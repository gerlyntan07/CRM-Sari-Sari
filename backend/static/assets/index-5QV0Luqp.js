function Wae(e,t){for(var n=0;n<t.length;n++){const s=t[n];if(typeof s!="string"&&!Array.isArray(s)){for(const r in s)if(r!=="default"&&!(r in e)){const i=Object.getOwnPropertyDescriptor(s,r);i&&Object.defineProperty(e,r,i.get?i:{enumerable:!0,get:()=>s[r]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=n(r);fetch(r.href,i)}})();function ao(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var KS={exports:{}},gg={};var uI;function Vae(){if(uI)return gg;uI=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function n(s,r,i){var o=null;if(i!==void 0&&(o=""+i),r.key!==void 0&&(o=""+r.key),"key"in r){i={};for(var l in r)l!=="key"&&(i[l]=r[l])}else i=r;return r=i.ref,{$$typeof:e,type:s,key:o,ref:r!==void 0?r:null,props:i}}return gg.Fragment=t,gg.jsx=n,gg.jsxs=n,gg}var mI;function Yae(){return mI||(mI=1,KS.exports=Vae()),KS.exports}var a=Yae(),XS={exports:{}},na={};var fI;function Qae(){if(fI)return na;fI=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),h=Symbol.for("react.activity"),p=Symbol.iterator;function x(J){return J===null||typeof J!="object"?null:(J=p&&J[p]||J["@@iterator"],typeof J=="function"?J:null)}var b={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},j=Object.assign,y={};function N(J,se,ye){this.props=J,this.context=se,this.refs=y,this.updater=ye||b}N.prototype.isReactComponent={},N.prototype.setState=function(J,se){if(typeof J!="object"&&typeof J!="function"&&J!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,J,se,"setState")},N.prototype.forceUpdate=function(J){this.updater.enqueueForceUpdate(this,J,"forceUpdate")};function w(){}w.prototype=N.prototype;function S(J,se,ye){this.props=J,this.context=se,this.refs=y,this.updater=ye||b}var _=S.prototype=new w;_.constructor=S,j(_,N.prototype),_.isPureReactComponent=!0;var T=Array.isArray;function k(){}var A={H:null,A:null,T:null,S:null},E=Object.prototype.hasOwnProperty;function M(J,se,ye){var Ce=ye.ref;return{$$typeof:e,type:J,key:se,ref:Ce!==void 0?Ce:null,props:ye}}function F(J,se){return M(J.type,se,J.props)}function D(J){return typeof J=="object"&&J!==null&&J.$$typeof===e}function P(J){var se={"=":"=0",":":"=2"};return"$"+J.replace(/[=:]/g,function(ye){return se[ye]})}var B=/\/+/g;function G(J,se){return typeof J=="object"&&J!==null&&J.key!=null?P(""+J.key):se.toString(36)}function $(J){switch(J.status){case"fulfilled":return J.value;case"rejected":throw J.reason;default:switch(typeof J.status=="string"?J.then(k,k):(J.status="pending",J.then(function(se){J.status==="pending"&&(J.status="fulfilled",J.value=se)},function(se){J.status==="pending"&&(J.status="rejected",J.reason=se)})),J.status){case"fulfilled":return J.value;case"rejected":throw J.reason}}throw J}function W(J,se,ye,Ce,ge){var be=typeof J;(be==="undefined"||be==="boolean")&&(J=null);var me=!1;if(J===null)me=!0;else switch(be){case"bigint":case"string":case"number":me=!0;break;case"object":switch(J.$$typeof){case e:case t:me=!0;break;case d:return me=J._init,W(me(J._payload),se,ye,Ce,ge)}}if(me)return ge=ge(J),me=Ce===""?"."+G(J,0):Ce,T(ge)?(ye="",me!=null&&(ye=me.replace(B,"$&/")+"/"),W(ge,se,ye,"",function(Ie){return Ie})):ge!=null&&(D(ge)&&(ge=F(ge,ye+(ge.key==null||J&&J.key===ge.key?"":(""+ge.key).replace(B,"$&/")+"/")+me)),se.push(ge)),1;me=0;var Ae=Ce===""?".":Ce+":";if(T(J))for(var pe=0;pe<J.length;pe++)Ce=J[pe],be=Ae+G(Ce,pe),me+=W(Ce,se,ye,be,ge);else if(pe=x(J),typeof pe=="function")for(J=pe.call(J),pe=0;!(Ce=J.next()).done;)Ce=Ce.value,be=Ae+G(Ce,pe++),me+=W(Ce,se,ye,be,ge);else if(be==="object"){if(typeof J.then=="function")return W($(J),se,ye,Ce,ge);throw se=String(J),Error("Objects are not valid as a React child (found: "+(se==="[object Object]"?"object with keys {"+Object.keys(J).join(", ")+"}":se)+"). If you meant to render a collection of children, use an array instead.")}return me}function Z(J,se,ye){if(J==null)return J;var Ce=[],ge=0;return W(J,Ce,"","",function(be){return se.call(ye,be,ge++)}),Ce}function Q(J){if(J._status===-1){var se=J._result;se=se(),se.then(function(ye){(J._status===0||J._status===-1)&&(J._status=1,J._result=ye)},function(ye){(J._status===0||J._status===-1)&&(J._status=2,J._result=ye)}),J._status===-1&&(J._status=0,J._result=se)}if(J._status===1)return J._result.default;throw J._result}var le=typeof reportError=="function"?reportError:function(J){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var se=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof J=="object"&&J!==null&&typeof J.message=="string"?String(J.message):String(J),error:J});if(!window.dispatchEvent(se))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",J);return}console.error(J)},we={map:Z,forEach:function(J,se,ye){Z(J,function(){se.apply(this,arguments)},ye)},count:function(J){var se=0;return Z(J,function(){se++}),se},toArray:function(J){return Z(J,function(se){return se})||[]},only:function(J){if(!D(J))throw Error("React.Children.only expected to receive a single React element child.");return J}};return na.Activity=h,na.Children=we,na.Component=N,na.Fragment=n,na.Profiler=r,na.PureComponent=S,na.StrictMode=s,na.Suspense=c,na.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=A,na.__COMPILER_RUNTIME={__proto__:null,c:function(J){return A.H.useMemoCache(J)}},na.cache=function(J){return function(){return J.apply(null,arguments)}},na.cacheSignal=function(){return null},na.cloneElement=function(J,se,ye){if(J==null)throw Error("The argument must be a React element, but you passed "+J+".");var Ce=j({},J.props),ge=J.key;if(se!=null)for(be in se.key!==void 0&&(ge=""+se.key),se)!E.call(se,be)||be==="key"||be==="__self"||be==="__source"||be==="ref"&&se.ref===void 0||(Ce[be]=se[be]);var be=arguments.length-2;if(be===1)Ce.children=ye;else if(1<be){for(var me=Array(be),Ae=0;Ae<be;Ae++)me[Ae]=arguments[Ae+2];Ce.children=me}return M(J.type,ge,Ce)},na.createContext=function(J){return J={$$typeof:o,_currentValue:J,_currentValue2:J,_threadCount:0,Provider:null,Consumer:null},J.Provider=J,J.Consumer={$$typeof:i,_context:J},J},na.createElement=function(J,se,ye){var Ce,ge={},be=null;if(se!=null)for(Ce in se.key!==void 0&&(be=""+se.key),se)E.call(se,Ce)&&Ce!=="key"&&Ce!=="__self"&&Ce!=="__source"&&(ge[Ce]=se[Ce]);var me=arguments.length-2;if(me===1)ge.children=ye;else if(1<me){for(var Ae=Array(me),pe=0;pe<me;pe++)Ae[pe]=arguments[pe+2];ge.children=Ae}if(J&&J.defaultProps)for(Ce in me=J.defaultProps,me)ge[Ce]===void 0&&(ge[Ce]=me[Ce]);return M(J,be,ge)},na.createRef=function(){return{current:null}},na.forwardRef=function(J){return{$$typeof:l,render:J}},na.isValidElement=D,na.lazy=function(J){return{$$typeof:d,_payload:{_status:-1,_result:J},_init:Q}},na.memo=function(J,se){return{$$typeof:u,type:J,compare:se===void 0?null:se}},na.startTransition=function(J){var se=A.T,ye={};A.T=ye;try{var Ce=J(),ge=A.S;ge!==null&&ge(ye,Ce),typeof Ce=="object"&&Ce!==null&&typeof Ce.then=="function"&&Ce.then(k,le)}catch(be){le(be)}finally{se!==null&&ye.types!==null&&(se.types=ye.types),A.T=se}},na.unstable_useCacheRefresh=function(){return A.H.useCacheRefresh()},na.use=function(J){return A.H.use(J)},na.useActionState=function(J,se,ye){return A.H.useActionState(J,se,ye)},na.useCallback=function(J,se){return A.H.useCallback(J,se)},na.useContext=function(J){return A.H.useContext(J)},na.useDebugValue=function(){},na.useDeferredValue=function(J,se){return A.H.useDeferredValue(J,se)},na.useEffect=function(J,se){return A.H.useEffect(J,se)},na.useEffectEvent=function(J){return A.H.useEffectEvent(J)},na.useId=function(){return A.H.useId()},na.useImperativeHandle=function(J,se,ye){return A.H.useImperativeHandle(J,se,ye)},na.useInsertionEffect=function(J,se){return A.H.useInsertionEffect(J,se)},na.useLayoutEffect=function(J,se){return A.H.useLayoutEffect(J,se)},na.useMemo=function(J,se){return A.H.useMemo(J,se)},na.useOptimistic=function(J,se){return A.H.useOptimistic(J,se)},na.useReducer=function(J,se,ye){return A.H.useReducer(J,se,ye)},na.useRef=function(J){return A.H.useRef(J)},na.useState=function(J){return A.H.useState(J)},na.useSyncExternalStore=function(J,se,ye){return A.H.useSyncExternalStore(J,se,ye)},na.useTransition=function(){return A.H.useTransition()},na.version="19.2.0",na}var hI;function Xf(){return hI||(hI=1,XS.exports=Qae()),XS.exports}var f=Xf();const wt=ao(f),Mu=Wae({__proto__:null,default:wt},[f]);var ZS={exports:{}},pg={},JS={exports:{}},e2={};var gI;function Kae(){return gI||(gI=1,(function(e){function t(W,Z){var Q=W.length;W.push(Z);e:for(;0<Q;){var le=Q-1>>>1,we=W[le];if(0<r(we,Z))W[le]=Z,W[Q]=we,Q=le;else break e}}function n(W){return W.length===0?null:W[0]}function s(W){if(W.length===0)return null;var Z=W[0],Q=W.pop();if(Q!==Z){W[0]=Q;e:for(var le=0,we=W.length,J=we>>>1;le<J;){var se=2*(le+1)-1,ye=W[se],Ce=se+1,ge=W[Ce];if(0>r(ye,Q))Ce<we&&0>r(ge,ye)?(W[le]=ge,W[Ce]=Q,le=Ce):(W[le]=ye,W[se]=Q,le=se);else if(Ce<we&&0>r(ge,Q))W[le]=ge,W[Ce]=Q,le=Ce;else break e}}return Z}function r(W,Z){var Q=W.sortIndex-Z.sortIndex;return Q!==0?Q:W.id-Z.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,h=null,p=3,x=!1,b=!1,j=!1,y=!1,N=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;function _(W){for(var Z=n(u);Z!==null;){if(Z.callback===null)s(u);else if(Z.startTime<=W)s(u),Z.sortIndex=Z.expirationTime,t(c,Z);else break;Z=n(u)}}function T(W){if(j=!1,_(W),!b)if(n(c)!==null)b=!0,k||(k=!0,P());else{var Z=n(u);Z!==null&&$(T,Z.startTime-W)}}var k=!1,A=-1,E=5,M=-1;function F(){return y?!0:!(e.unstable_now()-M<E)}function D(){if(y=!1,k){var W=e.unstable_now();M=W;var Z=!0;try{e:{b=!1,j&&(j=!1,w(A),A=-1),x=!0;var Q=p;try{t:{for(_(W),h=n(c);h!==null&&!(h.expirationTime>W&&F());){var le=h.callback;if(typeof le=="function"){h.callback=null,p=h.priorityLevel;var we=le(h.expirationTime<=W);if(W=e.unstable_now(),typeof we=="function"){h.callback=we,_(W),Z=!0;break t}h===n(c)&&s(c),_(W)}else s(c);h=n(c)}if(h!==null)Z=!0;else{var J=n(u);J!==null&&$(T,J.startTime-W),Z=!1}}break e}finally{h=null,p=Q,x=!1}Z=void 0}}finally{Z?P():k=!1}}}var P;if(typeof S=="function")P=function(){S(D)};else if(typeof MessageChannel<"u"){var B=new MessageChannel,G=B.port2;B.port1.onmessage=D,P=function(){G.postMessage(null)}}else P=function(){N(D,0)};function $(W,Z){A=N(function(){W(e.unstable_now())},Z)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(W){W.callback=null},e.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<W?Math.floor(1e3/W):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_next=function(W){switch(p){case 1:case 2:case 3:var Z=3;break;default:Z=p}var Q=p;p=Z;try{return W()}finally{p=Q}},e.unstable_requestPaint=function(){y=!0},e.unstable_runWithPriority=function(W,Z){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var Q=p;p=W;try{return Z()}finally{p=Q}},e.unstable_scheduleCallback=function(W,Z,Q){var le=e.unstable_now();switch(typeof Q=="object"&&Q!==null?(Q=Q.delay,Q=typeof Q=="number"&&0<Q?le+Q:le):Q=le,W){case 1:var we=-1;break;case 2:we=250;break;case 5:we=1073741823;break;case 4:we=1e4;break;default:we=5e3}return we=Q+we,W={id:d++,callback:Z,priorityLevel:W,startTime:Q,expirationTime:we,sortIndex:-1},Q>le?(W.sortIndex=Q,t(u,W),n(c)===null&&W===n(u)&&(j?(w(A),A=-1):j=!0,$(T,Q-le))):(W.sortIndex=we,t(c,W),b||x||(b=!0,k||(k=!0,P()))),W},e.unstable_shouldYield=F,e.unstable_wrapCallback=function(W){var Z=p;return function(){var Q=p;p=Z;try{return W.apply(this,arguments)}finally{p=Q}}}})(e2)),e2}var pI;function Xae(){return pI||(pI=1,JS.exports=Kae()),JS.exports}var t2={exports:{}},Ds={};var xI;function Zae(){if(xI)return Ds;xI=1;var e=Xf();function t(c){var u="https://react.dev/errors/"+c;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var d=2;d<arguments.length;d++)u+="&args[]="+encodeURIComponent(arguments[d])}return"Minified React error #"+c+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var s={d:{f:n,r:function(){throw Error(t(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},r=Symbol.for("react.portal");function i(c,u,d){var h=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:h==null?null:""+h,children:c,containerInfo:u,implementation:d}}var o=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function l(c,u){if(c==="font")return"";if(typeof u=="string")return u==="use-credentials"?u:""}return Ds.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,Ds.createPortal=function(c,u){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)throw Error(t(299));return i(c,u,null,d)},Ds.flushSync=function(c){var u=o.T,d=s.p;try{if(o.T=null,s.p=2,c)return c()}finally{o.T=u,s.p=d,s.d.f()}},Ds.preconnect=function(c,u){typeof c=="string"&&(u?(u=u.crossOrigin,u=typeof u=="string"?u==="use-credentials"?u:"":void 0):u=null,s.d.C(c,u))},Ds.prefetchDNS=function(c){typeof c=="string"&&s.d.D(c)},Ds.preinit=function(c,u){if(typeof c=="string"&&u&&typeof u.as=="string"){var d=u.as,h=l(d,u.crossOrigin),p=typeof u.integrity=="string"?u.integrity:void 0,x=typeof u.fetchPriority=="string"?u.fetchPriority:void 0;d==="style"?s.d.S(c,typeof u.precedence=="string"?u.precedence:void 0,{crossOrigin:h,integrity:p,fetchPriority:x}):d==="script"&&s.d.X(c,{crossOrigin:h,integrity:p,fetchPriority:x,nonce:typeof u.nonce=="string"?u.nonce:void 0})}},Ds.preinitModule=function(c,u){if(typeof c=="string")if(typeof u=="object"&&u!==null){if(u.as==null||u.as==="script"){var d=l(u.as,u.crossOrigin);s.d.M(c,{crossOrigin:d,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0})}}else u==null&&s.d.M(c)},Ds.preload=function(c,u){if(typeof c=="string"&&typeof u=="object"&&u!==null&&typeof u.as=="string"){var d=u.as,h=l(d,u.crossOrigin);s.d.L(c,d,{crossOrigin:h,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0,type:typeof u.type=="string"?u.type:void 0,fetchPriority:typeof u.fetchPriority=="string"?u.fetchPriority:void 0,referrerPolicy:typeof u.referrerPolicy=="string"?u.referrerPolicy:void 0,imageSrcSet:typeof u.imageSrcSet=="string"?u.imageSrcSet:void 0,imageSizes:typeof u.imageSizes=="string"?u.imageSizes:void 0,media:typeof u.media=="string"?u.media:void 0})}},Ds.preloadModule=function(c,u){if(typeof c=="string")if(u){var d=l(u.as,u.crossOrigin);s.d.m(c,{as:typeof u.as=="string"&&u.as!=="script"?u.as:void 0,crossOrigin:d,integrity:typeof u.integrity=="string"?u.integrity:void 0})}else s.d.m(c)},Ds.requestFormReset=function(c){s.d.r(c)},Ds.unstable_batchedUpdates=function(c,u){return c(u)},Ds.useFormState=function(c,u,d){return o.H.useFormState(c,u,d)},Ds.useFormStatus=function(){return o.H.useHostTransitionStatus()},Ds.version="19.2.0",Ds}var yI;function jH(){if(yI)return t2.exports;yI=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),t2.exports=Zae(),t2.exports}var bI;function Jae(){if(bI)return pg;bI=1;var e=Xae(),t=Xf(),n=jH();function s(m){var g="https://react.dev/errors/"+m;if(1<arguments.length){g+="?args[]="+encodeURIComponent(arguments[1]);for(var v=2;v<arguments.length;v++)g+="&args[]="+encodeURIComponent(arguments[v])}return"Minified React error #"+m+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(m){return!(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)}function i(m){var g=m,v=m;if(m.alternate)for(;g.return;)g=g.return;else{m=g;do g=m,(g.flags&4098)!==0&&(v=g.return),m=g.return;while(m)}return g.tag===3?v:null}function o(m){if(m.tag===13){var g=m.memoizedState;if(g===null&&(m=m.alternate,m!==null&&(g=m.memoizedState)),g!==null)return g.dehydrated}return null}function l(m){if(m.tag===31){var g=m.memoizedState;if(g===null&&(m=m.alternate,m!==null&&(g=m.memoizedState)),g!==null)return g.dehydrated}return null}function c(m){if(i(m)!==m)throw Error(s(188))}function u(m){var g=m.alternate;if(!g){if(g=i(m),g===null)throw Error(s(188));return g!==m?null:m}for(var v=m,C=g;;){var O=v.return;if(O===null)break;var R=O.alternate;if(R===null){if(C=O.return,C!==null){v=C;continue}break}if(O.child===R.child){for(R=O.child;R;){if(R===v)return c(O),m;if(R===C)return c(O),g;R=R.sibling}throw Error(s(188))}if(v.return!==C.return)v=O,C=R;else{for(var ae=!1,Se=O.child;Se;){if(Se===v){ae=!0,v=O,C=R;break}if(Se===C){ae=!0,C=O,v=R;break}Se=Se.sibling}if(!ae){for(Se=R.child;Se;){if(Se===v){ae=!0,v=R,C=O;break}if(Se===C){ae=!0,C=R,v=O;break}Se=Se.sibling}if(!ae)throw Error(s(189))}}if(v.alternate!==C)throw Error(s(190))}if(v.tag!==3)throw Error(s(188));return v.stateNode.current===v?m:g}function d(m){var g=m.tag;if(g===5||g===26||g===27||g===6)return m;for(m=m.child;m!==null;){if(g=d(m),g!==null)return g;m=m.sibling}return null}var h=Object.assign,p=Symbol.for("react.element"),x=Symbol.for("react.transitional.element"),b=Symbol.for("react.portal"),j=Symbol.for("react.fragment"),y=Symbol.for("react.strict_mode"),N=Symbol.for("react.profiler"),w=Symbol.for("react.consumer"),S=Symbol.for("react.context"),_=Symbol.for("react.forward_ref"),T=Symbol.for("react.suspense"),k=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),E=Symbol.for("react.lazy"),M=Symbol.for("react.activity"),F=Symbol.for("react.memo_cache_sentinel"),D=Symbol.iterator;function P(m){return m===null||typeof m!="object"?null:(m=D&&m[D]||m["@@iterator"],typeof m=="function"?m:null)}var B=Symbol.for("react.client.reference");function G(m){if(m==null)return null;if(typeof m=="function")return m.$$typeof===B?null:m.displayName||m.name||null;if(typeof m=="string")return m;switch(m){case j:return"Fragment";case N:return"Profiler";case y:return"StrictMode";case T:return"Suspense";case k:return"SuspenseList";case M:return"Activity"}if(typeof m=="object")switch(m.$$typeof){case b:return"Portal";case S:return m.displayName||"Context";case w:return(m._context.displayName||"Context")+".Consumer";case _:var g=m.render;return m=m.displayName,m||(m=g.displayName||g.name||"",m=m!==""?"ForwardRef("+m+")":"ForwardRef"),m;case A:return g=m.displayName||null,g!==null?g:G(m.type)||"Memo";case E:g=m._payload,m=m._init;try{return G(m(g))}catch{}}return null}var $=Array.isArray,W=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Z=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Q={pending:!1,data:null,method:null,action:null},le=[],we=-1;function J(m){return{current:m}}function se(m){0>we||(m.current=le[we],le[we]=null,we--)}function ye(m,g){we++,le[we]=m.current,m.current=g}var Ce=J(null),ge=J(null),be=J(null),me=J(null);function Ae(m,g){switch(ye(be,g),ye(ge,m),ye(Ce,null),g.nodeType){case 9:case 11:m=(m=g.documentElement)&&(m=m.namespaceURI)?OM(m):0;break;default:if(m=g.tagName,g=g.namespaceURI)g=OM(g),m=MM(g,m);else switch(m){case"svg":m=1;break;case"math":m=2;break;default:m=0}}se(Ce),ye(Ce,m)}function pe(){se(Ce),se(ge),se(be)}function Ie(m){m.memoizedState!==null&&ye(me,m);var g=Ce.current,v=MM(g,m.type);g!==v&&(ye(ge,m),ye(Ce,v))}function xe(m){ge.current===m&&(se(Ce),se(ge)),me.current===m&&(se(me),ug._currentValue=Q)}var he,Re;function Ee(m){if(he===void 0)try{throw Error()}catch(v){var g=v.stack.trim().match(/\n( *(at )?)/);he=g&&g[1]||"",Re=-1<v.stack.indexOf(`
    at`)?" (<anonymous>)":-1<v.stack.indexOf("@")?"@unknown:0:0":""}return`
`+he+m+Re}var He=!1;function Ke(m,g){if(!m||He)return"";He=!0;var v=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var C={DetermineComponentFrameRoot:function(){try{if(g){var Nt=function(){throw Error()};if(Object.defineProperty(Nt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Nt,[])}catch(gt){var ut=gt}Reflect.construct(m,[],Nt)}else{try{Nt.call()}catch(gt){ut=gt}m.call(Nt.prototype)}}else{try{throw Error()}catch(gt){ut=gt}(Nt=m())&&typeof Nt.catch=="function"&&Nt.catch(function(){})}}catch(gt){if(gt&&ut&&typeof gt.stack=="string")return[gt.stack,ut.stack]}return[null,null]}};C.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var O=Object.getOwnPropertyDescriptor(C.DetermineComponentFrameRoot,"name");O&&O.configurable&&Object.defineProperty(C.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var R=C.DetermineComponentFrameRoot(),ae=R[0],Se=R[1];if(ae&&Se){var Ye=ae.split(`
`),ct=Se.split(`
`);for(O=C=0;C<Ye.length&&!Ye[C].includes("DetermineComponentFrameRoot");)C++;for(;O<ct.length&&!ct[O].includes("DetermineComponentFrameRoot");)O++;if(C===Ye.length||O===ct.length)for(C=Ye.length-1,O=ct.length-1;1<=C&&0<=O&&Ye[C]!==ct[O];)O--;for(;1<=C&&0<=O;C--,O--)if(Ye[C]!==ct[O]){if(C!==1||O!==1)do if(C--,O--,0>O||Ye[C]!==ct[O]){var pt=`
`+Ye[C].replace(" at new "," at ");return m.displayName&&pt.includes("<anonymous>")&&(pt=pt.replace("<anonymous>",m.displayName)),pt}while(1<=C&&0<=O);break}}}finally{He=!1,Error.prepareStackTrace=v}return(v=m?m.displayName||m.name:"")?Ee(v):""}function st(m,g){switch(m.tag){case 26:case 27:case 5:return Ee(m.type);case 16:return Ee("Lazy");case 13:return m.child!==g&&g!==null?Ee("Suspense Fallback"):Ee("Suspense");case 19:return Ee("SuspenseList");case 0:case 15:return Ke(m.type,!1);case 11:return Ke(m.type.render,!1);case 1:return Ke(m.type,!0);case 31:return Ee("Activity");default:return""}}function it(m){try{var g="",v=null;do g+=st(m,v),v=m,m=m.return;while(m);return g}catch(C){return`
Error generating stack: `+C.message+`
`+C.stack}}var ot=Object.prototype.hasOwnProperty,rt=e.unstable_scheduleCallback,at=e.unstable_cancelCallback,Je=e.unstable_shouldYield,Fe=e.unstable_requestPaint,Ue=e.unstable_now,Ne=e.unstable_getCurrentPriorityLevel,ze=e.unstable_ImmediatePriority,je=e.unstable_UserBlockingPriority,ve=e.unstable_NormalPriority,z=e.unstable_LowPriority,K=e.unstable_IdlePriority,ue=e.log,re=e.unstable_setDisableYieldValue,Le=null,De=null;function Qe(m){if(typeof ue=="function"&&re(m),De&&typeof De.setStrictMode=="function")try{De.setStrictMode(Le,m)}catch{}}var tt=Math.clz32?Math.clz32:yt,Me=Math.log,et=Math.LN2;function yt(m){return m>>>=0,m===0?32:31-(Me(m)/et|0)|0}var _t=256,Ct=262144,jt=4194304;function At(m){var g=m&42;if(g!==0)return g;switch(m&-m){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return m&261888;case 262144:case 524288:case 1048576:case 2097152:return m&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return m&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return m}}function Ge(m,g,v){var C=m.pendingLanes;if(C===0)return 0;var O=0,R=m.suspendedLanes,ae=m.pingedLanes;m=m.warmLanes;var Se=C&134217727;return Se!==0?(C=Se&~R,C!==0?O=At(C):(ae&=Se,ae!==0?O=At(ae):v||(v=Se&~m,v!==0&&(O=At(v))))):(Se=C&~R,Se!==0?O=At(Se):ae!==0?O=At(ae):v||(v=C&~m,v!==0&&(O=At(v)))),O===0?0:g!==0&&g!==O&&(g&R)===0&&(R=O&-O,v=g&-g,R>=v||R===32&&(v&4194048)!==0)?g:O}function Be(m,g){return(m.pendingLanes&~(m.suspendedLanes&~m.pingedLanes)&g)===0}function ce(m,g){switch(m){case 1:case 2:case 4:case 8:case 64:return g+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return g+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function fe(){var m=jt;return jt<<=1,(jt&62914560)===0&&(jt=4194304),m}function H(m){for(var g=[],v=0;31>v;v++)g.push(m);return g}function te(m,g){m.pendingLanes|=g,g!==268435456&&(m.suspendedLanes=0,m.pingedLanes=0,m.warmLanes=0)}function q(m,g,v,C,O,R){var ae=m.pendingLanes;m.pendingLanes=v,m.suspendedLanes=0,m.pingedLanes=0,m.warmLanes=0,m.expiredLanes&=v,m.entangledLanes&=v,m.errorRecoveryDisabledLanes&=v,m.shellSuspendCounter=0;var Se=m.entanglements,Ye=m.expirationTimes,ct=m.hiddenUpdates;for(v=ae&~v;0<v;){var pt=31-tt(v),Nt=1<<pt;Se[pt]=0,Ye[pt]=-1;var ut=ct[pt];if(ut!==null)for(ct[pt]=null,pt=0;pt<ut.length;pt++){var gt=ut[pt];gt!==null&&(gt.lane&=-536870913)}v&=~Nt}C!==0&&Y(m,C,0),R!==0&&O===0&&m.tag!==0&&(m.suspendedLanes|=R&~(ae&~g))}function Y(m,g,v){m.pendingLanes|=g,m.suspendedLanes&=~g;var C=31-tt(g);m.entangledLanes|=g,m.entanglements[C]=m.entanglements[C]|1073741824|v&261930}function U(m,g){var v=m.entangledLanes|=g;for(m=m.entanglements;v;){var C=31-tt(v),O=1<<C;O&g|m[C]&g&&(m[C]|=g),v&=~O}}function de(m,g){var v=g&-g;return v=(v&42)!==0?1:Te(v),(v&(m.suspendedLanes|g))!==0?0:v}function Te(m){switch(m){case 2:m=1;break;case 8:m=4;break;case 32:m=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:m=128;break;case 268435456:m=134217728;break;default:m=0}return m}function ie(m){return m&=-m,2<m?8<m?(m&134217727)!==0?32:268435456:8:2}function Oe(){var m=Z.p;return m!==0?m:(m=window.event,m===void 0?32:sI(m.type))}function X(m,g){var v=Z.p;try{return Z.p=m,g()}finally{Z.p=v}}var oe=Math.random().toString(36).slice(2),Pe="__reactFiber$"+oe,Ve="__reactProps$"+oe,ft="__reactContainer$"+oe,St="__reactEvents$"+oe,Ht="__reactListeners$"+oe,da="__reactHandles$"+oe,qe="__reactResources$"+oe,_e="__reactMarker$"+oe;function I(m){delete m[Pe],delete m[Ve],delete m[St],delete m[Ht],delete m[da]}function L(m){var g=m[Pe];if(g)return g;for(var v=m.parentNode;v;){if(g=v[ft]||v[Pe]){if(v=g.alternate,g.child!==null||v!==null&&v.child!==null)for(m=BM(m);m!==null;){if(v=m[Pe])return v;m=BM(m)}return g}m=v,v=m.parentNode}return null}function ee(m){if(m=m[Pe]||m[ft]){var g=m.tag;if(g===5||g===6||g===13||g===31||g===26||g===27||g===3)return m}return null}function ke(m){var g=m.tag;if(g===5||g===26||g===27||g===6)return m.stateNode;throw Error(s(33))}function $e(m){var g=m[qe];return g||(g=m[qe]={hoistableStyles:new Map,hoistableScripts:new Map}),g}function We(m){m[_e]=!0}var mt=new Set,Tt={};function kt(m,g){Yt(m,g),Yt(m+"Capture",g)}function Yt(m,g){for(Tt[m]=g,m=0;m<g.length;m++)mt.add(g[m])}var En=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Qr={},S0={};function Ree(m){return ot.call(S0,m)?!0:ot.call(Qr,m)?!1:En.test(m)?S0[m]=!0:(Qr[m]=!0,!1)}function _0(m,g,v){if(Ree(g))if(v===null)m.removeAttribute(g);else{switch(typeof v){case"undefined":case"function":case"symbol":m.removeAttribute(g);return;case"boolean":var C=g.toLowerCase().slice(0,5);if(C!=="data-"&&C!=="aria-"){m.removeAttribute(g);return}}m.setAttribute(g,""+v)}}function A0(m,g,v){if(v===null)m.removeAttribute(g);else{switch(typeof v){case"undefined":case"function":case"symbol":case"boolean":m.removeAttribute(g);return}m.setAttribute(g,""+v)}}function Zo(m,g,v,C){if(C===null)m.removeAttribute(v);else{switch(typeof C){case"undefined":case"function":case"symbol":case"boolean":m.removeAttribute(v);return}m.setAttributeNS(g,v,""+C)}}function Kr(m){switch(typeof m){case"bigint":case"boolean":case"number":case"string":case"undefined":return m;case"object":return m;default:return""}}function _3(m){var g=m.type;return(m=m.nodeName)&&m.toLowerCase()==="input"&&(g==="checkbox"||g==="radio")}function zee(m,g,v){var C=Object.getOwnPropertyDescriptor(m.constructor.prototype,g);if(!m.hasOwnProperty(g)&&typeof C<"u"&&typeof C.get=="function"&&typeof C.set=="function"){var O=C.get,R=C.set;return Object.defineProperty(m,g,{configurable:!0,get:function(){return O.call(this)},set:function(ae){v=""+ae,R.call(this,ae)}}),Object.defineProperty(m,g,{enumerable:C.enumerable}),{getValue:function(){return v},setValue:function(ae){v=""+ae},stopTracking:function(){m._valueTracker=null,delete m[g]}}}}function H1(m){if(!m._valueTracker){var g=_3(m)?"checked":"value";m._valueTracker=zee(m,g,""+m[g])}}function A3(m){if(!m)return!1;var g=m._valueTracker;if(!g)return!0;var v=g.getValue(),C="";return m&&(C=_3(m)?m.checked?"true":"false":m.value),m=C,m!==v?(g.setValue(m),!0):!1}function T0(m){if(m=m||(typeof document<"u"?document:void 0),typeof m>"u")return null;try{return m.activeElement||m.body}catch{return m.body}}var Fee=/[\n"\\]/g;function Xr(m){return m.replace(Fee,function(g){return"\\"+g.charCodeAt(0).toString(16)+" "})}function q1(m,g,v,C,O,R,ae,Se){m.name="",ae!=null&&typeof ae!="function"&&typeof ae!="symbol"&&typeof ae!="boolean"?m.type=ae:m.removeAttribute("type"),g!=null?ae==="number"?(g===0&&m.value===""||m.value!=g)&&(m.value=""+Kr(g)):m.value!==""+Kr(g)&&(m.value=""+Kr(g)):ae!=="submit"&&ae!=="reset"||m.removeAttribute("value"),g!=null?G1(m,ae,Kr(g)):v!=null?G1(m,ae,Kr(v)):C!=null&&m.removeAttribute("value"),O==null&&R!=null&&(m.defaultChecked=!!R),O!=null&&(m.checked=O&&typeof O!="function"&&typeof O!="symbol"),Se!=null&&typeof Se!="function"&&typeof Se!="symbol"&&typeof Se!="boolean"?m.name=""+Kr(Se):m.removeAttribute("name")}function T3(m,g,v,C,O,R,ae,Se){if(R!=null&&typeof R!="function"&&typeof R!="symbol"&&typeof R!="boolean"&&(m.type=R),g!=null||v!=null){if(!(R!=="submit"&&R!=="reset"||g!=null)){H1(m);return}v=v!=null?""+Kr(v):"",g=g!=null?""+Kr(g):v,Se||g===m.value||(m.value=g),m.defaultValue=g}C=C??O,C=typeof C!="function"&&typeof C!="symbol"&&!!C,m.checked=Se?m.checked:!!C,m.defaultChecked=!!C,ae!=null&&typeof ae!="function"&&typeof ae!="symbol"&&typeof ae!="boolean"&&(m.name=ae),H1(m)}function G1(m,g,v){g==="number"&&T0(m.ownerDocument)===m||m.defaultValue===""+v||(m.defaultValue=""+v)}function gm(m,g,v,C){if(m=m.options,g){g={};for(var O=0;O<v.length;O++)g["$"+v[O]]=!0;for(v=0;v<m.length;v++)O=g.hasOwnProperty("$"+m[v].value),m[v].selected!==O&&(m[v].selected=O),O&&C&&(m[v].defaultSelected=!0)}else{for(v=""+Kr(v),g=null,O=0;O<m.length;O++){if(m[O].value===v){m[O].selected=!0,C&&(m[O].defaultSelected=!0);return}g!==null||m[O].disabled||(g=m[O])}g!==null&&(g.selected=!0)}}function k3(m,g,v){if(g!=null&&(g=""+Kr(g),g!==m.value&&(m.value=g),v==null)){m.defaultValue!==g&&(m.defaultValue=g);return}m.defaultValue=v!=null?""+Kr(v):""}function E3(m,g,v,C){if(g==null){if(C!=null){if(v!=null)throw Error(s(92));if($(C)){if(1<C.length)throw Error(s(93));C=C[0]}v=C}v==null&&(v=""),g=v}v=Kr(g),m.defaultValue=v,C=m.textContent,C===v&&C!==""&&C!==null&&(m.value=C),H1(m)}function pm(m,g){if(g){var v=m.firstChild;if(v&&v===m.lastChild&&v.nodeType===3){v.nodeValue=g;return}}m.textContent=g}var Uee=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function L3(m,g,v){var C=g.indexOf("--")===0;v==null||typeof v=="boolean"||v===""?C?m.setProperty(g,""):g==="float"?m.cssFloat="":m[g]="":C?m.setProperty(g,v):typeof v!="number"||v===0||Uee.has(g)?g==="float"?m.cssFloat=v:m[g]=(""+v).trim():m[g]=v+"px"}function D3(m,g,v){if(g!=null&&typeof g!="object")throw Error(s(62));if(m=m.style,v!=null){for(var C in v)!v.hasOwnProperty(C)||g!=null&&g.hasOwnProperty(C)||(C.indexOf("--")===0?m.setProperty(C,""):C==="float"?m.cssFloat="":m[C]="");for(var O in g)C=g[O],g.hasOwnProperty(O)&&v[O]!==C&&L3(m,O,C)}else for(var R in g)g.hasOwnProperty(R)&&L3(m,R,g[R])}function W1(m){if(m.indexOf("-")===-1)return!1;switch(m){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Bee=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Hee=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function k0(m){return Hee.test(""+m)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":m}function Jo(){}var V1=null;function Y1(m){return m=m.target||m.srcElement||window,m.correspondingUseElement&&(m=m.correspondingUseElement),m.nodeType===3?m.parentNode:m}var xm=null,ym=null;function P3(m){var g=ee(m);if(g&&(m=g.stateNode)){var v=m[Ve]||null;e:switch(m=g.stateNode,g.type){case"input":if(q1(m,v.value,v.defaultValue,v.defaultValue,v.checked,v.defaultChecked,v.type,v.name),g=v.name,v.type==="radio"&&g!=null){for(v=m;v.parentNode;)v=v.parentNode;for(v=v.querySelectorAll('input[name="'+Xr(""+g)+'"][type="radio"]'),g=0;g<v.length;g++){var C=v[g];if(C!==m&&C.form===m.form){var O=C[Ve]||null;if(!O)throw Error(s(90));q1(C,O.value,O.defaultValue,O.defaultValue,O.checked,O.defaultChecked,O.type,O.name)}}for(g=0;g<v.length;g++)C=v[g],C.form===m.form&&A3(C)}break e;case"textarea":k3(m,v.value,v.defaultValue);break e;case"select":g=v.value,g!=null&&gm(m,!!v.multiple,g,!1)}}}var Q1=!1;function O3(m,g,v){if(Q1)return m(g,v);Q1=!0;try{var C=m(g);return C}finally{if(Q1=!1,(xm!==null||ym!==null)&&(py(),xm&&(g=xm,m=ym,ym=xm=null,P3(g),m)))for(g=0;g<m.length;g++)P3(m[g])}}function Th(m,g){var v=m.stateNode;if(v===null)return null;var C=v[Ve]||null;if(C===null)return null;v=C[g];e:switch(g){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(C=!C.disabled)||(m=m.type,C=!(m==="button"||m==="input"||m==="select"||m==="textarea")),m=!C;break e;default:m=!1}if(m)return null;if(v&&typeof v!="function")throw Error(s(231,g,typeof v));return v}var el=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),K1=!1;if(el)try{var kh={};Object.defineProperty(kh,"passive",{get:function(){K1=!0}}),window.addEventListener("test",kh,kh),window.removeEventListener("test",kh,kh)}catch{K1=!1}var gc=null,X1=null,E0=null;function M3(){if(E0)return E0;var m,g=X1,v=g.length,C,O="value"in gc?gc.value:gc.textContent,R=O.length;for(m=0;m<v&&g[m]===O[m];m++);var ae=v-m;for(C=1;C<=ae&&g[v-C]===O[R-C];C++);return E0=O.slice(m,1<C?1-C:void 0)}function L0(m){var g=m.keyCode;return"charCode"in m?(m=m.charCode,m===0&&g===13&&(m=13)):m=g,m===10&&(m=13),32<=m||m===13?m:0}function D0(){return!0}function I3(){return!1}function er(m){function g(v,C,O,R,ae){this._reactName=v,this._targetInst=O,this.type=C,this.nativeEvent=R,this.target=ae,this.currentTarget=null;for(var Se in m)m.hasOwnProperty(Se)&&(v=m[Se],this[Se]=v?v(R):R[Se]);return this.isDefaultPrevented=(R.defaultPrevented!=null?R.defaultPrevented:R.returnValue===!1)?D0:I3,this.isPropagationStopped=I3,this}return h(g.prototype,{preventDefault:function(){this.defaultPrevented=!0;var v=this.nativeEvent;v&&(v.preventDefault?v.preventDefault():typeof v.returnValue!="unknown"&&(v.returnValue=!1),this.isDefaultPrevented=D0)},stopPropagation:function(){var v=this.nativeEvent;v&&(v.stopPropagation?v.stopPropagation():typeof v.cancelBubble!="unknown"&&(v.cancelBubble=!0),this.isPropagationStopped=D0)},persist:function(){},isPersistent:D0}),g}var Dd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(m){return m.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},P0=er(Dd),Eh=h({},Dd,{view:0,detail:0}),qee=er(Eh),Z1,J1,Lh,O0=h({},Eh,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:tC,button:0,buttons:0,relatedTarget:function(m){return m.relatedTarget===void 0?m.fromElement===m.srcElement?m.toElement:m.fromElement:m.relatedTarget},movementX:function(m){return"movementX"in m?m.movementX:(m!==Lh&&(Lh&&m.type==="mousemove"?(Z1=m.screenX-Lh.screenX,J1=m.screenY-Lh.screenY):J1=Z1=0,Lh=m),Z1)},movementY:function(m){return"movementY"in m?m.movementY:J1}}),$3=er(O0),Gee=h({},O0,{dataTransfer:0}),Wee=er(Gee),Vee=h({},Eh,{relatedTarget:0}),eC=er(Vee),Yee=h({},Dd,{animationName:0,elapsedTime:0,pseudoElement:0}),Qee=er(Yee),Kee=h({},Dd,{clipboardData:function(m){return"clipboardData"in m?m.clipboardData:window.clipboardData}}),Xee=er(Kee),Zee=h({},Dd,{data:0}),R3=er(Zee),Jee={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ete={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},tte={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ate(m){var g=this.nativeEvent;return g.getModifierState?g.getModifierState(m):(m=tte[m])?!!g[m]:!1}function tC(){return ate}var nte=h({},Eh,{key:function(m){if(m.key){var g=Jee[m.key]||m.key;if(g!=="Unidentified")return g}return m.type==="keypress"?(m=L0(m),m===13?"Enter":String.fromCharCode(m)):m.type==="keydown"||m.type==="keyup"?ete[m.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:tC,charCode:function(m){return m.type==="keypress"?L0(m):0},keyCode:function(m){return m.type==="keydown"||m.type==="keyup"?m.keyCode:0},which:function(m){return m.type==="keypress"?L0(m):m.type==="keydown"||m.type==="keyup"?m.keyCode:0}}),ste=er(nte),rte=h({},O0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),z3=er(rte),ite=h({},Eh,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:tC}),ote=er(ite),lte=h({},Dd,{propertyName:0,elapsedTime:0,pseudoElement:0}),cte=er(lte),dte=h({},O0,{deltaX:function(m){return"deltaX"in m?m.deltaX:"wheelDeltaX"in m?-m.wheelDeltaX:0},deltaY:function(m){return"deltaY"in m?m.deltaY:"wheelDeltaY"in m?-m.wheelDeltaY:"wheelDelta"in m?-m.wheelDelta:0},deltaZ:0,deltaMode:0}),ute=er(dte),mte=h({},Dd,{newState:0,oldState:0}),fte=er(mte),hte=[9,13,27,32],aC=el&&"CompositionEvent"in window,Dh=null;el&&"documentMode"in document&&(Dh=document.documentMode);var gte=el&&"TextEvent"in window&&!Dh,F3=el&&(!aC||Dh&&8<Dh&&11>=Dh),U3=" ",B3=!1;function H3(m,g){switch(m){case"keyup":return hte.indexOf(g.keyCode)!==-1;case"keydown":return g.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function q3(m){return m=m.detail,typeof m=="object"&&"data"in m?m.data:null}var bm=!1;function pte(m,g){switch(m){case"compositionend":return q3(g);case"keypress":return g.which!==32?null:(B3=!0,U3);case"textInput":return m=g.data,m===U3&&B3?null:m;default:return null}}function xte(m,g){if(bm)return m==="compositionend"||!aC&&H3(m,g)?(m=M3(),E0=X1=gc=null,bm=!1,m):null;switch(m){case"paste":return null;case"keypress":if(!(g.ctrlKey||g.altKey||g.metaKey)||g.ctrlKey&&g.altKey){if(g.char&&1<g.char.length)return g.char;if(g.which)return String.fromCharCode(g.which)}return null;case"compositionend":return F3&&g.locale!=="ko"?null:g.data;default:return null}}var yte={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function G3(m){var g=m&&m.nodeName&&m.nodeName.toLowerCase();return g==="input"?!!yte[m.type]:g==="textarea"}function W3(m,g,v,C){xm?ym?ym.push(C):ym=[C]:xm=C,g=Ny(g,"onChange"),0<g.length&&(v=new P0("onChange","change",null,v,C),m.push({event:v,listeners:g}))}var Ph=null,Oh=null;function bte(m){TM(m,0)}function M0(m){var g=ke(m);if(A3(g))return m}function V3(m,g){if(m==="change")return g}var Y3=!1;if(el){var nC;if(el){var sC="oninput"in document;if(!sC){var Q3=document.createElement("div");Q3.setAttribute("oninput","return;"),sC=typeof Q3.oninput=="function"}nC=sC}else nC=!1;Y3=nC&&(!document.documentMode||9<document.documentMode)}function K3(){Ph&&(Ph.detachEvent("onpropertychange",X3),Oh=Ph=null)}function X3(m){if(m.propertyName==="value"&&M0(Oh)){var g=[];W3(g,Oh,m,Y1(m)),O3(bte,g)}}function vte(m,g,v){m==="focusin"?(K3(),Ph=g,Oh=v,Ph.attachEvent("onpropertychange",X3)):m==="focusout"&&K3()}function wte(m){if(m==="selectionchange"||m==="keyup"||m==="keydown")return M0(Oh)}function jte(m,g){if(m==="click")return M0(g)}function Nte(m,g){if(m==="input"||m==="change")return M0(g)}function Cte(m,g){return m===g&&(m!==0||1/m===1/g)||m!==m&&g!==g}var Ar=typeof Object.is=="function"?Object.is:Cte;function Mh(m,g){if(Ar(m,g))return!0;if(typeof m!="object"||m===null||typeof g!="object"||g===null)return!1;var v=Object.keys(m),C=Object.keys(g);if(v.length!==C.length)return!1;for(C=0;C<v.length;C++){var O=v[C];if(!ot.call(g,O)||!Ar(m[O],g[O]))return!1}return!0}function Z3(m){for(;m&&m.firstChild;)m=m.firstChild;return m}function J3(m,g){var v=Z3(m);m=0;for(var C;v;){if(v.nodeType===3){if(C=m+v.textContent.length,m<=g&&C>=g)return{node:v,offset:g-m};m=C}e:{for(;v;){if(v.nextSibling){v=v.nextSibling;break e}v=v.parentNode}v=void 0}v=Z3(v)}}function e5(m,g){return m&&g?m===g?!0:m&&m.nodeType===3?!1:g&&g.nodeType===3?e5(m,g.parentNode):"contains"in m?m.contains(g):m.compareDocumentPosition?!!(m.compareDocumentPosition(g)&16):!1:!1}function t5(m){m=m!=null&&m.ownerDocument!=null&&m.ownerDocument.defaultView!=null?m.ownerDocument.defaultView:window;for(var g=T0(m.document);g instanceof m.HTMLIFrameElement;){try{var v=typeof g.contentWindow.location.href=="string"}catch{v=!1}if(v)m=g.contentWindow;else break;g=T0(m.document)}return g}function rC(m){var g=m&&m.nodeName&&m.nodeName.toLowerCase();return g&&(g==="input"&&(m.type==="text"||m.type==="search"||m.type==="tel"||m.type==="url"||m.type==="password")||g==="textarea"||m.contentEditable==="true")}var Ste=el&&"documentMode"in document&&11>=document.documentMode,vm=null,iC=null,Ih=null,oC=!1;function a5(m,g,v){var C=v.window===v?v.document:v.nodeType===9?v:v.ownerDocument;oC||vm==null||vm!==T0(C)||(C=vm,"selectionStart"in C&&rC(C)?C={start:C.selectionStart,end:C.selectionEnd}:(C=(C.ownerDocument&&C.ownerDocument.defaultView||window).getSelection(),C={anchorNode:C.anchorNode,anchorOffset:C.anchorOffset,focusNode:C.focusNode,focusOffset:C.focusOffset}),Ih&&Mh(Ih,C)||(Ih=C,C=Ny(iC,"onSelect"),0<C.length&&(g=new P0("onSelect","select",null,g,v),m.push({event:g,listeners:C}),g.target=vm)))}function Pd(m,g){var v={};return v[m.toLowerCase()]=g.toLowerCase(),v["Webkit"+m]="webkit"+g,v["Moz"+m]="moz"+g,v}var wm={animationend:Pd("Animation","AnimationEnd"),animationiteration:Pd("Animation","AnimationIteration"),animationstart:Pd("Animation","AnimationStart"),transitionrun:Pd("Transition","TransitionRun"),transitionstart:Pd("Transition","TransitionStart"),transitioncancel:Pd("Transition","TransitionCancel"),transitionend:Pd("Transition","TransitionEnd")},lC={},n5={};el&&(n5=document.createElement("div").style,"AnimationEvent"in window||(delete wm.animationend.animation,delete wm.animationiteration.animation,delete wm.animationstart.animation),"TransitionEvent"in window||delete wm.transitionend.transition);function Od(m){if(lC[m])return lC[m];if(!wm[m])return m;var g=wm[m],v;for(v in g)if(g.hasOwnProperty(v)&&v in n5)return lC[m]=g[v];return m}var s5=Od("animationend"),r5=Od("animationiteration"),i5=Od("animationstart"),_te=Od("transitionrun"),Ate=Od("transitionstart"),Tte=Od("transitioncancel"),o5=Od("transitionend"),l5=new Map,cC="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");cC.push("scrollEnd");function Di(m,g){l5.set(m,g),kt(g,[m])}var I0=typeof reportError=="function"?reportError:function(m){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var g=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof m=="object"&&m!==null&&typeof m.message=="string"?String(m.message):String(m),error:m});if(!window.dispatchEvent(g))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",m);return}console.error(m)},Zr=[],jm=0,dC=0;function $0(){for(var m=jm,g=dC=jm=0;g<m;){var v=Zr[g];Zr[g++]=null;var C=Zr[g];Zr[g++]=null;var O=Zr[g];Zr[g++]=null;var R=Zr[g];if(Zr[g++]=null,C!==null&&O!==null){var ae=C.pending;ae===null?O.next=O:(O.next=ae.next,ae.next=O),C.pending=O}R!==0&&c5(v,O,R)}}function R0(m,g,v,C){Zr[jm++]=m,Zr[jm++]=g,Zr[jm++]=v,Zr[jm++]=C,dC|=C,m.lanes|=C,m=m.alternate,m!==null&&(m.lanes|=C)}function uC(m,g,v,C){return R0(m,g,v,C),z0(m)}function Md(m,g){return R0(m,null,null,g),z0(m)}function c5(m,g,v){m.lanes|=v;var C=m.alternate;C!==null&&(C.lanes|=v);for(var O=!1,R=m.return;R!==null;)R.childLanes|=v,C=R.alternate,C!==null&&(C.childLanes|=v),R.tag===22&&(m=R.stateNode,m===null||m._visibility&1||(O=!0)),m=R,R=R.return;return m.tag===3?(R=m.stateNode,O&&g!==null&&(O=31-tt(v),m=R.hiddenUpdates,C=m[O],C===null?m[O]=[g]:C.push(g),g.lane=v|536870912),R):null}function z0(m){if(50<sg)throw sg=0,vS=null,Error(s(185));for(var g=m.return;g!==null;)m=g,g=m.return;return m.tag===3?m.stateNode:null}var Nm={};function kte(m,g,v,C){this.tag=m,this.key=v,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=g,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=C,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Tr(m,g,v,C){return new kte(m,g,v,C)}function mC(m){return m=m.prototype,!(!m||!m.isReactComponent)}function tl(m,g){var v=m.alternate;return v===null?(v=Tr(m.tag,g,m.key,m.mode),v.elementType=m.elementType,v.type=m.type,v.stateNode=m.stateNode,v.alternate=m,m.alternate=v):(v.pendingProps=g,v.type=m.type,v.flags=0,v.subtreeFlags=0,v.deletions=null),v.flags=m.flags&65011712,v.childLanes=m.childLanes,v.lanes=m.lanes,v.child=m.child,v.memoizedProps=m.memoizedProps,v.memoizedState=m.memoizedState,v.updateQueue=m.updateQueue,g=m.dependencies,v.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext},v.sibling=m.sibling,v.index=m.index,v.ref=m.ref,v.refCleanup=m.refCleanup,v}function d5(m,g){m.flags&=65011714;var v=m.alternate;return v===null?(m.childLanes=0,m.lanes=g,m.child=null,m.subtreeFlags=0,m.memoizedProps=null,m.memoizedState=null,m.updateQueue=null,m.dependencies=null,m.stateNode=null):(m.childLanes=v.childLanes,m.lanes=v.lanes,m.child=v.child,m.subtreeFlags=0,m.deletions=null,m.memoizedProps=v.memoizedProps,m.memoizedState=v.memoizedState,m.updateQueue=v.updateQueue,m.type=v.type,g=v.dependencies,m.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext}),m}function F0(m,g,v,C,O,R){var ae=0;if(C=m,typeof m=="function")mC(m)&&(ae=1);else if(typeof m=="string")ae=Oae(m,v,Ce.current)?26:m==="html"||m==="head"||m==="body"?27:5;else e:switch(m){case M:return m=Tr(31,v,g,O),m.elementType=M,m.lanes=R,m;case j:return Id(v.children,O,R,g);case y:ae=8,O|=24;break;case N:return m=Tr(12,v,g,O|2),m.elementType=N,m.lanes=R,m;case T:return m=Tr(13,v,g,O),m.elementType=T,m.lanes=R,m;case k:return m=Tr(19,v,g,O),m.elementType=k,m.lanes=R,m;default:if(typeof m=="object"&&m!==null)switch(m.$$typeof){case S:ae=10;break e;case w:ae=9;break e;case _:ae=11;break e;case A:ae=14;break e;case E:ae=16,C=null;break e}ae=29,v=Error(s(130,m===null?"null":typeof m,"")),C=null}return g=Tr(ae,v,g,O),g.elementType=m,g.type=C,g.lanes=R,g}function Id(m,g,v,C){return m=Tr(7,m,C,g),m.lanes=v,m}function fC(m,g,v){return m=Tr(6,m,null,g),m.lanes=v,m}function u5(m){var g=Tr(18,null,null,0);return g.stateNode=m,g}function hC(m,g,v){return g=Tr(4,m.children!==null?m.children:[],m.key,g),g.lanes=v,g.stateNode={containerInfo:m.containerInfo,pendingChildren:null,implementation:m.implementation},g}var m5=new WeakMap;function Jr(m,g){if(typeof m=="object"&&m!==null){var v=m5.get(m);return v!==void 0?v:(g={value:m,source:g,stack:it(g)},m5.set(m,g),g)}return{value:m,source:g,stack:it(g)}}var Cm=[],Sm=0,U0=null,$h=0,ei=[],ti=0,pc=null,ro=1,io="";function al(m,g){Cm[Sm++]=$h,Cm[Sm++]=U0,U0=m,$h=g}function f5(m,g,v){ei[ti++]=ro,ei[ti++]=io,ei[ti++]=pc,pc=m;var C=ro;m=io;var O=32-tt(C)-1;C&=~(1<<O),v+=1;var R=32-tt(g)+O;if(30<R){var ae=O-O%5;R=(C&(1<<ae)-1).toString(32),C>>=ae,O-=ae,ro=1<<32-tt(g)+O|v<<O|C,io=R+m}else ro=1<<R|v<<O|C,io=m}function gC(m){m.return!==null&&(al(m,1),f5(m,1,0))}function pC(m){for(;m===U0;)U0=Cm[--Sm],Cm[Sm]=null,$h=Cm[--Sm],Cm[Sm]=null;for(;m===pc;)pc=ei[--ti],ei[ti]=null,io=ei[--ti],ei[ti]=null,ro=ei[--ti],ei[ti]=null}function h5(m,g){ei[ti++]=ro,ei[ti++]=io,ei[ti++]=pc,ro=g.id,io=g.overflow,pc=m}var Ns=null,en=null,ba=!1,xc=null,ai=!1,xC=Error(s(519));function yc(m){var g=Error(s(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Rh(Jr(g,m)),xC}function g5(m){var g=m.stateNode,v=m.type,C=m.memoizedProps;switch(g[Pe]=m,g[Ve]=C,v){case"dialog":ga("cancel",g),ga("close",g);break;case"iframe":case"object":case"embed":ga("load",g);break;case"video":case"audio":for(v=0;v<ig.length;v++)ga(ig[v],g);break;case"source":ga("error",g);break;case"img":case"image":case"link":ga("error",g),ga("load",g);break;case"details":ga("toggle",g);break;case"input":ga("invalid",g),T3(g,C.value,C.defaultValue,C.checked,C.defaultChecked,C.type,C.name,!0);break;case"select":ga("invalid",g);break;case"textarea":ga("invalid",g),E3(g,C.value,C.defaultValue,C.children)}v=C.children,typeof v!="string"&&typeof v!="number"&&typeof v!="bigint"||g.textContent===""+v||C.suppressHydrationWarning===!0||DM(g.textContent,v)?(C.popover!=null&&(ga("beforetoggle",g),ga("toggle",g)),C.onScroll!=null&&ga("scroll",g),C.onScrollEnd!=null&&ga("scrollend",g),C.onClick!=null&&(g.onclick=Jo),g=!0):g=!1,g||yc(m,!0)}function p5(m){for(Ns=m.return;Ns;)switch(Ns.tag){case 5:case 31:case 13:ai=!1;return;case 27:case 3:ai=!0;return;default:Ns=Ns.return}}function _m(m){if(m!==Ns)return!1;if(!ba)return p5(m),ba=!0,!1;var g=m.tag,v;if((v=g!==3&&g!==27)&&((v=g===5)&&(v=m.type,v=!(v!=="form"&&v!=="button")||MS(m.type,m.memoizedProps)),v=!v),v&&en&&yc(m),p5(m),g===13){if(m=m.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(s(317));en=UM(m)}else if(g===31){if(m=m.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(s(317));en=UM(m)}else g===27?(g=en,Dc(m.type)?(m=FS,FS=null,en=m):en=g):en=Ns?si(m.stateNode.nextSibling):null;return!0}function $d(){en=Ns=null,ba=!1}function yC(){var m=xc;return m!==null&&(sr===null?sr=m:sr.push.apply(sr,m),xc=null),m}function Rh(m){xc===null?xc=[m]:xc.push(m)}var bC=J(null),Rd=null,nl=null;function bc(m,g,v){ye(bC,g._currentValue),g._currentValue=v}function sl(m){m._currentValue=bC.current,se(bC)}function vC(m,g,v){for(;m!==null;){var C=m.alternate;if((m.childLanes&g)!==g?(m.childLanes|=g,C!==null&&(C.childLanes|=g)):C!==null&&(C.childLanes&g)!==g&&(C.childLanes|=g),m===v)break;m=m.return}}function wC(m,g,v,C){var O=m.child;for(O!==null&&(O.return=m);O!==null;){var R=O.dependencies;if(R!==null){var ae=O.child;R=R.firstContext;e:for(;R!==null;){var Se=R;R=O;for(var Ye=0;Ye<g.length;Ye++)if(Se.context===g[Ye]){R.lanes|=v,Se=R.alternate,Se!==null&&(Se.lanes|=v),vC(R.return,v,m),C||(ae=null);break e}R=Se.next}}else if(O.tag===18){if(ae=O.return,ae===null)throw Error(s(341));ae.lanes|=v,R=ae.alternate,R!==null&&(R.lanes|=v),vC(ae,v,m),ae=null}else ae=O.child;if(ae!==null)ae.return=O;else for(ae=O;ae!==null;){if(ae===m){ae=null;break}if(O=ae.sibling,O!==null){O.return=ae.return,ae=O;break}ae=ae.return}O=ae}}function Am(m,g,v,C){m=null;for(var O=g,R=!1;O!==null;){if(!R){if((O.flags&524288)!==0)R=!0;else if((O.flags&262144)!==0)break}if(O.tag===10){var ae=O.alternate;if(ae===null)throw Error(s(387));if(ae=ae.memoizedProps,ae!==null){var Se=O.type;Ar(O.pendingProps.value,ae.value)||(m!==null?m.push(Se):m=[Se])}}else if(O===me.current){if(ae=O.alternate,ae===null)throw Error(s(387));ae.memoizedState.memoizedState!==O.memoizedState.memoizedState&&(m!==null?m.push(ug):m=[ug])}O=O.return}m!==null&&wC(g,m,v,C),g.flags|=262144}function B0(m){for(m=m.firstContext;m!==null;){if(!Ar(m.context._currentValue,m.memoizedValue))return!0;m=m.next}return!1}function zd(m){Rd=m,nl=null,m=m.dependencies,m!==null&&(m.firstContext=null)}function Cs(m){return x5(Rd,m)}function H0(m,g){return Rd===null&&zd(m),x5(m,g)}function x5(m,g){var v=g._currentValue;if(g={context:g,memoizedValue:v,next:null},nl===null){if(m===null)throw Error(s(308));nl=g,m.dependencies={lanes:0,firstContext:g},m.flags|=524288}else nl=nl.next=g;return v}var Ete=typeof AbortController<"u"?AbortController:function(){var m=[],g=this.signal={aborted:!1,addEventListener:function(v,C){m.push(C)}};this.abort=function(){g.aborted=!0,m.forEach(function(v){return v()})}},Lte=e.unstable_scheduleCallback,Dte=e.unstable_NormalPriority,Rn={$$typeof:S,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function jC(){return{controller:new Ete,data:new Map,refCount:0}}function zh(m){m.refCount--,m.refCount===0&&Lte(Dte,function(){m.controller.abort()})}var Fh=null,NC=0,Tm=0,km=null;function Pte(m,g){if(Fh===null){var v=Fh=[];NC=0,Tm=_S(),km={status:"pending",value:void 0,then:function(C){v.push(C)}}}return NC++,g.then(y5,y5),g}function y5(){if(--NC===0&&Fh!==null){km!==null&&(km.status="fulfilled");var m=Fh;Fh=null,Tm=0,km=null;for(var g=0;g<m.length;g++)(0,m[g])()}}function Ote(m,g){var v=[],C={status:"pending",value:null,reason:null,then:function(O){v.push(O)}};return m.then(function(){C.status="fulfilled",C.value=g;for(var O=0;O<v.length;O++)(0,v[O])(g)},function(O){for(C.status="rejected",C.reason=O,O=0;O<v.length;O++)(0,v[O])(void 0)}),C}var b5=W.S;W.S=function(m,g){aM=Ue(),typeof g=="object"&&g!==null&&typeof g.then=="function"&&Pte(m,g),b5!==null&&b5(m,g)};var Fd=J(null);function CC(){var m=Fd.current;return m!==null?m:Wa.pooledCache}function q0(m,g){g===null?ye(Fd,Fd.current):ye(Fd,g.pool)}function v5(){var m=CC();return m===null?null:{parent:Rn._currentValue,pool:m}}var Em=Error(s(460)),SC=Error(s(474)),G0=Error(s(542)),W0={then:function(){}};function w5(m){return m=m.status,m==="fulfilled"||m==="rejected"}function j5(m,g,v){switch(v=m[v],v===void 0?m.push(g):v!==g&&(g.then(Jo,Jo),g=v),g.status){case"fulfilled":return g.value;case"rejected":throw m=g.reason,C5(m),m;default:if(typeof g.status=="string")g.then(Jo,Jo);else{if(m=Wa,m!==null&&100<m.shellSuspendCounter)throw Error(s(482));m=g,m.status="pending",m.then(function(C){if(g.status==="pending"){var O=g;O.status="fulfilled",O.value=C}},function(C){if(g.status==="pending"){var O=g;O.status="rejected",O.reason=C}})}switch(g.status){case"fulfilled":return g.value;case"rejected":throw m=g.reason,C5(m),m}throw Bd=g,Em}}function Ud(m){try{var g=m._init;return g(m._payload)}catch(v){throw v!==null&&typeof v=="object"&&typeof v.then=="function"?(Bd=v,Em):v}}var Bd=null;function N5(){if(Bd===null)throw Error(s(459));var m=Bd;return Bd=null,m}function C5(m){if(m===Em||m===G0)throw Error(s(483))}var Lm=null,Uh=0;function V0(m){var g=Uh;return Uh+=1,Lm===null&&(Lm=[]),j5(Lm,m,g)}function Bh(m,g){g=g.props.ref,m.ref=g!==void 0?g:null}function Y0(m,g){throw g.$$typeof===p?Error(s(525)):(m=Object.prototype.toString.call(g),Error(s(31,m==="[object Object]"?"object with keys {"+Object.keys(g).join(", ")+"}":m)))}function S5(m){function g(nt,Xe){if(m){var lt=nt.deletions;lt===null?(nt.deletions=[Xe],nt.flags|=16):lt.push(Xe)}}function v(nt,Xe){if(!m)return null;for(;Xe!==null;)g(nt,Xe),Xe=Xe.sibling;return null}function C(nt){for(var Xe=new Map;nt!==null;)nt.key!==null?Xe.set(nt.key,nt):Xe.set(nt.index,nt),nt=nt.sibling;return Xe}function O(nt,Xe){return nt=tl(nt,Xe),nt.index=0,nt.sibling=null,nt}function R(nt,Xe,lt){return nt.index=lt,m?(lt=nt.alternate,lt!==null?(lt=lt.index,lt<Xe?(nt.flags|=67108866,Xe):lt):(nt.flags|=67108866,Xe)):(nt.flags|=1048576,Xe)}function ae(nt){return m&&nt.alternate===null&&(nt.flags|=67108866),nt}function Se(nt,Xe,lt,vt){return Xe===null||Xe.tag!==6?(Xe=fC(lt,nt.mode,vt),Xe.return=nt,Xe):(Xe=O(Xe,lt),Xe.return=nt,Xe)}function Ye(nt,Xe,lt,vt){var Xt=lt.type;return Xt===j?pt(nt,Xe,lt.props.children,vt,lt.key):Xe!==null&&(Xe.elementType===Xt||typeof Xt=="object"&&Xt!==null&&Xt.$$typeof===E&&Ud(Xt)===Xe.type)?(Xe=O(Xe,lt.props),Bh(Xe,lt),Xe.return=nt,Xe):(Xe=F0(lt.type,lt.key,lt.props,null,nt.mode,vt),Bh(Xe,lt),Xe.return=nt,Xe)}function ct(nt,Xe,lt,vt){return Xe===null||Xe.tag!==4||Xe.stateNode.containerInfo!==lt.containerInfo||Xe.stateNode.implementation!==lt.implementation?(Xe=hC(lt,nt.mode,vt),Xe.return=nt,Xe):(Xe=O(Xe,lt.children||[]),Xe.return=nt,Xe)}function pt(nt,Xe,lt,vt,Xt){return Xe===null||Xe.tag!==7?(Xe=Id(lt,nt.mode,vt,Xt),Xe.return=nt,Xe):(Xe=O(Xe,lt),Xe.return=nt,Xe)}function Nt(nt,Xe,lt){if(typeof Xe=="string"&&Xe!==""||typeof Xe=="number"||typeof Xe=="bigint")return Xe=fC(""+Xe,nt.mode,lt),Xe.return=nt,Xe;if(typeof Xe=="object"&&Xe!==null){switch(Xe.$$typeof){case x:return lt=F0(Xe.type,Xe.key,Xe.props,null,nt.mode,lt),Bh(lt,Xe),lt.return=nt,lt;case b:return Xe=hC(Xe,nt.mode,lt),Xe.return=nt,Xe;case E:return Xe=Ud(Xe),Nt(nt,Xe,lt)}if($(Xe)||P(Xe))return Xe=Id(Xe,nt.mode,lt,null),Xe.return=nt,Xe;if(typeof Xe.then=="function")return Nt(nt,V0(Xe),lt);if(Xe.$$typeof===S)return Nt(nt,H0(nt,Xe),lt);Y0(nt,Xe)}return null}function ut(nt,Xe,lt,vt){var Xt=Xe!==null?Xe.key:null;if(typeof lt=="string"&&lt!==""||typeof lt=="number"||typeof lt=="bigint")return Xt!==null?null:Se(nt,Xe,""+lt,vt);if(typeof lt=="object"&&lt!==null){switch(lt.$$typeof){case x:return lt.key===Xt?Ye(nt,Xe,lt,vt):null;case b:return lt.key===Xt?ct(nt,Xe,lt,vt):null;case E:return lt=Ud(lt),ut(nt,Xe,lt,vt)}if($(lt)||P(lt))return Xt!==null?null:pt(nt,Xe,lt,vt,null);if(typeof lt.then=="function")return ut(nt,Xe,V0(lt),vt);if(lt.$$typeof===S)return ut(nt,Xe,H0(nt,lt),vt);Y0(nt,lt)}return null}function gt(nt,Xe,lt,vt,Xt){if(typeof vt=="string"&&vt!==""||typeof vt=="number"||typeof vt=="bigint")return nt=nt.get(lt)||null,Se(Xe,nt,""+vt,Xt);if(typeof vt=="object"&&vt!==null){switch(vt.$$typeof){case x:return nt=nt.get(vt.key===null?lt:vt.key)||null,Ye(Xe,nt,vt,Xt);case b:return nt=nt.get(vt.key===null?lt:vt.key)||null,ct(Xe,nt,vt,Xt);case E:return vt=Ud(vt),gt(nt,Xe,lt,vt,Xt)}if($(vt)||P(vt))return nt=nt.get(lt)||null,pt(Xe,nt,vt,Xt,null);if(typeof vt.then=="function")return gt(nt,Xe,lt,V0(vt),Xt);if(vt.$$typeof===S)return gt(nt,Xe,lt,H0(Xe,vt),Xt);Y0(Xe,vt)}return null}function Ft(nt,Xe,lt,vt){for(var Xt=null,Ca=null,Wt=Xe,ua=Xe=0,xa=null;Wt!==null&&ua<lt.length;ua++){Wt.index>ua?(xa=Wt,Wt=null):xa=Wt.sibling;var Sa=ut(nt,Wt,lt[ua],vt);if(Sa===null){Wt===null&&(Wt=xa);break}m&&Wt&&Sa.alternate===null&&g(nt,Wt),Xe=R(Sa,Xe,ua),Ca===null?Xt=Sa:Ca.sibling=Sa,Ca=Sa,Wt=xa}if(ua===lt.length)return v(nt,Wt),ba&&al(nt,ua),Xt;if(Wt===null){for(;ua<lt.length;ua++)Wt=Nt(nt,lt[ua],vt),Wt!==null&&(Xe=R(Wt,Xe,ua),Ca===null?Xt=Wt:Ca.sibling=Wt,Ca=Wt);return ba&&al(nt,ua),Xt}for(Wt=C(Wt);ua<lt.length;ua++)xa=gt(Wt,nt,ua,lt[ua],vt),xa!==null&&(m&&xa.alternate!==null&&Wt.delete(xa.key===null?ua:xa.key),Xe=R(xa,Xe,ua),Ca===null?Xt=xa:Ca.sibling=xa,Ca=xa);return m&&Wt.forEach(function($c){return g(nt,$c)}),ba&&al(nt,ua),Xt}function Jt(nt,Xe,lt,vt){if(lt==null)throw Error(s(151));for(var Xt=null,Ca=null,Wt=Xe,ua=Xe=0,xa=null,Sa=lt.next();Wt!==null&&!Sa.done;ua++,Sa=lt.next()){Wt.index>ua?(xa=Wt,Wt=null):xa=Wt.sibling;var $c=ut(nt,Wt,Sa.value,vt);if($c===null){Wt===null&&(Wt=xa);break}m&&Wt&&$c.alternate===null&&g(nt,Wt),Xe=R($c,Xe,ua),Ca===null?Xt=$c:Ca.sibling=$c,Ca=$c,Wt=xa}if(Sa.done)return v(nt,Wt),ba&&al(nt,ua),Xt;if(Wt===null){for(;!Sa.done;ua++,Sa=lt.next())Sa=Nt(nt,Sa.value,vt),Sa!==null&&(Xe=R(Sa,Xe,ua),Ca===null?Xt=Sa:Ca.sibling=Sa,Ca=Sa);return ba&&al(nt,ua),Xt}for(Wt=C(Wt);!Sa.done;ua++,Sa=lt.next())Sa=gt(Wt,nt,ua,Sa.value,vt),Sa!==null&&(m&&Sa.alternate!==null&&Wt.delete(Sa.key===null?ua:Sa.key),Xe=R(Sa,Xe,ua),Ca===null?Xt=Sa:Ca.sibling=Sa,Ca=Sa);return m&&Wt.forEach(function(Gae){return g(nt,Gae)}),ba&&al(nt,ua),Xt}function Ha(nt,Xe,lt,vt){if(typeof lt=="object"&&lt!==null&&lt.type===j&&lt.key===null&&(lt=lt.props.children),typeof lt=="object"&&lt!==null){switch(lt.$$typeof){case x:e:{for(var Xt=lt.key;Xe!==null;){if(Xe.key===Xt){if(Xt=lt.type,Xt===j){if(Xe.tag===7){v(nt,Xe.sibling),vt=O(Xe,lt.props.children),vt.return=nt,nt=vt;break e}}else if(Xe.elementType===Xt||typeof Xt=="object"&&Xt!==null&&Xt.$$typeof===E&&Ud(Xt)===Xe.type){v(nt,Xe.sibling),vt=O(Xe,lt.props),Bh(vt,lt),vt.return=nt,nt=vt;break e}v(nt,Xe);break}else g(nt,Xe);Xe=Xe.sibling}lt.type===j?(vt=Id(lt.props.children,nt.mode,vt,lt.key),vt.return=nt,nt=vt):(vt=F0(lt.type,lt.key,lt.props,null,nt.mode,vt),Bh(vt,lt),vt.return=nt,nt=vt)}return ae(nt);case b:e:{for(Xt=lt.key;Xe!==null;){if(Xe.key===Xt)if(Xe.tag===4&&Xe.stateNode.containerInfo===lt.containerInfo&&Xe.stateNode.implementation===lt.implementation){v(nt,Xe.sibling),vt=O(Xe,lt.children||[]),vt.return=nt,nt=vt;break e}else{v(nt,Xe);break}else g(nt,Xe);Xe=Xe.sibling}vt=hC(lt,nt.mode,vt),vt.return=nt,nt=vt}return ae(nt);case E:return lt=Ud(lt),Ha(nt,Xe,lt,vt)}if($(lt))return Ft(nt,Xe,lt,vt);if(P(lt)){if(Xt=P(lt),typeof Xt!="function")throw Error(s(150));return lt=Xt.call(lt),Jt(nt,Xe,lt,vt)}if(typeof lt.then=="function")return Ha(nt,Xe,V0(lt),vt);if(lt.$$typeof===S)return Ha(nt,Xe,H0(nt,lt),vt);Y0(nt,lt)}return typeof lt=="string"&&lt!==""||typeof lt=="number"||typeof lt=="bigint"?(lt=""+lt,Xe!==null&&Xe.tag===6?(v(nt,Xe.sibling),vt=O(Xe,lt),vt.return=nt,nt=vt):(v(nt,Xe),vt=fC(lt,nt.mode,vt),vt.return=nt,nt=vt),ae(nt)):v(nt,Xe)}return function(nt,Xe,lt,vt){try{Uh=0;var Xt=Ha(nt,Xe,lt,vt);return Lm=null,Xt}catch(Wt){if(Wt===Em||Wt===G0)throw Wt;var Ca=Tr(29,Wt,null,nt.mode);return Ca.lanes=vt,Ca.return=nt,Ca}}}var Hd=S5(!0),_5=S5(!1),vc=!1;function _C(m){m.updateQueue={baseState:m.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function AC(m,g){m=m.updateQueue,g.updateQueue===m&&(g.updateQueue={baseState:m.baseState,firstBaseUpdate:m.firstBaseUpdate,lastBaseUpdate:m.lastBaseUpdate,shared:m.shared,callbacks:null})}function wc(m){return{lane:m,tag:0,payload:null,callback:null,next:null}}function jc(m,g,v){var C=m.updateQueue;if(C===null)return null;if(C=C.shared,(Ta&2)!==0){var O=C.pending;return O===null?g.next=g:(g.next=O.next,O.next=g),C.pending=g,g=z0(m),c5(m,null,v),g}return R0(m,C,g,v),z0(m)}function Hh(m,g,v){if(g=g.updateQueue,g!==null&&(g=g.shared,(v&4194048)!==0)){var C=g.lanes;C&=m.pendingLanes,v|=C,g.lanes=v,U(m,v)}}function TC(m,g){var v=m.updateQueue,C=m.alternate;if(C!==null&&(C=C.updateQueue,v===C)){var O=null,R=null;if(v=v.firstBaseUpdate,v!==null){do{var ae={lane:v.lane,tag:v.tag,payload:v.payload,callback:null,next:null};R===null?O=R=ae:R=R.next=ae,v=v.next}while(v!==null);R===null?O=R=g:R=R.next=g}else O=R=g;v={baseState:C.baseState,firstBaseUpdate:O,lastBaseUpdate:R,shared:C.shared,callbacks:C.callbacks},m.updateQueue=v;return}m=v.lastBaseUpdate,m===null?v.firstBaseUpdate=g:m.next=g,v.lastBaseUpdate=g}var kC=!1;function qh(){if(kC){var m=km;if(m!==null)throw m}}function Gh(m,g,v,C){kC=!1;var O=m.updateQueue;vc=!1;var R=O.firstBaseUpdate,ae=O.lastBaseUpdate,Se=O.shared.pending;if(Se!==null){O.shared.pending=null;var Ye=Se,ct=Ye.next;Ye.next=null,ae===null?R=ct:ae.next=ct,ae=Ye;var pt=m.alternate;pt!==null&&(pt=pt.updateQueue,Se=pt.lastBaseUpdate,Se!==ae&&(Se===null?pt.firstBaseUpdate=ct:Se.next=ct,pt.lastBaseUpdate=Ye))}if(R!==null){var Nt=O.baseState;ae=0,pt=ct=Ye=null,Se=R;do{var ut=Se.lane&-536870913,gt=ut!==Se.lane;if(gt?(pa&ut)===ut:(C&ut)===ut){ut!==0&&ut===Tm&&(kC=!0),pt!==null&&(pt=pt.next={lane:0,tag:Se.tag,payload:Se.payload,callback:null,next:null});e:{var Ft=m,Jt=Se;ut=g;var Ha=v;switch(Jt.tag){case 1:if(Ft=Jt.payload,typeof Ft=="function"){Nt=Ft.call(Ha,Nt,ut);break e}Nt=Ft;break e;case 3:Ft.flags=Ft.flags&-65537|128;case 0:if(Ft=Jt.payload,ut=typeof Ft=="function"?Ft.call(Ha,Nt,ut):Ft,ut==null)break e;Nt=h({},Nt,ut);break e;case 2:vc=!0}}ut=Se.callback,ut!==null&&(m.flags|=64,gt&&(m.flags|=8192),gt=O.callbacks,gt===null?O.callbacks=[ut]:gt.push(ut))}else gt={lane:ut,tag:Se.tag,payload:Se.payload,callback:Se.callback,next:null},pt===null?(ct=pt=gt,Ye=Nt):pt=pt.next=gt,ae|=ut;if(Se=Se.next,Se===null){if(Se=O.shared.pending,Se===null)break;gt=Se,Se=gt.next,gt.next=null,O.lastBaseUpdate=gt,O.shared.pending=null}}while(!0);pt===null&&(Ye=Nt),O.baseState=Ye,O.firstBaseUpdate=ct,O.lastBaseUpdate=pt,R===null&&(O.shared.lanes=0),Ac|=ae,m.lanes=ae,m.memoizedState=Nt}}function A5(m,g){if(typeof m!="function")throw Error(s(191,m));m.call(g)}function T5(m,g){var v=m.callbacks;if(v!==null)for(m.callbacks=null,m=0;m<v.length;m++)A5(v[m],g)}var Dm=J(null),Q0=J(0);function k5(m,g){m=fl,ye(Q0,m),ye(Dm,g),fl=m|g.baseLanes}function EC(){ye(Q0,fl),ye(Dm,Dm.current)}function LC(){fl=Q0.current,se(Dm),se(Q0)}var kr=J(null),ni=null;function Nc(m){var g=m.alternate;ye(Ln,Ln.current&1),ye(kr,m),ni===null&&(g===null||Dm.current!==null||g.memoizedState!==null)&&(ni=m)}function DC(m){ye(Ln,Ln.current),ye(kr,m),ni===null&&(ni=m)}function E5(m){m.tag===22?(ye(Ln,Ln.current),ye(kr,m),ni===null&&(ni=m)):Cc()}function Cc(){ye(Ln,Ln.current),ye(kr,kr.current)}function Er(m){se(kr),ni===m&&(ni=null),se(Ln)}var Ln=J(0);function K0(m){for(var g=m;g!==null;){if(g.tag===13){var v=g.memoizedState;if(v!==null&&(v=v.dehydrated,v===null||RS(v)||zS(v)))return g}else if(g.tag===19&&(g.memoizedProps.revealOrder==="forwards"||g.memoizedProps.revealOrder==="backwards"||g.memoizedProps.revealOrder==="unstable_legacy-backwards"||g.memoizedProps.revealOrder==="together")){if((g.flags&128)!==0)return g}else if(g.child!==null){g.child.return=g,g=g.child;continue}if(g===m)break;for(;g.sibling===null;){if(g.return===null||g.return===m)return null;g=g.return}g.sibling.return=g.return,g=g.sibling}return null}var rl=0,oa=null,Ua=null,zn=null,X0=!1,Pm=!1,qd=!1,Z0=0,Wh=0,Om=null,Mte=0;function vn(){throw Error(s(321))}function PC(m,g){if(g===null)return!1;for(var v=0;v<g.length&&v<m.length;v++)if(!Ar(m[v],g[v]))return!1;return!0}function OC(m,g,v,C,O,R){return rl=R,oa=g,g.memoizedState=null,g.updateQueue=null,g.lanes=0,W.H=m===null||m.memoizedState===null?fO:QC,qd=!1,R=v(C,O),qd=!1,Pm&&(R=D5(g,v,C,O)),L5(m),R}function L5(m){W.H=Qh;var g=Ua!==null&&Ua.next!==null;if(rl=0,zn=Ua=oa=null,X0=!1,Wh=0,Om=null,g)throw Error(s(300));m===null||Fn||(m=m.dependencies,m!==null&&B0(m)&&(Fn=!0))}function D5(m,g,v,C){oa=m;var O=0;do{if(Pm&&(Om=null),Wh=0,Pm=!1,25<=O)throw Error(s(301));if(O+=1,zn=Ua=null,m.updateQueue!=null){var R=m.updateQueue;R.lastEffect=null,R.events=null,R.stores=null,R.memoCache!=null&&(R.memoCache.index=0)}W.H=hO,R=g(v,C)}while(Pm);return R}function Ite(){var m=W.H,g=m.useState()[0];return g=typeof g.then=="function"?Vh(g):g,m=m.useState()[0],(Ua!==null?Ua.memoizedState:null)!==m&&(oa.flags|=1024),g}function MC(){var m=Z0!==0;return Z0=0,m}function IC(m,g,v){g.updateQueue=m.updateQueue,g.flags&=-2053,m.lanes&=~v}function $C(m){if(X0){for(m=m.memoizedState;m!==null;){var g=m.queue;g!==null&&(g.pending=null),m=m.next}X0=!1}rl=0,zn=Ua=oa=null,Pm=!1,Wh=Z0=0,Om=null}function qs(){var m={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return zn===null?oa.memoizedState=zn=m:zn=zn.next=m,zn}function Dn(){if(Ua===null){var m=oa.alternate;m=m!==null?m.memoizedState:null}else m=Ua.next;var g=zn===null?oa.memoizedState:zn.next;if(g!==null)zn=g,Ua=m;else{if(m===null)throw oa.alternate===null?Error(s(467)):Error(s(310));Ua=m,m={memoizedState:Ua.memoizedState,baseState:Ua.baseState,baseQueue:Ua.baseQueue,queue:Ua.queue,next:null},zn===null?oa.memoizedState=zn=m:zn=zn.next=m}return zn}function J0(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Vh(m){var g=Wh;return Wh+=1,Om===null&&(Om=[]),m=j5(Om,m,g),g=oa,(zn===null?g.memoizedState:zn.next)===null&&(g=g.alternate,W.H=g===null||g.memoizedState===null?fO:QC),m}function ey(m){if(m!==null&&typeof m=="object"){if(typeof m.then=="function")return Vh(m);if(m.$$typeof===S)return Cs(m)}throw Error(s(438,String(m)))}function RC(m){var g=null,v=oa.updateQueue;if(v!==null&&(g=v.memoCache),g==null){var C=oa.alternate;C!==null&&(C=C.updateQueue,C!==null&&(C=C.memoCache,C!=null&&(g={data:C.data.map(function(O){return O.slice()}),index:0})))}if(g==null&&(g={data:[],index:0}),v===null&&(v=J0(),oa.updateQueue=v),v.memoCache=g,v=g.data[g.index],v===void 0)for(v=g.data[g.index]=Array(m),C=0;C<m;C++)v[C]=F;return g.index++,v}function il(m,g){return typeof g=="function"?g(m):g}function ty(m){var g=Dn();return zC(g,Ua,m)}function zC(m,g,v){var C=m.queue;if(C===null)throw Error(s(311));C.lastRenderedReducer=v;var O=m.baseQueue,R=C.pending;if(R!==null){if(O!==null){var ae=O.next;O.next=R.next,R.next=ae}g.baseQueue=O=R,C.pending=null}if(R=m.baseState,O===null)m.memoizedState=R;else{g=O.next;var Se=ae=null,Ye=null,ct=g,pt=!1;do{var Nt=ct.lane&-536870913;if(Nt!==ct.lane?(pa&Nt)===Nt:(rl&Nt)===Nt){var ut=ct.revertLane;if(ut===0)Ye!==null&&(Ye=Ye.next={lane:0,revertLane:0,gesture:null,action:ct.action,hasEagerState:ct.hasEagerState,eagerState:ct.eagerState,next:null}),Nt===Tm&&(pt=!0);else if((rl&ut)===ut){ct=ct.next,ut===Tm&&(pt=!0);continue}else Nt={lane:0,revertLane:ct.revertLane,gesture:null,action:ct.action,hasEagerState:ct.hasEagerState,eagerState:ct.eagerState,next:null},Ye===null?(Se=Ye=Nt,ae=R):Ye=Ye.next=Nt,oa.lanes|=ut,Ac|=ut;Nt=ct.action,qd&&v(R,Nt),R=ct.hasEagerState?ct.eagerState:v(R,Nt)}else ut={lane:Nt,revertLane:ct.revertLane,gesture:ct.gesture,action:ct.action,hasEagerState:ct.hasEagerState,eagerState:ct.eagerState,next:null},Ye===null?(Se=Ye=ut,ae=R):Ye=Ye.next=ut,oa.lanes|=Nt,Ac|=Nt;ct=ct.next}while(ct!==null&&ct!==g);if(Ye===null?ae=R:Ye.next=Se,!Ar(R,m.memoizedState)&&(Fn=!0,pt&&(v=km,v!==null)))throw v;m.memoizedState=R,m.baseState=ae,m.baseQueue=Ye,C.lastRenderedState=R}return O===null&&(C.lanes=0),[m.memoizedState,C.dispatch]}function FC(m){var g=Dn(),v=g.queue;if(v===null)throw Error(s(311));v.lastRenderedReducer=m;var C=v.dispatch,O=v.pending,R=g.memoizedState;if(O!==null){v.pending=null;var ae=O=O.next;do R=m(R,ae.action),ae=ae.next;while(ae!==O);Ar(R,g.memoizedState)||(Fn=!0),g.memoizedState=R,g.baseQueue===null&&(g.baseState=R),v.lastRenderedState=R}return[R,C]}function P5(m,g,v){var C=oa,O=Dn(),R=ba;if(R){if(v===void 0)throw Error(s(407));v=v()}else v=g();var ae=!Ar((Ua||O).memoizedState,v);if(ae&&(O.memoizedState=v,Fn=!0),O=O.queue,HC(I5.bind(null,C,O,m),[m]),O.getSnapshot!==g||ae||zn!==null&&zn.memoizedState.tag&1){if(C.flags|=2048,Mm(9,{destroy:void 0},M5.bind(null,C,O,v,g),null),Wa===null)throw Error(s(349));R||(rl&127)!==0||O5(C,g,v)}return v}function O5(m,g,v){m.flags|=16384,m={getSnapshot:g,value:v},g=oa.updateQueue,g===null?(g=J0(),oa.updateQueue=g,g.stores=[m]):(v=g.stores,v===null?g.stores=[m]:v.push(m))}function M5(m,g,v,C){g.value=v,g.getSnapshot=C,$5(g)&&R5(m)}function I5(m,g,v){return v(function(){$5(g)&&R5(m)})}function $5(m){var g=m.getSnapshot;m=m.value;try{var v=g();return!Ar(m,v)}catch{return!0}}function R5(m){var g=Md(m,2);g!==null&&rr(g,m,2)}function UC(m){var g=qs();if(typeof m=="function"){var v=m;if(m=v(),qd){Qe(!0);try{v()}finally{Qe(!1)}}}return g.memoizedState=g.baseState=m,g.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:il,lastRenderedState:m},g}function z5(m,g,v,C){return m.baseState=v,zC(m,Ua,typeof C=="function"?C:il)}function $te(m,g,v,C,O){if(sy(m))throw Error(s(485));if(m=g.action,m!==null){var R={payload:O,action:m,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(ae){R.listeners.push(ae)}};W.T!==null?v(!0):R.isTransition=!1,C(R),v=g.pending,v===null?(R.next=g.pending=R,F5(g,R)):(R.next=v.next,g.pending=v.next=R)}}function F5(m,g){var v=g.action,C=g.payload,O=m.state;if(g.isTransition){var R=W.T,ae={};W.T=ae;try{var Se=v(O,C),Ye=W.S;Ye!==null&&Ye(ae,Se),U5(m,g,Se)}catch(ct){BC(m,g,ct)}finally{R!==null&&ae.types!==null&&(R.types=ae.types),W.T=R}}else try{R=v(O,C),U5(m,g,R)}catch(ct){BC(m,g,ct)}}function U5(m,g,v){v!==null&&typeof v=="object"&&typeof v.then=="function"?v.then(function(C){B5(m,g,C)},function(C){return BC(m,g,C)}):B5(m,g,v)}function B5(m,g,v){g.status="fulfilled",g.value=v,H5(g),m.state=v,g=m.pending,g!==null&&(v=g.next,v===g?m.pending=null:(v=v.next,g.next=v,F5(m,v)))}function BC(m,g,v){var C=m.pending;if(m.pending=null,C!==null){C=C.next;do g.status="rejected",g.reason=v,H5(g),g=g.next;while(g!==C)}m.action=null}function H5(m){m=m.listeners;for(var g=0;g<m.length;g++)(0,m[g])()}function q5(m,g){return g}function G5(m,g){if(ba){var v=Wa.formState;if(v!==null){e:{var C=oa;if(ba){if(en){t:{for(var O=en,R=ai;O.nodeType!==8;){if(!R){O=null;break t}if(O=si(O.nextSibling),O===null){O=null;break t}}R=O.data,O=R==="F!"||R==="F"?O:null}if(O){en=si(O.nextSibling),C=O.data==="F!";break e}}yc(C)}C=!1}C&&(g=v[0])}}return v=qs(),v.memoizedState=v.baseState=g,C={pending:null,lanes:0,dispatch:null,lastRenderedReducer:q5,lastRenderedState:g},v.queue=C,v=dO.bind(null,oa,C),C.dispatch=v,C=UC(!1),R=YC.bind(null,oa,!1,C.queue),C=qs(),O={state:g,dispatch:null,action:m,pending:null},C.queue=O,v=$te.bind(null,oa,O,R,v),O.dispatch=v,C.memoizedState=m,[g,v,!1]}function W5(m){var g=Dn();return V5(g,Ua,m)}function V5(m,g,v){if(g=zC(m,g,q5)[0],m=ty(il)[0],typeof g=="object"&&g!==null&&typeof g.then=="function")try{var C=Vh(g)}catch(ae){throw ae===Em?G0:ae}else C=g;g=Dn();var O=g.queue,R=O.dispatch;return v!==g.memoizedState&&(oa.flags|=2048,Mm(9,{destroy:void 0},Rte.bind(null,O,v),null)),[C,R,m]}function Rte(m,g){m.action=g}function Y5(m){var g=Dn(),v=Ua;if(v!==null)return V5(g,v,m);Dn(),g=g.memoizedState,v=Dn();var C=v.queue.dispatch;return v.memoizedState=m,[g,C,!1]}function Mm(m,g,v,C){return m={tag:m,create:v,deps:C,inst:g,next:null},g=oa.updateQueue,g===null&&(g=J0(),oa.updateQueue=g),v=g.lastEffect,v===null?g.lastEffect=m.next=m:(C=v.next,v.next=m,m.next=C,g.lastEffect=m),m}function Q5(){return Dn().memoizedState}function ay(m,g,v,C){var O=qs();oa.flags|=m,O.memoizedState=Mm(1|g,{destroy:void 0},v,C===void 0?null:C)}function ny(m,g,v,C){var O=Dn();C=C===void 0?null:C;var R=O.memoizedState.inst;Ua!==null&&C!==null&&PC(C,Ua.memoizedState.deps)?O.memoizedState=Mm(g,R,v,C):(oa.flags|=m,O.memoizedState=Mm(1|g,R,v,C))}function K5(m,g){ay(8390656,8,m,g)}function HC(m,g){ny(2048,8,m,g)}function zte(m){oa.flags|=4;var g=oa.updateQueue;if(g===null)g=J0(),oa.updateQueue=g,g.events=[m];else{var v=g.events;v===null?g.events=[m]:v.push(m)}}function X5(m){var g=Dn().memoizedState;return zte({ref:g,nextImpl:m}),function(){if((Ta&2)!==0)throw Error(s(440));return g.impl.apply(void 0,arguments)}}function Z5(m,g){return ny(4,2,m,g)}function J5(m,g){return ny(4,4,m,g)}function eO(m,g){if(typeof g=="function"){m=m();var v=g(m);return function(){typeof v=="function"?v():g(null)}}if(g!=null)return m=m(),g.current=m,function(){g.current=null}}function tO(m,g,v){v=v!=null?v.concat([m]):null,ny(4,4,eO.bind(null,g,m),v)}function qC(){}function aO(m,g){var v=Dn();g=g===void 0?null:g;var C=v.memoizedState;return g!==null&&PC(g,C[1])?C[0]:(v.memoizedState=[m,g],m)}function nO(m,g){var v=Dn();g=g===void 0?null:g;var C=v.memoizedState;if(g!==null&&PC(g,C[1]))return C[0];if(C=m(),qd){Qe(!0);try{m()}finally{Qe(!1)}}return v.memoizedState=[C,g],C}function GC(m,g,v){return v===void 0||(rl&1073741824)!==0&&(pa&261930)===0?m.memoizedState=g:(m.memoizedState=v,m=sM(),oa.lanes|=m,Ac|=m,v)}function sO(m,g,v,C){return Ar(v,g)?v:Dm.current!==null?(m=GC(m,v,C),Ar(m,g)||(Fn=!0),m):(rl&42)===0||(rl&1073741824)!==0&&(pa&261930)===0?(Fn=!0,m.memoizedState=v):(m=sM(),oa.lanes|=m,Ac|=m,g)}function rO(m,g,v,C,O){var R=Z.p;Z.p=R!==0&&8>R?R:8;var ae=W.T,Se={};W.T=Se,YC(m,!1,g,v);try{var Ye=O(),ct=W.S;if(ct!==null&&ct(Se,Ye),Ye!==null&&typeof Ye=="object"&&typeof Ye.then=="function"){var pt=Ote(Ye,C);Yh(m,g,pt,Pr(m))}else Yh(m,g,C,Pr(m))}catch(Nt){Yh(m,g,{then:function(){},status:"rejected",reason:Nt},Pr())}finally{Z.p=R,ae!==null&&Se.types!==null&&(ae.types=Se.types),W.T=ae}}function Fte(){}function WC(m,g,v,C){if(m.tag!==5)throw Error(s(476));var O=iO(m).queue;rO(m,O,g,Q,v===null?Fte:function(){return oO(m),v(C)})}function iO(m){var g=m.memoizedState;if(g!==null)return g;g={memoizedState:Q,baseState:Q,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:il,lastRenderedState:Q},next:null};var v={};return g.next={memoizedState:v,baseState:v,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:il,lastRenderedState:v},next:null},m.memoizedState=g,m=m.alternate,m!==null&&(m.memoizedState=g),g}function oO(m){var g=iO(m);g.next===null&&(g=m.alternate.memoizedState),Yh(m,g.next.queue,{},Pr())}function VC(){return Cs(ug)}function lO(){return Dn().memoizedState}function cO(){return Dn().memoizedState}function Ute(m){for(var g=m.return;g!==null;){switch(g.tag){case 24:case 3:var v=Pr();m=wc(v);var C=jc(g,m,v);C!==null&&(rr(C,g,v),Hh(C,g,v)),g={cache:jC()},m.payload=g;return}g=g.return}}function Bte(m,g,v){var C=Pr();v={lane:C,revertLane:0,gesture:null,action:v,hasEagerState:!1,eagerState:null,next:null},sy(m)?uO(g,v):(v=uC(m,g,v,C),v!==null&&(rr(v,m,C),mO(v,g,C)))}function dO(m,g,v){var C=Pr();Yh(m,g,v,C)}function Yh(m,g,v,C){var O={lane:C,revertLane:0,gesture:null,action:v,hasEagerState:!1,eagerState:null,next:null};if(sy(m))uO(g,O);else{var R=m.alternate;if(m.lanes===0&&(R===null||R.lanes===0)&&(R=g.lastRenderedReducer,R!==null))try{var ae=g.lastRenderedState,Se=R(ae,v);if(O.hasEagerState=!0,O.eagerState=Se,Ar(Se,ae))return R0(m,g,O,0),Wa===null&&$0(),!1}catch{}if(v=uC(m,g,O,C),v!==null)return rr(v,m,C),mO(v,g,C),!0}return!1}function YC(m,g,v,C){if(C={lane:2,revertLane:_S(),gesture:null,action:C,hasEagerState:!1,eagerState:null,next:null},sy(m)){if(g)throw Error(s(479))}else g=uC(m,v,C,2),g!==null&&rr(g,m,2)}function sy(m){var g=m.alternate;return m===oa||g!==null&&g===oa}function uO(m,g){Pm=X0=!0;var v=m.pending;v===null?g.next=g:(g.next=v.next,v.next=g),m.pending=g}function mO(m,g,v){if((v&4194048)!==0){var C=g.lanes;C&=m.pendingLanes,v|=C,g.lanes=v,U(m,v)}}var Qh={readContext:Cs,use:ey,useCallback:vn,useContext:vn,useEffect:vn,useImperativeHandle:vn,useLayoutEffect:vn,useInsertionEffect:vn,useMemo:vn,useReducer:vn,useRef:vn,useState:vn,useDebugValue:vn,useDeferredValue:vn,useTransition:vn,useSyncExternalStore:vn,useId:vn,useHostTransitionStatus:vn,useFormState:vn,useActionState:vn,useOptimistic:vn,useMemoCache:vn,useCacheRefresh:vn};Qh.useEffectEvent=vn;var fO={readContext:Cs,use:ey,useCallback:function(m,g){return qs().memoizedState=[m,g===void 0?null:g],m},useContext:Cs,useEffect:K5,useImperativeHandle:function(m,g,v){v=v!=null?v.concat([m]):null,ay(4194308,4,eO.bind(null,g,m),v)},useLayoutEffect:function(m,g){return ay(4194308,4,m,g)},useInsertionEffect:function(m,g){ay(4,2,m,g)},useMemo:function(m,g){var v=qs();g=g===void 0?null:g;var C=m();if(qd){Qe(!0);try{m()}finally{Qe(!1)}}return v.memoizedState=[C,g],C},useReducer:function(m,g,v){var C=qs();if(v!==void 0){var O=v(g);if(qd){Qe(!0);try{v(g)}finally{Qe(!1)}}}else O=g;return C.memoizedState=C.baseState=O,m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:m,lastRenderedState:O},C.queue=m,m=m.dispatch=Bte.bind(null,oa,m),[C.memoizedState,m]},useRef:function(m){var g=qs();return m={current:m},g.memoizedState=m},useState:function(m){m=UC(m);var g=m.queue,v=dO.bind(null,oa,g);return g.dispatch=v,[m.memoizedState,v]},useDebugValue:qC,useDeferredValue:function(m,g){var v=qs();return GC(v,m,g)},useTransition:function(){var m=UC(!1);return m=rO.bind(null,oa,m.queue,!0,!1),qs().memoizedState=m,[!1,m]},useSyncExternalStore:function(m,g,v){var C=oa,O=qs();if(ba){if(v===void 0)throw Error(s(407));v=v()}else{if(v=g(),Wa===null)throw Error(s(349));(pa&127)!==0||O5(C,g,v)}O.memoizedState=v;var R={value:v,getSnapshot:g};return O.queue=R,K5(I5.bind(null,C,R,m),[m]),C.flags|=2048,Mm(9,{destroy:void 0},M5.bind(null,C,R,v,g),null),v},useId:function(){var m=qs(),g=Wa.identifierPrefix;if(ba){var v=io,C=ro;v=(C&~(1<<32-tt(C)-1)).toString(32)+v,g="_"+g+"R_"+v,v=Z0++,0<v&&(g+="H"+v.toString(32)),g+="_"}else v=Mte++,g="_"+g+"r_"+v.toString(32)+"_";return m.memoizedState=g},useHostTransitionStatus:VC,useFormState:G5,useActionState:G5,useOptimistic:function(m){var g=qs();g.memoizedState=g.baseState=m;var v={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return g.queue=v,g=YC.bind(null,oa,!0,v),v.dispatch=g,[m,g]},useMemoCache:RC,useCacheRefresh:function(){return qs().memoizedState=Ute.bind(null,oa)},useEffectEvent:function(m){var g=qs(),v={impl:m};return g.memoizedState=v,function(){if((Ta&2)!==0)throw Error(s(440));return v.impl.apply(void 0,arguments)}}},QC={readContext:Cs,use:ey,useCallback:aO,useContext:Cs,useEffect:HC,useImperativeHandle:tO,useInsertionEffect:Z5,useLayoutEffect:J5,useMemo:nO,useReducer:ty,useRef:Q5,useState:function(){return ty(il)},useDebugValue:qC,useDeferredValue:function(m,g){var v=Dn();return sO(v,Ua.memoizedState,m,g)},useTransition:function(){var m=ty(il)[0],g=Dn().memoizedState;return[typeof m=="boolean"?m:Vh(m),g]},useSyncExternalStore:P5,useId:lO,useHostTransitionStatus:VC,useFormState:W5,useActionState:W5,useOptimistic:function(m,g){var v=Dn();return z5(v,Ua,m,g)},useMemoCache:RC,useCacheRefresh:cO};QC.useEffectEvent=X5;var hO={readContext:Cs,use:ey,useCallback:aO,useContext:Cs,useEffect:HC,useImperativeHandle:tO,useInsertionEffect:Z5,useLayoutEffect:J5,useMemo:nO,useReducer:FC,useRef:Q5,useState:function(){return FC(il)},useDebugValue:qC,useDeferredValue:function(m,g){var v=Dn();return Ua===null?GC(v,m,g):sO(v,Ua.memoizedState,m,g)},useTransition:function(){var m=FC(il)[0],g=Dn().memoizedState;return[typeof m=="boolean"?m:Vh(m),g]},useSyncExternalStore:P5,useId:lO,useHostTransitionStatus:VC,useFormState:Y5,useActionState:Y5,useOptimistic:function(m,g){var v=Dn();return Ua!==null?z5(v,Ua,m,g):(v.baseState=m,[m,v.queue.dispatch])},useMemoCache:RC,useCacheRefresh:cO};hO.useEffectEvent=X5;function KC(m,g,v,C){g=m.memoizedState,v=v(C,g),v=v==null?g:h({},g,v),m.memoizedState=v,m.lanes===0&&(m.updateQueue.baseState=v)}var XC={enqueueSetState:function(m,g,v){m=m._reactInternals;var C=Pr(),O=wc(C);O.payload=g,v!=null&&(O.callback=v),g=jc(m,O,C),g!==null&&(rr(g,m,C),Hh(g,m,C))},enqueueReplaceState:function(m,g,v){m=m._reactInternals;var C=Pr(),O=wc(C);O.tag=1,O.payload=g,v!=null&&(O.callback=v),g=jc(m,O,C),g!==null&&(rr(g,m,C),Hh(g,m,C))},enqueueForceUpdate:function(m,g){m=m._reactInternals;var v=Pr(),C=wc(v);C.tag=2,g!=null&&(C.callback=g),g=jc(m,C,v),g!==null&&(rr(g,m,v),Hh(g,m,v))}};function gO(m,g,v,C,O,R,ae){return m=m.stateNode,typeof m.shouldComponentUpdate=="function"?m.shouldComponentUpdate(C,R,ae):g.prototype&&g.prototype.isPureReactComponent?!Mh(v,C)||!Mh(O,R):!0}function pO(m,g,v,C){m=g.state,typeof g.componentWillReceiveProps=="function"&&g.componentWillReceiveProps(v,C),typeof g.UNSAFE_componentWillReceiveProps=="function"&&g.UNSAFE_componentWillReceiveProps(v,C),g.state!==m&&XC.enqueueReplaceState(g,g.state,null)}function Gd(m,g){var v=g;if("ref"in g){v={};for(var C in g)C!=="ref"&&(v[C]=g[C])}if(m=m.defaultProps){v===g&&(v=h({},v));for(var O in m)v[O]===void 0&&(v[O]=m[O])}return v}function xO(m){I0(m)}function yO(m){console.error(m)}function bO(m){I0(m)}function ry(m,g){try{var v=m.onUncaughtError;v(g.value,{componentStack:g.stack})}catch(C){setTimeout(function(){throw C})}}function vO(m,g,v){try{var C=m.onCaughtError;C(v.value,{componentStack:v.stack,errorBoundary:g.tag===1?g.stateNode:null})}catch(O){setTimeout(function(){throw O})}}function ZC(m,g,v){return v=wc(v),v.tag=3,v.payload={element:null},v.callback=function(){ry(m,g)},v}function wO(m){return m=wc(m),m.tag=3,m}function jO(m,g,v,C){var O=v.type.getDerivedStateFromError;if(typeof O=="function"){var R=C.value;m.payload=function(){return O(R)},m.callback=function(){vO(g,v,C)}}var ae=v.stateNode;ae!==null&&typeof ae.componentDidCatch=="function"&&(m.callback=function(){vO(g,v,C),typeof O!="function"&&(Tc===null?Tc=new Set([this]):Tc.add(this));var Se=C.stack;this.componentDidCatch(C.value,{componentStack:Se!==null?Se:""})})}function Hte(m,g,v,C,O){if(v.flags|=32768,C!==null&&typeof C=="object"&&typeof C.then=="function"){if(g=v.alternate,g!==null&&Am(g,v,O,!0),v=kr.current,v!==null){switch(v.tag){case 31:case 13:return ni===null?xy():v.alternate===null&&wn===0&&(wn=3),v.flags&=-257,v.flags|=65536,v.lanes=O,C===W0?v.flags|=16384:(g=v.updateQueue,g===null?v.updateQueue=new Set([C]):g.add(C),NS(m,C,O)),!1;case 22:return v.flags|=65536,C===W0?v.flags|=16384:(g=v.updateQueue,g===null?(g={transitions:null,markerInstances:null,retryQueue:new Set([C])},v.updateQueue=g):(v=g.retryQueue,v===null?g.retryQueue=new Set([C]):v.add(C)),NS(m,C,O)),!1}throw Error(s(435,v.tag))}return NS(m,C,O),xy(),!1}if(ba)return g=kr.current,g!==null?((g.flags&65536)===0&&(g.flags|=256),g.flags|=65536,g.lanes=O,C!==xC&&(m=Error(s(422),{cause:C}),Rh(Jr(m,v)))):(C!==xC&&(g=Error(s(423),{cause:C}),Rh(Jr(g,v))),m=m.current.alternate,m.flags|=65536,O&=-O,m.lanes|=O,C=Jr(C,v),O=ZC(m.stateNode,C,O),TC(m,O),wn!==4&&(wn=2)),!1;var R=Error(s(520),{cause:C});if(R=Jr(R,v),ng===null?ng=[R]:ng.push(R),wn!==4&&(wn=2),g===null)return!0;C=Jr(C,v),v=g;do{switch(v.tag){case 3:return v.flags|=65536,m=O&-O,v.lanes|=m,m=ZC(v.stateNode,C,m),TC(v,m),!1;case 1:if(g=v.type,R=v.stateNode,(v.flags&128)===0&&(typeof g.getDerivedStateFromError=="function"||R!==null&&typeof R.componentDidCatch=="function"&&(Tc===null||!Tc.has(R))))return v.flags|=65536,O&=-O,v.lanes|=O,O=wO(O),jO(O,m,v,C),TC(v,O),!1}v=v.return}while(v!==null);return!1}var JC=Error(s(461)),Fn=!1;function Ss(m,g,v,C){g.child=m===null?_5(g,null,v,C):Hd(g,m.child,v,C)}function NO(m,g,v,C,O){v=v.render;var R=g.ref;if("ref"in C){var ae={};for(var Se in C)Se!=="ref"&&(ae[Se]=C[Se])}else ae=C;return zd(g),C=OC(m,g,v,ae,R,O),Se=MC(),m!==null&&!Fn?(IC(m,g,O),ol(m,g,O)):(ba&&Se&&gC(g),g.flags|=1,Ss(m,g,C,O),g.child)}function CO(m,g,v,C,O){if(m===null){var R=v.type;return typeof R=="function"&&!mC(R)&&R.defaultProps===void 0&&v.compare===null?(g.tag=15,g.type=R,SO(m,g,R,C,O)):(m=F0(v.type,null,C,g,g.mode,O),m.ref=g.ref,m.return=g,g.child=m)}if(R=m.child,!oS(m,O)){var ae=R.memoizedProps;if(v=v.compare,v=v!==null?v:Mh,v(ae,C)&&m.ref===g.ref)return ol(m,g,O)}return g.flags|=1,m=tl(R,C),m.ref=g.ref,m.return=g,g.child=m}function SO(m,g,v,C,O){if(m!==null){var R=m.memoizedProps;if(Mh(R,C)&&m.ref===g.ref)if(Fn=!1,g.pendingProps=C=R,oS(m,O))(m.flags&131072)!==0&&(Fn=!0);else return g.lanes=m.lanes,ol(m,g,O)}return eS(m,g,v,C,O)}function _O(m,g,v,C){var O=C.children,R=m!==null?m.memoizedState:null;if(m===null&&g.stateNode===null&&(g.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),C.mode==="hidden"){if((g.flags&128)!==0){if(R=R!==null?R.baseLanes|v:v,m!==null){for(C=g.child=m.child,O=0;C!==null;)O=O|C.lanes|C.childLanes,C=C.sibling;C=O&~R}else C=0,g.child=null;return AO(m,g,R,v,C)}if((v&536870912)!==0)g.memoizedState={baseLanes:0,cachePool:null},m!==null&&q0(g,R!==null?R.cachePool:null),R!==null?k5(g,R):EC(),E5(g);else return C=g.lanes=536870912,AO(m,g,R!==null?R.baseLanes|v:v,v,C)}else R!==null?(q0(g,R.cachePool),k5(g,R),Cc(),g.memoizedState=null):(m!==null&&q0(g,null),EC(),Cc());return Ss(m,g,O,v),g.child}function Kh(m,g){return m!==null&&m.tag===22||g.stateNode!==null||(g.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),g.sibling}function AO(m,g,v,C,O){var R=CC();return R=R===null?null:{parent:Rn._currentValue,pool:R},g.memoizedState={baseLanes:v,cachePool:R},m!==null&&q0(g,null),EC(),E5(g),m!==null&&Am(m,g,C,!0),g.childLanes=O,null}function iy(m,g){return g=ly({mode:g.mode,children:g.children},m.mode),g.ref=m.ref,m.child=g,g.return=m,g}function TO(m,g,v){return Hd(g,m.child,null,v),m=iy(g,g.pendingProps),m.flags|=2,Er(g),g.memoizedState=null,m}function qte(m,g,v){var C=g.pendingProps,O=(g.flags&128)!==0;if(g.flags&=-129,m===null){if(ba){if(C.mode==="hidden")return m=iy(g,C),g.lanes=536870912,Kh(null,m);if(DC(g),(m=en)?(m=FM(m,ai),m=m!==null&&m.data==="&"?m:null,m!==null&&(g.memoizedState={dehydrated:m,treeContext:pc!==null?{id:ro,overflow:io}:null,retryLane:536870912,hydrationErrors:null},v=u5(m),v.return=g,g.child=v,Ns=g,en=null)):m=null,m===null)throw yc(g);return g.lanes=536870912,null}return iy(g,C)}var R=m.memoizedState;if(R!==null){var ae=R.dehydrated;if(DC(g),O)if(g.flags&256)g.flags&=-257,g=TO(m,g,v);else if(g.memoizedState!==null)g.child=m.child,g.flags|=128,g=null;else throw Error(s(558));else if(Fn||Am(m,g,v,!1),O=(v&m.childLanes)!==0,Fn||O){if(C=Wa,C!==null&&(ae=de(C,v),ae!==0&&ae!==R.retryLane))throw R.retryLane=ae,Md(m,ae),rr(C,m,ae),JC;xy(),g=TO(m,g,v)}else m=R.treeContext,en=si(ae.nextSibling),Ns=g,ba=!0,xc=null,ai=!1,m!==null&&h5(g,m),g=iy(g,C),g.flags|=4096;return g}return m=tl(m.child,{mode:C.mode,children:C.children}),m.ref=g.ref,g.child=m,m.return=g,m}function oy(m,g){var v=g.ref;if(v===null)m!==null&&m.ref!==null&&(g.flags|=4194816);else{if(typeof v!="function"&&typeof v!="object")throw Error(s(284));(m===null||m.ref!==v)&&(g.flags|=4194816)}}function eS(m,g,v,C,O){return zd(g),v=OC(m,g,v,C,void 0,O),C=MC(),m!==null&&!Fn?(IC(m,g,O),ol(m,g,O)):(ba&&C&&gC(g),g.flags|=1,Ss(m,g,v,O),g.child)}function kO(m,g,v,C,O,R){return zd(g),g.updateQueue=null,v=D5(g,C,v,O),L5(m),C=MC(),m!==null&&!Fn?(IC(m,g,R),ol(m,g,R)):(ba&&C&&gC(g),g.flags|=1,Ss(m,g,v,R),g.child)}function EO(m,g,v,C,O){if(zd(g),g.stateNode===null){var R=Nm,ae=v.contextType;typeof ae=="object"&&ae!==null&&(R=Cs(ae)),R=new v(C,R),g.memoizedState=R.state!==null&&R.state!==void 0?R.state:null,R.updater=XC,g.stateNode=R,R._reactInternals=g,R=g.stateNode,R.props=C,R.state=g.memoizedState,R.refs={},_C(g),ae=v.contextType,R.context=typeof ae=="object"&&ae!==null?Cs(ae):Nm,R.state=g.memoizedState,ae=v.getDerivedStateFromProps,typeof ae=="function"&&(KC(g,v,ae,C),R.state=g.memoizedState),typeof v.getDerivedStateFromProps=="function"||typeof R.getSnapshotBeforeUpdate=="function"||typeof R.UNSAFE_componentWillMount!="function"&&typeof R.componentWillMount!="function"||(ae=R.state,typeof R.componentWillMount=="function"&&R.componentWillMount(),typeof R.UNSAFE_componentWillMount=="function"&&R.UNSAFE_componentWillMount(),ae!==R.state&&XC.enqueueReplaceState(R,R.state,null),Gh(g,C,R,O),qh(),R.state=g.memoizedState),typeof R.componentDidMount=="function"&&(g.flags|=4194308),C=!0}else if(m===null){R=g.stateNode;var Se=g.memoizedProps,Ye=Gd(v,Se);R.props=Ye;var ct=R.context,pt=v.contextType;ae=Nm,typeof pt=="object"&&pt!==null&&(ae=Cs(pt));var Nt=v.getDerivedStateFromProps;pt=typeof Nt=="function"||typeof R.getSnapshotBeforeUpdate=="function",Se=g.pendingProps!==Se,pt||typeof R.UNSAFE_componentWillReceiveProps!="function"&&typeof R.componentWillReceiveProps!="function"||(Se||ct!==ae)&&pO(g,R,C,ae),vc=!1;var ut=g.memoizedState;R.state=ut,Gh(g,C,R,O),qh(),ct=g.memoizedState,Se||ut!==ct||vc?(typeof Nt=="function"&&(KC(g,v,Nt,C),ct=g.memoizedState),(Ye=vc||gO(g,v,Ye,C,ut,ct,ae))?(pt||typeof R.UNSAFE_componentWillMount!="function"&&typeof R.componentWillMount!="function"||(typeof R.componentWillMount=="function"&&R.componentWillMount(),typeof R.UNSAFE_componentWillMount=="function"&&R.UNSAFE_componentWillMount()),typeof R.componentDidMount=="function"&&(g.flags|=4194308)):(typeof R.componentDidMount=="function"&&(g.flags|=4194308),g.memoizedProps=C,g.memoizedState=ct),R.props=C,R.state=ct,R.context=ae,C=Ye):(typeof R.componentDidMount=="function"&&(g.flags|=4194308),C=!1)}else{R=g.stateNode,AC(m,g),ae=g.memoizedProps,pt=Gd(v,ae),R.props=pt,Nt=g.pendingProps,ut=R.context,ct=v.contextType,Ye=Nm,typeof ct=="object"&&ct!==null&&(Ye=Cs(ct)),Se=v.getDerivedStateFromProps,(ct=typeof Se=="function"||typeof R.getSnapshotBeforeUpdate=="function")||typeof R.UNSAFE_componentWillReceiveProps!="function"&&typeof R.componentWillReceiveProps!="function"||(ae!==Nt||ut!==Ye)&&pO(g,R,C,Ye),vc=!1,ut=g.memoizedState,R.state=ut,Gh(g,C,R,O),qh();var gt=g.memoizedState;ae!==Nt||ut!==gt||vc||m!==null&&m.dependencies!==null&&B0(m.dependencies)?(typeof Se=="function"&&(KC(g,v,Se,C),gt=g.memoizedState),(pt=vc||gO(g,v,pt,C,ut,gt,Ye)||m!==null&&m.dependencies!==null&&B0(m.dependencies))?(ct||typeof R.UNSAFE_componentWillUpdate!="function"&&typeof R.componentWillUpdate!="function"||(typeof R.componentWillUpdate=="function"&&R.componentWillUpdate(C,gt,Ye),typeof R.UNSAFE_componentWillUpdate=="function"&&R.UNSAFE_componentWillUpdate(C,gt,Ye)),typeof R.componentDidUpdate=="function"&&(g.flags|=4),typeof R.getSnapshotBeforeUpdate=="function"&&(g.flags|=1024)):(typeof R.componentDidUpdate!="function"||ae===m.memoizedProps&&ut===m.memoizedState||(g.flags|=4),typeof R.getSnapshotBeforeUpdate!="function"||ae===m.memoizedProps&&ut===m.memoizedState||(g.flags|=1024),g.memoizedProps=C,g.memoizedState=gt),R.props=C,R.state=gt,R.context=Ye,C=pt):(typeof R.componentDidUpdate!="function"||ae===m.memoizedProps&&ut===m.memoizedState||(g.flags|=4),typeof R.getSnapshotBeforeUpdate!="function"||ae===m.memoizedProps&&ut===m.memoizedState||(g.flags|=1024),C=!1)}return R=C,oy(m,g),C=(g.flags&128)!==0,R||C?(R=g.stateNode,v=C&&typeof v.getDerivedStateFromError!="function"?null:R.render(),g.flags|=1,m!==null&&C?(g.child=Hd(g,m.child,null,O),g.child=Hd(g,null,v,O)):Ss(m,g,v,O),g.memoizedState=R.state,m=g.child):m=ol(m,g,O),m}function LO(m,g,v,C){return $d(),g.flags|=256,Ss(m,g,v,C),g.child}var tS={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function aS(m){return{baseLanes:m,cachePool:v5()}}function nS(m,g,v){return m=m!==null?m.childLanes&~v:0,g&&(m|=Dr),m}function DO(m,g,v){var C=g.pendingProps,O=!1,R=(g.flags&128)!==0,ae;if((ae=R)||(ae=m!==null&&m.memoizedState===null?!1:(Ln.current&2)!==0),ae&&(O=!0,g.flags&=-129),ae=(g.flags&32)!==0,g.flags&=-33,m===null){if(ba){if(O?Nc(g):Cc(),(m=en)?(m=FM(m,ai),m=m!==null&&m.data!=="&"?m:null,m!==null&&(g.memoizedState={dehydrated:m,treeContext:pc!==null?{id:ro,overflow:io}:null,retryLane:536870912,hydrationErrors:null},v=u5(m),v.return=g,g.child=v,Ns=g,en=null)):m=null,m===null)throw yc(g);return zS(m)?g.lanes=32:g.lanes=536870912,null}var Se=C.children;return C=C.fallback,O?(Cc(),O=g.mode,Se=ly({mode:"hidden",children:Se},O),C=Id(C,O,v,null),Se.return=g,C.return=g,Se.sibling=C,g.child=Se,C=g.child,C.memoizedState=aS(v),C.childLanes=nS(m,ae,v),g.memoizedState=tS,Kh(null,C)):(Nc(g),sS(g,Se))}var Ye=m.memoizedState;if(Ye!==null&&(Se=Ye.dehydrated,Se!==null)){if(R)g.flags&256?(Nc(g),g.flags&=-257,g=rS(m,g,v)):g.memoizedState!==null?(Cc(),g.child=m.child,g.flags|=128,g=null):(Cc(),Se=C.fallback,O=g.mode,C=ly({mode:"visible",children:C.children},O),Se=Id(Se,O,v,null),Se.flags|=2,C.return=g,Se.return=g,C.sibling=Se,g.child=C,Hd(g,m.child,null,v),C=g.child,C.memoizedState=aS(v),C.childLanes=nS(m,ae,v),g.memoizedState=tS,g=Kh(null,C));else if(Nc(g),zS(Se)){if(ae=Se.nextSibling&&Se.nextSibling.dataset,ae)var ct=ae.dgst;ae=ct,C=Error(s(419)),C.stack="",C.digest=ae,Rh({value:C,source:null,stack:null}),g=rS(m,g,v)}else if(Fn||Am(m,g,v,!1),ae=(v&m.childLanes)!==0,Fn||ae){if(ae=Wa,ae!==null&&(C=de(ae,v),C!==0&&C!==Ye.retryLane))throw Ye.retryLane=C,Md(m,C),rr(ae,m,C),JC;RS(Se)||xy(),g=rS(m,g,v)}else RS(Se)?(g.flags|=192,g.child=m.child,g=null):(m=Ye.treeContext,en=si(Se.nextSibling),Ns=g,ba=!0,xc=null,ai=!1,m!==null&&h5(g,m),g=sS(g,C.children),g.flags|=4096);return g}return O?(Cc(),Se=C.fallback,O=g.mode,Ye=m.child,ct=Ye.sibling,C=tl(Ye,{mode:"hidden",children:C.children}),C.subtreeFlags=Ye.subtreeFlags&65011712,ct!==null?Se=tl(ct,Se):(Se=Id(Se,O,v,null),Se.flags|=2),Se.return=g,C.return=g,C.sibling=Se,g.child=C,Kh(null,C),C=g.child,Se=m.child.memoizedState,Se===null?Se=aS(v):(O=Se.cachePool,O!==null?(Ye=Rn._currentValue,O=O.parent!==Ye?{parent:Ye,pool:Ye}:O):O=v5(),Se={baseLanes:Se.baseLanes|v,cachePool:O}),C.memoizedState=Se,C.childLanes=nS(m,ae,v),g.memoizedState=tS,Kh(m.child,C)):(Nc(g),v=m.child,m=v.sibling,v=tl(v,{mode:"visible",children:C.children}),v.return=g,v.sibling=null,m!==null&&(ae=g.deletions,ae===null?(g.deletions=[m],g.flags|=16):ae.push(m)),g.child=v,g.memoizedState=null,v)}function sS(m,g){return g=ly({mode:"visible",children:g},m.mode),g.return=m,m.child=g}function ly(m,g){return m=Tr(22,m,null,g),m.lanes=0,m}function rS(m,g,v){return Hd(g,m.child,null,v),m=sS(g,g.pendingProps.children),m.flags|=2,g.memoizedState=null,m}function PO(m,g,v){m.lanes|=g;var C=m.alternate;C!==null&&(C.lanes|=g),vC(m.return,g,v)}function iS(m,g,v,C,O,R){var ae=m.memoizedState;ae===null?m.memoizedState={isBackwards:g,rendering:null,renderingStartTime:0,last:C,tail:v,tailMode:O,treeForkCount:R}:(ae.isBackwards=g,ae.rendering=null,ae.renderingStartTime=0,ae.last=C,ae.tail=v,ae.tailMode=O,ae.treeForkCount=R)}function OO(m,g,v){var C=g.pendingProps,O=C.revealOrder,R=C.tail;C=C.children;var ae=Ln.current,Se=(ae&2)!==0;if(Se?(ae=ae&1|2,g.flags|=128):ae&=1,ye(Ln,ae),Ss(m,g,C,v),C=ba?$h:0,!Se&&m!==null&&(m.flags&128)!==0)e:for(m=g.child;m!==null;){if(m.tag===13)m.memoizedState!==null&&PO(m,v,g);else if(m.tag===19)PO(m,v,g);else if(m.child!==null){m.child.return=m,m=m.child;continue}if(m===g)break e;for(;m.sibling===null;){if(m.return===null||m.return===g)break e;m=m.return}m.sibling.return=m.return,m=m.sibling}switch(O){case"forwards":for(v=g.child,O=null;v!==null;)m=v.alternate,m!==null&&K0(m)===null&&(O=v),v=v.sibling;v=O,v===null?(O=g.child,g.child=null):(O=v.sibling,v.sibling=null),iS(g,!1,O,v,R,C);break;case"backwards":case"unstable_legacy-backwards":for(v=null,O=g.child,g.child=null;O!==null;){if(m=O.alternate,m!==null&&K0(m)===null){g.child=O;break}m=O.sibling,O.sibling=v,v=O,O=m}iS(g,!0,v,null,R,C);break;case"together":iS(g,!1,null,null,void 0,C);break;default:g.memoizedState=null}return g.child}function ol(m,g,v){if(m!==null&&(g.dependencies=m.dependencies),Ac|=g.lanes,(v&g.childLanes)===0)if(m!==null){if(Am(m,g,v,!1),(v&g.childLanes)===0)return null}else return null;if(m!==null&&g.child!==m.child)throw Error(s(153));if(g.child!==null){for(m=g.child,v=tl(m,m.pendingProps),g.child=v,v.return=g;m.sibling!==null;)m=m.sibling,v=v.sibling=tl(m,m.pendingProps),v.return=g;v.sibling=null}return g.child}function oS(m,g){return(m.lanes&g)!==0?!0:(m=m.dependencies,!!(m!==null&&B0(m)))}function Gte(m,g,v){switch(g.tag){case 3:Ae(g,g.stateNode.containerInfo),bc(g,Rn,m.memoizedState.cache),$d();break;case 27:case 5:Ie(g);break;case 4:Ae(g,g.stateNode.containerInfo);break;case 10:bc(g,g.type,g.memoizedProps.value);break;case 31:if(g.memoizedState!==null)return g.flags|=128,DC(g),null;break;case 13:var C=g.memoizedState;if(C!==null)return C.dehydrated!==null?(Nc(g),g.flags|=128,null):(v&g.child.childLanes)!==0?DO(m,g,v):(Nc(g),m=ol(m,g,v),m!==null?m.sibling:null);Nc(g);break;case 19:var O=(m.flags&128)!==0;if(C=(v&g.childLanes)!==0,C||(Am(m,g,v,!1),C=(v&g.childLanes)!==0),O){if(C)return OO(m,g,v);g.flags|=128}if(O=g.memoizedState,O!==null&&(O.rendering=null,O.tail=null,O.lastEffect=null),ye(Ln,Ln.current),C)break;return null;case 22:return g.lanes=0,_O(m,g,v,g.pendingProps);case 24:bc(g,Rn,m.memoizedState.cache)}return ol(m,g,v)}function MO(m,g,v){if(m!==null)if(m.memoizedProps!==g.pendingProps)Fn=!0;else{if(!oS(m,v)&&(g.flags&128)===0)return Fn=!1,Gte(m,g,v);Fn=(m.flags&131072)!==0}else Fn=!1,ba&&(g.flags&1048576)!==0&&f5(g,$h,g.index);switch(g.lanes=0,g.tag){case 16:e:{var C=g.pendingProps;if(m=Ud(g.elementType),g.type=m,typeof m=="function")mC(m)?(C=Gd(m,C),g.tag=1,g=EO(null,g,m,C,v)):(g.tag=0,g=eS(null,g,m,C,v));else{if(m!=null){var O=m.$$typeof;if(O===_){g.tag=11,g=NO(null,g,m,C,v);break e}else if(O===A){g.tag=14,g=CO(null,g,m,C,v);break e}}throw g=G(m)||m,Error(s(306,g,""))}}return g;case 0:return eS(m,g,g.type,g.pendingProps,v);case 1:return C=g.type,O=Gd(C,g.pendingProps),EO(m,g,C,O,v);case 3:e:{if(Ae(g,g.stateNode.containerInfo),m===null)throw Error(s(387));C=g.pendingProps;var R=g.memoizedState;O=R.element,AC(m,g),Gh(g,C,null,v);var ae=g.memoizedState;if(C=ae.cache,bc(g,Rn,C),C!==R.cache&&wC(g,[Rn],v,!0),qh(),C=ae.element,R.isDehydrated)if(R={element:C,isDehydrated:!1,cache:ae.cache},g.updateQueue.baseState=R,g.memoizedState=R,g.flags&256){g=LO(m,g,C,v);break e}else if(C!==O){O=Jr(Error(s(424)),g),Rh(O),g=LO(m,g,C,v);break e}else for(m=g.stateNode.containerInfo,m.nodeType===9?m=m.body:m=m.nodeName==="HTML"?m.ownerDocument.body:m,en=si(m.firstChild),Ns=g,ba=!0,xc=null,ai=!0,v=_5(g,null,C,v),g.child=v;v;)v.flags=v.flags&-3|4096,v=v.sibling;else{if($d(),C===O){g=ol(m,g,v);break e}Ss(m,g,C,v)}g=g.child}return g;case 26:return oy(m,g),m===null?(v=WM(g.type,null,g.pendingProps,null))?g.memoizedState=v:ba||(v=g.type,m=g.pendingProps,C=Cy(be.current).createElement(v),C[Pe]=g,C[Ve]=m,_s(C,v,m),We(C),g.stateNode=C):g.memoizedState=WM(g.type,m.memoizedProps,g.pendingProps,m.memoizedState),null;case 27:return Ie(g),m===null&&ba&&(C=g.stateNode=HM(g.type,g.pendingProps,be.current),Ns=g,ai=!0,O=en,Dc(g.type)?(FS=O,en=si(C.firstChild)):en=O),Ss(m,g,g.pendingProps.children,v),oy(m,g),m===null&&(g.flags|=4194304),g.child;case 5:return m===null&&ba&&((O=C=en)&&(C=wae(C,g.type,g.pendingProps,ai),C!==null?(g.stateNode=C,Ns=g,en=si(C.firstChild),ai=!1,O=!0):O=!1),O||yc(g)),Ie(g),O=g.type,R=g.pendingProps,ae=m!==null?m.memoizedProps:null,C=R.children,MS(O,R)?C=null:ae!==null&&MS(O,ae)&&(g.flags|=32),g.memoizedState!==null&&(O=OC(m,g,Ite,null,null,v),ug._currentValue=O),oy(m,g),Ss(m,g,C,v),g.child;case 6:return m===null&&ba&&((m=v=en)&&(v=jae(v,g.pendingProps,ai),v!==null?(g.stateNode=v,Ns=g,en=null,m=!0):m=!1),m||yc(g)),null;case 13:return DO(m,g,v);case 4:return Ae(g,g.stateNode.containerInfo),C=g.pendingProps,m===null?g.child=Hd(g,null,C,v):Ss(m,g,C,v),g.child;case 11:return NO(m,g,g.type,g.pendingProps,v);case 7:return Ss(m,g,g.pendingProps,v),g.child;case 8:return Ss(m,g,g.pendingProps.children,v),g.child;case 12:return Ss(m,g,g.pendingProps.children,v),g.child;case 10:return C=g.pendingProps,bc(g,g.type,C.value),Ss(m,g,C.children,v),g.child;case 9:return O=g.type._context,C=g.pendingProps.children,zd(g),O=Cs(O),C=C(O),g.flags|=1,Ss(m,g,C,v),g.child;case 14:return CO(m,g,g.type,g.pendingProps,v);case 15:return SO(m,g,g.type,g.pendingProps,v);case 19:return OO(m,g,v);case 31:return qte(m,g,v);case 22:return _O(m,g,v,g.pendingProps);case 24:return zd(g),C=Cs(Rn),m===null?(O=CC(),O===null&&(O=Wa,R=jC(),O.pooledCache=R,R.refCount++,R!==null&&(O.pooledCacheLanes|=v),O=R),g.memoizedState={parent:C,cache:O},_C(g),bc(g,Rn,O)):((m.lanes&v)!==0&&(AC(m,g),Gh(g,null,null,v),qh()),O=m.memoizedState,R=g.memoizedState,O.parent!==C?(O={parent:C,cache:C},g.memoizedState=O,g.lanes===0&&(g.memoizedState=g.updateQueue.baseState=O),bc(g,Rn,C)):(C=R.cache,bc(g,Rn,C),C!==O.cache&&wC(g,[Rn],v,!0))),Ss(m,g,g.pendingProps.children,v),g.child;case 29:throw g.pendingProps}throw Error(s(156,g.tag))}function ll(m){m.flags|=4}function lS(m,g,v,C,O){if((g=(m.mode&32)!==0)&&(g=!1),g){if(m.flags|=16777216,(O&335544128)===O)if(m.stateNode.complete)m.flags|=8192;else if(lM())m.flags|=8192;else throw Bd=W0,SC}else m.flags&=-16777217}function IO(m,g){if(g.type!=="stylesheet"||(g.state.loading&4)!==0)m.flags&=-16777217;else if(m.flags|=16777216,!XM(g))if(lM())m.flags|=8192;else throw Bd=W0,SC}function cy(m,g){g!==null&&(m.flags|=4),m.flags&16384&&(g=m.tag!==22?fe():536870912,m.lanes|=g,zm|=g)}function Xh(m,g){if(!ba)switch(m.tailMode){case"hidden":g=m.tail;for(var v=null;g!==null;)g.alternate!==null&&(v=g),g=g.sibling;v===null?m.tail=null:v.sibling=null;break;case"collapsed":v=m.tail;for(var C=null;v!==null;)v.alternate!==null&&(C=v),v=v.sibling;C===null?g||m.tail===null?m.tail=null:m.tail.sibling=null:C.sibling=null}}function tn(m){var g=m.alternate!==null&&m.alternate.child===m.child,v=0,C=0;if(g)for(var O=m.child;O!==null;)v|=O.lanes|O.childLanes,C|=O.subtreeFlags&65011712,C|=O.flags&65011712,O.return=m,O=O.sibling;else for(O=m.child;O!==null;)v|=O.lanes|O.childLanes,C|=O.subtreeFlags,C|=O.flags,O.return=m,O=O.sibling;return m.subtreeFlags|=C,m.childLanes=v,g}function Wte(m,g,v){var C=g.pendingProps;switch(pC(g),g.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return tn(g),null;case 1:return tn(g),null;case 3:return v=g.stateNode,C=null,m!==null&&(C=m.memoizedState.cache),g.memoizedState.cache!==C&&(g.flags|=2048),sl(Rn),pe(),v.pendingContext&&(v.context=v.pendingContext,v.pendingContext=null),(m===null||m.child===null)&&(_m(g)?ll(g):m===null||m.memoizedState.isDehydrated&&(g.flags&256)===0||(g.flags|=1024,yC())),tn(g),null;case 26:var O=g.type,R=g.memoizedState;return m===null?(ll(g),R!==null?(tn(g),IO(g,R)):(tn(g),lS(g,O,null,C,v))):R?R!==m.memoizedState?(ll(g),tn(g),IO(g,R)):(tn(g),g.flags&=-16777217):(m=m.memoizedProps,m!==C&&ll(g),tn(g),lS(g,O,m,C,v)),null;case 27:if(xe(g),v=be.current,O=g.type,m!==null&&g.stateNode!=null)m.memoizedProps!==C&&ll(g);else{if(!C){if(g.stateNode===null)throw Error(s(166));return tn(g),null}m=Ce.current,_m(g)?g5(g):(m=HM(O,C,v),g.stateNode=m,ll(g))}return tn(g),null;case 5:if(xe(g),O=g.type,m!==null&&g.stateNode!=null)m.memoizedProps!==C&&ll(g);else{if(!C){if(g.stateNode===null)throw Error(s(166));return tn(g),null}if(R=Ce.current,_m(g))g5(g);else{var ae=Cy(be.current);switch(R){case 1:R=ae.createElementNS("http://www.w3.org/2000/svg",O);break;case 2:R=ae.createElementNS("http://www.w3.org/1998/Math/MathML",O);break;default:switch(O){case"svg":R=ae.createElementNS("http://www.w3.org/2000/svg",O);break;case"math":R=ae.createElementNS("http://www.w3.org/1998/Math/MathML",O);break;case"script":R=ae.createElement("div"),R.innerHTML="<script><\/script>",R=R.removeChild(R.firstChild);break;case"select":R=typeof C.is=="string"?ae.createElement("select",{is:C.is}):ae.createElement("select"),C.multiple?R.multiple=!0:C.size&&(R.size=C.size);break;default:R=typeof C.is=="string"?ae.createElement(O,{is:C.is}):ae.createElement(O)}}R[Pe]=g,R[Ve]=C;e:for(ae=g.child;ae!==null;){if(ae.tag===5||ae.tag===6)R.appendChild(ae.stateNode);else if(ae.tag!==4&&ae.tag!==27&&ae.child!==null){ae.child.return=ae,ae=ae.child;continue}if(ae===g)break e;for(;ae.sibling===null;){if(ae.return===null||ae.return===g)break e;ae=ae.return}ae.sibling.return=ae.return,ae=ae.sibling}g.stateNode=R;e:switch(_s(R,O,C),O){case"button":case"input":case"select":case"textarea":C=!!C.autoFocus;break e;case"img":C=!0;break e;default:C=!1}C&&ll(g)}}return tn(g),lS(g,g.type,m===null?null:m.memoizedProps,g.pendingProps,v),null;case 6:if(m&&g.stateNode!=null)m.memoizedProps!==C&&ll(g);else{if(typeof C!="string"&&g.stateNode===null)throw Error(s(166));if(m=be.current,_m(g)){if(m=g.stateNode,v=g.memoizedProps,C=null,O=Ns,O!==null)switch(O.tag){case 27:case 5:C=O.memoizedProps}m[Pe]=g,m=!!(m.nodeValue===v||C!==null&&C.suppressHydrationWarning===!0||DM(m.nodeValue,v)),m||yc(g,!0)}else m=Cy(m).createTextNode(C),m[Pe]=g,g.stateNode=m}return tn(g),null;case 31:if(v=g.memoizedState,m===null||m.memoizedState!==null){if(C=_m(g),v!==null){if(m===null){if(!C)throw Error(s(318));if(m=g.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(s(557));m[Pe]=g}else $d(),(g.flags&128)===0&&(g.memoizedState=null),g.flags|=4;tn(g),m=!1}else v=yC(),m!==null&&m.memoizedState!==null&&(m.memoizedState.hydrationErrors=v),m=!0;if(!m)return g.flags&256?(Er(g),g):(Er(g),null);if((g.flags&128)!==0)throw Error(s(558))}return tn(g),null;case 13:if(C=g.memoizedState,m===null||m.memoizedState!==null&&m.memoizedState.dehydrated!==null){if(O=_m(g),C!==null&&C.dehydrated!==null){if(m===null){if(!O)throw Error(s(318));if(O=g.memoizedState,O=O!==null?O.dehydrated:null,!O)throw Error(s(317));O[Pe]=g}else $d(),(g.flags&128)===0&&(g.memoizedState=null),g.flags|=4;tn(g),O=!1}else O=yC(),m!==null&&m.memoizedState!==null&&(m.memoizedState.hydrationErrors=O),O=!0;if(!O)return g.flags&256?(Er(g),g):(Er(g),null)}return Er(g),(g.flags&128)!==0?(g.lanes=v,g):(v=C!==null,m=m!==null&&m.memoizedState!==null,v&&(C=g.child,O=null,C.alternate!==null&&C.alternate.memoizedState!==null&&C.alternate.memoizedState.cachePool!==null&&(O=C.alternate.memoizedState.cachePool.pool),R=null,C.memoizedState!==null&&C.memoizedState.cachePool!==null&&(R=C.memoizedState.cachePool.pool),R!==O&&(C.flags|=2048)),v!==m&&v&&(g.child.flags|=8192),cy(g,g.updateQueue),tn(g),null);case 4:return pe(),m===null&&ES(g.stateNode.containerInfo),tn(g),null;case 10:return sl(g.type),tn(g),null;case 19:if(se(Ln),C=g.memoizedState,C===null)return tn(g),null;if(O=(g.flags&128)!==0,R=C.rendering,R===null)if(O)Xh(C,!1);else{if(wn!==0||m!==null&&(m.flags&128)!==0)for(m=g.child;m!==null;){if(R=K0(m),R!==null){for(g.flags|=128,Xh(C,!1),m=R.updateQueue,g.updateQueue=m,cy(g,m),g.subtreeFlags=0,m=v,v=g.child;v!==null;)d5(v,m),v=v.sibling;return ye(Ln,Ln.current&1|2),ba&&al(g,C.treeForkCount),g.child}m=m.sibling}C.tail!==null&&Ue()>hy&&(g.flags|=128,O=!0,Xh(C,!1),g.lanes=4194304)}else{if(!O)if(m=K0(R),m!==null){if(g.flags|=128,O=!0,m=m.updateQueue,g.updateQueue=m,cy(g,m),Xh(C,!0),C.tail===null&&C.tailMode==="hidden"&&!R.alternate&&!ba)return tn(g),null}else 2*Ue()-C.renderingStartTime>hy&&v!==536870912&&(g.flags|=128,O=!0,Xh(C,!1),g.lanes=4194304);C.isBackwards?(R.sibling=g.child,g.child=R):(m=C.last,m!==null?m.sibling=R:g.child=R,C.last=R)}return C.tail!==null?(m=C.tail,C.rendering=m,C.tail=m.sibling,C.renderingStartTime=Ue(),m.sibling=null,v=Ln.current,ye(Ln,O?v&1|2:v&1),ba&&al(g,C.treeForkCount),m):(tn(g),null);case 22:case 23:return Er(g),LC(),C=g.memoizedState!==null,m!==null?m.memoizedState!==null!==C&&(g.flags|=8192):C&&(g.flags|=8192),C?(v&536870912)!==0&&(g.flags&128)===0&&(tn(g),g.subtreeFlags&6&&(g.flags|=8192)):tn(g),v=g.updateQueue,v!==null&&cy(g,v.retryQueue),v=null,m!==null&&m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(v=m.memoizedState.cachePool.pool),C=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(C=g.memoizedState.cachePool.pool),C!==v&&(g.flags|=2048),m!==null&&se(Fd),null;case 24:return v=null,m!==null&&(v=m.memoizedState.cache),g.memoizedState.cache!==v&&(g.flags|=2048),sl(Rn),tn(g),null;case 25:return null;case 30:return null}throw Error(s(156,g.tag))}function Vte(m,g){switch(pC(g),g.tag){case 1:return m=g.flags,m&65536?(g.flags=m&-65537|128,g):null;case 3:return sl(Rn),pe(),m=g.flags,(m&65536)!==0&&(m&128)===0?(g.flags=m&-65537|128,g):null;case 26:case 27:case 5:return xe(g),null;case 31:if(g.memoizedState!==null){if(Er(g),g.alternate===null)throw Error(s(340));$d()}return m=g.flags,m&65536?(g.flags=m&-65537|128,g):null;case 13:if(Er(g),m=g.memoizedState,m!==null&&m.dehydrated!==null){if(g.alternate===null)throw Error(s(340));$d()}return m=g.flags,m&65536?(g.flags=m&-65537|128,g):null;case 19:return se(Ln),null;case 4:return pe(),null;case 10:return sl(g.type),null;case 22:case 23:return Er(g),LC(),m!==null&&se(Fd),m=g.flags,m&65536?(g.flags=m&-65537|128,g):null;case 24:return sl(Rn),null;case 25:return null;default:return null}}function $O(m,g){switch(pC(g),g.tag){case 3:sl(Rn),pe();break;case 26:case 27:case 5:xe(g);break;case 4:pe();break;case 31:g.memoizedState!==null&&Er(g);break;case 13:Er(g);break;case 19:se(Ln);break;case 10:sl(g.type);break;case 22:case 23:Er(g),LC(),m!==null&&se(Fd);break;case 24:sl(Rn)}}function Zh(m,g){try{var v=g.updateQueue,C=v!==null?v.lastEffect:null;if(C!==null){var O=C.next;v=O;do{if((v.tag&m)===m){C=void 0;var R=v.create,ae=v.inst;C=R(),ae.destroy=C}v=v.next}while(v!==O)}}catch(Se){Ma(g,g.return,Se)}}function Sc(m,g,v){try{var C=g.updateQueue,O=C!==null?C.lastEffect:null;if(O!==null){var R=O.next;C=R;do{if((C.tag&m)===m){var ae=C.inst,Se=ae.destroy;if(Se!==void 0){ae.destroy=void 0,O=g;var Ye=v,ct=Se;try{ct()}catch(pt){Ma(O,Ye,pt)}}}C=C.next}while(C!==R)}}catch(pt){Ma(g,g.return,pt)}}function RO(m){var g=m.updateQueue;if(g!==null){var v=m.stateNode;try{T5(g,v)}catch(C){Ma(m,m.return,C)}}}function zO(m,g,v){v.props=Gd(m.type,m.memoizedProps),v.state=m.memoizedState;try{v.componentWillUnmount()}catch(C){Ma(m,g,C)}}function Jh(m,g){try{var v=m.ref;if(v!==null){switch(m.tag){case 26:case 27:case 5:var C=m.stateNode;break;case 30:C=m.stateNode;break;default:C=m.stateNode}typeof v=="function"?m.refCleanup=v(C):v.current=C}}catch(O){Ma(m,g,O)}}function oo(m,g){var v=m.ref,C=m.refCleanup;if(v!==null)if(typeof C=="function")try{C()}catch(O){Ma(m,g,O)}finally{m.refCleanup=null,m=m.alternate,m!=null&&(m.refCleanup=null)}else if(typeof v=="function")try{v(null)}catch(O){Ma(m,g,O)}else v.current=null}function FO(m){var g=m.type,v=m.memoizedProps,C=m.stateNode;try{e:switch(g){case"button":case"input":case"select":case"textarea":v.autoFocus&&C.focus();break e;case"img":v.src?C.src=v.src:v.srcSet&&(C.srcset=v.srcSet)}}catch(O){Ma(m,m.return,O)}}function cS(m,g,v){try{var C=m.stateNode;gae(C,m.type,v,g),C[Ve]=g}catch(O){Ma(m,m.return,O)}}function UO(m){return m.tag===5||m.tag===3||m.tag===26||m.tag===27&&Dc(m.type)||m.tag===4}function dS(m){e:for(;;){for(;m.sibling===null;){if(m.return===null||UO(m.return))return null;m=m.return}for(m.sibling.return=m.return,m=m.sibling;m.tag!==5&&m.tag!==6&&m.tag!==18;){if(m.tag===27&&Dc(m.type)||m.flags&2||m.child===null||m.tag===4)continue e;m.child.return=m,m=m.child}if(!(m.flags&2))return m.stateNode}}function uS(m,g,v){var C=m.tag;if(C===5||C===6)m=m.stateNode,g?(v.nodeType===9?v.body:v.nodeName==="HTML"?v.ownerDocument.body:v).insertBefore(m,g):(g=v.nodeType===9?v.body:v.nodeName==="HTML"?v.ownerDocument.body:v,g.appendChild(m),v=v._reactRootContainer,v!=null||g.onclick!==null||(g.onclick=Jo));else if(C!==4&&(C===27&&Dc(m.type)&&(v=m.stateNode,g=null),m=m.child,m!==null))for(uS(m,g,v),m=m.sibling;m!==null;)uS(m,g,v),m=m.sibling}function dy(m,g,v){var C=m.tag;if(C===5||C===6)m=m.stateNode,g?v.insertBefore(m,g):v.appendChild(m);else if(C!==4&&(C===27&&Dc(m.type)&&(v=m.stateNode),m=m.child,m!==null))for(dy(m,g,v),m=m.sibling;m!==null;)dy(m,g,v),m=m.sibling}function BO(m){var g=m.stateNode,v=m.memoizedProps;try{for(var C=m.type,O=g.attributes;O.length;)g.removeAttributeNode(O[0]);_s(g,C,v),g[Pe]=m,g[Ve]=v}catch(R){Ma(m,m.return,R)}}var cl=!1,Un=!1,mS=!1,HO=typeof WeakSet=="function"?WeakSet:Set,fs=null;function Yte(m,g){if(m=m.containerInfo,PS=Ly,m=t5(m),rC(m)){if("selectionStart"in m)var v={start:m.selectionStart,end:m.selectionEnd};else e:{v=(v=m.ownerDocument)&&v.defaultView||window;var C=v.getSelection&&v.getSelection();if(C&&C.rangeCount!==0){v=C.anchorNode;var O=C.anchorOffset,R=C.focusNode;C=C.focusOffset;try{v.nodeType,R.nodeType}catch{v=null;break e}var ae=0,Se=-1,Ye=-1,ct=0,pt=0,Nt=m,ut=null;t:for(;;){for(var gt;Nt!==v||O!==0&&Nt.nodeType!==3||(Se=ae+O),Nt!==R||C!==0&&Nt.nodeType!==3||(Ye=ae+C),Nt.nodeType===3&&(ae+=Nt.nodeValue.length),(gt=Nt.firstChild)!==null;)ut=Nt,Nt=gt;for(;;){if(Nt===m)break t;if(ut===v&&++ct===O&&(Se=ae),ut===R&&++pt===C&&(Ye=ae),(gt=Nt.nextSibling)!==null)break;Nt=ut,ut=Nt.parentNode}Nt=gt}v=Se===-1||Ye===-1?null:{start:Se,end:Ye}}else v=null}v=v||{start:0,end:0}}else v=null;for(OS={focusedElem:m,selectionRange:v},Ly=!1,fs=g;fs!==null;)if(g=fs,m=g.child,(g.subtreeFlags&1028)!==0&&m!==null)m.return=g,fs=m;else for(;fs!==null;){switch(g=fs,R=g.alternate,m=g.flags,g.tag){case 0:if((m&4)!==0&&(m=g.updateQueue,m=m!==null?m.events:null,m!==null))for(v=0;v<m.length;v++)O=m[v],O.ref.impl=O.nextImpl;break;case 11:case 15:break;case 1:if((m&1024)!==0&&R!==null){m=void 0,v=g,O=R.memoizedProps,R=R.memoizedState,C=v.stateNode;try{var Ft=Gd(v.type,O);m=C.getSnapshotBeforeUpdate(Ft,R),C.__reactInternalSnapshotBeforeUpdate=m}catch(Jt){Ma(v,v.return,Jt)}}break;case 3:if((m&1024)!==0){if(m=g.stateNode.containerInfo,v=m.nodeType,v===9)$S(m);else if(v===1)switch(m.nodeName){case"HEAD":case"HTML":case"BODY":$S(m);break;default:m.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((m&1024)!==0)throw Error(s(163))}if(m=g.sibling,m!==null){m.return=g.return,fs=m;break}fs=g.return}}function qO(m,g,v){var C=v.flags;switch(v.tag){case 0:case 11:case 15:ul(m,v),C&4&&Zh(5,v);break;case 1:if(ul(m,v),C&4)if(m=v.stateNode,g===null)try{m.componentDidMount()}catch(ae){Ma(v,v.return,ae)}else{var O=Gd(v.type,g.memoizedProps);g=g.memoizedState;try{m.componentDidUpdate(O,g,m.__reactInternalSnapshotBeforeUpdate)}catch(ae){Ma(v,v.return,ae)}}C&64&&RO(v),C&512&&Jh(v,v.return);break;case 3:if(ul(m,v),C&64&&(m=v.updateQueue,m!==null)){if(g=null,v.child!==null)switch(v.child.tag){case 27:case 5:g=v.child.stateNode;break;case 1:g=v.child.stateNode}try{T5(m,g)}catch(ae){Ma(v,v.return,ae)}}break;case 27:g===null&&C&4&&BO(v);case 26:case 5:ul(m,v),g===null&&C&4&&FO(v),C&512&&Jh(v,v.return);break;case 12:ul(m,v);break;case 31:ul(m,v),C&4&&VO(m,v);break;case 13:ul(m,v),C&4&&YO(m,v),C&64&&(m=v.memoizedState,m!==null&&(m=m.dehydrated,m!==null&&(v=nae.bind(null,v),Nae(m,v))));break;case 22:if(C=v.memoizedState!==null||cl,!C){g=g!==null&&g.memoizedState!==null||Un,O=cl;var R=Un;cl=C,(Un=g)&&!R?ml(m,v,(v.subtreeFlags&8772)!==0):ul(m,v),cl=O,Un=R}break;case 30:break;default:ul(m,v)}}function GO(m){var g=m.alternate;g!==null&&(m.alternate=null,GO(g)),m.child=null,m.deletions=null,m.sibling=null,m.tag===5&&(g=m.stateNode,g!==null&&I(g)),m.stateNode=null,m.return=null,m.dependencies=null,m.memoizedProps=null,m.memoizedState=null,m.pendingProps=null,m.stateNode=null,m.updateQueue=null}var on=null,tr=!1;function dl(m,g,v){for(v=v.child;v!==null;)WO(m,g,v),v=v.sibling}function WO(m,g,v){if(De&&typeof De.onCommitFiberUnmount=="function")try{De.onCommitFiberUnmount(Le,v)}catch{}switch(v.tag){case 26:Un||oo(v,g),dl(m,g,v),v.memoizedState?v.memoizedState.count--:v.stateNode&&(v=v.stateNode,v.parentNode.removeChild(v));break;case 27:Un||oo(v,g);var C=on,O=tr;Dc(v.type)&&(on=v.stateNode,tr=!1),dl(m,g,v),lg(v.stateNode),on=C,tr=O;break;case 5:Un||oo(v,g);case 6:if(C=on,O=tr,on=null,dl(m,g,v),on=C,tr=O,on!==null)if(tr)try{(on.nodeType===9?on.body:on.nodeName==="HTML"?on.ownerDocument.body:on).removeChild(v.stateNode)}catch(R){Ma(v,g,R)}else try{on.removeChild(v.stateNode)}catch(R){Ma(v,g,R)}break;case 18:on!==null&&(tr?(m=on,RM(m.nodeType===9?m.body:m.nodeName==="HTML"?m.ownerDocument.body:m,v.stateNode),Vm(m)):RM(on,v.stateNode));break;case 4:C=on,O=tr,on=v.stateNode.containerInfo,tr=!0,dl(m,g,v),on=C,tr=O;break;case 0:case 11:case 14:case 15:Sc(2,v,g),Un||Sc(4,v,g),dl(m,g,v);break;case 1:Un||(oo(v,g),C=v.stateNode,typeof C.componentWillUnmount=="function"&&zO(v,g,C)),dl(m,g,v);break;case 21:dl(m,g,v);break;case 22:Un=(C=Un)||v.memoizedState!==null,dl(m,g,v),Un=C;break;default:dl(m,g,v)}}function VO(m,g){if(g.memoizedState===null&&(m=g.alternate,m!==null&&(m=m.memoizedState,m!==null))){m=m.dehydrated;try{Vm(m)}catch(v){Ma(g,g.return,v)}}}function YO(m,g){if(g.memoizedState===null&&(m=g.alternate,m!==null&&(m=m.memoizedState,m!==null&&(m=m.dehydrated,m!==null))))try{Vm(m)}catch(v){Ma(g,g.return,v)}}function Qte(m){switch(m.tag){case 31:case 13:case 19:var g=m.stateNode;return g===null&&(g=m.stateNode=new HO),g;case 22:return m=m.stateNode,g=m._retryCache,g===null&&(g=m._retryCache=new HO),g;default:throw Error(s(435,m.tag))}}function uy(m,g){var v=Qte(m);g.forEach(function(C){if(!v.has(C)){v.add(C);var O=sae.bind(null,m,C);C.then(O,O)}})}function ar(m,g){var v=g.deletions;if(v!==null)for(var C=0;C<v.length;C++){var O=v[C],R=m,ae=g,Se=ae;e:for(;Se!==null;){switch(Se.tag){case 27:if(Dc(Se.type)){on=Se.stateNode,tr=!1;break e}break;case 5:on=Se.stateNode,tr=!1;break e;case 3:case 4:on=Se.stateNode.containerInfo,tr=!0;break e}Se=Se.return}if(on===null)throw Error(s(160));WO(R,ae,O),on=null,tr=!1,R=O.alternate,R!==null&&(R.return=null),O.return=null}if(g.subtreeFlags&13886)for(g=g.child;g!==null;)QO(g,m),g=g.sibling}var Pi=null;function QO(m,g){var v=m.alternate,C=m.flags;switch(m.tag){case 0:case 11:case 14:case 15:ar(g,m),nr(m),C&4&&(Sc(3,m,m.return),Zh(3,m),Sc(5,m,m.return));break;case 1:ar(g,m),nr(m),C&512&&(Un||v===null||oo(v,v.return)),C&64&&cl&&(m=m.updateQueue,m!==null&&(C=m.callbacks,C!==null&&(v=m.shared.hiddenCallbacks,m.shared.hiddenCallbacks=v===null?C:v.concat(C))));break;case 26:var O=Pi;if(ar(g,m),nr(m),C&512&&(Un||v===null||oo(v,v.return)),C&4){var R=v!==null?v.memoizedState:null;if(C=m.memoizedState,v===null)if(C===null)if(m.stateNode===null){e:{C=m.type,v=m.memoizedProps,O=O.ownerDocument||O;t:switch(C){case"title":R=O.getElementsByTagName("title")[0],(!R||R[_e]||R[Pe]||R.namespaceURI==="http://www.w3.org/2000/svg"||R.hasAttribute("itemprop"))&&(R=O.createElement(C),O.head.insertBefore(R,O.querySelector("head > title"))),_s(R,C,v),R[Pe]=m,We(R),C=R;break e;case"link":var ae=QM("link","href",O).get(C+(v.href||""));if(ae){for(var Se=0;Se<ae.length;Se++)if(R=ae[Se],R.getAttribute("href")===(v.href==null||v.href===""?null:v.href)&&R.getAttribute("rel")===(v.rel==null?null:v.rel)&&R.getAttribute("title")===(v.title==null?null:v.title)&&R.getAttribute("crossorigin")===(v.crossOrigin==null?null:v.crossOrigin)){ae.splice(Se,1);break t}}R=O.createElement(C),_s(R,C,v),O.head.appendChild(R);break;case"meta":if(ae=QM("meta","content",O).get(C+(v.content||""))){for(Se=0;Se<ae.length;Se++)if(R=ae[Se],R.getAttribute("content")===(v.content==null?null:""+v.content)&&R.getAttribute("name")===(v.name==null?null:v.name)&&R.getAttribute("property")===(v.property==null?null:v.property)&&R.getAttribute("http-equiv")===(v.httpEquiv==null?null:v.httpEquiv)&&R.getAttribute("charset")===(v.charSet==null?null:v.charSet)){ae.splice(Se,1);break t}}R=O.createElement(C),_s(R,C,v),O.head.appendChild(R);break;default:throw Error(s(468,C))}R[Pe]=m,We(R),C=R}m.stateNode=C}else KM(O,m.type,m.stateNode);else m.stateNode=YM(O,C,m.memoizedProps);else R!==C?(R===null?v.stateNode!==null&&(v=v.stateNode,v.parentNode.removeChild(v)):R.count--,C===null?KM(O,m.type,m.stateNode):YM(O,C,m.memoizedProps)):C===null&&m.stateNode!==null&&cS(m,m.memoizedProps,v.memoizedProps)}break;case 27:ar(g,m),nr(m),C&512&&(Un||v===null||oo(v,v.return)),v!==null&&C&4&&cS(m,m.memoizedProps,v.memoizedProps);break;case 5:if(ar(g,m),nr(m),C&512&&(Un||v===null||oo(v,v.return)),m.flags&32){O=m.stateNode;try{pm(O,"")}catch(Ft){Ma(m,m.return,Ft)}}C&4&&m.stateNode!=null&&(O=m.memoizedProps,cS(m,O,v!==null?v.memoizedProps:O)),C&1024&&(mS=!0);break;case 6:if(ar(g,m),nr(m),C&4){if(m.stateNode===null)throw Error(s(162));C=m.memoizedProps,v=m.stateNode;try{v.nodeValue=C}catch(Ft){Ma(m,m.return,Ft)}}break;case 3:if(Ay=null,O=Pi,Pi=Sy(g.containerInfo),ar(g,m),Pi=O,nr(m),C&4&&v!==null&&v.memoizedState.isDehydrated)try{Vm(g.containerInfo)}catch(Ft){Ma(m,m.return,Ft)}mS&&(mS=!1,KO(m));break;case 4:C=Pi,Pi=Sy(m.stateNode.containerInfo),ar(g,m),nr(m),Pi=C;break;case 12:ar(g,m),nr(m);break;case 31:ar(g,m),nr(m),C&4&&(C=m.updateQueue,C!==null&&(m.updateQueue=null,uy(m,C)));break;case 13:ar(g,m),nr(m),m.child.flags&8192&&m.memoizedState!==null!=(v!==null&&v.memoizedState!==null)&&(fy=Ue()),C&4&&(C=m.updateQueue,C!==null&&(m.updateQueue=null,uy(m,C)));break;case 22:O=m.memoizedState!==null;var Ye=v!==null&&v.memoizedState!==null,ct=cl,pt=Un;if(cl=ct||O,Un=pt||Ye,ar(g,m),Un=pt,cl=ct,nr(m),C&8192)e:for(g=m.stateNode,g._visibility=O?g._visibility&-2:g._visibility|1,O&&(v===null||Ye||cl||Un||Wd(m)),v=null,g=m;;){if(g.tag===5||g.tag===26){if(v===null){Ye=v=g;try{if(R=Ye.stateNode,O)ae=R.style,typeof ae.setProperty=="function"?ae.setProperty("display","none","important"):ae.display="none";else{Se=Ye.stateNode;var Nt=Ye.memoizedProps.style,ut=Nt!=null&&Nt.hasOwnProperty("display")?Nt.display:null;Se.style.display=ut==null||typeof ut=="boolean"?"":(""+ut).trim()}}catch(Ft){Ma(Ye,Ye.return,Ft)}}}else if(g.tag===6){if(v===null){Ye=g;try{Ye.stateNode.nodeValue=O?"":Ye.memoizedProps}catch(Ft){Ma(Ye,Ye.return,Ft)}}}else if(g.tag===18){if(v===null){Ye=g;try{var gt=Ye.stateNode;O?zM(gt,!0):zM(Ye.stateNode,!1)}catch(Ft){Ma(Ye,Ye.return,Ft)}}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===m)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===m)break e;for(;g.sibling===null;){if(g.return===null||g.return===m)break e;v===g&&(v=null),g=g.return}v===g&&(v=null),g.sibling.return=g.return,g=g.sibling}C&4&&(C=m.updateQueue,C!==null&&(v=C.retryQueue,v!==null&&(C.retryQueue=null,uy(m,v))));break;case 19:ar(g,m),nr(m),C&4&&(C=m.updateQueue,C!==null&&(m.updateQueue=null,uy(m,C)));break;case 30:break;case 21:break;default:ar(g,m),nr(m)}}function nr(m){var g=m.flags;if(g&2){try{for(var v,C=m.return;C!==null;){if(UO(C)){v=C;break}C=C.return}if(v==null)throw Error(s(160));switch(v.tag){case 27:var O=v.stateNode,R=dS(m);dy(m,R,O);break;case 5:var ae=v.stateNode;v.flags&32&&(pm(ae,""),v.flags&=-33);var Se=dS(m);dy(m,Se,ae);break;case 3:case 4:var Ye=v.stateNode.containerInfo,ct=dS(m);uS(m,ct,Ye);break;default:throw Error(s(161))}}catch(pt){Ma(m,m.return,pt)}m.flags&=-3}g&4096&&(m.flags&=-4097)}function KO(m){if(m.subtreeFlags&1024)for(m=m.child;m!==null;){var g=m;KO(g),g.tag===5&&g.flags&1024&&g.stateNode.reset(),m=m.sibling}}function ul(m,g){if(g.subtreeFlags&8772)for(g=g.child;g!==null;)qO(m,g.alternate,g),g=g.sibling}function Wd(m){for(m=m.child;m!==null;){var g=m;switch(g.tag){case 0:case 11:case 14:case 15:Sc(4,g,g.return),Wd(g);break;case 1:oo(g,g.return);var v=g.stateNode;typeof v.componentWillUnmount=="function"&&zO(g,g.return,v),Wd(g);break;case 27:lg(g.stateNode);case 26:case 5:oo(g,g.return),Wd(g);break;case 22:g.memoizedState===null&&Wd(g);break;case 30:Wd(g);break;default:Wd(g)}m=m.sibling}}function ml(m,g,v){for(v=v&&(g.subtreeFlags&8772)!==0,g=g.child;g!==null;){var C=g.alternate,O=m,R=g,ae=R.flags;switch(R.tag){case 0:case 11:case 15:ml(O,R,v),Zh(4,R);break;case 1:if(ml(O,R,v),C=R,O=C.stateNode,typeof O.componentDidMount=="function")try{O.componentDidMount()}catch(ct){Ma(C,C.return,ct)}if(C=R,O=C.updateQueue,O!==null){var Se=C.stateNode;try{var Ye=O.shared.hiddenCallbacks;if(Ye!==null)for(O.shared.hiddenCallbacks=null,O=0;O<Ye.length;O++)A5(Ye[O],Se)}catch(ct){Ma(C,C.return,ct)}}v&&ae&64&&RO(R),Jh(R,R.return);break;case 27:BO(R);case 26:case 5:ml(O,R,v),v&&C===null&&ae&4&&FO(R),Jh(R,R.return);break;case 12:ml(O,R,v);break;case 31:ml(O,R,v),v&&ae&4&&VO(O,R);break;case 13:ml(O,R,v),v&&ae&4&&YO(O,R);break;case 22:R.memoizedState===null&&ml(O,R,v),Jh(R,R.return);break;case 30:break;default:ml(O,R,v)}g=g.sibling}}function fS(m,g){var v=null;m!==null&&m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(v=m.memoizedState.cachePool.pool),m=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(m=g.memoizedState.cachePool.pool),m!==v&&(m!=null&&m.refCount++,v!=null&&zh(v))}function hS(m,g){m=null,g.alternate!==null&&(m=g.alternate.memoizedState.cache),g=g.memoizedState.cache,g!==m&&(g.refCount++,m!=null&&zh(m))}function Oi(m,g,v,C){if(g.subtreeFlags&10256)for(g=g.child;g!==null;)XO(m,g,v,C),g=g.sibling}function XO(m,g,v,C){var O=g.flags;switch(g.tag){case 0:case 11:case 15:Oi(m,g,v,C),O&2048&&Zh(9,g);break;case 1:Oi(m,g,v,C);break;case 3:Oi(m,g,v,C),O&2048&&(m=null,g.alternate!==null&&(m=g.alternate.memoizedState.cache),g=g.memoizedState.cache,g!==m&&(g.refCount++,m!=null&&zh(m)));break;case 12:if(O&2048){Oi(m,g,v,C),m=g.stateNode;try{var R=g.memoizedProps,ae=R.id,Se=R.onPostCommit;typeof Se=="function"&&Se(ae,g.alternate===null?"mount":"update",m.passiveEffectDuration,-0)}catch(Ye){Ma(g,g.return,Ye)}}else Oi(m,g,v,C);break;case 31:Oi(m,g,v,C);break;case 13:Oi(m,g,v,C);break;case 23:break;case 22:R=g.stateNode,ae=g.alternate,g.memoizedState!==null?R._visibility&2?Oi(m,g,v,C):eg(m,g):R._visibility&2?Oi(m,g,v,C):(R._visibility|=2,Im(m,g,v,C,(g.subtreeFlags&10256)!==0||!1)),O&2048&&fS(ae,g);break;case 24:Oi(m,g,v,C),O&2048&&hS(g.alternate,g);break;default:Oi(m,g,v,C)}}function Im(m,g,v,C,O){for(O=O&&((g.subtreeFlags&10256)!==0||!1),g=g.child;g!==null;){var R=m,ae=g,Se=v,Ye=C,ct=ae.flags;switch(ae.tag){case 0:case 11:case 15:Im(R,ae,Se,Ye,O),Zh(8,ae);break;case 23:break;case 22:var pt=ae.stateNode;ae.memoizedState!==null?pt._visibility&2?Im(R,ae,Se,Ye,O):eg(R,ae):(pt._visibility|=2,Im(R,ae,Se,Ye,O)),O&&ct&2048&&fS(ae.alternate,ae);break;case 24:Im(R,ae,Se,Ye,O),O&&ct&2048&&hS(ae.alternate,ae);break;default:Im(R,ae,Se,Ye,O)}g=g.sibling}}function eg(m,g){if(g.subtreeFlags&10256)for(g=g.child;g!==null;){var v=m,C=g,O=C.flags;switch(C.tag){case 22:eg(v,C),O&2048&&fS(C.alternate,C);break;case 24:eg(v,C),O&2048&&hS(C.alternate,C);break;default:eg(v,C)}g=g.sibling}}var tg=8192;function $m(m,g,v){if(m.subtreeFlags&tg)for(m=m.child;m!==null;)ZO(m,g,v),m=m.sibling}function ZO(m,g,v){switch(m.tag){case 26:$m(m,g,v),m.flags&tg&&m.memoizedState!==null&&Mae(v,Pi,m.memoizedState,m.memoizedProps);break;case 5:$m(m,g,v);break;case 3:case 4:var C=Pi;Pi=Sy(m.stateNode.containerInfo),$m(m,g,v),Pi=C;break;case 22:m.memoizedState===null&&(C=m.alternate,C!==null&&C.memoizedState!==null?(C=tg,tg=16777216,$m(m,g,v),tg=C):$m(m,g,v));break;default:$m(m,g,v)}}function JO(m){var g=m.alternate;if(g!==null&&(m=g.child,m!==null)){g.child=null;do g=m.sibling,m.sibling=null,m=g;while(m!==null)}}function ag(m){var g=m.deletions;if((m.flags&16)!==0){if(g!==null)for(var v=0;v<g.length;v++){var C=g[v];fs=C,tM(C,m)}JO(m)}if(m.subtreeFlags&10256)for(m=m.child;m!==null;)eM(m),m=m.sibling}function eM(m){switch(m.tag){case 0:case 11:case 15:ag(m),m.flags&2048&&Sc(9,m,m.return);break;case 3:ag(m);break;case 12:ag(m);break;case 22:var g=m.stateNode;m.memoizedState!==null&&g._visibility&2&&(m.return===null||m.return.tag!==13)?(g._visibility&=-3,my(m)):ag(m);break;default:ag(m)}}function my(m){var g=m.deletions;if((m.flags&16)!==0){if(g!==null)for(var v=0;v<g.length;v++){var C=g[v];fs=C,tM(C,m)}JO(m)}for(m=m.child;m!==null;){switch(g=m,g.tag){case 0:case 11:case 15:Sc(8,g,g.return),my(g);break;case 22:v=g.stateNode,v._visibility&2&&(v._visibility&=-3,my(g));break;default:my(g)}m=m.sibling}}function tM(m,g){for(;fs!==null;){var v=fs;switch(v.tag){case 0:case 11:case 15:Sc(8,v,g);break;case 23:case 22:if(v.memoizedState!==null&&v.memoizedState.cachePool!==null){var C=v.memoizedState.cachePool.pool;C!=null&&C.refCount++}break;case 24:zh(v.memoizedState.cache)}if(C=v.child,C!==null)C.return=v,fs=C;else e:for(v=m;fs!==null;){C=fs;var O=C.sibling,R=C.return;if(GO(C),C===v){fs=null;break e}if(O!==null){O.return=R,fs=O;break e}fs=R}}}var Kte={getCacheForType:function(m){var g=Cs(Rn),v=g.data.get(m);return v===void 0&&(v=m(),g.data.set(m,v)),v},cacheSignal:function(){return Cs(Rn).controller.signal}},Xte=typeof WeakMap=="function"?WeakMap:Map,Ta=0,Wa=null,ha=null,pa=0,Oa=0,Lr=null,_c=!1,Rm=!1,gS=!1,fl=0,wn=0,Ac=0,Vd=0,pS=0,Dr=0,zm=0,ng=null,sr=null,xS=!1,fy=0,aM=0,hy=1/0,gy=null,Tc=null,Zn=0,kc=null,Fm=null,hl=0,yS=0,bS=null,nM=null,sg=0,vS=null;function Pr(){return(Ta&2)!==0&&pa!==0?pa&-pa:W.T!==null?_S():Oe()}function sM(){if(Dr===0)if((pa&536870912)===0||ba){var m=Ct;Ct<<=1,(Ct&3932160)===0&&(Ct=262144),Dr=m}else Dr=536870912;return m=kr.current,m!==null&&(m.flags|=32),Dr}function rr(m,g,v){(m===Wa&&(Oa===2||Oa===9)||m.cancelPendingCommit!==null)&&(Um(m,0),Ec(m,pa,Dr,!1)),te(m,v),((Ta&2)===0||m!==Wa)&&(m===Wa&&((Ta&2)===0&&(Vd|=v),wn===4&&Ec(m,pa,Dr,!1)),lo(m))}function rM(m,g,v){if((Ta&6)!==0)throw Error(s(327));var C=!v&&(g&127)===0&&(g&m.expiredLanes)===0||Be(m,g),O=C?eae(m,g):jS(m,g,!0),R=C;do{if(O===0){Rm&&!C&&Ec(m,g,0,!1);break}else{if(v=m.current.alternate,R&&!Zte(v)){O=jS(m,g,!1),R=!1;continue}if(O===2){if(R=g,m.errorRecoveryDisabledLanes&R)var ae=0;else ae=m.pendingLanes&-536870913,ae=ae!==0?ae:ae&536870912?536870912:0;if(ae!==0){g=ae;e:{var Se=m;O=ng;var Ye=Se.current.memoizedState.isDehydrated;if(Ye&&(Um(Se,ae).flags|=256),ae=jS(Se,ae,!1),ae!==2){if(gS&&!Ye){Se.errorRecoveryDisabledLanes|=R,Vd|=R,O=4;break e}R=sr,sr=O,R!==null&&(sr===null?sr=R:sr.push.apply(sr,R))}O=ae}if(R=!1,O!==2)continue}}if(O===1){Um(m,0),Ec(m,g,0,!0);break}e:{switch(C=m,R=O,R){case 0:case 1:throw Error(s(345));case 4:if((g&4194048)!==g)break;case 6:Ec(C,g,Dr,!_c);break e;case 2:sr=null;break;case 3:case 5:break;default:throw Error(s(329))}if((g&62914560)===g&&(O=fy+300-Ue(),10<O)){if(Ec(C,g,Dr,!_c),Ge(C,0,!0)!==0)break e;hl=g,C.timeoutHandle=IM(iM.bind(null,C,v,sr,gy,xS,g,Dr,Vd,zm,_c,R,"Throttled",-0,0),O);break e}iM(C,v,sr,gy,xS,g,Dr,Vd,zm,_c,R,null,-0,0)}}break}while(!0);lo(m)}function iM(m,g,v,C,O,R,ae,Se,Ye,ct,pt,Nt,ut,gt){if(m.timeoutHandle=-1,Nt=g.subtreeFlags,Nt&8192||(Nt&16785408)===16785408){Nt={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Jo},ZO(g,R,Nt);var Ft=(R&62914560)===R?fy-Ue():(R&4194048)===R?aM-Ue():0;if(Ft=Iae(Nt,Ft),Ft!==null){hl=R,m.cancelPendingCommit=Ft(hM.bind(null,m,g,R,v,C,O,ae,Se,Ye,pt,Nt,null,ut,gt)),Ec(m,R,ae,!ct);return}}hM(m,g,R,v,C,O,ae,Se,Ye)}function Zte(m){for(var g=m;;){var v=g.tag;if((v===0||v===11||v===15)&&g.flags&16384&&(v=g.updateQueue,v!==null&&(v=v.stores,v!==null)))for(var C=0;C<v.length;C++){var O=v[C],R=O.getSnapshot;O=O.value;try{if(!Ar(R(),O))return!1}catch{return!1}}if(v=g.child,g.subtreeFlags&16384&&v!==null)v.return=g,g=v;else{if(g===m)break;for(;g.sibling===null;){if(g.return===null||g.return===m)return!0;g=g.return}g.sibling.return=g.return,g=g.sibling}}return!0}function Ec(m,g,v,C){g&=~pS,g&=~Vd,m.suspendedLanes|=g,m.pingedLanes&=~g,C&&(m.warmLanes|=g),C=m.expirationTimes;for(var O=g;0<O;){var R=31-tt(O),ae=1<<R;C[R]=-1,O&=~ae}v!==0&&Y(m,v,g)}function py(){return(Ta&6)===0?(rg(0),!1):!0}function wS(){if(ha!==null){if(Oa===0)var m=ha.return;else m=ha,nl=Rd=null,$C(m),Lm=null,Uh=0,m=ha;for(;m!==null;)$O(m.alternate,m),m=m.return;ha=null}}function Um(m,g){var v=m.timeoutHandle;v!==-1&&(m.timeoutHandle=-1,yae(v)),v=m.cancelPendingCommit,v!==null&&(m.cancelPendingCommit=null,v()),hl=0,wS(),Wa=m,ha=v=tl(m.current,null),pa=g,Oa=0,Lr=null,_c=!1,Rm=Be(m,g),gS=!1,zm=Dr=pS=Vd=Ac=wn=0,sr=ng=null,xS=!1,(g&8)!==0&&(g|=g&32);var C=m.entangledLanes;if(C!==0)for(m=m.entanglements,C&=g;0<C;){var O=31-tt(C),R=1<<O;g|=m[O],C&=~R}return fl=g,$0(),v}function oM(m,g){oa=null,W.H=Qh,g===Em||g===G0?(g=N5(),Oa=3):g===SC?(g=N5(),Oa=4):Oa=g===JC?8:g!==null&&typeof g=="object"&&typeof g.then=="function"?6:1,Lr=g,ha===null&&(wn=1,ry(m,Jr(g,m.current)))}function lM(){var m=kr.current;return m===null?!0:(pa&4194048)===pa?ni===null:(pa&62914560)===pa||(pa&536870912)!==0?m===ni:!1}function cM(){var m=W.H;return W.H=Qh,m===null?Qh:m}function dM(){var m=W.A;return W.A=Kte,m}function xy(){wn=4,_c||(pa&4194048)!==pa&&kr.current!==null||(Rm=!0),(Ac&134217727)===0&&(Vd&134217727)===0||Wa===null||Ec(Wa,pa,Dr,!1)}function jS(m,g,v){var C=Ta;Ta|=2;var O=cM(),R=dM();(Wa!==m||pa!==g)&&(gy=null,Um(m,g)),g=!1;var ae=wn;e:do try{if(Oa!==0&&ha!==null){var Se=ha,Ye=Lr;switch(Oa){case 8:wS(),ae=6;break e;case 3:case 2:case 9:case 6:kr.current===null&&(g=!0);var ct=Oa;if(Oa=0,Lr=null,Bm(m,Se,Ye,ct),v&&Rm){ae=0;break e}break;default:ct=Oa,Oa=0,Lr=null,Bm(m,Se,Ye,ct)}}Jte(),ae=wn;break}catch(pt){oM(m,pt)}while(!0);return g&&m.shellSuspendCounter++,nl=Rd=null,Ta=C,W.H=O,W.A=R,ha===null&&(Wa=null,pa=0,$0()),ae}function Jte(){for(;ha!==null;)uM(ha)}function eae(m,g){var v=Ta;Ta|=2;var C=cM(),O=dM();Wa!==m||pa!==g?(gy=null,hy=Ue()+500,Um(m,g)):Rm=Be(m,g);e:do try{if(Oa!==0&&ha!==null){g=ha;var R=Lr;t:switch(Oa){case 1:Oa=0,Lr=null,Bm(m,g,R,1);break;case 2:case 9:if(w5(R)){Oa=0,Lr=null,mM(g);break}g=function(){Oa!==2&&Oa!==9||Wa!==m||(Oa=7),lo(m)},R.then(g,g);break e;case 3:Oa=7;break e;case 4:Oa=5;break e;case 7:w5(R)?(Oa=0,Lr=null,mM(g)):(Oa=0,Lr=null,Bm(m,g,R,7));break;case 5:var ae=null;switch(ha.tag){case 26:ae=ha.memoizedState;case 5:case 27:var Se=ha;if(ae?XM(ae):Se.stateNode.complete){Oa=0,Lr=null;var Ye=Se.sibling;if(Ye!==null)ha=Ye;else{var ct=Se.return;ct!==null?(ha=ct,yy(ct)):ha=null}break t}}Oa=0,Lr=null,Bm(m,g,R,5);break;case 6:Oa=0,Lr=null,Bm(m,g,R,6);break;case 8:wS(),wn=6;break e;default:throw Error(s(462))}}tae();break}catch(pt){oM(m,pt)}while(!0);return nl=Rd=null,W.H=C,W.A=O,Ta=v,ha!==null?0:(Wa=null,pa=0,$0(),wn)}function tae(){for(;ha!==null&&!Je();)uM(ha)}function uM(m){var g=MO(m.alternate,m,fl);m.memoizedProps=m.pendingProps,g===null?yy(m):ha=g}function mM(m){var g=m,v=g.alternate;switch(g.tag){case 15:case 0:g=kO(v,g,g.pendingProps,g.type,void 0,pa);break;case 11:g=kO(v,g,g.pendingProps,g.type.render,g.ref,pa);break;case 5:$C(g);default:$O(v,g),g=ha=d5(g,fl),g=MO(v,g,fl)}m.memoizedProps=m.pendingProps,g===null?yy(m):ha=g}function Bm(m,g,v,C){nl=Rd=null,$C(g),Lm=null,Uh=0;var O=g.return;try{if(Hte(m,O,g,v,pa)){wn=1,ry(m,Jr(v,m.current)),ha=null;return}}catch(R){if(O!==null)throw ha=O,R;wn=1,ry(m,Jr(v,m.current)),ha=null;return}g.flags&32768?(ba||C===1?m=!0:Rm||(pa&536870912)!==0?m=!1:(_c=m=!0,(C===2||C===9||C===3||C===6)&&(C=kr.current,C!==null&&C.tag===13&&(C.flags|=16384))),fM(g,m)):yy(g)}function yy(m){var g=m;do{if((g.flags&32768)!==0){fM(g,_c);return}m=g.return;var v=Wte(g.alternate,g,fl);if(v!==null){ha=v;return}if(g=g.sibling,g!==null){ha=g;return}ha=g=m}while(g!==null);wn===0&&(wn=5)}function fM(m,g){do{var v=Vte(m.alternate,m);if(v!==null){v.flags&=32767,ha=v;return}if(v=m.return,v!==null&&(v.flags|=32768,v.subtreeFlags=0,v.deletions=null),!g&&(m=m.sibling,m!==null)){ha=m;return}ha=m=v}while(m!==null);wn=6,ha=null}function hM(m,g,v,C,O,R,ae,Se,Ye){m.cancelPendingCommit=null;do by();while(Zn!==0);if((Ta&6)!==0)throw Error(s(327));if(g!==null){if(g===m.current)throw Error(s(177));if(R=g.lanes|g.childLanes,R|=dC,q(m,v,R,ae,Se,Ye),m===Wa&&(ha=Wa=null,pa=0),Fm=g,kc=m,hl=v,yS=R,bS=O,nM=C,(g.subtreeFlags&10256)!==0||(g.flags&10256)!==0?(m.callbackNode=null,m.callbackPriority=0,rae(ve,function(){return bM(),null})):(m.callbackNode=null,m.callbackPriority=0),C=(g.flags&13878)!==0,(g.subtreeFlags&13878)!==0||C){C=W.T,W.T=null,O=Z.p,Z.p=2,ae=Ta,Ta|=4;try{Yte(m,g,v)}finally{Ta=ae,Z.p=O,W.T=C}}Zn=1,gM(),pM(),xM()}}function gM(){if(Zn===1){Zn=0;var m=kc,g=Fm,v=(g.flags&13878)!==0;if((g.subtreeFlags&13878)!==0||v){v=W.T,W.T=null;var C=Z.p;Z.p=2;var O=Ta;Ta|=4;try{QO(g,m);var R=OS,ae=t5(m.containerInfo),Se=R.focusedElem,Ye=R.selectionRange;if(ae!==Se&&Se&&Se.ownerDocument&&e5(Se.ownerDocument.documentElement,Se)){if(Ye!==null&&rC(Se)){var ct=Ye.start,pt=Ye.end;if(pt===void 0&&(pt=ct),"selectionStart"in Se)Se.selectionStart=ct,Se.selectionEnd=Math.min(pt,Se.value.length);else{var Nt=Se.ownerDocument||document,ut=Nt&&Nt.defaultView||window;if(ut.getSelection){var gt=ut.getSelection(),Ft=Se.textContent.length,Jt=Math.min(Ye.start,Ft),Ha=Ye.end===void 0?Jt:Math.min(Ye.end,Ft);!gt.extend&&Jt>Ha&&(ae=Ha,Ha=Jt,Jt=ae);var nt=J3(Se,Jt),Xe=J3(Se,Ha);if(nt&&Xe&&(gt.rangeCount!==1||gt.anchorNode!==nt.node||gt.anchorOffset!==nt.offset||gt.focusNode!==Xe.node||gt.focusOffset!==Xe.offset)){var lt=Nt.createRange();lt.setStart(nt.node,nt.offset),gt.removeAllRanges(),Jt>Ha?(gt.addRange(lt),gt.extend(Xe.node,Xe.offset)):(lt.setEnd(Xe.node,Xe.offset),gt.addRange(lt))}}}}for(Nt=[],gt=Se;gt=gt.parentNode;)gt.nodeType===1&&Nt.push({element:gt,left:gt.scrollLeft,top:gt.scrollTop});for(typeof Se.focus=="function"&&Se.focus(),Se=0;Se<Nt.length;Se++){var vt=Nt[Se];vt.element.scrollLeft=vt.left,vt.element.scrollTop=vt.top}}Ly=!!PS,OS=PS=null}finally{Ta=O,Z.p=C,W.T=v}}m.current=g,Zn=2}}function pM(){if(Zn===2){Zn=0;var m=kc,g=Fm,v=(g.flags&8772)!==0;if((g.subtreeFlags&8772)!==0||v){v=W.T,W.T=null;var C=Z.p;Z.p=2;var O=Ta;Ta|=4;try{qO(m,g.alternate,g)}finally{Ta=O,Z.p=C,W.T=v}}Zn=3}}function xM(){if(Zn===4||Zn===3){Zn=0,Fe();var m=kc,g=Fm,v=hl,C=nM;(g.subtreeFlags&10256)!==0||(g.flags&10256)!==0?Zn=5:(Zn=0,Fm=kc=null,yM(m,m.pendingLanes));var O=m.pendingLanes;if(O===0&&(Tc=null),ie(v),g=g.stateNode,De&&typeof De.onCommitFiberRoot=="function")try{De.onCommitFiberRoot(Le,g,void 0,(g.current.flags&128)===128)}catch{}if(C!==null){g=W.T,O=Z.p,Z.p=2,W.T=null;try{for(var R=m.onRecoverableError,ae=0;ae<C.length;ae++){var Se=C[ae];R(Se.value,{componentStack:Se.stack})}}finally{W.T=g,Z.p=O}}(hl&3)!==0&&by(),lo(m),O=m.pendingLanes,(v&261930)!==0&&(O&42)!==0?m===vS?sg++:(sg=0,vS=m):sg=0,rg(0)}}function yM(m,g){(m.pooledCacheLanes&=g)===0&&(g=m.pooledCache,g!=null&&(m.pooledCache=null,zh(g)))}function by(){return gM(),pM(),xM(),bM()}function bM(){if(Zn!==5)return!1;var m=kc,g=yS;yS=0;var v=ie(hl),C=W.T,O=Z.p;try{Z.p=32>v?32:v,W.T=null,v=bS,bS=null;var R=kc,ae=hl;if(Zn=0,Fm=kc=null,hl=0,(Ta&6)!==0)throw Error(s(331));var Se=Ta;if(Ta|=4,eM(R.current),XO(R,R.current,ae,v),Ta=Se,rg(0,!1),De&&typeof De.onPostCommitFiberRoot=="function")try{De.onPostCommitFiberRoot(Le,R)}catch{}return!0}finally{Z.p=O,W.T=C,yM(m,g)}}function vM(m,g,v){g=Jr(v,g),g=ZC(m.stateNode,g,2),m=jc(m,g,2),m!==null&&(te(m,2),lo(m))}function Ma(m,g,v){if(m.tag===3)vM(m,m,v);else for(;g!==null;){if(g.tag===3){vM(g,m,v);break}else if(g.tag===1){var C=g.stateNode;if(typeof g.type.getDerivedStateFromError=="function"||typeof C.componentDidCatch=="function"&&(Tc===null||!Tc.has(C))){m=Jr(v,m),v=wO(2),C=jc(g,v,2),C!==null&&(jO(v,C,g,m),te(C,2),lo(C));break}}g=g.return}}function NS(m,g,v){var C=m.pingCache;if(C===null){C=m.pingCache=new Xte;var O=new Set;C.set(g,O)}else O=C.get(g),O===void 0&&(O=new Set,C.set(g,O));O.has(v)||(gS=!0,O.add(v),m=aae.bind(null,m,g,v),g.then(m,m))}function aae(m,g,v){var C=m.pingCache;C!==null&&C.delete(g),m.pingedLanes|=m.suspendedLanes&v,m.warmLanes&=~v,Wa===m&&(pa&v)===v&&(wn===4||wn===3&&(pa&62914560)===pa&&300>Ue()-fy?(Ta&2)===0&&Um(m,0):pS|=v,zm===pa&&(zm=0)),lo(m)}function wM(m,g){g===0&&(g=fe()),m=Md(m,g),m!==null&&(te(m,g),lo(m))}function nae(m){var g=m.memoizedState,v=0;g!==null&&(v=g.retryLane),wM(m,v)}function sae(m,g){var v=0;switch(m.tag){case 31:case 13:var C=m.stateNode,O=m.memoizedState;O!==null&&(v=O.retryLane);break;case 19:C=m.stateNode;break;case 22:C=m.stateNode._retryCache;break;default:throw Error(s(314))}C!==null&&C.delete(g),wM(m,v)}function rae(m,g){return rt(m,g)}var vy=null,Hm=null,CS=!1,wy=!1,SS=!1,Lc=0;function lo(m){m!==Hm&&m.next===null&&(Hm===null?vy=Hm=m:Hm=Hm.next=m),wy=!0,CS||(CS=!0,oae())}function rg(m,g){if(!SS&&wy){SS=!0;do for(var v=!1,C=vy;C!==null;){if(m!==0){var O=C.pendingLanes;if(O===0)var R=0;else{var ae=C.suspendedLanes,Se=C.pingedLanes;R=(1<<31-tt(42|m)+1)-1,R&=O&~(ae&~Se),R=R&201326741?R&201326741|1:R?R|2:0}R!==0&&(v=!0,SM(C,R))}else R=pa,R=Ge(C,C===Wa?R:0,C.cancelPendingCommit!==null||C.timeoutHandle!==-1),(R&3)===0||Be(C,R)||(v=!0,SM(C,R));C=C.next}while(v);SS=!1}}function iae(){jM()}function jM(){wy=CS=!1;var m=0;Lc!==0&&xae()&&(m=Lc);for(var g=Ue(),v=null,C=vy;C!==null;){var O=C.next,R=NM(C,g);R===0?(C.next=null,v===null?vy=O:v.next=O,O===null&&(Hm=v)):(v=C,(m!==0||(R&3)!==0)&&(wy=!0)),C=O}Zn!==0&&Zn!==5||rg(m),Lc!==0&&(Lc=0)}function NM(m,g){for(var v=m.suspendedLanes,C=m.pingedLanes,O=m.expirationTimes,R=m.pendingLanes&-62914561;0<R;){var ae=31-tt(R),Se=1<<ae,Ye=O[ae];Ye===-1?((Se&v)===0||(Se&C)!==0)&&(O[ae]=ce(Se,g)):Ye<=g&&(m.expiredLanes|=Se),R&=~Se}if(g=Wa,v=pa,v=Ge(m,m===g?v:0,m.cancelPendingCommit!==null||m.timeoutHandle!==-1),C=m.callbackNode,v===0||m===g&&(Oa===2||Oa===9)||m.cancelPendingCommit!==null)return C!==null&&C!==null&&at(C),m.callbackNode=null,m.callbackPriority=0;if((v&3)===0||Be(m,v)){if(g=v&-v,g===m.callbackPriority)return g;switch(C!==null&&at(C),ie(v)){case 2:case 8:v=je;break;case 32:v=ve;break;case 268435456:v=K;break;default:v=ve}return C=CM.bind(null,m),v=rt(v,C),m.callbackPriority=g,m.callbackNode=v,g}return C!==null&&C!==null&&at(C),m.callbackPriority=2,m.callbackNode=null,2}function CM(m,g){if(Zn!==0&&Zn!==5)return m.callbackNode=null,m.callbackPriority=0,null;var v=m.callbackNode;if(by()&&m.callbackNode!==v)return null;var C=pa;return C=Ge(m,m===Wa?C:0,m.cancelPendingCommit!==null||m.timeoutHandle!==-1),C===0?null:(rM(m,C,g),NM(m,Ue()),m.callbackNode!=null&&m.callbackNode===v?CM.bind(null,m):null)}function SM(m,g){if(by())return null;rM(m,g,!0)}function oae(){bae(function(){(Ta&6)!==0?rt(ze,iae):jM()})}function _S(){if(Lc===0){var m=Tm;m===0&&(m=_t,_t<<=1,(_t&261888)===0&&(_t=256)),Lc=m}return Lc}function _M(m){return m==null||typeof m=="symbol"||typeof m=="boolean"?null:typeof m=="function"?m:k0(""+m)}function AM(m,g){var v=g.ownerDocument.createElement("input");return v.name=g.name,v.value=g.value,m.id&&v.setAttribute("form",m.id),g.parentNode.insertBefore(v,g),m=new FormData(m),v.parentNode.removeChild(v),m}function lae(m,g,v,C,O){if(g==="submit"&&v&&v.stateNode===O){var R=_M((O[Ve]||null).action),ae=C.submitter;ae&&(g=(g=ae[Ve]||null)?_M(g.formAction):ae.getAttribute("formAction"),g!==null&&(R=g,ae=null));var Se=new P0("action","action",null,C,O);m.push({event:Se,listeners:[{instance:null,listener:function(){if(C.defaultPrevented){if(Lc!==0){var Ye=ae?AM(O,ae):new FormData(O);WC(v,{pending:!0,data:Ye,method:O.method,action:R},null,Ye)}}else typeof R=="function"&&(Se.preventDefault(),Ye=ae?AM(O,ae):new FormData(O),WC(v,{pending:!0,data:Ye,method:O.method,action:R},R,Ye))},currentTarget:O}]})}}for(var AS=0;AS<cC.length;AS++){var TS=cC[AS],cae=TS.toLowerCase(),dae=TS[0].toUpperCase()+TS.slice(1);Di(cae,"on"+dae)}Di(s5,"onAnimationEnd"),Di(r5,"onAnimationIteration"),Di(i5,"onAnimationStart"),Di("dblclick","onDoubleClick"),Di("focusin","onFocus"),Di("focusout","onBlur"),Di(_te,"onTransitionRun"),Di(Ate,"onTransitionStart"),Di(Tte,"onTransitionCancel"),Di(o5,"onTransitionEnd"),Yt("onMouseEnter",["mouseout","mouseover"]),Yt("onMouseLeave",["mouseout","mouseover"]),Yt("onPointerEnter",["pointerout","pointerover"]),Yt("onPointerLeave",["pointerout","pointerover"]),kt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),kt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),kt("onBeforeInput",["compositionend","keypress","textInput","paste"]),kt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),kt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),kt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ig="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),uae=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(ig));function TM(m,g){g=(g&4)!==0;for(var v=0;v<m.length;v++){var C=m[v],O=C.event;C=C.listeners;e:{var R=void 0;if(g)for(var ae=C.length-1;0<=ae;ae--){var Se=C[ae],Ye=Se.instance,ct=Se.currentTarget;if(Se=Se.listener,Ye!==R&&O.isPropagationStopped())break e;R=Se,O.currentTarget=ct;try{R(O)}catch(pt){I0(pt)}O.currentTarget=null,R=Ye}else for(ae=0;ae<C.length;ae++){if(Se=C[ae],Ye=Se.instance,ct=Se.currentTarget,Se=Se.listener,Ye!==R&&O.isPropagationStopped())break e;R=Se,O.currentTarget=ct;try{R(O)}catch(pt){I0(pt)}O.currentTarget=null,R=Ye}}}}function ga(m,g){var v=g[St];v===void 0&&(v=g[St]=new Set);var C=m+"__bubble";v.has(C)||(kM(g,m,2,!1),v.add(C))}function kS(m,g,v){var C=0;g&&(C|=4),kM(v,m,C,g)}var jy="_reactListening"+Math.random().toString(36).slice(2);function ES(m){if(!m[jy]){m[jy]=!0,mt.forEach(function(v){v!=="selectionchange"&&(uae.has(v)||kS(v,!1,m),kS(v,!0,m))});var g=m.nodeType===9?m:m.ownerDocument;g===null||g[jy]||(g[jy]=!0,kS("selectionchange",!1,g))}}function kM(m,g,v,C){switch(sI(g)){case 2:var O=zae;break;case 8:O=Fae;break;default:O=GS}v=O.bind(null,g,v,m),O=void 0,!K1||g!=="touchstart"&&g!=="touchmove"&&g!=="wheel"||(O=!0),C?O!==void 0?m.addEventListener(g,v,{capture:!0,passive:O}):m.addEventListener(g,v,!0):O!==void 0?m.addEventListener(g,v,{passive:O}):m.addEventListener(g,v,!1)}function LS(m,g,v,C,O){var R=C;if((g&1)===0&&(g&2)===0&&C!==null)e:for(;;){if(C===null)return;var ae=C.tag;if(ae===3||ae===4){var Se=C.stateNode.containerInfo;if(Se===O)break;if(ae===4)for(ae=C.return;ae!==null;){var Ye=ae.tag;if((Ye===3||Ye===4)&&ae.stateNode.containerInfo===O)return;ae=ae.return}for(;Se!==null;){if(ae=L(Se),ae===null)return;if(Ye=ae.tag,Ye===5||Ye===6||Ye===26||Ye===27){C=R=ae;continue e}Se=Se.parentNode}}C=C.return}O3(function(){var ct=R,pt=Y1(v),Nt=[];e:{var ut=l5.get(m);if(ut!==void 0){var gt=P0,Ft=m;switch(m){case"keypress":if(L0(v)===0)break e;case"keydown":case"keyup":gt=ste;break;case"focusin":Ft="focus",gt=eC;break;case"focusout":Ft="blur",gt=eC;break;case"beforeblur":case"afterblur":gt=eC;break;case"click":if(v.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":gt=$3;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":gt=Wee;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":gt=ote;break;case s5:case r5:case i5:gt=Qee;break;case o5:gt=cte;break;case"scroll":case"scrollend":gt=qee;break;case"wheel":gt=ute;break;case"copy":case"cut":case"paste":gt=Xee;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":gt=z3;break;case"toggle":case"beforetoggle":gt=fte}var Jt=(g&4)!==0,Ha=!Jt&&(m==="scroll"||m==="scrollend"),nt=Jt?ut!==null?ut+"Capture":null:ut;Jt=[];for(var Xe=ct,lt;Xe!==null;){var vt=Xe;if(lt=vt.stateNode,vt=vt.tag,vt!==5&&vt!==26&&vt!==27||lt===null||nt===null||(vt=Th(Xe,nt),vt!=null&&Jt.push(og(Xe,vt,lt))),Ha)break;Xe=Xe.return}0<Jt.length&&(ut=new gt(ut,Ft,null,v,pt),Nt.push({event:ut,listeners:Jt}))}}if((g&7)===0){e:{if(ut=m==="mouseover"||m==="pointerover",gt=m==="mouseout"||m==="pointerout",ut&&v!==V1&&(Ft=v.relatedTarget||v.fromElement)&&(L(Ft)||Ft[ft]))break e;if((gt||ut)&&(ut=pt.window===pt?pt:(ut=pt.ownerDocument)?ut.defaultView||ut.parentWindow:window,gt?(Ft=v.relatedTarget||v.toElement,gt=ct,Ft=Ft?L(Ft):null,Ft!==null&&(Ha=i(Ft),Jt=Ft.tag,Ft!==Ha||Jt!==5&&Jt!==27&&Jt!==6)&&(Ft=null)):(gt=null,Ft=ct),gt!==Ft)){if(Jt=$3,vt="onMouseLeave",nt="onMouseEnter",Xe="mouse",(m==="pointerout"||m==="pointerover")&&(Jt=z3,vt="onPointerLeave",nt="onPointerEnter",Xe="pointer"),Ha=gt==null?ut:ke(gt),lt=Ft==null?ut:ke(Ft),ut=new Jt(vt,Xe+"leave",gt,v,pt),ut.target=Ha,ut.relatedTarget=lt,vt=null,L(pt)===ct&&(Jt=new Jt(nt,Xe+"enter",Ft,v,pt),Jt.target=lt,Jt.relatedTarget=Ha,vt=Jt),Ha=vt,gt&&Ft)t:{for(Jt=mae,nt=gt,Xe=Ft,lt=0,vt=nt;vt;vt=Jt(vt))lt++;vt=0;for(var Xt=Xe;Xt;Xt=Jt(Xt))vt++;for(;0<lt-vt;)nt=Jt(nt),lt--;for(;0<vt-lt;)Xe=Jt(Xe),vt--;for(;lt--;){if(nt===Xe||Xe!==null&&nt===Xe.alternate){Jt=nt;break t}nt=Jt(nt),Xe=Jt(Xe)}Jt=null}else Jt=null;gt!==null&&EM(Nt,ut,gt,Jt,!1),Ft!==null&&Ha!==null&&EM(Nt,Ha,Ft,Jt,!0)}}e:{if(ut=ct?ke(ct):window,gt=ut.nodeName&&ut.nodeName.toLowerCase(),gt==="select"||gt==="input"&&ut.type==="file")var Ca=V3;else if(G3(ut))if(Y3)Ca=Nte;else{Ca=wte;var Wt=vte}else gt=ut.nodeName,!gt||gt.toLowerCase()!=="input"||ut.type!=="checkbox"&&ut.type!=="radio"?ct&&W1(ct.elementType)&&(Ca=V3):Ca=jte;if(Ca&&(Ca=Ca(m,ct))){W3(Nt,Ca,v,pt);break e}Wt&&Wt(m,ut,ct),m==="focusout"&&ct&&ut.type==="number"&&ct.memoizedProps.value!=null&&G1(ut,"number",ut.value)}switch(Wt=ct?ke(ct):window,m){case"focusin":(G3(Wt)||Wt.contentEditable==="true")&&(vm=Wt,iC=ct,Ih=null);break;case"focusout":Ih=iC=vm=null;break;case"mousedown":oC=!0;break;case"contextmenu":case"mouseup":case"dragend":oC=!1,a5(Nt,v,pt);break;case"selectionchange":if(Ste)break;case"keydown":case"keyup":a5(Nt,v,pt)}var ua;if(aC)e:{switch(m){case"compositionstart":var xa="onCompositionStart";break e;case"compositionend":xa="onCompositionEnd";break e;case"compositionupdate":xa="onCompositionUpdate";break e}xa=void 0}else bm?H3(m,v)&&(xa="onCompositionEnd"):m==="keydown"&&v.keyCode===229&&(xa="onCompositionStart");xa&&(F3&&v.locale!=="ko"&&(bm||xa!=="onCompositionStart"?xa==="onCompositionEnd"&&bm&&(ua=M3()):(gc=pt,X1="value"in gc?gc.value:gc.textContent,bm=!0)),Wt=Ny(ct,xa),0<Wt.length&&(xa=new R3(xa,m,null,v,pt),Nt.push({event:xa,listeners:Wt}),ua?xa.data=ua:(ua=q3(v),ua!==null&&(xa.data=ua)))),(ua=gte?pte(m,v):xte(m,v))&&(xa=Ny(ct,"onBeforeInput"),0<xa.length&&(Wt=new R3("onBeforeInput","beforeinput",null,v,pt),Nt.push({event:Wt,listeners:xa}),Wt.data=ua)),lae(Nt,m,ct,v,pt)}TM(Nt,g)})}function og(m,g,v){return{instance:m,listener:g,currentTarget:v}}function Ny(m,g){for(var v=g+"Capture",C=[];m!==null;){var O=m,R=O.stateNode;if(O=O.tag,O!==5&&O!==26&&O!==27||R===null||(O=Th(m,v),O!=null&&C.unshift(og(m,O,R)),O=Th(m,g),O!=null&&C.push(og(m,O,R))),m.tag===3)return C;m=m.return}return[]}function mae(m){if(m===null)return null;do m=m.return;while(m&&m.tag!==5&&m.tag!==27);return m||null}function EM(m,g,v,C,O){for(var R=g._reactName,ae=[];v!==null&&v!==C;){var Se=v,Ye=Se.alternate,ct=Se.stateNode;if(Se=Se.tag,Ye!==null&&Ye===C)break;Se!==5&&Se!==26&&Se!==27||ct===null||(Ye=ct,O?(ct=Th(v,R),ct!=null&&ae.unshift(og(v,ct,Ye))):O||(ct=Th(v,R),ct!=null&&ae.push(og(v,ct,Ye)))),v=v.return}ae.length!==0&&m.push({event:g,listeners:ae})}var fae=/\r\n?/g,hae=/\u0000|\uFFFD/g;function LM(m){return(typeof m=="string"?m:""+m).replace(fae,`
`).replace(hae,"")}function DM(m,g){return g=LM(g),LM(m)===g}function Ba(m,g,v,C,O,R){switch(v){case"children":typeof C=="string"?g==="body"||g==="textarea"&&C===""||pm(m,C):(typeof C=="number"||typeof C=="bigint")&&g!=="body"&&pm(m,""+C);break;case"className":A0(m,"class",C);break;case"tabIndex":A0(m,"tabindex",C);break;case"dir":case"role":case"viewBox":case"width":case"height":A0(m,v,C);break;case"style":D3(m,C,R);break;case"data":if(g!=="object"){A0(m,"data",C);break}case"src":case"href":if(C===""&&(g!=="a"||v!=="href")){m.removeAttribute(v);break}if(C==null||typeof C=="function"||typeof C=="symbol"||typeof C=="boolean"){m.removeAttribute(v);break}C=k0(""+C),m.setAttribute(v,C);break;case"action":case"formAction":if(typeof C=="function"){m.setAttribute(v,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof R=="function"&&(v==="formAction"?(g!=="input"&&Ba(m,g,"name",O.name,O,null),Ba(m,g,"formEncType",O.formEncType,O,null),Ba(m,g,"formMethod",O.formMethod,O,null),Ba(m,g,"formTarget",O.formTarget,O,null)):(Ba(m,g,"encType",O.encType,O,null),Ba(m,g,"method",O.method,O,null),Ba(m,g,"target",O.target,O,null)));if(C==null||typeof C=="symbol"||typeof C=="boolean"){m.removeAttribute(v);break}C=k0(""+C),m.setAttribute(v,C);break;case"onClick":C!=null&&(m.onclick=Jo);break;case"onScroll":C!=null&&ga("scroll",m);break;case"onScrollEnd":C!=null&&ga("scrollend",m);break;case"dangerouslySetInnerHTML":if(C!=null){if(typeof C!="object"||!("__html"in C))throw Error(s(61));if(v=C.__html,v!=null){if(O.children!=null)throw Error(s(60));m.innerHTML=v}}break;case"multiple":m.multiple=C&&typeof C!="function"&&typeof C!="symbol";break;case"muted":m.muted=C&&typeof C!="function"&&typeof C!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(C==null||typeof C=="function"||typeof C=="boolean"||typeof C=="symbol"){m.removeAttribute("xlink:href");break}v=k0(""+C),m.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",v);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":C!=null&&typeof C!="function"&&typeof C!="symbol"?m.setAttribute(v,""+C):m.removeAttribute(v);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":C&&typeof C!="function"&&typeof C!="symbol"?m.setAttribute(v,""):m.removeAttribute(v);break;case"capture":case"download":C===!0?m.setAttribute(v,""):C!==!1&&C!=null&&typeof C!="function"&&typeof C!="symbol"?m.setAttribute(v,C):m.removeAttribute(v);break;case"cols":case"rows":case"size":case"span":C!=null&&typeof C!="function"&&typeof C!="symbol"&&!isNaN(C)&&1<=C?m.setAttribute(v,C):m.removeAttribute(v);break;case"rowSpan":case"start":C==null||typeof C=="function"||typeof C=="symbol"||isNaN(C)?m.removeAttribute(v):m.setAttribute(v,C);break;case"popover":ga("beforetoggle",m),ga("toggle",m),_0(m,"popover",C);break;case"xlinkActuate":Zo(m,"http://www.w3.org/1999/xlink","xlink:actuate",C);break;case"xlinkArcrole":Zo(m,"http://www.w3.org/1999/xlink","xlink:arcrole",C);break;case"xlinkRole":Zo(m,"http://www.w3.org/1999/xlink","xlink:role",C);break;case"xlinkShow":Zo(m,"http://www.w3.org/1999/xlink","xlink:show",C);break;case"xlinkTitle":Zo(m,"http://www.w3.org/1999/xlink","xlink:title",C);break;case"xlinkType":Zo(m,"http://www.w3.org/1999/xlink","xlink:type",C);break;case"xmlBase":Zo(m,"http://www.w3.org/XML/1998/namespace","xml:base",C);break;case"xmlLang":Zo(m,"http://www.w3.org/XML/1998/namespace","xml:lang",C);break;case"xmlSpace":Zo(m,"http://www.w3.org/XML/1998/namespace","xml:space",C);break;case"is":_0(m,"is",C);break;case"innerText":case"textContent":break;default:(!(2<v.length)||v[0]!=="o"&&v[0]!=="O"||v[1]!=="n"&&v[1]!=="N")&&(v=Bee.get(v)||v,_0(m,v,C))}}function DS(m,g,v,C,O,R){switch(v){case"style":D3(m,C,R);break;case"dangerouslySetInnerHTML":if(C!=null){if(typeof C!="object"||!("__html"in C))throw Error(s(61));if(v=C.__html,v!=null){if(O.children!=null)throw Error(s(60));m.innerHTML=v}}break;case"children":typeof C=="string"?pm(m,C):(typeof C=="number"||typeof C=="bigint")&&pm(m,""+C);break;case"onScroll":C!=null&&ga("scroll",m);break;case"onScrollEnd":C!=null&&ga("scrollend",m);break;case"onClick":C!=null&&(m.onclick=Jo);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Tt.hasOwnProperty(v))e:{if(v[0]==="o"&&v[1]==="n"&&(O=v.endsWith("Capture"),g=v.slice(2,O?v.length-7:void 0),R=m[Ve]||null,R=R!=null?R[v]:null,typeof R=="function"&&m.removeEventListener(g,R,O),typeof C=="function")){typeof R!="function"&&R!==null&&(v in m?m[v]=null:m.hasAttribute(v)&&m.removeAttribute(v)),m.addEventListener(g,C,O);break e}v in m?m[v]=C:C===!0?m.setAttribute(v,""):_0(m,v,C)}}}function _s(m,g,v){switch(g){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ga("error",m),ga("load",m);var C=!1,O=!1,R;for(R in v)if(v.hasOwnProperty(R)){var ae=v[R];if(ae!=null)switch(R){case"src":C=!0;break;case"srcSet":O=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,g));default:Ba(m,g,R,ae,v,null)}}O&&Ba(m,g,"srcSet",v.srcSet,v,null),C&&Ba(m,g,"src",v.src,v,null);return;case"input":ga("invalid",m);var Se=R=ae=O=null,Ye=null,ct=null;for(C in v)if(v.hasOwnProperty(C)){var pt=v[C];if(pt!=null)switch(C){case"name":O=pt;break;case"type":ae=pt;break;case"checked":Ye=pt;break;case"defaultChecked":ct=pt;break;case"value":R=pt;break;case"defaultValue":Se=pt;break;case"children":case"dangerouslySetInnerHTML":if(pt!=null)throw Error(s(137,g));break;default:Ba(m,g,C,pt,v,null)}}T3(m,R,Se,Ye,ct,ae,O,!1);return;case"select":ga("invalid",m),C=ae=R=null;for(O in v)if(v.hasOwnProperty(O)&&(Se=v[O],Se!=null))switch(O){case"value":R=Se;break;case"defaultValue":ae=Se;break;case"multiple":C=Se;default:Ba(m,g,O,Se,v,null)}g=R,v=ae,m.multiple=!!C,g!=null?gm(m,!!C,g,!1):v!=null&&gm(m,!!C,v,!0);return;case"textarea":ga("invalid",m),R=O=C=null;for(ae in v)if(v.hasOwnProperty(ae)&&(Se=v[ae],Se!=null))switch(ae){case"value":C=Se;break;case"defaultValue":O=Se;break;case"children":R=Se;break;case"dangerouslySetInnerHTML":if(Se!=null)throw Error(s(91));break;default:Ba(m,g,ae,Se,v,null)}E3(m,C,O,R);return;case"option":for(Ye in v)v.hasOwnProperty(Ye)&&(C=v[Ye],C!=null)&&(Ye==="selected"?m.selected=C&&typeof C!="function"&&typeof C!="symbol":Ba(m,g,Ye,C,v,null));return;case"dialog":ga("beforetoggle",m),ga("toggle",m),ga("cancel",m),ga("close",m);break;case"iframe":case"object":ga("load",m);break;case"video":case"audio":for(C=0;C<ig.length;C++)ga(ig[C],m);break;case"image":ga("error",m),ga("load",m);break;case"details":ga("toggle",m);break;case"embed":case"source":case"link":ga("error",m),ga("load",m);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ct in v)if(v.hasOwnProperty(ct)&&(C=v[ct],C!=null))switch(ct){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,g));default:Ba(m,g,ct,C,v,null)}return;default:if(W1(g)){for(pt in v)v.hasOwnProperty(pt)&&(C=v[pt],C!==void 0&&DS(m,g,pt,C,v,void 0));return}}for(Se in v)v.hasOwnProperty(Se)&&(C=v[Se],C!=null&&Ba(m,g,Se,C,v,null))}function gae(m,g,v,C){switch(g){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var O=null,R=null,ae=null,Se=null,Ye=null,ct=null,pt=null;for(gt in v){var Nt=v[gt];if(v.hasOwnProperty(gt)&&Nt!=null)switch(gt){case"checked":break;case"value":break;case"defaultValue":Ye=Nt;default:C.hasOwnProperty(gt)||Ba(m,g,gt,null,C,Nt)}}for(var ut in C){var gt=C[ut];if(Nt=v[ut],C.hasOwnProperty(ut)&&(gt!=null||Nt!=null))switch(ut){case"type":R=gt;break;case"name":O=gt;break;case"checked":ct=gt;break;case"defaultChecked":pt=gt;break;case"value":ae=gt;break;case"defaultValue":Se=gt;break;case"children":case"dangerouslySetInnerHTML":if(gt!=null)throw Error(s(137,g));break;default:gt!==Nt&&Ba(m,g,ut,gt,C,Nt)}}q1(m,ae,Se,Ye,ct,pt,R,O);return;case"select":gt=ae=Se=ut=null;for(R in v)if(Ye=v[R],v.hasOwnProperty(R)&&Ye!=null)switch(R){case"value":break;case"multiple":gt=Ye;default:C.hasOwnProperty(R)||Ba(m,g,R,null,C,Ye)}for(O in C)if(R=C[O],Ye=v[O],C.hasOwnProperty(O)&&(R!=null||Ye!=null))switch(O){case"value":ut=R;break;case"defaultValue":Se=R;break;case"multiple":ae=R;default:R!==Ye&&Ba(m,g,O,R,C,Ye)}g=Se,v=ae,C=gt,ut!=null?gm(m,!!v,ut,!1):!!C!=!!v&&(g!=null?gm(m,!!v,g,!0):gm(m,!!v,v?[]:"",!1));return;case"textarea":gt=ut=null;for(Se in v)if(O=v[Se],v.hasOwnProperty(Se)&&O!=null&&!C.hasOwnProperty(Se))switch(Se){case"value":break;case"children":break;default:Ba(m,g,Se,null,C,O)}for(ae in C)if(O=C[ae],R=v[ae],C.hasOwnProperty(ae)&&(O!=null||R!=null))switch(ae){case"value":ut=O;break;case"defaultValue":gt=O;break;case"children":break;case"dangerouslySetInnerHTML":if(O!=null)throw Error(s(91));break;default:O!==R&&Ba(m,g,ae,O,C,R)}k3(m,ut,gt);return;case"option":for(var Ft in v)ut=v[Ft],v.hasOwnProperty(Ft)&&ut!=null&&!C.hasOwnProperty(Ft)&&(Ft==="selected"?m.selected=!1:Ba(m,g,Ft,null,C,ut));for(Ye in C)ut=C[Ye],gt=v[Ye],C.hasOwnProperty(Ye)&&ut!==gt&&(ut!=null||gt!=null)&&(Ye==="selected"?m.selected=ut&&typeof ut!="function"&&typeof ut!="symbol":Ba(m,g,Ye,ut,C,gt));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Jt in v)ut=v[Jt],v.hasOwnProperty(Jt)&&ut!=null&&!C.hasOwnProperty(Jt)&&Ba(m,g,Jt,null,C,ut);for(ct in C)if(ut=C[ct],gt=v[ct],C.hasOwnProperty(ct)&&ut!==gt&&(ut!=null||gt!=null))switch(ct){case"children":case"dangerouslySetInnerHTML":if(ut!=null)throw Error(s(137,g));break;default:Ba(m,g,ct,ut,C,gt)}return;default:if(W1(g)){for(var Ha in v)ut=v[Ha],v.hasOwnProperty(Ha)&&ut!==void 0&&!C.hasOwnProperty(Ha)&&DS(m,g,Ha,void 0,C,ut);for(pt in C)ut=C[pt],gt=v[pt],!C.hasOwnProperty(pt)||ut===gt||ut===void 0&&gt===void 0||DS(m,g,pt,ut,C,gt);return}}for(var nt in v)ut=v[nt],v.hasOwnProperty(nt)&&ut!=null&&!C.hasOwnProperty(nt)&&Ba(m,g,nt,null,C,ut);for(Nt in C)ut=C[Nt],gt=v[Nt],!C.hasOwnProperty(Nt)||ut===gt||ut==null&&gt==null||Ba(m,g,Nt,ut,C,gt)}function PM(m){switch(m){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function pae(){if(typeof performance.getEntriesByType=="function"){for(var m=0,g=0,v=performance.getEntriesByType("resource"),C=0;C<v.length;C++){var O=v[C],R=O.transferSize,ae=O.initiatorType,Se=O.duration;if(R&&Se&&PM(ae)){for(ae=0,Se=O.responseEnd,C+=1;C<v.length;C++){var Ye=v[C],ct=Ye.startTime;if(ct>Se)break;var pt=Ye.transferSize,Nt=Ye.initiatorType;pt&&PM(Nt)&&(Ye=Ye.responseEnd,ae+=pt*(Ye<Se?1:(Se-ct)/(Ye-ct)))}if(--C,g+=8*(R+ae)/(O.duration/1e3),m++,10<m)break}}if(0<m)return g/m/1e6}return navigator.connection&&(m=navigator.connection.downlink,typeof m=="number")?m:5}var PS=null,OS=null;function Cy(m){return m.nodeType===9?m:m.ownerDocument}function OM(m){switch(m){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function MM(m,g){if(m===0)switch(g){case"svg":return 1;case"math":return 2;default:return 0}return m===1&&g==="foreignObject"?0:m}function MS(m,g){return m==="textarea"||m==="noscript"||typeof g.children=="string"||typeof g.children=="number"||typeof g.children=="bigint"||typeof g.dangerouslySetInnerHTML=="object"&&g.dangerouslySetInnerHTML!==null&&g.dangerouslySetInnerHTML.__html!=null}var IS=null;function xae(){var m=window.event;return m&&m.type==="popstate"?m===IS?!1:(IS=m,!0):(IS=null,!1)}var IM=typeof setTimeout=="function"?setTimeout:void 0,yae=typeof clearTimeout=="function"?clearTimeout:void 0,$M=typeof Promise=="function"?Promise:void 0,bae=typeof queueMicrotask=="function"?queueMicrotask:typeof $M<"u"?function(m){return $M.resolve(null).then(m).catch(vae)}:IM;function vae(m){setTimeout(function(){throw m})}function Dc(m){return m==="head"}function RM(m,g){var v=g,C=0;do{var O=v.nextSibling;if(m.removeChild(v),O&&O.nodeType===8)if(v=O.data,v==="/$"||v==="/&"){if(C===0){m.removeChild(O),Vm(g);return}C--}else if(v==="$"||v==="$?"||v==="$~"||v==="$!"||v==="&")C++;else if(v==="html")lg(m.ownerDocument.documentElement);else if(v==="head"){v=m.ownerDocument.head,lg(v);for(var R=v.firstChild;R;){var ae=R.nextSibling,Se=R.nodeName;R[_e]||Se==="SCRIPT"||Se==="STYLE"||Se==="LINK"&&R.rel.toLowerCase()==="stylesheet"||v.removeChild(R),R=ae}}else v==="body"&&lg(m.ownerDocument.body);v=O}while(v);Vm(g)}function zM(m,g){var v=m;m=0;do{var C=v.nextSibling;if(v.nodeType===1?g?(v._stashedDisplay=v.style.display,v.style.display="none"):(v.style.display=v._stashedDisplay||"",v.getAttribute("style")===""&&v.removeAttribute("style")):v.nodeType===3&&(g?(v._stashedText=v.nodeValue,v.nodeValue=""):v.nodeValue=v._stashedText||""),C&&C.nodeType===8)if(v=C.data,v==="/$"){if(m===0)break;m--}else v!=="$"&&v!=="$?"&&v!=="$~"&&v!=="$!"||m++;v=C}while(v)}function $S(m){var g=m.firstChild;for(g&&g.nodeType===10&&(g=g.nextSibling);g;){var v=g;switch(g=g.nextSibling,v.nodeName){case"HTML":case"HEAD":case"BODY":$S(v),I(v);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(v.rel.toLowerCase()==="stylesheet")continue}m.removeChild(v)}}function wae(m,g,v,C){for(;m.nodeType===1;){var O=v;if(m.nodeName.toLowerCase()!==g.toLowerCase()){if(!C&&(m.nodeName!=="INPUT"||m.type!=="hidden"))break}else if(C){if(!m[_e])switch(g){case"meta":if(!m.hasAttribute("itemprop"))break;return m;case"link":if(R=m.getAttribute("rel"),R==="stylesheet"&&m.hasAttribute("data-precedence"))break;if(R!==O.rel||m.getAttribute("href")!==(O.href==null||O.href===""?null:O.href)||m.getAttribute("crossorigin")!==(O.crossOrigin==null?null:O.crossOrigin)||m.getAttribute("title")!==(O.title==null?null:O.title))break;return m;case"style":if(m.hasAttribute("data-precedence"))break;return m;case"script":if(R=m.getAttribute("src"),(R!==(O.src==null?null:O.src)||m.getAttribute("type")!==(O.type==null?null:O.type)||m.getAttribute("crossorigin")!==(O.crossOrigin==null?null:O.crossOrigin))&&R&&m.hasAttribute("async")&&!m.hasAttribute("itemprop"))break;return m;default:return m}}else if(g==="input"&&m.type==="hidden"){var R=O.name==null?null:""+O.name;if(O.type==="hidden"&&m.getAttribute("name")===R)return m}else return m;if(m=si(m.nextSibling),m===null)break}return null}function jae(m,g,v){if(g==="")return null;for(;m.nodeType!==3;)if((m.nodeType!==1||m.nodeName!=="INPUT"||m.type!=="hidden")&&!v||(m=si(m.nextSibling),m===null))return null;return m}function FM(m,g){for(;m.nodeType!==8;)if((m.nodeType!==1||m.nodeName!=="INPUT"||m.type!=="hidden")&&!g||(m=si(m.nextSibling),m===null))return null;return m}function RS(m){return m.data==="$?"||m.data==="$~"}function zS(m){return m.data==="$!"||m.data==="$?"&&m.ownerDocument.readyState!=="loading"}function Nae(m,g){var v=m.ownerDocument;if(m.data==="$~")m._reactRetry=g;else if(m.data!=="$?"||v.readyState!=="loading")g();else{var C=function(){g(),v.removeEventListener("DOMContentLoaded",C)};v.addEventListener("DOMContentLoaded",C),m._reactRetry=C}}function si(m){for(;m!=null;m=m.nextSibling){var g=m.nodeType;if(g===1||g===3)break;if(g===8){if(g=m.data,g==="$"||g==="$!"||g==="$?"||g==="$~"||g==="&"||g==="F!"||g==="F")break;if(g==="/$"||g==="/&")return null}}return m}var FS=null;function UM(m){m=m.nextSibling;for(var g=0;m;){if(m.nodeType===8){var v=m.data;if(v==="/$"||v==="/&"){if(g===0)return si(m.nextSibling);g--}else v!=="$"&&v!=="$!"&&v!=="$?"&&v!=="$~"&&v!=="&"||g++}m=m.nextSibling}return null}function BM(m){m=m.previousSibling;for(var g=0;m;){if(m.nodeType===8){var v=m.data;if(v==="$"||v==="$!"||v==="$?"||v==="$~"||v==="&"){if(g===0)return m;g--}else v!=="/$"&&v!=="/&"||g++}m=m.previousSibling}return null}function HM(m,g,v){switch(g=Cy(v),m){case"html":if(m=g.documentElement,!m)throw Error(s(452));return m;case"head":if(m=g.head,!m)throw Error(s(453));return m;case"body":if(m=g.body,!m)throw Error(s(454));return m;default:throw Error(s(451))}}function lg(m){for(var g=m.attributes;g.length;)m.removeAttributeNode(g[0]);I(m)}var ri=new Map,qM=new Set;function Sy(m){return typeof m.getRootNode=="function"?m.getRootNode():m.nodeType===9?m:m.ownerDocument}var gl=Z.d;Z.d={f:Cae,r:Sae,D:_ae,C:Aae,L:Tae,m:kae,X:Lae,S:Eae,M:Dae};function Cae(){var m=gl.f(),g=py();return m||g}function Sae(m){var g=ee(m);g!==null&&g.tag===5&&g.type==="form"?oO(g):gl.r(m)}var qm=typeof document>"u"?null:document;function GM(m,g,v){var C=qm;if(C&&typeof g=="string"&&g){var O=Xr(g);O='link[rel="'+m+'"][href="'+O+'"]',typeof v=="string"&&(O+='[crossorigin="'+v+'"]'),qM.has(O)||(qM.add(O),m={rel:m,crossOrigin:v,href:g},C.querySelector(O)===null&&(g=C.createElement("link"),_s(g,"link",m),We(g),C.head.appendChild(g)))}}function _ae(m){gl.D(m),GM("dns-prefetch",m,null)}function Aae(m,g){gl.C(m,g),GM("preconnect",m,g)}function Tae(m,g,v){gl.L(m,g,v);var C=qm;if(C&&m&&g){var O='link[rel="preload"][as="'+Xr(g)+'"]';g==="image"&&v&&v.imageSrcSet?(O+='[imagesrcset="'+Xr(v.imageSrcSet)+'"]',typeof v.imageSizes=="string"&&(O+='[imagesizes="'+Xr(v.imageSizes)+'"]')):O+='[href="'+Xr(m)+'"]';var R=O;switch(g){case"style":R=Gm(m);break;case"script":R=Wm(m)}ri.has(R)||(m=h({rel:"preload",href:g==="image"&&v&&v.imageSrcSet?void 0:m,as:g},v),ri.set(R,m),C.querySelector(O)!==null||g==="style"&&C.querySelector(cg(R))||g==="script"&&C.querySelector(dg(R))||(g=C.createElement("link"),_s(g,"link",m),We(g),C.head.appendChild(g)))}}function kae(m,g){gl.m(m,g);var v=qm;if(v&&m){var C=g&&typeof g.as=="string"?g.as:"script",O='link[rel="modulepreload"][as="'+Xr(C)+'"][href="'+Xr(m)+'"]',R=O;switch(C){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":R=Wm(m)}if(!ri.has(R)&&(m=h({rel:"modulepreload",href:m},g),ri.set(R,m),v.querySelector(O)===null)){switch(C){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(v.querySelector(dg(R)))return}C=v.createElement("link"),_s(C,"link",m),We(C),v.head.appendChild(C)}}}function Eae(m,g,v){gl.S(m,g,v);var C=qm;if(C&&m){var O=$e(C).hoistableStyles,R=Gm(m);g=g||"default";var ae=O.get(R);if(!ae){var Se={loading:0,preload:null};if(ae=C.querySelector(cg(R)))Se.loading=5;else{m=h({rel:"stylesheet",href:m,"data-precedence":g},v),(v=ri.get(R))&&US(m,v);var Ye=ae=C.createElement("link");We(Ye),_s(Ye,"link",m),Ye._p=new Promise(function(ct,pt){Ye.onload=ct,Ye.onerror=pt}),Ye.addEventListener("load",function(){Se.loading|=1}),Ye.addEventListener("error",function(){Se.loading|=2}),Se.loading|=4,_y(ae,g,C)}ae={type:"stylesheet",instance:ae,count:1,state:Se},O.set(R,ae)}}}function Lae(m,g){gl.X(m,g);var v=qm;if(v&&m){var C=$e(v).hoistableScripts,O=Wm(m),R=C.get(O);R||(R=v.querySelector(dg(O)),R||(m=h({src:m,async:!0},g),(g=ri.get(O))&&BS(m,g),R=v.createElement("script"),We(R),_s(R,"link",m),v.head.appendChild(R)),R={type:"script",instance:R,count:1,state:null},C.set(O,R))}}function Dae(m,g){gl.M(m,g);var v=qm;if(v&&m){var C=$e(v).hoistableScripts,O=Wm(m),R=C.get(O);R||(R=v.querySelector(dg(O)),R||(m=h({src:m,async:!0,type:"module"},g),(g=ri.get(O))&&BS(m,g),R=v.createElement("script"),We(R),_s(R,"link",m),v.head.appendChild(R)),R={type:"script",instance:R,count:1,state:null},C.set(O,R))}}function WM(m,g,v,C){var O=(O=be.current)?Sy(O):null;if(!O)throw Error(s(446));switch(m){case"meta":case"title":return null;case"style":return typeof v.precedence=="string"&&typeof v.href=="string"?(g=Gm(v.href),v=$e(O).hoistableStyles,C=v.get(g),C||(C={type:"style",instance:null,count:0,state:null},v.set(g,C)),C):{type:"void",instance:null,count:0,state:null};case"link":if(v.rel==="stylesheet"&&typeof v.href=="string"&&typeof v.precedence=="string"){m=Gm(v.href);var R=$e(O).hoistableStyles,ae=R.get(m);if(ae||(O=O.ownerDocument||O,ae={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},R.set(m,ae),(R=O.querySelector(cg(m)))&&!R._p&&(ae.instance=R,ae.state.loading=5),ri.has(m)||(v={rel:"preload",as:"style",href:v.href,crossOrigin:v.crossOrigin,integrity:v.integrity,media:v.media,hrefLang:v.hrefLang,referrerPolicy:v.referrerPolicy},ri.set(m,v),R||Pae(O,m,v,ae.state))),g&&C===null)throw Error(s(528,""));return ae}if(g&&C!==null)throw Error(s(529,""));return null;case"script":return g=v.async,v=v.src,typeof v=="string"&&g&&typeof g!="function"&&typeof g!="symbol"?(g=Wm(v),v=$e(O).hoistableScripts,C=v.get(g),C||(C={type:"script",instance:null,count:0,state:null},v.set(g,C)),C):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,m))}}function Gm(m){return'href="'+Xr(m)+'"'}function cg(m){return'link[rel="stylesheet"]['+m+"]"}function VM(m){return h({},m,{"data-precedence":m.precedence,precedence:null})}function Pae(m,g,v,C){m.querySelector('link[rel="preload"][as="style"]['+g+"]")?C.loading=1:(g=m.createElement("link"),C.preload=g,g.addEventListener("load",function(){return C.loading|=1}),g.addEventListener("error",function(){return C.loading|=2}),_s(g,"link",v),We(g),m.head.appendChild(g))}function Wm(m){return'[src="'+Xr(m)+'"]'}function dg(m){return"script[async]"+m}function YM(m,g,v){if(g.count++,g.instance===null)switch(g.type){case"style":var C=m.querySelector('style[data-href~="'+Xr(v.href)+'"]');if(C)return g.instance=C,We(C),C;var O=h({},v,{"data-href":v.href,"data-precedence":v.precedence,href:null,precedence:null});return C=(m.ownerDocument||m).createElement("style"),We(C),_s(C,"style",O),_y(C,v.precedence,m),g.instance=C;case"stylesheet":O=Gm(v.href);var R=m.querySelector(cg(O));if(R)return g.state.loading|=4,g.instance=R,We(R),R;C=VM(v),(O=ri.get(O))&&US(C,O),R=(m.ownerDocument||m).createElement("link"),We(R);var ae=R;return ae._p=new Promise(function(Se,Ye){ae.onload=Se,ae.onerror=Ye}),_s(R,"link",C),g.state.loading|=4,_y(R,v.precedence,m),g.instance=R;case"script":return R=Wm(v.src),(O=m.querySelector(dg(R)))?(g.instance=O,We(O),O):(C=v,(O=ri.get(R))&&(C=h({},v),BS(C,O)),m=m.ownerDocument||m,O=m.createElement("script"),We(O),_s(O,"link",C),m.head.appendChild(O),g.instance=O);case"void":return null;default:throw Error(s(443,g.type))}else g.type==="stylesheet"&&(g.state.loading&4)===0&&(C=g.instance,g.state.loading|=4,_y(C,v.precedence,m));return g.instance}function _y(m,g,v){for(var C=v.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),O=C.length?C[C.length-1]:null,R=O,ae=0;ae<C.length;ae++){var Se=C[ae];if(Se.dataset.precedence===g)R=Se;else if(R!==O)break}R?R.parentNode.insertBefore(m,R.nextSibling):(g=v.nodeType===9?v.head:v,g.insertBefore(m,g.firstChild))}function US(m,g){m.crossOrigin==null&&(m.crossOrigin=g.crossOrigin),m.referrerPolicy==null&&(m.referrerPolicy=g.referrerPolicy),m.title==null&&(m.title=g.title)}function BS(m,g){m.crossOrigin==null&&(m.crossOrigin=g.crossOrigin),m.referrerPolicy==null&&(m.referrerPolicy=g.referrerPolicy),m.integrity==null&&(m.integrity=g.integrity)}var Ay=null;function QM(m,g,v){if(Ay===null){var C=new Map,O=Ay=new Map;O.set(v,C)}else O=Ay,C=O.get(v),C||(C=new Map,O.set(v,C));if(C.has(m))return C;for(C.set(m,null),v=v.getElementsByTagName(m),O=0;O<v.length;O++){var R=v[O];if(!(R[_e]||R[Pe]||m==="link"&&R.getAttribute("rel")==="stylesheet")&&R.namespaceURI!=="http://www.w3.org/2000/svg"){var ae=R.getAttribute(g)||"";ae=m+ae;var Se=C.get(ae);Se?Se.push(R):C.set(ae,[R])}}return C}function KM(m,g,v){m=m.ownerDocument||m,m.head.insertBefore(v,g==="title"?m.querySelector("head > title"):null)}function Oae(m,g,v){if(v===1||g.itemProp!=null)return!1;switch(m){case"meta":case"title":return!0;case"style":if(typeof g.precedence!="string"||typeof g.href!="string"||g.href==="")break;return!0;case"link":if(typeof g.rel!="string"||typeof g.href!="string"||g.href===""||g.onLoad||g.onError)break;return g.rel==="stylesheet"?(m=g.disabled,typeof g.precedence=="string"&&m==null):!0;case"script":if(g.async&&typeof g.async!="function"&&typeof g.async!="symbol"&&!g.onLoad&&!g.onError&&g.src&&typeof g.src=="string")return!0}return!1}function XM(m){return!(m.type==="stylesheet"&&(m.state.loading&3)===0)}function Mae(m,g,v,C){if(v.type==="stylesheet"&&(typeof C.media!="string"||matchMedia(C.media).matches!==!1)&&(v.state.loading&4)===0){if(v.instance===null){var O=Gm(C.href),R=g.querySelector(cg(O));if(R){g=R._p,g!==null&&typeof g=="object"&&typeof g.then=="function"&&(m.count++,m=Ty.bind(m),g.then(m,m)),v.state.loading|=4,v.instance=R,We(R);return}R=g.ownerDocument||g,C=VM(C),(O=ri.get(O))&&US(C,O),R=R.createElement("link"),We(R);var ae=R;ae._p=new Promise(function(Se,Ye){ae.onload=Se,ae.onerror=Ye}),_s(R,"link",C),v.instance=R}m.stylesheets===null&&(m.stylesheets=new Map),m.stylesheets.set(v,g),(g=v.state.preload)&&(v.state.loading&3)===0&&(m.count++,v=Ty.bind(m),g.addEventListener("load",v),g.addEventListener("error",v))}}var HS=0;function Iae(m,g){return m.stylesheets&&m.count===0&&Ey(m,m.stylesheets),0<m.count||0<m.imgCount?function(v){var C=setTimeout(function(){if(m.stylesheets&&Ey(m,m.stylesheets),m.unsuspend){var R=m.unsuspend;m.unsuspend=null,R()}},6e4+g);0<m.imgBytes&&HS===0&&(HS=62500*pae());var O=setTimeout(function(){if(m.waitingForImages=!1,m.count===0&&(m.stylesheets&&Ey(m,m.stylesheets),m.unsuspend)){var R=m.unsuspend;m.unsuspend=null,R()}},(m.imgBytes>HS?50:800)+g);return m.unsuspend=v,function(){m.unsuspend=null,clearTimeout(C),clearTimeout(O)}}:null}function Ty(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Ey(this,this.stylesheets);else if(this.unsuspend){var m=this.unsuspend;this.unsuspend=null,m()}}}var ky=null;function Ey(m,g){m.stylesheets=null,m.unsuspend!==null&&(m.count++,ky=new Map,g.forEach($ae,m),ky=null,Ty.call(m))}function $ae(m,g){if(!(g.state.loading&4)){var v=ky.get(m);if(v)var C=v.get(null);else{v=new Map,ky.set(m,v);for(var O=m.querySelectorAll("link[data-precedence],style[data-precedence]"),R=0;R<O.length;R++){var ae=O[R];(ae.nodeName==="LINK"||ae.getAttribute("media")!=="not all")&&(v.set(ae.dataset.precedence,ae),C=ae)}C&&v.set(null,C)}O=g.instance,ae=O.getAttribute("data-precedence"),R=v.get(ae)||C,R===C&&v.set(null,O),v.set(ae,O),this.count++,C=Ty.bind(this),O.addEventListener("load",C),O.addEventListener("error",C),R?R.parentNode.insertBefore(O,R.nextSibling):(m=m.nodeType===9?m.head:m,m.insertBefore(O,m.firstChild)),g.state.loading|=4}}var ug={$$typeof:S,Provider:null,Consumer:null,_currentValue:Q,_currentValue2:Q,_threadCount:0};function Rae(m,g,v,C,O,R,ae,Se,Ye){this.tag=1,this.containerInfo=m,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=H(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=H(0),this.hiddenUpdates=H(null),this.identifierPrefix=C,this.onUncaughtError=O,this.onCaughtError=R,this.onRecoverableError=ae,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Ye,this.incompleteTransitions=new Map}function ZM(m,g,v,C,O,R,ae,Se,Ye,ct,pt,Nt){return m=new Rae(m,g,v,ae,Ye,ct,pt,Nt,Se),g=1,R===!0&&(g|=24),R=Tr(3,null,null,g),m.current=R,R.stateNode=m,g=jC(),g.refCount++,m.pooledCache=g,g.refCount++,R.memoizedState={element:C,isDehydrated:v,cache:g},_C(R),m}function JM(m){return m?(m=Nm,m):Nm}function eI(m,g,v,C,O,R){O=JM(O),C.context===null?C.context=O:C.pendingContext=O,C=wc(g),C.payload={element:v},R=R===void 0?null:R,R!==null&&(C.callback=R),v=jc(m,C,g),v!==null&&(rr(v,m,g),Hh(v,m,g))}function tI(m,g){if(m=m.memoizedState,m!==null&&m.dehydrated!==null){var v=m.retryLane;m.retryLane=v!==0&&v<g?v:g}}function qS(m,g){tI(m,g),(m=m.alternate)&&tI(m,g)}function aI(m){if(m.tag===13||m.tag===31){var g=Md(m,67108864);g!==null&&rr(g,m,67108864),qS(m,67108864)}}function nI(m){if(m.tag===13||m.tag===31){var g=Pr();g=Te(g);var v=Md(m,g);v!==null&&rr(v,m,g),qS(m,g)}}var Ly=!0;function zae(m,g,v,C){var O=W.T;W.T=null;var R=Z.p;try{Z.p=2,GS(m,g,v,C)}finally{Z.p=R,W.T=O}}function Fae(m,g,v,C){var O=W.T;W.T=null;var R=Z.p;try{Z.p=8,GS(m,g,v,C)}finally{Z.p=R,W.T=O}}function GS(m,g,v,C){if(Ly){var O=WS(C);if(O===null)LS(m,g,C,Dy,v),rI(m,C);else if(Bae(O,m,g,v,C))C.stopPropagation();else if(rI(m,C),g&4&&-1<Uae.indexOf(m)){for(;O!==null;){var R=ee(O);if(R!==null)switch(R.tag){case 3:if(R=R.stateNode,R.current.memoizedState.isDehydrated){var ae=At(R.pendingLanes);if(ae!==0){var Se=R;for(Se.pendingLanes|=2,Se.entangledLanes|=2;ae;){var Ye=1<<31-tt(ae);Se.entanglements[1]|=Ye,ae&=~Ye}lo(R),(Ta&6)===0&&(hy=Ue()+500,rg(0))}}break;case 31:case 13:Se=Md(R,2),Se!==null&&rr(Se,R,2),py(),qS(R,2)}if(R=WS(C),R===null&&LS(m,g,C,Dy,v),R===O)break;O=R}O!==null&&C.stopPropagation()}else LS(m,g,C,null,v)}}function WS(m){return m=Y1(m),VS(m)}var Dy=null;function VS(m){if(Dy=null,m=L(m),m!==null){var g=i(m);if(g===null)m=null;else{var v=g.tag;if(v===13){if(m=o(g),m!==null)return m;m=null}else if(v===31){if(m=l(g),m!==null)return m;m=null}else if(v===3){if(g.stateNode.current.memoizedState.isDehydrated)return g.tag===3?g.stateNode.containerInfo:null;m=null}else g!==m&&(m=null)}}return Dy=m,null}function sI(m){switch(m){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ne()){case ze:return 2;case je:return 8;case ve:case z:return 32;case K:return 268435456;default:return 32}default:return 32}}var YS=!1,Pc=null,Oc=null,Mc=null,mg=new Map,fg=new Map,Ic=[],Uae="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function rI(m,g){switch(m){case"focusin":case"focusout":Pc=null;break;case"dragenter":case"dragleave":Oc=null;break;case"mouseover":case"mouseout":Mc=null;break;case"pointerover":case"pointerout":mg.delete(g.pointerId);break;case"gotpointercapture":case"lostpointercapture":fg.delete(g.pointerId)}}function hg(m,g,v,C,O,R){return m===null||m.nativeEvent!==R?(m={blockedOn:g,domEventName:v,eventSystemFlags:C,nativeEvent:R,targetContainers:[O]},g!==null&&(g=ee(g),g!==null&&aI(g)),m):(m.eventSystemFlags|=C,g=m.targetContainers,O!==null&&g.indexOf(O)===-1&&g.push(O),m)}function Bae(m,g,v,C,O){switch(g){case"focusin":return Pc=hg(Pc,m,g,v,C,O),!0;case"dragenter":return Oc=hg(Oc,m,g,v,C,O),!0;case"mouseover":return Mc=hg(Mc,m,g,v,C,O),!0;case"pointerover":var R=O.pointerId;return mg.set(R,hg(mg.get(R)||null,m,g,v,C,O)),!0;case"gotpointercapture":return R=O.pointerId,fg.set(R,hg(fg.get(R)||null,m,g,v,C,O)),!0}return!1}function iI(m){var g=L(m.target);if(g!==null){var v=i(g);if(v!==null){if(g=v.tag,g===13){if(g=o(v),g!==null){m.blockedOn=g,X(m.priority,function(){nI(v)});return}}else if(g===31){if(g=l(v),g!==null){m.blockedOn=g,X(m.priority,function(){nI(v)});return}}else if(g===3&&v.stateNode.current.memoizedState.isDehydrated){m.blockedOn=v.tag===3?v.stateNode.containerInfo:null;return}}}m.blockedOn=null}function Py(m){if(m.blockedOn!==null)return!1;for(var g=m.targetContainers;0<g.length;){var v=WS(m.nativeEvent);if(v===null){v=m.nativeEvent;var C=new v.constructor(v.type,v);V1=C,v.target.dispatchEvent(C),V1=null}else return g=ee(v),g!==null&&aI(g),m.blockedOn=v,!1;g.shift()}return!0}function oI(m,g,v){Py(m)&&v.delete(g)}function Hae(){YS=!1,Pc!==null&&Py(Pc)&&(Pc=null),Oc!==null&&Py(Oc)&&(Oc=null),Mc!==null&&Py(Mc)&&(Mc=null),mg.forEach(oI),fg.forEach(oI)}function Oy(m,g){m.blockedOn===g&&(m.blockedOn=null,YS||(YS=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Hae)))}var My=null;function lI(m){My!==m&&(My=m,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){My===m&&(My=null);for(var g=0;g<m.length;g+=3){var v=m[g],C=m[g+1],O=m[g+2];if(typeof C!="function"){if(VS(C||v)===null)continue;break}var R=ee(v);R!==null&&(m.splice(g,3),g-=3,WC(R,{pending:!0,data:O,method:v.method,action:C},C,O))}}))}function Vm(m){function g(Ye){return Oy(Ye,m)}Pc!==null&&Oy(Pc,m),Oc!==null&&Oy(Oc,m),Mc!==null&&Oy(Mc,m),mg.forEach(g),fg.forEach(g);for(var v=0;v<Ic.length;v++){var C=Ic[v];C.blockedOn===m&&(C.blockedOn=null)}for(;0<Ic.length&&(v=Ic[0],v.blockedOn===null);)iI(v),v.blockedOn===null&&Ic.shift();if(v=(m.ownerDocument||m).$$reactFormReplay,v!=null)for(C=0;C<v.length;C+=3){var O=v[C],R=v[C+1],ae=O[Ve]||null;if(typeof R=="function")ae||lI(v);else if(ae){var Se=null;if(R&&R.hasAttribute("formAction")){if(O=R,ae=R[Ve]||null)Se=ae.formAction;else if(VS(O)!==null)continue}else Se=ae.action;typeof Se=="function"?v[C+1]=Se:(v.splice(C,3),C-=3),lI(v)}}}function cI(){function m(R){R.canIntercept&&R.info==="react-transition"&&R.intercept({handler:function(){return new Promise(function(ae){return O=ae})},focusReset:"manual",scroll:"manual"})}function g(){O!==null&&(O(),O=null),C||setTimeout(v,20)}function v(){if(!C&&!navigation.transition){var R=navigation.currentEntry;R&&R.url!=null&&navigation.navigate(R.url,{state:R.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var C=!1,O=null;return navigation.addEventListener("navigate",m),navigation.addEventListener("navigatesuccess",g),navigation.addEventListener("navigateerror",g),setTimeout(v,100),function(){C=!0,navigation.removeEventListener("navigate",m),navigation.removeEventListener("navigatesuccess",g),navigation.removeEventListener("navigateerror",g),O!==null&&(O(),O=null)}}}function QS(m){this._internalRoot=m}Iy.prototype.render=QS.prototype.render=function(m){var g=this._internalRoot;if(g===null)throw Error(s(409));var v=g.current,C=Pr();eI(v,C,m,g,null,null)},Iy.prototype.unmount=QS.prototype.unmount=function(){var m=this._internalRoot;if(m!==null){this._internalRoot=null;var g=m.containerInfo;eI(m.current,2,null,m,null,null),py(),g[ft]=null}};function Iy(m){this._internalRoot=m}Iy.prototype.unstable_scheduleHydration=function(m){if(m){var g=Oe();m={blockedOn:null,target:m,priority:g};for(var v=0;v<Ic.length&&g!==0&&g<Ic[v].priority;v++);Ic.splice(v,0,m),v===0&&iI(m)}};var dI=t.version;if(dI!=="19.2.0")throw Error(s(527,dI,"19.2.0"));Z.findDOMNode=function(m){var g=m._reactInternals;if(g===void 0)throw typeof m.render=="function"?Error(s(188)):(m=Object.keys(m).join(","),Error(s(268,m)));return m=u(g),m=m!==null?d(m):null,m=m===null?null:m.stateNode,m};var qae={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:W,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var $y=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!$y.isDisabled&&$y.supportsFiber)try{Le=$y.inject(qae),De=$y}catch{}}return pg.createRoot=function(m,g){if(!r(m))throw Error(s(299));var v=!1,C="",O=xO,R=yO,ae=bO;return g!=null&&(g.unstable_strictMode===!0&&(v=!0),g.identifierPrefix!==void 0&&(C=g.identifierPrefix),g.onUncaughtError!==void 0&&(O=g.onUncaughtError),g.onCaughtError!==void 0&&(R=g.onCaughtError),g.onRecoverableError!==void 0&&(ae=g.onRecoverableError)),g=ZM(m,1,!1,null,null,v,C,null,O,R,ae,cI),m[ft]=g.current,ES(m),new QS(g)},pg.hydrateRoot=function(m,g,v){if(!r(m))throw Error(s(299));var C=!1,O="",R=xO,ae=yO,Se=bO,Ye=null;return v!=null&&(v.unstable_strictMode===!0&&(C=!0),v.identifierPrefix!==void 0&&(O=v.identifierPrefix),v.onUncaughtError!==void 0&&(R=v.onUncaughtError),v.onCaughtError!==void 0&&(ae=v.onCaughtError),v.onRecoverableError!==void 0&&(Se=v.onRecoverableError),v.formState!==void 0&&(Ye=v.formState)),g=ZM(m,1,!0,g,v??null,C,O,Ye,R,ae,Se,cI),g.context=JM(null),v=g.current,C=Pr(),C=Te(C),O=wc(C),O.callback=null,jc(v,O,C),v=C,g.current.lanes=v,te(g,v),lo(g),m[ft]=g.current,ES(m),new Iy(g)},pg.version="19.2.0",pg}var vI;function ene(){if(vI)return ZS.exports;vI=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),ZS.exports=Jae(),ZS.exports}var tne=ene();var wI="popstate";function ane(e={}){function t(s,r){let{pathname:i,search:o,hash:l}=s.location;return YT("",{pathname:i,search:o,hash:l},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function n(s,r){return typeof r=="string"?r:bp(r)}return sne(t,n,null,e)}function mn(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function bi(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function nne(){return Math.random().toString(36).substring(2,10)}function jI(e,t){return{usr:e.state,key:e.key,idx:t}}function YT(e,t,n=null,s){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?Zf(t):t,state:n,key:t&&t.key||s||nne()}}function bp({pathname:e="/",search:t="",hash:n=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function Zf(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substring(n),e=e.substring(0,n));let s=e.indexOf("?");s>=0&&(t.search=e.substring(s),e=e.substring(0,s)),e&&(t.pathname=e)}return t}function sne(e,t,n,s={}){let{window:r=document.defaultView,v5Compat:i=!1}=s,o=r.history,l="POP",c=null,u=d();u==null&&(u=0,o.replaceState({...o.state,idx:u},""));function d(){return(o.state||{idx:null}).idx}function h(){l="POP";let y=d(),N=y==null?null:y-u;u=y,c&&c({action:l,location:j.location,delta:N})}function p(y,N){l="PUSH";let w=YT(j.location,y,N);u=d()+1;let S=jI(w,u),_=j.createHref(w);try{o.pushState(S,"",_)}catch(T){if(T instanceof DOMException&&T.name==="DataCloneError")throw T;r.location.assign(_)}i&&c&&c({action:l,location:j.location,delta:1})}function x(y,N){l="REPLACE";let w=YT(j.location,y,N);u=d();let S=jI(w,u),_=j.createHref(w);o.replaceState(S,"",_),i&&c&&c({action:l,location:j.location,delta:0})}function b(y){return rne(y)}let j={get action(){return l},get location(){return e(r,o)},listen(y){if(c)throw new Error("A history only accepts one active listener");return r.addEventListener(wI,h),c=y,()=>{r.removeEventListener(wI,h),c=null}},createHref(y){return t(r,y)},createURL:b,encodeLocation(y){let N=b(y);return{pathname:N.pathname,search:N.search,hash:N.hash}},push:p,replace:x,go(y){return o.go(y)}};return j}function rne(e,t=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),mn(n,"No window.location.(origin|href) available to create URL");let s=typeof e=="string"?e:bp(e);return s=s.replace(/ $/,"%20"),!t&&s.startsWith("//")&&(s=n+s),new URL(s,n)}function NH(e,t,n="/"){return ine(e,t,n,!1)}function ine(e,t,n,s){let r=typeof t=="string"?Zf(t):t,i=Rl(r.pathname||"/",n);if(i==null)return null;let o=CH(e);one(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let u=yne(i);l=pne(o[c],u,s)}return l}function CH(e,t=[],n=[],s="",r=!1){let i=(o,l,c=r,u)=>{let d={relativePath:u===void 0?o.path||"":u,caseSensitive:o.caseSensitive===!0,childrenIndex:l,route:o};if(d.relativePath.startsWith("/")){if(!d.relativePath.startsWith(s)&&c)return;mn(d.relativePath.startsWith(s),`Absolute route path "${d.relativePath}" nested under path "${s}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),d.relativePath=d.relativePath.slice(s.length)}let h=Ol([s,d.relativePath]),p=n.concat(d);o.children&&o.children.length>0&&(mn(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${h}".`),CH(o.children,t,p,h,c)),!(o.path==null&&!o.index)&&t.push({path:h,score:hne(h,o.index),routesMeta:p})};return e.forEach((o,l)=>{if(o.path===""||!o.path?.includes("?"))i(o,l);else for(let c of SH(o.path))i(o,l,!0,c)}),t}function SH(e){let t=e.split("/");if(t.length===0)return[];let[n,...s]=t,r=n.endsWith("?"),i=n.replace(/\?$/,"");if(s.length===0)return r?[i,""]:[i];let o=SH(s.join("/")),l=[];return l.push(...o.map(c=>c===""?i:[i,c].join("/"))),r&&l.push(...o),l.map(c=>e.startsWith("/")&&c===""?"/":c)}function one(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:gne(t.routesMeta.map(s=>s.childrenIndex),n.routesMeta.map(s=>s.childrenIndex)))}var lne=/^:[\w-]+$/,cne=3,dne=2,une=1,mne=10,fne=-2,NI=e=>e==="*";function hne(e,t){let n=e.split("/"),s=n.length;return n.some(NI)&&(s+=fne),t&&(s+=dne),n.filter(r=>!NI(r)).reduce((r,i)=>r+(lne.test(i)?cne:i===""?une:mne),s)}function gne(e,t){return e.length===t.length&&e.slice(0,-1).every((s,r)=>s===t[r])?e[e.length-1]-t[t.length-1]:0}function pne(e,t,n=!1){let{routesMeta:s}=e,r={},i="/",o=[];for(let l=0;l<s.length;++l){let c=s[l],u=l===s.length-1,d=i==="/"?t:t.slice(i.length)||"/",h=kv({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),p=c.route;if(!h&&u&&n&&!s[s.length-1].route.index&&(h=kv({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},d)),!h)return null;Object.assign(r,h.params),o.push({params:r,pathname:Ol([i,h.pathname]),pathnameBase:jne(Ol([i,h.pathnameBase])),route:p}),h.pathnameBase!=="/"&&(i=Ol([i,h.pathnameBase]))}return o}function kv(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,s]=xne(e.path,e.caseSensitive,e.end),r=t.match(n);if(!r)return null;let i=r[0],o=i.replace(/(.)\/+$/,"$1"),l=r.slice(1);return{params:s.reduce((u,{paramName:d,isOptional:h},p)=>{if(d==="*"){let b=l[p]||"";o=i.slice(0,i.length-b.length).replace(/(.)\/+$/,"$1")}const x=l[p];return h&&!x?u[d]=void 0:u[d]=(x||"").replace(/%2F/g,"/"),u},{}),pathname:i,pathnameBase:o,pattern:e}}function xne(e,t=!1,n=!0){bi(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let s=[],r="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(s.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(s.push({paramName:"*"}),r+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":e!==""&&e!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,t?void 0:"i"),s]}function yne(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return bi(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function Rl(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,s=e.charAt(n);return s&&s!=="/"?null:e.slice(n)||"/"}var bne=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function vne(e,t="/"){let{pathname:n,search:s="",hash:r=""}=typeof e=="string"?Zf(e):e,i;return n?(n=n.replace(/\/\/+/g,"/"),n.startsWith("/")?i=CI(n.substring(1),"/"):i=CI(n,t)):i=t,{pathname:i,search:Nne(s),hash:Cne(r)}}function CI(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(r=>{r===".."?n.length>1&&n.pop():r!=="."&&n.push(r)}),n.length>1?n.join("/"):"/"}function a2(e,t,n,s){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(s)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function wne(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function xL(e){let t=wne(e);return t.map((n,s)=>s===t.length-1?n.pathname:n.pathnameBase)}function yL(e,t,n,s=!1){let r;typeof e=="string"?r=Zf(e):(r={...e},mn(!r.pathname||!r.pathname.includes("?"),a2("?","pathname","search",r)),mn(!r.pathname||!r.pathname.includes("#"),a2("#","pathname","hash",r)),mn(!r.search||!r.search.includes("#"),a2("#","search","hash",r)));let i=e===""||r.pathname==="",o=i?"/":r.pathname,l;if(o==null)l=n;else{let h=t.length-1;if(!s&&o.startsWith("..")){let p=o.split("/");for(;p[0]==="..";)p.shift(),h-=1;r.pathname=p.join("/")}l=h>=0?t[h]:"/"}let c=vne(r,l),u=o&&o!=="/"&&o.endsWith("/"),d=(i||o===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}var Ol=e=>e.join("/").replace(/\/\/+/g,"/"),jne=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),Nne=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,Cne=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e,Sne=class{constructor(e,t,n,s=!1){this.status=e,this.statusText=t||"",this.internal=s,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}};function _ne(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}function Ane(e){return e.map(t=>t.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var _H=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function AH(e,t){let n=e;if(typeof n!="string"||!bne.test(n))return{absoluteURL:void 0,isExternal:!1,to:n};let s=n,r=!1;if(_H)try{let i=new URL(window.location.href),o=n.startsWith("//")?new URL(i.protocol+n):new URL(n),l=Rl(o.pathname,t);o.origin===i.origin&&l!=null?n=l+o.search+o.hash:r=!0}catch{bi(!1,`<Link to="${n}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:s,isExternal:r,to:n}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var TH=["POST","PUT","PATCH","DELETE"];new Set(TH);var Tne=["GET",...TH];new Set(Tne);var Jf=f.createContext(null);Jf.displayName="DataRouter";var cj=f.createContext(null);cj.displayName="DataRouterState";var kne=f.createContext(!1),kH=f.createContext({isTransitioning:!1});kH.displayName="ViewTransition";var Ene=f.createContext(new Map);Ene.displayName="Fetchers";var Lne=f.createContext(null);Lne.displayName="Await";var Wr=f.createContext(null);Wr.displayName="Navigation";var ix=f.createContext(null);ix.displayName="Location";var _i=f.createContext({outlet:null,matches:[],isDataRoute:!1});_i.displayName="Route";var bL=f.createContext(null);bL.displayName="RouteError";var EH="REACT_ROUTER_ERROR",Dne="REDIRECT",Pne="ROUTE_ERROR_RESPONSE";function One(e){if(e.startsWith(`${EH}:${Dne}:{`))try{let t=JSON.parse(e.slice(28));if(typeof t=="object"&&t&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.location=="string"&&typeof t.reloadDocument=="boolean"&&typeof t.replace=="boolean")return t}catch{}}function Mne(e){if(e.startsWith(`${EH}:${Pne}:{`))try{let t=JSON.parse(e.slice(40));if(typeof t=="object"&&t&&typeof t.status=="number"&&typeof t.statusText=="string")return new Sne(t.status,t.statusText,t.data)}catch{}}function Ine(e,{relative:t}={}){mn(eh(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:s}=f.useContext(Wr),{hash:r,pathname:i,search:o}=ox(e,{relative:t}),l=i;return n!=="/"&&(l=i==="/"?n:Ol([n,i])),s.createHref({pathname:l,search:o,hash:r})}function eh(){return f.useContext(ix)!=null}function ta(){return mn(eh(),"useLocation() may be used only in the context of a <Router> component."),f.useContext(ix).location}var LH="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function DH(e){f.useContext(Wr).static||f.useLayoutEffect(e)}function Et(){let{isDataRoute:e}=f.useContext(_i);return e?Xne():$ne()}function $ne(){mn(eh(),"useNavigate() may be used only in the context of a <Router> component.");let e=f.useContext(Jf),{basename:t,navigator:n}=f.useContext(Wr),{matches:s}=f.useContext(_i),{pathname:r}=ta(),i=JSON.stringify(xL(s)),o=f.useRef(!1);return DH(()=>{o.current=!0}),f.useCallback((c,u={})=>{if(bi(o.current,LH),!o.current)return;if(typeof c=="number"){n.go(c);return}let d=yL(c,JSON.parse(i),r,u.relative==="path");e==null&&t!=="/"&&(d.pathname=d.pathname==="/"?t:Ol([t,d.pathname])),(u.replace?n.replace:n.push)(d,u.state,u)},[t,n,i,r,e])}var Rne=f.createContext(null);function zne(e){let t=f.useContext(_i).outlet;return f.useMemo(()=>t&&f.createElement(Rne.Provider,{value:e},t),[t,e])}function Wo(){let{matches:e}=f.useContext(_i),t=e[e.length-1];return t?t.params:{}}function ox(e,{relative:t}={}){let{matches:n}=f.useContext(_i),{pathname:s}=ta(),r=JSON.stringify(xL(n));return f.useMemo(()=>yL(e,JSON.parse(r),s,t==="path"),[e,r,s,t])}function Fne(e,t){return PH(e,t)}function PH(e,t,n,s,r){mn(eh(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=f.useContext(Wr),{matches:o}=f.useContext(_i),l=o[o.length-1],c=l?l.params:{},u=l?l.pathname:"/",d=l?l.pathnameBase:"/",h=l&&l.route;{let w=h&&h.path||"";MH(u,!h||w.endsWith("*")||w.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${u}" (under <Route path="${w}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${w}"> to <Route path="${w==="/"?"*":`${w}/*`}">.`)}let p=ta(),x;if(t){let w=typeof t=="string"?Zf(t):t;mn(d==="/"||w.pathname?.startsWith(d),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${d}" but pathname "${w.pathname}" was given in the \`location\` prop.`),x=w}else x=p;let b=x.pathname||"/",j=b;if(d!=="/"){let w=d.replace(/^\//,"").split("/");j="/"+b.replace(/^\//,"").split("/").slice(w.length).join("/")}let y=NH(e,{pathname:j});bi(h||y!=null,`No routes matched location "${x.pathname}${x.search}${x.hash}" `),bi(y==null||y[y.length-1].route.element!==void 0||y[y.length-1].route.Component!==void 0||y[y.length-1].route.lazy!==void 0,`Matched leaf route at location "${x.pathname}${x.search}${x.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let N=Gne(y&&y.map(w=>Object.assign({},w,{params:Object.assign({},c,w.params),pathname:Ol([d,i.encodeLocation?i.encodeLocation(w.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?d:Ol([d,i.encodeLocation?i.encodeLocation(w.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:w.pathnameBase])})),o,n,s,r);return t&&N?f.createElement(ix.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...x},navigationType:"POP"}},N):N}function Une(){let e=Kne(),t=_ne(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,s="rgba(200,200,200, 0.5)",r={padding:"0.5rem",backgroundColor:s},i={padding:"2px 4px",backgroundColor:s},o=null;return console.error("Error handled by React Router default ErrorBoundary:",e),o=f.createElement(f.Fragment,null,f.createElement("p",null," Hey developer "),f.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",f.createElement("code",{style:i},"ErrorBoundary")," or"," ",f.createElement("code",{style:i},"errorElement")," prop on your route.")),f.createElement(f.Fragment,null,f.createElement("h2",null,"Unexpected Application Error!"),f.createElement("h3",{style:{fontStyle:"italic"}},t),n?f.createElement("pre",{style:r},n):null,o)}var Bne=f.createElement(Une,null),OH=class extends f.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.onError?this.props.onError(e,t):console.error("React Router caught the following error during render",e)}render(){let e=this.state.error;if(this.context&&typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){const n=Mne(e.digest);n&&(e=n)}let t=e!==void 0?f.createElement(_i.Provider,{value:this.props.routeContext},f.createElement(bL.Provider,{value:e,children:this.props.component})):this.props.children;return this.context?f.createElement(Hne,{error:e},t):t}};OH.contextType=kne;var n2=new WeakMap;function Hne({children:e,error:t}){let{basename:n}=f.useContext(Wr);if(typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){let s=One(t.digest);if(s){let r=n2.get(t);if(r)throw r;let i=AH(s.location,n);if(_H&&!n2.get(t))if(i.isExternal||s.reloadDocument)window.location.href=i.absoluteURL||i.to;else{const o=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(i.to,{replace:s.replace}));throw n2.set(t,o),o}return f.createElement("meta",{httpEquiv:"refresh",content:`0;url=${i.absoluteURL||i.to}`})}}return e}function qne({routeContext:e,match:t,children:n}){let s=f.useContext(Jf);return s&&s.static&&s.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=t.route.id),f.createElement(_i.Provider,{value:e},n)}function Gne(e,t=[],n=null,s=null,r=null){if(e==null){if(!n)return null;if(n.errors)e=n.matches;else if(t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let i=e,o=n?.errors;if(o!=null){let d=i.findIndex(h=>h.route.id&&o?.[h.route.id]!==void 0);mn(d>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),i=i.slice(0,Math.min(i.length,d+1))}let l=!1,c=-1;if(n)for(let d=0;d<i.length;d++){let h=i[d];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(c=d),h.route.id){let{loaderData:p,errors:x}=n,b=h.route.loader&&!p.hasOwnProperty(h.route.id)&&(!x||x[h.route.id]===void 0);if(h.route.lazy||b){l=!0,c>=0?i=i.slice(0,c+1):i=[i[0]];break}}}let u=n&&s?(d,h)=>{s(d,{location:n.location,params:n.matches?.[0]?.params??{},unstable_pattern:Ane(n.matches),errorInfo:h})}:void 0;return i.reduceRight((d,h,p)=>{let x,b=!1,j=null,y=null;n&&(x=o&&h.route.id?o[h.route.id]:void 0,j=h.route.errorElement||Bne,l&&(c<0&&p===0?(MH("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),b=!0,y=null):c===p&&(b=!0,y=h.route.hydrateFallbackElement||null)));let N=t.concat(i.slice(0,p+1)),w=()=>{let S;return x?S=j:b?S=y:h.route.Component?S=f.createElement(h.route.Component,null):h.route.element?S=h.route.element:S=d,f.createElement(qne,{match:h,routeContext:{outlet:d,matches:N,isDataRoute:n!=null},children:S})};return n&&(h.route.ErrorBoundary||h.route.errorElement||p===0)?f.createElement(OH,{location:n.location,revalidation:n.revalidation,component:j,error:x,children:w(),routeContext:{outlet:null,matches:N,isDataRoute:!0},onError:u}):w()},null)}function vL(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Wne(e){let t=f.useContext(Jf);return mn(t,vL(e)),t}function Vne(e){let t=f.useContext(cj);return mn(t,vL(e)),t}function Yne(e){let t=f.useContext(_i);return mn(t,vL(e)),t}function wL(e){let t=Yne(e),n=t.matches[t.matches.length-1];return mn(n.route.id,`${e} can only be used on routes that contain a unique "id"`),n.route.id}function Qne(){return wL("useRouteId")}function Kne(){let e=f.useContext(bL),t=Vne("useRouteError"),n=wL("useRouteError");return e!==void 0?e:t.errors?.[n]}function Xne(){let{router:e}=Wne("useNavigate"),t=wL("useNavigate"),n=f.useRef(!1);return DH(()=>{n.current=!0}),f.useCallback(async(r,i={})=>{bi(n.current,LH),n.current&&(typeof r=="number"?await e.navigate(r):await e.navigate(r,{fromRouteId:t,...i}))},[e,t])}var SI={};function MH(e,t,n){!t&&!SI[e]&&(SI[e]=!0,bi(!1,n))}f.memo(Zne);function Zne({routes:e,future:t,state:n,onError:s}){return PH(e,void 0,n,s,t)}function ur({to:e,replace:t,state:n,relative:s}){mn(eh(),"<Navigate> may be used only in the context of a <Router> component.");let{static:r}=f.useContext(Wr);bi(!r,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:i}=f.useContext(_i),{pathname:o}=ta(),l=Et(),c=yL(e,xL(i),o,s==="path"),u=JSON.stringify(c);return f.useEffect(()=>{l(JSON.parse(u),{replace:t,state:n,relative:s})},[l,u,s,t,n]),null}function th(e){return zne(e.context)}function bt(e){mn(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Jne({basename:e="/",children:t=null,location:n,navigationType:s="POP",navigator:r,static:i=!1,unstable_useTransitions:o}){mn(!eh(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=e.replace(/^\/*/,"/"),c=f.useMemo(()=>({basename:l,navigator:r,static:i,unstable_useTransitions:o,future:{}}),[l,r,i,o]);typeof n=="string"&&(n=Zf(n));let{pathname:u="/",search:d="",hash:h="",state:p=null,key:x="default"}=n,b=f.useMemo(()=>{let j=Rl(u,l);return j==null?null:{location:{pathname:j,search:d,hash:h,state:p,key:x},navigationType:s}},[l,u,d,h,p,x,s]);return bi(b!=null,`<Router basename="${l}"> is not able to match the URL "${u}${d}${h}" because it does not start with the basename, so the <Router> won't render anything.`),b==null?null:f.createElement(Wr.Provider,{value:c},f.createElement(ix.Provider,{children:t,value:b}))}function ese({children:e,location:t}){return Fne(QT(e),t)}function QT(e,t=[]){let n=[];return f.Children.forEach(e,(s,r)=>{if(!f.isValidElement(s))return;let i=[...t,r];if(s.type===f.Fragment){n.push.apply(n,QT(s.props.children,i));return}mn(s.type===bt,`[${typeof s.type=="string"?s.type:s.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),mn(!s.props.index||!s.props.children,"An index route cannot have child routes.");let o={id:s.props.id||i.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,middleware:s.props.middleware,loader:s.props.loader,action:s.props.action,hydrateFallbackElement:s.props.hydrateFallbackElement,HydrateFallback:s.props.HydrateFallback,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.hasErrorBoundary===!0||s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(o.children=QT(s.props.children,i)),n.push(o)}),n}var ov="get",lv="application/x-www-form-urlencoded";function dj(e){return typeof HTMLElement<"u"&&e instanceof HTMLElement}function tse(e){return dj(e)&&e.tagName.toLowerCase()==="button"}function ase(e){return dj(e)&&e.tagName.toLowerCase()==="form"}function nse(e){return dj(e)&&e.tagName.toLowerCase()==="input"}function sse(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function rse(e,t){return e.button===0&&(!t||t==="_self")&&!sse(e)}function KT(e=""){return new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,n)=>{let s=e[n];return t.concat(Array.isArray(s)?s.map(r=>[n,r]):[[n,s]])},[]))}function ise(e,t){let n=KT(e);return t&&t.forEach((s,r)=>{n.has(r)||t.getAll(r).forEach(i=>{n.append(r,i)})}),n}var Ry=null;function ose(){if(Ry===null)try{new FormData(document.createElement("form"),0),Ry=!1}catch{Ry=!0}return Ry}var lse=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function s2(e){return e!=null&&!lse.has(e)?(bi(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${lv}"`),null):e}function cse(e,t){let n,s,r,i,o;if(ase(e)){let l=e.getAttribute("action");s=l?Rl(l,t):null,n=e.getAttribute("method")||ov,r=s2(e.getAttribute("enctype"))||lv,i=new FormData(e)}else if(tse(e)||nse(e)&&(e.type==="submit"||e.type==="image")){let l=e.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=e.getAttribute("formaction")||l.getAttribute("action");if(s=c?Rl(c,t):null,n=e.getAttribute("formmethod")||l.getAttribute("method")||ov,r=s2(e.getAttribute("formenctype"))||s2(l.getAttribute("enctype"))||lv,i=new FormData(l,e),!ose()){let{name:u,type:d,value:h}=e;if(d==="image"){let p=u?`${u}.`:"";i.append(`${p}x`,"0"),i.append(`${p}y`,"0")}else u&&i.append(u,h)}}else{if(dj(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=ov,s=null,r=lv,o=e}return i&&r==="text/plain"&&(o=i,i=void 0),{action:s,method:n.toLowerCase(),encType:r,formData:i,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function jL(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function dse(e,t,n,s){let r=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return n?r.pathname.endsWith("/")?r.pathname=`${r.pathname}_.${s}`:r.pathname=`${r.pathname}.${s}`:r.pathname==="/"?r.pathname=`_root.${s}`:t&&Rl(r.pathname,t)==="/"?r.pathname=`${t.replace(/\/$/,"")}/_root.${s}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${s}`,r}async function use(e,t){if(e.id in t)return t[e.id];try{let n=await import(e.module);return t[e.id]=n,n}catch(n){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function mse(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function fse(e,t,n){let s=await Promise.all(e.map(async r=>{let i=t.routes[r.route.id];if(i){let o=await use(i,n);return o.links?o.links():[]}return[]}));return xse(s.flat(1).filter(mse).filter(r=>r.rel==="stylesheet"||r.rel==="preload").map(r=>r.rel==="stylesheet"?{...r,rel:"prefetch",as:"style"}:{...r,rel:"prefetch"}))}function _I(e,t,n,s,r,i){let o=(c,u)=>n[u]?c.route.id!==n[u].route.id:!0,l=(c,u)=>n[u].pathname!==c.pathname||n[u].route.path?.endsWith("*")&&n[u].params["*"]!==c.params["*"];return i==="assets"?t.filter((c,u)=>o(c,u)||l(c,u)):i==="data"?t.filter((c,u)=>{let d=s.routes[c.route.id];if(!d||!d.hasLoader)return!1;if(o(c,u)||l(c,u))return!0;if(c.route.shouldRevalidate){let h=c.route.shouldRevalidate({currentUrl:new URL(r.pathname+r.search+r.hash,window.origin),currentParams:n[0]?.params||{},nextUrl:new URL(e,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof h=="boolean")return h}return!0}):[]}function hse(e,t,{includeHydrateFallback:n}={}){return gse(e.map(s=>{let r=t.routes[s.route.id];if(!r)return[];let i=[r.module];return r.clientActionModule&&(i=i.concat(r.clientActionModule)),r.clientLoaderModule&&(i=i.concat(r.clientLoaderModule)),n&&r.hydrateFallbackModule&&(i=i.concat(r.hydrateFallbackModule)),r.imports&&(i=i.concat(r.imports)),i}).flat(1))}function gse(e){return[...new Set(e)]}function pse(e){let t={},n=Object.keys(e).sort();for(let s of n)t[s]=e[s];return t}function xse(e,t){let n=new Set;return new Set(t),e.reduce((s,r)=>{let i=JSON.stringify(pse(r));return n.has(i)||(n.add(i),s.push({key:i,link:r})),s},[])}function IH(){let e=f.useContext(Jf);return jL(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function yse(){let e=f.useContext(cj);return jL(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var NL=f.createContext(void 0);NL.displayName="FrameworkContext";function $H(){let e=f.useContext(NL);return jL(e,"You must render this element inside a <HydratedRouter> element"),e}function bse(e,t){let n=f.useContext(NL),[s,r]=f.useState(!1),[i,o]=f.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:u,onMouseLeave:d,onTouchStart:h}=t,p=f.useRef(null);f.useEffect(()=>{if(e==="render"&&o(!0),e==="viewport"){let j=N=>{N.forEach(w=>{o(w.isIntersecting)})},y=new IntersectionObserver(j,{threshold:.5});return p.current&&y.observe(p.current),()=>{y.disconnect()}}},[e]),f.useEffect(()=>{if(s){let j=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(j)}}},[s]);let x=()=>{r(!0)},b=()=>{r(!1),o(!1)};return n?e!=="intent"?[i,p,{}]:[i,p,{onFocus:xg(l,x),onBlur:xg(c,b),onMouseEnter:xg(u,x),onMouseLeave:xg(d,b),onTouchStart:xg(h,x)}]:[!1,p,{}]}function xg(e,t){return n=>{e&&e(n),n.defaultPrevented||t(n)}}function vse({page:e,...t}){let{router:n}=IH(),s=f.useMemo(()=>NH(n.routes,e,n.basename),[n.routes,e,n.basename]);return s?f.createElement(jse,{page:e,matches:s,...t}):null}function wse(e){let{manifest:t,routeModules:n}=$H(),[s,r]=f.useState([]);return f.useEffect(()=>{let i=!1;return fse(e,t,n).then(o=>{i||r(o)}),()=>{i=!0}},[e,t,n]),s}function jse({page:e,matches:t,...n}){let s=ta(),{future:r,manifest:i,routeModules:o}=$H(),{basename:l}=IH(),{loaderData:c,matches:u}=yse(),d=f.useMemo(()=>_I(e,t,u,i,s,"data"),[e,t,u,i,s]),h=f.useMemo(()=>_I(e,t,u,i,s,"assets"),[e,t,u,i,s]),p=f.useMemo(()=>{if(e===s.pathname+s.search+s.hash)return[];let j=new Set,y=!1;if(t.forEach(w=>{let S=i.routes[w.route.id];!S||!S.hasLoader||(!d.some(_=>_.route.id===w.route.id)&&w.route.id in c&&o[w.route.id]?.shouldRevalidate||S.hasClientLoader?y=!0:j.add(w.route.id))}),j.size===0)return[];let N=dse(e,l,r.unstable_trailingSlashAwareDataRequests,"data");return y&&j.size>0&&N.searchParams.set("_routes",t.filter(w=>j.has(w.route.id)).map(w=>w.route.id).join(",")),[N.pathname+N.search]},[l,r.unstable_trailingSlashAwareDataRequests,c,s,i,d,t,e,o]),x=f.useMemo(()=>hse(h,i),[h,i]),b=wse(h);return f.createElement(f.Fragment,null,p.map(j=>f.createElement("link",{key:j,rel:"prefetch",as:"fetch",href:j,...n})),x.map(j=>f.createElement("link",{key:j,rel:"modulepreload",href:j,...n})),b.map(({key:j,link:y})=>f.createElement("link",{key:j,nonce:n.nonce,...y,crossOrigin:y.crossOrigin??n.crossOrigin})))}function Nse(...e){return t=>{e.forEach(n=>{typeof n=="function"?n(t):n!=null&&(n.current=t)})}}var Cse=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Cse&&(window.__reactRouterVersion="7.13.0")}catch{}function Sse({basename:e,children:t,unstable_useTransitions:n,window:s}){let r=f.useRef();r.current==null&&(r.current=ane({window:s,v5Compat:!0}));let i=r.current,[o,l]=f.useState({action:i.action,location:i.location}),c=f.useCallback(u=>{n===!1?l(u):f.startTransition(()=>l(u))},[n]);return f.useLayoutEffect(()=>i.listen(c),[i,c]),f.createElement(Jne,{basename:e,children:t,location:o.location,navigationType:o.action,navigator:i,unstable_useTransitions:n})}var RH=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ld=f.forwardRef(function({onClick:t,discover:n="render",prefetch:s="none",relative:r,reloadDocument:i,replace:o,state:l,target:c,to:u,preventScrollReset:d,viewTransition:h,unstable_defaultShouldRevalidate:p,...x},b){let{basename:j,unstable_useTransitions:y}=f.useContext(Wr),N=typeof u=="string"&&RH.test(u),w=AH(u,j);u=w.to;let S=Ine(u,{relative:r}),[_,T,k]=bse(s,x),A=Tse(u,{replace:o,state:l,target:c,preventScrollReset:d,relative:r,viewTransition:h,unstable_defaultShouldRevalidate:p,unstable_useTransitions:y});function E(F){t&&t(F),F.defaultPrevented||A(F)}let M=f.createElement("a",{...x,...k,href:w.absoluteURL||S,onClick:w.isExternal||i?t:E,ref:Nse(b,T),target:c,"data-discover":!N&&n==="render"?"true":void 0});return _&&!N?f.createElement(f.Fragment,null,M,f.createElement(vse,{page:S})):M});ld.displayName="Link";var $t=f.forwardRef(function({"aria-current":t="page",caseSensitive:n=!1,className:s="",end:r=!1,style:i,to:o,viewTransition:l,children:c,...u},d){let h=ox(o,{relative:u.relative}),p=ta(),x=f.useContext(cj),{navigator:b,basename:j}=f.useContext(Wr),y=x!=null&&Pse(h)&&l===!0,N=b.encodeLocation?b.encodeLocation(h).pathname:h.pathname,w=p.pathname,S=x&&x.navigation&&x.navigation.location?x.navigation.location.pathname:null;n||(w=w.toLowerCase(),S=S?S.toLowerCase():null,N=N.toLowerCase()),S&&j&&(S=Rl(S,j)||S);const _=N!=="/"&&N.endsWith("/")?N.length-1:N.length;let T=w===N||!r&&w.startsWith(N)&&w.charAt(_)==="/",k=S!=null&&(S===N||!r&&S.startsWith(N)&&S.charAt(N.length)==="/"),A={isActive:T,isPending:k,isTransitioning:y},E=T?t:void 0,M;typeof s=="function"?M=s(A):M=[s,T?"active":null,k?"pending":null,y?"transitioning":null].filter(Boolean).join(" ");let F=typeof i=="function"?i(A):i;return f.createElement(ld,{...u,"aria-current":E,className:M,ref:d,style:F,to:o,viewTransition:l},typeof c=="function"?c(A):c)});$t.displayName="NavLink";var _se=f.forwardRef(({discover:e="render",fetcherKey:t,navigate:n,reloadDocument:s,replace:r,state:i,method:o=ov,action:l,onSubmit:c,relative:u,preventScrollReset:d,viewTransition:h,unstable_defaultShouldRevalidate:p,...x},b)=>{let{unstable_useTransitions:j}=f.useContext(Wr),y=Lse(),N=Dse(l,{relative:u}),w=o.toLowerCase()==="get"?"get":"post",S=typeof l=="string"&&RH.test(l),_=T=>{if(c&&c(T),T.defaultPrevented)return;T.preventDefault();let k=T.nativeEvent.submitter,A=k?.getAttribute("formmethod")||o,E=()=>y(k||T.currentTarget,{fetcherKey:t,method:A,navigate:n,replace:r,state:i,relative:u,preventScrollReset:d,viewTransition:h,unstable_defaultShouldRevalidate:p});j&&n!==!1?f.startTransition(()=>E()):E()};return f.createElement("form",{ref:b,method:w,action:N,onSubmit:s?c:_,...x,"data-discover":!S&&e==="render"?"true":void 0})});_se.displayName="Form";function Ase(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function zH(e){let t=f.useContext(Jf);return mn(t,Ase(e)),t}function Tse(e,{target:t,replace:n,state:s,preventScrollReset:r,relative:i,viewTransition:o,unstable_defaultShouldRevalidate:l,unstable_useTransitions:c}={}){let u=Et(),d=ta(),h=ox(e,{relative:i});return f.useCallback(p=>{if(rse(p,t)){p.preventDefault();let x=n!==void 0?n:bp(d)===bp(h),b=()=>u(e,{replace:x,state:s,preventScrollReset:r,relative:i,viewTransition:o,unstable_defaultShouldRevalidate:l});c?f.startTransition(()=>b()):b()}},[d,u,h,n,s,t,e,r,i,o,l,c])}function Bs(e){bi(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let t=f.useRef(KT(e)),n=f.useRef(!1),s=ta(),r=f.useMemo(()=>ise(s.search,n.current?null:t.current),[s.search]),i=Et(),o=f.useCallback((l,c)=>{const u=KT(typeof l=="function"?l(new URLSearchParams(r)):l);n.current=!0,i("?"+u,c)},[i,r]);return[r,o]}var kse=0,Ese=()=>`__${String(++kse)}__`;function Lse(){let{router:e}=zH("useSubmit"),{basename:t}=f.useContext(Wr),n=Qne(),s=e.fetch,r=e.navigate;return f.useCallback(async(i,o={})=>{let{action:l,method:c,encType:u,formData:d,body:h}=cse(i,t);if(o.navigate===!1){let p=o.fetcherKey||Ese();await s(p,n,o.action||l,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:d,body:h,formMethod:o.method||c,formEncType:o.encType||u,flushSync:o.flushSync})}else await r(o.action||l,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:d,body:h,formMethod:o.method||c,formEncType:o.encType||u,replace:o.replace,state:o.state,fromRouteId:n,flushSync:o.flushSync,viewTransition:o.viewTransition})},[s,r,t,n])}function Dse(e,{relative:t}={}){let{basename:n}=f.useContext(Wr),s=f.useContext(_i);mn(s,"useFormAction must be used inside a RouteContext");let[r]=s.matches.slice(-1),i={...ox(e||".",{relative:t})},o=ta();if(e==null){i.search=o.search;let l=new URLSearchParams(i.search),c=l.getAll("index");if(c.some(d=>d==="")){l.delete("index"),c.filter(h=>h).forEach(h=>l.append("index",h));let d=l.toString();i.search=d?`?${d}`:""}}return(!e||e===".")&&r.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(i.pathname=i.pathname==="/"?n:Ol([n,i.pathname])),bp(i)}function Pse(e,{relative:t}={}){let n=f.useContext(kH);mn(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:s}=zH("useViewTransitionState"),r=ox(e,{relative:t});if(!n.isTransitioning)return!1;let i=Rl(n.currentLocation.pathname,s)||n.currentLocation.pathname,o=Rl(n.nextLocation.pathname,s)||n.nextLocation.pathname;return kv(r.pathname,o)!=null||kv(r.pathname,i)!=null}var Gi=jH();const zy=ao(Gi);function FH(e){var t,n,s="";if(typeof e=="string"||typeof e=="number")s+=e;else if(typeof e=="object")if(Array.isArray(e)){var r=e.length;for(t=0;t<r;t++)e[t]&&(n=FH(e[t]))&&(s&&(s+=" "),s+=n)}else for(n in e)e[n]&&(s&&(s+=" "),s+=n);return s}function Rt(){for(var e,t,n=0,s="",r=arguments.length;n<r;n++)(e=arguments[n])&&(t=FH(e))&&(s&&(s+=" "),s+=t);return s}function Ose(e){if(typeof document>"u")return;let t=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",t.firstChild?t.insertBefore(n,t.firstChild):t.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}Ose(`:root{--toastify-color-light: #fff;--toastify-color-dark: #121212;--toastify-color-info: #3498db;--toastify-color-success: #07bc0c;--toastify-color-warning: #f1c40f;--toastify-color-error: hsl(6, 78%, 57%);--toastify-color-transparent: rgba(255, 255, 255, .7);--toastify-icon-color-info: var(--toastify-color-info);--toastify-icon-color-success: var(--toastify-color-success);--toastify-icon-color-warning: var(--toastify-color-warning);--toastify-icon-color-error: var(--toastify-color-error);--toastify-container-width: fit-content;--toastify-toast-width: 320px;--toastify-toast-offset: 16px;--toastify-toast-top: max(var(--toastify-toast-offset), env(safe-area-inset-top));--toastify-toast-right: max(var(--toastify-toast-offset), env(safe-area-inset-right));--toastify-toast-left: max(var(--toastify-toast-offset), env(safe-area-inset-left));--toastify-toast-bottom: max(var(--toastify-toast-offset), env(safe-area-inset-bottom));--toastify-toast-background: #fff;--toastify-toast-padding: 14px;--toastify-toast-min-height: 64px;--toastify-toast-max-height: 800px;--toastify-toast-bd-radius: 6px;--toastify-toast-shadow: 0px 4px 12px rgba(0, 0, 0, .1);--toastify-font-family: sans-serif;--toastify-z-index: 9999;--toastify-text-color-light: #757575;--toastify-text-color-dark: #fff;--toastify-text-color-info: #fff;--toastify-text-color-success: #fff;--toastify-text-color-warning: #fff;--toastify-text-color-error: #fff;--toastify-spinner-color: #616161;--toastify-spinner-color-empty-area: #e0e0e0;--toastify-color-progress-light: linear-gradient(to right, #4cd964, #5ac8fa, #007aff, #34aadc, #5856d6, #ff2d55);--toastify-color-progress-dark: #bb86fc;--toastify-color-progress-info: var(--toastify-color-info);--toastify-color-progress-success: var(--toastify-color-success);--toastify-color-progress-warning: var(--toastify-color-warning);--toastify-color-progress-error: var(--toastify-color-error);--toastify-color-progress-bgo: .2}.Toastify__toast-container{z-index:var(--toastify-z-index);-webkit-transform:translate3d(0,0,var(--toastify-z-index));position:fixed;width:var(--toastify-container-width);box-sizing:border-box;color:#fff;display:flex;flex-direction:column}.Toastify__toast-container--top-left{top:var(--toastify-toast-top);left:var(--toastify-toast-left)}.Toastify__toast-container--top-center{top:var(--toastify-toast-top);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--top-right{top:var(--toastify-toast-top);right:var(--toastify-toast-right);align-items:end}.Toastify__toast-container--bottom-left{bottom:var(--toastify-toast-bottom);left:var(--toastify-toast-left)}.Toastify__toast-container--bottom-center{bottom:var(--toastify-toast-bottom);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--bottom-right{bottom:var(--toastify-toast-bottom);right:var(--toastify-toast-right);align-items:end}.Toastify__toast{--y: 0;position:relative;touch-action:none;width:var(--toastify-toast-width);min-height:var(--toastify-toast-min-height);box-sizing:border-box;margin-bottom:1rem;padding:var(--toastify-toast-padding);border-radius:var(--toastify-toast-bd-radius);box-shadow:var(--toastify-toast-shadow);max-height:var(--toastify-toast-max-height);font-family:var(--toastify-font-family);z-index:0;display:flex;flex:1 auto;align-items:center;word-break:break-word}@media only screen and (max-width: 480px){.Toastify__toast-container{width:100vw;left:env(safe-area-inset-left);margin:0}.Toastify__toast-container--top-left,.Toastify__toast-container--top-center,.Toastify__toast-container--top-right{top:env(safe-area-inset-top);transform:translate(0)}.Toastify__toast-container--bottom-left,.Toastify__toast-container--bottom-center,.Toastify__toast-container--bottom-right{bottom:env(safe-area-inset-bottom);transform:translate(0)}.Toastify__toast-container--rtl{right:env(safe-area-inset-right);left:initial}.Toastify__toast{--toastify-toast-width: 100%;margin-bottom:0;border-radius:0}}.Toastify__toast-container[data-stacked=true]{width:var(--toastify-toast-width)}.Toastify__toast--stacked{position:absolute;width:100%;transform:translate3d(0,var(--y),0) scale(var(--s));transition:transform .3s}.Toastify__toast--stacked[data-collapsed] .Toastify__toast-body,.Toastify__toast--stacked[data-collapsed] .Toastify__close-button{transition:opacity .1s}.Toastify__toast--stacked[data-collapsed=false]{overflow:visible}.Toastify__toast--stacked[data-collapsed=true]:not(:last-child)>*{opacity:0}.Toastify__toast--stacked:after{content:"";position:absolute;left:0;right:0;height:calc(var(--g) * 1px);bottom:100%}.Toastify__toast--stacked[data-pos=top]{top:0}.Toastify__toast--stacked[data-pos=bot]{bottom:0}.Toastify__toast--stacked[data-pos=bot].Toastify__toast--stacked:before{transform-origin:top}.Toastify__toast--stacked[data-pos=top].Toastify__toast--stacked:before{transform-origin:bottom}.Toastify__toast--stacked:before{content:"";position:absolute;left:0;right:0;bottom:0;height:100%;transform:scaleY(3);z-index:-1}.Toastify__toast--rtl{direction:rtl}.Toastify__toast--close-on-click{cursor:pointer}.Toastify__toast-icon{margin-inline-end:10px;width:22px;flex-shrink:0;display:flex}.Toastify--animate{animation-fill-mode:both;animation-duration:.5s}.Toastify--animate-icon{animation-fill-mode:both;animation-duration:.3s}.Toastify__toast-theme--dark{background:var(--toastify-color-dark);color:var(--toastify-text-color-dark)}.Toastify__toast-theme--light,.Toastify__toast-theme--colored.Toastify__toast--default{background:var(--toastify-color-light);color:var(--toastify-text-color-light)}.Toastify__toast-theme--colored.Toastify__toast--info{color:var(--toastify-text-color-info);background:var(--toastify-color-info)}.Toastify__toast-theme--colored.Toastify__toast--success{color:var(--toastify-text-color-success);background:var(--toastify-color-success)}.Toastify__toast-theme--colored.Toastify__toast--warning{color:var(--toastify-text-color-warning);background:var(--toastify-color-warning)}.Toastify__toast-theme--colored.Toastify__toast--error{color:var(--toastify-text-color-error);background:var(--toastify-color-error)}.Toastify__progress-bar-theme--light{background:var(--toastify-color-progress-light)}.Toastify__progress-bar-theme--dark{background:var(--toastify-color-progress-dark)}.Toastify__progress-bar--info{background:var(--toastify-color-progress-info)}.Toastify__progress-bar--success{background:var(--toastify-color-progress-success)}.Toastify__progress-bar--warning{background:var(--toastify-color-progress-warning)}.Toastify__progress-bar--error{background:var(--toastify-color-progress-error)}.Toastify__progress-bar-theme--colored.Toastify__progress-bar--info,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--success,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--warning,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--error{background:var(--toastify-color-transparent)}.Toastify__close-button{color:#fff;position:absolute;top:6px;right:6px;background:transparent;outline:none;border:none;padding:0;cursor:pointer;opacity:.7;transition:.3s ease;z-index:1}.Toastify__toast--rtl .Toastify__close-button{left:6px;right:unset}.Toastify__close-button--light{color:#000;opacity:.3}.Toastify__close-button>svg{fill:currentColor;height:16px;width:14px}.Toastify__close-button:hover,.Toastify__close-button:focus{opacity:1}@keyframes Toastify__trackProgress{0%{transform:scaleX(1)}to{transform:scaleX(0)}}.Toastify__progress-bar{position:absolute;bottom:0;left:0;width:100%;height:100%;z-index:1;opacity:.7;transform-origin:left}.Toastify__progress-bar--animated{animation:Toastify__trackProgress linear 1 forwards}.Toastify__progress-bar--controlled{transition:transform .2s}.Toastify__progress-bar--rtl{right:0;left:initial;transform-origin:right;border-bottom-left-radius:initial}.Toastify__progress-bar--wrp{position:absolute;overflow:hidden;bottom:0;left:0;width:100%;height:5px;border-bottom-left-radius:var(--toastify-toast-bd-radius);border-bottom-right-radius:var(--toastify-toast-bd-radius)}.Toastify__progress-bar--wrp[data-hidden=true]{opacity:0}.Toastify__progress-bar--bg{opacity:var(--toastify-color-progress-bgo);width:100%;height:100%}.Toastify__spinner{width:20px;height:20px;box-sizing:border-box;border:2px solid;border-radius:100%;border-color:var(--toastify-spinner-color-empty-area);border-right-color:var(--toastify-spinner-color);animation:Toastify__spin .65s linear infinite}@keyframes Toastify__bounceInRight{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(3000px,0,0)}60%{opacity:1;transform:translate3d(-25px,0,0)}75%{transform:translate3d(10px,0,0)}90%{transform:translate3d(-5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutRight{20%{opacity:1;transform:translate3d(-20px,var(--y),0)}to{opacity:0;transform:translate3d(2000px,var(--y),0)}}@keyframes Toastify__bounceInLeft{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(-3000px,0,0)}60%{opacity:1;transform:translate3d(25px,0,0)}75%{transform:translate3d(-10px,0,0)}90%{transform:translate3d(5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutLeft{20%{opacity:1;transform:translate3d(20px,var(--y),0)}to{opacity:0;transform:translate3d(-2000px,var(--y),0)}}@keyframes Toastify__bounceInUp{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,3000px,0)}60%{opacity:1;transform:translate3d(0,-20px,0)}75%{transform:translate3d(0,10px,0)}90%{transform:translate3d(0,-5px,0)}to{transform:translateZ(0)}}@keyframes Toastify__bounceOutUp{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,-2000px,0)}}@keyframes Toastify__bounceInDown{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,-3000px,0)}60%{opacity:1;transform:translate3d(0,25px,0)}75%{transform:translate3d(0,-10px,0)}90%{transform:translate3d(0,5px,0)}to{transform:none}}@keyframes Toastify__bounceOutDown{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,2000px,0)}}.Toastify__bounce-enter--top-left,.Toastify__bounce-enter--bottom-left{animation-name:Toastify__bounceInLeft}.Toastify__bounce-enter--top-right,.Toastify__bounce-enter--bottom-right{animation-name:Toastify__bounceInRight}.Toastify__bounce-enter--top-center{animation-name:Toastify__bounceInDown}.Toastify__bounce-enter--bottom-center{animation-name:Toastify__bounceInUp}.Toastify__bounce-exit--top-left,.Toastify__bounce-exit--bottom-left{animation-name:Toastify__bounceOutLeft}.Toastify__bounce-exit--top-right,.Toastify__bounce-exit--bottom-right{animation-name:Toastify__bounceOutRight}.Toastify__bounce-exit--top-center{animation-name:Toastify__bounceOutUp}.Toastify__bounce-exit--bottom-center{animation-name:Toastify__bounceOutDown}@keyframes Toastify__zoomIn{0%{opacity:0;transform:scale3d(.3,.3,.3)}50%{opacity:1}}@keyframes Toastify__zoomOut{0%{opacity:1}50%{opacity:0;transform:translate3d(0,var(--y),0) scale3d(.3,.3,.3)}to{opacity:0}}.Toastify__zoom-enter{animation-name:Toastify__zoomIn}.Toastify__zoom-exit{animation-name:Toastify__zoomOut}@keyframes Toastify__flipIn{0%{transform:perspective(400px) rotateX(90deg);animation-timing-function:ease-in;opacity:0}40%{transform:perspective(400px) rotateX(-20deg);animation-timing-function:ease-in}60%{transform:perspective(400px) rotateX(10deg);opacity:1}80%{transform:perspective(400px) rotateX(-5deg)}to{transform:perspective(400px)}}@keyframes Toastify__flipOut{0%{transform:translate3d(0,var(--y),0) perspective(400px)}30%{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(-20deg);opacity:1}to{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(90deg);opacity:0}}.Toastify__flip-enter{animation-name:Toastify__flipIn}.Toastify__flip-exit{animation-name:Toastify__flipOut}@keyframes Toastify__slideInRight{0%{transform:translate3d(110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInLeft{0%{transform:translate3d(-110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInUp{0%{transform:translate3d(0,110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInDown{0%{transform:translate3d(0,-110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideOutRight{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(110%,var(--y),0)}}@keyframes Toastify__slideOutLeft{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(-110%,var(--y),0)}}@keyframes Toastify__slideOutDown{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,500px,0)}}@keyframes Toastify__slideOutUp{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,-500px,0)}}.Toastify__slide-enter--top-left,.Toastify__slide-enter--bottom-left{animation-name:Toastify__slideInLeft}.Toastify__slide-enter--top-right,.Toastify__slide-enter--bottom-right{animation-name:Toastify__slideInRight}.Toastify__slide-enter--top-center{animation-name:Toastify__slideInDown}.Toastify__slide-enter--bottom-center{animation-name:Toastify__slideInUp}.Toastify__slide-exit--top-left,.Toastify__slide-exit--bottom-left{animation-name:Toastify__slideOutLeft;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-right,.Toastify__slide-exit--bottom-right{animation-name:Toastify__slideOutRight;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-center{animation-name:Toastify__slideOutUp;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--bottom-center{animation-name:Toastify__slideOutDown;animation-timing-function:ease-in;animation-duration:.3s}@keyframes Toastify__spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}
`);var lx=e=>typeof e=="number"&&!isNaN(e),Iu=e=>typeof e=="string",zl=e=>typeof e=="function",Mse=e=>Iu(e)||lx(e),XT=e=>Iu(e)||zl(e)?e:null,Ise=(e,t)=>e===!1||lx(e)&&e>0?e:t,ZT=e=>f.isValidElement(e)||Iu(e)||zl(e)||lx(e);function $se(e,t,n=300){let{scrollHeight:s,style:r}=e;requestAnimationFrame(()=>{r.minHeight="initial",r.height=s+"px",r.transition=`all ${n}ms`,requestAnimationFrame(()=>{r.height="0",r.padding="0",r.margin="0",setTimeout(t,n)})})}function Rse({enter:e,exit:t,appendPosition:n=!1,collapse:s=!0,collapseDuration:r=300}){return function({children:i,position:o,preventExitTransition:l,done:c,nodeRef:u,isIn:d,playToast:h}){let p=n?`${e}--${o}`:e,x=n?`${t}--${o}`:t,b=f.useRef(0);return f.useLayoutEffect(()=>{let j=u.current,y=p.split(" "),N=w=>{w.target===u.current&&(h(),j.removeEventListener("animationend",N),j.removeEventListener("animationcancel",N),b.current===0&&w.type!=="animationcancel"&&j.classList.remove(...y))};j.classList.add(...y),j.addEventListener("animationend",N),j.addEventListener("animationcancel",N)},[]),f.useEffect(()=>{let j=u.current,y=()=>{j.removeEventListener("animationend",y),s?$se(j,c,r):c()};d||(l?y():(b.current=1,j.className+=` ${x}`,j.addEventListener("animationend",y)))},[d]),wt.createElement(wt.Fragment,null,i)}}function AI(e,t){return{content:UH(e.content,e.props),containerId:e.props.containerId,id:e.props.toastId,theme:e.props.theme,type:e.props.type,data:e.props.data||{},isLoading:e.props.isLoading,icon:e.props.icon,reason:e.removalReason,status:t}}function UH(e,t,n=!1){return f.isValidElement(e)&&!Iu(e.type)?f.cloneElement(e,{closeToast:t.closeToast,toastProps:t,data:t.data,isPaused:n}):zl(e)?e({closeToast:t.closeToast,toastProps:t,data:t.data,isPaused:n}):e}function zse({closeToast:e,theme:t,ariaLabel:n="close"}){return wt.createElement("button",{className:`Toastify__close-button Toastify__close-button--${t}`,type:"button",onClick:s=>{s.stopPropagation(),e(!0)},"aria-label":n},wt.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},wt.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}function Fse({delay:e,isRunning:t,closeToast:n,type:s="default",hide:r,className:i,controlledProgress:o,progress:l,rtl:c,isIn:u,theme:d}){let h=r||o&&l===0,p={animationDuration:`${e}ms`,animationPlayState:t?"running":"paused"};o&&(p.transform=`scaleX(${l})`);let x=Rt("Toastify__progress-bar",o?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${d}`,`Toastify__progress-bar--${s}`,{"Toastify__progress-bar--rtl":c}),b=zl(i)?i({rtl:c,type:s,defaultClassName:x}):Rt(x,i),j={[o&&l>=1?"onTransitionEnd":"onAnimationEnd"]:o&&l<1?null:()=>{u&&n()}};return wt.createElement("div",{className:"Toastify__progress-bar--wrp","data-hidden":h},wt.createElement("div",{className:`Toastify__progress-bar--bg Toastify__progress-bar-theme--${d} Toastify__progress-bar--${s}`}),wt.createElement("div",{role:"progressbar","aria-hidden":h?"true":"false","aria-label":"notification timer",className:b,style:p,...j}))}var Use=1,BH=()=>`${Use++}`;function Bse(e,t,n){let s=1,r=0,i=[],o=[],l=t,c=new Map,u=new Set,d=w=>(u.add(w),()=>u.delete(w)),h=()=>{o=Array.from(c.values()),u.forEach(w=>w())},p=({containerId:w,toastId:S,updateId:_})=>{let T=w?w!==e:e!==1,k=c.has(S)&&_==null;return T||k},x=(w,S)=>{c.forEach(_=>{var T;(S==null||S===_.props.toastId)&&((T=_.toggle)==null||T.call(_,w))})},b=w=>{var S,_;(_=(S=w.props)==null?void 0:S.onClose)==null||_.call(S,w.removalReason),w.isActive=!1},j=w=>{if(w==null)c.forEach(b);else{let S=c.get(w);S&&b(S)}h()},y=()=>{r-=i.length,i=[]},N=w=>{var S,_;let{toastId:T,updateId:k}=w.props,A=k==null;w.staleId&&c.delete(w.staleId),w.isActive=!0,c.set(T,w),h(),n(AI(w,A?"added":"updated")),A&&((_=(S=w.props).onOpen)==null||_.call(S))};return{id:e,props:l,observe:d,toggle:x,removeToast:j,toasts:c,clearQueue:y,buildToast:(w,S)=>{if(p(S))return;let{toastId:_,updateId:T,data:k,staleId:A,delay:E}=S,M=T==null;M&&r++;let F={...l,style:l.toastStyle,key:s++,...Object.fromEntries(Object.entries(S).filter(([P,B])=>B!=null)),toastId:_,updateId:T,data:k,isIn:!1,className:XT(S.className||l.toastClassName),progressClassName:XT(S.progressClassName||l.progressClassName),autoClose:S.isLoading?!1:Ise(S.autoClose,l.autoClose),closeToast(P){c.get(_).removalReason=P,j(_)},deleteToast(){let P=c.get(_);if(P!=null){if(n(AI(P,"removed")),c.delete(_),r--,r<0&&(r=0),i.length>0){N(i.shift());return}h()}}};F.closeButton=l.closeButton,S.closeButton===!1||ZT(S.closeButton)?F.closeButton=S.closeButton:S.closeButton===!0&&(F.closeButton=ZT(l.closeButton)?l.closeButton:!0);let D={content:w,props:F,staleId:A};l.limit&&l.limit>0&&r>l.limit&&M?i.push(D):lx(E)?setTimeout(()=>{N(D)},E):N(D)},setProps(w){l=w},setToggle:(w,S)=>{let _=c.get(w);_&&(_.toggle=S)},isToastActive:w=>{var S;return(S=c.get(w))==null?void 0:S.isActive},getSnapshot:()=>o}}var Ws=new Map,vp=[],JT=new Set,Hse=e=>JT.forEach(t=>t(e)),HH=()=>Ws.size>0;function qse(){vp.forEach(e=>GH(e.content,e.options)),vp=[]}var Gse=(e,{containerId:t})=>{var n;return(n=Ws.get(t||1))==null?void 0:n.toasts.get(e)};function qH(e,t){var n;if(t)return!!((n=Ws.get(t))!=null&&n.isToastActive(e));let s=!1;return Ws.forEach(r=>{r.isToastActive(e)&&(s=!0)}),s}function Wse(e){if(!HH()){vp=vp.filter(t=>e!=null&&t.options.toastId!==e);return}if(e==null||Mse(e))Ws.forEach(t=>{t.removeToast(e)});else if(e&&("containerId"in e||"id"in e)){let t=Ws.get(e.containerId);t?t.removeToast(e.id):Ws.forEach(n=>{n.removeToast(e.id)})}}var Vse=(e={})=>{Ws.forEach(t=>{t.props.limit&&(!e.containerId||t.id===e.containerId)&&t.clearQueue()})};function GH(e,t){ZT(e)&&(HH()||vp.push({content:e,options:t}),Ws.forEach(n=>{n.buildToast(e,t)}))}function Yse(e){var t;(t=Ws.get(e.containerId||1))==null||t.setToggle(e.id,e.fn)}function WH(e,t){Ws.forEach(n=>{(t==null||!(t!=null&&t.containerId)||t?.containerId===n.id)&&n.toggle(e,t?.id)})}function Qse(e){let t=e.containerId||1;return{subscribe(n){let s=Bse(t,e,Hse);Ws.set(t,s);let r=s.observe(n);return qse(),()=>{r(),Ws.delete(t)}},setProps(n){var s;(s=Ws.get(t))==null||s.setProps(n)},getSnapshot(){var n;return(n=Ws.get(t))==null?void 0:n.getSnapshot()}}}function Kse(e){return JT.add(e),()=>{JT.delete(e)}}function Xse(e){return e&&(Iu(e.toastId)||lx(e.toastId))?e.toastId:BH()}function cx(e,t){return GH(e,t),t.toastId}function uj(e,t){return{...t,type:t&&t.type||e,toastId:Xse(t)}}function mj(e){return(t,n)=>cx(t,uj(e,n))}function V(e,t){return cx(e,uj("default",t))}V.loading=(e,t)=>cx(e,uj("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...t}));function Zse(e,{pending:t,error:n,success:s},r){let i;t&&(i=Iu(t)?V.loading(t,r):V.loading(t.render,{...r,...t}));let o={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},l=(u,d,h)=>{if(d==null){V.dismiss(i);return}let p={type:u,...o,...r,data:h},x=Iu(d)?{render:d}:d;return i?V.update(i,{...p,...x}):V(x.render,{...p,...x}),h},c=zl(e)?e():e;return c.then(u=>l("success",s,u)).catch(u=>l("error",n,u)),c}V.promise=Zse;V.success=mj("success");V.info=mj("info");V.error=mj("error");V.warning=mj("warning");V.warn=V.warning;V.dark=(e,t)=>cx(e,uj("default",{theme:"dark",...t}));function Jse(e){Wse(e)}V.dismiss=Jse;V.clearWaitingQueue=Vse;V.isActive=qH;V.update=(e,t={})=>{let n=Gse(e,t);if(n){let{props:s,content:r}=n,i={delay:100,...s,...t,toastId:t.toastId||e,updateId:BH()};i.toastId!==e&&(i.staleId=e);let o=i.render||r;delete i.render,cx(o,i)}};V.done=e=>{V.update(e,{progress:1})};V.onChange=Kse;V.play=e=>WH(!0,e);V.pause=e=>WH(!1,e);function ere(e){var t;let{subscribe:n,getSnapshot:s,setProps:r}=f.useRef(Qse(e)).current;r(e);let i=(t=f.useSyncExternalStore(n,s,s))==null?void 0:t.slice();function o(l){if(!i)return[];let c=new Map;return e.newestOnTop&&i.reverse(),i.forEach(u=>{let{position:d}=u.props;c.has(d)||c.set(d,[]),c.get(d).push(u)}),Array.from(c,u=>l(u[0],u[1]))}return{getToastToRender:o,isToastActive:qH,count:i?.length}}function tre(e){let[t,n]=f.useState(!1),[s,r]=f.useState(!1),i=f.useRef(null),o=f.useRef({start:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,didMove:!1}).current,{autoClose:l,pauseOnHover:c,closeToast:u,onClick:d,closeOnClick:h}=e;Yse({id:e.toastId,containerId:e.containerId,fn:n}),f.useEffect(()=>{if(e.pauseOnFocusLoss)return p(),()=>{x()}},[e.pauseOnFocusLoss]);function p(){document.hasFocus()||N(),window.addEventListener("focus",y),window.addEventListener("blur",N)}function x(){window.removeEventListener("focus",y),window.removeEventListener("blur",N)}function b(A){if(e.draggable===!0||e.draggable===A.pointerType){w();let E=i.current;o.canCloseOnClick=!0,o.canDrag=!0,E.style.transition="none",e.draggableDirection==="x"?(o.start=A.clientX,o.removalDistance=E.offsetWidth*(e.draggablePercent/100)):(o.start=A.clientY,o.removalDistance=E.offsetHeight*(e.draggablePercent===80?e.draggablePercent*1.5:e.draggablePercent)/100)}}function j(A){let{top:E,bottom:M,left:F,right:D}=i.current.getBoundingClientRect();A.nativeEvent.type!=="touchend"&&e.pauseOnHover&&A.clientX>=F&&A.clientX<=D&&A.clientY>=E&&A.clientY<=M?N():y()}function y(){n(!0)}function N(){n(!1)}function w(){o.didMove=!1,document.addEventListener("pointermove",_),document.addEventListener("pointerup",T)}function S(){document.removeEventListener("pointermove",_),document.removeEventListener("pointerup",T)}function _(A){let E=i.current;if(o.canDrag&&E){o.didMove=!0,t&&N(),e.draggableDirection==="x"?o.delta=A.clientX-o.start:o.delta=A.clientY-o.start,o.start!==A.clientX&&(o.canCloseOnClick=!1);let M=e.draggableDirection==="x"?`${o.delta}px, var(--y)`:`0, calc(${o.delta}px + var(--y))`;E.style.transform=`translate3d(${M},0)`,E.style.opacity=`${1-Math.abs(o.delta/o.removalDistance)}`}}function T(){S();let A=i.current;if(o.canDrag&&o.didMove&&A){if(o.canDrag=!1,Math.abs(o.delta)>o.removalDistance){r(!0),e.closeToast(!0),e.collapseAll();return}A.style.transition="transform 0.2s, opacity 0.2s",A.style.removeProperty("transform"),A.style.removeProperty("opacity")}}let k={onPointerDown:b,onPointerUp:j};return l&&c&&(k.onMouseEnter=N,e.stacked||(k.onMouseLeave=y)),h&&(k.onClick=A=>{d&&d(A),o.canCloseOnClick&&u(!0)}),{playToast:y,pauseToast:N,isRunning:t,preventExitTransition:s,toastRef:i,eventHandlers:k}}var are=typeof window<"u"?f.useLayoutEffect:f.useEffect,fj=({theme:e,type:t,isLoading:n,...s})=>wt.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:e==="colored"?"currentColor":`var(--toastify-icon-color-${t})`,...s});function nre(e){return wt.createElement(fj,{...e},wt.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))}function sre(e){return wt.createElement(fj,{...e},wt.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))}function rre(e){return wt.createElement(fj,{...e},wt.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))}function ire(e){return wt.createElement(fj,{...e},wt.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))}function ore(){return wt.createElement("div",{className:"Toastify__spinner"})}var ek={info:sre,warning:nre,success:rre,error:ire,spinner:ore},lre=e=>e in ek;function cre({theme:e,type:t,isLoading:n,icon:s}){let r=null,i={theme:e,type:t};return s===!1||(zl(s)?r=s({...i,isLoading:n}):f.isValidElement(s)?r=f.cloneElement(s,i):n?r=ek.spinner():lre(t)&&(r=ek[t](i))),r}var dre=e=>{let{isRunning:t,preventExitTransition:n,toastRef:s,eventHandlers:r,playToast:i}=tre(e),{closeButton:o,children:l,autoClose:c,onClick:u,type:d,hideProgressBar:h,closeToast:p,transition:x,position:b,className:j,style:y,progressClassName:N,updateId:w,role:S,progress:_,rtl:T,toastId:k,deleteToast:A,isIn:E,isLoading:M,closeOnClick:F,theme:D,ariaLabel:P}=e,B=Rt("Toastify__toast",`Toastify__toast-theme--${D}`,`Toastify__toast--${d}`,{"Toastify__toast--rtl":T},{"Toastify__toast--close-on-click":F}),G=zl(j)?j({rtl:T,position:b,type:d,defaultClassName:B}):Rt(B,j),$=cre(e),W=!!_||!c,Z={closeToast:p,type:d,theme:D},Q=null;return o===!1||(zl(o)?Q=o(Z):f.isValidElement(o)?Q=f.cloneElement(o,Z):Q=zse(Z)),wt.createElement(x,{isIn:E,done:A,position:b,preventExitTransition:n,nodeRef:s,playToast:i},wt.createElement("div",{id:k,tabIndex:0,onClick:u,"data-in":E,className:G,...r,style:y,ref:s,...E&&{role:S,"aria-label":P}},$!=null&&wt.createElement("div",{className:Rt("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!M})},$),UH(l,e,!t),Q,!e.customProgressBar&&wt.createElement(Fse,{...w&&!W?{key:`p-${w}`}:{},rtl:T,theme:D,delay:c,isRunning:t,isIn:E,closeToast:p,hide:h,type:d,className:N,controlledProgress:W,progress:_||0})))},ure=(e,t=!1)=>({enter:`Toastify--animate Toastify__${e}-enter`,exit:`Toastify--animate Toastify__${e}-exit`,appendPosition:t}),mre=Rse(ure("bounce",!0)),fre={position:"top-right",transition:mre,autoClose:5e3,closeButton:!0,pauseOnHover:!0,pauseOnFocusLoss:!0,draggable:"touch",draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light","aria-label":"Notifications Alt+T",hotKeys:e=>e.altKey&&e.code==="KeyT"};function hre(e){let t={...fre,...e},n=e.stacked,[s,r]=f.useState(!0),i=f.useRef(null),{getToastToRender:o,isToastActive:l,count:c}=ere(t),{className:u,style:d,rtl:h,containerId:p,hotKeys:x}=t;function b(y){let N=Rt("Toastify__toast-container",`Toastify__toast-container--${y}`,{"Toastify__toast-container--rtl":h});return zl(u)?u({position:y,rtl:h,defaultClassName:N}):Rt(N,XT(u))}function j(){n&&(r(!0),V.play())}return are(()=>{var y;if(n){let N=i.current.querySelectorAll('[data-in="true"]'),w=12,S=(y=t.position)==null?void 0:y.includes("top"),_=0,T=0;Array.from(N).reverse().forEach((k,A)=>{let E=k;E.classList.add("Toastify__toast--stacked"),A>0&&(E.dataset.collapsed=`${s}`),E.dataset.pos||(E.dataset.pos=S?"top":"bot");let M=_*(s?.2:1)+(s?0:w*A);E.style.setProperty("--y",`${S?M:M*-1}px`),E.style.setProperty("--g",`${w}`),E.style.setProperty("--s",`${1-(s?T:0)}`),_+=E.offsetHeight,T+=.025})}},[s,c,n]),f.useEffect(()=>{function y(N){var w;let S=i.current;x(N)&&((w=S.querySelector('[tabIndex="0"]'))==null||w.focus(),r(!1),V.pause()),N.key==="Escape"&&(document.activeElement===S||S!=null&&S.contains(document.activeElement))&&(r(!0),V.play())}return document.addEventListener("keydown",y),()=>{document.removeEventListener("keydown",y)}},[x]),wt.createElement("section",{ref:i,className:"Toastify",id:p,onMouseEnter:()=>{n&&(r(!1),V.pause())},onMouseLeave:j,"aria-live":"polite","aria-atomic":"false","aria-relevant":"additions text","aria-label":t["aria-label"]},o((y,N)=>{let w=N.length?{...d}:{...d,pointerEvents:"none"};return wt.createElement("div",{tabIndex:-1,className:b(y),"data-stacked":n,style:w,key:`c-${y}`},N.map(({content:S,props:_})=>wt.createElement(dre,{..._,stacked:n,collapseAll:j,isIn:l(_.toastId,_.containerId),key:`t-${_.key}`},S)))}))}function VH(e,t){return function(){return e.apply(t,arguments)}}const{toString:gre}=Object.prototype,{getPrototypeOf:CL}=Object,{iterator:hj,toStringTag:YH}=Symbol,gj=(e=>t=>{const n=gre.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),no=e=>(e=e.toLowerCase(),t=>gj(t)===e),pj=e=>t=>typeof t===e,{isArray:ah}=Array,Ef=pj("undefined");function dx(e){return e!==null&&!Ef(e)&&e.constructor!==null&&!Ef(e.constructor)&&gr(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const QH=no("ArrayBuffer");function pre(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&QH(e.buffer),t}const xre=pj("string"),gr=pj("function"),KH=pj("number"),ux=e=>e!==null&&typeof e=="object",yre=e=>e===!0||e===!1,cv=e=>{if(gj(e)!=="object")return!1;const t=CL(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(YH in e)&&!(hj in e)},bre=e=>{if(!ux(e)||dx(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},vre=no("Date"),wre=no("File"),jre=no("Blob"),Nre=no("FileList"),Cre=e=>ux(e)&&gr(e.pipe),Sre=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||gr(e.append)&&((t=gj(e))==="formdata"||t==="object"&&gr(e.toString)&&e.toString()==="[object FormData]"))},_re=no("URLSearchParams"),[Are,Tre,kre,Ere]=["ReadableStream","Request","Response","Headers"].map(no),Lre=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function mx(e,t,{allOwnKeys:n=!1}={}){if(e===null||typeof e>"u")return;let s,r;if(typeof e!="object"&&(e=[e]),ah(e))for(s=0,r=e.length;s<r;s++)t.call(null,e[s],s,e);else{if(dx(e))return;const i=n?Object.getOwnPropertyNames(e):Object.keys(e),o=i.length;let l;for(s=0;s<o;s++)l=i[s],t.call(null,e[l],l,e)}}function XH(e,t){if(dx(e))return null;t=t.toLowerCase();const n=Object.keys(e);let s=n.length,r;for(;s-- >0;)if(r=n[s],t===r.toLowerCase())return r;return null}const xu=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,ZH=e=>!Ef(e)&&e!==xu;function tk(){const{caseless:e,skipUndefined:t}=ZH(this)&&this||{},n={},s=(r,i)=>{const o=e&&XH(n,i)||i;cv(n[o])&&cv(r)?n[o]=tk(n[o],r):cv(r)?n[o]=tk({},r):ah(r)?n[o]=r.slice():(!t||!Ef(r))&&(n[o]=r)};for(let r=0,i=arguments.length;r<i;r++)arguments[r]&&mx(arguments[r],s);return n}const Dre=(e,t,n,{allOwnKeys:s}={})=>(mx(t,(r,i)=>{n&&gr(r)?e[i]=VH(r,n):e[i]=r},{allOwnKeys:s}),e),Pre=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),Ore=(e,t,n,s)=>{e.prototype=Object.create(t.prototype,s),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},Mre=(e,t,n,s)=>{let r,i,o;const l={};if(t=t||{},e==null)return t;do{for(r=Object.getOwnPropertyNames(e),i=r.length;i-- >0;)o=r[i],(!s||s(o,e,t))&&!l[o]&&(t[o]=e[o],l[o]=!0);e=n!==!1&&CL(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},Ire=(e,t,n)=>{e=String(e),(n===void 0||n>e.length)&&(n=e.length),n-=t.length;const s=e.indexOf(t,n);return s!==-1&&s===n},$re=e=>{if(!e)return null;if(ah(e))return e;let t=e.length;if(!KH(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},Rre=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&CL(Uint8Array)),zre=(e,t)=>{const s=(e&&e[hj]).call(e);let r;for(;(r=s.next())&&!r.done;){const i=r.value;t.call(e,i[0],i[1])}},Fre=(e,t)=>{let n;const s=[];for(;(n=e.exec(t))!==null;)s.push(n);return s},Ure=no("HTMLFormElement"),Bre=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,s,r){return s.toUpperCase()+r}),TI=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),Hre=no("RegExp"),JH=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),s={};mx(n,(r,i)=>{let o;(o=t(r,i,e))!==!1&&(s[i]=o||r)}),Object.defineProperties(e,s)},qre=e=>{JH(e,(t,n)=>{if(gr(e)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const s=e[n];if(gr(s)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},Gre=(e,t)=>{const n={},s=r=>{r.forEach(i=>{n[i]=!0})};return ah(e)?s(e):s(String(e).split(t)),n},Wre=()=>{},Vre=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function Yre(e){return!!(e&&gr(e.append)&&e[YH]==="FormData"&&e[hj])}const Qre=e=>{const t=new Array(10),n=(s,r)=>{if(ux(s)){if(t.indexOf(s)>=0)return;if(dx(s))return s;if(!("toJSON"in s)){t[r]=s;const i=ah(s)?[]:{};return mx(s,(o,l)=>{const c=n(o,r+1);!Ef(c)&&(i[l]=c)}),t[r]=void 0,i}}return s};return n(e,0)},Kre=no("AsyncFunction"),Xre=e=>e&&(ux(e)||gr(e))&&gr(e.then)&&gr(e.catch),e9=((e,t)=>e?setImmediate:t?((n,s)=>(xu.addEventListener("message",({source:r,data:i})=>{r===xu&&i===n&&s.length&&s.shift()()},!1),r=>{s.push(r),xu.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",gr(xu.postMessage)),Zre=typeof queueMicrotask<"u"?queueMicrotask.bind(xu):typeof process<"u"&&process.nextTick||e9,Jre=e=>e!=null&&gr(e[hj]),ht={isArray:ah,isArrayBuffer:QH,isBuffer:dx,isFormData:Sre,isArrayBufferView:pre,isString:xre,isNumber:KH,isBoolean:yre,isObject:ux,isPlainObject:cv,isEmptyObject:bre,isReadableStream:Are,isRequest:Tre,isResponse:kre,isHeaders:Ere,isUndefined:Ef,isDate:vre,isFile:wre,isBlob:jre,isRegExp:Hre,isFunction:gr,isStream:Cre,isURLSearchParams:_re,isTypedArray:Rre,isFileList:Nre,forEach:mx,merge:tk,extend:Dre,trim:Lre,stripBOM:Pre,inherits:Ore,toFlatObject:Mre,kindOf:gj,kindOfTest:no,endsWith:Ire,toArray:$re,forEachEntry:zre,matchAll:Fre,isHTMLForm:Ure,hasOwnProperty:TI,hasOwnProp:TI,reduceDescriptors:JH,freezeMethods:qre,toObjectSet:Gre,toCamelCase:Bre,noop:Wre,toFiniteNumber:Vre,findKey:XH,global:xu,isContextDefined:ZH,isSpecCompliantForm:Yre,toJSONObject:Qre,isAsyncFn:Kre,isThenable:Xre,setImmediate:e9,asap:Zre,isIterable:Jre};function la(e,t,n,s,r){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),s&&(this.request=s),r&&(this.response=r,this.status=r.status?r.status:null)}ht.inherits(la,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ht.toJSONObject(this.config),code:this.code,status:this.status}}});const t9=la.prototype,a9={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{a9[e]={value:e}});Object.defineProperties(la,a9);Object.defineProperty(t9,"isAxiosError",{value:!0});la.from=(e,t,n,s,r,i)=>{const o=Object.create(t9);ht.toFlatObject(e,o,function(d){return d!==Error.prototype},u=>u!=="isAxiosError");const l=e&&e.message?e.message:"Error",c=t==null&&e?e.code:t;return la.call(o,l,c,n,s,r),e&&o.cause==null&&Object.defineProperty(o,"cause",{value:e,configurable:!0}),o.name=e&&e.name||"Error",i&&Object.assign(o,i),o};const eie=null;function ak(e){return ht.isPlainObject(e)||ht.isArray(e)}function n9(e){return ht.endsWith(e,"[]")?e.slice(0,-2):e}function kI(e,t,n){return e?e.concat(t).map(function(r,i){return r=n9(r),!n&&i?"["+r+"]":r}).join(n?".":""):t}function tie(e){return ht.isArray(e)&&!e.some(ak)}const aie=ht.toFlatObject(ht,{},null,function(t){return/^is[A-Z]/.test(t)});function xj(e,t,n){if(!ht.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,n=ht.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(j,y){return!ht.isUndefined(y[j])});const s=n.metaTokens,r=n.visitor||d,i=n.dots,o=n.indexes,c=(n.Blob||typeof Blob<"u"&&Blob)&&ht.isSpecCompliantForm(t);if(!ht.isFunction(r))throw new TypeError("visitor must be a function");function u(b){if(b===null)return"";if(ht.isDate(b))return b.toISOString();if(ht.isBoolean(b))return b.toString();if(!c&&ht.isBlob(b))throw new la("Blob is not supported. Use a Buffer instead.");return ht.isArrayBuffer(b)||ht.isTypedArray(b)?c&&typeof Blob=="function"?new Blob([b]):Buffer.from(b):b}function d(b,j,y){let N=b;if(b&&!y&&typeof b=="object"){if(ht.endsWith(j,"{}"))j=s?j:j.slice(0,-2),b=JSON.stringify(b);else if(ht.isArray(b)&&tie(b)||(ht.isFileList(b)||ht.endsWith(j,"[]"))&&(N=ht.toArray(b)))return j=n9(j),N.forEach(function(S,_){!(ht.isUndefined(S)||S===null)&&t.append(o===!0?kI([j],_,i):o===null?j:j+"[]",u(S))}),!1}return ak(b)?!0:(t.append(kI(y,j,i),u(b)),!1)}const h=[],p=Object.assign(aie,{defaultVisitor:d,convertValue:u,isVisitable:ak});function x(b,j){if(!ht.isUndefined(b)){if(h.indexOf(b)!==-1)throw Error("Circular reference detected in "+j.join("."));h.push(b),ht.forEach(b,function(N,w){(!(ht.isUndefined(N)||N===null)&&r.call(t,N,ht.isString(w)?w.trim():w,j,p))===!0&&x(N,j?j.concat(w):[w])}),h.pop()}}if(!ht.isObject(e))throw new TypeError("data must be an object");return x(e),t}function EI(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(s){return t[s]})}function SL(e,t){this._pairs=[],e&&xj(e,this,t)}const s9=SL.prototype;s9.append=function(t,n){this._pairs.push([t,n])};s9.toString=function(t){const n=t?function(s){return t.call(this,s,EI)}:EI;return this._pairs.map(function(r){return n(r[0])+"="+n(r[1])},"").join("&")};function nie(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function r9(e,t,n){if(!t)return e;const s=n&&n.encode||nie;ht.isFunction(n)&&(n={serialize:n});const r=n&&n.serialize;let i;if(r?i=r(t,n):i=ht.isURLSearchParams(t)?t.toString():new SL(t,n).toString(s),i){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+i}return e}class LI{constructor(){this.handlers=[]}use(t,n,s){return this.handlers.push({fulfilled:t,rejected:n,synchronous:s?s.synchronous:!1,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){ht.forEach(this.handlers,function(s){s!==null&&t(s)})}}const i9={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},sie=typeof URLSearchParams<"u"?URLSearchParams:SL,rie=typeof FormData<"u"?FormData:null,iie=typeof Blob<"u"?Blob:null,oie={isBrowser:!0,classes:{URLSearchParams:sie,FormData:rie,Blob:iie},protocols:["http","https","file","blob","url","data"]},_L=typeof window<"u"&&typeof document<"u",nk=typeof navigator=="object"&&navigator||void 0,lie=_L&&(!nk||["ReactNative","NativeScript","NS"].indexOf(nk.product)<0),cie=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",die=_L&&window.location.href||"http://localhost",uie=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:_L,hasStandardBrowserEnv:lie,hasStandardBrowserWebWorkerEnv:cie,navigator:nk,origin:die},Symbol.toStringTag,{value:"Module"})),$s={...uie,...oie};function mie(e,t){return xj(e,new $s.classes.URLSearchParams,{visitor:function(n,s,r,i){return $s.isNode&&ht.isBuffer(n)?(this.append(s,n.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...t})}function fie(e){return ht.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function hie(e){const t={},n=Object.keys(e);let s;const r=n.length;let i;for(s=0;s<r;s++)i=n[s],t[i]=e[i];return t}function o9(e){function t(n,s,r,i){let o=n[i++];if(o==="__proto__")return!0;const l=Number.isFinite(+o),c=i>=n.length;return o=!o&&ht.isArray(r)?r.length:o,c?(ht.hasOwnProp(r,o)?r[o]=[r[o],s]:r[o]=s,!l):((!r[o]||!ht.isObject(r[o]))&&(r[o]=[]),t(n,s,r[o],i)&&ht.isArray(r[o])&&(r[o]=hie(r[o])),!l)}if(ht.isFormData(e)&&ht.isFunction(e.entries)){const n={};return ht.forEachEntry(e,(s,r)=>{t(fie(s),r,n,0)}),n}return null}function gie(e,t,n){if(ht.isString(e))try{return(t||JSON.parse)(e),ht.trim(e)}catch(s){if(s.name!=="SyntaxError")throw s}return(n||JSON.stringify)(e)}const fx={transitional:i9,adapter:["xhr","http","fetch"],transformRequest:[function(t,n){const s=n.getContentType()||"",r=s.indexOf("application/json")>-1,i=ht.isObject(t);if(i&&ht.isHTMLForm(t)&&(t=new FormData(t)),ht.isFormData(t))return r?JSON.stringify(o9(t)):t;if(ht.isArrayBuffer(t)||ht.isBuffer(t)||ht.isStream(t)||ht.isFile(t)||ht.isBlob(t)||ht.isReadableStream(t))return t;if(ht.isArrayBufferView(t))return t.buffer;if(ht.isURLSearchParams(t))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let l;if(i){if(s.indexOf("application/x-www-form-urlencoded")>-1)return mie(t,this.formSerializer).toString();if((l=ht.isFileList(t))||s.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return xj(l?{"files[]":t}:t,c&&new c,this.formSerializer)}}return i||r?(n.setContentType("application/json",!1),gie(t)):t}],transformResponse:[function(t){const n=this.transitional||fx.transitional,s=n&&n.forcedJSONParsing,r=this.responseType==="json";if(ht.isResponse(t)||ht.isReadableStream(t))return t;if(t&&ht.isString(t)&&(s&&!this.responseType||r)){const o=!(n&&n.silentJSONParsing)&&r;try{return JSON.parse(t,this.parseReviver)}catch(l){if(o)throw l.name==="SyntaxError"?la.from(l,la.ERR_BAD_RESPONSE,this,null,this.response):l}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:$s.classes.FormData,Blob:$s.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ht.forEach(["delete","get","head","post","put","patch"],e=>{fx.headers[e]={}});const pie=ht.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),xie=e=>{const t={};let n,s,r;return e&&e.split(`
`).forEach(function(o){r=o.indexOf(":"),n=o.substring(0,r).trim().toLowerCase(),s=o.substring(r+1).trim(),!(!n||t[n]&&pie[n])&&(n==="set-cookie"?t[n]?t[n].push(s):t[n]=[s]:t[n]=t[n]?t[n]+", "+s:s)}),t},DI=Symbol("internals");function yg(e){return e&&String(e).trim().toLowerCase()}function dv(e){return e===!1||e==null?e:ht.isArray(e)?e.map(dv):String(e)}function yie(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let s;for(;s=n.exec(e);)t[s[1]]=s[2];return t}const bie=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function r2(e,t,n,s,r){if(ht.isFunction(s))return s.call(this,t,n);if(r&&(t=n),!!ht.isString(t)){if(ht.isString(s))return t.indexOf(s)!==-1;if(ht.isRegExp(s))return s.test(t)}}function vie(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,n,s)=>n.toUpperCase()+s)}function wie(e,t){const n=ht.toCamelCase(" "+t);["get","set","has"].forEach(s=>{Object.defineProperty(e,s+n,{value:function(r,i,o){return this[s].call(this,t,r,i,o)},configurable:!0})})}let pr=class{constructor(t){t&&this.set(t)}set(t,n,s){const r=this;function i(l,c,u){const d=yg(c);if(!d)throw new Error("header name must be a non-empty string");const h=ht.findKey(r,d);(!h||r[h]===void 0||u===!0||u===void 0&&r[h]!==!1)&&(r[h||c]=dv(l))}const o=(l,c)=>ht.forEach(l,(u,d)=>i(u,d,c));if(ht.isPlainObject(t)||t instanceof this.constructor)o(t,n);else if(ht.isString(t)&&(t=t.trim())&&!bie(t))o(xie(t),n);else if(ht.isObject(t)&&ht.isIterable(t)){let l={},c,u;for(const d of t){if(!ht.isArray(d))throw TypeError("Object iterator must return a key-value pair");l[u=d[0]]=(c=l[u])?ht.isArray(c)?[...c,d[1]]:[c,d[1]]:d[1]}o(l,n)}else t!=null&&i(n,t,s);return this}get(t,n){if(t=yg(t),t){const s=ht.findKey(this,t);if(s){const r=this[s];if(!n)return r;if(n===!0)return yie(r);if(ht.isFunction(n))return n.call(this,r,s);if(ht.isRegExp(n))return n.exec(r);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,n){if(t=yg(t),t){const s=ht.findKey(this,t);return!!(s&&this[s]!==void 0&&(!n||r2(this,this[s],s,n)))}return!1}delete(t,n){const s=this;let r=!1;function i(o){if(o=yg(o),o){const l=ht.findKey(s,o);l&&(!n||r2(s,s[l],l,n))&&(delete s[l],r=!0)}}return ht.isArray(t)?t.forEach(i):i(t),r}clear(t){const n=Object.keys(this);let s=n.length,r=!1;for(;s--;){const i=n[s];(!t||r2(this,this[i],i,t,!0))&&(delete this[i],r=!0)}return r}normalize(t){const n=this,s={};return ht.forEach(this,(r,i)=>{const o=ht.findKey(s,i);if(o){n[o]=dv(r),delete n[i];return}const l=t?vie(i):String(i).trim();l!==i&&delete n[i],n[l]=dv(r),s[l]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const n=Object.create(null);return ht.forEach(this,(s,r)=>{s!=null&&s!==!1&&(n[r]=t&&ht.isArray(s)?s.join(", "):s)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,n])=>t+": "+n).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...n){const s=new this(t);return n.forEach(r=>s.set(r)),s}static accessor(t){const s=(this[DI]=this[DI]={accessors:{}}).accessors,r=this.prototype;function i(o){const l=yg(o);s[l]||(wie(r,o),s[l]=!0)}return ht.isArray(t)?t.forEach(i):i(t),this}};pr.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);ht.reduceDescriptors(pr.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(s){this[n]=s}}});ht.freezeMethods(pr);function i2(e,t){const n=this||fx,s=t||n,r=pr.from(s.headers);let i=s.data;return ht.forEach(e,function(l){i=l.call(n,i,r.normalize(),t?t.status:void 0)}),r.normalize(),i}function l9(e){return!!(e&&e.__CANCEL__)}function nh(e,t,n){la.call(this,e??"canceled",la.ERR_CANCELED,t,n),this.name="CanceledError"}ht.inherits(nh,la,{__CANCEL__:!0});function c9(e,t,n){const s=n.config.validateStatus;!n.status||!s||s(n.status)?e(n):t(new la("Request failed with status code "+n.status,[la.ERR_BAD_REQUEST,la.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function jie(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function Nie(e,t){e=e||10;const n=new Array(e),s=new Array(e);let r=0,i=0,o;return t=t!==void 0?t:1e3,function(c){const u=Date.now(),d=s[i];o||(o=u),n[r]=c,s[r]=u;let h=i,p=0;for(;h!==r;)p+=n[h++],h=h%e;if(r=(r+1)%e,r===i&&(i=(i+1)%e),u-o<t)return;const x=d&&u-d;return x?Math.round(p*1e3/x):void 0}}function Cie(e,t){let n=0,s=1e3/t,r,i;const o=(u,d=Date.now())=>{n=d,r=null,i&&(clearTimeout(i),i=null),e(...u)};return[(...u)=>{const d=Date.now(),h=d-n;h>=s?o(u,d):(r=u,i||(i=setTimeout(()=>{i=null,o(r)},s-h)))},()=>r&&o(r)]}const Ev=(e,t,n=3)=>{let s=0;const r=Nie(50,250);return Cie(i=>{const o=i.loaded,l=i.lengthComputable?i.total:void 0,c=o-s,u=r(c),d=o<=l;s=o;const h={loaded:o,total:l,progress:l?o/l:void 0,bytes:c,rate:u||void 0,estimated:u&&l&&d?(l-o)/u:void 0,event:i,lengthComputable:l!=null,[t?"download":"upload"]:!0};e(h)},n)},PI=(e,t)=>{const n=e!=null;return[s=>t[0]({lengthComputable:n,total:e,loaded:s}),t[1]]},OI=e=>(...t)=>ht.asap(()=>e(...t)),Sie=$s.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,$s.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL($s.origin),$s.navigator&&/(msie|trident)/i.test($s.navigator.userAgent)):()=>!0,_ie=$s.hasStandardBrowserEnv?{write(e,t,n,s,r,i){const o=[e+"="+encodeURIComponent(t)];ht.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),ht.isString(s)&&o.push("path="+s),ht.isString(r)&&o.push("domain="+r),i===!0&&o.push("secure"),document.cookie=o.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Aie(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function Tie(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function d9(e,t,n){let s=!Aie(t);return e&&(s||n==!1)?Tie(e,t):t}const MI=e=>e instanceof pr?{...e}:e;function $u(e,t){t=t||{};const n={};function s(u,d,h,p){return ht.isPlainObject(u)&&ht.isPlainObject(d)?ht.merge.call({caseless:p},u,d):ht.isPlainObject(d)?ht.merge({},d):ht.isArray(d)?d.slice():d}function r(u,d,h,p){if(ht.isUndefined(d)){if(!ht.isUndefined(u))return s(void 0,u,h,p)}else return s(u,d,h,p)}function i(u,d){if(!ht.isUndefined(d))return s(void 0,d)}function o(u,d){if(ht.isUndefined(d)){if(!ht.isUndefined(u))return s(void 0,u)}else return s(void 0,d)}function l(u,d,h){if(h in t)return s(u,d);if(h in e)return s(void 0,u)}const c={url:i,method:i,data:i,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:l,headers:(u,d,h)=>r(MI(u),MI(d),h,!0)};return ht.forEach(Object.keys({...e,...t}),function(d){const h=c[d]||r,p=h(e[d],t[d],d);ht.isUndefined(p)&&h!==l||(n[d]=p)}),n}const u9=e=>{const t=$u({},e);let{data:n,withXSRFToken:s,xsrfHeaderName:r,xsrfCookieName:i,headers:o,auth:l}=t;if(t.headers=o=pr.from(o),t.url=r9(d9(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),l&&o.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),ht.isFormData(n)){if($s.hasStandardBrowserEnv||$s.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(ht.isFunction(n.getHeaders)){const c=n.getHeaders(),u=["content-type","content-length"];Object.entries(c).forEach(([d,h])=>{u.includes(d.toLowerCase())&&o.set(d,h)})}}if($s.hasStandardBrowserEnv&&(s&&ht.isFunction(s)&&(s=s(t)),s||s!==!1&&Sie(t.url))){const c=r&&i&&_ie.read(i);c&&o.set(r,c)}return t},kie=typeof XMLHttpRequest<"u",Eie=kie&&function(e){return new Promise(function(n,s){const r=u9(e);let i=r.data;const o=pr.from(r.headers).normalize();let{responseType:l,onUploadProgress:c,onDownloadProgress:u}=r,d,h,p,x,b;function j(){x&&x(),b&&b(),r.cancelToken&&r.cancelToken.unsubscribe(d),r.signal&&r.signal.removeEventListener("abort",d)}let y=new XMLHttpRequest;y.open(r.method.toUpperCase(),r.url,!0),y.timeout=r.timeout;function N(){if(!y)return;const S=pr.from("getAllResponseHeaders"in y&&y.getAllResponseHeaders()),T={data:!l||l==="text"||l==="json"?y.responseText:y.response,status:y.status,statusText:y.statusText,headers:S,config:e,request:y};c9(function(A){n(A),j()},function(A){s(A),j()},T),y=null}"onloadend"in y?y.onloadend=N:y.onreadystatechange=function(){!y||y.readyState!==4||y.status===0&&!(y.responseURL&&y.responseURL.indexOf("file:")===0)||setTimeout(N)},y.onabort=function(){y&&(s(new la("Request aborted",la.ECONNABORTED,e,y)),y=null)},y.onerror=function(_){const T=_&&_.message?_.message:"Network Error",k=new la(T,la.ERR_NETWORK,e,y);k.event=_||null,s(k),y=null},y.ontimeout=function(){let _=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded";const T=r.transitional||i9;r.timeoutErrorMessage&&(_=r.timeoutErrorMessage),s(new la(_,T.clarifyTimeoutError?la.ETIMEDOUT:la.ECONNABORTED,e,y)),y=null},i===void 0&&o.setContentType(null),"setRequestHeader"in y&&ht.forEach(o.toJSON(),function(_,T){y.setRequestHeader(T,_)}),ht.isUndefined(r.withCredentials)||(y.withCredentials=!!r.withCredentials),l&&l!=="json"&&(y.responseType=r.responseType),u&&([p,b]=Ev(u,!0),y.addEventListener("progress",p)),c&&y.upload&&([h,x]=Ev(c),y.upload.addEventListener("progress",h),y.upload.addEventListener("loadend",x)),(r.cancelToken||r.signal)&&(d=S=>{y&&(s(!S||S.type?new nh(null,e,y):S),y.abort(),y=null)},r.cancelToken&&r.cancelToken.subscribe(d),r.signal&&(r.signal.aborted?d():r.signal.addEventListener("abort",d)));const w=jie(r.url);if(w&&$s.protocols.indexOf(w)===-1){s(new la("Unsupported protocol "+w+":",la.ERR_BAD_REQUEST,e));return}y.send(i||null)})},Lie=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let s=new AbortController,r;const i=function(u){if(!r){r=!0,l();const d=u instanceof Error?u:this.reason;s.abort(d instanceof la?d:new nh(d instanceof Error?d.message:d))}};let o=t&&setTimeout(()=>{o=null,i(new la(`timeout ${t} of ms exceeded`,la.ETIMEDOUT))},t);const l=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(u=>{u.unsubscribe?u.unsubscribe(i):u.removeEventListener("abort",i)}),e=null)};e.forEach(u=>u.addEventListener("abort",i));const{signal:c}=s;return c.unsubscribe=()=>ht.asap(l),c}},Die=function*(e,t){let n=e.byteLength;if(n<t){yield e;return}let s=0,r;for(;s<n;)r=s+t,yield e.slice(s,r),s=r},Pie=async function*(e,t){for await(const n of Oie(e))yield*Die(n,t)},Oie=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:n,value:s}=await t.read();if(n)break;yield s}}finally{await t.cancel()}},II=(e,t,n,s)=>{const r=Pie(e,t);let i=0,o,l=c=>{o||(o=!0,s&&s(c))};return new ReadableStream({async pull(c){try{const{done:u,value:d}=await r.next();if(u){l(),c.close();return}let h=d.byteLength;if(n){let p=i+=h;n(p)}c.enqueue(new Uint8Array(d))}catch(u){throw l(u),u}},cancel(c){return l(c),r.return()}},{highWaterMark:2})},$I=64*1024,{isFunction:Fy}=ht,Mie=(({Request:e,Response:t})=>({Request:e,Response:t}))(ht.global),{ReadableStream:RI,TextEncoder:zI}=ht.global,FI=(e,...t)=>{try{return!!e(...t)}catch{return!1}},Iie=e=>{e=ht.merge.call({skipUndefined:!0},Mie,e);const{fetch:t,Request:n,Response:s}=e,r=t?Fy(t):typeof fetch=="function",i=Fy(n),o=Fy(s);if(!r)return!1;const l=r&&Fy(RI),c=r&&(typeof zI=="function"?(b=>j=>b.encode(j))(new zI):async b=>new Uint8Array(await new n(b).arrayBuffer())),u=i&&l&&FI(()=>{let b=!1;const j=new n($s.origin,{body:new RI,method:"POST",get duplex(){return b=!0,"half"}}).headers.has("Content-Type");return b&&!j}),d=o&&l&&FI(()=>ht.isReadableStream(new s("").body)),h={stream:d&&(b=>b.body)};r&&["text","arrayBuffer","blob","formData","stream"].forEach(b=>{!h[b]&&(h[b]=(j,y)=>{let N=j&&j[b];if(N)return N.call(j);throw new la(`Response type '${b}' is not supported`,la.ERR_NOT_SUPPORT,y)})});const p=async b=>{if(b==null)return 0;if(ht.isBlob(b))return b.size;if(ht.isSpecCompliantForm(b))return(await new n($s.origin,{method:"POST",body:b}).arrayBuffer()).byteLength;if(ht.isArrayBufferView(b)||ht.isArrayBuffer(b))return b.byteLength;if(ht.isURLSearchParams(b)&&(b=b+""),ht.isString(b))return(await c(b)).byteLength},x=async(b,j)=>{const y=ht.toFiniteNumber(b.getContentLength());return y??p(j)};return async b=>{let{url:j,method:y,data:N,signal:w,cancelToken:S,timeout:_,onDownloadProgress:T,onUploadProgress:k,responseType:A,headers:E,withCredentials:M="same-origin",fetchOptions:F}=u9(b),D=t||fetch;A=A?(A+"").toLowerCase():"text";let P=Lie([w,S&&S.toAbortSignal()],_),B=null;const G=P&&P.unsubscribe&&(()=>{P.unsubscribe()});let $;try{if(k&&u&&y!=="get"&&y!=="head"&&($=await x(E,N))!==0){let J=new n(j,{method:"POST",body:N,duplex:"half"}),se;if(ht.isFormData(N)&&(se=J.headers.get("content-type"))&&E.setContentType(se),J.body){const[ye,Ce]=PI($,Ev(OI(k)));N=II(J.body,$I,ye,Ce)}}ht.isString(M)||(M=M?"include":"omit");const W=i&&"credentials"in n.prototype,Z={...F,signal:P,method:y.toUpperCase(),headers:E.normalize().toJSON(),body:N,duplex:"half",credentials:W?M:void 0};B=i&&new n(j,Z);let Q=await(i?D(B,F):D(j,Z));const le=d&&(A==="stream"||A==="response");if(d&&(T||le&&G)){const J={};["status","statusText","headers"].forEach(ge=>{J[ge]=Q[ge]});const se=ht.toFiniteNumber(Q.headers.get("content-length")),[ye,Ce]=T&&PI(se,Ev(OI(T),!0))||[];Q=new s(II(Q.body,$I,ye,()=>{Ce&&Ce(),G&&G()}),J)}A=A||"text";let we=await h[ht.findKey(h,A)||"text"](Q,b);return!le&&G&&G(),await new Promise((J,se)=>{c9(J,se,{data:we,headers:pr.from(Q.headers),status:Q.status,statusText:Q.statusText,config:b,request:B})})}catch(W){throw G&&G(),W&&W.name==="TypeError"&&/Load failed|fetch/i.test(W.message)?Object.assign(new la("Network Error",la.ERR_NETWORK,b,B),{cause:W.cause||W}):la.from(W,W&&W.code,b,B)}}},$ie=new Map,m9=e=>{let t=e?e.env:{};const{fetch:n,Request:s,Response:r}=t,i=[s,r,n];let o=i.length,l=o,c,u,d=$ie;for(;l--;)c=i[l],u=d.get(c),u===void 0&&d.set(c,u=l?new Map:Iie(t)),d=u;return u};m9();const sk={http:eie,xhr:Eie,fetch:{get:m9}};ht.forEach(sk,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const UI=e=>`- ${e}`,Rie=e=>ht.isFunction(e)||e===null||e===!1,f9={getAdapter:(e,t)=>{e=ht.isArray(e)?e:[e];const{length:n}=e;let s,r;const i={};for(let o=0;o<n;o++){s=e[o];let l;if(r=s,!Rie(s)&&(r=sk[(l=String(s)).toLowerCase()],r===void 0))throw new la(`Unknown adapter '${l}'`);if(r&&(ht.isFunction(r)||(r=r.get(t))))break;i[l||"#"+o]=r}if(!r){const o=Object.entries(i).map(([c,u])=>`adapter ${c} `+(u===!1?"is not supported by the environment":"is not available in the build"));let l=n?o.length>1?`since :
`+o.map(UI).join(`
`):" "+UI(o[0]):"as no adapter specified";throw new la("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return r},adapters:sk};function o2(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new nh(null,e)}function BI(e){return o2(e),e.headers=pr.from(e.headers),e.data=i2.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),f9.getAdapter(e.adapter||fx.adapter,e)(e).then(function(s){return o2(e),s.data=i2.call(e,e.transformResponse,s),s.headers=pr.from(s.headers),s},function(s){return l9(s)||(o2(e),s&&s.response&&(s.response.data=i2.call(e,e.transformResponse,s.response),s.response.headers=pr.from(s.response.headers))),Promise.reject(s)})}const h9="1.12.2",yj={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{yj[e]=function(s){return typeof s===e||"a"+(t<1?"n ":" ")+e}});const HI={};yj.transitional=function(t,n,s){function r(i,o){return"[Axios v"+h9+"] Transitional option '"+i+"'"+o+(s?". "+s:"")}return(i,o,l)=>{if(t===!1)throw new la(r(o," has been removed"+(n?" in "+n:"")),la.ERR_DEPRECATED);return n&&!HI[o]&&(HI[o]=!0,console.warn(r(o," has been deprecated since v"+n+" and will be removed in the near future"))),t?t(i,o,l):!0}};yj.spelling=function(t){return(n,s)=>(console.warn(`${s} is likely a misspelling of ${t}`),!0)};function zie(e,t,n){if(typeof e!="object")throw new la("options must be an object",la.ERR_BAD_OPTION_VALUE);const s=Object.keys(e);let r=s.length;for(;r-- >0;){const i=s[r],o=t[i];if(o){const l=e[i],c=l===void 0||o(l,i,e);if(c!==!0)throw new la("option "+i+" must be "+c,la.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new la("Unknown option "+i,la.ERR_BAD_OPTION)}}const uv={assertOptions:zie,validators:yj},co=uv.validators;let _u=class{constructor(t){this.defaults=t||{},this.interceptors={request:new LI,response:new LI}}async request(t,n){try{return await this._request(t,n)}catch(s){if(s instanceof Error){let r={};Error.captureStackTrace?Error.captureStackTrace(r):r=new Error;const i=r.stack?r.stack.replace(/^.+\n/,""):"";try{s.stack?i&&!String(s.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(s.stack+=`
`+i):s.stack=i}catch{}}throw s}}_request(t,n){typeof t=="string"?(n=n||{},n.url=t):n=t||{},n=$u(this.defaults,n);const{transitional:s,paramsSerializer:r,headers:i}=n;s!==void 0&&uv.assertOptions(s,{silentJSONParsing:co.transitional(co.boolean),forcedJSONParsing:co.transitional(co.boolean),clarifyTimeoutError:co.transitional(co.boolean)},!1),r!=null&&(ht.isFunction(r)?n.paramsSerializer={serialize:r}:uv.assertOptions(r,{encode:co.function,serialize:co.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),uv.assertOptions(n,{baseUrl:co.spelling("baseURL"),withXsrfToken:co.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let o=i&&ht.merge(i.common,i[n.method]);i&&ht.forEach(["delete","get","head","post","put","patch","common"],b=>{delete i[b]}),n.headers=pr.concat(o,i);const l=[];let c=!0;this.interceptors.request.forEach(function(j){typeof j.runWhen=="function"&&j.runWhen(n)===!1||(c=c&&j.synchronous,l.unshift(j.fulfilled,j.rejected))});const u=[];this.interceptors.response.forEach(function(j){u.push(j.fulfilled,j.rejected)});let d,h=0,p;if(!c){const b=[BI.bind(this),void 0];for(b.unshift(...l),b.push(...u),p=b.length,d=Promise.resolve(n);h<p;)d=d.then(b[h++],b[h++]);return d}p=l.length;let x=n;for(;h<p;){const b=l[h++],j=l[h++];try{x=b(x)}catch(y){j.call(this,y);break}}try{d=BI.call(this,x)}catch(b){return Promise.reject(b)}for(h=0,p=u.length;h<p;)d=d.then(u[h++],u[h++]);return d}getUri(t){t=$u(this.defaults,t);const n=d9(t.baseURL,t.url,t.allowAbsoluteUrls);return r9(n,t.params,t.paramsSerializer)}};ht.forEach(["delete","get","head","options"],function(t){_u.prototype[t]=function(n,s){return this.request($u(s||{},{method:t,url:n,data:(s||{}).data}))}});ht.forEach(["post","put","patch"],function(t){function n(s){return function(i,o,l){return this.request($u(l||{},{method:t,headers:s?{"Content-Type":"multipart/form-data"}:{},url:i,data:o}))}}_u.prototype[t]=n(),_u.prototype[t+"Form"]=n(!0)});let Fie=class g9{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(i){n=i});const s=this;this.promise.then(r=>{if(!s._listeners)return;let i=s._listeners.length;for(;i-- >0;)s._listeners[i](r);s._listeners=null}),this.promise.then=r=>{let i;const o=new Promise(l=>{s.subscribe(l),i=l}).then(r);return o.cancel=function(){s.unsubscribe(i)},o},t(function(i,o,l){s.reason||(s.reason=new nh(i,o,l),n(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const n=this._listeners.indexOf(t);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const t=new AbortController,n=s=>{t.abort(s)};return this.subscribe(n),t.signal.unsubscribe=()=>this.unsubscribe(n),t.signal}static source(){let t;return{token:new g9(function(r){t=r}),cancel:t}}};function Uie(e){return function(n){return e.apply(null,n)}}function Bie(e){return ht.isObject(e)&&e.isAxiosError===!0}const rk={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(rk).forEach(([e,t])=>{rk[t]=e});function p9(e){const t=new _u(e),n=VH(_u.prototype.request,t);return ht.extend(n,_u.prototype,t,{allOwnKeys:!0}),ht.extend(n,t,null,{allOwnKeys:!0}),n.create=function(r){return p9($u(e,r))},n}const Mn=p9(fx);Mn.Axios=_u;Mn.CanceledError=nh;Mn.CancelToken=Fie;Mn.isCancel=l9;Mn.VERSION=h9;Mn.toFormData=xj;Mn.AxiosError=la;Mn.Cancel=Mn.CanceledError;Mn.all=function(t){return Promise.all(t)};Mn.spread=Uie;Mn.isAxiosError=Bie;Mn.mergeConfig=$u;Mn.AxiosHeaders=pr;Mn.formToJSON=e=>o9(ht.isHTMLForm(e)?new FormData(e):e);Mn.getAdapter=f9.getAdapter;Mn.HttpStatusCode=rk;Mn.default=Mn;const{Axios:XVe,AxiosError:ZVe,CanceledError:JVe,isCancel:eYe,CancelToken:tYe,VERSION:aYe,all:nYe,Cancel:sYe,isAxiosError:rYe,spread:iYe,toFormData:oYe,AxiosHeaders:lYe,HttpStatusCode:cYe,formToJSON:dYe,getAdapter:uYe,mergeConfig:mYe}=Mn,Hie="https://crm.sari-sari.com",ne=Mn.create({baseURL:`${Hie}/api`,withCredentials:!0,headers:{"Content-Type":"application/json"}});ne.interceptors.request.use(e=>(console.log(` [${e.method?.toUpperCase()}] ${e.url}`),e),e=>Promise.reject(e));ne.interceptors.response.use(e=>e,e=>(e.response?.status===401&&(console.warn(" Unauthorized  possible expired token or not logged in."),localStorage.clear(),window.location.href="/login"),Promise.reject(e)));const qie="isLoggedIn",Uy="userRole",Ks=()=>{const[e,t]=f.useState(!!localStorage.getItem(Uy)),[n,s]=f.useState(localStorage.getItem(Uy)||""),r=Et();f.useEffect(()=>{const u=localStorage.getItem(Uy);u?(t(!0),s(u)):o()},[]);const i=u=>{localStorage.setItem(Uy,u.role),localStorage.setItem(qie,!0),t(!0),s(u.role)},o=()=>{localStorage.clear(),t(!1),s("")};return{isLoggedIn:e,logout:async()=>{try{await ne.post("/auth/logout")}catch(u){console.log("Failed to logout from server:",u)}o(),r("/")},userRole:n,setUserRole:s,login:u=>{i(u),u.role==="Admin"?r("/super-admin/dashboard"):u.role==="CEO"?r("/admin/dashboard"):u.role==="Manager"?r("/manager/dashboard"):r("/")}}},uo=({children:e,requiredRole:t})=>{const{isLoggedIn:n,userRole:s}=Ks();if(!n)return a.jsx(ur,{to:"/",replace:!0});if(!t)return s.toUpperCase()==="ADMIN"?a.jsx(ur,{to:"/super-admin/dashboard",replace:!0}):s.toUpperCase()==="CEO"?a.jsx(ur,{to:"/admin/dashboard",replace:!0}):s==="GROUP MANAGER"?a.jsx(ur,{to:"/group-manager/dashboard",replace:!0}):s==="MANAGER"?a.jsx(ur,{to:"/manager/dashboard",replace:!0}):s==="SALES"?a.jsx(ur,{to:"/sales/dashboard",replace:!0}):a.jsx(ur,{to:"/",replace:!0});const r=s.toLowerCase(),i=t.toLowerCase();return r!==i?a.jsx(ur,{to:"/",replace:!0}):e},x9=f.createContext(null);function Gie(){const e=f.useContext(x9);if(!e)throw new Error("useUserContext must be used within a UserProvider");return e}function Wie({children:e}){const[t,n]=f.useState(null),[s,r]=f.useState(!1),[i,o]=f.useState(!0),l=Et(),c=f.useCallback(async()=>{o(!0);try{const h=await ne.get("/auth/me");return n(h.data),r(!0),h.data}catch(h){return n(null),r(!1),console.warn("Unauthorized  possible expired token or not logged in.",h),null}finally{o(!1)}},[]);f.useEffect(()=>{c()},[c]);const u=f.useCallback(async()=>{try{await ne.post("/auth/logout")}catch{}n(null),r(!1),l("/login")},[l]),d=f.useMemo(()=>({user:t,isLoggedIn:s,loading:i,fetchUser:c,mutate:c,logout:u}),[t,s,i,c,u]);return a.jsx(x9.Provider,{value:d,children:e})}var y9={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},qI=wt.createContext&&wt.createContext(y9),Vie=["attr","size","title"];function Yie(e,t){if(e==null)return{};var n=Qie(e,t),s,r;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)s=i[r],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function Qie(e,t){if(e==null)return{};var n={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;n[s]=e[s]}return n}function Lv(){return Lv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Lv.apply(this,arguments)}function GI(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function Dv(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?GI(Object(n),!0).forEach(function(s){Kie(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):GI(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function Kie(e,t,n){return t=Xie(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Xie(e){var t=Zie(e,"string");return typeof t=="symbol"?t:t+""}function Zie(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function b9(e){return e&&e.map((t,n)=>wt.createElement(t.tag,Dv({key:n},t.attr),b9(t.child)))}function Ot(e){return t=>wt.createElement(Jie,Lv({attr:Dv({},e.attr)},t),b9(e.child))}function Jie(e){var t=n=>{var{attr:s,size:r,title:i}=e,o=Yie(e,Vie),l=r||n.size||"1em",c;return n.className&&(c=n.className),e.className&&(c=(c?c+" ":"")+e.className),wt.createElement("svg",Lv({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,s,o,{className:c,style:Dv(Dv({color:e.color||n.color},n.style),e.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),i&&wt.createElement("title",null,i),e.children)};return qI!==void 0?wt.createElement(qI.Consumer,null,n=>t(n)):t(y9)}function Yi(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"22 12 18 12 15 21 9 3 6 12 2 12"},child:[]}]})(e)}function Fl(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"line",attr:{x1:"12",y1:"8",x2:"12",y2:"12"},child:[]},{tag:"line",attr:{x1:"12",y1:"16",x2:"12.01",y2:"16"},child:[]}]})(e)}function Zt(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"21 8 21 21 3 21 3 8"},child:[]},{tag:"rect",attr:{x:"1",y:"3",width:"22",height:"5"},child:[]},{tag:"line",attr:{x1:"10",y1:"12",x2:"14",y2:"12"},child:[]}]})(e)}function bj(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"7",y1:"7",x2:"17",y2:"17"},child:[]},{tag:"polyline",attr:{points:"17 7 17 17 7 17"},child:[]}]})(e)}function ik(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"12",y1:"5",x2:"12",y2:"19"},child:[]},{tag:"polyline",attr:{points:"19 12 12 19 5 12"},child:[]}]})(e)}function eoe(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"19",y1:"12",x2:"5",y2:"12"},child:[]},{tag:"polyline",attr:{points:"12 19 5 12 12 5"},child:[]}]})(e)}function vj(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"5",y1:"12",x2:"19",y2:"12"},child:[]},{tag:"polyline",attr:{points:"12 5 19 12 12 19"},child:[]}]})(e)}function hx(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"7",y1:"17",x2:"17",y2:"7"},child:[]},{tag:"polyline",attr:{points:"7 7 17 7 17 17"},child:[]}]})(e)}function toe(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"12",y1:"19",x2:"12",y2:"5"},child:[]},{tag:"polyline",attr:{points:"5 12 12 5 19 12"},child:[]}]})(e)}function l2(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"8",r:"7"},child:[]},{tag:"polyline",attr:{points:"8.21 13.89 7 23 12 20 17 23 15.79 13.88"},child:[]}]})(e)}function aoe(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"18",y1:"20",x2:"18",y2:"10"},child:[]},{tag:"line",attr:{x1:"12",y1:"20",x2:"12",y2:"4"},child:[]},{tag:"line",attr:{x1:"6",y1:"20",x2:"6",y2:"14"},child:[]}]})(e)}function gx(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"},child:[]},{tag:"path",attr:{d:"M13.73 21a2 2 0 0 1-3.46 0"},child:[]}]})(e)}function noe(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"},child:[]},{tag:"path",attr:{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"},child:[]}]})(e)}function wj(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"},child:[]}]})(e)}function sa(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"2",y:"7",width:"20",height:"14",rx:"2",ry:"2"},child:[]},{tag:"path",attr:{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"},child:[]}]})(e)}function Pt(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"},child:[]},{tag:"line",attr:{x1:"16",y1:"2",x2:"16",y2:"6"},child:[]},{tag:"line",attr:{x1:"8",y1:"2",x2:"8",y2:"6"},child:[]},{tag:"line",attr:{x1:"3",y1:"10",x2:"21",y2:"10"},child:[]}]})(e)}function v9(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"},child:[]},{tag:"circle",attr:{cx:"12",cy:"13",r:"4"},child:[]}]})(e)}function La(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"},child:[]},{tag:"polyline",attr:{points:"22 4 12 14.01 9 11.01"},child:[]}]})(e)}function Qt(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"9 11 12 14 22 4"},child:[]},{tag:"path",attr:{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"},child:[]}]})(e)}function AL(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"20 6 9 17 4 12"},child:[]}]})(e)}function Dt(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"6 9 12 15 18 9"},child:[]}]})(e)}function soe(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"15 18 9 12 15 6"},child:[]}]})(e)}function Mt(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"9 18 15 12 9 6"},child:[]}]})(e)}function roe(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"18 15 12 9 6 15"},child:[]}]})(e)}function Ls(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"},child:[]},{tag:"rect",attr:{x:"8",y:"2",width:"8",height:"4",rx:"1",ry:"1"},child:[]}]})(e)}function Vn(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"polyline",attr:{points:"12 6 12 12 16 14"},child:[]}]})(e)}function w9(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"12",y1:"1",x2:"12",y2:"23"},child:[]},{tag:"path",attr:{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"},child:[]}]})(e)}function Vo(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"},child:[]},{tag:"polyline",attr:{points:"7 10 12 15 17 10"},child:[]},{tag:"line",attr:{x1:"12",y1:"15",x2:"12",y2:"3"},child:[]}]})(e)}function hn(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"},child:[]}]})(e)}function gn(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"},child:[]},{tag:"path",attr:{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"},child:[]}]})(e)}function Ru(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"},child:[]},{tag:"line",attr:{x1:"1",y1:"1",x2:"23",y2:"23"},child:[]}]})(e)}function md(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"},child:[]},{tag:"circle",attr:{cx:"12",cy:"12",r:"3"},child:[]}]})(e)}function ia(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"},child:[]},{tag:"polyline",attr:{points:"14 2 14 8 20 8"},child:[]},{tag:"line",attr:{x1:"16",y1:"13",x2:"8",y2:"13"},child:[]},{tag:"line",attr:{x1:"16",y1:"17",x2:"8",y2:"17"},child:[]},{tag:"polyline",attr:{points:"10 9 9 9 8 9"},child:[]}]})(e)}function ioe(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"},child:[]}]})(e)}function By(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M3 18v-6a9 9 0 0 1 18 0v6"},child:[]},{tag:"path",attr:{d:"M21 19a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3zM3 19a2 2 0 0 0 2 2h1a2 2 0 0 0 2-2v-3a2 2 0 0 0-2-2H3z"},child:[]}]})(e)}function ooe(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"path",attr:{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"},child:[]},{tag:"line",attr:{x1:"12",y1:"17",x2:"12.01",y2:"17"},child:[]}]})(e)}function sh(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"},child:[]},{tag:"polyline",attr:{points:"9 22 9 12 15 12 15 22"},child:[]}]})(e)}function WI(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"},child:[]},{tag:"circle",attr:{cx:"8.5",cy:"8.5",r:"1.5"},child:[]},{tag:"polyline",attr:{points:"21 15 16 10 5 21"},child:[]}]})(e)}function j9(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"line",attr:{x1:"12",y1:"16",x2:"12",y2:"12"},child:[]},{tag:"line",attr:{x1:"12",y1:"8",x2:"12.01",y2:"8"},child:[]}]})(e)}function TL(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"},child:[]},{tag:"line",attr:{x1:"3",y1:"9",x2:"21",y2:"9"},child:[]},{tag:"line",attr:{x1:"9",y1:"21",x2:"9",y2:"9"},child:[]}]})(e)}function Do(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"},child:[]},{tag:"path",attr:{d:"M7 11V7a5 5 0 0 1 10 0v4"},child:[]}]})(e)}function loe(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"},child:[]},{tag:"polyline",attr:{points:"16 17 21 12 16 7"},child:[]},{tag:"line",attr:{x1:"21",y1:"12",x2:"9",y2:"12"},child:[]}]})(e)}function sn(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"},child:[]},{tag:"polyline",attr:{points:"22,6 12,13 2,6"},child:[]}]})(e)}function coe(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"},child:[]},{tag:"circle",attr:{cx:"12",cy:"10",r:"3"},child:[]}]})(e)}function rh(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"3",y1:"12",x2:"21",y2:"12"},child:[]},{tag:"line",attr:{x1:"3",y1:"6",x2:"21",y2:"6"},child:[]},{tag:"line",attr:{x1:"3",y1:"18",x2:"21",y2:"18"},child:[]}]})(e)}function VI(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"},child:[]}]})(e)}function doe(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"5 9 2 12 5 15"},child:[]},{tag:"polyline",attr:{points:"9 5 12 2 15 5"},child:[]},{tag:"polyline",attr:{points:"15 19 12 22 9 19"},child:[]},{tag:"polyline",attr:{points:"19 9 22 12 19 15"},child:[]},{tag:"line",attr:{x1:"2",y1:"12",x2:"22",y2:"12"},child:[]},{tag:"line",attr:{x1:"12",y1:"2",x2:"12",y2:"22"},child:[]}]})(e)}function uoe(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"19",y1:"5",x2:"5",y2:"19"},child:[]},{tag:"circle",attr:{cx:"6.5",cy:"6.5",r:"2.5"},child:[]},{tag:"circle",attr:{cx:"17.5",cy:"17.5",r:"2.5"},child:[]}]})(e)}function Us(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M15.05 5A5 5 0 0 1 19 8.95M15.05 1A9 9 0 0 1 23 8.94m-1 7.98v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"},child:[]}]})(e)}function It(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"},child:[]}]})(e)}function YI(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21.21 15.89A10 10 0 1 1 8 2.83"},child:[]},{tag:"path",attr:{d:"M22 12A10 10 0 0 0 12 2v10z"},child:[]}]})(e)}function aa(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"12",y1:"5",x2:"12",y2:"19"},child:[]},{tag:"line",attr:{x1:"5",y1:"12",x2:"19",y2:"12"},child:[]}]})(e)}function Br(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"23 4 23 10 17 10"},child:[]},{tag:"polyline",attr:{points:"1 20 1 14 7 14"},child:[]},{tag:"path",attr:{d:"M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"},child:[]}]})(e)}function kL(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"},child:[]},{tag:"polyline",attr:{points:"17 21 17 13 7 13 7 21"},child:[]},{tag:"polyline",attr:{points:"7 3 7 8 15 8"},child:[]}]})(e)}function Kt(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"11",cy:"11",r:"8"},child:[]},{tag:"line",attr:{x1:"21",y1:"21",x2:"16.65",y2:"16.65"},child:[]}]})(e)}function ok(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"22",y1:"2",x2:"11",y2:"13"},child:[]},{tag:"polygon",attr:{points:"22 2 15 22 11 13 2 9 22 2"},child:[]}]})(e)}function EL(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"3"},child:[]},{tag:"path",attr:{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"},child:[]}]})(e)}function jj(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"},child:[]}]})(e)}function ec(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"},child:[]}]})(e)}function fr(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"circle",attr:{cx:"12",cy:"12",r:"6"},child:[]},{tag:"circle",attr:{cx:"12",cy:"12",r:"2"},child:[]}]})(e)}function moe(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"1",y:"5",width:"22",height:"14",rx:"7",ry:"7"},child:[]},{tag:"circle",attr:{cx:"8",cy:"12",r:"3"},child:[]}]})(e)}function foe(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"1",y:"5",width:"22",height:"14",rx:"7",ry:"7"},child:[]},{tag:"circle",attr:{cx:"16",cy:"12",r:"3"},child:[]}]})(e)}function _a(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"3 6 5 6 21 6"},child:[]},{tag:"path",attr:{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"},child:[]},{tag:"line",attr:{x1:"10",y1:"11",x2:"10",y2:"17"},child:[]},{tag:"line",attr:{x1:"14",y1:"11",x2:"14",y2:"17"},child:[]}]})(e)}function c2(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"23 18 13.5 8.5 8.5 13.5 1 6"},child:[]},{tag:"polyline",attr:{points:"17 18 23 18 23 12"},child:[]}]})(e)}function cd(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"23 6 13.5 15.5 8.5 10.5 1 18"},child:[]},{tag:"polyline",attr:{points:"17 6 23 6 23 12"},child:[]}]})(e)}function hoe(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"},child:[]},{tag:"polyline",attr:{points:"17 8 12 3 7 8"},child:[]},{tag:"line",attr:{x1:"12",y1:"3",x2:"12",y2:"15"},child:[]}]})(e)}function Qi(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"},child:[]},{tag:"circle",attr:{cx:"8.5",cy:"7",r:"4"},child:[]},{tag:"polyline",attr:{points:"17 11 19 13 23 9"},child:[]}]})(e)}function rn(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"},child:[]},{tag:"circle",attr:{cx:"8.5",cy:"7",r:"4"},child:[]},{tag:"line",attr:{x1:"20",y1:"8",x2:"20",y2:"14"},child:[]},{tag:"line",attr:{x1:"23",y1:"11",x2:"17",y2:"11"},child:[]}]})(e)}function Ki(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"},child:[]},{tag:"circle",attr:{cx:"8.5",cy:"7",r:"4"},child:[]},{tag:"line",attr:{x1:"18",y1:"8",x2:"23",y2:"13"},child:[]},{tag:"line",attr:{x1:"23",y1:"8",x2:"18",y2:"13"},child:[]}]})(e)}function ra(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"},child:[]},{tag:"circle",attr:{cx:"12",cy:"7",r:"4"},child:[]}]})(e)}function Xa(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"},child:[]},{tag:"circle",attr:{cx:"9",cy:"7",r:"4"},child:[]},{tag:"path",attr:{d:"M23 21v-2a4 4 0 0 0-3-3.87"},child:[]},{tag:"path",attr:{d:"M16 3.13a4 4 0 0 1 0 7.75"},child:[]}]})(e)}function Yn(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"line",attr:{x1:"15",y1:"9",x2:"9",y2:"15"},child:[]},{tag:"line",attr:{x1:"9",y1:"9",x2:"15",y2:"15"},child:[]}]})(e)}function ea(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"18",y1:"6",x2:"6",y2:"18"},child:[]},{tag:"line",attr:{x1:"6",y1:"6",x2:"18",y2:"18"},child:[]}]})(e)}const N9=()=>{const[e,t]=f.useState(!1),n=f.useRef(null);return f.useEffect(()=>{const s=r=>{n.current&&!n.current.contains(r.target)&&t(!1)};return document.addEventListener("mousedown",s),()=>{document.removeEventListener("mousedown",s)}},[]),f.useEffect(()=>{const s=()=>{e&&t(!1)};return window.addEventListener("scroll",s),()=>{window.removeEventListener("scroll",s)}},[e]),a.jsx("header",{className:"sticky top-0 z-50 bg-tertiary shadow-xl border-b border-tertiary",children:a.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"flex items-center justify-between h-16",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsxs("span",{className:"text-2xl font-black text-white",children:["Sari-Sari ",a.jsx("span",{className:"text-accent",children:" CRM"})]})}),a.jsxs("nav",{className:"hidden md:flex space-x-8 text-white font-medium",children:[a.jsx("a",{href:"#platform",className:"hover:text-accent transition duration-150",children:"Platform"}),a.jsx("a",{href:"#pricing",className:"hover:text-accent transition duration-150",children:"Pricing"})]}),a.jsxs("div",{className:"hidden sm:flex items-center space-x-4",children:[a.jsx("a",{href:"/login",className:"text-sm font-medium text-white hover:text-accent transition duration-500",children:"Log In"}),a.jsx("a",{href:"/signup",className:"inline-flex items-center justify-center px-4 py-2 text-sm font-semibold rounded-full shadow-lg border border-secondary text-white bg-secondary hover:bg-accent hover:text-secondary hover:border-accent transition-all duration-500",children:"Start for Free"})]}),a.jsxs("div",{className:"flex sm:hidden items-center relative",ref:n,children:[a.jsx("button",{onClick:()=>t(!e),children:e?a.jsx(ea,{className:"w-6 h-6 text-white"}):a.jsx(rh,{className:"w-6 h-6 text-white"})}),e&&a.jsx("div",{className:"absolute top-11 right-0 mt-2 w-48 border border-tertiary rounded-lg shadow-lg z-50 bg-primary",children:a.jsxs("nav",{className:"flex flex-col",children:[a.jsx("a",{href:"/login",className:"block px-4 py-2 text-center text-tertiary bg-white hover:bg-accent hover:text-secondary transition rounded-t-lg",children:"Log In"}),a.jsx("a",{href:"/signup",className:"block px-4 py-2 text-center text-tertiary bg-white hover:bg-secondary hover:text-white transition rounded-b-lg",children:"Start for Free"})]})})]})]})})})};function goe(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"m12 14 4-4"},child:[]},{tag:"path",attr:{d:"M3.34 19a10 10 0 1 1 17.32 0"},child:[]}]})(e)}function tc(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0"},child:[]},{tag:"circle",attr:{cx:"12",cy:"10",r:"3"},child:[]}]})(e)}function poe(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z"},child:[]}]})(e)}function Nj(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"10",cy:"7",r:"4"},child:[]},{tag:"path",attr:{d:"M10.3 15H7a4 4 0 0 0-4 4v2"},child:[]},{tag:"circle",attr:{cx:"17",cy:"17",r:"3"},child:[]},{tag:"path",attr:{d:"m21 21-1.9-1.9"},child:[]}]})(e)}function xoe(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"},child:[]},{tag:"circle",attr:{cx:"9",cy:"7",r:"4"},child:[]},{tag:"path",attr:{d:"M22 21v-2a4 4 0 0 0-3-3.87"},child:[]},{tag:"path",attr:{d:"M16 3.13a4 4 0 0 1 0 7.75"},child:[]}]})(e)}function yoe(e){return Ot({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z"},child:[]}]})(e)}const boe=()=>{const e=["/image/crm1.png","/image/crm2.png","/image/crm3.png","/image/crm4.png","/image/crm5.png","/image/crm7.png","/image/crm6.png"],[t,n]=f.useState(0),[s,r]=f.useState(!1),i=f.useRef(null),[o,l]=f.useState(0),[c,u]=f.useState(0);f.useEffect(()=>(s||(i.current=setInterval(()=>{n(x=>(x+1)%e.length)},4e3)),()=>clearInterval(i.current)),[s,e.length]);const d=x=>l(x.targetTouches[0].clientX),h=x=>u(x.targetTouches[0].clientX),p=()=>{o-c>75&&n(x=>(x+1)%e.length),c-o>75&&n(x=>(x-1+e.length)%e.length)};return a.jsx("section",{className:"bg-paper-white text-white py-15 lg:py-32",children:a.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 grid grid-cols-1 lg:grid-cols-2 gap-12 items-center",children:[a.jsxs("div",{className:"lg:text-left text-center",children:[a.jsxs("h1",{className:"text-5xl sm:text-6xl lg:text-7xl font-lg text-secondary mb-6 leading-tight",children:["Sari-Sari"," ",a.jsx("span",{className:"text-accent font-extrabold",children:"CRM"})]}),a.jsx("p",{className:"max-w-xl mx-auto lg:mx-0 text-lg sm:text-xl text-secondary mb-10 italic",children:"The CRM that keeps your customers organized and your sales growing."}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-center lg:justify-start space-y-4 sm:space-y-0 sm:space-x-4",children:[a.jsx("a",{href:"#",className:"px-10 py-3 rounded-lg border border-secondary text-white bg-secondary font-semibold hover:bg-accent hover:text-secondary hover:border-accent transition-all duration-500",children:"Get Started Now"}),a.jsx("a",{href:"#",className:"px-10 py-3 rounded-lg border border-secondary text-white bg-secondary hover:bg-accent hover:text-secondary hover:border-accent transition-all duration-500",children:"Watch Demo (2 min)"})]})]}),a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"hidden lg:block absolute inset-0 -top-10 -bottom-10 right-4 bg-accent rounded-3xl transform rotate-3 z-0"}),a.jsxs("div",{className:"relative z-10 overflow-hidden rounded-xl shadow-2xl border-4 border-gray-800 h-[400px] bg-gray-900 flex items-center justify-center",onMouseEnter:()=>r(!0),onMouseLeave:()=>r(!1),onTouchStart:d,onTouchMove:h,onTouchEnd:p,children:[e.map((x,b)=>a.jsx("img",{src:x,alt:`Slide ${b+1}`,className:`absolute inset-0 w-full h-full object-contain bg-gray-50 transition-opacity duration-1000 ease-in-out ${b===t?"opacity-100":"opacity-0"}`},b)),a.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 flex space-x-2",children:e.map((x,b)=>a.jsx("button",{onClick:()=>n(b),className:`w-3 h-3 rounded-full transition-all ${b===t?"bg-accent":"bg-gray-400 opacity-50"}`},b))})]})]})]})})},voe=({Icon:e,title:t,description:n})=>a.jsxs("div",{className:"bg-gray-800 p-8 rounded-2xl border border-gray-700 hover:border-accent transition transform hover:-translate-y-1",children:[a.jsx("div",{className:"w-14 h-14 flex items-center justify-center rounded-full text-accent mb-6",children:a.jsx(e,{className:"w-8 h-8"})}),a.jsx("h3",{className:"text-xl font-semibold text-white mb-3",children:t}),a.jsx("p",{className:"text-gray-400",children:n})]}),woe=()=>{const e=[{Icon:yoe,title:"Automated Workflows",description:"Automate tasks and focus on engagement."},{Icon:goe,title:"Predictive Analytics",description:"Harness AI to forecast sales and risks."},{Icon:xoe,title:"Unified Customer View",description:"360-degree profile for every customer."},{Icon:poe,title:"Multi-Channel Support",description:"Engage across email, chat, and more."}];return a.jsx("section",{id:"platform",className:"py-20 bg-gray-900 border-t border-gray-800",children:a.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[a.jsx("h2",{className:"text-4xl sm:text-5xl font-bold text-white mb-4",children:"Engineered for Enterprise Scale"}),a.jsx("p",{className:"text-xl text-gray-400 mb-16",children:"Pillows is the neural network powering your customer relationships."}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8",children:e.map((t,n)=>a.jsx(voe,{...t},n))})]})})},joe=()=>a.jsxs("section",{id:"pricing",className:"py-20 bg-paper-white border-t border-gray-800 text-center",children:[a.jsx("h2",{className:"text-4xl sm:text-5xl font-bold text-secondary mb-4",children:"Start Building Your Future, Today."}),a.jsx("p",{className:"text-xl text-gray-400 mb-10",children:"Join thousands leveraging Sari-Sari CRM's intelligent platform."}),a.jsx("a",{href:"/signup",className:"px-12 py-4 text-lg font-bold rounded-xl shadow-2xl bg-accent border border-secondary text-white bg-secondary hover:bg-accent hover:text-secondary hover:border-accent transition-all duration-400",children:"Start 15-Day Free Trial"})]}),Noe=()=>a.jsx("footer",{className:"bg-secondary text-white border-t py-10",children:a.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-5 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-8",children:[a.jsxs("div",{children:[a.jsxs("span",{className:"text-xl font-white",children:["Sari-Sari ",a.jsx("span",{className:"text-accent",children:"CRM"})]}),a.jsx("p",{className:"text-sm text-white mt-4",children:" 2026 Sari-Sari CRM"})]}),[{title:"Resources",links:["Security","Support"],href:"/resources"},{title:"Legal",links:["Terms","Privacy","SLA","Compliance"],href:"/legal"}].map((e,t)=>a.jsxs("div",{children:[a.jsx("h5",{className:"text-md font-semibold mb-4 text-accent",children:e.title}),a.jsx("ul",{className:"space-y-2 text-sm text-white",children:e.links.map((n,s)=>a.jsx("li",{children:a.jsx("a",{href:e.href,target:"_blank",rel:"noopener noreferrer",className:"hover:text-accent",children:n})},s))})]},t))]})}),Coe=()=>(f.useEffect(()=>{document.title="Sari-Sari CRM"},[]),a.jsxs("main",{className:"font-inter",children:[a.jsx(N9,{}),a.jsx(boe,{}),a.jsx(woe,{}),a.jsx(joe,{}),a.jsx(Noe,{})]}));function am(e){return Ot({attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z",clipRule:"evenodd"},child:[]}]})(e)}function Za(e){return Ot({attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"},child:[]}]})(e)}function ac(e){return Ot({attr:{fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"},child:[]}]})(e)}class qg extends Error{}qg.prototype.name="InvalidTokenError";function Soe(e){return decodeURIComponent(atob(e).replace(/(.)/g,(t,n)=>{let s=n.charCodeAt(0).toString(16).toUpperCase();return s.length<2&&(s="0"+s),"%"+s}))}function _oe(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return Soe(t)}catch{return atob(t)}}function C9(e,t){if(typeof e!="string")throw new qg("Invalid token specified: must be a string");t||(t={});const n=t.header===!0?0:1,s=e.split(".")[n];if(typeof s!="string")throw new qg(`Invalid token specified: missing part #${n+1}`);let r;try{r=_oe(s)}catch(i){throw new qg(`Invalid token specified: invalid base64 for part #${n+1} (${i.message})`)}try{return JSON.parse(r)}catch(i){throw new qg(`Invalid token specified: invalid json for part #${n+1} (${i.message})`)}}function Qn(e,t,n=void 0){const s={};for(const r in e){const i=e[r];let o="",l=!0;for(let c=0;c<i.length;c+=1){const u=i[c];u&&(o+=(l===!0?"":" ")+t(u),l=!1,n&&n[u]&&(o+=" "+n[u]))}s[r]=o}return s}function zu(e,...t){const n=new URL(`https://mui.com/production-error/?code=${e}`);return t.forEach(s=>n.searchParams.append("args[]",s)),`Minified MUI error #${e}; visit ${n} for the full message.`}function Va(e){if(typeof e!="string")throw new Error(zu(7));return e.charAt(0).toUpperCase()+e.slice(1)}var d2={exports:{}},qa={};var QI;function Aoe(){if(QI)return qa;QI=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),u=Symbol.for("react.suspense_list"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.for("react.view_transition"),x=Symbol.for("react.client.reference");function b(j){if(typeof j=="object"&&j!==null){var y=j.$$typeof;switch(y){case e:switch(j=j.type,j){case n:case r:case s:case c:case u:case p:return j;default:switch(j=j&&j.$$typeof,j){case o:case l:case h:case d:return j;case i:return j;default:return y}}case t:return y}}}return qa.ContextConsumer=i,qa.ContextProvider=o,qa.Element=e,qa.ForwardRef=l,qa.Fragment=n,qa.Lazy=h,qa.Memo=d,qa.Portal=t,qa.Profiler=r,qa.StrictMode=s,qa.Suspense=c,qa.SuspenseList=u,qa.isContextConsumer=function(j){return b(j)===i},qa.isContextProvider=function(j){return b(j)===o},qa.isElement=function(j){return typeof j=="object"&&j!==null&&j.$$typeof===e},qa.isForwardRef=function(j){return b(j)===l},qa.isFragment=function(j){return b(j)===n},qa.isLazy=function(j){return b(j)===h},qa.isMemo=function(j){return b(j)===d},qa.isPortal=function(j){return b(j)===t},qa.isProfiler=function(j){return b(j)===r},qa.isStrictMode=function(j){return b(j)===s},qa.isSuspense=function(j){return b(j)===c},qa.isSuspenseList=function(j){return b(j)===u},qa.isValidElementType=function(j){return typeof j=="string"||typeof j=="function"||j===n||j===r||j===s||j===c||j===u||typeof j=="object"&&j!==null&&(j.$$typeof===h||j.$$typeof===d||j.$$typeof===o||j.$$typeof===i||j.$$typeof===l||j.$$typeof===x||j.getModuleId!==void 0)},qa.typeOf=b,qa}var KI;function Toe(){return KI||(KI=1,d2.exports=Aoe()),d2.exports}var LL=Toe();function To(e){if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function S9(e){if(f.isValidElement(e)||LL.isValidElementType(e)||!To(e))return e;const t={};return Object.keys(e).forEach(n=>{t[n]=S9(e[n])}),t}function zr(e,t,n={clone:!0}){const s=n.clone?{...e}:e;return To(e)&&To(t)&&Object.keys(t).forEach(r=>{f.isValidElement(t[r])||LL.isValidElementType(t[r])?s[r]=t[r]:To(t[r])&&Object.prototype.hasOwnProperty.call(e,r)&&To(e[r])?s[r]=zr(e[r],t[r],n):n.clone?s[r]=To(t[r])?S9(t[r]):t[r]:s[r]=t[r]}),s}function rp(e,t){return t?zr(e,t,{clone:!1}):e}function XI(e,t){if(!e.containerQueries)return t;const n=Object.keys(t).filter(s=>s.startsWith("@container")).sort((s,r)=>{const i=/min-width:\s*([0-9.]+)/;return+(s.match(i)?.[1]||0)-+(r.match(i)?.[1]||0)});return n.length?n.reduce((s,r)=>{const i=t[r];return delete s[r],s[r]=i,s},{...t}):t}function koe(e,t){return t==="@"||t.startsWith("@")&&(e.some(n=>t.startsWith(`@${n}`))||!!t.match(/^@\d/))}function Eoe(e,t){const n=t.match(/^@([^/]+)?\/?(.+)?$/);if(!n)return null;const[,s,r]=n,i=Number.isNaN(+s)?s||0:+s;return e.containerQueries(r).up(i)}function Loe(e){const t=(i,o)=>i.replace("@media",o?`@container ${o}`:"@container");function n(i,o){i.up=(...l)=>t(e.breakpoints.up(...l),o),i.down=(...l)=>t(e.breakpoints.down(...l),o),i.between=(...l)=>t(e.breakpoints.between(...l),o),i.only=(...l)=>t(e.breakpoints.only(...l),o),i.not=(...l)=>{const c=t(e.breakpoints.not(...l),o);return c.includes("not all and")?c.replace("not all and ","").replace("min-width:","width<").replace("max-width:","width>").replace("and","or"):c}}const s={},r=i=>(n(s,i),s);return n(r),{...e,containerQueries:r}}const Cj={xs:0,sm:600,md:900,lg:1200,xl:1536},ZI={keys:["xs","sm","md","lg","xl"],up:e=>`@media (min-width:${Cj[e]}px)`},Doe={containerQueries:e=>({up:t=>{let n=typeof t=="number"?t:Cj[t]||t;return typeof n=="number"&&(n=`${n}px`),e?`@container ${e} (min-width:${n})`:`@container (min-width:${n})`}})};function Ul(e,t,n){const s=e.theme||{};if(Array.isArray(t)){const i=s.breakpoints||ZI;return t.reduce((o,l,c)=>(o[i.up(i.keys[c])]=n(t[c]),o),{})}if(typeof t=="object"){const i=s.breakpoints||ZI;return Object.keys(t).reduce((o,l)=>{if(koe(i.keys,l)){const c=Eoe(s.containerQueries?s:Doe,l);c&&(o[c]=n(t[l],l))}else if(Object.keys(i.values||Cj).includes(l)){const c=i.up(l);o[c]=n(t[l],l)}else{const c=l;o[c]=t[c]}return o},{})}return n(t)}function Poe(e={}){return e.keys?.reduce((n,s)=>{const r=e.up(s);return n[r]={},n},{})||{}}function JI(e,t){return e.reduce((n,s)=>{const r=n[s];return(!r||Object.keys(r).length===0)&&delete n[s],n},t)}function Sj(e,t,n=!0){if(!t||typeof t!="string")return null;if(e&&e.vars&&n){const s=`vars.${t}`.split(".").reduce((r,i)=>r&&r[i]?r[i]:null,e);if(s!=null)return s}return t.split(".").reduce((s,r)=>s&&s[r]!=null?s[r]:null,e)}function Pv(e,t,n,s=n){let r;return typeof e=="function"?r=e(n):Array.isArray(e)?r=e[n]||s:r=Sj(e,n)||s,t&&(r=t(r,s,e)),r}function In(e){const{prop:t,cssProperty:n=e.prop,themeKey:s,transform:r}=e,i=o=>{if(o[t]==null)return null;const l=o[t],c=o.theme,u=Sj(c,s)||{};return Ul(o,l,h=>{let p=Pv(u,r,h);return h===p&&typeof h=="string"&&(p=Pv(u,r,`${t}${h==="default"?"":Va(h)}`,h)),n===!1?p:{[n]:p}})};return i.propTypes={},i.filterProps=[t],i}function Ooe(e){const t={};return n=>(t[n]===void 0&&(t[n]=e(n)),t[n])}const Moe={m:"margin",p:"padding"},Ioe={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},e$={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},$oe=Ooe(e=>{if(e.length>2)if(e$[e])e=e$[e];else return[e];const[t,n]=e.split(""),s=Moe[t],r=Ioe[n]||"";return Array.isArray(r)?r.map(i=>s+i):[s+r]}),DL=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],PL=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...DL,...PL];function px(e,t,n,s){const r=Sj(e,t,!0)??n;return typeof r=="number"||typeof r=="string"?i=>typeof i=="string"?i:typeof r=="string"?r.startsWith("var(")&&i===0?0:r.startsWith("var(")&&i===1?r:`calc(${i} * ${r})`:r*i:Array.isArray(r)?i=>{if(typeof i=="string")return i;const o=Math.abs(i),l=r[o];return i>=0?l:typeof l=="number"?-l:typeof l=="string"&&l.startsWith("var(")?`calc(-1 * ${l})`:`-${l}`}:typeof r=="function"?r:()=>{}}function OL(e){return px(e,"spacing",8)}function xx(e,t){return typeof t=="string"||t==null?t:e(t)}function Roe(e,t){return n=>e.reduce((s,r)=>(s[r]=xx(t,n),s),{})}function zoe(e,t,n,s){if(!t.includes(n))return null;const r=$oe(n),i=Roe(r,s),o=e[n];return Ul(e,o,i)}function _9(e,t){const n=OL(e.theme);return Object.keys(e).map(s=>zoe(e,t,s,n)).reduce(rp,{})}function jn(e){return _9(e,DL)}jn.propTypes={};jn.filterProps=DL;function Nn(e){return _9(e,PL)}Nn.propTypes={};Nn.filterProps=PL;function _j(...e){const t=e.reduce((s,r)=>(r.filterProps.forEach(i=>{s[i]=r}),s),{}),n=s=>Object.keys(s).reduce((r,i)=>t[i]?rp(r,t[i](s)):r,{});return n.propTypes={},n.filterProps=e.reduce((s,r)=>s.concat(r.filterProps),[]),n}function hi(e){return typeof e!="number"?e:`${e}px solid`}function Ai(e,t){return In({prop:e,themeKey:"borders",transform:t})}const Foe=Ai("border",hi),Uoe=Ai("borderTop",hi),Boe=Ai("borderRight",hi),Hoe=Ai("borderBottom",hi),qoe=Ai("borderLeft",hi),Goe=Ai("borderColor"),Woe=Ai("borderTopColor"),Voe=Ai("borderRightColor"),Yoe=Ai("borderBottomColor"),Qoe=Ai("borderLeftColor"),Koe=Ai("outline",hi),Xoe=Ai("outlineColor"),Aj=e=>{if(e.borderRadius!==void 0&&e.borderRadius!==null){const t=px(e.theme,"shape.borderRadius",4),n=s=>({borderRadius:xx(t,s)});return Ul(e,e.borderRadius,n)}return null};Aj.propTypes={};Aj.filterProps=["borderRadius"];_j(Foe,Uoe,Boe,Hoe,qoe,Goe,Woe,Voe,Yoe,Qoe,Aj,Koe,Xoe);const Tj=e=>{if(e.gap!==void 0&&e.gap!==null){const t=px(e.theme,"spacing",8),n=s=>({gap:xx(t,s)});return Ul(e,e.gap,n)}return null};Tj.propTypes={};Tj.filterProps=["gap"];const kj=e=>{if(e.columnGap!==void 0&&e.columnGap!==null){const t=px(e.theme,"spacing",8),n=s=>({columnGap:xx(t,s)});return Ul(e,e.columnGap,n)}return null};kj.propTypes={};kj.filterProps=["columnGap"];const Ej=e=>{if(e.rowGap!==void 0&&e.rowGap!==null){const t=px(e.theme,"spacing",8),n=s=>({rowGap:xx(t,s)});return Ul(e,e.rowGap,n)}return null};Ej.propTypes={};Ej.filterProps=["rowGap"];const Zoe=In({prop:"gridColumn"}),Joe=In({prop:"gridRow"}),ele=In({prop:"gridAutoFlow"}),tle=In({prop:"gridAutoColumns"}),ale=In({prop:"gridAutoRows"}),nle=In({prop:"gridTemplateColumns"}),sle=In({prop:"gridTemplateRows"}),rle=In({prop:"gridTemplateAreas"}),ile=In({prop:"gridArea"});_j(Tj,kj,Ej,Zoe,Joe,ele,tle,ale,nle,sle,rle,ile);function wf(e,t){return t==="grey"?t:e}const ole=In({prop:"color",themeKey:"palette",transform:wf}),lle=In({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:wf}),cle=In({prop:"backgroundColor",themeKey:"palette",transform:wf});_j(ole,lle,cle);function Ir(e){return e<=1&&e!==0?`${e*100}%`:e}const dle=In({prop:"width",transform:Ir}),ML=e=>{if(e.maxWidth!==void 0&&e.maxWidth!==null){const t=n=>{const s=e.theme?.breakpoints?.values?.[n]||Cj[n];return s?e.theme?.breakpoints?.unit!=="px"?{maxWidth:`${s}${e.theme.breakpoints.unit}`}:{maxWidth:s}:{maxWidth:Ir(n)}};return Ul(e,e.maxWidth,t)}return null};ML.filterProps=["maxWidth"];const ule=In({prop:"minWidth",transform:Ir}),mle=In({prop:"height",transform:Ir}),fle=In({prop:"maxHeight",transform:Ir}),hle=In({prop:"minHeight",transform:Ir});In({prop:"size",cssProperty:"width",transform:Ir});In({prop:"size",cssProperty:"height",transform:Ir});const gle=In({prop:"boxSizing"});_j(dle,ML,ule,mle,fle,hle,gle);const yx={border:{themeKey:"borders",transform:hi},borderTop:{themeKey:"borders",transform:hi},borderRight:{themeKey:"borders",transform:hi},borderBottom:{themeKey:"borders",transform:hi},borderLeft:{themeKey:"borders",transform:hi},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:hi},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:Aj},color:{themeKey:"palette",transform:wf},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:wf},backgroundColor:{themeKey:"palette",transform:wf},p:{style:Nn},pt:{style:Nn},pr:{style:Nn},pb:{style:Nn},pl:{style:Nn},px:{style:Nn},py:{style:Nn},padding:{style:Nn},paddingTop:{style:Nn},paddingRight:{style:Nn},paddingBottom:{style:Nn},paddingLeft:{style:Nn},paddingX:{style:Nn},paddingY:{style:Nn},paddingInline:{style:Nn},paddingInlineStart:{style:Nn},paddingInlineEnd:{style:Nn},paddingBlock:{style:Nn},paddingBlockStart:{style:Nn},paddingBlockEnd:{style:Nn},m:{style:jn},mt:{style:jn},mr:{style:jn},mb:{style:jn},ml:{style:jn},mx:{style:jn},my:{style:jn},margin:{style:jn},marginTop:{style:jn},marginRight:{style:jn},marginBottom:{style:jn},marginLeft:{style:jn},marginX:{style:jn},marginY:{style:jn},marginInline:{style:jn},marginInlineStart:{style:jn},marginInlineEnd:{style:jn},marginBlock:{style:jn},marginBlockStart:{style:jn},marginBlockEnd:{style:jn},displayPrint:{cssProperty:!1,transform:e=>({"@media print":{display:e}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:Tj},rowGap:{style:Ej},columnGap:{style:kj},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:Ir},maxWidth:{style:ML},minWidth:{transform:Ir},height:{transform:Ir},maxHeight:{transform:Ir},minHeight:{transform:Ir},boxSizing:{},font:{themeKey:"font"},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}};function ple(...e){const t=e.reduce((s,r)=>s.concat(Object.keys(r)),[]),n=new Set(t);return e.every(s=>n.size===Object.keys(s).length)}function xle(e,t){return typeof e=="function"?e(t):e}function yle(){function e(n,s,r,i){const o={[n]:s,theme:r},l=i[n];if(!l)return{[n]:s};const{cssProperty:c=n,themeKey:u,transform:d,style:h}=l;if(s==null)return null;if(u==="typography"&&s==="inherit")return{[n]:s};const p=Sj(r,u)||{};return h?h(o):Ul(o,s,b=>{let j=Pv(p,d,b);return b===j&&typeof b=="string"&&(j=Pv(p,d,`${n}${b==="default"?"":Va(b)}`,b)),c===!1?j:{[c]:j}})}function t(n){const{sx:s,theme:r={},nested:i}=n||{};if(!s)return null;const o=r.unstable_sxConfig??yx;function l(c){let u=c;if(typeof c=="function")u=c(r);else if(typeof c!="object")return c;if(!u)return null;const d=Poe(r.breakpoints),h=Object.keys(d);let p=d;return Object.keys(u).forEach(x=>{const b=xle(u[x],r);if(b!=null)if(typeof b=="object")if(o[x])p=rp(p,e(x,b,r,o));else{const j=Ul({theme:r},b,y=>({[x]:y}));ple(j,b)?p[x]=t({sx:b,theme:r,nested:!0}):p=rp(p,j)}else p=rp(p,e(x,b,r,o))}),!i&&r.modularCssLayers?{"@layer sx":XI(r,JI(h,p))}:XI(r,JI(h,p))}return Array.isArray(s)?s.map(l):l(s)}return t}const Lf=yle();Lf.filterProps=["sx"];const ble=e=>{const t={systemProps:{},otherProps:{}},n=e?.theme?.unstable_sxConfig??yx;return Object.keys(e).forEach(s=>{n[s]?t.systemProps[s]=e[s]:t.otherProps[s]=e[s]}),t};function vle(e){const{sx:t,...n}=e,{systemProps:s,otherProps:r}=ble(n);let i;return Array.isArray(t)?i=[s,...t]:typeof t=="function"?i=(...o)=>{const l=t(...o);return To(l)?{...s,...l}:s}:i={...s,...t},{...r,sx:i}}function Ze(){return Ze=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Ze.apply(null,arguments)}function wle(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}function jle(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),e.nonce!==void 0&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}var Nle=(function(){function e(n){var s=this;this._insertTag=function(r){var i;s.tags.length===0?s.insertionPoint?i=s.insertionPoint.nextSibling:s.prepend?i=s.container.firstChild:i=s.before:i=s.tags[s.tags.length-1].nextSibling,s.container.insertBefore(r,i),s.tags.push(r)},this.isSpeedy=n.speedy===void 0?!0:n.speedy,this.tags=[],this.ctr=0,this.nonce=n.nonce,this.key=n.key,this.container=n.container,this.prepend=n.prepend,this.insertionPoint=n.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(s){s.forEach(this._insertTag)},t.insert=function(s){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(jle(this));var r=this.tags[this.tags.length-1];if(this.isSpeedy){var i=wle(r);try{i.insertRule(s,i.cssRules.length)}catch{}}else r.appendChild(document.createTextNode(s));this.ctr++},t.flush=function(){this.tags.forEach(function(s){var r;return(r=s.parentNode)==null?void 0:r.removeChild(s)}),this.tags=[],this.ctr=0},e})(),Ps="-ms-",Ov="-moz-",ka="-webkit-",A9="comm",IL="rule",$L="decl",Cle="@import",T9="@keyframes",Sle="@layer",_le=Math.abs,Lj=String.fromCharCode,Ale=Object.assign;function Tle(e,t){return Es(e,0)^45?(((t<<2^Es(e,0))<<2^Es(e,1))<<2^Es(e,2))<<2^Es(e,3):0}function k9(e){return e.trim()}function kle(e,t){return(e=t.exec(e))?e[0]:e}function Ea(e,t,n){return e.replace(t,n)}function lk(e,t){return e.indexOf(t)}function Es(e,t){return e.charCodeAt(t)|0}function wp(e,t,n){return e.slice(t,n)}function So(e){return e.length}function RL(e){return e.length}function Hy(e,t){return t.push(e),e}function Ele(e,t){return e.map(t).join("")}var Dj=1,Df=1,E9=0,vr=0,Hn=0,ih="";function Pj(e,t,n,s,r,i,o){return{value:e,root:t,parent:n,type:s,props:r,children:i,line:Dj,column:Df,length:o,return:""}}function bg(e,t){return Ale(Pj("",null,null,"",null,null,0),e,{length:-e.length},t)}function Lle(){return Hn}function Dle(){return Hn=vr>0?Es(ih,--vr):0,Df--,Hn===10&&(Df=1,Dj--),Hn}function Fr(){return Hn=vr<E9?Es(ih,vr++):0,Df++,Hn===10&&(Df=1,Dj++),Hn}function Mo(){return Es(ih,vr)}function mv(){return vr}function bx(e,t){return wp(ih,e,t)}function jp(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function L9(e){return Dj=Df=1,E9=So(ih=e),vr=0,[]}function D9(e){return ih="",e}function fv(e){return k9(bx(vr-1,ck(e===91?e+2:e===40?e+1:e)))}function Ple(e){for(;(Hn=Mo())&&Hn<33;)Fr();return jp(e)>2||jp(Hn)>3?"":" "}function Ole(e,t){for(;--t&&Fr()&&!(Hn<48||Hn>102||Hn>57&&Hn<65||Hn>70&&Hn<97););return bx(e,mv()+(t<6&&Mo()==32&&Fr()==32))}function ck(e){for(;Fr();)switch(Hn){case e:return vr;case 34:case 39:e!==34&&e!==39&&ck(Hn);break;case 40:e===41&&ck(e);break;case 92:Fr();break}return vr}function Mle(e,t){for(;Fr()&&e+Hn!==57;)if(e+Hn===84&&Mo()===47)break;return"/*"+bx(t,vr-1)+"*"+Lj(e===47?e:Fr())}function Ile(e){for(;!jp(Mo());)Fr();return bx(e,vr)}function $le(e){return D9(hv("",null,null,null,[""],e=L9(e),0,[0],e))}function hv(e,t,n,s,r,i,o,l,c){for(var u=0,d=0,h=o,p=0,x=0,b=0,j=1,y=1,N=1,w=0,S="",_=r,T=i,k=s,A=S;y;)switch(b=w,w=Fr()){case 40:if(b!=108&&Es(A,h-1)==58){lk(A+=Ea(fv(w),"&","&\f"),"&\f")!=-1&&(N=-1);break}case 34:case 39:case 91:A+=fv(w);break;case 9:case 10:case 13:case 32:A+=Ple(b);break;case 92:A+=Ole(mv()-1,7);continue;case 47:switch(Mo()){case 42:case 47:Hy(Rle(Mle(Fr(),mv()),t,n),c);break;default:A+="/"}break;case 123*j:l[u++]=So(A)*N;case 125*j:case 59:case 0:switch(w){case 0:case 125:y=0;case 59+d:N==-1&&(A=Ea(A,/\f/g,"")),x>0&&So(A)-h&&Hy(x>32?a$(A+";",s,n,h-1):a$(Ea(A," ","")+";",s,n,h-2),c);break;case 59:A+=";";default:if(Hy(k=t$(A,t,n,u,d,r,l,S,_=[],T=[],h),i),w===123)if(d===0)hv(A,t,k,k,_,i,h,l,T);else switch(p===99&&Es(A,3)===110?100:p){case 100:case 108:case 109:case 115:hv(e,k,k,s&&Hy(t$(e,k,k,0,0,r,l,S,r,_=[],h),T),r,T,h,l,s?_:T);break;default:hv(A,k,k,k,[""],T,0,l,T)}}u=d=x=0,j=N=1,S=A="",h=o;break;case 58:h=1+So(A),x=b;default:if(j<1){if(w==123)--j;else if(w==125&&j++==0&&Dle()==125)continue}switch(A+=Lj(w),w*j){case 38:N=d>0?1:(A+="\f",-1);break;case 44:l[u++]=(So(A)-1)*N,N=1;break;case 64:Mo()===45&&(A+=fv(Fr())),p=Mo(),d=h=So(S=A+=Ile(mv())),w++;break;case 45:b===45&&So(A)==2&&(j=0)}}return i}function t$(e,t,n,s,r,i,o,l,c,u,d){for(var h=r-1,p=r===0?i:[""],x=RL(p),b=0,j=0,y=0;b<s;++b)for(var N=0,w=wp(e,h+1,h=_le(j=o[b])),S=e;N<x;++N)(S=k9(j>0?p[N]+" "+w:Ea(w,/&\f/g,p[N])))&&(c[y++]=S);return Pj(e,t,n,r===0?IL:l,c,u,d)}function Rle(e,t,n){return Pj(e,t,n,A9,Lj(Lle()),wp(e,2,-2),0)}function a$(e,t,n,s){return Pj(e,t,n,$L,wp(e,0,s),wp(e,s+1,-1),s)}function jf(e,t){for(var n="",s=RL(e),r=0;r<s;r++)n+=t(e[r],r,e,t)||"";return n}function zle(e,t,n,s){switch(e.type){case Sle:if(e.children.length)break;case Cle:case $L:return e.return=e.return||e.value;case A9:return"";case T9:return e.return=e.value+"{"+jf(e.children,s)+"}";case IL:e.value=e.props.join(",")}return So(n=jf(e.children,s))?e.return=e.value+"{"+n+"}":""}function Fle(e){var t=RL(e);return function(n,s,r,i){for(var o="",l=0;l<t;l++)o+=e[l](n,s,r,i)||"";return o}}function Ule(e){return function(t){t.root||(t=t.return)&&e(t)}}function P9(e){var t=Object.create(null);return function(n){return t[n]===void 0&&(t[n]=e(n)),t[n]}}var Ble=function(t,n,s){for(var r=0,i=0;r=i,i=Mo(),r===38&&i===12&&(n[s]=1),!jp(i);)Fr();return bx(t,vr)},Hle=function(t,n){var s=-1,r=44;do switch(jp(r)){case 0:r===38&&Mo()===12&&(n[s]=1),t[s]+=Ble(vr-1,n,s);break;case 2:t[s]+=fv(r);break;case 4:if(r===44){t[++s]=Mo()===58?"&\f":"",n[s]=t[s].length;break}default:t[s]+=Lj(r)}while(r=Fr());return t},qle=function(t,n){return D9(Hle(L9(t),n))},n$=new WeakMap,Gle=function(t){if(!(t.type!=="rule"||!t.parent||t.length<1)){for(var n=t.value,s=t.parent,r=t.column===s.column&&t.line===s.line;s.type!=="rule";)if(s=s.parent,!s)return;if(!(t.props.length===1&&n.charCodeAt(0)!==58&&!n$.get(s))&&!r){n$.set(t,!0);for(var i=[],o=qle(n,i),l=s.props,c=0,u=0;c<o.length;c++)for(var d=0;d<l.length;d++,u++)t.props[u]=i[c]?o[c].replace(/&\f/g,l[d]):l[d]+" "+o[c]}}},Wle=function(t){if(t.type==="decl"){var n=t.value;n.charCodeAt(0)===108&&n.charCodeAt(2)===98&&(t.return="",t.value="")}};function O9(e,t){switch(Tle(e,t)){case 5103:return ka+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return ka+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return ka+e+Ov+e+Ps+e+e;case 6828:case 4268:return ka+e+Ps+e+e;case 6165:return ka+e+Ps+"flex-"+e+e;case 5187:return ka+e+Ea(e,/(\w+).+(:[^]+)/,ka+"box-$1$2"+Ps+"flex-$1$2")+e;case 5443:return ka+e+Ps+"flex-item-"+Ea(e,/flex-|-self/,"")+e;case 4675:return ka+e+Ps+"flex-line-pack"+Ea(e,/align-content|flex-|-self/,"")+e;case 5548:return ka+e+Ps+Ea(e,"shrink","negative")+e;case 5292:return ka+e+Ps+Ea(e,"basis","preferred-size")+e;case 6060:return ka+"box-"+Ea(e,"-grow","")+ka+e+Ps+Ea(e,"grow","positive")+e;case 4554:return ka+Ea(e,/([^-])(transform)/g,"$1"+ka+"$2")+e;case 6187:return Ea(Ea(Ea(e,/(zoom-|grab)/,ka+"$1"),/(image-set)/,ka+"$1"),e,"")+e;case 5495:case 3959:return Ea(e,/(image-set\([^]*)/,ka+"$1$`$1");case 4968:return Ea(Ea(e,/(.+:)(flex-)?(.*)/,ka+"box-pack:$3"+Ps+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+ka+e+e;case 4095:case 3583:case 4068:case 2532:return Ea(e,/(.+)-inline(.+)/,ka+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(So(e)-1-t>6)switch(Es(e,t+1)){case 109:if(Es(e,t+4)!==45)break;case 102:return Ea(e,/(.+:)(.+)-([^]+)/,"$1"+ka+"$2-$3$1"+Ov+(Es(e,t+3)==108?"$3":"$2-$3"))+e;case 115:return~lk(e,"stretch")?O9(Ea(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(Es(e,t+1)!==115)break;case 6444:switch(Es(e,So(e)-3-(~lk(e,"!important")&&10))){case 107:return Ea(e,":",":"+ka)+e;case 101:return Ea(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+ka+(Es(e,14)===45?"inline-":"")+"box$3$1"+ka+"$2$3$1"+Ps+"$2box$3")+e}break;case 5936:switch(Es(e,t+11)){case 114:return ka+e+Ps+Ea(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return ka+e+Ps+Ea(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return ka+e+Ps+Ea(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return ka+e+Ps+e+e}return e}var Vle=function(t,n,s,r){if(t.length>-1&&!t.return)switch(t.type){case $L:t.return=O9(t.value,t.length);break;case T9:return jf([bg(t,{value:Ea(t.value,"@","@"+ka)})],r);case IL:if(t.length)return Ele(t.props,function(i){switch(kle(i,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return jf([bg(t,{props:[Ea(i,/:(read-\w+)/,":"+Ov+"$1")]})],r);case"::placeholder":return jf([bg(t,{props:[Ea(i,/:(plac\w+)/,":"+ka+"input-$1")]}),bg(t,{props:[Ea(i,/:(plac\w+)/,":"+Ov+"$1")]}),bg(t,{props:[Ea(i,/:(plac\w+)/,Ps+"input-$1")]})],r)}return""})}},Yle=[Vle],Qle=function(t){var n=t.key;if(n==="css"){var s=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(s,function(j){var y=j.getAttribute("data-emotion");y.indexOf(" ")!==-1&&(document.head.appendChild(j),j.setAttribute("data-s",""))})}var r=t.stylisPlugins||Yle,i={},o,l=[];o=t.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+n+' "]'),function(j){for(var y=j.getAttribute("data-emotion").split(" "),N=1;N<y.length;N++)i[y[N]]=!0;l.push(j)});var c,u=[Gle,Wle];{var d,h=[zle,Ule(function(j){d.insert(j)})],p=Fle(u.concat(r,h)),x=function(y){return jf($le(y),p)};c=function(y,N,w,S){d=w,x(y?y+"{"+N.styles+"}":N.styles),S&&(b.inserted[N.name]=!0)}}var b={key:n,sheet:new Nle({key:n,container:o,nonce:t.nonce,speedy:t.speedy,prepend:t.prepend,insertionPoint:t.insertionPoint}),nonce:t.nonce,inserted:i,registered:{},insert:c};return b.sheet.hydrate(l),b},u2={exports:{}},Da={};var s$;function Kle(){if(s$)return Da;s$=1;var e=typeof Symbol=="function"&&Symbol.for,t=e?Symbol.for("react.element"):60103,n=e?Symbol.for("react.portal"):60106,s=e?Symbol.for("react.fragment"):60107,r=e?Symbol.for("react.strict_mode"):60108,i=e?Symbol.for("react.profiler"):60114,o=e?Symbol.for("react.provider"):60109,l=e?Symbol.for("react.context"):60110,c=e?Symbol.for("react.async_mode"):60111,u=e?Symbol.for("react.concurrent_mode"):60111,d=e?Symbol.for("react.forward_ref"):60112,h=e?Symbol.for("react.suspense"):60113,p=e?Symbol.for("react.suspense_list"):60120,x=e?Symbol.for("react.memo"):60115,b=e?Symbol.for("react.lazy"):60116,j=e?Symbol.for("react.block"):60121,y=e?Symbol.for("react.fundamental"):60117,N=e?Symbol.for("react.responder"):60118,w=e?Symbol.for("react.scope"):60119;function S(T){if(typeof T=="object"&&T!==null){var k=T.$$typeof;switch(k){case t:switch(T=T.type,T){case c:case u:case s:case i:case r:case h:return T;default:switch(T=T&&T.$$typeof,T){case l:case d:case b:case x:case o:return T;default:return k}}case n:return k}}}function _(T){return S(T)===u}return Da.AsyncMode=c,Da.ConcurrentMode=u,Da.ContextConsumer=l,Da.ContextProvider=o,Da.Element=t,Da.ForwardRef=d,Da.Fragment=s,Da.Lazy=b,Da.Memo=x,Da.Portal=n,Da.Profiler=i,Da.StrictMode=r,Da.Suspense=h,Da.isAsyncMode=function(T){return _(T)||S(T)===c},Da.isConcurrentMode=_,Da.isContextConsumer=function(T){return S(T)===l},Da.isContextProvider=function(T){return S(T)===o},Da.isElement=function(T){return typeof T=="object"&&T!==null&&T.$$typeof===t},Da.isForwardRef=function(T){return S(T)===d},Da.isFragment=function(T){return S(T)===s},Da.isLazy=function(T){return S(T)===b},Da.isMemo=function(T){return S(T)===x},Da.isPortal=function(T){return S(T)===n},Da.isProfiler=function(T){return S(T)===i},Da.isStrictMode=function(T){return S(T)===r},Da.isSuspense=function(T){return S(T)===h},Da.isValidElementType=function(T){return typeof T=="string"||typeof T=="function"||T===s||T===u||T===i||T===r||T===h||T===p||typeof T=="object"&&T!==null&&(T.$$typeof===b||T.$$typeof===x||T.$$typeof===o||T.$$typeof===l||T.$$typeof===d||T.$$typeof===y||T.$$typeof===N||T.$$typeof===w||T.$$typeof===j)},Da.typeOf=S,Da}var r$;function Xle(){return r$||(r$=1,u2.exports=Kle()),u2.exports}var m2,i$;function Zle(){if(i$)return m2;i$=1;var e=Xle(),t={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},n={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},s={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},r={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},i={};i[e.ForwardRef]=s,i[e.Memo]=r;function o(b){return e.isMemo(b)?r:i[b.$$typeof]||t}var l=Object.defineProperty,c=Object.getOwnPropertyNames,u=Object.getOwnPropertySymbols,d=Object.getOwnPropertyDescriptor,h=Object.getPrototypeOf,p=Object.prototype;function x(b,j,y){if(typeof j!="string"){if(p){var N=h(j);N&&N!==p&&x(b,N,y)}var w=c(j);u&&(w=w.concat(u(j)));for(var S=o(b),_=o(j),T=0;T<w.length;++T){var k=w[T];if(!n[k]&&!(y&&y[k])&&!(_&&_[k])&&!(S&&S[k])){var A=d(j,k);try{l(b,k,A)}catch{}}}}return b}return m2=x,m2}Zle();var Jle=!0;function M9(e,t,n){var s="";return n.split(" ").forEach(function(r){e[r]!==void 0?t.push(e[r]+";"):r&&(s+=r+" ")}),s}var zL=function(t,n,s){var r=t.key+"-"+n.name;(s===!1||Jle===!1)&&t.registered[r]===void 0&&(t.registered[r]=n.styles)},I9=function(t,n,s){zL(t,n,s);var r=t.key+"-"+n.name;if(t.inserted[n.name]===void 0){var i=n;do t.insert(n===i?"."+r:"",i,t.sheet,!0),i=i.next;while(i!==void 0)}};function ece(e){for(var t=0,n,s=0,r=e.length;r>=4;++s,r-=4)n=e.charCodeAt(s)&255|(e.charCodeAt(++s)&255)<<8|(e.charCodeAt(++s)&255)<<16|(e.charCodeAt(++s)&255)<<24,n=(n&65535)*1540483477+((n>>>16)*59797<<16),n^=n>>>24,t=(n&65535)*1540483477+((n>>>16)*59797<<16)^(t&65535)*1540483477+((t>>>16)*59797<<16);switch(r){case 3:t^=(e.charCodeAt(s+2)&255)<<16;case 2:t^=(e.charCodeAt(s+1)&255)<<8;case 1:t^=e.charCodeAt(s)&255,t=(t&65535)*1540483477+((t>>>16)*59797<<16)}return t^=t>>>13,t=(t&65535)*1540483477+((t>>>16)*59797<<16),((t^t>>>15)>>>0).toString(36)}var tce={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},ace=/[A-Z]|^ms/g,nce=/_EMO_([^_]+?)_([^]*?)_EMO_/g,$9=function(t){return t.charCodeAt(1)===45},o$=function(t){return t!=null&&typeof t!="boolean"},f2=P9(function(e){return $9(e)?e:e.replace(ace,"-$&").toLowerCase()}),l$=function(t,n){switch(t){case"animation":case"animationName":if(typeof n=="string")return n.replace(nce,function(s,r,i){return _o={name:r,styles:i,next:_o},r})}return tce[t]!==1&&!$9(t)&&typeof n=="number"&&n!==0?n+"px":n};function Np(e,t,n){if(n==null)return"";var s=n;if(s.__emotion_styles!==void 0)return s;switch(typeof n){case"boolean":return"";case"object":{var r=n;if(r.anim===1)return _o={name:r.name,styles:r.styles,next:_o},r.name;var i=n;if(i.styles!==void 0){var o=i.next;if(o!==void 0)for(;o!==void 0;)_o={name:o.name,styles:o.styles,next:_o},o=o.next;var l=i.styles+";";return l}return sce(e,t,n)}case"function":{if(e!==void 0){var c=_o,u=n(e);return _o=c,Np(e,t,u)}break}}var d=n;if(t==null)return d;var h=t[d];return h!==void 0?h:d}function sce(e,t,n){var s="";if(Array.isArray(n))for(var r=0;r<n.length;r++)s+=Np(e,t,n[r])+";";else for(var i in n){var o=n[i];if(typeof o!="object"){var l=o;t!=null&&t[l]!==void 0?s+=i+"{"+t[l]+"}":o$(l)&&(s+=f2(i)+":"+l$(i,l)+";")}else if(Array.isArray(o)&&typeof o[0]=="string"&&(t==null||t[o[0]]===void 0))for(var c=0;c<o.length;c++)o$(o[c])&&(s+=f2(i)+":"+l$(i,o[c])+";");else{var u=Np(e,t,o);switch(i){case"animation":case"animationName":{s+=f2(i)+":"+u+";";break}default:s+=i+"{"+u+"}"}}}return s}var c$=/label:\s*([^\s;{]+)\s*(;|$)/g,_o;function Oj(e,t,n){if(e.length===1&&typeof e[0]=="object"&&e[0]!==null&&e[0].styles!==void 0)return e[0];var s=!0,r="";_o=void 0;var i=e[0];if(i==null||i.raw===void 0)s=!1,r+=Np(n,t,i);else{var o=i;r+=o[0]}for(var l=1;l<e.length;l++)if(r+=Np(n,t,e[l]),s){var c=i;r+=c[l]}c$.lastIndex=0;for(var u="",d;(d=c$.exec(r))!==null;)u+="-"+d[1];var h=ece(r)+u;return{name:h,styles:r,next:_o}}var rce=function(t){return t()},ice=Mu.useInsertionEffect?Mu.useInsertionEffect:!1,R9=ice||rce,z9=f.createContext(typeof HTMLElement<"u"?Qle({key:"css"}):null);z9.Provider;var F9=function(t){return f.forwardRef(function(n,s){var r=f.useContext(z9);return t(n,r,s)})},FL=f.createContext({}),UL={}.hasOwnProperty,dk="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",oce=function(t,n){var s={};for(var r in n)UL.call(n,r)&&(s[r]=n[r]);return s[dk]=t,s},lce=function(t){var n=t.cache,s=t.serialized,r=t.isStringTag;return zL(n,s,r),R9(function(){return I9(n,s,r)}),null},cce=F9(function(e,t,n){var s=e.css;typeof s=="string"&&t.registered[s]!==void 0&&(s=t.registered[s]);var r=e[dk],i=[s],o="";typeof e.className=="string"?o=M9(t.registered,i,e.className):e.className!=null&&(o=e.className+" ");var l=Oj(i,void 0,f.useContext(FL));o+=t.key+"-"+l.name;var c={};for(var u in e)UL.call(e,u)&&u!=="css"&&u!==dk&&(c[u]=e[u]);return c.className=o,n&&(c.ref=n),f.createElement(f.Fragment,null,f.createElement(lce,{cache:t,serialized:l,isStringTag:typeof r=="string"}),f.createElement(r,c))}),dce=cce,d$=function(t,n){var s=arguments;if(n==null||!UL.call(n,"css"))return f.createElement.apply(void 0,s);var r=s.length,i=new Array(r);i[0]=dce,i[1]=oce(t,n);for(var o=2;o<r;o++)i[o]=s[o];return f.createElement.apply(null,i)};(function(e){var t;t||(t=e.JSX||(e.JSX={}))})(d$||(d$={}));function BL(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Oj(t)}function vx(){var e=BL.apply(void 0,arguments),t="animation-"+e.name;return{name:t,styles:"@keyframes "+t+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}var uce=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|popover|popoverTarget|popoverTargetAction|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,mce=P9(function(e){return uce.test(e)||e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)<91}),fce=mce,hce=function(t){return t!=="theme"},u$=function(t){return typeof t=="string"&&t.charCodeAt(0)>96?fce:hce},m$=function(t,n,s){var r;if(n){var i=n.shouldForwardProp;r=t.__emotion_forwardProp&&i?function(o){return t.__emotion_forwardProp(o)&&i(o)}:i}return typeof r!="function"&&s&&(r=t.__emotion_forwardProp),r},gce=function(t){var n=t.cache,s=t.serialized,r=t.isStringTag;return zL(n,s,r),R9(function(){return I9(n,s,r)}),null},pce=function e(t,n){var s=t.__emotion_real===t,r=s&&t.__emotion_base||t,i,o;n!==void 0&&(i=n.label,o=n.target);var l=m$(t,n,s),c=l||u$(r),u=!c("as");return function(){var d=arguments,h=s&&t.__emotion_styles!==void 0?t.__emotion_styles.slice(0):[];if(i!==void 0&&h.push("label:"+i+";"),d[0]==null||d[0].raw===void 0)h.push.apply(h,d);else{var p=d[0];h.push(p[0]);for(var x=d.length,b=1;b<x;b++)h.push(d[b],p[b])}var j=F9(function(y,N,w){var S=u&&y.as||r,_="",T=[],k=y;if(y.theme==null){k={};for(var A in y)k[A]=y[A];k.theme=f.useContext(FL)}typeof y.className=="string"?_=M9(N.registered,T,y.className):y.className!=null&&(_=y.className+" ");var E=Oj(h.concat(T),N.registered,k);_+=N.key+"-"+E.name,o!==void 0&&(_+=" "+o);var M=u&&l===void 0?u$(S):c,F={};for(var D in y)u&&D==="as"||M(D)&&(F[D]=y[D]);return F.className=_,w&&(F.ref=w),f.createElement(f.Fragment,null,f.createElement(gce,{cache:N,serialized:E,isStringTag:typeof S=="string"}),f.createElement(S,F))});return j.displayName=i!==void 0?i:"Styled("+(typeof r=="string"?r:r.displayName||r.name||"Component")+")",j.defaultProps=t.defaultProps,j.__emotion_real=j,j.__emotion_base=r,j.__emotion_styles=h,j.__emotion_forwardProp=l,Object.defineProperty(j,"toString",{value:function(){return"."+o}}),j.withComponent=function(y,N){var w=e(y,Ze({},n,N,{shouldForwardProp:m$(j,N,!0)}));return w.apply(void 0,h)},j}},xce=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],uk=pce.bind(null);xce.forEach(function(e){uk[e]=uk(e)});function yce(e,t){return uk(e,t)}function bce(e,t){Array.isArray(e.__emotion_styles)&&(e.__emotion_styles=t(e.__emotion_styles))}const f$=[];function Au(e){return f$[0]=e,Oj(f$)}const vce=e=>{const t=Object.keys(e).map(n=>({key:n,val:e[n]}))||[];return t.sort((n,s)=>n.val-s.val),t.reduce((n,s)=>({...n,[s.key]:s.val}),{})};function wce(e){const{values:t={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:n="px",step:s=5,...r}=e,i=vce(t),o=Object.keys(i);function l(p){return`@media (min-width:${typeof t[p]=="number"?t[p]:p}${n})`}function c(p){return`@media (max-width:${(typeof t[p]=="number"?t[p]:p)-s/100}${n})`}function u(p,x){const b=o.indexOf(x);return`@media (min-width:${typeof t[p]=="number"?t[p]:p}${n}) and (max-width:${(b!==-1&&typeof t[o[b]]=="number"?t[o[b]]:x)-s/100}${n})`}function d(p){return o.indexOf(p)+1<o.length?u(p,o[o.indexOf(p)+1]):l(p)}function h(p){const x=o.indexOf(p);return x===0?l(o[1]):x===o.length-1?c(o[x]):u(p,o[o.indexOf(p)+1]).replace("@media","@media not all and")}return{keys:o,values:i,up:l,down:c,between:u,only:d,not:h,unit:n,...r}}const jce={borderRadius:4};function U9(e=8,t=OL({spacing:e})){if(e.mui)return e;const n=(...s)=>(s.length===0?[1]:s).map(i=>{const o=t(i);return typeof o=="number"?`${o}px`:o}).join(" ");return n.mui=!0,n}function Nce(e,t){const n=this;if(n.vars){if(!n.colorSchemes?.[e]||typeof n.getColorSchemeSelector!="function")return{};let s=n.getColorSchemeSelector(e);return s==="&"?t:((s.includes("data-")||s.includes("."))&&(s=`*:where(${s.replace(/\s*&$/,"")}) &`),{[s]:t})}return n.palette.mode===e?t:{}}function HL(e={},...t){const{breakpoints:n={},palette:s={},spacing:r,shape:i={},...o}=e,l=wce(n),c=U9(r);let u=zr({breakpoints:l,direction:"ltr",components:{},palette:{mode:"light",...s},spacing:c,shape:{...jce,...i}},o);return u=Loe(u),u.applyStyles=Nce,u=t.reduce((d,h)=>zr(d,h),u),u.unstable_sxConfig={...yx,...o?.unstable_sxConfig},u.unstable_sx=function(h){return Lf({sx:h,theme:this})},u}function Cce(e){return Object.keys(e).length===0}function B9(e=null){const t=f.useContext(FL);return!t||Cce(t)?e:t}const Sce=HL();function H9(e=Sce){return B9(e)}const h$=e=>e,_ce=()=>{let e=h$;return{configure(t){e=t},generate(t){return e(t)},reset(){e=h$}}},Ace=_ce(),Tce={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function Kn(e,t,n="Mui"){const s=Tce[t];return s?`${n}-${s}`:`${Ace.generate(e)}-${t}`}function An(e,t,n="Mui"){const s={};return t.forEach(r=>{s[r]=Kn(e,r,n)}),s}function q9(e){const{variants:t,...n}=e,s={variants:t,style:Au(n),isProcessed:!0};return s.style===n||t&&t.forEach(r=>{typeof r.style!="function"&&(r.style=Au(r.style))}),s}const kce=HL();function gv(e){return e!=="ownerState"&&e!=="theme"&&e!=="sx"&&e!=="as"}function yu(e,t){return t&&e&&typeof e=="object"&&e.styles&&!e.styles.startsWith("@layer")&&(e.styles=`@layer ${t}{${String(e.styles)}}`),e}function Ece(e){return e?(t,n)=>n[e]:null}function Lce(e,t,n){e.theme=Oce(e.theme)?n:e.theme[t]||e.theme}function pv(e,t,n){const s=typeof t=="function"?t(e):t;if(Array.isArray(s))return s.flatMap(r=>pv(e,r,n));if(Array.isArray(s?.variants)){let r;if(s.isProcessed)r=n?yu(s.style,n):s.style;else{const{variants:i,...o}=s;r=n?yu(Au(o),n):o}return G9(e,s.variants,[r],n)}return s?.isProcessed?n?yu(Au(s.style),n):s.style:n?yu(Au(s),n):s}function G9(e,t,n=[],s=void 0){let r;e:for(let i=0;i<t.length;i+=1){const o=t[i];if(typeof o.props=="function"){if(r??={...e,...e.ownerState,ownerState:e.ownerState},!o.props(r))continue}else for(const l in o.props)if(e[l]!==o.props[l]&&e.ownerState?.[l]!==o.props[l])continue e;typeof o.style=="function"?(r??={...e,...e.ownerState,ownerState:e.ownerState},n.push(s?yu(Au(o.style(r)),s):o.style(r))):n.push(s?yu(Au(o.style),s):o.style)}return n}function Dce(e={}){const{themeId:t,defaultTheme:n=kce,rootShouldForwardProp:s=gv,slotShouldForwardProp:r=gv}=e;function i(l){Lce(l,t,n)}return(l,c={})=>{bce(l,k=>k.filter(A=>A!==Lf));const{name:u,slot:d,skipVariantsResolver:h,skipSx:p,overridesResolver:x=Ece(Ice(d)),...b}=c,j=u&&u.startsWith("Mui")||d?"components":"custom",y=h!==void 0?h:d&&d!=="Root"&&d!=="root"||!1,N=p||!1;let w=gv;d==="Root"||d==="root"?w=s:d?w=r:Mce(l)&&(w=void 0);const S=yce(l,{shouldForwardProp:w,label:Pce(),...b}),_=k=>{if(k.__emotion_real===k)return k;if(typeof k=="function")return function(E){return pv(E,k,E.theme.modularCssLayers?j:void 0)};if(To(k)){const A=q9(k);return function(M){return A.variants?pv(M,A,M.theme.modularCssLayers?j:void 0):M.theme.modularCssLayers?yu(A.style,j):A.style}}return k},T=(...k)=>{const A=[],E=k.map(_),M=[];if(A.push(i),u&&x&&M.push(function(B){const $=B.theme.components?.[u]?.styleOverrides;if(!$)return null;const W={};for(const Z in $)W[Z]=pv(B,$[Z],B.theme.modularCssLayers?"theme":void 0);return x(B,W)}),u&&!y&&M.push(function(B){const $=B.theme?.components?.[u]?.variants;return $?G9(B,$,[],B.theme.modularCssLayers?"theme":void 0):null}),N||M.push(Lf),Array.isArray(E[0])){const P=E.shift(),B=new Array(A.length).fill(""),G=new Array(M.length).fill("");let $;$=[...B,...P,...G],$.raw=[...B,...P.raw,...G],A.unshift($)}const F=[...A,...E,...M],D=S(...F);return l.muiName&&(D.muiName=l.muiName),D};return S.withConfig&&(T.withConfig=S.withConfig),T}}function Pce(e,t){return void 0}function Oce(e){for(const t in e)return!1;return!0}function Mce(e){return typeof e=="string"&&e.charCodeAt(0)>96}function Ice(e){return e&&e.charAt(0).toLowerCase()+e.slice(1)}function Fu(e,t,n=!1){const s={...t};for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)){const i=r;if(i==="components"||i==="slots")s[i]={...e[i],...s[i]};else if(i==="componentsProps"||i==="slotProps"){const o=e[i],l=t[i];if(!l)s[i]=o||{};else if(!o)s[i]=l;else{s[i]={...l};for(const c in o)if(Object.prototype.hasOwnProperty.call(o,c)){const u=c;s[i][u]=Fu(o[u],l[u],n)}}}else i==="className"&&n&&t.className?s.className=Rt(e?.className,t?.className):i==="style"&&n&&t.style?s.style={...e?.style,...t?.style}:s[i]===void 0&&(s[i]=e[i])}return s}function W9(e){const{theme:t,name:n,props:s}=e;return!t||!t.components||!t.components[n]||!t.components[n].defaultProps?s:Fu(t.components[n].defaultProps,s)}function $ce({props:e,name:t,defaultTheme:n,themeId:s}){let r=H9(n);return r=r[s]||r,W9({theme:r,name:t,props:e})}const ls=typeof window<"u"?f.useLayoutEffect:f.useEffect;function Rce(e,t,n,s,r){const[i,o]=f.useState(()=>r&&n?n(e).matches:s?s(e).matches:t);return ls(()=>{if(!n)return;const l=n(e),c=()=>{o(l.matches)};return c(),l.addEventListener("change",c),()=>{l.removeEventListener("change",c)}},[e,n]),i}const zce={...Mu},V9=zce.useSyncExternalStore;function Fce(e,t,n,s,r){const i=f.useCallback(()=>t,[t]),o=f.useMemo(()=>{if(r&&n)return()=>n(e).matches;if(s!==null){const{matches:d}=s(e);return()=>d}return i},[i,e,s,r,n]),[l,c]=f.useMemo(()=>{if(n===null)return[i,()=>()=>{}];const d=n(e);return[()=>d.matches,h=>(d.addEventListener("change",h),()=>{d.removeEventListener("change",h)})]},[i,n,e]);return V9(c,l,o)}function Y9(e={}){const{themeId:t}=e;return function(s,r={}){let i=B9();i&&t&&(i=i[t]||i);const o=typeof window<"u"&&typeof window.matchMedia<"u",{defaultMatches:l=!1,matchMedia:c=o?window.matchMedia:null,ssrMatchMedia:u=null,noSsr:d=!1}=W9({name:"MuiUseMediaQuery",props:r,theme:i});let h=typeof s=="function"?s(i):s;return h=h.replace(/^@media( ?)/m,""),h.includes("print")&&console.warn(["MUI: You have provided a `print` query to the `useMediaQuery` hook.","Using the print media query to modify print styles can lead to unexpected results.","Consider using the `displayPrint` field in the `sx` prop instead.","More information about `displayPrint` on our docs: https://mui.com/system/display/#display-in-print."].join(`
`)),(V9!==void 0?Fce:Rce)(h,l,c,u,d)}}Y9();function Uce(e,t=Number.MIN_SAFE_INTEGER,n=Number.MAX_SAFE_INTEGER){return Math.max(t,Math.min(e,n))}function qL(e,t=0,n=1){return Uce(e,t,n)}function Bce(e){e=e.slice(1);const t=new RegExp(`.{1,${e.length>=6?2:1}}`,"g");let n=e.match(t);return n&&n[0].length===1&&(n=n.map(s=>s+s)),n?`rgb${n.length===4?"a":""}(${n.map((s,r)=>r<3?parseInt(s,16):Math.round(parseInt(s,16)/255*1e3)/1e3).join(", ")})`:""}function fd(e){if(e.type)return e;if(e.charAt(0)==="#")return fd(Bce(e));const t=e.indexOf("("),n=e.substring(0,t);if(!["rgb","rgba","hsl","hsla","color"].includes(n))throw new Error(zu(9,e));let s=e.substring(t+1,e.length-1),r;if(n==="color"){if(s=s.split(" "),r=s.shift(),s.length===4&&s[3].charAt(0)==="/"&&(s[3]=s[3].slice(1)),!["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].includes(r))throw new Error(zu(10,r))}else s=s.split(",");return s=s.map(i=>parseFloat(i)),{type:n,values:s,colorSpace:r}}const Hce=e=>{const t=fd(e);return t.values.slice(0,3).map((n,s)=>t.type.includes("hsl")&&s!==0?`${n}%`:n).join(" ")},Gg=(e,t)=>{try{return Hce(e)}catch{return e}};function Mj(e){const{type:t,colorSpace:n}=e;let{values:s}=e;return t.includes("rgb")?s=s.map((r,i)=>i<3?parseInt(r,10):r):t.includes("hsl")&&(s[1]=`${s[1]}%`,s[2]=`${s[2]}%`),t.includes("color")?s=`${n} ${s.join(" ")}`:s=`${s.join(", ")}`,`${t}(${s})`}function Q9(e){e=fd(e);const{values:t}=e,n=t[0],s=t[1]/100,r=t[2]/100,i=s*Math.min(r,1-r),o=(u,d=(u+n/30)%12)=>r-i*Math.max(Math.min(d-3,9-d,1),-1);let l="rgb";const c=[Math.round(o(0)*255),Math.round(o(8)*255),Math.round(o(4)*255)];return e.type==="hsla"&&(l+="a",c.push(t[3])),Mj({type:l,values:c})}function mk(e){e=fd(e);let t=e.type==="hsl"||e.type==="hsla"?fd(Q9(e)).values:e.values;return t=t.map(n=>(e.type!=="color"&&(n/=255),n<=.03928?n/12.92:((n+.055)/1.055)**2.4)),Number((.2126*t[0]+.7152*t[1]+.0722*t[2]).toFixed(3))}function qce(e,t){const n=mk(e),s=mk(t);return(Math.max(n,s)+.05)/(Math.min(n,s)+.05)}function K9(e,t){return e=fd(e),t=qL(t),(e.type==="rgb"||e.type==="hsl")&&(e.type+="a"),e.type==="color"?e.values[3]=`/${t}`:e.values[3]=t,Mj(e)}function Yd(e,t,n){try{return K9(e,t)}catch{return e}}function Ij(e,t){if(e=fd(e),t=qL(t),e.type.includes("hsl"))e.values[2]*=1-t;else if(e.type.includes("rgb")||e.type.includes("color"))for(let n=0;n<3;n+=1)e.values[n]*=1-t;return Mj(e)}function Ia(e,t,n){try{return Ij(e,t)}catch{return e}}function $j(e,t){if(e=fd(e),t=qL(t),e.type.includes("hsl"))e.values[2]+=(100-e.values[2])*t;else if(e.type.includes("rgb"))for(let n=0;n<3;n+=1)e.values[n]+=(255-e.values[n])*t;else if(e.type.includes("color"))for(let n=0;n<3;n+=1)e.values[n]+=(1-e.values[n])*t;return Mj(e)}function $a(e,t,n){try{return $j(e,t)}catch{return e}}function Gce(e,t=.15){return mk(e)>.5?Ij(e,t):$j(e,t)}function qy(e,t,n){try{return Gce(e,t)}catch{return e}}const Wce=f.createContext(),wx=()=>f.useContext(Wce)??!1,Vce=f.createContext(void 0);function Yce(e){const{theme:t,name:n,props:s}=e;if(!t||!t.components||!t.components[n])return s;const r=t.components[n];return r.defaultProps?Fu(r.defaultProps,s,t.components.mergeClassNameAndStyle):!r.styleOverrides&&!r.variants?Fu(r,s,t.components.mergeClassNameAndStyle):s}function Qce({props:e,name:t}){const n=f.useContext(Vce);return Yce({props:e,name:t,theme:{components:n}})}let g$=0;function Kce(e){const[t,n]=f.useState(e),s=e||t;return f.useEffect(()=>{t==null&&(g$+=1,n(`mui-${g$}`))},[t]),s}const Xce={...Mu},p$=Xce.useId;function Rj(e){if(p$!==void 0){const t=p$();return e??t}return Kce(e)}const x$={theme:void 0};function Zce(e){let t,n;return function(r){let i=t;return(i===void 0||r.theme!==n)&&(x$.theme=r.theme,i=q9(e(x$)),t=i,n=r.theme),i}}function Jce(e=""){function t(...s){if(!s.length)return"";const r=s[0];return typeof r=="string"&&!r.match(/(#|\(|\)|(-?(\d*\.)?\d+)(px|em|%|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc))|^(-?(\d*\.)?\d+)$|(\d+ \d+ \d+)/)?`, var(--${e?`${e}-`:""}${r}${t(...s.slice(1))})`:`, ${r}`}return(s,...r)=>`var(--${e?`${e}-`:""}${s}${t(...r)})`}const y$=(e,t,n,s=[])=>{let r=e;t.forEach((i,o)=>{o===t.length-1?Array.isArray(r)?r[Number(i)]=n:r&&typeof r=="object"&&(r[i]=n):r&&typeof r=="object"&&(r[i]||(r[i]=s.includes(i)?[]:{}),r=r[i])})},ede=(e,t,n)=>{function s(r,i=[],o=[]){Object.entries(r).forEach(([l,c])=>{(!n||n&&!n([...i,l]))&&c!=null&&(typeof c=="object"&&Object.keys(c).length>0?s(c,[...i,l],Array.isArray(c)?[...o,l]:o):t([...i,l],c,o))})}s(e)},tde=(e,t)=>typeof t=="number"?["lineHeight","fontWeight","opacity","zIndex"].some(s=>e.includes(s))||e[e.length-1].toLowerCase().includes("opacity")?t:`${t}px`:t;function h2(e,t){const{prefix:n,shouldSkipGeneratingVar:s}=t||{},r={},i={},o={};return ede(e,(l,c,u)=>{if((typeof c=="string"||typeof c=="number")&&(!s||!s(l,c))){const d=`--${n?`${n}-`:""}${l.join("-")}`,h=tde(l,c);Object.assign(r,{[d]:h}),y$(i,l,`var(${d})`,u),y$(o,l,`var(${d}, ${h})`,u)}},l=>l[0]==="vars"),{css:r,vars:i,varsWithDefaults:o}}function ade(e,t={}){const{getSelector:n=N,disableCssColorScheme:s,colorSchemeSelector:r,enableContrastVars:i}=t,{colorSchemes:o={},components:l,defaultColorScheme:c="light",...u}=e,{vars:d,css:h,varsWithDefaults:p}=h2(u,t);let x=p;const b={},{[c]:j,...y}=o;if(Object.entries(y||{}).forEach(([_,T])=>{const{vars:k,css:A,varsWithDefaults:E}=h2(T,t);x=zr(x,E),b[_]={css:A,vars:k}}),j){const{css:_,vars:T,varsWithDefaults:k}=h2(j,t);x=zr(x,k),b[c]={css:_,vars:T}}function N(_,T){let k=r;if(r==="class"&&(k=".%s"),r==="data"&&(k="[data-%s]"),r?.startsWith("data-")&&!r.includes("%s")&&(k=`[${r}="%s"]`),_){if(k==="media")return e.defaultColorScheme===_?":root":{[`@media (prefers-color-scheme: ${o[_]?.palette?.mode||_})`]:{":root":T}};if(k)return e.defaultColorScheme===_?`:root, ${k.replace("%s",String(_))}`:k.replace("%s",String(_))}return":root"}return{vars:x,generateThemeVars:()=>{let _={...d};return Object.entries(b).forEach(([,{vars:T}])=>{_=zr(_,T)}),_},generateStyleSheets:()=>{const _=[],T=e.defaultColorScheme||"light";function k(M,F){Object.keys(F).length&&_.push(typeof M=="string"?{[M]:{...F}}:M)}k(n(void 0,{...h}),h);const{[T]:A,...E}=b;if(A){const{css:M}=A,F=o[T]?.palette?.mode,D=!s&&F?{colorScheme:F,...M}:{...M};k(n(T,{...D}),D)}return Object.entries(E).forEach(([M,{css:F}])=>{const D=o[M]?.palette?.mode,P=!s&&D?{colorScheme:D,...F}:{...F};k(n(M,{...P}),P)}),i&&_.push({":root":{"--__l-threshold":"0.7","--__l":"clamp(0, (l / var(--__l-threshold) - 1) * -infinity, 1)","--__a":"clamp(0.87, (l / var(--__l-threshold) - 1) * -infinity, 1)"}}),_}}}function nde(e){return function(n){return e==="media"?`@media (prefers-color-scheme: ${n})`:e?e.startsWith("data-")&&!e.includes("%s")?`[${e}="${n}"] &`:e==="class"?`.${n} &`:e==="data"?`[data-${n}] &`:`${e.replace("%s",n)} &`:"&"}}const Cp={black:"#000",white:"#fff"},sde={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},Ym={50:"#f3e5f5",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",700:"#7b1fa2"},Qm={300:"#e57373",400:"#ef5350",500:"#f44336",700:"#d32f2f",800:"#c62828"},vg={300:"#ffb74d",400:"#ffa726",500:"#ff9800",700:"#f57c00",900:"#e65100"},Km={50:"#e3f2fd",200:"#90caf9",400:"#42a5f5",700:"#1976d2",800:"#1565c0"},Xm={300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",700:"#0288d1",900:"#01579b"},Zm={300:"#81c784",400:"#66bb6a",500:"#4caf50",700:"#388e3c",800:"#2e7d32",900:"#1b5e20"};function X9(){return{text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:Cp.white,default:Cp.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}}}const Z9=X9();function J9(){return{text:{primary:Cp.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:Cp.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}}}const fk=J9();function b$(e,t,n,s){const r=s.light||s,i=s.dark||s*1.5;e[t]||(e.hasOwnProperty(n)?e[t]=e[n]:t==="light"?e.light=$j(e.main,r):t==="dark"&&(e.dark=Ij(e.main,i)))}function v$(e,t,n,s,r){const i=r.light||r,o=r.dark||r*1.5;t[n]||(t.hasOwnProperty(s)?t[n]=t[s]:n==="light"?t.light=`color-mix(in ${e}, ${t.main}, #fff ${(i*100).toFixed(0)}%)`:n==="dark"&&(t.dark=`color-mix(in ${e}, ${t.main}, #000 ${(o*100).toFixed(0)}%)`))}function rde(e="light"){return e==="dark"?{main:Km[200],light:Km[50],dark:Km[400]}:{main:Km[700],light:Km[400],dark:Km[800]}}function ide(e="light"){return e==="dark"?{main:Ym[200],light:Ym[50],dark:Ym[400]}:{main:Ym[500],light:Ym[300],dark:Ym[700]}}function ode(e="light"){return e==="dark"?{main:Qm[500],light:Qm[300],dark:Qm[700]}:{main:Qm[700],light:Qm[400],dark:Qm[800]}}function lde(e="light"){return e==="dark"?{main:Xm[400],light:Xm[300],dark:Xm[700]}:{main:Xm[700],light:Xm[500],dark:Xm[900]}}function cde(e="light"){return e==="dark"?{main:Zm[400],light:Zm[300],dark:Zm[700]}:{main:Zm[800],light:Zm[500],dark:Zm[900]}}function dde(e="light"){return e==="dark"?{main:vg[400],light:vg[300],dark:vg[700]}:{main:"#ed6c02",light:vg[500],dark:vg[900]}}function ude(e){return`oklch(from ${e} var(--__l) 0 h / var(--__a))`}function GL(e){const{mode:t="light",contrastThreshold:n=3,tonalOffset:s=.2,colorSpace:r,...i}=e,o=e.primary||rde(t),l=e.secondary||ide(t),c=e.error||ode(t),u=e.info||lde(t),d=e.success||cde(t),h=e.warning||dde(t);function p(y){return r?ude(y):qce(y,fk.text.primary)>=n?fk.text.primary:Z9.text.primary}const x=({color:y,name:N,mainShade:w=500,lightShade:S=300,darkShade:_=700})=>{if(y={...y},!y.main&&y[w]&&(y.main=y[w]),!y.hasOwnProperty("main"))throw new Error(zu(11,N?` (${N})`:"",w));if(typeof y.main!="string")throw new Error(zu(12,N?` (${N})`:"",JSON.stringify(y.main)));return r?(v$(r,y,"light",S,s),v$(r,y,"dark",_,s)):(b$(y,"light",S,s),b$(y,"dark",_,s)),y.contrastText||(y.contrastText=p(y.main)),y};let b;return t==="light"?b=X9():t==="dark"&&(b=J9()),zr({common:{...Cp},mode:t,primary:x({color:o,name:"primary"}),secondary:x({color:l,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:x({color:c,name:"error"}),warning:x({color:h,name:"warning"}),info:x({color:u,name:"info"}),success:x({color:d,name:"success"}),grey:sde,contrastThreshold:n,getContrastText:p,augmentColor:x,tonalOffset:s,...b},i)}function mde(e){const t={};return Object.entries(e).forEach(s=>{const[r,i]=s;typeof i=="object"&&(t[r]=`${i.fontStyle?`${i.fontStyle} `:""}${i.fontVariant?`${i.fontVariant} `:""}${i.fontWeight?`${i.fontWeight} `:""}${i.fontStretch?`${i.fontStretch} `:""}${i.fontSize||""}${i.lineHeight?`/${i.lineHeight} `:""}${i.fontFamily||""}`)}),t}function fde(e,t){return{toolbar:{minHeight:56,[e.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[e.up("sm")]:{minHeight:64}},...t}}function hde(e){return Math.round(e*1e5)/1e5}const w$={textTransform:"uppercase"},j$='"Roboto", "Helvetica", "Arial", sans-serif';function gde(e,t){const{fontFamily:n=j$,fontSize:s=14,fontWeightLight:r=300,fontWeightRegular:i=400,fontWeightMedium:o=500,fontWeightBold:l=700,htmlFontSize:c=16,allVariants:u,pxToRem:d,...h}=typeof t=="function"?t(e):t,p=s/14,x=d||(y=>`${y/c*p}rem`),b=(y,N,w,S,_)=>({fontFamily:n,fontWeight:y,fontSize:x(N),lineHeight:w,...n===j$?{letterSpacing:`${hde(S/N)}em`}:{},..._,...u}),j={h1:b(r,96,1.167,-1.5),h2:b(r,60,1.2,-.5),h3:b(i,48,1.167,0),h4:b(i,34,1.235,.25),h5:b(i,24,1.334,0),h6:b(o,20,1.6,.15),subtitle1:b(i,16,1.75,.15),subtitle2:b(o,14,1.57,.1),body1:b(i,16,1.5,.15),body2:b(i,14,1.43,.15),button:b(o,14,1.75,.4,w$),caption:b(i,12,1.66,.4),overline:b(i,12,2.66,1,w$),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return zr({htmlFontSize:c,pxToRem:x,fontFamily:n,fontSize:s,fontWeightLight:r,fontWeightRegular:i,fontWeightMedium:o,fontWeightBold:l,...j},h,{clone:!1})}const pde=.2,xde=.14,yde=.12;function ln(...e){return[`${e[0]}px ${e[1]}px ${e[2]}px ${e[3]}px rgba(0,0,0,${pde})`,`${e[4]}px ${e[5]}px ${e[6]}px ${e[7]}px rgba(0,0,0,${xde})`,`${e[8]}px ${e[9]}px ${e[10]}px ${e[11]}px rgba(0,0,0,${yde})`].join(",")}const bde=["none",ln(0,2,1,-1,0,1,1,0,0,1,3,0),ln(0,3,1,-2,0,2,2,0,0,1,5,0),ln(0,3,3,-2,0,3,4,0,0,1,8,0),ln(0,2,4,-1,0,4,5,0,0,1,10,0),ln(0,3,5,-1,0,5,8,0,0,1,14,0),ln(0,3,5,-1,0,6,10,0,0,1,18,0),ln(0,4,5,-2,0,7,10,1,0,2,16,1),ln(0,5,5,-3,0,8,10,1,0,3,14,2),ln(0,5,6,-3,0,9,12,1,0,3,16,2),ln(0,6,6,-3,0,10,14,1,0,4,18,3),ln(0,6,7,-4,0,11,15,1,0,4,20,3),ln(0,7,8,-4,0,12,17,2,0,5,22,4),ln(0,7,8,-4,0,13,19,2,0,5,24,4),ln(0,7,9,-4,0,14,21,2,0,5,26,4),ln(0,8,9,-5,0,15,22,2,0,6,28,5),ln(0,8,10,-5,0,16,24,2,0,6,30,5),ln(0,8,11,-5,0,17,26,2,0,6,32,5),ln(0,9,11,-5,0,18,28,2,0,7,34,6),ln(0,9,12,-6,0,19,29,2,0,7,36,6),ln(0,10,13,-6,0,20,31,3,0,8,38,7),ln(0,10,13,-6,0,21,33,3,0,8,40,7),ln(0,10,14,-6,0,22,35,3,0,8,42,7),ln(0,11,14,-7,0,23,36,3,0,9,44,8),ln(0,11,15,-7,0,24,38,3,0,9,46,8)],vde={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},wde={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function N$(e){return`${Math.round(e)}ms`}function jde(e){if(!e)return 0;const t=e/36;return Math.min(Math.round((4+15*t**.25+t/5)*10),3e3)}function Nde(e){const t={...vde,...e.easing},n={...wde,...e.duration};return{getAutoHeightDuration:jde,create:(r=["all"],i={})=>{const{duration:o=n.standard,easing:l=t.easeInOut,delay:c=0,...u}=i;return(Array.isArray(r)?r:[r]).map(d=>`${d} ${typeof o=="string"?o:N$(o)} ${l} ${typeof c=="string"?c:N$(c)}`).join(",")},...e,easing:t,duration:n}}const Cde={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500};function Sde(e){return To(e)||typeof e>"u"||typeof e=="string"||typeof e=="boolean"||typeof e=="number"||Array.isArray(e)}function eq(e={}){const t={...e};function n(s){const r=Object.entries(s);for(let i=0;i<r.length;i++){const[o,l]=r[i];!Sde(l)||o.startsWith("unstable_")?delete s[o]:To(l)&&(s[o]={...l},n(s[o]))}}return n(t),`import { unstable_createBreakpoints as createBreakpoints, createTransitions } from '@mui/material/styles';

const theme = ${JSON.stringify(t,null,2)};

theme.breakpoints = createBreakpoints(theme.breakpoints || {});
theme.transitions = createTransitions(theme.transitions || {});

export default theme;`}function C$(e){return typeof e=="number"?`${(e*100).toFixed(0)}%`:`calc((${e}) * 100%)`}const _de=e=>{if(!Number.isNaN(+e))return+e;const t=e.match(/\d*\.?\d+/g);if(!t)return 0;let n=0;for(let s=0;s<t.length;s+=1)n+=+t[s];return n};function Ade(e){Object.assign(e,{alpha(t,n){const s=this||e;return s.colorSpace?`oklch(from ${t} l c h / ${typeof n=="string"?`calc(${n})`:n})`:s.vars?`rgba(${t.replace(/var\(--([^,\s)]+)(?:,[^)]+)?\)+/g,"var(--$1Channel)")} / ${typeof n=="string"?`calc(${n})`:n})`:K9(t,_de(n))},lighten(t,n){const s=this||e;return s.colorSpace?`color-mix(in ${s.colorSpace}, ${t}, #fff ${C$(n)})`:$j(t,n)},darken(t,n){const s=this||e;return s.colorSpace?`color-mix(in ${s.colorSpace}, ${t}, #000 ${C$(n)})`:Ij(t,n)}})}function hk(e={},...t){const{breakpoints:n,mixins:s={},spacing:r,palette:i={},transitions:o={},typography:l={},shape:c,colorSpace:u,...d}=e;if(e.vars&&e.generateThemeVars===void 0)throw new Error(zu(20));const h=GL({...i,colorSpace:u}),p=HL(e);let x=zr(p,{mixins:fde(p.breakpoints,s),palette:h,shadows:bde.slice(),typography:gde(h,l),transitions:Nde(o),zIndex:{...Cde}});return x=zr(x,d),x=t.reduce((b,j)=>zr(b,j),x),x.unstable_sxConfig={...yx,...d?.unstable_sxConfig},x.unstable_sx=function(j){return Lf({sx:j,theme:this})},x.toRuntimeSource=eq,Ade(x),x}function Tde(e){let t;return e<1?t=5.11916*e**2:t=4.5*Math.log(e+1)+2,Math.round(t*10)/1e3}const kde=[...Array(25)].map((e,t)=>{if(t===0)return"none";const n=Tde(t);return`linear-gradient(rgba(255 255 255 / ${n}), rgba(255 255 255 / ${n}))`});function tq(e){return{inputPlaceholder:e==="dark"?.5:.42,inputUnderline:e==="dark"?.7:.42,switchTrackDisabled:e==="dark"?.2:.12,switchTrack:e==="dark"?.3:.38}}function aq(e){return e==="dark"?kde:[]}function Ede(e){const{palette:t={mode:"light"},opacity:n,overlays:s,colorSpace:r,...i}=e,o=GL({...t,colorSpace:r});return{palette:o,opacity:{...tq(o.mode),...n},overlays:s||aq(o.mode),...i}}function Lde(e){return!!e[0].match(/(cssVarPrefix|colorSchemeSelector|modularCssLayers|rootSelector|typography|mixins|breakpoints|direction|transitions)/)||!!e[0].match(/sxConfig$/)||e[0]==="palette"&&!!e[1]?.match(/(mode|contrastThreshold|tonalOffset)/)}const Dde=e=>[...[...Array(25)].map((t,n)=>`--${e?`${e}-`:""}overlays-${n}`),`--${e?`${e}-`:""}palette-AppBar-darkBg`,`--${e?`${e}-`:""}palette-AppBar-darkColor`],Pde=e=>(t,n)=>{const s=e.rootSelector||":root",r=e.colorSchemeSelector;let i=r;if(r==="class"&&(i=".%s"),r==="data"&&(i="[data-%s]"),r?.startsWith("data-")&&!r.includes("%s")&&(i=`[${r}="%s"]`),e.defaultColorScheme===t){if(t==="dark"){const o={};return Dde(e.cssVarPrefix).forEach(l=>{o[l]=n[l],delete n[l]}),i==="media"?{[s]:n,"@media (prefers-color-scheme: dark)":{[s]:o}}:i?{[i.replace("%s",t)]:o,[`${s}, ${i.replace("%s",t)}`]:n}:{[s]:{...n,...o}}}if(i&&i!=="media")return`${s}, ${i.replace("%s",String(t))}`}else if(t){if(i==="media")return{[`@media (prefers-color-scheme: ${String(t)})`]:{[s]:n}};if(i)return i.replace("%s",String(t))}return s};function Ode(e,t){t.forEach(n=>{e[n]||(e[n]={})})}function xt(e,t,n){!e[t]&&n&&(e[t]=n)}function Wg(e){return typeof e!="string"||!e.startsWith("hsl")?e:Q9(e)}function pl(e,t){`${t}Channel`in e||(e[`${t}Channel`]=Gg(Wg(e[t])))}function Mde(e){return typeof e=="number"?`${e}px`:typeof e=="string"||typeof e=="function"||Array.isArray(e)?e:"8px"}const mo=e=>{try{return e()}catch{}},Ide=(e="mui")=>Jce(e);function g2(e,t,n,s,r){if(!n)return;n=n===!0?{}:n;const i=r==="dark"?"dark":"light";if(!s){t[r]=Ede({...n,palette:{mode:i,...n?.palette},colorSpace:e});return}const{palette:o,...l}=hk({...s,palette:{mode:i,...n?.palette},colorSpace:e});return t[r]={...n,palette:o,opacity:{...tq(i),...n?.opacity},overlays:n?.overlays||aq(i)},l}function $de(e={},...t){const{colorSchemes:n={light:!0},defaultColorScheme:s,disableCssColorScheme:r=!1,cssVarPrefix:i="mui",nativeColor:o=!1,shouldSkipGeneratingVar:l=Lde,colorSchemeSelector:c=n.light&&n.dark?"media":void 0,rootSelector:u=":root",...d}=e,h=Object.keys(n)[0],p=s||(n.light&&h!=="light"?"light":h),x=Ide(i),{[p]:b,light:j,dark:y,...N}=n,w={...N};let S=b;if((p==="dark"&&!("dark"in n)||p==="light"&&!("light"in n))&&(S=!0),!S)throw new Error(zu(21,p));let _;o&&(_="oklch");const T=g2(_,w,S,d,p);j&&!w.light&&g2(_,w,j,void 0,"light"),y&&!w.dark&&g2(_,w,y,void 0,"dark");let k={defaultColorScheme:p,...T,cssVarPrefix:i,colorSchemeSelector:c,rootSelector:u,getCssVar:x,colorSchemes:w,font:{...mde(T.typography),...T.font},spacing:Mde(d.spacing)};Object.keys(k.colorSchemes).forEach(D=>{const P=k.colorSchemes[D].palette,B=$=>{const W=$.split("-"),Z=W[1],Q=W[2];return x($,P[Z][Q])};P.mode==="light"&&(xt(P.common,"background","#fff"),xt(P.common,"onBackground","#000")),P.mode==="dark"&&(xt(P.common,"background","#000"),xt(P.common,"onBackground","#fff"));function G($,W,Z){if(_){let Q;return $===Yd&&(Q=`transparent ${((1-Z)*100).toFixed(0)}%`),$===Ia&&(Q=`#000 ${(Z*100).toFixed(0)}%`),$===$a&&(Q=`#fff ${(Z*100).toFixed(0)}%`),`color-mix(in ${_}, ${W}, ${Q})`}return $(W,Z)}if(Ode(P,["Alert","AppBar","Avatar","Button","Chip","FilledInput","LinearProgress","Skeleton","Slider","SnackbarContent","SpeedDialAction","StepConnector","StepContent","Switch","TableCell","Tooltip"]),P.mode==="light"){xt(P.Alert,"errorColor",G(Ia,P.error.light,.6)),xt(P.Alert,"infoColor",G(Ia,P.info.light,.6)),xt(P.Alert,"successColor",G(Ia,P.success.light,.6)),xt(P.Alert,"warningColor",G(Ia,P.warning.light,.6)),xt(P.Alert,"errorFilledBg",B("palette-error-main")),xt(P.Alert,"infoFilledBg",B("palette-info-main")),xt(P.Alert,"successFilledBg",B("palette-success-main")),xt(P.Alert,"warningFilledBg",B("palette-warning-main")),xt(P.Alert,"errorFilledColor",mo(()=>P.getContrastText(P.error.main))),xt(P.Alert,"infoFilledColor",mo(()=>P.getContrastText(P.info.main))),xt(P.Alert,"successFilledColor",mo(()=>P.getContrastText(P.success.main))),xt(P.Alert,"warningFilledColor",mo(()=>P.getContrastText(P.warning.main))),xt(P.Alert,"errorStandardBg",G($a,P.error.light,.9)),xt(P.Alert,"infoStandardBg",G($a,P.info.light,.9)),xt(P.Alert,"successStandardBg",G($a,P.success.light,.9)),xt(P.Alert,"warningStandardBg",G($a,P.warning.light,.9)),xt(P.Alert,"errorIconColor",B("palette-error-main")),xt(P.Alert,"infoIconColor",B("palette-info-main")),xt(P.Alert,"successIconColor",B("palette-success-main")),xt(P.Alert,"warningIconColor",B("palette-warning-main")),xt(P.AppBar,"defaultBg",B("palette-grey-100")),xt(P.Avatar,"defaultBg",B("palette-grey-400")),xt(P.Button,"inheritContainedBg",B("palette-grey-300")),xt(P.Button,"inheritContainedHoverBg",B("palette-grey-A100")),xt(P.Chip,"defaultBorder",B("palette-grey-400")),xt(P.Chip,"defaultAvatarColor",B("palette-grey-700")),xt(P.Chip,"defaultIconColor",B("palette-grey-700")),xt(P.FilledInput,"bg","rgba(0, 0, 0, 0.06)"),xt(P.FilledInput,"hoverBg","rgba(0, 0, 0, 0.09)"),xt(P.FilledInput,"disabledBg","rgba(0, 0, 0, 0.12)"),xt(P.LinearProgress,"primaryBg",G($a,P.primary.main,.62)),xt(P.LinearProgress,"secondaryBg",G($a,P.secondary.main,.62)),xt(P.LinearProgress,"errorBg",G($a,P.error.main,.62)),xt(P.LinearProgress,"infoBg",G($a,P.info.main,.62)),xt(P.LinearProgress,"successBg",G($a,P.success.main,.62)),xt(P.LinearProgress,"warningBg",G($a,P.warning.main,.62)),xt(P.Skeleton,"bg",_?G(Yd,P.text.primary,.11):`rgba(${B("palette-text-primaryChannel")} / 0.11)`),xt(P.Slider,"primaryTrack",G($a,P.primary.main,.62)),xt(P.Slider,"secondaryTrack",G($a,P.secondary.main,.62)),xt(P.Slider,"errorTrack",G($a,P.error.main,.62)),xt(P.Slider,"infoTrack",G($a,P.info.main,.62)),xt(P.Slider,"successTrack",G($a,P.success.main,.62)),xt(P.Slider,"warningTrack",G($a,P.warning.main,.62));const $=_?G(Ia,P.background.default,.6825):qy(P.background.default,.8);xt(P.SnackbarContent,"bg",$),xt(P.SnackbarContent,"color",mo(()=>_?fk.text.primary:P.getContrastText($))),xt(P.SpeedDialAction,"fabHoverBg",qy(P.background.paper,.15)),xt(P.StepConnector,"border",B("palette-grey-400")),xt(P.StepContent,"border",B("palette-grey-400")),xt(P.Switch,"defaultColor",B("palette-common-white")),xt(P.Switch,"defaultDisabledColor",B("palette-grey-100")),xt(P.Switch,"primaryDisabledColor",G($a,P.primary.main,.62)),xt(P.Switch,"secondaryDisabledColor",G($a,P.secondary.main,.62)),xt(P.Switch,"errorDisabledColor",G($a,P.error.main,.62)),xt(P.Switch,"infoDisabledColor",G($a,P.info.main,.62)),xt(P.Switch,"successDisabledColor",G($a,P.success.main,.62)),xt(P.Switch,"warningDisabledColor",G($a,P.warning.main,.62)),xt(P.TableCell,"border",G($a,G(Yd,P.divider,1),.88)),xt(P.Tooltip,"bg",G(Yd,P.grey[700],.92))}if(P.mode==="dark"){xt(P.Alert,"errorColor",G($a,P.error.light,.6)),xt(P.Alert,"infoColor",G($a,P.info.light,.6)),xt(P.Alert,"successColor",G($a,P.success.light,.6)),xt(P.Alert,"warningColor",G($a,P.warning.light,.6)),xt(P.Alert,"errorFilledBg",B("palette-error-dark")),xt(P.Alert,"infoFilledBg",B("palette-info-dark")),xt(P.Alert,"successFilledBg",B("palette-success-dark")),xt(P.Alert,"warningFilledBg",B("palette-warning-dark")),xt(P.Alert,"errorFilledColor",mo(()=>P.getContrastText(P.error.dark))),xt(P.Alert,"infoFilledColor",mo(()=>P.getContrastText(P.info.dark))),xt(P.Alert,"successFilledColor",mo(()=>P.getContrastText(P.success.dark))),xt(P.Alert,"warningFilledColor",mo(()=>P.getContrastText(P.warning.dark))),xt(P.Alert,"errorStandardBg",G(Ia,P.error.light,.9)),xt(P.Alert,"infoStandardBg",G(Ia,P.info.light,.9)),xt(P.Alert,"successStandardBg",G(Ia,P.success.light,.9)),xt(P.Alert,"warningStandardBg",G(Ia,P.warning.light,.9)),xt(P.Alert,"errorIconColor",B("palette-error-main")),xt(P.Alert,"infoIconColor",B("palette-info-main")),xt(P.Alert,"successIconColor",B("palette-success-main")),xt(P.Alert,"warningIconColor",B("palette-warning-main")),xt(P.AppBar,"defaultBg",B("palette-grey-900")),xt(P.AppBar,"darkBg",B("palette-background-paper")),xt(P.AppBar,"darkColor",B("palette-text-primary")),xt(P.Avatar,"defaultBg",B("palette-grey-600")),xt(P.Button,"inheritContainedBg",B("palette-grey-800")),xt(P.Button,"inheritContainedHoverBg",B("palette-grey-700")),xt(P.Chip,"defaultBorder",B("palette-grey-700")),xt(P.Chip,"defaultAvatarColor",B("palette-grey-300")),xt(P.Chip,"defaultIconColor",B("palette-grey-300")),xt(P.FilledInput,"bg","rgba(255, 255, 255, 0.09)"),xt(P.FilledInput,"hoverBg","rgba(255, 255, 255, 0.13)"),xt(P.FilledInput,"disabledBg","rgba(255, 255, 255, 0.12)"),xt(P.LinearProgress,"primaryBg",G(Ia,P.primary.main,.5)),xt(P.LinearProgress,"secondaryBg",G(Ia,P.secondary.main,.5)),xt(P.LinearProgress,"errorBg",G(Ia,P.error.main,.5)),xt(P.LinearProgress,"infoBg",G(Ia,P.info.main,.5)),xt(P.LinearProgress,"successBg",G(Ia,P.success.main,.5)),xt(P.LinearProgress,"warningBg",G(Ia,P.warning.main,.5)),xt(P.Skeleton,"bg",_?G(Yd,P.text.primary,.13):`rgba(${B("palette-text-primaryChannel")} / 0.13)`),xt(P.Slider,"primaryTrack",G(Ia,P.primary.main,.5)),xt(P.Slider,"secondaryTrack",G(Ia,P.secondary.main,.5)),xt(P.Slider,"errorTrack",G(Ia,P.error.main,.5)),xt(P.Slider,"infoTrack",G(Ia,P.info.main,.5)),xt(P.Slider,"successTrack",G(Ia,P.success.main,.5)),xt(P.Slider,"warningTrack",G(Ia,P.warning.main,.5));const $=_?G($a,P.background.default,.985):qy(P.background.default,.98);xt(P.SnackbarContent,"bg",$),xt(P.SnackbarContent,"color",mo(()=>_?Z9.text.primary:P.getContrastText($))),xt(P.SpeedDialAction,"fabHoverBg",qy(P.background.paper,.15)),xt(P.StepConnector,"border",B("palette-grey-600")),xt(P.StepContent,"border",B("palette-grey-600")),xt(P.Switch,"defaultColor",B("palette-grey-300")),xt(P.Switch,"defaultDisabledColor",B("palette-grey-600")),xt(P.Switch,"primaryDisabledColor",G(Ia,P.primary.main,.55)),xt(P.Switch,"secondaryDisabledColor",G(Ia,P.secondary.main,.55)),xt(P.Switch,"errorDisabledColor",G(Ia,P.error.main,.55)),xt(P.Switch,"infoDisabledColor",G(Ia,P.info.main,.55)),xt(P.Switch,"successDisabledColor",G(Ia,P.success.main,.55)),xt(P.Switch,"warningDisabledColor",G(Ia,P.warning.main,.55)),xt(P.TableCell,"border",G(Ia,G(Yd,P.divider,1),.68)),xt(P.Tooltip,"bg",G(Yd,P.grey[700],.92))}pl(P.background,"default"),pl(P.background,"paper"),pl(P.common,"background"),pl(P.common,"onBackground"),pl(P,"divider"),Object.keys(P).forEach($=>{const W=P[$];$!=="tonalOffset"&&W&&typeof W=="object"&&(W.main&&xt(P[$],"mainChannel",Gg(Wg(W.main))),W.light&&xt(P[$],"lightChannel",Gg(Wg(W.light))),W.dark&&xt(P[$],"darkChannel",Gg(Wg(W.dark))),W.contrastText&&xt(P[$],"contrastTextChannel",Gg(Wg(W.contrastText))),$==="text"&&(pl(P[$],"primary"),pl(P[$],"secondary")),$==="action"&&(W.active&&pl(P[$],"active"),W.selected&&pl(P[$],"selected")))})}),k=t.reduce((D,P)=>zr(D,P),k);const A={prefix:i,disableCssColorScheme:r,shouldSkipGeneratingVar:l,getSelector:Pde(k),enableContrastVars:o},{vars:E,generateThemeVars:M,generateStyleSheets:F}=ade(k,A);return k.vars=E,Object.entries(k.colorSchemes[k.defaultColorScheme]).forEach(([D,P])=>{k[D]=P}),k.generateThemeVars=M,k.generateStyleSheets=F,k.generateSpacing=function(){return U9(d.spacing,OL(this))},k.getColorSchemeSelector=nde(c),k.spacing=k.generateSpacing(),k.shouldSkipGeneratingVar=l,k.unstable_sxConfig={...yx,...d?.unstable_sxConfig},k.unstable_sx=function(P){return Lf({sx:P,theme:this})},k.toRuntimeSource=eq,k}function S$(e,t,n){e.colorSchemes&&n&&(e.colorSchemes[t]={...n!==!0&&n,palette:GL({...n===!0?{}:n.palette,mode:t})})}function Rde(e={},...t){const{palette:n,cssVariables:s=!1,colorSchemes:r=n?void 0:{light:!0},defaultColorScheme:i=n?.mode,...o}=e,l=i||"light",c=r?.[l],u={...r,...n?{[l]:{...typeof c!="boolean"&&c,palette:n}}:void 0};if(s===!1){if(!("colorSchemes"in e))return hk(e,...t);let d=n;"palette"in e||u[l]&&(u[l]!==!0?d=u[l].palette:l==="dark"&&(d={mode:"dark"}));const h=hk({...e,palette:d},...t);return h.defaultColorScheme=l,h.colorSchemes=u,h.palette.mode==="light"&&(h.colorSchemes.light={...u.light!==!0&&u.light,palette:h.palette},S$(h,"dark",u.dark)),h.palette.mode==="dark"&&(h.colorSchemes.dark={...u.dark!==!0&&u.dark,palette:h.palette},S$(h,"light",u.light)),h}return!n&&!("light"in u)&&l==="light"&&(u.light=!0),$de({...o,colorSchemes:u,defaultColorScheme:l,...typeof s!="boolean"&&s},...t)}const WL=Rde(),zj="$$material";function Yo(){const e=H9(WL);return e[zj]||e}function zde(e){return e!=="ownerState"&&e!=="theme"&&e!=="sx"&&e!=="as"}const nq=e=>zde(e)&&e!=="classes",fa=Dce({themeId:zj,defaultTheme:WL,rootShouldForwardProp:nq});function Fde(){return vle}function Cd(e){return Qce(e)}function Uo(...e){const t=f.useRef(void 0),n=f.useCallback(s=>{const r=e.map(i=>{if(i==null)return null;if(typeof i=="function"){const o=i,l=o(s);return typeof l=="function"?l:()=>{o(null)}}return i.current=s,()=>{i.current=null}});return()=>{r.forEach(i=>i?.())}},e);return f.useMemo(()=>e.every(s=>s==null)?null:s=>{t.current&&(t.current(),t.current=void 0),s!=null&&(t.current=n(s))},e)}function Ude(e){return typeof e=="string"}function sq(e,t,n){return e===void 0||Ude(e)?t:{...t,ownerState:{...t.ownerState,...n}}}function rq(e,t,n){return typeof e=="function"?e(t,n):e}function Bde(e,t=[]){if(e===void 0)return{};const n={};return Object.keys(e).filter(s=>s.match(/^on[A-Z]/)&&typeof e[s]=="function"&&!t.includes(s)).forEach(s=>{n[s]=e[s]}),n}function _$(e){if(e===void 0)return{};const t={};return Object.keys(e).filter(n=>!(n.match(/^on[A-Z]/)&&typeof e[n]=="function")).forEach(n=>{t[n]=e[n]}),t}function iq(e){const{getSlotProps:t,additionalProps:n,externalSlotProps:s,externalForwardedProps:r,className:i}=e;if(!t){const x=Rt(n?.className,i,r?.className,s?.className),b={...n?.style,...r?.style,...s?.style},j={...n,...r,...s};return x.length>0&&(j.className=x),Object.keys(b).length>0&&(j.style=b),{props:j,internalRef:void 0}}const o=Bde({...r,...s}),l=_$(s),c=_$(r),u=t(o),d=Rt(u?.className,n?.className,i,r?.className,s?.className),h={...u?.style,...n?.style,...r?.style,...s?.style},p={...u,...n,...c,...l};return d.length>0&&(p.className=d),Object.keys(h).length>0&&(p.style=h),{props:p,internalRef:u.ref}}function A$(e,t){const{className:n,elementType:s,ownerState:r,externalForwardedProps:i,internalForwardedProps:o,shouldForwardComponentProp:l=!1,...c}=t,{component:u,slots:d={[e]:void 0},slotProps:h={[e]:void 0},...p}=i,x=d[e]||s,b=rq(h[e],r),{props:{component:j,...y},internalRef:N}=iq({className:n,...c,externalForwardedProps:e==="root"?p:void 0,externalSlotProps:b}),w=Uo(N,b?.ref,t.ref),S=e==="root"?j||u:j,_=sq(x,{...e==="root"&&!u&&!d[e]&&o,...e!=="root"&&!d[e]&&o,...y,...S&&!l&&{as:S},...S&&l&&{component:S},ref:w},r);return[x,_]}function ya(e,t){if(e==null)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;n[s]=e[s]}return n}function gk(e,t){return gk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},gk(e,t)}function oq(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,gk(e,t)}const T$={disabled:!1},Mv=wt.createContext(null);var Hde=function(t){return t.scrollTop},Vg="unmounted",nu="exited",su="entering",gf="entered",pk="exiting",nc=(function(e){oq(t,e);function t(s,r){var i;i=e.call(this,s,r)||this;var o=r,l=o&&!o.isMounting?s.enter:s.appear,c;return i.appearStatus=null,s.in?l?(c=nu,i.appearStatus=su):c=gf:s.unmountOnExit||s.mountOnEnter?c=Vg:c=nu,i.state={status:c},i.nextCallback=null,i}t.getDerivedStateFromProps=function(r,i){var o=r.in;return o&&i.status===Vg?{status:nu}:null};var n=t.prototype;return n.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},n.componentDidUpdate=function(r){var i=null;if(r!==this.props){var o=this.state.status;this.props.in?o!==su&&o!==gf&&(i=su):(o===su||o===gf)&&(i=pk)}this.updateStatus(!1,i)},n.componentWillUnmount=function(){this.cancelNextCallback()},n.getTimeouts=function(){var r=this.props.timeout,i,o,l;return i=o=l=r,r!=null&&typeof r!="number"&&(i=r.exit,o=r.enter,l=r.appear!==void 0?r.appear:o),{exit:i,enter:o,appear:l}},n.updateStatus=function(r,i){if(r===void 0&&(r=!1),i!==null)if(this.cancelNextCallback(),i===su){if(this.props.unmountOnExit||this.props.mountOnEnter){var o=this.props.nodeRef?this.props.nodeRef.current:zy.findDOMNode(this);o&&Hde(o)}this.performEnter(r)}else this.performExit();else this.props.unmountOnExit&&this.state.status===nu&&this.setState({status:Vg})},n.performEnter=function(r){var i=this,o=this.props.enter,l=this.context?this.context.isMounting:r,c=this.props.nodeRef?[l]:[zy.findDOMNode(this),l],u=c[0],d=c[1],h=this.getTimeouts(),p=l?h.appear:h.enter;if(!r&&!o||T$.disabled){this.safeSetState({status:gf},function(){i.props.onEntered(u)});return}this.props.onEnter(u,d),this.safeSetState({status:su},function(){i.props.onEntering(u,d),i.onTransitionEnd(p,function(){i.safeSetState({status:gf},function(){i.props.onEntered(u,d)})})})},n.performExit=function(){var r=this,i=this.props.exit,o=this.getTimeouts(),l=this.props.nodeRef?void 0:zy.findDOMNode(this);if(!i||T$.disabled){this.safeSetState({status:nu},function(){r.props.onExited(l)});return}this.props.onExit(l),this.safeSetState({status:pk},function(){r.props.onExiting(l),r.onTransitionEnd(o.exit,function(){r.safeSetState({status:nu},function(){r.props.onExited(l)})})})},n.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},n.safeSetState=function(r,i){i=this.setNextCallback(i),this.setState(r,i)},n.setNextCallback=function(r){var i=this,o=!0;return this.nextCallback=function(l){o&&(o=!1,i.nextCallback=null,r(l))},this.nextCallback.cancel=function(){o=!1},this.nextCallback},n.onTransitionEnd=function(r,i){this.setNextCallback(i);var o=this.props.nodeRef?this.props.nodeRef.current:zy.findDOMNode(this),l=r==null&&!this.props.addEndListener;if(!o||l){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var c=this.props.nodeRef?[this.nextCallback]:[o,this.nextCallback],u=c[0],d=c[1];this.props.addEndListener(u,d)}r!=null&&setTimeout(this.nextCallback,r)},n.render=function(){var r=this.state.status;if(r===Vg)return null;var i=this.props,o=i.children;i.in,i.mountOnEnter,i.unmountOnExit,i.appear,i.enter,i.exit,i.timeout,i.addEndListener,i.onEnter,i.onEntering,i.onEntered,i.onExit,i.onExiting,i.onExited,i.nodeRef;var l=ya(i,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return wt.createElement(Mv.Provider,{value:null},typeof o=="function"?o(r,l):wt.cloneElement(wt.Children.only(o),l))},t})(wt.Component);nc.contextType=Mv;nc.propTypes={};function Jm(){}nc.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:Jm,onEntering:Jm,onEntered:Jm,onExit:Jm,onExiting:Jm,onExited:Jm};nc.UNMOUNTED=Vg;nc.EXITED=nu;nc.ENTERING=su;nc.ENTERED=gf;nc.EXITING=pk;function qde(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function VL(e,t){var n=function(i){return t&&f.isValidElement(i)?t(i):i},s=Object.create(null);return e&&f.Children.map(e,function(r){return r}).forEach(function(r){s[r.key]=n(r)}),s}function Gde(e,t){e=e||{},t=t||{};function n(d){return d in t?t[d]:e[d]}var s=Object.create(null),r=[];for(var i in e)i in t?r.length&&(s[i]=r,r=[]):r.push(i);var o,l={};for(var c in t){if(s[c])for(o=0;o<s[c].length;o++){var u=s[c][o];l[s[c][o]]=n(u)}l[c]=n(c)}for(o=0;o<r.length;o++)l[r[o]]=n(r[o]);return l}function bu(e,t,n){return n[t]!=null?n[t]:e.props[t]}function Wde(e,t){return VL(e.children,function(n){return f.cloneElement(n,{onExited:t.bind(null,n),in:!0,appear:bu(n,"appear",e),enter:bu(n,"enter",e),exit:bu(n,"exit",e)})})}function Vde(e,t,n){var s=VL(e.children),r=Gde(t,s);return Object.keys(r).forEach(function(i){var o=r[i];if(f.isValidElement(o)){var l=i in t,c=i in s,u=t[i],d=f.isValidElement(u)&&!u.props.in;c&&(!l||d)?r[i]=f.cloneElement(o,{onExited:n.bind(null,o),in:!0,exit:bu(o,"exit",e),enter:bu(o,"enter",e)}):!c&&l&&!d?r[i]=f.cloneElement(o,{in:!1}):c&&l&&f.isValidElement(u)&&(r[i]=f.cloneElement(o,{onExited:n.bind(null,o),in:u.props.in,exit:bu(o,"exit",e),enter:bu(o,"enter",e)}))}}),r}var Yde=Object.values||function(e){return Object.keys(e).map(function(t){return e[t]})},Qde={component:"div",childFactory:function(t){return t}},YL=(function(e){oq(t,e);function t(s,r){var i;i=e.call(this,s,r)||this;var o=i.handleExited.bind(qde(i));return i.state={contextValue:{isMounting:!0},handleExited:o,firstRender:!0},i}var n=t.prototype;return n.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},n.componentWillUnmount=function(){this.mounted=!1},t.getDerivedStateFromProps=function(r,i){var o=i.children,l=i.handleExited,c=i.firstRender;return{children:c?Wde(r,l):Vde(r,o,l),firstRender:!1}},n.handleExited=function(r,i){var o=VL(this.props.children);r.key in o||(r.props.onExited&&r.props.onExited(i),this.mounted&&this.setState(function(l){var c=Ze({},l.children);return delete c[r.key],{children:c}}))},n.render=function(){var r=this.props,i=r.component,o=r.childFactory,l=ya(r,["component","childFactory"]),c=this.state.contextValue,u=Yde(this.state.children).map(o);return delete l.appear,delete l.enter,delete l.exit,i===null?wt.createElement(Mv.Provider,{value:c},u):wt.createElement(Mv.Provider,{value:c},wt.createElement(i,l,u))},t})(wt.Component);YL.propTypes={};YL.defaultProps=Qde;function lq(e){return parseInt(f.version,10)>=19?e?.props?.ref||null:e?.ref||null}const Kde=e=>e.scrollTop;function k$(e,t){const{timeout:n,easing:s,style:r={}}=e;return{duration:r.transitionDuration??(typeof n=="number"?n:n[t.mode]||0),easing:r.transitionTimingFunction??(typeof s=="object"?s[t.mode]:s),delay:r.transitionDelay}}const Xde={entering:{opacity:1},entered:{opacity:1}},Zde=f.forwardRef(function(t,n){const s=Yo(),r={enter:s.transitions.duration.enteringScreen,exit:s.transitions.duration.leavingScreen},{addEndListener:i,appear:o=!0,children:l,easing:c,in:u,onEnter:d,onEntered:h,onEntering:p,onExit:x,onExited:b,onExiting:j,style:y,timeout:N=r,TransitionComponent:w=nc,...S}=t,_=f.useRef(null),T=Uo(_,lq(l),n),k=G=>$=>{if(G){const W=_.current;$===void 0?G(W):G(W,$)}},A=k(p),E=k((G,$)=>{Kde(G);const W=k$({style:y,timeout:N,easing:c},{mode:"enter"});G.style.webkitTransition=s.transitions.create("opacity",W),G.style.transition=s.transitions.create("opacity",W),d&&d(G,$)}),M=k(h),F=k(j),D=k(G=>{const $=k$({style:y,timeout:N,easing:c},{mode:"exit"});G.style.webkitTransition=s.transitions.create("opacity",$),G.style.transition=s.transitions.create("opacity",$),x&&x(G)}),P=k(b),B=G=>{i&&i(_.current,G)};return a.jsx(w,{appear:o,in:u,nodeRef:_,onEnter:E,onEntered:M,onEntering:A,onExit:D,onExited:P,onExiting:F,addEndListener:B,timeout:N,...S,children:(G,{ownerState:$,...W})=>f.cloneElement(l,{style:{opacity:0,visibility:G==="exited"&&!u?"hidden":void 0,...Xde[G],...y,...l.props.style},ref:T,...W})})});function Jde(e){return Kn("MuiBackdrop",e)}An("MuiBackdrop",["root","invisible"]);const eue=e=>{const{classes:t,invisible:n}=e;return Qn({root:["root",n&&"invisible"]},Jde,t)},tue=fa("div",{name:"MuiBackdrop",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.invisible&&t.invisible]}})({position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent",variants:[{props:{invisible:!0},style:{backgroundColor:"transparent"}}]}),aue=f.forwardRef(function(t,n){const s=Cd({props:t,name:"MuiBackdrop"}),{children:r,className:i,component:o="div",invisible:l=!1,open:c,components:u={},componentsProps:d={},slotProps:h={},slots:p={},TransitionComponent:x,transitionDuration:b,...j}=s,y={...s,component:o,invisible:l},N=eue(y),w={transition:x,root:u.Root,...p},S={...d,...h},_={component:o,slots:w,slotProps:S},[T,k]=A$("root",{elementType:tue,externalForwardedProps:_,className:Rt(N.root,i),ownerState:y}),[A,E]=A$("transition",{elementType:Zde,externalForwardedProps:_,ownerState:y});return a.jsx(A,{in:c,timeout:b,...j,...E,children:a.jsx(T,{"aria-hidden":!0,...k,classes:N,ref:n,children:r})})}),Uu=Zce;function nue(e){return typeof e.main=="string"}function sue(e,t=[]){if(!nue(e))return!1;for(const n of t)if(!e.hasOwnProperty(n)||typeof e[n]!="string")return!1;return!0}function Sp(e=[]){return([,t])=>t&&sue(t,e)}function rue(e){return Kn("MuiCircularProgress",e)}An("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","track","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);const Mi=44,xk=vx`
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
`,yk=vx`
  0% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: 0;
  }

  50% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -15px;
  }

  100% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: -126px;
  }
`,iue=typeof xk!="string"?BL`
        animation: ${xk} 1.4s linear infinite;
      `:null,oue=typeof yk!="string"?BL`
        animation: ${yk} 1.4s ease-in-out infinite;
      `:null,lue=e=>{const{classes:t,variant:n,color:s,disableShrink:r}=e,i={root:["root",n,`color${Va(s)}`],svg:["svg"],track:["track"],circle:["circle",`circle${Va(n)}`,r&&"circleDisableShrink"]};return Qn(i,rue,t)},cue=fa("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[n.variant],t[`color${Va(n.color)}`]]}})(Uu(({theme:e})=>({display:"inline-block",variants:[{props:{variant:"determinate"},style:{transition:e.transitions.create("transform")}},{props:{variant:"indeterminate"},style:iue||{animation:`${xk} 1.4s linear infinite`}},...Object.entries(e.palette).filter(Sp()).map(([t])=>({props:{color:t},style:{color:(e.vars||e).palette[t].main}}))]}))),due=fa("svg",{name:"MuiCircularProgress",slot:"Svg"})({display:"block"}),uue=fa("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.circle,t[`circle${Va(n.variant)}`],n.disableShrink&&t.circleDisableShrink]}})(Uu(({theme:e})=>({stroke:"currentColor",variants:[{props:{variant:"determinate"},style:{transition:e.transitions.create("stroke-dashoffset")}},{props:{variant:"indeterminate"},style:{strokeDasharray:"80px, 200px",strokeDashoffset:0}},{props:({ownerState:t})=>t.variant==="indeterminate"&&!t.disableShrink,style:oue||{animation:`${yk} 1.4s ease-in-out infinite`}}]}))),mue=fa("circle",{name:"MuiCircularProgress",slot:"Track"})(Uu(({theme:e})=>({stroke:"currentColor",opacity:(e.vars||e).palette.action.activatedOpacity}))),QL=f.forwardRef(function(t,n){const s=Cd({props:t,name:"MuiCircularProgress"}),{className:r,color:i="primary",disableShrink:o=!1,enableTrackSlot:l=!1,size:c=40,style:u,thickness:d=3.6,value:h=0,variant:p="indeterminate",...x}=s,b={...s,color:i,disableShrink:o,size:c,thickness:d,value:h,variant:p,enableTrackSlot:l},j=lue(b),y={},N={},w={};if(p==="determinate"){const S=2*Math.PI*((Mi-d)/2);y.strokeDasharray=S.toFixed(3),w["aria-valuenow"]=Math.round(h),y.strokeDashoffset=`${((100-h)/100*S).toFixed(3)}px`,N.transform="rotate(-90deg)"}return a.jsx(cue,{className:Rt(j.root,r),style:{width:c,height:c,...N,...u},ownerState:b,ref:n,role:"progressbar",...w,...x,children:a.jsxs(due,{className:j.svg,ownerState:b,viewBox:`${Mi/2} ${Mi/2} ${Mi} ${Mi}`,children:[l?a.jsx(mue,{className:j.track,ownerState:b,cx:Mi,cy:Mi,r:(Mi-d)/2,fill:"none",strokeWidth:d,"aria-hidden":"true"}):null,a.jsx(uue,{className:j.circle,style:y,ownerState:b,cx:Mi,cy:Mi,r:(Mi-d)/2,fill:"none",strokeWidth:d})]})})});function cq(e){return a.jsx(aue,{sx:t=>({color:"#fff",zIndex:t.zIndex.drawer+1}),open:e,children:a.jsx(QL,{color:"inherit"})})}var As={},Gy={},E$;function fue(){if(E$)return Gy;E$=1,Object.defineProperty(Gy,"__esModule",{value:!0});function e(t,n){return t.reduce((s,r)=>{const i=String(r[n]);return s[i]||(s[i]=[]),s[i].push(r),s},{})}return Gy.default=e,Gy}var Wy={},L$;function hue(){if(L$)return Wy;L$=1,Object.defineProperty(Wy,"__esModule",{value:!0});function e(t,n){return t.replace(/{([^{}]*)}/g,(s,r)=>{const i=n[r];return typeof i=="string"||typeof i=="number"?i.toString():s})}return Wy.default=e,Wy}var Vy={},D$;function gue(){if(D$)return Vy;D$=1,Object.defineProperty(Vy,"__esModule",{value:!0});const e=[{countryNameEn:"Andorra",countryNameLocal:"Andorra",countryCode:"AD",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"",tinName:"",officialLanguageCode:"ca",officialLanguageNameEn:"Catalan, Valencian",officialLanguageNameLocal:"Catal, Valenci",countryCallingCode:"376",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Afghanistan",countryNameLocal:"     ,   ",countryCode:"AF",currencyCode:"AFN",currencyNameEn:"Afghan afghani",tinType:"",tinName:"",officialLanguageCode:"fa",officialLanguageNameEn:"Persian",officialLanguageNameLocal:"",countryCallingCode:"93",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Antigua and Barbuda",countryNameLocal:"Antigua and Barbuda",countryCode:"AG",currencyCode:"XCD",currencyNameEn:"East Caribbean dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"1268",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Anguilla",countryNameLocal:"Anguilla",countryCode:"AI",currencyCode:"XCD",currencyNameEn:"East Caribbean dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"1264",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Albania",countryNameLocal:"Shqipria",countryCode:"AL",currencyCode:"ALL",currencyNameEn:"Albanian lek",tinType:"NIPT",tinName:"Numri i Identifikimit pr Personin e Tatueshm",officialLanguageCode:"sq",officialLanguageNameEn:"Albanian",officialLanguageNameLocal:"Shqip",countryCallingCode:"355",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Armenia",countryNameLocal:"",countryCode:"AM",currencyCode:"AMD",currencyNameEn:"Armenian dram",tinType:"",tinName:"",officialLanguageCode:"hy",officialLanguageNameEn:"Armenian",officialLanguageNameLocal:"",countryCallingCode:"374",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Angola",countryNameLocal:"Angola",countryCode:"AO",currencyCode:"AOA",currencyNameEn:"Angolan kwanza",tinType:"",tinName:"",officialLanguageCode:"pt",officialLanguageNameEn:"Portuguese",officialLanguageNameLocal:"Portugus",countryCallingCode:"244",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Antarctica",countryNameLocal:"Antarctica, Antrtico, Antarctique, ",countryCode:"AQ",currencyCode:"",currencyNameEn:"",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"672",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Argentina",countryNameLocal:"Argentina",countryCode:"AR",currencyCode:"ARS",currencyNameEn:"Argentine peso",tinType:"CUIT",tinName:"Cdigo nico de Identificacin Tributaria",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espaol",countryCallingCode:"54",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"American Samoa",countryNameLocal:"American Samoa",countryCode:"AS",currencyCode:"USD",currencyNameEn:"United States dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"1684",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Austria",countryNameLocal:"sterreich",countryCode:"AT",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"UID",tinName:"Umsatzsteuer-Identifikationsnummer",officialLanguageCode:"de",officialLanguageNameEn:"German",officialLanguageNameLocal:"Deutsch",countryCallingCode:"43",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Australia",countryNameLocal:"Australia",countryCode:"AU",currencyCode:"AUD",currencyNameEn:"Australian dollar",tinType:"ABN",tinName:"Australian Business Number",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"61",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Aruba",countryNameLocal:"Aruba",countryCode:"AW",currencyCode:"AWG",currencyNameEn:"Aruban florin",tinType:"",tinName:"",officialLanguageCode:"nl",officialLanguageNameEn:"Dutch, Flemish",officialLanguageNameLocal:"Nederlands, Vlaams",countryCallingCode:"297",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"land Islands",countryNameLocal:"land",countryCode:"AX",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"",tinName:"",officialLanguageCode:"sv",officialLanguageNameEn:"Swedish",officialLanguageNameLocal:"Svenska",countryCallingCode:"358",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Azerbaijan",countryNameLocal:"Azrbaycan",countryCode:"AZ",currencyCode:"AZN",currencyNameEn:"Azerbaijani manat",tinType:"",tinName:"",officialLanguageCode:"az",officialLanguageNameEn:"Azerbaijani",officialLanguageNameLocal:"azrbaycan dili",countryCallingCode:"994",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Bosnia and Herzegovina",countryNameLocal:"Bosna i Hercegovina",countryCode:"BA",currencyCode:"BAM",currencyNameEn:"Bosnia and Herzegovina convertible mark",tinType:"",tinName:"",officialLanguageCode:"bs",officialLanguageNameEn:"Bosnian",officialLanguageNameLocal:"bosanski jezik",countryCallingCode:"387",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Barbados",countryNameLocal:"Barbados",countryCode:"BB",currencyCode:"BBD",currencyNameEn:"Barbados dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"1246",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Bangladesh",countryNameLocal:" ",countryCode:"BD",currencyCode:"BDT",currencyNameEn:"Bangladeshi taka",tinType:"",tinName:"",officialLanguageCode:"bn",officialLanguageNameEn:"Bengali",officialLanguageNameLocal:"",countryCallingCode:"880",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Belgium",countryNameLocal:"Belgi, Belgique, Belgien",countryCode:"BE",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"n TVABTW-nr Mwst-nr",tinName:"BTW identificatienummer / Numro de TVA",officialLanguageCode:"nl",officialLanguageNameEn:"Dutch, Flemish",officialLanguageNameLocal:"Nederlands, Vlaams",countryCallingCode:"32",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Burkina Faso",countryNameLocal:"Burkina Faso",countryCode:"BF",currencyCode:"XOF",currencyNameEn:"CFA franc BCEAO",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"226",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Bulgaria",countryNameLocal:"",countryCode:"BG",currencyCode:"BGN",currencyNameEn:"Bulgarian lev",tinType:" ",tinName:"   ",officialLanguageCode:"bg",officialLanguageNameEn:"Bulgarian",officialLanguageNameLocal:" ",countryCallingCode:"359",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Bahrain",countryNameLocal:"",countryCode:"BH",currencyCode:"BHD",currencyNameEn:"Bahraini dinar",tinType:"",tinName:"",officialLanguageCode:"ar",officialLanguageNameEn:"Arabic",officialLanguageNameLocal:"",countryCallingCode:"973",areaCodes:[],region:"Arab States",flag:""},{countryNameEn:"Burundi",countryNameLocal:"Burundi",countryCode:"BI",currencyCode:"BIF",currencyNameEn:"Burundian franc",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"257",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Benin",countryNameLocal:"Bnin",countryCode:"BJ",currencyCode:"XOF",currencyNameEn:"CFA franc BCEAO",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"229",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Saint Barthlemy",countryNameLocal:"Saint-Barthlemy",countryCode:"BL",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"590",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Bermuda",countryNameLocal:"Bermuda",countryCode:"BM",currencyCode:"BMD",currencyNameEn:"Bermudian dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"1441",areaCodes:[],region:"North America",flag:""},{countryNameEn:"Brunei Darussalam",countryNameLocal:"Brunei Darussalam",countryCode:"BN",currencyCode:"BND",currencyNameEn:"Brunei dollar",tinType:"",tinName:"",officialLanguageCode:"ms",officialLanguageNameEn:"Malay",officialLanguageNameLocal:"Bahasa Melayu,  ",countryCallingCode:"673",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Bolivia (Plurinational State of)",countryNameLocal:"Bolivia, Bulibiya, Volvia, Wuliwya",countryCode:"BO",currencyCode:"BOP",currencyNameEn:"",tinType:"NIT",tinName:"Nmero de Identificacin Tributaria",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espaol",countryCallingCode:"591",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Bonaire, Sint Eustatius and Saba",countryNameLocal:"Caribisch Nederland",countryCode:"BQ",currencyCode:"USD",currencyNameEn:"United States dollar",tinType:"",tinName:"",officialLanguageCode:"nl",officialLanguageNameEn:"Dutch, Flemish",officialLanguageNameLocal:"Nederlands, Vlaams",countryCallingCode:"5997",areaCodes:[],region:"Unknown",flag:""},{countryNameEn:"Brazil",countryNameLocal:"Brasil",countryCode:"BR",currencyCode:"BRL",currencyNameEn:"Brazilian real",tinType:"CNPJ",tinName:"Cadastro Nacional de Pessoa Jurdica",officialLanguageCode:"pt",officialLanguageNameEn:"Portuguese",officialLanguageNameLocal:"Portugus",countryCallingCode:"55",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Bhutan",countryNameLocal:"",countryCode:"BT",currencyCode:"BTN",currencyNameEn:"Bhutanese ngultrum",tinType:"",tinName:"",officialLanguageCode:"dz",officialLanguageNameEn:"Dzongkha",officialLanguageNameLocal:"",countryCallingCode:"975",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Bouvet Island",countryNameLocal:"Bouvetya",countryCode:"BV",currencyCode:"NOK",currencyNameEn:"Norwegian krone",tinType:"",tinName:"",officialLanguageCode:"no",officialLanguageNameEn:"Norwegian",officialLanguageNameLocal:"Norsk",countryCallingCode:"47",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Botswana",countryNameLocal:"Botswana",countryCode:"BW",currencyCode:"BWP",currencyNameEn:"Botswana pula",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"267",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Belarus",countryNameLocal:"",countryCode:"BY",currencyCode:"BYR",currencyNameEn:"",tinType:" (UNP)",tinName:"  ",officialLanguageCode:"be",officialLanguageNameEn:"Belarusian",officialLanguageNameLocal:" ",countryCallingCode:"375",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Belize",countryNameLocal:"Belize",countryCode:"BZ",currencyCode:"BZD",currencyNameEn:"Belize dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"501",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Canada",countryNameLocal:"Canada",countryCode:"CA",currencyCode:"CAD",currencyNameEn:"Canadian dollar",tinType:"BN / NE",tinName:"Business Number",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"1",areaCodes:["403","587","780","825","236","250","604","672","778","204","431","506","709","782","902","226","249","289","343","365","416","437","519","548","613","647","705","807","905","367","418","438","450","514","579","581","819","873","306","639","867"],region:"North America",flag:""},{countryNameEn:"Switzerland",countryNameLocal:"Schweiz, Suisse, Svizzera, Svizra",countryCode:"CH",currencyCode:"CHF",currencyNameEn:"Swiss franc",tinType:"MWST/TVA/IVA",tinName:"Mehrwertsteuernummer",officialLanguageCode:"de",officialLanguageNameEn:"German",officialLanguageNameLocal:"Deutsch",countryCallingCode:"41",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Cte d'Ivoire",countryNameLocal:"Cte d'Ivoire",countryCode:"CI",currencyCode:"XOF",currencyNameEn:"CFA franc BCEAO",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"225",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Chile",countryNameLocal:"Chile",countryCode:"CL",currencyCode:"CLP",currencyNameEn:"Chilean peso",tinType:"RUT",tinName:"Rol nico Tributario",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espaol",countryCallingCode:"56",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Cameroon",countryNameLocal:"Cameroun, Cameroon",countryCode:"CM",currencyCode:"XAF",currencyNameEn:"CFA franc BEAC",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"237",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"China",countryNameLocal:"",countryCode:"CN",currencyCode:"CNY",currencyNameEn:"Renminbi (Chinese) yuan",tinType:"",tinName:"",officialLanguageCode:"zh-hans",officialLanguageNameEn:"",officialLanguageNameLocal:"",countryCallingCode:"86",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Colombia",countryNameLocal:"Colombia",countryCode:"CO",currencyCode:"COP",currencyNameEn:"Colombian peso",tinType:"NIT",tinName:"Nmero De Identificacin Tributaria",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espaol",countryCallingCode:"57",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Costa Rica",countryNameLocal:"Costa Rica",countryCode:"CR",currencyCode:"CRC",currencyNameEn:"Costa Rican colon",tinType:"",tinName:"Cdula Jurdica",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espaol",countryCallingCode:"506",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Cuba",countryNameLocal:"Cuba",countryCode:"CU",currencyCode:"CUC",currencyNameEn:"Cuban convertible peso",tinType:"",tinName:"",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espaol",countryCallingCode:"53",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Cabo Verde",countryNameLocal:"Cabo Verde",countryCode:"CV",currencyCode:"CVE",currencyNameEn:"Cape Verdean escudo",tinType:"",tinName:"",officialLanguageCode:"pt",officialLanguageNameEn:"Portuguese",officialLanguageNameLocal:"Portugus",countryCallingCode:"238",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Curaao",countryNameLocal:"Curaao",countryCode:"CW",currencyCode:"ANG",currencyNameEn:"Netherlands Antillean guilder",tinType:"",tinName:"",officialLanguageCode:"nl",officialLanguageNameEn:"Dutch, Flemish",officialLanguageNameLocal:"Nederlands, Vlaams",countryCallingCode:"599",areaCodes:[],region:"Unknown",flag:""},{countryNameEn:"Christmas Island",countryNameLocal:"Christmas Island",countryCode:"CX",currencyCode:"AUD",currencyNameEn:"Australian dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"61",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Cyprus",countryNameLocal:", Kibris",countryCode:"CY",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"",tinName:"  ...",officialLanguageCode:"el",officialLanguageNameEn:"Greek, Modern (1453-)",officialLanguageNameLocal:"",countryCallingCode:"357",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Germany",countryNameLocal:"Deutschland",countryCode:"DE",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"USt-IdNr.",tinName:"Umsatzsteuer-Identifikationsnummer",officialLanguageCode:"de",officialLanguageNameEn:"German",officialLanguageNameLocal:"Deutsch",countryCallingCode:"49",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Djibouti",countryNameLocal:"Djibouti, , Jabuuti, Gabuutih",countryCode:"DJ",currencyCode:"DJF",currencyNameEn:"Djiboutian franc",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"253",areaCodes:[],region:"Arab States",flag:""},{countryNameEn:"Denmark",countryNameLocal:"Danmark",countryCode:"DK",currencyCode:"DKK",currencyNameEn:"Danish krone",tinType:"CVR",tinName:"Momsregistreringsnummer",officialLanguageCode:"da",officialLanguageNameEn:"Danish",officialLanguageNameLocal:"dansk",countryCallingCode:"45",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Dominica",countryNameLocal:"Dominica",countryCode:"DM",currencyCode:"XCD",currencyNameEn:"East Caribbean dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"767",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Algeria",countryNameLocal:"",countryCode:"DZ",currencyCode:"DZD",currencyNameEn:"Algerian dinar",tinType:"",tinName:"",officialLanguageCode:"ar",officialLanguageNameEn:"Arabic",officialLanguageNameLocal:"",countryCallingCode:"213",areaCodes:[],region:"Arab States",flag:""},{countryNameEn:"Ecuador",countryNameLocal:"Ecuador",countryCode:"EC",currencyCode:"USD",currencyNameEn:"United States dollar",tinType:"RUC",tinName:"Nmero de Registro Unico de Contribuyentes",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espaol",countryCallingCode:"593",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Estonia",countryNameLocal:"Eesti",countryCode:"EE",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"KMKR",tinName:"Kibemaksukohustuslase number",officialLanguageCode:"et",officialLanguageNameEn:"Estonian",officialLanguageNameLocal:"eesti, eesti keel",countryCallingCode:"372",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Egypt",countryNameLocal:"",countryCode:"EG",currencyCode:"EGP",currencyNameEn:"Egyptian pound",tinType:"",tinName:"",officialLanguageCode:"ar",officialLanguageNameEn:"Arabic",officialLanguageNameLocal:"",countryCallingCode:"20",areaCodes:[],region:"Arab States",flag:""},{countryNameEn:"Western Sahara",countryNameLocal:"Sahara Occidental",countryCode:"EH",currencyCode:"MAD",currencyNameEn:"Moroccan dirham",tinType:"",tinName:"",officialLanguageCode:"ar",officialLanguageNameEn:"Arabic",officialLanguageNameLocal:"",countryCallingCode:"212",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Eritrea",countryNameLocal:", , Eritrea",countryCode:"ER",currencyCode:"ERN",currencyNameEn:"Eritrean nakfa",tinType:"",tinName:"",officialLanguageCode:"ti",officialLanguageNameEn:"Tigrinya",officialLanguageNameLocal:"",countryCallingCode:"291",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Spain",countryNameLocal:"Espaa",countryCode:"ES",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"NIF (CIF)",tinName:"Nmero de Identificacin Fiscal (formerly named Cdigo de Identificacin Fiscal)",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espaol",countryCallingCode:"34",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Ethiopia",countryNameLocal:", Itoophiyaa",countryCode:"ET",currencyCode:"ETB",currencyNameEn:"Ethiopian birr",tinType:"",tinName:"",officialLanguageCode:"am",officialLanguageNameEn:"Amharic",officialLanguageNameLocal:"",countryCallingCode:"251",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Finland",countryNameLocal:"Suomi",countryCode:"FI",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"ALV nro",tinName:"Arvonlisveronumero",officialLanguageCode:"fi",officialLanguageNameEn:"Finnish",officialLanguageNameLocal:"suomi, suomen kieli",countryCallingCode:"358",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Fiji",countryNameLocal:"Fiji",countryCode:"FJ",currencyCode:"FJD",currencyNameEn:"Fiji dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"679",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Micronesia (Federated States of)",countryNameLocal:"Micronesia",countryCode:"FM",currencyCode:"USD",currencyNameEn:"United States dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"691",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"France",countryNameLocal:"France",countryCode:"FR",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"n TVA",tinName:"Numro d'identification  la taxe sur la valeur ajoute / Numro de TVA intracommunautaire",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"33",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Gabon",countryNameLocal:"Gabon",countryCode:"GA",currencyCode:"XAF",currencyNameEn:"CFA franc BEAC",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"241",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Grenada",countryNameLocal:"Grenada",countryCode:"GD",currencyCode:"XCD",currencyNameEn:"East Caribbean dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"1473",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Georgia",countryNameLocal:"",countryCode:"GE",currencyCode:"GEL",currencyNameEn:"Georgian lari",tinType:"",tinName:"",officialLanguageCode:"ka",officialLanguageNameEn:"Georgian",officialLanguageNameLocal:"",countryCallingCode:"995",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"French Guiana",countryNameLocal:"Guyane franaise",countryCode:"GF",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"594",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Guernsey",countryNameLocal:"Guernsey",countryCode:"GG",currencyCode:"GBP",currencyNameEn:"Pound sterling",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"44",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Ghana",countryNameLocal:"Ghana",countryCode:"GH",currencyCode:"GHS",currencyNameEn:"Ghanaian cedi",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"233",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Gibraltar",countryNameLocal:"Gibraltar",countryCode:"GI",currencyCode:"GIP",currencyNameEn:"Gibraltar pound",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"350",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Greenland",countryNameLocal:"Kalaallit Nunaat, Grnland",countryCode:"GL",currencyCode:"DKK",currencyNameEn:"Danish krone",tinType:"",tinName:"",officialLanguageCode:"kl",officialLanguageNameEn:"Kalaallisut, Greenlandic",officialLanguageNameLocal:"kalaallisut, kalaallit oqaasii",countryCallingCode:"299",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Guinea",countryNameLocal:"Guine",countryCode:"GN",currencyCode:"GNF",currencyNameEn:"Guinean franc",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"224",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Guadeloupe",countryNameLocal:"Guadeloupe",countryCode:"GP",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"590",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Equatorial Guinea",countryNameLocal:"Guiena ecuatorial, Guine quatoriale, Guin Equatorial",countryCode:"GQ",currencyCode:"XAF",currencyNameEn:"CFA franc BEAC",tinType:"",tinName:"",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espaol",countryCallingCode:"240",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Greece",countryNameLocal:"",countryCode:"GR",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"",tinName:"",officialLanguageCode:"el",officialLanguageNameEn:"Greek, Modern (1453-)",officialLanguageNameLocal:"",countryCallingCode:"30",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"South Georgia and the South Sandwich Islands",countryNameLocal:"South Georgia and the South Sandwich Islands",countryCode:"GS",currencyCode:"",currencyNameEn:"",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"500",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Guatemala",countryNameLocal:"Guatemala",countryCode:"GT",currencyCode:"GTQ",currencyNameEn:"Guatemalan quetzal",tinType:"NIT",tinName:"Nmero de Identificacin Tributaria",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espaol",countryCallingCode:"502",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Guam",countryNameLocal:"Guam, Guhn",countryCode:"GU",currencyCode:"USD",currencyNameEn:"United States dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"1",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Guinea-Bissau",countryNameLocal:"Guin-Bissau",countryCode:"GW",currencyCode:"XOF",currencyNameEn:"CFA franc BCEAO",tinType:"",tinName:"",officialLanguageCode:"pt",officialLanguageNameEn:"Portuguese",officialLanguageNameLocal:"Portugus",countryCallingCode:"245",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Guyana",countryNameLocal:"Guyana",countryCode:"GY",currencyCode:"GYD",currencyNameEn:"Guyanese dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"592",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Hong Kong",countryNameLocal:", Hong Kong",countryCode:"HK",currencyCode:"HKD",currencyNameEn:"Hong Kong dollar",tinType:"",tinName:"",officialLanguageCode:"zh-hant",officialLanguageNameEn:"",officialLanguageNameLocal:"",countryCallingCode:"852",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Honduras",countryNameLocal:"Honduras",countryCode:"HN",currencyCode:"HNL",currencyNameEn:"Honduran lempira",tinType:"RTN",tinName:"Registro Tributario Nacional",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espaol",countryCallingCode:"504",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Croatia",countryNameLocal:"Hrvatska",countryCode:"HR",currencyCode:"HRK",currencyNameEn:"Croatian kuna",tinType:"PDV-ID; OIB",tinName:"PDV Id. Broj OIB",officialLanguageCode:"hr",officialLanguageNameEn:"Croatian",officialLanguageNameLocal:"hrvatski jezik",countryCallingCode:"385",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Haiti",countryNameLocal:"Hati, Ayiti",countryCode:"HT",currencyCode:"HTG",currencyNameEn:"Haitian gourde",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"509",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Hungary",countryNameLocal:"Magyarorszg",countryCode:"HU",currencyCode:"HUF",currencyNameEn:"Hungarian forint",tinType:"ANUM",tinName:"Kzssgi adszm",officialLanguageCode:"hu",officialLanguageNameEn:"Hungarian",officialLanguageNameLocal:"magyar",countryCallingCode:"36",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Indonesia",countryNameLocal:"Indonesia",countryCode:"ID",currencyCode:"IDR",currencyNameEn:"Indonesian rupiah",tinType:"NPWP",tinName:"Nomor Pokok Wajib Pajak",officialLanguageCode:"id",officialLanguageNameEn:"Indonesian",officialLanguageNameLocal:"Bahasa Indonesia",countryCallingCode:"62",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Ireland",countryNameLocal:"Ireland, ire",countryCode:"IE",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"VAT or CBL",tinName:"Value added tax identification no.",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"353",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Israel",countryNameLocal:"",countryCode:"IL",currencyCode:"ILS",currencyNameEn:"Israeli new shekel",tinType:"",tinName:`'   / "`,officialLanguageCode:"he",officialLanguageNameEn:"Hebrew",officialLanguageNameLocal:"",countryCallingCode:"972",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Isle of Man",countryNameLocal:"Isle of Man",countryCode:"IM",currencyCode:"GBP",currencyNameEn:"Pound sterling",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"44",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"India",countryNameLocal:", India",countryCode:"IN",currencyCode:"INR",currencyNameEn:"Indian rupee",tinType:"VAT TIN / CST TIN",tinName:"Value Added Tax - Taxpayer Identification Number / Central Sales Tax - Taxpayer Identification Number (In most states)Not applicable",officialLanguageCode:"hi",officialLanguageNameEn:"Hindi",officialLanguageNameLocal:", ",countryCallingCode:"91",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"British Indian Ocean Territories",countryNameLocal:"British Indian Ocean Territories",countryCode:"IO",currencyCode:"USD",currencyNameEn:"United States dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"246",areaCodes:[],region:"Indian Ocean",flag:""},{countryNameEn:"Iraq",countryNameLocal:", Iraq",countryCode:"IQ",currencyCode:"IQD",currencyNameEn:"Iraqi dinar",tinType:"",tinName:"",officialLanguageCode:"ar",officialLanguageNameEn:"Arabic",officialLanguageNameLocal:"",countryCallingCode:"964",areaCodes:[],region:"Arab States",flag:""},{countryNameEn:"Iran (Islamic Republic of)",countryNameLocal:"",countryCode:"IR",currencyCode:"IRR",currencyNameEn:"Iranian rial",tinType:"",tinName:"",officialLanguageCode:"fa",officialLanguageNameEn:"Persian",officialLanguageNameLocal:"",countryCallingCode:"98",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Iceland",countryNameLocal:"sland",countryCode:"IS",currencyCode:"ISK",currencyNameEn:"Icelandic krna",tinType:"VSK / VASK",tinName:"Virisaukaskattsnmer",officialLanguageCode:"is",officialLanguageNameEn:"Icelandic",officialLanguageNameLocal:"slenska",countryCallingCode:"354",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Italy",countryNameLocal:"Italia",countryCode:"IT",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"P.IVA",tinName:"Partita IVA(IVA = Imposta sul Valore Aggiunto)",officialLanguageCode:"it",officialLanguageNameEn:"Italian",officialLanguageNameLocal:"Italiano",countryCallingCode:"39",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Jersey",countryNameLocal:"Jersey",countryCode:"JE",currencyCode:"GBP",currencyNameEn:"Pound sterling",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"44",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Jamaica",countryNameLocal:"Jamaica",countryCode:"JM",currencyCode:"JMD",currencyNameEn:"Jamaican dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"876",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Jordan",countryNameLocal:"",countryCode:"JO",currencyCode:"JOD",currencyNameEn:"Jordanian dinar",tinType:"",tinName:"",officialLanguageCode:"ar",officialLanguageNameEn:"Arabic",officialLanguageNameLocal:"",countryCallingCode:"962",areaCodes:[],region:"Arab States",flag:""},{countryNameEn:"Japan",countryNameLocal:"",countryCode:"JP",currencyCode:"JPY",currencyNameEn:"Japanese yen",tinType:"",tinName:"",officialLanguageCode:"ja",officialLanguageNameEn:"Japanese",officialLanguageNameLocal:" ()",countryCallingCode:"81",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Kenya",countryNameLocal:"Kenya",countryCode:"KE",currencyCode:"KES",currencyNameEn:"Kenyan shilling",tinType:"",tinName:"",officialLanguageCode:"sw",officialLanguageNameEn:"Swahili",officialLanguageNameLocal:"Kiswahili",countryCallingCode:"254",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Kyrgyzstan",countryNameLocal:", ",countryCode:"KG",currencyCode:"KGS",currencyNameEn:"Kyrgyzstani som",tinType:"",tinName:"",officialLanguageCode:"ky",officialLanguageNameEn:"Kirghiz, Kyrgyz",officialLanguageNameLocal:",  ",countryCallingCode:"996",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Cambodia",countryNameLocal:"",countryCode:"KH",currencyCode:"KHR",currencyNameEn:"Cambodian riel",tinType:"",tinName:"",officialLanguageCode:"km",officialLanguageNameEn:"Central Khmer",officialLanguageNameLocal:", , ",countryCallingCode:"855",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"North Korea",countryNameLocal:"",countryCode:"KP",currencyCode:"KPW",currencyNameEn:"North Korean won",tinType:"",tinName:"",officialLanguageCode:"ko",officialLanguageNameEn:"Korean",officialLanguageNameLocal:"",countryCallingCode:"850",areaCodes:[],region:"Asia",flag:""},{countryNameEn:"South Korea",countryNameLocal:"",countryCode:"KR",currencyCode:"KRW",currencyNameEn:"South Korean won",tinType:"",tinName:"",officialLanguageCode:"ko",officialLanguageNameEn:"Korean",officialLanguageNameLocal:"",countryCallingCode:"82",areaCodes:[],region:"Asia",flag:""},{countryNameEn:"Kiribati",countryNameLocal:"Kiribati",countryCode:"KI",currencyCode:"AUD",currencyNameEn:"Australian dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"686",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Saint Kitts and Nevis",countryNameLocal:"Saint Kitts and Nevis",countryCode:"KN",currencyCode:"XCD",currencyNameEn:"East Caribbean dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"1869",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Kuwait",countryNameLocal:"",countryCode:"KW",currencyCode:"KWD",currencyNameEn:"Kuwaiti dinar",tinType:"",tinName:"",officialLanguageCode:"ar",officialLanguageNameEn:"Arabic",officialLanguageNameLocal:"",countryCallingCode:"965",areaCodes:[],region:"Arab States",flag:""},{countryNameEn:"Kazakhstan",countryNameLocal:", ",countryCode:"KZ",currencyCode:"KZT",currencyNameEn:"Kazakhstani tenge",tinType:"",tinName:"",officialLanguageCode:"kk",officialLanguageNameEn:"Kazakh",officialLanguageNameLocal:" ",countryCallingCode:"7",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Lebanon",countryNameLocal:", Liban",countryCode:"LB",currencyCode:"LBP",currencyNameEn:"Lebanese pound",tinType:"",tinName:"",officialLanguageCode:"ar",officialLanguageNameEn:"Arabic",officialLanguageNameLocal:"",countryCallingCode:"961",areaCodes:[],region:"Arab States",flag:""},{countryNameEn:"Saint Lucia",countryNameLocal:"Saint Lucia",countryCode:"LC",currencyCode:"XCD",currencyNameEn:"East Caribbean dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"1758",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Liechtenstein",countryNameLocal:"Liechtenstein",countryCode:"LI",currencyCode:"CHF",currencyNameEn:"Swiss franc",tinType:"",tinName:"",officialLanguageCode:"de",officialLanguageNameEn:"German",officialLanguageNameLocal:"Deutsch",countryCallingCode:"423",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Sri Lanka",countryNameLocal:" , ",countryCode:"LK",currencyCode:"LKR",currencyNameEn:"Sri Lankan rupee",tinType:"",tinName:"",officialLanguageCode:"si",officialLanguageNameEn:"Sinhala, Sinhalese",officialLanguageNameLocal:"",countryCallingCode:"94",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Liberia",countryNameLocal:"Liberia",countryCode:"LR",currencyCode:"LRD",currencyNameEn:"Liberian dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"231",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Lesotho",countryNameLocal:"Lesotho",countryCode:"LS",currencyCode:"LSL",currencyNameEn:"Lesotho loti",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"266",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Lithuania",countryNameLocal:"Lietuva",countryCode:"LT",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"PVM kodas",tinName:"PVM (abbrev. Pridtins verts mokestis) moktojo kodas",officialLanguageCode:"lt",officialLanguageNameEn:"Lithuanian",officialLanguageNameLocal:"lietuvi kalba",countryCallingCode:"370",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Luxembourg",countryNameLocal:"Ltzebuerg, Luxembourg, Luxemburg",countryCode:"LU",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"No. TVA",tinName:"Numro d'identification  la taxe sur la valeur ajoute",officialLanguageCode:"lb",officialLanguageNameEn:"Luxembourgish, Letzeburgesch",officialLanguageNameLocal:"Ltzebuergesch",countryCallingCode:"352",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Latvia",countryNameLocal:"Latvija",countryCode:"LV",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"PVN",tinName:"Pievienots vrtbas nodoka (PVN) reistrcijas numurs",officialLanguageCode:"lv",officialLanguageNameEn:"Latvian",officialLanguageNameLocal:"latvieu valoda",countryCallingCode:"371",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Libya",countryNameLocal:"",countryCode:"LY",currencyCode:"LYD",currencyNameEn:"Libyan dinar",tinType:"",tinName:"",officialLanguageCode:"ar",officialLanguageNameEn:"Arabic",officialLanguageNameLocal:"",countryCallingCode:"218",areaCodes:[],region:"Arab States",flag:""},{countryNameEn:"Morocco",countryNameLocal:"Maroc, , ",countryCode:"MA",currencyCode:"MAD",currencyNameEn:"Moroccan dirham",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"212",areaCodes:[],region:"Arab States",flag:""},{countryNameEn:"Monaco",countryNameLocal:"Monaco",countryCode:"MC",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"377",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Montenegro",countryNameLocal:"Crna Gora,  ",countryCode:"ME",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"",tinName:"",officialLanguageCode:"srp",officialLanguageNameEn:" ",officialLanguageNameLocal:"",countryCallingCode:"382",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Saint Martin (French part)",countryNameLocal:"Saint-Martin",countryCode:"MF",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"590",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Madagascar",countryNameLocal:"Madagasikara, Madagascar",countryCode:"MG",currencyCode:"MGA",currencyNameEn:"Malagasy ariary",tinType:"",tinName:"",officialLanguageCode:"mg",officialLanguageNameEn:"Malagasy",officialLanguageNameLocal:"fiteny malagasy",countryCallingCode:"261",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Mali",countryNameLocal:"Mali",countryCode:"ML",currencyCode:"XOF",currencyNameEn:"CFA franc BCEAO",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"223",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Myanmar",countryNameLocal:"",countryCode:"MM",currencyCode:"MMK",currencyNameEn:"Myanmar kyat",tinType:"",tinName:"",officialLanguageCode:"my",officialLanguageNameEn:"Burmese",officialLanguageNameLocal:"",countryCallingCode:"95",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Mongolia",countryNameLocal:" ",countryCode:"MN",currencyCode:"MNT",currencyNameEn:"Mongolian tgrg",tinType:"",tinName:"",officialLanguageCode:"mn",officialLanguageNameEn:"Mongolian",officialLanguageNameLocal:" ",countryCallingCode:"976",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Macao",countryNameLocal:", Macau",countryCode:"MO",currencyCode:"MOP",currencyNameEn:"Macanese pataca",tinType:"",tinName:"",officialLanguageCode:"zh-hant",officialLanguageNameEn:"",officialLanguageNameLocal:"",countryCallingCode:"853",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Martinique",countryNameLocal:"Martinique",countryCode:"MQ",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"596",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Mauritania",countryNameLocal:", Mauritanie",countryCode:"MR",currencyCode:"MRU",currencyNameEn:"",tinType:"",tinName:"",officialLanguageCode:"ar",officialLanguageNameEn:"Arabic",officialLanguageNameLocal:"",countryCallingCode:"222",areaCodes:[],region:"Arab States",flag:""},{countryNameEn:"Montserrat",countryNameLocal:"Montserrat",countryCode:"MS",currencyCode:"XCD",currencyNameEn:"East Caribbean dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"1664",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Malta",countryNameLocal:"Malta",countryCode:"MT",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"Vat No.",tinName:"Vat reg. no.",officialLanguageCode:"mt",officialLanguageNameEn:"Maltese",officialLanguageNameLocal:"Malti",countryCallingCode:"356",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Mauritius",countryNameLocal:"Maurice, Mauritius",countryCode:"MU",currencyCode:"MUR",currencyNameEn:"Mauritian rupee",tinType:"",tinName:"",officialLanguageCode:"mfe",officialLanguageNameEn:"",officialLanguageNameLocal:"",countryCallingCode:"230",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Maldives",countryNameLocal:"",countryCode:"MV",currencyCode:"MVR",currencyNameEn:"Maldivian rufiyaa",tinType:"",tinName:"",officialLanguageCode:"dv",officialLanguageNameEn:"Divehi, Dhivehi, Maldivian",officialLanguageNameLocal:"",countryCallingCode:"960",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Malawi",countryNameLocal:"Malawi",countryCode:"MW",currencyCode:"MWK",currencyNameEn:"Malawian kwacha",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"265",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Mexico",countryNameLocal:"Mxico",countryCode:"MX",currencyCode:"MXN",currencyNameEn:"Mexican peso",tinType:"RFC",tinName:"Registro Federal de Contribuyentes",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espaol",countryCallingCode:"52",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Malaysia",countryNameLocal:"",countryCode:"MY",currencyCode:"MYR",currencyNameEn:"Malaysian ringgit",tinType:"",tinName:"",officialLanguageCode:"ms",officialLanguageNameEn:"Malay",officialLanguageNameLocal:"Bahasa Melayu,  ",countryCallingCode:"60",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Mozambique",countryNameLocal:"Mozambique",countryCode:"MZ",currencyCode:"MZN",currencyNameEn:"Mozambican metical",tinType:"",tinName:"",officialLanguageCode:"pt",officialLanguageNameEn:"Portuguese",officialLanguageNameLocal:"Portugus",countryCallingCode:"258",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Namibia",countryNameLocal:"Namibia",countryCode:"NA",currencyCode:"NAD",currencyNameEn:"Namibian dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"264",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"New Caledonia",countryNameLocal:"Nouvelle-Caldonie",countryCode:"NC",currencyCode:"XPF",currencyNameEn:"CFP franc (franc Pacifique)",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"687",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Norfolk Island",countryNameLocal:"Norfolk Island",countryCode:"NF",currencyCode:"AUD",currencyNameEn:"Australian dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"672",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Nigeria",countryNameLocal:"Nigeria",countryCode:"NG",currencyCode:"NGN",currencyNameEn:"Nigerian naira",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"234",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Nicaragua",countryNameLocal:"Nicaragua",countryCode:"NI",currencyCode:"NIO",currencyNameEn:"Nicaraguan crdoba",tinType:"RUC",tinName:"Registro Unico de Contribuyentes",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espaol",countryCallingCode:"505",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Norway",countryNameLocal:"Norge, Noreg",countryCode:"NO",currencyCode:"NOK",currencyNameEn:"Norwegian krone",tinType:"Orgnr",tinName:"Organisasjonsnummer",officialLanguageCode:"nb",officialLanguageNameEn:"Norwegian Bokml",officialLanguageNameLocal:"Norsk Bokml",countryCallingCode:"47",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Nepal",countryNameLocal:"",countryCode:"NP",currencyCode:"NPR",currencyNameEn:"Nepalese rupee",tinType:"",tinName:"",officialLanguageCode:"ne",officialLanguageNameEn:"Nepali",officialLanguageNameLocal:"",countryCallingCode:"977",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Nauru",countryNameLocal:"Nauru",countryCode:"NR",currencyCode:"AUD",currencyNameEn:"Australian dollar",tinType:"",tinName:"",officialLanguageCode:"na",officialLanguageNameEn:"Nauru",officialLanguageNameLocal:"Dorerin Naoero",countryCallingCode:"674",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Niue",countryNameLocal:"Niue",countryCode:"NU",currencyCode:"NZD",currencyNameEn:"New Zealand dollar",tinType:"",tinName:"",officialLanguageCode:"niu",officialLanguageNameEn:"",officialLanguageNameLocal:"",countryCallingCode:"683",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"New Zealand",countryNameLocal:"New Zealand",countryCode:"NZ",currencyCode:"NZD",currencyNameEn:"New Zealand dollar",tinType:"NZBN",tinName:"NZ Business Number",officialLanguageCode:"mi",officialLanguageNameEn:"Maori",officialLanguageNameLocal:"te reo Mori",countryCallingCode:"64",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Oman",countryNameLocal:" ",countryCode:"OM",currencyCode:"OMR",currencyNameEn:"Omani rial",tinType:"",tinName:"",officialLanguageCode:"ar",officialLanguageNameEn:"Arabic",officialLanguageNameLocal:"",countryCallingCode:"968",areaCodes:[],region:"Arab States",flag:""},{countryNameEn:"Panama",countryNameLocal:"Panama",countryCode:"PA",currencyCode:"PAB",currencyNameEn:"Panamanian balboa",tinType:"RUC",tinName:"Registro Unico de Contribuyentes",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espaol",countryCallingCode:"507",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Peru",countryNameLocal:"Per",countryCode:"PE",currencyCode:"PEN",currencyNameEn:"Peruvian sol",tinType:"RUC",tinName:"Registro Unico de Contribuyentes",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espaol",countryCallingCode:"51",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"French Polynesia",countryNameLocal:"Polynsie franaise",countryCode:"PF",currencyCode:"XPF",currencyNameEn:"CFP franc (franc Pacifique)",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"689",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Papua New Guinea",countryNameLocal:"Papua New Guinea",countryCode:"PG",currencyCode:"PGK",currencyNameEn:"Papua New Guinean kina",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"675",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Pakistan",countryNameLocal:"",countryCode:"PK",currencyCode:"PKR",currencyNameEn:"Pakistani rupee",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"92",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Poland",countryNameLocal:"Polska",countryCode:"PL",currencyCode:"PLN",currencyNameEn:"Polish zoty",tinType:"NIP",tinName:"numer identyfikacji podatkowej",officialLanguageCode:"pl",officialLanguageNameEn:"Polish",officialLanguageNameLocal:"jzyk polski, polszczyzna",countryCallingCode:"48",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Saint Pierre and Miquelon",countryNameLocal:"Saint-Pierre-et-Miquelon",countryCode:"PM",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"508",areaCodes:[],region:"North America",flag:""},{countryNameEn:"Pitcairn",countryNameLocal:"Pitcairn",countryCode:"PN",currencyCode:"NZD",currencyNameEn:"New Zealand dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"64",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Puerto Rico",countryNameLocal:"Puerto Rico",countryCode:"PR",currencyCode:"USD",currencyNameEn:"United States dollar",tinType:"",tinName:"",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espaol",countryCallingCode:"1",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Palestine, State of",countryNameLocal:"Palestinian Territory",countryCode:"PS",currencyCode:"",currencyNameEn:"",tinType:"",tinName:"",officialLanguageCode:"ar",officialLanguageNameEn:"Arabic",officialLanguageNameLocal:"",countryCallingCode:"970",areaCodes:[],region:"Arab States",flag:""},{countryNameEn:"Portugal",countryNameLocal:"Portugal",countryCode:"PT",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"NIPC",tinName:"Nmero de Identificao de Pessoa Coletiva (NIPC)",officialLanguageCode:"pt",officialLanguageNameEn:"Portuguese",officialLanguageNameLocal:"Portugus",countryCallingCode:"351",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Palau",countryNameLocal:"Palau",countryCode:"PW",currencyCode:"USD",currencyNameEn:"United States dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"680",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Paraguay",countryNameLocal:"Paraguay",countryCode:"PY",currencyCode:"PYG",currencyNameEn:"Paraguayan guaran",tinType:"RUC",tinName:"Registro Unico de Contribuyentes",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espaol",countryCallingCode:"595",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Qatar",countryNameLocal:"",countryCode:"QA",currencyCode:"QAR",currencyNameEn:"Qatari riyal",tinType:"",tinName:"",officialLanguageCode:"ar",officialLanguageNameEn:"Arabic",officialLanguageNameLocal:"",countryCallingCode:"974",areaCodes:[],region:"Arab States",flag:""},{countryNameEn:"Runion",countryNameLocal:"La Runion",countryCode:"RE",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"262",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Romania",countryNameLocal:"Romnia",countryCode:"RO",currencyCode:"RON",currencyNameEn:"Romanian leu",tinType:"CIF",tinName:"Codul de identificare fiscal",officialLanguageCode:"ro",officialLanguageNameEn:"Romanian, Moldavian, Moldovan",officialLanguageNameLocal:"Romn",countryCallingCode:"40",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Serbia",countryNameLocal:"",countryCode:"RS",currencyCode:"RSD",currencyNameEn:"Serbian dinar",tinType:"PIB",tinName:"Poreski identifikacioni broj",officialLanguageCode:"sr",officialLanguageNameEn:"Serbian",officialLanguageNameLocal:" ",countryCallingCode:"381",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Russia",countryNameLocal:"",countryCode:"RU",currencyCode:"RUB",currencyNameEn:"Russian ruble",tinType:"",tinName:"  ",officialLanguageCode:"ru",officialLanguageNameEn:"Russian",officialLanguageNameLocal:"",countryCallingCode:"7",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Rwanda",countryNameLocal:"Rwanda",countryCode:"RW",currencyCode:"RWF",currencyNameEn:"Rwandan franc",tinType:"",tinName:"",officialLanguageCode:"rw",officialLanguageNameEn:"Kinyarwanda",officialLanguageNameLocal:"Ikinyarwanda",countryCallingCode:"250",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Saudi Arabia",countryNameLocal:"",countryCode:"SA",currencyCode:"SAR",currencyNameEn:"Saudi riyal",tinType:"",tinName:"",officialLanguageCode:"ar",officialLanguageNameEn:"Arabic",officialLanguageNameLocal:"",countryCallingCode:"966",areaCodes:[],region:"Arab States",flag:""},{countryNameEn:"Solomon Islands",countryNameLocal:"Solomon Islands",countryCode:"SB",currencyCode:"SBD",currencyNameEn:"Solomon Islands dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"677",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Seychelles",countryNameLocal:"Seychelles",countryCode:"SC",currencyCode:"SCR",currencyNameEn:"Seychelles rupee",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"248",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Sweden",countryNameLocal:"Sverige",countryCode:"SE",currencyCode:"SEK",currencyNameEn:"Swedish krona/kronor",tinType:"Momsnr.",tinName:"VAT-nummer",officialLanguageCode:"sv",officialLanguageNameEn:"Swedish",officialLanguageNameLocal:"Svenska",countryCallingCode:"46",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Singapore",countryNameLocal:"Singapore",countryCode:"SG",currencyCode:"SGD",currencyNameEn:"Singapore dollar",tinType:"",tinName:"",officialLanguageCode:"zh-hans",officialLanguageNameEn:"",officialLanguageNameLocal:"",countryCallingCode:"65",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Saint Helena, Ascension and Tristan da Cunha",countryNameLocal:"Saint Helena",countryCode:"SH",currencyCode:"SHP",currencyNameEn:"Saint Helena pound",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"290",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Slovenia",countryNameLocal:"Slovenija",countryCode:"SI",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"ID za DDV",tinName:"Davna tevilka",officialLanguageCode:"sl",officialLanguageNameEn:"Slovenian",officialLanguageNameLocal:"Slovenski Jezik, Slovenina",countryCallingCode:"386",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Svalbard and Jan Mayen",countryNameLocal:"Svalbard and Jan Mayen",countryCode:"SJ",currencyCode:"NOK",currencyNameEn:"Norwegian krone",tinType:"",tinName:"",officialLanguageCode:"no",officialLanguageNameEn:"Norwegian",officialLanguageNameLocal:"Norsk",countryCallingCode:"4779",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Slovakia",countryNameLocal:"Slovensko",countryCode:"SK",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"I DPH",tinName:"Identifikan slo pre da z pridanej hodnoty",officialLanguageCode:"sk",officialLanguageNameEn:"Slovak",officialLanguageNameLocal:"Slovenina, Slovensk Jazyk",countryCallingCode:"421",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Sierra Leone",countryNameLocal:"Sierra Leone",countryCode:"SL",currencyCode:"SLL",currencyNameEn:"Sierra Leonean leone",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"232",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Republic of San Marino",countryNameLocal:"Repubblica di San Marino",countryCode:"SM",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"C.O.E.",tinName:"Codice operatore economico",officialLanguageCode:"it",officialLanguageNameEn:"Italian",officialLanguageNameLocal:"Italiano",countryCallingCode:"378",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Senegal",countryNameLocal:"Sngal",countryCode:"SN",currencyCode:"XOF",currencyNameEn:"CFA franc BCEAO",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"221",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Somalia",countryNameLocal:"Somalia, ",countryCode:"SO",currencyCode:"SOS",currencyNameEn:"Somali shilling",tinType:"",tinName:"",officialLanguageCode:"so",officialLanguageNameEn:"Somali",officialLanguageNameLocal:"Soomaaliga, af Soomaali",countryCallingCode:"252",areaCodes:[],region:"Arab States",flag:""},{countryNameEn:"Suriname",countryNameLocal:"Suriname",countryCode:"SR",currencyCode:"SRD",currencyNameEn:"Surinamese dollar",tinType:"",tinName:"",officialLanguageCode:"nl",officialLanguageNameEn:"Dutch, Flemish",officialLanguageNameLocal:"Nederlands, Vlaams",countryCallingCode:"597",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"South Sudan",countryNameLocal:"South Sudan",countryCode:"SS",currencyCode:"SSP",currencyNameEn:"South Sudanese pound",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"211",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Sao Tome and Principe",countryNameLocal:"So Tom e Prncipe",countryCode:"ST",currencyCode:"STN",currencyNameEn:"",tinType:"",tinName:"",officialLanguageCode:"pt",officialLanguageNameEn:"Portuguese",officialLanguageNameLocal:"Portugus",countryCallingCode:"239",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"El Salvador",countryNameLocal:"El Salvador",countryCode:"SV",currencyCode:"SVC",currencyNameEn:"Salvadoran coln",tinType:"NIT",tinName:"Nmero de Identificacin Tributaria",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espaol",countryCallingCode:"503",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Sint Maarten (Dutch part)",countryNameLocal:"Sint Maarten",countryCode:"SX",currencyCode:"ANG",currencyNameEn:"Netherlands Antillean guilder",tinType:"",tinName:"",officialLanguageCode:"nl",officialLanguageNameEn:"Dutch, Flemish",officialLanguageNameLocal:"Nederlands, Vlaams",countryCallingCode:"1721",areaCodes:[],region:"Unknown",flag:""},{countryNameEn:"Syrian Arab Republic",countryNameLocal:", Sriyya",countryCode:"SY",currencyCode:"SYP",currencyNameEn:"Syrian pound",tinType:"",tinName:"",officialLanguageCode:"ar",officialLanguageNameEn:"Arabic",officialLanguageNameLocal:"",countryCallingCode:"963",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Chad",countryNameLocal:"Tchad, ",countryCode:"TD",currencyCode:"XAF",currencyNameEn:"CFA franc BEAC",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"235",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Togo",countryNameLocal:"Togo",countryCode:"TG",currencyCode:"XOF",currencyNameEn:"CFA franc BCEAO",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"228",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Thailand",countryNameLocal:"",countryCode:"TH",currencyCode:"THB",currencyNameEn:"Thai baht",tinType:"",tinName:"",officialLanguageCode:"th",officialLanguageNameEn:"Thai",officialLanguageNameLocal:"",countryCallingCode:"66",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Tajikistan",countryNameLocal:",",countryCode:"TJ",currencyCode:"TJS",currencyNameEn:"Tajikistani somoni",tinType:"",tinName:"",officialLanguageCode:"tg",officialLanguageNameEn:"Tajik",officialLanguageNameLocal:", toik, ",countryCallingCode:"992",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Tokelau",countryNameLocal:"Tokelau",countryCode:"TK",currencyCode:"NZD",currencyNameEn:"New Zealand dollar",tinType:"",tinName:"",officialLanguageCode:"tkl",officialLanguageNameEn:"",officialLanguageNameLocal:"",countryCallingCode:"690",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Timor-Leste",countryNameLocal:"Timor-Leste, Timor Lorosa'e",countryCode:"TL",currencyCode:"USD",currencyNameEn:"United States dollar",tinType:"",tinName:"",officialLanguageCode:"pt",officialLanguageNameEn:"Portuguese",officialLanguageNameLocal:"Portugus",countryCallingCode:"670",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Turkmenistan",countryNameLocal:"Trkmenistan",countryCode:"TM",currencyCode:"TMT",currencyNameEn:"Turkmenistan manat",tinType:"",tinName:"",officialLanguageCode:"tk",officialLanguageNameEn:"Turkmen",officialLanguageNameLocal:"Trkmen, ",countryCallingCode:"993",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Tunisia",countryNameLocal:", Tunisie",countryCode:"TN",currencyCode:"TND",currencyNameEn:"Tunisian dinar",tinType:"",tinName:"",officialLanguageCode:"ar",officialLanguageNameEn:"Arabic",officialLanguageNameLocal:"",countryCallingCode:"216",areaCodes:[],region:"Arab States",flag:""},{countryNameEn:"Tonga",countryNameLocal:"Tonga",countryCode:"TO",currencyCode:"TOP",currencyNameEn:"Tongan paanga",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"676",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Turkey",countryNameLocal:"Trkiye",countryCode:"TR",currencyCode:"TRY",currencyNameEn:"Turkish lira",tinType:"KDV",tinName:"Vergi Kimlik Numaras",officialLanguageCode:"tr",officialLanguageNameEn:"Turkish",officialLanguageNameLocal:"Trke",countryCallingCode:"90",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Trinidad and Tobago",countryNameLocal:"Trinidad and Tobago",countryCode:"TT",currencyCode:"TTD",currencyNameEn:"Trinidad and Tobago dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"868",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Tuvalu",countryNameLocal:"Tuvalu",countryCode:"TV",currencyCode:"AUD",currencyNameEn:"Australian dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"688",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"United Republic of Tanzania",countryNameLocal:"Tanzania",countryCode:"TZ",currencyCode:"TZS",currencyNameEn:"Tanzanian shilling",tinType:"",tinName:"",officialLanguageCode:"sw",officialLanguageNameEn:"Swahili",officialLanguageNameLocal:"Kiswahili",countryCallingCode:"255",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Ukraine",countryNameLocal:"",countryCode:"UA",currencyCode:"UAH",currencyNameEn:"Ukrainian hryvnia",tinType:"",tinName:"   ",officialLanguageCode:"uk",officialLanguageNameEn:"Ukrainian",officialLanguageNameLocal:"",countryCallingCode:"380",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Uganda",countryNameLocal:"Uganda",countryCode:"UG",currencyCode:"UGX",currencyNameEn:"Ugandan shilling",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"256",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"United States of America",countryNameLocal:"United States of America",countryCode:"US",currencyCode:"USD",currencyNameEn:"United States dollar",tinType:"EIN",tinName:"Tax Identification Number",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"1",areaCodes:[],region:"North America",flag:""},{countryNameEn:"Uruguay",countryNameLocal:"Uruguay",countryCode:"UY",currencyCode:"UYU",currencyNameEn:"Uruguayan peso",tinType:"RUT",tinName:"Registro nico Tributario",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espaol",countryCallingCode:"598",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Uzbekistan",countryNameLocal:"",countryCode:"UZ",currencyCode:"UZS",currencyNameEn:"Uzbekistan som",tinType:"",tinName:"   ",officialLanguageCode:"uz",officialLanguageNameEn:"Uzbek",officialLanguageNameLocal:"Ozbek, , ",countryCallingCode:"998",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Saint Vincent and the Grenadines",countryNameLocal:"Saint Vincent and the Grenadines",countryCode:"VC",currencyCode:"XCD",currencyNameEn:"East Caribbean dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"1784",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Venezuela (Bolivarian Republic of)",countryNameLocal:"Venezuela",countryCode:"VE",currencyCode:"VES",currencyNameEn:"",tinType:"RIF",tinName:"Registro de Informacion Fiscal",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espaol",countryCallingCode:"58",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Virgin Islands (British)",countryNameLocal:"British Virgin Islands",countryCode:"VG",currencyCode:"USD",currencyNameEn:"United States dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"1284",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Virgin Islands (U.S.)",countryNameLocal:"United States Virgin Islands",countryCode:"VI",currencyCode:"USD",currencyNameEn:"United States dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"1340",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Vietnam",countryNameLocal:"Vit Nam",countryCode:"VN",currencyCode:"VND",currencyNameEn:"Vietnamese ng",tinType:"",tinName:"",officialLanguageCode:"vi",officialLanguageNameEn:"Vietnamese",officialLanguageNameLocal:"Ting Vit",countryCallingCode:"84",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Vanuatu",countryNameLocal:"Vanuatu",countryCode:"VU",currencyCode:"VUV",currencyNameEn:"Vanuatu vatu",tinType:"",tinName:"",officialLanguageCode:"bi",officialLanguageNameEn:"Bislama",officialLanguageNameLocal:"Bislama",countryCallingCode:"678",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Wallis and Futuna",countryNameLocal:"Wallis-et-Futuna",countryCode:"WF",currencyCode:"XPF",currencyNameEn:"CFP franc (franc Pacifique)",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"681",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Samoa",countryNameLocal:"Samoa",countryCode:"WS",currencyCode:"WST",currencyNameEn:"Samoan tala",tinType:"",tinName:"",officialLanguageCode:"sm",officialLanguageNameEn:"Samoan",officialLanguageNameLocal:"gagana fa'a Samoa",countryCallingCode:"685",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Yemen",countryNameLocal:"",countryCode:"YE",currencyCode:"YER",currencyNameEn:"Yemeni rial",tinType:"",tinName:"",officialLanguageCode:"ar",officialLanguageNameEn:"Arabic",officialLanguageNameLocal:"",countryCallingCode:"967",areaCodes:[],region:"Arab States",flag:""},{countryNameEn:"Mayotte",countryNameLocal:"Mayotte",countryCode:"YT",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"262",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"South Africa",countryNameLocal:"South Africa",countryCode:"ZA",currencyCode:"ZAR",currencyNameEn:"South African rand",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"27",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Zambia",countryNameLocal:"Zambia",countryCode:"ZM",currencyCode:"ZMW",currencyNameEn:"Zambian kwacha",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"260",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Zimbabwe",countryNameLocal:"Zimbabwe",countryCode:"ZW",currencyCode:"ZWL",currencyNameEn:"Zimbabwean dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"263",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Eswatini",countryNameLocal:"Swaziland",countryCode:"SZ",currencyCode:"SZL",currencyNameEn:"Swazi lilangeni",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"268",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"North Macedonia",countryNameLocal:"",countryCode:"MK",currencyCode:"MKD",currencyNameEn:"Macedonian denar",tinType:"",tinName:"",officialLanguageCode:"mk",officialLanguageNameEn:"Macedonian",officialLanguageNameLocal:" ",countryCallingCode:"389",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Philippines",countryNameLocal:"Philippines",countryCode:"PH",currencyCode:"PHP",currencyNameEn:"Philippine peso",tinType:"TIN",tinName:"Tax Identification Number",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"63",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Netherlands",countryNameLocal:"Nederland",countryCode:"NL",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"Btw-nr.",tinName:"Btw-nummer",officialLanguageCode:"nl",officialLanguageNameEn:"Dutch, Flemish",officialLanguageNameLocal:"Nederlands, Vlaams",countryCallingCode:"31",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"United Arab Emirates",countryNameLocal:"   ",countryCode:"AE",currencyCode:"AED",currencyNameEn:"United Arab Emirates dirham",tinType:"",tinName:"",officialLanguageCode:"ar",officialLanguageNameEn:"Arabic",officialLanguageNameLocal:"",countryCallingCode:"971",areaCodes:[],region:"Arab States",flag:""},{countryNameEn:"Republic of Moldova",countryNameLocal:"Moldova, ",countryCode:"MD",currencyCode:"MDL",currencyNameEn:"Moldovan leu",tinType:"",tinName:"",officialLanguageCode:"ro",officialLanguageNameEn:"Romanian, Moldavian, Moldovan",officialLanguageNameLocal:"Romn",countryCallingCode:"373",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Gambia",countryNameLocal:"The Gambia",countryCode:"GM",currencyCode:"GMD",currencyNameEn:"Gambian dalasi",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"220",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Dominican Republic",countryNameLocal:"Repblica Dominicana",countryCode:"DO",currencyCode:"DOP",currencyNameEn:"Dominican peso",tinType:"RNC",tinName:"Registro Nacional del Contribuyente",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espaol",countryCallingCode:"1",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Sudan",countryNameLocal:"",countryCode:"SD",currencyCode:"SDG",currencyNameEn:"Sudanese pound",tinType:"",tinName:"",officialLanguageCode:"ar",officialLanguageNameEn:"Arabic",officialLanguageNameLocal:"",countryCallingCode:"249",areaCodes:[],region:"Arab States",flag:""},{countryNameEn:"Lao People's Democratic Republic",countryNameLocal:"",countryCode:"LA",currencyCode:"LAK",currencyNameEn:"Lao kip",tinType:"",tinName:"",officialLanguageCode:"lo",officialLanguageNameEn:"Lao",officialLanguageNameLocal:"",countryCallingCode:"856",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Taiwan, Province of China",countryNameLocal:"Taiwan",countryCode:"TW",currencyCode:"TWD",currencyNameEn:"New Taiwan dollar",tinType:"",tinName:"",officialLanguageCode:"zh-hant",officialLanguageNameEn:"",officialLanguageNameLocal:"",countryCallingCode:"886",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Republic of the Congo",countryNameLocal:"Rpublique du Congo",countryCode:"CG",currencyCode:"XAF",currencyNameEn:"CFA franc BEAC",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"242",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Czechia",countryNameLocal:"esk republika",countryCode:"CZ",currencyCode:"CZK",currencyNameEn:"Czech koruna",tinType:"DI",tinName:"Daov identifikan slo",officialLanguageCode:"cs",officialLanguageNameEn:"Czech",officialLanguageNameLocal:"etina",countryCallingCode:"420",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"United Kingdom",countryNameLocal:"Great Britain",countryCode:"GB",currencyCode:"GBP",currencyNameEn:"Pound sterling",tinType:"VAT Reg No",tinName:"Value added tax registration number",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"44",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Niger",countryNameLocal:"Niger",countryCode:"NE",currencyCode:"XOF",currencyNameEn:"CFA franc BCEAO",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"227",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Democratic Republic of the Congo",countryNameLocal:"Democratic Republic of the Congo",countryCode:"CD",currencyCode:"CDF",currencyNameEn:"Congolese franc",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"243",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Commonwealth of The Bahamas",countryNameLocal:"Commonwealth of The Bahamas",countryCode:"BS",currencyCode:"BSD",currencyNameEn:"Bahamian dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"1 242",areaCodes:[],region:"Caribbean",flag:""},{countryNameEn:"Cocos (Keeling) Islands",countryNameLocal:"Pulu Kokos (Keeling)",countryCode:"CC",currencyCode:"AUD",currencyNameEn:"Australian dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"61 891",areaCodes:[],region:"Australia",flag:""},{countryNameEn:"Central African Republic",countryNameLocal:"Rpublique centrafricaine",countryCode:"CF",currencyCode:"XAF",currencyNameEn:"Central African CFA",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"236",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Cook Islands",countryNameLocal:"Kki 'irani",countryCode:"CK",currencyCode:"NZD",currencyNameEn:"New Zealand dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"682",areaCodes:[],region:"South Pacific Ocean",flag:""},{countryNameEn:"Falkland Islands",countryNameLocal:"Falkland Islands",countryCode:"FK",currencyCode:"FKP",currencyNameEn:"Falklands pound",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"500",areaCodes:[],region:"South Atlantic Ocean",flag:""},{countryNameEn:"Faroe Islands",countryNameLocal:"Frerne",countryCode:"FO",currencyCode:"DKK",currencyNameEn:"Faroese krna",tinType:"",tinName:"",officialLanguageCode:"da",officialLanguageNameEn:"Danish",officialLanguageNameLocal:"dansk",countryCallingCode:"298",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Territory of Heard Island and McDonald Islands",countryNameLocal:"Territory of Heard Island and McDonald Islands",countryCode:"HM",currencyCode:"AUD",currencyNameEn:"Australian dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"672",areaCodes:[],region:"Indian Ocean",flag:""},{countryNameEn:"British Indian Ocean Territory",countryNameLocal:"British Indian Ocean Territory",countryCode:"IO",currencyCode:"USD",currencyNameEn:"United States Dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"246",areaCodes:[],region:"Indian Ocean",flag:""},{countryNameEn:"Comoros",countryNameLocal:"Umoja wa Komori",countryCode:"KM",currencyCode:"KMF",currencyNameEn:"Comorian franc",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"269",areaCodes:[],region:"Indian Ocean",flag:""},{countryNameEn:"Cayman Islands",countryNameLocal:"Cayman Islands",countryCode:"KY",currencyCode:"KYD",currencyNameEn:"Cayman Islands dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"1 345",areaCodes:[],region:"Caribbean Sea",flag:""},{countryNameEn:"Republic of the Marshall Islands",countryNameLocal:"Aolepn Aorkin aje",countryCode:"MH",currencyCode:"USD",currencyNameEn:"United States dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"692",areaCodes:[],region:"Pacific Ocean",flag:""},{countryNameEn:"Commonwealth of the Northern Mariana Islands",countryNameLocal:"Sankattan Siha Na Islas Marinas",countryCode:"MP",currencyCode:"USD",currencyNameEn:"United States dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"1 670",areaCodes:[],region:"Pacific Ocean",flag:""},{countryNameEn:"Turks and Caicos Islands",countryNameLocal:"Turks and Caicos Islands",countryCode:"TC",currencyCode:"USD",currencyNameEn:"United States dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"1 649",areaCodes:[],region:"Atlantic Ocean",flag:""},{countryNameEn:"French Southern and Antarctic Lands",countryNameLocal:"Terres australes et antarctiques franaises",countryCode:"TF",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"672",areaCodes:[],region:"Indian Ocean",flag:""},{countryNameEn:"United States Minor Outlying Islands",countryNameLocal:"United States Minor Outlying Islands",countryCode:"UM",currencyCode:"USD",currencyNameEn:"United States dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"1",areaCodes:[],region:"Pacific Ocean",flag:""},{countryNameEn:"Holy See",countryNameLocal:"Sancta Sedes",countryCode:"VA",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"",tinName:"",officialLanguageCode:"la",officialLanguageNameEn:"Latin",officialLanguageNameLocal:"lingua latna",countryCallingCode:"39",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Republic of Kosovo",countryNameLocal:"Republika e Kosovs",countryCode:"XK",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"",tinName:"",officialLanguageCode:"sq",officialLanguageNameEn:"Albanian",officialLanguageNameLocal:"Shqip",countryCallingCode:"383",region:"Europe",flag:""},{countryNameEn:"Netherlands Antilles",countryNameLocal:"Nederlandse Antillen",countryCode:"AN",currencyCode:"ANG",currencyNameEn:"Netherlands Antillean guilder",tinType:"",tinName:"",officialLanguageCode:"nl",officialLanguageNameEn:"Dutch, Flemish",officialLanguageNameLocal:"Nederlands, Vlaams",countryCallingCode:"599",region:"Europe",flag:""}];return Vy.default=e,Vy}var P$;function pue(){if(P$)return As;P$=1;var e=As&&As.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(As,"__esModule",{value:!0}),As.customList=As.customArray=As.findOne=As.filter=As.all=As.utils=void 0;const t=e(fue()),n=e(hue()),s=e(gue());As.utils={groupBy:t.default};function r(){return s.default}As.all=r;function i(u,d){return s.default.filter(h=>h[u]===d)}As.filter=i;function o(u,d){return s.default.find(h=>h[u]===d)}As.findOne=o;function l(u={name:"{countryNameEn} ({countryCode})",value:"{countryCode}"},{sortBy:d,sortDataBy:h,filter:p}={}){const x=[];let b=s.default;if(typeof p=="function"&&(b=b.filter(p)),h){const j=new Intl.Collator([],{sensitivity:"accent"});b.sort((y,N)=>j.compare(y[h],N[h]))}if(b.forEach(j=>{const y={};for(const N in u)y[N]=(0,n.default)(u[N],j);x.push(y)}),d&&u[d]){const j=new Intl.Collator([],{sensitivity:"accent"});x.sort((y,N)=>j.compare(y[d],N[d]))}return x}As.customArray=l;function c(u="countryCode",d="{countryNameEn} ({countryCode})",{filter:h}={}){const p={};let x=s.default;return typeof h=="function"&&(x=x.filter(h)),x.forEach(b=>{const j=(0,n.default)(d,b);p[String(b[u])]=j}),p}return As.customList=c,As}var oh=pue();const bk=(...e)=>e.flat().filter(Boolean).join(" "),xue=oh.all(),dq=xue.map(e=>({code:`+${e.countryCallingCode}`,name:e.countryCode})),vk=[{id:1,title:"Your Account",subtitle:"Personal & Login Details"},{id:2,title:"Company Setup",subtitle:"Business Information"}],yue=()=>{const e=Et();return a.jsxs("button",{onClick:()=>e("/"),className:"inline-flex items-center text-sm text-gray-500 hover:text-gray-700 transition cursor-pointer",children:[a.jsx(am,{className:"size-4 mr-1"})," Back to Home"]})},bue=f.memo(({label:e,id:t,placeholder:n,type:s="text",value:r,onChange:i,isVisible:o,onTogglePass:l,error:c,isSelect:u,options:d})=>{const h=t.toLowerCase().includes("password"),p=bk("w-full bg-gray-50 border px-4 py-2.5 rounded-lg text-gray-800 transition shadow-inner placeholder-gray-400 focus:outline-none cursor-pointer",h?"pr-10":"",c?"border-red-500 focus:border-red-500 focus:ring-2 focus:ring-red-500/50":"border-gray-200 focus:border-amber-500 focus:ring-2 focus:ring-amber-500/50");return a.jsxs("div",{className:"flex flex-col space-y-2",children:[a.jsx("label",{htmlFor:t,className:"text-sm font-medium text-gray-700 cursor-pointer",children:e}),a.jsxs("div",{className:"relative",children:[u?a.jsx("select",{id:t,value:r,onChange:i,required:!0,className:p,children:d.map(x=>a.jsx("option",{value:x,children:x},x))}):a.jsx("input",{id:t,type:h?"text":s,style:h&&!o?{WebkitTextSecurity:"disc"}:void 0,placeholder:n,value:r,onChange:i,required:!0,className:p}),h&&a.jsx("button",{type:"button",onClick:()=>l(t),className:"absolute inset-y-0 right-0 flex items-center pr-3 text-gray-700 hover:text-gray-900 focus:outline-none z-10 transition-colors cursor-pointer","aria-label":o?"Hide password":"Show password",children:o?a.jsx(Ru,{className:"size-5"}):a.jsx(md,{className:"size-5"})})]}),c&&a.jsx("p",{className:"mt-1 text-sm text-red-600 font-semibold",children:c})]})}),uu=bue,vue=f.memo(({currentStep:e,totalSteps:t})=>a.jsx("div",{className:"flex justify-between items-center mb-10 w-full max-w-xs mx-auto",children:vk.map(n=>a.jsxs(f.Fragment,{children:[a.jsxs("div",{className:"flex flex-col items-center cursor-pointer",children:[a.jsx("div",{className:bk("size-10 flex items-center justify-center rounded-full font-bold transition-all duration-300",n.id===e?"bg-amber-500 text-white shadow-lg":n.id<e?"bg-green-500 text-white":"bg-gray-100 text-gray-500 border-2 border-gray-300"),children:n.id<e?a.jsx(AL,{className:"size-5"}):n.id}),a.jsx("span",{className:bk("mt-2 text-xs font-medium hidden sm:block",n.id===e?"text-amber-600":"text-gray-500"),children:n.title})]}),n.id<t&&a.jsx("div",{className:"flex-1 h-0.5 mx-1 transition-colors duration-300 bg-gray-300"})]},n.id))})),wue=f.memo(({formData:e,handleChange:t,handleCodeChange:n,handleTogglePass:s,isPassVisible:r,formError:i,signupError:o,termsAccepted:l,handleTerms:c,isButtonDisabled:u,handleSubmit:d,handleGoogleLogin:h})=>a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center my-6",children:[a.jsx("div",{className:"flex-grow border-t border-gray-300"}),a.jsx("span",{className:"flex-shrink mx-4 text-sm text-gray-500",children:"OR"}),a.jsx("div",{className:"flex-grow border-t border-gray-300"})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"md:flex md:space-x-4 space-y-6 md:space-y-0",children:[a.jsx("div",{className:"md:w-1/2",children:a.jsx(uu,{label:"First Name",id:"first_name",placeholder:"John",value:e.first_name,onChange:t})}),a.jsx("div",{className:"md:w-1/2",children:a.jsx(uu,{label:"Last Name",id:"last_name",placeholder:"Doe",value:e.last_name,onChange:t})})]}),a.jsxs("div",{className:"flex flex-col space-y-2",children:[a.jsx("label",{htmlFor:"phoneNumber",className:"text-sm font-medium text-gray-700 cursor-pointer",children:"Contact Number"}),a.jsxs("div",{className:"flex space-x-2",children:[a.jsx("select",{id:"countryCode",value:e.countryCode,onChange:n,className:"flex-shrink-0 bg-gray-50 border border-gray-200 px-3 py-2.5 rounded-lg text-gray-800 transition shadow-inner focus:border-amber-500 focus:ring-2 focus:ring-amber-500/50 focus:outline-none cursor-pointer",children:dq.map(p=>a.jsxs("option",{value:p.code,children:[p.name," ",p.code]},p.code))}),a.jsx("input",{id:"phone_number",type:"tel",placeholder:"0000000000",maxLength:10,value:e.phone_number,onChange:t,className:"w-full bg-gray-50 border border-gray-200 px-4 py-2.5 rounded-lg text-gray-800 transition shadow-inner placeholder-gray-400 focus:border-amber-500 focus:ring-2 focus:ring-amber-500/50 focus:outline-none cursor-pointer"})]})]}),a.jsx(uu,{label:"Email Address",id:"email",type:"email",placeholder:"you@company.com",value:e.email,onChange:t}),a.jsx(uu,{label:"Password",id:"password",placeholder:"Min 8 characters",value:e.password,onChange:t,isVisible:r.password,onTogglePass:s}),a.jsx(uu,{label:"Confirm Password",id:"confirmPassword",placeholder:"Confirm your password",value:e.confirmPassword,onChange:t,isVisible:r.confirmPassword,onTogglePass:s,error:i}),o&&a.jsx("div",{className:"bg-red-100 border border-red-300 py-2 px-3 text-red-600",children:o}),a.jsxs("div",{className:"flex items-start pt-2",children:[a.jsx("input",{id:"terms",type:"checkbox",checked:l,onChange:c,className:"size-4 mt-1 rounded text-amber-500 border-gray-300 focus:ring-amber-500 cursor-pointer"}),a.jsxs("label",{htmlFor:"terms",className:"ml-3 text-sm font-medium text-gray-700 cursor-pointer",children:["I accept the ",a.jsx("a",{href:"#",className:"text-amber-600 hover:text-amber-700 font-semibold",children:"Terms"})," and ",a.jsx("a",{href:"#",className:"text-amber-600 hover:text-amber-700 font-semibold",children:"Policy"}),"."]})]})]}),i&&a.jsx("div",{className:"mt-4 p-3 text-sm rounded-lg bg-red-100 text-red-700 border border-red-300 font-medium animate-pulse",children:i}),a.jsx("button",{type:"submit",onClick:d,disabled:u,className:"w-full mt-8 inline-flex items-center justify-center rounded-lg h-12 px-6 text-white font-bold tracking-wide transition-all duration-300 bg-secondary hover:bg-tertiary shadow-lg shadow-tertiary disabled:shadow-none focus-visible:outline-none cursor-pointer",children:"Continue to Company Details"})]})),jue=f.memo(({companyData:e,handleCodeChange1:t,handleSubmit:n,handleCompanyChange:s,formError:r,isSubmitted:i,isButtonDisabled:o,setStep:l,setIsSubmitted:c,setFormError:u})=>a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"space-y-6",children:[a.jsx(uu,{label:"Company Name",id:"company_name",placeholder:"Acme Corp",value:e.company_name,onChange:s}),a.jsxs("div",{className:"flex flex-col space-y-2",children:[a.jsx("label",{htmlFor:"phoneNumber",className:"text-sm font-medium text-gray-700 cursor-pointer",children:"Company Number"}),a.jsxs("div",{className:"flex space-x-2",children:[a.jsx("select",{id:"countryCode",value:e.countryCode,onChange:t,className:"flex-shrink-0 bg-gray-50 border border-gray-200 px-3 py-2.5 rounded-lg text-gray-800 transition shadow-inner focus:border-amber-500 focus:ring-2 focus:ring-amber-500/50 focus:outline-none cursor-pointer",children:dq.map(d=>a.jsxs("option",{value:d.code,children:[d.name," ",d.code]},d.code))}),a.jsx("input",{id:"company_number",type:"tel",placeholder:"0000000000",maxLength:10,value:e.company_number,onChange:s,className:"w-full bg-gray-50 border border-gray-200 px-4 py-2.5 rounded-lg text-gray-800 transition shadow-inner placeholder-gray-400 focus:border-amber-500 focus:ring-2 focus:ring-amber-500/50 focus:outline-none cursor-pointer"})]})]}),a.jsx(uu,{label:"Company Website",id:"company_website",type:"url",placeholder:"https://www.acme.com",value:e.company_website,onChange:s})]}),r&&a.jsx("div",{className:"p-3 text-sm rounded-lg bg-red-100 text-red-700 border border-red-300 font-medium my-6",children:r}),i&&a.jsx("div",{className:"p-3 text-sm rounded-lg bg-green-100 text-green-700 border border-green-300 font-medium my-6",children:"Account and Company Setup simulated successfully! Welcome aboard."}),a.jsxs("div",{className:"flex space-x-4 mt-8",children:[a.jsxs("button",{type:"button",onClick:()=>{l(1),c(!1),u(null)},className:"flex-1 inline-flex items-center justify-center rounded-lg h-12 px-6 text-gray-700 font-bold tracking-wide border border-gray-300 bg-white hover:bg-tertiary hover:text-white transition-colors focus-visible:ring-2 focus-visible:ring-gray-300 focus-visible:outline-none cursor-pointer",children:[a.jsx(eoe,{className:"size-4 mr-2"})," Back"]}),a.jsx("button",{onClick:n,type:"submit",disabled:o,className:"flex-1 inline-flex items-center justify-center rounded-lg h-12 px-6 text-white font-bold tracking-wide transition-all duration-300 bg-tertiary hover:bg-accent hover:text-secondary shadow-xl shadow-amber-500/30 disabled:shadow-none focus-visible:ring-2 focus-visible:ring-amber-500/50 focus-visible:outline-none cursor-pointer",children:"Create Account"})]})]})),Nue=()=>{const e=["first_name","email","password"],t=["company_name","company_number","company_website"],[n,s]=f.useState(1),[r,i]=f.useState({first_name:"",last_name:"",countryCode:"+63",phone_number:"",email:"",password:"",confirmPassword:"",role:"CEO"}),[o,l]=f.useState({company_name:"",company_number:"",company_website:"",countryCode:"+63"}),[c,u]=f.useState({}),[d,h]=f.useState(!1),[p,x]=f.useState(null),[b,j]=f.useState(!1),{login:y}=Ks(),[N,w]=f.useState({plan_name:"Free",price:0}),[S,_]=f.useState(!1),[T,k]=f.useState(null);f.useEffect(()=>{document.title="Sign Up | Sari-Sari CRM"},[]),f.useEffect(()=>{const Q=()=>{window.google&&window.google.accounts?(window.google.accounts.id.initialize({client_id:"222789237297-r8mebl46fdacgpsnlnjca4eu0crn8hf6.apps.googleusercontent.com",callback:A}),window.google.accounts.id.renderButton(document.getElementById("googleSignupBtn"),{theme:"outline",size:"large",text:"signup_with"})):console.error("Google API not loaded properly.")};if(window.google&&window.google.accounts){Q();return}const le=document.createElement("script");le.src="https://accounts.google.com/gsi/client",le.async=!0,le.defer=!0,le.onload=Q,document.body.appendChild(le)},[]);const A=async Q=>{_(!0);try{const le=C9(Q.credential);console.log("Google user:",le);try{await ne.post("/auth/email-check",{email:le.email})}catch(we){const J=we.response?.data?.detail||"An error occurred.";k(J),_(!1);return}i(we=>({...we,email:le.email,first_name:le.given_name||"",last_name:le.family_name||"",password:"",profilePicture:le.picture||"",googleId:le.sub,auth_provider:"google",id_token:Q.credential})),s(2)}catch(le){console.error("Google signup error:",le),x("Failed to process Google account. Please try again.")}finally{k(null),x(null),_(!1)}},E=f.useCallback(Q=>{const{id:le,value:we}=Q.target;l(J=>({...J,[le]:we})),x(null)},[]),M=f.useCallback(Q=>{const{id:le,value:we}=Q.target;j(!1),i(J=>{const se={...J,[le]:we};if(n===1){let ye=null;if(le==="password"&&we.length>0&&we.length<8)ye="Password must be at least 8 characters.";else if(le==="password"||le==="confirmPassword"){const Ce=le==="password"?we:se.password,ge=le==="confirmPassword"?we:se.confirmPassword;Ce&&ge&&Ce!==ge&&(ye="Passwords don't match.")}x(ye)}return se})},[n]),F=f.useCallback(Q=>i(le=>({...le,countryCode:Q.target.value})),[]),D=f.useCallback(Q=>l(le=>({...le,countryCode:Q.target.value})),[]),P=f.useCallback(Q=>u(le=>({...le,[Q]:!le[Q]})),[]),B=f.useCallback(Q=>h(Q.target.checked),[]),G=async Q=>{if(Q.preventDefault(),j(!1),x(null),n===1){if(!e.every(we=>r[we].trim()!=="")||!d){x("Please fill in all required fields and accept the terms.");return}if(r.password!==r.confirmPassword){x("The passwords you entered do not match. Please try again.");return}if(r.password.length<8){x("Password must be at least 8 characters long.");return}if(r.auth_provider==="google"){s(2);return}try{(await ne.post("/auth/email-check",{email:r.email})).data.detail==="No existing email"&&(x(null),s(2))}catch(we){we.response&&we.response.data&&we.response.data.detail?x(we.response.data.detail):x("Something went wrong. Please try again.")}finally{_(!1)}}else if(n===2){if(!t.every(we=>(o[we]||"").trim()!=="")){x("Please fill in all required company details.");return}try{const{confirmPassword:we,...J}=r,se={...o,company_number:`${o.countryCode} ${o.company_number}`},Ce=(await ne.post("/company/create",se)).data.id,ge={...J,company_id:Ce,phone_number:`${J.countryCode} ${J.phone_number}`};if(console.log(" Sending payload:",ge),J.auth_provider==="google"){const be=await ne.post("/auth/google/signup",ge),me={...N,company_id:Ce,status:"Active"},Ae=await ne.post("/subscription/subscribe",me);x(null),j(!0),y(be.data)}else{const be=await ne.post("/auth/signup",ge),me={...N,company_id:Ce,status:"Active"},Ae=await ne.post("/subscription/subscribe",me);x(null),j(!0),y(be.data)}}catch(we){if(we.response?.data?.detail){const J=we.response.data.detail;if(Array.isArray(J)){const se=J.map(ye=>ye.msg).join(", ");x(se)}else x(typeof J=="object"?J.msg||JSON.stringify(J):J)}else x("Something went wrong. Please try again.")}finally{_(!1)}}},$=f.useCallback(()=>{try{window.google.accounts.id.initialize({client_id:"222789237297-r8mebl46fdacgpsnlnjca4eu0crn8hf6.apps.googleusercontent.com",callback:Q=>{const{credential:le}=Q;i(we=>({...we,first_name:le.given_name||"",last_name:le.family_name||"",email:le.email||"",profile_picture:le.picture||"",auth_provider:"google",id_token:le})),s(2)}}),window.google.accounts.id.prompt()}catch(Q){console.error("Google login error:",Q),x("Google login failed. Please try again.")}},[i,x,s]),W=f.useMemo(()=>{if(n===1){const Q=e.every(J=>(r[J]||"").trim()!==""),le=r.password.length>=8,we=r.password===r.confirmPassword;return!d||!!p||!Q||!le||!we}return n===2?!t.every(le=>(o[le]||"").trim()!=="")||!!p:!1},[n,d,p,r,o]),Z=vk.find(Q=>Q.id===n);return a.jsxs("div",{className:"min-h-screen w-full bg-gray-100 font-sans text-gray-800 flex flex-col items-center",children:[a.jsx("div",{className:"w-full py-6 px-4 sm:px-12 lg:px-20 max-w-7xl",children:a.jsxs("div",{className:"flex items-center text-gray-800",children:[a.jsx(sa,{className:"size-6 text-amber-500 mr-2"}),a.jsx("span",{className:"text-xl font-extrabold tracking-wider",children:"CRM"})]})}),S&&a.jsx(cq,{isLoading:S}),a.jsx("div",{className:"w-full max-w-lg px-4 pt-6",children:a.jsx(yue,{})}),a.jsx("main",{className:"w-full max-w-lg font-inter mx-auto px-4 pt-3 pb-12",children:a.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl shadow-xl p-6 md:p-10",children:[a.jsxs("header",{className:"text-center mb-8",children:[a.jsx("h1",{className:"text-3xl font-extrabold text-gray-900 tracking-tight",children:Z.title}),a.jsx("p",{className:"text-sm text-gray-500 mt-2 max-w-sm mx-auto",children:Z.subtitle})]}),a.jsx(vue,{currentStep:n,totalSteps:vk.length}),n===1&&a.jsx("div",{id:"googleSignupBtn"}),a.jsxs("form",{className:"mt-8",children:[n===1&&a.jsx(wue,{formData:r,handleChange:M,handleCodeChange:F,handleTogglePass:P,isPassVisible:c,formError:p,signupError:T,termsAccepted:d,handleTerms:B,isButtonDisabled:W,handleSubmit:G,handleGoogleLogin:$}),n===2&&a.jsx(jue,{handleSubmit:G,companyData:o,handleCompanyChange:E,formError:p,isSubmitted:b,isButtonDisabled:W,setStep:s,setIsSubmitted:j,setFormError:x,handleCodeChange1:D}),n===1&&a.jsx("div",{className:"text-center mt-6",children:a.jsxs("p",{className:"text-sm text-gray-700",children:["Already have an account?",a.jsx("a",{href:"/login",className:"font-bold text-amber-600 hover:text-amber-700 ml-1 cursor-pointer",children:"Log in"})]})})]})]})})]})},Cue=()=>{const e=Et();return a.jsxs("button",{onClick:()=>e("/"),className:"inline-flex items-center text-sm text-gray-500 hover:text-gray-700 transition mb-3 cursor-pointer",children:[a.jsx(am,{className:"size-4 mr-1"})," Back to Home"]})},O$=({label:e,id:t,placeholder:n,type:s="text",value:r,onChange:i,isPassVisible:o,onTogglePass:l})=>{const c=t.toLowerCase().includes("password");return a.jsxs("div",{className:"flex flex-col space-y-2",children:[a.jsx("label",{htmlFor:t,className:"text-sm font-medium text-gray-700",children:e}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{id:t,type:c?"text":s,style:c&&!o?{WebkitTextSecurity:"disc"}:void 0,placeholder:n,value:r,onChange:i,required:!0,className:"w-full bg-gray-50 border border-gray-200 px-4 py-2.5 rounded-lg text-gray-800 transition shadow-inner placeholder-gray-400 focus:border-amber-500 focus:ring-2 focus:ring-amber-500/50 focus:outline-none cursor-pointer"}),c&&a.jsx("button",{type:"button",onClick:l,className:"absolute inset-y-0 right-0 flex items-center pr-3 text-gray-700 hover:text-gray-900 focus:outline-none z-10 transition-colors cursor-pointer","aria-label":o?"Hide password":"Show password",children:o?a.jsx(Ru,{className:"size-5"}):a.jsx(md,{className:"size-5"})})]})]})},Sue=()=>{const[e,t]=f.useState({email:"",password:""}),[n,s]=f.useState(!1),[r,i]=f.useState(null),[o,l]=f.useState(!1),{isLoggedIn:c,login:u,userRole:d}=Ks(),h=Et();f.useEffect(()=>{document.title="Login | Sari-Sari CRM"},[]),f.useEffect(()=>{c&&(d==="Admin"?h("/super-admin/dashboard"):d==="CEO"?h("/admin/dashboard"):d==="Group Manager"?h("/group-manager"):d==="Manager"?h("/manager"):d==="Marketing"?h("/marketing"):d==="Sales"&&h("/sales"))},[c,h,d]);const p=j=>{const{id:y,value:N}=j.target;t(w=>({...w,[y]:N}))},x=async j=>{j.preventDefault(),i(null);try{const y=await ne.post("/auth/login",e);u(y.data),i(null)}catch(y){y.response&&y.response.data&&y.response.data.detail?i(y.response.data.detail):i("Something went wrong. Please try again.")}};f.useEffect(()=>{const j=document.createElement("script");return j.src="https://accounts.google.com/gsi/client",j.async=!0,j.defer=!0,j.onload=()=>{window.google&&(window.google.accounts.id.initialize({client_id:"222789237297-r8mebl46fdacgpsnlnjca4eu0crn8hf6.apps.googleusercontent.com",callback:b}),window.google.accounts.id.renderButton(document.getElementById("googleLoginBtn"),{theme:"outline",size:"large",text:"signin_with"}))},document.body.appendChild(j),()=>{document.body.contains(j)&&document.body.removeChild(j)}},[]);const b=async j=>{l(!0);try{const y=C9(j.credential),N=await ne.post("/auth/google/login",{id_token:j.credential});u(N.data)}catch(y){console.error("Google login failed:",y);const N=y.response?.data?.detail||"Google login failed. Please try again.";i(N)}finally{l(!1)}};return a.jsxs("div",{className:"min-h-screen w-full bg-gray-100 font-sans text-gray-800 flex flex-col items-center",children:[a.jsx("div",{className:"w-full py-6 px-4 sm:px-12 lg:px-20 max-w-7xl",children:a.jsx("div",{className:"flex items-center text-gray-800",children:a.jsx("span",{className:"text-xl font-extrabold tracking-wider",children:"CRM"})})}),o&&a.jsx(cq,{isLoading:o}),a.jsxs("main",{className:"w-full max-w-lg font-inter mx-auto px-4 pt-6 pb-12",children:[a.jsx(Cue,{}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl shadow-xl p-6 md:p-10",children:[a.jsxs("header",{className:"text-center mb-6",children:[a.jsx("h1",{className:"text-3xl font-extrabold text-gray-900 tracking-tight",children:"Login"}),a.jsx("p",{className:"text-sm text-gray-500 mt-2 max-w-sm mx-auto",children:"Sign in to access your dashboard."})]}),a.jsx("div",{id:"googleLoginBtn"}),a.jsxs("div",{className:"flex items-center my-6",children:[a.jsx("div",{className:"flex-grow border-t border-gray-300"}),a.jsx("span",{className:"flex-shrink mx-4 text-sm text-gray-500",children:"OR"}),a.jsx("div",{className:"flex-grow border-t border-gray-300"})]}),a.jsxs("form",{onSubmit:x,className:"space-y-6 cursor-pointer",children:[a.jsx(O$,{label:"Email",id:"email",type:"email",placeholder:"you@example.com",value:e.email,onChange:p}),a.jsx(O$,{label:"Password",id:"password",type:"password",placeholder:"Enter your password",value:e.password,onChange:p,isPassVisible:n,onTogglePass:()=>s(j=>!j)}),r&&a.jsx("div",{className:"bg-red-100 border border-red-300 py-2 px-3 text-red-600",children:r}),a.jsx("button",{type:"submit",className:"w-full mt-2 inline-flex items-center justify-center rounded-lg h-12 px-6 text-white font-bold tracking-wide transition-all disabled:opacity-50 bg-secondary text-gray-900 hover:bg-tertiary shadow-xl focus-visible:ring-2 focus-visible:ring-amber-500/50 cursor-pointer",children:"Log In"}),a.jsx("div",{className:"text-center mt-1",children:a.jsx("a",{href:"/forgot-password",className:"text-sm font-medium text-amber-600 hover:text-amber-700 cursor-pointer",children:"Forgot Password?"})})]}),a.jsx("div",{className:"text-center mt-6",children:a.jsxs("p",{className:"text-sm text-gray-700",children:["Don't have an account?",a.jsx("a",{href:"/signup",className:"font-bold text-amber-600 hover:text-amber-700 ml-1 cursor-pointer",children:"Sign Up"})]})})]})]})]})},_ue=({onClick:e})=>a.jsxs("button",{onClick:e,className:"inline-flex items-center text-sm text-gray-500 hover:text-gray-700 transition mb-3 cursor-pointer",children:[a.jsx(am,{className:"size-4 mr-1"})," Back"]}),p2=({label:e,id:t,placeholder:n,type:s="text",value:r,onChange:i,icon:o})=>{const[l,c]=f.useState(!1),u=s==="password";return a.jsxs("div",{className:"flex flex-col space-y-2",children:[a.jsx("label",{htmlFor:t,className:"text-sm font-medium text-gray-700",children:e}),a.jsxs("div",{className:"relative flex items-center",children:[o&&a.jsx(o,{className:"absolute left-3 text-gray-500 size-5"}),a.jsx("input",{id:t,type:u?"text":s,style:u&&!l?{WebkitTextSecurity:"disc"}:void 0,placeholder:n,value:r,onChange:i,required:!0,className:"w-full bg-gray-50 border border-gray-200 pl-10 pr-10 py-2.5 rounded-lg text-gray-800 transition shadow-inner placeholder-gray-400 focus:border-amber-500 focus:ring-2 focus:ring-amber-500/50 focus:outline-none cursor-pointer"}),u&&a.jsx("button",{type:"button",onClick:()=>c(d=>!d),className:"absolute right-3 text-gray-500",children:l?a.jsx(Ru,{className:"size-5"}):a.jsx(md,{className:"size-5"})})]})]})},Aue=({otp:e,setOtp:t})=>a.jsx("div",{className:"flex justify-between gap-2",children:[...Array(6)].map((n,s)=>a.jsx("input",{type:"text",maxLength:"1",className:"w-12 h-12 text-center text-lg font-bold border border-gray-300 rounded-lg focus:border-amber-500 focus:ring-2 focus:ring-amber-500/50",value:e[s]||"",onChange:r=>{const i=r.target.value;if(/\d/.test(i)||i===""){const o=[...e];o[s]=i,t(o)}}},s))}),Tue=()=>{const e=Et(),[t,n]=f.useState(1),[s,r]=f.useState(""),[i,o]=f.useState(["","","","","",""]),[l,c]=f.useState(""),[u,d]=f.useState(""),h=j=>{j.preventDefault(),n(2)},p=j=>{j.preventDefault(),n(3)},x=j=>{if(j.preventDefault(),l!==u){alert("Passwords do not match!");return}alert("Password reset successfully!")},b=()=>{t>1?n(t-1):e("/login")};return a.jsxs("div",{className:"min-h-screen w-full bg-gray-100 font-sans text-gray-800 flex flex-col items-center",children:[a.jsx("div",{className:"w-full py-6 px-4 sm:px-12 lg:px-20 max-w-7xl",children:a.jsx("div",{className:"flex items-center text-gray-800",children:a.jsx("span",{className:"text-xl font-extrabold tracking-wider",children:"CRM"})})}),a.jsxs("main",{className:"w-full max-w-lg font-inter mx-auto px-4 pt-6 pb-12",children:[a.jsx(_ue,{onClick:b}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl shadow-xl p-6 md:p-10",children:[t===1&&a.jsxs(a.Fragment,{children:[a.jsxs("header",{className:"text-center mb-6",children:[a.jsx("h1",{className:"text-3xl font-extrabold text-gray-900 tracking-tight",children:"Forgot Password"}),a.jsx("p",{className:"text-sm text-gray-500 mt-2 max-w-sm mx-auto",children:"Enter your email and we'll send you a verification code."})]}),a.jsxs("form",{onSubmit:h,className:"space-y-6 cursor-pointer",children:[a.jsx(p2,{label:"Email Address",id:"email",type:"email",placeholder:"you@example.com",value:s,onChange:j=>r(j.target.value),icon:sn}),a.jsx("button",{className:"w-full mt-3 inline-flex items-center justify-center rounded-lg h-12 px-6 text-white font-bold tracking-wide transition-all bg-secondary text-gray-900 hover:bg-tertiary shadow-xl",children:"Send OTP"})]})]}),t===2&&a.jsxs(a.Fragment,{children:[a.jsxs("header",{className:"text-center mb-6",children:[a.jsx("h1",{className:"text-3xl font-extrabold text-gray-900 tracking-tight",children:"Enter Verification Code"}),a.jsxs("p",{className:"text-sm text-gray-500 mt-2 max-w-sm mx-auto",children:["We've sent a 6-digit code to ",a.jsx("strong",{children:s}),"."]})]}),a.jsxs("form",{onSubmit:p,className:"space-y-6",children:[a.jsx(Aue,{otp:i,setOtp:o}),a.jsx("button",{className:"w-full mt-3 inline-flex items-center justify-center rounded-lg h-12 px-6 text-white font-bold tracking-wide transition-all bg-secondary text-gray-900 hover:bg-tertiary shadow-xl",children:"Verify Code"})]})]}),t===3&&a.jsxs(a.Fragment,{children:[a.jsxs("header",{className:"text-center mb-6",children:[a.jsx("h1",{className:"text-3xl font-extrabold text-gray-900 tracking-tight",children:"Reset Password"}),a.jsx("p",{className:"text-sm text-gray-500 mt-2 max-w-sm mx-auto",children:"Enter your new password below."})]}),a.jsxs("form",{onSubmit:x,className:"space-y-6",children:[a.jsx(p2,{label:"New Password",id:"password",type:"password",placeholder:"Enter new password",value:l,onChange:j=>c(j.target.value),icon:Do}),a.jsx(p2,{label:"Confirm Password",id:"confirm-password",type:"password",placeholder:"Confirm new password",value:u,onChange:j=>d(j.target.value),icon:Do}),a.jsx("button",{className:"w-full mt-3 inline-flex items-center justify-center rounded-lg h-12 px-6 text-white font-bold tracking-wide transition-all bg-secondary text-gray-900 hover:bg-tertiary shadow-xl",children:"Reset Password"})]})]})]})]})]})},Gt=()=>{const{user:e,isLoggedIn:t,loading:n,fetchUser:s,mutate:r,logout:i}=Gie();return{user:e,isLoggedIn:t,loading:n,fetchUser:s,mutate:r,logout:i}};function qt({message:e="Loading..."}){return a.jsx("div",{className:"absolute inset-0 bg-primary/90 flex items-center justify-center z-40 lg:flex hidden",children:a.jsxs("div",{className:"flex items-center justify-center gap-1.5",children:[a.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-bounce",style:{animationDelay:"0ms",animationDuration:"0.6s"}}),a.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-bounce",style:{animationDelay:"150ms",animationDuration:"0.6s"}}),a.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-bounce",style:{animationDelay:"300ms",animationDuration:"0.6s"}})]})})}const kue=(e,t)=>{const n=e?.trim()?.[0]??"",s=t?.trim()?.[0]??"";return`${n}${s}`.toUpperCase()||"U"};function Yy(){const{user:e,loading:t,fetchUser:n}=Gt(),[s,r]=f.useState(!1),[i,o]=f.useState(!1),[l,c]=f.useState(!1),[u,d]=f.useState(!1),[h,p]=f.useState(!1),[x,b]=f.useState(!1),[j,y]=f.useState(!1),[N,w]=f.useState(!1),[S,_]=f.useState(null),[T,k]=f.useState(null),A=f.useRef(null),[E,M]=f.useState({firstName:"",lastName:"",email:"",phoneNumber:""}),[F,D]=f.useState({currentPassword:"",newPassword:"",confirmPassword:""});f.useEffect(()=>{e&&(M({firstName:e.first_name||"",lastName:e.last_name||"",email:e.email||"",phoneNumber:e.phone_number||""}),k(e.profile_picture||null))},[e]),f.useEffect(()=>{document.title="Manage Account | Sari-Sari CRM"},[]);const P=(Z,Q)=>{M(le=>({...le,[Z]:Q}))},B=(Z,Q)=>{D(le=>({...le,[Z]:Q}))},G=Z=>{const Q=Z.target.files?.[0];if(!Q)return;if(!Q.type.startsWith("image/")){V.error("Please select an image file");return}if(Q.size>5*1024*1024){V.error("Image size should be less than 5MB");return}const le=new FileReader;le.onloadend=()=>{_(le.result),k(le.result)},le.readAsDataURL(Q)},$=async Z=>{if(Z.preventDefault(),!E.firstName.trim()||!E.lastName.trim()){V.warn("Please fill in all required fields.");return}o(!0);try{const Q={first_name:E.firstName.trim(),last_name:E.lastName.trim(),phone_number:E.phoneNumber.trim()||null};S!==null&&(Q.profile_picture=S),await ne.put("/users/me",Q),await n(),c(!1),_(null),window.dispatchEvent(new CustomEvent("userProfileUpdated")),V.success("Account information updated successfully!")}catch(Q){console.error("Error updating account:",Q);const le=Q.response?.data?.detail||"Failed to update account information. Please try again.";V.error(le)}finally{o(!1)}},W=async Z=>{if(Z.preventDefault(),!F.newPassword||!F.confirmPassword){V.warn("Please fill in all password fields.");return}if(F.newPassword.length<8){V.warn("Password must be at least 8 characters long.");return}if(F.newPassword!==F.confirmPassword){V.warn("New password and confirm password do not match.");return}w(!0);try{const Q={password:F.newPassword};await ne.put("/users/me",Q),await n(),D({currentPassword:"",newPassword:"",confirmPassword:""}),window.dispatchEvent(new CustomEvent("userProfileUpdated")),w(!1),V.success("Password changed successfully!")}catch(Q){console.error("Error changing password:",Q);const le=Q.response?.data?.detail||"Failed to change password. Please try again.";V.error(le)}finally{w(!1)}};return a.jsxs("div",{className:"p-2 lg:p-8 font-inter relative",children:[(t||!e)&&a.jsx(qt,{}),e&&a.jsxs("div",{children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("h1",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 mb-2",children:"Manage Your Profile"}),a.jsx("p",{className:"text-gray-600 text-sm sm:text-base",children:"Update your account information and change your password"})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm p-6 mb-6",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h2",{className:"text-xl font-semibold text-gray-800 flex items-center gap-2",children:[a.jsx(ra,{className:"text-blue-600"}),"Profile Information"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:!l&&a.jsxs("button",{onClick:()=>c(!0),className:"flex items-center gap-2 px-4 py-2 bg-gray-900 text-white rounded-md hover:bg-gray-800 transition text-sm",children:[a.jsx(hn,{}),"Edit Profile"]})})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-4 mb-6 pb-6 border-b border-gray-200",children:[a.jsxs("div",{className:"flex-shrink-0 relative group",children:[T?a.jsx("div",{className:"relative",children:a.jsx("img",{src:T,alt:`${e.first_name} ${e.last_name}`,className:"w-20 h-20 sm:w-24 sm:h-24 rounded-full object-cover border-2 border-gray-200 shadow-sm"})}):a.jsx("div",{className:"w-20 h-20 sm:w-24 sm:h-24 rounded-full bg-gradient-to-br from-blue-500 to-indigo-600 text-white flex items-center justify-center text-2xl sm:text-3xl font-semibold border-2 border-gray-200 shadow-sm",children:kue(e.first_name,e.last_name)}),l&&a.jsxs("div",{className:"absolute bottom-0 right-0",children:[a.jsx("input",{type:"file",ref:A,accept:"image/*",onChange:G,className:"hidden",id:"profile-picture-upload"}),a.jsx("label",{htmlFor:"profile-picture-upload",className:"cursor-pointer bg-gray-900 text-white p-1.5 rounded-full shadow-lg hover:bg-gray-800 transition flex items-center justify-center border-2 border-white",title:"Change profile picture",children:a.jsx(v9,{size:14})})]})]}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-800",children:[e.first_name," ",e.last_name]}),a.jsx("p",{className:"text-gray-600 text-sm",children:e.email}),a.jsx("span",{className:"inline-block mt-2 px-3 py-1 bg-blue-100 text-blue-700 text-xs font-semibold rounded-md",children:e.role})]})]}),l?a.jsxs("form",{onSubmit:$,className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-2 text-sm",children:["First Name ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("div",{className:"relative",children:[a.jsx(ra,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),a.jsx("input",{type:"text",value:E.firstName,onChange:Z=>P("firstName",Z.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none",required:!0})]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-2 text-sm",children:["Last Name ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("div",{className:"relative",children:[a.jsx(ra,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),a.jsx("input",{type:"text",value:E.lastName,onChange:Z=>P("lastName",Z.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none",required:!0})]})]}),a.jsxs("div",{className:"sm:col-span-2",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-2 text-sm",children:"Email"}),a.jsxs("div",{className:"relative",children:[a.jsx(sn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),a.jsx("input",{type:"email",value:E.email,disabled:!0,className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md bg-gray-100 text-gray-600 cursor-not-allowed outline-none",readOnly:!0})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Email cannot be changed"})]}),a.jsxs("div",{className:"sm:col-span-2",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-2 text-sm",children:"Phone Number"}),a.jsxs("div",{className:"relative",children:[a.jsx(It,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),a.jsx("input",{type:"tel",value:E.phoneNumber,onChange:Z=>P("phoneNumber",Z.target.value),placeholder:"+1 (555) 123-4567",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none"})]})]})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-3 pt-4 border-t border-gray-200",children:[a.jsx("button",{type:"button",onClick:()=>{c(!1),M({firstName:e.first_name||"",lastName:e.last_name||"",email:e.email||"",phoneNumber:e.phone_number||""}),_(null),k(e.profile_picture||null),A.current&&(A.current.value="")},className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition",disabled:i,children:"Cancel"}),a.jsxs("button",{type:"submit",className:"flex items-center justify-center gap-2 px-4 py-2 bg-gray-900 text-white rounded-md hover:bg-gray-800 transition disabled:opacity-70",disabled:i,children:[a.jsx(kL,{}),i?"Saving...":"Save Changes"]})]})]}):a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"First Name"}),a.jsx("p",{className:"text-gray-800 font-medium",children:e.first_name||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Last Name"}),a.jsx("p",{className:"text-gray-800 font-medium",children:e.last_name||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Email"}),a.jsx("p",{className:"text-gray-800 font-medium",children:e.email||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Phone Number"}),a.jsx("p",{className:"text-gray-800 font-medium",children:e.phone_number||"N/A"})]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm p-6",children:[a.jsxs("h2",{className:"text-xl font-semibold text-gray-800 flex items-center gap-2 mb-6 justify-center lg:justify-start",children:[a.jsx(Do,{className:"text-blue-600"}),"Change Password"]}),a.jsxs("form",{onSubmit:W,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-2 text-sm",children:["New Password ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("div",{className:"relative",children:[a.jsx(Do,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),a.jsx("input",{type:"text",style:x?void 0:{WebkitTextSecurity:"disc"},value:F.newPassword,onChange:Z=>B("newPassword",Z.target.value),placeholder:"Enter new password (min. 8 characters)",className:"w-full pl-10 pr-10 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none",required:!0,minLength:8}),a.jsx("button",{type:"button",onClick:()=>b(Z=>!Z),className:"absolute inset-y-0 right-0 flex items-center pr-3 text-gray-700 hover:text-gray-900 focus:outline-none z-10 transition-colors cursor-pointer","aria-label":x?"Hide password":"Show password",children:x?a.jsx(Ru,{className:"size-5"}):a.jsx(md,{className:"size-5"})})]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-2 text-sm",children:["Confirm New Password ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("div",{className:"relative",children:[a.jsx(Do,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),a.jsx("input",{type:"text",style:j?void 0:{WebkitTextSecurity:"disc"},value:F.confirmPassword,onChange:Z=>B("confirmPassword",Z.target.value),placeholder:"Confirm new password",className:"w-full pl-10 pr-10 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none",required:!0,minLength:8}),a.jsx("button",{type:"button",onClick:()=>y(Z=>!Z),className:"absolute inset-y-0 right-0 flex items-center pr-3 text-gray-700 hover:text-gray-900 focus:outline-none z-10 transition-colors cursor-pointer","aria-label":j?"Hide password":"Show password",children:j?a.jsx(Ru,{className:"size-5"}):a.jsx(md,{className:"size-5"})})]})]}),a.jsx("div",{className:"pt-4 border-t border-gray-200 flex justify-center lg:justify-start",children:a.jsxs("button",{type:"submit",className:"flex items-center justify-center gap-2 px-4 py-2 bg-gray-900 text-white rounded-md hover:bg-gray-800 transition disabled:opacity-70",disabled:N,children:[a.jsx(Do,{}),N?"Changing Password...":"Change Password"]})})]})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm p-6 mt-6",children:[a.jsxs("h2",{className:"text-xl font-semibold text-gray-800 flex items-center gap-2 mb-6 justify-center lg:justify-start",children:[a.jsx(j9,{className:"text-blue-600"}),"Account Information"]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Role"}),a.jsx("span",{className:"inline-block px-3 py-1 bg-blue-100 text-blue-700 text-sm font-semibold rounded-md",children:e.role})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Status"}),a.jsx("span",{className:`inline-block px-3 py-1 text-sm font-semibold rounded-md ${e.is_active?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:e.is_active?"Active":"Inactive"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Company"}),a.jsx("p",{className:"text-gray-800 font-medium",children:e.company?.company_name||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Auth Provider"}),a.jsx("p",{className:"text-gray-800 font-medium",children:e.auth_provider?e.auth_provider.charAt(0).toUpperCase()+e.auth_provider.slice(1):"N/A"})]}),e.created_at&&a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Account Created"}),a.jsx("p",{className:"text-gray-800 font-medium",children:new Date(e.created_at).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]}),e.last_login&&a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Last Login"}),a.jsx("p",{className:"text-gray-800 font-medium",children:new Date(e.last_login).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"})})]})]})]})]})]})}const Eue=({isOpen:e,onClose:t})=>{if(!e)return null;const n=[{number:"1",title:"Enterprise Security Commitment",content:["Sari-Sari CRM maintains a security-first architecture designed to protect business data, preserve system integrity, and support continuous operational reliability. Security controls are implemented across administrative, technical, and operational layers to reduce risk and safeguard organizational information."]},{number:"2",title:"Access Governance",content:["The platform enforces strict role-based access controls to ensure that only authorized organizational users can access CRM records, including leads, contacts, accounts, deals, quotes, and scheduling information. Permission boundaries are applied according to user roles and operational responsibilities.","Internal and developer access is tightly restricted, monitored, and permitted only for essential system maintenance under controlled conditions."]},{number:"3",title:"Data Protection Controls",content:["Security measures are designed to:",` Protect confidentiality of business records
 Prevent unauthorized access or disclosure
 Preserve data integrity
 Maintain availability of services`,"Safeguards are reviewed periodically and updated to address evolving threats and operational needs."]},{number:"4",title:"Operational Security",content:["We maintain structured incident management, monitoring, and maintenance processes to support secure system performance. Security events are prioritized and addressed using defined response procedures."]},{number:"5",title:"Shared Responsibility",content:["Organizations are responsible for maintaining secure credential practices, enforcing internal access policies, and promptly reporting suspected security concerns."]},{number:"6",title:"Technical Security Framework",content:["Sari-Sari CRM employs layered security controls aligned with industry best practices to protect data and platform operations."]},{number:"7",title:"Access & Authentication",content:[` Role-based authorization controls
 Credential protection mechanisms
 Session management safeguards`]},{number:"8",title:"Data Protection",content:[` Controlled access to stored business records
 Logical isolation of organizational data
 Integrity protections to prevent unauthorized modification`,"Developer access to production environments is restricted, logged, and limited to operational necessity."]},{number:"9",title:"System Security Measures",content:[` Monitoring for abnormal system behavior
 Controlled maintenance workflows
 Incident response procedures
 Secure update and deployment processes`]},{number:"10",title:"Security Lifecycle",content:["Security practices are continuously evaluated and refined to maintain resilience against emerging risks."]}];return a.jsx("div",{className:"fixed inset-0 bg-black/40 bg-opacity-40 z-50 flex items-center justify-center p-4",onClick:t,children:a.jsxs("div",{className:"bg-white rounded-lg max-w-5xl w-full max-h-[90vh] overflow-hidden",onClick:s=>s.stopPropagation(),children:[a.jsxs("div",{className:"sticky top-0 bg-secondary text-white px-8 py-6 flex items-center justify-between border-b border-accent",children:[a.jsx("div",{children:a.jsx("h2",{className:"text-3xl font-bold",children:"Security Guidelines"})}),a.jsx("button",{onClick:t,className:"text-white hover:text-accent transition-colors text-4xl leading-none",children:""})]}),a.jsxs("div",{className:"overflow-y-auto max-h-[calc(90vh-120px)] px-8 py-6 scrollbar-hide",children:[a.jsx("p",{className:"text-gray-700 mb-6 leading-relaxed",children:"This document outlines the enterprise and technical security measures implemented to protect your business data and ensure the integrity, confidentiality, and availability of the Sari-Sari CRM platform."}),a.jsx("div",{className:"space-y-6",children:n.map((s,r)=>a.jsxs("div",{className:"border-l-4 border-accent pl-6 py-2",children:[a.jsxs("h3",{className:"text-xl font-semibold text-secondary mb-2",children:[s.number,". ",s.title]}),s.content.map((i,o)=>a.jsx("p",{className:"text-gray-700 mb-2 leading-relaxed whitespace-pre-line text-sm",children:i},o))]},r))}),a.jsx("div",{className:"mt-8 pt-6 mb-10 border-t border-gray-200",children:a.jsx("p",{className:"text-gray-600 text-xs leading-relaxed text-center",children:"Security is a shared responsibility. We are committed to maintaining robust protections while working with our customers to ensure secure and responsible use of the platform."})})]}),a.jsx("div",{className:"sticky bottom-0 bg-gray-50 px-8 py-4 border-t border-gray-200",children:a.jsx("button",{onClick:t,className:"w-full bg-accent text-white px-6 py-3 rounded-lg font-semibold hover:bg-secondary transition-colors",children:"Close"})})]})})},Lue=({isOpen:e,onClose:t})=>{if(!e)return null;const n=[{number:"1",title:"Support Commitment",content:["Sari-Sari CRM provides operational support to help organizations maintain smooth and reliable use of the platform. Our goal is to resolve issues efficiently and minimize disruption to your business workflows."]},{number:"2",title:"Support Coverage",content:["Support services include assistance with:",` System or feature malfunctions
 Performance concerns
 General platform inquiries`,"Support does not include custom development, third-party integrations outside our platform, or user-side hardware/network issues."]},{number:"3",title:"User Responsibilities",content:["Organizations and users help maintain efficient support by:",` Reporting issues promptly
 Providing accurate information
 Following role permissions
 Maintaining secure account access`]},{number:"4",title:"Continuous Improvement",content:["Support feedback is used to improve system performance, reliability, and user experience."]},{number:"5",title:"Support & Reporting",content:["Users should submit support requests through designated communication channels, including:",a.jsx("strong",{children:"Sari-Sari CRM Administration"},"dept"),a.jsx("a",{href:"https://www.sari-sari.com/",className:"font-bold text-accent hover:underline",target:"_blank",rel:"noopener noreferrer",children:"sari-sari.com"},"email"),"Providing clear details helps accelerate resolution."]}];return a.jsx("div",{className:"fixed inset-0 bg-black/40 bg-opacity-40 z-50 flex items-center justify-center p-4",onClick:t,children:a.jsxs("div",{className:"bg-white rounded-lg max-w-5xl w-full max-h-[90vh] overflow-hidden",onClick:s=>s.stopPropagation(),children:[a.jsxs("div",{className:"sticky top-0 bg-secondary text-white px-8 py-6 flex items-center justify-between border-b border-accent",children:[a.jsx("div",{children:a.jsx("h2",{className:"text-3xl font-bold",children:"Support"})}),a.jsx("button",{onClick:t,className:"text-white hover:text-accent transition-colors text-4xl leading-none",children:""})]}),a.jsxs("div",{className:"overflow-y-auto max-h-[calc(90vh-120px)] px-8 py-6 scrollbar-hide",children:[a.jsx("p",{className:"text-gray-700 mb-6 leading-relaxed",children:"Sari-Sari CRM is committed to providing responsive and effective support to help your organization succeed. Our support team is here to assist with platform access, features, performance, and general questions."}),a.jsx("div",{className:"space-y-6",children:n.map((s,r)=>a.jsxs("div",{className:"border-l-4 border-accent pl-6 py-2",children:[a.jsxs("h3",{className:"text-xl font-semibold text-secondary mb-2",children:[s.number,". ",s.title]}),s.content.map((i,o)=>a.jsx("p",{className:"text-gray-700 mb-2 leading-relaxed whitespace-pre-line text-sm",children:i},o))]},r))}),a.jsx("div",{className:"mt-8 pt-6 mb-10 border-t border-gray-200",children:a.jsx("p",{className:"text-gray-600 text-xs leading-relaxed text-center",children:"We value your feedback and continuously improve our support services based on your experience. Thank you for using Sari-Sari CRM."})})]}),a.jsx("div",{className:"sticky bottom-0 bg-gray-50 px-8 py-4 border-t border-gray-200",children:a.jsx("button",{onClick:t,className:"w-full bg-accent text-white px-6 py-3 rounded-lg font-semibold hover:bg-secondary transition-colors",children:"Close"})})]})})},Due=()=>a.jsx("header",{className:"bg-secondary text-white py-4 border-b border-accent",children:a.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"flex items-center justify-between py-3",children:[a.jsxs(ld,{to:"/",className:"text-2xl font-bold",children:["Sari-Sari ",a.jsx("span",{className:"text-accent",children:"CRM"})]}),a.jsxs("nav",{className:"flex space-x-8",children:[a.jsx(ld,{to:"/resources",className:"hover:text-accent transition-colors",children:"Resources"}),a.jsx(ld,{to:"/legal",className:"hover:text-accent transition-colors",children:"Legal"})]})]})})}),Pue=()=>{const[e,t]=f.useState(!1),[n,s]=f.useState(!1);f.useEffect(()=>{document.title="Resources - Sari-Sari CRM"},[]);const r=[{title:"Security",description:"Understand our security practices.",action:()=>t(!0)},{title:"Support",description:"Get help from our support team and knowledge base.",action:()=>s(!0)}];return a.jsxs("div",{className:"font-manrope",children:[a.jsx(Due,{}),a.jsx(Eue,{isOpen:e,onClose:()=>t(!1)}),a.jsx(Lue,{isOpen:n,onClose:()=>s(!1)}),a.jsx("main",{className:"bg-paper-white min-h-screen py-16",children:a.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:[a.jsx("h1",{className:"text-5xl font-bold text-secondary mb-4",children:"Resources"}),a.jsx("p",{className:"text-lg text-secondary mb-12",children:"Everything you need to succeed with Sari-Sari CRM"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:r.map((i,o)=>a.jsxs("div",{className:"p-6 bg-white border border-gray-200 rounded-lg shadow-md hover:shadow-lg transition-shadow",children:[a.jsx("h3",{className:"text-2xl font-semibold text-secondary mb-2",children:i.title}),a.jsx("p",{className:"text-gray-600 mb-4",children:i.description}),i.action?a.jsx("button",{onClick:i.action,className:"text-accent font-semibold hover:text-secondary transition-colors",children:"Learn More "}):a.jsx("a",{href:i.link,className:"text-accent font-semibold hover:text-secondary transition-colors",children:"Learn More "})]},o))})]})})]})},Oue=({isOpen:e,onClose:t})=>{if(!e)return null;const n=[{number:"1",title:"Authorized Use",content:["Sari-Sari CRM  is an internal company platform intended to manage leads, deals, accounts, contacts, scheduling, and task workflows.","Access is granted according to employment role and operational responsibilities. Users are required to safeguard their credentials and operate strictly within assigned permissions. Unauthorized access, credential sharing, or misuse of the System is prohibited and may result administrative action."]},{number:"2",title:"System Purpose",content:["The System supports company sales operations, including:",` Lead and deal pipeline management
 Account and contact records
 Scheduling of calls and meetings
 Task tracking and follow-ups
 Activity logging and reporting`]},{number:"3",title:"Role-Based Responsibilities",content:["Users are assigned permissions based on their role:","Administrator  Full configuration, oversight, and system governance.","Group Manager  Team supervision, reporting, and workflow monitoring.","Manager  Operational coordination and performance oversight.","Sales Users  Execution of sales activities and record maintenance.","Users must operate strictly within assigned permissions."]},{number:"4",title:"Data Integrity & Confidentiality",content:["All information stored in the System is confidential company data.",`Users must:
 Maintain accurate records
 Protect customer and sales information
 Avoid unauthorized disclosure or manipulation`,"Intentional misuse may lead to disciplinary action."]},{number:"5",title:"Activity Logging & Monitoring",content:["System actions may be recorded for accountability, performance review, and security purposes. Continued use indicates consent to such monitoring."]},{number:"6",title:"Acceptable Conduct",content:[`Users must not:
 Enter false or misleading information
 Delete or alter records without authorization
 Attempt to bypass security measures
 Use the System for personal or unrelated activities`,"Professional conduct is required at all times."]},{number:"7",title:"Scheduling & Task Accountability",content:["Users are responsible for maintaining accurate scheduling records and completing assigned tasks in good faith to support operational efficiency."]},{number:"8",title:"Security Responsibilities",content:["Users must safeguard login credentials and immediately report suspicious activity. Account sharing is prohibited."]},{number:"9",title:"Intellectual Property",content:["The System, including its interface, workflows, and software components, is proprietary company property and may not be copied or redistributed without authorization."]},{number:"10",title:"System Availability",content:["The company will maintain reasonable uptime but does not guarantee uninterrupted access due to maintenance or unforeseen technical issues."]},{number:"11",title:"Violations",content:[`Misuse of the System may result in:
 Access restriction or suspension
 Internal disciplinary action
 Further administrative review`,"depending on severity."]},{number:"12",title:"Support & Reporting",content:["Questions or concerns regarding System use should be directed to:",a.jsx("strong",{children:"Sari-Sari CRM Administration"},"dept"),a.jsx("a",{href:"https://www.sari-sari.com/",className:"font-bold text-accent hover:underline",target:"_blank",rel:"noopener noreferrer",children:"sari-sari.com"},"email")]}];return a.jsx("div",{className:"fixed inset-0 bg-black/40 bg-opacity-40 z-50 flex items-center justify-center p-4",onClick:t,children:a.jsxs("div",{className:"bg-white rounded-lg max-w-5xl w-full max-h-[90vh] overflow-hidden",onClick:s=>s.stopPropagation(),children:[a.jsxs("div",{className:"sticky top-0 bg-secondary text-white px-8 py-6 flex items-center justify-between border-b border-accent",children:[a.jsx("div",{children:a.jsx("h2",{className:"text-3xl font-bold",children:"Terms of Use"})}),a.jsx("button",{onClick:t,className:"text-white hover:text-accent transition-colors text-4xl leading-none",children:""})]}),a.jsxs("div",{className:"overflow-y-auto max-h-[calc(90vh-120px)] px-8 py-6 scrollbar-hide",children:[a.jsx("p",{className:"text-gray-700 mb-6 leading-relaxed",children:"These Terms of Use govern your access to and use of the Sari-Sari CRM system. By accessing or using the System, you acknowledge that you have read, understood, and agree to be bound by these terms."}),a.jsx("div",{className:"space-y-6",children:n.map((s,r)=>a.jsxs("div",{className:"border-l-4 border-accent pl-6 py-2",children:[a.jsxs("h3",{className:"text-xl font-semibold text-secondary mb-2",children:[s.number,". ",s.title]}),s.content.map((i,o)=>a.jsx("p",{className:"text-gray-700 mb-2 leading-relaxed whitespace-pre-line text-sm",children:i},o))]},r))}),a.jsx("div",{className:"mt-8 pt-6 mb-10 border-t border-gray-200",children:a.jsx("p",{className:"text-gray-600 text-xs leading-relaxed text-center",children:"By continuing to use Sari-Sari CRM, you acknowledge that you have read and agree to these Terms of Use. If you do not agree with any part of these terms, you must discontinue use of the System immediately."})})]}),a.jsx("div",{className:"sticky bottom-0 bg-gray-50 px-8 py-4 border-t border-gray-200",children:a.jsx("button",{onClick:t,className:"w-full bg-accent text-white px-6 py-3 rounded-lg font-semibold hover:bg-secondary transition-colors",children:"Close"})})]})})},Mue=({isOpen:e,onClose:t})=>{if(!e)return null;const n=[{number:"1",title:"Users and Roles",content:["The system supports multiple roles with distinct access permissions:",`Admin  full system access and management.
Group Manager  oversees multiple teams and manages metrics.
Manager  manages teams and monitors pipeline progress.
Sales  accesses leads, contacts, accounts, deals, quotes, target and schedules.`,"Access to business data is strictly limited to authorized users in your organization based on role."]},{number:"2",title:"Data We Collect",content:["We may collect the following types of data:",`Account Information: Names, email addresses, phone numbers, company details, and login credentials.
Business Data: Leads, contacts, accounts, deals, quotes, notes, and pipeline information entered by your organization.
Scheduling Data: Tasks, meetings, and calls associated with your account or team.
Usage Data: IP addresses, device information, login activity, and feature usage for system analytics.
Cookies & Tracking: Cookies or similar technologies for authentication, and performance monitoring.`]},{number:"3",title:"Purpose of Data Processing",content:["Your data is processed only to:",` Provide, operate, and maintain the CRM platform.
 Manage user roles, permissions, and workflow operations.
 Facilitate collaboration and sales processes within your organization. 
 Comply with legal obligations and protect the security of the platform.`]},{number:"4",title:"Developer Access and Confidentiality",content:["We respect your business privacy. Our developers and internal staff cannot access business transaction information.","Developer access is limited to technical maintenance, bug fixing, system monitoring, and improvements. Access is strictly controlled, logged, and does not include the ability to view or extract business-specific information."]},{number:"5",title:"Data Sharing",content:["We do not sell or trade your data. Data may be shared only with:",`Service Providers: Vendors who help host, operate, or maintain the CRM. They are bound by confidentiality agreements.
Legal Requirements: Where disclosure is required by law, regulation, or legal process.`]},{number:"6",title:"Data Security",content:["We implement reasonable technical, administrative, and organizational measures to protect your data from unauthorized access, disclosure, alteration, or destruction. Users must also maintain secure login credentials and account access."]},{number:"7",title:"Data Retention",content:["We retain data only as long as necessary to provide services and comply with legal obligations. Your organization's Admins may request deletion of user accounts and associated business data."]},{number:"8",title:"Consent",content:["By using our CRM, your organization consents to the collection, processing, and storage of data as described in this Privacy Policy. Admins are responsible for ensuring that all users within their organization are aware of this policy and that proper consent has been obtained where required."]},{number:"9",title:"Third-Party Integrations",content:["Our CRM may integrate with third-party tools (e.g., email, calendar, analytics). We are not responsible for the privacy practices of these third parties."]},{number:"10",title:"Data Processing Agreement",content:["By using Sari-Sari CRM, your organization acknowledges and agrees that:",` Your organization is the Data Controller of all business and personal data entered into the CRM. 
 We implement technical and organizational measures to ensure data confidentiality, integrity, and security.
 Developer access to business transaction data is strictly restricted and logged, and we will not use or disclose your organization's business data for any purpose other than providing and maintaining the CRM services.`]}];return a.jsx("div",{className:"fixed inset-0 bg-black/40 bg-opacity-40 z-50 flex items-center justify-center p-4",onClick:t,children:a.jsxs("div",{className:"bg-white rounded-lg max-w-5xl w-full max-h-[90vh] overflow-hidden",onClick:s=>s.stopPropagation(),children:[a.jsxs("div",{className:"sticky top-0 bg-secondary text-white px-8 py-6 flex items-center justify-between border-b border-accent",children:[a.jsx("div",{children:a.jsx("h2",{className:"text-3xl font-bold",children:"Privacy Policy"})}),a.jsx("button",{onClick:t,className:"text-white hover:text-accent transition-colors text-4xl leading-none",children:""})]}),a.jsxs("div",{className:"overflow-y-auto max-h-[calc(90vh-120px)] px-8 py-6 scrollbar-hide",children:[a.jsx("p",{className:"text-gray-700 mb-6 leading-relaxed",children:"Sari-Sari CRM provides a B2B CRM platform designed to help manage businesses. Protecting your business and personal data is a top priority. This Privacy Policy explains how we collect, process, store, and protect data in compliance with applicable."}),a.jsx("div",{className:"space-y-6",children:n.map((s,r)=>a.jsxs("div",{className:"border-l-4 border-accent pl-6 py-2",children:[a.jsxs("h3",{className:"text-xl font-semibold text-secondary mb-2",children:[s.number,". ",s.title]}),s.content.map((i,o)=>a.jsx("p",{className:"text-gray-700 mb-2 leading-relaxed whitespace-pre-line text-sm",children:i},o))]},r))}),a.jsx("div",{className:"mt-8 pt-6 mb-10 border-t border-gray-200",children:a.jsx("p",{className:"text-gray-600 text-xs leading-relaxed text-center",children:"Your privacy and data security are important to us. If you have any questions about this Privacy Policy, please contact our CRM Administration team."})})]}),a.jsx("div",{className:"sticky bottom-0 bg-gray-50 px-8 py-4 border-t border-gray-200",children:a.jsx("button",{onClick:t,className:"w-full bg-accent text-white px-6 py-3 rounded-lg font-semibold hover:bg-secondary transition-colors",children:"Close"})})]})})},Iue=({isOpen:e,onClose:t})=>{if(!e)return null;const n=[{number:"1",title:"Purpose",content:['This Service Level Agreement ("SLA") defines the service standards, availability commitments, support expectations, and responsibilities associated with the use of Sari-Sari CRM, a business-to-business customer relationship management platform.']},{number:"2",title:"Service Availability",content:["We work to keep the CRM available 99.5% of the time each month so your team can manage work without interruption.","Planned maintenance is announced in advance whenever possible. Emergency maintenance may happen if needed to keep the system secure and stable.","Downtime caused by scheduled maintenance, internet or third-party issues, user device problems, or events outside our control is not included in availability targets."]},{number:"3",title:"Performance Standards",content:["The CRM platform is designed to:",` Provide consistent access to business records and sales workflows
 Support role-based system operations`,"Performance may vary depending on user device, internet connection, and data volume."]},{number:"4",title:"Data Protection & Confidentiality",content:["We prioritize business data security:",` Access to CRM data is restricted to authorized organizational users
 Developers and internal staff do not access business transaction data
 Security safeguards are implemented to protect confidentiality and integrity`]},{number:"5",title:"Incident Management",content:["If a service disruption occurs:",` Issues are logged and prioritized based on severity
 Mitigation steps are started as quickly as possible
 Users are informed of significant incidents when appropriate`]},{number:"6",title:"Customer Responsibilities",content:["Organizations using the CRM agree to:",` Maintain secure login credentials
 Use the system in accordance with assigned roles
 Report issues promptly
 Ensure stable internet and device compatibility`]},{number:"7",title:"Maintenance & Updates",content:["We may perform:",` Routine maintenance
 Security updates
 Feature improvements`,"Maintenance may temporarily affect availability."]},{number:"8",title:"Limitations",content:["Service commitments do not apply to disruptions caused by:",` User misuse or unauthorized modifications
 Third-party service failures
 Network or infrastructure outside our control`]},{number:"9",title:"Review & Modification",content:["This SLA may be updated to reflect service improvements or operational changes. Continued use of the CRM indicates acceptance of updates."]}];return a.jsx("div",{className:"fixed inset-0 bg-black/40 bg-opacity-40 z-50 flex items-center justify-center p-4",onClick:t,children:a.jsxs("div",{className:"bg-white rounded-lg max-w-5xl w-full max-h-[90vh] overflow-hidden",onClick:s=>s.stopPropagation(),children:[a.jsxs("div",{className:"sticky top-0 bg-secondary text-white px-8 py-6 flex items-center justify-between border-b border-accent",children:[a.jsx("div",{children:a.jsx("h2",{className:"text-3xl font-bold",children:"Service Level Agreement"})}),a.jsx("button",{onClick:t,className:"text-white hover:text-accent transition-colors text-4xl leading-none",children:""})]}),a.jsxs("div",{className:"overflow-y-auto max-h-[calc(90vh-120px)] px-8 py-6 scrollbar-hide",children:[a.jsx("p",{className:"text-gray-700 mb-6 leading-relaxed",children:"This Service Level Agreement defines the service standards, availability commitments, support expectations, and responsibilities associated with the use of Sari-Sari CRM."}),a.jsx("div",{className:"space-y-6",children:n.map((s,r)=>a.jsxs("div",{className:"border-l-4 border-accent pl-6 py-2",children:[a.jsxs("h3",{className:"text-xl font-semibold text-secondary mb-2",children:[s.number,". ",s.title]}),s.content.map((i,o)=>a.jsx("p",{className:"text-gray-700 mb-2 leading-relaxed whitespace-pre-line text-sm",children:i},o))]},r))}),a.jsx("div",{className:"mt-8 pt-6 mb-10 border-t border-gray-200",children:a.jsx("p",{className:"text-gray-600 text-xs leading-relaxed text-center",children:"This SLA may be updated to reflect service improvements or operational changes. Continued use of the CRM indicates acceptance of updates."})})]}),a.jsx("div",{className:"sticky bottom-0 bg-gray-50 px-8 py-4 border-t border-gray-200",children:a.jsx("button",{onClick:t,className:"w-full bg-accent text-white px-6 py-3 rounded-lg font-semibold hover:bg-secondary transition-colors",children:"Close"})})]})})},$ue=({isOpen:e,onClose:t})=>{if(!e)return null;const n=[{number:"1",title:"Data Privacy Compliance",content:["Our platform is built to align with applicable data protection regulations, including:",` Philippine Data Privacy Act (RA 10173)
 Applicable international privacy standards where required`,"We support lawful collection, processing, and storage of business and personal information handled within the CRM."]},{number:"2",title:"Access & Confidentiality Controls",content:["We enforce role-based access controls to ensure that only authorized users within an organization can view or manage business data such as leads, contacts, accounts, deals, and quotes.","Developer and internal access is restricted to system maintenance and operational support under controlled conditions."]},{number:"3",title:"Security Practices",content:["We implement reasonable administrative, technical, and organizational safeguards designed to:",` Protect data confidentiality
 Prevent unauthorized access
 Maintain system integrity
 Support operational reliability`,"Security measures are reviewed and improved as part of ongoing system maintenance."]},{number:"4",title:"Operational Compliance",content:["The CRM follows structured operational processes to support:",` System availability and maintenance standards
 Incident management and issue resolution
 Data handling accountability
 Responsible service delivery`]},{number:"5",title:"Continuous Improvement",content:["Compliance and security practices are regularly evaluated to adapt to evolving regulatory expectations and technology standards."]}];return a.jsx("div",{className:"fixed inset-0 bg-black/40 bg-opacity-40 z-50 flex items-center justify-center p-4",onClick:t,children:a.jsxs("div",{className:"bg-white rounded-lg max-w-5xl w-full max-h-[90vh] overflow-hidden",onClick:s=>s.stopPropagation(),children:[a.jsxs("div",{className:"sticky top-0 bg-secondary text-white px-8 py-6 flex items-center justify-between border-b border-accent",children:[a.jsx("div",{children:a.jsx("h2",{className:"text-3xl font-bold",children:"Compliance Standards & Commitments"})}),a.jsx("button",{onClick:t,className:"text-white hover:text-accent transition-colors text-4xl leading-none",children:""})]}),a.jsxs("div",{className:"overflow-y-auto max-h-[calc(90vh-120px)] px-8 py-6 scrollbar-hide",children:[a.jsx("p",{className:"text-gray-700 mb-6 leading-relaxed",children:"Sari-Sari CRM is designed to support responsible business data management while aligning with recognized privacy, security, and operational best practices. We are committed to maintaining safeguards that protect customer and organizational information."}),a.jsx("div",{className:"space-y-6",children:n.map((s,r)=>a.jsxs("div",{className:"border-l-4 border-accent pl-6 py-2",children:[a.jsxs("h3",{className:"text-xl font-semibold text-secondary mb-2",children:[s.number,". ",s.title]}),s.content.map((i,o)=>a.jsx("p",{className:"text-gray-700 mb-2 leading-relaxed whitespace-pre-line text-sm",children:i},o))]},r))}),a.jsx("div",{className:"mt-8 pt-6 mb-10 border-t border-gray-200",children:a.jsx("p",{className:"text-gray-600 text-xs leading-relaxed text-center",children:"Compliance and security practices are regularly evaluated to adapt to evolving regulatory expectations and technology standards."})})]}),a.jsx("div",{className:"sticky bottom-0 bg-gray-50 px-8 py-4 border-t border-gray-200",children:a.jsx("button",{onClick:t,className:"w-full bg-accent text-white px-6 py-3 rounded-lg font-semibold hover:bg-secondary transition-colors",children:"Close"})})]})})},Rue=()=>a.jsx("header",{className:"bg-secondary text-white py-4 border-b border-accent",children:a.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"flex items-center justify-between py-3",children:[a.jsxs(ld,{to:"/",className:"text-2xl font-bold",children:["Sari-Sari ",a.jsx("span",{className:"text-accent",children:"CRM"})]}),a.jsxs("nav",{className:"flex space-x-8",children:[a.jsx(ld,{to:"/resources",className:"hover:text-accent transition-colors",children:"Resources"}),a.jsx(ld,{to:"/legal",className:"hover:text-accent transition-colors",children:"Legal"})]})]})})}),zue=()=>{const[e,t]=f.useState(!1),[n,s]=f.useState(!1),[r,i]=f.useState(!1),[o,l]=f.useState(!1);f.useEffect(()=>{document.title="Legal - Sari-Sari CRM"},[]);const c=[{title:"Terms",description:"Our terms of service and conditions of use.",action:()=>t(!0)},{title:"Privacy",description:"How we protect and handle your personal data.",action:()=>s(!0)},{title:"Service Level Agreement (SLA)",description:"Service level agreements and guarantees.",action:()=>i(!0)},{title:"Compliance",description:"Our compliance standards.",action:()=>l(!0)}];return a.jsxs("div",{className:"font-manrope",children:[a.jsx(Rue,{}),a.jsx(Oue,{isOpen:e,onClose:()=>t(!1)}),a.jsx(Mue,{isOpen:n,onClose:()=>s(!1)}),a.jsx(Iue,{isOpen:r,onClose:()=>i(!1)}),a.jsx($ue,{isOpen:o,onClose:()=>l(!1)}),a.jsx("main",{className:"bg-paper-white min-h-screen py-16",children:a.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:[a.jsx("h1",{className:"text-5xl font-bold text-secondary mb-4",children:"Legal"}),a.jsx("p",{className:"text-lg text-secondary mb-12",children:"Important legal information and policies"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:c.map((u,d)=>a.jsxs("div",{className:"p-6 bg-white border border-gray-200 rounded-lg shadow-md hover:shadow-lg transition-shadow",children:[a.jsx("h3",{className:"text-2xl font-semibold text-secondary mb-2",children:u.title}),a.jsx("p",{className:"text-gray-600 mb-4",children:u.description}),u.action?a.jsx("button",{onClick:u.action,className:"text-accent font-semibold hover:text-secondary transition-colors",children:"Read More "}):a.jsx("a",{href:u.link,className:"text-accent font-semibold hover:text-secondary transition-colors",children:"Read More "})]},d))})]})})]})},Fj=e=>{const t="https://crm.sari-sari.com";try{const n=new URL(t),s=n.protocol==="https:"?"wss":"ws",r=n.hostname,i=n.port||(n.protocol==="https:"?443:80),o=`${s}://${r}:${i}/ws/notifications?user_id=${e}`;return console.log(" WebSocket URL:",o),o}catch(n){return console.error("Error parsing API URL:",n),`ws://localhost:8000/ws/notifications?user_id=${e}`}};function Fue({toggleSidebar:e}){const[t,n]=f.useState(!1),[s,r]=f.useState(!1),[i,o]=f.useState([]),[l,c]=f.useState(0),u=f.useRef(null),d=f.useRef(null),h=ta(),p=Et(),{logout:x}=Ks(),{user:b,fetchUser:j}=Gt(),N={"/admin/dashboard":"Dashboard","/admin/accounts":"Accounts","/admin/contacts":"Contacts","/reports":"Reports","/leads":"Leads","/admin/Audit":"Audit","/admin/targets":"Targets","/admin/leads":"Leads","/admin/quotes":"Quotes","/admin/users":"Users","/admin/deals":"Deals"}[h.pathname]||"Admin Panel";return f.useEffect(()=>{const w=()=>{j()};return window.addEventListener("userProfileUpdated",w),()=>{window.removeEventListener("userProfileUpdated",w)}},[j]),f.useEffect(()=>{if(!b?.id)return;const w=Fj(b.id);console.log(" Connecting to WebSocket:",w);const S=new WebSocket(w);let _;const T=()=>{_=setTimeout(()=>{console.log(" Attempting WebSocket reconnection...")},3e3)};return S.onopen=()=>{console.log(" Admin WS Connected"),clearTimeout(_)},S.onmessage=k=>{try{const A=JSON.parse(k.data);console.log(" Notification received:",A),o(E=>[A,...E]),c(E=>E+1)}catch(A){console.error("Error parsing notification:",A)}},S.onerror=k=>{console.error(" Admin WS Error:",k)},S.onclose=()=>{console.log(" Admin WS Disconnected"),T()},()=>{clearTimeout(_),S&&S.readyState===WebSocket.OPEN&&S.close()}},[b?.id]),f.useEffect(()=>{function w(S){u.current&&!u.current.contains(S.target)&&n(!1),d.current&&!d.current.contains(S.target)&&r(!1)}return document.addEventListener("mousedown",w),()=>document.removeEventListener("mousedown",w)},[]),a.jsxs("header",{className:"flex justify-between items-center bg-white shadow px-4 sm:px-6 py-3 border-b relative",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("button",{onClick:e,className:"lg:hidden text-gray-700 hover:text-gray-900",children:a.jsx(rh,{className:"text-2xl"})}),b?.company?.company_logo&&a.jsx("img",{src:b.company.company_logo,alt:"Company Logo",className:"w-20 h-10 object-contain rounded"}),a.jsx("h1",{className:"text-lg font-semibold text-gray-800",children:N})]}),a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs("div",{className:"relative",ref:d,children:[a.jsxs("button",{onClick:()=>r(!s),className:"relative text-gray-600 hover:text-gray-800 transition",children:[a.jsx(gx,{className:"text-xl"}),l>0&&a.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-[10px] w-4 h-4 flex items-center justify-center rounded-full font-semibold",children:l})]}),s&&a.jsxs("div",{className:"absolute right-0 mt-3 w-80 bg-white rounded-xl shadow-lg border z-50 overflow-hidden animate-fade-in",children:[a.jsxs("div",{className:"p-3 border-b bg-gray-50 flex justify-between items-center",children:[a.jsx("h3",{className:"font-semibold text-gray-800 text-sm",children:"Notifications"}),a.jsx("button",{onClick:()=>{o([]),c(0)},className:"text-xs text-blue-600 hover:underline",children:"Clear"})]}),a.jsx("div",{className:"max-h-60 overflow-y-auto",children:i.length>0?i.map((w,S)=>a.jsx("div",{className:"p-3 border-b text-sm hover:bg-gray-50 cursor-pointer",children:w.title||w.message||"New Update"},S)):a.jsx("div",{className:"p-4 text-center text-gray-500 text-xs",children:"No notifications"})})]})]}),a.jsxs("div",{className:"relative",ref:u,children:[a.jsxs("button",{onClick:()=>n(!t),className:"flex items-center gap-2 cursor-pointer hover:bg-gray-100 px-2 py-1 rounded",children:[a.jsx("img",{src:b?.profile_picture||"https://via.placeholder.com/40",alt:"Profile",className:"w-8 aspect-square object-cover rounded-full"}),a.jsxs("span",{className:"hidden lg:inline text-sm font-medium text-gray-700",children:[b?.first_name," ",b?.last_name]})]}),t&&a.jsxs("div",{className:"absolute right-0 mt-2 w-64 bg-white shadow-xl rounded-xl border border-gray-200 z-50 p-4",children:[a.jsxs("div",{className:"flex flex-col items-center text-center space-y-3",children:[a.jsx("img",{src:b?.profile_picture||"https://via.placeholder.com/80",alt:"Profile",className:"w-16 h-16 rounded-full object-cover"}),a.jsxs("div",{children:[a.jsxs("h2",{className:"text-gray-800 font-semibold text-sm",children:[b?.first_name," ",b?.middle_name," ",b?.last_name]}),a.jsx("p",{className:"text-[11px] text-gray-600 font-light w-full truncate",children:"Admin"})]})]}),a.jsxs("div",{className:"mt-6 space-y-1 px-4 text-left",children:[a.jsx("button",{onClick:()=>{p("/admin/users"),n(!1)},className:"block w-full text-sm text-gray-700 hover:bg-gray-50 py-1 rounded text-left",children:"Invite Your Team"}),a.jsx("button",{onClick:()=>{p("/admin/manage-account"),n(!1)},className:"block w-full text-sm text-gray-700 hover:bg-gray-50 py-1 rounded text-left",children:"Manage Your Account"}),a.jsx("button",{onClick:()=>{p("/admin/help"),n(!1)},className:"block w-full text-sm text-gray-700 hover:bg-gray-50 py-1 rounded text-left",children:"Help"}),a.jsx("div",{className:"border-t border-gray-200 my-2"}),a.jsx("button",{onClick:x,className:"block w-full text-sm text-red-600 hover:text-red-700 hover:bg-gray-50 py-2 rounded text-left",children:"Logout"})]})]})]})]})]})}function Uue(){const[e,t]=f.useState(!1),[n,s]=f.useState(!1),[r,i]=f.useState(!1),[o,l]=f.useState(!1),c=ta(),{user:u}=Gt();f.useEffect(()=>{u&&console.log("Fetched user:",u)},[u]),f.useEffect(()=>{document.title="Admin Panel | Sari-Sari CRM"},[]);const h=["/admin/accounts","/admin/contacts","/admin/leads","/admin/deals","/admin/quotes","/admin/targets"].includes(c.pathname);f.useEffect(()=>{h&&t(!0)},[c.pathname]);const p="flex items-center gap-3 px-3 py-2 rounded-lg bg-white text-[#1e293b] font-semibold shadow-sm",x="flex items-center gap-3 px-3 py-2 rounded-lg text-gray-300 hover:bg-[#334155] hover:text-white transition";return a.jsxs("div",{className:"flex h-screen bg-gray-100 overflow-hidden",children:[a.jsxs("div",{className:`fixed top-0 left-0 h-screen w-64 bg-[#1e293b] text-white flex flex-col shadow-lg transform transition-transform duration-300 z-50
          ${o?"translate-x-0":"-translate-x-full"} lg:translate-x-0`,children:[a.jsxs("div",{className:"px-4 py-3 bg-[#fbbf24] leading-none",children:[a.jsxs("p",{className:"text-gray-900 font-bold text-lg m-0 p-0",children:[" Sari-Sari.CRM"," ",a.jsx("span",{className:"text-[12px] text-gray-700 font-medium align-bottom",children:"v2"})]}),u&&u.company&&a.jsx("p",{className:"text-[12px] text-gray-600 font-medium w-full truncate",title:u.company.company_name,children:u.company.slug||u.company.company_name})]}),a.jsxs("nav",{className:"flex-1 overflow-y-auto p-4 space-y-2 hide-scrollbar",children:[a.jsxs($t,{to:"/admin/dashboard",className:({isActive:b})=>b?p:x,children:[a.jsx(sh,{className:"text-lg"}),a.jsx("span",{children:"Dashboard"})]}),a.jsxs("div",{children:[a.jsxs("button",{className:"w-full px-3 py-2 flex justify-between items-center text-sm font-medium text-gray-300 hover:bg-[#334155] rounded-lg transition",onClick:()=>t(!e),children:[a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx(sa,{className:"text-lg"}),"Sales"]}),a.jsx(Dt,{className:`transition-transform ${e?"rotate-180":""}`})]}),e&&a.jsxs("div",{className:"ml-6 mt-2 space-y-1",children:[a.jsxs($t,{to:"/admin/accounts",className:({isActive:b})=>b?p:x,children:[a.jsx(ac,{})," Accounts"]}),a.jsxs($t,{to:"/admin/contacts",className:({isActive:b})=>b?p:x,children:[a.jsx(ra,{})," Contacts"]}),a.jsxs($t,{to:"/admin/leads",className:({isActive:b})=>b?p:x,children:[a.jsx(rn,{})," Leads"]}),a.jsxs($t,{to:"/admin/deals",className:({isActive:b})=>b?p:x,children:[a.jsx(sa,{})," Deals"]}),a.jsxs($t,{to:"/admin/quotes",className:({isActive:b})=>b?p:x,children:[a.jsx(ia,{})," Quotes"]}),a.jsxs($t,{to:"/admin/targets",className:({isActive:b})=>b?p:x,children:[a.jsx(fr,{})," Targets"]})]})]}),a.jsxs("div",{children:[a.jsxs("button",{className:"w-full px-3 py-2 flex justify-between items-center text-sm font-medium text-gray-300 hover:bg-[#334155] rounded-lg transition",onClick:()=>s(!n),children:[a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx(Ls,{className:"text-lg"}),"Activity"]}),a.jsx(Dt,{className:`transition-transform ${n?"rotate-180":""}`})]}),n&&a.jsxs("div",{className:"ml-6 mt-2 space-y-1",children:[a.jsxs($t,{to:"/admin/calendar",className:({isActive:b})=>b?p:x,children:[a.jsx(Pt,{})," Calendar"]}),a.jsxs($t,{to:"/admin/tasks",className:({isActive:b})=>b?p:x,children:[a.jsx(Qt,{})," Tasks"]}),a.jsxs($t,{to:"/admin/meetings",className:({isActive:b})=>b?p:x,children:[a.jsx(Pt,{})," Meetings"]}),a.jsxs($t,{to:"/admin/calls",className:({isActive:b})=>b?p:x,children:[a.jsx(Us,{})," Calls"]}),a.jsxs($t,{to:"/admin/audit",className:({isActive:b})=>b?p:x,children:[a.jsx(Ls,{})," Audit"]})]})]}),a.jsx("div",{children:a.jsx($t,{to:"/admin/territory",className:({isActive:b})=>b?p:x,children:a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx(tc,{className:"text-lg"}),"Territory"]})})}),a.jsxs("div",{children:[a.jsxs("button",{className:"w-full px-3 py-2 flex justify-between items-center text-sm font-medium text-gray-300 hover:bg-[#334155] rounded-lg transition",onClick:()=>i(!r),children:[a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx(EL,{className:"text-lg"}),"Settings"]}),a.jsx(Dt,{className:`transition-transform ${r?"rotate-180":""}`})]}),r&&a.jsxs("div",{className:"ml-6 mt-2 space-y-1",children:[a.jsxs($t,{to:"/admin/users",className:({isActive:b})=>b?p:x,children:[a.jsx(Xa,{})," Users"]}),a.jsxs($t,{to:"/admin/manage-account",className:({isActive:b})=>b?p:x,children:[a.jsx(ra,{}),"Your Profile"]}),a.jsxs($t,{to:"/admin/company-details",className:({isActive:b})=>b?p:x,children:[a.jsx(jj,{}),"Organization"]})]})]})]}),a.jsxs("div",{className:"px-4 py-3 text-xs text-gray-400 border-t border-gray-700",children:[" ",new Date().getFullYear()," Sari-Sari CRM"]})]}),o&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 lg:hidden",onClick:()=>l(!1)}),a.jsxs("div",{className:"flex-1 flex flex-col lg:ml-64 overflow-hidden",children:[a.jsx(Fue,{toggleSidebar:()=>l(!o)}),a.jsx("main",{className:"flex-1 p-6 overflow-auto hide-scrollbar",style:{backgroundColor:"#fffeee"},children:a.jsx(th,{})})]})]})}function Bue(e){return Ot({attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M160 0c17.7 0 32 14.3 32 32l0 35.7c1.6 .2 3.1 .4 4.7 .7c.4 .1 .7 .1 1.1 .2l48 8.8c17.4 3.2 28.9 19.9 25.7 37.2s-19.9 28.9-37.2 25.7l-47.5-8.7c-31.3-4.6-58.9-1.5-78.3 6.2s-27.2 18.3-29 28.1c-2 10.7-.5 16.7 1.2 20.4c1.8 3.9 5.5 8.3 12.8 13.2c16.3 10.7 41.3 17.7 73.7 26.3l2.9 .8c28.6 7.6 63.6 16.8 89.6 33.8c14.2 9.3 27.6 21.9 35.9 39.5c8.5 17.9 10.3 37.9 6.4 59.2c-6.9 38-33.1 63.4-65.6 76.7c-13.7 5.6-28.6 9.2-44.4 11l0 33.4c0 17.7-14.3 32-32 32s-32-14.3-32-32l0-34.9c-.4-.1-.9-.1-1.3-.2l-.2 0s0 0 0 0c-24.4-3.8-64.5-14.3-91.5-26.3c-16.1-7.2-23.4-26.1-16.2-42.2s26.1-23.4 42.2-16.2c20.9 9.3 55.3 18.5 75.2 21.6c31.9 4.7 58.2 2 76-5.3c16.9-6.9 24.6-16.9 26.8-28.9c1.9-10.6 .4-16.7-1.3-20.4c-1.9-4-5.6-8.4-13-13.3c-16.4-10.7-41.5-17.7-74-26.3l-2.8-.7s0 0 0 0C119.4 279.3 84.4 270 58.4 253c-14.2-9.3-27.5-22-35.8-39.6c-8.4-17.9-10.1-37.9-6.1-59.2C23.7 116 52.3 91.2 84.8 78.3c13.3-5.3 27.9-8.9 43.2-11L128 32c0-17.7 14.3-32 32-32z"},child:[]}]})(e)}function Hue(e){return Ot({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M544 248l0 3.3 69.7-69.7c21.9-21.9 21.9-57.3 0-79.2L535.6 24.4c-21.9-21.9-57.3-21.9-79.2 0L416.3 64.5c-2.7-.3-5.5-.5-8.3-.5L296 64c-37.1 0-67.6 28-71.6 64l-.4 0 0 120c0 22.1 17.9 40 40 40s40-17.9 40-40l0-72c0 0 0-.1 0-.1l0-15.9 16 0 136 0c0 0 0 0 .1 0l7.9 0c44.2 0 80 35.8 80 80l0 8zM336 192l0 56c0 39.8-32.2 72-72 72s-72-32.2-72-72l0-118.6c-35.9 6.2-65.8 32.3-76 68.2L99.5 255.2 26.3 328.4c-21.9 21.9-21.9 57.3 0 79.2l78.1 78.1c21.9 21.9 57.3 21.9 79.2 0l37.7-37.7c.9 0 1.8 .1 2.7 .1l160 0c26.5 0 48-21.5 48-48c0-5.6-1-11-2.7-16l2.7 0c26.5 0 48-21.5 48-48c0-12.8-5-24.4-13.2-33c25.7-5 45.1-27.6 45.2-54.8l0-.4c-.1-30.8-25.1-55.8-56-55.8c0 0 0 0 0 0l-120 0z"},child:[]}]})(e)}function que(e){return Ot({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M64 32C46.3 32 32 46.3 32 64l0 64c-17.7 0-32 14.3-32 32s14.3 32 32 32l0 32c-17.7 0-32 14.3-32 32s14.3 32 32 32l0 64 0 96c0 17.7 14.3 32 32 32s32-14.3 32-32l0-64 80 0c68.4 0 127.7-39 156.8-96l19.2 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-.7 0c.5-5.3 .7-10.6 .7-16s-.2-10.7-.7-16l.7 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-19.2 0C303.7 71 244.4 32 176 32L64 32zm190.4 96L96 128l0-32 80 0c30.5 0 58.2 12.2 78.4 32zM96 192l190.9 0c.7 5.2 1.1 10.6 1.1 16s-.4 10.8-1.1 16L96 224l0-32zm158.4 96c-20.2 19.8-47.9 32-78.4 32l-80 0 0-32 158.4 0z"},child:[]}]})(e)}function Ti({props:e,name:t}){return $ce({props:e,name:t,defaultTheme:WL,themeId:zj})}function Bl(e){const{elementType:t,externalSlotProps:n,ownerState:s,skipResolvingSlotProps:r=!1,...i}=e,o=r?{}:rq(n,s),{props:l,internalRef:c}=iq({...i,externalSlotProps:o}),u=Uo(c,o?.ref,e.additionalProps?.ref);return sq(t,{...l,ref:u},s)}function ys(e){const t=f.useRef(e);return ls(()=>{t.current=e}),f.useRef((...n)=>(0,t.current)(...n)).current}var Iv=Symbol("NOT_FOUND");function Gue(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function Wue(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function Vue(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(n=>typeof n=="function")){const n=e.map(s=>typeof s=="function"?`function ${s.name||"unnamed"}()`:typeof s).join(", ");throw new TypeError(`${t}[${n}]`)}}var M$=e=>Array.isArray(e)?e:[e];function Yue(e){const t=Array.isArray(e[0])?e[0]:e;return Vue(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function Que(e,t){const n=[],{length:s}=e;for(let r=0;r<s;r++)n.push(e[r].apply(null,t));return n}function Kue(e){let t;return{get(n){return t&&e(t.key,n)?t.value:Iv},put(n,s){t={key:n,value:s}},getEntries(){return t?[t]:[]},clear(){t=void 0}}}function Xue(e,t){let n=[];function s(l){const c=n.findIndex(u=>t(l,u.key));if(c>-1){const u=n[c];return c>0&&(n.splice(c,1),n.unshift(u)),u.value}return Iv}function r(l,c){s(l)===Iv&&(n.unshift({key:l,value:c}),n.length>e&&n.pop())}function i(){return n}function o(){n=[]}return{get:s,put:r,getEntries:i,clear:o}}var Zue=(e,t)=>e===t;function Jue(e){return function(n,s){if(n===null||s===null||n.length!==s.length)return!1;const{length:r}=n;for(let i=0;i<r;i++)if(!e(n[i],s[i]))return!1;return!0}}function eme(e,t){const n=typeof t=="object"?t:{equalityCheck:t},{equalityCheck:s=Zue,maxSize:r=1,resultEqualityCheck:i}=n,o=Jue(s);let l=0;const c=r<=1?Kue(o):Xue(r,o);function u(){let d=c.get(arguments);if(d===Iv){if(d=e.apply(null,arguments),l++,i){const p=c.getEntries().find(x=>i(x.value,d));p&&(d=p.value,l!==0&&l--)}c.put(arguments,d)}return d}return u.clearCache=()=>{c.clear(),u.resetResultsCount()},u.resultsCount=()=>l,u.resetResultsCount=()=>{l=0},u}var tme=class{constructor(e){this.value=e}deref(){return this.value}},ame=typeof WeakRef<"u"?WeakRef:tme,nme=0,I$=1;function Qy(){return{s:nme,v:void 0,o:null,p:null}}function uq(e,t={}){let n=Qy();const{resultEqualityCheck:s}=t;let r,i=0;function o(){let l=n;const{length:c}=arguments;for(let h=0,p=c;h<p;h++){const x=arguments[h];if(typeof x=="function"||typeof x=="object"&&x!==null){let b=l.o;b===null&&(l.o=b=new WeakMap);const j=b.get(x);j===void 0?(l=Qy(),b.set(x,l)):l=j}else{let b=l.p;b===null&&(l.p=b=new Map);const j=b.get(x);j===void 0?(l=Qy(),b.set(x,l)):l=j}}const u=l;let d;if(l.s===I$)d=l.v;else if(d=e.apply(null,arguments),i++,s){const h=r?.deref?.()??r;h!=null&&s(h,d)&&(d=h,i!==0&&i--),r=typeof d=="object"&&d!==null||typeof d=="function"?new ame(d):d}return u.s=I$,u.v=d,d}return o.clearCache=()=>{n=Qy(),o.resetResultsCount()},o.resultsCount=()=>i,o.resetResultsCount=()=>{i=0},o}function mq(e,...t){const n=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,s=(...r)=>{let i=0,o=0,l,c={},u=r.pop();typeof u=="object"&&(c=u,u=r.pop()),Gue(u,`createSelector expects an output function after the inputs, but received: [${typeof u}]`);const d={...n,...c},{memoize:h,memoizeOptions:p=[],argsMemoize:x=uq,argsMemoizeOptions:b=[]}=d,j=M$(p),y=M$(b),N=Yue(r),w=h(function(){return i++,u.apply(null,arguments)},...j),S=x(function(){o++;const T=Que(N,arguments);return l=w.apply(null,T),l},...y);return Object.assign(S,{resultFunc:u,memoizedResultFunc:w,dependencies:N,dependencyRecomputations:()=>o,resetDependencyRecomputations:()=>{o=0},lastResult:()=>l,recomputations:()=>i,resetRecomputations:()=>{i=0},memoize:h,argsMemoize:x})};return Object.assign(s,{withTypes:()=>s}),s}var dt=mq(uq),sme=Object.assign((e,t=dt)=>{Wue(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const n=Object.keys(e),s=n.map(i=>e[i]);return t(s,(...i)=>i.reduce((o,l,c)=>(o[n[c]]=l,o),{}))},{withTypes:()=>sme});const rme=mq({memoize:eme,memoizeOptions:{maxSize:1,equalityCheck:Object.is}}),Lt=(e,t,n,s,r,i,o,l,...c)=>{if(c.length>0)throw new Error("Unsupported number of selectors");let u;if(e&&t&&n&&s&&r&&i&&o&&l)u=(d,h,p,x)=>{const b=e(d,h,p,x),j=t(d,h,p,x),y=n(d,h,p,x),N=s(d,h,p,x),w=r(d,h,p,x),S=i(d,h,p,x),_=o(d,h,p,x);return l(b,j,y,N,w,S,_,h,p,x)};else if(e&&t&&n&&s&&r&&i&&o)u=(d,h,p,x)=>{const b=e(d,h,p,x),j=t(d,h,p,x),y=n(d,h,p,x),N=s(d,h,p,x),w=r(d,h,p,x),S=i(d,h,p,x);return o(b,j,y,N,w,S,h,p,x)};else if(e&&t&&n&&s&&r&&i)u=(d,h,p,x)=>{const b=e(d,h,p,x),j=t(d,h,p,x),y=n(d,h,p,x),N=s(d,h,p,x),w=r(d,h,p,x);return i(b,j,y,N,w,h,p,x)};else if(e&&t&&n&&s&&r)u=(d,h,p,x)=>{const b=e(d,h,p,x),j=t(d,h,p,x),y=n(d,h,p,x),N=s(d,h,p,x);return r(b,j,y,N,h,p,x)};else if(e&&t&&n&&s)u=(d,h,p,x)=>{const b=e(d,h,p,x),j=t(d,h,p,x),y=n(d,h,p,x);return s(b,j,y,h,p,x)};else if(e&&t&&n)u=(d,h,p,x)=>{const b=e(d,h,p,x),j=t(d,h,p,x);return n(b,j,h,p,x)};else if(e&&t)u=(d,h,p,x)=>{const b=e(d,h,p,x);return t(b,h,p,x)};else if(e)u=e;else throw new Error("Missing arguments");return u},Uj=e=>(...t)=>{const n=new WeakMap;let s=1;const r=t[t.length-1],i=t.length-1||1,o=Math.max(r.length-i,0);if(o>3)throw new Error("Unsupported number of arguments");return(c,u,d,h)=>{let p=c.__cacheKey__;p||(p={id:s},c.__cacheKey__=p,s+=1);let x=n.get(p);if(!x){const b=t.length===1?[N=>N,r]:t;let j=t;const y=[void 0,void 0,void 0];switch(o){case 0:break;case 1:{j=[...b.slice(0,-1),()=>y[0],r];break}case 2:{j=[...b.slice(0,-1),()=>y[0],()=>y[1],r];break}case 3:{j=[...b.slice(0,-1),()=>y[0],()=>y[1],()=>y[2],r];break}default:throw new Error("Unsupported number of arguments")}e&&(j=[...j,e]),x=rme(...j),x.selectorArgs=y,n.set(p,x)}switch(o){case 3:x.selectorArgs[2]=h;case 2:x.selectorArgs[1]=d;case 1:x.selectorArgs[0]=u}switch(o){case 0:return x(c);case 1:return x(c,u);case 2:return x(c,u,d);case 3:return x(c,u,d,h);default:throw new Error("unreachable")}}},$n=Uj();var x2={exports:{}},y2={},b2={exports:{}},v2={};var $$;function ime(){if($$)return v2;$$=1;var e=Xf();function t(h,p){return h===p&&(h!==0||1/h===1/p)||h!==h&&p!==p}var n=typeof Object.is=="function"?Object.is:t,s=e.useState,r=e.useEffect,i=e.useLayoutEffect,o=e.useDebugValue;function l(h,p){var x=p(),b=s({inst:{value:x,getSnapshot:p}}),j=b[0].inst,y=b[1];return i(function(){j.value=x,j.getSnapshot=p,c(j)&&y({inst:j})},[h,x,p]),r(function(){return c(j)&&y({inst:j}),h(function(){c(j)&&y({inst:j})})},[h]),o(x),x}function c(h){var p=h.getSnapshot;h=h.value;try{var x=p();return!n(h,x)}catch{return!0}}function u(h,p){return p()}var d=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?u:l;return v2.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:d,v2}var R$;function ome(){return R$||(R$=1,b2.exports=ime()),b2.exports}var z$;function lme(){if(z$)return y2;z$=1;var e=Xf(),t=ome();function n(u,d){return u===d&&(u!==0||1/u===1/d)||u!==u&&d!==d}var s=typeof Object.is=="function"?Object.is:n,r=t.useSyncExternalStore,i=e.useRef,o=e.useEffect,l=e.useMemo,c=e.useDebugValue;return y2.useSyncExternalStoreWithSelector=function(u,d,h,p,x){var b=i(null);if(b.current===null){var j={hasValue:!1,value:null};b.current=j}else j=b.current;b=l(function(){function N(k){if(!w){if(w=!0,S=k,k=p(k),x!==void 0&&j.hasValue){var A=j.value;if(x(A,k))return _=A}return _=k}if(A=_,s(S,k))return A;var E=p(k);return x!==void 0&&x(A,E)?(S=k,A):(S=k,_=E)}var w=!1,S,_,T=h===void 0?null:h;return[function(){return N(d())},T===null?void 0:function(){return N(T())}]},[d,h,p,x]);var y=r(u,b[0],b[1]);return o(function(){j.hasValue=!0,j.value=y},[y]),c(y),y},y2}var F$;function cme(){return F$||(F$=1,x2.exports=lme()),x2.exports}var fq=cme();function dme(e,t,n,s,r){const i=o=>t(o,n,s,r);return fq.useSyncExternalStoreWithSelector(e.subscribe,e.getSnapshot,e.getSnapshot,i)}const U$={};function Bj(e,t){const n=f.useRef(U$);return n.current===U$&&(n.current=e(t)),n}const ume=[];function hq(e){f.useEffect(e,ume)}const mme=()=>{};function fme(e,t,n){const s=Bj(hme,{store:e,selector:t}).current;s.effect=n,hq(s.onMount)}function hme(e){const{store:t,selector:n}=e;let s=n(t.state);const r={effect:mme,dispose:null,subscribe:()=>{r.dispose??=t.subscribe(i=>{const o=n(i);if(!Object.is(s,o)){const l=s;s=o,r.effect(l,o)}})},onMount:()=>(r.subscribe(),()=>{r.dispose?.(),r.dispose=null})};return r.subscribe(),r}class KL{static create(t){return new KL(t)}constructor(t){this.state=t,this.listeners=new Set,this.updateTick=0}subscribe=t=>(this.listeners.add(t),()=>{this.listeners.delete(t)});getSnapshot=()=>this.state;setState(t){this.state=t,this.updateTick+=1;const n=this.updateTick,s=this.listeners.values();let r;for(;r=s.next(),!r.done;){if(n!==this.updateTick)return;const i=r.value;i(t)}}update(t){for(const n in t)if(!Object.is(this.state[n],t[n])){this.setState(Ze({},this.state,t));return}}set(t,n){Object.is(this.state[t],n)||this.setState(Ze({},this.state,{[t]:n}))}}const Hj=({params:e,store:t})=>{f.useEffect(()=>{t.set("animation",Ze({},t.state.animation,{skip:e.skipAnimation}))},[t,e.skipAnimation]);const n=f.useCallback(()=>{let s=!1;return t.set("animation",Ze({},t.state.animation,{skipAnimationRequests:t.state.animation.skipAnimationRequests+1})),()=>{s||(s=!0,t.set("animation",Ze({},t.state.animation,{skipAnimationRequests:t.state.animation.skipAnimationRequests-1})))}},[t]);return ls(()=>{if(typeof window>"u"||!window?.matchMedia)return;let r;const i=l=>{l.matches?r=n():r?.()},o=window.matchMedia("(prefers-reduced-motion)");return i(o),o.addEventListener("change",i),()=>{o.removeEventListener("change",i)}},[n,t]),{instance:{disableAnimation:n}}};Hj.params={skipAnimation:!0};Hj.getDefaultizedParams=({params:e})=>Ze({},e,{skipAnimation:e.skipAnimation??!1});Hj.getInitialState=({skipAnimation:e})=>({animation:{skip:e,skipAnimationRequests:0}});const gme=e=>e.animation,pme=Lt(gme,e=>e.skip||e.skipAnimationRequests>0);function xme(e,t){const n=f.useRef(!0);f.useEffect(()=>{if(n.current){n.current=!1;return}return e()},t)}function wk(e){return e&&e.ownerDocument||document}function yme(e){return wk(e).defaultView||window}const Vt=dme,qj="DEFAULT_X_AXIS_KEY",bme="DEFAULT_Y_AXIS_KEY",vme={top:20,bottom:20,left:20,right:20},wme=45,jme=25,gq=20,Qo=e=>e.cartesianAxis?.x,sc=e=>e.cartesianAxis?.y,Nme=Lt(sc,function(t){return(t??[]).reduce((n,s)=>s.position==="left"?n+(s.width||0)+(s.zoom?.slider.enabled?s.zoom.slider.size:0):n,0)}),Cme=Lt(sc,function(t){return(t??[]).reduce((n,s)=>s.position==="right"?n+(s.width||0)+(s.zoom?.slider.enabled?s.zoom.slider.size:0):n,0)}),Sme=Lt(Qo,function(t){return(t??[]).reduce((n,s)=>s.position==="top"?n+(s.height||0)+(s.zoom?.slider.enabled?s.zoom.slider.size:0):n,0)}),_me=Lt(Qo,function(t){return(t??[]).reduce((n,s)=>s.position==="bottom"?n+(s.height||0)+(s.zoom?.slider.enabled?s.zoom.slider.size:0):n,0)}),Ame=$n(Nme,Cme,Sme,_me,function(t,n,s,r){return{left:t,right:n,top:s,bottom:r}}),jx=e=>e.dimensions,Tme=e=>e.dimensions.margin,wr=$n(jx,Tme,Ame,function({width:t,height:n},{top:s,right:r,bottom:i,left:o},{left:l,right:c,top:u,bottom:d}){return{width:t-o-r-l-c,left:o+l,right:r+c,height:n-s-i-u-d,top:s+u,bottom:i+d}}),kme=Lt(jx,e=>e.width),Eme=Lt(jx,e=>e.height),pq=Lt(jx,e=>e.propsWidth),xq=Lt(jx,e=>e.propsHeight);function Lme(e,t){return typeof e=="number"?{top:e,bottom:e,left:e,right:e}:t?Ze({},t,e):e}const Dme=10,Gj=({params:e,store:t,svgRef:n})=>{const s=e.width!==void 0&&e.height!==void 0,r=f.useRef({displayError:!1,initialCompute:!0,computeRun:0}),[i,o]=f.useState(0),[l,c]=f.useState(0),u=f.useCallback(()=>{const b=n?.current;if(!b)return{};const y=yme(b).getComputedStyle(b),N=Math.floor(parseFloat(y.height))||0,w=Math.floor(parseFloat(y.width))||0;return(t.state.dimensions.width!==w||t.state.dimensions.height!==N)&&t.set("dimensions",{margin:{top:e.margin.top,right:e.margin.right,bottom:e.margin.bottom,left:e.margin.left},width:e.width??w,height:e.height??N,propsWidth:e.width,propsHeight:e.height}),{height:N,width:w}},[t,n,e.height,e.width,e.margin.left,e.margin.right,e.margin.top,e.margin.bottom]);xme(()=>{const b=e.width??t.state.dimensions.width,j=e.height??t.state.dimensions.height;t.set("dimensions",{margin:{top:e.margin.top,right:e.margin.right,bottom:e.margin.bottom,left:e.margin.left},width:b,height:j,propsHeight:e.height,propsWidth:e.width})},[t,e.height,e.width,e.margin.left,e.margin.right,e.margin.top,e.margin.bottom]),f.useEffect(()=>{r.current.displayError=!0},[]),ls(()=>{if(s||!r.current.initialCompute||r.current.computeRun>Dme)return;const b=u();b.width!==i||b.height!==l?(r.current.computeRun+=1,b.width!==void 0&&o(b.width),b.height!==void 0&&c(b.height)):r.current.initialCompute&&(r.current.initialCompute=!1)},[l,i,u,s]),ls(()=>{if(s)return()=>{};u();const b=n.current;if(typeof ResizeObserver>"u")return()=>{};let j;const y=new ResizeObserver(()=>{j=requestAnimationFrame(()=>{u()})});return b&&y.observe(b),()=>{j&&cancelAnimationFrame(j),b&&y.unobserve(b)}},[u,s,n]);const d=Vt(t,wr),h=f.useCallback(b=>b>=d.left-1&&b<=d.left+d.width,[d.left,d.width]),p=f.useCallback(b=>b>=d.top-1&&b<=d.top+d.height,[d.height,d.top]);return{instance:{isPointInside:f.useCallback((b,j,y)=>y&&"closest"in y&&y.closest("[data-drawing-container]")?!0:h(b)&&p(j),[h,p]),isXInside:h,isYInside:p}}};Gj.params={width:!0,height:!0,margin:!0};Gj.getDefaultizedParams=({params:e})=>Ze({},e,{margin:Lme(e.margin,vme)});Gj.getInitialState=({width:e,height:t,margin:n})=>({dimensions:{margin:n,width:e??0,height:t??0,propsWidth:e,propsHeight:t}});const XL=({params:e,store:t})=>(ls(()=>{t.set("experimentalFeatures",e.experimentalFeatures)},[t,e.experimentalFeatures]),{});XL.params={experimentalFeatures:!0};XL.getInitialState=({experimentalFeatures:e})=>({experimentalFeatures:e});const Pme=e=>e.experimentalFeatures,Wj=Lt(Pme,e=>!!e?.preferStrictDomainInLineCharts);let B$=0;const Ome=()=>(B$+=1,`mui-chart-${B$}`),ZL=({params:e,store:t})=>(f.useEffect(()=>{e.id===void 0||e.id===t.state.id.providedChartId&&t.state.id.chartId!==void 0||t.set("id",Ze({},t.state.id,{chartId:e.id??Ome()}))},[t,e.id]),{});ZL.params={id:!0};ZL.getInitialState=({id:e})=>({id:{chartId:e,providedChartId:e}});const Mme=e=>e.id,Ime=Lt(Mme,e=>e.chartId),$me=["#4254FB","#FFB422","#FA4F58","#0DBEFF","#22BF75","#FA83B4","#FF7511"],Rme=["#495AFB","#FFC758","#F35865","#30C8FF","#44CE8D","#F286B3","#FF8C39"],yq=e=>e==="dark"?Rme:$me,bq=({series:e,colors:t,seriesConfig:n})=>{const s={};return e.forEach((r,i)=>{const o=n[r.type].getSeriesWithDefaultValues(r,i,t),l=o.id;if(s[r.type]===void 0&&(s[r.type]={series:{},seriesOrder:[]}),s[r.type]?.series[l]!==void 0)throw new Error(`MUI X Charts: series' id "${l}" is not unique.`);s[r.type].series[l]=o,s[r.type].seriesOrder.push(l)}),s},zme=(e,t,n)=>{const s={};return Object.keys(t).forEach(r=>{const i=e[r];i!==void 0&&(s[r]=t[r]?.seriesProcessor?.(i,n)??i)}),s},Vj=({params:e,store:t,seriesConfig:n})=>{const{series:s,dataset:r,theme:i,colors:o}=e,l=f.useRef(!0);return f.useEffect(()=>{if(l.current){l.current=!1;return}t.set("series",Ze({},t.state.series,{defaultizedSeries:bq({series:s,colors:typeof o=="function"?o(i):o,seriesConfig:n}),dataset:r}))},[o,r,s,i,n,t]),{}};Vj.params={dataset:!0,series:!0,colors:!0,theme:!0};const Fme=[];Vj.getDefaultizedParams=({params:e})=>Ze({},e,{series:e.series?.length?e.series:Fme,colors:e.colors??yq,theme:e.theme??"light"});Vj.getInitialState=({series:e=[],colors:t,theme:n,dataset:s},r,i)=>({series:{seriesConfig:i,defaultizedSeries:bq({series:e,colors:typeof t=="function"?t(n):t,seriesConfig:i}),dataset:s}});const JL=e=>e.series,Ume=Lt(JL,e=>e.defaultizedSeries),Vr=Lt(JL,e=>e.seriesConfig),Bme=Lt(JL,e=>e.dataset),yn=$n(Ume,Vr,Bme,function(t,n,s){return zme(t,n,s)}),Hme={abort:!0,animationcancel:!0,animationend:!0,animationiteration:!0,animationstart:!0,auxclick:!0,beforeinput:!0,beforetoggle:!0,blur:!0,cancel:!0,canplay:!0,canplaythrough:!0,change:!0,click:!0,close:!0,compositionend:!0,compositionstart:!0,compositionupdate:!0,contextlost:!0,contextmenu:!0,contextrestored:!0,copy:!0,cuechange:!0,cut:!0,dblclick:!0,drag:!0,dragend:!0,dragenter:!0,dragleave:!0,dragover:!0,dragstart:!0,drop:!0,durationchange:!0,emptied:!0,ended:!0,error:!0,focus:!0,focusin:!0,focusout:!0,formdata:!0,gotpointercapture:!0,input:!0,invalid:!0,keydown:!0,keypress:!0,keyup:!0,load:!0,loadeddata:!0,loadedmetadata:!0,loadstart:!0,lostpointercapture:!0,mousedown:!0,mouseenter:!0,mouseleave:!0,mousemove:!0,mouseout:!0,mouseover:!0,mouseup:!0,paste:!0,pause:!0,play:!0,playing:!0,pointercancel:!0,pointerdown:!0,pointerenter:!0,pointerleave:!0,pointermove:!0,pointerout:!0,pointerover:!0,pointerup:!0,progress:!0,ratechange:!0,reset:!0,resize:!0,scroll:!0,scrollend:!0,securitypolicyviolation:!0,seeked:!0,seeking:!0,select:!0,selectionchange:!0,selectstart:!0,slotchange:!0,stalled:!0,submit:!0,suspend:!0,timeupdate:!0,toggle:!0,touchcancel:!0,touchend:!0,touchmove:!0,touchstart:!0,transitioncancel:!0,transitionend:!0,transitionrun:!0,transitionstart:!0,volumechange:!0,waiting:!0,webkitanimationend:!0,webkitanimationiteration:!0,webkitanimationstart:!0,webkittransitionend:!0,wheel:!0,beforematch:!0,pointerrawupdate:!0};class vq{customData={};constructor(t){if(!t||!t.name)throw new Error("Gesture must be initialized with a valid name.");if(t.name in Hme)throw new Error(`Gesture can't be created with a native event name. Tried to use "${t.name}". Please use a custom name instead.`);this.name=t.name,this.preventDefault=t.preventDefault??!1,this.stopPropagation=t.stopPropagation??!1,this.preventIf=t.preventIf??[],this.requiredKeys=t.requiredKeys??[],this.pointerMode=t.pointerMode??[],this.pointerOptions=t.pointerOptions??{}}init(t,n,s,r){this.element=t,this.pointerManager=n,this.gesturesRegistry=s,this.keyboardManager=r;const i=`${this.name}ChangeOptions`;this.element.addEventListener(i,this.handleOptionsChange);const o=`${this.name}ChangeState`;this.element.addEventListener(o,this.handleStateChange)}handleOptionsChange=t=>{t&&t.detail&&this.updateOptions(t.detail)};updateOptions(t){this.preventDefault=t.preventDefault??this.preventDefault,this.stopPropagation=t.stopPropagation??this.stopPropagation,this.preventIf=t.preventIf??this.preventIf,this.requiredKeys=t.requiredKeys??this.requiredKeys,this.pointerMode=t.pointerMode??this.pointerMode,this.pointerOptions=t.pointerOptions??this.pointerOptions}getBaseConfig(){return{requiredKeys:this.requiredKeys}}getEffectiveConfig(t,n){if(t!=="mouse"&&t!=="touch"&&t!=="pen")return n;const s=this.pointerOptions[t];return s?Ze({},n,s):n}handleStateChange=t=>{t&&t.detail&&this.updateState(t.detail)};updateState(t){Object.assign(this.state,t)}getTargetElement(t){return this.isActive||this.element===t.target||"contains"in this.element&&this.element.contains(t.target)||"getRootNode"in this.element&&this.element.getRootNode()instanceof ShadowRoot&&t.composedPath().includes(this.element)?this.element:null}set isActive(t){t?this.gesturesRegistry.registerActiveGesture(this.element,this):this.gesturesRegistry.unregisterActiveGesture(this.element,this)}get isActive(){return this.gesturesRegistry.isGestureActive(this.element,this)??!1}shouldPreventGesture(t,n){const s=this.getEffectiveConfig(n,this.getBaseConfig());if(!this.keyboardManager.areKeysPressed(s.requiredKeys))return!0;if(this.preventIf.length===0)return!1;const r=this.gesturesRegistry.getActiveGestures(t);return this.preventIf.some(i=>r[i])}isPointerTypeAllowed(t){return!this.pointerMode||this.pointerMode.length===0?!0:this.pointerMode.includes(t)}destroy(){const t=`${this.name}ChangeOptions`;this.element.removeEventListener(t,this.handleOptionsChange);const n=`${this.name}ChangeState`;this.element.removeEventListener(n,this.handleStateChange)}}class qme{activeGestures=new Map;registerActiveGesture(t,n){this.activeGestures.has(t)||this.activeGestures.set(t,new Set);const s=this.activeGestures.get(t),r={gesture:n,element:t};s.add(r)}unregisterActiveGesture(t,n){const s=this.activeGestures.get(t);s&&(s.forEach(r=>{r.gesture===n&&s.delete(r)}),s.size===0&&this.activeGestures.delete(t))}getActiveGestures(t){const n=this.activeGestures.get(t);return n?Array.from(n).reduce((s,r)=>(s[r.gesture.name]=!0,s),{}):{}}isGestureActive(t,n){const s=this.activeGestures.get(t);return s?Array.from(s).some(r=>r.gesture===n):!1}destroy(){this.activeGestures.clear()}unregisterElement(t){this.activeGestures.delete(t)}}class Gme{pressedKeys=new Set;constructor(){this.initialize()}initialize(){typeof window>"u"||(window.addEventListener("keydown",this.handleKeyDown),window.addEventListener("keyup",this.handleKeyUp),window.addEventListener("blur",this.clearKeys))}handleKeyDown=t=>{this.pressedKeys.add(t.key)};handleKeyUp=t=>{this.pressedKeys.delete(t.key)};clearKeys=()=>{this.pressedKeys.clear()};areKeysPressed(t){return!t||t.length===0?!0:t.every(n=>n==="ControlOrMeta"?navigator.platform.includes("Mac")?this.pressedKeys.has("Meta"):this.pressedKeys.has("Control"):this.pressedKeys.has(n))}destroy(){typeof window<"u"&&(window.removeEventListener("keydown",this.handleKeyDown),window.removeEventListener("keyup",this.handleKeyUp),window.removeEventListener("blur",this.clearKeys)),this.clearKeys()}}class Wme{preventEventInterruption=!0;pointers=new Map;gestureHandlers=new Set;constructor(t){this.root=t.root??document.getRootNode({composed:!0})??document.body,this.touchAction=t.touchAction||"auto",this.passive=t.passive??!1,this.preventEventInterruption=t.preventEventInterruption??!0,this.setupEventListeners()}registerGestureHandler(t){return this.gestureHandlers.add(t),()=>{this.gestureHandlers.delete(t)}}getPointers(){return new Map(this.pointers)}setupEventListeners(){this.touchAction!=="auto"&&(this.root.style.touchAction=this.touchAction),this.root.addEventListener("pointerdown",this.handlePointerEvent,{passive:this.passive}),this.root.addEventListener("pointermove",this.handlePointerEvent,{passive:this.passive}),this.root.addEventListener("pointerup",this.handlePointerEvent,{passive:this.passive}),this.root.addEventListener("pointercancel",this.handlePointerEvent,{passive:this.passive}),this.root.addEventListener("forceCancel",this.handlePointerEvent,{passive:this.passive}),this.root.addEventListener("blur",this.handleInterruptEvents),this.root.addEventListener("contextmenu",this.handleInterruptEvents)}handleInterruptEvents=t=>{if(this.preventEventInterruption&&"pointerType"in t&&t.pointerType==="touch"){t.preventDefault();return}const n=new PointerEvent("forceCancel",{bubbles:!1,cancelable:!1}),s=this.pointers.values().next().value;if(this.pointers.size>0&&s){Object.defineProperties(n,{clientX:{value:s.clientX},clientY:{value:s.clientY},pointerId:{value:s.pointerId},pointerType:{value:s.pointerType}});for(const[r,i]of this.pointers.entries()){const o=Ze({},i,{type:"forceCancel"});this.pointers.set(r,o)}}this.notifyHandlers(n),this.pointers.clear()};handlePointerEvent=t=>{const{type:n,pointerId:s}=t;if(n==="pointerdown"||n==="pointermove")this.pointers.set(s,this.createPointerData(t));else if(n==="pointerup"||n==="pointercancel"||n==="forceCancel"){this.pointers.set(s,this.createPointerData(t)),this.notifyHandlers(t),this.pointers.delete(s);return}this.notifyHandlers(t)};notifyHandlers(t){this.gestureHandlers.forEach(n=>n(this.pointers,t))}createPointerData(t){return{pointerId:t.pointerId,clientX:t.clientX,clientY:t.clientY,pageX:t.pageX,pageY:t.pageY,target:t.target,timeStamp:t.timeStamp,type:t.type,isPrimary:t.isPrimary,pressure:t.pressure,width:t.width,height:t.height,pointerType:t.pointerType,srcEvent:t}}destroy(){this.root.removeEventListener("pointerdown",this.handlePointerEvent),this.root.removeEventListener("pointermove",this.handlePointerEvent),this.root.removeEventListener("pointerup",this.handlePointerEvent),this.root.removeEventListener("pointercancel",this.handlePointerEvent),this.root.removeEventListener("forceCancel",this.handlePointerEvent),this.root.removeEventListener("blur",this.handleInterruptEvents),this.root.removeEventListener("contextmenu",this.handleInterruptEvents),this.pointers.clear(),this.gestureHandlers.clear()}}class Vme{gestureTemplates=new Map;elementGestureMap=new Map;activeGesturesRegistry=new qme;keyboardManager=new Gme;constructor(t){this.pointerManager=new Wme({root:t.root,touchAction:t.touchAction,passive:t.passive}),t.gestures&&t.gestures.length>0&&t.gestures.forEach(n=>{this.addGestureTemplate(n)})}addGestureTemplate(t){this.gestureTemplates.has(t.name)&&console.warn(`Gesture template with name "${t.name}" already exists. It will be overwritten.`),this.gestureTemplates.set(t.name,t)}setGestureOptions(t,n,s){const r=this.elementGestureMap.get(n);if(!r||!r.has(t)){console.error(`Gesture "${t}" not found on the provided element.`);return}const i=new CustomEvent(`${t}ChangeOptions`,{detail:s,bubbles:!1,cancelable:!1,composed:!1});n.dispatchEvent(i)}setGestureState(t,n,s){const r=this.elementGestureMap.get(n);if(!r||!r.has(t)){console.error(`Gesture "${t}" not found on the provided element.`);return}const i=new CustomEvent(`${t}ChangeState`,{detail:s,bubbles:!1,cancelable:!1,composed:!1});n.dispatchEvent(i)}registerElement(t,n,s){return Array.isArray(t)||(t=[t]),t.forEach(r=>{const i=s?.[r];this.registerSingleGesture(r,n,i)}),n}registerSingleGesture(t,n,s){const r=this.gestureTemplates.get(t);if(!r)return console.error(`Gesture template "${t}" not found.`),!1;this.elementGestureMap.has(n)||this.elementGestureMap.set(n,new Map);const i=this.elementGestureMap.get(n);i.has(t)&&(console.warn(`Element already has gesture "${t}" registered. It will be replaced.`),this.unregisterElement(t,n));const o=r.clone(s);return o.init(n,this.pointerManager,this.activeGesturesRegistry,this.keyboardManager),i.set(t,o),!0}unregisterElement(t,n){const s=this.elementGestureMap.get(n);return!s||!s.has(t)?!1:(s.get(t).destroy(),s.delete(t),this.activeGesturesRegistry.unregisterElement(n),s.size===0&&this.elementGestureMap.delete(n),!0)}unregisterAllGestures(t){const n=this.elementGestureMap.get(t);if(n){for(const[,s]of n)s.destroy(),this.activeGesturesRegistry.unregisterElement(t);this.elementGestureMap.delete(t)}}destroy(){for(const[t]of this.elementGestureMap)this.unregisterAllGestures(t);this.gestureTemplates.clear(),this.elementGestureMap.clear(),this.activeGesturesRegistry.destroy(),this.keyboardManager.destroy(),this.pointerManager.destroy()}}class nm extends vq{unregisterHandler=null;originalTarget=null;constructor(t){super(t),this.minPointers=t.minPointers??1,this.maxPointers=t.maxPointers??1/0}init(t,n,s,r){super.init(t,n,s,r),this.unregisterHandler=this.pointerManager.registerGestureHandler(this.handlePointerEvent)}updateOptions(t){super.updateOptions(t),this.minPointers=t.minPointers??this.minPointers,this.maxPointers=t.maxPointers??this.maxPointers}getBaseConfig(){return{requiredKeys:this.requiredKeys,minPointers:this.minPointers,maxPointers:this.maxPointers}}isWithinPointerCount(t,n){const s=this.getEffectiveConfig(n,this.getBaseConfig());return t.length>=s.minPointers&&t.length<=s.maxPointers}getRelevantPointers(t,n){return t.filter(s=>this.isPointerTypeAllowed(s.pointerType)&&(n===s.target||s.target===this.originalTarget||n===this.originalTarget||"contains"in n&&n.contains(s.target))||"getRootNode"in n&&n.getRootNode()instanceof ShadowRoot&&s.srcEvent.composedPath().includes(n))}destroy(){this.unregisterHandler&&(this.unregisterHandler(),this.unregisterHandler=null),super.destroy()}}function Yme(e,t){const n=t.x-e.x,s=t.y-e.y;return Math.sqrt(n*n+s*s)}function w2(e){if(e.length<2)return 0;let t=0,n=0;for(let s=0;s<e.length;s+=1)for(let r=s+1;r<e.length;r+=1)t+=Yme({x:e[s].clientX,y:e[s].clientY},{x:e[r].clientX,y:e[r].clientY}),n+=1;return n>0?t/n:0}function Hl(e){if(e.length===0)return{x:0,y:0};const t=e.reduce((n,s)=>(n.x+=s.clientX,n.y+=s.clientY,n),{x:0,y:0});return{x:t.x/e.length,y:t.y/e.length}}function xi(e,t){return`${e}${t==="ongoing"?"":t.charAt(0).toUpperCase()+t.slice(1)}`}const Ky=1e-5,Rc=1e-5,H$=.15;function Qme(e,t){const n=t.x-e.x,s=t.y-e.y,r={vertical:null,horizontal:null,mainAxis:null},i=Kme(t,e),o=Math.abs(n)>Math.abs(s)?"horizontal":"vertical",l=i||o==="horizontal"?Ky:H$,c=i?Ky:o==="horizontal"?H$:Ky;return Math.abs(n)>l&&(r.horizontal=n>0?"right":"left"),Math.abs(s)>c&&(r.vertical=s>0?"down":"up"),r.mainAxis=i?"diagonal":o,r}function Kme(e,t){const n=t.x-e.x,s=t.y-e.y,r=Math.atan2(s,n)*180/Math.PI;return r>=-45+Rc&&r<=-22.5+Rc||r>=22.5+Rc&&r<=45+Rc||r>=135+Rc&&r<=157.5+Rc||r>=-157.5+Rc&&r<=-135+Rc}function Xme(e,t){if(!e.vertical&&!e.horizontal)return!1;if(t.length===0)return!0;const n=e.vertical===null||t.includes(e.vertical),s=e.horizontal===null||t.includes(e.horizontal);return n&&s}const q$=0,Zme=e=>e>q$?1:e<-q$?-1:0,Wc=e=>{e.cancelable&&e.preventDefault()};class e4 extends nm{state={lastPosition:null};constructor(t){super(t),this.threshold=t.threshold||0}clone(t){return new e4(Ze({name:this.name,preventDefault:this.preventDefault,stopPropagation:this.stopPropagation,threshold:this.threshold,minPointers:this.minPointers,maxPointers:this.maxPointers,requiredKeys:[...this.requiredKeys],pointerMode:[...this.pointerMode],preventIf:[...this.preventIf],pointerOptions:structuredClone(this.pointerOptions)},t))}init(t,n,s,r){super.init(t,n,s,r),this.element.addEventListener("pointerenter",this.handleElementEnter),this.element.addEventListener("pointerleave",this.handleElementLeave)}destroy(){this.element.removeEventListener("pointerenter",this.handleElementEnter),this.element.removeEventListener("pointerleave",this.handleElementLeave),this.resetState(),super.destroy()}updateOptions(t){super.updateOptions(t)}resetState(){this.isActive=!1,this.state={lastPosition:null}}handleElementEnter=t=>{if(t.pointerType!=="mouse"&&t.pointerType!=="pen")return;const n=this.pointerManager.getPointers()||new Map,s=Array.from(n.values());if(this.isWithinPointerCount(s,t.pointerType)){this.isActive=!0;const r={x:t.clientX,y:t.clientY};this.state.lastPosition=r,this.emitMoveEvent(this.element,"start",s,t),this.emitMoveEvent(this.element,"ongoing",s,t)}};handleElementLeave=t=>{if(t.pointerType!=="mouse"&&t.pointerType!=="pen"||!this.isActive)return;const n=this.pointerManager.getPointers()||new Map,s=Array.from(n.values());this.emitMoveEvent(this.element,"end",s,t),this.resetState()};handlePointerEvent=(t,n)=>{if(n.type!=="pointermove"||n.pointerType!=="mouse"&&n.pointerType!=="pen")return;this.preventDefault&&n.preventDefault(),this.stopPropagation&&n.stopPropagation();const s=Array.from(t.values()),r=this.getTargetElement(n);if(!r||!this.isWithinPointerCount(s,n.pointerType))return;if(this.shouldPreventGesture(r,n.pointerType)){if(!this.isActive)return;this.resetState(),this.emitMoveEvent(r,"end",s,n);return}const i={x:n.clientX,y:n.clientY};this.state.lastPosition=i,this.isActive||(this.isActive=!0,this.emitMoveEvent(r,"start",s,n)),this.emitMoveEvent(r,"ongoing",s,n)};emitMoveEvent(t,n,s,r){const i=this.state.lastPosition||Hl(s),o=this.gesturesRegistry.getActiveGestures(t),l={gestureName:this.name,centroid:i,target:r.target,srcEvent:r,phase:n,pointers:s,timeStamp:r.timeStamp,activeGestures:o,customData:this.customData},c=xi(this.name,n),u=new CustomEvent(c,{bubbles:!0,cancelable:!0,composed:!0,detail:l});t.dispatchEvent(u)}}class Tu extends nm{state={startPointers:new Map,startCentroid:null,lastCentroid:null,movementThresholdReached:!1,totalDeltaX:0,totalDeltaY:0,activeDeltaX:0,activeDeltaY:0,lastDirection:{vertical:null,horizontal:null,mainAxis:null},lastDeltas:null};constructor(t){super(t),this.direction=t.direction||["up","down","left","right"],this.threshold=t.threshold||0}clone(t){return new Tu(Ze({name:this.name,preventDefault:this.preventDefault,stopPropagation:this.stopPropagation,threshold:this.threshold,minPointers:this.minPointers,maxPointers:this.maxPointers,direction:[...this.direction],requiredKeys:[...this.requiredKeys],pointerMode:[...this.pointerMode],preventIf:[...this.preventIf],pointerOptions:structuredClone(this.pointerOptions)},t))}destroy(){this.resetState(),super.destroy()}updateOptions(t){super.updateOptions(t),this.direction=t.direction||this.direction,this.threshold=t.threshold??this.threshold}resetState(){this.isActive=!1,this.state=Ze({},this.state,{startPointers:new Map,startCentroid:null,lastCentroid:null,lastDeltas:null,activeDeltaX:0,activeDeltaY:0,movementThresholdReached:!1,lastDirection:{vertical:null,horizontal:null,mainAxis:null}})}handlePointerEvent=(t,n)=>{const s=Array.from(t.values());if(n.type==="forceCancel"){this.cancel(n.target,s,n);return}const r=this.getTargetElement(n);if(!r)return;if(this.shouldPreventGesture(r,n.pointerType)){this.cancel(r,s,n);return}const i=this.getRelevantPointers(s,r);if(!this.isWithinPointerCount(i,n.pointerType)){this.cancel(r,i,n);return}switch(n.type){case"pointerdown":!this.isActive&&!this.state.startCentroid&&(i.forEach(o=>{this.state.startPointers.set(o.pointerId,o)}),this.originalTarget=r,this.state.startCentroid=Hl(i),this.state.lastCentroid=Ze({},this.state.startCentroid));break;case"pointermove":if(this.state.startCentroid&&this.isWithinPointerCount(s,n.pointerType)){const o=Hl(i),l=o.x-this.state.startCentroid.x,c=o.y-this.state.startCentroid.y,u=Math.sqrt(l*l+c*c),d=Qme(this.state.lastCentroid??this.state.startCentroid,o),h=this.state.lastCentroid?o.x-this.state.lastCentroid.x:0,p=this.state.lastCentroid?o.y-this.state.lastCentroid.y:0;!this.state.movementThresholdReached&&u>=this.threshold&&Xme(d,this.direction)?(this.state.movementThresholdReached=!0,this.isActive=!0,this.state.lastDeltas={x:h,y:p},this.state.totalDeltaX+=h,this.state.totalDeltaY+=p,this.state.activeDeltaX+=h,this.state.activeDeltaY+=p,this.emitPanEvent(r,"start",i,n,o),this.emitPanEvent(r,"ongoing",i,n,o)):this.state.movementThresholdReached&&this.isActive&&(this.state.lastDeltas={x:h,y:p},this.state.totalDeltaX+=h,this.state.totalDeltaY+=p,this.state.activeDeltaX+=h,this.state.activeDeltaY+=p,this.emitPanEvent(r,"ongoing",i,n,o)),this.state.lastCentroid=o,this.state.lastDirection=d}break;case"pointerup":case"pointercancel":case"forceCancel":if(this.isActive&&this.state.movementThresholdReached){const o=i.filter(l=>l.type!=="pointerup"&&l.type!=="pointercancel");if(!this.isWithinPointerCount(o,n.pointerType)){const l=this.state.lastCentroid||this.state.startCentroid;n.type==="pointercancel"&&this.emitPanEvent(r,"cancel",i,n,l),this.emitPanEvent(r,"end",i,n,l),this.resetState()}}else this.resetState();break}};emitPanEvent(t,n,s,r,i){if(!this.state.startCentroid)return;const o=this.state.lastDeltas?.x??0,l=this.state.lastDeltas?.y??0,c=this.state.startPointers.values().next().value,u=c?(r.timeStamp-c.timeStamp)/1e3:0,d=u>0?o/u:0,h=u>0?l/u:0,p=Math.sqrt(d*d+h*h),x=this.gesturesRegistry.getActiveGestures(t),b={gestureName:this.name,initialCentroid:this.state.startCentroid,centroid:i,target:r.target,srcEvent:r,phase:n,pointers:s,timeStamp:r.timeStamp,deltaX:o,deltaY:l,direction:this.state.lastDirection,velocityX:d,velocityY:h,velocity:p,totalDeltaX:this.state.totalDeltaX,totalDeltaY:this.state.totalDeltaY,activeDeltaX:this.state.activeDeltaX,activeDeltaY:this.state.activeDeltaY,activeGestures:x,customData:this.customData},j=xi(this.name,n),y=new CustomEvent(j,{bubbles:!0,cancelable:!0,composed:!0,detail:b});t.dispatchEvent(y),this.preventDefault&&r.preventDefault(),this.stopPropagation&&r.stopPropagation()}cancel(t,n,s){if(this.isActive){const r=t??this.element;this.emitPanEvent(r,"cancel",n,s,this.state.lastCentroid),this.emitPanEvent(r,"end",n,s,this.state.lastCentroid)}this.resetState()}}class t4 extends nm{state={startDistance:0,lastDistance:0,lastScale:1,lastTime:0,velocity:0,totalScale:1,deltaScale:0};constructor(t){super(Ze({},t,{minPointers:t.minPointers??2})),this.threshold=t.threshold??0}clone(t){return new t4(Ze({name:this.name,preventDefault:this.preventDefault,stopPropagation:this.stopPropagation,threshold:this.threshold,minPointers:this.minPointers,maxPointers:this.maxPointers,requiredKeys:[...this.requiredKeys],pointerMode:[...this.pointerMode],preventIf:[...this.preventIf],pointerOptions:structuredClone(this.pointerOptions)},t))}destroy(){this.resetState(),super.destroy()}updateOptions(t){super.updateOptions(t)}resetState(){this.isActive=!1,this.state=Ze({},this.state,{startDistance:0,lastDistance:0,lastScale:1,lastTime:0,velocity:0,deltaScale:0})}handlePointerEvent=(t,n)=>{const s=Array.from(t.values()),r=this.getTargetElement(n);if(!r)return;if(this.shouldPreventGesture(r,n.pointerType)){this.isActive&&(this.emitPinchEvent(r,"cancel",s,n),this.resetState());return}const i=this.getRelevantPointers(s,r);switch(n.type){case"pointerdown":if(i.length>=2&&!this.isActive){const o=w2(i);this.state.startDistance=o,this.state.lastDistance=o,this.state.lastTime=n.timeStamp,this.originalTarget=r}break;case"pointermove":if(this.state.startDistance&&this.isWithinPointerCount(i,n.pointerType)){const o=w2(i),l=Math.abs(o-this.state.lastDistance);if(l!==0&&l>=this.threshold){const c=this.state.startDistance?o/this.state.startDistance:1,u=c/this.state.lastScale;this.state.totalScale*=u;const d=(n.timeStamp-this.state.lastTime)/1e3;if(this.state.lastDistance){const p=(o-this.state.lastDistance)/d;this.state.velocity=Number.isNaN(p)?0:p}this.state.lastDistance=o,this.state.deltaScale=c-this.state.lastScale,this.state.lastScale=c,this.state.lastTime=n.timeStamp,this.isActive?this.emitPinchEvent(r,"ongoing",i,n):(this.isActive=!0,this.emitPinchEvent(r,"start",i,n),this.emitPinchEvent(r,"ongoing",i,n))}}break;case"pointerup":case"pointercancel":case"forceCancel":if(this.isActive){const o=i.filter(l=>l.type!=="pointerup"&&l.type!=="pointercancel");if(!this.isWithinPointerCount(o,n.pointerType))n.type==="pointercancel"&&this.emitPinchEvent(r,"cancel",i,n),this.emitPinchEvent(r,"end",i,n),this.resetState();else if(o.length>=2){const l=w2(o);this.state.startDistance=l/this.state.lastScale}}break}};emitPinchEvent(t,n,s,r){const i=Hl(s),o=this.state.lastDistance,l=this.state.lastScale,c=this.gesturesRegistry.getActiveGestures(t),u={gestureName:this.name,centroid:i,target:r.target,srcEvent:r,phase:n,pointers:s,timeStamp:r.timeStamp,scale:l,deltaScale:this.state.deltaScale,totalScale:this.state.totalScale,distance:o,velocity:this.state.velocity,activeGestures:c,direction:Zme(this.state.velocity),customData:this.customData};this.preventDefault&&r.preventDefault(),this.stopPropagation&&r.stopPropagation();const d=xi(this.name,n),h=new CustomEvent(d,{bubbles:!0,cancelable:!0,composed:!0,detail:u});t.dispatchEvent(h)}}class Yj extends nm{state={startCentroid:null,lastPosition:null,timerId:null,startTime:0,pressThresholdReached:!1};constructor(t){super(t),this.duration=t.duration??500,this.maxDistance=t.maxDistance??10}clone(t){return new Yj(Ze({name:this.name,preventDefault:this.preventDefault,stopPropagation:this.stopPropagation,minPointers:this.minPointers,maxPointers:this.maxPointers,duration:this.duration,maxDistance:this.maxDistance,requiredKeys:[...this.requiredKeys],pointerMode:[...this.pointerMode],preventIf:[...this.preventIf],pointerOptions:structuredClone(this.pointerOptions)},t))}destroy(){this.clearPressTimer(),this.resetState(),super.destroy()}updateOptions(t){super.updateOptions(t),this.duration=t.duration??this.duration,this.maxDistance=t.maxDistance??this.maxDistance}resetState(){this.clearPressTimer(),this.isActive=!1,this.state=Ze({},this.state,{startCentroid:null,lastPosition:null,timerId:null,startTime:0,pressThresholdReached:!1})}clearPressTimer(){this.state.timerId!==null&&(clearTimeout(this.state.timerId),this.state.timerId=null)}handlePointerEvent=(t,n)=>{const s=Array.from(t.values());if(n.type==="forceCancel"){this.cancelPress(n.target,s,n);return}const r=this.getTargetElement(n);if(!r)return;if(this.shouldPreventGesture(r,n.pointerType)){this.isActive&&this.cancelPress(r,s,n);return}const i=this.getRelevantPointers(s,r);if(!this.isWithinPointerCount(i,n.pointerType)){this.isActive&&this.cancelPress(r,i,n);return}switch(n.type){case"pointerdown":!this.isActive&&!this.state.startCentroid&&(this.state.startCentroid=Hl(i),this.state.lastPosition=Ze({},this.state.startCentroid),this.state.startTime=n.timeStamp,this.isActive=!0,this.originalTarget=r,this.clearPressTimer(),this.state.timerId=setTimeout(()=>{if(this.isActive&&this.state.startCentroid){this.state.pressThresholdReached=!0;const o=this.state.lastPosition;this.emitPressEvent(r,"start",i,n,o),this.emitPressEvent(r,"ongoing",i,n,o)}},this.duration));break;case"pointermove":if(this.isActive&&this.state.startCentroid){const o=Hl(i);this.state.lastPosition=o;const l=o.x-this.state.startCentroid.x,c=o.y-this.state.startCentroid.y;Math.sqrt(l*l+c*c)>this.maxDistance&&this.cancelPress(r,i,n)}break;case"pointerup":if(this.isActive){if(this.state.pressThresholdReached){const o=this.state.lastPosition||this.state.startCentroid;this.emitPressEvent(r,"end",i,n,o)}this.resetState()}break;case"pointercancel":case"forceCancel":this.cancelPress(r,i,n);break}};emitPressEvent(t,n,s,r,i){const o=this.gesturesRegistry.getActiveGestures(t),l=r.timeStamp-this.state.startTime,c={gestureName:this.name,centroid:i,target:r.target,srcEvent:r,phase:n,pointers:s,timeStamp:r.timeStamp,x:i.x,y:i.y,duration:l,activeGestures:o,customData:this.customData},u=xi(this.name,n),d=new CustomEvent(u,{bubbles:!0,cancelable:!0,composed:!0,detail:c});t.dispatchEvent(d),this.preventDefault&&r.preventDefault(),this.stopPropagation&&r.stopPropagation()}cancelPress(t,n,s){if(this.isActive&&this.state.pressThresholdReached){const r=this.state.lastPosition||this.state.startCentroid;this.emitPressEvent(t??this.element,"cancel",n,s,r),this.emitPressEvent(t??this.element,"end",n,s,r)}this.resetState()}}class a4 extends nm{state={phase:"waitingForPress",dragTimeoutId:null};constructor(t){super(t),this.pressDuration=t.pressDuration??500,this.pressMaxDistance=t.pressMaxDistance??10,this.dragTimeout=t.dragTimeout??1e3,this.dragThreshold=t.dragThreshold??0,this.dragDirection=t.dragDirection||["up","down","left","right"],this.pressGesture=new Yj({name:`${this.name}-press`,duration:this.pressDuration,maxDistance:this.pressMaxDistance,maxPointers:this.maxPointers,pointerMode:this.pointerMode,requiredKeys:this.requiredKeys,preventIf:this.preventIf,pointerOptions:structuredClone(this.pointerOptions)}),this.panGesture=new Tu({name:`${this.name}-pan`,minPointers:this.minPointers,maxPointers:this.maxPointers,threshold:this.dragThreshold,direction:this.dragDirection,pointerMode:this.pointerMode,requiredKeys:this.requiredKeys,preventIf:this.preventIf,pointerOptions:structuredClone(this.pointerOptions)})}clone(t){return new a4(Ze({name:this.name,preventDefault:this.preventDefault,stopPropagation:this.stopPropagation,minPointers:this.minPointers,maxPointers:this.maxPointers,pressDuration:this.pressDuration,pressMaxDistance:this.pressMaxDistance,dragTimeout:this.dragTimeout,dragThreshold:this.dragThreshold,dragDirection:[...this.dragDirection],requiredKeys:[...this.requiredKeys],pointerMode:[...this.pointerMode],preventIf:[...this.preventIf],pointerOptions:structuredClone(this.pointerOptions)},t))}init(t,n,s,r){super.init(t,n,s,r),this.pressGesture.init(t,n,s,r),this.panGesture.init(t,n,s,r),this.element.addEventListener(this.pressGesture.name,this.pressHandler),this.element.addEventListener(`${this.panGesture.name}Start`,this.dragStartHandler),this.element.addEventListener(this.panGesture.name,this.dragMoveHandler),this.element.addEventListener(`${this.panGesture.name}End`,this.dragEndHandler),this.element.addEventListener(`${this.panGesture.name}Cancel`,this.dragEndHandler)}destroy(){this.resetState(),this.pressGesture.destroy(),this.panGesture.destroy(),this.element.removeEventListener(this.pressGesture.name,this.pressHandler),this.element.removeEventListener(`${this.panGesture.name}Start`,this.dragStartHandler),this.element.removeEventListener(this.panGesture.name,this.dragMoveHandler),this.element.removeEventListener(`${this.panGesture.name}End`,this.dragEndHandler),this.element.removeEventListener(`${this.panGesture.name}Cancel`,this.dragEndHandler),super.destroy()}updateOptions(t){super.updateOptions(t),this.pressDuration=t.pressDuration??this.pressDuration,this.pressMaxDistance=t.pressMaxDistance??this.pressMaxDistance,this.dragTimeout=t.dragTimeout??this.dragTimeout,this.dragThreshold=t.dragThreshold??this.dragThreshold,this.dragDirection=t.dragDirection||this.dragDirection,this.element.dispatchEvent(new CustomEvent(`${this.panGesture.name}ChangeOptions`,{detail:{minPointers:this.minPointers,maxPointers:this.maxPointers,threshold:this.dragThreshold,direction:this.dragDirection,pointerMode:this.pointerMode,requiredKeys:this.requiredKeys,preventIf:this.preventIf,pointerOptions:structuredClone(this.pointerOptions)}})),this.element.dispatchEvent(new CustomEvent(`${this.pressGesture.name}ChangeOptions`,{detail:{duration:this.pressDuration,maxDistance:this.pressMaxDistance,maxPointers:this.maxPointers,pointerMode:this.pointerMode,requiredKeys:this.requiredKeys,preventIf:this.preventIf,pointerOptions:structuredClone(this.pointerOptions)}}))}resetState(){this.state.dragTimeoutId!==null&&clearTimeout(this.state.dragTimeoutId),this.restoreTouchAction(),this.isActive=!1,this.state={phase:"waitingForPress",dragTimeoutId:null}}handlePointerEvent(){}pressHandler=()=>{this.state.phase==="waitingForPress"&&(this.state.phase="pressDetected",this.setTouchAction(),this.state.dragTimeoutId=setTimeout(()=>{this.resetState()},this.dragTimeout))};dragStartHandler=t=>{this.state.phase==="pressDetected"&&(this.state.dragTimeoutId!==null&&(clearTimeout(this.state.dragTimeoutId),this.state.dragTimeoutId=null),this.restoreTouchAction(),this.state.phase="dragging",this.isActive=!0,this.element.dispatchEvent(new CustomEvent(xi(this.name,t.detail.phase),t)))};dragMoveHandler=t=>{this.state.phase==="dragging"&&this.element.dispatchEvent(new CustomEvent(xi(this.name,t.detail.phase),t))};dragEndHandler=t=>{this.state.phase==="dragging"&&(this.resetState(),this.element.dispatchEvent(new CustomEvent(xi(this.name,t.detail.phase),t)))};setTouchAction(){this.element.addEventListener("touchstart",Wc,{passive:!1}),this.element.addEventListener("touchmove",Wc,{passive:!1}),this.element.addEventListener("touchend",Wc,{passive:!1})}restoreTouchAction(){this.element.removeEventListener("touchstart",Wc),this.element.removeEventListener("touchmove",Wc),this.element.removeEventListener("touchend",Wc)}}class _p extends nm{state={startCentroid:null,currentTapCount:0,lastTapTime:0,lastPosition:null};constructor(t){super(t),this.maxDistance=t.maxDistance??10,this.taps=t.taps??1}clone(t){return new _p(Ze({name:this.name,preventDefault:this.preventDefault,stopPropagation:this.stopPropagation,minPointers:this.minPointers,maxPointers:this.maxPointers,maxDistance:this.maxDistance,taps:this.taps,requiredKeys:[...this.requiredKeys],pointerMode:[...this.pointerMode],preventIf:[...this.preventIf],pointerOptions:structuredClone(this.pointerOptions)},t))}destroy(){this.resetState(),super.destroy()}updateOptions(t){super.updateOptions(t),this.maxDistance=t.maxDistance??this.maxDistance,this.taps=t.taps??this.taps}resetState(){this.isActive=!1,this.state={startCentroid:null,currentTapCount:0,lastTapTime:0,lastPosition:null}}handlePointerEvent=(t,n)=>{const s=Array.from(t.values()),r=this.getTargetElement(n);if(!r)return;const i=this.getRelevantPointers(s,r);if(this.shouldPreventGesture(r,n.pointerType)||!this.isWithinPointerCount(i,n.pointerType)){this.isActive&&this.cancelTap(r,i,n);return}switch(n.type){case"pointerdown":this.isActive||(this.state.startCentroid=Hl(i),this.state.lastPosition=Ze({},this.state.startCentroid),this.isActive=!0,this.originalTarget=r);break;case"pointermove":if(this.isActive&&this.state.startCentroid){const o=Hl(i);this.state.lastPosition=o;const l=o.x-this.state.startCentroid.x,c=o.y-this.state.startCentroid.y;Math.sqrt(l*l+c*c)>this.maxDistance&&this.cancelTap(r,i,n)}break;case"pointerup":if(this.isActive){this.state.currentTapCount+=1;const o=this.state.lastPosition||this.state.startCentroid;if(!o){this.cancelTap(r,i,n);return}this.state.currentTapCount>=this.taps?(this.fireTapEvent(r,i,n,o),this.resetState()):(this.state.lastTapTime=n.timeStamp,this.isActive=!1,this.state.startCentroid=null,setTimeout(()=>{this.state&&this.state.currentTapCount>0&&this.state.currentTapCount<this.taps&&(this.state.currentTapCount=0)},300))}break;case"pointercancel":case"forceCancel":this.cancelTap(r,i,n);break}};fireTapEvent(t,n,s,r){const i=this.gesturesRegistry.getActiveGestures(t),o={gestureName:this.name,centroid:r,target:s.target,srcEvent:s,phase:"end",pointers:n,timeStamp:s.timeStamp,x:r.x,y:r.y,tapCount:this.state.currentTapCount,activeGestures:i,customData:this.customData},l=new CustomEvent(this.name,{bubbles:!0,cancelable:!0,composed:!0,detail:o});t.dispatchEvent(l),this.preventDefault&&s.preventDefault(),this.stopPropagation&&s.stopPropagation()}cancelTap(t,n,s){if(this.state.startCentroid||this.state.lastPosition){const r=this.state.lastPosition||this.state.startCentroid,i=this.gesturesRegistry.getActiveGestures(t),o={gestureName:this.name,centroid:r,target:s.target,srcEvent:s,phase:"cancel",pointers:n,timeStamp:s.timeStamp,x:r.x,y:r.y,tapCount:this.state.currentTapCount,activeGestures:i,customData:this.customData},l=xi(this.name,"cancel"),c=new CustomEvent(l,{bubbles:!0,cancelable:!0,composed:!0,detail:o});t.dispatchEvent(c)}this.resetState()}}class n4 extends nm{state={phase:"waitingForTap",dragTimeoutId:null};constructor(t){super(t),this.tapMaxDistance=t.tapMaxDistance??10,this.dragTimeout=t.dragTimeout??1e3,this.dragThreshold=t.dragThreshold??0,this.dragDirection=t.dragDirection||["up","down","left","right"],this.tapGesture=new _p({name:`${this.name}-tap`,maxDistance:this.tapMaxDistance,maxPointers:this.maxPointers,pointerMode:this.pointerMode,requiredKeys:this.requiredKeys,preventIf:this.preventIf,pointerOptions:structuredClone(this.pointerOptions)}),this.panGesture=new Tu({name:`${this.name}-pan`,minPointers:this.minPointers,maxPointers:this.maxPointers,threshold:this.dragThreshold,direction:this.dragDirection,pointerMode:this.pointerMode,requiredKeys:this.requiredKeys,preventIf:this.preventIf,pointerOptions:structuredClone(this.pointerOptions)})}clone(t){return new n4(Ze({name:this.name,preventDefault:this.preventDefault,stopPropagation:this.stopPropagation,minPointers:this.minPointers,maxPointers:this.maxPointers,tapMaxDistance:this.tapMaxDistance,dragTimeout:this.dragTimeout,dragThreshold:this.dragThreshold,dragDirection:[...this.dragDirection],requiredKeys:[...this.requiredKeys],pointerMode:[...this.pointerMode],preventIf:[...this.preventIf],pointerOptions:structuredClone(this.pointerOptions)},t))}init(t,n,s,r){super.init(t,n,s,r),this.tapGesture.init(t,n,s,r),this.panGesture.init(t,n,s,r),this.element.addEventListener(this.tapGesture.name,this.tapHandler),this.element.addEventListener(`${this.panGesture.name}Start`,this.dragStartHandler),this.element.addEventListener(this.panGesture.name,this.dragMoveHandler),this.element.addEventListener(`${this.panGesture.name}End`,this.dragEndHandler),this.element.addEventListener(`${this.panGesture.name}Cancel`,this.dragEndHandler)}destroy(){this.resetState(),this.tapGesture.destroy(),this.panGesture.destroy(),this.element.removeEventListener(this.tapGesture.name,this.tapHandler),this.element.removeEventListener(`${this.panGesture.name}Start`,this.dragStartHandler),this.element.removeEventListener(this.panGesture.name,this.dragMoveHandler),this.element.removeEventListener(`${this.panGesture.name}End`,this.dragEndHandler),this.element.removeEventListener(`${this.panGesture.name}Cancel`,this.dragEndHandler),super.destroy()}updateOptions(t){super.updateOptions(t),this.tapMaxDistance=t.tapMaxDistance??this.tapMaxDistance,this.dragTimeout=t.dragTimeout??this.dragTimeout,this.dragThreshold=t.dragThreshold??this.dragThreshold,this.dragDirection=t.dragDirection||this.dragDirection,this.element.dispatchEvent(new CustomEvent(`${this.panGesture.name}ChangeOptions`,{detail:{minPointers:this.minPointers,maxPointers:this.maxPointers,threshold:this.dragThreshold,direction:this.dragDirection,pointerMode:this.pointerMode,requiredKeys:this.requiredKeys,preventIf:this.preventIf,pointerOptions:structuredClone(this.pointerOptions)}})),this.element.dispatchEvent(new CustomEvent(`${this.tapGesture.name}ChangeOptions`,{detail:{maxDistance:this.tapMaxDistance,maxPointers:this.maxPointers,pointerMode:this.pointerMode,requiredKeys:this.requiredKeys,preventIf:this.preventIf,pointerOptions:structuredClone(this.pointerOptions)}}))}resetState(){this.state.dragTimeoutId!==null&&clearTimeout(this.state.dragTimeoutId),this.restoreTouchAction(),this.isActive=!1,this.state={phase:"waitingForTap",dragTimeoutId:null}}handlePointerEvent(){}tapHandler=()=>{this.state.phase==="waitingForTap"&&(this.state.phase="tapDetected",this.setTouchAction(),this.state.dragTimeoutId=setTimeout(()=>{this.resetState()},this.dragTimeout))};dragStartHandler=t=>{this.state.phase==="tapDetected"&&(this.state.dragTimeoutId!==null&&(clearTimeout(this.state.dragTimeoutId),this.state.dragTimeoutId=null),this.restoreTouchAction(),this.state.phase="dragging",this.isActive=!0,this.element.dispatchEvent(new CustomEvent(xi(this.name,t.detail.phase),t)))};dragMoveHandler=t=>{this.state.phase==="dragging"&&this.element.dispatchEvent(new CustomEvent(xi(this.name,t.detail.phase),t))};dragEndHandler=t=>{this.state.phase==="dragging"&&(this.resetState(),this.element.dispatchEvent(new CustomEvent(xi(this.name,t.detail.phase),t)))};setTouchAction(){this.element.addEventListener("touchstart",Wc,{passive:!1})}restoreTouchAction(){this.element.removeEventListener("touchstart",Wc)}}class $v extends vq{state={totalDeltaX:0,totalDeltaY:0,totalDeltaZ:0};constructor(t){super(t),this.sensitivity=t.sensitivity??1,this.max=t.max??Number.MAX_SAFE_INTEGER,this.min=t.min??Number.MIN_SAFE_INTEGER,this.initialDelta=t.initialDelta??0,this.invert=t.invert??!1,this.state.totalDeltaX=this.initialDelta,this.state.totalDeltaY=this.initialDelta,this.state.totalDeltaZ=this.initialDelta}clone(t){return new $v(Ze({name:this.name,preventDefault:this.preventDefault,stopPropagation:this.stopPropagation,sensitivity:this.sensitivity,max:this.max,min:this.min,initialDelta:this.initialDelta,invert:this.invert,requiredKeys:[...this.requiredKeys],preventIf:[...this.preventIf]},t))}init(t,n,s,r){super.init(t,n,s,r),this.element.addEventListener("wheel",this.handleWheelEvent)}destroy(){this.element.removeEventListener("wheel",this.handleWheelEvent),this.resetState(),super.destroy()}resetState(){this.isActive=!1,this.state={totalDeltaX:0,totalDeltaY:0,totalDeltaZ:0}}updateOptions(t){super.updateOptions(t),this.sensitivity=t.sensitivity??this.sensitivity,this.max=t.max??this.max,this.min=t.min??this.min,this.initialDelta=t.initialDelta??this.initialDelta,this.invert=t.invert??this.invert}handleWheelEvent=t=>{if(this.shouldPreventGesture(this.element,"mouse"))return;const n=this.pointerManager.getPointers()||new Map,s=Array.from(n.values());this.state.totalDeltaX+=t.deltaX*this.sensitivity*(this.invert?-1:1),this.state.totalDeltaY+=t.deltaY*this.sensitivity*(this.invert?-1:1),this.state.totalDeltaZ+=t.deltaZ*this.sensitivity*(this.invert?-1:1),["totalDeltaX","totalDeltaY","totalDeltaZ"].forEach(r=>{this.state[r]<this.min&&(this.state[r]=this.min),this.state[r]>this.max&&(this.state[r]=this.max)}),this.emitWheelEvent(s,t)};emitWheelEvent(t,n){const s=t.length>0?Hl(t):{x:n.clientX,y:n.clientY},r=this.gesturesRegistry.getActiveGestures(this.element),i={gestureName:this.name,centroid:s,target:n.target,srcEvent:n,phase:"ongoing",pointers:t,timeStamp:n.timeStamp,deltaX:n.deltaX*this.sensitivity*(this.invert?-1:1),deltaY:n.deltaY*this.sensitivity*(this.invert?-1:1),deltaZ:n.deltaZ*this.sensitivity*(this.invert?-1:1),deltaMode:n.deltaMode,totalDeltaX:this.state.totalDeltaX,totalDeltaY:this.state.totalDeltaY,totalDeltaZ:this.state.totalDeltaZ,activeGestures:r,customData:this.customData};this.preventDefault&&n.preventDefault(),this.stopPropagation&&n.stopPropagation();const o=xi(this.name,"ongoing"),l=new CustomEvent(o,{bubbles:!0,cancelable:!0,composed:!0,detail:i});this.element.dispatchEvent(l)}}const ef=e=>e.preventDefault(),s4=({svgRef:e})=>{const t=f.useRef(null);f.useEffect(()=>{const r=e.current;t.current||(t.current=new Vme({gestures:[new Tu({name:"pan",threshold:0,maxPointers:1}),new e4({name:"move",preventIf:["pan","zoomPinch","zoomPan"]}),new _p({name:"tap",preventIf:["pan","zoomPinch","zoomPan"]}),new Yj({name:"quickPress",duration:50}),new Tu({name:"brush",threshold:0,maxPointers:1}),new Tu({name:"zoomPan",threshold:0,preventIf:["zoomTapAndDrag","zoomPressAndDrag"]}),new t4({name:"zoomPinch",threshold:5}),new $v({name:"zoomTurnWheel",sensitivity:.01,initialDelta:1}),new $v({name:"panTurnWheel",sensitivity:.5}),new n4({name:"zoomTapAndDrag",dragThreshold:10}),new a4({name:"zoomPressAndDrag",dragThreshold:10,preventIf:["zoomPinch"]}),new _p({name:"zoomDoubleTapReset",taps:2})]}));const i=t.current;if(!(!r||!i))return i.registerElement(["pan","move","zoomPinch","zoomPan","zoomTurnWheel","panTurnWheel","tap","quickPress","zoomTapAndDrag","zoomPressAndDrag","zoomDoubleTapReset","brush"],r),()=>{i.unregisterAllGestures(r)}},[e,t]);const n=f.useCallback((r,i,o)=>{const l=e.current;return l?.addEventListener(r,i,o),{cleanup:()=>l?.removeEventListener(r,i)}},[e]),s=f.useCallback((r,i)=>{const o=e.current,l=t.current;!l||!o||l.setGestureOptions(r,o,i??{})},[e,t]);return f.useEffect(()=>{const r=e.current;return r?.addEventListener("gesturestart",ef),r?.addEventListener("gesturechange",ef),r?.addEventListener("gestureend",ef),()=>{r?.removeEventListener("gesturestart",ef),r?.removeEventListener("gesturechange",ef),r?.removeEventListener("gestureend",ef)}},[e]),{instance:{addInteractionListener:n,updateZoomInteractionListeners:s}}};s4.params={};s4.getInitialState=()=>({});const Jme=[ZL,XL,Gj,Vj,s4,Hj],efe=["apiRef"],tfe=e=>{let{plugins:t}=e,n=ya(e.props,efe);const s={};t.forEach(o=>{Object.assign(s,o.params)});const r={};return Object.keys(n).forEach(o=>{const l=n[o];s[o]&&(r[o]=l)}),t.reduce((o,l)=>l.getDefaultizedParams?l.getDefaultizedParams({params:o}):o,r)};let G$=0;function afe(e,t,n){const s=Rj(),r=f.useMemo(()=>[...Jme,...e],[e]),i=tfe({plugins:r,props:t});i.id=i.id??s;const l=f.useRef({}).current,c=sfe(t.apiRef),u=f.useRef(null),d=f.useRef(null),h=f.useRef(null);if(h.current==null){G$+=1;const b={cacheKey:{id:G$}};r.forEach(j=>{j.getInitialState&&Object.assign(b,j.getInitialState(i,b,n))}),h.current=new KL(b)}const p=b=>{const j=b({instance:l,params:i,plugins:r,store:h.current,svgRef:d,chartRootRef:u,seriesConfig:n});j.publicAPI&&Object.assign(c.current,j.publicAPI),j.instance&&Object.assign(l,j.instance)};return r.forEach(p),{contextValue:f.useMemo(()=>({store:h.current,publicAPI:c.current,instance:l,svgRef:d,chartRootRef:u}),[l,c])}}function nfe(e){return e.current==null&&(e.current={}),e}function sfe(e){const t=f.useRef({});return e?nfe(e):t}const wq=f.createContext(null);const jq=()=>{},Nq=4,Cq=20+2*Nq,rfe=40+2*Nq,ife="hover",Xy={minStart:0,maxEnd:100,step:5,minSpan:10,maxSpan:100,panning:!0,filterMode:"keep",reverse:!1,slider:{enabled:!1,preview:!1,size:Cq,showTooltip:ife}},r4=(e,t,n,s)=>{if(e)return e===!0?Ze({axisId:t,axisDirection:n},Xy,{reverse:s??!1}):Ze({axisId:t,axisDirection:n},Xy,{reverse:s??!1},e,{slider:Ze({},Xy.slider,{size:e.slider?.preview??Xy.slider.preview?rfe:Cq},e.slider)})};function Sq(e,t){const n={top:0,bottom:0,none:0};return(e&&e.length>0?e:[{id:qj,scaleType:"linear"}]).map((i,o)=>{const l=i.dataKey,c=o===0?"bottom":"none",u=i.position??c,d=jme+(i.label?gq:0),h=i.id??`defaultized-x-axis-${o}`,p=Ze({offset:n[u]},i,{id:h,position:u,height:i.height??d,zoom:r4(i.zoom,h,"x",i.reverse)});if(u!=="none"&&(n[u]+=p.height,p.zoom?.slider.enabled&&(n[u]+=p.zoom.slider.size)),l===void 0||i.data!==void 0)return p;if(t===void 0)throw new Error("MUI X Charts: x-axis uses `dataKey` but no `dataset` is provided.");return Ze({},p,{data:t.map(x=>x[l])})})}function _q(e,t){const n={right:0,left:0,none:0};return(e&&e.length>0?e:[{id:bme,scaleType:"linear"}]).map((i,o)=>{const l=i.dataKey,c=o===0?"left":"none",u=i.position??c,d=wme+(i.label?gq:0),h=i.id??`defaultized-y-axis-${o}`,p=Ze({offset:n[u]},i,{id:h,position:u,width:i.width??d,zoom:r4(i.zoom,h,"y",i.reverse)});if(u!=="none"&&(n[u]+=p.width,p.zoom?.slider.enabled&&(n[u]+=p.zoom.slider.size)),l===void 0||i.data!==void 0)return p;if(t===void 0)throw new Error("MUI X Charts: y-axis uses `dataKey` but no `dataset` is provided.");return Ze({},p,{data:t.map(x=>x[l])})})}function ofe(e,t){return function(s,r){if(r.location==="tick"){const i=r.scale.domain();return i[0]===i[1]?r.scale.tickFormat(1)(s):r.scale.tickFormat(e)(s)}return r.location==="zoom-slider-tooltip"?t.tickFormat(2)(s):`${s}`}}function sm(e){return e.scaleType==="band"}function rm(e){return e.scaleType==="point"}function lfe(e){return e.scaleType!=="point"&&e.scaleType!=="band"}function cfe(e){return e.scaleType==="symlog"}function Nx(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function i4(e){let t=e,n=e;e.length===1&&(t=(o,l)=>e(o)-l,n=dfe(e));function s(o,l,c,u){for(c==null&&(c=0),u==null&&(u=o.length);c<u;){const d=c+u>>>1;n(o[d],l)<0?c=d+1:u=d}return c}function r(o,l,c,u){for(c==null&&(c=0),u==null&&(u=o.length);c<u;){const d=c+u>>>1;n(o[d],l)>0?u=d:c=d+1}return c}function i(o,l,c,u){c==null&&(c=0),u==null&&(u=o.length);const d=s(o,l,c,u-1);return d>c&&t(o[d-1],l)>-t(o[d],l)?d-1:d}return{left:s,center:i,right:r}}function dfe(e){return(t,n)=>Nx(e(t),n)}function Aq(e){return e===null?NaN:+e}function*ufe(e,t){for(let n of e)n!=null&&(n=+n)>=n&&(yield n)}const mfe=i4(Nx),Cx=mfe.right;i4(Aq).center;class Rv extends Map{constructor(t,n=gfe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[s,r]of t)this.set(s,r)}get(t){return super.get(W$(this,t))}has(t){return super.has(W$(this,t))}set(t,n){return super.set(ffe(this,t),n)}delete(t){return super.delete(hfe(this,t))}}function W$({_intern:e,_key:t},n){const s=t(n);return e.has(s)?e.get(s):n}function ffe({_intern:e,_key:t},n){const s=t(n);return e.has(s)?e.get(s):(e.set(s,n),n)}function hfe({_intern:e,_key:t},n){const s=t(n);return e.has(s)&&(n=e.get(n),e.delete(s)),n}function gfe(e){return e!==null&&typeof e=="object"?e.valueOf():e}var jk=Math.sqrt(50),Nk=Math.sqrt(10),Ck=Math.sqrt(2);function Sk(e,t,n){var s,r=-1,i,o,l;if(t=+t,e=+e,n=+n,e===t&&n>0)return[e];if((s=t<e)&&(i=e,e=t,t=i),(l=Tq(e,t,n))===0||!isFinite(l))return[];if(l>0){let c=Math.round(e/l),u=Math.round(t/l);for(c*l<e&&++c,u*l>t&&--u,o=new Array(i=u-c+1);++r<i;)o[r]=(c+r)*l}else{l=-l;let c=Math.round(e*l),u=Math.round(t*l);for(c/l<e&&++c,u/l>t&&--u,o=new Array(i=u-c+1);++r<i;)o[r]=(c+r)/l}return s&&o.reverse(),o}function Tq(e,t,n){var s=(t-e)/Math.max(0,n),r=Math.floor(Math.log(s)/Math.LN10),i=s/Math.pow(10,r);return r>=0?(i>=jk?10:i>=Nk?5:i>=Ck?2:1)*Math.pow(10,r):-Math.pow(10,-r)/(i>=jk?10:i>=Nk?5:i>=Ck?2:1)}function _k(e,t,n){var s=Math.abs(t-e)/Math.max(0,n),r=Math.pow(10,Math.floor(Math.log(s)/Math.LN10)),i=s/r;return i>=jk?r*=10:i>=Nk?r*=5:i>=Ck&&(r*=2),t<e?-r:r}function V$(e,t){let n;for(const s of e)s!=null&&(n<s||n===void 0&&s>=s)&&(n=s);return n}function Y$(e,t){let n;for(const s of e)s!=null&&(n>s||n===void 0&&s>=s)&&(n=s);return n}function kq(e,t,n=0,s=e.length-1,r=Nx){for(;s>n;){if(s-n>600){const c=s-n+1,u=t-n+1,d=Math.log(c),h=.5*Math.exp(2*d/3),p=.5*Math.sqrt(d*h*(c-h)/c)*(u-c/2<0?-1:1),x=Math.max(n,Math.floor(t-u*h/c+p)),b=Math.min(s,Math.floor(t+(c-u)*h/c+p));kq(e,t,x,b,r)}const i=e[t];let o=n,l=s;for(wg(e,n,t),r(e[s],i)>0&&wg(e,n,s);o<l;){for(wg(e,o,l),++o,--l;r(e[o],i)<0;)++o;for(;r(e[l],i)>0;)--l}r(e[n],i)===0?wg(e,n,l):(++l,wg(e,l,s)),l<=t&&(n=l+1),t<=l&&(s=l-1)}return e}function wg(e,t,n){const s=e[t];e[t]=e[n],e[n]=s}function pfe(e,t,n){if(e=Float64Array.from(ufe(e)),!!(s=e.length)){if((t=+t)<=0||s<2)return Y$(e);if(t>=1)return V$(e);var s,r=(s-1)*t,i=Math.floor(r),o=V$(kq(e,i).subarray(0,i+1)),l=Y$(e.subarray(i+1));return o+(l-o)*(r-i)}}function xfe(e,t,n=Aq){if(s=e.length){if((t=+t)<=0||s<2)return+n(e[0],0,e);if(t>=1)return+n(e[s-1],s-1,e);var s,r=(s-1)*t,i=Math.floor(r),o=+n(e[i],i,e),l=+n(e[i+1],i+1,e);return o+(l-o)*(r-i)}}function Eq(e,t,n){e=+e,t=+t,n=(r=arguments.length)<2?(t=e,e=0,1):r<3?1:+n;for(var s=-1,r=Math.max(0,Math.ceil((t-e)/n))|0,i=new Array(r);++s<r;)i[s]=e+s*n;return i}function ki(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function rc(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const Ak=Symbol("implicit");function Ap(){var e=new Rv,t=[],n=[],s=Ak;function r(i){let o=e.get(i);if(o===void 0){if(s!==Ak)return s;e.set(i,o=t.push(i)-1)}return n[o%n.length]}return r.domain=function(i){if(!arguments.length)return t.slice();t=[],e=new Rv;for(const o of i)e.has(o)||e.set(o,t.push(o)-1);return r},r.range=function(i){return arguments.length?(n=Array.from(i),r):n.slice()},r.unknown=function(i){return arguments.length?(s=i,r):s},r.copy=function(){return Ap(t,n).unknown(s)},ki.apply(r,arguments),r}function o4(){var e=Ap().unknown(void 0),t=e.domain,n=e.range,s=0,r=1,i,o,l=!1,c=0,u=0,d=.5;delete e.unknown;function h(){var p=t().length,x=r<s,b=x?r:s,j=x?s:r;i=(j-b)/Math.max(1,p-c+u*2),l&&(i=Math.floor(i)),b+=(j-b-i*(p-c))*d,o=i*(1-c),l&&(b=Math.round(b),o=Math.round(o));var y=Eq(p).map(function(N){return b+i*N});return n(x?y.reverse():y)}return e.domain=function(p){return arguments.length?(t(p),h()):t()},e.range=function(p){return arguments.length?([s,r]=p,s=+s,r=+r,h()):[s,r]},e.rangeRound=function(p){return[s,r]=p,s=+s,r=+r,l=!0,h()},e.bandwidth=function(){return o},e.step=function(){return i},e.round=function(p){return arguments.length?(l=!!p,h()):l},e.padding=function(p){return arguments.length?(c=Math.min(1,u=+p),h()):c},e.paddingInner=function(p){return arguments.length?(c=Math.min(1,p),h()):c},e.paddingOuter=function(p){return arguments.length?(u=+p,h()):u},e.align=function(p){return arguments.length?(d=Math.max(0,Math.min(1,p)),h()):d},e.copy=function(){return o4(t(),[s,r]).round(l).paddingInner(c).paddingOuter(u).align(d)},ki.apply(h(),arguments)}function Lq(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return Lq(t())},e}function yfe(){return Lq(o4.apply(null,arguments).paddingInner(1))}function l4(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Dq(e,t){var n=Object.create(e.prototype);for(var s in t)n[s]=t[s];return n}function Sx(){}var Tp=.7,zv=1/Tp,Nf="\\s*([+-]?\\d+)\\s*",kp="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Io="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",bfe=/^#([0-9a-f]{3,8})$/,vfe=new RegExp(`^rgb\\(${Nf},${Nf},${Nf}\\)$`),wfe=new RegExp(`^rgb\\(${Io},${Io},${Io}\\)$`),jfe=new RegExp(`^rgba\\(${Nf},${Nf},${Nf},${kp}\\)$`),Nfe=new RegExp(`^rgba\\(${Io},${Io},${Io},${kp}\\)$`),Cfe=new RegExp(`^hsl\\(${kp},${Io},${Io}\\)$`),Sfe=new RegExp(`^hsla\\(${kp},${Io},${Io},${kp}\\)$`),Q$={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};l4(Sx,Ep,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:K$,formatHex:K$,formatHex8:_fe,formatHsl:Afe,formatRgb:X$,toString:X$});function K$(){return this.rgb().formatHex()}function _fe(){return this.rgb().formatHex8()}function Afe(){return Pq(this).formatHsl()}function X$(){return this.rgb().formatRgb()}function Ep(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=bfe.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Z$(t):n===3?new hr(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Zy(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Zy(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=vfe.exec(e))?new hr(t[1],t[2],t[3],1):(t=wfe.exec(e))?new hr(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=jfe.exec(e))?Zy(t[1],t[2],t[3],t[4]):(t=Nfe.exec(e))?Zy(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Cfe.exec(e))?t6(t[1],t[2]/100,t[3]/100,1):(t=Sfe.exec(e))?t6(t[1],t[2]/100,t[3]/100,t[4]):Q$.hasOwnProperty(e)?Z$(Q$[e]):e==="transparent"?new hr(NaN,NaN,NaN,0):null}function Z$(e){return new hr(e>>16&255,e>>8&255,e&255,1)}function Zy(e,t,n,s){return s<=0&&(e=t=n=NaN),new hr(e,t,n,s)}function Tfe(e){return e instanceof Sx||(e=Ep(e)),e?(e=e.rgb(),new hr(e.r,e.g,e.b,e.opacity)):new hr}function Tk(e,t,n,s){return arguments.length===1?Tfe(e):new hr(e,t,n,s??1)}function hr(e,t,n,s){this.r=+e,this.g=+t,this.b=+n,this.opacity=+s}l4(hr,Tk,Dq(Sx,{brighter(e){return e=e==null?zv:Math.pow(zv,e),new hr(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Tp:Math.pow(Tp,e),new hr(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new hr(ku(this.r),ku(this.g),ku(this.b),Fv(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:J$,formatHex:J$,formatHex8:kfe,formatRgb:e6,toString:e6}));function J$(){return`#${vu(this.r)}${vu(this.g)}${vu(this.b)}`}function kfe(){return`#${vu(this.r)}${vu(this.g)}${vu(this.b)}${vu((isNaN(this.opacity)?1:this.opacity)*255)}`}function e6(){const e=Fv(this.opacity);return`${e===1?"rgb(":"rgba("}${ku(this.r)}, ${ku(this.g)}, ${ku(this.b)}${e===1?")":`, ${e})`}`}function Fv(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function ku(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function vu(e){return e=ku(e),(e<16?"0":"")+e.toString(16)}function t6(e,t,n,s){return s<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Bi(e,t,n,s)}function Pq(e){if(e instanceof Bi)return new Bi(e.h,e.s,e.l,e.opacity);if(e instanceof Sx||(e=Ep(e)),!e)return new Bi;if(e instanceof Bi)return e;e=e.rgb();var t=e.r/255,n=e.g/255,s=e.b/255,r=Math.min(t,n,s),i=Math.max(t,n,s),o=NaN,l=i-r,c=(i+r)/2;return l?(t===i?o=(n-s)/l+(n<s)*6:n===i?o=(s-t)/l+2:o=(t-n)/l+4,l/=c<.5?i+r:2-i-r,o*=60):l=c>0&&c<1?0:o,new Bi(o,l,c,e.opacity)}function Efe(e,t,n,s){return arguments.length===1?Pq(e):new Bi(e,t,n,s??1)}function Bi(e,t,n,s){this.h=+e,this.s=+t,this.l=+n,this.opacity=+s}l4(Bi,Efe,Dq(Sx,{brighter(e){return e=e==null?zv:Math.pow(zv,e),new Bi(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Tp:Math.pow(Tp,e),new Bi(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,s=n+(n<.5?n:1-n)*t,r=2*n-s;return new hr(j2(e>=240?e-240:e+120,r,s),j2(e,r,s),j2(e<120?e+240:e-120,r,s),this.opacity)},clamp(){return new Bi(a6(this.h),Jy(this.s),Jy(this.l),Fv(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Fv(this.opacity);return`${e===1?"hsl(":"hsla("}${a6(this.h)}, ${Jy(this.s)*100}%, ${Jy(this.l)*100}%${e===1?")":`, ${e})`}`}}));function a6(e){return e=(e||0)%360,e<0?e+360:e}function Jy(e){return Math.max(0,Math.min(1,e||0))}function j2(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const c4=e=>()=>e;function Lfe(e,t){return function(n){return e+n*t}}function Dfe(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(s){return Math.pow(e+s*t,n)}}function Pfe(e){return(e=+e)==1?Oq:function(t,n){return n-t?Dfe(t,n,e):c4(isNaN(t)?n:t)}}function Oq(e,t){var n=t-e;return n?Lfe(e,n):c4(isNaN(e)?t:e)}const n6=(function e(t){var n=Pfe(t);function s(r,i){var o=n((r=Tk(r)).r,(i=Tk(i)).r),l=n(r.g,i.g),c=n(r.b,i.b),u=Oq(r.opacity,i.opacity);return function(d){return r.r=o(d),r.g=l(d),r.b=c(d),r.opacity=u(d),r+""}}return s.gamma=e,s})(1);function Ofe(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,s=t.slice(),r;return function(i){for(r=0;r<n;++r)s[r]=e[r]*(1-i)+t[r]*i;return s}}function Mfe(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Ife(e,t){var n=t?t.length:0,s=e?Math.min(n,e.length):0,r=new Array(s),i=new Array(n),o;for(o=0;o<s;++o)r[o]=lh(e[o],t[o]);for(;o<n;++o)i[o]=t[o];return function(l){for(o=0;o<s;++o)i[o]=r[o](l);return i}}function d4(e,t){var n=new Date;return e=+e,t=+t,function(s){return n.setTime(e*(1-s)+t*s),n}}function Pf(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function $fe(e,t){var n={},s={},r;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(r in t)r in e?n[r]=lh(e[r],t[r]):s[r]=t[r];return function(i){for(r in n)s[r]=n[r](i);return s}}var kk=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,N2=new RegExp(kk.source,"g");function Rfe(e){return function(){return e}}function zfe(e){return function(t){return e(t)+""}}function u4(e,t){var n=kk.lastIndex=N2.lastIndex=0,s,r,i,o=-1,l=[],c=[];for(e=e+"",t=t+"";(s=kk.exec(e))&&(r=N2.exec(t));)(i=r.index)>n&&(i=t.slice(n,i),l[o]?l[o]+=i:l[++o]=i),(s=s[0])===(r=r[0])?l[o]?l[o]+=r:l[++o]=r:(l[++o]=null,c.push({i:o,x:Pf(s,r)})),n=N2.lastIndex;return n<t.length&&(i=t.slice(n),l[o]?l[o]+=i:l[++o]=i),l.length<2?c[0]?zfe(c[0].x):Rfe(t):(t=c.length,function(u){for(var d=0,h;d<t;++d)l[(h=c[d]).i]=h.x(u);return l.join("")})}function lh(e,t){var n=typeof t,s;return t==null||n==="boolean"?c4(t):(n==="number"?Pf:n==="string"?(s=Ep(t))?(t=s,n6):u4:t instanceof Ep?n6:t instanceof Date?d4:Mfe(t)?Ofe:Array.isArray(t)?Ife:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?$fe:Pf)(e,t)}function m4(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function Ffe(e,t){t===void 0&&(t=e,e=lh);for(var n=0,s=t.length-1,r=t[0],i=new Array(s<0?0:s);n<s;)i[n]=e(r,r=t[++n]);return function(o){var l=Math.max(0,Math.min(s-1,Math.floor(o*=s)));return i[l](o-l)}}function Ufe(e){return function(){return e}}function Uv(e){return+e}var s6=[0,1];function Vs(e){return e}function Ek(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:Ufe(isNaN(t)?NaN:.5)}function Bfe(e,t){var n;return e>t&&(n=e,e=t,t=n),function(s){return Math.max(e,Math.min(t,s))}}function Hfe(e,t,n){var s=e[0],r=e[1],i=t[0],o=t[1];return r<s?(s=Ek(r,s),i=n(o,i)):(s=Ek(s,r),i=n(i,o)),function(l){return i(s(l))}}function qfe(e,t,n){var s=Math.min(e.length,t.length)-1,r=new Array(s),i=new Array(s),o=-1;for(e[s]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<s;)r[o]=Ek(e[o],e[o+1]),i[o]=n(t[o],t[o+1]);return function(l){var c=Cx(e,l,1,s)-1;return i[c](r[c](l))}}function _x(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Qj(){var e=s6,t=s6,n=lh,s,r,i,o=Vs,l,c,u;function d(){var p=Math.min(e.length,t.length);return o!==Vs&&(o=Bfe(e[0],e[p-1])),l=p>2?qfe:Hfe,c=u=null,h}function h(p){return p==null||isNaN(p=+p)?i:(c||(c=l(e.map(s),t,n)))(s(o(p)))}return h.invert=function(p){return o(r((u||(u=l(t,e.map(s),Pf)))(p)))},h.domain=function(p){return arguments.length?(e=Array.from(p,Uv),d()):e.slice()},h.range=function(p){return arguments.length?(t=Array.from(p),d()):t.slice()},h.rangeRound=function(p){return t=Array.from(p),n=m4,d()},h.clamp=function(p){return arguments.length?(o=p?!0:Vs,d()):o!==Vs},h.interpolate=function(p){return arguments.length?(n=p,d()):n},h.unknown=function(p){return arguments.length?(i=p,h):i},function(p,x){return s=p,r=x,d()}}function f4(){return Qj()(Vs,Vs)}function Gfe(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Bv(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,s=e.slice(0,n);return[s.length>1?s[0]+s.slice(2):s,+e.slice(n+1)]}function Of(e){return e=Bv(Math.abs(e)),e?e[1]:NaN}function Wfe(e,t){return function(n,s){for(var r=n.length,i=[],o=0,l=e[0],c=0;r>0&&l>0&&(c+l+1>s&&(l=Math.max(1,s-c)),i.push(n.substring(r-=l,r+l)),!((c+=l+1)>s));)l=e[o=(o+1)%e.length];return i.reverse().join(t)}}function Vfe(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var Yfe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Lp(e){if(!(t=Yfe.exec(e)))throw new Error("invalid format: "+e);var t;return new h4({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Lp.prototype=h4.prototype;function h4(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}h4.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Qfe(e){e:for(var t=e.length,n=1,s=-1,r;n<t;++n)switch(e[n]){case".":s=r=n;break;case"0":s===0&&(s=n),r=n;break;default:if(!+e[n])break e;s>0&&(s=0);break}return s>0?e.slice(0,s)+e.slice(r+1):e}var Mq;function Kfe(e,t){var n=Bv(e,t);if(!n)return e+"";var s=n[0],r=n[1],i=r-(Mq=Math.max(-8,Math.min(8,Math.floor(r/3)))*3)+1,o=s.length;return i===o?s:i>o?s+new Array(i-o+1).join("0"):i>0?s.slice(0,i)+"."+s.slice(i):"0."+new Array(1-i).join("0")+Bv(e,Math.max(0,t+i-1))[0]}function r6(e,t){var n=Bv(e,t);if(!n)return e+"";var s=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+s:s.length>r+1?s.slice(0,r+1)+"."+s.slice(r+1):s+new Array(r-s.length+2).join("0")}const i6={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:Gfe,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>r6(e*100,t),r:r6,s:Kfe,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function o6(e){return e}var l6=Array.prototype.map,c6=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function Xfe(e){var t=e.grouping===void 0||e.thousands===void 0?o6:Wfe(l6.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",s=e.currency===void 0?"":e.currency[1]+"",r=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?o6:Vfe(l6.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",l=e.minus===void 0?"":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function u(h){h=Lp(h);var p=h.fill,x=h.align,b=h.sign,j=h.symbol,y=h.zero,N=h.width,w=h.comma,S=h.precision,_=h.trim,T=h.type;T==="n"?(w=!0,T="g"):i6[T]||(S===void 0&&(S=12),_=!0,T="g"),(y||p==="0"&&x==="=")&&(y=!0,p="0",x="=");var k=j==="$"?n:j==="#"&&/[boxX]/.test(T)?"0"+T.toLowerCase():"",A=j==="$"?s:/[%p]/.test(T)?o:"",E=i6[T],M=/[defgprs%]/.test(T);S=S===void 0?6:/[gprs]/.test(T)?Math.max(1,Math.min(21,S)):Math.max(0,Math.min(20,S));function F(D){var P=k,B=A,G,$,W;if(T==="c")B=E(D)+B,D="";else{D=+D;var Z=D<0||1/D<0;if(D=isNaN(D)?c:E(Math.abs(D),S),_&&(D=Qfe(D)),Z&&+D==0&&b!=="+"&&(Z=!1),P=(Z?b==="("?b:l:b==="-"||b==="("?"":b)+P,B=(T==="s"?c6[8+Mq/3]:"")+B+(Z&&b==="("?")":""),M){for(G=-1,$=D.length;++G<$;)if(W=D.charCodeAt(G),48>W||W>57){B=(W===46?r+D.slice(G+1):D.slice(G))+B,D=D.slice(0,G);break}}}w&&!y&&(D=t(D,1/0));var Q=P.length+D.length+B.length,le=Q<N?new Array(N-Q+1).join(p):"";switch(w&&y&&(D=t(le+D,le.length?N-B.length:1/0),le=""),x){case"<":D=P+D+B+le;break;case"=":D=P+le+D+B;break;case"^":D=le.slice(0,Q=le.length>>1)+P+D+B+le.slice(Q);break;default:D=le+P+D+B;break}return i(D)}return F.toString=function(){return h+""},F}function d(h,p){var x=u((h=Lp(h),h.type="f",h)),b=Math.max(-8,Math.min(8,Math.floor(Of(p)/3)))*3,j=Math.pow(10,-b),y=c6[8+b/3];return function(N){return x(j*N)+y}}return{format:u,formatPrefix:d}}var eb,g4,Iq;Zfe({thousands:",",grouping:[3],currency:["$",""]});function Zfe(e){return eb=Xfe(e),g4=eb.format,Iq=eb.formatPrefix,eb}function Jfe(e){return Math.max(0,-Of(Math.abs(e)))}function ehe(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Of(t)/3)))*3-Of(Math.abs(e)))}function the(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Of(t)-Of(e))+1}function $q(e,t,n,s){var r=_k(e,t,n),i;switch(s=Lp(s??",f"),s.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return s.precision==null&&!isNaN(i=ehe(r,o))&&(s.precision=i),Iq(s,o)}case"":case"e":case"g":case"p":case"r":{s.precision==null&&!isNaN(i=the(r,Math.max(Math.abs(e),Math.abs(t))))&&(s.precision=i-(s.type==="e"));break}case"f":case"%":{s.precision==null&&!isNaN(i=Jfe(r))&&(s.precision=i-(s.type==="%")*2);break}}return g4(s)}function Sd(e){var t=e.domain;return e.ticks=function(n){var s=t();return Sk(s[0],s[s.length-1],n??10)},e.tickFormat=function(n,s){var r=t();return $q(r[0],r[r.length-1],n??10,s)},e.nice=function(n){n==null&&(n=10);var s=t(),r=0,i=s.length-1,o=s[r],l=s[i],c,u,d=10;for(l<o&&(u=o,o=l,l=u,u=r,r=i,i=u);d-- >0;){if(u=Tq(o,l,n),u===c)return s[r]=o,s[i]=l,t(s);if(u>0)o=Math.floor(o/u)*u,l=Math.ceil(l/u)*u;else if(u<0)o=Math.ceil(o*u)/u,l=Math.floor(l*u)/u;else break;c=u}return e},e}function Kj(){var e=f4();return e.copy=function(){return _x(e,Kj())},ki.apply(e,arguments),Sd(e)}function Rq(e){var t;function n(s){return s==null||isNaN(s=+s)?t:s}return n.invert=n,n.domain=n.range=function(s){return arguments.length?(e=Array.from(s,Uv),n):e.slice()},n.unknown=function(s){return arguments.length?(t=s,n):t},n.copy=function(){return Rq(e).unknown(t)},e=arguments.length?Array.from(e,Uv):[0,1],Sd(n)}function zq(e,t){e=e.slice();var n=0,s=e.length-1,r=e[n],i=e[s],o;return i<r&&(o=n,n=s,s=o,o=r,r=i,i=o),e[n]=t.floor(r),e[s]=t.ceil(i),e}function d6(e){return Math.log(e)}function u6(e){return Math.exp(e)}function ahe(e){return-Math.log(-e)}function nhe(e){return-Math.exp(-e)}function she(e){return isFinite(e)?+("1e"+e):e<0?0:e}function rhe(e){return e===10?she:e===Math.E?Math.exp:t=>Math.pow(e,t)}function ihe(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function m6(e){return(t,n)=>-e(-t,n)}function p4(e){const t=e(d6,u6),n=t.domain;let s=10,r,i;function o(){return r=ihe(s),i=rhe(s),n()[0]<0?(r=m6(r),i=m6(i),e(ahe,nhe)):e(d6,u6),t}return t.base=function(l){return arguments.length?(s=+l,o()):s},t.domain=function(l){return arguments.length?(n(l),o()):n()},t.ticks=l=>{const c=n();let u=c[0],d=c[c.length-1];const h=d<u;h&&([u,d]=[d,u]);let p=r(u),x=r(d),b,j;const y=l==null?10:+l;let N=[];if(!(s%1)&&x-p<y){if(p=Math.floor(p),x=Math.ceil(x),u>0){for(;p<=x;++p)for(b=1;b<s;++b)if(j=p<0?b/i(-p):b*i(p),!(j<u)){if(j>d)break;N.push(j)}}else for(;p<=x;++p)for(b=s-1;b>=1;--b)if(j=p>0?b/i(-p):b*i(p),!(j<u)){if(j>d)break;N.push(j)}N.length*2<y&&(N=Sk(u,d,y))}else N=Sk(p,x,Math.min(x-p,y)).map(i);return h?N.reverse():N},t.tickFormat=(l,c)=>{if(l==null&&(l=10),c==null&&(c=s===10?"s":","),typeof c!="function"&&(!(s%1)&&(c=Lp(c)).precision==null&&(c.trim=!0),c=g4(c)),l===1/0)return c;const u=Math.max(1,s*l/t.ticks().length);return d=>{let h=d/i(Math.round(r(d)));return h*s<s-.5&&(h*=s),h<=u?c(d):""}},t.nice=()=>n(zq(n(),{floor:l=>i(Math.floor(r(l))),ceil:l=>i(Math.ceil(r(l)))})),t}function Dp(){const e=p4(Qj()).domain([1,10]);return e.copy=()=>_x(e,Dp()).base(e.base()),ki.apply(e,arguments),e}function f6(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function h6(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function x4(e){var t=1,n=e(f6(t),h6(t));return n.constant=function(s){return arguments.length?e(f6(t=+s),h6(t)):t},Sd(n)}function y4(){var e=x4(Qj());return e.copy=function(){return _x(e,y4()).constant(e.constant())},ki.apply(e,arguments)}function g6(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function ohe(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function lhe(e){return e<0?-e*e:e*e}function b4(e){var t=e(Vs,Vs),n=1;function s(){return n===1?e(Vs,Vs):n===.5?e(ohe,lhe):e(g6(n),g6(1/n))}return t.exponent=function(r){return arguments.length?(n=+r,s()):n},Sd(t)}function Xj(){var e=b4(Qj());return e.copy=function(){return _x(e,Xj()).exponent(e.exponent())},ki.apply(e,arguments),e}function Fq(){return Xj.apply(null,arguments).exponent(.5)}function p6(e){return Math.sign(e)*e*e}function che(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function Uq(){var e=f4(),t=[0,1],n=!1,s;function r(i){var o=che(e(i));return isNaN(o)?s:n?Math.round(o):o}return r.invert=function(i){return e.invert(p6(i))},r.domain=function(i){return arguments.length?(e.domain(i),r):e.domain()},r.range=function(i){return arguments.length?(e.range((t=Array.from(i,Uv)).map(p6)),r):t.slice()},r.rangeRound=function(i){return r.range(i).round(!0)},r.round=function(i){return arguments.length?(n=!!i,r):n},r.clamp=function(i){return arguments.length?(e.clamp(i),r):e.clamp()},r.unknown=function(i){return arguments.length?(s=i,r):s},r.copy=function(){return Uq(e.domain(),t).round(n).clamp(e.clamp()).unknown(s)},ki.apply(r,arguments),Sd(r)}function Bq(){var e=[],t=[],n=[],s;function r(){var o=0,l=Math.max(1,t.length);for(n=new Array(l-1);++o<l;)n[o-1]=xfe(e,o/l);return i}function i(o){return o==null||isNaN(o=+o)?s:t[Cx(n,o)]}return i.invertExtent=function(o){var l=t.indexOf(o);return l<0?[NaN,NaN]:[l>0?n[l-1]:e[0],l<n.length?n[l]:e[e.length-1]]},i.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let l of o)l!=null&&!isNaN(l=+l)&&e.push(l);return e.sort(Nx),r()},i.range=function(o){return arguments.length?(t=Array.from(o),r()):t.slice()},i.unknown=function(o){return arguments.length?(s=o,i):s},i.quantiles=function(){return n.slice()},i.copy=function(){return Bq().domain(e).range(t).unknown(s)},ki.apply(i,arguments)}function Hq(){var e=0,t=1,n=1,s=[.5],r=[0,1],i;function o(c){return c!=null&&c<=c?r[Cx(s,c,0,n)]:i}function l(){var c=-1;for(s=new Array(n);++c<n;)s[c]=((c+1)*t-(c-n)*e)/(n+1);return o}return o.domain=function(c){return arguments.length?([e,t]=c,e=+e,t=+t,l()):[e,t]},o.range=function(c){return arguments.length?(n=(r=Array.from(c)).length-1,l()):r.slice()},o.invertExtent=function(c){var u=r.indexOf(c);return u<0?[NaN,NaN]:u<1?[e,s[0]]:u>=n?[s[n-1],t]:[s[u-1],s[u]]},o.unknown=function(c){return arguments.length&&(i=c),o},o.thresholds=function(){return s.slice()},o.copy=function(){return Hq().domain([e,t]).range(r).unknown(i)},ki.apply(Sd(o),arguments)}function v4(){var e=[.5],t=[0,1],n,s=1;function r(i){return i!=null&&i<=i?t[Cx(e,i,0,s)]:n}return r.domain=function(i){return arguments.length?(e=Array.from(i),s=Math.min(e.length,t.length-1),r):e.slice()},r.range=function(i){return arguments.length?(t=Array.from(i),s=Math.min(e.length,t.length-1),r):t.slice()},r.invertExtent=function(i){var o=t.indexOf(i);return[e[o-1],e[o]]},r.unknown=function(i){return arguments.length?(n=i,r):n},r.copy=function(){return v4().domain(e).range(t).unknown(n)},ki.apply(r,arguments)}const C2=new Date,S2=new Date;function cs(e,t,n,s){function r(i){return e(i=arguments.length===0?new Date:new Date(+i)),i}return r.floor=i=>(e(i=new Date(+i)),i),r.ceil=i=>(e(i=new Date(i-1)),t(i,1),e(i),i),r.round=i=>{const o=r(i),l=r.ceil(i);return i-o<l-i?o:l},r.offset=(i,o)=>(t(i=new Date(+i),o==null?1:Math.floor(o)),i),r.range=(i,o,l)=>{const c=[];if(i=r.ceil(i),l=l==null?1:Math.floor(l),!(i<o)||!(l>0))return c;let u;do c.push(u=new Date(+i)),t(i,l),e(i);while(u<i&&i<o);return c},r.filter=i=>cs(o=>{if(o>=o)for(;e(o),!i(o);)o.setTime(o-1)},(o,l)=>{if(o>=o)if(l<0)for(;++l<=0;)for(;t(o,-1),!i(o););else for(;--l>=0;)for(;t(o,1),!i(o););}),n&&(r.count=(i,o)=>(C2.setTime(+i),S2.setTime(+o),e(C2),e(S2),Math.floor(n(C2,S2))),r.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?r.filter(s?o=>s(o)%i===0:o=>r.count(0,o)%i===0):r)),r}const Hv=cs(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);Hv.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?cs(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):Hv);Hv.range;const Ll=1e3,gi=Ll*60,Dl=gi*60,ql=Dl*24,w4=ql*7,x6=ql*30,_2=ql*365,wu=cs(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Ll)},(e,t)=>(t-e)/Ll,e=>e.getUTCSeconds());wu.range;const j4=cs(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Ll)},(e,t)=>{e.setTime(+e+t*gi)},(e,t)=>(t-e)/gi,e=>e.getMinutes());j4.range;const N4=cs(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*gi)},(e,t)=>(t-e)/gi,e=>e.getUTCMinutes());N4.range;const C4=cs(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Ll-e.getMinutes()*gi)},(e,t)=>{e.setTime(+e+t*Dl)},(e,t)=>(t-e)/Dl,e=>e.getHours());C4.range;const S4=cs(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Dl)},(e,t)=>(t-e)/Dl,e=>e.getUTCHours());S4.range;const Ax=cs(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*gi)/ql,e=>e.getDate()-1);Ax.range;const Zj=cs(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/ql,e=>e.getUTCDate()-1);Zj.range;const qq=cs(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/ql,e=>Math.floor(e/ql));qq.range;function im(e){return cs(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*gi)/w4)}const Jj=im(0),qv=im(1),dhe=im(2),uhe=im(3),Mf=im(4),mhe=im(5),fhe=im(6);Jj.range;qv.range;dhe.range;uhe.range;Mf.range;mhe.range;fhe.range;function om(e){return cs(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/w4)}const eN=om(0),Gv=om(1),hhe=om(2),ghe=om(3),If=om(4),phe=om(5),xhe=om(6);eN.range;Gv.range;hhe.range;ghe.range;If.range;phe.range;xhe.range;const _4=cs(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());_4.range;const A4=cs(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());A4.range;const Gl=cs(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Gl.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:cs(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});Gl.range;const Wl=cs(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Wl.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:cs(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});Wl.range;function Gq(e,t,n,s,r,i){const o=[[wu,1,Ll],[wu,5,5*Ll],[wu,15,15*Ll],[wu,30,30*Ll],[i,1,gi],[i,5,5*gi],[i,15,15*gi],[i,30,30*gi],[r,1,Dl],[r,3,3*Dl],[r,6,6*Dl],[r,12,12*Dl],[s,1,ql],[s,2,2*ql],[n,1,w4],[t,1,x6],[t,3,3*x6],[e,1,_2]];function l(u,d,h){const p=d<u;p&&([u,d]=[d,u]);const x=h&&typeof h.range=="function"?h:c(u,d,h),b=x?x.range(u,+d+1):[];return p?b.reverse():b}function c(u,d,h){const p=Math.abs(d-u)/h,x=i4(([,,y])=>y).right(o,p);if(x===o.length)return e.every(_k(u/_2,d/_2,h));if(x===0)return Hv.every(Math.max(_k(u,d,h),1));const[b,j]=o[p/o[x-1][2]<o[x][2]/p?x-1:x];return b.every(j)}return[l,c]}const[yhe,bhe]=Gq(Wl,A4,eN,qq,S4,N4),[vhe,whe]=Gq(Gl,_4,Jj,Ax,C4,j4);function A2(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function T2(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function jg(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function jhe(e){var t=e.dateTime,n=e.date,s=e.time,r=e.periods,i=e.days,o=e.shortDays,l=e.months,c=e.shortMonths,u=Ng(r),d=Cg(r),h=Ng(i),p=Cg(i),x=Ng(o),b=Cg(o),j=Ng(l),y=Cg(l),N=Ng(c),w=Cg(c),S={a:Z,A:Q,b:le,B:we,c:null,d:N6,e:N6,f:Ghe,g:tge,G:nge,H:Bhe,I:Hhe,j:qhe,L:Wq,m:Whe,M:Vhe,p:J,q:se,Q:_6,s:A6,S:Yhe,u:Qhe,U:Khe,V:Xhe,w:Zhe,W:Jhe,x:null,X:null,y:ege,Y:age,Z:sge,"%":S6},_={a:ye,A:Ce,b:ge,B:be,c:null,d:C6,e:C6,f:lge,g:yge,G:vge,H:rge,I:ige,j:oge,L:Yq,m:cge,M:dge,p:me,q:Ae,Q:_6,s:A6,S:uge,u:mge,U:fge,V:hge,w:gge,W:pge,x:null,X:null,y:xge,Y:bge,Z:wge,"%":S6},T={a:F,A:D,b:P,B,c:G,d:w6,e:w6,f:Rhe,g:v6,G:b6,H:j6,I:j6,j:Ohe,L:$he,m:Phe,M:Mhe,p:M,q:Dhe,Q:Fhe,s:Uhe,S:Ihe,u:Ahe,U:The,V:khe,w:_he,W:Ehe,x:$,X:W,y:v6,Y:b6,Z:Lhe,"%":zhe};S.x=k(n,S),S.X=k(s,S),S.c=k(t,S),_.x=k(n,_),_.X=k(s,_),_.c=k(t,_);function k(pe,Ie){return function(xe){var he=[],Re=-1,Ee=0,He=pe.length,Ke,st,it;for(xe instanceof Date||(xe=new Date(+xe));++Re<He;)pe.charCodeAt(Re)===37&&(he.push(pe.slice(Ee,Re)),(st=y6[Ke=pe.charAt(++Re)])!=null?Ke=pe.charAt(++Re):st=Ke==="e"?" ":"0",(it=Ie[Ke])&&(Ke=it(xe,st)),he.push(Ke),Ee=Re+1);return he.push(pe.slice(Ee,Re)),he.join("")}}function A(pe,Ie){return function(xe){var he=jg(1900,void 0,1),Re=E(he,pe,xe+="",0),Ee,He;if(Re!=xe.length)return null;if("Q"in he)return new Date(he.Q);if("s"in he)return new Date(he.s*1e3+("L"in he?he.L:0));if(Ie&&!("Z"in he)&&(he.Z=0),"p"in he&&(he.H=he.H%12+he.p*12),he.m===void 0&&(he.m="q"in he?he.q:0),"V"in he){if(he.V<1||he.V>53)return null;"w"in he||(he.w=1),"Z"in he?(Ee=T2(jg(he.y,0,1)),He=Ee.getUTCDay(),Ee=He>4||He===0?Gv.ceil(Ee):Gv(Ee),Ee=Zj.offset(Ee,(he.V-1)*7),he.y=Ee.getUTCFullYear(),he.m=Ee.getUTCMonth(),he.d=Ee.getUTCDate()+(he.w+6)%7):(Ee=A2(jg(he.y,0,1)),He=Ee.getDay(),Ee=He>4||He===0?qv.ceil(Ee):qv(Ee),Ee=Ax.offset(Ee,(he.V-1)*7),he.y=Ee.getFullYear(),he.m=Ee.getMonth(),he.d=Ee.getDate()+(he.w+6)%7)}else("W"in he||"U"in he)&&("w"in he||(he.w="u"in he?he.u%7:"W"in he?1:0),He="Z"in he?T2(jg(he.y,0,1)).getUTCDay():A2(jg(he.y,0,1)).getDay(),he.m=0,he.d="W"in he?(he.w+6)%7+he.W*7-(He+5)%7:he.w+he.U*7-(He+6)%7);return"Z"in he?(he.H+=he.Z/100|0,he.M+=he.Z%100,T2(he)):A2(he)}}function E(pe,Ie,xe,he){for(var Re=0,Ee=Ie.length,He=xe.length,Ke,st;Re<Ee;){if(he>=He)return-1;if(Ke=Ie.charCodeAt(Re++),Ke===37){if(Ke=Ie.charAt(Re++),st=T[Ke in y6?Ie.charAt(Re++):Ke],!st||(he=st(pe,xe,he))<0)return-1}else if(Ke!=xe.charCodeAt(he++))return-1}return he}function M(pe,Ie,xe){var he=u.exec(Ie.slice(xe));return he?(pe.p=d.get(he[0].toLowerCase()),xe+he[0].length):-1}function F(pe,Ie,xe){var he=x.exec(Ie.slice(xe));return he?(pe.w=b.get(he[0].toLowerCase()),xe+he[0].length):-1}function D(pe,Ie,xe){var he=h.exec(Ie.slice(xe));return he?(pe.w=p.get(he[0].toLowerCase()),xe+he[0].length):-1}function P(pe,Ie,xe){var he=N.exec(Ie.slice(xe));return he?(pe.m=w.get(he[0].toLowerCase()),xe+he[0].length):-1}function B(pe,Ie,xe){var he=j.exec(Ie.slice(xe));return he?(pe.m=y.get(he[0].toLowerCase()),xe+he[0].length):-1}function G(pe,Ie,xe){return E(pe,t,Ie,xe)}function $(pe,Ie,xe){return E(pe,n,Ie,xe)}function W(pe,Ie,xe){return E(pe,s,Ie,xe)}function Z(pe){return o[pe.getDay()]}function Q(pe){return i[pe.getDay()]}function le(pe){return c[pe.getMonth()]}function we(pe){return l[pe.getMonth()]}function J(pe){return r[+(pe.getHours()>=12)]}function se(pe){return 1+~~(pe.getMonth()/3)}function ye(pe){return o[pe.getUTCDay()]}function Ce(pe){return i[pe.getUTCDay()]}function ge(pe){return c[pe.getUTCMonth()]}function be(pe){return l[pe.getUTCMonth()]}function me(pe){return r[+(pe.getUTCHours()>=12)]}function Ae(pe){return 1+~~(pe.getUTCMonth()/3)}return{format:function(pe){var Ie=k(pe+="",S);return Ie.toString=function(){return pe},Ie},parse:function(pe){var Ie=A(pe+="",!1);return Ie.toString=function(){return pe},Ie},utcFormat:function(pe){var Ie=k(pe+="",_);return Ie.toString=function(){return pe},Ie},utcParse:function(pe){var Ie=A(pe+="",!0);return Ie.toString=function(){return pe},Ie}}}var y6={"-":"",_:" ",0:"0"},ws=/^\s*\d+/,Nhe=/^%/,Che=/[\\^$*+?|[\]().{}]/g;function Aa(e,t,n){var s=e<0?"-":"",r=(s?-e:e)+"",i=r.length;return s+(i<n?new Array(n-i+1).join(t)+r:r)}function She(e){return e.replace(Che,"\\$&")}function Ng(e){return new RegExp("^(?:"+e.map(She).join("|")+")","i")}function Cg(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function _he(e,t,n){var s=ws.exec(t.slice(n,n+1));return s?(e.w=+s[0],n+s[0].length):-1}function Ahe(e,t,n){var s=ws.exec(t.slice(n,n+1));return s?(e.u=+s[0],n+s[0].length):-1}function The(e,t,n){var s=ws.exec(t.slice(n,n+2));return s?(e.U=+s[0],n+s[0].length):-1}function khe(e,t,n){var s=ws.exec(t.slice(n,n+2));return s?(e.V=+s[0],n+s[0].length):-1}function Ehe(e,t,n){var s=ws.exec(t.slice(n,n+2));return s?(e.W=+s[0],n+s[0].length):-1}function b6(e,t,n){var s=ws.exec(t.slice(n,n+4));return s?(e.y=+s[0],n+s[0].length):-1}function v6(e,t,n){var s=ws.exec(t.slice(n,n+2));return s?(e.y=+s[0]+(+s[0]>68?1900:2e3),n+s[0].length):-1}function Lhe(e,t,n){var s=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return s?(e.Z=s[1]?0:-(s[2]+(s[3]||"00")),n+s[0].length):-1}function Dhe(e,t,n){var s=ws.exec(t.slice(n,n+1));return s?(e.q=s[0]*3-3,n+s[0].length):-1}function Phe(e,t,n){var s=ws.exec(t.slice(n,n+2));return s?(e.m=s[0]-1,n+s[0].length):-1}function w6(e,t,n){var s=ws.exec(t.slice(n,n+2));return s?(e.d=+s[0],n+s[0].length):-1}function Ohe(e,t,n){var s=ws.exec(t.slice(n,n+3));return s?(e.m=0,e.d=+s[0],n+s[0].length):-1}function j6(e,t,n){var s=ws.exec(t.slice(n,n+2));return s?(e.H=+s[0],n+s[0].length):-1}function Mhe(e,t,n){var s=ws.exec(t.slice(n,n+2));return s?(e.M=+s[0],n+s[0].length):-1}function Ihe(e,t,n){var s=ws.exec(t.slice(n,n+2));return s?(e.S=+s[0],n+s[0].length):-1}function $he(e,t,n){var s=ws.exec(t.slice(n,n+3));return s?(e.L=+s[0],n+s[0].length):-1}function Rhe(e,t,n){var s=ws.exec(t.slice(n,n+6));return s?(e.L=Math.floor(s[0]/1e3),n+s[0].length):-1}function zhe(e,t,n){var s=Nhe.exec(t.slice(n,n+1));return s?n+s[0].length:-1}function Fhe(e,t,n){var s=ws.exec(t.slice(n));return s?(e.Q=+s[0],n+s[0].length):-1}function Uhe(e,t,n){var s=ws.exec(t.slice(n));return s?(e.s=+s[0],n+s[0].length):-1}function N6(e,t){return Aa(e.getDate(),t,2)}function Bhe(e,t){return Aa(e.getHours(),t,2)}function Hhe(e,t){return Aa(e.getHours()%12||12,t,2)}function qhe(e,t){return Aa(1+Ax.count(Gl(e),e),t,3)}function Wq(e,t){return Aa(e.getMilliseconds(),t,3)}function Ghe(e,t){return Wq(e,t)+"000"}function Whe(e,t){return Aa(e.getMonth()+1,t,2)}function Vhe(e,t){return Aa(e.getMinutes(),t,2)}function Yhe(e,t){return Aa(e.getSeconds(),t,2)}function Qhe(e){var t=e.getDay();return t===0?7:t}function Khe(e,t){return Aa(Jj.count(Gl(e)-1,e),t,2)}function Vq(e){var t=e.getDay();return t>=4||t===0?Mf(e):Mf.ceil(e)}function Xhe(e,t){return e=Vq(e),Aa(Mf.count(Gl(e),e)+(Gl(e).getDay()===4),t,2)}function Zhe(e){return e.getDay()}function Jhe(e,t){return Aa(qv.count(Gl(e)-1,e),t,2)}function ege(e,t){return Aa(e.getFullYear()%100,t,2)}function tge(e,t){return e=Vq(e),Aa(e.getFullYear()%100,t,2)}function age(e,t){return Aa(e.getFullYear()%1e4,t,4)}function nge(e,t){var n=e.getDay();return e=n>=4||n===0?Mf(e):Mf.ceil(e),Aa(e.getFullYear()%1e4,t,4)}function sge(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Aa(t/60|0,"0",2)+Aa(t%60,"0",2)}function C6(e,t){return Aa(e.getUTCDate(),t,2)}function rge(e,t){return Aa(e.getUTCHours(),t,2)}function ige(e,t){return Aa(e.getUTCHours()%12||12,t,2)}function oge(e,t){return Aa(1+Zj.count(Wl(e),e),t,3)}function Yq(e,t){return Aa(e.getUTCMilliseconds(),t,3)}function lge(e,t){return Yq(e,t)+"000"}function cge(e,t){return Aa(e.getUTCMonth()+1,t,2)}function dge(e,t){return Aa(e.getUTCMinutes(),t,2)}function uge(e,t){return Aa(e.getUTCSeconds(),t,2)}function mge(e){var t=e.getUTCDay();return t===0?7:t}function fge(e,t){return Aa(eN.count(Wl(e)-1,e),t,2)}function Qq(e){var t=e.getUTCDay();return t>=4||t===0?If(e):If.ceil(e)}function hge(e,t){return e=Qq(e),Aa(If.count(Wl(e),e)+(Wl(e).getUTCDay()===4),t,2)}function gge(e){return e.getUTCDay()}function pge(e,t){return Aa(Gv.count(Wl(e)-1,e),t,2)}function xge(e,t){return Aa(e.getUTCFullYear()%100,t,2)}function yge(e,t){return e=Qq(e),Aa(e.getUTCFullYear()%100,t,2)}function bge(e,t){return Aa(e.getUTCFullYear()%1e4,t,4)}function vge(e,t){var n=e.getUTCDay();return e=n>=4||n===0?If(e):If.ceil(e),Aa(e.getUTCFullYear()%1e4,t,4)}function wge(){return"+0000"}function S6(){return"%"}function _6(e){return+e}function A6(e){return Math.floor(+e/1e3)}var tf,Kq,Xq;jge({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function jge(e){return tf=jhe(e),Kq=tf.format,tf.parse,Xq=tf.utcFormat,tf.utcParse,tf}function Nge(e){return new Date(e)}function Cge(e){return e instanceof Date?+e:+new Date(+e)}function T4(e,t,n,s,r,i,o,l,c,u){var d=f4(),h=d.invert,p=d.domain,x=u(".%L"),b=u(":%S"),j=u("%I:%M"),y=u("%I %p"),N=u("%a %d"),w=u("%b %d"),S=u("%B"),_=u("%Y");function T(k){return(c(k)<k?x:l(k)<k?b:o(k)<k?j:i(k)<k?y:s(k)<k?r(k)<k?N:w:n(k)<k?S:_)(k)}return d.invert=function(k){return new Date(h(k))},d.domain=function(k){return arguments.length?p(Array.from(k,Cge)):p().map(Nge)},d.ticks=function(k){var A=p();return e(A[0],A[A.length-1],k??10)},d.tickFormat=function(k,A){return A==null?T:u(A)},d.nice=function(k){var A=p();return(!k||typeof k.range!="function")&&(k=t(A[0],A[A.length-1],k??10)),k?p(zq(A,k)):d},d.copy=function(){return _x(d,T4(e,t,n,s,r,i,o,l,c,u))},d}function k4(){return ki.apply(T4(vhe,whe,Gl,_4,Jj,Ax,C4,j4,wu,Kq).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Zq(){return ki.apply(T4(yhe,bhe,Wl,A4,eN,Zj,S4,N4,wu,Xq).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function tN(){var e=0,t=1,n,s,r,i,o=Vs,l=!1,c;function u(h){return h==null||isNaN(h=+h)?c:o(r===0?.5:(h=(i(h)-n)*r,l?Math.max(0,Math.min(1,h)):h))}u.domain=function(h){return arguments.length?([e,t]=h,n=i(e=+e),s=i(t=+t),r=n===s?0:1/(s-n),u):[e,t]},u.clamp=function(h){return arguments.length?(l=!!h,u):l},u.interpolator=function(h){return arguments.length?(o=h,u):o};function d(h){return function(p){var x,b;return arguments.length?([x,b]=p,o=h(x,b),u):[o(0),o(1)]}}return u.range=d(lh),u.rangeRound=d(m4),u.unknown=function(h){return arguments.length?(c=h,u):c},function(h){return i=h,n=h(e),s=h(t),r=n===s?0:1/(s-n),u}}function _d(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function E4(){var e=Sd(tN()(Vs));return e.copy=function(){return _d(e,E4())},rc.apply(e,arguments)}function Jq(){var e=p4(tN()).domain([1,10]);return e.copy=function(){return _d(e,Jq()).base(e.base())},rc.apply(e,arguments)}function eG(){var e=x4(tN());return e.copy=function(){return _d(e,eG()).constant(e.constant())},rc.apply(e,arguments)}function L4(){var e=b4(tN());return e.copy=function(){return _d(e,L4()).exponent(e.exponent())},rc.apply(e,arguments)}function Sge(){return L4.apply(null,arguments).exponent(.5)}function tG(){var e=[],t=Vs;function n(s){if(s!=null&&!isNaN(s=+s))return t((Cx(e,s,1)-1)/(e.length-1))}return n.domain=function(s){if(!arguments.length)return e.slice();e=[];for(let r of s)r!=null&&!isNaN(r=+r)&&e.push(r);return e.sort(Nx),n},n.interpolator=function(s){return arguments.length?(t=s,n):t},n.range=function(){return e.map((s,r)=>t(r/(e.length-1)))},n.quantiles=function(s){return Array.from({length:s+1},(r,i)=>pfe(e,i/s))},n.copy=function(){return tG(t).domain(e)},rc.apply(n,arguments)}function aN(){var e=0,t=.5,n=1,s=1,r,i,o,l,c,u=Vs,d,h=!1,p;function x(j){return isNaN(j=+j)?p:(j=.5+((j=+d(j))-i)*(s*j<s*i?l:c),u(h?Math.max(0,Math.min(1,j)):j))}x.domain=function(j){return arguments.length?([e,t,n]=j,r=d(e=+e),i=d(t=+t),o=d(n=+n),l=r===i?0:.5/(i-r),c=i===o?0:.5/(o-i),s=i<r?-1:1,x):[e,t,n]},x.clamp=function(j){return arguments.length?(h=!!j,x):h},x.interpolator=function(j){return arguments.length?(u=j,x):u};function b(j){return function(y){var N,w,S;return arguments.length?([N,w,S]=y,u=Ffe(j,[N,w,S]),x):[u(0),u(.5),u(1)]}}return x.range=b(lh),x.rangeRound=b(m4),x.unknown=function(j){return arguments.length?(p=j,x):p},function(j){return d=j,r=j(e),i=j(t),o=j(n),l=r===i?0:.5/(i-r),c=i===o?0:.5/(o-i),s=i<r?-1:1,x}}function aG(){var e=Sd(aN()(Vs));return e.copy=function(){return _d(e,aG())},rc.apply(e,arguments)}function nG(){var e=p4(aN()).domain([.1,1,10]);return e.copy=function(){return _d(e,nG()).base(e.base())},rc.apply(e,arguments)}function sG(){var e=x4(aN());return e.copy=function(){return _d(e,sG()).constant(e.constant())},rc.apply(e,arguments)}function D4(){var e=b4(aN());return e.copy=function(){return _d(e,D4()).exponent(e.exponent())},rc.apply(e,arguments)}function _ge(){return D4.apply(null,arguments).exponent(.5)}function rG(e){return e.type==="piecewise"?v4(e.thresholds,e.colors):E4([e.min??0,e.max??100],e.color)}function $f(e){return e.values?Ap(e.values,e.colors).unknown(e.unknownColor??null):Ap(e.colors.map((t,n)=>n),e.colors).unknown(e.unknownColor??null)}function Cf(e){return e.type==="ordinal"?$f(e):rG(e)}function iG(e,t,n){const{tickMaxStep:s,tickMinStep:r,tickNumber:i}=e,o=r===void 0?999:Math.floor(Math.abs(t[1]-t[0])/r),l=s===void 0?2:Math.ceil(Math.abs(t[1]-t[0])/s);return Math.min(o,Math.max(l,i??n))}function oG(e,t){return t[1]-t[0]===0?1:e/((t[1]-t[0])/100)}function P4(e){return Math.floor(Math.abs(e)/50)}function T6(e){return Array.isArray(e)?JSON.stringify(e):typeof e=="object"&&e!==null?e.valueOf():e}function nN(...e){let t=new Rv(void 0,T6),n=[],s=[],r=0,i=1,o,l,c=!1,u=0,d=0,h=.5;const p=y=>{const N=t.get(y);if(N!==void 0)return s[N%s.length]},x=()=>{const y=n.length,N=i<r,w=N?i:r,S=N?r:i;o=(S-w)/Math.max(1,y-u+d*2),c&&(o=Math.floor(o));const _=w+(S-w-o*(y-u))*h;l=o*(1-u);const T=c?Math.round(_):_;l=c?Math.round(l):l;const A=Eq(y).map(E=>T+o*E);return s=N?A.reverse():A,p};p.domain=function(y){if(!arguments.length)return n.slice();n=[],t=new Rv(void 0,T6);for(const N of y)t.has(N)||t.set(N,n.push(N)-1);return x()},p.range=function(y){if(!arguments.length)return[r,i];const[N,w]=y;return r=+N,i=+w,x()},p.rangeRound=function(y){const[N,w]=y;return r=+N,i=+w,c=!0,x()},p.bandwidth=function(){return l},p.step=function(){return o},p.round=function(y){return arguments.length?(c=!!y,x()):c},p.padding=function(y){return arguments.length?(u=Math.min(1,d=+y),x()):u},p.paddingInner=function(y){return arguments.length?(u=Math.min(1,y),x()):u},p.paddingOuter=function(y){return arguments.length?(d=+y,x()):d},p.align=function(y){return arguments.length?(h=Math.max(0,Math.min(1,y)),x()):h},p.copy=()=>nN(n,[r,i]).round(c).paddingInner(u).paddingOuter(d).align(h);const[b,j]=e;return e.length>1?(p.domain(b),p.range(j)):b?p.range(b):x(),p}function lG(...e){const t=nN(...e).paddingInner(1),n=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=()=>{const s=n();return s.padding=s.paddingOuter,delete s.paddingInner,delete s.paddingOuter,s.copy=t.copy,s},t}function cG(...e){const t=y4(...e),n=t.ticks,{negativeScale:s,linearScale:r,positiveScale:i}=Age(t);return t.ticks=o=>{const l=n(o),c=t.constant();let u=0,d=0,h=0;l.forEach(x=>{x>-c&&x<c&&(d+=1),x<=-c&&(u+=1),x>=c&&(h+=1)});const p=[];if(u>0&&p.push(...s.ticks(u)),d>0){const x=r.ticks(d);p.at(-1)===x[0]?p.push(...x.slice(1)):p.push(...x)}if(h>0){const x=i.ticks(h);p.at(-1)===x[0]?p.push(...x.slice(1)):p.push(...x)}return p},t.tickFormat=(o=10,l)=>{const c=t.constant(),[u,d]=t.domain(),h=d-u,p=s.domain(),x=p[1]-p[0],j=(h===0?0:x/h)*o,y=r.domain(),N=y[1]-y[0],S=(h===0?0:N/h)*o,_=i.domain(),T=_[1]-_[0],A=(h===0?0:T/h)*o,E=s.tickFormat(j,l),M=r.tickFormat(S,l),F=i.tickFormat(A,l);return D=>(D.valueOf()<=-c?E:D.valueOf()>=c?F:M)(D)},t.copy=()=>cG(t.domain(),t.range()).constant(t.constant()),t}function Age(e){const t=e.constant(),n=e.domain(),s=[n[0],Math.min(n[1],-t)],r=Dp(s,e.range()),i=[Math.max(n[0],-t),Math.min(n[1],t)],o=Kj(i,e.range()),l=[Math.max(n[0],t),n[1]],c=Dp(l,e.range());return{negativeScale:r,linearScale:o,positiveScale:c}}function sN(e,t,n){switch(e){case"log":return Dp(t,n);case"pow":return Xj(t,n);case"sqrt":return Fq(t,n);case"time":return k4(t,n);case"utc":return Zq(t,n);case"symlog":return cG(t,n);default:return Kj(t,n)}}const Lk=e=>e?.[0]instanceof Date;function Dk(e,t,n){const s=k4(e,t);return(r,{location:i})=>i==="tick"?s.tickFormat(n)(r):`${r.toLocaleString()}`}let k6,E6;class Tge{types=new Set;constructor(){if(k6)throw new Error("You can only create one instance!");k6=this.types}addType(t){this.types.add(t)}getTypes(){return this.types}}class kge{types=new Set;constructor(){if(E6)throw new Error("You can only create one instance!");E6=this.types}addType(t){this.types.add(t)}getTypes(){return this.types}}const rN=new Tge;rN.addType("bar");rN.addType("line");rN.addType("scatter");const dG=new kge;dG.addType("radar");function iN(e){return rN.getTypes().has(e)}function Wv(e){return iN(e.type)}const Ege=(e,t,n,s)=>{const r=new Set;return Object.keys(t).filter(iN).forEach(o=>{const l=n[o]?.series??{},c=t[o].axisTooltipGetter?.(l);c!==void 0&&c.forEach(({axisId:u,direction:d})=>{d===e&&r.add(u??s)})}),r};function js(e){return e.bandwidth!==void 0}function Lge(e){return js(e)&&e.paddingOuter!==void 0}function Dge(e,t,n){const s=t==="x"?[e.left,e.left+e.width]:[e.top+e.height,e.top];return n?[s[1],s[0]]:s}const Pge=.2,Oge=.1;function uG({scales:e,drawingArea:t,formattedSeries:n,axis:s,seriesConfig:r,axisDirection:i,zoomMap:o,domains:l}){if(s===void 0)return{axis:{},axisIds:[]};const c=Ege(i,r,n,s[0].id),u={};return s.forEach(d=>{const h=d,p=e[h.id],x=o?.get(h.id),b=x?[x.start,x.end]:[0,100],j=Dge(t,i,h.reverse??!1),y=!h.ignoreTooltip&&c.has(h.id),N=h.data??[];if(js(p)){const k=i==="y"?[j[1],j[0]]:j;if(Lge(p)&&sm(h)){const A=h.categoryGapRatio??Pge,E=h.barGapRatio??Oge;u[h.id]=Ze({offset:0,height:0,categoryGapRatio:A,barGapRatio:E,triggerTooltip:y},h,{data:N,scale:p,tickNumber:h.data.length,colorScale:h.colorMap&&(h.colorMap.type==="ordinal"?$f(Ze({values:h.data},h.colorMap)):Cf(h.colorMap))})}if(rm(h)&&(u[h.id]=Ze({offset:0,height:0,triggerTooltip:y},h,{data:N,scale:p,tickNumber:h.data.length,colorScale:h.colorMap&&(h.colorMap.type==="ordinal"?$f(Ze({values:h.data},h.colorMap)):Cf(h.colorMap))})),Lk(h.data)){const A=Dk(h.data,k,h.tickNumber);u[h.id].valueFormatter=h.valueFormatter??A}return}if(h.scaleType==="band"||h.scaleType==="point")return;const w=l[h.id].tickNumber,S=h,_=S.scaleType??"linear",T=oG(w,b);u[h.id]=Ze({offset:0,height:0,triggerTooltip:y},S,{data:N,scaleType:_,scale:p,tickNumber:T,colorScale:S.colorMap&&rG(S.colorMap),valueFormatter:h.valueFormatter??ofe(T,sN(_,j.map(k=>p.invert(k)),j))})}),{axis:u,axisIds:s.map(({id:d})=>d)}}function Mge(e){return e!=null}function Ige(e,t,n,s){const r=e?.length??0,i=Math.floor(t*r/100),o=Math.ceil(n*r/100);return function(c,u){return(c[s]??e?.[u])==null?!0:u>=i&&u<o}}function $ge(e,t,n,s,r){const i=e[0].valueOf(),o=e[1].valueOf(),l=i+t*(o-i)/100,c=i+n*(o-i)/100;return function(d,h){const p=d[s]??r?.[h];return p==null?!0:p>=l&&p<=c}}const Rge=e=>({currentAxisId:t,seriesXAxisId:n,seriesYAxisId:s,isDefaultAxis:r})=>(i,o)=>!(t===n?s:n)||r?Object.values(e??{})[0]?.(i,o)??!0:[s,n].filter(u=>u!==t).map(u=>e[u??""]).filter(Mge).every(u=>u(i,o)),L6=e=>(t=[])=>t.reduce((n,s)=>{const{zoom:r,id:i,reverse:o}=s,l=r4(r,i,e,o);return l&&(n[i]=l),n},{}),zge=.2;function mG(e,t,n){const s=t==="x"?[e.left,e.left+e.width]:[e.top+e.height,e.top];return n.reverse?[s[1],s[0]]:s}function fG(e,t){const n=[0,1];if(sm(e)){const i=e.categoryGapRatio??zge;return nN(t,n).paddingInner(i).paddingOuter(i/2)}if(rm(e))return lG(t,n);const s=e.scaleType??"linear",r=sN(s,t,n);return cfe(e)&&e.constant!=null&&r.constant(e.constant),r}const hG=(e,t)=>{const n=e[1]-e[0],s=t[1]-t[0],r=e[0]-t[0]*n/s,i=e[1]+(100-t[1])*n/s;return[r,i]},Fge=(e,t,n,s,r,i,o)=>{const l=n==="x"?s[e].xExtremumGetter:s[e].yExtremumGetter,c=i[e]?.series??{};return l?.({series:c,axis:t,axisIndex:r,isDefaultAxis:r===0,getFilters:o})??[1/0,-1/0]};function oN(e,t,n,s,r,i){const o=Object.keys(n).filter(iN);let l=[1/0,-1/0];for(const c of o){const[u,d]=Fge(c,e,t,n,s,r,i);l=[Math.min(l[0],u),Math.max(l[1],d)]}return Number.isNaN(l[0])||Number.isNaN(l[1])?[1/0,-1/0]:l}const Uge=(e,t,n,s)=>{if(e.domainLimit!==void 0)return e.domainLimit;if(t==="x")for(const r of s.line?.seriesOrder??[]){const i=s.line.series[r];if(i.xAxisId===e.id||i.xAxisId===void 0&&n===0)return"strict"}return"nice"};function gG(e,t,n){return sN(e??"linear",t,[0,1]).nice(n).domain()}function pG(e,t,n,s,[r,i],o,l){const c=yG(e,t,n,s,l);let u=bG(e,r,i);if(typeof c=="function"){const{min:h,max:p}=c(r.valueOf(),i.valueOf());u[0]=h,u[1]=p}const d=iG(e,u,o);return c==="nice"&&(u=gG(e.scaleType,u,d)),u=["min"in e?e.min??u[0]:u[0],"max"in e?e.max??u[1]:u[1]],{domain:u,tickNumber:d}}function xG(e,t,n,s,[r,i],o,l){const c=yG(e,t,n,s,l);let u=bG(e,r,i);if(typeof c=="function"){const{min:d,max:h}=c(r.valueOf(),i.valueOf());u[0]=d,u[1]=h}return c==="nice"&&(u=gG(e.scaleType,u,o)),[e.min??u[0],e.max??u[1]]}function yG(e,t,n,s,r){return r?Uge(e,t,n,s):e.domainLimit??"nice"}function bG(e,t,n){let s=t,r=n;return"max"in e&&e.max!=null&&e.max<t&&(s=e.max),"min"in e&&e.min!=null&&e.min>t&&(r=e.min),!("min"in e)&&!("max"in e)?[s,r]:[e.min??s,e.max??r]}class Bge{constructor(){this.ids=[],this.values=[],this.length=0}clear(){this.length=0}push(t,n){let s=this.length++;for(;s>0;){const r=s-1>>1,i=this.values[r];if(n>=i)break;this.ids[s]=this.ids[r],this.values[s]=i,s=r}this.ids[s]=t,this.values[s]=n}pop(){if(this.length===0)return;const t=this.ids,n=this.values,s=t[0],r=--this.length;if(r>0){const i=t[r],o=n[r];let l=0;const c=r>>1;for(;l<c;){const u=(l<<1)+1,d=u+1,h=u+(+(d<r)&+(n[d]<n[u]));if(n[h]>=o)break;t[l]=t[h],n[l]=n[h],l=h}t[l]=i,n[l]=o}return s}peek(){return this.length>0?this.ids[0]:void 0}peekValue(){return this.length>0?this.values[0]:void 0}shrink(){this.ids.length=this.values.length=this.length}}const D6=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],k2=3;class O4{static from(t,n=0){if(n%8!==0)throw new Error("byteOffset must be 8-byte aligned.");if(!t||t.byteLength===void 0||t.buffer)throw new Error("Data must be an instance of ArrayBuffer or SharedArrayBuffer.");const[s,r]=new Uint8Array(t,n+0,2);if(s!==251)throw new Error("Data does not appear to be in a Flatbush format.");const i=r>>4;if(i!==k2)throw new Error(`Got v${i} data when expected v${k2}.`);const o=D6[r&15];if(!o)throw new Error("Unrecognized array type.");const[l]=new Uint16Array(t,n+2,1),[c]=new Uint32Array(t,n+4,1);return new O4(c,l,o,void 0,t,n)}constructor(t,n=16,s=Float64Array,r=ArrayBuffer,i,o=0){if(t===void 0)throw new Error("Missing required argument: numItems.");if(isNaN(t)||t<=0)throw new Error(`Unexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+n,2),65535),this.byteOffset=o;let l=t,c=l;this._levelBounds=[l*4];do l=Math.ceil(l/this.nodeSize),c+=l,this._levelBounds.push(c*4);while(l!==1);this.ArrayType=s,this.IndexArrayType=c<16384?Uint16Array:Uint32Array;const u=D6.indexOf(s),d=c*4*s.BYTES_PER_ELEMENT;if(u<0)throw new Error(`Unexpected typed array class: ${s}.`);if(i)this.data=i,this._boxes=new s(i,o+8,c*4),this._indices=new this.IndexArrayType(i,o+8+d,c),this._pos=c*4,this.minX=this._boxes[this._pos-4],this.minY=this._boxes[this._pos-3],this.maxX=this._boxes[this._pos-2],this.maxY=this._boxes[this._pos-1];else{const h=this.data=new r(8+d+c*this.IndexArrayType.BYTES_PER_ELEMENT);this._boxes=new s(h,8,c*4),this._indices=new this.IndexArrayType(h,8+d,c),this._pos=0,this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,new Uint8Array(h,0,2).set([251,(k2<<4)+u]),new Uint16Array(h,2,1)[0]=n,new Uint32Array(h,4,1)[0]=t}this._queue=new Bge}add(t,n,s=t,r=n){const i=this._pos>>2,o=this._boxes;return this._indices[i]=i,o[this._pos++]=t,o[this._pos++]=n,o[this._pos++]=s,o[this._pos++]=r,t<this.minX&&(this.minX=t),n<this.minY&&(this.minY=n),s>this.maxX&&(this.maxX=s),r>this.maxY&&(this.maxY=r),i}finish(){if(this._pos>>2!==this.numItems)throw new Error(`Added ${this._pos>>2} items when expected ${this.numItems}.`);const t=this._boxes;if(this.numItems<=this.nodeSize){t[this._pos++]=this.minX,t[this._pos++]=this.minY,t[this._pos++]=this.maxX,t[this._pos++]=this.maxY;return}const n=this.maxX-this.minX||1,s=this.maxY-this.minY||1,r=new Uint32Array(this.numItems),i=65535;for(let o=0,l=0;o<this.numItems;o++){const c=t[l++],u=t[l++],d=t[l++],h=t[l++],p=Math.floor(i*((c+d)/2-this.minX)/n),x=Math.floor(i*((u+h)/2-this.minY)/s);r[o]=Gge(p,x)}Pk(r,t,this._indices,0,this.numItems-1,this.nodeSize);for(let o=0,l=0;o<this._levelBounds.length-1;o++){const c=this._levelBounds[o];for(;l<c;){const u=l;let d=t[l++],h=t[l++],p=t[l++],x=t[l++];for(let b=1;b<this.nodeSize&&l<c;b++)d=Math.min(d,t[l++]),h=Math.min(h,t[l++]),p=Math.max(p,t[l++]),x=Math.max(x,t[l++]);this._indices[this._pos>>2]=u,t[this._pos++]=d,t[this._pos++]=h,t[this._pos++]=p,t[this._pos++]=x}}}search(t,n,s,r,i){if(this._pos!==this._boxes.length)throw new Error("Data not yet indexed - call index.finish().");let o=this._boxes.length-4;const l=[],c=[];for(;o!==void 0;){const u=Math.min(o+this.nodeSize*4,P6(o,this._levelBounds));for(let d=o;d<u;d+=4){if(s<this._boxes[d]||r<this._boxes[d+1]||t>this._boxes[d+2]||n>this._boxes[d+3])continue;const h=this._indices[d>>2]|0;o>=this.numItems*4?l.push(h):(i===void 0||i(h))&&(c.push(h),c.push(this._boxes[d]),c.push(this._boxes[d+1]))}o=l.pop()}return c}neighbors(t,n,s=1/0,r=1/0,i,o=Hge){if(this._pos!==this._boxes.length)throw new Error("Data not yet indexed - call index.finish().");let l=this._boxes.length-4;const c=this._queue,u=[];e:for(;l!==void 0;){const d=Math.min(l+this.nodeSize*4,P6(l,this._levelBounds));for(let h=l;h<d;h+=4){const p=this._indices[h>>2]|0,x=this._boxes[h],b=this._boxes[h+1],j=this._boxes[h+2],y=this._boxes[h+3],N=t<x?x-t:t>j?t-j:0,w=n<b?b-n:n>y?n-y:0,S=o(N,w);S>r||(l>=this.numItems*4?c.push(p<<1,S):(i===void 0||i(p))&&c.push((p<<1)+1,S))}for(;c.length&&c.peek()&1;)if(c.peekValue()>r||(u.push(c.pop()>>1),u.length===s))break e;l=c.length?c.pop()>>1:void 0}return c.clear(),u}}function Hge(e,t){return e*e+t*t}function P6(e,t){let n=0,s=t.length-1;for(;n<s;){const r=n+s>>1;t[r]>e?s=r:n=r+1}return t[n]}function Pk(e,t,n,s,r,i){if(Math.floor(s/i)>=Math.floor(r/i))return;const o=e[s],l=e[s+r>>1],c=e[r];let u=c;const d=Math.max(o,l);c>d?u=d:d===o?u=Math.max(l,c):d===l&&(u=Math.max(o,c));let h=s-1,p=r+1;for(;;){do h++;while(e[h]<u);do p--;while(e[p]>u);if(h>=p)break;qge(e,t,n,h,p)}Pk(e,t,n,s,p,i),Pk(e,t,n,p+1,r,i)}function qge(e,t,n,s,r){const i=e[s];e[s]=e[r],e[r]=i;const o=4*s,l=4*r,c=t[o],u=t[o+1],d=t[o+2],h=t[o+3];t[o]=t[l],t[o+1]=t[l+1],t[o+2]=t[l+2],t[o+3]=t[l+3],t[l]=c,t[l+1]=u,t[l+2]=d,t[l+3]=h;const p=n[s];n[s]=n[r],n[r]=p}function Gge(e,t){let n=e^t,s=65535^n,r=65535^(e|t),i=e&(t^65535),o=n|s>>1,l=n>>1^n,c=r>>1^s&i>>1^r,u=n&r>>1^i>>1^i;n=o,s=l,r=c,i=u,o=n&n>>2^s&s>>2,l=n&s>>2^s&(n^s)>>2,c^=n&r>>2^s&i>>2,u^=s&r>>2^(n^s)&i>>2,n=o,s=l,r=c,i=u,o=n&n>>4^s&s>>4,l=n&s>>4^s&(n^s)>>4,c^=n&r>>4^s&i>>4,u^=s&r>>4^(n^s)&i>>4,n=o,s=l,r=c,i=u,c^=n&r>>8^s&i>>8,u^=s&r>>8^(n^s)&i>>8,n=c^c>>1,s=u^u>>1;let d=e^t,h=s|65535^(d|n);return d=(d|d<<8)&16711935,d=(d|d<<4)&252645135,d=(d|d<<2)&858993459,d=(d|d<<1)&1431655765,h=(h|h<<8)&16711935,h=(h|h<<4)&252645135,h=(h|h<<2)&858993459,h=(h|h<<1)&1431655765,(h<<1|d)>>>0}const Wge=e=>{const t=new Map;return e.forEach(n=>{t.set(n.axisId,n)}),t},vG=e=>e.zoom,Vge=Lt(Qo,sc,(e,t)=>e?.some(n=>!!n.zoom)||t?.some(n=>!!n.zoom)||!1),wG=Lt(vG,e=>e?.isInteracting),Ad=$n(vG,function(t){return t?.zoomData&&Wge(t?.zoomData)}),O6=Lt(Ad,(e,t)=>e?.get(t)),Tx=$n(Qo,sc,function(t,n){return Ze({},L6("x")(t),L6("y")(n))});Lt(Tx,(e,t)=>e[t]);const Yge=Lt(wr,function(t){return P4(t.width)}),Qge=Lt(wr,function(t){return P4(t.height)}),M4=$n(Qo,yn,Vr,Wj,Yge,function(t,n,s,r,i){const l={};return t?.forEach((c,u)=>{const d=c;if(sm(d)||rm(d)){l[d.id]={domain:d.data};return}const h=oN(d,"x",s,u,n);l[d.id]=pG(d,"x",u,n,h,i,r)}),{axes:t,domains:l}}),I4=$n(sc,yn,Vr,Wj,Qge,function(t,n,s,r,i){const l={};return t?.forEach((c,u)=>{const d=c;if(sm(d)||rm(d)){l[d.id]={domain:d.data};return}const h=oN(d,"y",s,u,n);l[d.id]=pG(d,"y",u,n,h,i,r)}),{axes:t,domains:l}}),jG=$n(Ad,Tx,M4,I4,function(t,n,{axes:s,domains:r},{axes:i,domains:o}){if(!t||!n)return;let l=!1;const c={},u=[...s??[],...i??[]];for(let d=0;d<u.length;d+=1){const h=u[d];if(!n[h.id]||n[h.id].filterMode!=="discard")continue;const p=t.get(h.id);if(p===void 0||p.start<=0&&p.end>=100)continue;const x=d<(s?.length??0)?"x":"y";if(h.scaleType==="band"||h.scaleType==="point")c[h.id]=Ige(h.data,p.start,p.end,x);else{const{domain:b}=x==="x"?r[h.id]:o[h.id];c[h.id]=$ge(b,p.start,p.end,x,h.data)}l=!0}if(l)return Rge(c)}),Kge=$n(yn,Vr,Ad,Tx,jG,Wj,M4,function(t,n,s,r,i,o,{axes:l,domains:c}){const u={};return l?.forEach((d,h)=>{const p=c[d.id].domain;if(sm(d)||rm(d)){u[d.id]=p;return}const x=s?.get(d.id),b=r?.[d.id],j=x===void 0&&!b?i:void 0;if(!j){u[d.id]=p;return}const y=c[d.id].tickNumber,N=oN(d,"x",n,h,t,j);u[d.id]=xG(d,"x",h,t,N,y,o)}),u}),Xge=$n(yn,Vr,Ad,Tx,jG,Wj,I4,function(t,n,s,r,i,o,{axes:l,domains:c}){const u={};return l?.forEach((d,h)=>{const p=c[d.id].domain;if(sm(d)||rm(d)){u[d.id]=p;return}const x=s?.get(d.id),b=r?.[d.id],j=x===void 0&&!b?i:void 0;if(!j){u[d.id]=p;return}const y=c[d.id].tickNumber,N=oN(d,"y",n,h,t,j);u[d.id]=xG(d,"y",h,t,N,y,o)}),u}),NG=$n(Qo,Kge,function(t,n){const s={};return t?.forEach(r=>{const i=r,o=n[i.id];s[i.id]=fG(i,o)}),s}),CG=$n(sc,Xge,function(t,n){const s={};return t?.forEach(r=>{const i=r,o=n[i.id];s[i.id]=fG(i,o)}),s}),Zge=$n(Qo,NG,wr,Ad,function(t,n,s,r){const i={};return t?.forEach(o=>{const l=o,c=r?.get(l.id),u=c?[c.start,c.end]:[0,100],d=mG(s,"x",l),h=n[l.id].copy(),p=hG(d,u);h.range(p),i[l.id]=h}),i}),Jge=$n(sc,CG,wr,Ad,function(t,n,s,r){const i={};return t?.forEach(o=>{const l=o,c=r?.get(l.id),u=c?[c.start,c.end]:[0,100],d=mG(s,"y",l),h=n[l.id].copy(),p=js(h)?d.reverse():d,x=hG(p,u);h.range(x),i[l.id]=h}),i}),Xs=$n(wr,yn,Vr,Ad,M4,Zge,function(t,n,s,r,{axes:i,domains:o},l){return uG({scales:l,drawingArea:t,formattedSeries:n,axis:i,seriesConfig:s,axisDirection:"x",zoomMap:r,domains:o})}),Zs=$n(wr,yn,Vr,Ad,I4,Jge,function(t,n,s,r,{axes:i,domains:o},l){return uG({scales:l,drawingArea:t,formattedSeries:n,axis:i,seriesConfig:s,axisDirection:"y",zoomMap:r,domains:o})});Lt(Xs,Zs,(e,t,n)=>e?.axis[n]??t?.axis[n]);Lt(Qo,sc,(e,t,n)=>{const s=e?.find(r=>r.id===n)??t?.find(r=>r.id===n)??null;if(s)return s});const epe=Lt(Qo,e=>e[0].id),tpe=Lt(sc,e=>e[0].id),ape=new Map,npe=()=>ape,spe=$n(yn,NG,CG,epe,tpe,function(t,n,s,r,i){const o=t.scatter,l=new Map;return o&&o.seriesOrder.forEach(c=>{const{data:u,xAxisId:d=r,yAxisId:h=i}=o.series[c],p=new O4(u.length),x=n[d],b=s[h];for(const j of u)p.add(x(j.x),b(j.y));p.finish(),l.set(c,p)}),l});function af(e){return e instanceof Date?e.getTime():e}function Rf(e,t){const{scale:n,data:s,reverse:r}=e;if(!js(n)){const o=n.invert(t);if(s===void 0)return-1;const l=af(o);return s?.findIndex((u,d)=>{const h=af(u);return h>l&&(d===0||Math.abs(l-h)<=Math.abs(l-af(s[d-1])))||h<=l&&(d===s.length-1||Math.abs(af(o)-h)<Math.abs(af(o)-af(s[d+1])))})}const i=n.bandwidth()===0?Math.floor((t-Math.min(...n.range())+n.step()/2)/n.step()):Math.floor((t-Math.min(...n.range()))/n.step());return i<0||i>=s.length?-1:r?s.length-1-i:i}function M6(e,t,n,s){if(!js(e)){if(s===null){const r=e.invert(n);return Number.isNaN(r)?null:r}return t[s]}return s===null||s<0||s>=t.length?null:t[s]}function Pp(e,t){const n=e.createSVGPoint();return n.x=t.clientX,n.y=t.clientY,n.matrixTransform(e.getScreenCTM().inverse())}const rpe=Object.is;function SG(e,t){if(e===t)return!0;if(!(e instanceof Object)||!(t instanceof Object))return!1;let n=0,s=0;for(const r in e)if(n+=1,!rpe(e[r],t[r])||!(r in t))return!1;for(const r in t)s+=1;return n===s}const kx=({store:e})=>{const t=ys(function(){e.set("interaction",Ze({},e.state.interaction,{pointer:null,item:null}))}),n=ys(function(o){const l=e.state.interaction.item;if(!o){l!==null&&e.set("interaction",Ze({},e.state.interaction,{item:null}));return}l===null||Object.keys(o).some(c=>o[c]!==l[c])||e.set("interaction",Ze({},e.state.interaction,{item:null}))}),s=ys(function(o,l){SG(e.state.interaction.item,o)||e.set("interaction",Ze({},e.state.interaction,{lastUpdate:l.interaction,item:o}))}),r=ys(function(o){e.set("interaction",Ze({},e.state.interaction,{pointer:o,lastUpdate:o!==null?"pointer":e.state.interaction.lastUpdate}))});return{instance:{cleanInteraction:t,setItemInteraction:s,removeItemInteraction:n,setPointerCoordinate:r}}};kx.getInitialState=()=>({interaction:{item:null,pointer:null,lastUpdate:"pointer"}});kx.params={};const lN=e=>e.interaction,ipe=Lt(lN,e=>e!==void 0),_G=Lt(lN,e=>e?.item??null),AG=Lt(lN,e=>e?.pointer??null),Ex=Lt(AG,e=>e&&e.x),Lx=Lt(AG,e=>e&&e.y),ope=Lt(_G,e=>e!==null),Dx=Lt(lN,e=>e?.lastUpdate),lpe=new Set(["bar","line","scatter","pie"]);function TG(e){return lpe.has(e)}function kG(e,t,n){const s=Object.keys(e),r=t!==void 0&&e[t]?s.indexOf(t):0,i=t!==void 0&&n!==void 0&&e[t]&&e[t].series[n]?e[t].seriesOrder.indexOf(n):-1,o=s.filter(TG);for(let d=0;d<o.length;d+=1){const h=(r+d)%o.length,p=e[o[h]],x=d===0?i+1:0;for(let b=x;b<p.seriesOrder.length;b+=1)if(p.series[p.seriesOrder[b]].data.length>0)return{type:o[h],seriesId:p.seriesOrder[b]}}const l=r,c=e[o[l]],u=i;for(let d=0;d<u;d+=1)if(c.series[c.seriesOrder[d]].data.length>0)return{type:o[l],seriesId:c.seriesOrder[d]};return null}function EG(e,t,n){const s=Object.keys(e),r=t!==void 0&&e[t]?s.indexOf(t):0,i=t!==void 0&&n!==void 0&&e[t]&&e[t].series[n]?e[t].seriesOrder.indexOf(n):1,o=s.filter(TG);for(let d=0;d<o.length;d+=1){const h=(o.length+r-d)%o.length,p=e[o[h]],x=d===0?i+1:p.seriesOrder.length;for(let b=1;b<x;b+=1){const j=(p.seriesOrder.length+i-b)%p.seriesOrder.length;if(p.series[p.seriesOrder[j]].data.length>0)return{type:o[h],seriesId:p.seriesOrder[j]}}}const l=r,c=e[o[l]],u=c.seriesOrder;for(let d=u.length-1;d>i;d-=1)if(c.series[c.seriesOrder[d]].data.length>0)return{type:o[l],seriesId:c.seriesOrder[d]};return null}function LG(e,t,n){if(t==="sankey")return!1;const s=e[t]?.series[n]?.data;return s&&s.length>0}function cpe(e){const t=yn(e);let{type:n,seriesId:s}=e.keyboardNavigation.item??{};if(n===void 0||n==="sankey"||s===void 0||!LG(t,n,s)){const i=kG(t,n,s);if(i===null)return null;n=i.type,s=i.seriesId}const r=t[n].series[s].data.length;return{type:n,seriesId:s,dataIndex:((e.keyboardNavigation.item?.dataIndex??-1)+1)%r}}function dpe(e){const t=yn(e);let{type:n,seriesId:s}=e.keyboardNavigation.item??{};if(n===void 0||n==="sankey"||s===void 0||!LG(t,n,s)){const i=EG(t,n,s);if(i===null)return null;n=i.type,s=i.seriesId}const r=t[n].series[s].data.length;return{type:n,seriesId:s,dataIndex:(r+(e.keyboardNavigation.item?.dataIndex??1)-1)%r}}function upe(e){const t=yn(e);let{type:n,seriesId:s}=e.keyboardNavigation.item??{};const r=kG(t,n,s);if(r===null)return null;n=r.type,s=r.seriesId;const i=t[n].series[s].data.length;return{type:n,seriesId:s,dataIndex:Math.min(i-1,e.keyboardNavigation.item?.dataIndex??0)}}function mpe(e){const t=yn(e);let{type:n,seriesId:s}=e.keyboardNavigation.item??{};const r=EG(t,n,s);if(r===null)return null;n=r.type,s=r.seriesId;const i=t[n].series[s].data.length;return{type:n,seriesId:s,dataIndex:Math.min(i-1,e.keyboardNavigation.item?.dataIndex??0)}}const cN=({params:e,store:t,svgRef:n})=>{const s=ys(function(){t.state.keyboardNavigation.item!==null&&t.set("keyboardNavigation",Ze({},t.state.keyboardNavigation,{item:null}))});return f.useEffect(()=>{const r=n.current;if(!r||!e.enableKeyboardNavigation)return;function i(o){let l=t.state.keyboardNavigation.item;switch(o.key){case"ArrowRight":l=cpe(t.state);break;case"ArrowLeft":l=dpe(t.state);break;case"ArrowDown":{l=mpe(t.state);break}case"ArrowUp":{l=upe(t.state);break}}l!==t.state.keyboardNavigation.item&&(o.preventDefault(),t.update(Ze({},t.state.highlight&&{highlight:Ze({},t.state.highlight,{lastUpdate:"keyboard"})},t.state.interaction&&{interaction:Ze({},t.state.interaction,{lastUpdate:"keyboard"})},{keyboardNavigation:Ze({},t.state.keyboardNavigation,{item:l})})))}return r.addEventListener("keydown",i),r.addEventListener("blur",s),()=>{r.removeEventListener("keydown",i),r.removeEventListener("blur",s)}},[n,s,e.enableKeyboardNavigation,t]),ls(()=>{t.state.keyboardNavigation.enableKeyboardNavigation!==e.enableKeyboardNavigation&&t.set("keyboardNavigation",Ze({},t.state.keyboardNavigation,{enableKeyboardNavigation:!!e.enableKeyboardNavigation}))},[t,e.enableKeyboardNavigation]),{}};cN.getInitialState=e=>({keyboardNavigation:{item:null,enableKeyboardNavigation:!!e.enableKeyboardNavigation}});cN.params={enableKeyboardNavigation:!0};const lm=e=>e.keyboardNavigation;Lt(lm,(e,t)=>e?.item!=null&&e.item.type===t.seriesType&&e.item.seriesId===t.seriesId&&e.item.dataIndex===t.dataIndex);const fpe=Lt(lm,e=>e?.item!=null),dN=Lt(lm,e=>e?.item?.type),uN=Lt(lm,e=>e?.item?.seriesId),mN=Lt(lm,e=>e?.item?.dataIndex),hpe=Lt(lm,e=>!!e?.enableKeyboardNavigation),DG=e=>(t,n,s,r,i)=>{if(t===void 0||n===void 0||s===void 0)return;const o=i[t]?.series[n];if(!o)return;let l=e==="x"?"xAxisId"in o&&o.xAxisId:"yAxisId"in o&&o.yAxisId;return(l===void 0||l===!1)&&(l=r.axisIds[0]),{axisId:l,dataIndex:s}},gpe=Lt(dN,uN,mN,Xs,yn,DG("x")),ppe=Lt(dN,uN,mN,Zs,yn,DG("y")),PG=Lt(lm,function(t){if(t?.item==null)return null;const{type:n,seriesId:s}=t.item;return n===void 0||s===void 0?null:t.item}),xpe=Lt(dN,uN,mN,function(t,n,s){return n!==void 0&&s!==void 0}),OG=Lt(Dx,_G,PG,(e,t,n)=>e==="keyboard"?n:t??null),ype=Lt(Dx,ope,xpe,(e,t,n)=>e==="keyboard"?n:t),bpe=Lt(OG,wr,Vr,Xs,Zs,yn,function(t,n,s,{axis:r,axisIds:i},{axis:o,axisIds:l},c,u="top"){if(!t)return null;const d=c[t.type]?.series[t.seriesId];if(d){const h={},p=Wv(d)?d.xAxisId??i[0]:void 0,x=Wv(d)?d.yAxisId??l[0]:void 0;return p!==void 0&&(h.x=r[p]),x!==void 0&&(h.y=o[x]),s[d.type].tooltipItemPositionGetter?.({series:c,drawingArea:n,axesConfig:h,identifier:t,placement:u})??null}return null});function Sf(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;if(Array.isArray(e)){const r=e.length;if(r!==t.length)return!1;for(let i=0;i<r;i+=1)if(!Sf(e[i],t[i]))return!1;return!0}if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;const r=Array.from(e.entries());for(let i=0;i<r.length;i+=1)if(!t.has(r[i][0]))return!1;for(let i=0;i<r.length;i+=1){const o=r[i];if(!Sf(o[1],t.get(o[0])))return!1}return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;const r=Array.from(e.entries());for(let i=0;i<r.length;i+=1)if(!t.has(r[i][0]))return!1;return!0}if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){const r=e.length;if(r!==t.length)return!1;for(let i=0;i<r;i+=1)if(e[i]!==t[i])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();const n=Object.keys(e),s=n.length;if(s!==Object.keys(t).length)return!1;for(let r=0;r<s;r+=1)if(!Object.prototype.hasOwnProperty.call(t,n[r]))return!1;for(let r=0;r<s;r+=1){const i=n[r];if(!Sf(e[i],t[i]))return!1}return!0}return e!==e&&t!==t}function Ok(e,t,n=t.axisIds[0]){return Array.isArray(n)?n.map(s=>Rf(t.axis[s],e)):Rf(t.axis[n],e)}const MG=(e,t,n)=>{if(e===null)return null;const s=Ok(e,t,n);return s===-1?null:s},$4=Lt(Ex,Xs,MG),R4=Lt(Lx,Zs,MG),vpe=Lt(Ex,Lx,Xs,Zs,(e,t,n,s)=>[...e===null?[]:n.axisIds.map(r=>({axisId:r,dataIndex:Ok(e,n,r)})),...t===null?[]:s.axisIds.map(r=>({axisId:r,dataIndex:Ok(t,s,r)}))].filter(r=>r.dataIndex!==null&&r.dataIndex>=0));function IG(e,t,n,s=t.axisIds[0]){return Array.isArray(s)?s.map((r,i)=>{const o=t.axis[r];return M6(o.scale,o.data,e,n[i])}):M6(t.axis[s].scale,t.axis[s].data,e,n)}const wpe=Lt(Ex,Xs,$4,(e,t,n,s)=>e===null||t.axisIds.length===0?null:IG(e,t,n,s)),jpe=Lt(Lx,Zs,R4,(e,t,n,s)=>e===null||t.axisIds.length===0?null:IG(e,t,n,s)),$G=[],RG=Uj({memoizeOptions:{resultEqualityCheck:Sf}})(Ex,Xs,(e,t)=>e===null?$G:t.axisIds.filter(n=>t.axis[n].triggerTooltip).map(n=>({axisId:n,dataIndex:Rf(t.axis[n],e)})).filter(({dataIndex:n})=>n>=0)),zG=Uj({memoizeOptions:{resultEqualityCheck:Sf}})(Lx,Zs,(e,t)=>e===null?$G:t.axisIds.filter(n=>t.axis[n].triggerTooltip).map(n=>({axisId:n,dataIndex:Rf(t.axis[n],e)})).filter(({dataIndex:n})=>n>=0)),Npe=Lt(RG,zG,(e,t)=>e.length>0||t.length>0);function Cpe(e){return e.setPointerCoordinate!==void 0}const ch=({params:e,store:t,seriesConfig:n,svgRef:s,instance:r})=>{const{xAxis:i,yAxis:o,dataset:l,onHighlightedAxisChange:c}=e,u=Vt(t,wr),d=Vt(t,yn),h=Vt(t,ipe),{axis:p,axisIds:x}=Vt(t,Xs),{axis:b,axisIds:j}=Vt(t,Zs);jq({controlled:e.highlightedAxis}),ls(()=>{e.highlightedAxis!==void 0&&t.set("controlledCartesianAxisHighlight",e.highlightedAxis)},[t,e.highlightedAxis]);const y=f.useRef(!0);f.useEffect(()=>{if(y.current){y.current=!1;return}t.set("cartesianAxis",{x:Sq(i,l),y:_q(o,l)})},[n,u,i,o,l,t]);const N=x[0],w=j[0];fme(t,vpe,(_,T)=>{if(c&&!Object.is(_,T)){if(_.length!==T.length){c(T);return}_?.some(({axisId:k,dataIndex:A},E)=>T[E].axisId!==k||T[E].dataIndex!==A)&&c(T)}});const S=Cpe(r);return f.useEffect(()=>{const _=s.current;if(!h||!S||!_||e.disableAxisListener)return()=>{};const T=r.addInteractionListener("moveEnd",P=>{P.detail.activeGestures.pan||r.cleanInteraction()}),k=r.addInteractionListener("panEnd",P=>{P.detail.activeGestures.move||r.cleanInteraction()}),A=r.addInteractionListener("quickPressEnd",P=>{!P.detail.activeGestures.move&&!P.detail.activeGestures.pan&&r.cleanInteraction()}),E=P=>{const B=P.detail.srcEvent,G=P.detail.target,$=Pp(_,B);if(P.detail.srcEvent.buttons>=1&&G?.hasPointerCapture(P.detail.srcEvent.pointerId)&&!G?.closest("[data-charts-zoom-slider]")&&G?.releasePointerCapture(P.detail.srcEvent.pointerId),!r.isPointInside($.x,$.y,G)){r.cleanInteraction?.();return}r.setPointerCoordinate($)},M=r.addInteractionListener("move",E),F=r.addInteractionListener("pan",E),D=r.addInteractionListener("quickPress",E);return()=>{M.cleanup(),T.cleanup(),F.cleanup(),k.cleanup(),D.cleanup(),A.cleanup()}},[s,t,p,N,b,w,r,e.disableAxisListener,h,S]),f.useEffect(()=>{const _=s.current,T=e.onAxisClick;if(_===null||!T)return()=>{};const k=r.addInteractionListener("tap",A=>{let E=null,M=!1;const F=Pp(_,A.detail.srcEvent),D=Rf(p[N],F.x);M=D!==-1,E=M?D:Rf(b[w],F.y);const P=M?x[0]:j[0];if(E==null||E===-1)return;const B=(M?p:b)[P].data[E],G={};Object.keys(d).filter($=>["bar","line"].includes($)).forEach($=>{d[$]?.seriesOrder.forEach(W=>{const Z=d[$].series[W],Q=Z.xAxisId,le=Z.yAxisId,we=M?Q:le;(we===void 0||we===P)&&(G[W]=Z.data[E])})}),T(A.detail.srcEvent,{dataIndex:E,axisValue:B,seriesValues:G})});return()=>{k.cleanup()}},[e.onAxisClick,d,s,p,x,b,j,N,w,r]),{}};ch.params={xAxis:!0,yAxis:!0,dataset:!0,onAxisClick:!0,disableAxisListener:!0,onHighlightedAxisChange:!0,highlightedAxis:!0};ch.getDefaultizedParams=({params:e})=>Ze({},e,{colors:e.colors??yq,theme:e.theme??"light",defaultizedXAxis:Sq(e.xAxis,e.dataset),defaultizedYAxis:_q(e.yAxis,e.dataset)});ch.getInitialState=e=>Ze({cartesianAxis:{x:e.defaultizedXAxis,y:e.defaultizedYAxis}},e.highlightedAxis===void 0?{}:{controlledCartesianAxisHighlight:e.highlightedAxis});const Ko=e=>e.brush;Lt(Ko,e=>e?.start);Lt(Ko,e=>e?.current);const Spe=Lt(Ko,e=>e?.start?.x??null),_pe=Lt(Ko,e=>e?.start?.y??null),Ape=Lt(Ko,e=>e?.current?.x??null),Tpe=Lt(Ko,e=>e?.current?.y??null);Lt(Spe,_pe,Ape,Tpe,(e,t,n,s)=>e===null||t===null||n===null||s===null?null:{start:{x:e,y:t},current:{x:n,y:s}});const kpe=Lt(yn,e=>{let t=!1,n=!1;return e&&Object.entries(e).forEach(([s,r])=>{Object.values(r.series).some(i=>i.layout==="horizontal")&&(t=!0),s==="scatter"&&r.seriesOrder.length>0&&(n=!0)}),n?"xy":t?"y":"x"}),Epe=Lt(Tx,function(t){let n=!1,s=!1;return Object.values(t).forEach(r=>{r.axisDirection==="y"&&(s=!0),r.axisDirection==="x"&&(n=!0)}),n&&s?"xy":s?"y":n?"x":null});Lt(kpe,Epe,(e,t)=>t??e);const FG=Lt(Ko,e=>e?.enabled||e?.isZoomBrushEnabled),UG=Lt(FG,Ko,(e,t)=>e&&t?.start!==null&&t?.current!==null),fN=Lt(Ko,UG,(e,t)=>t&&e?.preventHighlight),Lpe=Lt(Ko,UG,(e,t)=>t&&e?.preventTooltip),Px=({store:e,svgRef:t,instance:n,params:s})=>{const r=Vt(e,FG);ls(()=>{e.set("brush",Ze({},e.state.brush,{enabled:s.brushConfig.enabled,preventTooltip:s.brushConfig.preventTooltip,preventHighlight:s.brushConfig.preventHighlight}))},[e,s.brushConfig.enabled,s.brushConfig.preventTooltip,s.brushConfig.preventHighlight]);const i=ys(function(u){e.set("brush",Ze({},e.state.brush,{start:e.state.brush.start??u,current:u}))}),o=ys(function(){e.set("brush",Ze({},e.state.brush,{start:null,current:null}))}),l=ys(function(u){e.state.brush.isZoomBrushEnabled!==u&&e.set("brush",Ze({},e.state.brush,{isZoomBrushEnabled:u}))});return f.useEffect(()=>{const c=t.current;if(c===null||!r)return()=>{};const u=j=>{if(j.detail.target?.closest("[data-charts-zoom-slider]"))return;const y=Pp(c,{clientX:j.detail.initialCentroid.x,clientY:j.detail.initialCentroid.y});i(y)},d=j=>{const y=Pp(c,{clientX:j.detail.centroid.x,clientY:j.detail.centroid.y});i(y)},h=n.addInteractionListener("brushStart",u),p=n.addInteractionListener("brush",d),x=n.addInteractionListener("brushCancel",o),b=n.addInteractionListener("brushEnd",o);return()=>{h.cleanup(),p.cleanup(),b.cleanup(),x.cleanup()}},[t,n,e,o,i,r]),{instance:{setBrushCoordinates:i,clearBrush:o,setZoomBrushEnabled:l}}};Px.params={brushConfig:!0};Px.getDefaultizedParams=({params:e})=>Ze({},e,{brushConfig:{enabled:e?.brushConfig?.enabled??!1,preventTooltip:e?.brushConfig?.preventTooltip??!0,preventHighlight:e?.brushConfig?.preventHighlight??!0}});Px.getInitialState=e=>({brush:{enabled:e.brushConfig.enabled,isZoomBrushEnabled:!1,preventTooltip:e.brushConfig.preventTooltip,preventHighlight:e.brushConfig.preventHighlight,start:null,current:null}});const dh=e=>e.controlledCartesianAxisHighlight,BG=(e,t,n,s)=>s?[]:n!==void 0?n.filter(r=>t.axis[r.axisId]!==void 0).map(r=>r):e===null?[]:[{axisId:t.axisIds[0],dataIndex:e}],HG=$n($4,Xs,dh,fN,BG);$n(R4,Zs,dh,fN,BG);const qG=(e,t,n,s,r,i,o)=>{if(o)return[];if(s!==void 0)return s.map(d=>Ze({},d,{value:n.axis[d.axisId]?.data?.[d.dataIndex]})).filter(({value:d})=>d!==void 0);const l=t!==null&&{axisId:n.axisIds[0],dataIndex:e,value:t},c=r&&n.axis[r.axisId]?.data?.[r.dataIndex],u=r&&c!=null&&Ze({},r,{value:c});if(i==="pointer"){if(l)return[l];if(u)return[u]}if(i==="keyboard"){if(u)return[u];if(l)return[l]}return[]},Dpe=Lt($4,wpe,Xs,dh,gpe,Dx,fN,qG),Ppe=Lt(R4,jpe,Zs,dh,ppe,Dx,fN,qG),GG=(e,t)=>e===void 0?[t.axis[t.axisIds[0]]]:e.map(s=>t.axis[s.axisId]??null).filter(s=>s!==null);Lt(dh,Xs,GG);Lt(dh,Zs,GG);function I6(e,t){return e.id!==void 0?e:Ze({id:t},e)}function $6(e){return e.colorMap?Ze({},e,{colorScale:e.colorMap.type==="ordinal"&&e.data?$f(Ze({values:e.data},e.colorMap)):Cf(e.colorMap.type==="continuous"?Ze({min:e.min,max:e.max},e.colorMap):e.colorMap)}):e}function WG(e,t){if(!e||e.length===0)return{axis:{},axisIds:[]};const n={},s=[];return e.forEach((r,i)=>{const o=r.dataKey,l=r.id??`defaultized-z-axis-${i}`;if(o===void 0||r.data!==void 0){n[l]=$6(I6(r,l)),s.push(l);return}if(t===void 0)throw new Error("MUI X Charts: z-axis uses `dataKey` but no `dataset` is provided.");n[l]=$6(I6(Ze({},r,{data:t.map(c=>c[o])}),l)),s.push(l)}),{axis:n,axisIds:s}}const Ox=({params:e,store:t})=>{const{zAxis:n,dataset:s}=e,r=f.useRef(!0);return f.useEffect(()=>{if(r.current){r.current=!1;return}t.set("zAxis",WG(n,s))},[n,s,t]),{}};Ox.params={zAxis:!0,dataset:!0};Ox.getInitialState=e=>({zAxis:WG(e.zAxis,e.dataset)});const Ope=e=>e,Mpe=Lt(Ope,e=>e.zAxis),Mx=({store:e,params:t})=>{jq({controlled:t.highlightedItem}),ls(()=>{e.state.highlight.item!==t.highlightedItem&&e.set("highlight",Ze({},e.state.highlight,{item:t.highlightedItem}))},[e,t.highlightedItem]);const n=ys(()=>{t.onHighlightChange?.(null);const r=e.getSnapshot().highlight;r.item===null||r.isControlled||e.set("highlight",{item:null,lastUpdate:"pointer",isControlled:!1})}),s=ys(r=>{const i=e.getSnapshot().highlight;i.isControlled||SG(i.item,r)||(t.onHighlightChange?.(r),e.set("highlight",{item:r,lastUpdate:"pointer",isControlled:!1}))});return{instance:{clearHighlight:n,setHighlight:s}}};Mx.getInitialState=e=>({highlight:{item:e.highlightedItem,lastUpdate:"pointer",isControlled:e.highlightedItem!==void 0}});Mx.params={highlightedItem:!0,onHighlightChange:!0};function Vv(e){let t=1/0,n=-1/0;for(const s of e??[])s<t&&(t=s),s>n&&(n=s);return[t,n]}const R6=(e,t)=>t==="x"?{x:e,y:null}:{x:null,y:e},VG=e=>{const{axis:t,getFilters:n,isDefaultAxis:s}=e,r=n?.({currentAxisId:t.id,isDefaultAxis:s}),i=r?t.data?.filter((o,l)=>r({x:null,y:null},l)):t.data;return Vv(i??[])},YG=e=>t=>{const{series:n,axis:s,getFilters:r,isDefaultAxis:i}=t;return Object.keys(n).filter(o=>{const l=e==="x"?n[o].xAxisId:n[o].yAxisId;return l===s.id||i&&l===void 0}).reduce((o,l)=>{const{stackedData:c}=n[l],u=r?.({currentAxisId:s.id,isDefaultAxis:i,seriesXAxisId:n[l].xAxisId,seriesYAxisId:n[l].yAxisId}),[d,h]=c?.reduce((p,x,b)=>u&&(!u(R6(x[0],e),b)||!u(R6(x[1],e),b))?p:[Math.min(...x,p[0]),Math.max(...x,p[1])],[1/0,-1/0])??[1/0,-1/0];return[Math.min(d,o[0]),Math.max(h,o[1])]},[1/0,-1/0])},Ipe=e=>Object.keys(e.series).some(n=>e.series[n].layout==="horizontal")?YG("x")(e):VG(e),$pe=e=>Object.keys(e.series).some(n=>e.series[n].layout==="horizontal")?VG(e):YG("y")(e);function ja(e){return function(){return e}}const QG=Math.cos,Yv=Math.sin,so=Math.sqrt,z6=1e-12,Qv=Math.PI,Eu=2*Qv,Mk=Math.PI,Ik=2*Mk,ru=1e-6,Rpe=Ik-ru;function KG(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function zpe(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return KG;const n=10**t;return function(s){this._+=s[0];for(let r=1,i=s.length;r<i;++r)this._+=Math.round(arguments[r]*n)/n+s[r]}}class Fpe{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?KG:zpe(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,s,r){this._append`Q${+t},${+n},${this._x1=+s},${this._y1=+r}`}bezierCurveTo(t,n,s,r,i,o){this._append`C${+t},${+n},${+s},${+r},${this._x1=+i},${this._y1=+o}`}arcTo(t,n,s,r,i){if(t=+t,n=+n,s=+s,r=+r,i=+i,i<0)throw new Error(`negative radius: ${i}`);let o=this._x1,l=this._y1,c=s-t,u=r-n,d=o-t,h=l-n,p=d*d+h*h;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(p>ru)if(!(Math.abs(h*c-u*d)>ru)||!i)this._append`L${this._x1=t},${this._y1=n}`;else{let x=s-o,b=r-l,j=c*c+u*u,y=x*x+b*b,N=Math.sqrt(j),w=Math.sqrt(p),S=i*Math.tan((Mk-Math.acos((j+p-y)/(2*N*w)))/2),_=S/w,T=S/N;Math.abs(_-1)>ru&&this._append`L${t+_*d},${n+_*h}`,this._append`A${i},${i},0,0,${+(h*x>d*b)},${this._x1=t+T*c},${this._y1=n+T*u}`}}arc(t,n,s,r,i,o){if(t=+t,n=+n,s=+s,o=!!o,s<0)throw new Error(`negative radius: ${s}`);let l=s*Math.cos(r),c=s*Math.sin(r),u=t+l,d=n+c,h=1^o,p=o?r-i:i-r;this._x1===null?this._append`M${u},${d}`:(Math.abs(this._x1-u)>ru||Math.abs(this._y1-d)>ru)&&this._append`L${u},${d}`,s&&(p<0&&(p=p%Ik+Ik),p>Rpe?this._append`A${s},${s},0,1,${h},${t-l},${n-c}A${s},${s},0,1,${h},${this._x1=u},${this._y1=d}`:p>ru&&this._append`A${s},${s},0,${+(p>=Mk)},${h},${this._x1=t+s*Math.cos(i)},${this._y1=n+s*Math.sin(i)}`)}rect(t,n,s,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${s=+s}v${+r}h${-s}Z`}toString(){return this._}}function z4(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const s=Math.floor(n);if(!(s>=0))throw new RangeError(`invalid digits: ${n}`);t=s}return e},()=>new Fpe(t)}function hN(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function XG(e){this._context=e}XG.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Ix(e){return new XG(e)}function ZG(e){return e[0]}function JG(e){return e[1]}function F4(e,t){var n=ja(!0),s=null,r=Ix,i=null,o=z4(l);e=typeof e=="function"?e:e===void 0?ZG:ja(e),t=typeof t=="function"?t:t===void 0?JG:ja(t);function l(c){var u,d=(c=hN(c)).length,h,p=!1,x;for(s==null&&(i=r(x=o())),u=0;u<=d;++u)!(u<d&&n(h=c[u],u,c))===p&&((p=!p)?i.lineStart():i.lineEnd()),p&&i.point(+e(h,u,c),+t(h,u,c));if(x)return i=null,x+""||null}return l.x=function(c){return arguments.length?(e=typeof c=="function"?c:ja(+c),l):e},l.y=function(c){return arguments.length?(t=typeof c=="function"?c:ja(+c),l):t},l.defined=function(c){return arguments.length?(n=typeof c=="function"?c:ja(!!c),l):n},l.curve=function(c){return arguments.length?(r=c,s!=null&&(i=r(s)),l):r},l.context=function(c){return arguments.length?(c==null?s=i=null:i=r(s=c),l):s},l}function Yg(e,t,n){var s=null,r=ja(!0),i=null,o=Ix,l=null,c=z4(u);e=typeof e=="function"?e:e===void 0?ZG:ja(+e),t=typeof t=="function"?t:ja(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?JG:ja(+n);function u(h){var p,x,b,j=(h=hN(h)).length,y,N=!1,w,S=new Array(j),_=new Array(j);for(i==null&&(l=o(w=c())),p=0;p<=j;++p){if(!(p<j&&r(y=h[p],p,h))===N)if(N=!N)x=p,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),b=p-1;b>=x;--b)l.point(S[b],_[b]);l.lineEnd(),l.areaEnd()}N&&(S[p]=+e(y,p,h),_[p]=+t(y,p,h),l.point(s?+s(y,p,h):S[p],n?+n(y,p,h):_[p]))}if(w)return l=null,w+""||null}function d(){return F4().defined(r).curve(o).context(i)}return u.x=function(h){return arguments.length?(e=typeof h=="function"?h:ja(+h),s=null,u):e},u.x0=function(h){return arguments.length?(e=typeof h=="function"?h:ja(+h),u):e},u.x1=function(h){return arguments.length?(s=h==null?null:typeof h=="function"?h:ja(+h),u):s},u.y=function(h){return arguments.length?(t=typeof h=="function"?h:ja(+h),n=null,u):t},u.y0=function(h){return arguments.length?(t=typeof h=="function"?h:ja(+h),u):t},u.y1=function(h){return arguments.length?(n=h==null?null:typeof h=="function"?h:ja(+h),u):n},u.lineX0=u.lineY0=function(){return d().x(e).y(t)},u.lineY1=function(){return d().x(e).y(n)},u.lineX1=function(){return d().x(s).y(t)},u.defined=function(h){return arguments.length?(r=typeof h=="function"?h:ja(!!h),u):r},u.curve=function(h){return arguments.length?(o=h,i!=null&&(l=o(i)),u):o},u.context=function(h){return arguments.length?(h==null?i=l=null:l=o(i=h),u):i},u}function Upe(e,t){return t<e?-1:t>e?1:t>=e?0:NaN}function Bpe(e){return e}function Hpe(){var e=Bpe,t=Upe,n=null,s=ja(0),r=ja(Eu),i=ja(0);function o(l){var c,u=(l=hN(l)).length,d,h,p=0,x=new Array(u),b=new Array(u),j=+s.apply(this,arguments),y=Math.min(Eu,Math.max(-Eu,r.apply(this,arguments)-j)),N,w=Math.min(Math.abs(y)/u,i.apply(this,arguments)),S=w*(y<0?-1:1),_;for(c=0;c<u;++c)(_=b[x[c]=c]=+e(l[c],c,l))>0&&(p+=_);for(t!=null?x.sort(function(T,k){return t(b[T],b[k])}):n!=null&&x.sort(function(T,k){return n(l[T],l[k])}),c=0,h=p?(y-u*S)/p:0;c<u;++c,j=N)d=x[c],_=b[d],N=j+(_>0?_*h:0)+S,b[d]={data:l[d],index:c,value:_,startAngle:j,endAngle:N,padAngle:w};return b}return o.value=function(l){return arguments.length?(e=typeof l=="function"?l:ja(+l),o):e},o.sortValues=function(l){return arguments.length?(t=l,n=null,o):t},o.sort=function(l){return arguments.length?(n=l,t=null,o):n},o.startAngle=function(l){return arguments.length?(s=typeof l=="function"?l:ja(+l),o):s},o.endAngle=function(l){return arguments.length?(r=typeof l=="function"?l:ja(+l),o):r},o.padAngle=function(l){return arguments.length?(i=typeof l=="function"?l:ja(+l),o):i},o}class eW{constructor(t,n){this._context=t,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,n){switch(t=+t,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,n,t,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,t,this._y0,t,n);break}}this._x0=t,this._y0=n}}function tW(e){return new eW(e,!0)}function aW(e){return new eW(e,!1)}const gN={draw(e,t){const n=so(t/Qv);e.moveTo(n,0),e.arc(0,0,n,0,Eu)}},nW={draw(e,t){const n=so(t/5)/2;e.moveTo(-3*n,-n),e.lineTo(-n,-n),e.lineTo(-n,-3*n),e.lineTo(n,-3*n),e.lineTo(n,-n),e.lineTo(3*n,-n),e.lineTo(3*n,n),e.lineTo(n,n),e.lineTo(n,3*n),e.lineTo(-n,3*n),e.lineTo(-n,n),e.lineTo(-3*n,n),e.closePath()}},sW=so(1/3),qpe=sW*2,rW={draw(e,t){const n=so(t/qpe),s=n*sW;e.moveTo(0,-n),e.lineTo(s,0),e.lineTo(0,n),e.lineTo(-s,0),e.closePath()}},iW={draw(e,t){const n=so(t),s=-n/2;e.rect(s,s,n,n)}},Gpe=.8908130915292852,oW=Yv(Qv/10)/Yv(7*Qv/10),Wpe=Yv(Eu/10)*oW,Vpe=-QG(Eu/10)*oW,lW={draw(e,t){const n=so(t*Gpe),s=Wpe*n,r=Vpe*n;e.moveTo(0,-n),e.lineTo(s,r);for(let i=1;i<5;++i){const o=Eu*i/5,l=QG(o),c=Yv(o);e.lineTo(c*n,-l*n),e.lineTo(l*s-c*r,c*s+l*r)}e.closePath()}},E2=so(3),cW={draw(e,t){const n=-so(t/(E2*3));e.moveTo(0,n*2),e.lineTo(-E2*n,-n),e.lineTo(E2*n,-n),e.closePath()}},ii=-.5,oi=so(3)/2,$k=1/so(12),Ype=($k/2+1)*3,dW={draw(e,t){const n=so(t/Ype),s=n/2,r=n*$k,i=s,o=n*$k+n,l=-i,c=o;e.moveTo(s,r),e.lineTo(i,o),e.lineTo(l,c),e.lineTo(ii*s-oi*r,oi*s+ii*r),e.lineTo(ii*i-oi*o,oi*i+ii*o),e.lineTo(ii*l-oi*c,oi*l+ii*c),e.lineTo(ii*s+oi*r,ii*r-oi*s),e.lineTo(ii*i+oi*o,ii*o-oi*i),e.lineTo(ii*l+oi*c,ii*c-oi*l),e.closePath()}},uW=[gN,nW,rW,iW,lW,cW,dW];function U4(e,t){let n=null,s=z4(r);e=typeof e=="function"?e:ja(e||gN),t=typeof t=="function"?t:ja(t===void 0?64:+t);function r(){let i;if(n||(n=i=s()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),i)return n=null,i+""||null}return r.type=function(i){return arguments.length?(e=typeof i=="function"?i:ja(i),r):e},r.size=function(i){return arguments.length?(t=typeof i=="function"?i:ja(+i),r):t},r.context=function(i){return arguments.length?(n=i??null,r):n},r}function Kv(){}function Xv(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function mW(e){this._context=e}mW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Xv(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Xv(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Qpe(e){return new mW(e)}function fW(e){this._context=e}fW.prototype={areaStart:Kv,areaEnd:Kv,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Xv(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Kpe(e){return new fW(e)}function hW(e){this._context=e}hW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,s=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,s):this._context.moveTo(n,s);break;case 3:this._point=4;default:Xv(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Xpe(e){return new hW(e)}function F6(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function B4(e,t){this._context=e,this._k=(1-t)/6}B4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:F6(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:F6(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};(function e(t){function n(s){return new B4(s,t)}return n.tension=function(s){return e(+s)},n})(0);function Zpe(e,t,n){var s=e._x1,r=e._y1,i=e._x2,o=e._y2;if(e._l01_a>z6){var l=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,c=3*e._l01_a*(e._l01_a+e._l12_a);s=(s*l-e._x0*e._l12_2a+e._x2*e._l01_2a)/c,r=(r*l-e._y0*e._l12_2a+e._y2*e._l01_2a)/c}if(e._l23_a>z6){var u=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,d=3*e._l23_a*(e._l23_a+e._l12_a);i=(i*u+e._x1*e._l23_2a-t*e._l12_2a)/d,o=(o*u+e._y1*e._l23_2a-n*e._l12_2a)/d}e._context.bezierCurveTo(s,r,i,o,e._x2,e._y2)}function gW(e,t){this._context=e,this._alpha=t}gW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,s=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+s*s,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:Zpe(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const Jpe=(function e(t){function n(s){return t?new gW(s,t):new B4(s,0)}return n.alpha=function(s){return e(+s)},n})(.5);function pW(e){this._context=e}pW.prototype={areaStart:Kv,areaEnd:Kv,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function exe(e){return new pW(e)}function U6(e){return e<0?-1:1}function B6(e,t,n){var s=e._x1-e._x0,r=t-e._x1,i=(e._y1-e._y0)/(s||r<0&&-0),o=(n-e._y1)/(r||s<0&&-0),l=(i*r+o*s)/(s+r);return(U6(i)+U6(o))*Math.min(Math.abs(i),Math.abs(o),.5*Math.abs(l))||0}function H6(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function L2(e,t,n){var s=e._x0,r=e._y0,i=e._x1,o=e._y1,l=(i-s)/3;e._context.bezierCurveTo(s+l,r+l*t,i-l,o-l*n,i,o)}function Zv(e){this._context=e}Zv.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:L2(this,this._t0,H6(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,L2(this,H6(this,n=B6(this,e,t)),n);break;default:L2(this,this._t0,n=B6(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function xW(e){this._context=new yW(e)}(xW.prototype=Object.create(Zv.prototype)).point=function(e,t){Zv.prototype.point.call(this,t,e)};function yW(e){this._context=e}yW.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,s,r,i){this._context.bezierCurveTo(t,e,s,n,i,r)}};function Rk(e){return new Zv(e)}function bW(e){return new xW(e)}function vW(e){this._context=e}vW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var s=q6(e),r=q6(t),i=0,o=1;o<n;++i,++o)this._context.bezierCurveTo(s[0][i],r[0][i],s[1][i],r[1][i],e[o],t[o]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function q6(e){var t,n=e.length-1,s,r=new Array(n),i=new Array(n),o=new Array(n);for(r[0]=0,i[0]=2,o[0]=e[0]+2*e[1],t=1;t<n-1;++t)r[t]=1,i[t]=4,o[t]=4*e[t]+2*e[t+1];for(r[n-1]=2,i[n-1]=7,o[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)s=r[t]/i[t-1],i[t]-=s,o[t]-=s*o[t-1];for(r[n-1]=o[n-1]/i[n-1],t=n-2;t>=0;--t)r[t]=(o[t]-r[t+1])/i[t];for(i[n-1]=(e[n]+r[n-1])/2,t=0;t<n-1;++t)i[t]=2*e[t+1]-r[t+1];return[r,i]}function wW(e){return new vW(e)}function pN(e,t){this._context=e,this._t=t}pN.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function jW(e){return new pN(e,.5)}function NW(e){return new pN(e,0)}function CW(e){return new pN(e,1)}function hd(e,t){if((o=e.length)>1)for(var n=1,s,r,i=e[t[0]],o,l=i.length;n<o;++n)for(r=i,i=e[t[n]],s=0;s<l;++s)i[s][1]+=i[s][0]=isNaN(r[s][1])?r[s][0]:r[s][1]}function Bu(e){for(var t=e.length,n=new Array(t);--t>=0;)n[t]=t;return n}function txe(e,t){return e[t]}function axe(e){const t=[];return t.key=e,t}function H4(){var e=ja([]),t=Bu,n=hd,s=txe;function r(i){var o=Array.from(e.apply(this,arguments),axe),l,c=o.length,u=-1,d;for(const h of i)for(l=0,++u;l<c;++l)(o[l][u]=[0,+s(h,o[l].key,u,i)]).data=h;for(l=0,d=hN(t(o));l<c;++l)o[d[l]].index=l;return n(o,d),o}return r.keys=function(i){return arguments.length?(e=typeof i=="function"?i:ja(Array.from(i)),r):e},r.value=function(i){return arguments.length?(s=typeof i=="function"?i:ja(+i),r):s},r.order=function(i){return arguments.length?(t=i==null?Bu:typeof i=="function"?i:ja(Array.from(i)),r):t},r.offset=function(i){return arguments.length?(n=i??hd,r):n},r}function SW(e,t){if((s=e.length)>0){for(var n,s,r=0,i=e[0].length,o;r<i;++r){for(o=n=0;n<s;++n)o+=e[n][r][1]||0;if(o)for(n=0;n<s;++n)e[n][r][1]/=o}hd(e,t)}}function nxe(e,t){if((c=e.length)>0)for(var n,s=0,r,i,o,l,c,u=e[t[0]].length;s<u;++s)for(o=l=0,n=0;n<c;++n)(i=(r=e[t[n]][s])[1]-r[0])>0?(r[0]=o,r[1]=o+=i):i<0?(r[1]=l,r[0]=l+=i):(r[0]=0,r[1]=i)}function _W(e,t){if((r=e.length)>0){for(var n=0,s=e[t[0]],r,i=s.length;n<i;++n){for(var o=0,l=0;o<r;++o)l+=e[o][n][1]||0;s[n][1]+=s[n][0]=-l/2}hd(e,t)}}function AW(e,t){if(!(!((o=e.length)>0)||!((i=(r=e[t[0]]).length)>0))){for(var n=0,s=1,r,i,o;s<i;++s){for(var l=0,c=0,u=0;l<o;++l){for(var d=e[t[l]],h=d[s][1]||0,p=d[s-1][1]||0,x=(h-p)/2,b=0;b<l;++b){var j=e[t[b]],y=j[s][1]||0,N=j[s-1][1]||0;x+=y-N}c+=h,u+=x*h}r[s-1][1]+=r[s-1][0]=n,c&&(n-=u/c)}r[s-1][1]+=r[s-1][0]=n,hd(e,t)}}function TW(e){var t=e.map(sxe);return Bu(e).sort(function(n,s){return t[n]-t[s]})}function sxe(e){for(var t=-1,n=0,s=e.length,r,i=-1/0;++t<s;)(r=+e[t][1])>i&&(i=r,n=t);return n}function kW(e){var t=e.map(EW);return Bu(e).sort(function(n,s){return t[n]-t[s]})}function EW(e){for(var t=0,n=-1,s=e.length,r;++n<s;)(r=+e[n][1])&&(t+=r);return t}function rxe(e){return kW(e).reverse()}function ixe(e){var t=e.length,n,s,r=e.map(EW),i=TW(e),o=0,l=0,c=[],u=[];for(n=0;n<t;++n)s=i[n],o<l?(o+=r[s],c.push(s)):(l+=r[s],u.push(s));return u.reverse().concat(c)}function oxe(e){return Bu(e).reverse()}const D2={appearance:TW,ascending:kW,descending:rxe,insideOut:ixe,none:Bu,reverse:oxe},P2={expand:SW,diverging:nxe,none:hd,silhouette:_W,wiggle:AW},LW=e=>{const{series:t,seriesOrder:n,defaultStrategy:s}=e,r=[],i={};return n.forEach(o=>{const{stack:l,stackOrder:c,stackOffset:u}=t[o];l===void 0?r.push({ids:[o],stackingOrder:D2.none,stackingOffset:P2.none}):i[l]===void 0?(i[l]=r.length,r.push({ids:[o],stackingOrder:D2[c??s?.stackOrder??"none"],stackingOffset:P2[u??s?.stackOffset??"diverging"]})):(r[i[l]].ids.push(o),c!==void 0&&(r[i[l]].stackingOrder=D2[c]),u!==void 0&&(r[i[l]].stackingOffset=P2[u]))}),r},lxe=e=>e==null?"":e.toLocaleString(),cxe=(e,t)=>{const{seriesOrder:n,series:s}=e,r=LW(e),i=t??[];n.forEach(l=>{const c=s[l].data;if(c!==void 0)c.forEach((u,d)=>{i.length<=d?i.push({[l]:u}):i[d][l]=u});else if(t===void 0)throw new Error([`MUI X Charts: bar series with id='${l}' has no data.`,"Either provide a data property to the series or use the dataset prop."].join(`
`))});const o={};return r.forEach(l=>{const{ids:c,stackingOffset:u,stackingOrder:d}=l,h=H4().keys(c.map(p=>{const x=s[p].dataKey;return s[p].data===void 0&&x!==void 0?x:p})).value((p,x)=>p[x]??0).order(d).offset(u)(i);c.forEach((p,x)=>{const b=s[p].dataKey;o[p]=Ze({layout:"vertical",labelMarkType:"square",minBarSize:0,valueFormatter:s[p].valueFormatter??lxe},s[p],{data:b?t.map(j=>{const y=j[b];return typeof y=="number"?y:null}):s[p].data,stackedData:h[x].map(([j,y])=>[j,y])})})}),{seriesOrder:n,stackingGroups:r,series:o}};function Xi(e,t){return typeof e=="function"?e(t):e}const dxe=e=>{const{seriesOrder:t,series:n}=e;return t.reduce((s,r)=>{const i=Xi(n[r].label,"legend");return i===void 0||s.push({markType:n[r].labelMarkType,id:r,seriesId:r,color:n[r].color,label:i}),s},[])};function q4(e){return e.colorGetter?e.colorGetter:()=>e.color}const uxe=(e,t,n)=>{const s=e.layout==="vertical",r=s?t?.colorScale:n?.colorScale,i=s?n?.colorScale:t?.colorScale,o=s?t?.data:n?.data,l=q4(e);return i?c=>{if(c===void 0)return e.color;const u=e.data[c],d=u===null?l({value:u,dataIndex:c}):i(u);return d===null?l({value:u,dataIndex:c}):d}:r&&o?c=>{if(c===void 0)return e.color;const u=o[c],d=u===null?l({value:u,dataIndex:c}):r(u);return d===null?l({value:u,dataIndex:c}):d}:c=>{if(c===void 0)return e.color;const u=e.data[c];return l({value:u,dataIndex:c})}},mxe=e=>{const{series:t,getColor:n,identifier:s}=e;if(!s||s.dataIndex===void 0)return null;const r=Xi(t.label,"tooltip"),i=t.data[s.dataIndex];if(i==null)return null;const o=t.valueFormatter(i,{dataIndex:s.dataIndex});return{identifier:s,color:n(s.dataIndex),label:r,value:i,formattedValue:o,markType:t.labelMarkType}},fxe=e=>Object.values(e).map(t=>t.layout==="horizontal"?{direction:"y",axisId:t.yAxisId}:{direction:"x",axisId:t.xAxisId});function Ka(){const e=Yr();if(!e)throw new Error(["MUI X Charts: Could not find the charts context.","It looks like you rendered your component outside of a ChartContainer parent component."].join(`
`));return e.store}function Ei(){const e=Ka();return Vt(e,wr)}function xN(){const e=Ka();return Vt(e,Ime)}function G4(e){return dG.getTypes().has(e)}const hxe=(e,t,n,s,r,i,o)=>{const l=s==="rotation"?r[t].rotationExtremumGetter:r[t].radiusExtremumGetter,c=o[t]?.series??{},[u,d]=l?.({series:c,axis:n,axisIndex:i,isDefaultAxis:i===0})??[1/0,-1/0],[h,p]=e;return[Math.min(u,h),Math.max(d,p)]},gxe=(e,t,n,s,r)=>{const o=Object.keys(n).filter(G4).reduce((l,c)=>hxe(l,c,e,t,n,s,r),[1/0,-1/0]);return Number.isNaN(o[0])||Number.isNaN(o[1])?[1/0,-1/0]:o},Jc=(e,t)=>e===void 0?t:Math.PI*e/180,pxe=(e,t,n,s)=>{const r=new Set;return Object.keys(t).filter(G4).forEach(o=>{const l=n[o]?.series??{},c=t[o].axisTooltipGetter?.(l);c!==void 0&&c.forEach(({axisId:u,direction:d})=>{d===e&&r.add(u??s)})}),r};function xxe(e,t,n){if(t==="rotation"){if(n.scaleType==="point"){const s=[Jc(n.startAngle,0),Jc(n.endAngle,2*Math.PI)],r=s[1]-s[0];return r>Math.PI*2-.1&&(s[1]-=r/n.data.length),s}return[Jc(n.startAngle,0),Jc(n.endAngle,2*Math.PI)]}return[0,Math.min(e.height,e.width)/2]}const yxe=.2,bxe=.1;function DW({drawingArea:e,formattedSeries:t,axis:n,seriesConfig:s,axisDirection:r}){if(n===void 0)return{axis:{},axisIds:[]};const i=pxe(r,s,t,n[0].id),o={};return n.forEach((l,c)=>{const u=l,d=xxe(e,r,u),[h,p]=gxe(u,r,s,c,t),x=!u.ignoreTooltip&&i.has(u.id),b=u.data??[];if(sm(u)){const M=u.categoryGapRatio??yxe,F=u.barGapRatio??bxe;if(o[u.id]=Ze({offset:0,categoryGapRatio:M,barGapRatio:F,triggerTooltip:x},u,{data:b,scale:nN(u.data,d).paddingInner(M).paddingOuter(M/2),tickNumber:u.data.length,colorScale:u.colorMap&&(u.colorMap.type==="ordinal"?$f(Ze({values:u.data},u.colorMap)):Cf(u.colorMap))}),Lk(u.data)){const D=Dk(u.data,d,u.tickNumber);o[u.id].valueFormatter=u.valueFormatter??D}}if(rm(u)&&(o[u.id]=Ze({offset:0,triggerTooltip:x},u,{data:b,scale:lG(u.data,d),tickNumber:u.data.length,colorScale:u.colorMap&&(u.colorMap.type==="ordinal"?$f(Ze({values:u.data},u.colorMap)):Cf(u.colorMap))}),Lk(u.data))){const M=Dk(u.data,d,u.tickNumber);o[u.id].valueFormatter=u.valueFormatter??M}if(!lfe(u))return;const j=u.scaleType??"linear",y=u.domainLimit??"nice",N=[u.min??h,u.max??p];if(typeof y=="function"){const{min:M,max:F}=y(h,p);N[0]=M,N[1]=F}const w=iG(u,N,P4(Math.abs(d[1]-d[0]))),S=oG(w,d),_=sN(j,N,d),T=y==="nice"?_.nice(w):_,[k,A]=T.domain(),E=[u.min??k,u.max??A];o[u.id]=Ze({offset:0,triggerTooltip:x},u,{data:b,scaleType:j,scale:T.domain(E),tickNumber:S,colorScale:u.colorMap&&Cf(u.colorMap)})}),{axis:o,axisIds:n.map(({id:l})=>l)}}const PW=e=>e.polarAxis,OW=Lt(PW,e=>e?.rotation),vxe=Lt(PW,e=>e?.radius),cm=Lt(OW,wr,yn,Vr,(e,t,n,s)=>DW({drawingArea:t,formattedSeries:n,axis:e,seriesConfig:s,axisDirection:"rotation"}));Lt(vxe,wr,yn,Vr,(e,t,n,s)=>DW({drawingArea:t,formattedSeries:n,axis:e,seriesConfig:s,axisDirection:"radius"}));const wxe=Lt(wr,e=>({cx:e.left+e.width/2,cy:e.top+e.height/2})),jxe=e=>(t,n)=>Math.atan2(t-e.cx,e.cy-n);function yN(e){return(e%360+360)%360}const O2=2*Math.PI;function Nxe(e){return(e%O2+O2)%O2}function G6(e,t){const{scale:n,data:s,reverse:r}=e;if(!js(n))throw new Error("MUI X Charts: getAxisValue is not implemented for polare continuous axes.");if(!s)return-1;const i=Nxe(t-Math.min(...n.range())),o=n.bandwidth()===0?Math.floor((i+n.step()/2)/n.step())%s.length:Math.floor(i/n.step());return o<0||o>=s.length?-1:r?s.length-1-o:o}function jr(){const e=Ka(),{axis:t,axisIds:n}=Vt(e,Xs);return{xAxis:t,xAxisIds:n}}function Nr(){const e=Ka(),{axis:t,axisIds:n}=Vt(e,Zs);return{yAxis:t,yAxisIds:n}}function Cxe(e){const t=Ka(),{axis:n,axisIds:s}=Vt(t,Xs),r=s[0];return n[r]}function Sxe(e){const t=Ka(),{axis:n,axisIds:s}=Vt(t,Zs),r=s[0];return n[r]}function MW(){const e=Ka(),{axis:t,axisIds:n}=Vt(e,cm);return{rotationAxis:t,rotationAxisIds:n}}function _xe(e){const t=Ka(),{axis:n,axisIds:s}=Vt(t,cm),r=s[0];return n[r]}function uh(e){if(js(e))return n=>(e(n)??0)+e.bandwidth()/2;const t=e.domain();return t[0]===t[1]?n=>n===t[0]?e(n):NaN:n=>e(n)}function W4(){const e=Ka(),{axis:t,axisIds:n}=Vt(e,Mpe)??{axis:{},axisIds:[]};return{zAxis:t,zAxisIds:n}}function V4(){const e=Yr();if(!e)throw new Error(["MUI X Charts: Could not find the svg ref context.","It looks like you rendered your component outside of a ChartContainer parent component."].join(`
`));return e.svgRef}function bN(){const e=Ka();return Vt(e,yn)}const Axe=Lt(yn,(e,t)=>e[t]);$n(yn,(e,t,n)=>{if(!n||Array.isArray(n)&&n.length===0)return e[t]?.seriesOrder?.map(r=>e[t]?.series[r])??[];if(!Array.isArray(n))return e[t]?.series?.[n];const s=[];for(const r of n){const i=e[t]?.series?.[r];i&&s.push(i)}return s});const Txe=e=>{const t=Ka();return Vt(t,Axe,e)};function $x(){return Txe("line")}function kxe(){return!1}function IW(e,t){return!e||!t?kxe:function(s){return s?e.highlight==="series"?s.seriesId===t.seriesId:e.highlight==="item"?s.dataIndex===t.dataIndex&&s.seriesId===t.seriesId:!1:!1}}function Exe(){return!1}function $W(e,t){return!e||!t?Exe:function(s){return s?e.fade==="series"?s.seriesId===t.seriesId&&s.dataIndex!==t.dataIndex:e.fade==="global"?s.seriesId!==t.seriesId||s.dataIndex!==t.dataIndex:!1:!1}}function Y4(e,t,n){return e?.highlight==="series"&&t?.seriesId===n}function Lxe(e,t,n){return Y4(e,t,n)?!1:e?.fade==="global"&&t!=null||e?.fade==="series"&&t?.seriesId===n}function RW(e,t,n){return e?.highlight==="item"&&t?.seriesId===n?t.dataIndex:null}function Dxe(e,t,n){return Y4(e,t,n)||RW(e,t,n)===t?.dataIndex?null:(e?.fade==="series"||e?.fade==="global")&&t?.seriesId===n?t.dataIndex:null}const Pxe=e=>e.highlight,Oxe=Lt(yn,e=>{const t=new Map;return Object.keys(e).forEach(n=>{const s=e[n];s?.seriesOrder?.forEach(r=>{const i=s?.series[r];t.set(r,i?.highlightScope)})}),t}),ic=$n(Pxe,PG,function(t,n){return t.isControlled||t.lastUpdate==="pointer"?t.item:n}),Td=Lt(Oxe,ic,function(t,n){if(!n)return null;const s=t.get(n.seriesId);return s===void 0?null:s}),Mxe=Lt(Td,ic,IW),Ixe=Lt(Td,ic,$W),$xe=Lt(Td,ic,function(t,n,s){return IW(t,n)(s)});Lt(Td,ic,Y4);Lt(Td,ic,Lxe);Lt(Td,ic,Dxe);Lt(Td,ic,RW);const Rxe=Lt(Td,ic,function(t,n,s){return $W(t,n)(s)});function zW(e){const t=Ka(),n=Vt(t,$xe,e),s=Vt(t,Rxe,e);return{isHighlighted:n,isFaded:!n&&s}}function zxe(){const e=Ka(),t=Vt(e,Mxe),n=Vt(e,Ixe);return{isHighlighted:t,isFaded:n}}function Fxe(e,t){return Object.keys(e).flatMap(n=>{const s=t[n].legendGetter;return s===void 0?[]:s(e[n])})}function Uxe(){const e=bN(),t=Ka(),n=Vt(t,Vr);return{items:Fxe(e,n)}}function Q4(){const e=xN();return f.useCallback(t=>`${e}-gradient-${t}`,[e])}function Bxe(){const e=xN();return f.useCallback(t=>`${e}-gradient-${t}-object-bound`,[e])}var M2,W6;function Hxe(){if(W6)return M2;W6=1;var e=4,t=.001,n=1e-7,s=10,r=11,i=1/(r-1),o=typeof Float32Array=="function";function l(j,y){return 1-3*y+3*j}function c(j,y){return 3*y-6*j}function u(j){return 3*j}function d(j,y,N){return((l(y,N)*j+c(y,N))*j+u(y))*j}function h(j,y,N){return 3*l(y,N)*j*j+2*c(y,N)*j+u(y)}function p(j,y,N,w,S){var _,T,k=0;do T=y+(N-y)/2,_=d(T,w,S)-j,_>0?N=T:y=T;while(Math.abs(_)>n&&++k<s);return T}function x(j,y,N,w){for(var S=0;S<e;++S){var _=h(y,N,w);if(_===0)return y;var T=d(y,N,w)-j;y-=T/_}return y}function b(j){return j}return M2=function(y,N,w,S){if(!(0<=y&&y<=1&&0<=w&&w<=1))throw new Error("bezier x values must be in [0, 1] range");if(y===N&&w===S)return b;for(var _=o?new Float32Array(r):new Array(r),T=0;T<r;++T)_[T]=d(T*i,y,w);function k(A){for(var E=0,M=1,F=r-1;M!==F&&_[M]<=A;++M)E+=i;--M;var D=(A-_[M])/(_[M+1]-_[M]),P=E+D*i,B=h(P,y,w);return B>=t?x(A,P,y,w):B===0?P:p(A,E,E+i,y,w)}return function(E){return E===0?0:E===1?1:d(k(E),N,S)}},M2}var qxe=Hxe();const Gxe=ao(qxe),vN=300,K4="cubic-bezier(0.66, 0, 0.34, 1)",Wxe=Gxe(.66,0,.34,1);var zf=0,Qg=0,Sg=0,FW=1e3,Jv,Kg,ew=0,Hu=0,wN=0,Op=typeof performance=="object"&&performance.now?performance:Date,UW=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function X4(){return Hu||(UW(Vxe),Hu=Op.now()+wN)}function Vxe(){Hu=0}function tw(){this._call=this._time=this._next=null}tw.prototype=BW.prototype={constructor:tw,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?X4():+n)+(t==null?0:+t),!this._next&&Kg!==this&&(Kg?Kg._next=this:Jv=this,Kg=this),this._call=e,this._time=n,zk()},stop:function(){this._call&&(this._call=null,this._time=1/0,zk())}};function BW(e,t,n){var s=new tw;return s.restart(e,t,n),s}function Yxe(){X4(),++zf;for(var e=Jv,t;e;)(t=Hu-e._time)>=0&&e._call.call(void 0,t),e=e._next;--zf}function V6(){Hu=(ew=Op.now())+wN,zf=Qg=0;try{Yxe()}finally{zf=0,Kxe(),Hu=0}}function Qxe(){var e=Op.now(),t=e-ew;t>FW&&(wN-=t,ew=e)}function Kxe(){for(var e,t=Jv,n,s=1/0;t;)t._call?(s>t._time&&(s=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Jv=n);Kg=e,zk(s)}function zk(e){if(!zf){Qg&&(Qg=clearTimeout(Qg));var t=e-Hu;t>24?(e<1/0&&(Qg=setTimeout(V6,e-Op.now()-wN)),Sg&&(Sg=clearInterval(Sg))):(Sg||(ew=Op.now(),Sg=setInterval(Qxe,FW)),zf=1,UW(V6))}}function Xxe(e,t,n){var s=new tw;return t=t==null?0:+t,s.restart(r=>{s.stop(),e(r+t)},t,n),s}class Zxe{elapsed=0;timer=null;constructor(t,n,s){this.duration=t,this.easingFn=n,this.onTickCallback=s,this.resume()}get running(){return this.timer!==null}timerCallback(t){this.elapsed=Math.min(t,this.duration);const n=this.duration===0?1:this.elapsed/this.duration,s=this.easingFn(n);this.onTickCallback(s),this.elapsed>=this.duration&&this.stop()}resume(){if(this.running||this.elapsed>=this.duration)return this;const t=X4()-this.elapsed;return this.timer=BW(n=>this.timerCallback(n),0,t),this}stop(){return this.running?(this.timer&&(this.timer.stop(),this.timer=null),this):this}finish(){return this.stop(),Xxe(()=>this.timerCallback(this.duration)),this}}function Jxe(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;const n=Object.keys(e),s=Object.keys(t);if(n.length!==s.length)return!1;for(let r=0;r<n.length;r+=1){const i=n[r];if(!Object.prototype.hasOwnProperty.call(t,i)||!Object.is(e[i],t[i]))return!1}return!0}function e0e(e,{createInterpolator:t,applyProps:n,skip:s,initialProps:r=e}){const i=f.useRef(r),o=f.useRef(null),l=f.useRef(null),c=f.useRef(e);ls(()=>{c.current=e},[e]),ls(()=>{s&&(o.current?.finish(),o.current=null,l.current=null,i.current=e)},[e,s]);const u=f.useCallback(h=>{const p=i.current,x=t(p,e);o.current=new Zxe(vN,Wxe,b=>{const j=x(b);i.current=j,n(h,j)})},[n,t,e]);return[f.useCallback(h=>{if(h===null){o.current?.stop();return}const p=l.current;if(p===h){if(Jxe(c.current,e)){o.current?.resume();return}o.current?.stop()}p&&o.current?.stop(),l.current=h,(o.current||!s)&&u(h)},[u,e,s]),i.current]}function HW(e,{createInterpolator:t,transformProps:n,applyProps:s,skip:r,initialProps:i=e,ref:o}){const l=n??(h=>h),[c,u]=e0e(e,{initialProps:i,createInterpolator:t,applyProps:(h,p)=>s(h,l(p)),skip:r}),d=n(r?e:u);return Ze({},d,{ref:Uo(c,o)})}function t0e(e){return HW({d:e.d},{createInterpolator:(t,n)=>{const s=u4(t.d,n.d);return r=>({d:s(r)})},applyProps:(t,{d:n})=>t.setAttribute("d",n),transformProps:t=>t,skip:e.skipAnimation,ref:e.ref})}function a0e(e){return HW({d:e.d},{createInterpolator:(t,n)=>{const s=u4(t.d,n.d);return r=>({d:s(r)})},applyProps:(t,{d:n})=>t.setAttribute("d",n),skip:e.skipAnimation,transformProps:t=>t,ref:e.ref})}function n0e(){return Yr().chartRootRef}const s0e={"image/png":"PNG","image/jpeg":"JPEG","image/webp":"WebP"},r0e=e=>({components:{MuiChartsLocalizationProvider:{defaultProps:{localeText:Ze({},e)}}}}),qW={loading:"Loading data",noData:"No data to display",zoomIn:"Zoom in",zoomOut:"Zoom out",toolbarExport:"Export",toolbarExportPrint:"Print",toolbarExportImage:e=>`Export as ${s0e[e]??e}`,chartTypeBar:"Bar",chartTypeColumn:"Column",chartTypeLine:"Line",chartTypeArea:"Area",chartTypePie:"Pie",chartPaletteLabel:"Color palette",chartPaletteNameRainbowSurge:"Rainbow Surge",chartPaletteNameBlueberryTwilight:"Blueberry Twilight",chartPaletteNameMangoFusion:"Mango Fusion",chartPaletteNameCheerfulFiesta:"Cheerful Fiesta",chartPaletteNameStrawberrySky:"Strawberry Sky",chartPaletteNameBlue:"Blue",chartPaletteNameGreen:"Green",chartPaletteNamePurple:"Purple",chartPaletteNameRed:"Red",chartPaletteNameOrange:"Orange",chartPaletteNameYellow:"Yellow",chartPaletteNameCyan:"Cyan",chartPaletteNamePink:"Pink",chartConfigurationSectionChart:"Chart",chartConfigurationSectionColumns:"Columns",chartConfigurationSectionBars:"Bars",chartConfigurationSectionAxes:"Axes",chartConfigurationGrid:"Grid",chartConfigurationBorderRadius:"Border radius",chartConfigurationCategoryGapRatio:"Category gap ratio",chartConfigurationBarGapRatio:"Series gap ratio",chartConfigurationStacked:"Stacked",chartConfigurationShowToolbar:"Show toolbar",chartConfigurationSkipAnimation:"Skip animation",chartConfigurationInnerRadius:"Inner radius",chartConfigurationOuterRadius:"Outer radius",chartConfigurationColors:"Colors",chartConfigurationHideLegend:"Hide legend",chartConfigurationShowMark:"Show mark",chartConfigurationHeight:"Height",chartConfigurationWidth:"Width",chartConfigurationSeriesGap:"Series gap",chartConfigurationTickPlacement:"Tick placement",chartConfigurationTickLabelPlacement:"Tick label placement",chartConfigurationCategoriesAxisLabel:"Categories axis label",chartConfigurationSeriesAxisLabel:"Series axis label",chartConfigurationXAxisPosition:"X-axis position",chartConfigurationYAxisPosition:"Y-axis position",chartConfigurationSeriesAxisReverse:"Reverse series axis",chartConfigurationTooltipPlacement:"Placement",chartConfigurationTooltipTrigger:"Trigger",chartConfigurationLegendPosition:"Position",chartConfigurationLegendDirection:"Direction",chartConfigurationBarLabels:"Bar labels",chartConfigurationColumnLabels:"Column labels",chartConfigurationInterpolation:"Interpolation",chartConfigurationSectionTooltip:"Tooltip",chartConfigurationSectionLegend:"Legend",chartConfigurationSectionLines:"Lines",chartConfigurationSectionAreas:"Areas",chartConfigurationSectionArcs:"Arcs",chartConfigurationPaddingAngle:"Padding angle",chartConfigurationCornerRadius:"Corner radius",chartConfigurationArcLabels:"Arc labels",chartConfigurationStartAngle:"Start angle",chartConfigurationEndAngle:"End angle",chartConfigurationPieTooltipTrigger:"Trigger",chartConfigurationPieLegendPosition:"Position",chartConfigurationPieLegendDirection:"Direction",chartConfigurationOptionNone:"None",chartConfigurationOptionValue:"Value",chartConfigurationOptionAuto:"Auto",chartConfigurationOptionTop:"Top",chartConfigurationOptionTopLeft:"Top Left",chartConfigurationOptionTopRight:"Top Right",chartConfigurationOptionBottom:"Bottom",chartConfigurationOptionBottomLeft:"Bottom Left",chartConfigurationOptionBottomRight:"Bottom Right",chartConfigurationOptionLeft:"Left",chartConfigurationOptionRight:"Right",chartConfigurationOptionAxis:"Axis",chartConfigurationOptionItem:"Item",chartConfigurationOptionHorizontal:"Horizontal",chartConfigurationOptionVertical:"Vertical",chartConfigurationOptionBoth:"Both",chartConfigurationOptionStart:"Start",chartConfigurationOptionMiddle:"Middle",chartConfigurationOptionEnd:"End",chartConfigurationOptionExtremities:"Extremities",chartConfigurationOptionTick:"Tick",chartConfigurationOptionMonotoneX:"Monotone X",chartConfigurationOptionMonotoneY:"Monotone Y",chartConfigurationOptionCatmullRom:"Catmull-Rom",chartConfigurationOptionLinear:"Linear",chartConfigurationOptionNatural:"Natural",chartConfigurationOptionStep:"Step",chartConfigurationOptionStepBefore:"Step Before",chartConfigurationOptionStepAfter:"Step After",chartConfigurationOptionBumpX:"Bump X",chartConfigurationOptionBumpY:"Bump Y"},i0e=qW;r0e(qW);const o0e=["localeText"],Fk=f.createContext(null);function l0e(e){const{localeText:t}=e,n=ya(e,o0e),{localeText:s}=f.useContext(Fk)??{localeText:void 0},r=Ti({props:n,name:"MuiChartsLocalizationProvider"}),{children:i,localeText:o}=r,l=f.useMemo(()=>Ze({},i0e,o,s,t),[o,s,t]),c=f.useMemo(()=>({localeText:l}),[l]);return a.jsx(Fk.Provider,{value:c,children:i})}const GW=()=>{const e=f.useContext(Fk);if(e===null)throw new Error(["MUI X Charts: Can not find the charts localization context.","It looks like you forgot to wrap your component in ChartsLocalizationProvider.","This can also happen if you are bundling multiple versions of the `@mui/x-charts` package"].join(`
`));return e};function c0e({bandWidth:e,numberOfGroups:t,gapRatio:n}){if(n===0)return{barWidth:e/t,offset:0};const s=e/(t+(t-1)*n),r=n*s;return{barWidth:s,offset:r}}function d0e(e,t,n){const s=e&&t>0,r=!e&&t<0,i=s||r;return n?!i:i}function u0e(e){const{verticalLayout:t,xAxisConfig:n,yAxisConfig:s,series:r,dataIndex:i,numberOfGroups:o,groupIndex:l}=e,c=t?n:s,u=(t?s.reverse:n.reverse)??!1,{barWidth:d,offset:h}=c0e({bandWidth:c.scale.bandwidth(),numberOfGroups:o,gapRatio:c.barGapRatio}),p=l*(d+h),x=n.scale,b=s.scale,j=c.data[i],y=r.data[i];if(y==null)return null;const w=r.stackedData[i].map(A=>t?b(A):x(A)),S=Math.round(Math.min(...w)),_=Math.round(Math.max(...w)),T=y===0?0:Math.max(r.minBarSize,_-S),k=d0e(t,y,u)?_-T:S;return{x:t?x(j)+p:k,y:t?k:b(j)+p,height:t?T:d,width:t?d:T}}const m0e=e=>{const{series:t,identifier:n,axesConfig:s,placement:r}=e;if(!n||n.dataIndex===void 0)return null;const i=t.bar?.series[n.seriesId];if(t.bar==null||i==null||s.x===void 0||s.y===void 0)return null;const o=u0e({verticalLayout:i.layout==="vertical",xAxisConfig:s.x,yAxisConfig:s.y,series:i,dataIndex:n.dataIndex,numberOfGroups:t.bar.stackingGroups.length,groupIndex:t.bar.stackingGroups.findIndex(h=>h.ids.includes(i.id))});if(o==null)return null;const{x:l,y:c,width:u,height:d}=o;switch(r){case"right":return{x:l+u,y:c+d/2};case"bottom":return{x:l+u/2,y:c+d};case"left":return{x:l,y:c+d/2};default:return{x:l+u/2,y:c}}},f0e=(e,t,n)=>Ze({},e,{id:e.id??`auto-generated-id-${t}`,color:e.color??n[t%n.length]}),h0e={seriesProcessor:cxe,colorProcessor:uxe,legendGetter:dxe,tooltipGetter:mxe,tooltipItemPositionGetter:m0e,axisTooltipGetter:fxe,xExtremumGetter:Ipe,yExtremumGetter:$pe,getSeriesWithDefaultValues:f0e},g0e=e=>{const{series:t,axis:n,isDefaultAxis:s,getFilters:r}=e;let i=1/0,o=-1/0;for(const l in t){if(!Object.hasOwn(t,l))continue;const c=t[l].xAxisId;if(!(c===n.id||c===void 0&&s))continue;const u=r?.({currentAxisId:n.id,isDefaultAxis:s,seriesXAxisId:t[l].xAxisId,seriesYAxisId:t[l].yAxisId}),d=t[l].data??[];for(let h=0;h<d.length;h+=1){const p=d[h];u&&!u(p,h)||p.x!==null&&(p.x<i&&(i=p.x),p.x>o&&(o=p.x))}}return[i,o]},p0e=e=>{const{series:t,axis:n,isDefaultAxis:s,getFilters:r}=e;let i=1/0,o=-1/0;for(const l in t){if(!Object.hasOwn(t,l))continue;const c=t[l].yAxisId;if(!(c===n.id||c===void 0&&s))continue;const u=r?.({currentAxisId:n.id,isDefaultAxis:s,seriesXAxisId:t[l].xAxisId,seriesYAxisId:t[l].yAxisId}),d=t[l].data??[];for(let h=0;h<d.length;h+=1){const p=d[h];u&&!u(p,h)||p.y!==null&&(p.y<i&&(i=p.y),p.y>o&&(o=p.y))}}return[i,o]},x0e=({series:e,seriesOrder:t},n)=>({series:Object.fromEntries(Object.entries(e).map(([r,i])=>{const o=i?.datasetKeys,l=["x","y"].filter(u=>typeof o?.[u]!="string");if(i?.datasetKeys&&l.length>0)throw new Error([`MUI X Charts: scatter series with id='${r}' has incomplete datasetKeys.`,`Properties ${l.map(u=>`"${u}"`).join(", ")} are missing.`].join(`
`));const c=o?n?.map(u=>({x:u[o.x]??null,y:u[o.y]??null,z:o.z&&u[o.z],id:o.id&&u[o.id]}))??[]:i.data??[];return[r,Ze({labelMarkType:"circle",markerSize:4},i,{preview:Ze({markerSize:1},i?.preview),data:c,valueFormatter:i.valueFormatter??(u=>u&&`(${u.x}, ${u.y})`)})]})),seriesOrder:t}),y0e=(e,t,n,s)=>{const r=s?.colorScale,i=n?.colorScale,o=t?.colorScale,l=q4(e);return r?c=>{if(c===void 0)return e.color;if(s?.data?.[c]!==void 0){const h=r(s?.data?.[c]);if(h!==null)return h}const u=e.data[c],d=u===null?l({value:u,dataIndex:c}):r(u.z);return d===null?l({value:u,dataIndex:c}):d}:i?c=>{if(c===void 0)return e.color;const u=e.data[c],d=u===null?l({value:u,dataIndex:c}):i(u.y);return d===null?l({value:u,dataIndex:c}):d}:o?c=>{if(c===void 0)return e.color;const u=e.data[c],d=u===null?l({value:u,dataIndex:c}):o(u.x);return d===null?l({value:u,dataIndex:c}):d}:c=>{if(c===void 0)return e.color;const u=e.data[c];return l({value:u,dataIndex:c})}},b0e=e=>{const{seriesOrder:t,series:n}=e;return t.reduce((s,r)=>{const i=Xi(n[r].label,"legend");return i===void 0||s.push({markType:n[r].labelMarkType,id:r,seriesId:r,color:n[r].color,label:i}),s},[])},v0e=e=>{const{series:t,getColor:n,identifier:s}=e;if(!s||s.dataIndex===void 0)return null;const r=Xi(t.label,"tooltip"),i=t.data[s.dataIndex],o=t.valueFormatter(i,{dataIndex:s.dataIndex});return{identifier:s,color:n(s.dataIndex),label:r,value:i,formattedValue:o,markType:t.labelMarkType}},w0e=(e,t,n)=>Ze({},e,{id:e.id??`auto-generated-id-${t}`,color:e.color??n[t%n.length]}),j0e=e=>{const{series:t,identifier:n,axesConfig:s}=e;if(!n||n.dataIndex===void 0)return null;const r=t.scatter?.series[n.seriesId];if(r==null||s.x===void 0||s.y===void 0)return null;const i=r.data?.[n.dataIndex].x,o=r.data?.[n.dataIndex].y;return i==null||o==null?null:{x:s.x.scale(i),y:s.y.scale(o)}},N0e={seriesProcessor:x0e,colorProcessor:y0e,legendGetter:b0e,tooltipGetter:v0e,tooltipItemPositionGetter:j0e,xExtremumGetter:g0e,yExtremumGetter:p0e,getSeriesWithDefaultValues:w0e},C0e=e=>{const{axis:t}=e;return Vv(t.data??[])};function S0e(e,t,n,s){return n.reduce((r,i,o)=>{if(t[o]===null)return r;const[l,c]=e(i);return s&&(!s({y:l,x:null},o)||!s({y:c,x:null},o))?r:[Math.min(l,c,r[0]),Math.max(l,c,r[1])]},[1/0,-1/0])}const _0e=e=>{const{series:t,axis:n,isDefaultAxis:s,getFilters:r}=e;return Object.keys(t).filter(i=>{const o=t[i].yAxisId;return o===n.id||s&&o===void 0}).reduce((i,o)=>{const{area:l,stackedData:c,data:u}=t[o],d=l!==void 0,h=r?.({currentAxisId:n.id,isDefaultAxis:s,seriesXAxisId:t[o].xAxisId,seriesYAxisId:t[o].yAxisId}),p=d&&n.scaleType!=="log"&&typeof t[o].baseline!="string"?y=>y:y=>[y[1],y[1]],x=S0e(p,u,c,h),[b,j]=x;return[Math.min(b,i[0]),Math.max(j,i[1])]},[1/0,-1/0])};function A0e(e,t){const n={};return Object.keys(e).forEach(s=>{n[s]=Ze({},e[s],{valueFormatter:e[s].valueFormatter??t})}),n}const T0e=(e,t)=>{const{seriesOrder:n,series:s}=e,r=LW(Ze({},e,{defaultStrategy:{stackOffset:"none"}})),i=t??[];n.forEach(l=>{const c=s[l].data;c!==void 0&&c.forEach((u,d)=>{i.length<=d?i.push({[l]:u}):i[d][l]=u})});const o={};return r.forEach(l=>{const{ids:c,stackingOrder:u,stackingOffset:d}=l,h=H4().keys(c.map(p=>{const x=s[p].dataKey;return s[p].data===void 0&&x!==void 0?x:p})).value((p,x)=>p[x]??0).order(u).offset(d)(i);c.forEach((p,x)=>{const b=s[p].dataKey;o[p]=Ze({labelMarkType:"line"},s[p],{data:b?t.map(j=>{const y=j[b];return typeof y=="number"?y:null}):s[p].data,stackedData:h[x].map(([j,y])=>[j,y])})})}),{seriesOrder:n,stackingGroups:r,series:A0e(o,l=>l==null?"":l.toLocaleString())}},Z4=(e,t,n)=>{const s=n?.colorScale,r=t?.colorScale,i=q4(e);return s?o=>{if(o===void 0)return e.color;const l=e.data[o],c=l===null?i({value:l,dataIndex:o}):s(l);return c===null?i({value:l,dataIndex:o}):c}:r?o=>{if(o===void 0)return e.color;const l=t.data?.[o],c=l===null?i({value:l,dataIndex:o}):r(l);return c===null?i({value:l,dataIndex:o}):c}:o=>{if(o===void 0)return e.color;const l=e.data[o];return i({value:l,dataIndex:o})}},k0e=e=>{const{seriesOrder:t,series:n}=e;return t.reduce((s,r)=>{const i=Xi(n[r].label,"legend");return i===void 0||s.push({markType:n[r].labelMarkType,id:r,seriesId:r,color:n[r].color,label:i}),s},[])},E0e=e=>{const{series:t,getColor:n,identifier:s}=e;if(!s||s.dataIndex===void 0)return null;const r=Xi(t.label,"tooltip"),i=t.data[s.dataIndex],o=t.valueFormatter(i,{dataIndex:s.dataIndex});return{identifier:s,color:n(s.dataIndex),label:r,value:i,formattedValue:o,markType:t.labelMarkType}},L0e=e=>Object.values(e).map(t=>({direction:"x",axisId:t.xAxisId})),D0e=(e,t,n)=>Ze({},e,{id:e.id??`auto-generated-id-${t}`,color:e.color??n[t%n.length]}),P0e=e=>{const{series:t,identifier:n,axesConfig:s}=e;if(!n||n.dataIndex===void 0)return null;const r=t.line?.series[n.seriesId];if(r==null||s.x===void 0||s.y===void 0)return null;const i=s.x.data?.[n.dataIndex],o=r.data[n.dataIndex];return i==null||o==null?null:{x:s.x.scale(i),y:s.y.scale(o)}},O0e={colorProcessor:Z4,seriesProcessor:T0e,legendGetter:k0e,tooltipGetter:E0e,tooltipItemPositionGetter:P0e,axisTooltipGetter:L0e,xExtremumGetter:C0e,yExtremumGetter:_0e,getSeriesWithDefaultValues:D0e},M0e=(e="none")=>{if(typeof e=="function")return e;switch(e){case"none":return null;case"desc":return(t,n)=>n-t;case"asc":return(t,n)=>t-n;default:return null}},I0e=e=>{const{seriesOrder:t,series:n}=e,s={};return t.forEach(r=>{const i=Hpe().startAngle(Jc(n[r].startAngle??0)).endAngle(Jc(n[r].endAngle??360)).padAngle(Jc(n[r].paddingAngle??0)).sortValues(M0e(n[r].sortingValues??"none"))(n[r].data.map(o=>o.value));s[r]=Ze({labelMarkType:"circle",valueFormatter:o=>o.value.toLocaleString()},n[r],{data:n[r].data.map((o,l)=>Ze({},o,{id:o.id??`auto-generated-pie-id-${r}-${l}`},i[l])).map((o,l)=>Ze({labelMarkType:"circle"},o,{formattedValue:n[r].valueFormatter?.(Ze({},o,{label:Xi(o.label,"arc")}),{dataIndex:l})??o.value.toLocaleString()}))})}),{seriesOrder:t,series:s}},$0e=e=>t=>e.data[t].color,R0e=e=>{const{seriesOrder:t,series:n}=e;return t.reduce((s,r)=>(n[r].data.forEach((i,o)=>{const l=Xi(i.label,"legend");l!==void 0&&s.push({markType:i.labelMarkType??n[r].labelMarkType,id:i.id??o,seriesId:r,color:i.color,label:l,itemId:i.id??o})}),s),[])},z0e=e=>{const{series:t,getColor:n,identifier:s}=e;if(!s||s.dataIndex===void 0)return null;const r=t.data[s.dataIndex];if(r==null)return null;const i=Xi(r.label,"tooltip"),o=Ze({},r,{label:i}),l=t.valueFormatter(o,{dataIndex:s.dataIndex});return{identifier:s,color:n(s.dataIndex),label:i,value:o,formattedValue:l,markType:r.labelMarkType??t.labelMarkType}},F0e=(e,t,n)=>Ze({},e,{id:e.id??`auto-generated-id-${t}`,data:e.data.map((s,r)=>Ze({},s,{color:s.color??n[r%n.length]}))});function aw(e,t){if(typeof e=="number")return e;if(e==="100%")return t;if(e.endsWith("%")){const n=Number.parseFloat(e.slice(0,e.length-1));if(!Number.isNaN(n))return n*t/100}if(e.endsWith("px")){const n=Number.parseFloat(e.slice(0,e.length-2));if(!Number.isNaN(n))return n}throw new Error(`MUI X Charts: Received an unknown value "${e}". It should be a number, or a string with a percentage value.`)}function U0e(e,t){const{height:n,width:s}=t,{cx:r,cy:i}=e,o=Math.min(s,n)/2,l=aw(r??"50%",s),c=aw(i??"50%",n);return{cx:l,cy:c,availableRadius:o}}const B0e=e=>{const{series:t,drawingArea:n,identifier:s,placement:r}=e;if(!s||s.dataIndex===void 0)return null;const i=t.pie?.series[s.seriesId];if(i==null)return null;const{cx:o,cy:l,availableRadius:c}=U0e({cx:i.cx,cy:i.cy},n),{data:u,innerRadius:d=0,outerRadius:h}=i,p=Math.max(0,aw(d??0,c)),x=Math.max(0,aw(h??c,c)),b=u[s.dataIndex];if(!b)return null;const j=[[p,b.startAngle],[p,b.endAngle],[x,b.startAngle],[x,b.endAngle]].map(([_,T])=>({x:o+_*Math.sin(T),y:l-_*Math.cos(T)})),[y,N]=Vv(j.map(_=>_.x)),[w,S]=Vv(j.map(_=>_.y));switch(r){case"bottom":return{x:(N+y)/2,y:S};case"left":return{x:y,y:(S+w)/2};case"right":return{x:N,y:(S+w)/2};default:return{x:(N+y)/2,y:w}}},H0e={colorProcessor:$0e,seriesProcessor:I0e,legendGetter:R0e,tooltipGetter:z0e,tooltipItemPositionGetter:B0e,getSeriesWithDefaultValues:F0e},q0e={bar:h0e,scatter:N0e,line:O0e,pie:H0e},G0e=[Ox,kx,ch,Mx];function W0e(e){const{children:t,plugins:n=G0e,pluginParams:s={},seriesConfig:r=q0e}=e,{contextValue:i}=afe(n,s,r);return a.jsx(wq.Provider,{value:i,children:t})}const Yr=()=>{const e=f.useContext(wq);if(e==null)throw new Error(["MUI X Charts: Could not find the Chart context.","It looks like you rendered your component outside of a ChartDataProvider.","This can also happen if you are bundling multiple versions of the library."].join(`
`));return e};function V0e(e){"hasPointerCapture"in e.currentTarget&&e.currentTarget.hasPointerCapture(e.pointerId)&&e.currentTarget.releasePointerCapture(e.pointerId)}const jN=(e,t)=>{const{instance:n}=Yr(),s=f.useRef(!1),r=ys(()=>{s.current=!0,n.setItemInteraction(e,{interaction:"pointer"}),n.setHighlight(e)}),i=ys(()=>{s.current=!1,n.removeItemInteraction(e),n.clearHighlight()});return f.useEffect(()=>()=>{s.current&&i()},[i]),f.useMemo(()=>({onPointerEnter:r,onPointerLeave:i,onPointerDown:V0e}),[t,r,i])};function WW(e){return e.replace(" ","_")}const VW=An("MuiAppearingMask",["animate"]),Y0e=fa("rect")({animationName:"animate-width",animationTimingFunction:K4,animationDuration:"0s",[`&.${VW.animate}`]:{animationDuration:`${vN}ms`},"@keyframes animate-width":{from:{width:0}}});function YW(e){const t=Ei(),n=xN(),s=WW(`${n}-${e.id}`);return a.jsxs(f.Fragment,{children:[a.jsx("clipPath",{id:s,children:a.jsx(Y0e,{className:e.skipAnimation?"":VW.animate,x:0,y:0,width:t.left+t.width+t.right,height:t.top+t.height+t.bottom})}),a.jsx("g",{clipPath:`url(#${s})`,children:e.children})]})}const Q0e=["skipAnimation","ownerState"];function K0e(e){const{skipAnimation:t,ownerState:n}=e,s=ya(e,Q0e),r=t0e(e);return a.jsx(YW,{skipAnimation:t,id:`${n.id}-area-clip`,children:a.jsx("path",Ze({fill:n.gradientId?`url(#${n.gradientId})`:n.color,filter:n.isHighlighted?"brightness(140%)":n.gradientId?void 0:"brightness(120%)",opacity:n.isFaded?.3:1,stroke:"none","data-series":n.id,"data-highlighted":n.isHighlighted||void 0,"data-faded":n.isFaded||void 0},s,r))})}const X0e=["id","classes","color","gradientId","slots","slotProps","onClick"];function Z0e(e){return Kn("MuiAreaElement",e)}const J0e=An("MuiAreaElement",["root","highlighted","faded","series"]),eye=e=>{const{classes:t,id:n,isFaded:s,isHighlighted:r}=e,i={root:["root",`series-${n}`,r&&"highlighted",s&&"faded"]};return Qn(i,Z0e,t)};function tye(e){const{id:t,classes:n,color:s,gradientId:r,slots:i,slotProps:o,onClick:l}=e,c=ya(e,X0e),u=jN({type:"line",seriesId:t}),{isFaded:d,isHighlighted:h}=zW({seriesId:t}),p={id:t,classes:n,color:s,gradientId:r,isFaded:d,isHighlighted:h},x=eye(p),b=i?.area??K0e,j=Bl({elementType:b,externalSlotProps:o?.area,additionalProps:Ze({},u,{onClick:l,cursor:l?"pointer":"unset"}),className:x.root,ownerState:p});return a.jsx(b,Ze({},c,j))}function J4(e){const t=Ka(),n=Vt(t,pme);return e||n}function eD(){const e=Ka();return Vt(e,wG)}function QW(e){switch(e){case"catmullRom":return Jpe.alpha(.5);case"linear":return Ix;case"monotoneX":return Rk;case"monotoneY":return bW;case"natural":return wW;case"step":return jW;case"stepBefore":return NW;case"stepAfter":return CW;case"bumpY":return aW;case"bumpX":return tW;default:return Rk}}function aye(e,t){const n=$x(),s=jr().xAxisIds[0],r=Nr().yAxisIds[0],i=Q4();return f.useMemo(()=>{if(n===void 0)return[];const{series:l,stackingGroups:c}=n,u=[];for(const d of c){const h=d.ids;for(let p=h.length-1;p>=0;p-=1){const x=h[p],{xAxisId:b=s,yAxisId:j=r,stackedData:y,data:N,connectNulls:w,baseline:S,curve:_,strictStepCurve:T,area:k}=l[x];if(!k||!(b in e)||!(j in t))continue;const A=e[b].scale,E=uh(A),M=t[j].scale,F=e[b].data,D=t[j].colorScale&&i(j)||e[b].colorScale&&i(b)||void 0,P=_?.includes("step")&&!T&&js(A),B=F?.flatMap((Z,Q)=>{const le=N[Q]==null;if(P){const we=[{x:Z,y:y[Q],nullData:le,isExtension:!1}];return!le&&(Q===0||N[Q-1]==null)&&we.unshift({x:(A(Z)??0)-(A.step()-A.bandwidth())/2,y:y[Q],nullData:le,isExtension:!0}),!le&&(Q===N.length-1||N[Q+1]==null)&&we.push({x:(A(Z)??0)+(A.step()+A.bandwidth())/2,y:y[Q],nullData:le,isExtension:!0}),we}return{x:Z,y:y[Q],nullData:le}})??[],G=w?B.filter(Z=>!Z.nullData):B,W=Yg().x(Z=>Z.isExtension?Z.x:E(Z.x)).defined(Z=>w||!Z.nullData||!!Z.isExtension).y0(Z=>{if(typeof S=="number")return M(S);if(S==="max")return M.range()[1];if(S==="min")return M.range()[0];const Q=Z.y&&M(Z.y[0]);return Number.isNaN(Q)?M.range()[0]:Q}).y1(Z=>Z.y&&M(Z.y[1])).curve(QW(_))(G)||"";u.push({area:l[x].area,color:l[x].color,gradientId:D,d:W,seriesId:x})}}return u},[n,s,r,e,t,i])}const nye=["slots","slotProps","onItemClick","skipAnimation"],sye=fa("g",{name:"MuiAreaPlot",slot:"Root"})({[`& .${J0e.root}`]:{transition:"opacity 0.2s ease-in, fill 0.2s ease-in"}}),rye=()=>{const{xAxis:e}=jr(),{yAxis:t}=Nr();return aye(e,t)};function iye(e){const{slots:t,slotProps:n,onItemClick:s,skipAnimation:r}=e,i=ya(e,nye),o=eD(),l=J4(o||r),c=rye();return a.jsx(sye,Ze({},i,{children:c.map(({d:u,seriesId:d,color:h,area:p,gradientId:x})=>!!p&&a.jsx(tye,{id:d,d:u,color:h,gradientId:x,slots:t,slotProps:n,onClick:s&&(b=>s(b,{type:"line",seriesId:d})),skipAnimation:l},d))}))}const oye=["skipAnimation","ownerState"],lye=f.forwardRef(function(t,n){const{skipAnimation:s,ownerState:r}=t,i=ya(t,oye),o=a0e(Ze({},t,{ref:n}));return a.jsx(YW,{skipAnimation:s,id:`${r.id}-line-clip`,children:a.jsx("path",Ze({stroke:r.gradientId?`url(#${r.gradientId})`:r.color,strokeWidth:2,strokeLinejoin:"round",fill:"none",filter:r.isHighlighted?"brightness(120%)":void 0,opacity:r.isFaded?.3:1,"data-series":r.id,"data-highlighted":r.isHighlighted||void 0,"data-faded":r.isFaded||void 0},i,o))})}),cye=["id","classes","color","gradientId","slots","slotProps","onClick"];function dye(e){return Kn("MuiLineElement",e)}const uye=An("MuiLineElement",["root","highlighted","faded","series"]),mye=e=>{const{classes:t,id:n,isFaded:s,isHighlighted:r}=e,i={root:["root",`series-${n}`,r&&"highlighted",s&&"faded"]};return Qn(i,dye,t)};function fye(e){const{id:t,classes:n,color:s,gradientId:r,slots:i,slotProps:o,onClick:l}=e,c=ya(e,cye),u=jN({type:"line",seriesId:t}),{isFaded:d,isHighlighted:h}=zW({seriesId:t}),p={id:t,classes:n,color:s,gradientId:r,isFaded:d,isHighlighted:h},x=mye(p),b=i?.line??lye,j=Bl({elementType:b,externalSlotProps:o?.line,additionalProps:Ze({},u,{onClick:l,cursor:l?"pointer":"unset"}),className:x.root,ownerState:p});return a.jsx(b,Ze({},c,j))}function hye(e,t){const n=$x(),s=jr().xAxisIds[0],r=Nr().yAxisIds[0],i=Q4();return f.useMemo(()=>{if(n===void 0)return[];const{series:l,stackingGroups:c}=n,u=[];for(const d of c){const h=d.ids;for(const p of h){const{xAxisId:x=s,yAxisId:b=r,stackedData:j,data:y,connectNulls:N,curve:w,strictStepCurve:S}=l[p];if(!(x in e)||!(b in t))continue;const _=e[x].scale,T=uh(_),k=t[b].scale,A=e[x].data,E=t[b].colorScale&&i(b)||e[x].colorScale&&i(x)||void 0,M=w?.includes("step")&&!S&&js(_),F=A?.flatMap((G,$)=>{const W=y[$]==null;if(M){const Z=[{x:G,y:j[$],nullData:W,isExtension:!1}];return!W&&($===0||y[$-1]==null)&&Z.unshift({x:(_(G)??0)-(_.step()-_.bandwidth())/2,y:j[$],nullData:W,isExtension:!0}),!W&&($===y.length-1||y[$+1]==null)&&Z.push({x:(_(G)??0)+(_.step()+_.bandwidth())/2,y:j[$],nullData:W,isExtension:!0}),Z}return{x:G,y:j[$],nullData:W}})??[],D=N?F.filter(G=>!G.nullData):F,B=F4().x(G=>G.isExtension?G.x:T(G.x)).defined(G=>N||!G.nullData||!!G.isExtension).y(G=>k(G.y[1])).curve(QW(w))(D)||"";u.push({color:l[p].color,gradientId:E,d:B,seriesId:p})}}return u},[n,s,r,e,t,i])}const gye=["slots","slotProps","skipAnimation","onItemClick"],pye=fa("g",{name:"MuiAreaPlot",slot:"Root"})({[`& .${uye.root}`]:{transition:"opacity 0.2s ease-in, fill 0.2s ease-in"}}),xye=()=>{const{xAxis:e}=jr(),{yAxis:t}=Nr();return hye(e,t)};function yye(e){const{slots:t,slotProps:n,skipAnimation:s,onItemClick:r}=e,i=ya(e,gye),o=eD(),l=J4(o||s),c=xye();return a.jsx(pye,Ze({},i,{children:c.map(({d:u,seriesId:d,color:h,gradientId:p})=>a.jsx(fye,{id:d,d:u,color:h,gradientId:p,skipAnimation:l,slots:t,slotProps:n,onClick:r&&(x=>r(x,{type:"line",seriesId:d}))},d))}))}function bye(e){return Kn("MuiMarkElement",e)}const KW=An("MuiMarkElement",["root","highlighted","faded","animate","series"]),XW=e=>{const{classes:t,id:n,isFaded:s,isHighlighted:r,skipAnimation:i}=e,o={root:["root",`series-${n}`,r&&"highlighted",s&&"faded",i?void 0:"animate"]};return Qn(o,bye,t)},vye=["x","y","id","classes","color","dataIndex","onClick","skipAnimation","isFaded","isHighlighted"],wye=fa("circle")({[`&.${KW.animate}`]:{transitionDuration:`${vN}ms`,transitionProperty:"cx, cy",transitionTimingFunction:K4}});function jye(e){const{x:t,y:n,id:s,classes:r,color:i,dataIndex:o,onClick:l,skipAnimation:c,isFaded:u=!1,isHighlighted:d=!1}=e,h=ya(e,vye),p=Yo(),x=jN({type:"line",seriesId:s,dataIndex:o}),j=XW({id:s,classes:r,isHighlighted:d,isFaded:u,skipAnimation:c});return a.jsx(wye,Ze({},h,{cx:t,cy:n,r:5,fill:(p.vars||p).palette.background.paper,stroke:i,strokeWidth:2,className:j.root,onClick:l,cursor:l?"pointer":"unset"},x,{"data-highlighted":d||void 0,"data-faded":u||void 0}))}function ZW(e){switch(e){case"circle":return 0;case"cross":return 1;case"diamond":return 2;case"square":return 3;case"star":return 4;case"triangle":return 5;case"wye":return 6;default:return 0}}const Nye=["x","y","id","classes","color","shape","dataIndex","onClick","skipAnimation","isFaded","isHighlighted"],Cye=fa("path",{name:"MuiMarkElement",slot:"Root"})(({ownerState:e,theme:t})=>({fill:(t.vars||t).palette.background.paper,stroke:e.color,strokeWidth:2,[`&.${KW.animate}`]:{transitionDuration:`${vN}ms`,transitionProperty:"transform, transform-origin",transitionTimingFunction:K4}}));function Sye(e){const{x:t,y:n,id:s,classes:r,color:i,shape:o,dataIndex:l,onClick:c,skipAnimation:u,isFaded:d=!1,isHighlighted:h=!1}=e,p=ya(e,Nye),x=jN({type:"line",seriesId:s,dataIndex:l}),b={id:s,classes:r,isHighlighted:h,isFaded:d,color:i,skipAnimation:u},j=XW(b);return a.jsx(Cye,Ze({},p,{style:{transform:`translate(${t}px, ${n}px)`,transformOrigin:`${t}px ${n}px`},ownerState:b,className:j.root,d:U4(uW[ZW(o)])(),onClick:c,cursor:c?"pointer":"unset"},x,{"data-highlighted":h||void 0,"data-faded":d||void 0}))}const _ye=["slots","slotProps","skipAnimation","onItemClick"];function Aye(e){const{slots:t,slotProps:n,skipAnimation:s,onItemClick:r}=e,i=ya(e,_ye),o=eD(),l=J4(o||s),c=$x(),{xAxis:u,xAxisIds:d}=jr(),{yAxis:h,yAxisIds:p}=Nr(),x=xN(),{instance:b,store:j}=Yr(),{isFaded:y,isHighlighted:N}=zxe(),w=Vt(j,HG),S=f.useMemo(()=>{const E={};for(const{dataIndex:M,axisId:F}of w)E[F]===void 0?E[F]=new Set([M]):E[F].add(M);return E},[w]);if(c===void 0)return null;const{series:_,stackingGroups:T}=c,k=d[0],A=p[0];return a.jsx("g",Ze({},i,{children:T.flatMap(({ids:E})=>E.map(M=>{const{xAxisId:F=k,yAxisId:D=A,stackedData:P,data:B,showMark:G=!0,shape:$="circle"}=_[M];if(G===!1)return null;const W=uh(u[F].scale),Z=h[D].scale,Q=u[F].data;if(Q===void 0)throw new Error(`MUI X Charts: ${F===qj?"The first `xAxis`":`The x-axis with id "${F}"`} should have data property to be able to display a line plot.`);const le=WW(`${x}-${M}-line-clip`),we=Z4(_[M],u[F],h[D]),J=t?.mark??($==="circle"?jye:Sye),se=N({seriesId:M}),ye=!se&&y({seriesId:M});return a.jsx("g",{clipPath:`url(#${le})`,"data-series":M,children:Q?.map((Ce,ge)=>{const be=B[ge]==null?null:P[ge][1];return{x:W(Ce),y:be===null?null:Z(be),position:Ce,value:be,index:ge}}).filter(({x:Ce,y:ge,index:be,position:me,value:Ae})=>Ae===null||ge===null||!b.isPointInside(Ce,ge)?!1:G===!0?!0:G({x:Ce,y:ge,index:be,position:me,value:Ae})).map(({x:Ce,y:ge,index:be})=>a.jsx(J,Ze({id:M,dataIndex:be,shape:$,color:we(be),x:Ce,y:ge,skipAnimation:l,onClick:r&&(me=>r(me,{type:"line",seriesId:M,dataIndex:be})),isHighlighted:S[F]?.has(be)||se,isFaded:ye},n?.mark),`${M}-${be}`))},M)}))}))}function NN(){const[e,t]=f.useState(typeof window<"u"||!1);return f.useEffect(()=>{t(!0)},[]),e}function tD(e){return typeof e=="number"&&!Number.isFinite(e)}const Uk={start:0,extremities:0,end:1,middle:.5};function I2(e,t,n){return e(t)-(e.step()-e.bandwidth())/2+Uk[n]*e.step()}function Tye(e){const{scale:t,tickNumber:n,valueFormatter:s,tickInterval:r,tickPlacement:i="extremities",tickLabelPlacement:o,isInside:l}=e;if(js(t)){const p=t.domain(),x=o??"middle";if(t.bandwidth()>0){const j=typeof r=="function"&&p.filter(r)||typeof r=="object"&&r||p,y=t.range()[0]>t.range()[1],N=j.findIndex(S=>l(I2(t,S,y?"start":"end"))),w=j.findLastIndex(S=>l(I2(t,S,y?"end":"start")));return[...j.slice(N,w+1).map(S=>{const _=`${S}`;return{value:S,formattedValue:s?.(S,{location:"tick",scale:t,tickNumber:n,defaultTickLabel:_})??_,offset:I2(t,S,i),labelOffset:x==="tick"?0:t.step()*(Uk[x]-Uk[i])}}),...i==="extremities"&&w===p.length-1&&l(t.range()[1])?[{formattedValue:void 0,offset:t.range()[1],labelOffset:0}]:[]]}return(typeof r=="function"&&p.filter(r)||typeof r=="object"&&r||p).map(j=>{const y=`${j}`;return{value:j,formattedValue:s?.(j,{location:"tick",scale:t,tickNumber:n,defaultTickLabel:y})??y,offset:t(j),labelOffset:0}})}if(t.domain().some(tD))return[];const u=o,d=typeof r=="object"?r:kye(t,n),h=[];for(let p=0;p<d.length;p+=1){const x=d[p],b=t(x);if(l(b)){const j=t.tickFormat(n)(x);h.push({value:x,formattedValue:s?.(x,{location:"tick",scale:t,tickNumber:n,defaultTickLabel:j})??j,offset:b,labelOffset:u==="middle"?t(d[p-1]??0)-(b+t(d[p-1]??0))/2:0})}}return h}function kye(e,t){const n=e.domain();return n[0]===n[1]?[n[0]]:e.ticks(t)}function CN(e){const{scale:t,tickNumber:n,valueFormatter:s,tickInterval:r,tickPlacement:i="extremities",tickLabelPlacement:o,direction:l}=e,{instance:c}=Yr(),u=l==="x"?c.isXInside:c.isYInside;return f.useMemo(()=>Tye({scale:t,tickNumber:n,tickPlacement:i,tickInterval:r,tickLabelPlacement:o,valueFormatter:s,isInside:u}),[t,n,i,r,o,s,u])}function Eye(e=!1){const[t,n]=f.useState(!1);return ls(()=>{e||n(!0)},[e]),f.useEffect(()=>{e&&n(!0)},[e]),t}const JW=typeof window<"u"&&"Intl"in window&&"Segmenter"in Intl?new Intl.Segmenter(void 0,{granularity:"grapheme"}):null;function Lye(e){return e.length}function Dye(e){const t=JW.segment(e);let n=0;for(const s of t)n+=1;return n}const Pye=JW?Dye:Lye;function Oye(e){return e*(Math.PI/180)}const eV=typeof window<"u"&&"Intl"in window&&"Segmenter"in Intl?new Intl.Segmenter(void 0,{granularity:"grapheme"}):null;function Mye(e,t){return e.slice(0,t)}function Iye(e,t){const n=eV.segment(e);let s="",r=0;for(const i of n)if(s+=i.segment,r+=1,r>=t)break;return s}const $ye=eV?Iye:Mye,Y6="";function tV(e,t){const{width:n,height:s,measureText:r}=t,i=Oye(t.angle),o=r(e),l=Math.abs(o.width*Math.cos(i))+Math.abs(o.height*Math.sin(i)),c=Math.abs(o.width*Math.sin(i))+Math.abs(o.height*Math.cos(i));return l<=n&&c<=s}function aV(e,t){if(t(e))return e;let n=e,s=1,r=1/2;const i=Pye(e);let o=i,l=i,c=null;do{if(l=o,o=Math.floor(i*r),o===0)break;n=$ye(e,o).trim();const u=t(n+Y6);s+=1,u?(c=n,r+=1/2**s):r-=1/2**s}while(Math.abs(o-l)!==1);return c?c+Y6:""}function nV(){return typeof window>"u"}const ed=new Map,sV=2e3,Rye=new Set(["minWidth","maxWidth","width","minHeight","maxHeight","height","top","left","fontSize","padding","margin","paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom"]);function aD(e,t){return Rye.has(e)&&t===+t?`${t}px`:t}const zye=/([A-Z])/g;function nD(e){return String(e).replace(zye,t=>`-${t.toLowerCase()}`)}function rV(e){let t="";for(const n in e)if(Object.hasOwn(e,n)){const s=n,r=e[s];if(r===void 0)continue;t+=`${nD(s)}:${aD(s,r)};`}return t}const Rx=(e,t={})=>{if(e==null||nV())return{width:0,height:0};const n=String(e),s=rV(t),r=`${n}-${s}`,i=ed.get(r);if(i)return i;try{const o=oV(),l=document.createElementNS("http://www.w3.org/2000/svg","text");Object.keys(t).map(u=>(l.style[nD(u)]=aD(u,t[u]),u)),l.textContent=n,o.replaceChildren(l);const c=iV(l);return ed.set(r,c),ed.size+1>sV&&ed.clear(),c}catch{return{width:0,height:0}}};function Fye(e,t={}){if(nV())return new Map(Array.from(e).map(c=>[c,{width:0,height:0}]));const n=new Map,s=[],r=rV(t);for(const c of e){const u=`${c}-${r}`,d=ed.get(u);d?n.set(c,d):s.push(c)}const i=oV(),o=Ze({},t);Object.keys(o).map(c=>(i.style[nD(c)]=aD(c,o[c]),c));const l=[];for(const c of s){const u=document.createElementNS("http://www.w3.org/2000/svg","text");u.textContent=`${c}`,l.push(u)}i.replaceChildren(...l);for(let c=0;c<s.length;c+=1){const u=s[c],d=i.children[c],h=iV(d),p=`${u}-${r}`;ed.set(p,h),n.set(u,h)}return ed.size+1>sV&&ed.clear(),n}function iV(e){try{const t=e.getBBox();return{width:t.width,height:t.height}}catch{const t=e.getBoundingClientRect();return{width:t.width,height:t.height}}}let ir=null;function oV(){return ir===null&&(ir=document.createElementNS("http://www.w3.org/2000/svg","svg"),ir.setAttribute("aria-hidden","true"),ir.style.position="absolute",ir.style.top="-20000px",ir.style.left="0",ir.style.padding="0",ir.style.margin="0",ir.style.border="none",ir.style.pointerEvents="none",ir.style.visibility="hidden",ir.style.contain="strict",document.body.appendChild(ir)),ir}function Uye(e,t,n,s,r){const i=new Map,o=yN(r?.angle??0);let l=1,c=1;r?.textAnchor==="start"?(l=1/0,c=1):r?.textAnchor==="end"?(l=1,c=1/0):(l=2,c=2),o>90&&o<270&&([l,c]=[c,l]),s&&([l,c]=[c,l]);for(const u of e)if(u.formattedValue){const d=Math.min((u.offset+u.labelOffset)*l,(t.left+t.width+t.right-u.offset-u.labelOffset)*c),h=p=>tV(p,{width:d,height:n,angle:o,measureText:x=>Rx(x,r)});i.set(u,aV(u.formattedValue.toString(),h))}return i}const Q6=5;function Bye(e,t,n=0){const s=Math.min(Math.abs(n)%180,Math.abs(Math.abs(n)%180-180)%180);if(s<Q6)return e;if(s>90-Q6)return t;const r=Jc(s),i=Math.atan2(t,e);return r<i?e/Math.cos(r):t/Math.sin(r)}function Hye(e,{tickLabelStyle:t,tickLabelInterval:n,tickLabelMinGap:s,reverse:r,isMounted:i,isXInside:o}){if(typeof n=="function")return new Set(e.filter((h,p)=>n(h.value,p)));let l=0;const c=r?-1:1,u=e.filter(h=>{const{offset:p,labelOffset:x,formattedValue:b}=h;if(b==="")return!1;const j=p+x;return o(j)}),d=Gye(u,t);return new Set(u.filter((h,p)=>{const{offset:x,labelOffset:b}=h,j=x+b;if(p>0&&c*j<c*(l+s))return!1;const{width:y,height:N}=i?qye(d,h):{width:0,height:0},w=Bye(y,N,t?.angle),S=j-c*w/2;return p>0&&c*S<c*(l+s)?!1:(l=j+c*w/2,!0)}))}function qye(e,t){if(t.formattedValue===void 0)return{width:0,height:0};let n=0,s=0;for(const r of t.formattedValue.split(`
`)){const i=e.get(r);i&&(n=Math.max(n,i.width),s+=i.height)}return{width:n,height:s}}function Gye(e,t){const n=new Set;for(const s of e)s.formattedValue&&s.formattedValue.split(`
`).forEach(r=>n.add(r));return Fye(n,t)}function lV(e){return Kn("MuiChartsAxis",e)}const tb=An("MuiChartsAxis",["root","line","tickContainer","tick","tickLabel","label","directionX","directionY","top","bottom","left","right","id"]),cV=e=>{const{classes:t,position:n,id:s}=e,r={root:["root","directionX",n,`id-${s}`],line:["line"],tickContainer:["tickContainer"],tick:["tick"],tickLabel:["tickLabel"],label:["label"]};return Qn(r,lV,t)},Bk=3,Wye=4,dV={disableLine:!1,disableTicks:!1,tickSize:6,tickLabelMinGap:4};function Vye({style:e,needsComputation:t,text:n}){return n.split(`
`).map(s=>Ze({text:s},t?Rx(s,e):{width:0,height:0}))}const Yye=["x","y","style","text","ownerState"],Qye=["angle","textAnchor","dominantBaseline"];function SN(e){const{x:t,y:n,style:s,text:r}=e,i=ya(e,Yye),o=s??{},{angle:l,textAnchor:c,dominantBaseline:u}=o,d=ya(o,Qye),h=NN(),p=f.useMemo(()=>Vye({style:d,needsComputation:h&&r.includes(`
`),text:r}),[d,r,h]);let x;switch(u){case"hanging":case"text-before-edge":x=0;break;case"central":x=(p.length-1)/2*-p[0].height;break;default:x=(p.length-1)*-p[0].height;break}return a.jsx("text",Ze({},i,{transform:l?`rotate(${l}, ${t}, ${n})`:void 0,x:t,y:n,textAnchor:c,dominantBaseline:u,style:d,children:p.map((b,j)=>a.jsx("tspan",{x:t,dy:`${j===0?x:p[0].height}px`,dominantBaseline:u,children:b.text},j))}))}function uV(e){const t=yN(e);return t<=30||t>=330||t<=210&&t>=150?"middle":t<=180?"end":"start"}function mV(e){const t=yN(e);return t<=30||t>=330?"hanging":t<=210&&t>=150?"auto":"central"}function fV(e){switch(e){case"start":return"end";case"end":return"start";default:return e}}const Kye=["scale","tickNumber","reverse"];function hV(e){const{xAxis:t,xAxisIds:n}=jr(),s=t[e.axisId??n[0]],{scale:r,tickNumber:i,reverse:o}=s,l=ya(s,Kye),c=Ti({props:Ze({},l,e),name:"MuiChartsXAxis"}),u=Ze({},dV,c),{position:d,tickLabelStyle:h,slots:p,slotProps:x}=u,b=Yo(),j=wx(),y=cV(u),N=d==="bottom"?1:-1,w=p?.axisTick??"line",S=p?.axisTickLabel??SN,_=uV((d==="bottom"?0:180)-(h?.angle??0)),T=mV((d==="bottom"?0:180)-(h?.angle??0)),k=Bl({elementType:S,externalSlotProps:x?.axisTickLabel,additionalProps:{style:Ze({},b.typography.caption,{fontSize:12,lineHeight:1.25,textAnchor:j?fV(_):_,dominantBaseline:T},h)},className:y.tickLabel,ownerState:{}});return{xScale:r,defaultizedProps:u,tickNumber:i,positionSign:N,classes:y,Tick:w,TickLabel:S,axisTickLabelProps:k,reverse:o}}function Xye(e){const{axisLabelHeight:t}=e,{xScale:n,defaultizedProps:s,tickNumber:r,positionSign:i,classes:o,Tick:l,TickLabel:c,axisTickLabelProps:u,reverse:d}=hV(e),h=wx(),p=Eye(),{disableTicks:x,tickSize:b,valueFormatter:j,slotProps:y,tickInterval:N,tickLabelInterval:w,tickPlacement:S,tickLabelPlacement:_,tickLabelMinGap:T,height:k}=s,A=Ei(),{instance:E}=Yr(),M=NN(),F=x?4:b,D=CN({scale:n,tickNumber:r,valueFormatter:j,tickInterval:N,tickPlacement:S,tickLabelPlacement:_,direction:"x"}),P=Hye(D,{tickLabelStyle:u.style,tickLabelInterval:w,tickLabelMinGap:T,reverse:d,isMounted:p,isXInside:E.isXInside}),B=Math.max(0,k-(t>0?t+Wye:0)-F-Bk),G=M?Uye(P,A,B,h,u.style):new Map(Array.from(P).map($=>[$,$.formattedValue]));return a.jsx(f.Fragment,{children:D.map(($,W)=>{const{offset:Z,labelOffset:Q}=$,le=Q??0,we=i*(F+Bk),J=E.isXInside(Z),se=G.get($),ye=P.has($);return a.jsxs("g",{transform:`translate(${Z}, 0)`,className:o.tickContainer,children:[!x&&J&&a.jsx(l,Ze({y2:i*F,className:o.tick},y?.axisTick)),se!==void 0&&ye&&a.jsx(c,Ze({x:le,y:we},u,{text:se}))]},W)})})}const _g={start:0,extremities:0,end:1,middle:.5,tick:0};function gV(e){const{scale:t,tickInterval:n,tickLabelPlacement:s="middle",tickPlacement:r="extremities",groups:i}=e;return f.useMemo(()=>{const o=t.domain(),l=typeof n=="function"&&o.filter(n)||typeof n=="object"&&n||o;if(t.bandwidth()>0){const c=K6(l,i,r,s,t);return c[0]&&(c[0].ignoreTick=!0),[{formattedValue:void 0,offset:t.range()[0],labelOffset:0,groupIndex:i.length-1},...c,{formattedValue:void 0,offset:t.range()[1],labelOffset:0,groupIndex:i.length-1}]}return K6(l,i,r,s,t)},[t,n,i,r,s])}function K6(e,t,n,s,r){const i=[],o=new Map;let l=0;for(let c=0;c<t.length;c+=1)for(let u=0;u<e.length;u+=1){const d=e[u],h=t[c].getValue(d,u),p=i[i.length-1];if(p?.value!==h||p?.groupIndex!==c){l=1;const b=js(r)?r(d)-(r.step()-r.bandwidth())/2+_g[n]*r.step():r(d),j=r.step()*l*(_g[s]-_g[n]);i.push({value:h,formattedValue:`${h}`,offset:b,groupIndex:c,dataIndex:u,ignoreTick:!1,labelOffset:j}),o.has(u)||o.set(u,new Set);const y=o.get(u);for(const N of y.values())i[N].ignoreTick=!0;y.add(i.length-1)}else{l+=1;const b=r.step()*l*(_g[s]-_g[n]);p.labelOffset=b}}return i}const X6={tickSize:6},Zye=(e,t,n)=>{const s=e[t]??{},r=n??X6.tickSize,i=r*t*2+r;return Ze({},X6,s,{tickSize:s.tickSize??i})};function Jye(e){const{xScale:t,defaultizedProps:n,positionSign:s,classes:r,Tick:i,TickLabel:o,axisTickLabelProps:l}=hV(e);if(!js(t))throw new Error("MUI X Charts: ChartsGroupedXAxis only supports the `band` and `point` scale types.");const{disableTicks:c,tickSize:u,valueFormatter:d,slotProps:h,tickInterval:p,tickPlacement:x,tickLabelPlacement:b}=n,j=n.groups,{instance:y}=Yr(),N=gV({scale:t,tickInterval:p,tickPlacement:x,tickLabelPlacement:b,groups:j});return a.jsx(f.Fragment,{children:N.map((w,S)=>{const{offset:_,labelOffset:T}=w,k=T??0,A=y.isXInside(_),E=w.formattedValue,M=w.ignoreTick??!1,F=w.groupIndex??0,D=Zye(j,F,u),P=s*D.tickSize,B=s*(D.tickSize+Bk);return a.jsxs("g",{transform:`translate(${_}, 0)`,className:r.tickContainer,"data-group-index":F,children:[!c&&!M&&A&&a.jsx(i,Ze({y2:P,className:r.tick},h?.axisTick)),E!==void 0&&a.jsx(o,Ze({x:k,y:B},l,{style:Ze({},l.style,D.tickLabelStyle),text:E}))]},S)})})}const pV=fa("g",{name:"MuiChartsAxis",slot:"Root"})(({theme:e})=>({[`& .${tb.tickLabel}`]:Ze({},e.typography.caption,{fill:(e.vars||e).palette.text.primary}),[`& .${tb.label}`]:{fill:(e.vars||e).palette.text.primary},[`& .${tb.line}`]:{stroke:(e.vars||e).palette.text.primary,shapeRendering:"crispEdges",strokeWidth:1},[`& .${tb.tick}`]:{stroke:(e.vars||e).palette.text.primary,shapeRendering:"crispEdges"}})),ebe=["axis"],tbe=["scale","tickNumber","reverse"],abe=fa(pV,{name:"MuiChartsXAxis",slot:"Root"})({});function nbe(e){let{axis:t}=e,n=ya(e,ebe);const{scale:s}=t,r=ya(t,tbe),i=Ti({props:Ze({},r,n),name:"MuiChartsXAxis"}),o=Ze({},dV,i),{position:l,labelStyle:c,offset:u,slots:d,slotProps:h,sx:p,disableLine:x,label:b,height:j}=o,y=Yo(),N=cV(o),{left:w,top:S,width:_,height:T}=Ei(),k=l==="bottom"?1:-1,A=d?.axisLine??"line",E=d?.axisLabel??SN,M=Bl({elementType:E,externalSlotProps:h?.axisLabel,additionalProps:{style:Ze({},y.typography.body1,{lineHeight:1,fontSize:14,textAnchor:"middle",dominantBaseline:l==="bottom"?"text-after-edge":"text-before-edge"},c)},ownerState:{}});if(l==="none")return null;const F=b?Rx(b,M.style).height:0,D=s.domain(),B=js(s)?D.length===0:D.some(tD);let G=null;B||(G="groups"in t&&Array.isArray(t.groups)?a.jsx(Jye,Ze({},n)):a.jsx(Xye,Ze({},n,{axisLabelHeight:F})));const $={x:w+_/2,y:k*j};return a.jsxs(abe,{transform:`translate(0, ${l==="bottom"?S+T+u:S-u})`,className:N.root,sx:p,children:[!x&&a.jsx(A,Ze({x1:w,x2:w+_,className:N.line},h?.axisLine)),G,b&&a.jsx("g",{className:N.label,children:a.jsx(E,Ze({},$,M,{text:b}))})]})}function sbe(e){const{xAxis:t,xAxisIds:n}=jr(),s=t[e.axisId??n[0]];return s?a.jsx(nbe,Ze({},e,{axis:s})):(`${e.axisId}`,null)}function rbe(e,t,n,s,r){const i=new Map,o=yN(r?.angle??0);let l=1,c=1;r?.textAnchor==="start"?(l=1/0,c=1):r?.textAnchor==="end"?(l=1,c=1/0):(l=2,c=2),o>180&&([l,c]=[c,l]),s&&([l,c]=[c,l]);for(const u of e)if(u.formattedValue){const d=Math.min((u.offset+u.labelOffset)*l,(t.top+t.height+t.bottom-u.offset-u.labelOffset)*c),h=p=>tV(p,{width:n,height:d,angle:o,measureText:x=>Rx(x,r)});i.set(u,aV(u.formattedValue.toString(),h))}return i}const xV=e=>{const{classes:t,position:n,id:s}=e,r={root:["root","directionY",n,`id-${s}`],line:["line"],tickContainer:["tickContainer"],tick:["tick"],tickLabel:["tickLabel"],label:["label"]};return Qn(r,lV,t)},Hk=2,ibe=2,yV={disableLine:!1,disableTicks:!1,tickSize:6},obe=["scale","tickNumber","reverse"];function bV(e){const{yAxis:t,yAxisIds:n}=Nr(),s=t[e.axisId??n[0]],{scale:r,tickNumber:i}=s,o=ya(s,obe),l=Ti({props:Ze({},o,e),name:"MuiChartsYAxis"}),c=Ze({},yV,l),{position:u,tickLabelStyle:d,slots:h,slotProps:p}=c,x=Yo(),b=wx(),j=xV(c),y=u==="right"?1:-1,N=typeof d?.fontSize=="number"?d.fontSize:12,w=h?.axisTick??"line",S=h?.axisTickLabel??SN,_=uV((u==="right"?-90:90)-(d?.angle??0)),T=mV((u==="right"?-90:90)-(d?.angle??0)),k=Bl({elementType:S,externalSlotProps:p?.axisTickLabel,additionalProps:{style:Ze({},x.typography.caption,{fontSize:N,textAnchor:b?fV(_):_,dominantBaseline:T},d)},className:j.tickLabel,ownerState:{}});return{yScale:r,defaultizedProps:c,tickNumber:i,positionSign:y,classes:j,Tick:w,TickLabel:S,axisTickLabelProps:k}}function lbe(e){const{axisLabelHeight:t}=e,{yScale:n,defaultizedProps:s,tickNumber:r,positionSign:i,classes:o,Tick:l,TickLabel:c,axisTickLabelProps:u}=bV(e),d=wx(),{disableTicks:h,tickSize:p,valueFormatter:x,slotProps:b,tickPlacement:j,tickLabelPlacement:y,tickInterval:N,tickLabelInterval:w,width:S}=s,_=Ei(),{instance:T}=Yr(),k=NN(),A=h?4:p,E=CN({scale:n,tickNumber:r,valueFormatter:x,tickPlacement:j,tickLabelPlacement:y,tickInterval:N,direction:"y"}),M=Math.max(0,S-(t>0?t+ibe:0)-A-Hk),F=k?rbe(E,_,M,d,u.style):new Map(Array.from(E).map(D=>[D,D.formattedValue]));return a.jsx(f.Fragment,{children:E.map((D,P)=>{const{offset:B,labelOffset:G,value:$}=D,W=i*(A+Hk),Z=G,Q=typeof w=="function"&&!w?.($,P),le=T.isYInside(B),we=F.get(D);return le?a.jsxs("g",{transform:`translate(0, ${B})`,className:o.tickContainer,children:[!h&&a.jsx(l,Ze({x2:i*A,className:o.tick},b?.axisTick)),we!==void 0&&!Q&&a.jsx(c,Ze({x:W,y:Z,text:we},u))]},P):null})})}const Z6={tickSize:6},cbe=(e,t,n)=>{const s=e[t]??{},r=n??Z6.tickSize,i=r*t*2+r;return Ze({},Z6,s,{tickSize:s.tickSize??i})};function dbe(e){const{yScale:t,defaultizedProps:n,positionSign:s,classes:r,Tick:i,TickLabel:o,axisTickLabelProps:l}=bV(e);if(!js(t))throw new Error("MUI X Charts: ChartsGroupedYAxis only supports the `band` and `point` scale types.");const{disableTicks:c,tickSize:u,valueFormatter:d,slotProps:h,tickInterval:p,tickPlacement:x,tickLabelPlacement:b}=n,j=n.groups,{instance:y}=Yr(),N=gV({scale:t,tickInterval:p,tickPlacement:x,tickLabelPlacement:b,groups:j});return a.jsx(f.Fragment,{children:N.map((w,S)=>{const{offset:_,labelOffset:T}=w,k=T??0,A=y.isYInside(_),E=w.formattedValue,M=w.ignoreTick??!1,F=w.groupIndex??0,D=cbe(j,F,u),P=s*D.tickSize,B=s*(D.tickSize+Hk);return a.jsxs("g",{transform:`translate(0, ${_})`,className:r.tickContainer,"data-group-index":F,children:[!c&&!M&&A&&a.jsx(i,Ze({x2:P,className:r.tick},h?.axisTick)),E!==void 0&&a.jsx(o,Ze({x:B,y:k},l,{style:Ze({},l.style,D.tickLabelStyle),text:E}))]},S)})})}const ube=["axis"],mbe=["scale","tickNumber","reverse"],fbe=fa(pV,{name:"MuiChartsYAxis",slot:"Root"})({});function hbe(e){let{axis:t}=e,n=ya(e,ube);const{scale:s}=t,r=ya(t,mbe),i=NN(),o=Ti({props:Ze({},r,n),name:"MuiChartsYAxis"}),l=Ze({},yV,o),{position:c,disableLine:u,label:d,labelStyle:h,offset:p,width:x,sx:b,slots:j,slotProps:y}=l,N=Yo(),w=xV(l),{left:S,top:_,width:T,height:k}=Ei(),A=c==="right"?1:-1,E=j?.axisLine??"line",M=j?.axisLabel??SN,F=Bl({elementType:E,externalSlotProps:y?.axisLine,additionalProps:{strokeLinecap:"square"},ownerState:{}}),D=Bl({elementType:M,externalSlotProps:y?.axisLabel,additionalProps:{style:Ze({},N.typography.body1,{lineHeight:1,fontSize:14,angle:A*90,textAnchor:"middle",dominantBaseline:"text-before-edge"},h)},ownerState:{}});if(c==="none")return null;const P={x:A*x,y:_+k/2},B=d==null?0:Rx(d,D.style).height,G=s.domain(),W=js(s)?G.length===0:G.some(tD);let Z=null;return W||(Z="groups"in t&&Array.isArray(t.groups)?a.jsx(dbe,Ze({},n)):a.jsx(lbe,Ze({},n,{axisLabelHeight:B}))),a.jsxs(fbe,{transform:`translate(${c==="right"?S+T+p:S-p}, 0)`,className:w.root,sx:b,children:[!u&&a.jsx(E,Ze({y1:_,y2:_+k,className:w.line},F)),Z,d&&i&&a.jsx("g",{className:w.label,children:a.jsx(M,Ze({},P,D,{text:d}))})]})}function gbe(e){const{yAxis:t,yAxisIds:n}=Nr(),s=t[e.axisId??n[0]];return s?a.jsx(hbe,Ze({},e,{axis:s})):(`${e.axisId}`,null)}function pbe(e){const{slots:t,slotProps:n}=e,{xAxisIds:s,xAxis:r}=jr(),{yAxisIds:i,yAxis:o}=Nr();return a.jsxs(f.Fragment,{children:[s.map(l=>!r[l].position||r[l].position==="none"?null:a.jsx(sbe,{slots:t,slotProps:n,axisId:l},l)),i.map(l=>!o[l].position||o[l].position==="none"?null:a.jsx(gbe,{slots:t,slotProps:n,axisId:l},l))]})}function xbe(e){return Kn("MuiTypography",e)}An("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]);const ybe={primary:!0,secondary:!0,error:!0,info:!0,success:!0,warning:!0,textPrimary:!0,textSecondary:!0,textDisabled:!0},bbe=Fde(),vbe=e=>{const{align:t,gutterBottom:n,noWrap:s,paragraph:r,variant:i,classes:o}=e,l={root:["root",i,e.align!=="inherit"&&`align${Va(t)}`,n&&"gutterBottom",s&&"noWrap",r&&"paragraph"]};return Qn(l,xbe,o)},wbe=fa("span",{name:"MuiTypography",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.variant&&t[n.variant],n.align!=="inherit"&&t[`align${Va(n.align)}`],n.noWrap&&t.noWrap,n.gutterBottom&&t.gutterBottom,n.paragraph&&t.paragraph]}})(Uu(({theme:e})=>({margin:0,variants:[{props:{variant:"inherit"},style:{font:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}},...Object.entries(e.typography).filter(([t,n])=>t!=="inherit"&&n&&typeof n=="object").map(([t,n])=>({props:{variant:t},style:n})),...Object.entries(e.palette).filter(Sp()).map(([t])=>({props:{color:t},style:{color:(e.vars||e).palette[t].main}})),...Object.entries(e.palette?.text||{}).filter(([,t])=>typeof t=="string").map(([t])=>({props:{color:`text${Va(t)}`},style:{color:(e.vars||e).palette.text[t]}})),{props:({ownerState:t})=>t.align!=="inherit",style:{textAlign:"var(--Typography-textAlign)"}},{props:({ownerState:t})=>t.noWrap,style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},{props:({ownerState:t})=>t.gutterBottom,style:{marginBottom:"0.35em"}},{props:({ownerState:t})=>t.paragraph,style:{marginBottom:16}}]}))),J6={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},sD=f.forwardRef(function(t,n){const{color:s,...r}=Cd({props:t,name:"MuiTypography"}),i=!ybe[s],o=bbe({...r,...i&&{color:s}}),{align:l="inherit",className:c,component:u,gutterBottom:d=!1,noWrap:h=!1,paragraph:p=!1,variant:x="body1",variantMapping:b=J6,...j}=o,y={...o,align:l,color:s,className:c,component:u,gutterBottom:d,noWrap:h,paragraph:p,variant:x,variantMapping:b},N=u||(p?"p":b[x]||J6[x])||"span",w=vbe(y);return a.jsx(wbe,{as:N,ref:n,className:Rt(w.root,c),...j,ownerState:y,style:{...l!=="inherit"&&{"--Typography-textAlign":l},...j.style}})});function jbe(e){return Kn("MuiChartsTooltip",e)}const pf=An("MuiChartsTooltip",["root","paper","table","row","cell","mark","markContainer","labelCell","valueCell","axisValueCell"]),_N=e=>Qn({root:["root"],paper:["paper"],table:["table"],row:["row"],cell:["cell"],mark:["mark"],markContainer:["markContainer"],labelCell:["labelCell"],valueCell:["valueCell"],axisValueCell:["axisValueCell"]},jbe,e);function Nbe(){const e=Ka(),t=Vt(e,OG),n=Vt(e,Vr),s=bN(),{xAxis:r,xAxisIds:i}=jr(),{yAxis:o,yAxisIds:l}=Nr(),{zAxis:c,zAxisIds:u}=W4(),{rotationAxis:d,rotationAxisIds:h}=MW();if(!t)return null;const p=s[t.type]?.series[t.seriesId];if(!p)return null;const x=Wv(p)?p.xAxisId??i[0]:void 0,b=Wv(p)?p.yAxisId??l[0]:void 0,j="zAxisId"in p?p.zAxisId??u[0]:u[0],y=h[0],N=n[p.type].colorProcessor?.(p,x!==void 0?r[x]:void 0,b!==void 0?o[b]:void 0,j!==void 0?c[j]:void 0)??(()=>""),w={};return x!==void 0&&(w.x=r[x]),b!==void 0&&(w.y=o[b]),y!==void 0&&(w.rotation=d[y]),n[p.type].tooltipGetter({series:p,axesConfig:w,getColor:N,identifier:t})}const qk=fa("div",{name:"MuiChartsTooltip",slot:"Container",overridesResolver:(e,t)=>t.paper})(({theme:e})=>({backgroundColor:(e.vars||e).palette.background.paper,color:(e.vars||e).palette.text.primary,borderRadius:(e.vars||e).shape?.borderRadius,border:`solid ${(e.vars||e).palette.divider} 1px`})),Gk=fa("table",{name:"MuiChartsTooltip",slot:"Table"})(({theme:e})=>({borderSpacing:0,[`& .${pf.markContainer}`]:{display:"inline-block",width:`calc(20px + ${e.spacing(1.5)})`,verticalAlign:"middle"},"& caption":{borderBottom:`solid ${(e.vars||e).palette.divider} 1px`,padding:e.spacing(.5,1.5),textAlign:"start",whiteSpace:"nowrap","& span":{marginRight:e.spacing(1.5)}}})),Wk=fa("tr",{name:"MuiChartsTooltip",slot:"Row"})(({theme:e})=>({"tr:first-of-type& td":{paddingTop:e.spacing(.5)},"tr:last-of-type& td":{paddingBottom:e.spacing(.5)}})),yf=fa(sD,{name:"MuiChartsTooltip",slot:"Cell"})(({theme:e})=>({verticalAlign:"middle",color:(e.vars||e).palette.text.secondary,textAlign:"start",[`&.${pf.cell}`]:{paddingLeft:e.spacing(1),paddingRight:e.spacing(1)},[`&.${pf.labelCell}`]:{whiteSpace:"nowrap",fontWeight:e.typography.fontWeightRegular},[`&.${pf.valueCell}, &.${pf.axisValueCell}`]:{color:(e.vars||e).palette.text.primary,fontWeight:e.typography.fontWeightMedium},[`&.${pf.valueCell}`]:{paddingLeft:e.spacing(1.5),paddingRight:e.spacing(1.5)},"td:first-of-type&, th:first-of-type&":{paddingLeft:e.spacing(1.5)},"td:last-of-type&, th:last-of-type&":{paddingRight:e.spacing(1.5)}}));function Cbe(e){return Kn("MuiChartsLabelMark",e)}const nf=An("MuiChartsLabelMark",["root","line","square","circle","mask","fill"]),Sbe=e=>{const{type:t}=e;return Qn({root:typeof t=="function"?["root"]:["root",t],mask:["mask"],fill:["fill"]},Cbe,e.classes)},vV=(e,t,n)=>f.forwardRef(function(r,i){const o=Ti({props:r,name:e}),l=typeof t.defaultProps=="function"?t.defaultProps(o):t.defaultProps??{},c=Fu(l,o),u=Yo(),d=t.classesResolver?.(c,u),h=f.forwardRef(n);return a.jsx(h,Ze({},c,{classes:d,ref:i}))}),_be=["type","color","className","classes"],Abe=fa("div",{name:"MuiChartsLabelMark",slot:"Root"})(()=>({display:"flex",width:14,height:14,[`&.${nf.line}`]:{width:16,height:"unset",alignItems:"center",[`.${nf.mask}`]:{height:4,width:"100%",borderRadius:1,overflow:"hidden"}},[`&.${nf.square}`]:{height:13,width:13,borderRadius:2,overflow:"hidden"},[`&.${nf.circle}`]:{height:15,width:15},svg:{display:"block"},[`& .${nf.mask} > *`]:{height:"100%",width:"100%"},[`& .${nf.mask}`]:{height:"100%",width:"100%"}})),nw=vV("MuiChartsLabelMark",{defaultProps:{type:"square"},classesResolver:Sbe},function(t,n){const{type:s,color:r,className:i,classes:o}=t,l=ya(t,_be),c=s;return a.jsx(Abe,Ze({className:Rt(o?.root,i),ownerState:t,"aria-hidden":"true",ref:n},l,{children:a.jsx("div",{className:o?.mask,children:typeof c=="function"?a.jsx(c,{className:o?.fill,color:r}):a.jsx("svg",{viewBox:"0 0 24 24",preserveAspectRatio:s==="line"?"none":void 0,children:s==="circle"?a.jsx("circle",{className:o?.fill,r:"12",cx:"12",cy:"12",fill:r}):a.jsx("rect",{className:o?.fill,width:"24",height:"24",fill:r})})})}))});function Tbe(e){const{classes:t,sx:n}=e,s=Nbe(),r=_N(t);if(!s)return null;if("values"in s){const{label:u,color:d,markType:h}=s;return a.jsx(qk,{sx:n,className:r.paper,children:a.jsxs(Gk,{className:r.table,children:[a.jsxs(sD,{component:"caption",children:[a.jsx("div",{className:r.markContainer,children:a.jsx(nw,{type:h,color:d,className:r.mark})}),u]}),a.jsx("tbody",{children:s.values.map(({formattedValue:p,label:x})=>a.jsxs(Wk,{className:r.row,children:[a.jsx(yf,{className:Rt(r.labelCell,r.cell),component:"th",children:x}),a.jsx(yf,{className:Rt(r.valueCell,r.cell),component:"td",children:p})]},x))})]})})}const{color:i,label:o,formattedValue:l,markType:c}=s;return a.jsx(qk,{sx:n,className:r.paper,children:a.jsx(Gk,{className:r.table,children:a.jsx("tbody",{children:a.jsxs(Wk,{className:r.row,children:[a.jsxs(yf,{className:Rt(r.labelCell,r.cell),component:"th",children:[a.jsx("div",{className:r.markContainer,children:a.jsx(nw,{type:c,color:i,className:r.mark})}),o]}),a.jsx(yf,{className:Rt(r.valueCell,r.cell),component:"td",children:l})]})})})})}function kbe(e){const t=Ka(),n=Vt(t,Vr);return f.useMemo(()=>{const r={};return Object.keys(n).forEach(i=>{r[i]=n[i].colorProcessor}),r},[n])}const Ebe=Y9({themeId:zj});function Lbe(){const e=V4(),[t,n]=f.useState(null);return f.useEffect(()=>{const s=e.current;if(s===null)return()=>{};const r=o=>{o.pointerType!=="mouse"&&n(null)},i=o=>{n({pointerType:o.pointerType})};return s.addEventListener("pointerenter",i),s.addEventListener("pointerup",r),()=>{s.removeEventListener("pointerenter",i),s.removeEventListener("pointerup",r)}},[e]),t}function Dbe(e){return e instanceof Date?e.toUTCString():e.toLocaleString()}const Pbe="@media (pointer: fine)",Obe=()=>Ebe(Pbe,{defaultMatches:!0}),wV=(e,t)=>t,jV=(e,t)=>t;function NV(e,t,n){return Array.isArray(n)?n.map(s=>G6(t.axis[s],e)):G6(t.axis[n],e)}const CV=Lt(Ex,Lx,wxe,(e,t,n)=>e===null||t===null?null:jxe(n)(e,t)),Mbe=Lt(CV,cm,wV,(e,t,n=t.axisIds[0])=>e===null?null:NV(e,t,n)),SV=Lt(CV,cm,jV,(e,t,n=t.axisIds)=>e===null?null:NV(e,t,n));Lt(cm,Mbe,wV,(e,t,n=e.axisIds[0])=>{if(t===null||t===-1||e.axisIds.length===0)return null;const s=e.axis[n]?.data;return s?s[t]:null});Lt(cm,SV,jV,(e,t,n=e.axisIds)=>t===null?null:n.map((s,r)=>{const i=t[r];return i===-1?null:e.axis[s].data?.[i]}));const _V=Uj({memoizeOptions:{resultEqualityCheck:Sf}})(SV,cm,(e,t)=>e===null?[]:t.axisIds.map((n,s)=>({axisId:n,dataIndex:e[s]})).filter(({axisId:n,dataIndex:s})=>t.axis[n].triggerTooltip&&s>=0)),Ibe=Lt(_V,e=>e.length>0);function $2(e,t,n){const s=e.data?.[t]??null,i=(e.valueFormatter??(o=>e.scaleType==="utc"?Dbe(o):o.toLocaleString()))(s,{location:"tooltip",scale:e.scale});return{axisDirection:n,axisId:e.id,mainAxis:e,dataIndex:t,axisValue:s,axisFormattedValue:i,seriesItems:[]}}function $be(e={}){const{multipleAxes:t,directions:n}=e,s=Cxe(),r=Sxe(),i=_xe(),o=Ka(),l=Vt(o,RG),c=Vt(o,zG),u=Vt(o,_V),d=bN(),{xAxis:h}=jr(),{yAxis:p}=Nr(),{zAxis:x,zAxisIds:b}=W4(),{rotationAxis:j}=MW(),y=kbe();if(l.length===0&&c.length===0&&u.length===0)return null;const N=[];return(n===void 0||n.includes("x"))&&l.forEach(({axisId:w,dataIndex:S})=>{!t&&N.length>1||N.push($2(h[w],S,"x"))}),(n===void 0||n.includes("y"))&&c.forEach(({axisId:w,dataIndex:S})=>{!t&&N.length>1||N.push($2(p[w],S,"y"))}),(n===void 0||n.includes("rotation"))&&u.forEach(({axisId:w,dataIndex:S})=>{!t&&N.length>1||N.push($2(j[w],S,"rotation"))}),Object.keys(d).filter(iN).forEach(w=>{const S=d[w];return S?S.seriesOrder.forEach(_=>{const T=S.series[_],k=T.xAxisId??s.id,A=T.yAxisId??r.id,E=N.findIndex(({axisDirection:M,axisId:F})=>M==="x"&&F===k||M==="y"&&F===A);if(E>=0){const M="zAxisId"in T?T.zAxisId:b[0],{dataIndex:F}=N[E],D=y[w]?.(T,h[k],p[A],M?x[M]:void 0)(F)??"",P=T.data[F]??null,B=T.valueFormatter(P,{dataIndex:F}),G=Xi(T.label,"tooltip")??null;N[E].seriesItems.push({seriesId:_,color:D,value:P,formattedValue:B,formattedLabel:G,markType:T.labelMarkType})}}):[]}),Object.keys(d).filter(G4).forEach(w=>{const S=d[w];return S?S.seriesOrder.forEach(_=>{const T=S.series[_],k=T.rotationAxisId??i?.id,A=N.findIndex(({axisDirection:E,axisId:M})=>E==="rotation"&&M===k);if(A>=0){const{dataIndex:E}=N[A],M=y[w]?.(T)(E)??"",F=T.data[E]??null,D=T.valueFormatter(F,{dataIndex:E}),P=Xi(T.label,"tooltip")??null;N[A].seriesItems.push({seriesId:_,color:M,value:F,formattedValue:D,formattedLabel:P,markType:T.labelMarkType})}}):[]}),t?N:N.length===0?N[0]:null}function Rbe(e){return $be(Ze({},e,{multipleAxes:!0}))}function zbe(e){const t=_N(e.classes),n=Rbe();return n===null?null:a.jsx(qk,{sx:e.sx,className:t.paper,children:n.map(({axisId:s,mainAxis:r,axisValue:i,axisFormattedValue:o,seriesItems:l})=>a.jsxs(Gk,{className:t.table,children:[i!=null&&!r.hideTooltip&&a.jsx(sD,{component:"caption",children:o}),a.jsx("tbody",{children:l.map(({seriesId:c,color:u,formattedValue:d,formattedLabel:h,markType:p})=>d==null?null:a.jsxs(Wk,{className:t.row,children:[a.jsxs(yf,{className:Rt(t.labelCell,t.cell),component:"th",children:[a.jsx("div",{className:t.markContainer,children:a.jsx(nw,{type:p,color:u,className:t.mark})}),h||null]}),a.jsx(yf,{className:Rt(t.valueCell,t.cell),component:"td",children:d})]},c))})]},s))})}var xr="top",vi="bottom",wi="right",yr="left",rD="auto",zx=[xr,vi,wi,yr],Ff="start",Mp="end",Fbe="clippingParents",AV="viewport",Ag="popper",Ube="reference",eR=zx.reduce(function(e,t){return e.concat([t+"-"+Ff,t+"-"+Mp])},[]),TV=[].concat(zx,[rD]).reduce(function(e,t){return e.concat([t,t+"-"+Ff,t+"-"+Mp])},[]),Bbe="beforeRead",Hbe="read",qbe="afterRead",Gbe="beforeMain",Wbe="main",Vbe="afterMain",Ybe="beforeWrite",Qbe="write",Kbe="afterWrite",Xbe=[Bbe,Hbe,qbe,Gbe,Wbe,Vbe,Ybe,Qbe,Kbe];function Bo(e){return e?(e.nodeName||"").toLowerCase():null}function Hr(e){if(e==null)return window;if(e.toString()!=="[object Window]"){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function qu(e){var t=Hr(e).Element;return e instanceof t||e instanceof Element}function yi(e){var t=Hr(e).HTMLElement;return e instanceof t||e instanceof HTMLElement}function iD(e){if(typeof ShadowRoot>"u")return!1;var t=Hr(e).ShadowRoot;return e instanceof t||e instanceof ShadowRoot}function Zbe(e){var t=e.state;Object.keys(t.elements).forEach(function(n){var s=t.styles[n]||{},r=t.attributes[n]||{},i=t.elements[n];!yi(i)||!Bo(i)||(Object.assign(i.style,s),Object.keys(r).forEach(function(o){var l=r[o];l===!1?i.removeAttribute(o):i.setAttribute(o,l===!0?"":l)}))})}function Jbe(e){var t=e.state,n={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,n.popper),t.styles=n,t.elements.arrow&&Object.assign(t.elements.arrow.style,n.arrow),function(){Object.keys(t.elements).forEach(function(s){var r=t.elements[s],i=t.attributes[s]||{},o=Object.keys(t.styles.hasOwnProperty(s)?t.styles[s]:n[s]),l=o.reduce(function(c,u){return c[u]="",c},{});!yi(r)||!Bo(r)||(Object.assign(r.style,l),Object.keys(i).forEach(function(c){r.removeAttribute(c)}))})}}const eve={name:"applyStyles",enabled:!0,phase:"write",fn:Zbe,effect:Jbe,requires:["computeStyles"]};function $o(e){return e.split("-")[0]}var Lu=Math.max,sw=Math.min,Uf=Math.round;function Vk(){var e=navigator.userAgentData;return e!=null&&e.brands&&Array.isArray(e.brands)?e.brands.map(function(t){return t.brand+"/"+t.version}).join(" "):navigator.userAgent}function kV(){return!/^((?!chrome|android).)*safari/i.test(Vk())}function Bf(e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!1);var s=e.getBoundingClientRect(),r=1,i=1;t&&yi(e)&&(r=e.offsetWidth>0&&Uf(s.width)/e.offsetWidth||1,i=e.offsetHeight>0&&Uf(s.height)/e.offsetHeight||1);var o=qu(e)?Hr(e):window,l=o.visualViewport,c=!kV()&&n,u=(s.left+(c&&l?l.offsetLeft:0))/r,d=(s.top+(c&&l?l.offsetTop:0))/i,h=s.width/r,p=s.height/i;return{width:h,height:p,top:d,right:u+h,bottom:d+p,left:u,x:u,y:d}}function oD(e){var t=Bf(e),n=e.offsetWidth,s=e.offsetHeight;return Math.abs(t.width-n)<=1&&(n=t.width),Math.abs(t.height-s)<=1&&(s=t.height),{x:e.offsetLeft,y:e.offsetTop,width:n,height:s}}function EV(e,t){var n=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(n&&iD(n)){var s=t;do{if(s&&e.isSameNode(s))return!0;s=s.parentNode||s.host}while(s)}return!1}function Vl(e){return Hr(e).getComputedStyle(e)}function tve(e){return["table","td","th"].indexOf(Bo(e))>=0}function kd(e){return((qu(e)?e.ownerDocument:e.document)||window.document).documentElement}function AN(e){return Bo(e)==="html"?e:e.assignedSlot||e.parentNode||(iD(e)?e.host:null)||kd(e)}function tR(e){return!yi(e)||Vl(e).position==="fixed"?null:e.offsetParent}function ave(e){var t=/firefox/i.test(Vk()),n=/Trident/i.test(Vk());if(n&&yi(e)){var s=Vl(e);if(s.position==="fixed")return null}var r=AN(e);for(iD(r)&&(r=r.host);yi(r)&&["html","body"].indexOf(Bo(r))<0;){var i=Vl(r);if(i.transform!=="none"||i.perspective!=="none"||i.contain==="paint"||["transform","perspective"].indexOf(i.willChange)!==-1||t&&i.willChange==="filter"||t&&i.filter&&i.filter!=="none")return r;r=r.parentNode}return null}function Fx(e){for(var t=Hr(e),n=tR(e);n&&tve(n)&&Vl(n).position==="static";)n=tR(n);return n&&(Bo(n)==="html"||Bo(n)==="body"&&Vl(n).position==="static")?t:n||ave(e)||t}function lD(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function ip(e,t,n){return Lu(e,sw(t,n))}function nve(e,t,n){var s=ip(e,t,n);return s>n?n:s}function LV(){return{top:0,right:0,bottom:0,left:0}}function DV(e){return Object.assign({},LV(),e)}function PV(e,t){return t.reduce(function(n,s){return n[s]=e,n},{})}var sve=function(t,n){return t=typeof t=="function"?t(Object.assign({},n.rects,{placement:n.placement})):t,DV(typeof t!="number"?t:PV(t,zx))};function rve(e){var t,n=e.state,s=e.name,r=e.options,i=n.elements.arrow,o=n.modifiersData.popperOffsets,l=$o(n.placement),c=lD(l),u=[yr,wi].indexOf(l)>=0,d=u?"height":"width";if(!(!i||!o)){var h=sve(r.padding,n),p=oD(i),x=c==="y"?xr:yr,b=c==="y"?vi:wi,j=n.rects.reference[d]+n.rects.reference[c]-o[c]-n.rects.popper[d],y=o[c]-n.rects.reference[c],N=Fx(i),w=N?c==="y"?N.clientHeight||0:N.clientWidth||0:0,S=j/2-y/2,_=h[x],T=w-p[d]-h[b],k=w/2-p[d]/2+S,A=ip(_,k,T),E=c;n.modifiersData[s]=(t={},t[E]=A,t.centerOffset=A-k,t)}}function ive(e){var t=e.state,n=e.options,s=n.element,r=s===void 0?"[data-popper-arrow]":s;r!=null&&(typeof r=="string"&&(r=t.elements.popper.querySelector(r),!r)||EV(t.elements.popper,r)&&(t.elements.arrow=r))}const ove={name:"arrow",enabled:!0,phase:"main",fn:rve,effect:ive,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Hf(e){return e.split("-")[1]}var lve={top:"auto",right:"auto",bottom:"auto",left:"auto"};function cve(e,t){var n=e.x,s=e.y,r=t.devicePixelRatio||1;return{x:Uf(n*r)/r||0,y:Uf(s*r)/r||0}}function aR(e){var t,n=e.popper,s=e.popperRect,r=e.placement,i=e.variation,o=e.offsets,l=e.position,c=e.gpuAcceleration,u=e.adaptive,d=e.roundOffsets,h=e.isFixed,p=o.x,x=p===void 0?0:p,b=o.y,j=b===void 0?0:b,y=typeof d=="function"?d({x,y:j}):{x,y:j};x=y.x,j=y.y;var N=o.hasOwnProperty("x"),w=o.hasOwnProperty("y"),S=yr,_=xr,T=window;if(u){var k=Fx(n),A="clientHeight",E="clientWidth";if(k===Hr(n)&&(k=kd(n),Vl(k).position!=="static"&&l==="absolute"&&(A="scrollHeight",E="scrollWidth")),k=k,r===xr||(r===yr||r===wi)&&i===Mp){_=vi;var M=h&&k===T&&T.visualViewport?T.visualViewport.height:k[A];j-=M-s.height,j*=c?1:-1}if(r===yr||(r===xr||r===vi)&&i===Mp){S=wi;var F=h&&k===T&&T.visualViewport?T.visualViewport.width:k[E];x-=F-s.width,x*=c?1:-1}}var D=Object.assign({position:l},u&&lve),P=d===!0?cve({x,y:j},Hr(n)):{x,y:j};if(x=P.x,j=P.y,c){var B;return Object.assign({},D,(B={},B[_]=w?"0":"",B[S]=N?"0":"",B.transform=(T.devicePixelRatio||1)<=1?"translate("+x+"px, "+j+"px)":"translate3d("+x+"px, "+j+"px, 0)",B))}return Object.assign({},D,(t={},t[_]=w?j+"px":"",t[S]=N?x+"px":"",t.transform="",t))}function dve(e){var t=e.state,n=e.options,s=n.gpuAcceleration,r=s===void 0?!0:s,i=n.adaptive,o=i===void 0?!0:i,l=n.roundOffsets,c=l===void 0?!0:l,u={placement:$o(t.placement),variation:Hf(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:r,isFixed:t.options.strategy==="fixed"};t.modifiersData.popperOffsets!=null&&(t.styles.popper=Object.assign({},t.styles.popper,aR(Object.assign({},u,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:o,roundOffsets:c})))),t.modifiersData.arrow!=null&&(t.styles.arrow=Object.assign({},t.styles.arrow,aR(Object.assign({},u,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:c})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})}const uve={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:dve,data:{}};var ab={passive:!0};function mve(e){var t=e.state,n=e.instance,s=e.options,r=s.scroll,i=r===void 0?!0:r,o=s.resize,l=o===void 0?!0:o,c=Hr(t.elements.popper),u=[].concat(t.scrollParents.reference,t.scrollParents.popper);return i&&u.forEach(function(d){d.addEventListener("scroll",n.update,ab)}),l&&c.addEventListener("resize",n.update,ab),function(){i&&u.forEach(function(d){d.removeEventListener("scroll",n.update,ab)}),l&&c.removeEventListener("resize",n.update,ab)}}const fve={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:mve,data:{}};var hve={left:"right",right:"left",bottom:"top",top:"bottom"};function xv(e){return e.replace(/left|right|bottom|top/g,function(t){return hve[t]})}var gve={start:"end",end:"start"};function nR(e){return e.replace(/start|end/g,function(t){return gve[t]})}function cD(e){var t=Hr(e),n=t.pageXOffset,s=t.pageYOffset;return{scrollLeft:n,scrollTop:s}}function dD(e){return Bf(kd(e)).left+cD(e).scrollLeft}function pve(e,t){var n=Hr(e),s=kd(e),r=n.visualViewport,i=s.clientWidth,o=s.clientHeight,l=0,c=0;if(r){i=r.width,o=r.height;var u=kV();(u||!u&&t==="fixed")&&(l=r.offsetLeft,c=r.offsetTop)}return{width:i,height:o,x:l+dD(e),y:c}}function xve(e){var t,n=kd(e),s=cD(e),r=(t=e.ownerDocument)==null?void 0:t.body,i=Lu(n.scrollWidth,n.clientWidth,r?r.scrollWidth:0,r?r.clientWidth:0),o=Lu(n.scrollHeight,n.clientHeight,r?r.scrollHeight:0,r?r.clientHeight:0),l=-s.scrollLeft+dD(e),c=-s.scrollTop;return Vl(r||n).direction==="rtl"&&(l+=Lu(n.clientWidth,r?r.clientWidth:0)-i),{width:i,height:o,x:l,y:c}}function uD(e){var t=Vl(e),n=t.overflow,s=t.overflowX,r=t.overflowY;return/auto|scroll|overlay|hidden/.test(n+r+s)}function OV(e){return["html","body","#document"].indexOf(Bo(e))>=0?e.ownerDocument.body:yi(e)&&uD(e)?e:OV(AN(e))}function op(e,t){var n;t===void 0&&(t=[]);var s=OV(e),r=s===((n=e.ownerDocument)==null?void 0:n.body),i=Hr(s),o=r?[i].concat(i.visualViewport||[],uD(s)?s:[]):s,l=t.concat(o);return r?l:l.concat(op(AN(o)))}function Yk(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function yve(e,t){var n=Bf(e,!1,t==="fixed");return n.top=n.top+e.clientTop,n.left=n.left+e.clientLeft,n.bottom=n.top+e.clientHeight,n.right=n.left+e.clientWidth,n.width=e.clientWidth,n.height=e.clientHeight,n.x=n.left,n.y=n.top,n}function sR(e,t,n){return t===AV?Yk(pve(e,n)):qu(t)?yve(t,n):Yk(xve(kd(e)))}function bve(e){var t=op(AN(e)),n=["absolute","fixed"].indexOf(Vl(e).position)>=0,s=n&&yi(e)?Fx(e):e;return qu(s)?t.filter(function(r){return qu(r)&&EV(r,s)&&Bo(r)!=="body"}):[]}function vve(e,t,n,s){var r=t==="clippingParents"?bve(e):[].concat(t),i=[].concat(r,[n]),o=i[0],l=i.reduce(function(c,u){var d=sR(e,u,s);return c.top=Lu(d.top,c.top),c.right=sw(d.right,c.right),c.bottom=sw(d.bottom,c.bottom),c.left=Lu(d.left,c.left),c},sR(e,o,s));return l.width=l.right-l.left,l.height=l.bottom-l.top,l.x=l.left,l.y=l.top,l}function MV(e){var t=e.reference,n=e.element,s=e.placement,r=s?$o(s):null,i=s?Hf(s):null,o=t.x+t.width/2-n.width/2,l=t.y+t.height/2-n.height/2,c;switch(r){case xr:c={x:o,y:t.y-n.height};break;case vi:c={x:o,y:t.y+t.height};break;case wi:c={x:t.x+t.width,y:l};break;case yr:c={x:t.x-n.width,y:l};break;default:c={x:t.x,y:t.y}}var u=r?lD(r):null;if(u!=null){var d=u==="y"?"height":"width";switch(i){case Ff:c[u]=c[u]-(t[d]/2-n[d]/2);break;case Mp:c[u]=c[u]+(t[d]/2-n[d]/2);break}}return c}function Ip(e,t){t===void 0&&(t={});var n=t,s=n.placement,r=s===void 0?e.placement:s,i=n.strategy,o=i===void 0?e.strategy:i,l=n.boundary,c=l===void 0?Fbe:l,u=n.rootBoundary,d=u===void 0?AV:u,h=n.elementContext,p=h===void 0?Ag:h,x=n.altBoundary,b=x===void 0?!1:x,j=n.padding,y=j===void 0?0:j,N=DV(typeof y!="number"?y:PV(y,zx)),w=p===Ag?Ube:Ag,S=e.rects.popper,_=e.elements[b?w:p],T=vve(qu(_)?_:_.contextElement||kd(e.elements.popper),c,d,o),k=Bf(e.elements.reference),A=MV({reference:k,element:S,placement:r}),E=Yk(Object.assign({},S,A)),M=p===Ag?E:k,F={top:T.top-M.top+N.top,bottom:M.bottom-T.bottom+N.bottom,left:T.left-M.left+N.left,right:M.right-T.right+N.right},D=e.modifiersData.offset;if(p===Ag&&D){var P=D[r];Object.keys(F).forEach(function(B){var G=[wi,vi].indexOf(B)>=0?1:-1,$=[xr,vi].indexOf(B)>=0?"y":"x";F[B]+=P[$]*G})}return F}function wve(e,t){t===void 0&&(t={});var n=t,s=n.placement,r=n.boundary,i=n.rootBoundary,o=n.padding,l=n.flipVariations,c=n.allowedAutoPlacements,u=c===void 0?TV:c,d=Hf(s),h=d?l?eR:eR.filter(function(b){return Hf(b)===d}):zx,p=h.filter(function(b){return u.indexOf(b)>=0});p.length===0&&(p=h);var x=p.reduce(function(b,j){return b[j]=Ip(e,{placement:j,boundary:r,rootBoundary:i,padding:o})[$o(j)],b},{});return Object.keys(x).sort(function(b,j){return x[b]-x[j]})}function jve(e){if($o(e)===rD)return[];var t=xv(e);return[nR(e),t,nR(t)]}function Nve(e){var t=e.state,n=e.options,s=e.name;if(!t.modifiersData[s]._skip){for(var r=n.mainAxis,i=r===void 0?!0:r,o=n.altAxis,l=o===void 0?!0:o,c=n.fallbackPlacements,u=n.padding,d=n.boundary,h=n.rootBoundary,p=n.altBoundary,x=n.flipVariations,b=x===void 0?!0:x,j=n.allowedAutoPlacements,y=t.options.placement,N=$o(y),w=N===y,S=c||(w||!b?[xv(y)]:jve(y)),_=[y].concat(S).reduce(function(Ce,ge){return Ce.concat($o(ge)===rD?wve(t,{placement:ge,boundary:d,rootBoundary:h,padding:u,flipVariations:b,allowedAutoPlacements:j}):ge)},[]),T=t.rects.reference,k=t.rects.popper,A=new Map,E=!0,M=_[0],F=0;F<_.length;F++){var D=_[F],P=$o(D),B=Hf(D)===Ff,G=[xr,vi].indexOf(P)>=0,$=G?"width":"height",W=Ip(t,{placement:D,boundary:d,rootBoundary:h,altBoundary:p,padding:u}),Z=G?B?wi:yr:B?vi:xr;T[$]>k[$]&&(Z=xv(Z));var Q=xv(Z),le=[];if(i&&le.push(W[P]<=0),l&&le.push(W[Z]<=0,W[Q]<=0),le.every(function(Ce){return Ce})){M=D,E=!1;break}A.set(D,le)}if(E)for(var we=b?3:1,J=function(ge){var be=_.find(function(me){var Ae=A.get(me);if(Ae)return Ae.slice(0,ge).every(function(pe){return pe})});if(be)return M=be,"break"},se=we;se>0;se--){var ye=J(se);if(ye==="break")break}t.placement!==M&&(t.modifiersData[s]._skip=!0,t.placement=M,t.reset=!0)}}const Cve={name:"flip",enabled:!0,phase:"main",fn:Nve,requiresIfExists:["offset"],data:{_skip:!1}};function rR(e,t,n){return n===void 0&&(n={x:0,y:0}),{top:e.top-t.height-n.y,right:e.right-t.width+n.x,bottom:e.bottom-t.height+n.y,left:e.left-t.width-n.x}}function iR(e){return[xr,wi,vi,yr].some(function(t){return e[t]>=0})}function Sve(e){var t=e.state,n=e.name,s=t.rects.reference,r=t.rects.popper,i=t.modifiersData.preventOverflow,o=Ip(t,{elementContext:"reference"}),l=Ip(t,{altBoundary:!0}),c=rR(o,s),u=rR(l,r,i),d=iR(c),h=iR(u);t.modifiersData[n]={referenceClippingOffsets:c,popperEscapeOffsets:u,isReferenceHidden:d,hasPopperEscaped:h},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":d,"data-popper-escaped":h})}const _ve={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:Sve};function Ave(e,t,n){var s=$o(e),r=[yr,xr].indexOf(s)>=0?-1:1,i=typeof n=="function"?n(Object.assign({},t,{placement:e})):n,o=i[0],l=i[1];return o=o||0,l=(l||0)*r,[yr,wi].indexOf(s)>=0?{x:l,y:o}:{x:o,y:l}}function Tve(e){var t=e.state,n=e.options,s=e.name,r=n.offset,i=r===void 0?[0,0]:r,o=TV.reduce(function(d,h){return d[h]=Ave(h,t.rects,i),d},{}),l=o[t.placement],c=l.x,u=l.y;t.modifiersData.popperOffsets!=null&&(t.modifiersData.popperOffsets.x+=c,t.modifiersData.popperOffsets.y+=u),t.modifiersData[s]=o}const kve={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:Tve};function Eve(e){var t=e.state,n=e.name;t.modifiersData[n]=MV({reference:t.rects.reference,element:t.rects.popper,placement:t.placement})}const Lve={name:"popperOffsets",enabled:!0,phase:"read",fn:Eve,data:{}};function Dve(e){return e==="x"?"y":"x"}function Pve(e){var t=e.state,n=e.options,s=e.name,r=n.mainAxis,i=r===void 0?!0:r,o=n.altAxis,l=o===void 0?!1:o,c=n.boundary,u=n.rootBoundary,d=n.altBoundary,h=n.padding,p=n.tether,x=p===void 0?!0:p,b=n.tetherOffset,j=b===void 0?0:b,y=Ip(t,{boundary:c,rootBoundary:u,padding:h,altBoundary:d}),N=$o(t.placement),w=Hf(t.placement),S=!w,_=lD(N),T=Dve(_),k=t.modifiersData.popperOffsets,A=t.rects.reference,E=t.rects.popper,M=typeof j=="function"?j(Object.assign({},t.rects,{placement:t.placement})):j,F=typeof M=="number"?{mainAxis:M,altAxis:M}:Object.assign({mainAxis:0,altAxis:0},M),D=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,P={x:0,y:0};if(k){if(i){var B,G=_==="y"?xr:yr,$=_==="y"?vi:wi,W=_==="y"?"height":"width",Z=k[_],Q=Z+y[G],le=Z-y[$],we=x?-E[W]/2:0,J=w===Ff?A[W]:E[W],se=w===Ff?-E[W]:-A[W],ye=t.elements.arrow,Ce=x&&ye?oD(ye):{width:0,height:0},ge=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:LV(),be=ge[G],me=ge[$],Ae=ip(0,A[W],Ce[W]),pe=S?A[W]/2-we-Ae-be-F.mainAxis:J-Ae-be-F.mainAxis,Ie=S?-A[W]/2+we+Ae+me+F.mainAxis:se+Ae+me+F.mainAxis,xe=t.elements.arrow&&Fx(t.elements.arrow),he=xe?_==="y"?xe.clientTop||0:xe.clientLeft||0:0,Re=(B=D?.[_])!=null?B:0,Ee=Z+pe-Re-he,He=Z+Ie-Re,Ke=ip(x?sw(Q,Ee):Q,Z,x?Lu(le,He):le);k[_]=Ke,P[_]=Ke-Z}if(l){var st,it=_==="x"?xr:yr,ot=_==="x"?vi:wi,rt=k[T],at=T==="y"?"height":"width",Je=rt+y[it],Fe=rt-y[ot],Ue=[xr,yr].indexOf(N)!==-1,Ne=(st=D?.[T])!=null?st:0,ze=Ue?Je:rt-A[at]-E[at]-Ne+F.altAxis,je=Ue?rt+A[at]+E[at]-Ne-F.altAxis:Fe,ve=x&&Ue?nve(ze,rt,je):ip(x?ze:Je,rt,x?je:Fe);k[T]=ve,P[T]=ve-rt}t.modifiersData[s]=P}}const Ove={name:"preventOverflow",enabled:!0,phase:"main",fn:Pve,requiresIfExists:["offset"]};function Mve(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}function Ive(e){return e===Hr(e)||!yi(e)?cD(e):Mve(e)}function $ve(e){var t=e.getBoundingClientRect(),n=Uf(t.width)/e.offsetWidth||1,s=Uf(t.height)/e.offsetHeight||1;return n!==1||s!==1}function Rve(e,t,n){n===void 0&&(n=!1);var s=yi(t),r=yi(t)&&$ve(t),i=kd(t),o=Bf(e,r,n),l={scrollLeft:0,scrollTop:0},c={x:0,y:0};return(s||!s&&!n)&&((Bo(t)!=="body"||uD(i))&&(l=Ive(t)),yi(t)?(c=Bf(t,!0),c.x+=t.clientLeft,c.y+=t.clientTop):i&&(c.x=dD(i))),{x:o.left+l.scrollLeft-c.x,y:o.top+l.scrollTop-c.y,width:o.width,height:o.height}}function zve(e){var t=new Map,n=new Set,s=[];e.forEach(function(i){t.set(i.name,i)});function r(i){n.add(i.name);var o=[].concat(i.requires||[],i.requiresIfExists||[]);o.forEach(function(l){if(!n.has(l)){var c=t.get(l);c&&r(c)}}),s.push(i)}return e.forEach(function(i){n.has(i.name)||r(i)}),s}function Fve(e){var t=zve(e);return Xbe.reduce(function(n,s){return n.concat(t.filter(function(r){return r.phase===s}))},[])}function Uve(e){var t;return function(){return t||(t=new Promise(function(n){Promise.resolve().then(function(){t=void 0,n(e())})})),t}}function Bve(e){var t=e.reduce(function(n,s){var r=n[s.name];return n[s.name]=r?Object.assign({},r,s,{options:Object.assign({},r.options,s.options),data:Object.assign({},r.data,s.data)}):s,n},{});return Object.keys(t).map(function(n){return t[n]})}var oR={placement:"bottom",modifiers:[],strategy:"absolute"};function lR(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return!t.some(function(s){return!(s&&typeof s.getBoundingClientRect=="function")})}function Hve(e){e===void 0&&(e={});var t=e,n=t.defaultModifiers,s=n===void 0?[]:n,r=t.defaultOptions,i=r===void 0?oR:r;return function(l,c,u){u===void 0&&(u=i);var d={placement:"bottom",orderedModifiers:[],options:Object.assign({},oR,i),modifiersData:{},elements:{reference:l,popper:c},attributes:{},styles:{}},h=[],p=!1,x={state:d,setOptions:function(N){var w=typeof N=="function"?N(d.options):N;j(),d.options=Object.assign({},i,d.options,w),d.scrollParents={reference:qu(l)?op(l):l.contextElement?op(l.contextElement):[],popper:op(c)};var S=Fve(Bve([].concat(s,d.options.modifiers)));return d.orderedModifiers=S.filter(function(_){return _.enabled}),b(),x.update()},forceUpdate:function(){if(!p){var N=d.elements,w=N.reference,S=N.popper;if(lR(w,S)){d.rects={reference:Rve(w,Fx(S),d.options.strategy==="fixed"),popper:oD(S)},d.reset=!1,d.placement=d.options.placement,d.orderedModifiers.forEach(function(F){return d.modifiersData[F.name]=Object.assign({},F.data)});for(var _=0;_<d.orderedModifiers.length;_++){if(d.reset===!0){d.reset=!1,_=-1;continue}var T=d.orderedModifiers[_],k=T.fn,A=T.options,E=A===void 0?{}:A,M=T.name;typeof k=="function"&&(d=k({state:d,options:E,name:M,instance:x})||d)}}}},update:Uve(function(){return new Promise(function(y){x.forceUpdate(),y(d)})}),destroy:function(){j(),p=!0}};if(!lR(l,c))return x;x.setOptions(u).then(function(y){!p&&u.onFirstUpdate&&u.onFirstUpdate(y)});function b(){d.orderedModifiers.forEach(function(y){var N=y.name,w=y.options,S=w===void 0?{}:w,_=y.effect;if(typeof _=="function"){var T=_({state:d,name:N,instance:x,options:S}),k=function(){};h.push(T||k)}})}function j(){h.forEach(function(y){return y()}),h=[]}return x}}var qve=[fve,Lve,uve,eve,kve,Cve,Ove,ove,_ve],Gve=Hve({defaultModifiers:qve});function cR(e,t){typeof e=="function"?e(t):e&&(e.current=t)}function Wve(e){return typeof e=="function"?e():e}const Vve=f.forwardRef(function(t,n){const{children:s,container:r,disablePortal:i=!1}=t,[o,l]=f.useState(null),c=Uo(f.isValidElement(s)?lq(s):null,n);if(ls(()=>{i||l(Wve(r)||document.body)},[r,i]),ls(()=>{if(o&&!i)return cR(n,o),()=>{cR(n,null)}},[n,o,i]),i){if(f.isValidElement(s)){const u={ref:c};return f.cloneElement(s,u)}return s}return o&&Gi.createPortal(s,o)});function Yve(e){return Kn("MuiPopper",e)}An("MuiPopper",["root"]);function Qve(e,t){if(t==="ltr")return e;switch(e){case"bottom-end":return"bottom-start";case"bottom-start":return"bottom-end";case"top-end":return"top-start";case"top-start":return"top-end";default:return e}}function Qk(e){return typeof e=="function"?e():e}function Kve(e){return e.nodeType!==void 0}const Xve=e=>{const{classes:t}=e;return Qn({root:["root"]},Yve,t)},Zve={},Jve=f.forwardRef(function(t,n){const{anchorEl:s,children:r,direction:i,disablePortal:o,modifiers:l,open:c,placement:u,popperOptions:d,popperRef:h,slotProps:p={},slots:x={},TransitionProps:b,ownerState:j,...y}=t,N=f.useRef(null),w=Uo(N,n),S=f.useRef(null),_=Uo(S,h),T=f.useRef(_);ls(()=>{T.current=_},[_]),f.useImperativeHandle(h,()=>S.current,[]);const k=Qve(u,i),[A,E]=f.useState(k),[M,F]=f.useState(Qk(s));f.useEffect(()=>{S.current&&S.current.forceUpdate()}),f.useEffect(()=>{s&&F(Qk(s))},[s]),ls(()=>{if(!M||!c)return;const $=Q=>{E(Q.placement)};let W=[{name:"preventOverflow",options:{altBoundary:o}},{name:"flip",options:{altBoundary:o}},{name:"onUpdate",enabled:!0,phase:"afterWrite",fn:({state:Q})=>{$(Q)}}];l!=null&&(W=W.concat(l)),d&&d.modifiers!=null&&(W=W.concat(d.modifiers));const Z=Gve(M,N.current,{placement:k,...d,modifiers:W});return T.current(Z),()=>{Z.destroy(),T.current(null)}},[M,o,l,c,d,k]);const D={placement:A};b!==null&&(D.TransitionProps=b);const P=Xve(t),B=x.root??"div",G=Bl({elementType:B,externalSlotProps:p.root,externalForwardedProps:y,additionalProps:{role:"tooltip",ref:w},ownerState:t,className:P.root});return a.jsx(B,{...G,children:typeof r=="function"?r(D):r})}),ewe=f.forwardRef(function(t,n){const{anchorEl:s,children:r,container:i,direction:o="ltr",disablePortal:l=!1,keepMounted:c=!1,modifiers:u,open:d,placement:h="bottom",popperOptions:p=Zve,popperRef:x,style:b,transition:j=!1,slotProps:y={},slots:N={},...w}=t,[S,_]=f.useState(!0),T=()=>{_(!1)},k=()=>{_(!0)};if(!c&&!d&&(!j||S))return null;let A;if(i)A=i;else if(s){const F=Qk(s);A=F&&Kve(F)?wk(F).body:wk(null).body}const E=!d&&c&&(!j||S)?"none":void 0,M=j?{in:d,onEnter:T,onExited:k}:void 0;return a.jsx(Vve,{disablePortal:l,container:A,children:a.jsx(Jve,{anchorEl:s,direction:o,disablePortal:l,modifiers:u,ref:n,open:j?!S:d,placement:h,popperOptions:p,popperRef:x,slotProps:y,slots:N,...w,style:{position:"fixed",top:0,left:0,display:E,...b},TransitionProps:M,children:r})})}),twe=fa(ewe,{name:"MuiPopper",slot:"Root"})({}),awe=f.forwardRef(function(t,n){const s=wx(),r=Cd({props:t,name:"MuiPopper"}),{anchorEl:i,component:o,components:l,componentsProps:c,container:u,disablePortal:d,keepMounted:h,modifiers:p,open:x,placement:b,popperOptions:j,popperRef:y,transition:N,slots:w,slotProps:S,..._}=r,T=w?.root??l?.Root,k={anchorEl:i,container:u,disablePortal:d,keepMounted:h,modifiers:p,open:x,placement:b,popperOptions:j,popperRef:y,transition:N,..._};return a.jsx(twe,{as:o,direction:s?"rtl":"ltr",slots:{root:T},slotProps:S??c,...k,ref:n})});function nwe(e){const{children:t,defer:n=!1,fallback:s=null}=e,[r,i]=f.useState(!1);return ls(()=>{n||i(!0)},[n]),f.useEffect(()=>{n&&i(!0)},[n]),r?t:s}function dR(e){let t,n;const s=()=>{n=null,e(...t)};function r(...i){t=i,n||(n=requestAnimationFrame(s))}return r.clear=()=>{n&&(cancelAnimationFrame(n),n=null)},r}function swe(){const e=Ka(),t=Vt(e,OW),n=Vt(e,Qo);return t!==void 0?"polar":n!==void 0?"cartesian":"none"}const rwe=["trigger","position","anchor","classes","children"],uR=()=>!1;function iwe(e,t,n){return n?uR:e==="item"?ype:t==="polar"?Ibe:t==="cartesian"?Npe:uR}const owe=fa(awe,{name:"MuiChartsTooltip",slot:"Root"})(({theme:e})=>({pointerEvents:"none",zIndex:e.zIndex.modal}));function lwe(e){const t=Ti({props:e,name:"MuiChartsTooltipContainer"}),{trigger:n="axis",position:s,anchor:r="pointer",classes:i,children:o}=t,l=ya(t,rwe),c=V4(),u=_N(i),d=Lbe(),h=Obe(),p=f.useRef(null),x=Bj(()=>({x:0,y:0})),b=swe(),j=Ka(),y=Vt(j,Lpe),N=Vt(j,iwe(n,b,y)),S=Vt(j,Dx)==="keyboard"?"node":r,_=Vt(j,n==="item"&&S==="node"?bpe:()=>null,s);f.useEffect(()=>{const M=c.current;if(M===null)return()=>{};if(_!==null){const P=dR(()=>{x.current={x:M.getBoundingClientRect().left+(_?.x??0),y:M.getBoundingClientRect().top+(_?.y??0)},p.current?.update()});return P(),()=>P.clear()}const F=dR((P,B)=>{x.current={x:P,y:B},p.current?.update()}),D=P=>{F(P.clientX,P.clientY)};return M.addEventListener("pointerdown",D),M.addEventListener("pointermove",D),M.addEventListener("pointerenter",D),()=>{M.removeEventListener("pointerdown",D),M.removeEventListener("pointermove",D),M.removeEventListener("pointerenter",D),F.clear()}},[c,x,_]);const T=f.useMemo(()=>({getBoundingClientRect:()=>({x:x.current.x,y:x.current.y,top:x.current.y,left:x.current.x,right:x.current.x,bottom:x.current.y,width:0,height:0,toJSON:()=>""})}),[x]),k=d?.pointerType==="mouse"||h,A=d?.pointerType==="touch"||!h,E=f.useMemo(()=>[{name:"offset",options:{offset:()=>A?[0,64]:[0,8]}},...k?[]:[{name:"flip",options:{fallbackPlacements:["top-end","top-start","bottom-end","bottom"]}}],{name:"preventOverflow",options:{altAxis:!0}}],[k,A]);return n==="none"?null:a.jsx(nwe,{children:N&&a.jsx(owe,Ze({},l,{className:u?.root,open:N,placement:l.placement??s??(k?"right-start":"top"),popperRef:p,anchorEl:T,modifiers:E,children:o}))})}function cwe(e){const{classes:t,trigger:n="axis"}=e,s=_N(t);return a.jsx(lwe,Ze({},e,{classes:t,children:n==="axis"?a.jsx(zbe,{classes:s}):a.jsx(Tbe,{classes:s})}))}const dwe=e=>({type:"series",color:e.color,label:e.label,seriesId:e.seriesId,itemId:e.itemId});function uwe(e){return Kn("MuiChartsLegend",e)}const mwe=e=>{const{classes:t,direction:n}=e;return Qn({root:["root",n],item:["item"],mark:["mark"],label:["label"],series:["series"]},uwe,t)},mR=An("MuiChartsLegend",["root","item","series","mark","label","vertical","horizontal"]),fwe=["slots","slotProps"],hwe=["ownerState"],gwe=(e,t,n,s)=>{function r(i,o){const l=Ti({props:i,name:e}),c=typeof n.defaultProps=="function"?n.defaultProps(l):n.defaultProps??{},u=Fu(c,l),d=u,{slots:h,slotProps:p}=d,x=ya(d,fwe),b=Yo(),j=n.classesResolver?.(u,b),y=h?.[t]??s,N=n.propagateSlots&&!h?.[t],w=Bl({elementType:y,externalSlotProps:p?.[t],additionalProps:Ze({},x,{classes:j},N&&{slots:h,slotProps:p}),ownerState:{}}),S=ya(w,hwe),_=Ze({},S);for(const T of n.omitProps??[])delete _[T];return a.jsx(y,Ze({},_,{ref:o}))}return f.forwardRef(r)};function pwe(e){return Kn("MuiChartsLabel",e)}An("MuiChartsLabel",["root"]);const xwe=e=>Qn({root:["root"]},pwe,e.classes),ywe=["children","className","classes"],bwe=vV("MuiChartsLabel",{classesResolver:xwe},function(t,n){const{children:s,className:r,classes:i}=t,o=ya(t,ywe);return a.jsx("span",Ze({className:Rt(i?.root,r),ref:n},o,{children:s}))}),vwe=["direction","onItemClick","className","classes"],wwe=fa("ul",{name:"MuiChartsLegend",slot:"Root"})(({ownerState:e,theme:t})=>Ze({},t.typography.caption,{color:(t.vars||t).palette.text.primary,lineHeight:"100%",display:"flex",flexDirection:e.direction==="vertical"?"column":"row",alignItems:e.direction==="vertical"?void 0:"center",flexShrink:0,gap:t.spacing(2),listStyleType:"none",paddingInlineStart:0,marginBlock:t.spacing(1),marginInline:t.spacing(1),flexWrap:"wrap",li:{display:e.direction==="horizontal"?"inline-flex":void 0},[`button.${mR.series}`]:{background:"none",border:"none",padding:0,fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",letterSpacing:"inherit",color:"inherit"},[`& .${mR.series}`]:{display:e.direction==="vertical"?"flex":"inline-flex",alignItems:"center",gap:t.spacing(1)},gridArea:"legend"})),jwe=gwe("MuiChartsLegend","legend",{defaultProps:{direction:"horizontal"},omitProps:["position"],classesResolver:mwe},f.forwardRef(function(t,n){const s=Uxe(),{onItemClick:r,className:i,classes:o}=t,l=ya(t,vwe);if(s.items.length===0)return null;const c=r?"button":"div";return a.jsx(wwe,Ze({className:Rt(o?.root,i),ref:n},l,{ownerState:t,children:s.items.map((u,d)=>a.jsx("li",{className:o?.item,"data-series":u.id,children:a.jsxs(c,{className:o?.series,role:r?"button":void 0,type:r?"button":void 0,onClick:r?(h=>r(h,dwe(u),d)):void 0,children:[a.jsx(nw,{className:o?.mark,color:u.color,type:u.markType}),a.jsx(bwe,{className:o?.label,children:u.label})]})},u.id))}))}));function Nwe(e){return Kn("MuiChartsAxisHighlight",e)}An("MuiChartsAxisHighlight",["root"]);const rw=fa("path",{name:"MuiChartsAxisHighlight",slot:"Root"})(({theme:e})=>({pointerEvents:"none",variants:[{props:{axisHighlight:"band"},style:Ze({fill:"white",fillOpacity:.1},e.applyStyles("light",{fill:"gray"}))},{props:{axisHighlight:"line"},style:Ze({strokeDasharray:"5 2",stroke:"#ffffff"},e.applyStyles("light",{stroke:"#000000"}))}]}));function Cwe(e){const{type:t,classes:n}=e,{left:s,width:r}=Ei(),i=Ka(),o=Vt(i,Ppe),l=Vt(i,Zs);return o.length===0?null:o.map(({axisId:c,value:u})=>{const h=l.axis[c].scale,p=uh(h),x=t==="band"&&u!==null&&js(h);return a.jsxs(f.Fragment,{children:[x&&h(u)!==void 0&&a.jsx(rw,{d:`M ${s} ${h(u)-(h.step()-h.bandwidth())/2} l 0 ${h.step()} l ${r} 0 l 0 ${-h.step()} Z`,className:n.root,ownerState:{axisHighlight:"band"}}),t==="line"&&u!==null&&a.jsx(rw,{d:`M ${s} ${p(u)} L ${s+r} ${p(u)}`,className:n.root,ownerState:{axisHighlight:"line"}})]},`${c}-${u}`)})}function Swe(e){const{type:t,classes:n}=e,{top:s,height:r}=Ei(),i=Ka(),o=Vt(i,Dpe),l=Vt(i,Xs);return o.length===0?null:o.map(({axisId:c,value:u})=>{const h=l.axis[c].scale,p=uh(h),x=t==="band"&&u!==null&&js(h);return a.jsxs(f.Fragment,{children:[x&&h(u)!==void 0&&a.jsx(rw,{d:`M ${h(u)-(h.step()-h.bandwidth())/2} ${s} l ${h.step()} 0 l 0 ${r} l ${-h.step()} 0 Z`,className:n.root,ownerState:{axisHighlight:"band"}}),t==="line"&&u!==null&&a.jsx(rw,{d:`M ${p(u)} ${s} L ${p(u)} ${s+r}`,className:n.root,ownerState:{axisHighlight:"line"}})]},`${c}-${u}`)})}const _we=()=>Qn({root:["root"]},Nwe);function Awe(e){const{x:t,y:n}=e,s=_we();return a.jsxs(f.Fragment,{children:[t&&t!=="none"&&a.jsx(Swe,{type:t,classes:s}),n&&n!=="none"&&a.jsx(Cwe,{type:n,classes:s})]})}function Twe(e){const{id:t,offset:n}=e,{left:s,top:r,width:i,height:o}=Ei(),l=Ze({top:0,right:0,bottom:0,left:0},n);return a.jsx("clipPath",{id:t,children:a.jsx("rect",{x:s-l.left,y:r-l.top,width:i+l.left+l.right,height:o+l.top+l.bottom})})}const kwe=parseInt(f.version,10),Ewe=["x","y","id","classes","color","shape"];function Lwe(e){return Kn("MuiHighlightElement",e)}An("MuiHighlightElement",["root"]);const Dwe=e=>{const{classes:t,id:n}=e,s={root:["root",`series-${n}`]};return Qn(s,Lwe,t)};function Pwe(e){const{x:t,y:n,color:s,shape:r}=e,i=ya(e,Ewe),o=Dwe(e),l=r==="circle"?"circle":"path",c=r==="circle"?{cx:0,cy:0,r:i.r===void 0?5:i.r}:{d:U4(uW[ZW(r)])()},u=kwe>18?{transformOrigin:`${t} ${n}`}:{"transform-origin":`${t} ${n}`};return a.jsx(l,Ze({pointerEvents:"none",className:o.root,transform:`translate(${t} ${n})`,fill:s},u,c,i))}const Owe=["slots","slotProps"];function Mwe(e){const{slots:t,slotProps:n}=e,s=ya(e,Owe),r=$x(),{xAxis:i,xAxisIds:o}=jr(),{yAxis:l,yAxisIds:c}=Nr(),{instance:u}=Yr(),d=Ka(),h=Vt(d,HG);if(h.length===0||r===void 0)return null;const{series:p,stackingGroups:x}=r,b=o[0],j=c[0],y=t?.lineHighlight??Pwe;return a.jsx("g",Ze({},s,{children:h.flatMap(({dataIndex:N,axisId:w})=>x.flatMap(({ids:S})=>S.flatMap(_=>{const{xAxisId:T=b,yAxisId:k=j,stackedData:A,data:E,disableHighlight:M,shape:F="circle"}=p[_];if(M||E[N]==null||w!==T)return null;const D=uh(i[T].scale),P=l[k].scale,B=i[T].data;if(B===void 0)throw new Error(`MUI X Charts: ${T===qj?"The first `xAxis`":`The x-axis with id "${T}"`} should have data property to be able to display a line plot.`);const G=D(B[N]),$=P(A[N][1]);if(!u.isPointInside(G,$))return null;const W=Z4(p[_],i[T],l[k]);return a.jsx(y,Ze({id:_,color:W(N),x:G,y:$,shape:F},n?.lineHighlight),`${_}`)})))}))}function Iwe(e){return Kn("MuiChartsGrid",e)}const fR=An("MuiChartsGrid",["root","line","horizontalLine","verticalLine"]),$we=fa("g",{name:"MuiChartsGrid",slot:"Root",overridesResolver:(e,t)=>[{[`&.${fR.verticalLine}`]:t.verticalLine},{[`&.${fR.horizontalLine}`]:t.horizontalLine},t.root]})({}),IV=fa("line",{name:"MuiChartsGrid",slot:"Line"})(({theme:e})=>({stroke:(e.vars||e).palette.divider,shapeRendering:"crispEdges",strokeWidth:1}));function Rwe(e){const{instance:t}=Yr(),{axis:n,start:s,end:r,classes:i}=e,{scale:o,tickNumber:l,tickInterval:c}=n,u=CN({scale:o,tickNumber:l,tickInterval:c,direction:"x"});return a.jsx(f.Fragment,{children:u.map(({value:d,offset:h})=>t.isXInside(h)?a.jsx(IV,{y1:s,y2:r,x1:h,x2:h,className:i.verticalLine},`vertical-${d?.getTime?.()??d}`):null)})}function zwe(e){const{instance:t}=Yr(),{axis:n,start:s,end:r,classes:i}=e,{scale:o,tickNumber:l,tickInterval:c}=n,u=CN({scale:o,tickNumber:l,tickInterval:c,direction:"y"});return a.jsx(f.Fragment,{children:u.map(({value:d,offset:h})=>t.isYInside(h)?a.jsx(IV,{y1:h,y2:h,x1:s,x2:r,className:i.horizontalLine},`horizontal-${d?.getTime?.()??d}`):null)})}const Fwe=["vertical","horizontal"],Uwe=({classes:e})=>Qn({root:["root"],verticalLine:["line","verticalLine"],horizontalLine:["line","horizontalLine"]},Iwe,e);function Bwe(e){const t=Ti({props:e,name:"MuiChartsGrid"}),n=Ei(),{vertical:s,horizontal:r}=t,i=ya(t,Fwe),{xAxis:o,xAxisIds:l}=jr(),{yAxis:c,yAxisIds:u}=Nr(),d=Uwe(t),h=c[u[0]],p=o[l[0]];return a.jsxs($we,Ze({},i,{className:d.root,children:[s&&a.jsx(Rwe,{axis:p,start:n.top,end:n.height+n.top,classes:d}),r&&a.jsx(zwe,{axis:h,start:n.left,end:n.width+n.left,classes:d})]}))}const Hwe=["message"],qwe=fa("text")(({theme:e})=>Ze({},e.typography.body2,{stroke:"none",fill:(e.vars||e).palette.text.primary,shapeRendering:"crispEdges",textAnchor:"middle",dominantBaseline:"middle"}));function Gwe(e){const{message:t}=e,n=ya(e,Hwe),{top:s,left:r,height:i,width:o}=Ei(),{localeText:l}=GW();return a.jsx(qwe,Ze({x:r+o/2,y:s+i/2},n,{children:t??l.loading}))}const Wwe=["message"],Vwe=fa("text")(({theme:e})=>Ze({},e.typography.body2,{stroke:"none",fill:(e.vars||e).palette.text.primary,shapeRendering:"crispEdges",textAnchor:"middle",dominantBaseline:"middle"}));function Ywe(e){const{message:t}=e,n=ya(e,Wwe),{top:s,left:r,height:i,width:o}=Ei(),{localeText:l}=GW();return a.jsx(Vwe,Ze({x:r+o/2,y:s+i/2},n,{children:t??l.noData}))}function Qwe(){const e=bN();return Object.values(e).every(t=>{if(!t)return!0;const{series:n,seriesOrder:s}=t;return s.every(r=>{const i=n[r];return i.type==="sankey"?i.data.links.length===0:i.data.length===0})})}function Kwe(e){const t=Qwe();if(e.loading){const n=e.slots?.loadingOverlay??Gwe;return a.jsx(n,Ze({},e.slotProps?.loadingOverlay))}if(t){const n=e.slots?.noDataOverlay??Ywe;return a.jsx(n,Ze({},e.slotProps?.noDataOverlay))}return null}const Xwe=[Ox,Px,kx,ch,Mx,cN],Zwe=["xAxis","yAxis","series","width","height","margin","colors","dataset","sx","onAreaClick","onLineClick","onMarkClick","axisHighlight","disableLineItemHighlight","hideLegend","grid","children","slots","slotProps","skipAnimation","loading","highlightedItem","onHighlightChange","className","showToolbar","brushConfig"],Jwe=e=>{const{xAxis:t,yAxis:n,series:s,width:r,height:i,margin:o,colors:l,dataset:c,sx:u,onAreaClick:d,onLineClick:h,onMarkClick:p,axisHighlight:x,disableLineItemHighlight:b,grid:j,children:y,slots:N,slotProps:w,skipAnimation:S,loading:_,highlightedItem:T,onHighlightChange:k,className:A,brushConfig:E}=e,M=ya(e,Zwe),D=`${Rj()}-clip-path`,P=f.useMemo(()=>s.map(be=>Ze({disableHighlight:!!b,type:"line"},be)),[b,s]),B=Ze({},M,{series:P,width:r,height:i,margin:o,colors:l,dataset:c,xAxis:t??[{id:qj,scaleType:"point",data:Array.from({length:Math.max(...s.map(be=>(be.data??c??[]).length))},(be,me)=>me)}],yAxis:n,highlightedItem:T,onHighlightChange:k,disableAxisListener:w?.tooltip?.trigger!=="axis"&&x?.x==="none"&&x?.y==="none",className:A,skipAnimation:S,brushConfig:E,plugins:Xwe}),G={vertical:j?.vertical,horizontal:j?.horizontal},$={clipPath:`url(#${D})`},W={id:D},Z={slots:N,slotProps:w,onItemClick:d},Q={slots:N,slotProps:w,onItemClick:h},le={slots:N,slotProps:w,onItemClick:p,skipAnimation:S},we={slots:N,slotProps:w,loading:_},J={slots:N,slotProps:w},se=Ze({x:"line"},x),ye={slots:N,slotProps:w},Ce={slots:N,slotProps:w};return{chartsWrapperProps:{sx:u,legendPosition:e.slotProps?.legend?.position,legendDirection:e.slotProps?.legend?.direction,hideLegend:e.hideLegend??!1},chartContainerProps:B,gridProps:G,clipPathProps:W,clipPathGroupProps:$,areaPlotProps:Z,linePlotProps:Q,markPlotProps:le,overlayProps:we,chartsAxisProps:J,axisHighlightProps:se,lineHighlightPlotProps:ye,legendProps:Ce,children:y}};function eje(e,t,n,s,r,i,o,l,c,u,d,h=1/0,p=1){const x=s.copy(),b=r.copy();x.range([0,1]),b.range([0,1]);const j=function(E){const M=x(n[E].x),F=b(n[E].y);return M>=i&&M<=o&&F>=l&&F<=c},y=s.range()[1]-s.range()[0],N=r.range()[1]-r.range()[0],w=y*y,S=N*N;function _(A,E){return w*A*A+S*E*E}const T=x(hR(s,u,A=>n[A]?.x)),k=b(hR(r,d,A=>n[A]?.y));return e.neighbors(T,k,p,h!=null?h*h:1/0,j,_)}function hR(e,t,n){if(js(e)){const s=e.bandwidth()===0?Math.floor((t-Math.min(...e.range())+e.step()/2)/e.step()):Math.floor((t-Math.min(...e.range()))/e.step());return n(s)}return e.invert(t)}const TN=({svgRef:e,params:t,store:n,instance:s})=>{const{disableVoronoi:r,voronoiMaxRadius:i,onItemClick:o}=t,l=Vt(n,wr),{axis:c,axisIds:u}=Vt(n,Xs),{axis:d,axisIds:h}=Vt(n,Zs),p=Vt(n,wG),{series:x,seriesOrder:b}=Vt(n,yn)?.scatter??{},j=Vt(n,p?npe:spe),y=u[0],N=h[0];ls(()=>{n.set("voronoi",{isVoronoiEnabled:!r})},[n,r]),f.useEffect(()=>{if(e.current===null||r)return;const _=e.current;function T(G){const $=Pp(_,G);if(!s.isPointInside($.x,$.y))return"outside-chart";let W;for(const Z of b??[]){const Q=(x??{})[Z],le=j.get(Z);if(!le)continue;const we=Q.xAxisId??y,J=Q.yAxisId??N,se=O6(n.getSnapshot(),we),ye=O6(n.getSnapshot(),J),Ce=i==="item"?Q.markerSize:i,ge=(se?.start??0)/100,be=(se?.end??100)/100,me=(ye?.start??0)/100,Ae=(ye?.end??100)/100,pe=c[we].scale,Ie=d[J].scale,xe=eje(le,l,Q.data,pe,Ie,ge,be,me,Ae,$.x,$.y,Ce)[0];if(xe===void 0)continue;const he=Q.data[xe],Re=pe(he.x),Ee=Ie(he.y),He=(Re-$.x)**2+(Ee-$.y)**2;(W===void 0||He<W.distanceSq)&&(W={dataIndex:xe,seriesId:Z,distanceSq:He})}return W===void 0?"no-point-found":{seriesId:W.seriesId,dataIndex:W.dataIndex}}const k=s.addInteractionListener("moveEnd",G=>{G.detail.activeGestures.pan||(s.cleanInteraction?.(),s.clearHighlight?.())}),A=s.addInteractionListener("panEnd",G=>{G.detail.activeGestures.move||(s.cleanInteraction?.(),s.clearHighlight?.())}),E=s.addInteractionListener("quickPressEnd",G=>{!G.detail.activeGestures.move&&!G.detail.activeGestures.pan&&(s.cleanInteraction?.(),s.clearHighlight?.())}),M=G=>{const $=T(G.detail.srcEvent);if($==="outside-chart"){s.cleanInteraction?.(),s.clearHighlight?.();return}if($==="outside-voronoi-max-radius"||$==="no-point-found"){s.removeItemInteraction?.(),s.clearHighlight?.();return}const{seriesId:W,dataIndex:Z}=$;s.setItemInteraction?.({type:"scatter",seriesId:W,dataIndex:Z},{interaction:"pointer"}),s.setHighlight?.({seriesId:W,dataIndex:Z})},F=s.addInteractionListener("tap",G=>{const $=T(G.detail.srcEvent);if(typeof $!="string"&&o){const{seriesId:W,dataIndex:Z}=$;o(G.detail.srcEvent,{type:"scatter",seriesId:W,dataIndex:Z})}}),D=s.addInteractionListener("move",M),P=s.addInteractionListener("pan",M),B=s.addInteractionListener("quickPress",M);return()=>{F.cleanup(),D.cleanup(),k.cleanup(),P.cleanup(),A.cleanup(),B.cleanup(),E.cleanup()}},[e,d,c,i,o,r,l,s,b,x,j,y,N,n]);const w=ys(()=>{n.set("voronoi",{isVoronoiEnabled:!0})}),S=ys(()=>{n.set("voronoi",{isVoronoiEnabled:!1})});return{instance:{enableVoronoi:w,disableVoronoi:S}}};TN.getDefaultizedParams=({params:e})=>Ze({},e,{disableVoronoi:e.disableVoronoi??!e.series.some(t=>t.type==="scatter")});TN.getInitialState=e=>({voronoi:{isVoronoiEnabled:!e.disableVoronoi}});TN.params={disableVoronoi:!0,voronoiMaxRadius:!0,onItemClick:!0};const $V=[Ox,Px,kx,ch,Mx,TN,cN],tje=["width","height","margin","children","series","colors","dataset","desc","onAxisClick","highlightedAxis","onHighlightedAxisChange","disableVoronoi","voronoiMaxRadius","onItemClick","disableAxisListener","highlightedItem","onHighlightChange","sx","title","xAxis","yAxis","zAxis","rotationAxis","radiusAxis","skipAnimation","seriesConfig","plugins","localeText","slots","slotProps","experimentalFeatures","enableKeyboardNavigation","brushConfig"],aje=(e,t)=>{const n=e,{width:s,height:r,margin:i,children:o,series:l,colors:c,dataset:u,desc:d,onAxisClick:h,highlightedAxis:p,onHighlightedAxisChange:x,disableVoronoi:b,voronoiMaxRadius:j,onItemClick:y,disableAxisListener:N,highlightedItem:w,onHighlightChange:S,sx:_,title:T,xAxis:k,yAxis:A,zAxis:E,rotationAxis:M,radiusAxis:F,skipAnimation:D,seriesConfig:P,plugins:B,localeText:G,slots:$,slotProps:W,experimentalFeatures:Z,enableKeyboardNavigation:Q,brushConfig:le}=n,we=ya(n,tje),J=Ze({title:T,desc:d,sx:_,ref:t},we);return{chartDataProviderProps:{margin:i,series:l,colors:c,dataset:u,disableAxisListener:N,highlightedItem:w,onHighlightChange:S,onAxisClick:h,highlightedAxis:p,onHighlightedAxisChange:x,disableVoronoi:b,voronoiMaxRadius:j,onItemClick:y,xAxis:k,yAxis:A,zAxis:E,rotationAxis:M,radiusAxis:F,skipAnimation:D,width:s,height:r,localeText:G,seriesConfig:P,experimentalFeatures:Z,enableKeyboardNavigation:Q,brushConfig:le,plugins:B??$V,slots:$,slotProps:W},chartsSurfaceProps:J,children:o}};function gR(e){try{return e.matches(":focus-visible")}catch{}return!1}class iw{static create(){return new iw}static use(){const t=Bj(iw.create).current,[n,s]=f.useState(!1);return t.shouldMount=n,t.setShouldMount=s,f.useEffect(t.mountEffect,[n]),t}constructor(){this.ref={current:null},this.mounted=null,this.didMount=!1,this.shouldMount=!1,this.setShouldMount=null}mount(){return this.mounted||(this.mounted=sje(),this.shouldMount=!0,this.setShouldMount(this.shouldMount)),this.mounted}mountEffect=()=>{this.shouldMount&&!this.didMount&&this.ref.current!==null&&(this.didMount=!0,this.mounted.resolve())};start(...t){this.mount().then(()=>this.ref.current?.start(...t))}stop(...t){this.mount().then(()=>this.ref.current?.stop(...t))}pulsate(...t){this.mount().then(()=>this.ref.current?.pulsate(...t))}}function nje(){return iw.use()}function sje(){let e,t;const n=new Promise((s,r)=>{e=s,t=r});return n.resolve=e,n.reject=t,n}class mD{static create(){return new mD}currentId=null;start(t,n){this.clear(),this.currentId=setTimeout(()=>{this.currentId=null,n()},t)}clear=()=>{this.currentId!==null&&(clearTimeout(this.currentId),this.currentId=null)};disposeEffect=()=>this.clear}function rje(){const e=Bj(mD.create).current;return hq(e.disposeEffect),e}function ije(e){const{className:t,classes:n,pulsate:s=!1,rippleX:r,rippleY:i,rippleSize:o,in:l,onExited:c,timeout:u}=e,[d,h]=f.useState(!1),p=Rt(t,n.ripple,n.rippleVisible,s&&n.ripplePulsate),x={width:o,height:o,top:-(o/2)+i,left:-(o/2)+r},b=Rt(n.child,d&&n.childLeaving,s&&n.childPulsate);return!l&&!d&&h(!0),f.useEffect(()=>{if(!l&&c!=null){const j=setTimeout(c,u);return()=>{clearTimeout(j)}}},[c,l,u]),a.jsx("span",{className:p,style:x,children:a.jsx("span",{className:b})})}const mi=An("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),Kk=550,oje=80,lje=vx`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`,cje=vx`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`,dje=vx`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`,uje=fa("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),mje=fa(ije,{name:"MuiTouchRipple",slot:"Ripple"})`
  opacity: 0;
  position: absolute;

  &.${mi.rippleVisible} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${lje};
    animation-duration: ${Kk}ms;
    animation-timing-function: ${({theme:e})=>e.transitions.easing.easeInOut};
  }

  &.${mi.ripplePulsate} {
    animation-duration: ${({theme:e})=>e.transitions.duration.shorter}ms;
  }

  & .${mi.child} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${mi.childLeaving} {
    opacity: 0;
    animation-name: ${cje};
    animation-duration: ${Kk}ms;
    animation-timing-function: ${({theme:e})=>e.transitions.easing.easeInOut};
  }

  & .${mi.childPulsate} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${dje};
    animation-duration: 2500ms;
    animation-timing-function: ${({theme:e})=>e.transitions.easing.easeInOut};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`,fje=f.forwardRef(function(t,n){const s=Cd({props:t,name:"MuiTouchRipple"}),{center:r=!1,classes:i={},className:o,...l}=s,[c,u]=f.useState([]),d=f.useRef(0),h=f.useRef(null);f.useEffect(()=>{h.current&&(h.current(),h.current=null)},[c]);const p=f.useRef(!1),x=rje(),b=f.useRef(null),j=f.useRef(null),y=f.useCallback(_=>{const{pulsate:T,rippleX:k,rippleY:A,rippleSize:E,cb:M}=_;u(F=>[...F,a.jsx(mje,{classes:{ripple:Rt(i.ripple,mi.ripple),rippleVisible:Rt(i.rippleVisible,mi.rippleVisible),ripplePulsate:Rt(i.ripplePulsate,mi.ripplePulsate),child:Rt(i.child,mi.child),childLeaving:Rt(i.childLeaving,mi.childLeaving),childPulsate:Rt(i.childPulsate,mi.childPulsate)},timeout:Kk,pulsate:T,rippleX:k,rippleY:A,rippleSize:E},d.current)]),d.current+=1,h.current=M},[i]),N=f.useCallback((_={},T={},k=()=>{})=>{const{pulsate:A=!1,center:E=r||T.pulsate,fakeElement:M=!1}=T;if(_?.type==="mousedown"&&p.current){p.current=!1;return}_?.type==="touchstart"&&(p.current=!0);const F=M?null:j.current,D=F?F.getBoundingClientRect():{width:0,height:0,left:0,top:0};let P,B,G;if(E||_===void 0||_.clientX===0&&_.clientY===0||!_.clientX&&!_.touches)P=Math.round(D.width/2),B=Math.round(D.height/2);else{const{clientX:$,clientY:W}=_.touches&&_.touches.length>0?_.touches[0]:_;P=Math.round($-D.left),B=Math.round(W-D.top)}if(E)G=Math.sqrt((2*D.width**2+D.height**2)/3),G%2===0&&(G+=1);else{const $=Math.max(Math.abs((F?F.clientWidth:0)-P),P)*2+2,W=Math.max(Math.abs((F?F.clientHeight:0)-B),B)*2+2;G=Math.sqrt($**2+W**2)}_?.touches?b.current===null&&(b.current=()=>{y({pulsate:A,rippleX:P,rippleY:B,rippleSize:G,cb:k})},x.start(oje,()=>{b.current&&(b.current(),b.current=null)})):y({pulsate:A,rippleX:P,rippleY:B,rippleSize:G,cb:k})},[r,y,x]),w=f.useCallback(()=>{N({},{pulsate:!0})},[N]),S=f.useCallback((_,T)=>{if(x.clear(),_?.type==="touchend"&&b.current){b.current(),b.current=null,x.start(0,()=>{S(_,T)});return}b.current=null,u(k=>k.length>0?k.slice(1):k),h.current=T},[x]);return f.useImperativeHandle(n,()=>({pulsate:w,start:N,stop:S}),[w,N,S]),a.jsx(uje,{className:Rt(mi.root,i.root,o),ref:j,...l,children:a.jsx(YL,{component:null,exit:!0,children:c})})});function hje(e){return Kn("MuiButtonBase",e)}const gje=An("MuiButtonBase",["root","disabled","focusVisible"]),pje=e=>{const{disabled:t,focusVisible:n,focusVisibleClassName:s,classes:r}=e,o=Qn({root:["root",t&&"disabled",n&&"focusVisible"]},hje,r);return n&&s&&(o.root+=` ${s}`),o},xje=fa("button",{name:"MuiButtonBase",slot:"Root"})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${gje.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),RV=f.forwardRef(function(t,n){const s=Cd({props:t,name:"MuiButtonBase"}),{action:r,centerRipple:i=!1,children:o,className:l,component:c="button",disabled:u=!1,disableRipple:d=!1,disableTouchRipple:h=!1,focusRipple:p=!1,focusVisibleClassName:x,LinkComponent:b="a",onBlur:j,onClick:y,onContextMenu:N,onDragLeave:w,onFocus:S,onFocusVisible:_,onKeyDown:T,onKeyUp:k,onMouseDown:A,onMouseLeave:E,onMouseUp:M,onTouchEnd:F,onTouchMove:D,onTouchStart:P,tabIndex:B=0,TouchRippleProps:G,touchRippleRef:$,type:W,...Z}=s,Q=f.useRef(null),le=nje(),we=Uo(le.ref,$),[J,se]=f.useState(!1);u&&J&&se(!1),f.useImperativeHandle(r,()=>({focusVisible:()=>{se(!0),Q.current.focus()}}),[]);const ye=le.shouldMount&&!d&&!u;f.useEffect(()=>{J&&p&&!d&&le.pulsate()},[d,p,J,le]);const Ce=xl(le,"start",A,h),ge=xl(le,"stop",N,h),be=xl(le,"stop",w,h),me=xl(le,"stop",M,h),Ae=xl(le,"stop",Je=>{J&&Je.preventDefault(),E&&E(Je)},h),pe=xl(le,"start",P,h),Ie=xl(le,"stop",F,h),xe=xl(le,"stop",D,h),he=xl(le,"stop",Je=>{gR(Je.target)||se(!1),j&&j(Je)},!1),Re=ys(Je=>{Q.current||(Q.current=Je.currentTarget),gR(Je.target)&&(se(!0),_&&_(Je)),S&&S(Je)}),Ee=()=>{const Je=Q.current;return c&&c!=="button"&&!(Je.tagName==="A"&&Je.href)},He=ys(Je=>{p&&!Je.repeat&&J&&Je.key===" "&&le.stop(Je,()=>{le.start(Je)}),Je.target===Je.currentTarget&&Ee()&&Je.key===" "&&Je.preventDefault(),T&&T(Je),Je.target===Je.currentTarget&&Ee()&&Je.key==="Enter"&&!u&&(Je.preventDefault(),y&&y(Je))}),Ke=ys(Je=>{p&&Je.key===" "&&J&&!Je.defaultPrevented&&le.stop(Je,()=>{le.pulsate(Je)}),k&&k(Je),y&&Je.target===Je.currentTarget&&Ee()&&Je.key===" "&&!Je.defaultPrevented&&y(Je)});let st=c;st==="button"&&(Z.href||Z.to)&&(st=b);const it={};st==="button"?(it.type=W===void 0?"button":W,it.disabled=u):(!Z.href&&!Z.to&&(it.role="button"),u&&(it["aria-disabled"]=u));const ot=Uo(n,Q),rt={...s,centerRipple:i,component:c,disabled:u,disableRipple:d,disableTouchRipple:h,focusRipple:p,tabIndex:B,focusVisible:J},at=pje(rt);return a.jsxs(xje,{as:st,className:Rt(at.root,l),ownerState:rt,onBlur:he,onClick:y,onContextMenu:ge,onFocus:Re,onKeyDown:He,onKeyUp:Ke,onMouseDown:Ce,onMouseLeave:Ae,onMouseUp:me,onDragLeave:be,onTouchEnd:Ie,onTouchMove:xe,onTouchStart:pe,ref:ot,tabIndex:u?-1:B,type:W,...it,...Z,children:[o,ye?a.jsx(fje,{ref:we,center:i,...G}):null]})});function xl(e,t,n,s=!1){return ys(r=>(n&&n(r),s||e[t](r),!0))}function yje(e){return Kn("MuiIconButton",e)}const pR=An("MuiIconButton",["root","disabled","colorInherit","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","edgeStart","edgeEnd","sizeSmall","sizeMedium","sizeLarge","loading","loadingIndicator","loadingWrapper"]),bje=e=>{const{classes:t,disabled:n,color:s,edge:r,size:i,loading:o}=e,l={root:["root",o&&"loading",n&&"disabled",s!=="default"&&`color${Va(s)}`,r&&`edge${Va(r)}`,`size${Va(i)}`],loadingIndicator:["loadingIndicator"],loadingWrapper:["loadingWrapper"]};return Qn(l,yje,t)},vje=fa(RV,{name:"MuiIconButton",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.loading&&t.loading,n.color!=="default"&&t[`color${Va(n.color)}`],n.edge&&t[`edge${Va(n.edge)}`],t[`size${Va(n.size)}`]]}})(Uu(({theme:e})=>({textAlign:"center",flex:"0 0 auto",fontSize:e.typography.pxToRem(24),padding:8,borderRadius:"50%",color:(e.vars||e).palette.action.active,transition:e.transitions.create("background-color",{duration:e.transitions.duration.shortest}),variants:[{props:t=>!t.disableRipple,style:{"--IconButton-hoverBg":e.alpha((e.vars||e).palette.action.active,(e.vars||e).palette.action.hoverOpacity),"&:hover":{backgroundColor:"var(--IconButton-hoverBg)","@media (hover: none)":{backgroundColor:"transparent"}}}},{props:{edge:"start"},style:{marginLeft:-12}},{props:{edge:"start",size:"small"},style:{marginLeft:-3}},{props:{edge:"end"},style:{marginRight:-12}},{props:{edge:"end",size:"small"},style:{marginRight:-3}}]})),Uu(({theme:e})=>({variants:[{props:{color:"inherit"},style:{color:"inherit"}},...Object.entries(e.palette).filter(Sp()).map(([t])=>({props:{color:t},style:{color:(e.vars||e).palette[t].main}})),...Object.entries(e.palette).filter(Sp()).map(([t])=>({props:{color:t},style:{"--IconButton-hoverBg":e.alpha((e.vars||e).palette[t].main,(e.vars||e).palette.action.hoverOpacity)}})),{props:{size:"small"},style:{padding:5,fontSize:e.typography.pxToRem(18)}},{props:{size:"large"},style:{padding:12,fontSize:e.typography.pxToRem(28)}}],[`&.${pR.disabled}`]:{backgroundColor:"transparent",color:(e.vars||e).palette.action.disabled},[`&.${pR.loading}`]:{color:"transparent"}}))),wje=fa("span",{name:"MuiIconButton",slot:"LoadingIndicator"})(({theme:e})=>({display:"none",position:"absolute",visibility:"visible",top:"50%",left:"50%",transform:"translate(-50%, -50%)",color:(e.vars||e).palette.action.disabled,variants:[{props:{loading:!0},style:{display:"flex"}}]})),jje=f.forwardRef(function(t,n){const s=Cd({props:t,name:"MuiIconButton"}),{edge:r=!1,children:i,className:o,color:l="default",disabled:c=!1,disableFocusRipple:u=!1,size:d="medium",id:h,loading:p=null,loadingIndicator:x,...b}=s,j=Rj(h),y=x??a.jsx(QL,{"aria-labelledby":j,color:"inherit",size:16}),N={...s,edge:r,color:l,disabled:c,disableFocusRipple:u,loading:p,loadingIndicator:y,size:d},w=bje(N);return a.jsxs(vje,{id:p?j:h,className:Rt(w.root,o),centerRipple:!0,focusRipple:!u,disabled:c||p,ref:n,...b,ownerState:N,children:[typeof p=="boolean"&&a.jsx("span",{className:w.loadingWrapper,style:{display:"contents"},children:a.jsx(wje,{className:w.loadingIndicator,ownerState:N,children:p&&y})}),i]})});function Nje(e){return Kn("MuiButton",e)}const Qd=An("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","colorPrimary","colorSecondary","colorSuccess","colorError","colorInfo","colorWarning","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","icon","iconSizeSmall","iconSizeMedium","iconSizeLarge","loading","loadingWrapper","loadingIconPlaceholder","loadingIndicator","loadingPositionCenter","loadingPositionStart","loadingPositionEnd"]),Cje=f.createContext({}),Sje=f.createContext(void 0),_je=e=>{const{color:t,disableElevation:n,fullWidth:s,size:r,variant:i,loading:o,loadingPosition:l,classes:c}=e,u={root:["root",o&&"loading",i,`${i}${Va(t)}`,`size${Va(r)}`,`${i}Size${Va(r)}`,`color${Va(t)}`,n&&"disableElevation",s&&"fullWidth",o&&`loadingPosition${Va(l)}`],startIcon:["icon","startIcon",`iconSize${Va(r)}`],endIcon:["icon","endIcon",`iconSize${Va(r)}`],loadingIndicator:["loadingIndicator"],loadingWrapper:["loadingWrapper"]},d=Qn(u,Nje,c);return{...c,...d}},zV=[{props:{size:"small"},style:{"& > *:nth-of-type(1)":{fontSize:18}}},{props:{size:"medium"},style:{"& > *:nth-of-type(1)":{fontSize:20}}},{props:{size:"large"},style:{"& > *:nth-of-type(1)":{fontSize:22}}}],Aje=fa(RV,{shouldForwardProp:e=>nq(e)||e==="classes",name:"MuiButton",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[n.variant],t[`${n.variant}${Va(n.color)}`],t[`size${Va(n.size)}`],t[`${n.variant}Size${Va(n.size)}`],n.color==="inherit"&&t.colorInherit,n.disableElevation&&t.disableElevation,n.fullWidth&&t.fullWidth,n.loading&&t.loading]}})(Uu(({theme:e})=>{const t=e.palette.mode==="light"?e.palette.grey[300]:e.palette.grey[800],n=e.palette.mode==="light"?e.palette.grey.A100:e.palette.grey[700];return{...e.typography.button,minWidth:64,padding:"6px 16px",border:0,borderRadius:(e.vars||e).shape.borderRadius,transition:e.transitions.create(["background-color","box-shadow","border-color","color"],{duration:e.transitions.duration.short}),"&:hover":{textDecoration:"none"},[`&.${Qd.disabled}`]:{color:(e.vars||e).palette.action.disabled},variants:[{props:{variant:"contained"},style:{color:"var(--variant-containedColor)",backgroundColor:"var(--variant-containedBg)",boxShadow:(e.vars||e).shadows[2],"&:hover":{boxShadow:(e.vars||e).shadows[4],"@media (hover: none)":{boxShadow:(e.vars||e).shadows[2]}},"&:active":{boxShadow:(e.vars||e).shadows[8]},[`&.${Qd.focusVisible}`]:{boxShadow:(e.vars||e).shadows[6]},[`&.${Qd.disabled}`]:{color:(e.vars||e).palette.action.disabled,boxShadow:(e.vars||e).shadows[0],backgroundColor:(e.vars||e).palette.action.disabledBackground}}},{props:{variant:"outlined"},style:{padding:"5px 15px",border:"1px solid currentColor",borderColor:"var(--variant-outlinedBorder, currentColor)",backgroundColor:"var(--variant-outlinedBg)",color:"var(--variant-outlinedColor)",[`&.${Qd.disabled}`]:{border:`1px solid ${(e.vars||e).palette.action.disabledBackground}`}}},{props:{variant:"text"},style:{padding:"6px 8px",color:"var(--variant-textColor)",backgroundColor:"var(--variant-textBg)"}},...Object.entries(e.palette).filter(Sp()).map(([s])=>({props:{color:s},style:{"--variant-textColor":(e.vars||e).palette[s].main,"--variant-outlinedColor":(e.vars||e).palette[s].main,"--variant-outlinedBorder":e.alpha((e.vars||e).palette[s].main,.5),"--variant-containedColor":(e.vars||e).palette[s].contrastText,"--variant-containedBg":(e.vars||e).palette[s].main,"@media (hover: hover)":{"&:hover":{"--variant-containedBg":(e.vars||e).palette[s].dark,"--variant-textBg":e.alpha((e.vars||e).palette[s].main,(e.vars||e).palette.action.hoverOpacity),"--variant-outlinedBorder":(e.vars||e).palette[s].main,"--variant-outlinedBg":e.alpha((e.vars||e).palette[s].main,(e.vars||e).palette.action.hoverOpacity)}}}})),{props:{color:"inherit"},style:{color:"inherit",borderColor:"currentColor","--variant-containedBg":e.vars?e.vars.palette.Button.inheritContainedBg:t,"@media (hover: hover)":{"&:hover":{"--variant-containedBg":e.vars?e.vars.palette.Button.inheritContainedHoverBg:n,"--variant-textBg":e.alpha((e.vars||e).palette.text.primary,(e.vars||e).palette.action.hoverOpacity),"--variant-outlinedBg":e.alpha((e.vars||e).palette.text.primary,(e.vars||e).palette.action.hoverOpacity)}}}},{props:{size:"small",variant:"text"},style:{padding:"4px 5px",fontSize:e.typography.pxToRem(13)}},{props:{size:"large",variant:"text"},style:{padding:"8px 11px",fontSize:e.typography.pxToRem(15)}},{props:{size:"small",variant:"outlined"},style:{padding:"3px 9px",fontSize:e.typography.pxToRem(13)}},{props:{size:"large",variant:"outlined"},style:{padding:"7px 21px",fontSize:e.typography.pxToRem(15)}},{props:{size:"small",variant:"contained"},style:{padding:"4px 10px",fontSize:e.typography.pxToRem(13)}},{props:{size:"large",variant:"contained"},style:{padding:"8px 22px",fontSize:e.typography.pxToRem(15)}},{props:{disableElevation:!0},style:{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${Qd.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${Qd.disabled}`]:{boxShadow:"none"}}},{props:{fullWidth:!0},style:{width:"100%"}},{props:{loadingPosition:"center"},style:{transition:e.transitions.create(["background-color","box-shadow","border-color"],{duration:e.transitions.duration.short}),[`&.${Qd.loading}`]:{color:"transparent"}}}]}})),Tje=fa("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.startIcon,n.loading&&t.startIconLoadingStart,t[`iconSize${Va(n.size)}`]]}})(({theme:e})=>({display:"inherit",marginRight:8,marginLeft:-4,variants:[{props:{size:"small"},style:{marginLeft:-2}},{props:{loadingPosition:"start",loading:!0},style:{transition:e.transitions.create(["opacity"],{duration:e.transitions.duration.short}),opacity:0}},{props:{loadingPosition:"start",loading:!0,fullWidth:!0},style:{marginRight:-8}},...zV]})),kje=fa("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.endIcon,n.loading&&t.endIconLoadingEnd,t[`iconSize${Va(n.size)}`]]}})(({theme:e})=>({display:"inherit",marginRight:-4,marginLeft:8,variants:[{props:{size:"small"},style:{marginRight:-2}},{props:{loadingPosition:"end",loading:!0},style:{transition:e.transitions.create(["opacity"],{duration:e.transitions.duration.short}),opacity:0}},{props:{loadingPosition:"end",loading:!0,fullWidth:!0},style:{marginLeft:-8}},...zV]})),Eje=fa("span",{name:"MuiButton",slot:"LoadingIndicator"})(({theme:e})=>({display:"none",position:"absolute",visibility:"visible",variants:[{props:{loading:!0},style:{display:"flex"}},{props:{loadingPosition:"start"},style:{left:14}},{props:{loadingPosition:"start",size:"small"},style:{left:10}},{props:{variant:"text",loadingPosition:"start"},style:{left:6}},{props:{loadingPosition:"center"},style:{left:"50%",transform:"translate(-50%)",color:(e.vars||e).palette.action.disabled}},{props:{loadingPosition:"end"},style:{right:14}},{props:{loadingPosition:"end",size:"small"},style:{right:10}},{props:{variant:"text",loadingPosition:"end"},style:{right:6}},{props:{loadingPosition:"start",fullWidth:!0},style:{position:"relative",left:-10}},{props:{loadingPosition:"end",fullWidth:!0},style:{position:"relative",right:-10}}]})),xR=fa("span",{name:"MuiButton",slot:"LoadingIconPlaceholder"})({display:"inline-block",width:"1em",height:"1em"}),Lje=f.forwardRef(function(t,n){const s=f.useContext(Cje),r=f.useContext(Sje),i=Fu(s,t),o=Cd({props:i,name:"MuiButton"}),{children:l,color:c="primary",component:u="button",className:d,disabled:h=!1,disableElevation:p=!1,disableFocusRipple:x=!1,endIcon:b,focusVisibleClassName:j,fullWidth:y=!1,id:N,loading:w=null,loadingIndicator:S,loadingPosition:_="center",size:T="medium",startIcon:k,type:A,variant:E="text",...M}=o,F=Rj(N),D=S??a.jsx(QL,{"aria-labelledby":F,color:"inherit",size:16}),P={...o,color:c,component:u,disabled:h,disableElevation:p,disableFocusRipple:x,fullWidth:y,loading:w,loadingIndicator:D,loadingPosition:_,size:T,type:A,variant:E},B=_je(P),G=(k||w&&_==="start")&&a.jsx(Tje,{className:B.startIcon,ownerState:P,children:k||a.jsx(xR,{className:B.loadingIconPlaceholder,ownerState:P})}),$=(b||w&&_==="end")&&a.jsx(kje,{className:B.endIcon,ownerState:P,children:b||a.jsx(xR,{className:B.loadingIconPlaceholder,ownerState:P})}),W=r||"",Z=typeof w=="boolean"?a.jsx("span",{className:B.loadingWrapper,style:{display:"contents"},children:w&&a.jsx(Eje,{className:B.loadingIndicator,ownerState:P,children:D})}):null;return a.jsxs(Aje,{ownerState:P,className:Rt(s.className,B.root,d,W),component:u,disabled:h||w,focusRipple:!x,focusVisibleClassName:Rt(B.focusVisible,j),ref:n,type:A,id:w?F:N,...M,classes:B,children:[G,_!=="end"&&Z,l,_==="end"&&Z,$]})}),Dje={baseButton:Lje,baseIconButton:jje},Pje={},Oje=Ze({},Dje,Pje),Mje=f.createContext(null);function Ije(e){const{slots:t,slotProps:n={},defaultSlots:s,children:r}=e,i=f.useMemo(()=>({slots:Ze({},s,t),slotProps:n}),[s,t,n]);return a.jsx(Mje.Provider,{value:i,children:r})}const $je=["children","localeText","plugins","seriesConfig","slots","slotProps"],Rje=e=>{const t=Ti({props:e,name:"MuiChartDataProvider"}),{children:n,localeText:s,plugins:r=$V,seriesConfig:i,slots:o,slotProps:l}=t,c=ya(t,$je),u=Yo(),d={plugins:r,seriesConfig:i,pluginParams:Ze({theme:u.palette.mode},c)};return{children:n,localeText:s,chartProviderProps:d,slots:o,slotProps:l}};function zje(e){const{children:t,localeText:n,chartProviderProps:s,slots:r,slotProps:i}=Rje(e);return a.jsx(W0e,Ze({},s,{children:a.jsx(l0e,{localeText:n,children:a.jsx(Ije,{slots:r,slotProps:i,defaultSlots:Oje,children:t})})}))}function yR(e){const{isReversed:t,gradientId:n,size:s,direction:r,scale:i,colorMap:o}=e;return s<=0?null:a.jsx("linearGradient",{id:n,x1:"0",x2:"0",y1:"0",y2:"0",[`${r}${t?1:2}`]:`${s}px`,gradientUnits:"userSpaceOnUse",children:o.thresholds.map((l,c)=>{const u=i(l);if(u===void 0)return null;const d=t?1-u/s:u/s;return Number.isNaN(d)?null:a.jsxs(f.Fragment,{children:[a.jsx("stop",{offset:d,stopColor:o.colors[c],stopOpacity:1}),a.jsx("stop",{offset:d,stopColor:o.colors[c+1],stopOpacity:1})]},l.toString()+c)})})}const Fje=10;function bR(e){const{gradientUnits:t,isReversed:n,gradientId:s,size:r,direction:i,scale:o,colorScale:l,colorMap:c}=e,u=[c.min??0,c.max??100],d=u.map(o).filter(b=>b!==void 0);if(d.length!==2)return null;const h=typeof u[0]=="number"?Pf(u[0],u[1]):d4(u[0],u[1]),p=Math.round((Math.max(...d)-Math.min(...d))/Fje),x=`${u[0]}-${u[1]}-`;return a.jsx("linearGradient",{id:s,x1:"0",x2:"0",y1:"0",y2:"0",[`${i}${n?1:2}`]:t==="objectBoundingBox"?1:`${r}px`,gradientUnits:t??"userSpaceOnUse",children:Array.from({length:p+1},(b,j)=>{const y=h(j/p);if(y===void 0)return null;const N=o(y);if(N===void 0)return null;const w=n?1-N/r:N/r,S=l(y);return S===null?null:a.jsx("stop",{offset:w,stopColor:S,stopOpacity:1},x+j)})})}const Uje=10,Bje=e=>e?{x1:"1",x2:"0",y1:"0",y2:"0"}:{x1:"0",x2:"1",y1:"0",y2:"0"};function R2(e){const{isReversed:t,gradientId:n,colorScale:s,colorMap:r}=e,i=[r.min??0,r.max??100],o=typeof i[0]=="number"?Pf(i[0],i[1]):d4(i[0],i[1]),l=Uje,c=`${i[0]}-${i[1]}-`;return a.jsx("linearGradient",Ze({id:n},Bje(t),{gradientUnits:"objectBoundingBox",children:Array.from({length:l+1},(u,d)=>{const h=d/l,p=o(h);if(p===void 0)return null;const x=s(p);return x===null?null:a.jsx("stop",{offset:h,stopColor:x,stopOpacity:1},c+d)})}))}function Hje(){const{top:e,height:t,bottom:n,left:s,width:r,right:i}=Ei(),o=e+t+n,l=s+r+i,c=Q4(),u=Bxe(),{xAxis:d,xAxisIds:h}=jr(),{yAxis:p,yAxisIds:x}=Nr(),{zAxis:b,zAxisIds:j}=W4(),y=x.filter(S=>p[S].colorMap!==void 0),N=h.filter(S=>d[S].colorMap!==void 0),w=j.filter(S=>b[S].colorMap!==void 0);return y.length===0&&N.length===0&&w.length===0?null:a.jsxs("defs",{children:[y.map(S=>{const _=c(S),T=u(S),{colorMap:k,scale:A,colorScale:E,reverse:M}=p[S];return k?.type==="piecewise"?a.jsx(yR,{isReversed:!M,scale:A,colorMap:k,size:o,gradientId:_,direction:"y"},_):k?.type==="continuous"?a.jsxs(f.Fragment,{children:[a.jsx(bR,{isReversed:!M,scale:A,colorScale:E,colorMap:k,size:o,gradientId:_,direction:"y"}),a.jsx(R2,{isReversed:M,colorScale:E,colorMap:k,gradientId:T})]},_):null}),N.map(S=>{const _=c(S),T=u(S),{colorMap:k,scale:A,reverse:E,colorScale:M}=d[S];return k?.type==="piecewise"?a.jsx(yR,{isReversed:E,scale:A,colorMap:k,size:l,gradientId:_,direction:"x"},_):k?.type==="continuous"?a.jsxs(f.Fragment,{children:[a.jsx(bR,{isReversed:E,scale:A,colorScale:M,colorMap:k,size:l,gradientId:_,direction:"x"}),a.jsx(R2,{isReversed:E,colorScale:M,colorMap:k,gradientId:T})]},_):null}),w.map(S=>{const _=u(S),{colorMap:T,colorScale:k}=b[S];return T?.type==="continuous"?a.jsx(R2,{colorScale:k,colorMap:T,gradientId:_},_):null})]})}function qje(e){return Kn("MuiChartsSurface",e)}const Gje=()=>Qn({root:["root"]},qje);An("MuiChartsSurface",["root"]);const Wje=["children","className","title","desc"],Vje=fa("svg",{name:"MuiChartsSurface",slot:"Root"})(({ownerState:e,theme:t})=>({width:e.width??"100%",height:e.height??"100%",display:"flex",position:"relative",flexDirection:"column",alignItems:"center",justifyContent:"center",overflow:"hidden",touchAction:e.hasZoom?"pan-y":void 0,userSelect:"none",gridArea:"chart","&:focus":{outline:"none"},"&:focus-visible":{outline:`${(t.vars??t).palette.text.primary} solid 2px`,"&[data-has-focused-item=true]":{outline:"none"}},"& [data-focused=true]":{outline:`${(t.vars??t).palette.text.primary} solid 2px`}})),Yje=f.forwardRef(function(t,n){const s=Ka(),r=Vt(s,kme),i=Vt(s,Eme),o=Vt(s,pq),l=Vt(s,xq),c=Vt(s,hpe),u=Vt(s,fpe),d=Vt(s,Vge),h=V4(),p=Uo(h,n),x=Ti({props:t,name:"MuiChartsSurface"}),{children:b,className:j,title:y,desc:N}=x,w=ya(x,Wje),S=Gje(),_=i>0&&r>0;return a.jsxs(Vje,Ze({ownerState:{width:o,height:l,hasZoom:d},viewBox:`0 0 ${r} ${i}`,className:Rt(S.root,j),tabIndex:c?0:void 0,"data-has-focused-item":u||void 0},w,{ref:p,children:[y&&a.jsx("title",{children:y}),N&&a.jsx("desc",{children:N}),a.jsx(Hje,{}),_&&b]}))}),vR=An("MuiChartsToolbar",["root"]),Qje=e=>e?.horizontal==="start"?"start":e?.horizontal==="end"?"end":"center",Kje=e=>e?.vertical==="top"?"flex-start":e?.vertical==="bottom"?"flex-end":"center",Xje=(e,t,n)=>e?'"chart"':t==="vertical"?n?.horizontal==="start"?'"legend chart"':'"chart legend"':n?.vertical==="bottom"?`"chart"
            "legend"`:`"legend"
          "chart"`,Zje=(e=!1,t="horizontal",n="end",s=void 0)=>{const r=s?"auto":"1fr";return t==="horizontal"||e?r:n==="start"?`auto ${r}`:`${r} auto`},Jje=(e=!1,t="horizontal",n="top")=>t==="vertical"||e?"1fr":n==="bottom"?"1fr auto":"auto 1fr",eNe=fa("div",{name:"MuiChartsWrapper",slot:"Root",shouldForwardProp:e=>gv(e)&&e!=="extendVertically"&&e!=="width"})(({ownerState:e,width:t})=>{const n=Zje(e.hideLegend,e.legendDirection,e.legendPosition?.horizontal,t),s=Jje(e.hideLegend,e.legendDirection,e.legendPosition?.vertical),r=Xje(e.hideLegend,e.legendDirection,e.legendPosition);return{variants:[{props:{extendVertically:!0},style:{height:"100%",minHeight:0}}],flex:1,display:"grid",gridTemplateColumns:n,gridTemplateRows:s,gridTemplateAreas:r,[`&:has(.${vR.root})`]:{gridTemplateRows:`auto ${s}`,gridTemplateAreas:`"${n.split(" ").map(()=>"toolbar").join(" ")}"
        ${r}`},[`& .${vR.root}`]:{gridArea:"toolbar",justifySelf:"center"},justifyContent:"safe center",justifyItems:Qje(e.legendPosition),alignItems:Kje(e.legendPosition)}});function tNe(e){const{children:t,sx:n,extendVertically:s}=e,r=n0e(),i=Ka(),o=Vt(i,pq),l=Vt(i,xq);return a.jsx(eNe,{ref:r,ownerState:e,sx:n,extendVertically:s??l===void 0,width:o,children:t})}function aNe(){const e=Ka(),t=Vt(e,dN),n=Vt(e,uN),s=Vt(e,mN);return f.useMemo(()=>t===void 0||n===void 0||s===void 0?null:{seriesType:t,seriesId:n,dataIndex:s},[t,n,s])}const nb=6;function nNe(){const e=Yo(),t=aNe(),n=$x(),{xAxis:s,xAxisIds:r}=jr(),{yAxis:i,yAxisIds:o}=Nr();if(t===null||t.seriesType!=="line"||!n)return null;const l=n?.series[t.seriesId],c=l.xAxisId??r[0],u=l.yAxisId??o[0];return a.jsx("rect",{fill:"none",stroke:(e.vars??e).palette.text.primary,strokeWidth:2,x:s[c].scale(s[c].data[t.dataIndex])-nb,y:i[u].scale(l.stackedData[t.dataIndex][1])-nb,width:2*nb,height:2*nb,rx:3,ry:3})}const mh=f.forwardRef(function(t,n){const s=Ti({props:t,name:"MuiLineChart"}),{chartsWrapperProps:r,chartContainerProps:i,gridProps:o,clipPathProps:l,clipPathGroupProps:c,areaPlotProps:u,linePlotProps:d,markPlotProps:h,overlayProps:p,chartsAxisProps:x,axisHighlightProps:b,lineHighlightPlotProps:j,legendProps:y,children:N}=Jwe(s),{chartDataProviderProps:w,chartsSurfaceProps:S}=aje(i,n),_=s.slots?.tooltip??cwe,T=s.slots?.toolbar;return a.jsx(zje,Ze({},w,{children:a.jsxs(tNe,Ze({},r,{children:[s.showToolbar&&T?a.jsx(T,Ze({},s.slotProps?.toolbar)):null,!s.hideLegend&&a.jsx(jwe,Ze({},y)),a.jsxs(Yje,Ze({},S,{children:[a.jsx(Bwe,Ze({},o)),a.jsxs("g",Ze({},c,{children:[a.jsx(iye,Ze({},u)),a.jsx(yye,Ze({},d)),a.jsx(Kwe,Ze({},p)),a.jsx(Awe,Ze({},b))]})),a.jsx(nNe,{}),a.jsx(pbe,Ze({},x)),a.jsx("g",{"data-drawing-container":!0,children:a.jsx(Aye,Ze({},h))}),a.jsx(Mwe,Ze({},j)),a.jsx(Twe,Ze({},l)),N]})),!s.loading&&a.jsx(_,Ze({},s.slotProps?.tooltip))]}))}))});function sNe(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return f.useMemo(()=>s=>{t.forEach(r=>r(s))},t)}const kN=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function fh(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function fD(e){return"nodeType"in e}function Js(e){var t,n;return e?fh(e)?e:fD(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function hD(e){const{Document:t}=Js(e);return e instanceof t}function Ux(e){return fh(e)?!1:e instanceof Js(e).HTMLElement}function FV(e){return e instanceof Js(e).SVGElement}function hh(e){return e?fh(e)?e.document:fD(e)?hD(e)?e:Ux(e)||FV(e)?e.ownerDocument:document:document:document}const Zi=kN?f.useLayoutEffect:f.useEffect;function EN(e){const t=f.useRef(e);return Zi(()=>{t.current=e}),f.useCallback(function(){for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return t.current==null?void 0:t.current(...s)},[])}function rNe(){const e=f.useRef(null),t=f.useCallback((s,r)=>{e.current=setInterval(s,r)},[]),n=f.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function $p(e,t){t===void 0&&(t=[e]);const n=f.useRef(e);return Zi(()=>{n.current!==e&&(n.current=e)},t),n}function Bx(e,t){const n=f.useRef();return f.useMemo(()=>{const s=e(n.current);return n.current=s,s},[...t])}function ow(e){const t=EN(e),n=f.useRef(null),s=f.useCallback(r=>{r!==n.current&&t?.(r,n.current),n.current=r},[]);return[n,s]}function lw(e){const t=f.useRef();return f.useEffect(()=>{t.current=e},[e]),t.current}let z2={};function Hx(e,t){return f.useMemo(()=>{if(t)return t;const n=z2[e]==null?0:z2[e]+1;return z2[e]=n,e+"-"+n},[e,t])}function UV(e){return function(t){for(var n=arguments.length,s=new Array(n>1?n-1:0),r=1;r<n;r++)s[r-1]=arguments[r];return s.reduce((i,o)=>{const l=Object.entries(o);for(const[c,u]of l){const d=i[c];d!=null&&(i[c]=d+e*u)}return i},{...t})}}const _f=UV(1),Rp=UV(-1);function iNe(e){return"clientX"in e&&"clientY"in e}function LN(e){if(!e)return!1;const{KeyboardEvent:t}=Js(e.target);return t&&e instanceof t}function oNe(e){if(!e)return!1;const{TouchEvent:t}=Js(e.target);return t&&e instanceof t}function cw(e){if(oNe(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return iNe(e)?{x:e.clientX,y:e.clientY}:null}const gd=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[gd.Translate.toString(e),gd.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:s}=e;return t+" "+n+"ms "+s}}}),wR="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function lNe(e){return e.matches(wR)?e:e.querySelector(wR)}const cNe={display:"none"};function dNe(e){let{id:t,value:n}=e;return wt.createElement("div",{id:t,style:cNe},n)}function uNe(e){let{id:t,announcement:n,ariaLiveType:s="assertive"}=e;const r={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return wt.createElement("div",{id:t,style:r,role:"status","aria-live":s,"aria-atomic":!0},n)}function mNe(){const[e,t]=f.useState("");return{announce:f.useCallback(s=>{s!=null&&t(s)},[]),announcement:e}}const BV=f.createContext(null);function fNe(e){const t=f.useContext(BV);f.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function hNe(){const[e]=f.useState(()=>new Set),t=f.useCallback(s=>(e.add(s),()=>e.delete(s)),[e]);return[f.useCallback(s=>{let{type:r,event:i}=s;e.forEach(o=>{var l;return(l=o[r])==null?void 0:l.call(o,i)})},[e]),t]}const gNe={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},pNe={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function xNe(e){let{announcements:t=pNe,container:n,hiddenTextDescribedById:s,screenReaderInstructions:r=gNe}=e;const{announce:i,announcement:o}=mNe(),l=Hx("DndLiveRegion"),[c,u]=f.useState(!1);if(f.useEffect(()=>{u(!0)},[]),fNe(f.useMemo(()=>({onDragStart(h){let{active:p}=h;i(t.onDragStart({active:p}))},onDragMove(h){let{active:p,over:x}=h;t.onDragMove&&i(t.onDragMove({active:p,over:x}))},onDragOver(h){let{active:p,over:x}=h;i(t.onDragOver({active:p,over:x}))},onDragEnd(h){let{active:p,over:x}=h;i(t.onDragEnd({active:p,over:x}))},onDragCancel(h){let{active:p,over:x}=h;i(t.onDragCancel({active:p,over:x}))}}),[i,t])),!c)return null;const d=wt.createElement(wt.Fragment,null,wt.createElement(dNe,{id:s,value:r.draggable}),wt.createElement(uNe,{id:l,announcement:o}));return n?Gi.createPortal(d,n):d}var ss;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(ss||(ss={}));function dw(){}function qf(e,t){return f.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function qx(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return f.useMemo(()=>[...t].filter(s=>s!=null),[...t])}const Ji=Object.freeze({x:0,y:0});function HV(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function yNe(e,t){const n=cw(e);if(!n)return"0 0";const s={x:(n.x-t.left)/t.width*100,y:(n.y-t.top)/t.height*100};return s.x+"% "+s.y+"%"}function qV(e,t){let{data:{value:n}}=e,{data:{value:s}}=t;return n-s}function bNe(e,t){let{data:{value:n}}=e,{data:{value:s}}=t;return s-n}function jR(e){let{left:t,top:n,height:s,width:r}=e;return[{x:t,y:n},{x:t+r,y:n},{x:t,y:n+s},{x:t+r,y:n+s}]}function GV(e,t){if(!e||e.length===0)return null;const[n]=e;return n[t]}function NR(e,t,n){return t===void 0&&(t=e.left),n===void 0&&(n=e.top),{x:t+e.width*.5,y:n+e.height*.5}}const Gx=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:s}=e;const r=NR(t,t.left,t.top),i=[];for(const o of s){const{id:l}=o,c=n.get(l);if(c){const u=HV(NR(c),r);i.push({id:l,data:{droppableContainer:o,value:u}})}}return i.sort(qV)},vNe=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:s}=e;const r=jR(t),i=[];for(const o of s){const{id:l}=o,c=n.get(l);if(c){const u=jR(c),d=r.reduce((p,x,b)=>p+HV(u[b],x),0),h=Number((d/4).toFixed(4));i.push({id:l,data:{droppableContainer:o,value:h}})}}return i.sort(qV)};function wNe(e,t){const n=Math.max(t.top,e.top),s=Math.max(t.left,e.left),r=Math.min(t.left+t.width,e.left+e.width),i=Math.min(t.top+t.height,e.top+e.height),o=r-s,l=i-n;if(s<r&&n<i){const c=t.width*t.height,u=e.width*e.height,d=o*l,h=d/(c+u-d);return Number(h.toFixed(4))}return 0}const jNe=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:s}=e;const r=[];for(const i of s){const{id:o}=i,l=n.get(o);if(l){const c=wNe(l,t);c>0&&r.push({id:o,data:{droppableContainer:i,value:c}})}}return r.sort(bNe)};function NNe(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}function WV(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:Ji}function CNe(e){return function(n){for(var s=arguments.length,r=new Array(s>1?s-1:0),i=1;i<s;i++)r[i-1]=arguments[i];return r.reduce((o,l)=>({...o,top:o.top+e*l.y,bottom:o.bottom+e*l.y,left:o.left+e*l.x,right:o.right+e*l.x}),{...n})}}const SNe=CNe(1);function VV(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function _Ne(e,t,n){const s=VV(t);if(!s)return e;const{scaleX:r,scaleY:i,x:o,y:l}=s,c=e.left-o-(1-r)*parseFloat(n),u=e.top-l-(1-i)*parseFloat(n.slice(n.indexOf(" ")+1)),d=r?e.width/r:e.width,h=i?e.height/i:e.height;return{width:d,height:h,top:u,right:c+d,bottom:u+h,left:c}}const ANe={ignoreTransform:!1};function gh(e,t){t===void 0&&(t=ANe);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:u,transformOrigin:d}=Js(e).getComputedStyle(e);u&&(n=_Ne(n,u,d))}const{top:s,left:r,width:i,height:o,bottom:l,right:c}=n;return{top:s,left:r,width:i,height:o,bottom:l,right:c}}function CR(e){return gh(e,{ignoreTransform:!0})}function TNe(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function kNe(e,t){return t===void 0&&(t=Js(e).getComputedStyle(e)),t.position==="fixed"}function ENe(e,t){t===void 0&&(t=Js(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(r=>{const i=t[r];return typeof i=="string"?n.test(i):!1})}function DN(e,t){const n=[];function s(r){if(t!=null&&n.length>=t||!r)return n;if(hD(r)&&r.scrollingElement!=null&&!n.includes(r.scrollingElement))return n.push(r.scrollingElement),n;if(!Ux(r)||FV(r)||n.includes(r))return n;const i=Js(e).getComputedStyle(r);return r!==e&&ENe(r,i)&&n.push(r),kNe(r,i)?n:s(r.parentNode)}return e?s(e):n}function YV(e){const[t]=DN(e,1);return t??null}function F2(e){return!kN||!e?null:fh(e)?e:fD(e)?hD(e)||e===hh(e).scrollingElement?window:Ux(e)?e:null:null}function QV(e){return fh(e)?e.scrollX:e.scrollLeft}function KV(e){return fh(e)?e.scrollY:e.scrollTop}function Xk(e){return{x:QV(e),y:KV(e)}}var xs;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(xs||(xs={}));function XV(e){return!kN||!e?!1:e===document.scrollingElement}function ZV(e){const t={x:0,y:0},n=XV(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},s={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},r=e.scrollTop<=t.y,i=e.scrollLeft<=t.x,o=e.scrollTop>=s.y,l=e.scrollLeft>=s.x;return{isTop:r,isLeft:i,isBottom:o,isRight:l,maxScroll:s,minScroll:t}}const LNe={x:.2,y:.2};function DNe(e,t,n,s,r){let{top:i,left:o,right:l,bottom:c}=n;s===void 0&&(s=10),r===void 0&&(r=LNe);const{isTop:u,isBottom:d,isLeft:h,isRight:p}=ZV(e),x={x:0,y:0},b={x:0,y:0},j={height:t.height*r.y,width:t.width*r.x};return!u&&i<=t.top+j.height?(x.y=xs.Backward,b.y=s*Math.abs((t.top+j.height-i)/j.height)):!d&&c>=t.bottom-j.height&&(x.y=xs.Forward,b.y=s*Math.abs((t.bottom-j.height-c)/j.height)),!p&&l>=t.right-j.width?(x.x=xs.Forward,b.x=s*Math.abs((t.right-j.width-l)/j.width)):!h&&o<=t.left+j.width&&(x.x=xs.Backward,b.x=s*Math.abs((t.left+j.width-o)/j.width)),{direction:x,speed:b}}function PNe(e){if(e===document.scrollingElement){const{innerWidth:i,innerHeight:o}=window;return{top:0,left:0,right:i,bottom:o,width:i,height:o}}const{top:t,left:n,right:s,bottom:r}=e.getBoundingClientRect();return{top:t,left:n,right:s,bottom:r,width:e.clientWidth,height:e.clientHeight}}function JV(e){return e.reduce((t,n)=>_f(t,Xk(n)),Ji)}function ONe(e){return e.reduce((t,n)=>t+QV(n),0)}function MNe(e){return e.reduce((t,n)=>t+KV(n),0)}function eY(e,t){if(t===void 0&&(t=gh),!e)return;const{top:n,left:s,bottom:r,right:i}=t(e);YV(e)&&(r<=0||i<=0||n>=window.innerHeight||s>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const INe=[["x",["left","right"],ONe],["y",["top","bottom"],MNe]];class gD{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const s=DN(n),r=JV(s);this.rect={...t},this.width=t.width,this.height=t.height;for(const[i,o,l]of INe)for(const c of o)Object.defineProperty(this,c,{get:()=>{const u=l(s),d=r[i]-u;return this.rect[c]+d},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class lp{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var s;return(s=this.target)==null?void 0:s.removeEventListener(...n)})},this.target=t}add(t,n,s){var r;(r=this.target)==null||r.addEventListener(t,n,s),this.listeners.push([t,n,s])}}function $Ne(e){const{EventTarget:t}=Js(e);return e instanceof t?e:hh(e)}function U2(e,t){const n=Math.abs(e.x),s=Math.abs(e.y);return typeof t=="number"?Math.sqrt(n**2+s**2)>t:"x"in t&&"y"in t?n>t.x&&s>t.y:"x"in t?n>t.x:"y"in t?s>t.y:!1}var fi;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(fi||(fi={}));function SR(e){e.preventDefault()}function RNe(e){e.stopPropagation()}var va;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(va||(va={}));const tY={start:[va.Space,va.Enter],cancel:[va.Esc],end:[va.Space,va.Enter,va.Tab]},zNe=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case va.Right:return{...n,x:n.x+25};case va.Left:return{...n,x:n.x-25};case va.Down:return{...n,y:n.y+25};case va.Up:return{...n,y:n.y-25}}};class pD{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new lp(hh(n)),this.windowListeners=new lp(Js(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(fi.Resize,this.handleCancel),this.windowListeners.add(fi.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(fi.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,s=t.node.current;s&&eY(s),n(Ji)}handleKeyDown(t){if(LN(t)){const{active:n,context:s,options:r}=this.props,{keyboardCodes:i=tY,coordinateGetter:o=zNe,scrollBehavior:l="smooth"}=r,{code:c}=t;if(i.end.includes(c)){this.handleEnd(t);return}if(i.cancel.includes(c)){this.handleCancel(t);return}const{collisionRect:u}=s.current,d=u?{x:u.left,y:u.top}:Ji;this.referenceCoordinates||(this.referenceCoordinates=d);const h=o(t,{active:n,context:s.current,currentCoordinates:d});if(h){const p=Rp(h,d),x={x:0,y:0},{scrollableAncestors:b}=s.current;for(const j of b){const y=t.code,{isTop:N,isRight:w,isLeft:S,isBottom:_,maxScroll:T,minScroll:k}=ZV(j),A=PNe(j),E={x:Math.min(y===va.Right?A.right-A.width/2:A.right,Math.max(y===va.Right?A.left:A.left+A.width/2,h.x)),y:Math.min(y===va.Down?A.bottom-A.height/2:A.bottom,Math.max(y===va.Down?A.top:A.top+A.height/2,h.y))},M=y===va.Right&&!w||y===va.Left&&!S,F=y===va.Down&&!_||y===va.Up&&!N;if(M&&E.x!==h.x){const D=j.scrollLeft+p.x,P=y===va.Right&&D<=T.x||y===va.Left&&D>=k.x;if(P&&!p.y){j.scrollTo({left:D,behavior:l});return}P?x.x=j.scrollLeft-D:x.x=y===va.Right?j.scrollLeft-T.x:j.scrollLeft-k.x,x.x&&j.scrollBy({left:-x.x,behavior:l});break}else if(F&&E.y!==h.y){const D=j.scrollTop+p.y,P=y===va.Down&&D<=T.y||y===va.Up&&D>=k.y;if(P&&!p.x){j.scrollTo({top:D,behavior:l});return}P?x.y=j.scrollTop-D:x.y=y===va.Down?j.scrollTop-T.y:j.scrollTop-k.y,x.y&&j.scrollBy({top:-x.y,behavior:l});break}}this.handleMove(t,_f(Rp(h,this.referenceCoordinates),x))}}}handleMove(t,n){const{onMove:s}=this.props;t.preventDefault(),s(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}pD.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:s=tY,onActivation:r}=t,{active:i}=n;const{code:o}=e.nativeEvent;if(s.start.includes(o)){const l=i.activatorNode.current;return l&&e.target!==l?!1:(e.preventDefault(),r?.({event:e.nativeEvent}),!0)}return!1}}];function _R(e){return!!(e&&"distance"in e)}function AR(e){return!!(e&&"delay"in e)}class xD{constructor(t,n,s){var r;s===void 0&&(s=$Ne(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:i}=t,{target:o}=i;this.props=t,this.events=n,this.document=hh(o),this.documentListeners=new lp(this.document),this.listeners=new lp(s),this.windowListeners=new lp(Js(o)),this.initialCoordinates=(r=cw(i))!=null?r:Ji,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n,bypassActivationConstraint:s}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(fi.Resize,this.handleCancel),this.windowListeners.add(fi.DragStart,SR),this.windowListeners.add(fi.VisibilityChange,this.handleCancel),this.windowListeners.add(fi.ContextMenu,SR),this.documentListeners.add(fi.Keydown,this.handleKeydown),n){if(s!=null&&s({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(AR(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(_R(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,n){const{active:s,onPending:r}=this.props;r(s,t,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(fi.Click,RNe,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(fi.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:s,initialCoordinates:r,props:i}=this,{onMove:o,options:{activationConstraint:l}}=i;if(!r)return;const c=(n=cw(t))!=null?n:Ji,u=Rp(r,c);if(!s&&l){if(_R(l)){if(l.tolerance!=null&&U2(u,l.tolerance))return this.handleCancel();if(U2(u,l.distance))return this.handleStart()}if(AR(l)&&U2(u,l.tolerance))return this.handleCancel();this.handlePending(l,u);return}t.cancelable&&t.preventDefault(),o(c)}handleEnd(){const{onAbort:t,onEnd:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleCancel(){const{onAbort:t,onCancel:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleKeydown(t){t.code===va.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const FNe={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class dm extends xD{constructor(t){const{event:n}=t,s=hh(n.target);super(t,FNe,s)}}dm.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:s}=t;return!n.isPrimary||n.button!==0?!1:(s?.({event:n}),!0)}}];const UNe={move:{name:"mousemove"},end:{name:"mouseup"}};var Zk;(function(e){e[e.RightClick=2]="RightClick"})(Zk||(Zk={}));class BNe extends xD{constructor(t){super(t,UNe,hh(t.event.target))}}BNe.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:s}=t;return n.button===Zk.RightClick?!1:(s?.({event:n}),!0)}}];const B2={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class HNe extends xD{constructor(t){super(t,B2)}static setup(){return window.addEventListener(B2.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(B2.move.name,t)};function t(){}}}HNe.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:s}=t;const{touches:r}=n;return r.length>1?!1:(s?.({event:n}),!0)}}];var cp;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(cp||(cp={}));var uw;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(uw||(uw={}));function qNe(e){let{acceleration:t,activator:n=cp.Pointer,canScroll:s,draggingRect:r,enabled:i,interval:o=5,order:l=uw.TreeOrder,pointerCoordinates:c,scrollableAncestors:u,scrollableAncestorRects:d,delta:h,threshold:p}=e;const x=WNe({delta:h,disabled:!i}),[b,j]=rNe(),y=f.useRef({x:0,y:0}),N=f.useRef({x:0,y:0}),w=f.useMemo(()=>{switch(n){case cp.Pointer:return c?{top:c.y,bottom:c.y,left:c.x,right:c.x}:null;case cp.DraggableRect:return r}},[n,r,c]),S=f.useRef(null),_=f.useCallback(()=>{const k=S.current;if(!k)return;const A=y.current.x*N.current.x,E=y.current.y*N.current.y;k.scrollBy(A,E)},[]),T=f.useMemo(()=>l===uw.TreeOrder?[...u].reverse():u,[l,u]);f.useEffect(()=>{if(!i||!u.length||!w){j();return}for(const k of T){if(s?.(k)===!1)continue;const A=u.indexOf(k),E=d[A];if(!E)continue;const{direction:M,speed:F}=DNe(k,E,w,t,p);for(const D of["x","y"])x[D][M[D]]||(F[D]=0,M[D]=0);if(F.x>0||F.y>0){j(),S.current=k,b(_,o),y.current=F,N.current=M;return}}y.current={x:0,y:0},N.current={x:0,y:0},j()},[t,_,s,j,i,o,JSON.stringify(w),JSON.stringify(x),b,u,T,d,JSON.stringify(p)])}const GNe={x:{[xs.Backward]:!1,[xs.Forward]:!1},y:{[xs.Backward]:!1,[xs.Forward]:!1}};function WNe(e){let{delta:t,disabled:n}=e;const s=lw(t);return Bx(r=>{if(n||!s||!r)return GNe;const i={x:Math.sign(t.x-s.x),y:Math.sign(t.y-s.y)};return{x:{[xs.Backward]:r.x[xs.Backward]||i.x===-1,[xs.Forward]:r.x[xs.Forward]||i.x===1},y:{[xs.Backward]:r.y[xs.Backward]||i.y===-1,[xs.Forward]:r.y[xs.Forward]||i.y===1}}},[n,t,s])}function VNe(e,t){const n=t!=null?e.get(t):void 0,s=n?n.node.current:null;return Bx(r=>{var i;return t==null?null:(i=s??r)!=null?i:null},[s,t])}function YNe(e,t){return f.useMemo(()=>e.reduce((n,s)=>{const{sensor:r}=s,i=r.activators.map(o=>({eventName:o.eventName,handler:t(o.handler,s)}));return[...n,...i]},[]),[e,t])}var zp;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(zp||(zp={}));var Jk;(function(e){e.Optimized="optimized"})(Jk||(Jk={}));const TR=new Map;function QNe(e,t){let{dragging:n,dependencies:s,config:r}=t;const[i,o]=f.useState(null),{frequency:l,measure:c,strategy:u}=r,d=f.useRef(e),h=y(),p=$p(h),x=f.useCallback(function(N){N===void 0&&(N=[]),!p.current&&o(w=>w===null?N:w.concat(N.filter(S=>!w.includes(S))))},[p]),b=f.useRef(null),j=Bx(N=>{if(h&&!n)return TR;if(!N||N===TR||d.current!==e||i!=null){const w=new Map;for(let S of e){if(!S)continue;if(i&&i.length>0&&!i.includes(S.id)&&S.rect.current){w.set(S.id,S.rect.current);continue}const _=S.node.current,T=_?new gD(c(_),_):null;S.rect.current=T,T&&w.set(S.id,T)}return w}return N},[e,i,n,h,c]);return f.useEffect(()=>{d.current=e},[e]),f.useEffect(()=>{h||x()},[n,h]),f.useEffect(()=>{i&&i.length>0&&o(null)},[JSON.stringify(i)]),f.useEffect(()=>{h||typeof l!="number"||b.current!==null||(b.current=setTimeout(()=>{x(),b.current=null},l))},[l,h,x,...s]),{droppableRects:j,measureDroppableContainers:x,measuringScheduled:i!=null};function y(){switch(u){case zp.Always:return!1;case zp.BeforeDragging:return n;default:return!n}}}function yD(e,t){return Bx(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function KNe(e,t){return yD(e,t)}function XNe(e){let{callback:t,disabled:n}=e;const s=EN(t),r=f.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:i}=window;return new i(s)},[s,n]);return f.useEffect(()=>()=>r?.disconnect(),[r]),r}function PN(e){let{callback:t,disabled:n}=e;const s=EN(t),r=f.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:i}=window;return new i(s)},[n]);return f.useEffect(()=>()=>r?.disconnect(),[r]),r}function ZNe(e){return new gD(gh(e),e)}function kR(e,t,n){t===void 0&&(t=ZNe);const[s,r]=f.useState(null);function i(){r(c=>{if(!e)return null;if(e.isConnected===!1){var u;return(u=c??n)!=null?u:null}const d=t(e);return JSON.stringify(c)===JSON.stringify(d)?c:d})}const o=XNe({callback(c){if(e)for(const u of c){const{type:d,target:h}=u;if(d==="childList"&&h instanceof HTMLElement&&h.contains(e)){i();break}}}}),l=PN({callback:i});return Zi(()=>{i(),e?(l?.observe(e),o?.observe(document.body,{childList:!0,subtree:!0})):(l?.disconnect(),o?.disconnect())},[e]),s}function JNe(e){const t=yD(e);return WV(e,t)}const ER=[];function e1e(e){const t=f.useRef(e),n=Bx(s=>e?s&&s!==ER&&e&&t.current&&e.parentNode===t.current.parentNode?s:DN(e):ER,[e]);return f.useEffect(()=>{t.current=e},[e]),n}function t1e(e){const[t,n]=f.useState(null),s=f.useRef(e),r=f.useCallback(i=>{const o=F2(i.target);o&&n(l=>l?(l.set(o,Xk(o)),new Map(l)):null)},[]);return f.useEffect(()=>{const i=s.current;if(e!==i){o(i);const l=e.map(c=>{const u=F2(c);return u?(u.addEventListener("scroll",r,{passive:!0}),[u,Xk(u)]):null}).filter(c=>c!=null);n(l.length?new Map(l):null),s.current=e}return()=>{o(e),o(i)};function o(l){l.forEach(c=>{const u=F2(c);u?.removeEventListener("scroll",r)})}},[r,e]),f.useMemo(()=>e.length?t?Array.from(t.values()).reduce((i,o)=>_f(i,o),Ji):JV(e):Ji,[e,t])}function LR(e,t){t===void 0&&(t=[]);const n=f.useRef(null);return f.useEffect(()=>{n.current=null},t),f.useEffect(()=>{const s=e!==Ji;s&&!n.current&&(n.current=e),!s&&n.current&&(n.current=null)},[e]),n.current?Rp(e,n.current):Ji}function a1e(e){f.useEffect(()=>{if(!kN)return;const t=e.map(n=>{let{sensor:s}=n;return s.setup==null?void 0:s.setup()});return()=>{for(const n of t)n?.()}},e.map(t=>{let{sensor:n}=t;return n}))}function n1e(e,t){return f.useMemo(()=>e.reduce((n,s)=>{let{eventName:r,handler:i}=s;return n[r]=o=>{i(o,t)},n},{}),[e,t])}function aY(e){return f.useMemo(()=>e?TNe(e):null,[e])}const DR=[];function s1e(e,t){t===void 0&&(t=gh);const[n]=e,s=aY(n?Js(n):null),[r,i]=f.useState(DR);function o(){i(()=>e.length?e.map(c=>XV(c)?s:new gD(t(c),c)):DR)}const l=PN({callback:o});return Zi(()=>{l?.disconnect(),o(),e.forEach(c=>l?.observe(c))},[e]),r}function nY(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return Ux(t)?t:e}function r1e(e){let{measure:t}=e;const[n,s]=f.useState(null),r=f.useCallback(u=>{for(const{target:d}of u)if(Ux(d)){s(h=>{const p=t(d);return h?{...h,width:p.width,height:p.height}:p});break}},[t]),i=PN({callback:r}),o=f.useCallback(u=>{const d=nY(u);i?.disconnect(),d&&i?.observe(d),s(d?t(d):null)},[t,i]),[l,c]=ow(o);return f.useMemo(()=>({nodeRef:l,rect:n,setRef:c}),[n,l,c])}const i1e=[{sensor:dm,options:{}},{sensor:pD,options:{}}],o1e={current:{}},yv={draggable:{measure:CR},droppable:{measure:CR,strategy:zp.WhileDragging,frequency:Jk.Optimized},dragOverlay:{measure:gh}};class dp extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,s;return(n=(s=this.get(t))==null?void 0:s.node.current)!=null?n:void 0}}const l1e={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new dp,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:dw},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:yv,measureDroppableContainers:dw,windowRect:null,measuringScheduled:!1},sY={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:dw,draggableNodes:new Map,over:null,measureDroppableContainers:dw},Wx=f.createContext(sY),rY=f.createContext(l1e);function c1e(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new dp}}}function d1e(e,t){switch(t.type){case ss.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case ss.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case ss.DragEnd:case ss.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case ss.RegisterDroppable:{const{element:n}=t,{id:s}=n,r=new dp(e.droppable.containers);return r.set(s,n),{...e,droppable:{...e.droppable,containers:r}}}case ss.SetDroppableDisabled:{const{id:n,key:s,disabled:r}=t,i=e.droppable.containers.get(n);if(!i||s!==i.key)return e;const o=new dp(e.droppable.containers);return o.set(n,{...i,disabled:r}),{...e,droppable:{...e.droppable,containers:o}}}case ss.UnregisterDroppable:{const{id:n,key:s}=t,r=e.droppable.containers.get(n);if(!r||s!==r.key)return e;const i=new dp(e.droppable.containers);return i.delete(n),{...e,droppable:{...e.droppable,containers:i}}}default:return e}}function u1e(e){let{disabled:t}=e;const{active:n,activatorEvent:s,draggableNodes:r}=f.useContext(Wx),i=lw(s),o=lw(n?.id);return f.useEffect(()=>{if(!t&&!s&&i&&o!=null){if(!LN(i)||document.activeElement===i.target)return;const l=r.get(o);if(!l)return;const{activatorNode:c,node:u}=l;if(!c.current&&!u.current)return;requestAnimationFrame(()=>{for(const d of[c.current,u.current]){if(!d)continue;const h=lNe(d);if(h){h.focus();break}}})}},[s,t,r,o,i]),null}function iY(e,t){let{transform:n,...s}=t;return e!=null&&e.length?e.reduce((r,i)=>i({transform:r,...s}),n):n}function m1e(e){return f.useMemo(()=>({draggable:{...yv.draggable,...e?.draggable},droppable:{...yv.droppable,...e?.droppable},dragOverlay:{...yv.dragOverlay,...e?.dragOverlay}}),[e?.draggable,e?.droppable,e?.dragOverlay])}function f1e(e){let{activeNode:t,measure:n,initialRect:s,config:r=!0}=e;const i=f.useRef(!1),{x:o,y:l}=typeof r=="boolean"?{x:r,y:r}:r;Zi(()=>{if(!o&&!l||!t){i.current=!1;return}if(i.current||!s)return;const u=t?.node.current;if(!u||u.isConnected===!1)return;const d=n(u),h=WV(d,s);if(o||(h.x=0),l||(h.y=0),i.current=!0,Math.abs(h.x)>0||Math.abs(h.y)>0){const p=YV(u);p&&p.scrollBy({top:h.y,left:h.x})}},[t,o,l,s,n])}const ON=f.createContext({...Ji,scaleX:1,scaleY:1});var Vc;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(Vc||(Vc={}));const Vx=f.memo(function(t){var n,s,r,i;let{id:o,accessibility:l,autoScroll:c=!0,children:u,sensors:d=i1e,collisionDetection:h=jNe,measuring:p,modifiers:x,...b}=t;const j=f.useReducer(d1e,void 0,c1e),[y,N]=j,[w,S]=hNe(),[_,T]=f.useState(Vc.Uninitialized),k=_===Vc.Initialized,{draggable:{active:A,nodes:E,translate:M},droppable:{containers:F}}=y,D=A!=null?E.get(A):null,P=f.useRef({initial:null,translated:null}),B=f.useMemo(()=>{var jt;return A!=null?{id:A,data:(jt=D?.data)!=null?jt:o1e,rect:P}:null},[A,D]),G=f.useRef(null),[$,W]=f.useState(null),[Z,Q]=f.useState(null),le=$p(b,Object.values(b)),we=Hx("DndDescribedBy",o),J=f.useMemo(()=>F.getEnabled(),[F]),se=m1e(p),{droppableRects:ye,measureDroppableContainers:Ce,measuringScheduled:ge}=QNe(J,{dragging:k,dependencies:[M.x,M.y],config:se.droppable}),be=VNe(E,A),me=f.useMemo(()=>Z?cw(Z):null,[Z]),Ae=Ct(),pe=KNe(be,se.draggable.measure);f1e({activeNode:A!=null?E.get(A):null,config:Ae.layoutShiftCompensation,initialRect:pe,measure:se.draggable.measure});const Ie=kR(be,se.draggable.measure,pe),xe=kR(be?be.parentElement:null),he=f.useRef({activatorEvent:null,active:null,activeNode:be,collisionRect:null,collisions:null,droppableRects:ye,draggableNodes:E,draggingNode:null,draggingNodeRect:null,droppableContainers:F,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),Re=F.getNodeFor((n=he.current.over)==null?void 0:n.id),Ee=r1e({measure:se.dragOverlay.measure}),He=(s=Ee.nodeRef.current)!=null?s:be,Ke=k?(r=Ee.rect)!=null?r:Ie:null,st=!!(Ee.nodeRef.current&&Ee.rect),it=JNe(st?null:Ie),ot=aY(He?Js(He):null),rt=e1e(k?Re??be:null),at=s1e(rt),Je=iY(x,{transform:{x:M.x-it.x,y:M.y-it.y,scaleX:1,scaleY:1},activatorEvent:Z,active:B,activeNodeRect:Ie,containerNodeRect:xe,draggingNodeRect:Ke,over:he.current.over,overlayNodeRect:Ee.rect,scrollableAncestors:rt,scrollableAncestorRects:at,windowRect:ot}),Fe=me?_f(me,M):null,Ue=t1e(rt),Ne=LR(Ue),ze=LR(Ue,[Ie]),je=_f(Je,Ne),ve=Ke?SNe(Ke,Je):null,z=B&&ve?h({active:B,collisionRect:ve,droppableRects:ye,droppableContainers:J,pointerCoordinates:Fe}):null,K=GV(z,"id"),[ue,re]=f.useState(null),Le=st?Je:_f(Je,ze),De=NNe(Le,(i=ue?.rect)!=null?i:null,Ie),Qe=f.useRef(null),tt=f.useCallback((jt,At)=>{let{sensor:Ge,options:Be}=At;if(G.current==null)return;const ce=E.get(G.current);if(!ce)return;const fe=jt.nativeEvent,H=new Ge({active:G.current,activeNode:ce,event:fe,options:Be,context:he,onAbort(q){if(!E.get(q))return;const{onDragAbort:U}=le.current,de={id:q};U?.(de),w({type:"onDragAbort",event:de})},onPending(q,Y,U,de){if(!E.get(q))return;const{onDragPending:ie}=le.current,Oe={id:q,constraint:Y,initialCoordinates:U,offset:de};ie?.(Oe),w({type:"onDragPending",event:Oe})},onStart(q){const Y=G.current;if(Y==null)return;const U=E.get(Y);if(!U)return;const{onDragStart:de}=le.current,Te={activatorEvent:fe,active:{id:Y,data:U.data,rect:P}};Gi.unstable_batchedUpdates(()=>{de?.(Te),T(Vc.Initializing),N({type:ss.DragStart,initialCoordinates:q,active:Y}),w({type:"onDragStart",event:Te}),W(Qe.current),Q(fe)})},onMove(q){N({type:ss.DragMove,coordinates:q})},onEnd:te(ss.DragEnd),onCancel:te(ss.DragCancel)});Qe.current=H;function te(q){return async function(){const{active:U,collisions:de,over:Te,scrollAdjustedTranslate:ie}=he.current;let Oe=null;if(U&&ie){const{cancelDrop:X}=le.current;Oe={activatorEvent:fe,active:U,collisions:de,delta:ie,over:Te},q===ss.DragEnd&&typeof X=="function"&&await Promise.resolve(X(Oe))&&(q=ss.DragCancel)}G.current=null,Gi.unstable_batchedUpdates(()=>{N({type:q}),T(Vc.Uninitialized),re(null),W(null),Q(null),Qe.current=null;const X=q===ss.DragEnd?"onDragEnd":"onDragCancel";if(Oe){const oe=le.current[X];oe?.(Oe),w({type:X,event:Oe})}})}}},[E]),Me=f.useCallback((jt,At)=>(Ge,Be)=>{const ce=Ge.nativeEvent,fe=E.get(Be);if(G.current!==null||!fe||ce.dndKit||ce.defaultPrevented)return;const H={active:fe};jt(Ge,At.options,H)===!0&&(ce.dndKit={capturedBy:At.sensor},G.current=Be,tt(Ge,At))},[E,tt]),et=YNe(d,Me);a1e(d),Zi(()=>{Ie&&_===Vc.Initializing&&T(Vc.Initialized)},[Ie,_]),f.useEffect(()=>{const{onDragMove:jt}=le.current,{active:At,activatorEvent:Ge,collisions:Be,over:ce}=he.current;if(!At||!Ge)return;const fe={active:At,activatorEvent:Ge,collisions:Be,delta:{x:je.x,y:je.y},over:ce};Gi.unstable_batchedUpdates(()=>{jt?.(fe),w({type:"onDragMove",event:fe})})},[je.x,je.y]),f.useEffect(()=>{const{active:jt,activatorEvent:At,collisions:Ge,droppableContainers:Be,scrollAdjustedTranslate:ce}=he.current;if(!jt||G.current==null||!At||!ce)return;const{onDragOver:fe}=le.current,H=Be.get(K),te=H&&H.rect.current?{id:H.id,rect:H.rect.current,data:H.data,disabled:H.disabled}:null,q={active:jt,activatorEvent:At,collisions:Ge,delta:{x:ce.x,y:ce.y},over:te};Gi.unstable_batchedUpdates(()=>{re(te),fe?.(q),w({type:"onDragOver",event:q})})},[K]),Zi(()=>{he.current={activatorEvent:Z,active:B,activeNode:be,collisionRect:ve,collisions:z,droppableRects:ye,draggableNodes:E,draggingNode:He,draggingNodeRect:Ke,droppableContainers:F,over:ue,scrollableAncestors:rt,scrollAdjustedTranslate:je},P.current={initial:Ke,translated:ve}},[B,be,z,ve,E,He,Ke,ye,F,ue,rt,je]),qNe({...Ae,delta:M,draggingRect:ve,pointerCoordinates:Fe,scrollableAncestors:rt,scrollableAncestorRects:at});const yt=f.useMemo(()=>({active:B,activeNode:be,activeNodeRect:Ie,activatorEvent:Z,collisions:z,containerNodeRect:xe,dragOverlay:Ee,draggableNodes:E,droppableContainers:F,droppableRects:ye,over:ue,measureDroppableContainers:Ce,scrollableAncestors:rt,scrollableAncestorRects:at,measuringConfiguration:se,measuringScheduled:ge,windowRect:ot}),[B,be,Ie,Z,z,xe,Ee,E,F,ye,ue,Ce,rt,at,se,ge,ot]),_t=f.useMemo(()=>({activatorEvent:Z,activators:et,active:B,activeNodeRect:Ie,ariaDescribedById:{draggable:we},dispatch:N,draggableNodes:E,over:ue,measureDroppableContainers:Ce}),[Z,et,B,Ie,N,we,E,ue,Ce]);return wt.createElement(BV.Provider,{value:S},wt.createElement(Wx.Provider,{value:_t},wt.createElement(rY.Provider,{value:yt},wt.createElement(ON.Provider,{value:De},u)),wt.createElement(u1e,{disabled:l?.restoreFocus===!1})),wt.createElement(xNe,{...l,hiddenTextDescribedById:we}));function Ct(){const jt=$?.autoScrollEnabled===!1,At=typeof c=="object"?c.enabled===!1:c===!1,Ge=k&&!jt&&!At;return typeof c=="object"?{...c,enabled:Ge}:{enabled:Ge}}}),h1e=f.createContext(null),PR="button",g1e="Draggable";function Yx(e){let{id:t,data:n,disabled:s=!1,attributes:r}=e;const i=Hx(g1e),{activators:o,activatorEvent:l,active:c,activeNodeRect:u,ariaDescribedById:d,draggableNodes:h,over:p}=f.useContext(Wx),{role:x=PR,roleDescription:b="draggable",tabIndex:j=0}=r??{},y=c?.id===t,N=f.useContext(y?ON:h1e),[w,S]=ow(),[_,T]=ow(),k=n1e(o,t),A=$p(n);Zi(()=>(h.set(t,{id:t,key:i,node:w,activatorNode:_,data:A}),()=>{const M=h.get(t);M&&M.key===i&&h.delete(t)}),[h,t]);const E=f.useMemo(()=>({role:x,tabIndex:j,"aria-disabled":s,"aria-pressed":y&&x===PR?!0:void 0,"aria-roledescription":b,"aria-describedby":d.draggable}),[s,x,j,y,b,d.draggable]);return{active:c,activatorEvent:l,activeNodeRect:u,attributes:E,isDragging:y,listeners:s?void 0:k,node:w,over:p,setNodeRef:S,setActivatorNodeRef:T,transform:N}}function oY(){return f.useContext(rY)}const p1e="Droppable",x1e={timeout:25};function Qx(e){let{data:t,disabled:n=!1,id:s,resizeObserverConfig:r}=e;const i=Hx(p1e),{active:o,dispatch:l,over:c,measureDroppableContainers:u}=f.useContext(Wx),d=f.useRef({disabled:n}),h=f.useRef(!1),p=f.useRef(null),x=f.useRef(null),{disabled:b,updateMeasurementsFor:j,timeout:y}={...x1e,...r},N=$p(j??s),w=f.useCallback(()=>{if(!h.current){h.current=!0;return}x.current!=null&&clearTimeout(x.current),x.current=setTimeout(()=>{u(Array.isArray(N.current)?N.current:[N.current]),x.current=null},y)},[y]),S=PN({callback:w,disabled:b||!o}),_=f.useCallback((E,M)=>{S&&(M&&(S.unobserve(M),h.current=!1),E&&S.observe(E))},[S]),[T,k]=ow(_),A=$p(t);return f.useEffect(()=>{!S||!T.current||(S.disconnect(),h.current=!1,S.observe(T.current))},[T,S]),f.useEffect(()=>(l({type:ss.RegisterDroppable,element:{id:s,key:i,disabled:n,node:T,rect:p,data:A}}),()=>l({type:ss.UnregisterDroppable,key:i,id:s})),[s]),f.useEffect(()=>{n!==d.current.disabled&&(l({type:ss.SetDroppableDisabled,id:s,key:i,disabled:n}),d.current.disabled=n)},[s,i,n,l]),{active:o,rect:p,isOver:c?.id===s,node:T,over:c,setNodeRef:k}}function y1e(e){let{animation:t,children:n}=e;const[s,r]=f.useState(null),[i,o]=f.useState(null),l=lw(n);return!n&&!s&&l&&r(l),Zi(()=>{if(!i)return;const c=s?.key,u=s?.props.id;if(c==null||u==null){r(null);return}Promise.resolve(t(u,i)).then(()=>{r(null)})},[t,s,i]),wt.createElement(wt.Fragment,null,n,s?f.cloneElement(s,{ref:o}):null)}const b1e={x:0,y:0,scaleX:1,scaleY:1};function v1e(e){let{children:t}=e;return wt.createElement(Wx.Provider,{value:sY},wt.createElement(ON.Provider,{value:b1e},t))}const w1e={position:"fixed",touchAction:"none"},j1e=e=>LN(e)?"transform 250ms ease":void 0,N1e=f.forwardRef((e,t)=>{let{as:n,activatorEvent:s,adjustScale:r,children:i,className:o,rect:l,style:c,transform:u,transition:d=j1e}=e;if(!l)return null;const h=r?u:{...u,scaleX:1,scaleY:1},p={...w1e,width:l.width,height:l.height,top:l.top,left:l.left,transform:gd.Transform.toString(h),transformOrigin:r&&s?yNe(s,l):void 0,transition:typeof d=="function"?d(s):d,...c};return wt.createElement(n,{className:o,style:p,ref:t},i)}),C1e=e=>t=>{let{active:n,dragOverlay:s}=t;const r={},{styles:i,className:o}=e;if(i!=null&&i.active)for(const[l,c]of Object.entries(i.active))c!==void 0&&(r[l]=n.node.style.getPropertyValue(l),n.node.style.setProperty(l,c));if(i!=null&&i.dragOverlay)for(const[l,c]of Object.entries(i.dragOverlay))c!==void 0&&s.node.style.setProperty(l,c);return o!=null&&o.active&&n.node.classList.add(o.active),o!=null&&o.dragOverlay&&s.node.classList.add(o.dragOverlay),function(){for(const[c,u]of Object.entries(r))n.node.style.setProperty(c,u);o!=null&&o.active&&n.node.classList.remove(o.active)}},S1e=e=>{let{transform:{initial:t,final:n}}=e;return[{transform:gd.Transform.toString(t)},{transform:gd.Transform.toString(n)}]},_1e={duration:250,easing:"ease",keyframes:S1e,sideEffects:C1e({styles:{active:{opacity:"0"}}})};function A1e(e){let{config:t,draggableNodes:n,droppableContainers:s,measuringConfiguration:r}=e;return EN((i,o)=>{if(t===null)return;const l=n.get(i);if(!l)return;const c=l.node.current;if(!c)return;const u=nY(o);if(!u)return;const{transform:d}=Js(o).getComputedStyle(o),h=VV(d);if(!h)return;const p=typeof t=="function"?t:T1e(t);return eY(c,r.draggable.measure),p({active:{id:i,data:l.data,node:c,rect:r.draggable.measure(c)},draggableNodes:n,dragOverlay:{node:o,rect:r.dragOverlay.measure(u)},droppableContainers:s,measuringConfiguration:r,transform:h})})}function T1e(e){const{duration:t,easing:n,sideEffects:s,keyframes:r}={..._1e,...e};return i=>{let{active:o,dragOverlay:l,transform:c,...u}=i;if(!t)return;const d={x:l.rect.left-o.rect.left,y:l.rect.top-o.rect.top},h={scaleX:c.scaleX!==1?o.rect.width*c.scaleX/l.rect.width:1,scaleY:c.scaleY!==1?o.rect.height*c.scaleY/l.rect.height:1},p={x:c.x-d.x,y:c.y-d.y,...h},x=r({...u,active:o,dragOverlay:l,transform:{initial:c,final:p}}),[b]=x,j=x[x.length-1];if(JSON.stringify(b)===JSON.stringify(j))return;const y=s?.({active:o,dragOverlay:l,...u}),N=l.node.animate(x,{duration:t,easing:n,fill:"forwards"});return new Promise(w=>{N.onfinish=()=>{y?.(),w()}})}}let OR=0;function k1e(e){return f.useMemo(()=>{if(e!=null)return OR++,OR},[e])}const MN=wt.memo(e=>{let{adjustScale:t=!1,children:n,dropAnimation:s,style:r,transition:i,modifiers:o,wrapperElement:l="div",className:c,zIndex:u=999}=e;const{activatorEvent:d,active:h,activeNodeRect:p,containerNodeRect:x,draggableNodes:b,droppableContainers:j,dragOverlay:y,over:N,measuringConfiguration:w,scrollableAncestors:S,scrollableAncestorRects:_,windowRect:T}=oY(),k=f.useContext(ON),A=k1e(h?.id),E=iY(o,{activatorEvent:d,active:h,activeNodeRect:p,containerNodeRect:x,draggingNodeRect:y.rect,over:N,overlayNodeRect:y.rect,scrollableAncestors:S,scrollableAncestorRects:_,transform:k,windowRect:T}),M=yD(p),F=A1e({config:s,draggableNodes:b,droppableContainers:j,measuringConfiguration:w}),D=M?y.setRef:void 0;return wt.createElement(v1e,null,wt.createElement(y1e,{animation:F},h&&A?wt.createElement(N1e,{key:A,id:h.id,ref:D,as:l,activatorEvent:d,adjustScale:t,className:c,transition:i,rect:M,style:{zIndex:u,...r},transform:E},n):null))});function bD(e,t,n){const s=e.slice();return s.splice(n<0?s.length+n:n,0,s.splice(t,1)[0]),s}function E1e(e,t){return e.reduce((n,s,r)=>{const i=t.get(s);return i&&(n[r]=i),n},Array(e.length))}function sb(e){return e!==null&&e>=0}function L1e(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function D1e(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const vD=e=>{let{rects:t,activeIndex:n,overIndex:s,index:r}=e;const i=bD(t,s,n),o=t[r],l=i[r];return!l||!o?null:{x:l.left-o.left,y:l.top-o.top,scaleX:l.width/o.width,scaleY:l.height/o.height}},lY="Sortable",cY=wt.createContext({activeIndex:-1,containerId:lY,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:vD,disabled:{draggable:!1,droppable:!1}});function P1e(e){let{children:t,id:n,items:s,strategy:r=vD,disabled:i=!1}=e;const{active:o,dragOverlay:l,droppableRects:c,over:u,measureDroppableContainers:d}=oY(),h=Hx(lY,n),p=l.rect!==null,x=f.useMemo(()=>s.map(k=>typeof k=="object"&&"id"in k?k.id:k),[s]),b=o!=null,j=o?x.indexOf(o.id):-1,y=u?x.indexOf(u.id):-1,N=f.useRef(x),w=!L1e(x,N.current),S=y!==-1&&j===-1||w,_=D1e(i);Zi(()=>{w&&b&&d(x)},[w,x,b,d]),f.useEffect(()=>{N.current=x},[x]);const T=f.useMemo(()=>({activeIndex:j,containerId:h,disabled:_,disableTransforms:S,items:x,overIndex:y,useDragOverlay:p,sortedRects:E1e(x,c),strategy:r}),[j,h,_.draggable,_.droppable,S,x,y,c,p,r]);return wt.createElement(cY.Provider,{value:T},t)}const O1e=e=>{let{id:t,items:n,activeIndex:s,overIndex:r}=e;return bD(n,s,r).indexOf(t)},M1e=e=>{let{containerId:t,isSorting:n,wasDragging:s,index:r,items:i,newIndex:o,previousItems:l,previousContainerId:c,transition:u}=e;return!u||!s||l!==i&&r===o?!1:n?!0:o!==r&&t===c},I1e={duration:200,easing:"ease"},dY="transform",$1e=gd.Transition.toString({property:dY,duration:0,easing:"linear"}),R1e={roleDescription:"sortable"};function z1e(e){let{disabled:t,index:n,node:s,rect:r}=e;const[i,o]=f.useState(null),l=f.useRef(n);return Zi(()=>{if(!t&&n!==l.current&&s.current){const c=r.current;if(c){const u=gh(s.current,{ignoreTransform:!0}),d={x:c.left-u.left,y:c.top-u.top,scaleX:c.width/u.width,scaleY:c.height/u.height};(d.x||d.y)&&o(d)}}n!==l.current&&(l.current=n)},[t,n,s,r]),f.useEffect(()=>{i&&o(null)},[i]),i}function F1e(e){let{animateLayoutChanges:t=M1e,attributes:n,disabled:s,data:r,getNewIndex:i=O1e,id:o,strategy:l,resizeObserverConfig:c,transition:u=I1e}=e;const{items:d,containerId:h,activeIndex:p,disabled:x,disableTransforms:b,sortedRects:j,overIndex:y,useDragOverlay:N,strategy:w}=f.useContext(cY),S=U1e(s,x),_=d.indexOf(o),T=f.useMemo(()=>({sortable:{containerId:h,index:_,items:d},...r}),[h,r,_,d]),k=f.useMemo(()=>d.slice(d.indexOf(o)),[d,o]),{rect:A,node:E,isOver:M,setNodeRef:F}=Qx({id:o,data:T,disabled:S.droppable,resizeObserverConfig:{updateMeasurementsFor:k,...c}}),{active:D,activatorEvent:P,activeNodeRect:B,attributes:G,setNodeRef:$,listeners:W,isDragging:Z,over:Q,setActivatorNodeRef:le,transform:we}=Yx({id:o,data:T,attributes:{...R1e,...n},disabled:S.draggable}),J=sNe(F,$),se=!!D,ye=se&&!b&&sb(p)&&sb(y),Ce=!N&&Z,ge=Ce&&ye?we:null,me=ye?ge??(l??w)({rects:j,activeNodeRect:B,activeIndex:p,overIndex:y,index:_}):null,Ae=sb(p)&&sb(y)?i({id:o,items:d,activeIndex:p,overIndex:y}):_,pe=D?.id,Ie=f.useRef({activeId:pe,items:d,newIndex:Ae,containerId:h}),xe=d!==Ie.current.items,he=t({active:D,containerId:h,isDragging:Z,isSorting:se,id:o,index:_,items:d,newIndex:Ie.current.newIndex,previousItems:Ie.current.items,previousContainerId:Ie.current.containerId,transition:u,wasDragging:Ie.current.activeId!=null}),Re=z1e({disabled:!he,index:_,node:E,rect:A});return f.useEffect(()=>{se&&Ie.current.newIndex!==Ae&&(Ie.current.newIndex=Ae),h!==Ie.current.containerId&&(Ie.current.containerId=h),d!==Ie.current.items&&(Ie.current.items=d)},[se,Ae,h,d]),f.useEffect(()=>{if(pe===Ie.current.activeId)return;if(pe!=null&&Ie.current.activeId==null){Ie.current.activeId=pe;return}const He=setTimeout(()=>{Ie.current.activeId=pe},50);return()=>clearTimeout(He)},[pe]),{active:D,activeIndex:p,attributes:G,data:T,rect:A,index:_,newIndex:Ae,items:d,isOver:M,isSorting:se,isDragging:Z,listeners:W,node:E,overIndex:y,over:Q,setNodeRef:J,setActivatorNodeRef:le,setDroppableNodeRef:F,setDraggableNodeRef:$,transform:Re??me,transition:Ee()};function Ee(){if(Re||xe&&Ie.current.newIndex===_)return $1e;if(!(Ce&&!LN(P)||!u)&&(se||he))return gd.Transition.toString({...u,property:dY})}}function U1e(e,t){var n,s;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e?.draggable)!=null?n:t.draggable,droppable:(s=e?.droppable)!=null?s:t.droppable}}function mw(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&typeof t.sortable=="object"&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const B1e=[va.Down,va.Right,va.Up,va.Left],H1e=(e,t)=>{let{context:{active:n,collisionRect:s,droppableRects:r,droppableContainers:i,over:o,scrollableAncestors:l}}=t;if(B1e.includes(e.code)){if(e.preventDefault(),!n||!s)return;const c=[];i.getEnabled().forEach(h=>{if(!h||h!=null&&h.disabled)return;const p=r.get(h.id);if(p)switch(e.code){case va.Down:s.top<p.top&&c.push(h);break;case va.Up:s.top>p.top&&c.push(h);break;case va.Left:s.left>p.left&&c.push(h);break;case va.Right:s.left<p.left&&c.push(h);break}});const u=vNe({collisionRect:s,droppableRects:r,droppableContainers:c});let d=GV(u,"id");if(d===o?.id&&u.length>1&&(d=u[1].id),d!=null){const h=i.get(n.id),p=i.get(d),x=p?r.get(p.id):null,b=p?.node.current;if(b&&x&&h&&p){const y=DN(b).some((k,A)=>l[A]!==k),N=uY(h,p),w=q1e(h,p),S=y||!N?{x:0,y:0}:{x:w?s.width-x.width:0,y:w?s.height-x.height:0},_={x:x.left,y:x.top};return S.x&&S.y?_:Rp(_,S)}}}};function uY(e,t){return!mw(e)||!mw(t)?!1:e.data.current.sortable.containerId===t.data.current.sortable.containerId}function q1e(e,t){return!mw(e)||!mw(t)||!uY(e,t)?!1:e.data.current.sortable.index<t.data.current.sortable.index}const Ro=(e,t="")=>`${t} ${new Intl.NumberFormat("en-US",{minimumFractionDigits:0}).format(e||0)}`,eE=e=>e?new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"",G1e=e=>{if(!e)return 0;const t=new Date-new Date(e);return Math.floor(t/(1e3*60*60*24))},W1e=(e,t)=>{if(!e||e.length===0)return;const n=e.map(c=>({ID:c.id,Name:c.name||`${c.first_name} ${c.last_name}`,Company:c.company_name||c.account?.name||"",Stage:c.stage||c.status,Amount:c.amount||0,Date:eE(c.created_at)})),s=Object.keys(n[0]).join(","),r=n.map(c=>Object.values(c).map(u=>typeof u=="string"?`"${u.replace(/"/g,'""')}"`:u).join(",")),i="data:text/csv;charset=utf-8,"+[s,...r].join(`
`),o=encodeURI(i),l=document.createElement("a");l.setAttribute("href",o),l.setAttribute("download",`${t}.csv`),document.body.appendChild(l),l.click(),document.body.removeChild(l)},tE=({label:e,count:t,value:n,width:s,color:r,onClick:i,isActive:o,isLead:l,weightedValue:c,currencySymbol:u,conversionRate:d,compact:h=!1})=>a.jsxs("div",{className:"flex flex-col items-center w-full",children:[d&&a.jsx("div",{className:`flex justify-center relative z-0 ${h?"-my-1":"-my-2 mb-1"}`,children:a.jsxs("div",{className:`bg-gray-100 text-gray-500 font-bold rounded-full border border-white shadow-sm flex items-center ${h?"text-[8px] px-1.5":"text-[10px] px-2 py-0.5"}`,children:[a.jsx(ik,{className:"mr-1"})," ",d,"%"]})}),a.jsxs("div",{onClick:i,className:`w-full relative group cursor-pointer transition-all duration-300 transform ${o?"scale-105 z-10":"hover:scale-102 hover:opacity-90"}`,children:[a.jsxs("div",{className:"flex justify-between items-end mb-1 px-1",children:[a.jsx("span",{className:`${h?"text-[10px]":"text-xs"} font-bold uppercase tracking-wider ${o?"text-blue-700":"text-gray-500"}`,children:e}),a.jsx("span",{className:`${h?"text-[10px]":"text-xs"} text-gray-400`,children:t})]}),a.jsxs("div",{className:`${h?"h-6":"h-10"} w-full bg-gray-100 rounded-r-lg overflow-hidden flex items-center relative shadow-sm`,children:[a.jsx("div",{className:`h-full ${r} transition-all duration-700 ease-out flex items-center px-2 text-white font-bold relative overflow-hidden`,style:{width:s},children:a.jsx("span",{className:`z-10 drop-shadow-md ${h?"text-xs":"text-sm"}`,children:l?t:Ro(n,u)})}),!l&&c>0&&a.jsx("div",{className:"absolute left-0 top-0 h-full bg-white opacity-20 z-20",style:{width:`${c/n*parseFloat(s)}%`}})]})]})]}),V1e=({id:e,children:t})=>{const{attributes:n,listeners:s,setNodeRef:r,transform:i,transition:o,isDragging:l}=F1e({id:e}),c={transform:gd.Transform.toString(i),transition:o,zIndex:l?50:"auto",opacity:l?.5:1,position:"relative"};return a.jsx("div",{ref:r,style:c,className:"h-full",children:wt.cloneElement(t,{dragHandleProps:{...n,...s}})})},Y1e=({user:e,metrics:t,stages:n,currencySymbol:s,target:r,dragHandleProps:i})=>{const o=t.metrics.CLOSED_WON?.value||0,l=t.metrics.CLOSED_LOST?.value||0,c=t.metrics.CLOSED_WON.count+t.metrics.CLOSED_LOST.count,u=c>0?(t.metrics.CLOSED_WON.count/c*100).toFixed(0):0,d=r>0?o/r*100:0;return a.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-md border border-gray-100 flex flex-col h-full hover:shadow-lg transition-shadow relative group",children:[a.jsxs("div",{className:"flex flex-col mb-4 pb-4 border-b border-gray-100",children:[a.jsxs("div",{className:"flex items-start justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center text-blue-600 font-bold mr-3 flex-shrink-0",children:e.name.charAt(0)}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-bold text-gray-800 text-sm",children:e.name}),a.jsxs("div",{className:"flex gap-2 text-[10px] mt-1",children:[a.jsxs("span",{className:"text-green-600 bg-green-50 px-1.5 py-0.5 rounded border border-green-100",children:["Win: ",u,"%"]}),a.jsxs("span",{className:"text-red-600 bg-red-50 px-1.5 py-0.5 rounded border border-red-100",children:["Lost: ",Ro(l,s)]})]})]})]}),i&&a.jsx("button",{...i,className:"p-1.5 text-gray-300 hover:text-blue-500 hover:bg-blue-50 rounded-md cursor-grab active:cursor-grabbing transition-colors touch-none",title:"Drag to reorder",children:a.jsx(doe,{size:16})})]}),r>0?a.jsxs("div",{className:"w-full mt-2 bg-gray-50 p-2 rounded-lg border border-gray-100",children:[a.jsxs("div",{className:"flex justify-between items-center text-[10px] text-gray-500 mb-1",children:[a.jsx("span",{className:"font-semibold text-gray-600",children:"Target Achievement"}),a.jsxs("span",{className:d>=100?"text-green-600 font-bold":"text-blue-600 font-bold",children:[d.toFixed(0),"%"]})]}),a.jsx("div",{className:"w-full h-2 bg-gray-200 rounded-full overflow-hidden mb-1",children:a.jsx("div",{className:`h-full rounded-full transition-all duration-1000 ${d>=100?"bg-green-500":"bg-blue-500"}`,style:{width:`${Math.min(d,100)}%`}})}),a.jsxs("div",{className:"flex justify-between text-[9px] text-gray-400",children:[a.jsxs("span",{children:["Achieved: ",a.jsx("span",{className:"text-gray-700 font-medium",children:Ro(o,s)})]}),a.jsxs("span",{children:["Target: ",Ro(r,s)]})]})]}):a.jsx("div",{className:"text-[10px] text-gray-400 italic mt-1 text-center bg-gray-50 p-1 rounded",children:"No target assigned"})]}),a.jsx("div",{className:"flex-grow space-y-2",children:n.map((h,p)=>{const x=t.metrics[h.key];let b=null;if(p>0){const j=n[p-1].key,y=t.metrics[j].count;y>0&&(b=(x.count/y*100).toFixed(0))}return a.jsx(tE,{label:h.label,count:x.count,value:x.value,width:x.width,color:x.color,isLead:!h.isDeal,weightedValue:x.weightedValue,currencySymbol:s,conversionRate:b,compact:!0,onClick:()=>{},isActive:!1},h.key)})})]})},Q1e=({data:e,stageKey:t,currencySymbol:n,basePath:s="/admin"})=>{const r=Et(),[i,o]=f.useState({key:null,direction:"desc"}),l=t==="LEADS",c=t==="CLOSED_WON",u=t==="CLOSED_LOST",d=!l&&!c&&!u,h=f.useMemo(()=>i.key?[...e].sort((b,j)=>{let y=b[i.key],N=j[i.key];return(i.key==="amount"||i.key==="probability")&&(y=parseFloat(b[i.key]||0),N=parseFloat(j[i.key]||0)),y<N?i.direction==="asc"?-1:1:y>N?i.direction==="asc"?1:-1:0}):e,[e,i]),p=b=>{o({key:b,direction:i.key===b&&i.direction==="desc"?"asc":"desc"})},x=({columnKey:b})=>i.key!==b?a.jsx(ik,{className:"inline ml-1 opacity-0 group-hover:opacity-30"}):i.direction==="asc"?a.jsx(toe,{className:"inline ml-1 text-blue-600"}):a.jsx(ik,{className:"inline ml-1 text-blue-600"});return!e||e.length===0?a.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-gray-400 bg-gray-50 rounded-xl border-2 border-dashed border-gray-200",children:[a.jsx(TL,{size:48,className:"mb-4 opacity-50"}),a.jsx("p",{className:"font-medium",children:"No records in this stage"})]}):a.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden flex flex-col h-full",children:a.jsx("div",{className:"overflow-x-auto flex-grow",children:a.jsxs("table",{className:"w-full text-left border-collapse",children:[a.jsx("thead",{className:"bg-gray-50 sticky top-0 z-10",children:a.jsxs("tr",{children:[a.jsxs("th",{className:"p-4 text-xs font-bold text-gray-500 uppercase tracking-wider cursor-pointer group",onClick:()=>p("name"),children:["Name ",a.jsx(x,{columnKey:"name"})]}),a.jsx("th",{className:"p-4 text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Company"}),l&&a.jsx("th",{className:"p-4 text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Contact Info"}),d&&a.jsxs(a.Fragment,{children:[a.jsxs("th",{className:"p-4 text-xs font-bold text-gray-500 uppercase tracking-wider text-right cursor-pointer group",onClick:()=>p("amount"),children:["Value ",a.jsx(x,{columnKey:"amount"})]}),a.jsxs("th",{className:"p-4 text-xs font-bold text-gray-500 uppercase tracking-wider text-center cursor-pointer group",onClick:()=>p("probability"),children:["Prob. ",a.jsx(x,{columnKey:"probability"})]}),a.jsx("th",{className:"p-4 text-xs font-bold text-gray-500 uppercase tracking-wider text-center",children:"Age"})]}),c&&a.jsxs("th",{className:"p-4 text-xs font-bold text-gray-500 uppercase tracking-wider text-right text-green-600 cursor-pointer group",onClick:()=>p("amount"),children:["Booked ",a.jsx(x,{columnKey:"amount"})]}),u&&a.jsxs(a.Fragment,{children:[a.jsxs("th",{className:"p-4 text-xs font-bold text-gray-500 uppercase tracking-wider text-right text-red-600 cursor-pointer group",onClick:()=>p("amount"),children:["Lost Value ",a.jsx(x,{columnKey:"amount"})]}),a.jsx("th",{className:"p-4 text-xs font-bold text-gray-500 uppercase tracking-wider text-center",children:"Lost Date"})]}),a.jsx("th",{className:"p-4 text-xs font-bold text-gray-500 uppercase tracking-wider text-right",children:"Owner"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-100",children:h.map(b=>{const j=l?0:G1e(b.stage_updated_at||b.created_at),y=j>30&&d;return a.jsxs("tr",{className:"hover:bg-blue-50 transition-colors cursor-pointer group",onClick:()=>r(l?`${s}/leads/${b.id}`:`${s}/deals/info?id=${b.id}`),children:[a.jsxs("td",{className:"p-4",children:[a.jsx("p",{className:"font-bold text-gray-800 text-sm group-hover:text-blue-600 transition-colors",children:l?`${b.first_name} ${b.last_name}`:b.name}),a.jsx("p",{className:"text-xs text-gray-400 mt-0.5",children:eE(b.created_at)})]}),a.jsx("td",{className:"p-4 text-sm text-gray-600",children:l?b.company_name:b.account?.name}),l&&a.jsxs("td",{className:"p-4 text-xs text-gray-500",children:[b.email&&a.jsxs("div",{className:"flex items-center mb-1",children:[a.jsx(sn,{className:"mr-1"})," ",b.email]}),b.phone&&a.jsxs("div",{className:"flex items-center",children:[a.jsx(It,{className:"mr-1"})," ",b.phone]})]}),d&&a.jsxs(a.Fragment,{children:[a.jsx("td",{className:"p-4 text-right font-medium text-gray-700",children:Ro(b.amount,n)}),a.jsx("td",{className:"p-4 text-center",children:a.jsxs("span",{className:`inline-block px-2 py-1 rounded text-xs font-bold ${b.probability>=80?"bg-green-100 text-green-700":b.probability>=50?"bg-yellow-100 text-yellow-700":"bg-gray-100 text-gray-600"}`,children:[b.probability,"%"]})}),a.jsx("td",{className:"p-4 text-center",children:y?a.jsxs("div",{className:"flex items-center justify-center text-red-600 bg-red-50 px-2 py-1 rounded border border-red-100",title:"Stuck for >30 days",children:[a.jsx(Yi,{size:14,className:"mr-1"}),a.jsxs("span",{className:"text-xs font-bold",children:[j,"d"]})]}):a.jsxs("span",{className:"text-xs text-gray-400",children:[j,"d"]})})]}),c&&a.jsx("td",{className:"p-4 text-right font-bold text-green-700",children:Ro(b.amount,n)}),u&&a.jsxs(a.Fragment,{children:[a.jsx("td",{className:"p-4 text-right font-bold text-red-600 opacity-75",children:Ro(b.amount,n)}),a.jsx("td",{className:"p-4 text-center text-xs text-gray-500",children:eE(b.stage_updated_at)})]}),a.jsx("td",{className:"p-4 text-right",children:a.jsxs("div",{className:"flex items-center justify-end text-gray-500 text-xs",children:[a.jsx(ra,{className:"mr-1"}),l?b.lead_owner?.first_name||b.owner?.first_name||b.assigned_to?.first_name||"Unassigned":b.assigned_deals?.first_name||b.deal_creator?.first_name||"Unassigned"]})})]},b.id)})})]})})})},IN=({leads:e,deals:t,currencySymbol:n,targets:s=[],basePath:r="/admin",currentUser:i=null})=>{const[o,l]=f.useState("ALL"),[c,u]=f.useState("ALL"),[d,h]=f.useState("ALL"),[p,x]=f.useState("AGGREGATE"),b=i?i.id.toString():d,j=!!i,[y,N]=f.useState([]),w=qx(qf(dm,{activationConstraint:{distance:5}}),qf(pD,{coordinateGetter:H1e})),S=f.useMemo(()=>{const D=new Date;if(c==="THIS_MONTH")return{start:new Date(D.getFullYear(),D.getMonth(),1),end:new Date(D.getFullYear(),D.getMonth()+1,0)};if(c==="THIS_QUARTER"){const P=Math.floor(D.getMonth()/3)*3;return{start:new Date(D.getFullYear(),P,1),end:new Date(D.getFullYear(),P+3,0)}}return c==="THIS_YEAR"?{start:new Date(D.getFullYear(),0,1),end:new Date(D.getFullYear(),11,31)}:null},[c]),_=f.useMemo(()=>s.filter(D=>{if(d!=="ALL"){const P=D.user?.id||D.user_id||D.assigned_to;if(parseInt(P)!==parseInt(d))return!1}if(S){const P=new Date(D.start_date),B=new Date(D.end_date);return P<=S.end&&B>=S.start}return!0}),[s,d,S]),T=f.useMemo(()=>{const D=new Map,P=B=>{B&&B.id&&D.set(B.id,`${B.first_name} ${B.last_name}`)};return e.forEach(B=>P(B.lead_owner||B.owner||B.assigned_to)),t.forEach(B=>{P(B.assigned_deals),P(B.deal_creator)}),Array.from(D.entries()).map(([B,G])=>({id:B,name:G}))},[e,t]),k=f.useMemo(()=>{const D=new Date;let P=null;c==="THIS_MONTH"?P=new Date(D.getFullYear(),D.getMonth(),1):c==="THIS_QUARTER"?P=new Date(D.getFullYear(),Math.floor(D.getMonth()/3)*3,1):c==="THIS_YEAR"&&(P=new Date(D.getFullYear(),0,1));const B=we=>{const J=new Date(we.created_at);if(P&&J<P)return!1;if(b!=="ALL"){const se=parseInt(b);return!!(we.lead_owner&&(we.lead_owner.id||we.lead_owner)===se||we.assigned_to?.id===se||we.owner?.id===se||we.assigned_deals?.id===se||we.created_by===se)}return!0},G=e.filter(B),$=t.filter(B),W=[{key:"LEADS",label:"Top Leads",color:"bg-blue-400",isDeal:!1},{key:"PROSPECTING",label:"Prospecting",color:"bg-blue-600",isDeal:!0},{key:"QUALIFICATION",label:"Qualification",color:"bg-indigo-600",isDeal:!0},{key:"PROPOSAL",label:"Proposal",color:"bg-purple-600",isDeal:!0},{key:"NEGOTIATION",label:"Negotiation",color:"bg-pink-600",isDeal:!0},{key:"CLOSED_WON",label:"Closed Won",color:"bg-emerald-500",isDeal:!0},{key:"CLOSED_LOST",label:"Closed Lost",color:"bg-red-500",isDeal:!0}],Z=(we,J)=>{const se=W.reduce((Ce,ge)=>(Ce[ge.key]={...ge,count:0,value:0,weightedValue:0,items:[]},Ce),{});se.LEADS.count=we.length,se.LEADS.items=we,J.forEach(Ce=>{const ge=(Ce.stage||"").toUpperCase();if(se[ge]){se[ge].count++,se[ge].items.push(Ce);const be=parseFloat(Ce.amount||0);se[ge].value+=be,se[ge].weightedValue+=be*((Ce.probability||0)/100)}});const ye=Math.max(...Object.values(se).map(Ce=>Ce.count),1);return Object.keys(se).forEach(Ce=>{const ge=se[Ce];ge.width=ge.count===0?"0%":`${Math.max(ge.count/ye*100,15)}%`}),{metrics:se,filteredDeals:J,filteredLeads:we}},Q=Z(G,$),le=[];return p==="COMPARE"&&(b==="ALL"?T:T.filter(J=>J.id===parseInt(b))).forEach(J=>{const se=parseInt(J.id),ye=G.filter(me=>(me.lead_owner?.id||me.lead_owner||me.assigned_to?.id||me.owner?.id)===se),Ce=$.filter(me=>(me.assigned_deals?.id||me.created_by)===se),ge=_.find(me=>{const Ae=me.user?.id||me.user_id||me.assigned_to;return parseInt(Ae)===se}),be=parseFloat(ge?.amount||ge?.target_amount||ge?.value||0);(ye.length>0||Ce.length>0||be>0)&&le.push({user:J,data:Z(ye,Ce),target:be})}),{stages:W,aggregate:Q,userGroups:le}},[t,e,c,b,p,T,_]),A=f.useMemo(()=>{if(!k.userGroups.length)return[];const D=[...k.userGroups];return y.length>0&&D.sort((P,B)=>{const G=y.indexOf(P.user.id),$=y.indexOf(B.user.id);return G!==-1&&$!==-1?G-$:G!==-1?-1:$!==-1?1:0}),D},[k.userGroups,y]),E=D=>{const{active:P,over:B}=D;P.id!==B.id&&N(()=>{const G=A.map(Z=>Z.user.id),$=G.indexOf(P.id),W=G.indexOf(B.id);return bD(G,$,W)})},M=f.useMemo(()=>{const D=_.reduce((se,ye)=>se+parseFloat(ye.amount||ye.target_amount||ye.value||0),0),P=k.aggregate.metrics,B=P.CLOSED_WON?.value||0,G=P.CLOSED_WON?.count||0,$=P.CLOSED_LOST?.value||0,W=P.CLOSED_LOST?.count||0,Z=P.LEADS?.count||0,Q=D>0?B/D*100:0,le=G+W,we=le>0?G/le*100:0,J=Z>0?G/Z*100:0;return{totalTarget:D,totalWon:B,totalLost:$,progress:Q,winRate:we,conversionRate:J}},[_,k]),F=f.useMemo(()=>o==="ALL"?[]:k.aggregate.metrics[o]?.items||[],[o,k]);return a.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-100 p-6 flex flex-col h-full",children:[a.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mb-6",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-bold text-gray-800 flex items-center",children:[a.jsx(TL,{className:"mr-2"})," ",j?"My Pipeline":"Pipeline Intelligence"]}),a.jsx("p",{className:"text-sm text-gray-500",children:j?"Your personal pipeline performance and metrics.":"Analyze pipeline velocity and bottlenecks."})]}),a.jsxs("div",{className:"flex flex-wrap gap-2 mt-4 md:mt-0",children:[a.jsxs("select",{value:c,onChange:D=>u(D.target.value),className:"bg-gray-50 border border-gray-200 text-gray-700 text-xs rounded-lg p-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"ALL",children:"All Time"}),a.jsx("option",{value:"THIS_MONTH",children:"This Month"}),a.jsx("option",{value:"THIS_QUARTER",children:"This Quarter"}),a.jsx("option",{value:"THIS_YEAR",children:"This Year"})]}),!j&&a.jsxs(a.Fragment,{children:[a.jsxs("select",{value:d,onChange:D=>h(D.target.value),className:"bg-gray-50 border border-gray-200 text-gray-700 text-xs rounded-lg p-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"ALL",children:"All Users"}),T.map(D=>a.jsx("option",{value:D.id,children:D.name},D.id))]}),a.jsxs("div",{className:"flex bg-gray-100 p-0.5 rounded-lg",children:[a.jsx("button",{onClick:()=>x("AGGREGATE"),className:`px-2 py-1 rounded-md text-xs font-medium transition-all ${p==="AGGREGATE"?"bg-white text-blue-600 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:"Aggregate"}),a.jsx("button",{onClick:()=>x("COMPARE"),className:`px-2 py-1 rounded-md text-xs font-medium transition-all ${p==="COMPARE"?"bg-white text-blue-600 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:"Compare"})]})]})]})]}),p==="COMPARE"?a.jsx(Vx,{sensors:w,collisionDetection:Gx,onDragEnd:E,children:a.jsx(P1e,{items:A.map(D=>D.user.id),strategy:vD,children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 overflow-x-auto pb-4",children:[A.map(D=>a.jsx(V1e,{id:D.user.id,children:a.jsx(Y1e,{user:D.user,metrics:D.data,stages:k.stages.filter(P=>P.key!=="CLOSED_LOST"),currencySymbol:n,target:D.target})},D.user.id)),A.length===0&&a.jsx("div",{className:"col-span-full text-center py-10 text-gray-400",children:"No data for selected filters."})]})})}):a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-8",children:[a.jsxs("div",{className:"lg:col-span-4 flex flex-col space-y-2 relative",children:[a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"absolute left-6 top-4 bottom-4 w-0.5 bg-gray-100 -z-0"}),k.stages.filter(D=>D.key!=="CLOSED_LOST").map((D,P)=>{const B=k.aggregate.metrics[D.key];let G=null;if(P>0){const $=k.stages[P-1].key,W=k.aggregate.metrics[$].count;W>0&&(G=(B.count/W*100).toFixed(0))}return a.jsx(tE,{label:D.label,count:B.count,value:B.value,width:B.width,color:B.color,isLead:!D.isDeal,weightedValue:B.weightedValue,currencySymbol:n,isActive:o===D.key,conversionRate:G,onClick:()=>l(D.key)},D.key)})]}),a.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-100",children:[a.jsx("div",{className:"mb-2 text-xs font-bold text-gray-400 uppercase",children:"Funnel Health"}),a.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center mb-4",children:[a.jsxs("div",{className:"bg-green-50 rounded p-2 border border-green-100",children:[a.jsx("p",{className:"text-[9px] text-green-600 uppercase font-bold",children:"Win Rate"}),a.jsxs("p",{className:"text-sm font-bold text-gray-800",children:[M.winRate.toFixed(0),"%"]})]}),a.jsxs("div",{className:"bg-blue-50 rounded p-2 border border-blue-100",children:[a.jsx("p",{className:"text-[9px] text-blue-600 uppercase font-bold",children:"Conversion"}),a.jsxs("p",{className:"text-sm font-bold text-gray-800",children:[M.conversionRate.toFixed(0),"%"]})]}),a.jsxs("div",{className:"bg-red-50 rounded p-2 border border-red-100",children:[a.jsx("p",{className:"text-[9px] text-red-600 uppercase font-bold",children:"Lost Value"}),a.jsx("p",{className:"text-sm font-bold text-gray-800",children:Ro(M.totalLost,n)})]})]}),a.jsx(tE,{label:"Closed Lost",count:k.aggregate.metrics.CLOSED_LOST.count,value:k.aggregate.metrics.CLOSED_LOST.value,width:k.aggregate.metrics.CLOSED_LOST.width,color:"bg-red-500 opacity-90",isLead:!1,weightedValue:0,currencySymbol:n,isActive:o==="CLOSED_LOST",onClick:()=>l("CLOSED_LOST")},"CLOSED_LOST"),a.jsxs("div",{className:"bg-gray-50 p-2 rounded-lg border border-gray-100 mt-4",children:[a.jsxs("div",{className:"flex justify-between items-center text-[10px] mb-1",children:[a.jsxs("span",{className:"font-bold text-gray-600 flex items-center",children:[a.jsx(fr,{className:"mr-1"})," Total Target"]}),a.jsxs("span",{className:M.progress>=100?"text-green-600 font-bold":"text-blue-600 font-bold",children:[M.progress.toFixed(0),"%"]})]}),a.jsx("div",{className:"w-full h-2 bg-gray-200 rounded-full overflow-hidden mb-1",children:a.jsx("div",{className:`h-full rounded-full transition-all duration-1000 ${M.progress>=100?"bg-green-500":"bg-blue-500"}`,style:{width:`${Math.min(M.progress,100)}%`}})}),a.jsxs("div",{className:"flex justify-between text-[9px] text-gray-400",children:[a.jsxs("span",{children:["Achieved: ",a.jsx("span",{className:"text-gray-700 font-medium",children:Ro(M.totalWon,n)})]}),a.jsxs("span",{children:["Goal: ",Ro(M.totalTarget,n)]})]})]})]})]}),a.jsxs("div",{className:"lg:col-span-8 h-[600px] flex flex-col",children:[a.jsxs("div",{className:"bg-gray-50 p-3 rounded-t-xl border-b border-gray-200 flex justify-between items-center",children:[a.jsx("h3",{className:"text-sm font-bold text-gray-800 flex items-center",children:o==="ALL"?a.jsx("span",{children:"Select a stage to view details"}):a.jsxs(a.Fragment,{children:[a.jsx("span",{className:`w-2.5 h-2.5 rounded-full mr-2 ${k.aggregate.metrics[o]?.color}`}),k.stages.find(D=>D.key===o)?.label," Details",a.jsxs("span",{className:"ml-2 px-2 py-0.5 bg-white border border-gray-200 text-gray-600 text-[10px] rounded-full",children:[F.length," records"]})]})}),o!=="ALL"&&F.length>0&&a.jsxs("button",{onClick:()=>W1e(F,`Funnel_${o}`),className:"text-[10px] font-bold text-blue-600 hover:bg-blue-100 px-2 py-1 rounded transition-colors flex items-center",children:[a.jsx(Vo,{className:"mr-1"})," Export"]})]}),o==="ALL"?a.jsxs("div",{className:"bg-white flex-grow rounded-b-xl border border-gray-100 flex flex-col items-center justify-center p-12 text-center text-gray-400",children:[a.jsx(ioe,{size:48,className:"mb-4 text-blue-100"}),a.jsx("p",{children:"Click on any stage bar (including Lost Deals) to inspect records."})]}):a.jsx(Q1e,{data:F,stageKey:o,currencySymbol:n,basePath:r})]})]})]})},K1e=(e,t="")=>`${t} ${new Intl.NumberFormat("en-US",{minimumFractionDigits:0}).format(e)}`,X1e=e=>{const t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())),n=t.getUTCDay()||7;t.setUTCDate(t.getUTCDate()+4-n);const s=new Date(Date.UTC(t.getUTCFullYear(),0,1));return Math.ceil(((t-s)/864e5+1)/7)},wD=({currencySymbol:e=""})=>{const[t,n]=f.useState("month"),[s,r]=f.useState([]),[i,o]=f.useState([]),[l,c]=f.useState([]),[u,d]=f.useState(!1),h=new Date,p=h.getFullYear(),x=h.getMonth()+1,b=X1e(h),j=f.useCallback(async()=>{d(!0);try{const S=new URLSearchParams;S.append("period_type","MONTHLY"),S.append("period_year",p),S.append("period_number",x);const _=await ne.get(`/targets/leaderboard?${S.toString()}`).catch(()=>({data:{entries:[]}}));o(_.data?.entries||[]);const T=new URLSearchParams;T.append("period_type","ANNUAL"),T.append("period_year",p);const k=await ne.get(`/targets/leaderboard?${T.toString()}`).catch(()=>({data:{entries:[]}}));c(k.data?.entries||[]);const A=new Date,E=new Date;E.setDate(E.getDate()-7);const M=new URLSearchParams;M.append("start_date",E.toISOString().split("T")[0]),M.append("end_date",A.toISOString().split("T")[0]);const F=await ne.get(`/targets/leaderboard?${M.toString()}`).catch(()=>({data:{entries:[]}}));r(F.data?.entries||[])}catch(S){console.error("Error fetching leaderboard data:",S)}finally{d(!1)}},[p,x]);f.useEffect(()=>{j()},[j]);const y=f.useMemo(()=>{let S=[];switch(t){case"week":S=s;break;case"month":S=i;break;case"year":S=l;break;default:S=i}return Array.isArray(S)?S.slice(0,5):[]},[t,s,i,l]),N=[{id:"week",label:"Week"},{id:"month",label:"Month"},{id:"year",label:"Year"}],w=S=>{switch(S){case 0:return"bg-yellow-100 text-yellow-700 border-yellow-300";case 1:return"bg-gray-100 text-gray-600 border-gray-300";case 2:return"bg-orange-100 text-orange-700 border-orange-300";default:return"bg-gray-50 text-gray-500 border-gray-200"}};return a.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg border border-gray-100 flex flex-col h-full",children:[a.jsx("div",{className:"flex justify-between items-center mb-4",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(cd,{className:"text-blue-500",size:20}),a.jsx("h2",{className:"text-md font-semibold text-gray-800",children:"Top 5 Performers"})]})}),a.jsx("div",{className:"flex space-x-1 mb-4 bg-gray-100 rounded-lg p-1",children:N.map(S=>a.jsx("button",{onClick:()=>n(S.id),className:`flex-1 py-1.5 px-3 text-xs font-medium rounded-md transition-all duration-200 ${t===S.id?"bg-white text-blue-600 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:S.label},S.id))}),u?a.jsx("div",{className:"flex items-center justify-center py-8",children:a.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-500"})}):y.length>0?a.jsx("div",{className:"space-y-3 flex-1",children:y.map((S,_)=>a.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg hover:bg-gray-50 transition-colors",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-xs font-bold border ${w(_)}`,children:_+1}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-800 truncate max-w-[120px]",children:S.user_name||"Unknown Rep"}),a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx("div",{className:"w-16 h-1.5 bg-gray-200 rounded-full overflow-hidden",children:a.jsx("div",{className:`h-full rounded-full ${S.achievement_percentage>=100?"bg-green-500":S.achievement_percentage>=50?"bg-yellow-500":"bg-red-400"}`,style:{width:`${Math.min(S.achievement_percentage,100)}%`}})}),a.jsxs("span",{className:"text-[10px] text-gray-500",children:[S.achievement_percentage?.toFixed(1),"%"]})]})]})]}),a.jsx("p",{className:"text-sm font-bold text-gray-900",children:K1e(S.achieved_amount||0,e)})]},S.user_id||_))}):a.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-gray-400",children:[a.jsx(Pt,{size:32,className:"mb-2 opacity-50"}),a.jsx("p",{className:"text-sm",children:"No data for this period"})]}),a.jsx("div",{className:"mt-auto pt-3 border-t border-gray-100",children:a.jsxs("p",{className:"text-[10px] text-gray-400 text-center",children:[t==="week"&&`Week ${b}, ${p}`,t==="month"&&`${h.toLocaleString("default",{month:"long"})} ${p}`,t==="year"&&`Year ${p}`]})})]})},Z1e=e=>a.jsx(Kt,{...e}),J1e=e=>a.jsx(ac,{...e}),jD=e=>a.jsx(Vn,{...e}),eCe=e=>a.jsx(hx,{...e}),tCe=e=>a.jsx(bj,{...e}),aCe=e=>a.jsx(Pt,{...e}),nCe=e=>a.jsx(It,{...e}),sCe=e=>a.jsx(wj,{...e}),mY=e=>a.jsx(vj,{...e}),rCe=e=>a.jsx(Xa,{...e}),fY=e=>a.jsx(ra,{...e}),iCe=e=>a.jsx(rn,{...e}),hY=e=>a.jsx(sa,{...e}),oCe=e=>a.jsx(ia,{...e}),gY=e=>a.jsx(fr,{...e}),lCe=e=>a.jsx(La,{...e}),cCe=e=>a.jsx(Pt,{...e}),dCe=e=>a.jsx(Us,{...e}),uCe=e=>a.jsx(tc,{...e}),mCe=e=>a.jsx(Ls,{...e}),pY=(e,t="")=>{const n=parseFloat(e)||0;return new Intl.NumberFormat("en-US",{notation:"compact",compactDisplay:"short",maximumFractionDigits:1}).format(n).replace(/^/,`${t} `)},fCe=e=>{if(!e)return 0;const t=new Date-new Date(e);return Math.floor(t/(1e3*60*60*24))},hCe=e=>{switch(e){case"Negotiation":return{text:"text-purple-700",bg:"bg-purple-100"};case"Proposal":return{text:"text-red-700",bg:"bg-red-100"};case"Qualification":return{text:"text-yellow-700",bg:"bg-yellow-100"};case"Prospecting":return{text:"text-blue-700",bg:"bg-blue-100"};case"Closed Won":return{text:"text-green-700",bg:"bg-green-100"};case"Closed Lost":return{text:"text-red-700",bg:"bg-red-100"};default:return{text:"text-gray-700",bg:"bg-gray-100"}}},gCe=e=>{switch(e){case"Website":return{text:"text-green-600",bg:"bg-green-100"};case"Referral":return{text:"text-purple-600",bg:"bg-purple-100"};case"Trade Show":return{text:"text-orange-600",bg:"bg-orange-100"};case"Cold Call":return{text:"text-red-600",bg:"bg-red-100"};default:return{text:"text-gray-600",bg:"bg-gray-100"}}},pCe=e=>{switch(e){case"call":return{Icon:nCe,color:"text-red-500",bgColor:"bg-red-100"};case"qualification":return{Icon:sCe,color:"text-green-600",bgColor:"bg-green-100"};default:return{Icon:aCe,color:"text-blue-500",bgColor:"bg-blue-100"}}},xCe=e=>{switch(e.toUpperCase()){case"HIGH":return{text:"text-red-700",bg:"bg-red-100"};case"LOW":return{text:"text-blue-700",bg:"bg-blue-100"};default:return{text:"text-gray-700",bg:"bg-gray-100"}}},yCe=({searchQuery:e,onSearchChange:t,searchResults:n,onSearchResultClick:s})=>{const r=Et(),[i,o]=f.useState(!1),l=f.useRef(null),c=[{icon:J1e,label:"Account"},{icon:fY,label:"Contact"},{icon:iCe,label:"Leads"},{icon:hY,label:"Deals"},{icon:oCe,label:"Quotes"},{icon:gY,label:"Target"},{icon:lCe,label:"Task"},{icon:cCe,label:"Meeting"},{icon:dCe,label:"Call"},{icon:mCe,label:"Audit"},{icon:uCe,label:"Territory"}];f.useEffect(()=>{const h=p=>{l.current&&!l.current.contains(p.target)&&o(!1)};return document.addEventListener("mousedown",h),()=>document.removeEventListener("mousedown",h)},[]);const u=h=>{t(h.target.value),o(h.target.value.trim().length>0)},d=h=>{s&&s(h),o(!1)};return a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-3 sm:p-4 flex flex-col items-start space-y-4 w-full",children:[a.jsxs("div",{className:"w-full flex justify-center relative",ref:l,children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg lg:mt-3 px-4 py-2 w-full max-w-md md:max-w-2xl lg:max-w-2xl focus-within:ring-2 focus-within:ring-blue-500 transition duration-150",children:[a.jsx(Z1e,{size:20,className:"text-gray-400 mr-3 flex-shrink-0"}),a.jsx("input",{type:"text",placeholder:"Search Leads, Deals, or Accounts...",className:"focus:outline-none text-base w-full",value:e,onChange:u,onFocus:()=>e.trim().length>0&&o(!0)})]}),i&&Array.isArray(n)&&n.length>0&&a.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 mt-2 w-full max-w-md md:max-w-lg lg:max-w-2xl bg-white rounded-lg shadow-xl border border-gray-200 z-50 max-h-96 overflow-y-auto",children:n.map((h,p)=>a.jsx("div",{className:"px-4 py-3 hover:bg-gray-50 cursor-pointer border-b border-gray-100 last:border-b-0 transition duration-150",onClick:()=>d(h),children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-semibold text-gray-800 text-sm",children:h.name}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:h.type}),h.details&&a.jsx("p",{className:"text-xs text-gray-400 mt-1",children:h.details})]}),a.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${h.type==="Lead"?"bg-blue-100 text-blue-600":h.type==="Deal"?"bg-yellow-100 text-yellow-600":"bg-green-100 text-green-600"}`,children:h.type})]})},p))})]}),a.jsx("div",{className:"w-full overflow-x-auto lg:overflow-x-hidden scroll-smooth flex justify-center",children:a.jsx("div",{className:"flex flex-nowrap space-x-3 lg:space-x-4 xl:space-x-3 px-2 sm:px-0",children:c.map((h,p)=>a.jsxs("div",{className:"relative flex-shrink-0 group",children:[a.jsx("button",{className:"p-3 text-gray-500 hover:text-gray-900 transition duration-150 rounded-full hover:bg-gray-100 focus:outline-none cursor-pointer","aria-label":h.label,title:h.label,onClick:()=>{const x={Account:"/admin/accounts",Contact:"/admin/contacts",Leads:"/admin/leads",Deals:"/admin/deals",Quotes:"/admin/quotes",Target:"/admin/targets",Task:"/admin/tasks",Meeting:"/admin/meetings",Call:"/admin/calls",Audit:"/admin/audit",Territory:"/admin/territory"};x[h.label]&&r(x[h.label])},children:a.jsx(h.icon,{size:24,className:"lg:scale-95"})}),a.jsxs("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 px-3 py-1.5 bg-gray-900 text-white text-xs font-semibold rounded-md whitespace-nowrap opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-75 ease-in-out z-50 shadow-lg",children:[h.label,a.jsx("div",{className:"absolute top-full left-1/2 -translate-x-1/2 -mt-1 border-4 border-transparent border-t-gray-900"})]})]},p))})})]})},bCe=({action:e,description:t,entity_type:n,entity_name:s,timestamp:r})=>{const i=Et(),o=d=>{if(!d)return"Unknown";const h=new Date(d),x=new Date-h,b=Math.floor(x/6e4),j=Math.floor(x/36e5),y=Math.floor(x/864e5);return b<1?"Just now":b<60?`${b} min ago`:j<24?`${j} hour${j>1?"s":""} ago`:y<7?`${y} day${y>1?"s":""} ago`:h.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},l=e||t||"Action",c=s||n||"System",u=o(r);return a.jsxs("li",{className:"flex justify-between items-center py-2 border-b border-gray-100 last:border-b-0 cursor-pointer hover:bg-gray-50 transition duration-150 px-2 -mx-2 rounded-md",onClick:()=>i("/admin/audit"),children:[a.jsxs("p",{className:"text-sm text-gray-800 flex-grow font-medium",children:[l," ",a.jsxs("span",{className:"text-gray-500 italic text-xs",children:["(",c,")"]})]}),a.jsx("span",{className:"text-xs text-gray-400 flex-shrink-0 ml-4",children:u})]})},vCe=({logs:e,loading:t})=>{const n=Et();return a.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg border border-gray-100 flex flex-col h-full",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h2",{className:"text-md font-semibold text-gray-800",children:"Recent Logs"}),a.jsxs("span",{className:"text-sm text-blue-500 cursor-pointer hover:underline flex items-center space-x-1 font-medium",onClick:()=>n("/admin/audit"),children:[a.jsx("span",{children:"See All"}),a.jsx(mY,{size:14,className:"transform -rotate-45"})]})]}),e&&e.length>0?a.jsx("ul",{className:"space-y-1",children:e.slice(0,3).map((s,r)=>a.jsx(bCe,{...s},r))}):a.jsx("div",{className:"text-sm text-gray-500 py-4",children:"No recent logs"})]})},wCe=({icon:e,title:t,value:n,color:s,bgColor:r,loading:i,onClick:o})=>a.jsxs("div",{className:"flex items-center p-4 bg-white rounded-xl shadow-md border border-gray-200 transition-all duration-300",onClick:o||(()=>console.log(`Clicked metric card: ${t}`)),children:[a.jsx("div",{className:`p-3 rounded-full ${r} ${s} mr-4`,children:a.jsx(e,{size:20})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-500 font-medium uppercase",children:t}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:n||0})]})]}),jCe=({revenueData:e,loading:t})=>{const n=Et(),s=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],r=f.useMemo(()=>{if(!e||e.length===0){const j=new Date().getMonth(),y=[],N=[];for(let w=0;w<=j;w++)y.push(s[w]),N.push(0);return{labels:y,revenues:N,maxRevenue:0}}const l={};e.forEach(b=>{const j=b.close_date||b.closeDate||null,y=b.stage||"",N=y.toUpperCase()==="CLOSED_WON"||y==="CLOSED_WON";let w=b.amount;w&&typeof w=="object"&&w.toString?w=parseFloat(w.toString()):w=parseFloat(w)||0;const S=w>0;if(j&&j!==null&&N&&S)try{let _=new Date(j);if(isNaN(_.getTime())){const T=String(j).split("T")[0];_=new Date(T+"T00:00:00")}if(!isNaN(_.getTime())){const T=_.getFullYear(),k=_.getMonth()+1,A=`${T}-${String(k).padStart(2,"0")}`;l[A]||(l[A]=0),l[A]+=w}}catch(_){console.error("Error parsing deal date:",j,_)}});const c=Object.keys(l).map(b=>parseInt(b.split("-")[0])),u=c.length>0?[...new Set(c)].sort():[],d=new Date().getFullYear(),h=[],p=[];for(let b=0;b<12;b++){const j=`${d}-${String(b+1).padStart(2,"0")}`;h.push(s[b]),p.push(l[j]||0)}if(u.length>0){const b=Math.max(...u);if(b>d)for(let j=d+1;j<=b;j++)for(let y=0;y<12;y++){const N=`${j}-${String(y+1).padStart(2,"0")}`,w=l[N]||0;h.push(`${s[y]} ${j}`),p.push(w)}}const x=Math.max(...p,1);return{labels:h,revenues:p,maxRevenue:x}},[e]),i=r.labels,o=r.revenues;return a.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg h-full flex flex-col",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Revenue Overview"}),a.jsxs("span",{className:"text-sm text-blue-500 cursor-pointer hover:underline flex items-center space-x-1 font-medium",onClick:()=>n("/admin/deals"),children:[a.jsx("span",{children:"See All"}),a.jsx(mY,{size:14,className:"transform -rotate-45"})]})]}),a.jsx("div",{className:"h-80 relative flex-1 flex items-center justify-center p-6",children:a.jsx("div",{className:"w-full h-full flex items-center justify-start lg:justify-center overflow-x-auto sm:overflow-x-hidden",children:i&&i.length>0&&o&&o.length>0?a.jsx(mh,{xAxis:[{data:i,scaleType:"point"}],yAxis:[{valueFormatter:l=>l>=1e3?`${(l/1e3).toFixed(0)}k`:l.toString()}],series:[{data:o,showMark:!0,area:!0}],height:320,width:void 0,grid:{vertical:!0,horizontal:!0},margin:{top:40,right:40,bottom:50,left:50},sx:{width:"100%",maxWidth:"100%",minWidth:{xs:600,lg:"100%"}}}):a.jsxs("div",{className:"text-center text-gray-500",children:[a.jsx("p",{className:"text-sm",children:"No revenue data available"}),a.jsx("p",{className:"text-xs mt-2",children:"Closed won deals with close dates will appear here"})]})})})]})},H2=({title:e,items:t,children:n,onSeeAll:s})=>{const r=Et(),i=()=>{if(s)s();else{const o={"Latest Leads":"/admin/leads","Latest Deals":"/admin/deals","Upcoming Activities":"/admin/tasks"};o[e]&&r(o[e])}};return a.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg flex flex-col h-full",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:e}),a.jsx("span",{className:"text-sm text-blue-500 cursor-pointer hover:underline",onClick:i,children:"See All"})]}),n]})},NCe=({first_name:e,last_name:t,company_name:n,source:s,created_at:r,id:i})=>{const o=Et(),{text:l,bg:c}=gCe(s||"Website"),u=x=>{if(!x)return"Unknown";const b=new Date(x),y=new Date-b,N=Math.floor(y/6e4),w=Math.floor(y/36e5),S=Math.floor(y/864e5);return N<60?`${N} min ago`:w<24?b.toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}):S<7?b.toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}):b.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})},d=`${e||""} ${t||""}`.trim()||"Unknown",h=n||"Unknown Company",p=u(r);return a.jsx("div",{className:"py-3 border-b border-gray-100 last:border-b-0 cursor-pointer hover:bg-gray-50 transition duration-150 px-2 -mx-2 rounded-md",onClick:()=>i&&o(`/admin/leads/${i}`),children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-gray-800",children:d}),a.jsx("p",{className:"text-xs text-gray-500",children:h})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"text-xs text-gray-400",children:p}),a.jsx("span",{className:`inline-block mt-1 text-xs font-medium ${l} ${c} px-2 py-0.5 rounded-full`,children:s||"Website"})]})]})})},CCe=({name:e,amount:t,account:n,stage:s,created_at:r,stage_updated_at:i,id:o,previousAmount:l,currencySymbol:c})=>{const u=Et(),h={PROSPECTING:"Prospecting",QUALIFICATION:"Qualification",PROPOSAL:"Proposal",NEGOTIATION:"Negotiation",CLOSED_WON:"Closed Won",CLOSED_LOST:"Closed Lost"}[s]||s||"Unknown",{text:p,bg:x}=hCe(h),b=fCe(i||r),j=b>30&&s!=="CLOSED_WON"&&s!=="CLOSED_LOST",y=parseFloat(t||0),N=l?y>=l?"up":"down":"up",w=N==="up"?eCe:tCe,S=N==="up"?"text-green-400":"text-red-400",_=n?.name||"Unknown Company";return a.jsx("div",{className:"py-3 border-b border-gray-100 last:border-b-0 cursor-pointer hover:bg-gray-50 transition duration-150 px-2 -mx-2 rounded-md",onClick:()=>o&&u(`/admin/deals/info?id=${o}`),children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{className:"flex-shrink",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("p",{className:"font-semibold text-sm text-gray-900",children:e||"Unnamed Deal"}),j&&a.jsxs("span",{className:"text-[10px] bg-red-100 text-red-600 px-1.5 py-0.5 rounded border border-red-200 font-bold flex items-center",children:[a.jsx(jD,{size:10,className:"mr-1"})," ",b," days stuck"]})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:_}),a.jsx("div",{className:"mt-1 flex items-center space-x-2",children:a.jsx("span",{className:`inline-block text-xs font-medium ${p} ${x} px-2 py-0.5 rounded-full`,children:h})})]}),a.jsxs("div",{className:"text-right flex flex-col items-end flex-shrink-0",children:[a.jsx("p",{className:"text-md font-bold text-gray-800",children:pY(y,c)}),a.jsx(w,{size:16,className:`${S} mt-1`})]})]})})},SCe=({type:e,title:t,assignedTo:n,dueDate:s,scheduledDate:r,priority:i,id:o,activityType:l,fullData:c})=>{const u=Et(),h=l||{Call:"call",Meeting:"meeting",Task:"qualification"}[e]||"meeting",{Icon:p,color:x,bgColor:b}=pCe(h),{text:j,bg:y}=xCe(i||"MEDIUM"),S=(k=>{if(!k)return"No date set";const A=new Date(k),M=A-new Date,F=Math.floor(M/864e5);return F===0?`Today, ${A.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}`:F===1?`Tomorrow, ${A.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}`:F===-1?`Yesterday, ${A.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}`:A.toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})})(s||r),_=n||"Unassigned",T=()=>{o&&(c?h==="call"?(sessionStorage.setItem("callDetailData",JSON.stringify(c)),u(`/admin/calls/info?id=${o}`)):h==="meeting"?(sessionStorage.setItem("meetingDetailData",JSON.stringify(c)),u(`/admin/meetings/info?id=${o}`)):u("/admin/tasks"):u(h==="call"?`/admin/calls/info?id=${o}`:h==="meeting"?`/admin/meetings/info?id=${o}`:"/admin/tasks"))};return a.jsxs("div",{className:"flex items-start py-3 border-b border-gray-100 last:border-b-0 cursor-pointer hover:bg-gray-50 transition duration-150 px-2 -mx-2 rounded-md",onClick:T,children:[a.jsx("div",{className:`p-2 rounded-lg ${b} mr-3 flex-shrink-0 mt-1`,children:a.jsx(p,{size:20,className:`${x}`})}),a.jsxs("div",{className:"flex-grow",children:[a.jsxs("p",{className:"font-medium text-gray-800 flex items-center mb-1",children:[a.jsx("span",{className:"text-xl leading-none mr-2",children:""}),t||"Untitled Activity"]}),a.jsxs("div",{className:"space-y-1 text-xs text-gray-500",children:[a.jsxs("p",{className:"flex items-center",children:[a.jsx(jD,{size:14,className:"mr-1.5 text-gray-400"}),S]}),a.jsxs("p",{className:"flex items-center",children:[a.jsx(fY,{size:14,className:"mr-1.5 text-gray-400"}),"Assigned to: ",_]})]})]}),a.jsx("span",{className:`inline-block text-xs font-medium ${j} ${y} px-2 py-0.5 rounded-full flex-shrink-0 self-center ml-4`,children:(i||"MEDIUM").toUpperCase()})]})},_Ce=()=>{const e=Et(),{user:t}=Gt(),n=t?.company?.currency||"",[s,r]=f.useState([]),[i,o]=f.useState(0),[l,c]=f.useState({activeLeads:0,totalDeals:0,activeAccounts:0,overdueTasks:0}),[u,d]=f.useState([]),[h,p]=f.useState([]),[x,b]=f.useState([]),[j,y]=f.useState([]),[N,w]=f.useState([]),[S,_]=f.useState(!0),[T,k]=f.useState(null),[A,E]=f.useState(""),[M,F]=f.useState([]),[D,P]=f.useState([]),[B,G]=f.useState([]),[$,W]=f.useState(new Date),Z=f.useRef(null);f.useRef(null);const Q=f.useMemo(()=>{try{if(!A.trim())return[];const se=A.toLowerCase().trim(),ye=[];return Array.isArray(M)&&M.forEach(Ce=>{const ge=`${Ce.first_name||""} ${Ce.last_name||""}`.trim().toLowerCase(),be=(Ce.company_name||"").toLowerCase(),me=(Ce.email||"").toLowerCase(),Ae=(Ce.phone||"").toLowerCase();(ge.includes(se)||be.includes(se)||me.includes(se)||Ae.includes(se))&&ye.push({id:Ce.id,name:`${Ce.first_name||""} ${Ce.last_name||""}`.trim()||"Unnamed Lead",type:"Lead",details:Ce.company_name||"No company",route:`/admin/leads/${Ce.id}`})}),Array.isArray(D)&&D.forEach(Ce=>{const ge=(Ce.name||"").toLowerCase(),be=(Ce.account?.name||"").toLowerCase(),me=(Ce.description||"").toLowerCase();(ge.includes(se)||be.includes(se)||me.includes(se))&&ye.push({id:Ce.id,name:Ce.name||"Unnamed Deal",type:"Deal",details:Ce.account?.name||"No account",route:`/admin/deals/info?id=${Ce.id}`})}),Array.isArray(B)&&B.forEach(Ce=>{const ge=(Ce.name||"").toLowerCase(),be=(Ce.email||"").toLowerCase(),me=(Ce.phone||"").toLowerCase(),Ae=(Ce.website||"").toLowerCase();(ge.includes(se)||be.includes(se)||me.includes(se)||Ae.includes(se))&&ye.push({id:Ce.id,name:Ce.name||"Unnamed Account",type:"Account",details:Ce.email||Ce.phone||"No contact info",route:"/admin/accounts"})}),ye.slice(0,10)}catch(se){return console.error("Error in search:",se),[]}},[A,M,D,B]),le=se=>{se.route&&(e(se.route),E(""))},we=f.useCallback(async()=>{_(!0),k(null);try{const[se,ye,Ce,ge,be,me,Ae,pe]=await Promise.all([ne.get("/leads/admin/getLeads").catch(Ne=>(console.error("Error fetching leads:",Ne),{data:[]})),ne.get("/deals/admin/fetch-all").catch(Ne=>(console.error("Error fetching deals:",Ne),{data:[]})),ne.get("/accounts/admin/fetch-all").catch(Ne=>(console.error("Error fetching accounts:",Ne),{data:[]})),ne.get("/tasks/all").catch(Ne=>(console.error("Error fetching tasks:",Ne),{data:[]})),ne.get("/meetings/admin/fetch-all").catch(Ne=>(console.error("Error fetching meetings:",Ne),{data:[]})),ne.get("/calls/admin/fetch-all").catch(Ne=>(console.error("Error fetching calls:",Ne),{data:[]})),ne.get("/logs/read-all").catch(Ne=>(console.error("Error fetching logs:",Ne),{data:[]})),ne.get("/targets/admin/fetch-all").catch(Ne=>(console.error("Error fetching targets:",Ne),{data:[]}))]),Ie=Array.isArray(se.data)?se.data:[],xe=Array.isArray(ye.data)?ye.data:[],he=Array.isArray(Ce.data)?Ce.data:[],Re=Array.isArray(ge.data)?ge.data:[],Ee=Array.isArray(be.data)?be.data:[],He=Array.isArray(me.data)?me.data:[],Ke=Array.isArray(Ae.data)?Ae.data:[],st=Array.isArray(pe.data)?pe.data:[];F(Ie),P(xe),G(he),r(st);const it=st.reduce((Ne,ze)=>{const je=ze.amount||ze.value||ze.target_amount||0,ve=parseFloat(typeof je=="string"?je.replace(/[^\d.-]/g,""):je);return Ne+(isNaN(ve)?0:ve)},0);o(it),c({activeLeads:Ie.filter(Ne=>Ne.status&&!["Lost","Converted"].includes(Ne.status)).length,totalDeals:xe.length,activeAccounts:he.length,overdueTasks:Re.filter(Ne=>!Ne.dueDate||Ne.status==="Completed"?!1:new Date(Ne.dueDate)<new Date).length});const ot=[...Ie].sort((Ne,ze)=>new Date(ze.created_at||0)-new Date(Ne.created_at||0)).slice(0,5);d(ot);const rt=[...xe].sort((Ne,ze)=>new Date(ze.created_at||0)-new Date(Ne.created_at||0)).slice(0,5);p(rt);const at=[];He.forEach(Ne=>{const ze=Ne.due_date||Ne.call_time,je=(Ne.status||"").toUpperCase();ze&&!["COMPLETED","MISSED","NOT_HELD","HELD"].includes(je)&&at.push({type:"Call",title:Ne.subject||"Untitled Call",assignedTo:Ne.assigned_to||(Ne.call_assign_to?`${Ne.call_assign_to.first_name||""} ${Ne.call_assign_to.last_name||""}`.trim():"Unassigned"),scheduledDate:ze,priority:(Ne.priority||"MEDIUM").toUpperCase(),id:Ne.id,activityType:"call",fullData:Ne})}),Ee.forEach(Ne=>{const ze=Ne.dueDate||Ne.start_time,je=(Ne.status||"").toUpperCase();ze&&!["COMPLETED","CANCELLED","DONE"].includes(je)&&at.push({type:"Meeting",title:Ne.subject||Ne.activity||"Untitled Meeting",assignedTo:Ne.assignedTo||(Ne.meet_assign_to?`${Ne.meet_assign_to.first_name||""} ${Ne.meet_assign_to.last_name||""}`.trim():"Unassigned"),scheduledDate:ze,priority:(Ne.priority||"MEDIUM").toUpperCase(),id:Ne.id,activityType:"meeting",fullData:Ne})});const Je={HIGH:1,MEDIUM:2,LOW:3},Fe=at.sort((Ne,ze)=>{const je=Je[Ne.priority]||3,ve=Je[ze.priority]||3;return je!==ve?je-ve:new Date(Ne.scheduledDate||0)-new Date(ze.scheduledDate||0)}).slice(0,5);b(Fe),w(xe);const Ue=[...Ke].sort((Ne,ze)=>new Date(ze.timestamp||0)-new Date(Ne.timestamp||0));y(Ue)}catch(se){console.error("Error fetching dashboard data:",se),k("Failed to load dashboard data. Please refresh the page.")}finally{_(!1)}},[]);f.useEffect(()=>(document.title="Dashboard | Sari-Sari CRM",we(),Z.current=setInterval(()=>{we(),W(new Date)},3e4),()=>{Z.current&&clearInterval(Z.current)}),[we]);const J=[{icon:rCe,title:"Active Leads",value:l.activeLeads,color:"text-blue-600",bgColor:"bg-blue-50",onClick:()=>e("/admin/leads")},{icon:gY,title:"Total Targets",value:pY(i,n),color:"text-purple-600",bgColor:"bg-purple-50",onClick:()=>e("/admin/targets")},{icon:hY,title:"Total Deals",value:l.totalDeals,color:"text-yellow-600",bgColor:"bg-yellow-50",onClick:()=>e("/admin/deals")},{icon:jD,title:"Overdue Tasks",value:l.overdueTasks,color:"text-red-600",bgColor:"bg-red-50",onClick:()=>e("/admin/tasks")}];return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative w-full",children:[S&&a.jsx(qt,{}),a.jsxs("div",{className:"max-w-screen-2xl mx-auto",children:[T&&a.jsx("div",{className:"mb-6 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:a.jsx("p",{className:"font-medium",children:T})}),a.jsx("div",{className:"mb-8",children:a.jsx(yCe,{searchQuery:A,onSearchChange:E,searchResults:Q,onSearchResultClick:le})}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-4 mb-8",children:J.map(se=>a.jsx(wCe,{...se,loading:S},se.title))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[a.jsx(vCe,{logs:j,loading:S}),a.jsx(wD,{currencySymbol:n})]}),a.jsx("div",{className:"mb-8",children:a.jsx(IN,{leads:M,deals:D,targets:s,currencySymbol:n})}),a.jsx("div",{className:"grid grid-cols-1 mb-8",children:a.jsx(jCe,{revenueData:N,loading:S})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[a.jsx(H2,{title:"Latest Leads",children:u.length>0?u.map((se,ye)=>a.jsx(NCe,{...se},se.id||ye)):a.jsx("div",{className:"text-sm text-gray-500 py-4 text-center",children:"No leads found"})}),a.jsx(H2,{title:"Latest Deals",children:h.length>0?h.map((se,ye)=>a.jsx(CCe,{...se,stage_updated_at:se.stage_updated_at,currencySymbol:n},se.id||ye)):a.jsx("div",{className:"text-sm text-gray-500 py-4 text-center",children:"No deals found"})}),a.jsx(H2,{title:"Upcoming Activities",children:x.length>0?x.map((se,ye)=>a.jsx(SCe,{...se},se.id||ye)):a.jsx("div",{className:"text-sm text-gray-500 py-4 text-center",children:"No upcoming activities"})})]})]})]})};function ca({totalItems:e=0,pageSize:t=10,currentPage:n=1,onPrev:s,onNext:r,onPageSizeChange:i,pageSizeOptions:o=[10,20,30,40,50],className:l="",label:c="records"}){const u=e===0?1:Math.ceil(e/t),d=e===0?0:(n-1)*t+1,h=Math.min(n*t,e),p=n<=1||e===0,x=n>=u||e===0,b="inline-flex items-center gap-1 px-3 sm:px-4 py-2 text-sm font-semibold rounded-lg transition focus:outline-none focus:ring-2 focus:ring-offset-1",j="bg-black text-white hover:bg-gray-900",y="bg-gray-200 text-gray-500 cursor-not-allowed focus:ring-transparent";return a.jsxs("div",{className:`flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 ${l}`,children:[a.jsxs("div",{className:"text-sm text-gray-600 font-medium text-center sm:text-left w-full sm:w-auto order-1",children:["Showing ",e===0?0:d,"-",h," of ",e," ",c]}),i&&a.jsxs("div",{className:"flex items-center justify-center gap-2 w-full sm:w-auto order-3 sm:order-2",children:[a.jsx("span",{className:"text-sm text-gray-600 font-medium",children:"Rows per page"}),a.jsx("select",{value:t,onChange:N=>i(Number(N.target.value)),className:"border border-gray-300 rounded-md text-sm py-1 pl-2 pr-6 focus:outline-none focus:ring-2 focus:ring-indigo-500",children:o.map(N=>a.jsx("option",{value:N,children:N},N))})]}),a.jsxs("div",{className:"flex items-center gap-3 justify-center sm:justify-end w-full sm:w-auto order-2 sm:order-3",children:[a.jsxs("button",{type:"button",onClick:s,disabled:p,className:`${b} ${p?y:j}`,children:[a.jsx(soe,{className:"text-base"}),"Prev"]}),a.jsxs("div",{className:"text-sm font-semibold text-white bg-gray-900 border border-gray-900 shadow-sm px-3 py-1.5 rounded-full",children:["Page ",e===0?0:n," of"," ",e===0?0:u]}),a.jsxs("button",{type:"button",onClick:r,disabled:x,className:`${b} ${x?y:j}`,children:["Next",a.jsx(Mt,{className:"text-base"})]})]})]})}const ACe=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),TCe=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,n,s)=>s?s.toUpperCase():n.toLowerCase()),MR=e=>{const t=TCe(e);return t.charAt(0).toUpperCase()+t.slice(1)},xY=(...e)=>e.filter((t,n,s)=>!!t&&t.trim()!==""&&s.indexOf(t)===n).join(" ").trim(),kCe=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};var ECe={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const LCe=f.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:s,className:r="",children:i,iconNode:o,...l},c)=>f.createElement("svg",{ref:c,...ECe,width:t,height:t,stroke:e,strokeWidth:s?Number(n)*24/Number(t):n,className:xY("lucide",r),...!i&&!kCe(l)&&{"aria-hidden":"true"},...l},[...o.map(([u,d])=>f.createElement(u,d)),...Array.isArray(i)?i:[i]]));const ph=(e,t)=>{const n=f.forwardRef(({className:s,...r},i)=>f.createElement(LCe,{ref:i,iconNode:t,className:xY(`lucide-${ACe(MR(e))}`,`lucide-${e}`,s),...r}));return n.displayName=MR(e),n};const DCe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],PCe=ph("globe",DCe);const OCe=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],IR=ph("lock",OCe);const MCe=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],ICe=ph("message-circle",MCe);const $Ce=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],RCe=ph("message-square",$Ce);const zCe=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],FCe=ph("send",zCe);const UCe=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],$N=ph("x",UCe);function Tn({comments:e=[],onAddComment:t,currentUser:n}){const[s,r]=f.useState(""),[i,o]=f.useState(!1),[l,c]=f.useState(!1),u=async d=>{if(d.preventDefault(),!!s.trim()){c(!0);try{t&&await t({comment:s.trim(),is_private:i}),r("")}catch(h){console.error("Failed to add comment:",h)}finally{c(!1)}}};return a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 md:p-8 border border-gray-200 mt-5",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-800 break-words border-b border-gray-300 py-2 flex items-center gap-2",children:[a.jsx(RCe,{className:"w-5 h-5 text-gray-600"}),"Comments",e.length>0&&a.jsxs("span",{className:"text-sm font-normal text-gray-500",children:["(",e.length,")"]})]}),a.jsx("div",{className:"mt-4",children:e.length===0?a.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:a.jsx(ICe,{className:"w-8 h-8 text-gray-400"})}),a.jsx("h4",{className:"text-lg font-medium text-gray-700 mb-1",children:"No comments yet"}),a.jsx("p",{className:"text-sm text-gray-500 max-w-sm",children:"Be the first to share your thoughts. Start a conversation by adding a comment below."})]}):a.jsx("div",{className:"space-y-3",children:e.map(d=>a.jsxs("div",{className:"flex gap-3 p-3 bg-gray-100 rounded-lg border border-gray-100",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("div",{className:"w-9 h-9 bg-blue-500 rounded-full flex items-center justify-center text-white font-semibold text-sm",children:d.comment_creator?.profile_picture?a.jsx("img",{src:`${d.comment_creator.profile_picture}`,alt:`${d.comment_creator?.first_name||d.comment_creator?.email||"User"}'s profile`,className:"w-9 h-9 rounded-full object-cover"}):d.comment_creator?.first_name?.[0]||d.comment_creator?.email?.[0]?.toUpperCase()||"U"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[a.jsx("span",{className:"font-medium text-gray-800 text-sm",children:d.comment_creator?.first_name||d.comment_creator?.email||"Unknown User"}),a.jsx("span",{className:"text-xs text-gray-400",children:new Date(d.created_at).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"})}),d.is_private&&a.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-amber-100 text-amber-700 rounded-full text-xs font-medium",children:[a.jsx(IR,{className:"w-3 h-3"}),"Private"]})]}),a.jsx("p",{className:"mt-1 text-gray-600 whitespace-pre-wrap break-words text-xs",children:d.comment})]})]},d.id))})}),a.jsxs("form",{onSubmit:u,className:"mt-6 pt-4 border-t border-gray-200 text-sm",children:[a.jsx("div",{className:"relative",children:a.jsx("textarea",{value:s,onChange:d=>r(d.target.value),placeholder:"Write a comment...",rows:2,className:"w-full px-4 py-3 border border-gray-300 rounded-lg resize-none focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-700 placeholder-gray-400"})}),a.jsxs("div",{className:"flex items-center justify-between mt-3",children:[a.jsx("button",{type:"button",onClick:()=>o(!i),className:`cursor-pointer flex items-center gap-2 px-3 py-1.5 rounded-full text-sm font-medium transition-all duration-200 ${i?"bg-amber-100 text-amber-700 hover:bg-amber-200":"bg-green-100 text-green-700 hover:bg-green-200"}`,children:i?a.jsxs(a.Fragment,{children:[a.jsx(IR,{className:"w-4 h-4"}),"Private"]}):a.jsxs(a.Fragment,{children:[a.jsx(PCe,{className:"w-4 h-4"}),"Public"]})}),a.jsxs("button",{type:"submit",disabled:!s.trim()||l,className:"cursor-pointer flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200",children:[a.jsx(FCe,{className:"w-4 h-4"}),l?"Posting...":"Post Comment"]})]})]})]})}async function BCe({relatedType:e,relatedId:t}){const n=await ne.get("/comments",{params:{related_type:e,related_id:t}});return Array.isArray(n.data)?n.data:[]}async function HCe({relatedType:e,relatedId:t,comment:n,isPrivate:s}){return(await ne.post("/comments",{related_type:e,related_id:t,comment:n,is_private:!!s})).data}function kn({relatedType:e,relatedId:t}){const[n,s]=f.useState([]),[r,i]=f.useState(!1),o=f.useCallback(async()=>{if(!e||!t){s([]);return}i(!0);try{const c=await BCe({relatedType:e,relatedId:t});s(c)}finally{i(!1)}},[e,t]),l=f.useCallback(async({comment:c,is_private:u})=>{!e||!t||(await HCe({relatedType:e,relatedId:t,comment:c,isPrivate:u}),await o())},[e,t,o]);return f.useEffect(()=>{o()},[o]),{comments:n,loading:r,refresh:o,addComment:l}}const q2=[{value:"CUSTOMER",label:"Customer"},{value:"PROSPECT",label:"Prospect"},{value:"PARTNER",label:"Partner"},{value:"ACTIVE",label:"Vendor"},{value:"INACTIVE",label:"Inactive"},{value:"FORMER",label:"Delete"}],rb={name:"",website:"",phone_number:"",billing_address:"",shipping_address:"",industry:"",parent_company:"",status:"PROSPECT",territory_id:"",assigned_to:""},lr=e=>e?e.toUpperCase():"",G2=e=>e?e.toString().toLowerCase().replace(/\b\w/g,t=>t.toUpperCase()):"--",qCe=e=>{switch(lr(e)){case"CUSTOMER":return"bg-green-600 text-white";case"PROSPECT":return"bg-purple-600 text-white";case"PARTNER":return"bg-pink-600 text-white";case"ACTIVE":return"bg-blue-600 text-white";case"INACTIVE":return"bg-gray-600 text-white";case"FORMER":return"bg-orange-600 text-white";default:return"bg-gray-500 text-white"}},GCe=e=>{switch(lr(e)){case"CUSTOMER":return"bg-green-100 text-green-700";case"PROSPECT":return"bg-purple-100 text-purple-700";case"PARTNER":return"bg-pink-100 text-pink-700";case"ACTIVE":return"bg-blue-100 text-blue-700";case"INACTIVE":return"bg-gray-200 text-gray-700";case"FORMER":return"bg-orange-100 text-orange-700";default:return"bg-gray-100 text-gray-700"}};function WCe(){const e=Et(),t=ta();f.useEffect(()=>{document.title="Accounts | Sari-Sari CRM"},[]);const[n,s]=f.useState(!1),[r,i]=f.useState(!1),[o,l]=f.useState(!1),[c,u]=f.useState(null),[d,h]=f.useState(null),[p,x]=f.useState(rb),[b,j]=f.useState(null),[y,N]=f.useState([]),[w,S]=f.useState(!1),[_,T]=f.useState([]),[k,A]=f.useState(null),[E,M]=f.useState([]),[F,D]=f.useState([]),[P,B]=f.useState("Filter by Status"),[G,$]=f.useState(""),[W,Z]=f.useState(null),[Q,le]=f.useState(!1),[we,J]=f.useState(1),[se,ye]=f.useState(10),[Ce,ge]=f.useState("Overview"),[be,me]=f.useState(""),[Ae,pe]=f.useState(!1),[Ie,xe]=f.useState([]),[he,Re]=f.useState({}),[Ee,He]=f.useState(null),{comments:Ke,addComment:st,refresh:it}=kn({relatedType:"account",relatedId:b?.id});f.useEffect(()=>{b?.id&&it()},[b?.id,it]);const ot=f.useCallback(async(qe=null)=>{S(!0);try{const _e=await ne.get("/accounts/admin/fetch-all"),L=[...Array.isArray(_e.data)?_e.data:[]].sort((ee,ke)=>{const $e=ee?.created_at||ee?.updated_at||0,We=ke?.created_at||ke?.updated_at||0;return new Date(We)-new Date($e)});if(N(L),qe){const ee=L.find(ke=>ke.id===qe);j(ee||null)}}catch(_e){console.error(_e),N([]),_e.response?.status===403?V.error("Permission denied. Only CEO, Admin, or Group Manager can access this page."):V.error("Failed to fetch accounts. Please try again later.")}finally{S(!1)}},[j]),rt=f.useCallback(async()=>{try{const qe=await ne.get("/users/all");T(Array.isArray(qe.data)?qe.data:[])}catch(qe){console.error(qe),qe.response?.status===403&&V.warn("Unable to load users for assignment (permission denied).")}},[]),at=f.useCallback(async()=>{try{const qe=await ne.get("/territories/fetch");M(Array.isArray(qe.data)?qe.data:[])}catch(qe){console.error(qe),qe.response?.status===403&&V.warn("Unable to load territories (permission denied).")}},[]),Je=f.useCallback(async()=>{try{const qe=await ne.get("/accounts/admin/parent-companies");D(Array.isArray(qe.data)?qe.data:[])}catch(qe){console.error(qe),qe.response?.status===403&&V.warn("Unable to load parent companies (permission denied).")}},[]),Fe=f.useCallback(async qe=>{try{const _e=await ne.get(`/activities/accounts/${qe}`);Re(_e.data&&typeof _e.data=="object"?_e.data:{})}catch(_e){console.error(_e),_e.response?.status===404&&(console.warn("No activities found for this account."),Re({}))}},[]);f.useEffect(()=>{ot(),rt(),at(),Je()},[ot,rt,at,Je]),f.useEffect(()=>{J(1)},[G,P,se]);const Ue=f.useMemo(()=>{const qe=G.toLowerCase(),_e=P;return y.filter(I=>{const L=I.name?.toLowerCase().includes(qe)||I.website?.toLowerCase().includes(qe)||I.phone_number?.toLowerCase().includes(qe)||I.industry?.toLowerCase().includes(qe)||I.parent_company?.toLowerCase().includes(qe)||I.territory?.name?.toLowerCase().includes(qe),ee=_e==="Filter by Status"||lr(I.status)===lr(_e);return L&&ee})},[y,G,P]),Ne=Math.max(1,Math.ceil(Ue.length/se)||1);f.useEffect(()=>{J(qe=>{const _e=Math.max(1,Math.ceil(Ue.length/se)||1);return qe>_e?_e:qe})},[Ue.length,se]);const ze=f.useMemo(()=>{const qe=(we-1)*se;return Ue.slice(qe,qe+se)},[Ue,we,se]),je=qe=>{if(qe.target.checked){const _e=ze.map(I=>I.id);xe(_e)}else xe([])},ve=qe=>{xe(_e=>_e.includes(qe)?_e.filter(I=>I!==qe):[..._e,qe])},z=async()=>{Ie.length!==0&&Z({title:"Delete Accounts",message:a.jsxs("span",{children:["Are you sure you want to delete"," ",a.jsx("span",{className:"font-semibold",children:Ie.length})," selected accounts? This action cannot be undone."]}),confirmLabel:`Delete ${Ie.length} Account(s)`,cancelLabel:"Cancel",variant:"danger",action:{type:"bulk-delete",accountIds:Ie}})};Ue.length===0||(we-1)*se+1,Math.min(we*se,Ue.length);const K=()=>J(qe=>Math.max(qe-1,1)),ue=()=>J(qe=>Math.min(qe+1,Ne));f.useEffect(()=>{b&&me(lr(b.status)||"PROSPECT")},[b]);const re=y.length,Le=f.useMemo(()=>y.filter(qe=>qe.status?.toLowerCase()==="customer").length,[y]),De=f.useMemo(()=>y.filter(qe=>qe.status?.toLowerCase()==="prospect").length,[y]),Qe=f.useMemo(()=>y.filter(qe=>qe.status?.toLowerCase()==="partner").length,[y]),tt=f.useMemo(()=>y.filter(qe=>qe.status?.toLowerCase()==="active").length,[y]),Me=f.useMemo(()=>y.filter(qe=>qe.status?.toLowerCase()==="inactive").length,[y]),et=f.useMemo(()=>y.filter(qe=>qe.status?.toLowerCase()==="former").length,[y]),yt=f.useMemo(()=>[{title:"Total",value:re,icon:Xa,color:"text-slate-600",bgColor:"bg-slate-100"},{title:"Customers",value:Le,icon:Qi,color:"text-green-600",bgColor:"bg-green-100"},{title:"Prospects",value:De,icon:rn,color:"text-purple-600",bgColor:"bg-purple-100"},{title:"Partners",value:Qe,icon:ra,color:"text-pink-600",bgColor:"bg-pink-100"},{title:"Active",value:tt,icon:Qi,color:"text-blue-600",bgColor:"bg-blue-100"},{title:"Inactive",value:Me,icon:Ki,color:"text-gray-600",bgColor:"bg-gray-100"},{title:"Former",value:et,icon:Ki,color:"text-orange-600",bgColor:"bg-orange-100"}],[re,Le,De,Qe,tt,Me,et]),_t=qe=>{j(qe),ge("Overview"),me(lr(qe?.status)||"PROSPECT")},Ct=()=>j(null),jt=qe=>{qe.target.id==="accountModalBackdrop"&&!Q&&Ct()},At=()=>{s(!1),i(!1),h(null),x(rb),l(!1),A(null)},Ge=qe=>{qe.target.id==="modalBackdrop"&&At()},Be=qe=>qe?new Date(qe).toLocaleString("en-US",{month:"short",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).replace(",",""):"",ce=qe=>{const{name:_e,value:I}=qe.target;x(L=>({...L,[_e]:I}))},fe=()=>{x(rb),i(!1),h(null),s(!0)};f.useEffect(()=>{const qe=new URLSearchParams(t.search||"");(t.state?.openAccountModal||qe.get("openModal")==="1")&&(x(rb),i(!1),h(null),s(!0),Te(!1),e(t.pathname,{replace:!0,state:{}}))},[t.state,t.pathname,t.search,e]);const H=qe=>{j(null),qe.assigned_accs?A(qe.assigned_accs):A(null),x({name:qe.name||"",website:qe.website||"",phone_number:qe.phone_number||"",billing_address:qe.billing_address||"",shipping_address:qe.shipping_address||"",parent_company:qe.parent_company||"",industry:qe.industry||"",status:lr(qe.status)||"PROSPECT",territory_id:qe.territory?.id?String(qe.territory.id):"",assigned_to:qe.assigned_accs?.id?String(qe.assigned_accs.id):""}),i(!0),h(qe.id),s(!0)},te=qe=>{qe&&Z({title:"Delete Account",message:a.jsxs("span",{children:["Are you sure you want to permanently delete the account"," ",a.jsx("span",{className:"font-semibold",children:qe.name}),"? This action cannot be undone."]}),confirmLabel:"Delete Account",cancelLabel:"Cancel",variant:"danger",action:{type:"delete",targetId:qe.id,name:qe.name}})},q=async()=>{if(!W?.action){Z(null);return}const{action:qe}=W,{type:_e,payload:I,targetId:L,name:ee,accountIds:ke}=qe;le(!0);try{if(_e==="create"){l(!0);const $e=await ne.post("/accounts/admin",I);Je(),V.success(`Account "${ee}" created successfully.`);const We=b?.id||null;At(),await ot(We),!b&&$e.data?.id}else if(_e==="update"){if(!L)throw new Error("Missing account identifier for update.");l(!0),await ne.put(`/accounts/admin/${L}`,I),V.success(`Account "${ee}" updated successfully.`);const $e=b?.id&&b.id===L?L:null;At(),await ot($e),b?.id===L&&j(null)}else if(_e==="delete"){if(!L)throw new Error("Missing account identifier for deletion.");const $e=b?.id;u(L),await ne.delete(`/accounts/admin/${L}`),V.success(`Account "${ee}" deleted successfully.`),await ot($e&&$e!==L?$e:null),$e===L&&j(null)}else _e==="bulk-delete"&&(await ne.delete("/accounts/admin/bulk-delete",{data:{account_ids:ke}}),V.success(`Successfully deleted ${ke.length} accounts`),xe([]),await ot())}catch($e){console.error($e);const We=_e==="create"?"Failed to create account. Please review the details and try again.":_e==="update"?"Failed to update account. Please review the details and try again.":_e==="bulk-delete"?"Failed to delete selected accounts.":"Failed to delete account. Please try again.",mt=$e.response?.data?.detail||We;V.error(mt),(_e==="create"||_e==="update")&&l(!1),_e==="delete"&&u(null)}finally{(_e==="create"||_e==="update")&&l(!1),_e==="delete"&&u(null),le(!1),Z(null)}},Y=()=>{Q||Z(null)},U=async()=>{if(!b||!be)return;const qe=lr(be),_e=lr(b.status);if(qe!==_e){pe(!0);try{await ne.put(`/accounts/admin/${b.id}`,{status:qe}),V.success(`Account status updated to ${G2(qe)}`),N(I=>I.map(L=>L.id===b.id?{...L,status:qe}:L)),j(null)}catch(I){console.error(I);const L=I.response?.data?.detail||"Failed to update account status. Please try again.";V.error(L)}finally{pe(!1)}}},[de,Te]=f.useState(!1),ie=qe=>{qe.preventDefault(),Te(!0);const _e=p.name.trim();if(!_e){V.error("Account name is required.");return}if(!p.assigned_to){V.error("Assigned To is required.");return}const L={name:_e,website:p.website?.trim()||null,phone_number:p.phone_number?.trim()||null,billing_address:p.billing_address?.trim()||null,shipping_address:p.shipping_address?.trim()||null,industry:p.industry?.trim()||null,parent_company:p.parent_company?.trim()||null,status:p.status||"PROSPECT",territory_id:p.territory_id?Number(p.territory_id):null,assigned_to:p.assigned_to?Number(p.assigned_to):null},ee=r&&d?"update":"create";Z({title:ee==="create"?"Confirm New Account":"Confirm Update",message:ee==="create"?a.jsxs("span",{children:["Are you sure you want to create the account"," ",a.jsx("span",{className:"font-semibold",children:_e}),"?"]}):a.jsxs("span",{children:["Save changes to the account"," ",a.jsx("span",{className:"font-semibold",children:_e}),"?"]}),confirmLabel:ee==="create"?"Create Account":"Update Account",cancelLabel:"Cancel",variant:"primary",action:{type:ee,payload:L,targetId:d||null,name:_e}})},Oe=[{label:"Filter by Status",value:"Filter by Status"},...q2.map(qe=>({label:qe.label,value:qe.value}))],X=W?.action?.type==="delete"?W.action.targetId:null,oe=b&&(c===b.id||X===b.id),Pe=b&&c===b.id,Ve=b?qCe(b.status):"",ft=b?a.jsx("div",{id:"accountModalBackdrop",onClick:jt,className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-6xl max-h-[92vh] overflow-y-auto hide-scrollbar animate-scale-in font-inter relative",onClick:qe=>qe.stopPropagation(),children:[a.jsxs("div",{className:"bg-tertiary w-full rounded-t-xl flex items-center justify-between p-3 lg:p-3",children:[a.jsx("h1",{className:"lg:text-3xl text-xl text-white font-semibold text-center w-full",children:"Account"}),a.jsx("button",{onClick:Ct,className:"text-gray-400 hover:text-white cursor-pointer",children:a.jsx(Za,{size:25})})]}),a.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between lg:flex-row lg:items-center lg:justify-between mt-3 gap-2 px-2 md:items-center lg:gap-4 md:mx-7 lg:mx-7",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[a.jsx("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-800",children:b.name}),a.jsx("span",{className:`text-xs sm:text-sm font-medium px-2 sm:px-3 py-1 rounded-full whitespace-nowrap ${Ve}`,children:G2(b.status)})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsxs("button",{className:"inline-flex items-center justify-center w-full sm:w-auto bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 disabled:opacity-70 transition text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",onClick:()=>H(b),disabled:W?.action?.type==="update"&&W.action.targetId===b.id,children:[a.jsx(gn,{className:"mr-2"}),"Edit"]}),a.jsx("button",{className:"inline-flex items-center justify-center w-full sm:w-auto px-4 py-2 rounded-md text-sm bg-red-500 text-white hover:bg-red-600 transition focus:outline-none focus:ring-2 focus:ring-red-400",onClick:()=>te(b),disabled:!!oe,children:Pe?"Deleting...":a.jsxs(a.Fragment,{children:[a.jsx(_a,{className:"mr-2"}),"Delete"]})})]})]}),a.jsx("div",{className:"border-b border-gray-200 my-5"}),a.jsxs("div",{className:"p-6 lg:p-4",children:[a.jsx("div",{className:"flex w-full bg-[#6A727D] text-white mt-1 overflow-x-auto mb-6",children:["Overview","Activities"].map(qe=>a.jsx("button",{onClick:()=>ge(qe),className:`flex-1 min-w-[90px] px-4 py-2.5 text-xs sm:text-sm font-medium text-center transition-all duration-200 border-b-2
        ${Ce===qe?"bg-paper-white text-[#6A727D] border-white":"text-white hover:bg-[#5c636d]"}`,children:qe},qe))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 items-start",children:[a.jsxs("div",{className:"lg:col-span-3",children:[Ce==="Overview"&&a.jsxs("div",{className:"h-full max-h-100 md:max-h-70 overflow-y-auto hide-scrollbar",children:[a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 md:p-8 border border-gray-200",children:a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4 sm:gap-6 text-sm text-gray-700",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Website:"}),a.jsx("p",{children:b.website?a.jsx("a",{href:b.website,className:"text-blue-600 hover:underline break-all",target:"_blank",rel:"noopener noreferrer",children:b.website}):"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Industry:"}),a.jsx("p",{children:b.industry||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Parent Company:"}),a.jsx("p",{children:b.parent_company||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Territory:"}),a.jsx("p",{children:b.territory?.name||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Phone Number:"}),a.jsx("p",{children:b.phone_number||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Billing Address:"}),a.jsx("p",{children:b.billing_address||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Shipping Address:"}),a.jsx("p",{children:b.shipping_address||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Assigned To:"}),a.jsx("p",{children:b.assigned_accs?`${b.assigned_accs.first_name} ${b.assigned_accs.last_name}`:"Unassigned"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created By:"}),a.jsx("p",{children:b.acc_creator?`${b.acc_creator.first_name} ${b.acc_creator.last_name}`:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created At:"}),a.jsx("p",{children:Be(b.created_at)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Last Updated:"}),a.jsx("p",{children:Be(b.updated_at)||"N/A"})]})]})}),a.jsx(Tn,{comments:Ke,onAddComment:st})]}),Ce==="Notes"&&a.jsxs("div",{className:"mt-4 w-full",children:[a.jsx("div",{className:"flex flex-wrap items-center justify-between mb-4 gap-2",children:a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words",children:"Account Note"})}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 shadow-sm break-words",children:[a.jsx("div",{className:"flex items-start justify-between",children:a.jsx("div",{children:a.jsx("p",{className:"text-sm font-medium text-gray-800 break-words",children:"Note"})})}),a.jsx("div",{className:"mt-3 text-sm text-gray-700 whitespace-pre-wrap break-words",children:y.notes||"No notes available."})]})]}),Ce==="Activities"&&a.jsxs("div",{className:"space-y-2 w-full h-full max-h-[50dvh] overflow-y-auto bg-gray-50 p-2 hide-scrollbar rounded-lg border border-gray-200 shadow-sm",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words border-b border-gray-300 py-2",children:"Related Activities"}),a.jsxs("div",{className:"space-y-2 text-sm",children:[he.tasks&&he.tasks.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>He(Ee==="tasks"?null:"tasks"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Qt,{className:"text-blue-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Tasks (",he.tasks.length,")"]})]}),Ee==="tasks"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Ee==="tasks"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:he.tasks.map((qe,_e)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/admin/tasks",{state:{taskID:qe.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-blue-600 mt-1",children:a.jsx(Qt,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:qe.subject||qe.title||"Task"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:qe.description||"No description"}),qe.assigned_to&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Assigned: ",qe.assigned_to.first_name," ",qe.assigned_to.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:Be(qe.due_date||qe.created_at)})]},`task-${_e}`))})]}),he.meetings&&he.meetings.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>He(Ee==="meetings"?null:"meetings"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Pt,{className:"text-green-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Meetings (",he.meetings.length,")"]})]}),Ee==="meetings"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Ee==="meetings"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:he.meetings.map((qe,_e)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/admin/meetings",{state:{meetingID:qe.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-green-600 mt-1",children:a.jsx(Pt,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:qe.subject||qe.title||"Meeting"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:qe.description||qe.location||"No description"}),qe.host&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Host: ",qe.host.first_name," ",qe.host.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:Be(qe.start_time||qe.created_at)})]},`meeting-${_e}`))})]}),he.calls&&he.calls.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>He(Ee==="calls"?null:"calls"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(It,{className:"text-purple-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Calls (",he.calls.length,")"]})]}),Ee==="calls"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Ee==="calls"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:he.calls.map((qe,_e)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/admin/calls",{state:{callID:qe.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-purple-600 mt-1",children:a.jsx(It,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:qe.subject||qe.title||"Call"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:qe.direction||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:Be(qe.call_time||qe.created_at)})]},`call-${_e}`))})]}),he.contacts&&he.contacts.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>He(Ee==="contacts"?null:"contacts"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ra,{className:"text-teal-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Contacts (",he.contacts.length,")"]})]}),Ee==="contacts"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Ee==="contacts"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:he.contacts.map((qe,_e)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/admin/contacts",{state:{contactID:qe.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-teal-600 mt-1",children:a.jsx(ra,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("h4",{className:"font-medium text-blue-600 break-words text-sm",children:[qe.first_name?`${qe.first_name} `:"",qe.last_name]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:qe.title||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:Be(qe.created_at)})]},`contact-${_e}`))})]}),he.deals&&he.deals.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>He(Ee==="deals"?null:"deals"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(sa,{className:"text-indigo-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Deals (",he.deals.length,")"]})]}),Ee==="deals"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Ee==="deals"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:he.deals.map((qe,_e)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/admin/deals",{state:{dealID:qe.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-indigo-600 mt-1",children:a.jsx(sa,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("h4",{className:"font-medium text-blue-600 break-words text-sm",children:[qe.deal_id?qe.deal_id.replace(/D(\d+)-\d+-/,"D$1-"):"--"," ",qe.name||qe.title||"Deal"]}),a.jsx("p",{className:"text-xs text-gray-500 break-words capitalize",children:qe.stage||qe.description||"No description"})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:Be(qe.close_date||qe.created_at)})]},`deal-${_e}`))})]}),he.quotes&&he.quotes.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>He(Ee==="quotes"?null:"quotes"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ia,{className:"text-orange-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Quotes (",he.quotes.length,")"]})]}),Ee==="quotes"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Ee==="quotes"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:he.quotes.map((qe,_e)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/admin/quotes",{state:{quoteID:qe.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-orange-600 mt-1",children:a.jsx(ia,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:(qe.quote_id?qe.quote_id.replace(/Q(\d+)-\d+-/,"Q$1-"):"--")||"Quote"}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:qe.status||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:Be(qe.presented_date)||""})]},`quote-${_e}`))})]}),(!he||(!he.tasks||he.tasks.length===0)&&(!he.meetings||he.meetings.length===0)&&(!he.calls||he.calls.length===0)&&(!he.quotes||he.quotes.length===0)&&(!he.deals||he.deals.length===0)&&(!he.contacts||he.contacts.length===0))&&a.jsx("div",{className:"text-center py-8 text-gray-500",children:a.jsx("p",{children:"No related activities found for this account."})})]})]})]}),a.jsxs("div",{className:"flex flex-col gap-4",children:[a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Quick Actions"}),a.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[a.jsxs("button",{onClick:()=>e("/admin/calls",{state:{openCallModal:!0,initialCallData:{subject:`Call with ${b.name}`,relatedType1:"Account",relatedTo1:String(b.id),relatedType2:null,relatedTo2:null,assigned_to:b.assigned_accs?.id?String(b.assigned_accs.id):"",direction:"Outgoing",status:"Planned"}}}),className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(It,{className:"text-gray-600 w-4 h-4"}),"Schedule Call"]}),a.jsxs("button",{onClick:()=>e("/admin/meetings",{state:{openMeetingModal:!0,initialMeetingData:{subject:`Meeting with ${b.name}`,relatedType1:"Account",relatedTo1:String(b.id),relatedType2:null,relatedTo2:null,assignedTo:b.assigned_accs?.id?String(b.assigned_accs.id):"",status:"Planned"}}}),className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(Pt,{className:"text-gray-600 w-4 h-4"}),"Book Meeting"]}),a.jsxs("button",{onClick:()=>e("/admin/tasks",{state:{openTaskModal:!0,initialTaskData:{subject:`Follow up with ${b.name}`,relatedType1:"Account",relatedTo1:String(b.id),relatedType2:null,relatedTo2:null,assignedTo:b.assigned_accs?.id?String(b.assigned_accs.id):"",priority:"NORMAL",status:"Not Started"}}}),className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(Qt,{className:"text-gray-600 w-4 h-4"}),"Tasks"]})]})]}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm w-full",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Status"}),a.jsx("select",{className:"border border-gray-200 rounded-md px-2 sm:px-3 py-1.5 w-full text-sm mb-2 focus:ring-2 focus:ring-indigo-500 outline-none",value:be||lr(b?.status)||"PROSPECT",onChange:qe=>me(qe.target.value),children:q2.map(qe=>a.jsx("option",{value:qe.value,children:qe.label},qe.value))}),a.jsx("button",{onClick:U,disabled:Ae||!be||lr(be)===lr(b?.status),className:`w-full py-1.5 rounded-md text-sm transition focus:outline-none focus:ring-2 ${Ae||!be||lr(be)===lr(b?.status)?"bg-gray-400 cursor-not-allowed text-white":"bg-gray-900 text-white hover:bg-gray-800 focus:ring-gray-400"}`,children:Ae?"Updating...":"Update"})]})]})]})]})]})}):null,St=a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[w&&a.jsx(qt,{message:"Loading accounts..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h2",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(Xa,{className:"mr-2 text-blue-600"}),"Accounts Management"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{onClick:()=>{fe(),Te(!1)},className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 my-1 lg:my-0 rounded-md hover:bg-gray-800 text-sm sm:text-base mx-auto sm:ml-auto cursor-pointer",children:[a.jsx(aa,{className:"mr-2"})," Add Account"]})})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4 mb-6 w-full break-words overflow-hidden lg:overflow-visible",children:yt.map(qe=>a.jsx(VCe,{...qe},qe.title))}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search accounts",value:G,onChange:qe=>$(qe.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsx("div",{className:"w-full lg:w-1/4",children:a.jsx("select",{value:P,onChange:qe=>B(qe.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:Oe.map(qe=>a.jsx("option",{value:qe.value,children:qe.label},qe.value))})})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[500px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 text-sm tracking-wide font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 text-center w-12",children:a.jsx("input",{type:"checkbox",checked:ze.length>0&&ze.every(qe=>Ie.includes(qe.id)),onChange:je,className:"form-checkbox h-4 w-4 text-blue-600 rounded focus:ring-blue-500 border-gray-300"})}),a.jsx("th",{className:"py-3 px-4 truncate",children:"Account"}),a.jsx("th",{className:"py-3 px-4",children:"Status"}),a.jsx("th",{className:"py-3 px-4",children:"Industry"}),a.jsx("th",{className:"py-3 px-4",children:"Territory"}),a.jsx("th",{className:"py-3 px-4",children:"Phone"}),a.jsx("th",{className:"py-3 px-4 text-center w-24",children:Ie.length>0?a.jsx("button",{onClick:z,className:"text-red-600 hover:text-red-800 transition p-1 rounded-full hover:bg-red-50",title:`Delete ${Ie.length} selected items`,children:a.jsx(_a,{size:18})}):""})]})}),a.jsx("tbody",{children:w?a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:7,children:"Loading accounts..."})}):Ue.length>0?ze.map(qe=>a.jsxs("tr",{className:"hover:bg-gray-50 text-xs cursor-pointer",onClick:()=>{_t(qe),Fe(qe.id)},children:[a.jsx("td",{className:"py-3 px-4 text-center",children:a.jsx("input",{type:"checkbox",checked:Ie.includes(qe.id),onChange:()=>ve(qe.id),onClick:_e=>_e.stopPropagation(),className:"form-checkbox h-4 w-4 text-blue-600 rounded focus:ring-blue-500 border-gray-300"})}),a.jsx("td",{className:"py-3 px-4",children:a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-blue-600 hover:underline break-all text-sm",children:qe.name}),a.jsx("div",{className:"text-gray-500 text-xs break-all",children:qe.website||"--"})]})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${GCe(qe.status)}`,children:G2(qe.status)})}),a.jsx("td",{className:"py-3 px-4 text-sm",children:qe.industry||"--"}),a.jsx("td",{className:"py-3 px-4 text-sm",children:qe.territory?.name||"--"}),a.jsx("td",{className:"py-3 px-4",children:a.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[a.jsx(It,{className:"text-gray-500"}),a.jsx("span",{children:qe.phone_number||"--"})]})}),a.jsx("td",{className:"py-3 px-4 text-center"})]},qe.id)):a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:7,children:"No accounts found."})})})]})}),a.jsx(ca,{className:"mt-4",totalItems:Ue.length,pageSize:se,currentPage:we,onPrev:K,onNext:ue,onPageSizeChange:qe=>{ye(qe),J(1)},pageSizeOptions:[10,20,30,40,50],label:"accounts"})]}),Ht=n?a.jsx("div",{id:"modalBackdrop",onClick:Ge,className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-full sm:max-w-3xl rounded-2xl shadow-lg p-4 sm:p-6 md:p-8 relative border border-gray-200 overflow-y-auto hide-scrollbar max-h-[90vh]",onClick:qe=>qe.stopPropagation(),children:[a.jsx("button",{onClick:()=>{At(),Te(!1)},className:"absolute top-4 right-4 text-gray-500 hover:text-black transition",disabled:o||Q,children:a.jsx(ea,{size:22})}),a.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800 mb-4 sm:mb-6 flex items-center justify-center",children:r?"Edit Account":"Add New Account"}),a.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",onSubmit:ie,noValidate:!0,children:[a.jsx("div",{className:"md:col-span-2",children:a.jsx(sf,{label:"Name",name:"name",value:p.name,onChange:ce,placeholder:"Company name",required:!0,isSubmitted:de})}),a.jsx(RR,{label:"Parent Company",value:p.parent_company,onChange:qe=>{x(_e=>({..._e,parent_company:qe}))},items:F.map(qe=>({id:qe,name:qe})),getLabel:qe=>qe?.name||"",placeholder:"Select parent company...",disabled:o}),a.jsx(sf,{label:"Website",name:"website",value:p.website,onChange:ce,placeholder:"https://example.com",disabled:o}),a.jsx(sf,{label:"Phone Number",name:"phone_number",value:p.phone_number,onChange:ce,placeholder:"09xx xxx xxxx",type:"tel",disabled:o}),a.jsx(sf,{label:"Industry",name:"industry",value:p.industry,onChange:ce,placeholder:"Industry",disabled:o}),a.jsx(sf,{label:"Billing Address",name:"billing_address",value:p.billing_address,onChange:ce,placeholder:"Billing address",disabled:o}),a.jsx(sf,{label:"Shipping Address",name:"shipping_address",value:p.shipping_address,onChange:ce,placeholder:"Shipping address",disabled:o}),a.jsx($R,{label:"Status",name:"status",value:p.status,onChange:ce,options:[{value:"",label:"Select status"},...q2],required:!0,disabled:o}),a.jsx(RR,{label:"Assigned To",value:p.assigned_to,onChange:qe=>{const _e=_.find(L=>String(L.id)===String(qe));A(_e);let I=null;_e&&_e.assigned_territory&&_e.assigned_territory.length===1&&(I=_e.assigned_territory[0].id),x(L=>({...L,assigned_to:qe,territory_id:I}))},items:_||[],getLabel:qe=>`${qe?.first_name??""} ${qe?.last_name??""} (${qe?.role?.toUpperCase()==="CEO"?"Admin":qe?.role??""})`.trim(),placeholder:"Search assignee...",required:!0,isSubmitted:de,disabled:o||_.length===0}),a.jsx("div",{className:"md:col-span-2",children:a.jsx($R,{label:"Territory",name:"territory_id",value:p.territory_id||"",onChange:ce,options:[{value:"",label:k?k.assigned_territory&&k.assigned_territory.length>0?"Select Territory":"No territories assigned to this user":"Select a user first"},...k&&k.assigned_territory&&k.assigned_territory.map(qe=>({value:String(qe.id),label:qe.name}))||[]],disabled:o||!k||!k.assigned_territory||k.assigned_territory.length===0})}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-end sm:justify-end space-y-2 sm:space-y-0 sm:space-x-2 col-span-1 md:col-span-2 mt-4 w-full",children:[a.jsx("button",{type:"button",onClick:()=>{At(),Te(!1)},className:"w-full sm:w-auto px-4 py-2 text-white bg-red-400 border border-red-300 rounded hover:bg-red-500 transition disabled:opacity-70",disabled:o||Q,children:"Cancel"}),a.jsx("button",{type:"submit",className:"w-full sm:w-auto px-4 py-2 text-white border border-tertiary bg-tertiary rounded hover:bg-secondary transition disabled:opacity-70",disabled:o||Q,children:o?"Saving...":r?"Update Account":"Save Account"})]})]})]})}):null,da=W?a.jsx(QCe,{open:!0,title:W.title,message:W.message,confirmLabel:W.confirmLabel,cancelLabel:W.cancelLabel,variant:W.variant,onConfirm:q,onCancel:Y,loading:Q}):null;return a.jsxs(a.Fragment,{children:[St,ft,Ht,da]})}function VCe({icon:e,title:t,value:n,color:s="text-blue-600",bgColor:r="bg-blue-100",onClick:i}){const o=()=>{typeof i=="function"?i():console.log(`Clicked: ${t}`)};return a.jsxs("div",{className:"flex items-center p-4 bg-white rounded-xl shadow-md border border-gray-200 transition-all duration-300",onClick:o,children:[a.jsx("div",{className:`flex-shrink-0 p-3 rounded-full ${r} ${s} mr-4`,children:e?a.jsx(e,{size:22}):null}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:t}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:n})]})]})}function sf({label:e,name:t,value:n,onChange:s,placeholder:r,type:i="text",required:o=!1,disabled:l=!1,className:c="",isSubmitted:u=!1}){const d=u&&!n?.trim();return a.jsxs("div",{children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",o&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:i,name:t,value:n??"",onChange:s,placeholder:r,required:o,disabled:l,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border focus:ring-2
          ${d?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}
          ${c}
        `})]})}function $R({label:e,name:t,value:n,onChange:s,options:r,required:i=!1,disabled:o=!1}){return a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsx("select",{name:t,value:n??"",onChange:s,required:i,disabled:o,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100",children:r.map(l=>a.jsx("option",{value:l.value,children:l.label},l.value))})]})}function RR({label:e,items:t=[],value:n="",onChange:s,getLabel:r,placeholder:i="Search...",disabled:o=!1,className:l="",required:c=!1,isSubmitted:u=!1,allowFreeText:d=!1}){const h=u&&c&&!n;return a.jsxs("div",{className:l,children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",c&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx(YCe,{items:t,value:n??"",onChange:s,getLabel:r,placeholder:i,disabled:o,hasError:h,allowFreeText:d})]})}function YCe({items:e=[],value:t="",onChange:n,getLabel:s,placeholder:r="Search...",disabled:i=!1,maxRender:o=200,hasError:l=!1,allowFreeText:c=!1}){const[u,d]=f.useState(!1),[h,p]=f.useState(""),x=f.useRef(null),b=e.find(N=>String(N.id)===String(t)),j=b?s(b):t,y=f.useMemo(()=>{const N=h.trim().toLowerCase();return(N?e.filter(S=>(s(S)||"").toLowerCase().includes(N)):e).slice(0,o)},[e,h,s,o]);return f.useEffect(()=>{const N=w=>{x.current&&!x.current.contains(w.target)&&d(!1)};return document.addEventListener("mousedown",N),()=>document.removeEventListener("mousedown",N)},[]),f.useEffect(()=>{u||p("")},[u]),a.jsxs("div",{ref:x,className:"relative w-full",children:[a.jsx("input",{disabled:i,value:u?h:j,placeholder:r,onFocus:()=>!i&&d(!0),onChange:N=>{p(N.target.value),u||d(!0)},className:`w-full border rounded-md px-2 py-1.5 text-sm outline-none focus:ring-2
          ${l?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}`}),u&&!i&&a.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg overflow-hidden",children:[a.jsxs("div",{className:"max-h-56 overflow-y-auto hide-scrollbar",children:[c&&h.trim()&&!y.some(N=>s(N).toLowerCase()===h.trim().toLowerCase())&&a.jsxs("button",{type:"button",onClick:()=>{n(h.trim()),d(!1)},className:"w-full text-left px-3 py-2 text-sm hover:bg-green-50 bg-blue-50 font-medium text-blue-700",children:['+ Add "',h.trim(),'" as new parent company']}),y.length>0?y.map(N=>{const w=String(N.id),S=s(N),_=String(t)===w;return a.jsx("button",{type:"button",onClick:()=>{n(w),d(!1)},className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-50 ${_?"bg-blue-50":""}`,children:S||"--"},w)}):!c||!h.trim()?a.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No results"}):null]}),e.length>o&&a.jsxs("div",{className:"px-3 py-2 text-[11px] text-gray-400 border-t",children:["Showing first ",o," results  keep typing to narrow."]})]})]})}function QCe({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o=!1,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsx("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${u}`,disabled:o,children:o?"Processing...":s})]})]})})}function Kx(e){return Ot({attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M4 2.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zm3 0a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zm3.5-.5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5zM4 5.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zM7.5 5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5zm2.5.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zM4.5 8a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5zm2.5.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zm3.5-.5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5z"},child:[]},{tag:"path",attr:{d:"M2 1a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1zm11 0H3v14h3v-2.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5V15h3z"},child:[]}]})(e)}const ib={first_name:"",last_name:"",account_id:"",title:"",department:"",email:"",work_phone:"",mobile_phone_1:"",mobile_phone_2:"",notes:"",assigned_to:""},yl=e=>[e?.first_name,e?.last_name].filter(Boolean).join(" ").trim(),fo=e=>e?new Date(e).toLocaleString("en-US",{month:"short",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).replace(",",""):"";function KCe(){const e=Et(),t=ta();f.useEffect(()=>{document.title="Contacts | Sari-Sari CRM"},[]);const[n,s]=f.useState([]),[r,i]=f.useState(!1),[o,l]=f.useState([]),[c,u]=f.useState([]),[d,h]=f.useState(null),[p,x]=f.useState(!1),[b,j]=f.useState(!1),[y,N]=f.useState(!1),[w,S]=f.useState(null),[_,T]=f.useState(!1),[k,A]=f.useState(null),[E,M]=f.useState(ib),[F,D]=f.useState(""),[P,B]=f.useState("Filter by Accounts"),[G,$]=f.useState(null),[W,Z]=f.useState("Overview"),[Q,le]=f.useState(1),[we,J]=f.useState(10),[se,ye]=f.useState({}),[Ce,ge]=f.useState(null),[be,me]=f.useState([]),[Ae,pe]=f.useState(null),{comments:Ie,addComment:xe,refresh:he}=kn({relatedType:"contact",relatedId:d?.id});f.useEffect(()=>{d?.id&&he()},[d?.id,he]),f.useEffect(()=>{const H=t.state?.contactID;H&&(pe(H),e(t.pathname,{replace:!0,state:{}}))},[t,e]),f.useEffect(()=>{if(Ae&&n.length>0&&!r){const H=n.find(te=>te.id===Ae);H?h(H):V.error("Contact not found."),pe(null)}},[Ae,n,r]);const Re=f.useCallback(async(H=null)=>{i(!0);try{const te=await ne.get("/contacts/admin/fetch-all"),Y=[...Array.isArray(te.data)?te.data:[]].sort((U,de)=>{const Te=U?.created_at||U?.updated_at||0,ie=de?.created_at||de?.updated_at||0;return new Date(ie)-new Date(Te)});if(s(Y),H){const U=Y.find(de=>de.id===H);h(U||null)}}catch(te){console.error(te),s([]),te.response?.status===403?V.error("Permission denied. Only CEO, Admin, or Group Manager can access this page."):V.error("Failed to fetch contacts. Please try again later.")}finally{i(!1)}},[h]),Ee=f.useCallback(async()=>{try{const H=await ne.get("/accounts/admin/fetch-all"),q=[...Array.isArray(H.data)?H.data:[]].sort((Y,U)=>(Y?.name||"").localeCompare(U?.name||""));l(q)}catch(H){console.error(H),l([]),H.response?.status===403&&V.warn("Unable to load accounts (permission denied).")}},[]),He=f.useCallback(()=>{window.open("/admin/accounts?openModal=1","_blank","noopener,noreferrer")},[]),Ke=f.useCallback(async()=>{try{const H=await ne.get("/users/all"),q=[...Array.isArray(H.data)?H.data:[]].sort((Y,U)=>yl(Y).localeCompare(yl(U)));u(q)}catch(H){console.error(H),u([]),H.response?.status===403&&V.warn("Unable to load users for assignment (permission denied).")}},[]),st=f.useCallback(async H=>{try{const te=await ne.get(`/activities/contact/${H}`);ye(te.data&&typeof te.data=="object"?te.data:{})}catch(te){console.error(te),te.response?.status===404&&(console.warn("No activities found for this account."),ye({}))}},[]);f.useEffect(()=>{Re(),Ee(),Ke()},[Re,Ee,Ke]);const it=f.useMemo(()=>{const H=new Map;o.forEach(q=>{q?.id&&q?.name&&H.set(String(q.id),q.name)}),n.forEach(q=>{q?.account_id&&q?.account?.name&&H.set(String(q.account_id),q.account.name)});const te=Array.from(H.entries()).sort((q,Y)=>q[1].localeCompare(Y[1])).map(([q,Y])=>({value:q,label:Y}));return[{value:"Filter by Accounts",label:"Filter by Accounts"},...te]},[o,n]),ot=f.useMemo(()=>{const H=F.trim().toLowerCase(),te=P.trim();return n.filter(q=>{const Y=[q?.first_name,q?.last_name,q?.email,q?.title,q?.department,q?.account?.name,q?.account?.status,q?.work_phone,q?.mobile_phone_1,q?.mobile_phone_2,q?.assigned_contact?.first_name,q?.assigned_contact?.last_name,q?.contact_creator?.first_name,q?.contact_creator?.last_name,q?.notes,fo(q?.created_at),fo(q?.updated_at)],U=H===""||Y.some(Te=>Te==null?!1:Te.toString().toLowerCase().includes(H)),de=te==="Filter by Accounts"||String(q.account_id)===te;return U&&de})},[n,F,P]),rt=Math.max(1,Math.ceil(ot.length/we)||1);f.useEffect(()=>{le(1)},[F,P,we]),f.useEffect(()=>{le(H=>{const te=Math.max(1,Math.ceil(ot.length/we)||1);return H>te?te:H})},[ot.length,we]);const at=f.useMemo(()=>{const H=(Q-1)*we;return ot.slice(H,H+we)},[ot,Q,we]),Je=()=>le(H=>Math.max(H-1,1)),Fe=()=>le(H=>Math.min(H+1,rt)),Ue=H=>{if(H.target.checked){const te=at.map(q=>q.id);me(te)}else me([])},Ne=H=>{me(te=>te.includes(H)?te.filter(q=>q!==H):[...te,H])},ze=async()=>{be.length!==0&&S({title:"Delete Contacts",message:a.jsxs("span",{children:["Are you sure you want to delete"," ",a.jsx("span",{className:"font-semibold",children:be.length})," selected contacts? This action cannot be undone."]}),confirmLabel:`Delete ${be.length} Contact(s)`,cancelLabel:"Cancel",variant:"danger",action:{type:"bulk-delete",contact_ids:be}})},je=f.useCallback(()=>{x(!1),j(!1),A(null),M(ib),N(!1),De(!1)},[]),ve=H=>{H.target.id==="modalBackdrop"&&!y&&!_&&je()},z=H=>{const{name:te,value:q}=H.target;M(Y=>({...Y,[te]:q}))},K=()=>{M(ib),j(!1),A(null),x(!0)};f.useEffect(()=>{const H=new URLSearchParams(t.search||"");(t.state?.openContactModal||H.get("openModal")==="1")&&(M(ib),j(!1),A(null),x(!0),De(!1),e(t.pathname,{replace:!0,state:{}}))},[t.state,t.pathname,t.search,e]);const ue=H=>{H&&(M({first_name:H.first_name||"",last_name:H.last_name||"",account_id:H.account_id?String(H.account_id):"",title:H.title||"",department:H.department||"",email:H.email||"",work_phone:H.work_phone||"",mobile_phone_1:H.mobile_phone_1||"",mobile_phone_2:H.mobile_phone_2||"",notes:H.notes||"",assigned_to:H.assigned_to?String(H.assigned_to):""}),j(!0),A(H.id),x(!0),h(null))},re=H=>{if(!H)return;const te=yl(H)||"this contact";S({title:"Delete Contact",message:a.jsxs("span",{children:["Are you sure you want to permanently delete"," ",a.jsx("span",{className:"font-semibold",children:te}),"? This action cannot be undone."]}),confirmLabel:"Delete Contact",cancelLabel:"Cancel",variant:"danger",action:{type:"delete",targetId:H.id,name:te}})},[Le,De]=f.useState(!1),Qe=H=>{H.preventDefault(),De(!0);const te=E.last_name.trim();if(!te){V.error("Last name is required.");return}if(!E.account_id){V.error("Account is required.");return}if(!E.assigned_to){V.error("Assigned To is required.");return}const Y=E.email?.trim();if(!Y){V.error("Email is required.");return}if(!Y.includes("@")){V.error("Email must contain '@'.");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(Y)){V.error("Please enter a valid email address.");return}const de=E.first_name?.trim()||"",Te={first_name:de,last_name:te,account_id:Number(E.account_id),title:E.title?.trim()||null,department:E.department?.trim()||null,email:E.email?.trim().toLowerCase()||null,work_phone:E.work_phone?.trim()||null,mobile_phone_1:E.mobile_phone_1?.trim()||null,mobile_phone_2:E.mobile_phone_2?.trim()||null,notes:E.notes?.trim()||null,assigned_to:E.assigned_to?Number(E.assigned_to):null},ie=b&&k?"update":"create",Oe=`${de} ${te}`.trim();S({title:ie==="create"?"Confirm New Contact":"Confirm Update",message:ie==="create"?a.jsxs("span",{children:["Are you sure you want to add"," ",a.jsx("span",{className:"font-semibold",children:Oe})," to your contacts?"]}):a.jsxs("span",{children:["Save changes to ",a.jsx("span",{className:"font-semibold",children:Oe}),"?"]}),confirmLabel:ie==="create"?"Create Contact":"Update Contact",cancelLabel:"Cancel",variant:"primary",action:{type:ie,payload:Te,targetId:k||null,name:Oe}})},tt=async()=>{if(!w?.action){S(null);return}const{action:H}=w,{type:te,payload:q,targetId:Y,name:U}=H;T(!0);try{if(te==="create"){N(!0),await ne.post("/contacts/admin",q),V.success(`Contact "${U}" created successfully.`);const de=d?.id||null;je(),await Re(de)}else if(te==="update"){if(!Y)throw new Error("Missing contact identifier for update.");N(!0),await ne.put(`/contacts/admin/${Y}`,q),V.success(`Contact "${U}" updated successfully.`);const de=d?.id&&d.id===Y?Y:d?.id||null;je(),await Re(de),d?.id===Y&&h(null)}else if(te==="delete"){if(!Y)throw new Error("Missing contact identifier for deletion.");const de=d?.id;$(Y),await ne.delete(`/contacts/admin/${Y}`),V.success(`Contact "${U}" deleted successfully.`),await Re(de&&de!==Y?de:null),de===Y&&h(null)}else if(te==="bulk-delete"){const de=H.contact_ids;await ne.delete("/contacts/admin/bulk-delete",{data:{contact_ids:de}}),V.success(`Successfully deleted ${de.length} contacts`),me([]),await Re()}}catch(de){console.error(de);const Te=te==="create"?"Failed to create contact. Please review the details and try again.":te==="update"?"Failed to update contact. Please review the details and try again.":te==="bulk-delete"?"Failed to delete selected contacts.":"Failed to delete contact. Please try again.",ie=de.response?.data?.detail||Te;V.error(ie)}finally{(te==="create"||te==="update")&&N(!1),te==="delete"&&$(null),T(!1),S(null)}},Me=()=>{_||S(null)},et=H=>{h(H),Z("Overview")},yt=()=>h(null),_t=H=>{H.target.id==="contactModalBackdrop"&&!_&&yt()},Ct=w?.action?.type==="delete"?w.action.targetId:null,jt=d&&(G===d.id||Ct===d.id),At=d&&G===d.id,Ge=d?a.jsx("div",{id:"contactModalBackdrop",onClick:_t,className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-6xl max-h-[92vh] overflow-y-auto hide-scrollbar animate-scale-in font-inter relative",onClick:H=>H.stopPropagation(),children:[a.jsxs("div",{className:"bg-tertiary w-full rounded-t-xl relative p-3 lg:p-3",children:[a.jsx("h1",{className:"lg:text-3xl text-xl text-white font-semibold text-center w-full",children:"Contact"}),a.jsx("button",{onClick:yt,className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-white cursor-pointer",children:a.jsx(Za,{size:25})})]}),a.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between lg:flex-row lg:items-center lg:justify-between mt-3 gap-2 px-2 md:items-center lg:gap-4 md:mx-7 lg:mx-7",children:[a.jsx("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:a.jsx("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-800",children:yl(d)||"Unnamed contact"})}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsxs("button",{className:"inline-flex items-center justify-center w-full sm:w-auto bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 disabled:opacity-70 transition text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",onClick:()=>ue(d),disabled:_||w?.action?.type==="update"&&w.action.targetId===d.id,children:[a.jsx(gn,{className:"mr-2"}),"Edit"]}),a.jsx("button",{className:"inline-flex items-center justify-center w-full sm:w-auto px-4 py-2 rounded-md text-sm bg-red-500 text-white hover:bg-red-600 transition focus:outline-none focus:ring-2 focus:ring-red-400",onClick:()=>re(d),disabled:!!jt,children:At?"Deleting...":a.jsxs(a.Fragment,{children:[a.jsx(_a,{className:"mr-2"}),"Delete"]})})]})]}),a.jsx("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-2 px-2 lg:gap-4 md:mx-7 lg:mx-7",children:a.jsx("p",{className:"text-sm text-gray-500",children:d.account?.name||"No associated account"})}),a.jsx("div",{className:"border-b border-gray-200 my-5"}),a.jsxs("div",{className:"p-6 lg:p-4",children:[a.jsx("div",{className:"flex w-full bg-[#6A727D] text-white mt-1 overflow-x-auto mb-6",children:["Overview","Notes","Activities"].map(H=>a.jsx("button",{onClick:()=>Z(H),className:`flex-1 min-w-[90px] px-4 py-2.5 text-xs sm:text-sm font-medium text-center transition-all duration-200 border-b-2
        ${W===H?"bg-paper-white text-[#6A727D] border-white":"text-white hover:bg-[#5c636d]"}`,children:H},H))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 items-start",children:[a.jsxs("div",{className:"lg:col-span-3",children:[W==="Overview"&&a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 md:p-8 border border-gray-200",children:a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4 sm:gap-6 text-sm text-gray-700",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Contact Name:"}),a.jsx("p",{children:yl(d)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Title:"}),a.jsx("p",{children:d.title||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Email:"}),a.jsx("p",{children:d.email?a.jsx("a",{href:`mailto:${d.email}`,className:"text-blue-600 hover:underline break-all",children:d.email}):"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Department:"}),a.jsx("p",{children:d.department||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Work Phone:"}),a.jsx("p",{children:d.work_phone||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Mobile Phone 1:"}),a.jsx("p",{children:d.mobile_phone_1||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Mobile Phone 2:"}),a.jsx("p",{children:d.mobile_phone_2||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Assigned To:"}),a.jsx("p",{children:d.assigned_contact?`${d.assigned_contact.first_name} ${d.assigned_contact.last_name}`:"Unassigned"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created By:"}),a.jsx("p",{children:d.contact_creator?`${d.contact_creator.first_name} ${d.contact_creator.last_name}`:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created At:"}),a.jsx("p",{children:fo(d.created_at)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Last Updated:"}),a.jsx("p",{children:fo(d.updated_at)||"N/A"})]})]})}),W==="Notes"&&a.jsxs("div",{className:"mt-4 w-full",children:[a.jsx("div",{className:"flex flex-wrap items-center justify-between mb-4 gap-2",children:a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words",children:"Contact Note"})}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 shadow-sm break-words",children:[a.jsx("div",{className:"flex items-start justify-between",children:a.jsx("div",{children:a.jsx("p",{className:"text-sm font-medium text-gray-800 break-words",children:"Note"})})}),a.jsx("div",{className:"mt-3 text-sm text-gray-700 whitespace-pre-wrap break-words",children:d.notes||"No notes available."})]}),a.jsx(Tn,{comments:Ie,onAddComment:xe})]}),W==="Activities"&&a.jsxs("div",{className:"space-y-2 w-full h-full max-h-[50dvh] overflow-y-auto bg-gray-50 p-2 hide-scrollbar rounded-lg border border-gray-200 shadow-sm",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words border-b border-gray-300 py-2",children:"Related Activities"}),a.jsxs("div",{className:"space-y-2 text-sm",children:[se.tasks&&se.tasks.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>ge(Ce==="tasks"?null:"tasks"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Qt,{className:"text-blue-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Tasks (",se.tasks.length,")"]})]}),Ce==="tasks"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Ce==="tasks"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:se.tasks.map((H,te)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/admin/tasks",{state:{taskID:H.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-blue-600 mt-1",children:a.jsx(Qt,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:H.subject||H.title||"Task"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:H.description||"No description"}),H.assigned_to&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Assigned: ",H.assigned_to.first_name," ",H.assigned_to.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:fo(H.due_date||H.created_at)})]},`task-${te}`))})]}),se.meetings&&se.meetings.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>ge(Ce==="meetings"?null:"meetings"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Pt,{className:"text-green-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Meetings (",se.meetings.length,")"]})]}),Ce==="meetings"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Ce==="meetings"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:se.meetings.map((H,te)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/admin/meetings",{state:{meetingID:H.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-green-600 mt-1",children:a.jsx(Pt,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:H.subject||H.title||"Meeting"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:H.description||H.location||"No description"}),H.host&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Host: ",H.host.first_name," ",H.host.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:fo(H.start_time||H.created_at)})]},`meeting-${te}`))})]}),se.calls&&se.calls.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>ge(Ce==="calls"?null:"calls"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(It,{className:"text-purple-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Calls (",se.calls.length,")"]})]}),Ce==="calls"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Ce==="calls"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:se.calls.map((H,te)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/admin/calls",{state:{callID:H.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-purple-600 mt-1",children:a.jsx(It,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:H.subject||H.title||"Call"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:H.direction||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:fo(H.call_time||H.created_at)})]},`call-${te}`))})]}),se.deals&&se.deals.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>ge(Ce==="deals"?null:"deals"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(sa,{className:"text-indigo-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Deals (",se.deals.length,")"]})]}),Ce==="deals"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Ce==="deals"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:se.deals.map((H,te)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/admin/deals",{state:{dealID:H.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-indigo-600 mt-1",children:a.jsx(sa,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("h4",{className:"font-medium text-blue-600 break-words text-sm",children:[H.deal_id?H.deal_id.replace(/D(\d+)-\d+-/,"D$1-"):"--"," ",H.name||H.title||"Deal"]}),a.jsx("p",{className:"text-xs text-gray-500 break-words capitalize",children:H.stage||H.description||"No description"})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:fo(H.close_date||H.created_at)})]},`deal-${te}`))})]}),se.quotes&&se.quotes.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>ge(Ce==="quotes"?null:"quotes"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ia,{className:"text-orange-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Quotes (",se.quotes.length,")"]})]}),Ce==="quotes"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Ce==="quotes"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:se.quotes.map((H,te)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/admin/quotes",{state:{quoteID:H.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-orange-600 mt-1",children:a.jsx(ia,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:(H.quote_id?H.quote_id.replace(/Q(\d+)-\d+-/,"Q$1-"):"--")||"Quote"}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:H.status||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:fo(H.presented_date)||""})]},`quote-${te}`))})]}),(!se||(!se.tasks||se.tasks.length===0)&&(!se.meetings||se.meetings.length===0)&&(!se.calls||se.calls.length===0)&&(!se.quotes||se.quotes.length===0)&&(!se.deals||se.deals.length===0)&&(!se.contacts||se.contacts.length===0))&&a.jsx("div",{className:"text-center py-8 text-gray-500",children:a.jsx("p",{children:"No related activities found for this account."})})]})]})]}),a.jsx("div",{className:"flex flex-col gap-4",children:a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Quick Actions"}),a.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[a.jsxs("button",{onClick:()=>e("/admin/calls",{state:{openCallModal:!0,initialCallData:{subject:`Call with ${yl(d)||""}`.trim(),relatedType1:"Account",relatedTo1:d?.account_id?String(d.account_id):d?.account?.id?String(d.account.id):"",relatedType2:"Contact",relatedTo2:d?.id?String(d.id):"",assigned_to:d?.assigned_contact?.id?String(d.assigned_contact.id):"",direction:"Outgoing",status:"Planned"}}}),className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(It,{className:"text-gray-600 w-4 h-4"}),"Schedule Call"]}),a.jsxs("button",{type:"button",onClick:()=>{if(!d?.email){alert("No email address available");return}const H=encodeURIComponent(d.email),te=encodeURIComponent(""),q=encodeURIComponent(""),Y=`mailto:${H}?subject=${te}&body=${q}`;window.location.href=Y},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(sn,{className:"text-gray-600 w-4 h-4"}),"Send E-mail"]}),a.jsxs("button",{className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",onClick:()=>e("/admin/meetings",{state:{openMeetingModal:!0,initialMeetingData:{subject:`Meeting with ${yl(d)||""}`.trim(),relatedType1:"Account",relatedTo1:d?.account_id?String(d.account_id):d?.account?.id?String(d.account.id):"",relatedType2:"Contact",relatedTo2:d?.id?String(d.id):"",assignedTo:d?.assigned_contact?.id?String(d.assigned_contact.id):"",status:"Planned"}}}),children:[a.jsx(Pt,{className:"text-gray-600 w-4 h-4"}),"Book Meeting"]}),a.jsxs("button",{onClick:()=>e("/admin/tasks",{state:{openTaskModal:!0,initialTaskData:{subject:`Task for ${yl(d)||""}`.trim(),relatedType1:"Account",relatedTo1:d?.account_id?String(d.account_id):d?.account?.id?String(d.account.id):"",relatedType2:"Contact",relatedTo2:d?.id?String(d.id):"",assignedTo:d?.assigned_contact?.id?String(d.assigned_contact.id):"",priority:"NORMAL",status:"Not Started"}}}),className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(Qt,{className:"text-gray-600 w-4 h-4"}),"Tasks"]})]})]})})]})]})]})}):null,Be=a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[r&&a.jsx(qt,{message:"Loading contacts..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0 w-full",children:[a.jsxs("h2",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(Xa,{className:"mr-2 text-blue-600"})," Contacts Management"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{onClick:()=>{K(),De(!1)},className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 rounded-md hover:bg-gray-800 text-sm sm:text-base self-end sm:self-auto cursor-pointer",children:[a.jsx(aa,{className:"mr-2"})," Add Contact"]})})]}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search contacts",value:F,onChange:H=>D(H.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsx("div",{className:"w-full lg:w-1/4",children:a.jsx("select",{value:P,onChange:H=>B(H.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:it.map(H=>a.jsx("option",{value:H.value,children:H.label},H.value??H.label))})})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[600px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 text-sm tracking-wide font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 text-center w-12",children:a.jsx("input",{type:"checkbox",className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500 cursor-pointer",checked:at.length>0&&be.length===at.length,onChange:Ue})}),a.jsx("th",{className:"py-3 px-4 truncate",children:"Contact"}),a.jsx("th",{className:"py-3 px-4",children:"Account"}),a.jsx("th",{className:"py-3 px-4 truncate",children:"Contact Info"}),a.jsx("th",{className:"py-3 px-4",children:"Department"}),a.jsx("th",{className:"py-3 px-4",children:"Assigned To"}),a.jsx("th",{className:"py-3 px-4",children:"Created"}),a.jsx("th",{className:"py-3 px-4",children:"Status"}),a.jsx("th",{className:"py-3 px-4 text-center w-24",children:be.length>0?a.jsx("button",{onClick:ze,className:"text-red-600 hover:text-red-800 transition p-1 rounded-full hover:bg-red-50",title:`Delete ${be.length} selected items`,children:a.jsx(_a,{size:18})}):""})]})}),a.jsx("tbody",{children:r?a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:9,children:"Loading contacts..."})}):ot.length>0?at.map(H=>{const te=[{Icon:sn,value:H.email,key:"email"},{Icon:It,value:H.work_phone,key:"work_phone"}].filter(q=>!!q.value);return a.jsxs("tr",{className:"hover:bg-gray-50 text-sm cursor-pointer transition",onClick:q=>{q.target.closest('input[type="checkbox"]')||q.target.closest("button")||(et(H),st(H.id))},children:[a.jsx("td",{className:"py-3 px-4 text-center align-top",children:a.jsx("input",{type:"checkbox",className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500 cursor-pointer",checked:be.includes(H.id),onChange:()=>Ne(H.id)})}),a.jsxs("td",{className:"py-3 px-4 align-top",children:[a.jsx("div",{className:"font-medium text-blue-600 hover:underline break-all text-sm",children:yl(H)||"--"}),a.jsx("div",{className:"text-xs text-gray-500",children:H.title||"No title"})]}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-700",children:[a.jsx(Kx,{className:"text-gray-500 flex-shrink-0"}),a.jsx("span",{className:"break-words",children:H.account?.name||"--"})]})}),a.jsx("td",{className:"py-3 px-4 align-top",children:te.length>0?a.jsx("div",{className:"space-y-1 text-gray-700",children:te.map(({Icon:q,value:Y,key:U})=>{const de=wt.createElement(q,{className:"text-gray-500 flex-shrink-0"});return a.jsxs("div",{className:"flex items-center space-x-2 break-all text-sm",children:[de,a.jsx("span",{children:Y})]},U)})}):a.jsx("span",{className:"text-gray-400 text-sm",children:"--"})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsxs("div",{className:"flex items-center space-x-2 text-gray-700 text-sm",children:[a.jsx(sa,{className:"text-gray-500 flex-shrink-0"}),a.jsx("span",{children:H.department||"--"})]})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[a.jsx(ra,{className:"text-gray-500 flex-shrink-0"}),a.jsx("span",{children:H.assigned_contact?`${H.assigned_contact.first_name} ${H.assigned_contact.last_name}`:"Unassigned"})]})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsxs("div",{className:"flex items-center space-x-2 text-gray-500",children:[a.jsx(Pt,{className:"text-gray-500 flex-shrink-0"}),a.jsx("span",{className:"text-xs",children:fo(H.created_at)||"--"})]})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${H.status==="Inactive"?"bg-red-100 text-red-800":"bg-green-100 text-green-800"}`,children:H.status||"Active"})}),a.jsx("td",{className:"py-3 px-4 align-top"})]},H.id)}):a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:9,children:"No contacts found."})})})]})}),a.jsx(ca,{className:"mt-4",totalItems:ot.length,pageSize:we,currentPage:Q,onPrev:Je,onNext:Fe,onPageSizeChange:H=>{J(H),le(1)},pageSizeOptions:[10,20,30,40,50],label:"contacts"})]}),ce=p?a.jsx("div",{id:"modalBackdrop",onClick:ve,className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-full sm:max-w-3xl rounded-2xl shadow-lg p-4 sm:p-6 md:p-8 relative border border-gray-200 overflow-y-auto max-h-[90vh] hide-scrollbar",onClick:H=>H.stopPropagation(),children:[a.jsx("button",{onClick:()=>{je(),De(!1)},className:"absolute top-4 right-4 text-gray-500 hover:text-black transition disabled:opacity-60",disabled:y||_,children:a.jsx(ea,{size:22})}),a.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800 mb-4 sm:mb-6 flex items-center justify-center",children:b?"Edit Contact":"Add New Contact"}),a.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",onSubmit:Qe,noValidate:!0,children:[a.jsx(zc,{label:"First Name",name:"first_name",value:E.first_name,onChange:z,placeholder:"First name",isSubmitted:Le}),a.jsx(zc,{label:"Last Name",name:"last_name",value:E.last_name,onChange:z,placeholder:"Last name",required:!0,isSubmitted:Le}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:col-span-2",children:[a.jsx(zR,{label:"Account",value:E.account_id,onChange:H=>M(te=>({...te,account_id:H})),items:o||[],getLabel:H=>H?.name??"",placeholder:"Search account...",actions:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{type:"button",onClick:He,disabled:y,title:"Add account",className:"inline-flex items-center justify-center w-4 h-4 rounded-sm border border-gray-300 text-gray-600 hover:bg-gray-50 transition disabled:opacity-60",children:a.jsx(aa,{size:16})}),a.jsx("button",{type:"button",onClick:Ee,disabled:y,title:"Refresh accounts",className:"inline-flex items-center justify-center w-4 h-3 text-gray-600 hover:bg-gray-50 transition disabled:opacity-60",children:a.jsx(Br,{size:16})})]}),required:!0,isSubmitted:Le,disabled:y||o.length===0}),a.jsx(zR,{label:"Assigned To",value:E.assigned_to,onChange:H=>M(te=>({...te,assigned_to:H})),items:c||[],getLabel:H=>`${H?.first_name??""} ${H?.last_name??""} (${H?.role?.toUpperCase()==="CEO"?"Admin":H?.role??""})`.trim(),placeholder:"Search assignee...",required:!0,isSubmitted:Le,disabled:y||c.length===0})]}),a.jsx(zc,{label:"Title",name:"title",value:E.title,onChange:z,placeholder:"Job title",disabled:y}),a.jsx(zc,{label:"Department",name:"department",value:E.department,onChange:z,placeholder:"Department",disabled:y}),a.jsx(zc,{label:"Email",name:"email",type:"email",value:E.email,onChange:z,placeholder:"example@email.com",required:!0,isSubmitted:Le}),a.jsx(zc,{label:"Work Phone",name:"work_phone",value:E.work_phone,onChange:z,placeholder:"09xx xxx xxxx",disabled:y}),a.jsx(zc,{label:"Mobile Phone 1",name:"mobile_phone_1",value:E.mobile_phone_1,onChange:z,placeholder:"09xx xxx xxxx",disabled:y}),a.jsx(zc,{label:"Mobile Phone 2",name:"mobile_phone_2",value:E.mobile_phone_2,onChange:z,placeholder:"09xx xxx xxxx",disabled:y}),a.jsx(ZCe,{label:"Notes",name:"notes",value:E.notes,onChange:z,placeholder:"Additional details...",rows:3,disabled:y,className:"md:col-span-2"}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-2 md:col-span-2 mt-4",children:[a.jsx("button",{type:"button",onClick:()=>{je(),De(!1)},className:"w-full sm:w-auto px-4 py-2 text-white bg-red-400 border border-red-300 rounded hover:bg-red-500 transition disabled:opacity-70",disabled:y||_,children:"Cancel"}),a.jsx("button",{type:"submit",className:"w-full sm:w-auto px-4 py-2 text-white border border-tertiary bg-tertiary rounded hover:bg-secondary transition disabled:opacity-70",disabled:y||_,children:y?"Saving...":b?"Update Contact":"Save Contact"})]})]})]})}):null,fe=w?a.jsx(JCe,{open:!0,title:w.title,message:w.message,confirmLabel:w.confirmLabel,cancelLabel:w.cancelLabel,variant:w.variant,onConfirm:tt,onCancel:Me,loading:_}):null;return a.jsxs(a.Fragment,{children:[Be,Ge,ce,fe]})}function zc({label:e,name:t,value:n,onChange:s,placeholder:r,type:i="text",required:o=!1,disabled:l=!1,isSubmitted:c=!1,className:u=""}){const d=c&&!n?.trim();return a.jsxs("div",{children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",o&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:i,name:t,value:n??"",onChange:s,placeholder:r,required:o,disabled:l,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border focus:ring-2
          ${d?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}
          ${u}
        `})]})}function zR({label:e,items:t=[],value:n="",onChange:s,getLabel:r,placeholder:i="Search...",disabled:o=!1,className:l="",required:c=!1,isSubmitted:u=!1,actions:d=null}){const h=u&&c&&!n;return a.jsxs("div",{className:l,children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",c&&a.jsx("span",{className:"text-red-500",children:"*"})]}),d?a.jsx("div",{className:"flex items-center",children:d}):null]}),a.jsx(XCe,{items:t,value:n??"",onChange:s,getLabel:r,placeholder:i,disabled:o,hasError:h})]})}function XCe({items:e=[],value:t="",onChange:n,getLabel:s,placeholder:r="Search...",disabled:i=!1,maxRender:o=200,hasError:l=!1}){const[c,u]=f.useState(!1),[d,h]=f.useState(""),p=f.useRef(null),x=e.find(y=>String(y.id)===String(t)),b=x?s(x):"",j=f.useMemo(()=>{const y=d.trim().toLowerCase();return(y?e.filter(w=>(s(w)||"").toLowerCase().includes(y)):e).slice(0,o)},[e,d,s,o]);return f.useEffect(()=>{const y=N=>{p.current&&!p.current.contains(N.target)&&u(!1)};return document.addEventListener("mousedown",y),()=>document.removeEventListener("mousedown",y)},[]),f.useEffect(()=>{c||h("")},[c]),a.jsxs("div",{ref:p,className:"relative w-full",children:[a.jsx("input",{disabled:i,value:c?d:b,placeholder:r,onFocus:()=>!i&&u(!0),onChange:y=>{h(y.target.value),c||u(!0)},className:`w-full border rounded-md px-2 py-1.5 text-sm outline-none focus:ring-2
          ${l?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}`}),c&&!i&&a.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg overflow-hidden",children:[a.jsx("div",{className:"max-h-56 overflow-y-auto",children:j.length>0?j.map(y=>{const N=String(y.id),w=s(y),S=String(t)===N;return a.jsx("button",{type:"button",onClick:()=>{n(N),u(!1)},className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-50 ${S?"bg-blue-50":""}`,children:w||"--"},N)}):a.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No results"})}),e.length>o&&a.jsxs("div",{className:"px-3 py-2 text-[11px] text-gray-400 border-t",children:["Showing first ",o," results  keep typing to narrow."]})]})]})}function ZCe({label:e,name:t,value:n,onChange:s,placeholder:r,rows:i=3,disabled:o=!1,className:l=""}){return a.jsxs("div",{className:l,children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsx("textarea",{name:t,value:n??"",onChange:s,placeholder:r,rows:i,disabled:o,className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100 resize-none"})]})}function JCe({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o=!1,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsx("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${u}`,disabled:o,children:o?"Processing...":s})]})]})})}const W2=e=>e?new Date(e).toLocaleString("en-US",{month:"short",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).replace(",",""):"";function yY({lead:e,onBack:t,fetchLeads:n,onEdit:s,onDelete:r,setSelectedLead:i,relatedActs:o}){const l=Et(),{leadID:c}=Wo(),[u,d]=f.useState(e||null),[h,p]=f.useState("Overview"),[x,b]=f.useState(""),j=u?.status?.toUpperCase()==="QUALIFIED",[y,N]=f.useState(null),[w,S]=f.useState({name:"",website:"",countryCode:"",phone_number:"",billing_address:"",shipping_address:"",industry:"",status:"Prospect",territory_id:null,assigned_to:null,created_by:null}),[_,T]=f.useState({last_name:"",first_name:"",account_id:null,title:"",department:"",email:"",work_phone:"",mobile_phone_1:"",mobile_phone_2:"",notes:"",assigned_to:null,created_by:null}),[k,A]=f.useState({name:"Converted from Lead",account_id:null,primary_contact_id:null,stage:"Prospecting",probability:10,amount:0,currency:"PHP",description:"Initial deal from lead conversion.",assigned_to:null,created_by:null}),E=async()=>{try{if(e){d(e),b(e.status||"New");return}if(!c)return;const B=await ne.get(`/leads/get/${c}`);d(B.data),b(B.data.status||"New"),S({name:B.data.company_name||"",website:"",countryCode:"+63",phone_number:"",billing_address:"",shipping_address:"",industry:"",status:"Prospect",territory_id:B.data.territory?.id||null,assigned_to:B.data.assigned_to?.id||null,created_by:B.data.creator?.id||null}),T({last_name:B.data.last_name||"",first_name:B.data.first_name||"",account_id:null,title:B.data.title||"",department:B.data.department||"",email:B.data.email||"",work_phone:B.data.work_phone||"",mobile_phone_1:B.data.mobile_phone_1||"",mobile_phone_2:B.data.mobile_phone_2||"",notes:"",assigned_to:B.data.assigned_to?.id||null,created_by:B.data.creator?.id||null}),A({name:"Converted from Lead",account_id:null,primary_contact_id:null,stage:"Prospecting",probability:10,amount:0,currency:"PHP",description:"Initial deal from lead conversion.",assigned_to:B.data.assigned_to?.id||null,created_by:B.data.creator?.id||null})}catch(B){console.error(B)}};f.useEffect(()=>{e?(d(e),b(e.status||"New")):c&&E()},[c,e]);const M=async()=>{try{if(x==="Converted"&&u?.status?.toUpperCase()!=="QUALIFIED"){V.error("Lead must be Qualified before it can be converted.");return}const B=await ne.put(`/leads/${u.id}/update/status`,{status:x});V.success("Lead status updated successfully");const G={...u,status:B.data.status};d(G),i&&i(G),n&&n(),t&&t()}catch(B){console.error(B),V.error("Failed to update lead status")}},F=async B=>{const G={...w,assigned_to:B.assigned_to?.id,billing_address:B.address,shipping_address:B.address,created_by:B.creator?.id,industry:null,name:B.company_name,phone_number:B.work_phone,status:"Prospect",territory_id:B.territory?.id,website:""};console.log("Account data: ",G),console.log("Contact data: ",_),console.log("Deal data: ",k),console.log("Lead data: ",B);try{const W=(await ne.post("/accounts/convertedLead",G)).data.id,Z={..._,account_id:W,assigned_to:B.assigned_to?.id,created_by:B.creator?.id,department:B.department,email:B.email,first_name:B.first_name,last_name:B.last_name,mobile_phone_1:B.mobile_phone_1,mobile_phone_2:B.mobile_phone_2,notes:B.notes,title:B.title,work_phone:B.work_phone},le=(await ne.post("/contacts/convertedLead",Z)).data.id,we=()=>{switch(k.stage){case"PROSPECTING":return 10;case"QUALIFICATION":return 25;case"PROPOSAL":return 60;case"NEGOTIATION":return 80;case"CLOSED_WON":return 100;case"CLOSED_LOST":return 0;default:return 0}},J=k.amount&&k.amount!==""?parseFloat(k.amount):0,se={...k,account_id:W,assigned_to:B.assigned_to?.id,created_by:B.creator?.id,primary_contact_id:le,probability:we(),stage:"Prospecting"},ye=await ne.post("/deals/convertedLead",se),Ce=await ne.put(`/leads/convert/${B.id}`);i&&i(null),n(),V.success("Lead converted successfully!"),t()}catch($){console.error("Error during conversion:",$);const W=$.response?.data?.detail||$.message||"Failed to convert lead. Please try again.";V.error(W)}},D=B=>{switch((B||"").toUpperCase()){case"NEW":return"bg-indigo-100 text-indigo-700";case"CONTACTED":return"bg-blue-100 text-blue-700";case"QUALIFIED":return"bg-green-100 text-green-700";case"CONVERTED":return"bg-emerald-100 text-emerald-700";case"LOST":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-700"}},P=B=>B.toString().toLowerCase().replace(/\b\w/g,G=>G.toUpperCase());return u?a.jsx(a.Fragment,{children:a.jsx("div",{className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-lg w-full max-w-full sm:max-w-6xl max-h-[90vh] overflow-y-auto hide-scrollbar relative box-border",children:[a.jsx("div",{className:"bg-tertiary w-full rounded-t-xl p-3 lg:p-3",children:a.jsxs("div",{className:"flex items-start justify-between w-full",children:[a.jsx("h1",{className:"lg:text-3xl text-xl text-white font-semibold text-center w-full",children:"Lead"}),a.jsx("button",{onClick:()=>{t?t():l(-1)},className:"text-gray-400 hover:text-white mt-1 cursor-pointer",children:a.jsx(Za,{size:25})})]})}),a.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between lg:flex-row lg:items-center lg:justify-between mt-3 gap-2 px-2 md:items-center lg:gap-4 md:mx-7 lg:mx-7",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[a.jsxs("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-800",children:[u.first_name," ",u.last_name]}),a.jsx("span",{className:`text-xs sm:text-sm font-medium px-2 sm:px-3 py-1 rounded-full whitespace-nowrap ${D(u.status)}`,children:P(u.status||"New")}),a.jsx("div",{className:"flex flex-col",children:a.jsx("button",{onClick:()=>F(u),disabled:!j,title:j?"Convert Lead":"Lead must be Qualified before converting",className:`px-3 sm:px-4 py-1.5 sm:py-2 rounded-md font-medium text-xs sm:text-sm transition focus:outline-none focus:ring-2
      ${j?"bg-green-600 hover:bg-green-700 text-white focus:ring-green-400":"bg-gray-200 text-gray-400 cursor-not-allowed"}
    `,children:"Convert"})})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsxs("button",{type:"button",onClick:()=>{s&&u&&s(u)},className:"inline-flex items-center justify-center w-full sm:w-auto bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 transition text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",children:[a.jsx(hn,{className:"mr-2"}),"Edit"]}),a.jsxs("button",{type:"button",onClick:()=>{r&&u&&r(u)},className:"inline-flex items-center justify-center w-full sm:w-auto px-4 py-2 rounded-md text-sm bg-red-500 text-white hover:bg-red-600 transition focus:outline-none focus:ring-2 focus:ring-red-400",children:[a.jsx(_a,{className:"mr-2"}),"Delete"]})]})]}),a.jsx("div",{className:"border-b border-gray-200 my-5"}),a.jsxs("div",{className:"p-4 lg:p-4",children:[a.jsx("div",{className:"flex w-full bg-[#6A727D] text-white mt-1 overflow-x-auto mb-6",children:["Overview","Notes","Activities"].map(B=>a.jsx("button",{onClick:()=>p(B),className:`flex-1 min-w-[90px] px-4 py-2.5 text-xs sm:text-sm font-medium text-center transition-all duration-200 border-b-2
        ${h===B?"bg-paper-white text-[#6A727D] border-white":"text-white hover:bg-[#5c636d]"}`,children:B},B))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 items-start",children:[a.jsxs("div",{className:"lg:col-span-3",children:[h==="Overview"&&a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 md:p-8 border border-gray-200",children:a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4 sm:gap-6 text-sm text-gray-700",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Name:"}),a.jsxs("p",{children:[u.first_name," ",u.last_name||"N/A"]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Company:"}),a.jsx("p",{children:u.company_name||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Job Title:"}),a.jsx("p",{children:u.title||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Department:"}),a.jsx("p",{children:u.department||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Email:"}),a.jsx("p",{children:u.email||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Territory:"}),a.jsx("p",{children:u.territory?.name||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Assigned To:"}),a.jsx("p",{children:u.assigned_to?`${u.assigned_to.first_name} ${u.assigned_to.last_name}`:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created By:"}),a.jsx("p",{children:u.creator?`${u.creator.first_name} ${u.creator.last_name}`:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Work Phone:"}),a.jsx("p",{children:u.work_phone||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Mobile Phone 1:"}),a.jsx("p",{children:u.mobile_phone_1||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Mobile Phone 2:"}),a.jsx("p",{children:u.mobile_phone_2||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Source:"}),a.jsx("p",{children:u.source||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Address:"}),a.jsx("p",{children:u.address||"N/A"})]})]})}),h==="Notes"&&a.jsxs("div",{className:"mt-4 w-full",children:[a.jsx("div",{className:"flex flex-wrap items-center justify-between mb-4 gap-2",children:a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words",children:"Lead Note"})}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 shadow-sm break-words",children:[a.jsx("div",{className:"flex items-start justify-between",children:a.jsx("div",{children:a.jsx("p",{className:"text-sm font-medium text-gray-800 break-words",children:"Note"})})}),a.jsx("div",{className:"mt-3 text-sm text-gray-700 whitespace-pre-wrap break-words",children:u.notes||"No notes available."})]})]}),h==="Activities"&&a.jsxs("div",{className:"space-y-2 w-full h-full max-h-[50dvh] overflow-y-auto bg-gray-50 p-2 hide-scrollbar rounded-lg border border-gray-200 shadow-sm",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words border-b border-gray-300 py-2",children:"Related Activities"}),a.jsxs("div",{className:"space-y-2 text-sm",children:[o.tasks&&o.tasks.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>N(y==="tasks"?null:"tasks"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Qt,{className:"text-blue-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Tasks (",o.tasks.length,")"]})]}),y==="tasks"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),y==="tasks"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:o.tasks.map((B,G)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>l("/admin/tasks",{state:{taskID:B.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-blue-600 mt-1",children:a.jsx(Qt,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:B.subject||B.title||"Task"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:B.description||"No description"}),B.assigned_to&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Assigned:"," ",B.assigned_to.first_name," ",B.assigned_to.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:W2(B.due_date||B.created_at)})]},`task-${G}`))})]}),o.meetings&&o.meetings.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>N(y==="meetings"?null:"meetings"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Pt,{className:"text-green-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Meetings (",o.meetings.length,")"]})]}),y==="meetings"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),y==="meetings"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:o.meetings.map((B,G)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>l("/admin/meetings",{state:{meetingID:B.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-green-600 mt-1",children:a.jsx(Pt,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:B.subject||B.title||"Meeting"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:B.description||B.location||"No description"}),B.host&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Host: ",B.host.first_name," ",B.host.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:W2(B.start_time||B.created_at)})]},`meeting-${G}`))})]}),o.calls&&o.calls.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>N(y==="calls"?null:"calls"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(It,{className:"text-purple-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Calls (",o.calls.length,")"]})]}),y==="calls"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),y==="calls"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:o.calls.map((B,G)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>l("/admin/calls",{state:{callID:B.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-purple-600 mt-1",children:a.jsx(It,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:B.subject||B.title||"Call"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:B.direction||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:W2(B.call_time||B.created_at)})]},`call-${G}`))})]}),(!o||(!o.tasks||o.tasks.length===0)&&(!o.meetings||o.meetings.length===0)&&(!o.calls||o.calls.length===0)&&(!o.quotes||o.quotes.length===0)&&(!o.deals||o.deals.length===0)&&(!o.contacts||o.contacts.length===0))&&a.jsx("div",{className:"text-center py-8 text-gray-500",children:a.jsx("p",{children:"No related activities found for this account."})})]})]})]}),a.jsxs("div",{className:"flex flex-col gap-4",children:[a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Quick Actions"}),a.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[a.jsxs("button",{onClick:()=>{u&&l("/admin/calls",{state:{openCallModal:!0,initialCallData:{subject:u.title?`Call regarding ${u.title}`:`Call with ${u.first_name} ${u.last_name}`,relatedType1:"Lead",relatedTo1:String(u.id),relatedType2:null,relatedTo2:null,assigned_to:u.assigned_to?.id?String(u.assigned_to.id):"",direction:"Outgoing",status:"Planned"}}})},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(It,{className:"text-gray-600 w-4 h-4"}),"Schedule Call"]}),a.jsxs("button",{type:"button",onClick:()=>{if(!u?.email){alert("No email address available");return}const B=encodeURIComponent(u.email),G=encodeURIComponent(""),$=encodeURIComponent(""),W=`mailto:${B}?subject=${G}&body=${$}`;window.location.href=W},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(sn,{className:"text-gray-600 w-4 h-4"}),"Send E-mail"]}),a.jsxs("button",{className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",onClick:()=>{u&&l("/admin/meetings",{state:{openMeetingModal:!0,initialMeetingData:{subject:u.title?`Meeting regarding ${u.title}`:`Meeting with ${u.first_name||""} ${u.last_name||""}`.trim(),relatedType1:"Lead",relatedTo1:String(u.id),relatedType2:null,relatedTo2:null,assignedTo:u.assigned_to?.id?String(u.assigned_to.id):"",status:"Planned"}}})},children:[a.jsx(Pt,{className:"text-gray-600 w-4 h-4"}),"Book Meeting"]}),a.jsxs("button",{onClick:()=>{u&&l("/admin/tasks",{state:{openTaskModal:!0,initialTaskData:{subject:u.title?`Follow up on ${u.title}`:`Follow up with ${u.first_name||""} ${u.last_name||""}`.trim(),relatedType1:"Lead",relatedTo1:String(u.id),relatedType2:null,relatedTo2:null,assignedTo:u.assigned_to?.id?String(u.assigned_to.id):"",priority:"NORMAL",status:"Not Started"}}})},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(Qt,{className:"text-gray-600 w-4 h-4"}),"Tasks"]})]})]}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm w-full",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Status"}),a.jsxs("select",{className:"border border-gray-200 rounded-md px-2 sm:px-3 py-1.5 w-full text-sm mb-2 focus:ring-2 focus:ring-indigo-500 outline-none",value:x,onChange:B=>b(B.target.value),children:[a.jsx("option",{value:"New",children:"New"}),a.jsx("option",{value:"Contacted",children:"Contacted"}),a.jsx("option",{value:"Qualified",children:"Qualified"}),u?.status?.toUpperCase()==="QUALIFIED"&&a.jsx("option",{value:"Converted",children:"Converted"}),a.jsx("option",{value:"Lost",children:"Lost"})]}),a.jsx("button",{onClick:M,disabled:x===u.status,className:`w-full py-1.5 rounded-md text-sm transition focus:outline-none focus:ring-2 ${x===u.status?"bg-gray-400 cursor-not-allowed text-white":"bg-gray-900 text-white hover:bg-gray-800 focus:ring-gray-400"}`,children:"Update"})]})]})]})]})]})})}):null}const eSe=oh.all(),V2=eSe.map((e,t)=>({code:`+${e.countryCallingCode}`,name:e.countryCode,id:`${e.countryCallingCode}-${e.countryCode}-${t}`})),tSe=e=>e.toString().toLowerCase().replace(/\b\w/g,t=>t.toUpperCase()),aSe=e=>{switch(e.toUpperCase()){case"NEW":return"bg-indigo-100 text-indigo-700";case"CONTACTED":return"bg-blue-100 text-blue-700";case"QUALIFIED":return"bg-green-100 text-green-700";case"CONVERTED":return"bg-emerald-100 text-emerald-700";case"LOST":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-700"}},Y2={first_name:"",last_name:"",company_name:"",title:"",department:"",email:"",work_ccode:"+63",work_phone:"",m1_ccode:"+63",mobile_phone_1:"",m2_ccode:"+63",mobile_phone_2:"",address:"",notes:"",source:"",territory_id:null,lead_owner:null,status:"New"};function nSe(){const e=Et(),{leadID:t}=Wo();Bs();const[n,s]=f.useState(null),[r,i]=f.useState(!1),[o,l]=f.useState(null),[c,u]=f.useState(null),[d,h]=f.useState([]),[p,x]=f.useState(!1),[b,j]=f.useState(""),[y,N]=f.useState("Filter by Status"),[w,S]=f.useState(""),[_,T]=f.useState(1),[k,A]=f.useState(10),[E,M]=f.useState(Y2),[F,D]=f.useState(!1),[P,B]=f.useState(null),[G,$]=f.useState(!1),[W,Z]=f.useState(null),[Q,le]=f.useState(!1),[we,J]=f.useState([]),[se,ye]=f.useState({});f.useRef(null);const[Ce,ge]=f.useState(!1),[be,me]=f.useState(null),[Ae,pe]=f.useState({name:"",website:"",countryCode:"+63",phone_number:"",combinedPhoneNumbers:"",billing_address:"",shipping_address:"",industry:"",status:"Prospect",territory_id:null,assigned_to:null,created_by:null}),[Ie,xe]=f.useState({last_name:"",first_name:"",account_id:null,title:"",department:"",email:"",work_phone:"",mobile_phone_1:"",mobile_phone_2:"",notes:"",assigned_to:null,created_by:null}),[he,Re]=f.useState({name:"Converted from Lead",account_id:null,primary_contact_id:null,stage:"PROSPECTING",probability:10,amount:0,currency:"PHP",description:"Initial deal from lead conversion.",assigned_to:null,created_by:null});f.useEffect(()=>{document.title="Leads | Sari-Sari CRM"},[]);const Ee=async()=>{try{const ce=await ne.get("/leads/getUsers");l(ce.data)}catch(ce){console.error(`Error fetching users: ${ce}`)}},He=async()=>{x(!0);try{const ce=await ne.get("/leads/admin/getLeads");h(ce.data),console.log(ce.data)}catch(ce){console.error(`Error fetching leads: ${ce}`)}finally{x(!1)}};f.useEffect(()=>{Ee(),He()},[]),f.useEffect(()=>{if(t&&d.length>0&&!r&&!F){const ce=d.find(fe=>fe.id===Number(t));ce&&s(ce)}else!t&&!n&&s(null)},[t,d,r,F]),f.useEffect(()=>{if(be){const fe=(q=>{if(!q)return{code:"+63",number:""};const Y=q.match(/^(\+\d+)\s(.+)$/);if(Y)return{code:Y[1],number:Y[2]};if(q.startsWith("+")){const U=q.match(/^(\+\d{1,3})/);if(U)return{code:U[1],number:q.substring(U[1].length).trim()}}return{code:"+63",number:q}})(be.work_phone),H=[];be.work_phone&&H.push(`Work: ${be.work_phone}`),be.mobile_phone_1&&H.push(`Mobile 1: ${be.mobile_phone_1}`),be.mobile_phone_2&&H.push(`Mobile 2: ${be.mobile_phone_2}`);const te=H.length>0?H.join(" | "):"";pe({name:be.company_name||"",website:"",countryCode:fe.code,phone_number:fe.number,combinedPhoneNumbers:te,billing_address:be.address||"",shipping_address:be.address||"",industry:"",status:"Prospect",territory_id:be.assigned_to?.territory?.id||null,assigned_to:be.assigned_to?.id||null,created_by:be.creator?.id||null}),xe({last_name:be.last_name||"",first_name:be.first_name||"",account_id:null,title:be.title||"",department:be.department||"",email:be.email||"",work_phone:be.work_phone||"",mobile_phone_1:be.mobile_phone_1||"",mobile_phone_2:be.mobile_phone_2||"",notes:be.notes||"",assigned_to:be.assigned_to?.id||null,created_by:be.creator?.id||null}),Re({name:"Converted from Lead",account_id:null,primary_contact_id:null,stage:"PROSPECTING",probability:10,amount:0,currency:"PHP",description:"Initial deal from lead conversion.",assigned_to:be.assigned_to?.id||null,created_by:be.creator?.id||null})}},[be]);const Ke=ce=>j(ce.target.value),st=f.useMemo(()=>{let ce=[...d];const fe=b.trim().toLowerCase();fe&&(ce=ce.filter(te=>[te?.first_name,te?.last_name,te?.company_name,te?.title,te?.email,te?.work_phone,te?.assigned_to?`${te.assigned_to.first_name} ${te.assigned_to.last_name}`:""].some(Y=>Y&&Y.toString().toLowerCase().includes(fe))));const H=y.trim().toUpperCase();return H&&H!=="FILTER BY STATUS"?ce=ce.filter(te=>(te.status?te.status.toUpperCase():"")===H):ce=ce.filter(te=>(te.status?te.status.toUpperCase():"")!=="CONVERTED"),w?ce.sort((te,q)=>{const Y=`${te.first_name} ${te.last_name}`,U=`${q.first_name} ${q.last_name}`;return w==="asc"?Y.localeCompare(U):U.localeCompare(Y)}):ce.sort((te,q)=>{const Y=new Date(te.created_at).getTime();return new Date(q.created_at).getTime()-Y}),ce},[d,b,y,w]),it=Math.max(1,Math.ceil(st.length/k)||1);f.useEffect(()=>{T(1)},[b,y]),f.useEffect(()=>{T(ce=>{const fe=Math.max(1,Math.ceil(st.length/k)||1);return ce>fe?fe:ce})},[st.length,k]);const ot=f.useMemo(()=>{const ce=(_-1)*k;return st.slice(ce,ce+k)},[st,_,k]),rt=()=>T(ce=>Math.max(ce-1,1)),at=()=>T(ce=>Math.min(ce+1,it)),Je=ce=>{A(ce),T(1)},Fe=f.useCallback(async ce=>{try{const fe=await ne.get(`/activities/lead/${ce}`);ye(fe.data&&typeof fe.data=="object"?fe.data:{})}catch(fe){console.error(fe),fe.response?.status===404&&(console.warn("No activities found for this account."),ye({}))}},[]),Ue=ce=>{s(ce),Fe(ce.id)},Ne=()=>{s(null),t&&e("/admin/leads",{replace:!0})},ze=()=>{i(!1),M(Y2),D(!1),B(null),$(!1),u(null),sessionStorage.removeItem("editLeadData")},je=ce=>{ce.target.id==="modalBackdrop"&&ze()},ve=()=>{M(Y2),D(!1),B(null),u(null),i(!0)},z=ce=>{if(!ce){console.error("handleEditClick: lead is null or undefined");return}console.log("handleEditClick called with lead:",ce),console.log("Current state - leadID:",t,"selectedLead:",n,"showModal:",r);const fe=U=>{if(!U)return{code:"+63",number:""};const de=U.match(/^(\+\d+)\s(.+)$/);return de?{code:de[1],number:de[2]}:{code:"+63",number:U}},H=fe(ce.work_phone),te=fe(ce.mobile_phone_1),q=fe(ce.mobile_phone_2);let Y="";if(ce.assigned_to){Y=String(ce.assigned_to.id);const U=o?.find(de=>de.id===ce.assigned_to.id);u(U)}M({first_name:ce.first_name||"",last_name:ce.last_name||"",company_name:ce.company_name||"",title:ce.title||"",department:ce.department||"",email:ce.email||"",work_ccode:H.code,work_phone:H.number,m1_ccode:te.code,mobile_phone_1:te.number,m2_ccode:q.code,mobile_phone_2:q.number,address:ce.address||"",notes:ce.notes||"",source:ce.source||"",territory_id:ce.territory?.id||null,lead_owner:Y,status:ce.status||"New"}),D(!0),B(ce.id),n?(console.log("Coming from detail view - closing detail modal and showing edit form"),s(null),i(!0)):(console.log("Already in list view - showing modal"),i(!0))},K=ce=>{if(!ce){console.error("handleDelete: lead is null or undefined");return}console.log("handleDelete called with lead:",ce);const fe=`${ce.first_name} ${ce.last_name}`||"this lead";Z({title:"Delete Lead",message:a.jsxs("span",{children:["Are you sure you want to permanently delete"," ",a.jsx("span",{className:"font-semibold",children:fe}),"? This action cannot be undone."]}),confirmLabel:"Delete Lead",cancelLabel:"Cancel",variant:"danger",action:{type:"delete",targetId:ce.id,name:fe}})},ue=ce=>{const{name:fe,value:H}=ce.target;if(M(te=>({...te,[fe]:H})),fe==="lead_owner"){const te=o.find(q=>q.id===parseInt(H));u(te)}},[re,Le]=f.useState(!1),De=ce=>{if(ce.preventDefault(),Le(!0),!E.last_name?.trim()){V.error("Last name is required.");return}if(!E.email?.trim()){V.error("Email is required.");return}if(!E.email.includes("@")){V.error("Email must contain '@'.");return}if(!E.lead_owner){V.error("Please assign a lead owner.");return}const fe={...E,territory_id:E.territory_id?parseInt(E.territory_id):null,lead_owner:parseInt(E.lead_owner),work_phone:`${E.work_ccode} ${E.work_phone}`,mobile_phone_1:`${E.m1_ccode} ${E.mobile_phone_1}`,mobile_phone_2:`${E.m2_ccode} ${E.mobile_phone_2}`},H=F&&P?"update":"create",te=`${E.first_name} ${E.last_name}`;Z({title:H==="create"?"Confirm New Lead":"Confirm Update",message:H==="create"?a.jsxs("span",{children:["Are you sure you want to create a new lead for"," ",a.jsx("span",{className:"font-semibold",children:te}),"?"]}):a.jsxs("span",{children:["Save changes to ",a.jsx("span",{className:"font-semibold",children:te}),"?"]}),confirmLabel:H==="create"?"Create Lead":"Update Lead",cancelLabel:"Cancel",variant:"primary",action:{type:H,payload:fe,targetId:P||null,name:te}})},Qe=ce=>{if(ce.target.checked){const fe=ot.map(H=>H.id);J(fe)}else J([])},tt=ce=>{J(fe=>fe.includes(ce)?fe.filter(H=>H!==ce):[...fe,ce])},Me=async()=>{we.length!==0&&Z({title:"Delete Leads",message:a.jsxs("span",{children:["Are you sure you want to delete"," ",a.jsx("span",{className:"font-semibold",children:we.length})," selected leads? This action cannot be undone."]}),confirmLabel:`Delete ${we.length} Lead(s)`,cancelLabel:"Cancel",variant:"danger",action:{type:"bulk-delete",leadIds:we}})},et=async()=>{if(!W?.action){Z(null);return}const{action:ce}=W,{type:fe,payload:H,targetId:te,name:q,lead:Y,leadIds:U}=ce;console.log(H),le(!0);try{if(fe==="create")$(!0),await ne.post("/leads/create",H),V.success(`Lead "${q}" created successfully.`),ze(),await He();else if(fe==="update"){if(!te)throw new Error("Missing lead identifier for update.");$(!0);const de=await ne.put(`/leads/${te}`,H);V.success(`Lead "${q}" updated successfully.`),n&&n.id===te&&s(null),ze(),await He()}else if(fe==="delete"){if(!te)throw new Error("Missing lead identifier for deletion.");await ne.delete(`/leads/${te}`),V.success(`Lead "${q}" deleted successfully.`),n?.id===te&&s(null),await He()}else fe==="bulk-delete"&&(await ne.delete("/leads/admin/bulk-delete",{data:{lead_ids:U}}),V.success(`Successfully deleted ${U.length} leads`),J([]),await He())}catch(de){console.error(de);const Te=fe==="create"?"Failed to create lead. Please review the details and try again.":fe==="update"?"Failed to update lead. Please review the details and try again.":"Failed to delete lead. Please try again.",ie=de.response?.data?.detail||Te;V.error(ie)}finally{(fe==="create"||fe==="update")&&$(!1),fe!=="edit"&&(le(!1),Z(null))}},yt=()=>{Q||Z(null)},_t=d.filter(ce=>ce.status==="New").length,Ct=d.filter(ce=>ce.status==="Contacted").length,jt=d.filter(ce=>ce.status==="Qualified").length,At=d.filter(ce=>ce.status==="Converted").length,Ge=d.filter(ce=>ce.status==="Lost").length,Be=[{title:"New",value:_t,icon:rn,color:"text-indigo-600",bgColor:"bg-indigo-100"},{title:"Contacted",value:Ct,icon:It,color:"text-blue-600",bgColor:"bg-blue-100"},{title:"Qualified",value:jt,icon:La,color:"text-green-600",bgColor:"bg-green-100"},{title:"Converted",value:At,icon:ec,color:"text-emerald-600",bgColor:"bg-emerald-100"},{title:"Lost",value:Ge,icon:Yn,color:"text-red-600",bgColor:"bg-red-100"}];return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[p&&a.jsx(qt,{message:"Loading leads..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h1",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(rn,{className:"mr-2 text-blue-600"}),"Leads"]}),a.jsxs("div",{className:"flex justify-center lg:justify-end gap-3 w-full sm:w-auto",children:[a.jsxs("button",{onClick:()=>{V.info("Download functionality coming soon")},className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 rounded-md hover:bg-gray-800 text-sm sm:text-base self-end sm:self-auto cursor-pointer",children:[a.jsx(Vo,{className:"mr-2"})," Download"]}),a.jsxs("button",{onClick:()=>{ve(),Le(!1)},className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 rounded-md hover:bg-gray-800 text-sm sm:text-base self-end sm:self-auto cursor-pointer",children:[a.jsx(aa,{className:"mr-2"})," Add Lead"]})]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 xl:grid-cols-5 gap-4 mb-6 w-full break-words overflow-hidden lg:overflow-visible",children:Be.map(ce=>a.jsx(rSe,{...ce},ce.title))}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search leads",value:b,onChange:Ke,className:"focus:outline-none text-base w-full"})]}),a.jsx("div",{className:"w-full lg:w-1/4",children:a.jsxs("select",{value:y,onChange:ce=>N(ce.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{value:"Filter by Status",children:"Filter by Status"}),a.jsx("option",{value:"New",children:"New"}),a.jsx("option",{value:"Contacted",children:"Contacted"}),a.jsx("option",{value:"Qualified",children:"Qualified"}),a.jsx("option",{value:"Converted",children:"Converted"}),a.jsx("option",{value:"Lost",children:"Lost"})]})}),a.jsx("div",{className:"w-full lg:w-1/4",children:a.jsxs("select",{value:w,onChange:ce=>S(ce.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{value:"",children:"Sort by Name"}),a.jsx("option",{value:"asc",children:"A-Z"}),a.jsx("option",{value:"desc",children:"Z-A"})]})})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[500px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 text-sm tracking-wide font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 w-10",children:a.jsx("input",{type:"checkbox",className:"w-4 h-4 accent-blue-600",checked:ot.length>0&&ot.every(ce=>we.includes(ce.id)),onChange:Qe})}),a.jsx("th",{className:"py-3 px-4",children:"Name"}),a.jsx("th",{className:"py-3 px-4",children:"Company"}),a.jsx("th",{className:"py-3 px-4",children:"Job Title"}),a.jsx("th",{className:"py-3 px-4",children:"Email"}),a.jsx("th",{className:"py-3 px-4",children:"Assigned To"}),a.jsx("th",{className:"py-3 px-4",children:"Status"}),a.jsx("th",{className:"py-3 px-4 text-center w-24",children:we.length>0?a.jsx("button",{onClick:Me,className:"text-red-600 hover:text-red-800 transition p-1 rounded-full hover:bg-red-50",title:`Delete ${we.length} selected leads`,children:a.jsx(_a,{size:18})}):""})]})}),a.jsx("tbody",{children:st.length>0?ot.map(ce=>a.jsxs("tr",{className:"hover:bg-gray-50 text-sm cursor-pointer",children:[a.jsx("td",{className:"py-3 px-4",onClick:fe=>fe.stopPropagation(),children:a.jsx("input",{type:"checkbox",className:"w-4 h-4 accent-blue-600",checked:we.includes(ce.id),onChange:()=>tt(ce.id)})}),a.jsx("td",{className:"py-3 px-4",onClick:()=>Ue(ce),children:a.jsxs("div",{className:"font-medium text-blue-600 hover:underline break-all text-sm",children:[ce.first_name," ",ce.last_name]})}),a.jsx("td",{className:"py-3 px-4",onClick:()=>Ue(ce),children:a.jsx("div",{className:"font-medium text-gray-800 text-sm leading-tight",children:ce.company_name||"--"})}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",onClick:()=>Ue(ce),children:ce.title||"--"}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",onClick:()=>Ue(ce),children:ce.email||"--"}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",onClick:()=>Ue(ce),children:ce.assigned_to?`${ce.assigned_to.first_name} ${ce.assigned_to.last_name}`:"--"}),a.jsx("td",{className:"py-3 px-4",onClick:()=>Ue(ce),children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium whitespace-nowrap ${aSe(ce.status||"New")}`,children:tSe(ce.status||"New")})}),a.jsx("td",{})]},ce.id)):a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:8,children:"No leads found."})})})]})}),a.jsx(ca,{className:"mt-4",totalItems:st.length,pageSize:k,currentPage:_,onPrev:rt,onNext:at,onPageSizeChange:Je,label:"leads"}),r&&a.jsx("div",{id:"modalBackdrop",onClick:je,className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-full sm:max-w-3xl rounded-2xl shadow-lg p-4 sm:p-6 md:p-8 relative border border-gray-200 overflow-y-auto max-h-[90vh] hide-scrollbar",onClick:ce=>ce.stopPropagation(),children:[a.jsx("button",{onClick:()=>{ze(),Le(!1)},className:"absolute top-4 right-4 text-gray-500 hover:text-black transition",children:a.jsx(ea,{size:22})}),a.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800 mb-4 sm:mb-6 flex items-center justify-center",children:F?"Edit Lead":"Add New Lead"}),a.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 text-sm",children:[a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"First Name"}),a.jsx("input",{type:"text",name:"first_name",value:E.first_name,onChange:ue,placeholder:"Joe",className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:["Last Name ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",name:"last_name",placeholder:"Smith",value:E.last_name,onChange:ue,required:!0,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border
              ${re&&!E.last_name?.trim()?"border-red-400 focus:ring-red-400":"border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"}
          focus:ring-2`})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Company"}),a.jsx("input",{type:"text",placeholder:"ABC Company",name:"company_name",value:E.company_name,onChange:ue,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Job Title"}),a.jsx("input",{type:"text",placeholder:"ABC Agenda",name:"title",value:E.title,onChange:ue,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Department"}),a.jsx("input",{type:"text",placeholder:"Sales",name:"department",value:E.department,onChange:ue,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:["Email",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"email",placeholder:"abc@gmail.com",name:"email",value:E.email,onChange:ue,required:!0,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border
                       ${re&&!E.email?.trim()?"border-red-400 focus:ring-red-400":"border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"}
                      focus:ring-2`})]}),a.jsxs("div",{className:"flex flex-col col-span-1 md:col-span-2 lg:col-span-1",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Work Phone"}),a.jsxs("div",{className:"w-full border border-gray-300 rounded-md focus-within:ring-2 focus-within:ring-blue-400 outline-none flex flex-row gap-1",children:[a.jsx("select",{name:"work_ccode",value:E.work_ccode,onChange:ue,className:"outline-none cursor-pointer py-1.5 px-2 border-r border-gray-400 text-sm",children:V2.map(ce=>a.jsx("option",{value:ce.code,children:ce.code},ce.id))}),a.jsx("input",{type:"text",placeholder:"9----------",name:"work_phone",value:E.work_phone,onChange:ue,className:"w-full outline-none px-2 py-1.5 text-sm"})]})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Mobile Phone 1"}),a.jsxs("div",{className:"w-full border border-gray-300 rounded-md focus-within:ring-2 focus-within:ring-blue-400 outline-none flex flex-row gap-1",children:[a.jsx("select",{name:"m1_ccode",value:E.m1_ccode,onChange:ue,className:"outline-none cursor-pointer py-1.5 px-2 border-r border-gray-400 text-sm",children:V2.map(ce=>a.jsx("option",{value:ce.code,children:ce.code},ce.id))}),a.jsx("input",{type:"text",placeholder:"9----------",name:"mobile_phone_1",value:E.mobile_phone_1,onChange:ue,className:"w-full outline-none px-2 py-1.5 text-sm"})]})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Mobile Phone 2"}),a.jsxs("div",{className:"w-full border border-gray-300 rounded-md focus-within:ring-2 focus-within:ring-blue-400 outline-none flex flex-row gap-1",children:[a.jsx("select",{name:"m2_ccode",value:E.m2_ccode,onChange:ue,className:"outline-none cursor-pointer py-1.5 px-2 border-r border-gray-400 text-sm",children:V2.map(ce=>a.jsx("option",{value:ce.code,children:ce.code},ce.id))}),a.jsx("input",{type:"text",placeholder:"9----------",name:"mobile_phone_2",value:E.mobile_phone_2,onChange:ue,className:"w-full outline-none px-2 py-1.5 text-sm"})]})]}),a.jsxs("div",{className:"flex flex-col col-span-1 sm:col-span-2 lg:col-span-3",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Address"}),a.jsx("input",{type:"text",name:"address",value:E.address,onChange:ue,placeholder:"Street No., Street Name, City, State/Province, Postal Code",className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"})]}),a.jsxs("div",{className:"flex flex-col col-span-1 md:col-span-2 lg:col-span-1",children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:["Assign To ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("div",{className:`w-full rounded-lg ${re&&!E.lead_owner?"border border-red-400":"border border-gray-300"}`,children:a.jsx(iSe,{items:Array.isArray(o)?o:[],value:E.lead_owner??"",placeholder:"Search a user...",getLabel:ce=>`${ce.first_name} ${ce.last_name}`,onChange:ce=>{const fe=o.find(te=>String(te.id)===String(ce));u(fe);let H=null;fe&&fe.assigned_territory&&fe.assigned_territory.length===1&&(H=fe.assigned_territory[0].id),M(te=>({...te,lead_owner:ce,territory_id:H}))}})})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Territory"}),a.jsxs("select",{name:"territory_id",value:E.territory_id||"",onChange:ue,disabled:!c||!c.assigned_territory||c.assigned_territory.length===0,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm bg-white focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100 disabled:text-gray-500",children:[a.jsx("option",{value:"",disabled:!0,children:c?c.assigned_territory&&c.assigned_territory.length>0?"Select Territory":"No territories assigned to this user":"Select a user first"}),c&&c.assigned_territory&&c.assigned_territory.map(ce=>a.jsx("option",{value:ce.id,children:ce.name},ce.id))]})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Source"}),a.jsxs("select",{className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none",defaultValue:"",name:"source",value:E.source,onChange:ue,children:[a.jsx("option",{value:"",disabled:!0,children:"Select Source"}),a.jsx("option",{value:"Website",children:"Website"}),a.jsx("option",{value:"Referral",children:"Referral"}),a.jsx("option",{value:"Cold call",children:"Cold call"}),a.jsx("option",{value:"Event",children:"Event"}),a.jsx("option",{value:"Other",children:"Other"})]})]}),a.jsxs("div",{className:"flex flex-col col-span-1 sm:col-span-2 lg:col-span-3",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Notes"}),a.jsx("textarea",{placeholder:"Additional details...",name:"notes",value:E.notes,onChange:ue,rows:3,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none resize-none"})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-2 mt-4 col-span-1 sm:col-span-2 lg:col-span-3",children:[a.jsx("button",{type:"button",onClick:()=>{ze(),Le(!1)},className:"w-full sm:w-auto px-4 py-2 text-white bg-red-400 border border-red-300 rounded hover:bg-red-500 transition disabled:opacity-70",disabled:G||Q,children:"Cancel"}),a.jsx("button",{type:"submit",onClick:De,className:"w-full sm:w-auto px-4 py-2 text-white border border-tertiary bg-tertiary rounded hover:bg-secondary transition disabled:opacity-70",disabled:G||Q,children:G||Q?"Processing...":F?"Update Lead":"Save Lead"})]})]})]})}),W&&a.jsx(sSe,{open:!0,title:W.title,message:W.message,confirmLabel:W.confirmLabel,cancelLabel:W.cancelLabel,variant:W.variant,onConfirm:et,onCancel:yt,loading:Q}),n&&!r&&!F&&a.jsx(yY,{relatedActs:se,lead:n,onBack:Ne,fetchLeads:He,setSelectedLead:s,onEdit:z,onDelete:K})]})}function sSe({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o=!1,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsx("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${u}`,disabled:o,children:o?"Processing...":s})]})]})})}function rSe({icon:e,title:t,value:n,color:s="text-blue-600",bgColor:r="bg-blue-100",onClick:i}){const o=()=>{typeof i=="function"?i():console.log(`Clicked: ${t}`)};return a.jsxs("div",{className:"flex items-center p-4 bg-white rounded-xl shadow-md border border-gray-200 transition-all duration-300",onClick:o,children:[a.jsx("div",{className:`flex-shrink-0 p-3 rounded-full ${r} ${s} mr-4`,children:e?a.jsx(e,{size:22}):null}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:t}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:n})]})]})}function iSe({items:e=[],value:t="",onChange:n,getLabel:s,placeholder:r="Search...",disabled:i=!1,maxRender:o=200}){const[l,c]=f.useState(!1),[u,d]=f.useState(""),h=f.useRef(null),p=e.find(j=>String(j.id)===String(t)),x=p?s(p):"",b=f.useMemo(()=>{const j=u.trim().toLowerCase();return(j?e.filter(N=>(s(N)||"").toLowerCase().includes(j)):e).slice(0,o)},[e,u,s,o]);return f.useEffect(()=>{const j=y=>{h.current&&!h.current.contains(y.target)&&c(!1)};return document.addEventListener("mousedown",j),()=>document.removeEventListener("mousedown",j)},[]),f.useEffect(()=>{l||d("")},[l]),a.jsxs("div",{ref:h,className:"relative w-full",children:[a.jsx("input",{disabled:i,value:l?u:x,placeholder:r,onFocus:()=>!i&&c(!0),onChange:j=>{d(j.target.value),l||c(!0)},className:"w-full rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100"}),l&&!i&&a.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg overflow-hidden",children:[a.jsx("div",{className:"max-h-56 overflow-y-auto",children:b.length>0?b.map(j=>{const y=String(j.id),N=s(j),w=String(t)===y;return a.jsx("button",{type:"button",onClick:()=>{n(y),c(!1)},className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-50 ${w?"bg-blue-50":""}`,children:N||"--"},y)}):a.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No results"})}),e.length>o&&a.jsxs("div",{className:"px-3 py-2 text-[11px] text-gray-400 border-t",children:["Showing first ",o," results  keep typing to narrow."]})]})]})}let oSe={data:""},lSe=e=>{if(typeof window=="object"){let t=(e?e.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return t.nonce=window.__nonce__,t.parentNode||(e||document.head).appendChild(t),t.firstChild}return e||oSe},cSe=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,dSe=/\/\*[^]*?\*\/|  +/g,FR=/\n+/g,Kc=(e,t)=>{let n="",s="",r="";for(let i in e){let o=e[i];i[0]=="@"?i[1]=="i"?n=i+" "+o+";":s+=i[1]=="f"?Kc(o,i):i+"{"+Kc(o,i[1]=="k"?"":t)+"}":typeof o=="object"?s+=Kc(o,t?t.replace(/([^,])+/g,l=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,c=>/&/.test(c)?c.replace(/&/g,l):l?l+" "+c:c)):i):o!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),r+=Kc.p?Kc.p(i,o):i+":"+o+";")}return n+(t&&r?t+"{"+r+"}":r)+s},bl={},bY=e=>{if(typeof e=="object"){let t="";for(let n in e)t+=n+bY(e[n]);return t}return e},uSe=(e,t,n,s,r)=>{let i=bY(e),o=bl[i]||(bl[i]=(c=>{let u=0,d=11;for(;u<c.length;)d=101*d+c.charCodeAt(u++)>>>0;return"go"+d})(i));if(!bl[o]){let c=i!==e?e:(u=>{let d,h,p=[{}];for(;d=cSe.exec(u.replace(dSe,""));)d[4]?p.shift():d[3]?(h=d[3].replace(FR," ").trim(),p.unshift(p[0][h]=p[0][h]||{})):p[0][d[1]]=d[2].replace(FR," ").trim();return p[0]})(e);bl[o]=Kc(r?{["@keyframes "+o]:c}:c,n?"":"."+o)}let l=n&&bl.g?bl.g:null;return n&&(bl.g=bl[o]),((c,u,d,h)=>{h?u.data=u.data.replace(h,c):u.data.indexOf(c)===-1&&(u.data=d?c+u.data:u.data+c)})(bl[o],t,s,l),o},mSe=(e,t,n)=>e.reduce((s,r,i)=>{let o=t[i];if(o&&o.call){let l=o(n),c=l&&l.props&&l.props.className||/^go/.test(l)&&l;o=c?"."+c:l&&typeof l=="object"?l.props?"":Kc(l,""):l===!1?"":l}return s+r+(o??"")},"");function RN(e){let t=this||{},n=e.call?e(t.p):e;return uSe(n.unshift?n.raw?mSe(n,[].slice.call(arguments,1),t.p):n.reduce((s,r)=>Object.assign(s,r&&r.call?r(t.p):r),{}):n,lSe(t.target),t.g,t.o,t.k)}let vY,aE,nE;RN.bind({g:1});let Yl=RN.bind({k:1});function fSe(e,t,n,s){Kc.p=t,vY=e,aE=n,nE=s}function Ed(e,t){let n=this||{};return function(){let s=arguments;function r(i,o){let l=Object.assign({},i),c=l.className||r.className;n.p=Object.assign({theme:aE&&aE()},l),n.o=/ *go\d+/.test(c),l.className=RN.apply(n,s)+(c?" "+c:"");let u=e;return e[0]&&(u=l.as||e,delete l.as),nE&&u[0]&&nE(l),vY(u,l)}return r}}var hSe=e=>typeof e=="function",fw=(e,t)=>hSe(e)?e(t):e,gSe=(()=>{let e=0;return()=>(++e).toString()})(),wY=(()=>{let e;return()=>{if(e===void 0&&typeof window<"u"){let t=matchMedia("(prefers-reduced-motion: reduce)");e=!t||t.matches}return e}})(),pSe=20,ND="default",jY=(e,t)=>{let{toastLimit:n}=e.settings;switch(t.type){case 0:return{...e,toasts:[t.toast,...e.toasts].slice(0,n)};case 1:return{...e,toasts:e.toasts.map(o=>o.id===t.toast.id?{...o,...t.toast}:o)};case 2:let{toast:s}=t;return jY(e,{type:e.toasts.find(o=>o.id===s.id)?1:0,toast:s});case 3:let{toastId:r}=t;return{...e,toasts:e.toasts.map(o=>o.id===r||r===void 0?{...o,dismissed:!0,visible:!1}:o)};case 4:return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(o=>o.id!==t.toastId)};case 5:return{...e,pausedAt:t.time};case 6:let i=t.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(o=>({...o,pauseDuration:o.pauseDuration+i}))}}},bv=[],NY={toasts:[],pausedAt:void 0,settings:{toastLimit:pSe}},Po={},CY=(e,t=ND)=>{Po[t]=jY(Po[t]||NY,e),bv.forEach(([n,s])=>{n===t&&s(Po[t])})},SY=e=>Object.keys(Po).forEach(t=>CY(e,t)),xSe=e=>Object.keys(Po).find(t=>Po[t].toasts.some(n=>n.id===e)),zN=(e=ND)=>t=>{CY(t,e)},ySe={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},bSe=(e={},t=ND)=>{let[n,s]=f.useState(Po[t]||NY),r=f.useRef(Po[t]);f.useEffect(()=>(r.current!==Po[t]&&s(Po[t]),bv.push([t,s]),()=>{let o=bv.findIndex(([l])=>l===t);o>-1&&bv.splice(o,1)}),[t]);let i=n.toasts.map(o=>{var l,c,u;return{...e,...e[o.type],...o,removeDelay:o.removeDelay||((l=e[o.type])==null?void 0:l.removeDelay)||e?.removeDelay,duration:o.duration||((c=e[o.type])==null?void 0:c.duration)||e?.duration||ySe[o.type],style:{...e.style,...(u=e[o.type])==null?void 0:u.style,...o.style}}});return{...n,toasts:i}},vSe=(e,t="blank",n)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:t,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...n,id:n?.id||gSe()}),Xx=e=>(t,n)=>{let s=vSe(t,e,n);return zN(s.toasterId||xSe(s.id))({type:2,toast:s}),s.id},rs=(e,t)=>Xx("blank")(e,t);rs.error=Xx("error");rs.success=Xx("success");rs.loading=Xx("loading");rs.custom=Xx("custom");rs.dismiss=(e,t)=>{let n={type:3,toastId:e};t?zN(t)(n):SY(n)};rs.dismissAll=e=>rs.dismiss(void 0,e);rs.remove=(e,t)=>{let n={type:4,toastId:e};t?zN(t)(n):SY(n)};rs.removeAll=e=>rs.remove(void 0,e);rs.promise=(e,t,n)=>{let s=rs.loading(t.loading,{...n,...n?.loading});return typeof e=="function"&&(e=e()),e.then(r=>{let i=t.success?fw(t.success,r):void 0;return i?rs.success(i,{id:s,...n,...n?.success}):rs.dismiss(s),r}).catch(r=>{let i=t.error?fw(t.error,r):void 0;i?rs.error(i,{id:s,...n,...n?.error}):rs.dismiss(s)}),e};var wSe=1e3,jSe=(e,t="default")=>{let{toasts:n,pausedAt:s}=bSe(e,t),r=f.useRef(new Map).current,i=f.useCallback((h,p=wSe)=>{if(r.has(h))return;let x=setTimeout(()=>{r.delete(h),o({type:4,toastId:h})},p);r.set(h,x)},[]);f.useEffect(()=>{if(s)return;let h=Date.now(),p=n.map(x=>{if(x.duration===1/0)return;let b=(x.duration||0)+x.pauseDuration-(h-x.createdAt);if(b<0){x.visible&&rs.dismiss(x.id);return}return setTimeout(()=>rs.dismiss(x.id,t),b)});return()=>{p.forEach(x=>x&&clearTimeout(x))}},[n,s,t]);let o=f.useCallback(zN(t),[t]),l=f.useCallback(()=>{o({type:5,time:Date.now()})},[o]),c=f.useCallback((h,p)=>{o({type:1,toast:{id:h,height:p}})},[o]),u=f.useCallback(()=>{s&&o({type:6,time:Date.now()})},[s,o]),d=f.useCallback((h,p)=>{let{reverseOrder:x=!1,gutter:b=8,defaultPosition:j}=p||{},y=n.filter(S=>(S.position||j)===(h.position||j)&&S.height),N=y.findIndex(S=>S.id===h.id),w=y.filter((S,_)=>_<N&&S.visible).length;return y.filter(S=>S.visible).slice(...x?[w+1]:[0,w]).reduce((S,_)=>S+(_.height||0)+b,0)},[n]);return f.useEffect(()=>{n.forEach(h=>{if(h.dismissed)i(h.id,h.removeDelay);else{let p=r.get(h.id);p&&(clearTimeout(p),r.delete(h.id))}})},[n,i]),{toasts:n,handlers:{updateHeight:c,startPause:l,endPause:u,calculateOffset:d}}},NSe=Yl`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,CSe=Yl`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,SSe=Yl`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,_Se=Ed("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${NSe} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${CSe} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${SSe} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,ASe=Yl`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,TSe=Ed("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${ASe} 1s linear infinite;
`,kSe=Yl`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,ESe=Yl`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,LSe=Ed("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${kSe} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${ESe} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,DSe=Ed("div")`
  position: absolute;
`,PSe=Ed("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,OSe=Yl`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,MSe=Ed("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${OSe} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,ISe=({toast:e})=>{let{icon:t,type:n,iconTheme:s}=e;return t!==void 0?typeof t=="string"?f.createElement(MSe,null,t):t:n==="blank"?null:f.createElement(PSe,null,f.createElement(TSe,{...s}),n!=="loading"&&f.createElement(DSe,null,n==="error"?f.createElement(_Se,{...s}):f.createElement(LSe,{...s})))},$Se=e=>`
0% {transform: translate3d(0,${e*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,RSe=e=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${e*-150}%,-1px) scale(.6); opacity:0;}
`,zSe="0%{opacity:0;} 100%{opacity:1;}",FSe="0%{opacity:1;} 100%{opacity:0;}",USe=Ed("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,BSe=Ed("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,HSe=(e,t)=>{let n=e.includes("top")?1:-1,[s,r]=wY()?[zSe,FSe]:[$Se(n),RSe(n)];return{animation:t?`${Yl(s)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Yl(r)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},qSe=f.memo(({toast:e,position:t,style:n,children:s})=>{let r=e.height?HSe(e.position||t||"top-center",e.visible):{opacity:0},i=f.createElement(ISe,{toast:e}),o=f.createElement(BSe,{...e.ariaProps},fw(e.message,e));return f.createElement(USe,{className:e.className,style:{...r,...n,...e.style}},typeof s=="function"?s({icon:i,message:o}):f.createElement(f.Fragment,null,i,o))});fSe(f.createElement);var GSe=({id:e,className:t,style:n,onHeightUpdate:s,children:r})=>{let i=f.useCallback(o=>{if(o){let l=()=>{let c=o.getBoundingClientRect().height;s(e,c)};l(),new MutationObserver(l).observe(o,{subtree:!0,childList:!0,characterData:!0})}},[e,s]);return f.createElement("div",{ref:i,className:t,style:n},r)},WSe=(e,t)=>{let n=e.includes("top"),s=n?{top:0}:{bottom:0},r=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:wY()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${t*(n?1:-1)}px)`,...s,...r}},VSe=RN`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,ob=16,Zx=({reverseOrder:e,position:t="top-center",toastOptions:n,gutter:s,children:r,toasterId:i,containerStyle:o,containerClassName:l})=>{let{toasts:c,handlers:u}=jSe(n,i);return f.createElement("div",{"data-rht-toaster":i||"",style:{position:"fixed",zIndex:9999,top:ob,left:ob,right:ob,bottom:ob,pointerEvents:"none",...o},className:l,onMouseEnter:u.startPause,onMouseLeave:u.endPause},c.map(d=>{let h=d.position||t,p=u.calculateOffset(d,{reverseOrder:e,gutter:s,defaultPosition:t}),x=WSe(h,p);return f.createElement(GSe,{id:d.id,key:d.id,onHeightUpdate:u.updateHeight,className:d.visible?VSe:"",style:x},d.type==="custom"?fw(d.message,d):r?r(d):f.createElement(qSe,{toast:d,position:h}))}))},Jx=rs;function YSe(){f.useEffect(()=>{document.title="Audit | Sari-Sari CRM"},[]);const[e,t]=f.useState(null),[n,s]=f.useState(""),[r,i]=f.useState("Filter by Actions"),[o,l]=f.useState(1),[c,u]=f.useState(10),d=async()=>{try{const w=await ne.get("/logs/read-all");t(w.data)}catch(w){console.error("Error fetching audit logs:",w)}};f.useEffect(()=>{d()},[]);const h=f.useMemo(()=>{if(!Array.isArray(e))return[];const w=n.trim().toLowerCase(),S=r?.toUpperCase?.()||"ALL";return e.filter(T=>{const k=T.timestamp?new Date(T.timestamp).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}):"",A=`${T.entity_type||""} ${T.entity_name||T.entity_details?.name||T.entity_details?.title||T.entity_id||""}`,E=`${T.logger?.first_name||""} ${T.logger?.last_name||""}`,M=[k,E,T.action,T.entity_type,A,T.description],F=w===""||M.some(P=>P==null?!1:P.toString().toLowerCase().includes(w)),D=S==="FILTER BY ACTIONS"||(T.action||"").toUpperCase()===S;return F&&D}).sort((T,k)=>{const A=T.timestamp?new Date(T.timestamp).getTime():0;return(k.timestamp?new Date(k.timestamp).getTime():0)-A})},[e,n,r]),p=Math.max(1,Math.ceil(h.length/c)||1);f.useEffect(()=>{l(1)},[n,r]),f.useEffect(()=>{l(w=>{const S=Math.max(1,Math.ceil(h.length/c)||1);return w>S?S:w})},[h.length,c]);const x=f.useMemo(()=>{const w=(o-1)*c;return h.slice(w,w+c)},[h,o,c]);h.length===0||(o-1)*c+1,Math.min(o*c,h.length);const b=()=>l(w=>Math.max(w-1,1)),j=()=>l(w=>Math.min(w+1,p)),y=()=>{if(!h.length){Jx.error("No logs to export!");return}const w=["Timestamp","User","Action","Resource","Details"],S=h.map(E=>[new Date(E.timestamp).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}),`${E.logger?.first_name||""} ${E.logger?.last_name||""}`.trim(),E.action,`${E.entity_type}: ${E.entity_id}`,E.description||""]),_=[w.join(","),...S.map(E=>E.map(M=>`"${String(M).replace(/"/g,'""')}"`).join(","))].join(`
`),T=new Blob([_],{type:"text/csv;charset=utf-8;"}),k=URL.createObjectURL(T),A=document.createElement("a");A.href=k,A.download=`AuditLogs_${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(A),A.click(),document.body.removeChild(A),URL.revokeObjectURL(k)},N=w=>{switch((w||"").toUpperCase()){case"CREATE":return"bg-green-100 text-green-700";case"UPDATE":case"EDIT":return"bg-blue-100 text-blue-700";case"DELETE":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-700"}};return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[e===null&&a.jsx(qt,{message:"Loading audit logs..."}),a.jsx(Zx,{toastOptions:{duration:1e3}}),a.jsxs("div",{className:"bg-blue-50 border-l-4 border-blue-400 p-4 mb-6 rounded-r-md flex items-center",children:[a.jsx(Pt,{className:"text-blue-600 mr-3 flex-shrink-0",size:20}),a.jsxs("p",{className:"text-sm text-blue-700",children:[a.jsx("span",{className:"font-semibold",children:"Data Retention Policy:"})," Audit logs are automatically purged after 6 months to optimize system performance."]})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-5 space-y-3 sm:space-y-0",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Ls,{className:"text-blue-600",size:20}),a.jsx("h2",{className:"text-2xl sm:text-xl font-semibold text-gray-700",children:"Audit Logs"})]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 rounded-md hover:bg-gray-800 text-sm sm:text-base self-end sm:self-auto cursor-pointer",onClick:y,children:[a.jsx(Vo,{className:"mr-2"}),"Export Logs"]})})]}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition bg-white",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search audit logs",value:n,onChange:w=>s(w.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsx("div",{className:"w-full lg:w-1/4",children:a.jsxs("select",{value:r,onChange:w=>i(w.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{value:"Filter by Actions",children:"Filter by Actions"}),a.jsx("option",{value:"CREATE",children:"CREATE"}),a.jsx("option",{value:"DELETE",children:"DELETE"}),a.jsx("option",{value:"UPDATE",children:"UPDATE"})]})})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[600px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 text-sm tracking-wide font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4",children:"Timestamp"}),a.jsx("th",{className:"py-3 px-4",children:"User"}),a.jsx("th",{className:"py-3 px-4",children:"Action"}),a.jsx("th",{className:"py-3 px-4",children:"Resource"}),a.jsx("th",{className:"py-3 px-4",children:"Details"})]})}),a.jsx("tbody",{children:Array.isArray(h)&&h.length>0?x.map((w,S)=>a.jsxs("tr",{className:"hover:bg-gray-50 text-sm",children:[a.jsx("td",{className:"py-3 px-4 text-gray-700 whitespace-nowrap",children:new Date(w.timestamp).toLocaleString("en-US",{month:"numeric",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}).replace(",","")}),a.jsx("td",{className:"py-3 px-4 text-gray-700",children:w.name}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium whitespace-nowrap ${N(w.action)}`,children:w.action})}),a.jsxs("td",{className:"py-3 px-4 text-gray-700",children:[w.entity_type,": ",w.entity_id]}),a.jsx("td",{className:"py-3 px-4 text-gray-700",children:w.description})]},S)):a.jsx("tr",{children:a.jsx("td",{className:"py-3 px-4 text-sm text-gray-500 text-center",colSpan:5,children:"No activities to show."})})})]})}),a.jsx(ca,{className:"mt-4",totalItems:h.length,pageSize:c,currentPage:o,onPrev:b,onNext:j,onPageSizeChange:w=>{u(w),l(1)},pageSizeOptions:[10,20,30,40,50],label:"logs"})]})}var QSe=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function CD(e){if(typeof e!="string")return!1;var t=QSe;return t.includes(e)}var KSe=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],XSe=new Set(KSe);function _Y(e){return typeof e!="string"?!1:XSe.has(e)}function AY(e){return typeof e=="string"&&e.startsWith("data-")}function qr(e){if(typeof e!="object"||e===null)return{};var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(_Y(n)||AY(n))&&(t[n]=e[n]);return t}function Gu(e){if(e==null)return null;if(f.isValidElement(e)&&typeof e.props=="object"&&e.props!==null){var t=e.props;return qr(t)}return typeof e=="object"&&!Array.isArray(e)?qr(e):null}function Ys(e){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(_Y(n)||AY(n)||CD(n))&&(t[n]=e[n]);return t}function ZSe(e){return e==null?null:f.isValidElement(e)?Ys(e.props):typeof e=="object"&&!Array.isArray(e)?Ys(e):null}var JSe=["children","width","height","viewBox","className","style","title","desc"];function sE(){return sE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},sE.apply(null,arguments)}function e2e(e,t){if(e==null)return{};var n,s,r=t2e(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)n=i[s],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function t2e(e,t){if(e==null)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;n[s]=e[s]}return n}var SD=f.forwardRef((e,t)=>{var{children:n,width:s,height:r,viewBox:i,className:o,style:l,title:c,desc:u}=e,d=e2e(e,JSe),h=i||{width:s,height:r,x:0,y:0},p=Rt("recharts-surface",o);return f.createElement("svg",sE({},Ys(d),{className:p,width:s,height:r,style:l,viewBox:"".concat(h.x," ").concat(h.y," ").concat(h.width," ").concat(h.height),ref:t}),f.createElement("title",null,c),f.createElement("desc",null,u),n)}),a2e=["children","className"];function rE(){return rE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},rE.apply(null,arguments)}function n2e(e,t){if(e==null)return{};var n,s,r=s2e(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)n=i[s],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function s2e(e,t){if(e==null)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;n[s]=e[s]}return n}var vs=f.forwardRef((e,t)=>{var{children:n,className:s}=e,r=n2e(e,a2e),i=Rt("recharts-layer",s);return f.createElement("g",rE({className:i},Ys(r),{ref:t}),n)}),TY=f.createContext(null),r2e=()=>f.useContext(TY),Q2={},K2={},UR;function i2e(){return UR||(UR=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return n==="__proto__"}e.isUnsafeProperty=t})(K2)),K2}var X2={},BR;function kY(){return BR||(BR=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){switch(typeof n){case"number":case"symbol":return!1;case"string":return n.includes(".")||n.includes("[")||n.includes("]")}}e.isDeepKey=t})(X2)),X2}var Z2={},HR;function _D(){return HR||(HR=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return typeof n=="string"||typeof n=="symbol"?n:Object.is(n?.valueOf?.(),-0)?"-0":String(n)}e.toKey=t})(Z2)),Z2}var J2={},e_={},qR;function o2e(){return qR||(qR=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){if(n==null)return"";if(typeof n=="string")return n;if(Array.isArray(n))return n.map(t).join(",");const s=String(n);return s==="0"&&Object.is(Number(n),-0)?"-0":s}e.toString=t})(e_)),e_}var GR;function AD(){return GR||(GR=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=o2e(),n=_D();function s(r){if(Array.isArray(r))return r.map(n.toKey);if(typeof r=="symbol")return[r];r=t.toString(r);const i=[],o=r.length;if(o===0)return i;let l=0,c="",u="",d=!1;for(r.charCodeAt(0)===46&&(i.push(""),l++);l<o;){const h=r[l];u?h==="\\"&&l+1<o?(l++,c+=r[l]):h===u?u="":c+=h:d?h==='"'||h==="'"?u=h:h==="]"?(d=!1,i.push(c),c=""):c+=h:h==="["?(d=!0,c&&(i.push(c),c="")):h==="."?c&&(i.push(c),c=""):c+=h,l++}return c&&i.push(c),i}e.toPath=s})(J2)),J2}var WR;function TD(){return WR||(WR=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=i2e(),n=kY(),s=_D(),r=AD();function i(l,c,u){if(l==null)return u;switch(typeof c){case"string":{if(t.isUnsafeProperty(c))return u;const d=l[c];return d===void 0?n.isDeepKey(c)?i(l,r.toPath(c),u):u:d}case"number":case"symbol":{typeof c=="number"&&(c=s.toKey(c));const d=l[c];return d===void 0?u:d}default:{if(Array.isArray(c))return o(l,c,u);if(Object.is(c?.valueOf(),-0)?c="-0":c=String(c),t.isUnsafeProperty(c))return u;const d=l[c];return d===void 0?u:d}}}function o(l,c,u){if(c.length===0)return u;let d=l;for(let h=0;h<c.length;h++){if(d==null||t.isUnsafeProperty(c[h]))return u;d=d[c[h]]}return d===void 0?u:d}e.get=i})(Q2)),Q2}var t_,VR;function l2e(){return VR||(VR=1,t_=TD().get),t_}var c2e=l2e();const Wu=ao(c2e);var d2e=4;function td(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:d2e,n=10**t,s=Math.round(e*n)/n;return Object.is(s,-0)?0:s}function Cn(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];return e.reduce((r,i,o)=>{var l=n[o-1];return typeof l=="string"?r+l+i:l!==void 0?r+td(l)+i:r+i},"")}var bs=e=>e===0?0:e>0?1:-1,eo=e=>typeof e=="number"&&e!=+e,Ql=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,Ut=e=>(typeof e=="number"||e instanceof Number)&&!eo(e),Ho=e=>Ut(e)||typeof e=="string",u2e=0,Fp=e=>{var t=++u2e;return"".concat(e||"").concat(t)},Fs=function(t,n){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Ut(t)&&typeof t!="string")return s;var i;if(Ql(t)){if(n==null)return s;var o=t.indexOf("%");i=n*parseFloat(t.slice(0,o))/100}else i=+t;return eo(i)&&(i=s),r&&n!=null&&i>n&&(i=n),i},EY=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,n={},s=0;s<t;s++)if(!n[String(e[s])])n[String(e[s])]=!0;else return!0;return!1};function dn(e,t,n){return Ut(e)&&Ut(t)?td(e+n*(t-e)):t}function LY(e,t,n){if(!(!e||!e.length))return e.find(s=>s&&(typeof t=="function"?t(s):Wu(s,t))===n)}var fn=e=>e===null||typeof e>"u",e0=e=>fn(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1));function m2e(e){return e!=null}function t0(){}var f2e=["type","size","sizeType"];function iE(){return iE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},iE.apply(null,arguments)}function YR(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function QR(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?YR(Object(n),!0).forEach(function(s){h2e(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):YR(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function h2e(e,t,n){return(t=g2e(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function g2e(e){var t=p2e(e,"string");return typeof t=="symbol"?t:t+""}function p2e(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function x2e(e,t){if(e==null)return{};var n,s,r=y2e(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)n=i[s],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function y2e(e,t){if(e==null)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;n[s]=e[s]}return n}var DY={symbolCircle:gN,symbolCross:nW,symbolDiamond:rW,symbolSquare:iW,symbolStar:lW,symbolTriangle:cW,symbolWye:dW},b2e=Math.PI/180,v2e=e=>{var t="symbol".concat(e0(e));return DY[t]||gN},w2e=(e,t,n)=>{if(t==="area")return e;switch(n){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var s=18*b2e;return 1.25*e*e*(Math.tan(s)-Math.tan(s*2)*Math.tan(s)**2)}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},j2e=(e,t)=>{DY["symbol".concat(e0(e))]=t},kD=e=>{var{type:t="circle",size:n=64,sizeType:s="area"}=e,r=x2e(e,f2e),i=QR(QR({},r),{},{type:t,size:n,sizeType:s}),o="circle";typeof t=="string"&&(o=t);var l=()=>{var p=v2e(o),x=U4().type(p).size(w2e(n,s,o)),b=x();if(b!==null)return b},{className:c,cx:u,cy:d}=i,h=Ys(i);return Ut(u)&&Ut(d)&&Ut(n)?f.createElement("path",iE({},h,{className:Rt("recharts-symbols",c),transform:"translate(".concat(u,", ").concat(d,")"),d:l()})):null};kD.registerSymbol=j2e;var PY=e=>"radius"in e&&"startAngle"in e&&"endAngle"in e,ED=(e,t)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var n=e;if(f.isValidElement(e)&&(n=e.props),typeof n!="object"&&typeof n!="function")return null;var s={};return Object.keys(n).forEach(r=>{CD(r)&&(s[r]=(i=>n[r](n,i)))}),s},N2e=(e,t,n)=>s=>(e(t,n,s),null),a0=(e,t,n)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var s=null;return Object.keys(e).forEach(r=>{var i=e[r];CD(r)&&typeof i=="function"&&(s||(s={}),s[r]=N2e(i,t,n))}),s};function KR(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function C2e(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?KR(Object(n),!0).forEach(function(s){S2e(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):KR(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function S2e(e,t,n){return(t=_2e(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _2e(e){var t=A2e(e,"string");return typeof t=="symbol"?t:t+""}function A2e(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Xn(e,t){var n=C2e({},e),s=t,r=Object.keys(t),i=r.reduce((o,l)=>(o[l]===void 0&&s[l]!==void 0&&(o[l]=s[l]),o),n);return i}function hw(){return hw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},hw.apply(null,arguments)}function XR(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function T2e(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?XR(Object(n),!0).forEach(function(s){k2e(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):XR(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function k2e(e,t,n){return(t=E2e(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function E2e(e){var t=L2e(e,"string");return typeof t=="symbol"?t:t+""}function L2e(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ui=32,D2e={align:"center",iconSize:14,inactiveColor:"#ccc",layout:"horizontal",verticalAlign:"middle"};function P2e(e){var{data:t,iconType:n,inactiveColor:s}=e,r=ui/2,i=ui/6,o=ui/3,l=t.inactive?s:t.color,c=n??t.type;if(c==="none")return null;if(c==="plainline"){var u;return f.createElement("line",{strokeWidth:4,fill:"none",stroke:l,strokeDasharray:(u=t.payload)===null||u===void 0?void 0:u.strokeDasharray,x1:0,y1:r,x2:ui,y2:r,className:"recharts-legend-icon"})}if(c==="line")return f.createElement("path",{strokeWidth:4,fill:"none",stroke:l,d:"M0,".concat(r,"h").concat(o,`
            A`).concat(i,",").concat(i,",0,1,1,").concat(2*o,",").concat(r,`
            H`).concat(ui,"M").concat(2*o,",").concat(r,`
            A`).concat(i,",").concat(i,",0,1,1,").concat(o,",").concat(r),className:"recharts-legend-icon"});if(c==="rect")return f.createElement("path",{stroke:"none",fill:l,d:"M0,".concat(ui/8,"h").concat(ui,"v").concat(ui*3/4,"h").concat(-ui,"z"),className:"recharts-legend-icon"});if(f.isValidElement(t.legendIcon)){var d=T2e({},t);return delete d.legendIcon,f.cloneElement(t.legendIcon,d)}return f.createElement(kD,{fill:l,cx:r,cy:r,size:ui,sizeType:"diameter",type:c})}function O2e(e){var{payload:t,iconSize:n,layout:s,formatter:r,inactiveColor:i,iconType:o}=e,l={x:0,y:0,width:ui,height:ui},c={display:s==="horizontal"?"inline-block":"block",marginRight:10},u={display:"inline-block",verticalAlign:"middle",marginRight:4};return t.map((d,h)=>{var p=d.formatter||r,x=Rt({"recharts-legend-item":!0,["legend-item-".concat(h)]:!0,inactive:d.inactive});if(d.type==="none")return null;var b=d.inactive?i:d.color,j=p?p(d.value,d,h):d.value;return f.createElement("li",hw({className:x,style:c,key:"legend-item-".concat(h)},a0(e,d,h)),f.createElement(SD,{width:n,height:n,viewBox:l,style:u,"aria-label":"".concat(j," legend icon")},f.createElement(P2e,{data:d,iconType:o,inactiveColor:i})),f.createElement("span",{className:"recharts-legend-item-text",style:{color:b}},j))})}var M2e=e=>{var t=Xn(e,D2e),{payload:n,layout:s,align:r}=t;if(!n||!n.length)return null;var i={padding:0,margin:0,textAlign:s==="horizontal"?r:"left"};return f.createElement("ul",{className:"recharts-default-legend",style:i},f.createElement(O2e,hw({},t,{payload:n})))},a_={},n_={},ZR;function I2e(){return ZR||(ZR=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n,s){const r=new Map;for(let i=0;i<n.length;i++){const o=n[i],l=s(o);r.has(l)||r.set(l,o)}return Array.from(r.values())}e.uniqBy=t})(n_)),n_}var s_={},JR;function OY(){return JR||(JR=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return n}e.identity=t})(s_)),s_}var r_={},i_={},o_={},ez;function $2e(){return ez||(ez=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return Number.isSafeInteger(n)&&n>=0}e.isLength=t})(o_)),o_}var tz;function LD(){return tz||(tz=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=$2e();function n(s){return s!=null&&typeof s!="function"&&t.isLength(s.length)}e.isArrayLike=n})(i_)),i_}var l_={},az;function R2e(){return az||(az=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return typeof n=="object"&&n!==null}e.isObjectLike=t})(l_)),l_}var nz;function z2e(){return nz||(nz=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=LD(),n=R2e();function s(r){return n.isObjectLike(r)&&t.isArrayLike(r)}e.isArrayLikeObject=s})(r_)),r_}var c_={},d_={},sz;function F2e(){return sz||(sz=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=TD();function n(s){return function(r){return t.get(r,s)}}e.property=n})(d_)),d_}var u_={},m_={},f_={},h_={},rz;function MY(){return rz||(rz=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return n!==null&&(typeof n=="object"||typeof n=="function")}e.isObject=t})(h_)),h_}var g_={},iz;function IY(){return iz||(iz=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return n==null||typeof n!="object"&&typeof n!="function"}e.isPrimitive=t})(g_)),g_}var p_={},oz;function $Y(){return oz||(oz=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n,s){return n===s||Number.isNaN(n)&&Number.isNaN(s)}e.eq=t})(p_)),p_}var lz;function U2e(){return lz||(lz=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=MY(),n=IY(),s=$Y();function r(d,h,p){return typeof p!="function"?r(d,h,()=>{}):i(d,h,function x(b,j,y,N,w,S){const _=p(b,j,y,N,w,S);return _!==void 0?!!_:i(b,j,x,S)},new Map)}function i(d,h,p,x){if(h===d)return!0;switch(typeof h){case"object":return o(d,h,p,x);case"function":return Object.keys(h).length>0?i(d,{...h},p,x):s.eq(d,h);default:return t.isObject(d)?typeof h=="string"?h==="":!0:s.eq(d,h)}}function o(d,h,p,x){if(h==null)return!0;if(Array.isArray(h))return c(d,h,p,x);if(h instanceof Map)return l(d,h,p,x);if(h instanceof Set)return u(d,h,p,x);const b=Object.keys(h);if(d==null||n.isPrimitive(d))return b.length===0;if(b.length===0)return!0;if(x?.has(h))return x.get(h)===d;x?.set(h,d);try{for(let j=0;j<b.length;j++){const y=b[j];if(!n.isPrimitive(d)&&!(y in d)||h[y]===void 0&&d[y]!==void 0||h[y]===null&&d[y]!==null||!p(d[y],h[y],y,d,h,x))return!1}return!0}finally{x?.delete(h)}}function l(d,h,p,x){if(h.size===0)return!0;if(!(d instanceof Map))return!1;for(const[b,j]of h.entries()){const y=d.get(b);if(p(y,j,b,d,h,x)===!1)return!1}return!0}function c(d,h,p,x){if(h.length===0)return!0;if(!Array.isArray(d))return!1;const b=new Set;for(let j=0;j<h.length;j++){const y=h[j];let N=!1;for(let w=0;w<d.length;w++){if(b.has(w))continue;const S=d[w];let _=!1;if(p(S,y,j,d,h,x)&&(_=!0),_){b.add(w),N=!0;break}}if(!N)return!1}return!0}function u(d,h,p,x){return h.size===0?!0:d instanceof Set?c([...d],[...h],p,x):!1}e.isMatchWith=r,e.isSetMatch=u})(f_)),f_}var cz;function RY(){return cz||(cz=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=U2e();function n(s,r){return t.isMatchWith(s,r,()=>{})}e.isMatch=n})(m_)),m_}var x_={},y_={},b_={},dz;function B2e(){return dz||(dz=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return Object.getOwnPropertySymbols(n).filter(s=>Object.prototype.propertyIsEnumerable.call(n,s))}e.getSymbols=t})(b_)),b_}var v_={},uz;function zY(){return uz||(uz=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return n==null?n===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(n)}e.getTag=t})(v_)),v_}var w_={},mz;function FY(){return mz||(mz=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t="[object RegExp]",n="[object String]",s="[object Number]",r="[object Boolean]",i="[object Arguments]",o="[object Symbol]",l="[object Date]",c="[object Map]",u="[object Set]",d="[object Array]",h="[object Function]",p="[object ArrayBuffer]",x="[object Object]",b="[object Error]",j="[object DataView]",y="[object Uint8Array]",N="[object Uint8ClampedArray]",w="[object Uint16Array]",S="[object Uint32Array]",_="[object BigUint64Array]",T="[object Int8Array]",k="[object Int16Array]",A="[object Int32Array]",E="[object BigInt64Array]",M="[object Float32Array]",F="[object Float64Array]";e.argumentsTag=i,e.arrayBufferTag=p,e.arrayTag=d,e.bigInt64ArrayTag=E,e.bigUint64ArrayTag=_,e.booleanTag=r,e.dataViewTag=j,e.dateTag=l,e.errorTag=b,e.float32ArrayTag=M,e.float64ArrayTag=F,e.functionTag=h,e.int16ArrayTag=k,e.int32ArrayTag=A,e.int8ArrayTag=T,e.mapTag=c,e.numberTag=s,e.objectTag=x,e.regexpTag=t,e.setTag=u,e.stringTag=n,e.symbolTag=o,e.uint16ArrayTag=w,e.uint32ArrayTag=S,e.uint8ArrayTag=y,e.uint8ClampedArrayTag=N})(w_)),w_}var j_={},fz;function H2e(){return fz||(fz=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}e.isTypedArray=t})(j_)),j_}var hz;function UY(){return hz||(hz=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=B2e(),n=zY(),s=FY(),r=IY(),i=H2e();function o(d,h){return l(d,void 0,d,new Map,h)}function l(d,h,p,x=new Map,b=void 0){const j=b?.(d,h,p,x);if(j!==void 0)return j;if(r.isPrimitive(d))return d;if(x.has(d))return x.get(d);if(Array.isArray(d)){const y=new Array(d.length);x.set(d,y);for(let N=0;N<d.length;N++)y[N]=l(d[N],N,p,x,b);return Object.hasOwn(d,"index")&&(y.index=d.index),Object.hasOwn(d,"input")&&(y.input=d.input),y}if(d instanceof Date)return new Date(d.getTime());if(d instanceof RegExp){const y=new RegExp(d.source,d.flags);return y.lastIndex=d.lastIndex,y}if(d instanceof Map){const y=new Map;x.set(d,y);for(const[N,w]of d)y.set(N,l(w,N,p,x,b));return y}if(d instanceof Set){const y=new Set;x.set(d,y);for(const N of d)y.add(l(N,void 0,p,x,b));return y}if(typeof Buffer<"u"&&Buffer.isBuffer(d))return d.subarray();if(i.isTypedArray(d)){const y=new(Object.getPrototypeOf(d)).constructor(d.length);x.set(d,y);for(let N=0;N<d.length;N++)y[N]=l(d[N],N,p,x,b);return y}if(d instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&d instanceof SharedArrayBuffer)return d.slice(0);if(d instanceof DataView){const y=new DataView(d.buffer.slice(0),d.byteOffset,d.byteLength);return x.set(d,y),c(y,d,p,x,b),y}if(typeof File<"u"&&d instanceof File){const y=new File([d],d.name,{type:d.type});return x.set(d,y),c(y,d,p,x,b),y}if(typeof Blob<"u"&&d instanceof Blob){const y=new Blob([d],{type:d.type});return x.set(d,y),c(y,d,p,x,b),y}if(d instanceof Error){const y=new d.constructor;return x.set(d,y),y.message=d.message,y.name=d.name,y.stack=d.stack,y.cause=d.cause,c(y,d,p,x,b),y}if(d instanceof Boolean){const y=new Boolean(d.valueOf());return x.set(d,y),c(y,d,p,x,b),y}if(d instanceof Number){const y=new Number(d.valueOf());return x.set(d,y),c(y,d,p,x,b),y}if(d instanceof String){const y=new String(d.valueOf());return x.set(d,y),c(y,d,p,x,b),y}if(typeof d=="object"&&u(d)){const y=Object.create(Object.getPrototypeOf(d));return x.set(d,y),c(y,d,p,x,b),y}return d}function c(d,h,p=d,x,b){const j=[...Object.keys(h),...t.getSymbols(h)];for(let y=0;y<j.length;y++){const N=j[y],w=Object.getOwnPropertyDescriptor(d,N);(w==null||w.writable)&&(d[N]=l(h[N],N,p,x,b))}}function u(d){switch(n.getTag(d)){case s.argumentsTag:case s.arrayTag:case s.arrayBufferTag:case s.dataViewTag:case s.booleanTag:case s.dateTag:case s.float32ArrayTag:case s.float64ArrayTag:case s.int8ArrayTag:case s.int16ArrayTag:case s.int32ArrayTag:case s.mapTag:case s.numberTag:case s.objectTag:case s.regexpTag:case s.setTag:case s.stringTag:case s.symbolTag:case s.uint8ArrayTag:case s.uint8ClampedArrayTag:case s.uint16ArrayTag:case s.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=o,e.cloneDeepWithImpl=l,e.copyProperties=c})(y_)),y_}var gz;function q2e(){return gz||(gz=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=UY();function n(s){return t.cloneDeepWithImpl(s,void 0,s,new Map,void 0)}e.cloneDeep=n})(x_)),x_}var pz;function G2e(){return pz||(pz=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=RY(),n=q2e();function s(r){return r=n.cloneDeep(r),i=>t.isMatch(i,r)}e.matches=s})(u_)),u_}var N_={},C_={},S_={},xz;function W2e(){return xz||(xz=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=UY(),n=FY();function s(r,i){return t.cloneDeepWith(r,(o,l,c,u)=>{const d=i?.(o,l,c,u);if(d!==void 0)return d;if(typeof r=="object")switch(Object.prototype.toString.call(r)){case n.numberTag:case n.stringTag:case n.booleanTag:{const h=new r.constructor(r?.valueOf());return t.copyProperties(h,r),h}case n.argumentsTag:{const h={};return t.copyProperties(h,r),h.length=r.length,h[Symbol.iterator]=r[Symbol.iterator],h}default:return}})}e.cloneDeepWith=s})(S_)),S_}var yz;function V2e(){return yz||(yz=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=W2e();function n(s){return t.cloneDeepWith(s)}e.cloneDeep=n})(C_)),C_}var __={},A_={},bz;function BY(){return bz||(bz=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=/^(?:0|[1-9]\d*)$/;function n(s,r=Number.MAX_SAFE_INTEGER){switch(typeof s){case"number":return Number.isInteger(s)&&s>=0&&s<r;case"symbol":return!1;case"string":return t.test(s)}}e.isIndex=n})(A_)),A_}var T_={},vz;function Y2e(){return vz||(vz=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=zY();function n(s){return s!==null&&typeof s=="object"&&t.getTag(s)==="[object Arguments]"}e.isArguments=n})(T_)),T_}var wz;function Q2e(){return wz||(wz=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=kY(),n=BY(),s=Y2e(),r=AD();function i(o,l){let c;if(Array.isArray(l)?c=l:typeof l=="string"&&t.isDeepKey(l)&&o?.[l]==null?c=r.toPath(l):c=[l],c.length===0)return!1;let u=o;for(let d=0;d<c.length;d++){const h=c[d];if((u==null||!Object.hasOwn(u,h))&&!((Array.isArray(u)||s.isArguments(u))&&n.isIndex(h)&&h<u.length))return!1;u=u[h]}return!0}e.has=i})(__)),__}var jz;function K2e(){return jz||(jz=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=RY(),n=_D(),s=V2e(),r=TD(),i=Q2e();function o(l,c){switch(typeof l){case"object":{Object.is(l?.valueOf(),-0)&&(l="-0");break}case"number":{l=n.toKey(l);break}}return c=s.cloneDeep(c),function(u){const d=r.get(u,l);return d===void 0?i.has(u,l):c===void 0?d===void 0:t.isMatch(d,c)}}e.matchesProperty=o})(N_)),N_}var Nz;function X2e(){return Nz||(Nz=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=OY(),n=F2e(),s=G2e(),r=K2e();function i(o){if(o==null)return t.identity;switch(typeof o){case"function":return o;case"object":return Array.isArray(o)&&o.length===2?r.matchesProperty(o[0],o[1]):s.matches(o);case"string":case"symbol":case"number":return n.property(o)}}e.iteratee=i})(c_)),c_}var Cz;function Z2e(){return Cz||(Cz=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=I2e(),n=OY(),s=z2e(),r=X2e();function i(o,l=n.identity){return s.isArrayLikeObject(o)?t.uniqBy(Array.from(o),r.iteratee(l)):[]}e.uniqBy=i})(a_)),a_}var k_,Sz;function J2e(){return Sz||(Sz=1,k_=Z2e().uniqBy),k_}var e_e=J2e();const _z=ao(e_e);function HY(e,t,n){return t===!0?_z(e,n):typeof t=="function"?_z(e,t):e}var DD=f.createContext(null),t_e=e=>e,Ja=()=>{var e=f.useContext(DD);return e?e.store.dispatch:t_e},vv=()=>{},a_e=()=>vv,n_e=(e,t)=>e===t;function Bt(e){var t=f.useContext(DD);return fq.useSyncExternalStoreWithSelector(t?t.subscription.addNestedSub:a_e,t?t.store.getState:vv,t?t.store.getState:vv,t?e:vv,n_e)}var E_={},L_={},D_={},Az;function s_e(){return Az||(Az=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(s){return typeof s=="symbol"?1:s===null?2:s===void 0?3:s!==s?4:0}const n=(s,r,i)=>{if(s!==r){const o=t(s),l=t(r);if(o===l&&o===0){if(s<r)return i==="desc"?1:-1;if(s>r)return i==="desc"?-1:1}return i==="desc"?l-o:o-l}return 0};e.compareValues=n})(D_)),D_}var P_={},O_={},Tz;function qY(){return Tz||(Tz=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return typeof n=="symbol"||n instanceof Symbol}e.isSymbol=t})(O_)),O_}var kz;function r_e(){return kz||(kz=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=qY(),n=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,s=/^\w*$/;function r(i,o){return Array.isArray(i)?!1:typeof i=="number"||typeof i=="boolean"||i==null||t.isSymbol(i)?!0:typeof i=="string"&&(s.test(i)||!n.test(i))||o!=null&&Object.hasOwn(o,i)}e.isKey=r})(P_)),P_}var Ez;function i_e(){return Ez||(Ez=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=s_e(),n=r_e(),s=AD();function r(i,o,l,c){if(i==null)return[];l=c?void 0:l,Array.isArray(i)||(i=Object.values(i)),Array.isArray(o)||(o=o==null?[null]:[o]),o.length===0&&(o=[null]),Array.isArray(l)||(l=l==null?[]:[l]),l=l.map(x=>String(x));const u=(x,b)=>{let j=x;for(let y=0;y<b.length&&j!=null;++y)j=j[b[y]];return j},d=(x,b)=>b==null||x==null?b:typeof x=="object"&&"key"in x?Object.hasOwn(b,x.key)?b[x.key]:u(b,x.path):typeof x=="function"?x(b):Array.isArray(x)?u(b,x):typeof b=="object"?b[x]:b,h=o.map(x=>(Array.isArray(x)&&x.length===1&&(x=x[0]),x==null||typeof x=="function"||Array.isArray(x)||n.isKey(x)?x:{key:x,path:s.toPath(x)}));return i.map(x=>({original:x,criteria:h.map(b=>d(b,x))})).slice().sort((x,b)=>{for(let j=0;j<h.length;j++){const y=t.compareValues(x.criteria[j],b.criteria[j],l[j]);if(y!==0)return y}return 0}).map(x=>x.original)}e.orderBy=r})(L_)),L_}var M_={},Lz;function o_e(){return Lz||(Lz=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n,s=1){const r=[],i=Math.floor(s),o=(l,c)=>{for(let u=0;u<l.length;u++){const d=l[u];Array.isArray(d)&&c<i?o(d,c+1):r.push(d)}};return o(n,0),r}e.flatten=t})(M_)),M_}var I_={},Dz;function GY(){return Dz||(Dz=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=BY(),n=LD(),s=MY(),r=$Y();function i(o,l,c){return s.isObject(c)&&(typeof l=="number"&&n.isArrayLike(c)&&t.isIndex(l)&&l<c.length||typeof l=="string"&&l in c)?r.eq(c[l],o):!1}e.isIterateeCall=i})(I_)),I_}var Pz;function l_e(){return Pz||(Pz=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=i_e(),n=o_e(),s=GY();function r(i,...o){const l=o.length;return l>1&&s.isIterateeCall(i,o[0],o[1])?o=[]:l>2&&s.isIterateeCall(o[0],o[1],o[2])&&(o=[o[0]]),t.orderBy(i,n.flatten(o),["asc"])}e.sortBy=r})(E_)),E_}var $_,Oz;function c_e(){return Oz||(Oz=1,$_=l_e().sortBy),$_}var d_e=c_e();const FN=ao(d_e);var WY=e=>e.legend.settings,u_e=e=>e.legend.size,m_e=e=>e.legend.payload,f_e=dt([m_e,WY],(e,t)=>{var{itemSorter:n}=t,s=e.flat(1);return n?FN(s,n):s});function h_e(){return Bt(f_e)}var lb=1;function VY(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[t,n]=f.useState({height:0,left:0,top:0,width:0}),s=f.useCallback(r=>{if(r!=null){var i=r.getBoundingClientRect(),o={height:i.height,left:i.left,top:i.top,width:i.width};(Math.abs(o.height-t.height)>lb||Math.abs(o.left-t.left)>lb||Math.abs(o.top-t.top)>lb||Math.abs(o.width-t.width)>lb)&&n({height:o.height,left:o.left,top:o.top,width:o.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,s]}function Ts(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var g_e=typeof Symbol=="function"&&Symbol.observable||"@@observable",Mz=g_e,R_=()=>Math.random().toString(36).substring(7).split("").join("."),p_e={INIT:`@@redux/INIT${R_()}`,REPLACE:`@@redux/REPLACE${R_()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${R_()}`},gw=p_e;function PD(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function YY(e,t,n){if(typeof e!="function")throw new Error(Ts(2));if(typeof t=="function"&&typeof n=="function"||typeof n=="function"&&typeof arguments[3]=="function")throw new Error(Ts(0));if(typeof t=="function"&&typeof n>"u"&&(n=t,t=void 0),typeof n<"u"){if(typeof n!="function")throw new Error(Ts(1));return n(YY)(e,t)}let s=e,r=t,i=new Map,o=i,l=0,c=!1;function u(){o===i&&(o=new Map,i.forEach((y,N)=>{o.set(N,y)}))}function d(){if(c)throw new Error(Ts(3));return r}function h(y){if(typeof y!="function")throw new Error(Ts(4));if(c)throw new Error(Ts(5));let N=!0;u();const w=l++;return o.set(w,y),function(){if(N){if(c)throw new Error(Ts(6));N=!1,u(),o.delete(w),i=null}}}function p(y){if(!PD(y))throw new Error(Ts(7));if(typeof y.type>"u")throw new Error(Ts(8));if(typeof y.type!="string")throw new Error(Ts(17));if(c)throw new Error(Ts(9));try{c=!0,r=s(r,y)}finally{c=!1}return(i=o).forEach(w=>{w()}),y}function x(y){if(typeof y!="function")throw new Error(Ts(10));s=y,p({type:gw.REPLACE})}function b(){const y=h;return{subscribe(N){if(typeof N!="object"||N===null)throw new Error(Ts(11));function w(){const _=N;_.next&&_.next(d())}return w(),{unsubscribe:y(w)}},[Mz](){return this}}}return p({type:gw.INIT}),{dispatch:p,subscribe:h,getState:d,replaceReducer:x,[Mz]:b}}function x_e(e){Object.keys(e).forEach(t=>{const n=e[t];if(typeof n(void 0,{type:gw.INIT})>"u")throw new Error(Ts(12));if(typeof n(void 0,{type:gw.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Ts(13))})}function QY(e){const t=Object.keys(e),n={};for(let i=0;i<t.length;i++){const o=t[i];typeof e[o]=="function"&&(n[o]=e[o])}const s=Object.keys(n);let r;try{x_e(n)}catch(i){r=i}return function(o={},l){if(r)throw r;let c=!1;const u={};for(let d=0;d<s.length;d++){const h=s[d],p=n[h],x=o[h],b=p(x,l);if(typeof b>"u")throw l&&l.type,new Error(Ts(14));u[h]=b,c=c||b!==x}return c=c||s.length!==Object.keys(o).length,c?u:o}}function pw(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,n)=>(...s)=>t(n(...s)))}function y_e(...e){return t=>(n,s)=>{const r=t(n,s);let i=()=>{throw new Error(Ts(15))};const o={getState:r.getState,dispatch:(c,...u)=>i(c,...u)},l=e.map(c=>c(o));return i=pw(...l)(r.dispatch),{...r,dispatch:i}}}function KY(e){return PD(e)&&"type"in e&&typeof e.type=="string"}var XY=Symbol.for("immer-nothing"),Iz=Symbol.for("immer-draftable"),Qs=Symbol.for("immer-state");function Hi(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Rr=Object,Gf=Rr.getPrototypeOf,xw="constructor",UN="prototype",oE="configurable",yw="enumerable",wv="writable",Up="value",Kl=e=>!!e&&!!e[Qs];function to(e){return e?ZY(e)||BN(e)||!!e[Iz]||!!e[xw]?.[Iz]||HN(e)||qN(e):!1}var b_e=Rr[UN][xw].toString(),$z=new WeakMap;function ZY(e){if(!e||!OD(e))return!1;const t=Gf(e);if(t===null||t===Rr[UN])return!0;const n=Rr.hasOwnProperty.call(t,xw)&&t[xw];if(n===Object)return!0;if(!xf(n))return!1;let s=$z.get(n);return s===void 0&&(s=Function.toString.call(n),$z.set(n,s)),s===b_e}function n0(e,t,n=!0){s0(e)===0?(n?Reflect.ownKeys(e):Rr.keys(e)).forEach(r=>{t(r,e[r],e)}):e.forEach((s,r)=>t(r,s,e))}function s0(e){const t=e[Qs];return t?t.type_:BN(e)?1:HN(e)?2:qN(e)?3:0}var Rz=(e,t,n=s0(e))=>n===2?e.has(t):Rr[UN].hasOwnProperty.call(e,t),lE=(e,t,n=s0(e))=>n===2?e.get(t):e[t],bw=(e,t,n,s=s0(e))=>{s===2?e.set(t,n):s===3?e.add(n):e[t]=n};function v_e(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}var BN=Array.isArray,HN=e=>e instanceof Map,qN=e=>e instanceof Set,OD=e=>typeof e=="object",xf=e=>typeof e=="function",z_=e=>typeof e=="boolean";function w_e(e){const t=+e;return Number.isInteger(t)&&String(t)===e}var _l=e=>e.copy_||e.base_,MD=e=>e.modified_?e.copy_:e.base_;function cE(e,t){if(HN(e))return new Map(e);if(qN(e))return new Set(e);if(BN(e))return Array[UN].slice.call(e);const n=ZY(e);if(t===!0||t==="class_only"&&!n){const s=Rr.getOwnPropertyDescriptors(e);delete s[Qs];let r=Reflect.ownKeys(s);for(let i=0;i<r.length;i++){const o=r[i],l=s[o];l[wv]===!1&&(l[wv]=!0,l[oE]=!0),(l.get||l.set)&&(s[o]={[oE]:!0,[wv]:!0,[yw]:l[yw],[Up]:e[o]})}return Rr.create(Gf(e),s)}else{const s=Gf(e);if(s!==null&&n)return{...e};const r=Rr.create(s);return Rr.assign(r,e)}}function ID(e,t=!1){return GN(e)||Kl(e)||!to(e)||(s0(e)>1&&Rr.defineProperties(e,{set:cb,add:cb,clear:cb,delete:cb}),Rr.freeze(e),t&&n0(e,(n,s)=>{ID(s,!0)},!1)),e}function j_e(){Hi(2)}var cb={[Up]:j_e};function GN(e){return e===null||!OD(e)?!0:Rr.isFrozen(e)}var vw="MapSet",dE="Patches",zz="ArrayMethods",JY={};function Vu(e){const t=JY[e];return t||Hi(0,e),t}var Fz=e=>!!JY[e],Bp,eQ=()=>Bp,N_e=(e,t)=>({drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0,handledSet_:new Set,processedForPatches_:new Set,mapSetPlugin_:Fz(vw)?Vu(vw):void 0,arrayMethodsPlugin_:Fz(zz)?Vu(zz):void 0});function Uz(e,t){t&&(e.patchPlugin_=Vu(dE),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function uE(e){mE(e),e.drafts_.forEach(C_e),e.drafts_=null}function mE(e){e===Bp&&(Bp=e.parent_)}var Bz=e=>Bp=N_e(Bp,e);function C_e(e){const t=e[Qs];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function Hz(e,t){t.unfinalizedDrafts_=t.drafts_.length;const n=t.drafts_[0];if(e!==void 0&&e!==n){n[Qs].modified_&&(uE(t),Hi(4)),to(e)&&(e=qz(t,e));const{patchPlugin_:r}=t;r&&r.generateReplacementPatches_(n[Qs].base_,e,t)}else e=qz(t,n);return S_e(t,e,!0),uE(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==XY?e:void 0}function qz(e,t){if(GN(t))return t;const n=t[Qs];if(!n)return $D(t,e.handledSet_,e);if(!WN(n,e))return t;if(!n.modified_)return n.base_;if(!n.finalized_){const{callbacks_:s}=n;if(s)for(;s.length>0;)s.pop()(e);nQ(n,e)}return n.copy_}function S_e(e,t,n=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&ID(t,n)}function tQ(e){e.finalized_=!0,e.scope_.unfinalizedDrafts_--}var WN=(e,t)=>e.scope_===t,__e=[];function aQ(e,t,n,s){const r=_l(e),i=e.type_;if(s!==void 0&&lE(r,s,i)===t){bw(r,s,n,i);return}if(!e.draftLocations_){const l=e.draftLocations_=new Map;n0(r,(c,u)=>{if(Kl(u)){const d=l.get(u)||[];d.push(c),l.set(u,d)}})}const o=e.draftLocations_.get(t)??__e;for(const l of o)bw(r,l,n,i)}function A_e(e,t,n){e.callbacks_.push(function(r){const i=t;if(!i||!WN(i,r))return;r.mapSetPlugin_?.fixSetContents(i);const o=MD(i);aQ(e,i.draft_??i,o,n),nQ(i,r)})}function nQ(e,t){if(e.modified_&&!e.finalized_&&(e.type_===3||e.type_===1&&e.allIndicesReassigned_||(e.assigned_?.size??0)>0)){const{patchPlugin_:s}=t;if(s){const r=s.getPath(e);r&&s.generatePatches_(e,r,t)}tQ(e)}}function T_e(e,t,n){const{scope_:s}=e;if(Kl(n)){const r=n[Qs];WN(r,s)&&r.callbacks_.push(function(){jv(e);const o=MD(r);aQ(e,n,o,t)})}else to(n)&&e.callbacks_.push(function(){const i=_l(e);lE(i,t,e.type_)===n&&s.drafts_.length>1&&(e.assigned_.get(t)??!1)===!0&&e.copy_&&$D(lE(e.copy_,t,e.type_),s.handledSet_,s)})}function $D(e,t,n){return!n.immer_.autoFreeze_&&n.unfinalizedDrafts_<1||Kl(e)||t.has(e)||!to(e)||GN(e)||(t.add(e),n0(e,(s,r)=>{if(Kl(r)){const i=r[Qs];if(WN(i,n)){const o=MD(i);bw(e,s,o,e.type_),tQ(i)}}else to(r)&&$D(r,t,n)})),e}function k_e(e,t){const n=BN(e),s={type_:n?1:0,scope_:t?t.scope_:eQ(),modified_:!1,finalized_:!1,assigned_:void 0,parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1,callbacks_:void 0};let r=s,i=RD;n&&(r=[s],i=Hp);const{revoke:o,proxy:l}=Proxy.revocable(r,i);return s.draft_=l,s.revoke_=o,[l,s]}var RD={get(e,t){if(t===Qs)return e;let n=e.scope_.arrayMethodsPlugin_;const s=e.type_===1&&typeof t=="string";if(s&&n?.isArrayOperationMethod(t))return n.createMethodInterceptor(e,t);const r=_l(e);if(!Rz(r,t,e.type_))return E_e(e,r,t);const i=r[t];if(e.finalized_||!to(i)||s&&e.operationMethod&&n?.isMutatingArrayMethod(e.operationMethod)&&w_e(t))return i;if(i===F_(e.base_,t)){jv(e);const o=e.type_===1?+t:t,l=hE(e.scope_,i,e,o);return e.copy_[o]=l}return i},has(e,t){return t in _l(e)},ownKeys(e){return Reflect.ownKeys(_l(e))},set(e,t,n){const s=sQ(_l(e),t);if(s?.set)return s.set.call(e.draft_,n),!0;if(!e.modified_){const r=F_(_l(e),t),i=r?.[Qs];if(i&&i.base_===n)return e.copy_[t]=n,e.assigned_.set(t,!1),!0;if(v_e(n,r)&&(n!==void 0||Rz(e.base_,t,e.type_)))return!0;jv(e),fE(e)}return e.copy_[t]===n&&(n!==void 0||t in e.copy_)||Number.isNaN(n)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=n,e.assigned_.set(t,!0),T_e(e,t,n)),!0},deleteProperty(e,t){return jv(e),F_(e.base_,t)!==void 0||t in e.base_?(e.assigned_.set(t,!1),fE(e)):e.assigned_.delete(t),e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const n=_l(e),s=Reflect.getOwnPropertyDescriptor(n,t);return s&&{[wv]:!0,[oE]:e.type_!==1||t!=="length",[yw]:s[yw],[Up]:n[t]}},defineProperty(){Hi(11)},getPrototypeOf(e){return Gf(e.base_)},setPrototypeOf(){Hi(12)}},Hp={};n0(RD,(e,t)=>{Hp[e]=function(){const n=arguments;return n[0]=n[0][0],t.apply(this,n)}});Hp.deleteProperty=function(e,t){return Hp.set.call(this,e,t,void 0)};Hp.set=function(e,t,n){return RD.set.call(this,e[0],t,n,e[0])};function F_(e,t){const n=e[Qs];return(n?_l(n):e)[t]}function E_e(e,t,n){const s=sQ(t,n);return s?Up in s?s[Up]:s.get?.call(e.draft_):void 0}function sQ(e,t){if(!(t in e))return;let n=Gf(e);for(;n;){const s=Object.getOwnPropertyDescriptor(n,t);if(s)return s;n=Gf(n)}}function fE(e){e.modified_||(e.modified_=!0,e.parent_&&fE(e.parent_))}function jv(e){e.copy_||(e.assigned_=new Map,e.copy_=cE(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var L_e=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!1,this.produce=(n,s,r)=>{if(xf(n)&&!xf(s)){const o=s;s=n;const l=this;return function(u=o,...d){return l.produce(u,h=>s.call(this,h,...d))}}xf(s)||Hi(6),r!==void 0&&!xf(r)&&Hi(7);let i;if(to(n)){const o=Bz(this),l=hE(o,n,void 0);let c=!0;try{i=s(l),c=!1}finally{c?uE(o):mE(o)}return Uz(o,r),Hz(i,o)}else if(!n||!OD(n)){if(i=s(n),i===void 0&&(i=n),i===XY&&(i=void 0),this.autoFreeze_&&ID(i,!0),r){const o=[],l=[];Vu(dE).generateReplacementPatches_(n,i,{patches_:o,inversePatches_:l}),r(o,l)}return i}else Hi(1,n)},this.produceWithPatches=(n,s)=>{if(xf(n))return(l,...c)=>this.produceWithPatches(l,u=>n(u,...c));let r,i;return[this.produce(n,s,(l,c)=>{r=l,i=c}),r,i]},z_(t?.autoFreeze)&&this.setAutoFreeze(t.autoFreeze),z_(t?.useStrictShallowCopy)&&this.setUseStrictShallowCopy(t.useStrictShallowCopy),z_(t?.useStrictIteration)&&this.setUseStrictIteration(t.useStrictIteration)}createDraft(t){to(t)||Hi(8),Kl(t)&&(t=Vi(t));const n=Bz(this),s=hE(n,t,void 0);return s[Qs].isManual_=!0,mE(n),s}finishDraft(t,n){const s=t&&t[Qs];(!s||!s.isManual_)&&Hi(9);const{scope_:r}=s;return Uz(r,n),Hz(void 0,r)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}setUseStrictIteration(t){this.useStrictIteration_=t}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(t,n){let s;for(s=n.length-1;s>=0;s--){const i=n[s];if(i.path.length===0&&i.op==="replace"){t=i.value;break}}s>-1&&(n=n.slice(s+1));const r=Vu(dE).applyPatches_;return Kl(t)?r(t,n):this.produce(t,i=>r(i,n))}};function hE(e,t,n,s){const[r,i]=HN(t)?Vu(vw).proxyMap_(t,n):qN(t)?Vu(vw).proxySet_(t,n):k_e(t,n);return(n?.scope_??eQ()).drafts_.push(r),i.callbacks_=n?.callbacks_??[],i.key_=s,n&&s!==void 0?A_e(n,i,s):i.callbacks_.push(function(c){c.mapSetPlugin_?.fixSetContents(i);const{patchPlugin_:u}=c;i.modified_&&u&&u.generatePatches_(i,[],c)}),r}function Vi(e){return Kl(e)||Hi(10,e),rQ(e)}function rQ(e){if(!to(e)||GN(e))return e;const t=e[Qs];let n,s=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,n=cE(e,t.scope_.immer_.useStrictShallowCopy_),s=t.scope_.immer_.shouldUseStrictIteration()}else n=cE(e,!0);return n0(n,(r,i)=>{bw(n,r,rQ(i))},s),t&&(t.finalized_=!1),n}var D_e=new L_e,iQ=D_e.produce;function oQ(e){return({dispatch:n,getState:s})=>r=>i=>typeof i=="function"?i(n,s,e):r(i)}var P_e=oQ(),O_e=oQ,M_e=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?pw:pw.apply(null,arguments)};function ji(e,t){function n(...s){if(t){let r=t(...s);if(!r)throw new Error(Ur(0));return{type:e,payload:r.payload,..."meta"in r&&{meta:r.meta},..."error"in r&&{error:r.error}}}return{type:e,payload:s[0]}}return n.toString=()=>`${e}`,n.type=e,n.match=s=>KY(s)&&s.type===e,n}var lQ=class Xg extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,Xg.prototype)}static get[Symbol.species](){return Xg}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new Xg(...t[0].concat(this)):new Xg(...t.concat(this))}};function Gz(e){return to(e)?iQ(e,()=>{}):e}function db(e,t,n){return e.has(t)?e.get(t):e.set(t,n(t)).get(t)}function I_e(e){return typeof e=="boolean"}var $_e=()=>function(t){const{thunk:n=!0,immutableCheck:s=!0,serializableCheck:r=!0,actionCreatorCheck:i=!0}=t??{};let o=new lQ;return n&&(I_e(n)?o.push(P_e):o.push(O_e(n.extraArgument))),o},cQ="RTK_autoBatch",cn=()=>e=>({payload:e,meta:{[cQ]:!0}}),Wz=e=>t=>{setTimeout(t,e)},dQ=(e={type:"raf"})=>t=>(...n)=>{const s=t(...n);let r=!0,i=!1,o=!1;const l=new Set,c=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:Wz(10):e.type==="callback"?e.queueNotification:Wz(e.timeout),u=()=>{o=!1,i&&(i=!1,l.forEach(d=>d()))};return Object.assign({},s,{subscribe(d){const h=()=>r&&d(),p=s.subscribe(h);return l.add(d),()=>{p(),l.delete(d)}},dispatch(d){try{return r=!d?.meta?.[cQ],i=!r,i&&(o||(o=!0,c(u))),s.dispatch(d)}finally{r=!0}}})},R_e=e=>function(n){const{autoBatch:s=!0}=n??{};let r=new lQ(e);return s&&r.push(dQ(typeof s=="object"?s:void 0)),r};function z_e(e){const t=$_e(),{reducer:n=void 0,middleware:s,devTools:r=!0,preloadedState:i=void 0,enhancers:o=void 0}=e||{};let l;if(typeof n=="function")l=n;else if(PD(n))l=QY(n);else throw new Error(Ur(1));let c;typeof s=="function"?c=s(t):c=t();let u=pw;r&&(u=M_e({trace:!1,...typeof r=="object"&&r}));const d=y_e(...c),h=R_e(d);let p=typeof o=="function"?o(h):h();const x=u(...p);return YY(l,i,x)}function uQ(e){const t={},n=[];let s;const r={addCase(i,o){const l=typeof i=="string"?i:i.type;if(!l)throw new Error(Ur(28));if(l in t)throw new Error(Ur(29));return t[l]=o,r},addAsyncThunk(i,o){return o.pending&&(t[i.pending.type]=o.pending),o.rejected&&(t[i.rejected.type]=o.rejected),o.fulfilled&&(t[i.fulfilled.type]=o.fulfilled),o.settled&&n.push({matcher:i.settled,reducer:o.settled}),r},addMatcher(i,o){return n.push({matcher:i,reducer:o}),r},addDefaultCase(i){return s=i,r}};return e(r),[t,n,s]}function F_e(e){return typeof e=="function"}function U_e(e,t){let[n,s,r]=uQ(t),i;if(F_e(e))i=()=>Gz(e());else{const l=Gz(e);i=()=>l}function o(l=i(),c){let u=[n[c.type],...s.filter(({matcher:d})=>d(c)).map(({reducer:d})=>d)];return u.filter(d=>!!d).length===0&&(u=[r]),u.reduce((d,h)=>{if(h)if(Kl(d)){const x=h(d,c);return x===void 0?d:x}else{if(to(d))return iQ(d,p=>h(p,c));{const p=h(d,c);if(p===void 0){if(d===null)return d;throw Error("A case reducer on a non-draftable value must not return undefined")}return p}}return d},l)}return o.getInitialState=i,o}var B_e="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",H_e=(e=21)=>{let t="",n=e;for(;n--;)t+=B_e[Math.random()*64|0];return t},q_e=Symbol.for("rtk-slice-createasyncthunk");function G_e(e,t){return`${e}/${t}`}function W_e({creators:e}={}){const t=e?.asyncThunk?.[q_e];return function(s){const{name:r,reducerPath:i=r}=s;if(!r)throw new Error(Ur(11));const o=(typeof s.reducers=="function"?s.reducers(Y_e()):s.reducers)||{},l=Object.keys(o),c={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},u={addCase(S,_){const T=typeof S=="string"?S:S.type;if(!T)throw new Error(Ur(12));if(T in c.sliceCaseReducersByType)throw new Error(Ur(13));return c.sliceCaseReducersByType[T]=_,u},addMatcher(S,_){return c.sliceMatchers.push({matcher:S,reducer:_}),u},exposeAction(S,_){return c.actionCreators[S]=_,u},exposeCaseReducer(S,_){return c.sliceCaseReducersByName[S]=_,u}};l.forEach(S=>{const _=o[S],T={reducerName:S,type:G_e(r,S),createNotation:typeof s.reducers=="function"};K_e(_)?Z_e(T,_,u,t):Q_e(T,_,u)});function d(){const[S={},_=[],T=void 0]=typeof s.extraReducers=="function"?uQ(s.extraReducers):[s.extraReducers],k={...S,...c.sliceCaseReducersByType};return U_e(s.initialState,A=>{for(let E in k)A.addCase(E,k[E]);for(let E of c.sliceMatchers)A.addMatcher(E.matcher,E.reducer);for(let E of _)A.addMatcher(E.matcher,E.reducer);T&&A.addDefaultCase(T)})}const h=S=>S,p=new Map,x=new WeakMap;let b;function j(S,_){return b||(b=d()),b(S,_)}function y(){return b||(b=d()),b.getInitialState()}function N(S,_=!1){function T(A){let E=A[S];return typeof E>"u"&&_&&(E=db(x,T,y)),E}function k(A=h){const E=db(p,_,()=>new WeakMap);return db(E,A,()=>{const M={};for(const[F,D]of Object.entries(s.selectors??{}))M[F]=V_e(D,A,()=>db(x,A,y),_);return M})}return{reducerPath:S,getSelectors:k,get selectors(){return k(T)},selectSlice:T}}const w={name:r,reducer:j,actions:c.actionCreators,caseReducers:c.sliceCaseReducersByName,getInitialState:y,...N(i),injectInto(S,{reducerPath:_,...T}={}){const k=_??i;return S.inject({reducerPath:k,reducer:j},T),{...w,...N(k,!0)}}};return w}}function V_e(e,t,n,s){function r(i,...o){let l=t(i);return typeof l>"u"&&s&&(l=n()),e(l,...o)}return r.unwrapped=e,r}var Cr=W_e();function Y_e(){function e(t,n){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...n}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...n){return t(...n)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,n){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:n}},asyncThunk:e}}function Q_e({type:e,reducerName:t,createNotation:n},s,r){let i,o;if("reducer"in s){if(n&&!X_e(s))throw new Error(Ur(17));i=s.reducer,o=s.prepare}else i=s;r.addCase(e,i).exposeCaseReducer(t,i).exposeAction(t,o?ji(e,o):ji(e))}function K_e(e){return e._reducerDefinitionType==="asyncThunk"}function X_e(e){return e._reducerDefinitionType==="reducerWithPrepare"}function Z_e({type:e,reducerName:t},n,s,r){if(!r)throw new Error(Ur(18));const{payloadCreator:i,fulfilled:o,pending:l,rejected:c,settled:u,options:d}=n,h=r(e,i,d);s.exposeAction(t,h),o&&s.addCase(h.fulfilled,o),l&&s.addCase(h.pending,l),c&&s.addCase(h.rejected,c),u&&s.addMatcher(h.settled,u),s.exposeCaseReducer(t,{fulfilled:o||ub,pending:l||ub,rejected:c||ub,settled:u||ub})}function ub(){}var J_e="task",mQ="listener",fQ="completed",zD="cancelled",eAe=`task-${zD}`,tAe=`task-${fQ}`,gE=`${mQ}-${zD}`,aAe=`${mQ}-${fQ}`,VN=class{constructor(e){this.code=e,this.message=`${J_e} ${zD} (reason: ${e})`}name="TaskAbortError";message},FD=(e,t)=>{if(typeof e!="function")throw new TypeError(Ur(32))},ww=()=>{},hQ=(e,t=ww)=>(e.catch(t),e),gQ=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),Du=e=>{if(e.aborted)throw new VN(e.reason)};function pQ(e,t){let n=ww;return new Promise((s,r)=>{const i=()=>r(new VN(e.reason));if(e.aborted){i();return}n=gQ(e,i),t.finally(()=>n()).then(s,r)}).finally(()=>{n=ww})}var nAe=async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(n){return{status:n instanceof VN?"cancelled":"rejected",error:n}}finally{t?.()}},jw=e=>t=>hQ(pQ(e,t).then(n=>(Du(e),n))),xQ=e=>{const t=jw(e);return n=>t(new Promise(s=>setTimeout(s,n)))},{assign:Af}=Object,Vz={},YN="listenerMiddleware",sAe=(e,t)=>{const n=s=>gQ(e,()=>s.abort(e.reason));return(s,r)=>{FD(s);const i=new AbortController;n(i);const o=nAe(async()=>{Du(e),Du(i.signal);const l=await s({pause:jw(i.signal),delay:xQ(i.signal),signal:i.signal});return Du(i.signal),l},()=>i.abort(tAe));return r?.autoJoin&&t.push(o.catch(ww)),{result:jw(e)(o),cancel(){i.abort(eAe)}}}},rAe=(e,t)=>{const n=async(s,r)=>{Du(t);let i=()=>{};const l=[new Promise((c,u)=>{let d=e({predicate:s,effect:(h,p)=>{p.unsubscribe(),c([h,p.getState(),p.getOriginalState()])}});i=()=>{d(),u()}})];r!=null&&l.push(new Promise(c=>setTimeout(c,r,null)));try{const c=await pQ(t,Promise.race(l));return Du(t),c}finally{i()}};return(s,r)=>hQ(n(s,r))},yQ=e=>{let{type:t,actionCreator:n,matcher:s,predicate:r,effect:i}=e;if(t)r=ji(t).match;else if(n)t=n.type,r=n.match;else if(s)r=s;else if(!r)throw new Error(Ur(21));return FD(i),{predicate:r,type:t,effect:i}},bQ=Af(e=>{const{type:t,predicate:n,effect:s}=yQ(e);return{id:H_e(),effect:s,type:t,predicate:n,pending:new Set,unsubscribe:()=>{throw new Error(Ur(22))}}},{withTypes:()=>bQ}),Yz=(e,t)=>{const{type:n,effect:s,predicate:r}=yQ(t);return Array.from(e.values()).find(i=>(typeof n=="string"?i.type===n:i.predicate===r)&&i.effect===s)},pE=e=>{e.pending.forEach(t=>{t.abort(gE)})},iAe=(e,t)=>()=>{for(const n of t.keys())pE(n);e.clear()},Qz=(e,t,n)=>{try{e(t,n)}catch(s){setTimeout(()=>{throw s},0)}},vQ=Af(ji(`${YN}/add`),{withTypes:()=>vQ}),oAe=ji(`${YN}/removeAll`),wQ=Af(ji(`${YN}/remove`),{withTypes:()=>wQ}),lAe=(...e)=>{console.error(`${YN}/error`,...e)},r0=(e={})=>{const t=new Map,n=new Map,s=x=>{const b=n.get(x)??0;n.set(x,b+1)},r=x=>{const b=n.get(x)??1;b===1?n.delete(x):n.set(x,b-1)},{extra:i,onError:o=lAe}=e;FD(o);const l=x=>(x.unsubscribe=()=>t.delete(x.id),t.set(x.id,x),b=>{x.unsubscribe(),b?.cancelActive&&pE(x)}),c=x=>{const b=Yz(t,x)??bQ(x);return l(b)};Af(c,{withTypes:()=>c});const u=x=>{const b=Yz(t,x);return b&&(b.unsubscribe(),x.cancelActive&&pE(b)),!!b};Af(u,{withTypes:()=>u});const d=async(x,b,j,y)=>{const N=new AbortController,w=rAe(c,N.signal),S=[];try{x.pending.add(N),s(x),await Promise.resolve(x.effect(b,Af({},j,{getOriginalState:y,condition:(_,T)=>w(_,T).then(Boolean),take:w,delay:xQ(N.signal),pause:jw(N.signal),extra:i,signal:N.signal,fork:sAe(N.signal,S),unsubscribe:x.unsubscribe,subscribe:()=>{t.set(x.id,x)},cancelActiveListeners:()=>{x.pending.forEach((_,T,k)=>{_!==N&&(_.abort(gE),k.delete(_))})},cancel:()=>{N.abort(gE),x.pending.delete(N)},throwIfCancelled:()=>{Du(N.signal)}})))}catch(_){_ instanceof VN||Qz(o,_,{raisedBy:"effect"})}finally{await Promise.all(S),N.abort(aAe),r(x),x.pending.delete(N)}},h=iAe(t,n);return{middleware:x=>b=>j=>{if(!KY(j))return b(j);if(vQ.match(j))return c(j.payload);if(oAe.match(j)){h();return}if(wQ.match(j))return u(j.payload);let y=x.getState();const N=()=>{if(y===Vz)throw new Error(Ur(23));return y};let w;try{if(w=b(j),t.size>0){const S=x.getState(),_=Array.from(t.values());for(const T of _){let k=!1;try{k=T.predicate(j,S,y)}catch(A){k=!1,Qz(o,A,{raisedBy:"predicate"})}k&&d(T,j,x,N)}}}finally{y=Vz}return w},startListening:c,stopListening:u,clearListeners:h}};function Ur(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var cAe={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},jQ=Cr({name:"chartLayout",initialState:cAe,reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){var n,s,r,i;e.margin.top=(n=t.payload.top)!==null&&n!==void 0?n:0,e.margin.right=(s=t.payload.right)!==null&&s!==void 0?s:0,e.margin.bottom=(r=t.payload.bottom)!==null&&r!==void 0?r:0,e.margin.left=(i=t.payload.left)!==null&&i!==void 0?i:0},setScale(e,t){e.scale=t.payload}}}),{setMargin:dAe,setLayout:uAe,setChartSize:mAe,setScale:fAe}=jQ.actions,hAe=jQ.reducer;function NQ(e,t,n){return Array.isArray(e)&&e&&t+n!==0?e.slice(t,n+1):e}function xn(e){return Number.isFinite(e)}function qo(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function Kz(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function bf(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Kz(Object(n),!0).forEach(function(s){gAe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Kz(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function gAe(e,t,n){return(t=pAe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function pAe(e){var t=xAe(e,"string");return typeof t=="symbol"?t:t+""}function xAe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ga(e,t,n){return fn(e)||fn(t)?n:Ho(t)?Wu(e,t,n):typeof t=="function"?t(e):n}var yAe=(e,t,n)=>{if(t&&n){var{width:s,height:r}=n,{align:i,verticalAlign:o,layout:l}=t;if((l==="vertical"||l==="horizontal"&&o==="middle")&&i!=="center"&&Ut(e[i]))return bf(bf({},e),{},{[i]:e[i]+(s||0)});if((l==="horizontal"||l==="vertical"&&i==="center")&&o!=="middle"&&Ut(e[o]))return bf(bf({},e),{},{[o]:e[o]+(r||0)})}return e},Ld=(e,t)=>e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis",CQ=(e,t,n,s)=>{if(s)return e.map(l=>l.coordinate);var r,i,o=e.map(l=>(l.coordinate===t&&(r=!0),l.coordinate===n&&(i=!0),l.coordinate));return r||o.push(t),i||o.push(n),o},SQ=(e,t,n)=>{if(!e)return null;var{duplicateDomain:s,type:r,range:i,scale:o,realScaleType:l,isCategorical:c,categoricalDomain:u,tickCount:d,ticks:h,niceTicks:p,axisType:x}=e;if(!o)return null;var b=l==="scaleBand"&&o.bandwidth?o.bandwidth()/2:2,j=r==="category"&&o.bandwidth?o.bandwidth()/b:0;if(j=x==="angleAxis"&&i&&i.length>=2?bs(i[0]-i[1])*2*j:j,h||p){var y=(h||p||[]).map((N,w)=>{var S=s?s.indexOf(N):N;return{coordinate:o(S)+j,value:N,offset:j,index:w}});return y.filter(N=>!eo(N.coordinate))}return c&&u?u.map((N,w)=>({coordinate:o(N)+j,value:N,index:w,offset:j})):o.ticks&&d!=null?o.ticks(d).map((N,w)=>({coordinate:o(N)+j,value:N,offset:j,index:w})):o.domain().map((N,w)=>({coordinate:o(N)+j,value:s?s[N]:N,index:w,offset:j}))},Xz=1e-4,bAe=e=>{var t=e.domain();if(!(!t||t.length<=2)){var n=t.length,s=e.range(),r=Math.min(s[0],s[1])-Xz,i=Math.max(s[0],s[1])+Xz,o=e(t[0]),l=e(t[n-1]);(o<r||o>i||l<r||l>i)&&e.domain([t[0],t[n-1]])}},vAe=(e,t)=>{if(!t||t.length!==2||!Ut(t[0])||!Ut(t[1]))return e;var n=Math.min(t[0],t[1]),s=Math.max(t[0],t[1]),r=[e[0],e[1]];return(!Ut(e[0])||e[0]<n)&&(r[0]=n),(!Ut(e[1])||e[1]>s)&&(r[1]=s),r[0]>s&&(r[0]=s),r[1]<n&&(r[1]=n),r},wAe=e=>{var t,n=e.length;if(!(n<=0)){var s=(t=e[0])===null||t===void 0?void 0:t.length;if(!(s==null||s<=0))for(var r=0;r<s;++r)for(var i=0,o=0,l=0;l<n;++l){var c=e[l],u=c?.[r];if(u!=null){var d=u[1],h=u[0],p=eo(d)?h:d;p>=0?(u[0]=i,u[1]=i+p,i=d):(u[0]=o,u[1]=o+p,o=d)}}}},jAe=e=>{var t,n=e.length;if(!(n<=0)){var s=(t=e[0])===null||t===void 0?void 0:t.length;if(!(s==null||s<=0))for(var r=0;r<s;++r)for(var i=0,o=0;o<n;++o){var l=e[o],c=l?.[r];if(c!=null){var u=eo(c[1])?c[0]:c[1];u>=0?(c[0]=i,c[1]=i+u,i=c[1]):(c[0]=0,c[1]=0)}}}},NAe={sign:wAe,expand:SW,none:hd,silhouette:_W,wiggle:AW,positive:jAe},CAe=(e,t,n)=>{var s,r=(s=NAe[n])!==null&&s!==void 0?s:hd,i=H4().keys(t).value((l,c)=>Number(Ga(l,c,0))).order(Bu).offset(r),o=i(e);return o.forEach((l,c)=>{l.forEach((u,d)=>{var h=Ga(e[d],t[c],0);Array.isArray(h)&&h.length===2&&Ut(h[0])&&Ut(h[1])&&(u[0]=h[0],u[1]=h[1])})}),o};function SAe(e){return e==null?void 0:String(e)}function Zz(e){var{axis:t,ticks:n,bandSize:s,entry:r,index:i,dataKey:o}=e;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!fn(r[t.dataKey])){var l=LY(n,"value",r[t.dataKey]);if(l)return l.coordinate+s/2}return n[i]?n[i].coordinate+s/2:null}var c=Ga(r,fn(o)?t.dataKey:o);return fn(c)?null:t.scale(c)}var Jz=e=>{var{axis:t,ticks:n,offset:s,bandSize:r,entry:i,index:o}=e;if(t.type==="category")return n[o]?n[o].coordinate+s:null;var l=Ga(i,t.dataKey,t.scale.domain()[o]);return fn(l)?null:t.scale(l)-r/2+s},_Ae=e=>{var{numericAxis:t}=e,n=t.scale.domain();if(t.type==="number"){var s=Math.min(n[0],n[1]),r=Math.max(n[0],n[1]);return s<=0&&r>=0?0:r<0?r:s}return n[0]},AAe=e=>{var t=e.flat(2).filter(Ut);return[Math.min(...t),Math.max(...t)]},TAe=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],kAe=(e,t,n)=>{if(e!=null)return TAe(Object.keys(e).reduce((s,r)=>{var i=e[r];if(!i)return s;var{stackedData:o}=i,l=o.reduce((c,u)=>{var d=NQ(u,t,n),h=AAe(d);return!xn(h[0])||!xn(h[1])?c:[Math.min(c[0],h[0]),Math.max(c[1],h[1])]},[1/0,-1/0]);return[Math.min(l[0],s[0]),Math.max(l[1],s[1])]},[1/0,-1/0]))},eF=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,tF=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Wf=(e,t,n)=>{if(e&&e.scale&&e.scale.bandwidth){var s=e.scale.bandwidth();if(!n||s>0)return s}if(e&&t&&t.length>=2){for(var r=FN(t,d=>d.coordinate),i=1/0,o=1,l=r.length;o<l;o++){var c=r[o],u=r[o-1];i=Math.min((c?.coordinate||0)-(u?.coordinate||0),i)}return i===1/0?0:i}return n?void 0:0};function aF(e){var{tooltipEntrySettings:t,dataKey:n,payload:s,value:r,name:i}=e;return bf(bf({},t),{},{dataKey:n,payload:s,value:r,name:i})}function xh(e,t){if(e)return String(e);if(typeof t=="string")return t}var EAe=(e,t)=>{if(t==="horizontal")return e.chartX;if(t==="vertical")return e.chartY},LAe=(e,t)=>t==="centric"?e.angle:e.radius,oc=e=>e.layout.width,lc=e=>e.layout.height,DAe=e=>e.layout.scale,_Q=e=>e.layout.margin,QN=dt(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),KN=dt(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),AQ="data-recharts-item-index",TQ="data-recharts-item-id",i0=60;function nF(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function mb(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?nF(Object(n),!0).forEach(function(s){PAe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nF(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function PAe(e,t,n){return(t=OAe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function OAe(e){var t=MAe(e,"string");return typeof t=="symbol"?t:t+""}function MAe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var IAe=e=>e.brush.height;function $Ae(e){var t=KN(e);return t.reduce((n,s)=>{if(s.orientation==="left"&&!s.mirror&&!s.hide){var r=typeof s.width=="number"?s.width:i0;return n+r}return n},0)}function RAe(e){var t=KN(e);return t.reduce((n,s)=>{if(s.orientation==="right"&&!s.mirror&&!s.hide){var r=typeof s.width=="number"?s.width:i0;return n+r}return n},0)}function zAe(e){var t=QN(e);return t.reduce((n,s)=>s.orientation==="top"&&!s.mirror&&!s.hide?n+s.height:n,0)}function FAe(e){var t=QN(e);return t.reduce((n,s)=>s.orientation==="bottom"&&!s.mirror&&!s.hide?n+s.height:n,0)}var ds=dt([oc,lc,_Q,IAe,$Ae,RAe,zAe,FAe,WY,u_e],(e,t,n,s,r,i,o,l,c,u)=>{var d={left:(n.left||0)+r,right:(n.right||0)+i},h={top:(n.top||0)+o,bottom:(n.bottom||0)+l},p=mb(mb({},h),d),x=p.bottom;p.bottom+=s,p=yAe(p,c,u);var b=e-p.left-p.right,j=t-p.top-p.bottom;return mb(mb({brushBottom:x},p),{},{width:Math.max(b,0),height:Math.max(j,0)})}),UAe=dt(ds,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),UD=dt(oc,lc,(e,t)=>({x:0,y:0,width:e,height:t})),BAe=f.createContext(null),Hs=()=>f.useContext(BAe)!=null,XN=e=>e.brush,ZN=dt([XN,ds,_Q],(e,t,n)=>({height:e.height,x:Ut(e.x)?e.x:t.left,y:Ut(e.y)?e.y:t.top+t.height+t.brushBottom-(n?.bottom||0),width:Ut(e.width)?e.width:t.width})),U_={},B_={},H_={},sF;function HAe(){return sF||(sF=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n,s,{signal:r,edges:i}={}){let o,l=null;const c=i!=null&&i.includes("leading"),u=i==null||i.includes("trailing"),d=()=>{l!==null&&(n.apply(o,l),o=void 0,l=null)},h=()=>{u&&d(),j()};let p=null;const x=()=>{p!=null&&clearTimeout(p),p=setTimeout(()=>{p=null,h()},s)},b=()=>{p!==null&&(clearTimeout(p),p=null)},j=()=>{b(),o=void 0,l=null},y=()=>{d()},N=function(...w){if(r?.aborted)return;o=this,l=w;const S=p==null;x(),c&&S&&d()};return N.schedule=x,N.cancel=j,N.flush=y,r?.addEventListener("abort",j,{once:!0}),N}e.debounce=t})(H_)),H_}var rF;function qAe(){return rF||(rF=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=HAe();function n(s,r=0,i={}){typeof i!="object"&&(i={});const{leading:o=!1,trailing:l=!0,maxWait:c}=i,u=Array(2);o&&(u[0]="leading"),l&&(u[1]="trailing");let d,h=null;const p=t.debounce(function(...j){d=s.apply(this,j),h=null},r,{edges:u}),x=function(...j){return c!=null&&(h===null&&(h=Date.now()),Date.now()-h>=c)?(d=s.apply(this,j),h=Date.now(),p.cancel(),p.schedule(),d):(p.apply(this,j),d)},b=()=>(p.flush(),d);return x.cancel=p.cancel,x.flush=b,x}e.debounce=n})(B_)),B_}var iF;function GAe(){return iF||(iF=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=qAe();function n(s,r=0,i={}){const{leading:o=!0,trailing:l=!0}=i;return t.debounce(s,r,{leading:o,maxWait:r,trailing:l})}e.throttle=n})(U_)),U_}var q_,oF;function WAe(){return oF||(oF=1,q_=GAe().throttle),q_}var VAe=WAe();const YAe=ao(VAe);var Nw=function(t,n){for(var s=arguments.length,r=new Array(s>2?s-2:0),i=2;i<s;i++)r[i-2]=arguments[i];if(typeof console<"u"&&console.warn&&(n===void 0&&console.warn("LogUtils requires an error message argument"),!t))if(n===void 0)console.warn("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var o=0;console.warn(n.replace(/%s/g,()=>r[o++]))}},kQ=(e,t,n)=>{var{width:s="100%",height:r="100%",aspect:i,maxHeight:o}=n,l=Ql(s)?e:Number(s),c=Ql(r)?t:Number(r);return i&&i>0&&(l?c=l/i:c&&(l=c*i),o&&c!=null&&c>o&&(c=o)),{calculatedWidth:l,calculatedHeight:c}},QAe={width:0,height:0,overflow:"visible"},KAe={width:0,overflowX:"visible"},XAe={height:0,overflowY:"visible"},ZAe={},JAe=e=>{var{width:t,height:n}=e,s=Ql(t),r=Ql(n);return s&&r?QAe:s?KAe:r?XAe:ZAe};function eTe(e){var{width:t,height:n,aspect:s}=e,r=t,i=n;return r===void 0&&i===void 0?(r="100%",i="100%"):r===void 0?r=s&&s>0?void 0:"100%":i===void 0&&(i=s&&s>0?void 0:"100%"),{width:r,height:i}}function xE(){return xE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},xE.apply(null,arguments)}function lF(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function cF(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?lF(Object(n),!0).forEach(function(s){tTe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):lF(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function tTe(e,t,n){return(t=aTe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function aTe(e){var t=nTe(e,"string");return typeof t=="symbol"?t:t+""}function nTe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var EQ=f.createContext({width:-1,height:-1});function sTe(e){return qo(e.width)&&qo(e.height)}function LQ(e){var{children:t,width:n,height:s}=e,r=f.useMemo(()=>({width:n,height:s}),[n,s]);return sTe(r)?f.createElement(EQ.Provider,{value:r},t):null}var BD=()=>f.useContext(EQ),rTe=f.forwardRef((e,t)=>{var{aspect:n,initialDimension:s={width:-1,height:-1},width:r,height:i,minWidth:o=0,minHeight:l,maxHeight:c,children:u,debounce:d=0,id:h,className:p,onResize:x,style:b={}}=e,j=f.useRef(null),y=f.useRef();y.current=x,f.useImperativeHandle(t,()=>j.current);var[N,w]=f.useState({containerWidth:s.width,containerHeight:s.height}),S=f.useCallback((E,M)=>{w(F=>{var D=Math.round(E),P=Math.round(M);return F.containerWidth===D&&F.containerHeight===P?F:{containerWidth:D,containerHeight:P}})},[]);f.useEffect(()=>{if(j.current==null||typeof ResizeObserver>"u")return t0;var E=P=>{var B,{width:G,height:$}=P[0].contentRect;S(G,$),(B=y.current)===null||B===void 0||B.call(y,G,$)};d>0&&(E=YAe(E,d,{trailing:!0,leading:!1}));var M=new ResizeObserver(E),{width:F,height:D}=j.current.getBoundingClientRect();return S(F,D),M.observe(j.current),()=>{M.disconnect()}},[S,d]);var{containerWidth:_,containerHeight:T}=N;Nw(!n||n>0,"The aspect(%s) must be greater than zero.",n);var{calculatedWidth:k,calculatedHeight:A}=kQ(_,T,{width:r,height:i,aspect:n,maxHeight:c});return Nw(k!=null&&k>0||A!=null&&A>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,k,A,r,i,o,l,n),f.createElement("div",{id:h?"".concat(h):void 0,className:Rt("recharts-responsive-container",p),style:cF(cF({},b),{},{width:r,height:i,minWidth:o,minHeight:l,maxHeight:c}),ref:j},f.createElement("div",{style:JAe({width:r,height:i})},f.createElement(LQ,{width:k,height:A},u)))}),G_=f.forwardRef((e,t)=>{var n=BD();if(qo(n.width)&&qo(n.height))return e.children;var{width:s,height:r}=eTe({width:e.width,height:e.height,aspect:e.aspect}),{calculatedWidth:i,calculatedHeight:o}=kQ(void 0,void 0,{width:s,height:r,aspect:e.aspect,maxHeight:e.maxHeight});return Ut(i)&&Ut(o)?f.createElement(LQ,{width:i,height:o},e.children):f.createElement(rTe,xE({},e,{width:s,height:r,ref:t}))});function DQ(e){if(e)return{x:e.x,y:e.y,upperWidth:"upperWidth"in e?e.upperWidth:e.width,lowerWidth:"lowerWidth"in e?e.lowerWidth:e.width,width:e.width,height:e.height}}var JN=()=>{var e,t=Hs(),n=Bt(UAe),s=Bt(ZN),r=(e=Bt(XN))===null||e===void 0?void 0:e.padding;return!t||!s||!r?n:{width:s.width-r.left-r.right,height:s.height-r.top-r.bottom,x:r.left,y:r.top}},iTe={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},PQ=()=>{var e;return(e=Bt(ds))!==null&&e!==void 0?e:iTe},HD=()=>Bt(oc),qD=()=>Bt(lc),oTe=()=>Bt(e=>e.layout.margin),wa=e=>e.layout.layoutType,yh=()=>Bt(wa),lTe=()=>{var e=yh();return e!==void 0},e1=e=>{var t=Ja(),n=Hs(),{width:s,height:r}=e,i=BD(),o=s,l=r;return i&&(o=i.width>0?i.width:s,l=i.height>0?i.height:r),f.useEffect(()=>{!n&&qo(o)&&qo(l)&&t(mAe({width:o,height:l}))},[t,n,o,l]),null},OQ=Symbol.for("immer-nothing"),dF=Symbol.for("immer-draftable"),Gr=Symbol.for("immer-state");function qi(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var qp=Object.getPrototypeOf;function Vf(e){return!!e&&!!e[Gr]}function Yu(e){return e?MQ(e)||Array.isArray(e)||!!e[dF]||!!e.constructor?.[dF]||o0(e)||a1(e):!1}var cTe=Object.prototype.constructor.toString(),uF=new WeakMap;function MQ(e){if(!e||typeof e!="object")return!1;const t=Object.getPrototypeOf(e);if(t===null||t===Object.prototype)return!0;const n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;if(n===Object)return!0;if(typeof n!="function")return!1;let s=uF.get(n);return s===void 0&&(s=Function.toString.call(n),uF.set(n,s)),s===cTe}function Cw(e,t,n=!0){t1(e)===0?(n?Reflect.ownKeys(e):Object.keys(e)).forEach(r=>{t(r,e[r],e)}):e.forEach((s,r)=>t(r,s,e))}function t1(e){const t=e[Gr];return t?t.type_:Array.isArray(e)?1:o0(e)?2:a1(e)?3:0}function yE(e,t){return t1(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function IQ(e,t,n){const s=t1(e);s===2?e.set(t,n):s===3?e.add(n):e[t]=n}function dTe(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function o0(e){return e instanceof Map}function a1(e){return e instanceof Set}function iu(e){return e.copy_||e.base_}function bE(e,t){if(o0(e))return new Map(e);if(a1(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const n=MQ(e);if(t===!0||t==="class_only"&&!n){const s=Object.getOwnPropertyDescriptors(e);delete s[Gr];let r=Reflect.ownKeys(s);for(let i=0;i<r.length;i++){const o=r[i],l=s[o];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(s[o]={configurable:!0,writable:!0,enumerable:l.enumerable,value:e[o]})}return Object.create(qp(e),s)}else{const s=qp(e);if(s!==null&&n)return{...e};const r=Object.create(s);return Object.assign(r,e)}}function GD(e,t=!1){return n1(e)||Vf(e)||!Yu(e)||(t1(e)>1&&Object.defineProperties(e,{set:fb,add:fb,clear:fb,delete:fb}),Object.freeze(e),t&&Object.values(e).forEach(n=>GD(n,!0))),e}function uTe(){qi(2)}var fb={value:uTe};function n1(e){return e===null||typeof e!="object"?!0:Object.isFrozen(e)}var mTe={};function Qu(e){const t=mTe[e];return t||qi(0,e),t}var Gp;function $Q(){return Gp}function fTe(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function mF(e,t){t&&(Qu("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function vE(e){wE(e),e.drafts_.forEach(hTe),e.drafts_=null}function wE(e){e===Gp&&(Gp=e.parent_)}function fF(e){return Gp=fTe(Gp,e)}function hTe(e){const t=e[Gr];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function hF(e,t){t.unfinalizedDrafts_=t.drafts_.length;const n=t.drafts_[0];return e!==void 0&&e!==n?(n[Gr].modified_&&(vE(t),qi(4)),Yu(e)&&(e=Sw(t,e),t.parent_||_w(t,e)),t.patches_&&Qu("Patches").generateReplacementPatches_(n[Gr].base_,e,t.patches_,t.inversePatches_)):e=Sw(t,n,[]),vE(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==OQ?e:void 0}function Sw(e,t,n){if(n1(t))return t;const s=e.immer_.shouldUseStrictIteration(),r=t[Gr];if(!r)return Cw(t,(i,o)=>gF(e,r,t,i,o,n),s),t;if(r.scope_!==e)return t;if(!r.modified_)return _w(e,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const i=r.copy_;let o=i,l=!1;r.type_===3&&(o=new Set(i),i.clear(),l=!0),Cw(o,(c,u)=>gF(e,r,i,c,u,n,l),s),_w(e,i,!1),n&&e.patches_&&Qu("Patches").generatePatches_(r,n,e.patches_,e.inversePatches_)}return r.copy_}function gF(e,t,n,s,r,i,o){if(r==null||typeof r!="object"&&!o)return;const l=n1(r);if(!(l&&!o)){if(Vf(r)){const c=i&&t&&t.type_!==3&&!yE(t.assigned_,s)?i.concat(s):void 0,u=Sw(e,r,c);if(IQ(n,s,u),Vf(u))e.canAutoFreeze_=!1;else return}else o&&n.add(r);if(Yu(r)&&!l){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1||t&&t.base_&&t.base_[s]===r&&l)return;Sw(e,r),(!t||!t.scope_.parent_)&&typeof s!="symbol"&&(o0(n)?n.has(s):Object.prototype.propertyIsEnumerable.call(n,s))&&_w(e,r)}}}function _w(e,t,n=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&GD(t,n)}function gTe(e,t){const n=Array.isArray(e),s={type_:n?1:0,scope_:t?t.scope_:$Q(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let r=s,i=WD;n&&(r=[s],i=Wp);const{revoke:o,proxy:l}=Proxy.revocable(r,i);return s.draft_=l,s.revoke_=o,l}var WD={get(e,t){if(t===Gr)return e;const n=iu(e);if(!yE(n,t))return pTe(e,n,t);const s=n[t];return e.finalized_||!Yu(s)?s:s===W_(e.base_,t)?(V_(e),e.copy_[t]=NE(s,e)):s},has(e,t){return t in iu(e)},ownKeys(e){return Reflect.ownKeys(iu(e))},set(e,t,n){const s=RQ(iu(e),t);if(s?.set)return s.set.call(e.draft_,n),!0;if(!e.modified_){const r=W_(iu(e),t),i=r?.[Gr];if(i&&i.base_===n)return e.copy_[t]=n,e.assigned_[t]=!1,!0;if(dTe(n,r)&&(n!==void 0||yE(e.base_,t)))return!0;V_(e),jE(e)}return e.copy_[t]===n&&(n!==void 0||t in e.copy_)||Number.isNaN(n)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=n,e.assigned_[t]=!0),!0},deleteProperty(e,t){return W_(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,V_(e),jE(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const n=iu(e),s=Reflect.getOwnPropertyDescriptor(n,t);return s&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:s.enumerable,value:n[t]}},defineProperty(){qi(11)},getPrototypeOf(e){return qp(e.base_)},setPrototypeOf(){qi(12)}},Wp={};Cw(WD,(e,t)=>{Wp[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});Wp.deleteProperty=function(e,t){return Wp.set.call(this,e,t,void 0)};Wp.set=function(e,t,n){return WD.set.call(this,e[0],t,n,e[0])};function W_(e,t){const n=e[Gr];return(n?iu(n):e)[t]}function pTe(e,t,n){const s=RQ(t,n);return s?"value"in s?s.value:s.get?.call(e.draft_):void 0}function RQ(e,t){if(!(t in e))return;let n=qp(e);for(;n;){const s=Object.getOwnPropertyDescriptor(n,t);if(s)return s;n=qp(n)}}function jE(e){e.modified_||(e.modified_=!0,e.parent_&&jE(e.parent_))}function V_(e){e.copy_||(e.copy_=bE(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var xTe=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(t,n,s)=>{if(typeof t=="function"&&typeof n!="function"){const i=n;n=t;const o=this;return function(c=i,...u){return o.produce(c,d=>n.call(this,d,...u))}}typeof n!="function"&&qi(6),s!==void 0&&typeof s!="function"&&qi(7);let r;if(Yu(t)){const i=fF(this),o=NE(t,void 0);let l=!0;try{r=n(o),l=!1}finally{l?vE(i):wE(i)}return mF(i,s),hF(r,i)}else if(!t||typeof t!="object"){if(r=n(t),r===void 0&&(r=t),r===OQ&&(r=void 0),this.autoFreeze_&&GD(r,!0),s){const i=[],o=[];Qu("Patches").generateReplacementPatches_(t,r,i,o),s(i,o)}return r}else qi(1,t)},this.produceWithPatches=(t,n)=>{if(typeof t=="function")return(o,...l)=>this.produceWithPatches(o,c=>t(c,...l));let s,r;return[this.produce(t,n,(o,l)=>{s=o,r=l}),s,r]},typeof e?.autoFreeze=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof e?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),typeof e?.useStrictIteration=="boolean"&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){Yu(e)||qi(8),Vf(e)&&(e=yTe(e));const t=fF(this),n=NE(e,void 0);return n[Gr].isManual_=!0,wE(t),n}finishDraft(e,t){const n=e&&e[Gr];(!n||!n.isManual_)&&qi(9);const{scope_:s}=n;return mF(s,t),hF(void 0,s)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,t){let n;for(n=t.length-1;n>=0;n--){const r=t[n];if(r.path.length===0&&r.op==="replace"){e=r.value;break}}n>-1&&(t=t.slice(n+1));const s=Qu("Patches").applyPatches_;return Vf(e)?s(e,t):this.produce(e,r=>s(r,t))}};function NE(e,t){const n=o0(e)?Qu("MapSet").proxyMap_(e,t):a1(e)?Qu("MapSet").proxySet_(e,t):gTe(e,t);return(t?t.scope_:$Q()).drafts_.push(n),n}function yTe(e){return Vf(e)||qi(10,e),zQ(e)}function zQ(e){if(!Yu(e)||n1(e))return e;const t=e[Gr];let n,s=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,n=bE(e,t.scope_.immer_.useStrictShallowCopy_),s=t.scope_.immer_.shouldUseStrictIteration()}else n=bE(e,!0);return Cw(n,(r,i)=>{IQ(n,r,zQ(i))},s),t&&(t.finalized_=!1),n}var bTe=new xTe;bTe.produce;var vTe={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},FQ=Cr({name:"legend",initialState:vTe,reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload:{reducer(e,t){e.payload.push(t.payload)},prepare:cn()},replaceLegendPayload:{reducer(e,t){var{prev:n,next:s}=t.payload,r=Vi(e).payload.indexOf(n);r>-1&&(e.payload[r]=s)},prepare:cn()},removeLegendPayload:{reducer(e,t){var n=Vi(e).payload.indexOf(t.payload);n>-1&&e.payload.splice(n,1)},prepare:cn()}}}),{setLegendSize:pF,setLegendSettings:wTe,addLegendPayload:UQ,replaceLegendPayload:BQ,removeLegendPayload:HQ}=FQ.actions,jTe=FQ.reducer,NTe=["contextPayload"];function CE(){return CE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},CE.apply(null,arguments)}function xF(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function Yf(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?xF(Object(n),!0).forEach(function(s){CTe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xF(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function CTe(e,t,n){return(t=STe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function STe(e){var t=_Te(e,"string");return typeof t=="symbol"?t:t+""}function _Te(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ATe(e,t){if(e==null)return{};var n,s,r=TTe(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)n=i[s],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function TTe(e,t){if(e==null)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;n[s]=e[s]}return n}function kTe(e){return e.value}function ETe(e){var{contextPayload:t}=e,n=ATe(e,NTe),s=HY(t,e.payloadUniqBy,kTe),r=Yf(Yf({},n),{},{payload:s});return f.isValidElement(e.content)?f.cloneElement(e.content,r):typeof e.content=="function"?f.createElement(e.content,r):f.createElement(M2e,r)}function LTe(e,t,n,s,r,i){var{layout:o,align:l,verticalAlign:c}=t,u,d;return(!e||(e.left===void 0||e.left===null)&&(e.right===void 0||e.right===null))&&(l==="center"&&o==="vertical"?u={left:((s||0)-i.width)/2}:u=l==="right"?{right:n&&n.right||0}:{left:n&&n.left||0}),(!e||(e.top===void 0||e.top===null)&&(e.bottom===void 0||e.bottom===null))&&(c==="middle"?d={top:((r||0)-i.height)/2}:d=c==="bottom"?{bottom:n&&n.bottom||0}:{top:n&&n.top||0}),Yf(Yf({},u),d)}function DTe(e){var t=Ja();return f.useEffect(()=>{t(wTe(e))},[t,e]),null}function PTe(e){var t=Ja();return f.useEffect(()=>(t(pF(e)),()=>{t(pF({width:0,height:0}))}),[t,e]),null}function OTe(e,t,n,s){return e==="vertical"&&Ut(t)?{height:t}:e==="horizontal"?{width:n||s}:null}var MTe={align:"center",iconSize:14,itemSorter:"value",layout:"horizontal",verticalAlign:"bottom"};function qQ(e){var t=Xn(e,MTe),n=h_e(),s=r2e(),r=oTe(),{width:i,height:o,wrapperStyle:l,portal:c}=t,[u,d]=VY([n]),h=HD(),p=qD();if(h==null||p==null)return null;var x=h-(r?.left||0)-(r?.right||0),b=OTe(t.layout,o,i,x),j=c?l:Yf(Yf({position:"absolute",width:b?.width||i||"auto",height:b?.height||o||"auto"},LTe(l,t,r,h,p,u)),l),y=c??s;if(y==null||n==null)return null;var N=f.createElement("div",{className:"recharts-legend-wrapper",style:j,ref:d},f.createElement(DTe,{layout:t.layout,align:t.align,verticalAlign:t.verticalAlign,itemSorter:t.itemSorter}),!c&&f.createElement(PTe,{width:u.width,height:u.height}),f.createElement(ETe,CE({},t,b,{margin:r,chartWidth:h,chartHeight:p,contextPayload:n})));return Gi.createPortal(N,y)}qQ.displayName="Legend";function SE(){return SE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},SE.apply(null,arguments)}function yF(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function Y_(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?yF(Object(n),!0).forEach(function(s){ITe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yF(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function ITe(e,t,n){return(t=$Te(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $Te(e){var t=RTe(e,"string");return typeof t=="symbol"?t:t+""}function RTe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zTe(e){return Array.isArray(e)&&Ho(e[0])&&Ho(e[1])?e.join(" ~ "):e}var FTe=e=>{var{separator:t=" : ",contentStyle:n={},itemStyle:s={},labelStyle:r={},payload:i,formatter:o,itemSorter:l,wrapperClassName:c,labelClassName:u,label:d,labelFormatter:h,accessibilityLayer:p=!1}=e,x=()=>{if(i&&i.length){var T={padding:0,margin:0},k=(l?FN(i,l):i).map((A,E)=>{if(A.type==="none")return null;var M=A.formatter||o||zTe,{value:F,name:D}=A,P=F,B=D;if(M){var G=M(F,D,A,E,i);if(Array.isArray(G))[P,B]=G;else if(G!=null)P=G;else return null}var $=Y_({display:"block",paddingTop:4,paddingBottom:4,color:A.color||"#000"},s);return f.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(E),style:$},Ho(B)?f.createElement("span",{className:"recharts-tooltip-item-name"},B):null,Ho(B)?f.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,f.createElement("span",{className:"recharts-tooltip-item-value"},P),f.createElement("span",{className:"recharts-tooltip-item-unit"},A.unit||""))});return f.createElement("ul",{className:"recharts-tooltip-item-list",style:T},k)}return null},b=Y_({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},n),j=Y_({margin:0},r),y=!fn(d),N=y?d:"",w=Rt("recharts-default-tooltip",c),S=Rt("recharts-tooltip-label",u);y&&h&&i!==void 0&&i!==null&&(N=h(d,i));var _=p?{role:"status","aria-live":"assertive"}:{};return f.createElement("div",SE({className:w,style:b},_),f.createElement("p",{className:S,style:j},f.isValidElement(N)?N:"".concat(N)),x())},Tg="recharts-tooltip-wrapper",UTe={visibility:"hidden"};function BTe(e){var{coordinate:t,translateX:n,translateY:s}=e;return Rt(Tg,{["".concat(Tg,"-right")]:Ut(n)&&t&&Ut(t.x)&&n>=t.x,["".concat(Tg,"-left")]:Ut(n)&&t&&Ut(t.x)&&n<t.x,["".concat(Tg,"-bottom")]:Ut(s)&&t&&Ut(t.y)&&s>=t.y,["".concat(Tg,"-top")]:Ut(s)&&t&&Ut(t.y)&&s<t.y})}function bF(e){var{allowEscapeViewBox:t,coordinate:n,key:s,offsetTopLeft:r,position:i,reverseDirection:o,tooltipDimension:l,viewBox:c,viewBoxDimension:u}=e;if(i&&Ut(i[s]))return i[s];var d=n[s]-l-(r>0?r:0),h=n[s]+r;if(t[s])return o[s]?d:h;var p=c[s];if(p==null)return 0;if(o[s]){var x=d,b=p;return x<b?Math.max(h,p):Math.max(d,p)}if(u==null)return 0;var j=h+l,y=p+u;return j>y?Math.max(d,p):Math.max(h,p)}function HTe(e){var{translateX:t,translateY:n,useTranslate3d:s}=e;return{transform:s?"translate3d(".concat(t,"px, ").concat(n,"px, 0)"):"translate(".concat(t,"px, ").concat(n,"px)")}}function qTe(e){var{allowEscapeViewBox:t,coordinate:n,offsetTopLeft:s,position:r,reverseDirection:i,tooltipBox:o,useTranslate3d:l,viewBox:c}=e,u,d,h;return o.height>0&&o.width>0&&n?(d=bF({allowEscapeViewBox:t,coordinate:n,key:"x",offsetTopLeft:s,position:r,reverseDirection:i,tooltipDimension:o.width,viewBox:c,viewBoxDimension:c.width}),h=bF({allowEscapeViewBox:t,coordinate:n,key:"y",offsetTopLeft:s,position:r,reverseDirection:i,tooltipDimension:o.height,viewBox:c,viewBoxDimension:c.height}),u=HTe({translateX:d,translateY:h,useTranslate3d:l})):u=UTe,{cssProperties:u,cssClasses:BTe({translateX:d,translateY:h,coordinate:n})}}function vF(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function hb(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?vF(Object(n),!0).forEach(function(s){_E(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vF(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function _E(e,t,n){return(t=GTe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function GTe(e){var t=WTe(e,"string");return typeof t=="symbol"?t:t+""}function WTe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class VTe extends f.PureComponent{constructor(){super(...arguments),_E(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),_E(this,"handleKeyDown",t=>{if(t.key==="Escape"){var n,s,r,i;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(n=(s=this.props.coordinate)===null||s===void 0?void 0:s.x)!==null&&n!==void 0?n:0,y:(r=(i=this.props.coordinate)===null||i===void 0?void 0:i.y)!==null&&r!==void 0?r:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var t,n;this.state.dismissed&&(((t=this.props.coordinate)===null||t===void 0?void 0:t.x)!==this.state.dismissedAtCoordinate.x||((n=this.props.coordinate)===null||n===void 0?void 0:n.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:t,allowEscapeViewBox:n,animationDuration:s,animationEasing:r,children:i,coordinate:o,hasPayload:l,isAnimationActive:c,offset:u,position:d,reverseDirection:h,useTranslate3d:p,viewBox:x,wrapperStyle:b,lastBoundingBox:j,innerRef:y,hasPortalFromProps:N}=this.props,{cssClasses:w,cssProperties:S}=qTe({allowEscapeViewBox:n,coordinate:o,offsetTopLeft:u,position:d,reverseDirection:h,tooltipBox:{height:j.height,width:j.width},useTranslate3d:p,viewBox:x}),_=N?{}:hb(hb({transition:c&&t?"transform ".concat(s,"ms ").concat(r):void 0},S),{},{pointerEvents:"none",visibility:!this.state.dismissed&&t&&l?"visible":"hidden",position:"absolute",top:0,left:0}),T=hb(hb({},_),{},{visibility:!this.state.dismissed&&t&&l?"visible":"hidden"},b);return f.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:w,style:T,ref:y},i)}}var GQ=()=>{var e;return(e=Bt(t=>t.rootProps.accessibilityLayer))!==null&&e!==void 0?e:!0};function AE(){return AE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},AE.apply(null,arguments)}function wF(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function jF(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?wF(Object(n),!0).forEach(function(s){YTe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wF(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function YTe(e,t,n){return(t=QTe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function QTe(e){var t=KTe(e,"string");return typeof t=="symbol"?t:t+""}function KTe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var NF={curveBasisClosed:Kpe,curveBasisOpen:Xpe,curveBasis:Qpe,curveBumpX:tW,curveBumpY:aW,curveLinearClosed:exe,curveLinear:Ix,curveMonotoneX:Rk,curveMonotoneY:bW,curveNatural:wW,curveStep:jW,curveStepAfter:CW,curveStepBefore:NW},Aw=e=>xn(e.x)&&xn(e.y),CF=e=>e.base!=null&&Aw(e.base)&&Aw(e),kg=e=>e.x,Eg=e=>e.y,XTe=(e,t)=>{if(typeof e=="function")return e;var n="curve".concat(e0(e));return(n==="curveMonotone"||n==="curveBump")&&t?NF["".concat(n).concat(t==="vertical"?"Y":"X")]:NF[n]||Ix},ZTe=e=>{var{type:t="linear",points:n=[],baseLine:s,layout:r,connectNulls:i=!1}=e,o=XTe(t,r),l=i?n.filter(Aw):n,c;if(Array.isArray(s)){var u=n.map((x,b)=>jF(jF({},x),{},{base:s[b]}));r==="vertical"?c=Yg().y(Eg).x1(kg).x0(x=>x.base.x):c=Yg().x(kg).y1(Eg).y0(x=>x.base.y);var d=c.defined(CF).curve(o),h=i?u.filter(CF):u;return d(h)}r==="vertical"&&Ut(s)?c=Yg().y(Eg).x1(kg).x0(s):Ut(s)?c=Yg().x(kg).y1(Eg).y0(s):c=F4().x(kg).y(Eg);var p=c.defined(Aw).curve(o);return p(l)},VD=e=>{var{className:t,points:n,path:s,pathRef:r}=e,i=yh();if((!n||!n.length)&&!s)return null;var o={type:e.type,points:e.points,baseLine:e.baseLine,layout:e.layout||i,connectNulls:e.connectNulls},l=n&&n.length?ZTe(o):s;return f.createElement("path",AE({},qr(e),ED(e),{className:Rt("recharts-curve",t),d:l===null?void 0:l,ref:r}))},JTe=["x","y","top","left","width","height","className"];function TE(){return TE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},TE.apply(null,arguments)}function SF(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function eke(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?SF(Object(n),!0).forEach(function(s){tke(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):SF(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function tke(e,t,n){return(t=ake(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ake(e){var t=nke(e,"string");return typeof t=="symbol"?t:t+""}function nke(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ske(e,t){if(e==null)return{};var n,s,r=rke(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)n=i[s],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function rke(e,t){if(e==null)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;n[s]=e[s]}return n}var ike=(e,t,n,s,r,i)=>"M".concat(e,",").concat(r,"v").concat(s,"M").concat(i,",").concat(t,"h").concat(n),oke=e=>{var{x:t=0,y:n=0,top:s=0,left:r=0,width:i=0,height:o=0,className:l}=e,c=ske(e,JTe),u=eke({x:t,y:n,top:s,left:r,width:i,height:o},c);return!Ut(t)||!Ut(n)||!Ut(i)||!Ut(o)||!Ut(s)||!Ut(r)?null:f.createElement("path",TE({},Ys(u),{className:Rt("recharts-cross",l),d:ike(t,n,i,o,s,r)}))};function lke(e,t,n,s){var r=s/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-r:n.left+.5,y:e==="horizontal"?n.top+.5:t.y-r,width:e==="horizontal"?s:n.width-1,height:e==="horizontal"?n.height-1:s}}function _F(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function AF(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?_F(Object(n),!0).forEach(function(s){cke(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_F(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function cke(e,t,n){return(t=dke(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function dke(e){var t=uke(e,"string");return typeof t=="symbol"?t:t+""}function uke(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var mke=e=>e.replace(/([A-Z])/g,t=>"-".concat(t.toLowerCase())),WQ=(e,t,n)=>e.map(s=>"".concat(mke(s)," ").concat(t,"ms ").concat(n)).join(","),fke=(e,t)=>[Object.keys(e),Object.keys(t)].reduce((n,s)=>n.filter(r=>s.includes(r))),Vp=(e,t)=>Object.keys(t).reduce((n,s)=>AF(AF({},n),{},{[s]:e(s,t[s])}),{});function TF(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function Jn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?TF(Object(n),!0).forEach(function(s){hke(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):TF(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function hke(e,t,n){return(t=gke(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function gke(e){var t=pke(e,"string");return typeof t=="symbol"?t:t+""}function pke(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Tw=(e,t,n)=>e+(t-e)*n,kE=e=>{var{from:t,to:n}=e;return t!==n},VQ=(e,t,n)=>{var s=Vp((r,i)=>{if(kE(i)){var[o,l]=e(i.from,i.to,i.velocity);return Jn(Jn({},i),{},{from:o,velocity:l})}return i},t);return n<1?Vp((r,i)=>kE(i)&&s[r]!=null?Jn(Jn({},i),{},{velocity:Tw(i.velocity,s[r].velocity,n),from:Tw(i.from,s[r].from,n)}):i,t):VQ(e,s,n-1)};function xke(e,t,n,s,r,i){var o,l=s.reduce((p,x)=>Jn(Jn({},p),{},{[x]:{from:e[x],velocity:0,to:t[x]}}),{}),c=()=>Vp((p,x)=>x.from,l),u=()=>!Object.values(l).filter(kE).length,d=null,h=p=>{o||(o=p);var x=p-o,b=x/n.dt;l=VQ(n,l,b),r(Jn(Jn(Jn({},e),t),c())),o=p,u()||(d=i.setTimeout(h))};return()=>(d=i.setTimeout(h),()=>{var p;(p=d)===null||p===void 0||p()})}function yke(e,t,n,s,r,i,o){var l=null,c=r.reduce((h,p)=>{var x=e[p],b=t[p];return x==null||b==null?h:Jn(Jn({},h),{},{[p]:[x,b]})},{}),u,d=h=>{u||(u=h);var p=(h-u)/s,x=Vp((j,y)=>Tw(...y,n(p)),c);if(i(Jn(Jn(Jn({},e),t),x)),p<1)l=o.setTimeout(d);else{var b=Vp((j,y)=>Tw(...y,n(1)),c);i(Jn(Jn(Jn({},e),t),b))}};return()=>(l=o.setTimeout(d),()=>{var h;(h=l)===null||h===void 0||h()})}const bke=(e,t,n,s,r,i)=>{var o=fke(e,t);return n==null?()=>(r(Jn(Jn({},e),t)),()=>{}):n.isStepper===!0?xke(e,t,n,o,r,i):yke(e,t,n,s,o,r,i)};var kw=1e-4,YQ=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],QQ=(e,t)=>e.map((n,s)=>n*t**s).reduce((n,s)=>n+s),kF=(e,t)=>n=>{var s=YQ(e,t);return QQ(s,n)},vke=(e,t)=>n=>{var s=YQ(e,t),r=[...s.map((i,o)=>i*o).slice(1),0];return QQ(r,n)},wke=e=>{var t,n=e.split("(");if(n.length!==2||n[0]!=="cubic-bezier")return null;var s=(t=n[1])===null||t===void 0||(t=t.split(")")[0])===null||t===void 0?void 0:t.split(",");if(s==null||s.length!==4)return null;var r=s.map(i=>parseFloat(i));return[r[0],r[1],r[2],r[3]]},jke=function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];if(n.length===1)switch(n[0]){case"linear":return[0,0,1,1];case"ease":return[.25,.1,.25,1];case"ease-in":return[.42,0,1,1];case"ease-out":return[.42,0,.58,1];case"ease-in-out":return[0,0,.58,1];default:{var r=wke(n[0]);if(r)return r}}return n.length===4?n:[0,0,1,1]},Nke=(e,t,n,s)=>{var r=kF(e,n),i=kF(t,s),o=vke(e,n),l=u=>u>1?1:u<0?0:u,c=u=>{for(var d=u>1?1:u,h=d,p=0;p<8;++p){var x=r(h)-d,b=o(h);if(Math.abs(x-d)<kw||b<kw)return i(h);h=l(h-x/b)}return i(h)};return c.isStepper=!1,c},EF=function(){return Nke(...jke(...arguments))},Cke=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:n=100,damping:s=8,dt:r=17}=t,i=(o,l,c)=>{var u=-(o-l)*n,d=c*s,h=c+(u-d)*r/1e3,p=c*r/1e3+o;return Math.abs(p-l)<kw&&Math.abs(h)<kw?[l,0]:[p,h]};return i.isStepper=!0,i.dt=r,i},Ske=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return EF(e);case"spring":return Cke();default:if(e.split("(")[0]==="cubic-bezier")return EF(e)}return typeof e=="function"?e:null};function _ke(e){var t,n=()=>null,s=!1,r=null,i=o=>{if(!s){if(Array.isArray(o)){if(!o.length)return;var l=o,[c,...u]=l;if(typeof c=="number"){r=e.setTimeout(i.bind(null,u),c);return}i(c),r=e.setTimeout(i.bind(null,u));return}typeof o=="string"&&(t=o,n(t)),typeof o=="object"&&(t=o,n(t)),typeof o=="function"&&o()}};return{stop:()=>{s=!0},start:o=>{s=!1,r&&(r(),r=null),i(o)},subscribe:o=>(n=o,()=>{n=()=>null}),getTimeoutController:()=>e}}class Ake{setTimeout(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=performance.now(),r=null,i=o=>{o-s>=n?t(o):typeof requestAnimationFrame=="function"&&(r=requestAnimationFrame(i))};return r=requestAnimationFrame(i),()=>{r!=null&&cancelAnimationFrame(r)}}}function Tke(){return _ke(new Ake)}var kke=f.createContext(Tke);function Eke(e,t){var n=f.useContext(kke);return f.useMemo(()=>t??n(e),[e,t,n])}var Lke=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),s1={isSsr:Lke()},Dke={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},LF={t:0},Q_={t:1};function l0(e){var t=Xn(e,Dke),{isActive:n,canBegin:s,duration:r,easing:i,begin:o,onAnimationEnd:l,onAnimationStart:c,children:u}=t,d=n==="auto"?!s1.isSsr:n,h=Eke(t.animationId,t.animationManager),[p,x]=f.useState(d?LF:Q_),b=f.useRef(null);return f.useEffect(()=>{d||x(Q_)},[d]),f.useEffect(()=>{if(!d||!s)return t0;var j=bke(LF,Q_,Ske(i),r,x,h.getTimeoutController()),y=()=>{b.current=j()};return h.start([c,o,y,r,l]),()=>{h.stop(),b.current&&b.current(),l()}},[d,s,r,i,o,c,l,h]),u(p.t)}function c0(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",n=f.useRef(Fp(t)),s=f.useRef(e);return s.current!==e&&(n.current=Fp(t),s.current=e),n.current}var Pke=["radius"],Oke=["radius"],DF,PF,OF,MF,IF,$F,RF,zF,FF,UF;function BF(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function HF(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?BF(Object(n),!0).forEach(function(s){Mke(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):BF(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function Mke(e,t,n){return(t=Ike(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ike(e){var t=$ke(e,"string");return typeof t=="symbol"?t:t+""}function $ke(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ew(){return Ew=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Ew.apply(null,arguments)}function qF(e,t){if(e==null)return{};var n,s,r=Rke(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)n=i[s],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Rke(e,t){if(e==null)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;n[s]=e[s]}return n}function ho(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var GF=(e,t,n,s,r)=>{var i=td(n),o=td(s),l=Math.min(Math.abs(i)/2,Math.abs(o)/2),c=o>=0?1:-1,u=i>=0?1:-1,d=o>=0&&i>=0||o<0&&i<0?1:0,h;if(l>0&&r instanceof Array){for(var p=[0,0,0,0],x=0,b=4;x<b;x++)p[x]=r[x]>l?l:r[x];h=Cn(DF||(DF=ho(["M",",",""])),e,t+c*p[0]),p[0]>0&&(h+=Cn(PF||(PF=ho(["A ",",",",0,0,",",",",",""])),p[0],p[0],d,e+u*p[0],t)),h+=Cn(OF||(OF=ho(["L ",",",""])),e+n-u*p[1],t),p[1]>0&&(h+=Cn(MF||(MF=ho(["A ",",",",0,0,",`,
        `,",",""])),p[1],p[1],d,e+n,t+c*p[1])),h+=Cn(IF||(IF=ho(["L ",",",""])),e+n,t+s-c*p[2]),p[2]>0&&(h+=Cn($F||($F=ho(["A ",",",",0,0,",`,
        `,",",""])),p[2],p[2],d,e+n-u*p[2],t+s)),h+=Cn(RF||(RF=ho(["L ",",",""])),e+u*p[3],t+s),p[3]>0&&(h+=Cn(zF||(zF=ho(["A ",",",",0,0,",`,
        `,",",""])),p[3],p[3],d,e,t+s-c*p[3])),h+="Z"}else if(l>0&&r===+r&&r>0){var j=Math.min(l,r);h=Cn(FF||(FF=ho(["M ",",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",","," Z"])),e,t+c*j,j,j,d,e+u*j,t,e+n-u*j,t,j,j,d,e+n,t+c*j,e+n,t+s-c*j,j,j,d,e+n-u*j,t+s,e+u*j,t+s,j,j,d,e,t+s-c*j)}else h=Cn(UF||(UF=ho(["M ",","," h "," v "," h "," Z"])),e,t,n,s,-n);return h},WF={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},KQ=e=>{var t=Xn(e,WF),n=f.useRef(null),[s,r]=f.useState(-1);f.useEffect(()=>{if(n.current&&n.current.getTotalLength)try{var Z=n.current.getTotalLength();Z&&r(Z)}catch{}},[]);var{x:i,y:o,width:l,height:c,radius:u,className:d}=t,{animationEasing:h,animationDuration:p,animationBegin:x,isAnimationActive:b,isUpdateAnimationActive:j}=t,y=f.useRef(l),N=f.useRef(c),w=f.useRef(i),S=f.useRef(o),_=f.useMemo(()=>({x:i,y:o,width:l,height:c,radius:u}),[i,o,l,c,u]),T=c0(_,"rectangle-");if(i!==+i||o!==+o||l!==+l||c!==+c||l===0||c===0)return null;var k=Rt("recharts-rectangle",d);if(!j){var A=Ys(t),{radius:E}=A,M=qF(A,Pke);return f.createElement("path",Ew({},M,{x:td(i),y:td(o),width:td(l),height:td(c),radius:typeof u=="number"?u:void 0,className:k,d:GF(i,o,l,c,u)}))}var F=y.current,D=N.current,P=w.current,B=S.current,G="0px ".concat(s===-1?1:s,"px"),$="".concat(s,"px 0px"),W=WQ(["strokeDasharray"],p,typeof h=="string"?h:WF.animationEasing);return f.createElement(l0,{animationId:T,key:T,canBegin:s>0,duration:p,easing:h,isActive:j,begin:x},Z=>{var Q=dn(F,l,Z),le=dn(D,c,Z),we=dn(P,i,Z),J=dn(B,o,Z);n.current&&(y.current=Q,N.current=le,w.current=we,S.current=J);var se;b?Z>0?se={transition:W,strokeDasharray:$}:se={strokeDasharray:G}:se={strokeDasharray:$};var ye=Ys(t),{radius:Ce}=ye,ge=qF(ye,Oke);return f.createElement("path",Ew({},ge,{radius:typeof u=="number"?u:void 0,className:k,d:GF(we,J,Q,le,u),ref:n,style:HF(HF({},se),t.style)}))})};function VF(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function YF(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?VF(Object(n),!0).forEach(function(s){zke(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):VF(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function zke(e,t,n){return(t=Fke(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Fke(e){var t=Uke(e,"string");return typeof t=="symbol"?t:t+""}function Uke(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Lw=Math.PI/180,Bke=e=>e*180/Math.PI,qn=(e,t,n,s)=>({x:e+Math.cos(-Lw*s)*n,y:t+Math.sin(-Lw*s)*n}),XQ=function(t,n){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(s.left||0)-(s.right||0)),Math.abs(n-(s.top||0)-(s.bottom||0)))/2},Hke=(e,t)=>{var{x:n,y:s}=e,{x:r,y:i}=t;return Math.sqrt((n-r)**2+(s-i)**2)},qke=(e,t)=>{var{x:n,y:s}=e,{cx:r,cy:i}=t,o=Hke({x:n,y:s},{x:r,y:i});if(o<=0)return{radius:o,angle:0};var l=(n-r)/o,c=Math.acos(l);return s>i&&(c=2*Math.PI-c),{radius:o,angle:Bke(c),angleInRadian:c}},Gke=e=>{var{startAngle:t,endAngle:n}=e,s=Math.floor(t/360),r=Math.floor(n/360),i=Math.min(s,r);return{startAngle:t-i*360,endAngle:n-i*360}},Wke=(e,t)=>{var{startAngle:n,endAngle:s}=t,r=Math.floor(n/360),i=Math.floor(s/360),o=Math.min(r,i);return e+o*360},Vke=(e,t)=>{var{chartX:n,chartY:s}=e,{radius:r,angle:i}=qke({x:n,y:s},t),{innerRadius:o,outerRadius:l}=t;if(r<o||r>l||r===0)return null;var{startAngle:c,endAngle:u}=Gke(t),d=i,h;if(c<=u){for(;d>u;)d-=360;for(;d<c;)d+=360;h=d>=c&&d<=u}else{for(;d>c;)d-=360;for(;d<u;)d+=360;h=d>=u&&d<=c}return h?YF(YF({},t),{},{radius:r,angle:Wke(d,t)}):null};function ZQ(e){var{cx:t,cy:n,radius:s,startAngle:r,endAngle:i}=e,o=qn(t,n,s,r),l=qn(t,n,s,i);return{points:[o,l],cx:t,cy:n,radius:s,startAngle:r,endAngle:i}}var QF,KF,XF,ZF,JF,eU,tU;function EE(){return EE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},EE.apply(null,arguments)}function ju(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var Yke=(e,t)=>{var n=bs(t-e),s=Math.min(Math.abs(t-e),359.999);return n*s},gb=e=>{var{cx:t,cy:n,radius:s,angle:r,sign:i,isExternal:o,cornerRadius:l,cornerIsExternal:c}=e,u=l*(o?1:-1)+s,d=Math.asin(l/u)/Lw,h=c?r:r+i*d,p=qn(t,n,u,h),x=qn(t,n,s,h),b=c?r-i*d:r,j=qn(t,n,u*Math.cos(d*Lw),b);return{center:p,circleTangency:x,lineTangency:j,theta:d}},JQ=e=>{var{cx:t,cy:n,innerRadius:s,outerRadius:r,startAngle:i,endAngle:o}=e,l=Yke(i,o),c=i+l,u=qn(t,n,r,i),d=qn(t,n,r,c),h=Cn(QF||(QF=ju(["M ",",",`
    A `,",",`,0,
    `,",",`,
    `,",",`
  `])),u.x,u.y,r,r,+(Math.abs(l)>180),+(i>c),d.x,d.y);if(s>0){var p=qn(t,n,s,i),x=qn(t,n,s,c);h+=Cn(KF||(KF=ju(["L ",",",`
            A `,",",`,0,
            `,",",`,
            `,","," Z"])),x.x,x.y,s,s,+(Math.abs(l)>180),+(i<=c),p.x,p.y)}else h+=Cn(XF||(XF=ju(["L ",","," Z"])),t,n);return h},Qke=e=>{var{cx:t,cy:n,innerRadius:s,outerRadius:r,cornerRadius:i,forceCornerRadius:o,cornerIsExternal:l,startAngle:c,endAngle:u}=e,d=bs(u-c),{circleTangency:h,lineTangency:p,theta:x}=gb({cx:t,cy:n,radius:r,angle:c,sign:d,cornerRadius:i,cornerIsExternal:l}),{circleTangency:b,lineTangency:j,theta:y}=gb({cx:t,cy:n,radius:r,angle:u,sign:-d,cornerRadius:i,cornerIsExternal:l}),N=l?Math.abs(c-u):Math.abs(c-u)-x-y;if(N<0)return o?Cn(ZF||(ZF=ju(["M ",",",`
        a`,",",",0,0,1,",`,0
        a`,",",",0,0,1,",`,0
      `])),p.x,p.y,i,i,i*2,i,i,-i*2):JQ({cx:t,cy:n,innerRadius:s,outerRadius:r,startAngle:c,endAngle:u});var w=Cn(JF||(JF=ju(["M ",",",`
    A`,",",",0,0,",",",",",`
    A`,",",",0,",",",",",",",`
    A`,",",",0,0,",",",",",`
  `])),p.x,p.y,i,i,+(d<0),h.x,h.y,r,r,+(N>180),+(d<0),b.x,b.y,i,i,+(d<0),j.x,j.y);if(s>0){var{circleTangency:S,lineTangency:_,theta:T}=gb({cx:t,cy:n,radius:s,angle:c,sign:d,isExternal:!0,cornerRadius:i,cornerIsExternal:l}),{circleTangency:k,lineTangency:A,theta:E}=gb({cx:t,cy:n,radius:s,angle:u,sign:-d,isExternal:!0,cornerRadius:i,cornerIsExternal:l}),M=l?Math.abs(c-u):Math.abs(c-u)-T-E;if(M<0&&i===0)return"".concat(w,"L").concat(t,",").concat(n,"Z");w+=Cn(eU||(eU=ju(["L",",",`
      A`,",",",0,0,",",",",",`
      A`,",",",0,",",",",",",",`
      A`,",",",0,0,",",",",","Z"])),A.x,A.y,i,i,+(d<0),k.x,k.y,s,s,+(M>180),+(d>0),S.x,S.y,i,i,+(d<0),_.x,_.y)}else w+=Cn(tU||(tU=ju(["L",",","Z"])),t,n);return w},Kke={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},eK=e=>{var t=Xn(e,Kke),{cx:n,cy:s,innerRadius:r,outerRadius:i,cornerRadius:o,forceCornerRadius:l,cornerIsExternal:c,startAngle:u,endAngle:d,className:h}=t;if(i<r||u===d)return null;var p=Rt("recharts-sector",h),x=i-r,b=Fs(o,x,0,!0),j;return b>0&&Math.abs(u-d)<360?j=Qke({cx:n,cy:s,innerRadius:r,outerRadius:i,cornerRadius:Math.min(b,x/2),forceCornerRadius:l,cornerIsExternal:c,startAngle:u,endAngle:d}):j=JQ({cx:n,cy:s,innerRadius:r,outerRadius:i,startAngle:u,endAngle:d}),f.createElement("path",EE({},Ys(t),{className:p,d:j}))};function Xke(e,t,n){if(e==="horizontal")return[{x:t.x,y:n.top},{x:t.x,y:n.top+n.height}];if(e==="vertical")return[{x:n.left,y:t.y},{x:n.left+n.width,y:t.y}];if(PY(t)){if(e==="centric"){var{cx:s,cy:r,innerRadius:i,outerRadius:o,angle:l}=t,c=qn(s,r,i,l),u=qn(s,r,o,l);return[{x:c.x,y:c.y},{x:u.x,y:u.y}]}return ZQ(t)}}var K_={},X_={},Z_={},aU;function Zke(){return aU||(aU=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=qY();function n(s){return t.isSymbol(s)?NaN:Number(s)}e.toNumber=n})(Z_)),Z_}var nU;function Jke(){return nU||(nU=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Zke();function n(s){return s?(s=t.toNumber(s),s===1/0||s===-1/0?(s<0?-1:1)*Number.MAX_VALUE:s===s?s:0):s===0?s:0}e.toFinite=n})(X_)),X_}var sU;function eEe(){return sU||(sU=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=GY(),n=Jke();function s(r,i,o){o&&typeof o!="number"&&t.isIterateeCall(r,i,o)&&(i=o=void 0),r=n.toFinite(r),i===void 0?(i=r,r=0):i=n.toFinite(i),o=o===void 0?r<i?1:-1:n.toFinite(o);const l=Math.max(Math.ceil((i-r)/(o||1)),0),c=new Array(l);for(let u=0;u<l;u++)c[u]=r,r+=o;return c}e.range=s})(K_)),K_}var J_,rU;function tEe(){return rU||(rU=1,J_=eEe().range),J_}var aEe=tEe();const tK=ao(aEe),Zg=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:o4,scaleDiverging:aG,scaleDivergingLog:nG,scaleDivergingPow:D4,scaleDivergingSqrt:_ge,scaleDivergingSymlog:sG,scaleIdentity:Rq,scaleImplicit:Ak,scaleLinear:Kj,scaleLog:Dp,scaleOrdinal:Ap,scalePoint:yfe,scalePow:Xj,scaleQuantile:Bq,scaleQuantize:Hq,scaleRadial:Uq,scaleSequential:E4,scaleSequentialLog:Jq,scaleSequentialPow:L4,scaleSequentialQuantile:tG,scaleSequentialSqrt:Sge,scaleSequentialSymlog:eG,scaleSqrt:Fq,scaleSymlog:y4,scaleThreshold:v4,scaleTime:k4,scaleUtc:Zq,tickFormat:$q},Symbol.toStringTag,{value:"Module"}));var cc=e=>e.chartData,r1=dt([cc],e=>{var t=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),YD=(e,t,n,s)=>s?r1(e):cc(e),nEe=(e,t,n)=>n?r1(e):cc(e);function pd(e){if(Array.isArray(e)&&e.length===2){var[t,n]=e;if(xn(t)&&xn(n))return!0}return!1}function iU(e,t,n){return n?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function aK(e,t){if(t&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[n,s]=e,r,i;if(xn(n))r=n;else if(typeof n=="function")return;if(xn(s))i=s;else if(typeof s=="function")return;var o=[r,i];if(pd(o))return o}}function sEe(e,t,n){if(!(!n&&t==null)){if(typeof e=="function"&&t!=null)try{var s=e(t,n);if(pd(s))return iU(s,t,n)}catch{}if(Array.isArray(e)&&e.length===2){var[r,i]=e,o,l;if(r==="auto")t!=null&&(o=Math.min(...t));else if(Ut(r))o=r;else if(typeof r=="function")try{t!=null&&(o=r(t?.[0]))}catch{}else if(typeof r=="string"&&eF.test(r)){var c=eF.exec(r);if(c==null||c[1]==null||t==null)o=void 0;else{var u=+c[1];o=t[0]-u}}else o=t?.[0];if(i==="auto")t!=null&&(l=Math.max(...t));else if(Ut(i))l=i;else if(typeof i=="function")try{t!=null&&(l=i(t?.[1]))}catch{}else if(typeof i=="string"&&tF.test(i)){var d=tF.exec(i);if(d==null||d[1]==null||t==null)l=void 0;else{var h=+d[1];l=t[1]+h}}else l=t?.[1];var p=[o,l];if(pd(p))return t==null?p:iU(p,t,n)}}}var bh=1e9,rEe={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},KD,un=!0,Ni="[DecimalError] ",Pu=Ni+"Invalid argument: ",QD=Ni+"Exponent out of range: ",vh=Math.floor,ou=Math.pow,iEe=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,$r,ps=1e7,nn=7,nK=9007199254740991,Dw=vh(nK/nn),zt={};zt.absoluteValue=zt.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};zt.comparedTo=zt.cmp=function(e){var t,n,s,r,i=this;if(e=new i.constructor(e),i.s!==e.s)return i.s||-e.s;if(i.e!==e.e)return i.e>e.e^i.s<0?1:-1;for(s=i.d.length,r=e.d.length,t=0,n=s<r?s:r;t<n;++t)if(i.d[t]!==e.d[t])return i.d[t]>e.d[t]^i.s<0?1:-1;return s===r?0:s>r^i.s<0?1:-1};zt.decimalPlaces=zt.dp=function(){var e=this,t=e.d.length-1,n=(t-e.e)*nn;if(t=e.d[t],t)for(;t%10==0;t/=10)n--;return n<0?0:n};zt.dividedBy=zt.div=function(e){return Ml(this,new this.constructor(e))};zt.dividedToIntegerBy=zt.idiv=function(e){var t=this,n=t.constructor;return Ya(Ml(t,new n(e),0,1),n.precision)};zt.equals=zt.eq=function(e){return!this.cmp(e)};zt.exponent=function(){return Wn(this)};zt.greaterThan=zt.gt=function(e){return this.cmp(e)>0};zt.greaterThanOrEqualTo=zt.gte=function(e){return this.cmp(e)>=0};zt.isInteger=zt.isint=function(){return this.e>this.d.length-2};zt.isNegative=zt.isneg=function(){return this.s<0};zt.isPositive=zt.ispos=function(){return this.s>0};zt.isZero=function(){return this.s===0};zt.lessThan=zt.lt=function(e){return this.cmp(e)<0};zt.lessThanOrEqualTo=zt.lte=function(e){return this.cmp(e)<1};zt.logarithm=zt.log=function(e){var t,n=this,s=n.constructor,r=s.precision,i=r+5;if(e===void 0)e=new s(10);else if(e=new s(e),e.s<1||e.eq($r))throw Error(Ni+"NaN");if(n.s<1)throw Error(Ni+(n.s?"NaN":"-Infinity"));return n.eq($r)?new s(0):(un=!1,t=Ml(Yp(n,i),Yp(e,i),i),un=!0,Ya(t,r))};zt.minus=zt.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?iK(t,e):sK(t,(e.s=-e.s,e))};zt.modulo=zt.mod=function(e){var t,n=this,s=n.constructor,r=s.precision;if(e=new s(e),!e.s)throw Error(Ni+"NaN");return n.s?(un=!1,t=Ml(n,e,0,1).times(e),un=!0,n.minus(t)):Ya(new s(n),r)};zt.naturalExponential=zt.exp=function(){return rK(this)};zt.naturalLogarithm=zt.ln=function(){return Yp(this)};zt.negated=zt.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};zt.plus=zt.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?sK(t,e):iK(t,(e.s=-e.s,e))};zt.precision=zt.sd=function(e){var t,n,s,r=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Pu+e);if(t=Wn(r)+1,s=r.d.length-1,n=s*nn+1,s=r.d[s],s){for(;s%10==0;s/=10)n--;for(s=r.d[0];s>=10;s/=10)n++}return e&&t>n?t:n};zt.squareRoot=zt.sqrt=function(){var e,t,n,s,r,i,o,l=this,c=l.constructor;if(l.s<1){if(!l.s)return new c(0);throw Error(Ni+"NaN")}for(e=Wn(l),un=!1,r=Math.sqrt(+l),r==0||r==1/0?(t=Oo(l.d),(t.length+e)%2==0&&(t+="0"),r=Math.sqrt(t),e=vh((e+1)/2)-(e<0||e%2),r==1/0?t="5e"+e:(t=r.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),s=new c(t)):s=new c(r.toString()),n=c.precision,r=o=n+3;;)if(i=s,s=i.plus(Ml(l,i,o+2)).times(.5),Oo(i.d).slice(0,o)===(t=Oo(s.d)).slice(0,o)){if(t=t.slice(o-3,o+1),r==o&&t=="4999"){if(Ya(i,n+1,0),i.times(i).eq(l)){s=i;break}}else if(t!="9999")break;o+=4}return un=!0,Ya(s,n)};zt.times=zt.mul=function(e){var t,n,s,r,i,o,l,c,u,d=this,h=d.constructor,p=d.d,x=(e=new h(e)).d;if(!d.s||!e.s)return new h(0);for(e.s*=d.s,n=d.e+e.e,c=p.length,u=x.length,c<u&&(i=p,p=x,x=i,o=c,c=u,u=o),i=[],o=c+u,s=o;s--;)i.push(0);for(s=u;--s>=0;){for(t=0,r=c+s;r>s;)l=i[r]+x[s]*p[r-s-1]+t,i[r--]=l%ps|0,t=l/ps|0;i[r]=(i[r]+t)%ps|0}for(;!i[--o];)i.pop();return t?++n:i.shift(),e.d=i,e.e=n,un?Ya(e,h.precision):e};zt.toDecimalPlaces=zt.todp=function(e,t){var n=this,s=n.constructor;return n=new s(n),e===void 0?n:(Go(e,0,bh),t===void 0?t=s.rounding:Go(t,0,8),Ya(n,e+Wn(n)+1,t))};zt.toExponential=function(e,t){var n,s=this,r=s.constructor;return e===void 0?n=Ku(s,!0):(Go(e,0,bh),t===void 0?t=r.rounding:Go(t,0,8),s=Ya(new r(s),e+1,t),n=Ku(s,!0,e+1)),n};zt.toFixed=function(e,t){var n,s,r=this,i=r.constructor;return e===void 0?Ku(r):(Go(e,0,bh),t===void 0?t=i.rounding:Go(t,0,8),s=Ya(new i(r),e+Wn(r)+1,t),n=Ku(s.abs(),!1,e+Wn(s)+1),r.isneg()&&!r.isZero()?"-"+n:n)};zt.toInteger=zt.toint=function(){var e=this,t=e.constructor;return Ya(new t(e),Wn(e)+1,t.rounding)};zt.toNumber=function(){return+this};zt.toPower=zt.pow=function(e){var t,n,s,r,i,o,l=this,c=l.constructor,u=12,d=+(e=new c(e));if(!e.s)return new c($r);if(l=new c(l),!l.s){if(e.s<1)throw Error(Ni+"Infinity");return l}if(l.eq($r))return l;if(s=c.precision,e.eq($r))return Ya(l,s);if(t=e.e,n=e.d.length-1,o=t>=n,i=l.s,o){if((n=d<0?-d:d)<=nK){for(r=new c($r),t=Math.ceil(s/nn+4),un=!1;n%2&&(r=r.times(l),lU(r.d,t)),n=vh(n/2),n!==0;)l=l.times(l),lU(l.d,t);return un=!0,e.s<0?new c($r).div(r):Ya(r,s)}}else if(i<0)throw Error(Ni+"NaN");return i=i<0&&e.d[Math.max(t,n)]&1?-1:1,l.s=1,un=!1,r=e.times(Yp(l,s+u)),un=!0,r=rK(r),r.s=i,r};zt.toPrecision=function(e,t){var n,s,r=this,i=r.constructor;return e===void 0?(n=Wn(r),s=Ku(r,n<=i.toExpNeg||n>=i.toExpPos)):(Go(e,1,bh),t===void 0?t=i.rounding:Go(t,0,8),r=Ya(new i(r),e,t),n=Wn(r),s=Ku(r,e<=n||n<=i.toExpNeg,e)),s};zt.toSignificantDigits=zt.tosd=function(e,t){var n=this,s=n.constructor;return e===void 0?(e=s.precision,t=s.rounding):(Go(e,1,bh),t===void 0?t=s.rounding:Go(t,0,8)),Ya(new s(n),e,t)};zt.toString=zt.valueOf=zt.val=zt.toJSON=zt[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Wn(e),n=e.constructor;return Ku(e,t<=n.toExpNeg||t>=n.toExpPos)};function sK(e,t){var n,s,r,i,o,l,c,u,d=e.constructor,h=d.precision;if(!e.s||!t.s)return t.s||(t=new d(e)),un?Ya(t,h):t;if(c=e.d,u=t.d,o=e.e,r=t.e,c=c.slice(),i=o-r,i){for(i<0?(s=c,i=-i,l=u.length):(s=u,r=o,l=c.length),o=Math.ceil(h/nn),l=o>l?o+1:l+1,i>l&&(i=l,s.length=1),s.reverse();i--;)s.push(0);s.reverse()}for(l=c.length,i=u.length,l-i<0&&(i=l,s=u,u=c,c=s),n=0;i;)n=(c[--i]=c[i]+u[i]+n)/ps|0,c[i]%=ps;for(n&&(c.unshift(n),++r),l=c.length;c[--l]==0;)c.pop();return t.d=c,t.e=r,un?Ya(t,h):t}function Go(e,t,n){if(e!==~~e||e<t||e>n)throw Error(Pu+e)}function Oo(e){var t,n,s,r=e.length-1,i="",o=e[0];if(r>0){for(i+=o,t=1;t<r;t++)s=e[t]+"",n=nn-s.length,n&&(i+=Yc(n)),i+=s;o=e[t],s=o+"",n=nn-s.length,n&&(i+=Yc(n))}else if(o===0)return"0";for(;o%10===0;)o/=10;return i+o}var Ml=(function(){function e(s,r){var i,o=0,l=s.length;for(s=s.slice();l--;)i=s[l]*r+o,s[l]=i%ps|0,o=i/ps|0;return o&&s.unshift(o),s}function t(s,r,i,o){var l,c;if(i!=o)c=i>o?1:-1;else for(l=c=0;l<i;l++)if(s[l]!=r[l]){c=s[l]>r[l]?1:-1;break}return c}function n(s,r,i){for(var o=0;i--;)s[i]-=o,o=s[i]<r[i]?1:0,s[i]=o*ps+s[i]-r[i];for(;!s[0]&&s.length>1;)s.shift()}return function(s,r,i,o){var l,c,u,d,h,p,x,b,j,y,N,w,S,_,T,k,A,E,M=s.constructor,F=s.s==r.s?1:-1,D=s.d,P=r.d;if(!s.s)return new M(s);if(!r.s)throw Error(Ni+"Division by zero");for(c=s.e-r.e,A=P.length,T=D.length,x=new M(F),b=x.d=[],u=0;P[u]==(D[u]||0);)++u;if(P[u]>(D[u]||0)&&--c,i==null?w=i=M.precision:o?w=i+(Wn(s)-Wn(r))+1:w=i,w<0)return new M(0);if(w=w/nn+2|0,u=0,A==1)for(d=0,P=P[0],w++;(u<T||d)&&w--;u++)S=d*ps+(D[u]||0),b[u]=S/P|0,d=S%P|0;else{for(d=ps/(P[0]+1)|0,d>1&&(P=e(P,d),D=e(D,d),A=P.length,T=D.length),_=A,j=D.slice(0,A),y=j.length;y<A;)j[y++]=0;E=P.slice(),E.unshift(0),k=P[0],P[1]>=ps/2&&++k;do d=0,l=t(P,j,A,y),l<0?(N=j[0],A!=y&&(N=N*ps+(j[1]||0)),d=N/k|0,d>1?(d>=ps&&(d=ps-1),h=e(P,d),p=h.length,y=j.length,l=t(h,j,p,y),l==1&&(d--,n(h,A<p?E:P,p))):(d==0&&(l=d=1),h=P.slice()),p=h.length,p<y&&h.unshift(0),n(j,h,y),l==-1&&(y=j.length,l=t(P,j,A,y),l<1&&(d++,n(j,A<y?E:P,y))),y=j.length):l===0&&(d++,j=[0]),b[u++]=d,l&&j[0]?j[y++]=D[_]||0:(j=[D[_]],y=1);while((_++<T||j[0]!==void 0)&&w--)}return b[0]||b.shift(),x.e=c,Ya(x,o?i+Wn(x)+1:i)}})();function rK(e,t){var n,s,r,i,o,l,c=0,u=0,d=e.constructor,h=d.precision;if(Wn(e)>16)throw Error(QD+Wn(e));if(!e.s)return new d($r);for(un=!1,l=h,o=new d(.03125);e.abs().gte(.1);)e=e.times(o),u+=5;for(s=Math.log(ou(2,u))/Math.LN10*2+5|0,l+=s,n=r=i=new d($r),d.precision=l;;){if(r=Ya(r.times(e),l),n=n.times(++c),o=i.plus(Ml(r,n,l)),Oo(o.d).slice(0,l)===Oo(i.d).slice(0,l)){for(;u--;)i=Ya(i.times(i),l);return d.precision=h,t==null?(un=!0,Ya(i,h)):i}i=o}}function Wn(e){for(var t=e.e*nn,n=e.d[0];n>=10;n/=10)t++;return t}function eA(e,t,n){if(t>e.LN10.sd())throw un=!0,n&&(e.precision=n),Error(Ni+"LN10 precision limit exceeded");return Ya(new e(e.LN10),t)}function Yc(e){for(var t="";e--;)t+="0";return t}function Yp(e,t){var n,s,r,i,o,l,c,u,d,h=1,p=10,x=e,b=x.d,j=x.constructor,y=j.precision;if(x.s<1)throw Error(Ni+(x.s?"NaN":"-Infinity"));if(x.eq($r))return new j(0);if(t==null?(un=!1,u=y):u=t,x.eq(10))return t==null&&(un=!0),eA(j,u);if(u+=p,j.precision=u,n=Oo(b),s=n.charAt(0),i=Wn(x),Math.abs(i)<15e14){for(;s<7&&s!=1||s==1&&n.charAt(1)>3;)x=x.times(e),n=Oo(x.d),s=n.charAt(0),h++;i=Wn(x),s>1?(x=new j("0."+n),i++):x=new j(s+"."+n.slice(1))}else return c=eA(j,u+2,y).times(i+""),x=Yp(new j(s+"."+n.slice(1)),u-p).plus(c),j.precision=y,t==null?(un=!0,Ya(x,y)):x;for(l=o=x=Ml(x.minus($r),x.plus($r),u),d=Ya(x.times(x),u),r=3;;){if(o=Ya(o.times(d),u),c=l.plus(Ml(o,new j(r),u)),Oo(c.d).slice(0,u)===Oo(l.d).slice(0,u))return l=l.times(2),i!==0&&(l=l.plus(eA(j,u+2,y).times(i+""))),l=Ml(l,new j(h),u),j.precision=y,t==null?(un=!0,Ya(l,y)):l;l=c,r+=2}}function oU(e,t){var n,s,r;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(s=t.search(/e/i))>0?(n<0&&(n=s),n+=+t.slice(s+1),t=t.substring(0,s)):n<0&&(n=t.length),s=0;t.charCodeAt(s)===48;)++s;for(r=t.length;t.charCodeAt(r-1)===48;)--r;if(t=t.slice(s,r),t){if(r-=s,n=n-s-1,e.e=vh(n/nn),e.d=[],s=(n+1)%nn,n<0&&(s+=nn),s<r){for(s&&e.d.push(+t.slice(0,s)),r-=nn;s<r;)e.d.push(+t.slice(s,s+=nn));t=t.slice(s),s=nn-t.length}else s-=r;for(;s--;)t+="0";if(e.d.push(+t),un&&(e.e>Dw||e.e<-Dw))throw Error(QD+n)}else e.s=0,e.e=0,e.d=[0];return e}function Ya(e,t,n){var s,r,i,o,l,c,u,d,h=e.d;for(o=1,i=h[0];i>=10;i/=10)o++;if(s=t-o,s<0)s+=nn,r=t,u=h[d=0];else{if(d=Math.ceil((s+1)/nn),i=h.length,d>=i)return e;for(u=i=h[d],o=1;i>=10;i/=10)o++;s%=nn,r=s-nn+o}if(n!==void 0&&(i=ou(10,o-r-1),l=u/i%10|0,c=t<0||h[d+1]!==void 0||u%i,c=n<4?(l||c)&&(n==0||n==(e.s<0?3:2)):l>5||l==5&&(n==4||c||n==6&&(s>0?r>0?u/ou(10,o-r):0:h[d-1])%10&1||n==(e.s<0?8:7))),t<1||!h[0])return c?(i=Wn(e),h.length=1,t=t-i-1,h[0]=ou(10,(nn-t%nn)%nn),e.e=vh(-t/nn)||0):(h.length=1,h[0]=e.e=e.s=0),e;if(s==0?(h.length=d,i=1,d--):(h.length=d+1,i=ou(10,nn-s),h[d]=r>0?(u/ou(10,o-r)%ou(10,r)|0)*i:0),c)for(;;)if(d==0){(h[0]+=i)==ps&&(h[0]=1,++e.e);break}else{if(h[d]+=i,h[d]!=ps)break;h[d--]=0,i=1}for(s=h.length;h[--s]===0;)h.pop();if(un&&(e.e>Dw||e.e<-Dw))throw Error(QD+Wn(e));return e}function iK(e,t){var n,s,r,i,o,l,c,u,d,h,p=e.constructor,x=p.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new p(e),un?Ya(t,x):t;if(c=e.d,h=t.d,s=t.e,u=e.e,c=c.slice(),o=u-s,o){for(d=o<0,d?(n=c,o=-o,l=h.length):(n=h,s=u,l=c.length),r=Math.max(Math.ceil(x/nn),l)+2,o>r&&(o=r,n.length=1),n.reverse(),r=o;r--;)n.push(0);n.reverse()}else{for(r=c.length,l=h.length,d=r<l,d&&(l=r),r=0;r<l;r++)if(c[r]!=h[r]){d=c[r]<h[r];break}o=0}for(d&&(n=c,c=h,h=n,t.s=-t.s),l=c.length,r=h.length-l;r>0;--r)c[l++]=0;for(r=h.length;r>o;){if(c[--r]<h[r]){for(i=r;i&&c[--i]===0;)c[i]=ps-1;--c[i],c[r]+=ps}c[r]-=h[r]}for(;c[--l]===0;)c.pop();for(;c[0]===0;c.shift())--s;return c[0]?(t.d=c,t.e=s,un?Ya(t,x):t):new p(0)}function Ku(e,t,n){var s,r=Wn(e),i=Oo(e.d),o=i.length;return t?(n&&(s=n-o)>0?i=i.charAt(0)+"."+i.slice(1)+Yc(s):o>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(r<0?"e":"e+")+r):r<0?(i="0."+Yc(-r-1)+i,n&&(s=n-o)>0&&(i+=Yc(s))):r>=o?(i+=Yc(r+1-o),n&&(s=n-r-1)>0&&(i=i+"."+Yc(s))):((s=r+1)<o&&(i=i.slice(0,s)+"."+i.slice(s)),n&&(s=n-o)>0&&(r+1===o&&(i+="."),i+=Yc(s))),e.s<0?"-"+i:i}function lU(e,t){if(e.length>t)return e.length=t,!0}function oK(e){var t,n,s;function r(i){var o=this;if(!(o instanceof r))return new r(i);if(o.constructor=r,i instanceof r){o.s=i.s,o.e=i.e,o.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(Pu+i);if(i>0)o.s=1;else if(i<0)i=-i,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(i===~~i&&i<1e7){o.e=0,o.d=[i];return}return oU(o,i.toString())}else if(typeof i!="string")throw Error(Pu+i);if(i.charCodeAt(0)===45?(i=i.slice(1),o.s=-1):o.s=1,iEe.test(i))oU(o,i);else throw Error(Pu+i)}if(r.prototype=zt,r.ROUND_UP=0,r.ROUND_DOWN=1,r.ROUND_CEIL=2,r.ROUND_FLOOR=3,r.ROUND_HALF_UP=4,r.ROUND_HALF_DOWN=5,r.ROUND_HALF_EVEN=6,r.ROUND_HALF_CEIL=7,r.ROUND_HALF_FLOOR=8,r.clone=oK,r.config=r.set=oEe,e===void 0&&(e={}),e)for(s=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<s.length;)e.hasOwnProperty(n=s[t++])||(e[n]=this[n]);return r.config(e),r}function oEe(e){if(!e||typeof e!="object")throw Error(Ni+"Object expected");var t,n,s,r=["precision",1,bh,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<r.length;t+=3)if((s=e[n=r[t]])!==void 0)if(vh(s)===s&&s>=r[t+1]&&s<=r[t+2])this[n]=s;else throw Error(Pu+n+": "+s);if((s=e[n="LN10"])!==void 0)if(s==Math.LN10)this[n]=new this(s);else throw Error(Pu+n+": "+s);return this}var KD=oK(rEe);$r=new KD(1);const za=KD;var lEe=e=>e,lK={},cK=e=>e===lK,cU=e=>function t(){return arguments.length===0||arguments.length===1&&cK(arguments.length<=0?void 0:arguments[0])?t:e(...arguments)},dK=(e,t)=>e===1?t:cU(function(){for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];var i=s.filter(o=>o!==lK).length;return i>=e?t(...s):dK(e-i,cU(function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];var u=s.map(d=>cK(d)?l.shift():d);return t(...u,...l)}))}),cEe=e=>dK(e.length,e),LE=(e,t)=>{for(var n=[],s=e;s<t;++s)n[s-e]=s;return n},dEe=cEe((e,t)=>Array.isArray(t)?t.map(e):Object.keys(t).map(n=>t[n]).map(e)),uEe=function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];if(!n.length)return lEe;var r=n.reverse(),i=r[0],o=r.slice(1);return function(){return o.reduce((l,c)=>c(l),i(...arguments))}};function uK(e){var t;return e===0?t=1:t=Math.floor(new za(e).abs().log(10).toNumber())+1,t}function mK(e,t,n){for(var s=new za(e),r=0,i=[];s.lt(t)&&r<1e5;)i.push(s.toNumber()),s=s.add(n),r++;return i}var fK=e=>{var[t,n]=e,[s,r]=[t,n];return t>n&&([s,r]=[n,t]),[s,r]},hK=(e,t,n)=>{if(e.lte(0))return new za(0);var s=uK(e.toNumber()),r=new za(10).pow(s),i=e.div(r),o=s!==1?.05:.1,l=new za(Math.ceil(i.div(o).toNumber())).add(n).mul(o),c=l.mul(r);return t?new za(c.toNumber()):new za(Math.ceil(c.toNumber()))},mEe=(e,t,n)=>{var s=new za(1),r=new za(e);if(!r.isint()&&n){var i=Math.abs(e);i<1?(s=new za(10).pow(uK(e)-1),r=new za(Math.floor(r.div(s).toNumber())).mul(s)):i>1&&(r=new za(Math.floor(e)))}else e===0?r=new za(Math.floor((t-1)/2)):n||(r=new za(Math.floor(e)));var o=Math.floor((t-1)/2),l=uEe(dEe(c=>r.add(new za(c-o).mul(s)).toNumber()),LE);return l(0,t)},gK=function(t,n,s,r){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((n-t)/(s-1)))return{step:new za(0),tickMin:new za(0),tickMax:new za(0)};var o=hK(new za(n).sub(t).div(s-1),r,i),l;t<=0&&n>=0?l=new za(0):(l=new za(t).add(n).div(2),l=l.sub(new za(l).mod(o)));var c=Math.ceil(l.sub(t).div(o).toNumber()),u=Math.ceil(new za(n).sub(l).div(o).toNumber()),d=c+u+1;return d>s?gK(t,n,s,r,i+1):(d<s&&(u=n>0?u+(s-d):u,c=n>0?c:c+(s-d)),{step:o,tickMin:l.sub(new za(c).mul(o)),tickMax:l.add(new za(u).mul(o))})},fEe=function(t){var[n,s]=t,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=Math.max(r,2),[l,c]=fK([n,s]);if(l===-1/0||c===1/0){var u=c===1/0?[l,...LE(0,r-1).map(()=>1/0)]:[...LE(0,r-1).map(()=>-1/0),c];return n>s?u.reverse():u}if(l===c)return mEe(l,r,i);var{step:d,tickMin:h,tickMax:p}=gK(l,c,o,i,0),x=mK(h,p.add(new za(.1).mul(d)),d);return n>s?x.reverse():x},hEe=function(t,n){var[s,r]=t,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[o,l]=fK([s,r]);if(o===-1/0||l===1/0)return[s,r];if(o===l)return[o];var c=Math.max(n,2),u=hK(new za(l).sub(o).div(c-1),i,0),d=[...mK(new za(o),new za(l),u),l];return i===!1&&(d=d.map(h=>Math.round(h))),s>r?d.reverse():d},pK=e=>e.rootProps.maxBarSize,gEe=e=>e.rootProps.barGap,xK=e=>e.rootProps.barCategoryGap,pEe=e=>e.rootProps.barSize,d0=e=>e.rootProps.stackOffset,yK=e=>e.rootProps.reverseStackOrder,XD=e=>e.options.chartName,ZD=e=>e.rootProps.syncId,bK=e=>e.rootProps.syncMethod,JD=e=>e.options.eventEmitter,Gn={grid:-100,barBackground:-50,area:100,cursorRectangle:200,bar:300,line:400,axis:500,scatter:600,activeBar:1e3,cursorLine:1100,activeDot:1200,label:2e3},Tl={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},Mr={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},i1=(e,t)=>{if(!(!e||!t))return e!=null&&e.reversed?[t[1],t[0]]:t},xEe={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:Tl.angleAxisId,includeHidden:!1,name:void 0,reversed:Tl.reversed,scale:Tl.scale,tick:Tl.tick,tickCount:void 0,ticks:void 0,type:Tl.type,unit:void 0},yEe={allowDataOverflow:Mr.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:Mr.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Mr.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Mr.scale,tick:Mr.tick,tickCount:Mr.tickCount,ticks:void 0,type:Mr.type,unit:void 0},bEe={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:Tl.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Tl.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Tl.scale,tick:Tl.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},vEe={allowDataOverflow:Mr.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:Mr.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Mr.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Mr.scale,tick:Mr.tick,tickCount:Mr.tickCount,ticks:void 0,type:"category",unit:void 0},eP=(e,t)=>e.polarAxis.angleAxis[t]!=null?e.polarAxis.angleAxis[t]:e.layout.layoutType==="radial"?bEe:xEe,tP=(e,t)=>e.polarAxis.radiusAxis[t]!=null?e.polarAxis.radiusAxis[t]:e.layout.layoutType==="radial"?vEe:yEe,o1=e=>e.polarOptions,aP=dt([oc,lc,ds],XQ),vK=dt([o1,aP],(e,t)=>{if(e!=null)return Fs(e.innerRadius,t,0)}),wK=dt([o1,aP],(e,t)=>{if(e!=null)return Fs(e.outerRadius,t,t*.8)}),wEe=e=>{if(e==null)return[0,0];var{startAngle:t,endAngle:n}=e;return[t,n]},jK=dt([o1],wEe);dt([eP,jK],i1);var NK=dt([aP,vK,wK],(e,t,n)=>{if(!(e==null||t==null||n==null))return[t,n]});dt([tP,NK],i1);var CK=dt([wa,o1,vK,wK,oc,lc],(e,t,n,s,r,i)=>{if(!(e!=="centric"&&e!=="radial"||t==null||n==null||s==null)){var{cx:o,cy:l,startAngle:c,endAngle:u}=t;return{cx:Fs(o,r,r/2),cy:Fs(l,i,i/2),innerRadius:n,outerRadius:s,startAngle:c,endAngle:u,clockWise:!1}}}),pn=(e,t)=>t,u0=(e,t,n)=>n;function nP(e){return e?.id}function SK(e,t,n){var{chartData:s=[]}=t,{allowDuplicatedCategory:r,dataKey:i}=n,o=new Map;return e.forEach(l=>{var c,u=(c=l.data)!==null&&c!==void 0?c:s;if(!(u==null||u.length===0)){var d=nP(l);u.forEach((h,p)=>{var x=i==null||r?p:String(Ga(h,i,null)),b=Ga(h,l.dataKey,0),j;o.has(x)?j=o.get(x):j={},Object.assign(j,{[d]:b}),o.set(x,j)})}}),Array.from(o.values())}function l1(e){return"stackId"in e&&e.stackId!=null&&e.dataKey!=null}var c1=(e,t)=>e===t?!0:e==null||t==null?!1:e[0]===t[0]&&e[1]===t[1];function d1(e,t){return Array.isArray(e)&&Array.isArray(t)&&e.length===0&&t.length===0?!0:e===t}function jEe(e,t){if(e.length===t.length){for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}return!1}var us=e=>{var t=wa(e);return t==="horizontal"?"xAxis":t==="vertical"?"yAxis":t==="centric"?"angleAxis":"radiusAxis"},wh=e=>e.tooltip.settings.axisId;function dU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function Pw(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?dU(Object(n),!0).forEach(function(s){NEe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dU(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function NEe(e,t,n){return(t=CEe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function CEe(e){var t=SEe(e,"string");return typeof t=="symbol"?t:t+""}function SEe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var DE=[0,"auto"],hs={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},_K=(e,t)=>e.cartesianAxis.xAxis[t],dc=(e,t)=>{var n=_K(e,t);return n??hs},gs={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:DE,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:i0},AK=(e,t)=>e.cartesianAxis.yAxis[t],uc=(e,t)=>{var n=AK(e,t);return n??gs},_Ee={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},sP=(e,t)=>{var n=e.cartesianAxis.zAxis[t];return n??_Ee},bn=(e,t,n)=>{switch(t){case"xAxis":return dc(e,n);case"yAxis":return uc(e,n);case"zAxis":return sP(e,n);case"angleAxis":return eP(e,n);case"radiusAxis":return tP(e,n);default:throw new Error("Unexpected axis type: ".concat(t))}},AEe=(e,t,n)=>{switch(t){case"xAxis":return dc(e,n);case"yAxis":return uc(e,n);default:throw new Error("Unexpected axis type: ".concat(t))}},m0=(e,t,n)=>{switch(t){case"xAxis":return dc(e,n);case"yAxis":return uc(e,n);case"angleAxis":return eP(e,n);case"radiusAxis":return tP(e,n);default:throw new Error("Unexpected axis type: ".concat(t))}},TK=e=>e.graphicalItems.cartesianItems.some(t=>t.type==="bar")||e.graphicalItems.polarItems.some(t=>t.type==="radialBar");function rP(e,t){return n=>{switch(e){case"xAxis":return"xAxisId"in n&&n.xAxisId===t;case"yAxis":return"yAxisId"in n&&n.yAxisId===t;case"zAxis":return"zAxisId"in n&&n.zAxisId===t;case"angleAxis":return"angleAxisId"in n&&n.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in n&&n.radiusAxisId===t;default:return!1}}}var u1=e=>e.graphicalItems.cartesianItems,TEe=dt([pn,u0],rP),iP=(e,t,n)=>e.filter(n).filter(s=>t?.includeHidden===!0?!0:!s.hide),f0=dt([u1,bn,TEe],iP,{memoizeOptions:{resultEqualityCheck:d1}}),kK=dt([f0],e=>e.filter(t=>t.type==="area"||t.type==="bar").filter(l1)),EK=e=>e.filter(t=>!("stackId"in t)||t.stackId===void 0),kEe=dt([f0],EK),oP=e=>e.map(t=>t.data).filter(Boolean).flat(1),EEe=dt([f0],oP,{memoizeOptions:{resultEqualityCheck:d1}}),lP=(e,t)=>{var{chartData:n=[],dataStartIndex:s,dataEndIndex:r}=t;return e.length>0?e:n.slice(s,r+1)},cP=dt([EEe,YD],lP),dP=(e,t,n)=>t?.dataKey!=null?e.map(s=>({value:Ga(s,t.dataKey)})):n.length>0?n.map(s=>s.dataKey).flatMap(s=>e.map(r=>({value:Ga(r,s)}))):e.map(s=>({value:s})),m1=dt([cP,bn,f0],dP);function LK(e,t){switch(e){case"xAxis":return t.direction==="x";case"yAxis":return t.direction==="y";default:return!1}}function Nv(e){if(Ho(e)||e instanceof Date){var t=Number(e);if(xn(t))return t}}function uU(e){if(Array.isArray(e)){var t=[Nv(e[0]),Nv(e[1])];return pd(t)?t:void 0}var n=Nv(e);if(n!=null)return[n,n]}function Xl(e){return e.map(Nv).filter(m2e)}function LEe(e,t,n){return!n||typeof t!="number"||eo(t)?[]:n.length?Xl(n.flatMap(s=>{var r=Ga(e,s.dataKey),i,o;if(Array.isArray(r)?[i,o]=r:i=o=r,!(!xn(i)||!xn(o)))return[t-i,t+o]})):[]}var ms=e=>{var t=us(e),n=wh(e);return m0(e,t,n)},h0=dt([ms],e=>e?.dataKey),DEe=dt([kK,YD,ms],SK),DK=(e,t,n,s)=>{var r={},i=t.reduce((o,l)=>{if(l.stackId==null)return o;var c=o[l.stackId];return c==null&&(c=[]),c.push(l),o[l.stackId]=c,o},r);return Object.fromEntries(Object.entries(i).map(o=>{var[l,c]=o,u=s?[...c].reverse():c,d=u.map(nP);return[l,{stackedData:CAe(e,d,n),graphicalItems:u}]}))},PE=dt([DEe,kK,d0,yK],DK),PK=(e,t,n,s)=>{var{dataStartIndex:r,dataEndIndex:i}=t;if(s==null&&n!=="zAxis"){var o=kAe(e,r,i);if(!(o!=null&&o[0]===0&&o[1]===0))return o}},PEe=dt([bn],e=>e.allowDataOverflow),uP=e=>{var t;if(e==null||!("domain"in e))return DE;if(e.domain!=null)return e.domain;if("ticks"in e&&e.ticks!=null){if(e.type==="number"){var n=Xl(e.ticks);return[Math.min(...n),Math.max(...n)]}if(e.type==="category")return e.ticks.map(String)}return(t=e?.domain)!==null&&t!==void 0?t:DE},mP=dt([bn],uP),fP=dt([mP,PEe],aK),OEe=dt([PE,cc,pn,fP],PK,{memoizeOptions:{resultEqualityCheck:c1}}),f1=e=>e.errorBars,MEe=(e,t,n)=>e.flatMap(s=>t[s.id]).filter(Boolean).filter(s=>LK(n,s)),Ow=function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];var r=n.filter(Boolean);if(r.length!==0){var i=r.flat(),o=Math.min(...i),l=Math.max(...i);return[o,l]}},hP=(e,t,n,s,r)=>{var i,o;if(n.length>0&&e.forEach(l=>{n.forEach(c=>{var u,d,h=(u=s[c.id])===null||u===void 0?void 0:u.filter(N=>LK(r,N)),p=Ga(l,(d=t.dataKey)!==null&&d!==void 0?d:c.dataKey),x=LEe(l,p,h);if(x.length>=2){var b=Math.min(...x),j=Math.max(...x);(i==null||b<i)&&(i=b),(o==null||j>o)&&(o=j)}var y=uU(p);y!=null&&(i=i==null?y[0]:Math.min(i,y[0]),o=o==null?y[1]:Math.max(o,y[1]))})}),t?.dataKey!=null&&e.forEach(l=>{var c=uU(Ga(l,t.dataKey));c!=null&&(i=i==null?c[0]:Math.min(i,c[0]),o=o==null?c[1]:Math.max(o,c[1]))}),xn(i)&&xn(o))return[i,o]},IEe=dt([cP,bn,kEe,f1,pn],hP,{memoizeOptions:{resultEqualityCheck:c1}});function $Ee(e){var{value:t}=e;if(Ho(t)||t instanceof Date)return t}var REe=(e,t,n)=>{var s=e.map($Ee).filter(r=>r!=null);return n&&(t.dataKey==null||t.allowDuplicatedCategory&&EY(s))?tK(0,e.length):t.allowDuplicatedCategory?s:Array.from(new Set(s))},OK=e=>e.referenceElements.dots,jh=(e,t,n)=>e.filter(s=>s.ifOverflow==="extendDomain").filter(s=>t==="xAxis"?s.xAxisId===n:s.yAxisId===n),zEe=dt([OK,pn,u0],jh),MK=e=>e.referenceElements.areas,FEe=dt([MK,pn,u0],jh),IK=e=>e.referenceElements.lines,UEe=dt([IK,pn,u0],jh),$K=(e,t)=>{if(e!=null){var n=Xl(e.map(s=>t==="xAxis"?s.x:s.y));if(n.length!==0)return[Math.min(...n),Math.max(...n)]}},BEe=dt(zEe,pn,$K),RK=(e,t)=>{if(e!=null){var n=Xl(e.flatMap(s=>[t==="xAxis"?s.x1:s.y1,t==="xAxis"?s.x2:s.y2]));if(n.length!==0)return[Math.min(...n),Math.max(...n)]}},HEe=dt([FEe,pn],RK);function qEe(e){var t;if(e.x!=null)return Xl([e.x]);var n=(t=e.segment)===null||t===void 0?void 0:t.map(s=>s.x);return n==null||n.length===0?[]:Xl(n)}function GEe(e){var t;if(e.y!=null)return Xl([e.y]);var n=(t=e.segment)===null||t===void 0?void 0:t.map(s=>s.y);return n==null||n.length===0?[]:Xl(n)}var zK=(e,t)=>{if(e!=null){var n=e.flatMap(s=>t==="xAxis"?qEe(s):GEe(s));if(n.length!==0)return[Math.min(...n),Math.max(...n)]}},WEe=dt([UEe,pn],zK),VEe=dt(BEe,WEe,HEe,(e,t,n)=>Ow(e,n,t)),gP=(e,t,n,s,r,i,o,l)=>{if(n!=null)return n;var c=o==="vertical"&&l==="xAxis"||o==="horizontal"&&l==="yAxis",u=c?Ow(s,i,r):Ow(i,r);return sEe(t,u,e.allowDataOverflow)},YEe=dt([bn,mP,fP,OEe,IEe,VEe,wa,pn],gP,{memoizeOptions:{resultEqualityCheck:c1}}),QEe=[0,1],pP=(e,t,n,s,r,i,o)=>{if(!((e==null||n==null||n.length===0)&&o===void 0)){var{dataKey:l,type:c}=e,u=Ld(t,i);if(u&&l==null){var d;return tK(0,(d=n?.length)!==null&&d!==void 0?d:0)}return c==="category"?REe(s,e,u):r==="expand"?QEe:o}},xP=dt([bn,wa,cP,m1,d0,pn,YEe],pP),FK=(e,t,n,s,r)=>{if(e!=null){var{scale:i,type:o}=e;if(i==="auto")return t==="radial"&&r==="radiusAxis"?"band":t==="radial"&&r==="angleAxis"?"linear":o==="category"&&s&&(s.indexOf("LineChart")>=0||s.indexOf("AreaChart")>=0||s.indexOf("ComposedChart")>=0&&!n)?"point":o==="category"?"band":"linear";if(typeof i=="string"){var l="scale".concat(e0(i));return l in Zg?l:"point"}}},Nh=dt([bn,wa,TK,XD,pn],FK);function KEe(e){if(e!=null){if(e in Zg)return Zg[e]();var t="scale".concat(e0(e));if(t in Zg)return Zg[t]()}}function yP(e,t,n,s){if(!(n==null||s==null)){if(typeof e.scale=="function")return e.scale.copy().domain(n).range(s);var r=KEe(t);if(r!=null){var i=r.domain(n).range(s);return bAe(i),i}}}var bP=(e,t,n)=>{var s=uP(t);if(!(n!=="auto"&&n!=="linear")){if(t!=null&&t.tickCount&&Array.isArray(s)&&(s[0]==="auto"||s[1]==="auto")&&pd(e))return fEe(e,t.tickCount,t.allowDecimals);if(t!=null&&t.tickCount&&t.type==="number"&&pd(e))return hEe(e,t.tickCount,t.allowDecimals)}},vP=dt([xP,m0,Nh],bP),wP=(e,t,n,s)=>{if(s!=="angleAxis"&&e?.type==="number"&&pd(t)&&Array.isArray(n)&&n.length>0){var r=t[0],i=n[0],o=t[1],l=n[n.length-1];return[Math.min(r,i),Math.max(o,l)]}return t},XEe=dt([bn,xP,vP,pn],wP),ZEe=dt(m1,bn,(e,t)=>{if(!(!t||t.type!=="number")){var n=1/0,s=Array.from(Xl(e.map(h=>h.value))).sort((h,p)=>h-p),r=s[0],i=s[s.length-1];if(r==null||i==null)return 1/0;var o=i-r;if(o===0)return 1/0;for(var l=0;l<s.length-1;l++){var c=s[l],u=s[l+1];if(!(c==null||u==null)){var d=u-c;n=Math.min(n,d)}}return n/o}}),UK=dt(ZEe,wa,xK,ds,(e,t,n,s,r)=>r,(e,t,n,s,r)=>{if(!xn(e))return 0;var i=t==="vertical"?s.height:s.width;if(r==="gap")return e*i/2;if(r==="no-gap"){var o=Fs(n,e*i),l=e*i/2;return l-o-(l-o)/i*o}return 0}),JEe=(e,t,n)=>{var s=dc(e,t);return s==null||typeof s.padding!="string"?0:UK(e,"xAxis",t,n,s.padding)},eLe=(e,t,n)=>{var s=uc(e,t);return s==null||typeof s.padding!="string"?0:UK(e,"yAxis",t,n,s.padding)},tLe=dt(dc,JEe,(e,t)=>{var n,s;if(e==null)return{left:0,right:0};var{padding:r}=e;return typeof r=="string"?{left:t,right:t}:{left:((n=r.left)!==null&&n!==void 0?n:0)+t,right:((s=r.right)!==null&&s!==void 0?s:0)+t}}),aLe=dt(uc,eLe,(e,t)=>{var n,s;if(e==null)return{top:0,bottom:0};var{padding:r}=e;return typeof r=="string"?{top:t,bottom:t}:{top:((n=r.top)!==null&&n!==void 0?n:0)+t,bottom:((s=r.bottom)!==null&&s!==void 0?s:0)+t}}),nLe=dt([ds,tLe,ZN,XN,(e,t,n)=>n],(e,t,n,s,r)=>{var{padding:i}=s;return r?[i.left,n.width-i.right]:[e.left+t.left,e.left+e.width-t.right]}),sLe=dt([ds,wa,aLe,ZN,XN,(e,t,n)=>n],(e,t,n,s,r,i)=>{var{padding:o}=r;return i?[s.height-o.bottom,o.top]:t==="horizontal"?[e.top+e.height-n.bottom,e.top+n.top]:[e.top+n.top,e.top+e.height-n.bottom]}),g0=(e,t,n,s)=>{var r;switch(t){case"xAxis":return nLe(e,n,s);case"yAxis":return sLe(e,n,s);case"zAxis":return(r=sP(e,n))===null||r===void 0?void 0:r.range;case"angleAxis":return jK(e);case"radiusAxis":return NK(e,n);default:return}},BK=dt([bn,g0],i1),h1=dt([bn,Nh,XEe,BK],yP);dt([f0,f1,pn],MEe);function HK(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var g1=(e,t)=>t,p1=(e,t,n)=>n,rLe=dt(QN,g1,p1,(e,t,n)=>e.filter(s=>s.orientation===t).filter(s=>s.mirror===n).sort(HK)),iLe=dt(KN,g1,p1,(e,t,n)=>e.filter(s=>s.orientation===t).filter(s=>s.mirror===n).sort(HK)),qK=(e,t)=>({width:e.width,height:t.height}),oLe=(e,t)=>{var n=typeof t.width=="number"?t.width:i0;return{width:n,height:e.height}},GK=dt(ds,dc,qK),lLe=(e,t,n)=>{switch(t){case"top":return e.top;case"bottom":return n-e.bottom;default:return 0}},cLe=(e,t,n)=>{switch(t){case"left":return e.left;case"right":return n-e.right;default:return 0}},dLe=dt(lc,ds,rLe,g1,p1,(e,t,n,s,r)=>{var i={},o;return n.forEach(l=>{var c=qK(t,l);o==null&&(o=lLe(t,s,e));var u=s==="top"&&!r||s==="bottom"&&r;i[l.id]=o-Number(u)*c.height,o+=(u?-1:1)*c.height}),i}),uLe=dt(oc,ds,iLe,g1,p1,(e,t,n,s,r)=>{var i={},o;return n.forEach(l=>{var c=oLe(t,l);o==null&&(o=cLe(t,s,e));var u=s==="left"&&!r||s==="right"&&r;i[l.id]=o-Number(u)*c.width,o+=(u?-1:1)*c.width}),i}),mLe=(e,t)=>{var n=dc(e,t);if(n!=null)return dLe(e,n.orientation,n.mirror)},fLe=dt([ds,dc,mLe,(e,t)=>t],(e,t,n,s)=>{if(t!=null){var r=n?.[s];return r==null?{x:e.left,y:0}:{x:e.left,y:r}}}),hLe=(e,t)=>{var n=uc(e,t);if(n!=null)return uLe(e,n.orientation,n.mirror)},gLe=dt([ds,uc,hLe,(e,t)=>t],(e,t,n,s)=>{if(t!=null){var r=n?.[s];return r==null?{x:0,y:e.top}:{x:r,y:e.top}}}),WK=dt(ds,uc,(e,t)=>{var n=typeof t.width=="number"?t.width:i0;return{width:n,height:e.height}}),mU=(e,t,n)=>{switch(t){case"xAxis":return GK(e,n).width;case"yAxis":return WK(e,n).height;default:return}},VK=(e,t,n,s)=>{if(n!=null){var{allowDuplicatedCategory:r,type:i,dataKey:o}=n,l=Ld(e,s),c=t.map(u=>u.value);if(o&&l&&i==="category"&&r&&EY(c))return c}},jP=dt([wa,m1,bn,pn],VK),YK=(e,t,n,s)=>{if(!(n==null||n.dataKey==null)){var{type:r,scale:i}=n,o=Ld(e,s);if(o&&(r==="number"||i!=="auto"))return t.map(l=>l.value)}},NP=dt([wa,m1,m0,pn],YK),fU=dt([wa,AEe,Nh,h1,jP,NP,g0,vP,pn],(e,t,n,s,r,i,o,l,c)=>{if(t!=null){var u=Ld(e,c);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:c,categoricalDomain:i,duplicateDomain:r,isCategorical:u,niceTicks:l,range:o,realScaleType:n,scale:s}}}),pLe=(e,t,n,s,r,i,o,l,c)=>{if(!(t==null||s==null)){var u=Ld(e,c),{type:d,ticks:h,tickCount:p}=t,x=n==="scaleBand"&&typeof s.bandwidth=="function"?s.bandwidth()/2:2,b=d==="category"&&s.bandwidth?s.bandwidth()/x:0;b=c==="angleAxis"&&i!=null&&i.length>=2?bs(i[0]-i[1])*2*b:b;var j=h||r;if(j){var y=j.map((N,w)=>{var S=o?o.indexOf(N):N;return{index:w,coordinate:s(S)+b,value:N,offset:b}});return y.filter(N=>xn(N.coordinate))}return u&&l?l.map((N,w)=>({coordinate:s(N)+b,value:N,index:w,offset:b})).filter(N=>xn(N.coordinate)):s.ticks?s.ticks(p).map(N=>({coordinate:s(N)+b,value:N,offset:b})):s.domain().map((N,w)=>({coordinate:s(N)+b,value:o?o[N]:N,index:w,offset:b}))}},QK=dt([wa,m0,Nh,h1,vP,g0,jP,NP,pn],pLe),xLe=(e,t,n,s,r,i,o)=>{if(!(t==null||n==null||s==null||s[0]===s[1])){var l=Ld(e,o),{tickCount:c}=t,u=0;return u=o==="angleAxis"&&s?.length>=2?bs(s[0]-s[1])*2*u:u,l&&i?i.map((d,h)=>({coordinate:n(d)+u,value:d,index:h,offset:u})):n.ticks?n.ticks(c).map(d=>({coordinate:n(d)+u,value:d,offset:u})):n.domain().map((d,h)=>({coordinate:n(d)+u,value:r?r[d]:d,index:h,offset:u}))}},xd=dt([wa,m0,h1,g0,jP,NP,pn],xLe),yd=dt(bn,h1,(e,t)=>{if(!(e==null||t==null))return Pw(Pw({},e),{},{scale:t})}),yLe=dt([bn,Nh,xP,BK],yP);dt((e,t,n)=>sP(e,n),yLe,(e,t)=>{if(!(e==null||t==null))return Pw(Pw({},e),{},{scale:t})});var bLe=dt([wa,QN,KN],(e,t,n)=>{switch(e){case"horizontal":return t.some(s=>s.reversed)?"right-to-left":"left-to-right";case"vertical":return n.some(s=>s.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),KK=e=>e.options.defaultTooltipEventType,XK=e=>e.options.validateTooltipEventTypes;function ZK(e,t,n){if(e==null)return t;var s=e?"axis":"item";return n==null?t:n.includes(s)?s:t}function CP(e,t){var n=KK(e),s=XK(e);return ZK(t,n,s)}function vLe(e){return Bt(t=>CP(t,e))}var JK=(e,t)=>{var n,s=Number(t);if(!(eo(s)||t==null))return s>=0?e==null||(n=e[s])===null||n===void 0?void 0:n.value:void 0},wLe=e=>e.tooltip.settings,Xc={active:!1,index:null,dataKey:void 0,graphicalItemId:void 0,coordinate:void 0},jLe={itemInteraction:{click:Xc,hover:Xc},axisInteraction:{click:Xc,hover:Xc},keyboardInteraction:Xc,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0,sourceViewBox:void 0,graphicalItemId:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},eX=Cr({name:"tooltip",initialState:jLe,reducers:{addTooltipEntrySettings:{reducer(e,t){e.tooltipItemPayloads.push(t.payload)},prepare:cn()},replaceTooltipEntrySettings:{reducer(e,t){var{prev:n,next:s}=t.payload,r=Vi(e).tooltipItemPayloads.indexOf(n);r>-1&&(e.tooltipItemPayloads[r]=s)},prepare:cn()},removeTooltipEntrySettings:{reducer(e,t){var n=Vi(e).tooltipItemPayloads.indexOf(t.payload);n>-1&&e.tooltipItemPayloads.splice(n,1)},prepare:cn()},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.graphicalItemId=t.payload.activeGraphicalItemId,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.graphicalItemId=t.payload.activeGraphicalItemId,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate}}}),{addTooltipEntrySettings:NLe,replaceTooltipEntrySettings:CLe,removeTooltipEntrySettings:SLe,setTooltipSettingsState:_Le,setActiveMouseOverItemIndex:tX,mouseLeaveItem:ALe,mouseLeaveChart:aX,setActiveClickItemIndex:TLe,setMouseOverAxisIndex:nX,setMouseClickAxisIndex:kLe,setSyncInteraction:OE,setKeyboardInteraction:ME}=eX.actions,ELe=eX.reducer;function hU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function pb(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?hU(Object(n),!0).forEach(function(s){LLe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hU(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function LLe(e,t,n){return(t=DLe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function DLe(e){var t=PLe(e,"string");return typeof t=="symbol"?t:t+""}function PLe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function OLe(e,t,n){return t==="axis"?n==="click"?e.axisInteraction.click:e.axisInteraction.hover:n==="click"?e.itemInteraction.click:e.itemInteraction.hover}function MLe(e){return e.index!=null}var sX=(e,t,n,s)=>{if(t==null)return Xc;var r=OLe(e,t,n);if(r==null)return Xc;if(r.active)return r;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var i=e.settings.active===!0;if(MLe(r)){if(i)return pb(pb({},r),{},{active:!0})}else if(s!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:s,graphicalItemId:void 0};return pb(pb({},Xc),{},{coordinate:r.coordinate})};function ILe(e){if(typeof e=="number")return Number.isFinite(e)?e:void 0;if(e instanceof Date){var t=e.valueOf();return Number.isFinite(t)?t:void 0}var n=Number(e);return Number.isFinite(n)?n:void 0}function $Le(e,t){var n=ILe(e),s=t[0],r=t[1];if(n===void 0)return!1;var i=Math.min(s,r),o=Math.max(s,r);return n>=i&&n<=o}function RLe(e,t,n){if(n==null||t==null)return!0;var s=Ga(e,t);return s==null||!pd(n)?!0:$Le(s,n)}var SP=(e,t,n,s)=>{var r=e?.index;if(r==null)return null;var i=Number(r);if(!xn(i))return r;var o=0,l=1/0;t.length>0&&(l=t.length-1);var c=Math.max(o,Math.min(i,l)),u=t[c];return u==null||RLe(u,n,s)?String(c):null},rX=(e,t,n,s,r,i,o,l)=>{if(!(i==null||l==null)){var c=o[0],u=c==null?void 0:l(c.positions,i);if(u!=null)return u;var d=r?.[Number(i)];if(d)return n==="horizontal"?{x:d.coordinate,y:(s.top+t)/2}:{x:(s.left+e)/2,y:d.coordinate}}},iX=(e,t,n,s)=>{if(t==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var r;if(n==="hover"?r=e.itemInteraction.hover.graphicalItemId:r=e.itemInteraction.click.graphicalItemId,r==null&&s!=null){var i=e.tooltipItemPayloads[0];return i!=null?[i]:[]}return e.tooltipItemPayloads.filter(o=>{var l;return((l=o.settings)===null||l===void 0?void 0:l.graphicalItemId)===r})},p0=e=>e.options.tooltipPayloadSearcher,Ch=e=>e.tooltip;function gU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function pU(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?gU(Object(n),!0).forEach(function(s){zLe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gU(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function zLe(e,t,n){return(t=FLe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function FLe(e){var t=ULe(e,"string");return typeof t=="symbol"?t:t+""}function ULe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function BLe(e,t){return e??t}var oX=(e,t,n,s,r,i,o)=>{if(!(t==null||i==null)){var{chartData:l,computedData:c,dataStartIndex:u,dataEndIndex:d}=n,h=[];return e.reduce((p,x)=>{var b,{dataDefinedOnItem:j,settings:y}=x,N=BLe(j,l),w=Array.isArray(N)?NQ(N,u,d):N,S=(b=y?.dataKey)!==null&&b!==void 0?b:s,_=y?.nameKey,T;if(s&&Array.isArray(w)&&!Array.isArray(w[0])&&o==="axis"?T=LY(w,s,r):T=i(w,t,c,_),Array.isArray(T))T.forEach(A=>{var E=pU(pU({},y),{},{name:A.name,unit:A.unit,color:void 0,fill:void 0});p.push(aF({tooltipEntrySettings:E,dataKey:A.dataKey,payload:A.payload,value:Ga(A.payload,A.dataKey),name:A.name}))});else{var k;p.push(aF({tooltipEntrySettings:y,dataKey:S,payload:T,value:Ga(T,S),name:(k=Ga(T,_))!==null&&k!==void 0?k:y?.name}))}return p},h)}},_P=dt([ms,wa,TK,XD,us],FK),HLe=dt([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),qLe=dt([us,wh],rP),Sh=dt([HLe,ms,qLe],iP,{memoizeOptions:{resultEqualityCheck:d1}}),GLe=dt([Sh],e=>e.filter(l1)),WLe=dt([Sh],oP,{memoizeOptions:{resultEqualityCheck:d1}}),_h=dt([WLe,cc],lP),VLe=dt([GLe,cc,ms],SK),AP=dt([_h,ms,Sh],dP),lX=dt([ms],uP),YLe=dt([ms],e=>e.allowDataOverflow),cX=dt([lX,YLe],aK),QLe=dt([Sh],e=>e.filter(l1)),KLe=dt([VLe,QLe,d0,yK],DK),XLe=dt([KLe,cc,us,cX],PK),ZLe=dt([Sh],EK),JLe=dt([_h,ms,ZLe,f1,us],hP,{memoizeOptions:{resultEqualityCheck:c1}}),e4e=dt([OK,us,wh],jh),t4e=dt([e4e,us],$K),a4e=dt([MK,us,wh],jh),n4e=dt([a4e,us],RK),s4e=dt([IK,us,wh],jh),r4e=dt([s4e,us],zK),i4e=dt([t4e,r4e,n4e],Ow),o4e=dt([ms,lX,cX,XLe,JLe,i4e,wa,us],gP),x0=dt([ms,wa,_h,AP,d0,us,o4e],pP),l4e=dt([x0,ms,_P],bP),c4e=dt([ms,x0,l4e,us],wP),dX=e=>{var t=us(e),n=wh(e),s=!1;return g0(e,t,n,s)},uX=dt([ms,dX],i1),mX=dt([ms,_P,c4e,uX],yP),d4e=dt([wa,AP,ms,us],VK),u4e=dt([wa,AP,ms,us],YK),m4e=(e,t,n,s,r,i,o,l)=>{if(t){var{type:c}=t,u=Ld(e,l);if(s){var d=n==="scaleBand"&&s.bandwidth?s.bandwidth()/2:2,h=c==="category"&&s.bandwidth?s.bandwidth()/d:0;return h=l==="angleAxis"&&r!=null&&r?.length>=2?bs(r[0]-r[1])*2*h:h,u&&o?o.map((p,x)=>({coordinate:s(p)+h,value:p,index:x,offset:h})):s.domain().map((p,x)=>({coordinate:s(p)+h,value:i?i[p]:p,index:x,offset:h}))}}},mc=dt([wa,ms,_P,mX,dX,d4e,u4e,us],m4e),TP=dt([KK,XK,wLe],(e,t,n)=>ZK(n.shared,e,t)),fX=e=>e.tooltip.settings.trigger,kP=e=>e.tooltip.settings.defaultIndex,y0=dt([Ch,TP,fX,kP],sX),bd=dt([y0,_h,h0,x0],SP),hX=dt([mc,bd],JK),EP=dt([y0],e=>{if(e)return e.dataKey}),f4e=dt([y0],e=>{if(e)return e.graphicalItemId}),gX=dt([Ch,TP,fX,kP],iX),h4e=dt([oc,lc,wa,ds,mc,kP,gX,p0],rX),g4e=dt([y0,h4e],(e,t)=>e!=null&&e.coordinate?e.coordinate:t),p4e=dt([y0],e=>{var t;return(t=e?.active)!==null&&t!==void 0?t:!1}),x4e=dt([gX,bd,cc,h0,hX,p0,TP],oX),y4e=dt([x4e],e=>{if(e!=null){var t=e.map(n=>n.payload).filter(n=>n!=null);return Array.from(new Set(t))}});function xU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function yU(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?xU(Object(n),!0).forEach(function(s){b4e(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xU(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function b4e(e,t,n){return(t=v4e(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v4e(e){var t=w4e(e,"string");return typeof t=="symbol"?t:t+""}function w4e(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var j4e=()=>Bt(ms),N4e=()=>{var e=j4e(),t=Bt(mc),n=Bt(mX);return Wf(!e||!n?void 0:yU(yU({},e),{},{scale:n}),t)};function bU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function rf(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?bU(Object(n),!0).forEach(function(s){C4e(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bU(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function C4e(e,t,n){return(t=S4e(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function S4e(e){var t=_4e(e,"string");return typeof t=="symbol"?t:t+""}function _4e(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var A4e=(e,t,n,s)=>{var r=t.find(i=>i&&i.index===n);if(r){if(e==="horizontal")return{x:r.coordinate,y:s.chartY};if(e==="vertical")return{x:s.chartX,y:r.coordinate}}return{x:0,y:0}},T4e=(e,t,n,s)=>{var r=t.find(u=>u&&u.index===n);if(r){if(e==="centric"){var i=r.coordinate,{radius:o}=s;return rf(rf(rf({},s),qn(s.cx,s.cy,o,i)),{},{angle:i,radius:o})}var l=r.coordinate,{angle:c}=s;return rf(rf(rf({},s),qn(s.cx,s.cy,l,c)),{},{angle:c,radius:l})}return{angle:0,clockWise:!1,cx:0,cy:0,endAngle:0,innerRadius:0,outerRadius:0,radius:0,startAngle:0,x:0,y:0}};function k4e(e,t){var{chartX:n,chartY:s}=e;return n>=t.left&&n<=t.left+t.width&&s>=t.top&&s<=t.top+t.height}var pX=(e,t,n,s,r)=>{var i,o=(i=t?.length)!==null&&i!==void 0?i:0;if(o<=1||e==null)return 0;if(s==="angleAxis"&&r!=null&&Math.abs(Math.abs(r[1]-r[0])-360)<=1e-6)for(var l=0;l<o;l++){var c,u,d,h,p,x=l>0?(c=n[l-1])===null||c===void 0?void 0:c.coordinate:(u=n[o-1])===null||u===void 0?void 0:u.coordinate,b=(d=n[l])===null||d===void 0?void 0:d.coordinate,j=l>=o-1?(h=n[0])===null||h===void 0?void 0:h.coordinate:(p=n[l+1])===null||p===void 0?void 0:p.coordinate,y=void 0;if(!(x==null||b==null||j==null))if(bs(b-x)!==bs(j-b)){var N=[];if(bs(j-b)===bs(r[1]-r[0])){y=j;var w=b+r[1]-r[0];N[0]=Math.min(w,(w+x)/2),N[1]=Math.max(w,(w+x)/2)}else{y=x;var S=j+r[1]-r[0];N[0]=Math.min(b,(S+b)/2),N[1]=Math.max(b,(S+b)/2)}var _=[Math.min(b,(y+b)/2),Math.max(b,(y+b)/2)];if(e>_[0]&&e<=_[1]||e>=N[0]&&e<=N[1]){var T;return(T=n[l])===null||T===void 0?void 0:T.index}}else{var k=Math.min(x,j),A=Math.max(x,j);if(e>(k+b)/2&&e<=(A+b)/2){var E;return(E=n[l])===null||E===void 0?void 0:E.index}}}else if(t)for(var M=0;M<o;M++){var F=t[M];if(F!=null){var D=t[M+1],P=t[M-1];if(M===0&&D!=null&&e<=(F.coordinate+D.coordinate)/2||M===o-1&&P!=null&&e>(F.coordinate+P.coordinate)/2||M>0&&M<o-1&&P!=null&&D!=null&&e>(F.coordinate+P.coordinate)/2&&e<=(F.coordinate+D.coordinate)/2)return F.index}}return-1},E4e=()=>Bt(XD),LP=(e,t)=>t,xX=(e,t,n)=>n,DP=(e,t,n,s)=>s,L4e=dt(mc,e=>FN(e,t=>t.coordinate)),PP=dt([Ch,LP,xX,DP],sX),OP=dt([PP,_h,h0,x0],SP),D4e=(e,t,n)=>{if(t!=null){var s=Ch(e);return t==="axis"?n==="hover"?s.axisInteraction.hover.dataKey:s.axisInteraction.click.dataKey:n==="hover"?s.itemInteraction.hover.dataKey:s.itemInteraction.click.dataKey}},yX=dt([Ch,LP,xX,DP],iX),Mw=dt([oc,lc,wa,ds,mc,DP,yX,p0],rX),P4e=dt([PP,Mw],(e,t)=>{var n;return(n=e.coordinate)!==null&&n!==void 0?n:t}),bX=dt([mc,OP],JK),O4e=dt([yX,OP,cc,h0,bX,p0,LP],oX),M4e=dt([PP,OP],(e,t)=>({isActive:e.active&&t!=null,activeIndex:t})),I4e=(e,t,n,s,r,i,o)=>{if(!(!e||!n||!s||!r)&&k4e(e,o)){var l=EAe(e,t),c=pX(l,i,r,n,s),u=A4e(t,r,c,e);return{activeIndex:String(c),activeCoordinate:u}}},$4e=(e,t,n,s,r,i,o)=>{if(!(!e||!s||!r||!i||!n)){var l=Vke(e,n);if(l){var c=LAe(l,t),u=pX(c,o,i,s,r),d=T4e(t,i,u,l);return{activeIndex:String(u),activeCoordinate:d}}}},R4e=(e,t,n,s,r,i,o,l)=>{if(!(!e||!t||!s||!r||!i))return t==="horizontal"||t==="vertical"?I4e(e,t,s,r,i,o,l):$4e(e,t,n,s,r,i,o)},z4e=dt(e=>e.zIndex.zIndexMap,(e,t)=>t,(e,t,n)=>n,(e,t,n)=>{if(t!=null){var s=e[t];if(s!=null)return n?s.panoramaElement:s.element}}),F4e=dt(e=>e.zIndex.zIndexMap,e=>{var t=Object.keys(e).map(s=>parseInt(s,10)).concat(Object.values(Gn)),n=Array.from(new Set(t));return n.sort((s,r)=>s-r)},{memoizeOptions:{resultEqualityCheck:jEe}});function vU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function wU(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?vU(Object(n),!0).forEach(function(s){U4e(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vU(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function U4e(e,t,n){return(t=B4e(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function B4e(e){var t=H4e(e,"string");return typeof t=="symbol"?t:t+""}function H4e(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var q4e={},G4e={zIndexMap:Object.values(Gn).reduce((e,t)=>wU(wU({},e),{},{[t]:{element:void 0,panoramaElement:void 0,consumers:0}}),q4e)},W4e=new Set(Object.values(Gn));function V4e(e){return W4e.has(e)}var vX=Cr({name:"zIndex",initialState:G4e,reducers:{registerZIndexPortal:{reducer:(e,t)=>{var{zIndex:n}=t.payload;e.zIndexMap[n]?e.zIndexMap[n].consumers+=1:e.zIndexMap[n]={consumers:1,element:void 0,panoramaElement:void 0}},prepare:cn()},unregisterZIndexPortal:{reducer:(e,t)=>{var{zIndex:n}=t.payload;e.zIndexMap[n]&&(e.zIndexMap[n].consumers-=1,e.zIndexMap[n].consumers<=0&&!V4e(n)&&delete e.zIndexMap[n])},prepare:cn()},registerZIndexPortalElement:{reducer:(e,t)=>{var{zIndex:n,element:s,isPanorama:r}=t.payload;e.zIndexMap[n]?r?e.zIndexMap[n].panoramaElement=s:e.zIndexMap[n].element=s:e.zIndexMap[n]={consumers:0,element:r?void 0:s,panoramaElement:r?s:void 0}},prepare:cn()},unregisterZIndexPortalElement:{reducer:(e,t)=>{var{zIndex:n}=t.payload;e.zIndexMap[n]&&(t.payload.isPanorama?e.zIndexMap[n].panoramaElement=void 0:e.zIndexMap[n].element=void 0)},prepare:cn()}}}),{registerZIndexPortal:Y4e,unregisterZIndexPortal:Q4e,registerZIndexPortalElement:K4e,unregisterZIndexPortalElement:X4e}=vX.actions,Z4e=vX.reducer;function Sr(e){var{zIndex:t,children:n}=e,s=lTe(),r=s&&t!==void 0&&t!==0,i=Hs(),o=Ja();f.useLayoutEffect(()=>r?(o(Y4e({zIndex:t})),()=>{o(Q4e({zIndex:t}))}):t0,[o,t,r]);var l=Bt(c=>z4e(c,t,i));return r?l?Gi.createPortal(n,l):null:n}function IE(){return IE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},IE.apply(null,arguments)}function jU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function xb(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?jU(Object(n),!0).forEach(function(s){J4e(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jU(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function J4e(e,t,n){return(t=eDe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function eDe(e){var t=tDe(e,"string");return typeof t=="symbol"?t:t+""}function tDe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function aDe(e){var{cursor:t,cursorComp:n,cursorProps:s}=e;return f.isValidElement(t)?f.cloneElement(t,s):f.createElement(n,s)}function nDe(e){var t,{coordinate:n,payload:s,index:r,offset:i,tooltipAxisBandSize:o,layout:l,cursor:c,tooltipEventType:u,chartName:d}=e,h=n,p=s,x=r;if(!c||!h||d!=="ScatterChart"&&u!=="axis")return null;var b,j,y;if(d==="ScatterChart")b=h,j=oke,y=Gn.cursorLine;else if(d==="BarChart")b=lke(l,h,i,o),j=KQ,y=Gn.cursorRectangle;else if(l==="radial"&&PY(h)){var{cx:N,cy:w,radius:S,startAngle:_,endAngle:T}=ZQ(h);b={cx:N,cy:w,startAngle:_,endAngle:T,innerRadius:S,outerRadius:S},j=eK,y=Gn.cursorLine}else b={points:Xke(l,h,i)},j=VD,y=Gn.cursorLine;var k=typeof c=="object"&&"className"in c?c.className:void 0,A=xb(xb(xb(xb({stroke:"#ccc",pointerEvents:"none"},i),b),Gu(c)),{},{payload:p,payloadIndex:x,className:Rt("recharts-tooltip-cursor",k)});return f.createElement(Sr,{zIndex:(t=e.zIndex)!==null&&t!==void 0?t:y},f.createElement(aDe,{cursor:c,cursorComp:j,cursorProps:A}))}function sDe(e){var t=N4e(),n=PQ(),s=yh(),r=E4e();return t==null||n==null||s==null||r==null?null:f.createElement(nDe,IE({},e,{offset:n,layout:s,tooltipAxisBandSize:t,chartName:r}))}var wX=f.createContext(null),rDe=()=>f.useContext(wX),tA={exports:{}},NU;function iDe(){return NU||(NU=1,(function(e){var t=Object.prototype.hasOwnProperty,n="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(n=!1));function r(c,u,d){this.fn=c,this.context=u,this.once=d||!1}function i(c,u,d,h,p){if(typeof d!="function")throw new TypeError("The listener must be a function");var x=new r(d,h||c,p),b=n?n+u:u;return c._events[b]?c._events[b].fn?c._events[b]=[c._events[b],x]:c._events[b].push(x):(c._events[b]=x,c._eventsCount++),c}function o(c,u){--c._eventsCount===0?c._events=new s:delete c._events[u]}function l(){this._events=new s,this._eventsCount=0}l.prototype.eventNames=function(){var u=[],d,h;if(this._eventsCount===0)return u;for(h in d=this._events)t.call(d,h)&&u.push(n?h.slice(1):h);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(d)):u},l.prototype.listeners=function(u){var d=n?n+u:u,h=this._events[d];if(!h)return[];if(h.fn)return[h.fn];for(var p=0,x=h.length,b=new Array(x);p<x;p++)b[p]=h[p].fn;return b},l.prototype.listenerCount=function(u){var d=n?n+u:u,h=this._events[d];return h?h.fn?1:h.length:0},l.prototype.emit=function(u,d,h,p,x,b){var j=n?n+u:u;if(!this._events[j])return!1;var y=this._events[j],N=arguments.length,w,S;if(y.fn){switch(y.once&&this.removeListener(u,y.fn,void 0,!0),N){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,d),!0;case 3:return y.fn.call(y.context,d,h),!0;case 4:return y.fn.call(y.context,d,h,p),!0;case 5:return y.fn.call(y.context,d,h,p,x),!0;case 6:return y.fn.call(y.context,d,h,p,x,b),!0}for(S=1,w=new Array(N-1);S<N;S++)w[S-1]=arguments[S];y.fn.apply(y.context,w)}else{var _=y.length,T;for(S=0;S<_;S++)switch(y[S].once&&this.removeListener(u,y[S].fn,void 0,!0),N){case 1:y[S].fn.call(y[S].context);break;case 2:y[S].fn.call(y[S].context,d);break;case 3:y[S].fn.call(y[S].context,d,h);break;case 4:y[S].fn.call(y[S].context,d,h,p);break;default:if(!w)for(T=1,w=new Array(N-1);T<N;T++)w[T-1]=arguments[T];y[S].fn.apply(y[S].context,w)}}return!0},l.prototype.on=function(u,d,h){return i(this,u,d,h,!1)},l.prototype.once=function(u,d,h){return i(this,u,d,h,!0)},l.prototype.removeListener=function(u,d,h,p){var x=n?n+u:u;if(!this._events[x])return this;if(!d)return o(this,x),this;var b=this._events[x];if(b.fn)b.fn===d&&(!p||b.once)&&(!h||b.context===h)&&o(this,x);else{for(var j=0,y=[],N=b.length;j<N;j++)(b[j].fn!==d||p&&!b[j].once||h&&b[j].context!==h)&&y.push(b[j]);y.length?this._events[x]=y.length===1?y[0]:y:o(this,x)}return this},l.prototype.removeAllListeners=function(u){var d;return u?(d=n?n+u:u,this._events[d]&&o(this,d)):(this._events=new s,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=n,l.EventEmitter=l,e.exports=l})(tA)),tA.exports}var oDe=iDe();const lDe=ao(oDe);var Qp=new lDe,$E="recharts.syncEvent.tooltip",CU="recharts.syncEvent.brush";function MP(e,t){if(t){var n=Number.parseInt(t,10);if(!eo(n))return e?.[n]}}var cDe={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},jX=Cr({name:"options",initialState:cDe,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),dDe=jX.reducer,{createEventEmitter:uDe}=jX.actions;function mDe(e){return e.tooltip.syncInteraction}var fDe={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},NX=Cr({name:"chartData",initialState:fDe,reducers:{setChartData(e,t){if(e.chartData=t.payload,t.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:n,endIndex:s}=t.payload;n!=null&&(e.dataStartIndex=n),s!=null&&(e.dataEndIndex=s)}}}),{setChartData:SU,setDataStartEndIndexes:hDe,setComputedData:hYe}=NX.actions,gDe=NX.reducer,pDe=["x","y"];function _U(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function of(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?_U(Object(n),!0).forEach(function(s){xDe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_U(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function xDe(e,t,n){return(t=yDe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function yDe(e){var t=bDe(e,"string");return typeof t=="symbol"?t:t+""}function bDe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vDe(e,t){if(e==null)return{};var n,s,r=wDe(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)n=i[s],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function wDe(e,t){if(e==null)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;n[s]=e[s]}return n}function jDe(){var e=Bt(ZD),t=Bt(JD),n=Ja(),s=Bt(bK),r=Bt(mc),i=yh(),o=JN(),l=Bt(c=>c.rootProps.className);f.useEffect(()=>{if(e==null)return t0;var c=(u,d,h)=>{if(t!==h&&e===u){if(s==="index"){var p;if(o&&d!==null&&d!==void 0&&(p=d.payload)!==null&&p!==void 0&&p.coordinate&&d.payload.sourceViewBox){var x=d.payload.coordinate,{x:b,y:j}=x,y=vDe(x,pDe),{x:N,y:w,width:S,height:_}=d.payload.sourceViewBox,T=of(of({},y),{},{x:o.x+(S?(b-N)/S:0)*o.width,y:o.y+(_?(j-w)/_:0)*o.height});n(of(of({},d),{},{payload:of(of({},d.payload),{},{coordinate:T})}))}else n(d);return}if(r!=null){var k;if(typeof s=="function"){var A={activeTooltipIndex:d.payload.index==null?void 0:Number(d.payload.index),isTooltipActive:d.payload.active,activeIndex:d.payload.index==null?void 0:Number(d.payload.index),activeLabel:d.payload.label,activeDataKey:d.payload.dataKey,activeCoordinate:d.payload.coordinate},E=s(r,A);k=r[E]}else s==="value"&&(k=r.find(W=>String(W.value)===d.payload.label));var{coordinate:M}=d.payload;if(k==null||d.payload.active===!1||M==null||o==null){n(OE({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0,sourceViewBox:void 0,graphicalItemId:void 0}));return}var{x:F,y:D}=M,P=Math.min(F,o.x+o.width),B=Math.min(D,o.y+o.height),G={x:i==="horizontal"?k.coordinate:P,y:i==="horizontal"?B:k.coordinate},$=OE({active:d.payload.active,coordinate:G,dataKey:d.payload.dataKey,index:String(k.index),label:d.payload.label,sourceViewBox:d.payload.sourceViewBox,graphicalItemId:d.payload.graphicalItemId});n($)}}};return Qp.on($E,c),()=>{Qp.off($E,c)}},[l,n,t,e,s,r,i,o])}function NDe(){var e=Bt(ZD),t=Bt(JD),n=Ja();f.useEffect(()=>{if(e==null)return t0;var s=(r,i,o)=>{t!==o&&e===r&&n(hDe(i))};return Qp.on(CU,s),()=>{Qp.off(CU,s)}},[n,t,e])}function CDe(){var e=Ja();f.useEffect(()=>{e(uDe())},[e]),jDe(),NDe()}function SDe(e,t,n,s,r,i){var o=Bt(x=>D4e(x,e,t)),l=Bt(JD),c=Bt(ZD),u=Bt(bK),d=Bt(mDe),h=d?.active,p=JN();f.useEffect(()=>{if(!h&&c!=null&&l!=null){var x=OE({active:i,coordinate:n,dataKey:o,index:r,label:typeof s=="number"?String(s):s,sourceViewBox:p,graphicalItemId:void 0});Qp.emit($E,c,x,l)}},[h,n,o,r,s,l,c,u,i,p])}function AU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function TU(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?AU(Object(n),!0).forEach(function(s){_De(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):AU(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function _De(e,t,n){return(t=ADe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ADe(e){var t=TDe(e,"string");return typeof t=="symbol"?t:t+""}function TDe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kDe(e){return e.dataKey}function EDe(e,t){return f.isValidElement(e)?f.cloneElement(e,t):typeof e=="function"?f.createElement(e,t):f.createElement(FTe,t)}var kU=[],LDe={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,includeHidden:!1,isAnimationActive:"auto",itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function aA(e){var t,n,s=Xn(e,LDe),{active:r,allowEscapeViewBox:i,animationDuration:o,animationEasing:l,content:c,filterNull:u,isAnimationActive:d,offset:h,payloadUniqBy:p,position:x,reverseDirection:b,useTranslate3d:j,wrapperStyle:y,cursor:N,shared:w,trigger:S,defaultIndex:_,portal:T,axisId:k}=s,A=Ja(),E=typeof _=="number"?String(_):_;f.useEffect(()=>{A(_Le({shared:w,trigger:S,axisId:k,active:r,defaultIndex:E}))},[A,w,S,k,r,E]);var M=JN(),F=GQ(),D=vLe(w),{activeIndex:P,isActive:B}=(t=Bt(me=>M4e(me,D,S,E)))!==null&&t!==void 0?t:{},G=Bt(me=>O4e(me,D,S,E)),$=Bt(me=>bX(me,D,S,E)),W=Bt(me=>P4e(me,D,S,E)),Z=G,Q=rDe(),le=(n=r??B)!==null&&n!==void 0?n:!1,[we,J]=VY([Z,le]),se=D==="axis"?$:void 0;SDe(D,S,W,se,P,le);var ye=T??Q;if(ye==null||M==null||D==null)return null;var Ce=Z??kU;le||(Ce=kU),u&&Ce.length&&(Ce=HY(Ce.filter(me=>me.value!=null&&(me.hide!==!0||s.includeHidden)),p,kDe));var ge=Ce.length>0,be=f.createElement(VTe,{allowEscapeViewBox:i,animationDuration:o,animationEasing:l,isAnimationActive:d,active:le,coordinate:W,hasPayload:ge,offset:h,position:x,reverseDirection:b,useTranslate3d:j,viewBox:M,wrapperStyle:y,lastBoundingBox:we,innerRef:J,hasPortalFromProps:!!T},EDe(c,TU(TU({},s),{},{payload:Ce,label:se,active:le,activeIndex:P,coordinate:W,accessibilityLayer:F})));return f.createElement(f.Fragment,null,Gi.createPortal(be,ye),le&&f.createElement(sDe,{cursor:N,tooltipEventType:D,coordinate:W,payload:Ce,index:P}))}var x1=e=>null;x1.displayName="Cell";function DDe(e,t,n){return(t=PDe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function PDe(e){var t=ODe(e,"string");return typeof t=="symbol"?t:t+""}function ODe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class MDe{constructor(t){DDe(this,"cache",new Map),this.maxSize=t}get(t){var n=this.cache.get(t);return n!==void 0&&(this.cache.delete(t),this.cache.set(t,n)),n}set(t,n){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxSize){var s=this.cache.keys().next().value;s!=null&&this.cache.delete(s)}this.cache.set(t,n)}clear(){this.cache.clear()}size(){return this.cache.size}}function EU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function IDe(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?EU(Object(n),!0).forEach(function(s){$De(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):EU(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function $De(e,t,n){return(t=RDe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function RDe(e){var t=zDe(e,"string");return typeof t=="symbol"?t:t+""}function zDe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var FDe={cacheSize:2e3,enableCache:!0},CX=IDe({},FDe),LU=new MDe(CX.cacheSize),UDe={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},DU="recharts_measurement_span";function BDe(e,t){var n=t.fontSize||"",s=t.fontFamily||"",r=t.fontWeight||"",i=t.fontStyle||"",o=t.letterSpacing||"",l=t.textTransform||"";return"".concat(e,"|").concat(n,"|").concat(s,"|").concat(r,"|").concat(i,"|").concat(o,"|").concat(l)}var PU=(e,t)=>{try{var n=document.getElementById(DU);n||(n=document.createElement("span"),n.setAttribute("id",DU),n.setAttribute("aria-hidden","true"),document.body.appendChild(n)),Object.assign(n.style,UDe,t),n.textContent="".concat(e);var s=n.getBoundingClientRect();return{width:s.width,height:s.height}}catch{return{width:0,height:0}}},up=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||s1.isSsr)return{width:0,height:0};if(!CX.enableCache)return PU(t,n);var s=BDe(t,n),r=LU.get(s);if(r)return r;var i=PU(t,n);return LU.set(s,i),i},SX;function HDe(e,t,n){return(t=qDe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qDe(e){var t=GDe(e,"string");return typeof t=="symbol"?t:t+""}function GDe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var OU=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,MU=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,WDe=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,VDe=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,YDe={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},QDe=["cm","mm","pt","pc","in","Q","px"];function KDe(e){return QDe.includes(e)}var vf="NaN";function XDe(e,t){return e*YDe[t]}class ks{static parse(t){var n,[,s,r]=(n=VDe.exec(t))!==null&&n!==void 0?n:[];return s==null?ks.NaN:new ks(parseFloat(s),r??"")}constructor(t,n){this.num=t,this.unit=n,this.num=t,this.unit=n,eo(t)&&(this.unit=""),n!==""&&!WDe.test(n)&&(this.num=NaN,this.unit=""),KDe(n)&&(this.num=XDe(t,n),this.unit="px")}add(t){return this.unit!==t.unit?new ks(NaN,""):new ks(this.num+t.num,this.unit)}subtract(t){return this.unit!==t.unit?new ks(NaN,""):new ks(this.num-t.num,this.unit)}multiply(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new ks(NaN,""):new ks(this.num*t.num,this.unit||t.unit)}divide(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new ks(NaN,""):new ks(this.num/t.num,this.unit||t.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return eo(this.num)}}SX=ks;HDe(ks,"NaN",new SX(NaN,""));function _X(e){if(e==null||e.includes(vf))return vf;for(var t=e;t.includes("*")||t.includes("/");){var n,[,s,r,i]=(n=OU.exec(t))!==null&&n!==void 0?n:[],o=ks.parse(s??""),l=ks.parse(i??""),c=r==="*"?o.multiply(l):o.divide(l);if(c.isNaN())return vf;t=t.replace(OU,c.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var u,[,d,h,p]=(u=MU.exec(t))!==null&&u!==void 0?u:[],x=ks.parse(d??""),b=ks.parse(p??""),j=h==="+"?x.add(b):x.subtract(b);if(j.isNaN())return vf;t=t.replace(MU,j.toString())}return t}var IU=/\(([^()]*)\)/;function ZDe(e){for(var t=e,n;(n=IU.exec(t))!=null;){var[,s]=n;t=t.replace(IU,_X(s))}return t}function JDe(e){var t=e.replace(/\s+/g,"");return t=ZDe(t),t=_X(t),t}function ePe(e){try{return JDe(e)}catch{return vf}}function nA(e){var t=ePe(e.slice(5,-1));return t===vf?"":t}var tPe=["x","y","lineHeight","capHeight","fill","scaleToFit","textAnchor","verticalAnchor"],aPe=["dx","dy","angle","className","breakAll"];function RE(){return RE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},RE.apply(null,arguments)}function $U(e,t){if(e==null)return{};var n,s,r=nPe(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)n=i[s],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function nPe(e,t){if(e==null)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;n[s]=e[s]}return n}var AX=/[ \f\n\r\t\v\u2028\u2029]+/,TX=e=>{var{children:t,breakAll:n,style:s}=e;try{var r=[];fn(t)||(n?r=t.toString().split(""):r=t.toString().split(AX));var i=r.map(l=>({word:l,width:up(l,s).width})),o=n?0:up("",s).width;return{wordsWithComputedWidth:i,spaceWidth:o}}catch{return null}};function sPe(e){return e==="start"||e==="middle"||e==="end"||e==="inherit"}var kX=(e,t,n,s)=>e.reduce((r,i)=>{var{word:o,width:l}=i,c=r[r.length-1];if(c&&l!=null&&(t==null||s||c.width+l+n<Number(t)))c.words.push(o),c.width+=l+n;else{var u={words:[o],width:l};r.push(u)}return r},[]),EX=e=>e.reduce((t,n)=>t.width>n.width?t:n),rPe="",RU=(e,t,n,s,r,i,o,l)=>{var c=e.slice(0,t),u=TX({breakAll:n,style:s,children:c+rPe});if(!u)return[!1,[]];var d=kX(u.wordsWithComputedWidth,i,o,l),h=d.length>r||EX(d).width>Number(i);return[h,d]},iPe=(e,t,n,s,r)=>{var{maxLines:i,children:o,style:l,breakAll:c}=e,u=Ut(i),d=String(o),h=kX(t,s,n,r);if(!u||r)return h;var p=h.length>i||EX(h).width>Number(s);if(!p)return h;for(var x=0,b=d.length-1,j=0,y;x<=b&&j<=d.length-1;){var N=Math.floor((x+b)/2),w=N-1,[S,_]=RU(d,w,c,l,i,s,n,r),[T]=RU(d,N,c,l,i,s,n,r);if(!S&&!T&&(x=N+1),S&&T&&(b=N-1),!S&&T){y=_;break}j++}return y||h},zU=e=>{var t=fn(e)?[]:e.toString().split(AX);return[{words:t,width:void 0}]},oPe=e=>{var{width:t,scaleToFit:n,children:s,style:r,breakAll:i,maxLines:o}=e;if((t||n)&&!s1.isSsr){var l,c,u=TX({breakAll:i,children:s,style:r});if(u){var{wordsWithComputedWidth:d,spaceWidth:h}=u;l=d,c=h}else return zU(s);return iPe({breakAll:i,children:s,maxLines:o,style:r},l,c,t,!!n)}return zU(s)},LX="#808080",lPe={angle:0,breakAll:!1,capHeight:"0.71em",fill:LX,lineHeight:"1em",scaleToFit:!1,textAnchor:"start",verticalAnchor:"end",x:0,y:0},y1=f.forwardRef((e,t)=>{var n=Xn(e,lPe),{x:s,y:r,lineHeight:i,capHeight:o,fill:l,scaleToFit:c,textAnchor:u,verticalAnchor:d}=n,h=$U(n,tPe),p=f.useMemo(()=>oPe({breakAll:h.breakAll,children:h.children,maxLines:h.maxLines,scaleToFit:c,style:h.style,width:h.width}),[h.breakAll,h.children,h.maxLines,c,h.style,h.width]),{dx:x,dy:b,angle:j,className:y,breakAll:N}=h,w=$U(h,aPe);if(!Ho(s)||!Ho(r)||p.length===0)return null;var S=Number(s)+(Ut(x)?x:0),_=Number(r)+(Ut(b)?b:0);if(!xn(S)||!xn(_))return null;var T;switch(d){case"start":T=nA("calc(".concat(o,")"));break;case"middle":T=nA("calc(".concat((p.length-1)/2," * -").concat(i," + (").concat(o," / 2))"));break;default:T=nA("calc(".concat(p.length-1," * -").concat(i,")"));break}var k=[];if(c){var A=p[0].width,{width:E}=h;k.push("scale(".concat(Ut(E)&&Ut(A)?E/A:1,")"))}return j&&k.push("rotate(".concat(j,", ").concat(S,", ").concat(_,")")),k.length&&(w.transform=k.join(" ")),f.createElement("text",RE({},Ys(w),{ref:t,x:S,y:_,className:Rt("recharts-text",y),textAnchor:u,fill:l.includes("url")?LX:l}),p.map((M,F)=>{var D=M.words.join(N?"":" ");return f.createElement("tspan",{x:S,dy:F===0?T:i,key:"".concat(D,"-").concat(F)},D)}))});y1.displayName="Text";var cPe=["labelRef"],dPe=["content"];function FU(e,t){if(e==null)return{};var n,s,r=uPe(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)n=i[s],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function uPe(e,t){if(e==null)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;n[s]=e[s]}return n}function UU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function Pn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?UU(Object(n),!0).forEach(function(s){mPe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):UU(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function mPe(e,t,n){return(t=fPe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function fPe(e){var t=hPe(e,"string");return typeof t=="symbol"?t:t+""}function hPe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kl(){return kl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},kl.apply(null,arguments)}var DX=f.createContext(null),gPe=e=>{var{x:t,y:n,upperWidth:s,lowerWidth:r,width:i,height:o,children:l}=e,c=f.useMemo(()=>({x:t,y:n,upperWidth:s,lowerWidth:r,width:i,height:o}),[t,n,s,r,i,o]);return f.createElement(DX.Provider,{value:c},l)},PX=()=>{var e=f.useContext(DX),t=JN();return e||DQ(t)},pPe=f.createContext(null),xPe=()=>{var e=f.useContext(pPe),t=Bt(CK);return e||t},yPe=e=>{var{value:t,formatter:n}=e,s=fn(e.children)?t:e.children;return typeof n=="function"?n(s):s},IP=e=>e!=null&&typeof e=="function",bPe=(e,t)=>{var n=bs(t-e),s=Math.min(Math.abs(t-e),360);return n*s},vPe=(e,t,n,s,r)=>{var{offset:i,className:o}=e,{cx:l,cy:c,innerRadius:u,outerRadius:d,startAngle:h,endAngle:p,clockWise:x}=r,b=(u+d)/2,j=bPe(h,p),y=j>=0?1:-1,N,w;switch(t){case"insideStart":N=h+y*i,w=x;break;case"insideEnd":N=p-y*i,w=!x;break;case"end":N=p+y*i,w=x;break;default:throw new Error("Unsupported position ".concat(t))}w=j<=0?w:!w;var S=qn(l,c,b,N),_=qn(l,c,b,N+(w?1:-1)*359),T="M".concat(S.x,",").concat(S.y,`
    A`).concat(b,",").concat(b,",0,1,").concat(w?0:1,`,
    `).concat(_.x,",").concat(_.y),k=fn(e.id)?Fp("recharts-radial-line-"):e.id;return f.createElement("text",kl({},s,{dominantBaseline:"central",className:Rt("recharts-radial-bar-label",o)}),f.createElement("defs",null,f.createElement("path",{id:k,d:T})),f.createElement("textPath",{xlinkHref:"#".concat(k)},n))},wPe=(e,t,n)=>{var{cx:s,cy:r,innerRadius:i,outerRadius:o,startAngle:l,endAngle:c}=e,u=(l+c)/2;if(n==="outside"){var{x:d,y:h}=qn(s,r,o+t,u);return{x:d,y:h,textAnchor:d>=s?"start":"end",verticalAnchor:"middle"}}if(n==="center")return{x:s,y:r,textAnchor:"middle",verticalAnchor:"middle"};if(n==="centerTop")return{x:s,y:r,textAnchor:"middle",verticalAnchor:"start"};if(n==="centerBottom")return{x:s,y:r,textAnchor:"middle",verticalAnchor:"end"};var p=(i+o)/2,{x,y:b}=qn(s,r,p,u);return{x,y:b,textAnchor:"middle",verticalAnchor:"middle"}},zE=e=>"cx"in e&&Ut(e.cx),jPe=(e,t)=>{var{parentViewBox:n,offset:s,position:r}=e,i;n!=null&&!zE(n)&&(i=n);var{x:o,y:l,upperWidth:c,lowerWidth:u,height:d}=t,h=o,p=o+(c-u)/2,x=(h+p)/2,b=(c+u)/2,j=h+c/2,y=d>=0?1:-1,N=y*s,w=y>0?"end":"start",S=y>0?"start":"end",_=c>=0?1:-1,T=_*s,k=_>0?"end":"start",A=_>0?"start":"end";if(r==="top"){var E={x:h+c/2,y:l-N,textAnchor:"middle",verticalAnchor:w};return Pn(Pn({},E),i?{height:Math.max(l-i.y,0),width:c}:{})}if(r==="bottom"){var M={x:p+u/2,y:l+d+N,textAnchor:"middle",verticalAnchor:S};return Pn(Pn({},M),i?{height:Math.max(i.y+i.height-(l+d),0),width:u}:{})}if(r==="left"){var F={x:x-T,y:l+d/2,textAnchor:k,verticalAnchor:"middle"};return Pn(Pn({},F),i?{width:Math.max(F.x-i.x,0),height:d}:{})}if(r==="right"){var D={x:x+b+T,y:l+d/2,textAnchor:A,verticalAnchor:"middle"};return Pn(Pn({},D),i?{width:Math.max(i.x+i.width-D.x,0),height:d}:{})}var P=i?{width:b,height:d}:{};return r==="insideLeft"?Pn({x:x+T,y:l+d/2,textAnchor:A,verticalAnchor:"middle"},P):r==="insideRight"?Pn({x:x+b-T,y:l+d/2,textAnchor:k,verticalAnchor:"middle"},P):r==="insideTop"?Pn({x:h+c/2,y:l+N,textAnchor:"middle",verticalAnchor:S},P):r==="insideBottom"?Pn({x:p+u/2,y:l+d-N,textAnchor:"middle",verticalAnchor:w},P):r==="insideTopLeft"?Pn({x:h+T,y:l+N,textAnchor:A,verticalAnchor:S},P):r==="insideTopRight"?Pn({x:h+c-T,y:l+N,textAnchor:k,verticalAnchor:S},P):r==="insideBottomLeft"?Pn({x:p+T,y:l+d-N,textAnchor:A,verticalAnchor:w},P):r==="insideBottomRight"?Pn({x:p+u-T,y:l+d-N,textAnchor:k,verticalAnchor:w},P):r&&typeof r=="object"&&(Ut(r.x)||Ql(r.x))&&(Ut(r.y)||Ql(r.y))?Pn({x:o+Fs(r.x,b),y:l+Fs(r.y,d),textAnchor:"end",verticalAnchor:"end"},P):Pn({x:j,y:l+d/2,textAnchor:"middle",verticalAnchor:"middle"},P)},NPe={angle:0,offset:5,zIndex:Gn.label,position:"middle",textBreakAll:!1};function Qc(e){var t=Xn(e,NPe),{viewBox:n,position:s,value:r,children:i,content:o,className:l="",textBreakAll:c,labelRef:u}=t,d=xPe(),h=PX(),p=s==="center"?h:d??h,x,b,j;if(n==null?x=p:zE(n)?x=n:x=DQ(n),!x||fn(r)&&fn(i)&&!f.isValidElement(o)&&typeof o!="function")return null;var y=Pn(Pn({},t),{},{viewBox:x});if(f.isValidElement(o)){var{labelRef:N}=y,w=FU(y,cPe);return f.cloneElement(o,w)}if(typeof o=="function"){var{content:S}=y,_=FU(y,dPe);if(b=f.createElement(o,_),f.isValidElement(b))return b}else b=yPe(t);var T=Ys(t);if(zE(x)){if(s==="insideStart"||s==="insideEnd"||s==="end")return vPe(t,s,b,T,x);j=wPe(x,t.offset,t.position)}else j=jPe(t,x);return f.createElement(Sr,{zIndex:t.zIndex},f.createElement(y1,kl({ref:u,className:Rt("recharts-label",l)},T,j,{textAnchor:sPe(T.textAnchor)?T.textAnchor:j.textAnchor,breakAll:c}),b))}Qc.displayName="Label";var CPe=(e,t,n)=>{if(!e)return null;var s={viewBox:t,labelRef:n};return e===!0?f.createElement(Qc,kl({key:"label-implicit"},s)):Ho(e)?f.createElement(Qc,kl({key:"label-implicit",value:e},s)):f.isValidElement(e)?e.type===Qc?f.cloneElement(e,Pn({key:"label-implicit"},s)):f.createElement(Qc,kl({key:"label-implicit",content:e},s)):IP(e)?f.createElement(Qc,kl({key:"label-implicit",content:e},s)):e&&typeof e=="object"?f.createElement(Qc,kl({},e,{key:"label-implicit"},s)):null};function SPe(e){var{label:t,labelRef:n}=e,s=PX();return CPe(t,s,n)||null}var sA={},rA={},BU;function _Pe(){return BU||(BU=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return n[n.length-1]}e.last=t})(rA)),rA}var iA={},HU;function APe(){return HU||(HU=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return Array.isArray(n)?n:Array.from(n)}e.toArray=t})(iA)),iA}var qU;function TPe(){return qU||(qU=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=_Pe(),n=APe(),s=LD();function r(i){if(s.isArrayLike(i))return t.last(n.toArray(i))}e.last=r})(sA)),sA}var oA,GU;function kPe(){return GU||(GU=1,oA=TPe().last),oA}var EPe=kPe();const LPe=ao(EPe);var DPe=["valueAccessor"],PPe=["dataKey","clockWise","id","textBreakAll","zIndex"];function Iw(){return Iw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Iw.apply(null,arguments)}function WU(e,t){if(e==null)return{};var n,s,r=OPe(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)n=i[s],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function OPe(e,t){if(e==null)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;n[s]=e[s]}return n}var MPe=e=>Array.isArray(e.value)?LPe(e.value):e.value,OX=f.createContext(void 0),MX=OX.Provider,IX=f.createContext(void 0),IPe=IX.Provider;function $Pe(){return f.useContext(OX)}function RPe(){return f.useContext(IX)}function Cv(e){var{valueAccessor:t=MPe}=e,n=WU(e,DPe),{dataKey:s,clockWise:r,id:i,textBreakAll:o,zIndex:l}=n,c=WU(n,PPe),u=$Pe(),d=RPe(),h=u||d;return!h||!h.length?null:f.createElement(Sr,{zIndex:l??Gn.label},f.createElement(vs,{className:"recharts-label-list"},h.map((p,x)=>{var b,j=fn(s)?t(p,x):Ga(p&&p.payload,s),y=fn(i)?{}:{id:"".concat(i,"-").concat(x)};return f.createElement(Qc,Iw({key:"label-".concat(x)},Ys(p),c,y,{fill:(b=n.fill)!==null&&b!==void 0?b:p.fill,parentViewBox:p.parentViewBox,value:j,textBreakAll:o,viewBox:p.viewBox,index:x,zIndex:0}))})))}Cv.displayName="LabelList";function $P(e){var{label:t}=e;return t?t===!0?f.createElement(Cv,{key:"labelList-implicit"}):f.isValidElement(t)||IP(t)?f.createElement(Cv,{key:"labelList-implicit",content:t}):typeof t=="object"?f.createElement(Cv,Iw({key:"labelList-implicit"},t,{type:String(t.type)})):null:null}function FE(){return FE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},FE.apply(null,arguments)}var $X=e=>{var{cx:t,cy:n,r:s,className:r}=e,i=Rt("recharts-dot",r);return Ut(t)&&Ut(n)&&Ut(s)?f.createElement("circle",FE({},qr(e),ED(e),{className:i,cx:t,cy:n,r:s})):null},RX=e=>e.graphicalItems.polarItems,zPe=dt([pn,u0],rP),b1=dt([RX,bn,zPe],iP),FPe=dt([b1],oP),v1=dt([FPe,r1],lP),UPe=dt([v1,bn,b1],dP);dt([v1,bn,b1],(e,t,n)=>n.length>0?e.flatMap(s=>n.flatMap(r=>{var i,o=Ga(s,(i=t.dataKey)!==null&&i!==void 0?i:r.dataKey);return{value:o,errorDomain:[]}})).filter(Boolean):t?.dataKey!=null?e.map(s=>({value:Ga(s,t.dataKey),errorDomain:[]})):e.map(s=>({value:s,errorDomain:[]})));var VU=()=>{},BPe=dt([v1,bn,b1,f1,pn],hP),HPe=dt([bn,mP,fP,VU,BPe,VU,wa,pn],gP),zX=dt([bn,wa,v1,UPe,d0,pn,HPe],pP),qPe=dt([zX,bn,Nh],bP);dt([bn,zX,qPe,pn],wP);var GPe={radiusAxis:{},angleAxis:{}},FX=Cr({name:"polarAxis",initialState:GPe,reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis:gYe,removeRadiusAxis:pYe,addAngleAxis:xYe,removeAngleAxis:yYe}=FX.actions,WPe=FX.reducer;function YU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function QU(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?YU(Object(n),!0).forEach(function(s){VPe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):YU(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function VPe(e,t,n){return(t=YPe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function YPe(e){var t=QPe(e,"string");return typeof t=="symbol"?t:t+""}function QPe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var KPe=(e,t)=>t,RP=dt([RX,KPe],(e,t)=>e.filter(n=>n.type==="pie").find(n=>n.id===t)),XPe=[],zP=(e,t,n)=>n?.length===0?XPe:n,UX=dt([r1,RP,zP],(e,t,n)=>{var{chartData:s}=e;if(t!=null){var r;if(t?.data!=null&&t.data.length>0?r=t.data:r=s,(!r||!r.length)&&n!=null&&(r=n.map(i=>QU(QU({},t.presentationProps),i.props))),r!=null)return r}}),ZPe=dt([UX,RP,zP],(e,t,n)=>{if(!(e==null||t==null))return e.map((s,r)=>{var i,o=Ga(s,t.nameKey,t.name),l;return n!=null&&(i=n[r])!==null&&i!==void 0&&(i=i.props)!==null&&i!==void 0&&i.fill?l=n[r].props.fill:typeof s=="object"&&s!=null&&"fill"in s?l=s.fill:l=t.fill,{value:xh(o,t.dataKey),color:l,payload:s,type:t.legendType}})}),JPe=dt([UX,RP,zP,ds],(e,t,n,s)=>{if(!(t==null||e==null))return Z3e({offset:s,pieSettings:t,displayedData:e,cells:n})}),KU=e=>typeof e=="string"?e:e?e.displayName||e.name||"Component":"",XU=null,lA=null,BX=e=>{if(e===XU&&Array.isArray(lA))return lA;var t=[];return f.Children.forEach(e,n=>{fn(n)||(LL.isFragment(n)?t=t.concat(BX(n.props.children)):t.push(n))}),lA=t,XU=e,t};function FP(e,t){var n=[],s=[];return Array.isArray(t)?s=t.map(r=>KU(r)):s=[KU(t)],BX(e).forEach(r=>{var i=Wu(r,"type.displayName")||Wu(r,"type.name");i&&s.indexOf(i)!==-1&&n.push(r)}),n}var HX=e=>e&&typeof e=="object"&&"clipDot"in e?!!e.clipDot:!0,cA={},ZU;function e3e(){return ZU||(ZU=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){if(typeof n!="object"||n==null)return!1;if(Object.getPrototypeOf(n)===null)return!0;if(Object.prototype.toString.call(n)!=="[object Object]"){const r=n[Symbol.toStringTag];return r==null||!Object.getOwnPropertyDescriptor(n,Symbol.toStringTag)?.writable?!1:n.toString()===`[object ${r}]`}let s=n;for(;Object.getPrototypeOf(s)!==null;)s=Object.getPrototypeOf(s);return Object.getPrototypeOf(n)===s}e.isPlainObject=t})(cA)),cA}var dA,JU;function t3e(){return JU||(JU=1,dA=e3e().isPlainObject),dA}var a3e=t3e();const n3e=ao(a3e);var e7,t7,a7,n7,s7;function r7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function i7(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?r7(Object(n),!0).forEach(function(s){s3e(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r7(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function s3e(e,t,n){return(t=r3e(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r3e(e){var t=i3e(e,"string");return typeof t=="symbol"?t:t+""}function i3e(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $w(){return $w=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},$w.apply(null,arguments)}function Lg(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var o7=(e,t,n,s,r)=>{var i=n-s,o;return o=Cn(e7||(e7=Lg(["M ",",",""])),e,t),o+=Cn(t7||(t7=Lg(["L ",",",""])),e+n,t),o+=Cn(a7||(a7=Lg(["L ",",",""])),e+n-i/2,t+r),o+=Cn(n7||(n7=Lg(["L ",",",""])),e+n-i/2-s,t+r),o+=Cn(s7||(s7=Lg(["L ",","," Z"])),e,t),o},o3e={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},l3e=e=>{var t=Xn(e,o3e),{x:n,y:s,upperWidth:r,lowerWidth:i,height:o,className:l}=t,{animationEasing:c,animationDuration:u,animationBegin:d,isUpdateAnimationActive:h}=t,p=f.useRef(null),[x,b]=f.useState(-1),j=f.useRef(r),y=f.useRef(i),N=f.useRef(o),w=f.useRef(n),S=f.useRef(s),_=c0(e,"trapezoid-");if(f.useEffect(()=>{if(p.current&&p.current.getTotalLength)try{var G=p.current.getTotalLength();G&&b(G)}catch{}},[]),n!==+n||s!==+s||r!==+r||i!==+i||o!==+o||r===0&&i===0||o===0)return null;var T=Rt("recharts-trapezoid",l);if(!h)return f.createElement("g",null,f.createElement("path",$w({},Ys(t),{className:T,d:o7(n,s,r,i,o)})));var k=j.current,A=y.current,E=N.current,M=w.current,F=S.current,D="0px ".concat(x===-1?1:x,"px"),P="".concat(x,"px 0px"),B=WQ(["strokeDasharray"],u,c);return f.createElement(l0,{animationId:_,key:_,canBegin:x>0,duration:u,easing:c,isActive:h,begin:d},G=>{var $=dn(k,r,G),W=dn(A,i,G),Z=dn(E,o,G),Q=dn(M,n,G),le=dn(F,s,G);p.current&&(j.current=$,y.current=W,N.current=Z,w.current=Q,S.current=le);var we=G>0?{transition:B,strokeDasharray:P}:{strokeDasharray:D};return f.createElement("path",$w({},Ys(t),{className:T,d:o7(Q,le,$,W,Z),ref:p,style:i7(i7({},we),t.style)}))})},c3e=["option","shapeType","activeClassName"];function d3e(e,t){if(e==null)return{};var n,s,r=u3e(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)n=i[s],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function u3e(e,t){if(e==null)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;n[s]=e[s]}return n}function l7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function Rw(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?l7(Object(n),!0).forEach(function(s){m3e(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l7(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function m3e(e,t,n){return(t=f3e(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f3e(e){var t=h3e(e,"string");return typeof t=="symbol"?t:t+""}function h3e(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function g3e(e,t){return Rw(Rw({},t),e)}function p3e(e,t){return e==="symbols"}function c7(e){var{shapeType:t,elementProps:n}=e;switch(t){case"rectangle":return f.createElement(KQ,n);case"trapezoid":return f.createElement(l3e,n);case"sector":return f.createElement(eK,n);case"symbols":if(p3e(t))return f.createElement(kD,n);break;case"curve":return f.createElement(VD,n);default:return null}}function x3e(e){return f.isValidElement(e)?e.props:e}function UP(e){var{option:t,shapeType:n,activeClassName:s="recharts-active-shape"}=e,r=d3e(e,c3e),i;if(f.isValidElement(t))i=f.cloneElement(t,Rw(Rw({},r),x3e(t)));else if(typeof t=="function")i=t(r,r.index);else if(n3e(t)&&typeof t!="boolean"){var o=g3e(t,r);i=f.createElement(c7,{shapeType:n,elementProps:o})}else{var l=r;i=f.createElement(c7,{shapeType:n,elementProps:l})}return r.isActive?f.createElement(vs,{className:s},i):i}var BP=(e,t,n)=>{var s=Ja();return(r,i)=>o=>{e?.(r,i,o),s(tX({activeIndex:String(i),activeDataKey:t,activeCoordinate:r.tooltipPosition,activeGraphicalItemId:n}))}},HP=e=>{var t=Ja();return(n,s)=>r=>{e?.(n,s,r),t(ALe())}},qP=(e,t,n)=>{var s=Ja();return(r,i)=>o=>{e?.(r,i,o),s(TLe({activeIndex:String(i),activeDataKey:t,activeCoordinate:r.tooltipPosition,activeGraphicalItemId:n}))}};function GP(e){var{tooltipEntrySettings:t}=e,n=Ja(),s=Hs(),r=f.useRef(null);return f.useLayoutEffect(()=>{s||(r.current===null?n(NLe(t)):r.current!==t&&n(CLe({prev:r.current,next:t})),r.current=t)},[t,n,s]),f.useLayoutEffect(()=>()=>{r.current&&(n(SLe(r.current)),r.current=null)},[n]),null}function qX(e){var{legendPayload:t}=e,n=Ja(),s=Hs(),r=f.useRef(null);return f.useLayoutEffect(()=>{s||(r.current===null?n(UQ(t)):r.current!==t&&n(BQ({prev:r.current,next:t})),r.current=t)},[n,s,t]),f.useLayoutEffect(()=>()=>{r.current&&(n(HQ(r.current)),r.current=null)},[n]),null}function y3e(e){var{legendPayload:t}=e,n=Ja(),s=Bt(wa),r=f.useRef(null);return f.useLayoutEffect(()=>{s!=="centric"&&s!=="radial"||(r.current===null?n(UQ(t)):r.current!==t&&n(BQ({prev:r.current,next:t})),r.current=t)},[n,s,t]),f.useLayoutEffect(()=>()=>{r.current&&(n(HQ(r.current)),r.current=null)},[n]),null}var uA,b3e=()=>{var[e]=f.useState(()=>Fp("uid-"));return e},v3e=(uA=Mu.useId)!==null&&uA!==void 0?uA:b3e;function w3e(e,t){var n=v3e();return t||(e?"".concat(e,"-").concat(n):n)}var j3e=f.createContext(void 0),WP=e=>{var{id:t,type:n,children:s}=e,r=w3e("recharts-".concat(n),t);return f.createElement(j3e.Provider,{value:r},s(r))},N3e={cartesianItems:[],polarItems:[]},GX=Cr({name:"graphicalItems",initialState:N3e,reducers:{addCartesianGraphicalItem:{reducer(e,t){e.cartesianItems.push(t.payload)},prepare:cn()},replaceCartesianGraphicalItem:{reducer(e,t){var{prev:n,next:s}=t.payload,r=Vi(e).cartesianItems.indexOf(n);r>-1&&(e.cartesianItems[r]=s)},prepare:cn()},removeCartesianGraphicalItem:{reducer(e,t){var n=Vi(e).cartesianItems.indexOf(t.payload);n>-1&&e.cartesianItems.splice(n,1)},prepare:cn()},addPolarGraphicalItem:{reducer(e,t){e.polarItems.push(t.payload)},prepare:cn()},removePolarGraphicalItem:{reducer(e,t){var n=Vi(e).polarItems.indexOf(t.payload);n>-1&&e.polarItems.splice(n,1)},prepare:cn()}}}),{addCartesianGraphicalItem:C3e,replaceCartesianGraphicalItem:S3e,removeCartesianGraphicalItem:_3e,addPolarGraphicalItem:A3e,removePolarGraphicalItem:T3e}=GX.actions,k3e=GX.reducer,E3e=e=>{var t=Ja(),n=f.useRef(null);return f.useLayoutEffect(()=>{n.current===null?t(C3e(e)):n.current!==e&&t(S3e({prev:n.current,next:e})),n.current=e},[t,e]),f.useLayoutEffect(()=>()=>{n.current&&(t(_3e(n.current)),n.current=null)},[t]),null},WX=f.memo(E3e);function L3e(e){var t=Ja();return f.useLayoutEffect(()=>(t(A3e(e)),()=>{t(T3e(e))}),[t,e]),null}var D3e=["key"],P3e=["onMouseEnter","onClick","onMouseLeave"],O3e=["id"],M3e=["id"];function d7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function Sn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?d7(Object(n),!0).forEach(function(s){I3e(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d7(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function I3e(e,t,n){return(t=$3e(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $3e(e){var t=R3e(e,"string");return typeof t=="symbol"?t:t+""}function R3e(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vd(){return vd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},vd.apply(null,arguments)}function w1(e,t){if(e==null)return{};var n,s,r=z3e(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)n=i[s],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function z3e(e,t){if(e==null)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;n[s]=e[s]}return n}function F3e(e){var t=f.useMemo(()=>FP(e.children,x1),[e.children]),n=Bt(s=>ZPe(s,e.id,t));return n==null?null:f.createElement(y3e,{legendPayload:n})}var U3e=f.memo(e=>{var{dataKey:t,nameKey:n,sectors:s,stroke:r,strokeWidth:i,fill:o,name:l,hide:c,tooltipType:u,id:d}=e,h={dataDefinedOnItem:s.map(p=>p.tooltipPayload),positions:s.map(p=>p.tooltipPosition),settings:{stroke:r,strokeWidth:i,fill:o,dataKey:t,nameKey:n,name:xh(l,t),hide:c,type:u,color:o,unit:"",graphicalItemId:d}};return f.createElement(GP,{tooltipEntrySettings:h})}),B3e=(e,t)=>e>t?"start":e<t?"end":"middle",H3e=(e,t,n)=>Fs(typeof t=="function"?t(e):t,n,n*.8),q3e=(e,t,n)=>{var{top:s,left:r,width:i,height:o}=t,l=XQ(i,o),c=r+Fs(e.cx,i,i/2),u=s+Fs(e.cy,o,o/2),d=Fs(e.innerRadius,l,0),h=H3e(n,e.outerRadius,l),p=e.maxRadius||Math.sqrt(i*i+o*o)/2;return{cx:c,cy:u,innerRadius:d,outerRadius:h,maxRadius:p}},G3e=(e,t)=>{var n=bs(t-e),s=Math.min(Math.abs(t-e),360);return n*s};function W3e(e){return e&&typeof e=="object"&&"className"in e&&typeof e.className=="string"?e.className:""}var V3e=(e,t)=>{if(f.isValidElement(e))return f.cloneElement(e,t);if(typeof e=="function")return e(t);var n=Rt("recharts-pie-label-line",typeof e!="boolean"?e.className:""),{key:s}=t,r=w1(t,D3e);return f.createElement(VD,vd({},r,{type:"linear",className:n}))},Y3e=(e,t,n)=>{if(f.isValidElement(e))return f.cloneElement(e,t);var s=n;if(typeof e=="function"&&(s=e(t),f.isValidElement(s)))return s;var r=Rt("recharts-pie-label-text",W3e(e));return f.createElement(y1,vd({},t,{alignmentBaseline:"middle",className:r}),s)};function Q3e(e){var{sectors:t,props:n,showLabels:s}=e,{label:r,labelLine:i,dataKey:o}=n;if(!s||!r||!t)return null;var l=qr(n),c=Gu(r),u=Gu(i),d=typeof r=="object"&&"offsetRadius"in r&&typeof r.offsetRadius=="number"&&r.offsetRadius||20,h=t.map((p,x)=>{var b=(p.startAngle+p.endAngle)/2,j=qn(p.cx,p.cy,p.outerRadius+d,b),y=Sn(Sn(Sn(Sn({},l),p),{},{stroke:"none"},c),{},{index:x,textAnchor:B3e(j.x,p.cx)},j),N=Sn(Sn(Sn(Sn({},l),p),{},{fill:"none",stroke:p.fill},u),{},{index:x,points:[qn(p.cx,p.cy,p.outerRadius,b),j],key:"line"});return f.createElement(Sr,{zIndex:Gn.label,key:"label-".concat(p.startAngle,"-").concat(p.endAngle,"-").concat(p.midAngle,"-").concat(x)},f.createElement(vs,null,i&&V3e(i,N),Y3e(r,y,Ga(p,o))))});return f.createElement(vs,{className:"recharts-pie-labels"},h)}function K3e(e){var{sectors:t,props:n,showLabels:s}=e,{label:r}=n;return typeof r=="object"&&r!=null&&"position"in r?f.createElement($P,{label:r}):f.createElement(Q3e,{sectors:t,props:n,showLabels:s})}function X3e(e){var{sectors:t,activeShape:n,inactiveShape:s,allOtherPieProps:r,shape:i,id:o}=e,l=Bt(bd),c=Bt(EP),u=Bt(f4e),{onMouseEnter:d,onClick:h,onMouseLeave:p}=r,x=w1(r,P3e),b=BP(d,r.dataKey,o),j=HP(p),y=qP(h,r.dataKey,o);return t==null||t.length===0?null:f.createElement(f.Fragment,null,t.map((N,w)=>{if(N?.startAngle===0&&N?.endAngle===0&&t.length!==1)return null;var S=u==null||u===o,_=String(w)===l&&(c==null||r.dataKey===c)&&S,T=l?s:null,k=n&&_?n:T,A=Sn(Sn({},N),{},{stroke:N.stroke,tabIndex:-1,[AQ]:w,[TQ]:o});return f.createElement(vs,vd({key:"sector-".concat(N?.startAngle,"-").concat(N?.endAngle,"-").concat(N.midAngle,"-").concat(w),tabIndex:-1,className:"recharts-pie-sector"},a0(x,N,w),{onMouseEnter:b(N,w),onMouseLeave:j(N,w),onClick:y(N,w)}),f.createElement(UP,vd({option:i??k,index:w,shapeType:"sector",isActive:_},A)))}))}function Z3e(e){var t,{pieSettings:n,displayedData:s,cells:r,offset:i}=e,{cornerRadius:o,startAngle:l,endAngle:c,dataKey:u,nameKey:d,tooltipType:h}=n,p=Math.abs(n.minAngle),x=G3e(l,c),b=Math.abs(x),j=s.length<=1?0:(t=n.paddingAngle)!==null&&t!==void 0?t:0,y=s.filter(k=>Ga(k,u,0)!==0).length,N=(b>=360?y:y-1)*j,w=b-y*p-N,S=s.reduce((k,A)=>{var E=Ga(A,u,0);return k+(Ut(E)?E:0)},0),_;if(S>0){var T;_=s.map((k,A)=>{var E=Ga(k,u,0),M=Ga(k,d,A),F=q3e(n,i,k),D=(Ut(E)?E:0)/S,P,B=Sn(Sn({},k),r&&r[A]&&r[A].props);A?P=T.endAngle+bs(x)*j*(E!==0?1:0):P=l;var G=P+bs(x)*((E!==0?p:0)+D*w),$=(P+G)/2,W=(F.innerRadius+F.outerRadius)/2,Z=[{name:M,value:E,payload:B,dataKey:u,type:h,graphicalItemId:n.id}],Q=qn(F.cx,F.cy,W,$);return T=Sn(Sn(Sn(Sn({},n.presentationProps),{},{percent:D,cornerRadius:typeof o=="string"?parseFloat(o):o,name:M,tooltipPayload:Z,midAngle:$,middleRadius:W,tooltipPosition:Q},B),F),{},{value:E,dataKey:u,startAngle:P,endAngle:G,payload:B,paddingAngle:bs(x)*j}),T})}return _}function J3e(e){var{showLabels:t,sectors:n,children:s}=e,r=f.useMemo(()=>!t||!n?[]:n.map(i=>({value:i.value,payload:i.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:i.cx,cy:i.cy,innerRadius:i.innerRadius,outerRadius:i.outerRadius,startAngle:i.startAngle,endAngle:i.endAngle,clockWise:!1},fill:i.fill})),[n,t]);return f.createElement(IPe,{value:t?r:void 0},s)}function e5e(e){var{props:t,previousSectorsRef:n,id:s}=e,{sectors:r,isAnimationActive:i,animationBegin:o,animationDuration:l,animationEasing:c,activeShape:u,inactiveShape:d,onAnimationStart:h,onAnimationEnd:p}=t,x=c0(t,"recharts-pie-"),b=n.current,[j,y]=f.useState(!1),N=f.useCallback(()=>{typeof p=="function"&&p(),y(!1)},[p]),w=f.useCallback(()=>{typeof h=="function"&&h(),y(!0)},[h]);return f.createElement(J3e,{showLabels:!j,sectors:r},f.createElement(l0,{animationId:x,begin:o,duration:l,isActive:i,easing:c,onAnimationStart:w,onAnimationEnd:N,key:x},S=>{var _=[],T=r&&r[0],k=T?.startAngle;return r?.forEach((A,E)=>{var M=b&&b[E],F=E>0?Wu(A,"paddingAngle",0):0;if(M){var D=dn(M.endAngle-M.startAngle,A.endAngle-A.startAngle,S),P=Sn(Sn({},A),{},{startAngle:k+F,endAngle:k+D+F});_.push(P),k=P.endAngle}else{var{endAngle:B,startAngle:G}=A,$=dn(0,B-G,S),W=Sn(Sn({},A),{},{startAngle:k+F,endAngle:k+$+F});_.push(W),k=W.endAngle}}),n.current=_,f.createElement(vs,null,f.createElement(X3e,{sectors:_,activeShape:u,inactiveShape:d,allOtherPieProps:t,shape:t.shape,id:s}))}),f.createElement(K3e,{showLabels:!j,sectors:r,props:t}),t.children)}var t5e={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:"auto",label:!1,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff",zIndex:Gn.area};function a5e(e){var{id:t}=e,n=w1(e,O3e),{hide:s,className:r,rootTabIndex:i}=e,o=f.useMemo(()=>FP(e.children,x1),[e.children]),l=Bt(d=>JPe(d,t,o)),c=f.useRef(null),u=Rt("recharts-pie",r);return s||l==null?(c.current=null,f.createElement(vs,{tabIndex:i,className:u})):f.createElement(Sr,{zIndex:e.zIndex},f.createElement(U3e,{dataKey:e.dataKey,nameKey:e.nameKey,sectors:l,stroke:e.stroke,strokeWidth:e.strokeWidth,fill:e.fill,name:e.name,hide:e.hide,tooltipType:e.tooltipType,id:t}),f.createElement(vs,{tabIndex:i,className:u},f.createElement(e5e,{props:Sn(Sn({},n),{},{sectors:l}),previousSectorsRef:c,id:t})))}function VX(e){var t=Xn(e,t5e),{id:n}=t,s=w1(t,M3e),r=qr(s);return f.createElement(WP,{id:n,type:"pie"},i=>f.createElement(f.Fragment,null,f.createElement(L3e,{type:"pie",id:i,data:s.data,dataKey:s.dataKey,hide:s.hide,angleAxisId:0,radiusAxisId:0,name:s.name,nameKey:s.nameKey,tooltipType:s.tooltipType,legendType:s.legendType,fill:s.fill,cx:s.cx,cy:s.cy,startAngle:s.startAngle,endAngle:s.endAngle,paddingAngle:s.paddingAngle,minAngle:s.minAngle,innerRadius:s.innerRadius,outerRadius:s.outerRadius,cornerRadius:s.cornerRadius,presentationProps:r,maxRadius:t.maxRadius}),f.createElement(F3e,vd({},s,{id:i})),f.createElement(a5e,vd({},s,{id:i}))))}VX.displayName="Pie";var n5e=["points"];function u7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function mA(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?u7(Object(n),!0).forEach(function(s){s5e(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u7(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function s5e(e,t,n){return(t=r5e(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r5e(e){var t=i5e(e,"string");return typeof t=="symbol"?t:t+""}function i5e(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zw(){return zw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},zw.apply(null,arguments)}function o5e(e,t){if(e==null)return{};var n,s,r=l5e(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)n=i[s],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function l5e(e,t){if(e==null)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;n[s]=e[s]}return n}function c5e(e){var{option:t,dotProps:n,className:s}=e;if(f.isValidElement(t))return f.cloneElement(t,n);if(typeof t=="function")return t(n);var r=Rt(s,typeof t!="boolean"?t.className:""),i=n??{},{points:o}=i,l=o5e(i,n5e);return f.createElement($X,zw({},l,{className:r}))}function d5e(e,t){return e==null?!1:t?!0:e.length===1}function u5e(e){var{points:t,dot:n,className:s,dotClassName:r,dataKey:i,baseProps:o,needClip:l,clipPathId:c,zIndex:u=Gn.scatter}=e;if(!d5e(t,n))return null;var d=HX(n),h=ZSe(n),p=t.map((b,j)=>{var y,N,w=mA(mA(mA({r:3},o),h),{},{index:j,cx:(y=b.x)!==null&&y!==void 0?y:void 0,cy:(N=b.y)!==null&&N!==void 0?N:void 0,dataKey:i,value:b.value,payload:b.payload,points:t});return f.createElement(c5e,{key:"dot-".concat(j),option:n,dotProps:w,className:r})}),x={};return l&&c!=null&&(x.clipPath="url(#clipPath-".concat(d?"":"dots-").concat(c,")")),f.createElement(Sr,{zIndex:u},f.createElement(vs,zw({className:s},x),p))}function m7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function f7(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?m7(Object(n),!0).forEach(function(s){m5e(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m7(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function m5e(e,t,n){return(t=f5e(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f5e(e){var t=h5e(e,"string");return typeof t=="symbol"?t:t+""}function h5e(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var YX=0,g5e={xAxis:{},yAxis:{},zAxis:{}},QX=Cr({name:"cartesianAxis",initialState:g5e,reducers:{addXAxis:{reducer(e,t){e.xAxis[t.payload.id]=t.payload},prepare:cn()},replaceXAxis:{reducer(e,t){var{prev:n,next:s}=t.payload;e.xAxis[n.id]!==void 0&&(n.id!==s.id&&delete e.xAxis[n.id],e.xAxis[s.id]=s)},prepare:cn()},removeXAxis:{reducer(e,t){delete e.xAxis[t.payload.id]},prepare:cn()},addYAxis:{reducer(e,t){e.yAxis[t.payload.id]=t.payload},prepare:cn()},replaceYAxis:{reducer(e,t){var{prev:n,next:s}=t.payload;e.yAxis[n.id]!==void 0&&(n.id!==s.id&&delete e.yAxis[n.id],e.yAxis[s.id]=s)},prepare:cn()},removeYAxis:{reducer(e,t){delete e.yAxis[t.payload.id]},prepare:cn()},addZAxis:{reducer(e,t){e.zAxis[t.payload.id]=t.payload},prepare:cn()},replaceZAxis:{reducer(e,t){var{prev:n,next:s}=t.payload;e.zAxis[n.id]!==void 0&&(n.id!==s.id&&delete e.zAxis[n.id],e.zAxis[s.id]=s)},prepare:cn()},removeZAxis:{reducer(e,t){delete e.zAxis[t.payload.id]},prepare:cn()},updateYAxisWidth(e,t){var{id:n,width:s}=t.payload,r=e.yAxis[n];if(r){var i=r.widthHistory||[];if(i.length===3&&i[0]===i[2]&&s===i[1]&&s!==r.width&&Math.abs(s-i[0])<=1)return;var o=[...i,s].slice(-3);e.yAxis[n]=f7(f7({},e.yAxis[n]),{},{width:s,widthHistory:o})}}}}),{addXAxis:p5e,replaceXAxis:x5e,removeXAxis:y5e,addYAxis:b5e,replaceYAxis:v5e,removeYAxis:w5e,addZAxis:bYe,replaceZAxis:vYe,removeZAxis:wYe,updateYAxisWidth:j5e}=QX.actions,N5e=QX.reducer,C5e=dt([ds],e=>({top:e.top,bottom:e.bottom,left:e.left,right:e.right})),S5e=dt([C5e,oc,lc],(e,t,n)=>{if(!(!e||t==null||n==null))return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,n-e.top-e.bottom)}}),VP=()=>Bt(S5e),_5e=()=>Bt(y4e);function h7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function fA(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?h7(Object(n),!0).forEach(function(s){A5e(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h7(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function A5e(e,t,n){return(t=T5e(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function T5e(e){var t=k5e(e,"string");return typeof t=="symbol"?t:t+""}function k5e(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var E5e=e=>{var{point:t,childIndex:n,mainColor:s,activeDot:r,dataKey:i,clipPath:o}=e;if(r===!1||t.x==null||t.y==null)return null;var l={index:n,dataKey:i,cx:t.x,cy:t.y,r:4,fill:s??"none",strokeWidth:2,stroke:"#fff",payload:t.payload,value:t.value},c=fA(fA(fA({},l),Gu(r)),ED(r)),u;return f.isValidElement(r)?u=f.cloneElement(r,c):typeof r=="function"?u=r(c):u=f.createElement($X,c),f.createElement(vs,{className:"recharts-active-dot",clipPath:o},u)};function L5e(e){var{points:t,mainColor:n,activeDot:s,itemDataKey:r,clipPath:i,zIndex:o=Gn.activeDot}=e,l=Bt(bd),c=_5e();if(t==null||c==null)return null;var u=t.find(d=>c.includes(d.payload));return fn(u)?null:f.createElement(Sr,{zIndex:o},f.createElement(E5e,{point:u,childIndex:Number(l),mainColor:n,dataKey:r,activeDot:s,clipPath:i}))}var g7=(e,t,n)=>{var s=n??e;if(!fn(s))return Fs(s,t,0)},D5e=(e,t,n)=>{var s={},r=e.filter(l1),i=e.filter(u=>u.stackId==null),o=r.reduce((u,d)=>(u[d.stackId]||(u[d.stackId]=[]),u[d.stackId].push(d),u),s),l=Object.entries(o).map(u=>{var[d,h]=u,p=h.map(b=>b.dataKey),x=g7(t,n,h[0].barSize);return{stackId:d,dataKeys:p,barSize:x}}),c=i.map(u=>{var d=[u.dataKey].filter(p=>p!=null),h=g7(t,n,u.barSize);return{stackId:void 0,dataKeys:d,barSize:h}});return[...l,...c]};function p7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function yb(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?p7(Object(n),!0).forEach(function(s){P5e(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p7(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function P5e(e,t,n){return(t=O5e(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function O5e(e){var t=M5e(e,"string");return typeof t=="symbol"?t:t+""}function M5e(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function I5e(e,t,n,s,r){var i=s.length;if(!(i<1)){var o=Fs(e,n,0,!0),l,c=[];if(xn(s[0].barSize)){var u=!1,d=n/i,h=s.reduce((N,w)=>N+(w.barSize||0),0);h+=(i-1)*o,h>=n&&(h-=(i-1)*o,o=0),h>=n&&d>0&&(u=!0,d*=.9,h=i*d);var p=(n-h)/2>>0,x={offset:p-o,size:0};l=s.reduce((N,w)=>{var S,_={stackId:w.stackId,dataKeys:w.dataKeys,position:{offset:x.offset+x.size+o,size:u?d:(S=w.barSize)!==null&&S!==void 0?S:0}},T=[...N,_];return x=T[T.length-1].position,T},c)}else{var b=Fs(t,n,0,!0);n-2*b-(i-1)*o<=0&&(o=0);var j=(n-2*b-(i-1)*o)/i;j>1&&(j>>=0);var y=xn(r)?Math.min(j,r):j;l=s.reduce((N,w,S)=>[...N,{stackId:w.stackId,dataKeys:w.dataKeys,position:{offset:b+(j+o)*S+(j-y)/2,size:y}}],c)}return l}}var $5e=(e,t,n,s,r,i,o)=>{var l=fn(o)?t:o,c=I5e(n,s,r!==i?r:i,e,l);return r!==i&&c!=null&&(c=c.map(u=>yb(yb({},u),{},{position:yb(yb({},u.position),{},{offset:u.position.offset-r/2})}))),c},R5e=(e,t)=>{var n=nP(t);if(!(!e||n==null||t==null)){var{stackId:s}=t;if(s!=null){var r=e[s];if(r){var{stackedData:i}=r;if(i)return i.find(o=>o.key===n)}}}};function z5e(e,t){return e&&typeof e=="object"&&"zIndex"in e&&typeof e.zIndex=="number"&&xn(e.zIndex)?e.zIndex:t}var KX=e=>{var{chartData:t}=e,n=Ja(),s=Hs();return f.useEffect(()=>s?()=>{}:(n(SU(t)),()=>{n(SU(void 0))}),[t,n,s]),null},x7={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},XX=Cr({name:"brush",initialState:x7,reducers:{setBrushSettings(e,t){return t.payload==null?x7:t.payload}}}),{setBrushSettings:jYe}=XX.actions,F5e=XX.reducer;function U5e(e,t,n){return(t=B5e(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function B5e(e){var t=H5e(e,"string");return typeof t=="symbol"?t:t+""}function H5e(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class YP{static create(t){return new YP(t)}constructor(t){this.scale=t}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(t){var{bandAware:n,position:s}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t!==void 0){if(s)switch(s){case"start":return this.scale(t);case"middle":{var r=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+r}case"end":{var i=this.bandwidth?this.bandwidth():0;return this.scale(t)+i}default:return this.scale(t)}if(n){var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+o}return this.scale(t)}}isInRange(t){var n=this.range(),s=n[0],r=n[n.length-1];return s<=r?t>=s&&t<=r:t>=r&&t<=s}}U5e(YP,"EPS",1e-4);function q5e(e){return(e%180+180)%180}var G5e=function(t){var{width:n,height:s}=t,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=q5e(r),o=i*Math.PI/180,l=Math.atan(s/n),c=o>l&&o<Math.PI-l?s/Math.sin(o):n/Math.cos(o);return Math.abs(c)},W5e={dots:[],areas:[],lines:[]},ZX=Cr({name:"referenceElements",initialState:W5e,reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var n=Vi(e).dots.findIndex(s=>s===t.payload);n!==-1&&e.dots.splice(n,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var n=Vi(e).areas.findIndex(s=>s===t.payload);n!==-1&&e.areas.splice(n,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var n=Vi(e).lines.findIndex(s=>s===t.payload);n!==-1&&e.lines.splice(n,1)}}}),{addDot:NYe,removeDot:CYe,addArea:SYe,removeArea:_Ye,addLine:AYe,removeLine:TYe}=ZX.actions,V5e=ZX.reducer,Y5e=f.createContext(void 0),Q5e=e=>{var{children:t}=e,[n]=f.useState("".concat(Fp("recharts"),"-clip")),s=VP();if(s==null)return null;var{x:r,y:i,width:o,height:l}=s;return f.createElement(Y5e.Provider,{value:n},f.createElement("defs",null,f.createElement("clipPath",{id:n},f.createElement("rect",{x:r,y:i,height:l,width:o}))),t)};function JX(e,t){if(t<1)return[];if(t===1)return e;for(var n=[],s=0;s<e.length;s+=t){var r=e[s];r!==void 0&&n.push(r)}return n}function K5e(e,t,n){var s={width:e.width+t.width,height:e.height+t.height};return G5e(s,n)}function X5e(e,t,n){var s=n==="width",{x:r,y:i,width:o,height:l}=e;return t===1?{start:s?r:i,end:s?r+o:i+l}:{start:s?r+o:i+l,end:s?r:i}}function Kp(e,t,n,s,r){if(e*t<e*s||e*t>e*r)return!1;var i=n();return e*(t-e*i/2-s)>=0&&e*(t+e*i/2-r)<=0}function Z5e(e,t){return JX(e,t+1)}function J5e(e,t,n,s,r){for(var i=(s||[]).slice(),{start:o,end:l}=t,c=0,u=1,d=o,h=function(){var b=s?.[c];if(b===void 0)return{v:JX(s,u)};var j=c,y,N=()=>(y===void 0&&(y=n(b,j)),y),w=b.coordinate,S=c===0||Kp(e,w,N,d,l);S||(c=0,d=o,u+=1),S&&(d=w+e*(N()/2+r),c+=u)},p;u<=i.length;)if(p=h(),p)return p.v;return[]}function eOe(e,t,n,s,r){var i=(s||[]).slice(),o=i.length;if(o===0)return[];for(var{start:l,end:c}=t,u=1;u<=o;u++){for(var d=(o-1)%u,h=l,p=!0,x=function(){var w=s[b],S=b,_,T=()=>(_===void 0&&(_=n(w,S)),_),k=w.coordinate,A=b===d||Kp(e,k,T,h,c);if(!A)return p=!1,1;A&&(h=k+e*(T()/2+r))},b=d;b<o&&!x();b+=u);if(p){for(var j=[],y=d;y<o;y+=u)j.push(s[y]);return j}}return[]}function y7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function Ms(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?y7(Object(n),!0).forEach(function(s){tOe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y7(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function tOe(e,t,n){return(t=aOe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function aOe(e){var t=nOe(e,"string");return typeof t=="symbol"?t:t+""}function nOe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sOe(e,t,n,s,r){for(var i=(s||[]).slice(),o=i.length,{start:l}=t,{end:c}=t,u=function(p){var x=i[p],b,j=()=>(b===void 0&&(b=n(x,p)),b);if(p===o-1){var y=e*(x.coordinate+e*j()/2-c);i[p]=x=Ms(Ms({},x),{},{tickCoord:y>0?x.coordinate-y*e:x.coordinate})}else i[p]=x=Ms(Ms({},x),{},{tickCoord:x.coordinate});if(x.tickCoord!=null){var N=Kp(e,x.tickCoord,j,l,c);N&&(c=x.tickCoord-e*(j()/2+r),i[p]=Ms(Ms({},x),{},{isShow:!0}))}},d=o-1;d>=0;d--)u(d);return i}function rOe(e,t,n,s,r,i){var o=(s||[]).slice(),l=o.length,{start:c,end:u}=t;if(i){var d=s[l-1],h=n(d,l-1),p=e*(d.coordinate+e*h/2-u);if(o[l-1]=d=Ms(Ms({},d),{},{tickCoord:p>0?d.coordinate-p*e:d.coordinate}),d.tickCoord!=null){var x=Kp(e,d.tickCoord,()=>h,c,u);x&&(u=d.tickCoord-e*(h/2+r),o[l-1]=Ms(Ms({},d),{},{isShow:!0}))}}for(var b=i?l-1:l,j=function(w){var S=o[w],_,T=()=>(_===void 0&&(_=n(S,w)),_);if(w===0){var k=e*(S.coordinate-e*T()/2-c);o[w]=S=Ms(Ms({},S),{},{tickCoord:k<0?S.coordinate-k*e:S.coordinate})}else o[w]=S=Ms(Ms({},S),{},{tickCoord:S.coordinate});if(S.tickCoord!=null){var A=Kp(e,S.tickCoord,T,c,u);A&&(c=S.tickCoord+e*(T()/2+r),o[w]=Ms(Ms({},S),{},{isShow:!0}))}},y=0;y<b;y++)j(y);return o}function QP(e,t,n){var{tick:s,ticks:r,viewBox:i,minTickGap:o,orientation:l,interval:c,tickFormatter:u,unit:d,angle:h}=e;if(!r||!r.length||!s)return[];if(Ut(c)||s1.isSsr){var p;return(p=Z5e(r,Ut(c)?c:0))!==null&&p!==void 0?p:[]}var x=[],b=l==="top"||l==="bottom"?"width":"height",j=d&&b==="width"?up(d,{fontSize:t,letterSpacing:n}):{width:0,height:0},y=(S,_)=>{var T=typeof u=="function"?u(S.value,_):S.value;return b==="width"?K5e(up(T,{fontSize:t,letterSpacing:n}),j,h):up(T,{fontSize:t,letterSpacing:n})[b]},N=r.length>=2?bs(r[1].coordinate-r[0].coordinate):1,w=X5e(i,N,b);return c==="equidistantPreserveStart"?J5e(N,w,y,r,o):c==="equidistantPreserveEnd"?eOe(N,w,y,r,o):(c==="preserveStart"||c==="preserveStartEnd"?x=rOe(N,w,y,r,o,c==="preserveStartEnd"):x=sOe(N,w,y,r,o),x.filter(S=>S.isShow))}var iOe=e=>{var{ticks:t,label:n,labelGapWithTick:s=5,tickSize:r=0,tickMargin:i=0}=e,o=0;if(t){Array.from(t).forEach(d=>{if(d){var h=d.getBoundingClientRect();h.width>o&&(o=h.width)}});var l=n?n.getBoundingClientRect().width:0,c=r+i,u=o+c+l+(n?s:0);return Math.round(u)}return 0},oOe=["axisLine","width","height","className","hide","ticks","axisType"];function lOe(e,t){if(e==null)return{};var n,s,r=cOe(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)n=i[s],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function cOe(e,t){if(e==null)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;n[s]=e[s]}return n}function Xu(){return Xu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Xu.apply(null,arguments)}function b7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function Bn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?b7(Object(n),!0).forEach(function(s){dOe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b7(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function dOe(e,t,n){return(t=uOe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function uOe(e){var t=mOe(e,"string");return typeof t=="symbol"?t:t+""}function mOe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Il={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd",zIndex:Gn.axis};function fOe(e){var{x:t,y:n,width:s,height:r,orientation:i,mirror:o,axisLine:l,otherSvgProps:c}=e;if(!l)return null;var u=Bn(Bn(Bn({},c),qr(l)),{},{fill:"none"});if(i==="top"||i==="bottom"){var d=+(i==="top"&&!o||i==="bottom"&&o);u=Bn(Bn({},u),{},{x1:t,y1:n+d*r,x2:t+s,y2:n+d*r})}else{var h=+(i==="left"&&!o||i==="right"&&o);u=Bn(Bn({},u),{},{x1:t+h*s,y1:n,x2:t+h*s,y2:n+r})}return f.createElement("line",Xu({},u,{className:Rt("recharts-cartesian-axis-line",Wu(l,"className"))}))}function hOe(e,t,n,s,r,i,o,l,c){var u,d,h,p,x,b,j=l?-1:1,y=e.tickSize||o,N=Ut(e.tickCoord)?e.tickCoord:e.coordinate;switch(i){case"top":u=d=e.coordinate,p=n+ +!l*r,h=p-j*y,b=h-j*c,x=N;break;case"left":h=p=e.coordinate,d=t+ +!l*s,u=d-j*y,x=u-j*c,b=N;break;case"right":h=p=e.coordinate,d=t+ +l*s,u=d+j*y,x=u+j*c,b=N;break;default:u=d=e.coordinate,p=n+ +l*r,h=p+j*y,b=h+j*c,x=N;break}return{line:{x1:u,y1:h,x2:d,y2:p},tick:{x,y:b}}}function gOe(e,t){switch(e){case"left":return t?"start":"end";case"right":return t?"end":"start";default:return"middle"}}function pOe(e,t){switch(e){case"left":case"right":return"middle";case"top":return t?"start":"end";default:return t?"end":"start"}}function xOe(e){var{option:t,tickProps:n,value:s}=e,r,i=Rt(n.className,"recharts-cartesian-axis-tick-value");if(f.isValidElement(t))r=f.cloneElement(t,Bn(Bn({},n),{},{className:i}));else if(typeof t=="function")r=t(Bn(Bn({},n),{},{className:i}));else{var o="recharts-cartesian-axis-tick-value";typeof t!="boolean"&&(o=Rt(o,t?.className)),r=f.createElement(y1,Xu({},n,{className:o}),s)}return r}var yOe=f.forwardRef((e,t)=>{var{ticks:n=[],tick:s,tickLine:r,stroke:i,tickFormatter:o,unit:l,padding:c,tickTextProps:u,orientation:d,mirror:h,x:p,y:x,width:b,height:j,tickSize:y,tickMargin:N,fontSize:w,letterSpacing:S,getTicksConfig:_,events:T,axisType:k}=e,A=QP(Bn(Bn({},_),{},{ticks:n}),w,S),E=gOe(d,h),M=pOe(d,h),F=qr(_),D=Gu(s),P={};typeof r=="object"&&(P=r);var B=Bn(Bn({},F),{},{fill:"none"},P),G=A.map(Z=>Bn({entry:Z},hOe(Z,p,x,b,j,d,y,h,N))),$=G.map(Z=>{var{entry:Q,line:le}=Z;return f.createElement(vs,{className:"recharts-cartesian-axis-tick",key:"tick-".concat(Q.value,"-").concat(Q.coordinate,"-").concat(Q.tickCoord)},r&&f.createElement("line",Xu({},B,le,{className:Rt("recharts-cartesian-axis-tick-line",Wu(r,"className"))})))}),W=G.map((Z,Q)=>{var{entry:le,tick:we}=Z,J=Bn(Bn(Bn(Bn({textAnchor:E,verticalAnchor:M},F),{},{stroke:"none",fill:i},D),we),{},{index:Q,payload:le,visibleTicksCount:A.length,tickFormatter:o,padding:c},u);return f.createElement(vs,Xu({className:"recharts-cartesian-axis-tick-label",key:"tick-label-".concat(le.value,"-").concat(le.coordinate,"-").concat(le.tickCoord)},a0(T,le,Q)),s&&f.createElement(xOe,{option:s,tickProps:J,value:"".concat(typeof o=="function"?o(le.value,Q):le.value).concat(l||"")}))});return f.createElement("g",{className:"recharts-cartesian-axis-ticks recharts-".concat(k,"-ticks")},W.length>0&&f.createElement(Sr,{zIndex:Gn.label},f.createElement("g",{className:"recharts-cartesian-axis-tick-labels recharts-".concat(k,"-tick-labels"),ref:t},W)),$.length>0&&f.createElement("g",{className:"recharts-cartesian-axis-tick-lines recharts-".concat(k,"-tick-lines")},$))}),bOe=f.forwardRef((e,t)=>{var{axisLine:n,width:s,height:r,className:i,hide:o,ticks:l,axisType:c}=e,u=lOe(e,oOe),[d,h]=f.useState(""),[p,x]=f.useState(""),b=f.useRef(null);f.useImperativeHandle(t,()=>({getCalculatedWidth:()=>{var y;return iOe({ticks:b.current,label:(y=e.labelRef)===null||y===void 0?void 0:y.current,labelGapWithTick:5,tickSize:e.tickSize,tickMargin:e.tickMargin})}}));var j=f.useCallback(y=>{if(y){var N=y.getElementsByClassName("recharts-cartesian-axis-tick-value");b.current=N;var w=N[0];if(w){var S=window.getComputedStyle(w),_=S.fontSize,T=S.letterSpacing;(_!==d||T!==p)&&(h(_),x(T))}}},[d,p]);return o||s!=null&&s<=0||r!=null&&r<=0?null:f.createElement(Sr,{zIndex:e.zIndex},f.createElement(vs,{className:Rt("recharts-cartesian-axis",i)},f.createElement(fOe,{x:e.x,y:e.y,width:s,height:r,orientation:e.orientation,mirror:e.mirror,axisLine:n,otherSvgProps:qr(e)}),f.createElement(yOe,{ref:j,axisType:c,events:u,fontSize:d,getTicksConfig:e,height:e.height,letterSpacing:p,mirror:e.mirror,orientation:e.orientation,padding:e.padding,stroke:e.stroke,tick:e.tick,tickFormatter:e.tickFormatter,tickLine:e.tickLine,tickMargin:e.tickMargin,tickSize:e.tickSize,tickTextProps:e.tickTextProps,ticks:l,unit:e.unit,width:e.width,x:e.x,y:e.y}),f.createElement(gPe,{x:e.x,y:e.y,width:e.width,height:e.height,lowerWidth:e.width,upperWidth:e.width},f.createElement(SPe,{label:e.label,labelRef:e.labelRef}),e.children)))}),KP=f.forwardRef((e,t)=>{var n=Xn(e,Il);return f.createElement(bOe,Xu({},n,{ref:t}))});KP.displayName="CartesianAxis";var vOe=["x1","y1","x2","y2","key"],wOe=["offset"],jOe=["xAxisId","yAxisId"],NOe=["xAxisId","yAxisId"];function v7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function Is(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?v7(Object(n),!0).forEach(function(s){COe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v7(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function COe(e,t,n){return(t=SOe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function SOe(e){var t=_Oe(e,"string");return typeof t=="symbol"?t:t+""}function _Oe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Nu(){return Nu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Nu.apply(null,arguments)}function Fw(e,t){if(e==null)return{};var n,s,r=AOe(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)n=i[s],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function AOe(e,t){if(e==null)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;n[s]=e[s]}return n}var TOe=e=>{var{fill:t}=e;if(!t||t==="none")return null;var{fillOpacity:n,x:s,y:r,width:i,height:o,ry:l}=e;return f.createElement("rect",{x:s,y:r,ry:l,width:i,height:o,stroke:"none",fill:t,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function eZ(e){var{option:t,lineItemProps:n}=e,s;if(f.isValidElement(t))s=f.cloneElement(t,n);else if(typeof t=="function")s=t(n);else{var r,{x1:i,y1:o,x2:l,y2:c,key:u}=n,d=Fw(n,vOe),h=(r=qr(d))!==null&&r!==void 0?r:{},{offset:p}=h,x=Fw(h,wOe);s=f.createElement("line",Nu({},x,{x1:i,y1:o,x2:l,y2:c,fill:"none",key:u}))}return s}function kOe(e){var{x:t,width:n,horizontal:s=!0,horizontalPoints:r}=e;if(!s||!r||!r.length)return null;var{xAxisId:i,yAxisId:o}=e,l=Fw(e,jOe),c=r.map((u,d)=>{var h=Is(Is({},l),{},{x1:t,y1:u,x2:t+n,y2:u,key:"line-".concat(d),index:d});return f.createElement(eZ,{key:"line-".concat(d),option:s,lineItemProps:h})});return f.createElement("g",{className:"recharts-cartesian-grid-horizontal"},c)}function EOe(e){var{y:t,height:n,vertical:s=!0,verticalPoints:r}=e;if(!s||!r||!r.length)return null;var{xAxisId:i,yAxisId:o}=e,l=Fw(e,NOe),c=r.map((u,d)=>{var h=Is(Is({},l),{},{x1:u,y1:t,x2:u,y2:t+n,key:"line-".concat(d),index:d});return f.createElement(eZ,{option:s,lineItemProps:h,key:"line-".concat(d)})});return f.createElement("g",{className:"recharts-cartesian-grid-vertical"},c)}function LOe(e){var{horizontalFill:t,fillOpacity:n,x:s,y:r,width:i,height:o,horizontalPoints:l,horizontal:c=!0}=e;if(!c||!t||!t.length||l==null)return null;var u=l.map(h=>Math.round(h+r-r)).sort((h,p)=>h-p);r!==u[0]&&u.unshift(0);var d=u.map((h,p)=>{var x=!u[p+1],b=x?r+o-h:u[p+1]-h;if(b<=0)return null;var j=p%t.length;return f.createElement("rect",{key:"react-".concat(p),y:h,x:s,height:b,width:i,stroke:"none",fill:t[j],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return f.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},d)}function DOe(e){var{vertical:t=!0,verticalFill:n,fillOpacity:s,x:r,y:i,width:o,height:l,verticalPoints:c}=e;if(!t||!n||!n.length)return null;var u=c.map(h=>Math.round(h+r-r)).sort((h,p)=>h-p);r!==u[0]&&u.unshift(0);var d=u.map((h,p)=>{var x=!u[p+1],b=x?r+o-h:u[p+1]-h;if(b<=0)return null;var j=p%n.length;return f.createElement("rect",{key:"react-".concat(p),x:h,y:i,width:b,height:l,stroke:"none",fill:n[j],fillOpacity:s,className:"recharts-cartesian-grid-bg"})});return f.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},d)}var POe=(e,t)=>{var{xAxis:n,width:s,height:r,offset:i}=e;return CQ(QP(Is(Is(Is({},Il),n),{},{ticks:SQ(n),viewBox:{x:0,y:0,width:s,height:r}})),i.left,i.left+i.width,t)},OOe=(e,t)=>{var{yAxis:n,width:s,height:r,offset:i}=e;return CQ(QP(Is(Is(Is({},Il),n),{},{ticks:SQ(n),viewBox:{x:0,y:0,width:s,height:r}})),i.top,i.top+i.height,t)},MOe={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0,syncWithTicks:!1,zIndex:Gn.grid};function UE(e){var t=HD(),n=qD(),s=PQ(),r=Is(Is({},Xn(e,MOe)),{},{x:Ut(e.x)?e.x:s.left,y:Ut(e.y)?e.y:s.top,width:Ut(e.width)?e.width:s.width,height:Ut(e.height)?e.height:s.height}),{xAxisId:i,yAxisId:o,x:l,y:c,width:u,height:d,syncWithTicks:h,horizontalValues:p,verticalValues:x}=r,b=Hs(),j=Bt(M=>fU(M,"xAxis",i,b)),y=Bt(M=>fU(M,"yAxis",o,b));if(!qo(u)||!qo(d)||!Ut(l)||!Ut(c))return null;var N=r.verticalCoordinatesGenerator||POe,w=r.horizontalCoordinatesGenerator||OOe,{horizontalPoints:S,verticalPoints:_}=r;if((!S||!S.length)&&typeof w=="function"){var T=p&&p.length,k=w({yAxis:y?Is(Is({},y),{},{ticks:T?p:y.ticks}):void 0,width:t??u,height:n??d,offset:s},T?!0:h);Nw(Array.isArray(k),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof k,"]")),Array.isArray(k)&&(S=k)}if((!_||!_.length)&&typeof N=="function"){var A=x&&x.length,E=N({xAxis:j?Is(Is({},j),{},{ticks:A?x:j.ticks}):void 0,width:t??u,height:n??d,offset:s},A?!0:h);Nw(Array.isArray(E),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof E,"]")),Array.isArray(E)&&(_=E)}return f.createElement(Sr,{zIndex:r.zIndex},f.createElement("g",{className:"recharts-cartesian-grid"},f.createElement(TOe,{fill:r.fill,fillOpacity:r.fillOpacity,x:r.x,y:r.y,width:r.width,height:r.height,ry:r.ry}),f.createElement(LOe,Nu({},r,{horizontalPoints:S})),f.createElement(DOe,Nu({},r,{verticalPoints:_})),f.createElement(kOe,Nu({},r,{offset:s,horizontalPoints:S,xAxis:j,yAxis:y})),f.createElement(EOe,Nu({},r,{offset:s,verticalPoints:_,xAxis:j,yAxis:y}))))}UE.displayName="CartesianGrid";var IOe={},tZ=Cr({name:"errorBars",initialState:IOe,reducers:{addErrorBar:(e,t)=>{var{itemId:n,errorBar:s}=t.payload;e[n]||(e[n]=[]),e[n].push(s)},replaceErrorBar:(e,t)=>{var{itemId:n,prev:s,next:r}=t.payload;e[n]&&(e[n]=e[n].map(i=>i.dataKey===s.dataKey&&i.direction===s.direction?r:i))},removeErrorBar:(e,t)=>{var{itemId:n,errorBar:s}=t.payload;e[n]&&(e[n]=e[n].filter(r=>r.dataKey!==s.dataKey||r.direction!==s.direction))}}}),{addErrorBar:kYe,replaceErrorBar:EYe,removeErrorBar:LYe}=tZ.actions,$Oe=tZ.reducer,ROe=["children"];function zOe(e,t){if(e==null)return{};var n,s,r=FOe(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)n=i[s],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function FOe(e,t){if(e==null)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;n[s]=e[s]}return n}var UOe={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},BOe=f.createContext(UOe);function aZ(e){var{children:t}=e,n=zOe(e,ROe);return f.createElement(BOe.Provider,{value:n},t)}function XP(e,t){var n,s,r=Bt(u=>dc(u,e)),i=Bt(u=>uc(u,t)),o=(n=r?.allowDataOverflow)!==null&&n!==void 0?n:hs.allowDataOverflow,l=(s=i?.allowDataOverflow)!==null&&s!==void 0?s:gs.allowDataOverflow,c=o||l;return{needClip:c,needClipX:o,needClipY:l}}function nZ(e){var{xAxisId:t,yAxisId:n,clipPathId:s}=e,r=VP(),{needClipX:i,needClipY:o,needClip:l}=XP(t,n);if(!l||!r)return null;var{x:c,y:u,width:d,height:h}=r;return f.createElement("clipPath",{id:"clipPath-".concat(s)},f.createElement("rect",{x:i?c:c-d/2,y:o?u:u-h/2,width:i?d:d*2,height:o?h:h*2}))}var sZ=(e,t,n,s)=>yd(e,"xAxis",t,s),rZ=(e,t,n,s)=>xd(e,"xAxis",t,s),iZ=(e,t,n,s)=>yd(e,"yAxis",n,s),oZ=(e,t,n,s)=>xd(e,"yAxis",n,s),HOe=dt([wa,sZ,iZ,rZ,oZ],(e,t,n,s,r)=>Ld(e,"xAxis")?Wf(t,s,!1):Wf(n,r,!1)),qOe=(e,t,n,s,r)=>r;function GOe(e){return e.type==="line"}var WOe=dt([u1,qOe],(e,t)=>e.filter(GOe).find(n=>n.id===t)),VOe=dt([wa,sZ,iZ,rZ,oZ,WOe,HOe,YD],(e,t,n,s,r,i,o,l)=>{var{chartData:c,dataStartIndex:u,dataEndIndex:d}=l;if(!(i==null||t==null||n==null||s==null||r==null||s.length===0||r.length===0||o==null||e!=="horizontal"&&e!=="vertical")){var{dataKey:h,data:p}=i,x;if(p!=null&&p.length>0?x=p:x=c?.slice(u,d+1),x!=null)return MMe({layout:e,xAxis:t,yAxis:n,xAxisTicks:s,yAxisTicks:r,dataKey:h,bandSize:o,displayedData:x})}});function YOe(e){var t=Gu(e),n=3,s=2;if(t!=null){var{r,strokeWidth:i}=t,o=Number(r),l=Number(i);return(Number.isNaN(o)||o<0)&&(o=n),(Number.isNaN(l)||l<0)&&(l=s),{r:o,strokeWidth:l}}return{r:n,strokeWidth:s}}var hA={exports:{}},gA={};var w7;function QOe(){if(w7)return gA;w7=1;var e=Xf();function t(c,u){return c===u&&(c!==0||1/c===1/u)||c!==c&&u!==u}var n=typeof Object.is=="function"?Object.is:t,s=e.useSyncExternalStore,r=e.useRef,i=e.useEffect,o=e.useMemo,l=e.useDebugValue;return gA.useSyncExternalStoreWithSelector=function(c,u,d,h,p){var x=r(null);if(x.current===null){var b={hasValue:!1,value:null};x.current=b}else b=x.current;x=o(function(){function y(T){if(!N){if(N=!0,w=T,T=h(T),p!==void 0&&b.hasValue){var k=b.value;if(p(k,T))return S=k}return S=T}if(k=S,n(w,T))return k;var A=h(T);return p!==void 0&&p(k,A)?(w=T,k):(w=T,S=A)}var N=!1,w,S,_=d===void 0?null:d;return[function(){return y(u())},_===null?void 0:function(){return y(_())}]},[u,d,h,p]);var j=s(c,x[0],x[1]);return i(function(){b.hasValue=!0,b.value=j},[j]),l(j),j},gA}var j7;function KOe(){return j7||(j7=1,hA.exports=QOe()),hA.exports}var XOe=KOe();function ZOe(e){e()}function JOe(){let e=null,t=null;return{clear(){e=null,t=null},notify(){ZOe(()=>{let n=e;for(;n;)n.callback(),n=n.next})},get(){const n=[];let s=e;for(;s;)n.push(s),s=s.next;return n},subscribe(n){let s=!0;const r=t={callback:n,next:null,prev:t};return r.prev?r.prev.next=r:e=r,function(){!s||e===null||(s=!1,r.next?r.next.prev=r.prev:t=r.prev,r.prev?r.prev.next=r.next:e=r.next)}}}}var N7={notify(){},get:()=>[]};function eMe(e,t){let n,s=N7,r=0,i=!1;function o(j){d();const y=s.subscribe(j);let N=!1;return()=>{N||(N=!0,y(),h())}}function l(){s.notify()}function c(){b.onStateChange&&b.onStateChange()}function u(){return i}function d(){r++,n||(n=e.subscribe(c),s=JOe())}function h(){r--,n&&r===0&&(n(),n=void 0,s.clear(),s=N7)}function p(){i||(i=!0,d())}function x(){i&&(i=!1,h())}const b={addNestedSub:o,notifyNestedSubs:l,handleChangeWrapper:c,isSubscribed:u,trySubscribe:p,tryUnsubscribe:x,getListeners:()=>s};return b}var tMe=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",aMe=tMe(),nMe=()=>typeof navigator<"u"&&navigator.product==="ReactNative",sMe=nMe(),rMe=()=>aMe||sMe?f.useLayoutEffect:f.useEffect,iMe=rMe();function C7(e,t){return e===t?e!==0||t!==0||1/e===1/t:e!==e&&t!==t}function oMe(e,t){if(C7(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;const n=Object.keys(e),s=Object.keys(t);if(n.length!==s.length)return!1;for(let r=0;r<n.length;r++)if(!Object.prototype.hasOwnProperty.call(t,n[r])||!C7(e[n[r]],t[n[r]]))return!1;return!0}var lMe=Symbol.for("react-redux-context"),cMe=typeof globalThis<"u"?globalThis:{};function dMe(){if(!f.createContext)return{};const e=cMe[lMe]??=new Map;let t=e.get(f.createContext);return t||(t=f.createContext(null),e.set(f.createContext,t)),t}var uMe=dMe();function mMe(e){const{children:t,context:n,serverState:s,store:r}=e,i=f.useMemo(()=>{const c=eMe(r);return{store:r,subscription:c,getServerState:s?()=>s:void 0}},[r,s]),o=f.useMemo(()=>r.getState(),[r]);iMe(()=>{const{subscription:c}=i;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),o!==r.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[i,o]);const l=n||uMe;return f.createElement(l.Provider,{value:i},t)}var fMe=mMe,hMe=new Set(["axisLine","tickLine","activeBar","activeDot","activeLabel","activeShape","allowEscapeViewBox","background","cursor","dot","label","line","margin","padding","position","shape","style","tick","wrapperStyle","radius"]);function gMe(e,t){return e==null&&t==null?!0:typeof e=="number"&&typeof t=="number"?e===t||e!==e&&t!==t:e===t}function j1(e,t){var n=new Set([...Object.keys(e),...Object.keys(t)]);for(var s of n)if(hMe.has(s)){if(e[s]==null&&t[s]==null)continue;if(!oMe(e[s],t[s]))return!1}else if(!gMe(e[s],t[s]))return!1;return!0}var pMe=["id"],xMe=["type","layout","connectNulls","needClip","shape"],yMe=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId","id"];function Xp(){return Xp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Xp.apply(null,arguments)}function S7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function Ao(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?S7(Object(n),!0).forEach(function(s){bMe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S7(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function bMe(e,t,n){return(t=vMe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function vMe(e){var t=wMe(e,"string");return typeof t=="symbol"?t:t+""}function wMe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ZP(e,t){if(e==null)return{};var n,s,r=jMe(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)n=i[s],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function jMe(e,t){if(e==null)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;n[s]=e[s]}return n}var NMe=e=>{var{dataKey:t,name:n,stroke:s,legendType:r,hide:i}=e;return[{inactive:i,dataKey:t,type:r,color:s,value:xh(n,t),payload:e}]},CMe=f.memo(e=>{var{dataKey:t,data:n,stroke:s,strokeWidth:r,fill:i,name:o,hide:l,unit:c,tooltipType:u,id:d}=e,h={dataDefinedOnItem:n,positions:void 0,settings:{stroke:s,strokeWidth:r,fill:i,dataKey:t,nameKey:void 0,name:xh(o,t),hide:l,type:u,color:s,unit:c,graphicalItemId:d}};return f.createElement(GP,{tooltipEntrySettings:h})}),lZ=(e,t)=>"".concat(t,"px ").concat(e-t,"px");function SMe(e,t){for(var n=e.length%2!==0?[...e,0]:e,s=[],r=0;r<t;++r)s=[...s,...n];return s}var _Me=(e,t,n)=>{var s=n.reduce((h,p)=>h+p);if(!s)return lZ(t,e);for(var r=Math.floor(e/s),i=e%s,o=t-e,l=[],c=0,u=0;c<n.length;u+=n[c],++c)if(u+n[c]>i){l=[...n.slice(0,c),i-u];break}var d=l.length%2===0?[0,o]:[o];return[...SMe(n,r),...l,...d].map(h=>"".concat(h,"px")).join(", ")};function AMe(e){var{clipPathId:t,points:n,props:s}=e,{dot:r,dataKey:i,needClip:o}=s,{id:l}=s,c=ZP(s,pMe),u=qr(c);return f.createElement(u5e,{points:n,dot:r,className:"recharts-line-dots",dotClassName:"recharts-line-dot",dataKey:i,baseProps:u,needClip:o,clipPathId:t})}function TMe(e){var{showLabels:t,children:n,points:s}=e,r=f.useMemo(()=>s?.map(i=>{var o,l,c={x:(o=i.x)!==null&&o!==void 0?o:0,y:(l=i.y)!==null&&l!==void 0?l:0,width:0,lowerWidth:0,upperWidth:0,height:0};return Ao(Ao({},c),{},{value:i.value,payload:i.payload,viewBox:c,parentViewBox:void 0,fill:void 0})}),[s]);return f.createElement(MX,{value:t?r:void 0},n)}function _7(e){var{clipPathId:t,pathRef:n,points:s,strokeDasharray:r,props:i}=e,{type:o,layout:l,connectNulls:c,needClip:u,shape:d}=i,h=ZP(i,xMe),p=Ao(Ao({},Ys(h)),{},{fill:"none",className:"recharts-line-curve",clipPath:u?"url(#clipPath-".concat(t,")"):void 0,points:s,type:o,layout:l,connectNulls:c,strokeDasharray:r??i.strokeDasharray});return f.createElement(f.Fragment,null,s?.length>1&&f.createElement(UP,Xp({shapeType:"curve",option:d},p,{pathRef:n})),f.createElement(AMe,{points:s,clipPathId:t,props:i}))}function kMe(e){try{return e&&e.getTotalLength&&e.getTotalLength()||0}catch{return 0}}function EMe(e){var{clipPathId:t,props:n,pathRef:s,previousPointsRef:r,longestAnimatedLengthRef:i}=e,{points:o,strokeDasharray:l,isAnimationActive:c,animationBegin:u,animationDuration:d,animationEasing:h,animateNewValues:p,width:x,height:b,onAnimationEnd:j,onAnimationStart:y}=n,N=r.current,w=c0(o,"recharts-line-"),S=f.useRef(w),[_,T]=f.useState(!1),k=!_,A=f.useCallback(()=>{typeof j=="function"&&j(),T(!1)},[j]),E=f.useCallback(()=>{typeof y=="function"&&y(),T(!0)},[y]),M=kMe(s.current),F=f.useRef(0);S.current!==w&&(F.current=i.current,S.current=w);var D=F.current;return f.createElement(TMe,{points:o,showLabels:k},n.children,f.createElement(l0,{animationId:w,begin:u,duration:d,isActive:c,easing:h,onAnimationEnd:A,onAnimationStart:E,key:w},P=>{var B=dn(D,M+D,P),G=Math.min(B,M),$;if(c)if(l){var W="".concat(l).split(/[,\s]+/gim).map(le=>parseFloat(le));$=_Me(G,M,W)}else $=lZ(M,G);else $=l==null?void 0:String(l);if(P>0&&M>0&&(r.current=o,i.current=Math.max(i.current,G)),N){var Z=N.length/o.length,Q=P===1?o:o.map((le,we)=>{var J=Math.floor(we*Z);if(N[J]){var se=N[J];return Ao(Ao({},le),{},{x:dn(se.x,le.x,P),y:dn(se.y,le.y,P)})}return p?Ao(Ao({},le),{},{x:dn(x*2,le.x,P),y:dn(b/2,le.y,P)}):Ao(Ao({},le),{},{x:le.x,y:le.y})});return r.current=Q,f.createElement(_7,{props:n,points:Q,clipPathId:t,pathRef:s,strokeDasharray:$})}return f.createElement(_7,{props:n,points:o,clipPathId:t,pathRef:s,strokeDasharray:$})}),f.createElement($P,{label:n.label}))}function LMe(e){var{clipPathId:t,props:n}=e,s=f.useRef(null),r=f.useRef(0),i=f.useRef(null);return f.createElement(EMe,{props:n,clipPathId:t,previousPointsRef:s,longestAnimatedLengthRef:r,pathRef:i})}var DMe=(e,t)=>{var n,s;return{x:(n=e.x)!==null&&n!==void 0?n:void 0,y:(s=e.y)!==null&&s!==void 0?s:void 0,value:e.value,errorVal:Ga(e.payload,t)}};class PMe extends f.Component{render(){var{hide:t,dot:n,points:s,className:r,xAxisId:i,yAxisId:o,top:l,left:c,width:u,height:d,id:h,needClip:p,zIndex:x}=this.props;if(t)return null;var b=Rt("recharts-line",r),j=h,{r:y,strokeWidth:N}=YOe(n),w=HX(n),S=y*2+N,_=p?"url(#clipPath-".concat(w?"":"dots-").concat(j,")"):void 0;return f.createElement(Sr,{zIndex:x},f.createElement(vs,{className:b},p&&f.createElement("defs",null,f.createElement(nZ,{clipPathId:j,xAxisId:i,yAxisId:o}),!w&&f.createElement("clipPath",{id:"clipPath-dots-".concat(j)},f.createElement("rect",{x:c-S/2,y:l-S/2,width:u+S,height:d+S}))),f.createElement(aZ,{xAxisId:i,yAxisId:o,data:s,dataPointFormatter:DMe,errorBarOffset:0},f.createElement(LMe,{props:this.props,clipPathId:j}))),f.createElement(L5e,{activeDot:this.props.activeDot,points:s,mainColor:this.props.stroke,itemDataKey:this.props.dataKey,clipPath:_}))}}var cZ={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:"auto",label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0,zIndex:Gn.line,type:"linear"};function OMe(e){var t=Xn(e,cZ),{activeDot:n,animateNewValues:s,animationBegin:r,animationDuration:i,animationEasing:o,connectNulls:l,dot:c,hide:u,isAnimationActive:d,label:h,legendType:p,xAxisId:x,yAxisId:b,id:j}=t,y=ZP(t,yMe),{needClip:N}=XP(x,b),w=VP(),S=yh(),_=Hs(),T=Bt(F=>VOe(F,x,b,_,j));if(S!=="horizontal"&&S!=="vertical"||T==null||w==null)return null;var{height:k,width:A,x:E,y:M}=w;return f.createElement(PMe,Xp({},y,{id:j,connectNulls:l,dot:c,activeDot:n,animateNewValues:s,animationBegin:r,animationDuration:i,animationEasing:o,isAnimationActive:d,hide:u,label:h,legendType:p,xAxisId:x,yAxisId:b,points:T,layout:S,height:k,width:A,left:E,top:M,needClip:N}))}function MMe(e){var{layout:t,xAxis:n,yAxis:s,xAxisTicks:r,yAxisTicks:i,dataKey:o,bandSize:l,displayedData:c}=e;return c.map((u,d)=>{var h=Ga(u,o);if(t==="horizontal"){var p=Zz({axis:n,ticks:r,bandSize:l,entry:u,index:d}),x=fn(h)?null:s.scale(h);return{x:p,y:x,value:h,payload:u}}var b=fn(h)?null:n.scale(h),j=Zz({axis:s,ticks:i,bandSize:l,entry:u,index:d});return b==null||j==null?null:{x:b,y:j,value:h,payload:u}}).filter(Boolean)}function IMe(e){var t=Xn(e,cZ),n=Hs();return f.createElement(WP,{id:t.id,type:"line"},s=>f.createElement(f.Fragment,null,f.createElement(qX,{legendPayload:NMe(t)}),f.createElement(CMe,{dataKey:t.dataKey,data:t.data,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill,name:t.name,hide:t.hide,unit:t.unit,tooltipType:t.tooltipType,id:s}),f.createElement(WX,{type:"line",id:s,data:t.data,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,hide:t.hide,isPanorama:n}),f.createElement(OMe,Xp({},t,{id:s}))))}var BE=f.memo(IMe,j1);BE.displayName="Line";function um(e,t){var n,s;return(n=(s=e.graphicalItems.cartesianItems.find(r=>r.id===t))===null||s===void 0?void 0:s.xAxisId)!==null&&n!==void 0?n:YX}function mm(e,t){var n,s;return(n=(s=e.graphicalItems.cartesianItems.find(r=>r.id===t))===null||s===void 0?void 0:s.yAxisId)!==null&&n!==void 0?n:YX}var $Me="Invariant failed";function RMe(e,t){throw new Error($Me)}function HE(){return HE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},HE.apply(null,arguments)}function Uw(e){return f.createElement(UP,HE({shapeType:"rectangle",activeClassName:"recharts-active-bar"},e))}var zMe=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(s,r)=>{if(Ut(t))return t;var i=Ut(s)||fn(s);return i?t(s,r):(i||RMe(),n)}},FMe=(e,t,n)=>n,UMe=(e,t)=>t,b0=dt([u1,UMe],(e,t)=>e.filter(n=>n.type==="bar").find(n=>n.id===t)),BMe=dt([b0],e=>e?.maxBarSize),HMe=(e,t,n,s)=>s,qMe=dt([wa,u1,um,mm,FMe],(e,t,n,s,r)=>t.filter(i=>e==="horizontal"?i.xAxisId===n:i.yAxisId===s).filter(i=>i.isPanorama===r).filter(i=>i.hide===!1).filter(i=>i.type==="bar")),GMe=(e,t,n)=>{var s=wa(e),r=um(e,t),i=mm(e,t);if(!(r==null||i==null))return s==="horizontal"?PE(e,"yAxis",i,n):PE(e,"xAxis",r,n)},WMe=(e,t)=>{var n=wa(e),s=um(e,t),r=mm(e,t);if(!(s==null||r==null))return n==="horizontal"?mU(e,"xAxis",s):mU(e,"yAxis",r)},VMe=dt([qMe,pEe,WMe],D5e),YMe=(e,t,n)=>{var s,r,i=b0(e,t);if(i!=null){var o=um(e,t),l=mm(e,t);if(!(o==null||l==null)){var c=wa(e),u=pK(e),{maxBarSize:d}=i,h=fn(d)?u:d,p,x;return c==="horizontal"?(p=yd(e,"xAxis",o,n),x=xd(e,"xAxis",o,n)):(p=yd(e,"yAxis",l,n),x=xd(e,"yAxis",l,n)),(s=(r=Wf(p,x,!0))!==null&&r!==void 0?r:h)!==null&&s!==void 0?s:0}}},dZ=(e,t,n)=>{var s=wa(e),r=um(e,t),i=mm(e,t);if(!(r==null||i==null)){var o,l;return s==="horizontal"?(o=yd(e,"xAxis",r,n),l=xd(e,"xAxis",r,n)):(o=yd(e,"yAxis",i,n),l=xd(e,"yAxis",i,n)),Wf(o,l)}},QMe=dt([VMe,pK,gEe,xK,YMe,dZ,BMe],$5e),KMe=(e,t,n)=>{var s=um(e,t);if(s!=null)return yd(e,"xAxis",s,n)},XMe=(e,t,n)=>{var s=mm(e,t);if(s!=null)return yd(e,"yAxis",s,n)},ZMe=(e,t,n)=>{var s=um(e,t);if(s!=null)return xd(e,"xAxis",s,n)},JMe=(e,t,n)=>{var s=mm(e,t);if(s!=null)return xd(e,"yAxis",s,n)},eIe=dt([QMe,b0],(e,t)=>{if(!(e==null||t==null)){var n=e.find(s=>s.stackId===t.stackId&&t.dataKey!=null&&s.dataKeys.includes(t.dataKey));if(n!=null)return n.position}}),tIe=dt([GMe,b0],R5e),aIe=dt([ds,UD,KMe,XMe,ZMe,JMe,eIe,wa,nEe,dZ,tIe,b0,HMe],(e,t,n,s,r,i,o,l,c,u,d,h,p)=>{var{chartData:x,dataStartIndex:b,dataEndIndex:j}=c;if(!(h==null||o==null||t==null||l!=="horizontal"&&l!=="vertical"||n==null||s==null||r==null||i==null||u==null)){var{data:y}=h,N;if(y!=null&&y.length>0?N=y:N=x?.slice(b,j+1),N!=null)return LIe({layout:l,barSettings:h,pos:o,parentViewBox:t,bandSize:u,xAxis:n,yAxis:s,xAxisTicks:r,yAxisTicks:i,stackedData:d,displayedData:N,offset:e,cells:p,dataStartIndex:b})}}),nIe=["index"];function qE(){return qE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},qE.apply(null,arguments)}function sIe(e,t){if(e==null)return{};var n,s,r=rIe(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)n=i[s],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function rIe(e,t){if(e==null)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;n[s]=e[s]}return n}var uZ=f.createContext(void 0),iIe=e=>{var t=f.useContext(uZ);if(t!=null)return t.stackId;if(e!=null)return SAe(e)},oIe=(e,t)=>"recharts-bar-stack-clip-path-".concat(e,"-").concat(t),lIe=e=>{var t=f.useContext(uZ);if(t!=null){var{stackId:n}=t;return"url(#".concat(oIe(n,e),")")}},cIe=e=>{var{index:t}=e,n=sIe(e,nIe),s=lIe(t);return f.createElement(vs,qE({className:"recharts-bar-stack-layer",clipPath:s},n))},dIe=["onMouseEnter","onMouseLeave","onClick"],uIe=["value","background","tooltipPosition"],mIe=["id"],fIe=["onMouseEnter","onClick","onMouseLeave"];function Zl(){return Zl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Zl.apply(null,arguments)}function A7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function Gs(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?A7(Object(n),!0).forEach(function(s){hIe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A7(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function hIe(e,t,n){return(t=gIe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function gIe(e){var t=pIe(e,"string");return typeof t=="symbol"?t:t+""}function pIe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Bw(e,t){if(e==null)return{};var n,s,r=xIe(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)n=i[s],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function xIe(e,t){if(e==null)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;n[s]=e[s]}return n}var yIe=e=>{var{dataKey:t,name:n,fill:s,legendType:r,hide:i}=e;return[{inactive:i,dataKey:t,type:r,color:s,value:xh(n,t),payload:e}]},bIe=f.memo(e=>{var{dataKey:t,stroke:n,strokeWidth:s,fill:r,name:i,hide:o,unit:l,tooltipType:c,id:u}=e,d={dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:n,strokeWidth:s,fill:r,dataKey:t,nameKey:void 0,name:xh(i,t),hide:o,type:c,color:r,unit:l,graphicalItemId:u}};return f.createElement(GP,{tooltipEntrySettings:d})});function vIe(e){var t=Bt(bd),{data:n,dataKey:s,background:r,allOtherBarProps:i}=e,{onMouseEnter:o,onMouseLeave:l,onClick:c}=i,u=Bw(i,dIe),d=BP(o,s,i.id),h=HP(l),p=qP(c,s,i.id);if(!r||n==null)return null;var x=Gu(r);return f.createElement(Sr,{zIndex:z5e(r,Gn.barBackground)},n.map((b,j)=>{var{value:y,background:N,tooltipPosition:w}=b,S=Bw(b,uIe);if(!N)return null;var _=d(b,j),T=h(b,j),k=p(b,j),A=Gs(Gs(Gs(Gs(Gs({option:r,isActive:String(j)===t},S),{},{fill:"#eee"},N),x),a0(u,b,j)),{},{onMouseEnter:_,onMouseLeave:T,onClick:k,dataKey:s,index:j,className:"recharts-bar-background-rectangle"});return f.createElement(Uw,Zl({key:"background-bar-".concat(j)},A))}))}function wIe(e){var{showLabels:t,children:n,rects:s}=e,r=s?.map(i=>{var o={x:i.x,y:i.y,width:i.width,lowerWidth:i.width,upperWidth:i.width,height:i.height};return Gs(Gs({},o),{},{value:i.value,payload:i.payload,parentViewBox:i.parentViewBox,viewBox:o,fill:i.fill})});return f.createElement(MX,{value:t?r:void 0},n)}function jIe(e){var{shape:t,activeBar:n,baseProps:s,entry:r,index:i,dataKey:o}=e,l=Bt(bd),c=Bt(EP),u=n&&String(i)===l&&(c==null||o===c),d=u?n:t;return u?f.createElement(Sr,{zIndex:Gn.activeBar},f.createElement(Uw,Zl({},s,{name:String(s.name)},r,{isActive:u,option:d,index:i,dataKey:o}))):f.createElement(Uw,Zl({},s,{name:String(s.name)},r,{isActive:u,option:d,index:i,dataKey:o}))}function NIe(e){var{shape:t,baseProps:n,entry:s,index:r,dataKey:i}=e;return f.createElement(Uw,Zl({},n,{name:String(n.name)},s,{isActive:!1,option:t,index:r,dataKey:i}))}function CIe(e){var t,{data:n,props:s}=e,r=(t=qr(s))!==null&&t!==void 0?t:{},{id:i}=r,o=Bw(r,mIe),{shape:l,dataKey:c,activeBar:u}=s,{onMouseEnter:d,onClick:h,onMouseLeave:p}=s,x=Bw(s,fIe),b=BP(d,c,i),j=HP(p),y=qP(h,c,i);return n?f.createElement(f.Fragment,null,n.map((N,w)=>f.createElement(cIe,Zl({index:w,key:"rectangle-".concat(N?.x,"-").concat(N?.y,"-").concat(N?.value,"-").concat(w),className:"recharts-bar-rectangle"},a0(x,N,w),{onMouseEnter:b(N,w),onMouseLeave:j(N,w),onClick:y(N,w)}),u?f.createElement(jIe,{shape:l,activeBar:u,baseProps:o,entry:N,index:w,dataKey:c}):f.createElement(NIe,{shape:l,baseProps:o,entry:N,index:w,dataKey:c})))):null}function SIe(e){var{props:t,previousRectanglesRef:n}=e,{data:s,layout:r,isAnimationActive:i,animationBegin:o,animationDuration:l,animationEasing:c,onAnimationEnd:u,onAnimationStart:d}=t,h=n.current,p=c0(t,"recharts-bar-"),[x,b]=f.useState(!1),j=!x,y=f.useCallback(()=>{typeof u=="function"&&u(),b(!1)},[u]),N=f.useCallback(()=>{typeof d=="function"&&d(),b(!0)},[d]);return f.createElement(wIe,{showLabels:j,rects:s},f.createElement(l0,{animationId:p,begin:o,duration:l,isActive:i,easing:c,onAnimationEnd:y,onAnimationStart:N,key:p},w=>{var S=w===1?s:s?.map((_,T)=>{var k=h&&h[T];if(k)return Gs(Gs({},_),{},{x:dn(k.x,_.x,w),y:dn(k.y,_.y,w),width:dn(k.width,_.width,w),height:dn(k.height,_.height,w)});if(r==="horizontal"){var A=dn(0,_.height,w),E=dn(_.stackedBarStart,_.y,w);return Gs(Gs({},_),{},{y:E,height:A})}var M=dn(0,_.width,w),F=dn(_.stackedBarStart,_.x,w);return Gs(Gs({},_),{},{width:M,x:F})});return w>0&&(n.current=S??null),S==null?null:f.createElement(vs,null,f.createElement(CIe,{props:t,data:S}))}),f.createElement($P,{label:t.label}),t.children)}function _Ie(e){var t=f.useRef(null);return f.createElement(SIe,{previousRectanglesRef:t,props:e})}var mZ=0,AIe=(e,t)=>{var n=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:n,errorVal:Ga(e,t)}};class TIe extends f.PureComponent{render(){var{hide:t,data:n,dataKey:s,className:r,xAxisId:i,yAxisId:o,needClip:l,background:c,id:u}=this.props;if(t||n==null)return null;var d=Rt("recharts-bar",r),h=u;return f.createElement(vs,{className:d,id:u},l&&f.createElement("defs",null,f.createElement(nZ,{clipPathId:h,xAxisId:i,yAxisId:o})),f.createElement(vs,{className:"recharts-bar-rectangles",clipPath:l?"url(#clipPath-".concat(h,")"):void 0},f.createElement(vIe,{data:n,dataKey:s,background:c,allOtherBarProps:this.props}),f.createElement(_Ie,this.props)))}}var kIe={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",background:!1,hide:!1,isAnimationActive:"auto",label:!1,legendType:"rect",minPointSize:mZ,xAxisId:0,yAxisId:0,zIndex:Gn.bar};function EIe(e){var{xAxisId:t,yAxisId:n,hide:s,legendType:r,minPointSize:i,activeBar:o,animationBegin:l,animationDuration:c,animationEasing:u,isAnimationActive:d}=e,{needClip:h}=XP(t,n),p=yh(),x=Hs(),b=FP(e.children,x1),j=Bt(w=>aIe(w,e.id,x,b));if(p!=="vertical"&&p!=="horizontal")return null;var y,N=j?.[0];return N==null||N.height==null||N.width==null?y=0:y=p==="vertical"?N.height/2:N.width/2,f.createElement(aZ,{xAxisId:t,yAxisId:n,data:j,dataPointFormatter:AIe,errorBarOffset:y},f.createElement(TIe,Zl({},e,{layout:p,needClip:h,data:j,xAxisId:t,yAxisId:n,hide:s,legendType:r,minPointSize:i,activeBar:o,animationBegin:l,animationDuration:c,animationEasing:u,isAnimationActive:d})))}function LIe(e){var{layout:t,barSettings:{dataKey:n,minPointSize:s},pos:r,bandSize:i,xAxis:o,yAxis:l,xAxisTicks:c,yAxisTicks:u,stackedData:d,displayedData:h,offset:p,cells:x,parentViewBox:b,dataStartIndex:j}=e,y=t==="horizontal"?l:o,N=d?y.scale.domain():null,w=_Ae({numericAxis:y}),S=y.scale(w);return h.map((_,T)=>{var k,A,E,M,F,D;if(d){var P=d[T+j];if(P==null)return null;k=vAe(P,N)}else k=Ga(_,n),Array.isArray(k)||(k=[w,k]);var B=zMe(s,mZ)(k[1],T);if(t==="horizontal"){var G,[$,W]=[l.scale(k[0]),l.scale(k[1])];A=Jz({axis:o,ticks:c,bandSize:i,offset:r.offset,entry:_,index:T}),E=(G=W??$)!==null&&G!==void 0?G:void 0,M=r.size;var Z=$-W;if(F=eo(Z)?0:Z,D={x:A,y:p.top,width:M,height:p.height},Math.abs(B)>0&&Math.abs(F)<Math.abs(B)){var Q=bs(F||B)*(Math.abs(B)-Math.abs(F));E-=Q,F+=Q}}else{var[le,we]=[o.scale(k[0]),o.scale(k[1])];if(A=le,E=Jz({axis:l,ticks:u,bandSize:i,offset:r.offset,entry:_,index:T}),M=we-le,F=r.size,D={x:p.left,y:E,width:p.width,height:F},Math.abs(B)>0&&Math.abs(M)<Math.abs(B)){var J=bs(M||B)*(Math.abs(B)-Math.abs(M));M+=J}}if(A==null||E==null||M==null||F==null)return null;var se=Gs(Gs({},_),{},{stackedBarStart:S,x:A,y:E,width:M,height:F,value:d?k:k[1],payload:_,background:D,tooltipPosition:{x:A+M/2,y:E+F/2},parentViewBox:b},x&&x[T]&&x[T].props);return se}).filter(Boolean)}function DIe(e){var t=Xn(e,kIe),n=iIe(t.stackId),s=Hs();return f.createElement(WP,{id:t.id,type:"bar"},r=>f.createElement(f.Fragment,null,f.createElement(qX,{legendPayload:yIe(t)}),f.createElement(bIe,{dataKey:t.dataKey,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill,name:t.name,hide:t.hide,unit:t.unit,tooltipType:t.tooltipType,id:r}),f.createElement(WX,{type:"bar",id:r,data:void 0,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,stackId:n,hide:t.hide,barSize:t.barSize,minPointSize:t.minPointSize,maxBarSize:t.maxBarSize,isPanorama:s}),f.createElement(Sr,{zIndex:t.zIndex},f.createElement(EIe,Zl({},t,{id:r})))))}var GE=f.memo(DIe,j1);GE.displayName="Bar";var PIe=["domain","range"],OIe=["domain","range"];function T7(e,t){if(e==null)return{};var n,s,r=MIe(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)n=i[s],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function MIe(e,t){if(e==null)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;n[s]=e[s]}return n}function k7(e,t){return e===t?!0:Array.isArray(e)&&e.length===2&&Array.isArray(t)&&t.length===2?e[0]===t[0]&&e[1]===t[1]:!1}function fZ(e,t){if(e===t)return!0;var{domain:n,range:s}=e,r=T7(e,PIe),{domain:i,range:o}=t,l=T7(t,OIe);return!k7(n,i)||!k7(s,o)?!1:j1(r,l)}var IIe=["dangerouslySetInnerHTML","ticks","scale"],$Ie=["id","scale"];function WE(){return WE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},WE.apply(null,arguments)}function E7(e,t){if(e==null)return{};var n,s,r=RIe(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)n=i[s],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function RIe(e,t){if(e==null)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;n[s]=e[s]}return n}function zIe(e){var t=Ja(),n=f.useRef(null);return f.useLayoutEffect(()=>{n.current===null?t(p5e(e)):n.current!==e&&t(x5e({prev:n.current,next:e})),n.current=e},[e,t]),f.useLayoutEffect(()=>()=>{n.current&&(t(y5e(n.current)),n.current=null)},[t]),null}var FIe=e=>{var{xAxisId:t,className:n}=e,s=Bt(UD),r=Hs(),i="xAxis",o=Bt(N=>QK(N,i,t,r)),l=Bt(N=>GK(N,t)),c=Bt(N=>fLe(N,t)),u=Bt(N=>_K(N,t));if(l==null||c==null||u==null)return null;var{dangerouslySetInnerHTML:d,ticks:h,scale:p}=e,x=E7(e,IIe),{id:b,scale:j}=u,y=E7(u,$Ie);return f.createElement(KP,WE({},x,y,{x:c.x,y:c.y,width:l.width,height:l.height,className:Rt("recharts-".concat(i," ").concat(i),n),viewBox:s,ticks:o,axisType:i}))},UIe={allowDataOverflow:hs.allowDataOverflow,allowDecimals:hs.allowDecimals,allowDuplicatedCategory:hs.allowDuplicatedCategory,angle:hs.angle,axisLine:Il.axisLine,height:hs.height,hide:!1,includeHidden:hs.includeHidden,interval:hs.interval,minTickGap:hs.minTickGap,mirror:hs.mirror,orientation:hs.orientation,padding:hs.padding,reversed:hs.reversed,scale:hs.scale,tick:hs.tick,tickCount:hs.tickCount,tickLine:Il.tickLine,tickSize:Il.tickSize,type:hs.type,xAxisId:0},BIe=e=>{var t=Xn(e,UIe);return f.createElement(f.Fragment,null,f.createElement(zIe,{allowDataOverflow:t.allowDataOverflow,allowDecimals:t.allowDecimals,allowDuplicatedCategory:t.allowDuplicatedCategory,angle:t.angle,dataKey:t.dataKey,domain:t.domain,height:t.height,hide:t.hide,id:t.xAxisId,includeHidden:t.includeHidden,interval:t.interval,minTickGap:t.minTickGap,mirror:t.mirror,name:t.name,orientation:t.orientation,padding:t.padding,reversed:t.reversed,scale:t.scale,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit}),f.createElement(FIe,t))},VE=f.memo(BIe,fZ);VE.displayName="XAxis";var HIe=["dangerouslySetInnerHTML","ticks","scale"],qIe=["id","scale"];function YE(){return YE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},YE.apply(null,arguments)}function L7(e,t){if(e==null)return{};var n,s,r=GIe(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)n=i[s],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function GIe(e,t){if(e==null)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;n[s]=e[s]}return n}function WIe(e){var t=Ja(),n=f.useRef(null);return f.useLayoutEffect(()=>{n.current===null?t(b5e(e)):n.current!==e&&t(v5e({prev:n.current,next:e})),n.current=e},[e,t]),f.useLayoutEffect(()=>()=>{n.current&&(t(w5e(n.current)),n.current=null)},[t]),null}var VIe=e=>{var{yAxisId:t,className:n,width:s,label:r}=e,i=f.useRef(null),o=f.useRef(null),l=Bt(UD),c=Hs(),u=Ja(),d="yAxis",h=Bt(k=>WK(k,t)),p=Bt(k=>gLe(k,t)),x=Bt(k=>QK(k,d,t,c)),b=Bt(k=>AK(k,t));if(f.useLayoutEffect(()=>{if(!(s!=="auto"||!h||IP(r)||f.isValidElement(r)||b==null)){var k=i.current;if(k){var A=k.getCalculatedWidth();Math.round(h.width)!==Math.round(A)&&u(j5e({id:t,width:A}))}}},[x,h,u,r,t,s,b]),h==null||p==null||b==null)return null;var{dangerouslySetInnerHTML:j,ticks:y,scale:N}=e,w=L7(e,HIe),{id:S,scale:_}=b,T=L7(b,qIe);return f.createElement(KP,YE({},w,T,{ref:i,labelRef:o,x:p.x,y:p.y,tickTextProps:s==="auto"?{width:void 0}:{width:s},width:h.width,height:h.height,className:Rt("recharts-".concat(d," ").concat(d),n),viewBox:l,ticks:x,axisType:d}))},YIe={allowDataOverflow:gs.allowDataOverflow,allowDecimals:gs.allowDecimals,allowDuplicatedCategory:gs.allowDuplicatedCategory,angle:gs.angle,axisLine:Il.axisLine,hide:!1,includeHidden:gs.includeHidden,interval:gs.interval,minTickGap:gs.minTickGap,mirror:gs.mirror,orientation:gs.orientation,padding:gs.padding,reversed:gs.reversed,scale:gs.scale,tick:gs.tick,tickCount:gs.tickCount,tickLine:Il.tickLine,tickSize:Il.tickSize,type:gs.type,width:gs.width,yAxisId:0},QIe=e=>{var t=Xn(e,YIe);return f.createElement(f.Fragment,null,f.createElement(WIe,{interval:t.interval,id:t.yAxisId,scale:t.scale,type:t.type,domain:t.domain,allowDataOverflow:t.allowDataOverflow,dataKey:t.dataKey,allowDuplicatedCategory:t.allowDuplicatedCategory,allowDecimals:t.allowDecimals,tickCount:t.tickCount,padding:t.padding,includeHidden:t.includeHidden,reversed:t.reversed,ticks:t.ticks,width:t.width,orientation:t.orientation,mirror:t.mirror,hide:t.hide,unit:t.unit,name:t.name,angle:t.angle,minTickGap:t.minTickGap,tick:t.tick,tickFormatter:t.tickFormatter}),f.createElement(VIe,t))},QE=f.memo(QIe,fZ);QE.displayName="YAxis";var KIe=(e,t)=>t,JP=dt([KIe,wa,CK,us,uX,mc,L4e,ds],R4e),e3=e=>{var t=e.currentTarget.getBoundingClientRect(),n=t.width/e.currentTarget.offsetWidth,s=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/n),chartY:Math.round((e.clientY-t.top)/s)}},hZ=ji("mouseClick"),gZ=r0();gZ.startListening({actionCreator:hZ,effect:(e,t)=>{var n=e.payload,s=JP(t.getState(),e3(n));s?.activeIndex!=null&&t.dispatch(kLe({activeIndex:s.activeIndex,activeDataKey:void 0,activeCoordinate:s.activeCoordinate}))}});var KE=ji("mouseMove"),pZ=r0(),bb=null;pZ.startListening({actionCreator:KE,effect:(e,t)=>{var n=e.payload;bb!==null&&cancelAnimationFrame(bb);var s=e3(n);bb=requestAnimationFrame(()=>{var r=t.getState(),i=CP(r,r.tooltip.settings.shared);if(i==="axis"){var o=JP(r,s);o?.activeIndex!=null?t.dispatch(nX({activeIndex:o.activeIndex,activeDataKey:void 0,activeCoordinate:o.activeCoordinate})):t.dispatch(aX())}bb=null})}});function XIe(e,t){return t instanceof HTMLElement?"HTMLElement <".concat(t.tagName,' class="').concat(t.className,'">'):t===window?"global.window":e==="children"&&typeof t=="object"&&t!==null?"<<CHILDREN>>":t}var D7={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index",baseValue:void 0,reverseStackOrder:!1},xZ=Cr({name:"rootProps",initialState:D7,reducers:{updateOptions:(e,t)=>{var n;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=(n=t.payload.barGap)!==null&&n!==void 0?n:D7.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className,e.baseValue=t.payload.baseValue,e.reverseStackOrder=t.payload.reverseStackOrder}}}),ZIe=xZ.reducer,{updateOptions:JIe}=xZ.actions,yZ=Cr({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(e,t)=>t.payload}}),{updatePolarOptions:e$e}=yZ.actions,t$e=yZ.reducer,bZ=ji("keyDown"),vZ=ji("focus"),t3=r0();t3.startListening({actionCreator:bZ,effect:(e,t)=>{var n=t.getState(),s=n.rootProps.accessibilityLayer!==!1;if(s){var{keyboardInteraction:r}=n.tooltip,i=e.payload;if(!(i!=="ArrowRight"&&i!=="ArrowLeft"&&i!=="Enter")){var o=SP(r,_h(n),h0(n),x0(n)),l=o==null?-1:Number(o);if(!(!Number.isFinite(l)||l<0)){var c=mc(n);if(i==="Enter"){var u=Mw(n,"axis","hover",String(r.index));t.dispatch(ME({active:!r.active,activeIndex:r.index,activeCoordinate:u}));return}var d=bLe(n),h=d==="left-to-right"?1:-1,p=i==="ArrowRight"?1:-1,x=l+p*h;if(!(c==null||x>=c.length||x<0)){var b=Mw(n,"axis","hover",String(x));t.dispatch(ME({active:!0,activeIndex:x.toString(),activeCoordinate:b}))}}}}}});t3.startListening({actionCreator:vZ,effect:(e,t)=>{var n=t.getState(),s=n.rootProps.accessibilityLayer!==!1;if(s){var{keyboardInteraction:r}=n.tooltip;if(!r.active&&r.index==null){var i="0",o=Mw(n,"axis","hover",String(i));t.dispatch(ME({active:!0,activeIndex:i,activeCoordinate:o}))}}}});var di=ji("externalEvent"),wZ=r0(),pA=new Map;wZ.startListening({actionCreator:di,effect:(e,t)=>{var{handler:n,reactEvent:s}=e.payload;if(n!=null){s.persist();var r=s.type,i=pA.get(r);i!==void 0&&cancelAnimationFrame(i);var o=requestAnimationFrame(()=>{try{var l=t.getState(),c={activeCoordinate:g4e(l),activeDataKey:EP(l),activeIndex:bd(l),activeLabel:hX(l),activeTooltipIndex:bd(l),isTooltipActive:p4e(l)};n(c,s)}finally{pA.delete(r)}});pA.set(r,o)}}});var a$e=dt([Ch],e=>e.tooltipItemPayloads),n$e=dt([a$e,p0,(e,t)=>t,(e,t,n)=>n],(e,t,n,s)=>{var r=e.find(l=>l.settings.graphicalItemId===s);if(r!=null){var{positions:i}=r;if(i!=null){var o=t(i,n);return o}}}),jZ=ji("touchMove"),NZ=r0();NZ.startListening({actionCreator:jZ,effect:(e,t)=>{var n=e.payload;if(!(n.touches==null||n.touches.length===0)){var s=t.getState(),r=CP(s,s.tooltip.settings.shared);if(r==="axis"){var i=n.touches[0];if(i==null)return;var o=JP(s,e3({clientX:i.clientX,clientY:i.clientY,currentTarget:n.currentTarget}));o?.activeIndex!=null&&t.dispatch(nX({activeIndex:o.activeIndex,activeDataKey:void 0,activeCoordinate:o.activeCoordinate}))}else if(r==="item"){var l,c=n.touches[0];if(document.elementFromPoint==null||c==null)return;var u=document.elementFromPoint(c.clientX,c.clientY);if(!u||!u.getAttribute)return;var d=u.getAttribute(AQ),h=(l=u.getAttribute(TQ))!==null&&l!==void 0?l:void 0,p=Sh(s).find(j=>j.id===h);if(d==null||p==null||h==null)return;var{dataKey:x}=p,b=n$e(s,d,h);t.dispatch(tX({activeDataKey:x,activeIndex:d,activeCoordinate:b,activeGraphicalItemId:h}))}}}});var s$e=QY({brush:F5e,cartesianAxis:N5e,chartData:gDe,errorBars:$Oe,graphicalItems:k3e,layout:hAe,legend:jTe,options:dDe,polarAxis:WPe,polarOptions:t$e,referenceElements:V5e,rootProps:ZIe,tooltip:ELe,zIndex:Z4e}),r$e=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Chart";return z_e({reducer:s$e,preloadedState:t,middleware:s=>{var r;return s({serializableCheck:!1,immutableCheck:!["commonjs","es6","production"].includes((r="es6")!==null&&r!==void 0?r:"")}).concat([gZ.middleware,pZ.middleware,t3.middleware,wZ.middleware,NZ.middleware])},enhancers:s=>{var r=s;return typeof s=="function"&&(r=s()),r.concat(dQ({type:"raf"}))},devTools:{serialize:{replacer:XIe},name:"recharts-".concat(n)}})};function CZ(e){var{preloadedState:t,children:n,reduxStoreName:s}=e,r=Hs(),i=f.useRef(null);if(r)return n;i.current==null&&(i.current=r$e(t,s));var o=DD;return f.createElement(fMe,{context:o,store:i.current},n)}function i$e(e){var{layout:t,margin:n}=e,s=Ja(),r=Hs();return f.useEffect(()=>{r||(s(uAe(t)),s(dAe(n)))},[s,r,t,n]),null}var SZ=f.memo(i$e,j1);function _Z(e){var t=Ja();return f.useEffect(()=>{t(JIe(e))},[t,e]),null}function P7(e){var{zIndex:t,isPanorama:n}=e,s=f.useRef(null),r=Ja();return f.useLayoutEffect(()=>(s.current&&r(K4e({zIndex:t,element:s.current,isPanorama:n})),()=>{r(X4e({zIndex:t,isPanorama:n}))}),[r,t,n]),f.createElement("g",{tabIndex:-1,ref:s})}function O7(e){var{children:t,isPanorama:n}=e,s=Bt(F4e);if(!s||s.length===0)return t;var r=s.filter(o=>o<0),i=s.filter(o=>o>0);return f.createElement(f.Fragment,null,r.map(o=>f.createElement(P7,{key:o,zIndex:o,isPanorama:n})),t,i.map(o=>f.createElement(P7,{key:o,zIndex:o,isPanorama:n})))}var o$e=["children"];function l$e(e,t){if(e==null)return{};var n,s,r=c$e(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)n=i[s],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function c$e(e,t){if(e==null)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;n[s]=e[s]}return n}function Hw(){return Hw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Hw.apply(null,arguments)}var d$e={width:"100%",height:"100%",display:"block"},u$e=f.forwardRef((e,t)=>{var n=HD(),s=qD(),r=GQ();if(!qo(n)||!qo(s))return null;var{children:i,otherAttributes:o,title:l,desc:c}=e,u,d;return o!=null&&(typeof o.tabIndex=="number"?u=o.tabIndex:u=r?0:void 0,typeof o.role=="string"?d=o.role:d=r?"application":void 0),f.createElement(SD,Hw({},o,{title:l,desc:c,role:d,tabIndex:u,width:n,height:s,style:d$e,ref:t}),i)}),m$e=e=>{var{children:t}=e,n=Bt(ZN);if(!n)return null;var{width:s,height:r,y:i,x:o}=n;return f.createElement(SD,{width:s,height:r,x:o,y:i},t)},M7=f.forwardRef((e,t)=>{var{children:n}=e,s=l$e(e,o$e),r=Hs();return r?f.createElement(m$e,null,f.createElement(O7,{isPanorama:!0},n)):f.createElement(u$e,Hw({ref:t},s),f.createElement(O7,{isPanorama:!1},n))});function f$e(){var e=Ja(),[t,n]=f.useState(null),s=Bt(DAe);return f.useEffect(()=>{if(t!=null){var r=t.getBoundingClientRect(),i=r.width/t.offsetWidth;xn(i)&&i!==s&&e(fAe(i))}},[t,e,s]),n}function I7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function h$e(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?I7(Object(n),!0).forEach(function(s){g$e(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I7(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function g$e(e,t,n){return(t=p$e(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p$e(e){var t=x$e(e,"string");return typeof t=="symbol"?t:t+""}function x$e(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Zu(){return Zu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Zu.apply(null,arguments)}var y$e=()=>(CDe(),null);function qw(e){if(typeof e=="number")return e;if(typeof e=="string"){var t=parseFloat(e);if(!Number.isNaN(t))return t}return 0}var b$e=f.forwardRef((e,t)=>{var n,s,r=f.useRef(null),[i,o]=f.useState({containerWidth:qw((n=e.style)===null||n===void 0?void 0:n.width),containerHeight:qw((s=e.style)===null||s===void 0?void 0:s.height)}),l=f.useCallback((u,d)=>{o(h=>{var p=Math.round(u),x=Math.round(d);return h.containerWidth===p&&h.containerHeight===x?h:{containerWidth:p,containerHeight:x}})},[]),c=f.useCallback(u=>{if(typeof t=="function"&&t(u),u!=null&&typeof ResizeObserver<"u"){var{width:d,height:h}=u.getBoundingClientRect();l(d,h);var p=b=>{var{width:j,height:y}=b[0].contentRect;l(j,y)},x=new ResizeObserver(p);x.observe(u),r.current=x}},[t,l]);return f.useEffect(()=>()=>{var u=r.current;u?.disconnect()},[l]),f.createElement(f.Fragment,null,f.createElement(e1,{width:i.containerWidth,height:i.containerHeight}),f.createElement("div",Zu({ref:c},e)))}),v$e=f.forwardRef((e,t)=>{var{width:n,height:s}=e,[r,i]=f.useState({containerWidth:qw(n),containerHeight:qw(s)}),o=f.useCallback((c,u)=>{i(d=>{var h=Math.round(c),p=Math.round(u);return d.containerWidth===h&&d.containerHeight===p?d:{containerWidth:h,containerHeight:p}})},[]),l=f.useCallback(c=>{if(typeof t=="function"&&t(c),c!=null){var{width:u,height:d}=c.getBoundingClientRect();o(u,d)}},[t,o]);return f.createElement(f.Fragment,null,f.createElement(e1,{width:r.containerWidth,height:r.containerHeight}),f.createElement("div",Zu({ref:l},e)))}),w$e=f.forwardRef((e,t)=>{var{width:n,height:s}=e;return f.createElement(f.Fragment,null,f.createElement(e1,{width:n,height:s}),f.createElement("div",Zu({ref:t},e)))}),j$e=f.forwardRef((e,t)=>{var{width:n,height:s}=e;return Ql(n)||Ql(s)?f.createElement(v$e,Zu({},e,{ref:t})):f.createElement(w$e,Zu({},e,{ref:t}))});function N$e(e){return e===!0?b$e:j$e}var C$e=f.forwardRef((e,t)=>{var{children:n,className:s,height:r,onClick:i,onContextMenu:o,onDoubleClick:l,onMouseDown:c,onMouseEnter:u,onMouseLeave:d,onMouseMove:h,onMouseUp:p,onTouchEnd:x,onTouchMove:b,onTouchStart:j,style:y,width:N,responsive:w,dispatchTouchEvents:S=!0}=e,_=f.useRef(null),T=Ja(),[k,A]=f.useState(null),[E,M]=f.useState(null),F=f$e(),D=BD(),P=D?.width>0?D.width:N,B=D?.height>0?D.height:r,G=f.useCallback(pe=>{F(pe),typeof t=="function"&&t(pe),A(pe),M(pe),pe!=null&&(_.current=pe)},[F,t,A,M]),$=f.useCallback(pe=>{T(hZ(pe)),T(di({handler:i,reactEvent:pe}))},[T,i]),W=f.useCallback(pe=>{T(KE(pe)),T(di({handler:u,reactEvent:pe}))},[T,u]),Z=f.useCallback(pe=>{T(aX()),T(di({handler:d,reactEvent:pe}))},[T,d]),Q=f.useCallback(pe=>{T(KE(pe)),T(di({handler:h,reactEvent:pe}))},[T,h]),le=f.useCallback(()=>{T(vZ())},[T]),we=f.useCallback(pe=>{T(bZ(pe.key))},[T]),J=f.useCallback(pe=>{T(di({handler:o,reactEvent:pe}))},[T,o]),se=f.useCallback(pe=>{T(di({handler:l,reactEvent:pe}))},[T,l]),ye=f.useCallback(pe=>{T(di({handler:c,reactEvent:pe}))},[T,c]),Ce=f.useCallback(pe=>{T(di({handler:p,reactEvent:pe}))},[T,p]),ge=f.useCallback(pe=>{T(di({handler:j,reactEvent:pe}))},[T,j]),be=f.useCallback(pe=>{S&&T(jZ(pe)),T(di({handler:b,reactEvent:pe}))},[T,S,b]),me=f.useCallback(pe=>{T(di({handler:x,reactEvent:pe}))},[T,x]),Ae=N$e(w);return f.createElement(wX.Provider,{value:k},f.createElement(TY.Provider,{value:E},f.createElement(Ae,{width:P??y?.width,height:B??y?.height,className:Rt("recharts-wrapper",s),style:h$e({position:"relative",cursor:"default",width:P,height:B},y),onClick:$,onContextMenu:J,onDoubleClick:se,onFocus:le,onKeyDown:we,onMouseDown:ye,onMouseEnter:W,onMouseLeave:Z,onMouseMove:Q,onMouseUp:Ce,onTouchEnd:me,onTouchMove:be,onTouchStart:ge,ref:G},f.createElement(y$e,null),n)))}),S$e=["width","height","responsive","children","className","style","compact","title","desc"];function _$e(e,t){if(e==null)return{};var n,s,r=A$e(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)n=i[s],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function A$e(e,t){if(e==null)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;n[s]=e[s]}return n}var AZ=f.forwardRef((e,t)=>{var{width:n,height:s,responsive:r,children:i,className:o,style:l,compact:c,title:u,desc:d}=e,h=_$e(e,S$e),p=qr(h);return c?f.createElement(f.Fragment,null,f.createElement(e1,{width:n,height:s}),f.createElement(M7,{otherAttributes:p,title:u,desc:d},i)):f.createElement(C$e,{className:o,style:l,width:n,height:s,responsive:r??!1,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},f.createElement(M7,{otherAttributes:p,title:u,desc:d,ref:t},f.createElement(Q5e,null,i)))});function XE(){return XE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},XE.apply(null,arguments)}var T$e={top:5,right:5,bottom:5,left:5},k$e={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,layout:"horizontal",margin:T$e,responsive:!1,reverseStackOrder:!1,stackOffset:"none",syncMethod:"index"},TZ=f.forwardRef(function(t,n){var s,r=Xn(t.categoricalChartProps,k$e),{chartName:i,defaultTooltipEventType:o,validateTooltipEventTypes:l,tooltipPayloadSearcher:c,categoricalChartProps:u}=t,d={chartName:i,defaultTooltipEventType:o,validateTooltipEventTypes:l,tooltipPayloadSearcher:c,eventEmitter:void 0};return f.createElement(CZ,{preloadedState:{options:d},reduxStoreName:(s=u.id)!==null&&s!==void 0?s:i},f.createElement(KX,{chartData:u.data}),f.createElement(SZ,{layout:r.layout,margin:r.margin}),f.createElement(_Z,{baseValue:r.baseValue,accessibilityLayer:r.accessibilityLayer,barCategoryGap:r.barCategoryGap,maxBarSize:r.maxBarSize,stackOffset:r.stackOffset,barGap:r.barGap,barSize:r.barSize,syncId:r.syncId,syncMethod:r.syncMethod,className:r.className,reverseStackOrder:r.reverseStackOrder}),f.createElement(AZ,XE({},r,{ref:n})))}),E$e=["axis"],L$e=f.forwardRef((e,t)=>f.createElement(TZ,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:E$e,tooltipPayloadSearcher:MP,categoricalChartProps:e,ref:t})),D$e=["axis","item"],P$e=f.forwardRef((e,t)=>f.createElement(TZ,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:D$e,tooltipPayloadSearcher:MP,categoricalChartProps:e,ref:t}));function O$e(e){var t=Ja();return f.useEffect(()=>{t(e$e(e))},[t,e]),null}var M$e=["layout"];function ZE(){return ZE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},ZE.apply(null,arguments)}function I$e(e,t){if(e==null)return{};var n,s,r=$$e(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)n=i[s],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function $$e(e,t){if(e==null)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;n[s]=e[s]}return n}var R$e={top:5,right:5,bottom:5,left:5},kZ={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:R$e,reverseStackOrder:!1,syncMethod:"index",layout:"radial",responsive:!1,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},z$e=f.forwardRef(function(t,n){var s,r=Xn(t.categoricalChartProps,kZ),{layout:i}=r,o=I$e(r,M$e),{chartName:l,defaultTooltipEventType:c,validateTooltipEventTypes:u,tooltipPayloadSearcher:d}=t,h={chartName:l,defaultTooltipEventType:c,validateTooltipEventTypes:u,tooltipPayloadSearcher:d,eventEmitter:void 0};return f.createElement(CZ,{preloadedState:{options:h},reduxStoreName:(s=r.id)!==null&&s!==void 0?s:l},f.createElement(KX,{chartData:r.data}),f.createElement(SZ,{layout:i,margin:r.margin}),f.createElement(_Z,{baseValue:void 0,accessibilityLayer:r.accessibilityLayer,barCategoryGap:r.barCategoryGap,maxBarSize:r.maxBarSize,stackOffset:r.stackOffset,barGap:r.barGap,barSize:r.barSize,syncId:r.syncId,syncMethod:r.syncMethod,className:r.className,reverseStackOrder:r.reverseStackOrder}),f.createElement(O$e,{cx:r.cx,cy:r.cy,startAngle:r.startAngle,endAngle:r.endAngle,innerRadius:r.innerRadius,outerRadius:r.outerRadius}),f.createElement(AZ,ZE({},o,{ref:n})))});function $7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function R7(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?$7(Object(n),!0).forEach(function(s){F$e(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$7(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function F$e(e,t,n){return(t=U$e(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function U$e(e){var t=B$e(e,"string");return typeof t=="symbol"?t:t+""}function B$e(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var H$e=["item"],q$e=R7(R7({},kZ),{},{layout:"centric",startAngle:0,endAngle:360}),G$e=f.forwardRef((e,t)=>{var n=Xn(e,q$e);return f.createElement(z$e,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:H$e,tooltipPayloadSearcher:MP,categoricalChartProps:n,ref:t})});const z7={user_id:"",start_date:"",end_date:"",target_amount:"",annual_amount:"",period_type:"",period_year:new Date().getFullYear(),period_number:1,prorate_first_period:!0,use_annual_mode:!0},EZ=[{value:"MONTHLY",label:"Monthly",divisor:12},{value:"QUARTERLY",label:"Quarterly",divisor:4},{value:"SEMIANNUAL",label:"Semi-Annual",divisor:2},{value:"ANNUAL",label:"Annual",divisor:1},{value:"CUSTOM",label:"Custom (Manual)",divisor:1}],F7=["#6366f1","#22c55e","#f97316","#0ea5e9","#a855f7","#f43f5e","#eab308","#8b5cf6","#10b981","#ec4899","#14b8a6","#f59e0b"];function W$e({name:e,items:t=[],value:n="",onChange:s,getLabel:r,placeholder:i="Search...",required:o=!1,isSubmitted:l=!1}){const[c,u]=f.useState(!1),[d,h]=f.useState(""),p=f.useRef(null),x=t.find(N=>String(N.id)===String(n)),b=x?r(x):"",j=o&&l&&!n,y=f.useMemo(()=>{const N=d.toLowerCase();return N?t.filter(w=>r(w).toLowerCase().includes(N)):t},[t,d,r]);return f.useEffect(()=>{const N=w=>{p.current&&!p.current.contains(w.target)&&u(!1)};return document.addEventListener("mousedown",N),()=>document.removeEventListener("mousedown",N)},[]),a.jsxs("div",{ref:p,className:"relative flex justify-center w-full",children:[a.jsx("input",{value:c?d:b,placeholder:i,onFocus:()=>u(!0),onChange:N=>{h(N.target.value),u(!0)},className:`w-full border rounded-lg p-1 text-gray-700 focus:outline-none focus:ring-1
          ${j?"border-red-500 focus:ring-red-400 focus:border-red-400":"border-gray-300 focus:ring-blue-400 focus:border-blue-400"}`}),c&&a.jsx("div",{className:"absolute top-full left-0 z-50 mt-1 w-full bg-white border border-gray-200 rounded-lg shadow-lg max-h-48 overflow-y-auto",children:y.length?y.map(N=>a.jsx("button",{type:"button",onClick:()=>{s({target:{name:e,value:String(N.id)}}),u(!1),h("")},className:"w-full text-left px-3 py-2 text-sm hover:bg-gray-50",children:r(N)},N.id)):a.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No results found"})})]})}function N1({currentUserRole:e,currentUserId:t}){const{user:n,mutate:s}=Gt(),r=n?.id,i=n?.company?.currency||"",o=i==="$"?Bue:que;f.useEffect(()=>{s&&s()},[s]),f.useEffect(()=>{n?.company&&console.log("Dashboard detected Company Settings:",n.company)},[n]),f.useEffect(()=>{document.title="Targets | Sari-Sari CRM"},[]);const[l,c]=f.useState([]),[u,d]=f.useState([]),[h,p]=f.useState(!1),[x,b]=f.useState(""),[j,y]=f.useState(""),[N,w]=f.useState(1),[S,_]=f.useState(10),[T,k]=f.useState(!1),[A,E]=f.useState(!1),[M,F]=f.useState(!1),[D,P]=f.useState(null),[B,G]=f.useState(z7),[$,W]=f.useState(null),[Z,Q]=f.useState(null),[le,we]=f.useState(!1),[J,se]=f.useState([]),[ye,Ce]=f.useState(!1),[ge,be]=f.useState("annual"),[me,Ae]=f.useState(1),[pe,Ie]=f.useState("overview"),[xe,he]=f.useState(null),[Re,Ee]=f.useState(!1),[He,Ke]=f.useState(null),[st,it]=f.useState(!1),[ot,rt]=f.useState(""),[at,Je]=f.useState(null),[Fe,Ue]=f.useState(null),[Ne,ze]=f.useState(new Date().getFullYear()),[je,ve]=f.useState(""),[z,K]=f.useState(1),ue=f.useMemo(()=>["CEO","ADMIN","GROUP MANAGER"].includes(e?.toUpperCase()),[e]),re=f.useMemo(()=>["CEO","ADMIN","GROUP MANAGER"].includes(e?.toUpperCase()),[e]),Le=f.useCallback(async()=>{p(!0);try{const ie=await ne.get("/targets/admin/fetch-all");c(ie.data)}catch(ie){console.error(ie),V.error("Failed to load targets.")}finally{p(!1)}},[]),De=f.useCallback(async()=>{try{const ie=await ne.get("/targets/admin/get-users");d(ie.data)}catch(ie){console.error(ie)}},[]),Qe=f.useCallback(async()=>{try{const ie=await ne.get("/targets/fiscal-settings");Ue(ie.data)}catch(ie){console.error("Failed to fetch fiscal settings:",ie)}},[]),tt=f.useCallback(async()=>{Ee(!0);try{const ie=new URLSearchParams;je&&ie.append("period_type",je),Ne&&ie.append("period_year",Ne),z&&ie.append("period_number",z);const Oe=await ne.get(`/targets/leaderboard?${ie.toString()}`);he(Oe.data)}catch(ie){console.error(ie),V.error("Failed to load leaderboard.")}finally{Ee(!1)}},[je,Ne,z]),Me=f.useCallback(async()=>{try{const ie=new URLSearchParams;je&&ie.append("period_type",je),Ne&&ie.append("period_year",Ne),z&&ie.append("period_number",z);const Oe=await ne.get(`/targets/team-summary?${ie.toString()}`);Je(Oe.data)}catch(ie){console.error(ie)}},[je,Ne,z]),et=f.useCallback(async(ie,Oe="")=>{it(!0);try{const X=Oe?`?period_type=${encodeURIComponent(Oe)}`:"",oe=await ne.get(`/targets/history/${ie}${X}`);Ke(oe.data)}catch(X){console.error(X),V.error("Failed to load user history.")}finally{it(!1)}},[]);f.useEffect(()=>{Le(),De(),Qe()},[Le,De,Qe]),f.useEffect(()=>{pe==="leaderboard"&&(tt(),Me())},[pe,tt,Me]);const yt=f.useMemo(()=>{const ie=l.reduce((Pe,Ve)=>Pe+(Number(Ve.target_amount)||0),0),Oe=l.reduce((Pe,Ve)=>Pe+(Number(Ve.achieved_amount)||0),0),X=ie>0?(Oe/ie*100).toFixed(1):0,oe=Math.max(0,ie-Oe);return{totalTarget:ie,totalAchieved:Oe,achievement:X,remaining:oe,totalCount:l.length}},[l]),_t=f.useCallback(()=>(Oe=>ge==="annual"?Oe:Oe.filter(X=>{const oe=new Date(X.start_date),Pe=new Date(X.end_date),Ve=oe.getMonth(),ft=Pe.getMonth();let St=!1;if(ge==="semiannual")me===1?St=Ve<=5&&ft>=0:St=Ve<=11&&ft>=6;else if(ge==="trimester"){const da=[{start:0,end:3},{start:4,end:7},{start:8,end:11}][me-1];St=Ve<=da.end&&ft>=da.start}else if(ge==="quarterly"){const da=[{start:0,end:2},{start:3,end:5},{start:6,end:8},{start:9,end:11}][me-1];St=Ve<=da.end&&ft>=da.start}return St}))(l),[l,ge,me]),Ct=f.useMemo(()=>{const ie=_t(),Oe={};ie.forEach(Ve=>{const ft=Ve.user_id,St=Ve.user?`${Ve.user.first_name} ${Ve.user.last_name}`:"Unknown";Oe[ft]||(Oe[ft]={userId:ft,name:St,targetAmount:0,achievedAmount:0}),Oe[ft].targetAmount+=Number(Ve.target_amount)||0,Oe[ft].achievedAmount+=Number(Ve.achieved_amount)||0});const X=Object.values(Oe).map((Ve,ft)=>({...Ve,fill:F7[ft%F7.length]})),oe=X.reduce((Ve,ft)=>Ve+ft.targetAmount,0);return X.map(Ve=>({...Ve,percentage:oe>0?(Ve.targetAmount/oe*100).toFixed(1):0}))},[_t]),jt=f.useMemo(()=>Ct.slice(0,8).map(ie=>({name:ie.name.split(" ")[0],achievement:Number(ie.achievedAmount),target:Number(ie.targetAmount)})),[Ct]),At=f.useMemo(()=>{const ie=Array.isArray(u)&&u.length?u:l.filter(oe=>oe.user&&oe.user.id).map(oe=>({id:oe.user.id,first_name:oe.user.first_name,last_name:oe.user.last_name})),Oe=new Set,X=[];for(const oe of ie){const Pe=String(oe.id);Oe.has(Pe)||(Oe.add(Pe),X.push(oe))}return X.sort((oe,Pe)=>{const Ve=`${oe.first_name||""} ${oe.last_name||""}`.trim().toLowerCase(),ft=`${Pe.first_name||""} ${Pe.last_name||""}`.trim().toLowerCase();return Ve.localeCompare(ft)}),X},[u,l]),Ge=f.useMemo(()=>{const ie=x.toLowerCase();return l.filter(Oe=>{const X=!j||String(Oe.user?.id||"")===String(j),oe=Oe.user?`${Oe.user.first_name} ${Oe.user.last_name}`.toLowerCase():"";return X&&(oe.includes(ie)||Oe.start_date?.includes(ie)||Oe.end_date?.includes(ie))})},[l,x,j]);f.useEffect(()=>{w(1)},[x,j]);const Be=Math.max(1,Math.ceil(Ge.length/S)),ce=f.useMemo(()=>{const ie=(N-1)*S;return Ge.slice(ie,ie+S)},[Ge,N,S]),fe=ie=>{const{name:Oe,value:X}=ie.target;G(oe=>({...oe,[Oe]:X}))},H=()=>{G(z7),E(!1),P(null),Ce(!1),k(!0)},te=ie=>{G({user_id:ie.user?.id?String(ie.user.id):"",start_date:ie.start_date||"",end_date:ie.end_date||"",target_amount:ie.target_amount?.toString()||"",annual_amount:"",period_type:ie.period_type||"CUSTOM",period_year:ie.period_year||new Date().getFullYear(),period_number:ie.period_number||1,prorate_first_period:!0,use_annual_mode:!1}),E(!0),P(ie.id),Ce(!1),k(!0),W(null)},q=ie=>{const Oe=ie.user?`${ie.user.first_name} ${ie.user.last_name}`:"Unknown",X=e?.toUpperCase()==="GROUP MANAGER",oe=["CEO","ADMIN"].includes(e?.toUpperCase());if(X&&Number(ie.created_by)!==Number(r)){V.error("You can only archive targets you created");return}Q({title:oe?"Delete Target":"Archive Target",message:a.jsxs("span",{children:["Are you sure you want to ",oe?"delete":"archive"," the target for"," ",a.jsx("span",{className:"font-semibold",children:Oe}),"?"]}),confirmLabel:oe?"Delete":"Archive",cancelLabel:"Cancel",variant:oe?"danger":"archive",action:async()=>{await ne.delete(`/targets/admin/${ie.id}`),V.success(`Target ${oe?"deleted":"archived"} successfully.`),Le(),W(null)}})},Y=()=>{const Oe=e?.toUpperCase()==="GROUP MANAGER"?ce.filter(oe=>Number(oe.created_by)===Number(r)):ce;if(Oe.length>0&&Oe.every(oe=>J.includes(oe.id))){const oe=Oe.map(Pe=>Pe.id);se(J.filter(Pe=>!oe.includes(Pe)))}else{const oe=Oe.map(Pe=>Pe.id);se([...new Set([...J,...oe])])}},U=ie=>{const Oe=l.find(oe=>oe.id===ie);e?.toUpperCase()==="GROUP MANAGER"&&Oe&&Number(Oe.created_by)!==Number(r)||se(oe=>oe.includes(ie)?oe.filter(Pe=>Pe!==ie):[...oe,ie])},de=async()=>{if(J.length===0)return;const ie=e?.toUpperCase()==="GROUP MANAGER",Oe=["CEO","ADMIN"].includes(e?.toUpperCase());if(ie&&!J.every(oe=>{const Pe=l.find(Ve=>Ve.id===oe);return Pe&&Number(Pe.created_by)===Number(r)})){V.error("You can only archive targets you created");return}Q({title:Oe?"Delete Targets":"Archive Targets",message:a.jsxs("span",{children:["Are you sure you want to ",Oe?"delete":"archive"," ",a.jsx("span",{className:"font-semibold",children:J.length})," selected targets?"]}),confirmLabel:`${Oe?"Delete":"Archive"} ${J.length} Target(s)`,cancelLabel:"Cancel",variant:Oe?"danger":"archive",action:async()=>{await ne.post("/targets/admin/bulk-delete",{target_ids:J}),V.success(`Successfully ${Oe?"deleted":"archived"} ${J.length} targets`),se([]),Le()}})},Te=ie=>{if(ie.preventDefault(),Ce(!0),!B.user_id){V.error("Assign User is required.");return}if(!B.period_type){V.error("Period Type is required.");return}const Oe=B.use_annual_mode&&B.period_type!=="CUSTOM"&&!A;if(Oe){if(!B.annual_amount||Number(B.annual_amount)<=0){V.error("Annual target amount must be greater than 0.");return}}else if(!B.target_amount||Number(B.target_amount)<=0){V.error("Target amount must be greater than 0.");return}if(!Oe&&B.start_date&&B.end_date&&new Date(B.end_date)<new Date(B.start_date)){V.error("End date must be after start date.");return}const X=A?"Update Target":"Create Target(s)",oe=()=>{const ft=Number(B.period_number)||1;return B.period_type==="MONTHLY"?Math.max(1,12-ft+1):B.period_type==="QUARTERLY"?Math.max(1,4-ft+1):B.period_type==="SEMIANNUAL"?Math.max(1,2-ft+1):1},Pe=()=>{const ft=Number(B.annual_amount)||0,St=EZ.find(Ht=>Ht.value===B.period_type);return St?(ft/St.divisor).toFixed(2):0},Ve=Oe?`This will create ${oe()} ${B.period_type?.toLowerCase()} target(s) for the selected user.

Annual Target: ${i}${Number(B.annual_amount).toLocaleString()}
Per Period: ${i}${Number(Pe()).toLocaleString()}

The first period may be prorated if it starts mid-period.`:"Are you sure you want to proceed?";Q({title:X,message:Ve,confirmLabel:X,cancelLabel:"Cancel",variant:"primary",action:async()=>{F(!0);try{if(A){const ft={user_id:Number(B.user_id),target_amount:Number(B.target_amount),start_date:B.start_date,end_date:B.end_date,period_type:B.period_type||"CUSTOM",period_year:B.period_year||new Date().getFullYear(),period_number:B.period_number||null};await ne.put(`/targets/admin/${D}`,ft),V.success("Target updated successfully.")}else if(Oe){const ft=new Date().toISOString().split("T")[0],St={user_id:Number(B.user_id),annual_amount:Number(B.annual_amount),period_type:B.period_type,generation_date:B.start_date||ft,period_year:Number(B.period_year)||new Date().getFullYear(),period_number:Number(B.period_number)||1,prorate_first_period:B.prorate_first_period!==!1},Ht=await ne.post("/targets/admin/create-annual-targets",St);Le(),V.success(Ht.data.message||"Targets created successfully.")}else{const ft={user_id:Number(B.user_id),target_amount:Number(B.target_amount),start_date:B.start_date,end_date:B.end_date,period_type:B.period_type||"CUSTOM",period_year:B.period_year||new Date().getFullYear(),period_number:B.period_number||null};await ne.post("/targets/admin/create",ft),Le(),V.success("Target created successfully.")}k(!1),Le()}catch(ft){console.error(ft);const St=ft.response?.data?.detail||ft.message||"Operation failed.";V.error(St)}finally{F(!1)}}})};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[h&&a.jsx(qt,{message:"Loading targets..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h1",{className:"flex items-center text-xl sm:text-2xl font-semibold",children:[a.jsx(fr,{className:"mr-2 text-blue-600"})," Targets"]}),ue&&a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{onClick:H,className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 my-1 lg:my-0 rounded-md hover:bg-gray-800 text-sm sm:text-base mx-auto sm:ml-auto cursor-pointer",children:[a.jsx(aa,{className:"mr-2"})," Add Target"]})})]}),e?.toUpperCase()!=="SALES"&&a.jsxs("div",{className:"flex border-b border-gray-200 mb-6",children:[a.jsxs("button",{onClick:()=>Ie("overview"),className:`px-4 py-3 text-sm font-medium border-b-2 transition ${pe==="overview"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[a.jsx(YI,{className:"inline mr-2"}),"Overview"]}),a.jsxs("button",{onClick:()=>Ie("leaderboard"),className:`px-4 py-3 text-sm font-medium border-b-2 transition ${pe==="leaderboard"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[a.jsx(l2,{className:"inline mr-2"}),"Leaderboard"]}),a.jsxs("button",{onClick:()=>Ie("history"),className:`px-4 py-3 text-sm font-medium border-b-2 transition ${pe==="history"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[a.jsx(Vn,{className:"inline mr-2"}),"History"]})]}),pe==="overview"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[a.jsx(Fc,{title:"Total Targets",value:yt.totalCount,icon:a.jsx(fr,{size:22}),color:"blue"}),a.jsx(Fc,{title:"Target Amount",value:`${i}${yt.totalTarget.toLocaleString("en-US",{maximumFractionDigits:0})}`,icon:a.jsx(o,{size:22}),color:"green"}),a.jsx(Fc,{title:"Achieved Amount",value:`${i}${yt.totalAchieved.toLocaleString("en-US",{maximumFractionDigits:0})}`,icon:a.jsx(cd,{size:22}),color:"purple"}),a.jsx(Fc,{title:"Achievement Rate",value:`${yt.achievement}%`,icon:a.jsx(fr,{size:22}),color:"orange"})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[a.jsxs("div",{className:"bg-white rounded-xl shadow p-4 md:h-[420px] h-[350px] flex flex-col",children:[a.jsxs("div",{className:"mb-4 text-center",children:[a.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Sales Achievement"}),a.jsx("div",{className:"h-[38px] w-full invisible"})]}),jt.length>0?a.jsx("div",{className:"flex-1 min-h-0 w-full",children:a.jsx(G_,{width:"100%",height:"100%",children:a.jsxs(P$e,{data:jt,children:[a.jsx(UE,{strokeDasharray:"3 3",vertical:!1}),a.jsx(VE,{dataKey:"name",tickLine:!1,axisLine:!1,tick:{fontSize:12,fill:"#6b7280"}}),a.jsx(QE,{tickLine:!1,axisLine:!1,label:{value:"Amount",angle:-90,position:"insideLeft",offset:3},domain:[0,ie=>Math.ceil(ie/50)*50],tick:{fontSize:12,fill:"#6b7280"}}),a.jsx(aA,{cursor:{fill:"rgba(0, 0, 0, 0.15)"},wrapperStyle:{outline:"none",zIndex:9999,pointerEvents:"auto"},contentStyle:{backgroundColor:"#ffffff",border:"2px solid #1f2937",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.2)",zIndex:9999,pointerEvents:"auto"},labelFormatter:ie=>`Sales: ${ie}`,formatter:(ie,Oe,X)=>{if(!X||!X.payload)return[ie,Oe];const oe=X.payload,Pe=Number(oe.achievement)||0,Ve=Number(oe.target)||0,ft=Math.max(0,Ve-Pe),St=Ve>0?(Pe/Ve*100).toFixed(1):0;return Oe==="Achieved"?[`${i}${Pe.toLocaleString()} (${St}%)`,"Achieved"]:Oe==="Remaining"?[`${i}${ft.toLocaleString()}`,"Remaining"]:[ie,Oe]}}),a.jsx(GE,{dataKey:"achievement",stackId:"a",fill:"#10b981",name:"Achieved",label:({x:ie,y:Oe,width:X,value:oe,payload:Pe})=>{if(!Pe||Pe.target===void 0)return null;const Ve=(oe/Pe.target*100).toFixed(0),ft=Oe-10<0?10:Oe-10;return a.jsxs("text",{x:ie+X/2,y:ft,textAnchor:"middle",fill:"#111827",fontSize:10,fontWeight:500,children:[Ve,"%"]})}}),a.jsx(GE,{dataKey:ie=>Math.max(0,ie.target-ie.achievement),stackId:"a",fill:"#e5e7eb",name:"Remaining",radius:[0,4,4,0]})]})})}):a.jsxs("div",{className:"flex flex-col items-center justify-center flex-1 text-gray-400",children:[a.jsx(aoe,{size:48,className:"mb-2 opacity-20"}),a.jsx("p",{className:"text-gray-500 font-medium text-center",children:"No sales data available"})]})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow p-4 md:h-[420px] h-[350px] flex flex-col",children:[a.jsxs("div",{className:"text-center mb-4",children:[a.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Target Distribution by Sales"}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 justify-center items-center flex-wrap",children:[a.jsxs("select",{value:ge,onChange:ie=>{be(ie.target.value),Ae(1)},className:"border border-gray-300 rounded px-3 py-2 text-sm text-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"annual",children:"Annual"}),a.jsx("option",{value:"semiannual",children:"Every 6 Months"}),a.jsx("option",{value:"trimester",children:"Every 4 Months"}),a.jsx("option",{value:"quarterly",children:"Quarterly"})]}),ge!=="annual"&&a.jsxs("select",{value:me,onChange:ie=>Ae(parseInt(ie.target.value)),className:"border border-gray-300 rounded px-3 py-2 text-sm text-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[ge==="semiannual"&&a.jsxs(a.Fragment,{children:[a.jsx("option",{value:1,children:"Jan - Jun"}),a.jsx("option",{value:2,children:"Jul - Dec"})]}),ge==="trimester"&&a.jsxs(a.Fragment,{children:[a.jsx("option",{value:1,children:"Jan - Apr"}),a.jsx("option",{value:2,children:"May - Aug"}),a.jsx("option",{value:3,children:"Sep - Dec"})]}),ge==="quarterly"&&a.jsxs(a.Fragment,{children:[a.jsx("option",{value:1,children:"Q1 (Jan - Mar)"}),a.jsx("option",{value:2,children:"Q2 (Apr - Jun)"}),a.jsx("option",{value:3,children:"Q3 (Jul - Sep)"}),a.jsx("option",{value:4,children:"Q4 (Oct - Dec)"})]})]})]})]}),Ct.length>0?a.jsx("div",{className:"flex-1 min-h-0 w-full",children:a.jsx(G_,{width:"100%",height:"100%",children:a.jsxs(G$e,{children:[a.jsx(aA,{contentStyle:{backgroundColor:"#fff",border:"1px solid #333",borderRadius:"6px",padding:"10px",boxShadow:"0 2px 8px rgba(0,0,0,0.15)",outline:"none"},content:({active:ie,payload:Oe})=>{if(ie&&Oe&&Oe.length>0){const X=Oe[0].payload;return a.jsxs("div",{className:"bg-white p-3 border border-gray-300 rounded shadow-lg",children:[a.jsx("p",{className:"text-sm font-semibold text-gray-800",children:X.name}),a.jsxs("p",{className:"text-xs text-blue-600 mt-1",children:[a.jsx("span",{className:"font-semibold",children:"Target Amount:"})," ",i,Number(X.targetAmount||0).toLocaleString("en-US",{maximumFractionDigits:0})]}),a.jsxs("p",{className:"text-xs text-purple-600 font-semibold mt-2",children:["Distribution: ",X.percentage,"%"]})]})}return null}}),a.jsx(VX,{data:Ct,dataKey:"targetAmount",nameKey:"name",cx:"50%",cy:"50%",outerRadius:80,label:({name:ie,percentage:Oe,fill:X})=>a.jsxs("text",{fill:X,fontSize:12,fontWeight:600,children:[ie.split(" ")[0],": ",Oe,"%"]}),labelLine:!1,isAnimationActive:!0,animationDuration:800})]})})}):a.jsxs("div",{className:"flex flex-col items-center justify-center flex-1 text-gray-400",children:[a.jsx(YI,{size:48,className:"mb-2 opacity-20"}),a.jsx("p",{className:"text-gray-500 font-medium text-center",children:"No targets data available"})]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col sm:flex-row items-stretch sm:items-center gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full sm:flex-1 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search targets...",value:x,onChange:ie=>b(ie.target.value),className:"w-full outline-none"})]}),a.jsx("div",{className:"w-full sm:w-64",children:a.jsxs("select",{value:j,onChange:ie=>y(ie.target.value),className:"w-full h-11 border border-gray-300 rounded-lg px-3 text-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[a.jsx("option",{value:"",children:"All users"}),At.map(ie=>a.jsx("option",{value:String(ie.id),children:`${ie.first_name||""} ${ie.last_name||""}`.trim()||"Unknown"},ie.id))]})})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full border border-gray-200 rounded-lg bg-white shadow-sm text-sm",children:[a.jsx("thead",{className:"bg-gray-100 font-semibold text-gray-600",children:a.jsxs("tr",{children:[re&&a.jsx("th",{className:"py-3 px-4 w-10",children:a.jsx("input",{type:"checkbox",className:"w-4 h-4 accent-blue-600",checked:ce.length>0&&(e?.toUpperCase()==="GROUP MANAGER"?ce.filter(ie=>Number(ie.created_by)===Number(r)).every(ie=>J.includes(ie.id))&&ce.filter(ie=>Number(ie.created_by)===Number(r)).length>0:ce.every(ie=>J.includes(ie.id))),onChange:Y})}),a.jsx("th",{className:"py-3 px-4 text-left",children:"User"}),a.jsx("th",{className:"py-3 px-4 text-left",children:"Target Amount"}),a.jsx("th",{className:"py-3 px-4 text-left",children:"Achieved Amount"}),a.jsx("th",{className:"py-3 px-4 text-left",children:"Achievement %"}),a.jsx("th",{className:"py-3 px-4 text-left",children:"Start Date"}),a.jsx("th",{className:"py-3 px-4 text-left",children:"End Date"}),["ADMIN","CEO"].includes(e?.toUpperCase())&&a.jsx("th",{className:"py-3 px-4 text-left",children:"Status"}),re&&a.jsx("th",{className:"py-3 px-4 text-center w-24",children:J.length>0?a.jsx("button",{onClick:de,className:e?.toUpperCase()==="GROUP MANAGER"?"text-orange-500 hover:text-orange-700 transition p-1 rounded-full hover:bg-orange-50":"text-red-500 hover:text-red-700 transition p-1 rounded-full hover:bg-red-50",title:e?.toUpperCase()==="GROUP MANAGER"?`Archive ${J.length} selected targets`:`Delete ${J.length} selected targets`,children:e?.toUpperCase()==="GROUP MANAGER"?a.jsx(Zt,{size:18}):a.jsx(_a,{size:18})}):""})]})}),a.jsx("tbody",{children:ce.length>0?ce.map(ie=>{const Oe=Number(ie.target_amount)>0?(Number(ie.achieved_amount)/Number(ie.target_amount)*100).toFixed(1):0,oe=!(e?.toUpperCase()==="GROUP MANAGER")||Number(ie.created_by)===Number(r);return a.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer border-b border-gray-200",children:[re&&a.jsx("td",{className:"py-3 px-4",onClick:Pe=>Pe.stopPropagation(),children:oe&&a.jsx("input",{type:"checkbox",className:"w-4 h-4 accent-blue-600",checked:J.includes(ie.id),onChange:()=>U(ie.id)})}),a.jsx("td",{className:"py-3 px-4 text-left font-medium",onClick:()=>W(ie),children:ie.user?`${ie.user.first_name} ${ie.user.last_name}`:"Unknown"}),a.jsxs("td",{className:"py-3 px-4 text-left",onClick:()=>W(ie),children:[i,Number(ie.target_amount).toLocaleString()]}),a.jsxs("td",{className:"py-3 px-4 text-left",onClick:()=>W(ie),children:[i,Number(ie.achieved_amount).toLocaleString()]}),a.jsx("td",{className:"py-3 px-4 text-left",onClick:()=>W(ie),children:a.jsxs("span",{className:`px-2 py-1 rounded text-white text-xs font-semibold ${Oe>=100?"bg-green-500":Oe>=75?"bg-blue-500":Oe>=50?"bg-yellow-500":"bg-red-500"}`,children:[Oe,"%"]})}),a.jsx("td",{className:"py-3 px-4 text-left",onClick:()=>W(ie),children:ie.start_date}),a.jsx("td",{className:"py-3 px-4 text-left",onClick:()=>W(ie),children:ie.end_date}),["ADMIN","CEO"].includes(e?.toUpperCase())&&a.jsx("td",{className:"py-3 px-4 text-left",onClick:()=>W(ie),children:a.jsx("span",{className:`px-2 py-1 rounded text-white text-xs font-semibold ${ie.status&&ie.status.toUpperCase()==="INACTIVE"?"bg-red-500":"bg-green-500"}`,children:ie.status&&ie.status.toUpperCase()==="INACTIVE"?"Inactive":"Active"})}),a.jsx("td",{})]},ie.id)}):a.jsx("tr",{children:a.jsx("td",{colSpan:["ADMIN","CEO"].includes(e?.toUpperCase())?"9":"8",className:"py-4 px-4 text-center text-gray-500",children:"No targets found"})})})]})}),a.jsx(ca,{className:"mt-4",totalItems:Ge.length,pageSize:S,currentPage:N,onPrev:()=>w(ie=>Math.max(ie-1,1)),onNext:()=>w(ie=>Math.min(ie+1,Be)),onPageSizeChange:ie=>{_(ie),w(1)},pageSizeOptions:[10,20,30,40,50],label:"targets"})]}),pe==="leaderboard"&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm flex flex-wrap gap-4 items-center",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Pt,{className:"text-gray-500"}),a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Filter by Period:"})]}),a.jsx("select",{value:Ne,onChange:ie=>ze(Number(ie.target.value)),className:"border border-gray-300 rounded-lg px-3 py-2 text-sm",children:[...Array(5)].map((ie,Oe)=>{const X=new Date().getFullYear()-Oe;return a.jsx("option",{value:X,children:X},X)})}),a.jsxs("select",{value:je,onChange:ie=>{ve(ie.target.value),K(1)},className:"border border-gray-300 rounded-lg px-3 py-2 text-sm",children:[a.jsx("option",{value:"",children:"All Periods"}),a.jsx("option",{value:"MONTHLY",children:"Monthly"}),a.jsx("option",{value:"QUARTERLY",children:"Quarterly"}),a.jsx("option",{value:"SEMIANNUAL",children:"Semi-Annual"}),a.jsx("option",{value:"ANNUAL",children:"Annual"})]}),je==="QUARTERLY"&&a.jsxs("select",{value:z,onChange:ie=>K(Number(ie.target.value)),className:"border border-gray-300 rounded-lg px-3 py-2 text-sm",children:[a.jsx("option",{value:1,children:"Q1"}),a.jsx("option",{value:2,children:"Q2"}),a.jsx("option",{value:3,children:"Q3"}),a.jsx("option",{value:4,children:"Q4"})]}),je==="SEMIANNUAL"&&a.jsxs("select",{value:z,onChange:ie=>K(Number(ie.target.value)),className:"border border-gray-300 rounded-lg px-3 py-2 text-sm",children:[a.jsx("option",{value:1,children:"H1 (Jan-Jun)"}),a.jsx("option",{value:2,children:"H2 (Jul-Dec)"})]}),je==="MONTHLY"&&a.jsx("select",{value:z,onChange:ie=>K(Number(ie.target.value)),className:"border border-gray-300 rounded-lg px-3 py-2 text-sm",children:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].map((ie,Oe)=>a.jsx("option",{value:Oe+1,children:ie},Oe))}),a.jsx("button",{onClick:tt,className:"bg-blue-600 text-white px-4 py-2 rounded-lg text-sm hover:bg-blue-700",children:"Apply Filter"})]}),at&&a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[a.jsx(Fc,{title:"Sales Reps",value:at.total_sales_reps,icon:a.jsx(Xa,{size:22}),color:"blue"}),a.jsx(Fc,{title:"Met Quota",value:at.above_target_count,icon:a.jsx(cd,{size:22}),color:"green"}),a.jsx(Fc,{title:"Below Quota",value:at.below_target_count,icon:a.jsx(c2,{size:22}),color:"orange"}),a.jsx(Fc,{title:"Team Achievement",value:`${at.overall_achievement}%`,icon:a.jsx(fr,{size:22}),color:"purple"})]}),Re?a.jsx(qt,{message:"Loading leaderboard..."}):xe?.entries?.length>0?a.jsxs("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden",children:[a.jsx("div",{className:"p-4 border-b border-gray-200",children:a.jsxs("h2",{className:"text-lg font-semibold flex items-center",children:[a.jsx(l2,{className:"mr-2 text-yellow-500"}),"Sales Leaderboard",xe.period_type!=="ALL"&&a.jsxs("span",{className:"ml-2 text-sm font-normal text-gray-500",children:["(",xe.period_type," ",xe.period_year,")"]})]})}),a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 text-left font-semibold text-gray-600",children:"Rank"}),a.jsx("th",{className:"py-3 px-4 text-left font-semibold text-gray-600",children:"Sales Rep"}),a.jsx("th",{className:"py-3 px-4 text-left font-semibold text-gray-600",children:"Role"}),a.jsx("th",{className:"py-3 px-4 text-right font-semibold text-gray-600",children:"Target"}),a.jsx("th",{className:"py-3 px-4 text-right font-semibold text-gray-600",children:"Achieved"}),a.jsx("th",{className:"py-3 px-4 text-right font-semibold text-gray-600",children:"Achievement"}),a.jsx("th",{className:"py-3 px-4 text-center font-semibold text-gray-600",children:"Actions"})]})}),a.jsx("tbody",{children:xe.entries.map(ie=>a.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`inline-flex items-center justify-center w-8 h-8 rounded-full font-bold text-sm ${ie.rank===1?"bg-yellow-100 text-yellow-700":ie.rank===2?"bg-gray-100 text-gray-700":ie.rank===3?"bg-orange-100 text-orange-700":"bg-gray-50 text-gray-600"}`,children:ie.rank})}),a.jsx("td",{className:"py-3 px-4 font-medium",children:ie.user_name}),a.jsx("td",{className:"py-3 px-4 text-gray-500",children:ie.role}),a.jsxs("td",{className:"py-3 px-4 text-right",children:[i,Number(ie.target_amount).toLocaleString()]}),a.jsxs("td",{className:"py-3 px-4 text-right",children:[i,Number(ie.achieved_amount).toLocaleString()]}),a.jsx("td",{className:"py-3 px-4 text-right",children:a.jsxs("span",{className:`px-2 py-1 rounded text-white text-xs font-semibold ${ie.achievement_percentage>=100?"bg-green-500":ie.achievement_percentage>=75?"bg-blue-500":ie.achievement_percentage>=50?"bg-yellow-500":"bg-red-500"}`,children:[ie.achievement_percentage,"%"]})}),a.jsx("td",{className:"py-3 px-4 text-center",children:a.jsx("button",{onClick:()=>{et(ie.user_id),Ie("history")},className:"text-blue-600 hover:text-blue-800 text-sm",children:"View History"})})]},ie.user_id))})]})]}):a.jsxs("div",{className:"bg-white rounded-xl p-8 text-center text-gray-500",children:[a.jsx(l2,{size:48,className:"mx-auto mb-4 opacity-20"}),a.jsx("p",{children:"No leaderboard data available for the selected period."})]}),at?.needs_attention?.length>0&&a.jsxs("div",{className:"bg-red-50 rounded-xl p-4 border border-red-200",children:[a.jsxs("h3",{className:"text-lg font-semibold text-red-800 mb-3 flex items-center",children:[a.jsx(c2,{className:"mr-2"}),"Needs Attention (Below 50%)"]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:at.needs_attention.map(ie=>a.jsxs("div",{className:"bg-white rounded-lg p-3 border border-red-100",children:[a.jsx("p",{className:"font-medium text-gray-800",children:ie.user_name}),a.jsx("p",{className:"text-sm text-gray-500",children:ie.role}),a.jsxs("div",{className:"mt-2 flex justify-between items-center",children:[a.jsxs("span",{className:"text-red-600 font-semibold",children:[ie.achievement_percentage,"%"]}),a.jsxs("span",{className:"text-xs text-gray-500",children:[i,Number(ie.remaining_amount).toLocaleString()," remaining"]})]})]},ie.user_id))})]})]}),pe==="history"&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm",children:[a.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Select Sales Rep to View History:"}),a.jsxs("div",{className:"flex gap-4 flex-wrap",children:[a.jsxs("select",{onChange:ie=>{const Oe=Number(ie.target.value);Oe&&et(Oe,ot)},className:"border border-gray-300 rounded-lg px-4 py-2 text-sm",value:He?.user_id||"",children:[a.jsx("option",{value:"",children:"-- Select User --"}),u.map(ie=>a.jsxs("option",{value:ie.id,children:[ie.first_name," ",ie.last_name]},ie.id))]}),a.jsxs("select",{className:"border border-gray-300 rounded-lg px-4 py-2 text-sm",value:ot,onChange:ie=>{const Oe=ie.target.value;rt(Oe),He?.user_id&&et(Number(He.user_id),Oe)},children:[a.jsx("option",{value:"",children:"All period types"}),a.jsx("option",{value:"MONTHLY",children:"Monthly"}),a.jsx("option",{value:"QUARTERLY",children:"Quarterly"}),a.jsx("option",{value:"SEMIANNUAL",children:"Semi-Annual"}),a.jsx("option",{value:"ANNUAL",children:"Annual"}),a.jsx("option",{value:"CUSTOM",children:"Custom"})]})]})]}),st?a.jsx(qt,{message:"Loading history..."}):He?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[a.jsx("h2",{className:"text-xl font-semibold mb-4",children:He.user_name}),He.current_period&&He.previous_period&&a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[a.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[a.jsx("p",{className:"text-sm text-blue-600 font-medium",children:"Current Period"}),a.jsx("p",{className:"text-xs text-gray-500",children:He.current_period.period_label}),a.jsxs("p",{className:"text-2xl font-bold text-blue-700 mt-2",children:[He.current_period.achievement_percentage,"%"]}),a.jsxs("p",{className:"text-sm text-gray-600",children:[i,Number(He.current_period.achieved_amount).toLocaleString()," / ",i,Number(He.current_period.target_amount).toLocaleString()]})]}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[a.jsx("p",{className:"text-sm text-gray-600 font-medium",children:"Previous Period"}),a.jsx("p",{className:"text-xs text-gray-500",children:He.previous_period.period_label}),a.jsxs("p",{className:"text-2xl font-bold text-gray-700 mt-2",children:[He.previous_period.achievement_percentage,"%"]}),a.jsxs("p",{className:"text-sm text-gray-600",children:[i,Number(He.previous_period.achieved_amount).toLocaleString()," / ",i,Number(He.previous_period.target_amount).toLocaleString()]})]}),a.jsxs("div",{className:`rounded-lg p-4 ${He.growth_percentage>=0?"bg-green-50":"bg-red-50"}`,children:[a.jsx("p",{className:"text-sm font-medium",style:{color:He.growth_percentage>=0?"#16a34a":"#dc2626"},children:"Growth"}),a.jsxs("p",{className:`text-2xl font-bold mt-2 flex items-center ${He.growth_percentage>=0?"text-green-700":"text-red-700"}`,children:[He.growth_percentage>=0?a.jsx(cd,{className:"mr-2"}):a.jsx(c2,{className:"mr-2"}),He.growth_percentage>=0?"+":"",He.growth_percentage?.toFixed(1),"%"]}),a.jsxs("p",{className:"text-sm text-gray-600",children:[He.growth_amount>=0?"+":"",i,Number(He.growth_amount||0).toLocaleString()]})]})]}),He.periods?.length>0&&a.jsx("div",{className:"h-64",children:a.jsx(G_,{width:"100%",height:"100%",children:a.jsxs(L$e,{data:[...He.periods].reverse(),children:[a.jsx(UE,{strokeDasharray:"3 3"}),a.jsx(VE,{dataKey:"period_label",tick:{fontSize:12}}),a.jsx(QE,{tick:{fontSize:12}}),a.jsx(aA,{formatter:(ie,Oe)=>[`${i}${Number(ie).toLocaleString()}`,Oe]}),a.jsx(qQ,{}),a.jsx(BE,{type:"monotone",dataKey:"target_amount",stroke:"#6366f1",name:"Target",strokeWidth:2,dot:{r:2},activeDot:{r:5}}),a.jsx(BE,{type:"monotone",dataKey:"achieved_amount",stroke:"#22c55e",name:"Achieved",strokeWidth:2,dot:{r:3},activeDot:{r:6}})]})})})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden",children:[a.jsx("div",{className:"p-4 border-b border-gray-200",children:a.jsx("h3",{className:"font-semibold",children:"All Historical Periods"})}),a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 text-left font-semibold text-gray-600",children:"Period"}),a.jsx("th",{className:"py-3 px-4 text-left font-semibold text-gray-600",children:"Date Range"}),a.jsx("th",{className:"py-3 px-4 text-right font-semibold text-gray-600",children:"Target"}),a.jsx("th",{className:"py-3 px-4 text-right font-semibold text-gray-600",children:"Achieved"}),a.jsx("th",{className:"py-3 px-4 text-right font-semibold text-gray-600",children:"Achievement"})]})}),a.jsx("tbody",{children:He.periods.map((ie,Oe)=>a.jsxs("tr",{className:"border-b border-gray-100",children:[a.jsx("td",{className:"py-3 px-4 font-medium",children:ie.period_label}),a.jsxs("td",{className:"py-3 px-4 text-gray-500",children:[ie.start_date," - ",ie.end_date]}),a.jsxs("td",{className:"py-3 px-4 text-right",children:[i,Number(ie.target_amount).toLocaleString()]}),a.jsxs("td",{className:"py-3 px-4 text-right",children:[i,Number(ie.achieved_amount).toLocaleString()]}),a.jsx("td",{className:"py-3 px-4 text-right",children:a.jsxs("span",{className:`px-2 py-1 rounded text-white text-xs font-semibold ${ie.achievement_percentage>=100?"bg-green-500":ie.achievement_percentage>=75?"bg-blue-500":ie.achievement_percentage>=50?"bg-yellow-500":"bg-red-500"}`,children:[ie.achievement_percentage,"%"]})})]},Oe))})]})]})]}):a.jsxs("div",{className:"bg-white rounded-xl p-8 text-center text-gray-500",children:[a.jsx(Vn,{size:48,className:"mx-auto mb-4 opacity-20"}),a.jsx("p",{children:"Select a sales rep to view their historical performance."})]})]})]}),$&&a.jsx(V$e,{target:$,currencySymbol:i,onClose:()=>W(null),onEdit:()=>te($),onArchive:()=>q($),canEdit:e?.toUpperCase()==="GROUP MANAGER"?$.created_by===null||Number($.created_by)===Number(r):ue,canArchive:e?.toUpperCase()==="GROUP MANAGER"?$.created_by===null||Number($.created_by)===Number(r):re,currentUserRole:e,currentUserId:r}),T&&ue&&a.jsx(Y$e,{formData:B,users:u,isEditing:A,isSubmitting:M,isSubmitted:ye,onChange:fe,onClose:()=>k(!1),onSubmit:Te,fiscalSettings:Fe}),Z&&a.jsx(Q$e,{...Z,loading:le,onConfirm:async()=>{we(!0),await Z.action(),we(!1),Q(null)},onCancel:()=>Q(null)})]})}function Fc({title:e,value:t,icon:n,color:s="blue"}){const r={blue:"bg-blue-100 text-blue-600",green:"bg-green-100 text-green-600",purple:"bg-purple-100 text-purple-600",orange:"bg-orange-100 text-orange-600"};return a.jsxs("div",{className:"flex items-center p-4 bg-white rounded-xl shadow-md border border-gray-200",children:[a.jsx("div",{className:`p-3 rounded-full ${r[s]} mr-4`,children:n}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:e}),a.jsx("p",{className:"text-xl font-bold",children:t})]})]})}function V$e({target:e,onClose:t,onEdit:n,onArchive:s,canEdit:r,canArchive:i,currencySymbol:o,currentUserRole:l,currentUserId:c}){const u=Number(e.target_amount)>0?(Number(e.achieved_amount)/Number(e.target_amount)*100).toFixed(1):0;return a.jsx("div",{className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center p-4",onClick:t,children:a.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-4xl max-h-[92vh] overflow-y-auto hide-scrollbar animate-scale-in font-inter relative",onClick:d=>d.stopPropagation(),children:[a.jsxs("div",{className:"bg-tertiary w-full flex items-center justify-between p-3 lg:p-4 rounded-t-xl",children:[a.jsx("h1",{className:"lg:text-3xl text-xl text-white font-semibold text-center w-full",children:"Target Details"}),a.jsx("button",{onClick:t,className:"text-gray-200 hover:text-white transition cursor-pointer",children:a.jsx(ea,{size:25})})]}),(r||i)&&a.jsxs("div",{className:"p-6 lg:p-4",children:[a.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between lg:flex-row lg:items-center lg:justify-between mt-3 gap-2 px-2 md:items-center lg:gap-4 md:mx-7 lg:mx-7",children:[a.jsx("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:a.jsx("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-800",children:e.user&&`${e.user.first_name} ${e.user.last_name}`})}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[r&&a.jsxs("button",{className:"inline-flex items-center justify-center w-full sm:w-auto bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 transition text-sm focus:outline-none focus:ring-2 focus:ring-blue-400 cursor-pointer",onClick:n,children:[a.jsx(gn,{className:"mr-2"}),"Edit"]}),i&&a.jsx("button",{className:`inline-flex items-center justify-center w-full sm:w-auto px-4 py-2 rounded-md text-sm text-white transition focus:outline-none cursor-pointer ${l?.toUpperCase()==="GROUP MANAGER"?"bg-orange-500 hover:bg-orange-600 focus:ring-2 focus:ring-orange-400":"bg-red-500 hover:bg-red-600 focus:ring-2 focus:ring-red-400"}`,onClick:s,children:l?.toUpperCase()==="GROUP MANAGER"?a.jsxs(a.Fragment,{children:[a.jsx(Zt,{className:"mr-2"}),"Archive"]}):a.jsxs(a.Fragment,{children:[a.jsx(_a,{className:"mr-2"}),"Delete"]})})]})]}),a.jsx("div",{className:"border-b border-gray-200 my-5"})]}),a.jsxs("div",{className:"p-4 lg:p-6",children:[a.jsx("div",{className:"flex w-full bg-gray-600 text-white overflow-x-auto",children:a.jsx("button",{className:"flex-1 min-w-[90px] px-4 py-2 lg:text-lg text-sm font-medium text-center text-white",children:"Overview"})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm sm:p-6 lg:p-5 border border-gray-200 text-sm text-gray-700",children:a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-gray-900",children:"Sales Person:"}),a.jsx("p",{children:e.user?`${e.user.first_name} ${e.user.last_name}`:"Unknown"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-gray-900",children:"Target Amount:"}),a.jsxs("p",{className:"text-green-600 font-semibold",children:[o,Number(e.target_amount).toLocaleString()]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-gray-900",children:"Achieved Amount:"}),a.jsxs("p",{className:"text-blue-600 font-semibold",children:[o,Number(e.achieved_amount).toLocaleString()]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-gray-900",children:"Achievement Rate:"}),a.jsxs("p",{className:`font-semibold ${u>=100?"text-green-600":u>=75?"text-blue-600":u>=50?"text-yellow-600":"text-red-600"}`,children:[u,"%"]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-gray-900",children:"Start Date:"}),a.jsx("p",{children:e.start_date})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-gray-900",children:"End Date:"}),a.jsx("p",{children:e.end_date})]})]})})]})]})})}function Y$e({formData:e,users:t,isEditing:n,isSubmitting:s,onChange:r,onClose:i,onSubmit:o,fiscalSettings:l,isSubmitted:c}){const u=l?.fiscal_start_month||1,d=e.use_annual_mode!==!1&&e.period_type!=="CUSTOM"&&e.period_type!==""&&!n,h=c&&d&&(!e.annual_amount||Number(e.annual_amount)<=0),p=c&&!d&&(!e.target_amount||Number(e.target_amount)<=0),x=c&&!e.period_type,b=n||e.period_type==="CUSTOM",j=_=>{const T=_.getFullYear(),k=String(_.getMonth()+1).padStart(2,"0"),A=String(_.getDate()).padStart(2,"0");return`${T}-${k}-${A}`},y=(_,T,k)=>{let A,E;if(_==="MONTHLY")A=new Date(T,k-1,1),E=new Date(T,k,0);else if(_==="QUARTERLY"){const M=(k-1)*3,F=(u-1+M)%12;let D=T;u>1&&(F>=u-1?D=T-1:D=T),A=new Date(D,F,1);const P=(F+2)%12,B=F+2>=12?D+1:D;E=new Date(B,P+1,0)}else if(_==="SEMIANNUAL"){const M=(k-1)*6,F=(u-1+M)%12;let D=T;u>1&&(F>=u-1?D=T-1:D=T),A=new Date(D,F,1);const P=(F+5)%12,B=F+5>=12?D+1:D;E=new Date(B,P+1,0)}else if(_==="ANNUAL"){const M=u-1;let F=u>1?T-1:T;A=new Date(F,M,1);const D=(u-2+12)%12;E=new Date(F+1,D+1,0)}return{startDate:A,endDate:E}},N=_=>{const T=_.target.value;if(r({target:{name:"period_type",value:T}}),e.use_annual_mode!==!1&&T!=="CUSTOM"&&T!==""&&!n){e.start_date||r({target:{name:"start_date",value:new Date().toISOString().split("T")[0]}});return}if(T!=="CUSTOM"){const A=e.period_year||new Date().getFullYear(),E=e.period_number||1,{startDate:M,endDate:F}=y(T,A,E);M&&F&&(r({target:{name:"start_date",value:j(M)}}),r({target:{name:"end_date",value:j(F)}}))}},w=_=>{const T=Number(_.target.value);r({target:{name:"period_number",value:T}});const k=e.period_year||new Date().getFullYear(),A=e.period_type;if(A!=="CUSTOM"&&!d){const{startDate:E,endDate:M}=y(A,k,T);E&&M&&(r({target:{name:"start_date",value:j(E)}}),r({target:{name:"end_date",value:j(M)}}))}},S=_=>{const T=Number(_.target.value);r({target:{name:"period_year",value:T}});const k=e.period_type,A=e.period_number||1;if(k!=="CUSTOM"&&!d){const{startDate:E,endDate:M}=y(k,T,A);E&&M&&(r({target:{name:"start_date",value:j(E)}}),r({target:{name:"end_date",value:j(M)}}))}};return f.useEffect(()=>{if(!d&&e.period_type!=="CUSTOM"&&!e.start_date){const _=e.period_year||new Date().getFullYear(),T=e.period_number||1,{startDate:k,endDate:A}=y(e.period_type,_,T);k&&A&&(r({target:{name:"start_date",value:j(k)}}),r({target:{name:"end_date",value:j(A)}}))}},[l]),a.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-2xl p-8 relative overflow-y-auto max-h-[90vh] hide-scrollbar",children:[a.jsx("button",{onClick:i,className:"absolute top-5 right-5",children:a.jsx(ea,{size:24})}),a.jsx("h2",{className:"text-2xl font-semibold text-center mb-6",children:n?"Edit Target":"Add New Target"}),a.jsxs("form",{onSubmit:o,noValidate:!0,className:"grid gap-4 text-base",children:[a.jsxs("div",{className:"flex flex-col gap-1 relative",children:[a.jsxs("label",{className:"text-sm font-medium text-gray-700",children:["Assign User ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx(W$e,{name:"user_id",items:t,value:e.user_id,onChange:r,getLabel:_=>`${_.first_name} ${_.last_name}`,placeholder:"Search user...",required:!0,isSubmitted:c})]}),a.jsxs("div",{className:"flex flex-col gap-1",children:[a.jsxs("label",{className:"text-sm font-medium text-gray-700 text-left",children:["Period Type ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("select",{name:"period_type",value:e.period_type,onChange:N,isSubmitted:c,className:`w-full border rounded-lg p-2 text-gray-700 focus:outline-none focus:ring-1
                ${x?"border-red-500 focus:ring-red-400 focus:border-red-400":"border-gray-300 focus:ring-blue-400 focus:border-blue-400"}`,children:[a.jsx("option",{value:"",children:"-- Choose Period Type --"}),EZ.map(_=>a.jsx("option",{value:_.value,children:_.label},_.value))]})]}),e.period_type&&e.period_type!=="CUSTOM"&&e.period_type!=="ANNUAL"&&a.jsxs("div",{className:"flex flex-col gap-1",children:[a.jsx("label",{className:"text-sm font-medium text-gray-700 text-left",children:e.period_type==="MONTHLY"?"Month":e.period_type==="QUARTERLY"?"Quarter":"Half"}),a.jsxs("select",{name:"period_number",value:e.period_number,onChange:w,required:!0,className:"w-full border text-gray-500 border-gray-300 rounded-lg p-2 focus:outline-none focus:ring-1 focus:ring-blue-400 focus:border-blue-400",children:[e.period_type==="MONTHLY"&&["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].map((_,T)=>a.jsx("option",{value:T+1,children:_},T)),e.period_type==="QUARTERLY"&&[1,2,3,4].map(_=>a.jsxs("option",{value:_,children:["Q",_," ",l?.quarters?.[`Q${_}`]?`(${l.quarters[`Q${_}`]})`:""]},_)),e.period_type==="SEMIANNUAL"&&[1,2].map(_=>a.jsxs("option",{value:_,children:["H",_," ",l?.halves?.[`H${_}`]?`(${l.halves[`H${_}`]})`:`(${_===1?"Jan-Jun":"Jul-Dec"})`]},_))]})]}),e.period_type&&e.period_type!=="CUSTOM"&&a.jsxs("div",{className:"flex flex-col gap-1",children:[a.jsx("label",{className:"text-sm font-medium text-gray-700 text-left",children:u!==1?"Fiscal Year":"Year"}),a.jsx("select",{name:"period_year",value:e.period_year,onChange:S,className:"w-full border text-gray-500 border-gray-300 rounded-lg p-2 focus:outline-none focus:ring-1 focus:ring-blue-400 focus:border-blue-400",children:[...Array(5)].map((_,T)=>{const k=new Date().getFullYear()+1-T;return a.jsx("option",{value:k,children:u!==1?`FY${k}`:k},k)})})]}),d&&a.jsxs("div",{className:"flex flex-col gap-1",children:[a.jsx("label",{className:"text-sm font-medium text-gray-700 text-left",children:"Start Date"}),a.jsx("div",{className:"flex justify-center w-full",children:a.jsx("input",{type:"date",name:"start_date",value:e.start_date,onChange:r,className:"w-full max-w-md border text-gray-500 border-gray-300 rounded-lg p-1 focus:outline-none focus:ring-1 focus:ring-blue-400 focus:border-blue-400"})}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Used to prorate the first period when enabled."})]}),d&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex flex-col gap-1",children:[a.jsxs("label",{className:"text-sm font-medium text-gray-700 text-left",children:["Annual Target Amount ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("div",{className:"flex justify-center w-full",children:a.jsx("input",{type:"number",name:"annual_amount",placeholder:"e.g., 12000000 for 12M",value:e.annual_amount,onChange:r,required:!0,className:`w-full max-w-md border rounded-lg p-2 text-gray-700 focus:outline-none focus:ring-1
                      ${h?"border-red-500 focus:ring-red-400 focus:border-red-400":"border-gray-300 focus:ring-blue-400 focus:border-blue-400"}`})}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Enter the full year target. It will be automatically divided based on the period type."})]}),e.annual_amount&&Number(e.annual_amount)>0&&a.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:[a.jsx("p",{className:"text-sm font-medium text-blue-800 mb-2",children:"Period Breakdown:"}),a.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[a.jsx("div",{className:"text-gray-600",children:"Annual:"}),a.jsx("div",{className:"text-right font-semibold text-gray-900",children:Number(e.annual_amount).toLocaleString()}),e.period_type==="MONTHLY"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"text-gray-600",children:["Monthly (",e.period_type,"):"]}),a.jsx("div",{className:"text-right font-semibold text-green-600",children:(Number(e.annual_amount)/12).toLocaleString(void 0,{maximumFractionDigits:2})})]}),e.period_type==="QUARTERLY"&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"text-gray-600",children:"Quarterly:"}),a.jsx("div",{className:"text-right font-semibold text-green-600",children:(Number(e.annual_amount)/4).toLocaleString(void 0,{maximumFractionDigits:2})})]}),e.period_type==="SEMIANNUAL"&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"text-gray-600",children:"Semi-Annual:"}),a.jsx("div",{className:"text-right font-semibold text-green-600",children:(Number(e.annual_amount)/2).toLocaleString(void 0,{maximumFractionDigits:2})})]}),e.period_type==="ANNUAL"&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"text-gray-600",children:"Full Year:"}),a.jsx("div",{className:"text-right font-semibold text-green-600",children:Number(e.annual_amount).toLocaleString(void 0,{maximumFractionDigits:2})})]})]}),a.jsx("p",{className:"text-xs text-blue-600 mt-2",children:"* First period may be prorated if starting mid-period"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",id:"prorate_first_period",name:"prorate_first_period",checked:e.prorate_first_period!==!1,onChange:_=>r({target:{name:"prorate_first_period",value:_.target.checked}}),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),a.jsx("label",{htmlFor:"prorate_first_period",className:"text-sm text-gray-700",children:"Prorate first period based on remaining days"})]})]}),b&&a.jsxs("div",{className:"flex flex-col gap-1",children:[a.jsxs("label",{className:"text-sm font-medium text-gray-700 text-left",children:["Target Amount ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("div",{className:"flex justify-center w-full",children:a.jsx("input",{type:"number",name:"target_amount",placeholder:"0.00",value:e.target_amount,onChange:r,required:!0,className:`w-full max-w-md border rounded-lg p-2 text-gray-700 focus:outline-none focus:ring-1
                    ${p?"border-red-500 focus:ring-red-400 focus:border-red-400":"border-gray-300 focus:ring-blue-400 focus:border-blue-400"}`})})]}),b&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex flex-col gap-1",children:[a.jsx("label",{className:"text-sm font-medium text-gray-700 text-left",children:"Start Date"}),a.jsx("div",{className:"flex justify-center w-full",children:a.jsx("input",{type:"date",name:"start_date",value:e.start_date,onChange:r,className:"w-full max-w-md border text-gray-500 border-gray-300 rounded-lg p-1 focus:outline-none focus:ring-1 focus:ring-blue-400 focus:border-blue-400"})})]}),a.jsxs("div",{className:"flex flex-col gap-1",children:[a.jsx("label",{className:"text-sm font-medium text-gray-700 text-left",children:"End Date"}),a.jsx("div",{className:"flex justify-center w-full",children:a.jsx("input",{type:"date",name:"end_date",value:e.end_date,onChange:r,className:"w-full max-w-md border text-gray-500 border-gray-300 rounded-lg p-1 focus:outline-none focus:ring-1 focus:ring-blue-400 focus:border-blue-400"})})]})]}),a.jsxs("div",{className:"flex justify-end gap-3 mt-4",children:[a.jsx("button",{type:"button",onClick:i,className:"bg-red-400 text-white px-5 py-2 rounded-lg",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:s,className:"bg-tertiary text-white px-5 py-2 rounded-lg hover:bg-tertiary/90 disabled:opacity-50",children:s?"Saving...":n?"Update Target":"Create Targets"})]})]})]})})}function Q$e({title:e,message:t,confirmLabel:n,cancelLabel:s,variant:r,loading:i,onConfirm:o,onCancel:l}){return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:e}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:t}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{onClick:l,disabled:i,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",children:s}),a.jsx("button",{onClick:o,disabled:i,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${r==="archive"?"bg-orange-500 hover:bg-orange-600 border border-orange-400":r==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":"bg-tertiary hover:bg-tertiary/90 border border-tertiary"}`,children:i?"Processing...":n})]})]})})}function K$e(){const{userRole:e}=Ks();return a.jsx(N1,{currentUserRole:e,currentUserId:null})}const U7=[{value:"Product",label:"Product"},{value:"Service",label:"Service"}],xA={id:null,item_type:"Product",name:"",description:"",sku:"",variant:"",unit:"pcs",quantity:1,unit_price:0,discount_percent:0,discount_amount:0,line_total:0,sort_order:0},vb=e=>{const t=parseFloat(e.quantity)||0,n=parseFloat(e.unit_price)||0,s=parseFloat(e.discount_percent)||0,r=t*n,i=r*(s/100),o=r-i;return{discount_amount:i,line_total:o}},Uc=(e,t="")=>{const n=parseFloat(e)||0;return`${t}${n.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`};function wd({items:e=[],onChange:t,currencySymbol:n="",readOnly:s=!1,taxRate:r=0,discountType:i=null,discountValue:o=0,onTotalsChange:l}){const[c,u]=f.useState(null),[d,h]=f.useState(null),[p,x]=f.useState(!1),[b,j]=f.useState({...xA});f.useEffect(()=>{if(l){const E=e.reduce((B,G)=>B+(parseFloat(G.line_total)||0),0);let M=0;i==="percentage"&&o?M=E*(parseFloat(o)/100):i==="fixed"&&o&&(M=parseFloat(o));const F=E-M,D=F*(parseFloat(r)/100),P=F+D;l({subtotal:E,discount_amount:M,tax_amount:D,total_amount:P})}},[e,r,i,o,l]);const y=f.useCallback(()=>{if(!b.name.trim()){V.error("Item name is required");return}if(parseFloat(b.unit_price)<=0){V.error("Unit price must be greater than 0");return}if(parseFloat(b.quantity)<=0){V.error("Quantity must be greater than 0");return}const E=vb(b),M={...b,...E,sort_order:e.length};t([...e,M]),j({...xA}),x(!1),V.success("Item added")},[b,e,t]),N=E=>{if(!d){V.error("No item being edited");return}if(!d.name.trim()){V.error("Item name is required");return}if(parseFloat(d.unit_price)<=0){V.error("Unit price must be greater than 0");return}if(parseFloat(d.quantity)<=0){V.error("Quantity must be greater than 0");return}const M=vb(d),F={...d,...M},D=e.map((P,B)=>B===E?F:P);t(D),u(null),h(null),V.success("Item updated")},w=f.useCallback(E=>{const M=e.filter((F,D)=>D!==E);M.forEach((F,D)=>{F.sort_order=D}),t(M),V.success("Item removed")},[e,t]),S=f.useCallback((E,M)=>{const F=M==="up"?E-1:E+1;if(F<0||F>=e.length)return;const D=[...e];[D[E],D[F]]=[D[F],D[E]],D.forEach((P,B)=>{P.sort_order=B}),t(D)},[e,t]),_=E=>{u(E),h({...e[E]})},T=()=>{u(null),h(null)},k=e.reduce((E,M)=>E+(parseFloat(M.line_total)||0),0),A=(E,M)=>c===M&&!s?a.jsxs("tr",{className:"bg-blue-50",children:[a.jsx("td",{className:"px-3 py-2",children:a.jsx("select",{value:d.item_type,onChange:D=>h(P=>({...P,item_type:D.target.value})),className:"w-full px-2 py-1 border rounded text-sm",children:U7.map(D=>a.jsx("option",{value:D.value,children:D.label},D.value))})}),a.jsxs("td",{className:"px-3 py-2",children:[a.jsx("input",{type:"text",value:d.name,onChange:D=>h(P=>({...P,name:D.target.value})),className:"w-full px-2 py-1 border rounded text-sm",placeholder:"Name *"}),a.jsx("input",{type:"text",value:d.variant||"",onChange:D=>h(P=>({...P,variant:D.target.value})),className:"w-full px-2 py-1 border rounded text-sm mt-1",placeholder:"Variant (optional)"})]}),a.jsx("td",{className:"px-3 py-2",children:a.jsx("input",{type:"text",value:d.sku||"",onChange:D=>h(P=>({...P,sku:D.target.value})),className:"w-full px-2 py-1 border rounded text-sm",placeholder:"SKU"})}),a.jsx("td",{className:"px-3 py-2",children:a.jsxs("div",{className:"flex gap-1",children:[a.jsx("input",{type:"number",value:d.quantity,onChange:D=>h(P=>({...P,quantity:D.target.value})),className:"w-16 px-2 py-1 border rounded text-sm text-right",min:"0.01",step:"0.01"}),a.jsx("input",{type:"text",value:d.unit||"",onChange:D=>h(P=>({...P,unit:D.target.value})),className:"w-16 px-2 py-1 border rounded text-sm",placeholder:"Unit"})]})}),a.jsx("td",{className:"px-3 py-2",children:a.jsx("input",{type:"number",value:d.unit_price,onChange:D=>h(P=>({...P,unit_price:D.target.value})),className:"w-24 px-2 py-1 border rounded text-sm text-right",min:"0",step:"0.01"})}),a.jsx("td",{className:"px-3 py-2",children:a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("input",{type:"number",value:d.discount_percent||0,onChange:D=>h(P=>({...P,discount_percent:D.target.value})),className:"w-16 px-2 py-1 border rounded text-sm text-right",min:"0",max:"100",step:"0.01"}),a.jsx("span",{className:"text-sm text-gray-500",children:"%"})]})}),a.jsx("td",{className:"px-3 py-2 text-right font-medium",children:Uc(vb(d).line_total,n)}),a.jsx("td",{className:"px-3 py-2",children:a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{type:"button",onClick:()=>N(M),className:"p-1 text-green-600 hover:bg-green-100 rounded",title:"Save",children:a.jsx(AL,{size:16})}),a.jsx("button",{type:"button",onClick:T,className:"p-1 text-gray-600 hover:bg-gray-100 rounded",title:"Cancel",children:a.jsx(ea,{size:16})})]})})]},E.id||`edit-${M}`):a.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[a.jsx("td",{className:"px-3 py-2",children:a.jsx("span",{className:`inline-block px-2 py-0.5 rounded text-xs font-medium ${E.item_type==="Service"?"bg-purple-100 text-purple-700":"bg-blue-100 text-blue-700"}`,children:E.item_type})}),a.jsxs("td",{className:"px-3 py-2",children:[a.jsx("div",{className:"font-medium text-gray-900",children:E.name}),E.variant&&a.jsx("div",{className:"text-xs text-gray-500",children:E.variant}),E.description&&a.jsx("div",{className:"text-xs text-gray-400 mt-0.5",children:E.description})]}),a.jsx("td",{className:"px-3 py-2 text-gray-600 text-sm",children:E.sku||"-"}),a.jsxs("td",{className:"px-3 py-2 text-center",children:[a.jsx("span",{className:"font-medium",children:parseFloat(E.quantity).toLocaleString()}),E.unit&&a.jsx("span",{className:"text-gray-500 text-sm ml-1",children:E.unit})]}),a.jsx("td",{className:"px-3 py-2 text-right",children:Uc(E.unit_price,n)}),a.jsx("td",{className:"px-3 py-2 text-right text-sm",children:parseFloat(E.discount_percent)>0?a.jsxs("span",{className:"text-red-600",children:["-",parseFloat(E.discount_percent).toFixed(1),"%"]}):a.jsx("span",{className:"text-gray-400",children:"-"})}),a.jsx("td",{className:"px-3 py-2 text-right font-medium",children:Uc(E.line_total,n)}),!s&&a.jsx("td",{className:"px-3 py-2",children:a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{type:"button",onClick:()=>S(M,"up"),disabled:M===0,className:"p-1 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded disabled:opacity-30",title:"Move up",children:a.jsx(roe,{size:14})}),a.jsx("button",{type:"button",onClick:()=>S(M,"down"),disabled:M===e.length-1,className:"p-1 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded disabled:opacity-30",title:"Move down",children:a.jsx(Dt,{size:14})}),a.jsx("button",{type:"button",onClick:()=>_(M),className:"p-1 text-blue-600 hover:bg-blue-100 rounded",title:"Edit",children:a.jsx(hn,{size:14})}),a.jsx("button",{type:"button",onClick:()=>w(M),className:"p-1 text-red-600 hover:bg-red-100 rounded",title:"Delete",children:a.jsx(_a,{size:14})})]})})]},E.id||`row-${M}`);return a.jsxs("div",{className:"border border-gray-300 rounded-lg overflow-hidden bg-white",children:[a.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gray-50 border border-gray-300",children:[a.jsxs("h3",{className:"font-semibold text-gray-800",children:["Line Items ",e.length>0&&a.jsxs("span",{className:"text-gray-500 font-normal",children:["(",e.length,")"]})]}),!s&&!p&&a.jsxs("button",{onClick:()=>x(!0),className:"flex items-center gap-1.5 px-3 py-1.5 bg-blue-600 text-white text-sm rounded hover:bg-blue-700 transition",children:[a.jsx(aa,{size:14}),"Add Item"]})]}),p&&!s&&a.jsxs("div",{className:"p-4 bg-blue-50 border border-gray-300",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Type"}),a.jsx("select",{value:b.item_type,onChange:E=>j({...b,item_type:E.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-3 focus:ring-blue-500 focus:border-blue-500",children:U7.map(E=>a.jsx("option",{value:E.value,children:E.label},E.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Name *"}),a.jsx("input",{type:"text",value:b.name,onChange:E=>j({...b,name:E.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-3 focus:ring-blue-500 focus:border-blue-500",placeholder:"Product/Service name"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"SKU"}),a.jsx("input",{type:"text",value:b.sku,onChange:E=>j({...b,sku:E.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-3 focus:ring-blue-500 focus:border-blue-500",placeholder:"Item code"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Variant"}),a.jsx("input",{type:"text",value:b.variant,onChange:E=>j({...b,variant:E.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-3 focus:ring-blue-500 focus:border-blue-500",placeholder:"Size, color, etc."})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Quantity *"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("input",{type:"number",value:b.quantity,onChange:E=>j({...b,quantity:E.target.value}),className:"w-20 px-3 py-2 border border-gray-300 rounded-lg text-sm text-right focus:ring-3 focus:ring-blue-500 focus:border-blue-500",min:"0.01",step:"0.01"}),a.jsx("input",{type:"text",value:b.unit,onChange:E=>j({...b,unit:E.target.value}),className:"w-20 px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-3 focus:ring-blue-500 focus:border-blue-500",placeholder:"Unit"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Unit Price *"}),a.jsxs("div",{className:"relative",children:[a.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500",children:n}),a.jsx("input",{type:"number",value:b.unit_price,onChange:E=>j({...b,unit_price:E.target.value}),className:"w-full pl-8 pr-3 py-2 border border-gray-300 rounded-lg text-sm text-right focus:ring-3 focus:ring-blue-500 focus:border-blue-500",min:"0",step:"0.01"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Discount %"}),a.jsx("input",{type:"number",value:b.discount_percent,onChange:E=>j({...b,discount_percent:E.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm text-right focus:ring-3 focus:ring-blue-500 focus:border-blue-500",min:"0",max:"100",step:"0.01"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Line Total"}),a.jsx("div",{className:"px-3 py-2 bg-gray-100 rounded-lg text-sm text-right font-medium",children:Uc(vb(b).line_total,n)})]})]}),a.jsxs("div",{className:"mt-3",children:[a.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Description (optional)"}),a.jsx("textarea",{value:b.description,onChange:E=>j({...b,description:E.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-3 focus:ring-blue-500 focus:border-blue-500",rows:2,placeholder:"Additional details about this item..."})]}),a.jsxs("div",{className:"flex justify-end gap-2 mt-3",children:[a.jsx("button",{onClick:()=>{x(!1),j({...xA})},className:"px-4 py-2 text-gray-600 bg-gray-100 rounded-lg hover:bg-gray-200 transition text-sm",children:"Cancel"}),a.jsx("button",{onClick:y,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition text-sm",children:"Add Item"})]})]}),e.length>0?a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50 border-b",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-600 w-20",children:"Type"}),a.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-600",children:"Item"}),a.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-600 w-24",children:"SKU"}),a.jsx("th",{className:"px-3 py-2 text-center font-medium text-gray-600 w-28",children:"Qty"}),a.jsx("th",{className:"px-3 py-2 text-right font-medium text-gray-600 w-28",children:"Price"}),a.jsx("th",{className:"px-3 py-2 text-right font-medium text-gray-600 w-20",children:"Disc."}),a.jsx("th",{className:"px-3 py-2 text-right font-medium text-gray-600 w-28",children:"Total"}),!s&&a.jsx("th",{className:"px-3 py-2 w-28"})]})}),a.jsx("tbody",{children:e.map((E,M)=>A(E,M))})]})}):a.jsxs("div",{className:"p-8 text-center text-gray-500",children:[a.jsx("p",{children:"No items added yet."}),!s&&a.jsx("button",{onClick:()=>x(!0),className:"mt-2 text-blue-600 hover:underline text-sm",children:"+ Add your first item"})]}),e.length>0&&a.jsx("div",{className:"border-t bg-gray-50 px-4 py-3",children:a.jsx("div",{className:"flex justify-end",children:a.jsxs("div",{className:"w-64 space-y-1",children:[a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-gray-600",children:"Subtotal:"}),a.jsx("span",{className:"font-medium",children:Uc(k,n)})]}),parseFloat(o)>0&&a.jsxs("div",{className:"flex justify-between text-sm text-red-600",children:[a.jsxs("span",{children:["Discount (",i==="percentage"?`${o}%`:"Fixed","):"]}),a.jsxs("span",{children:["-",Uc(i==="percentage"?k*(parseFloat(o)/100):parseFloat(o),n)]})]}),parseFloat(r)>0&&a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsxs("span",{className:"text-gray-600",children:["Tax (",r,"%):"]}),a.jsx("span",{children:Uc((k-(i==="percentage"?k*(parseFloat(o)/100):parseFloat(o)||0))*(parseFloat(r)/100),n)})]}),a.jsxs("div",{className:"flex justify-between text-base font-semibold pt-1 border-t",children:[a.jsx("span",{children:"Total:"}),a.jsx("span",{children:Uc((()=>{let E=0;i==="percentage"&&o?E=k*(parseFloat(o)/100):i==="fixed"&&o&&(E=parseFloat(o));const M=k-E,F=M*(parseFloat(r)/100);return M+F})(),n)})]})]})})})]})}const yA=[{value:"Draft",label:"Draft"},{value:"Presented",label:"Presented"},{value:"Accepted",label:"Accepted"},{value:"Rejected",label:"Rejected"}],bA={deal_id:"",account_id:"",contact_id:"",total_amount:"",presented_date:"",validity_days:"",status:"Draft",assigned_to:"",notes:"",subtotal:0,tax_rate:0,tax_amount:0,discount_type:"",discount_value:0,discount_amount:0,currency:"PHP",items:[]},$i=e=>{if(!e)return"Draft";const t=e.toString().trim().toLowerCase();return{draft:"Draft",presented:"Presented",accepted:"Accepted",rejected:"Rejected",inactive:"Inactive"}[t]||"Draft"},vA=e=>e?e.toString().toLowerCase().replace(/\b\w/g,t=>t.toUpperCase()):"--",X$e=e=>{switch($i(e).toLowerCase()){case"draft":return"bg-gray-100 text-gray-700";case"presented":return"bg-yellow-100 text-yellow-700";case"accepted":return"bg-green-100 text-green-700";case"rejected":return"bg-red-100 text-red-700";case"inactive":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-700"}},Z$e=e=>{switch($i(e).toLowerCase()){case"draft":return"bg-gray-600 text-white";case"presented":return"bg-yellow-600 text-white";case"accepted":return"bg-green-600 text-white";case"rejected":return"bg-red-600 text-white";case"inactive":return"bg-red-600 text-white";default:return"bg-gray-600 text-white"}},wb=e=>e?new Date(e).toLocaleString("en-US",{month:"2-digit",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).replace(",",""):"",Dg=e=>e?new Date(e).toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"numeric"}):"",J$e=e=>{if(!e)return"";if(typeof e=="string"&&e.match(/^\d{4}-\d{2}-\d{2}$/))return e;try{const t=new Date(e);if(isNaN(t.getTime()))return"";const n=t.getFullYear(),s=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0");return`${n}-${s}-${r}`}catch{return""}},wA=(e,t)=>{if(!e||t==null||t==="")return"";const n=Number(t);if(Number.isNaN(n))return"";const s=new Date(e);return isNaN(s.getTime())?"":(s.setDate(s.getDate()+n),s.toISOString().slice(0,10))},B7=e=>{if(!e)return"";const t=String(e).split("-");return t.length===3?`${t[0]}-${t[2]}`:String(e)},jb=e=>{if(!e)return"";const t=String(e).split("-");return t.length===3?`${t[0]}-${t[2]}`:String(e)},Gw=e=>{if(!e)return null;if(typeof e=="number")return e;if(typeof e=="string"&&e.trim()&&!Number.isNaN(Number(e)))return Number(e);if(typeof e=="object"){if(e.id&&!Number.isNaN(Number(e.id)))return Number(e.id);if(e.user?.id&&!Number.isNaN(Number(e.user.id)))return Number(e.user.id);if(e.data?.id&&!Number.isNaN(Number(e.data.id)))return Number(e.data.id);if(e.profile?.id&&!Number.isNaN(Number(e.profile.id)))return Number(e.profile.id)}return null},e6e=()=>{const e=["user","currentUser","userData","authUser","profile"];for(const s of e){const r=localStorage.getItem(s);if(r)try{const i=JSON.parse(r),o=Gw(i);if(o)return o}catch{}}const t=localStorage.getItem("user_id"),n=Gw(t);return n||null},t6e=e=>{if(!e)return"";const n=[e.account_id,e.accountId,e.account?.id,e.account?.account_id,e.account?.accountId].find(s=>s!=null&&String(s).trim()!=="");return n?String(n):""},a6e=e=>{if(!e)return"";const n=[e.contact_id,e.contactId,e.contact?.id,e.primary_contact_id,e.primaryContactId,e.primary_contact?.id,e.primaryContact?.id].find(s=>s!=null&&String(s).trim()!=="");return n?String(n):""};function n6e(){const e=Et(),t=ta(),{user:n}=Gt(),s=n?.company?.currency||"";f.useEffect(()=>{document.title="Quotes | Sari-Sari CRM"},[]);const[r,i]=f.useState([]),[o,l]=f.useState(!1),[c,u]=f.useState([]),[d,h]=f.useState([]),[p,x]=f.useState([]),[b,j]=f.useState([]),[y,N]=f.useState(null),[w,S]=f.useState(null),[_,T]=f.useState(!1),[k,A]=f.useState(!1),[E,M]=f.useState(!1),[F,D]=f.useState(null),[P,B]=f.useState(!1),[G,$]=f.useState(!1),[W,Z]=f.useState(null),[Q,le]=f.useState(bA),[we,J]=f.useState(""),[se,ye]=f.useState("Filter by Status"),[Ce,ge]=f.useState(null),be=f.useCallback(async()=>{if(w)try{$(!0);const I=(await ne.get("/company/invoice-info"))?.data;e(`/admin/quotes/${encodeURIComponent(w.id)}/print`,{state:{quote:w,companyInfo:I}})}catch(_e){const I=_e?.response?.data?.detail||_e?.message||"Failed to open print page.";V.error(I)}finally{$(!1)}},[w,s]),[me,Ae]=f.useState(1),[pe,Ie]=f.useState(10),[xe,he]=f.useState("Overview"),[Re,Ee]=f.useState("Draft"),[He,Ke]=f.useState([]),[st,it]=f.useState(null),{comments:ot,addComment:rt,refresh:at}=kn({relatedType:"quote",relatedId:w?.id});f.useEffect(()=>{w?.id&&at()},[w?.id,at]),f.useEffect(()=>{const I=t.state?.quoteID;if(I){it(I),e(t.pathname,{replace:!0,state:{}});return}},[t,e]),f.useEffect(()=>{if(st&&r.length>0&&!o){const _e=r.find(I=>I.id===st);_e?S(_e):V.error("Quote not found."),it(null)}},[st,p,o]),f.useEffect(()=>{let _e=!0;return(async()=>{const L=e6e();if(L&&_e){N(L);return}try{const ee=await ne.get("/auth/me"),ke=Gw(ee?.data);if(ke&&_e){N(ke);return}}catch{}try{const ee=await ne.get("/users/me"),ke=Gw(ee?.data);if(ke&&_e){N(ke);return}}catch{}_e&&N(null)})(),()=>{_e=!1}},[]);const Je=f.useCallback(_e=>_e&&d.find(L=>String(L.id)===String(_e))?.name||"",[d]),Fe=f.useCallback(_e=>{if(!_e)return"";const I=p.find(L=>String(L.id)===String(_e));return I?`${I.first_name} ${I.last_name}`.trim():""},[p]),Ue=f.useCallback(_e=>{if(!_e)return"--";const I=c.find(L=>String(L.id)===String(_e));return I?.deal_name||I?.name||`Deal #${B7(_e)}`},[c]),Ne=f.useCallback(_e=>{const I=c.find(ke=>String(ke.id)===String(_e)),L=t6e(I);let ee=a6e(I);if(!ee&&L){const ke=p.filter($e=>String($e.account_id||"")===String(L));if(ke.length>0){const $e=[...ke].sort((We,mt)=>{const Tt=`${We.first_name||""} ${We.last_name||""}`.trim().toLowerCase(),kt=`${mt.first_name||""} ${mt.last_name||""}`.trim().toLowerCase();return Tt.localeCompare(kt)});ee=String($e[0].id)}}if(L&&ee){const ke=p.find($e=>String($e.id)===String(ee));ke?.account_id&&String(ke.account_id)!==String(L)&&(ee="")}return{accountId:L||"",contactId:ee||""}},[c,p]),ze=f.useCallback(_e=>{if(!_e)return"--";if(_e.deal?.deal_name)return _e.deal.deal_name;if(_e.deal?.name)return _e.deal.name;const I=_e.deal_id||_e.deal?.id;return I?Ue(I):"--"},[Ue]),je=f.useCallback(_e=>{if(!_e)return"--";if(_e.account?.name)return _e.account.name;let I=_e.account_id||_e.account?.id;if(!I){const L=_e.deal_id||_e.deal?.id;L&&(I=Ne(L).accountId)}return I?Je(I)||`Account #${I}`:"--"},[Ne,Je]),ve=f.useCallback(_e=>{if(!_e)return"--";if(_e.contact?.first_name||_e.contact?.last_name)return`${_e.contact?.first_name||""} ${_e.contact?.last_name||""}`.trim()||"--";let I=_e.contact_id||_e.contact?.id;if(!I){const ee=_e.deal_id||_e.deal?.id;ee&&(I=Ne(ee).contactId)}return(I?Fe(I):"")||(I?`Contact #${I}`:"--")},[Ne,Fe]),z=f.useCallback(async(_e=null)=>{l(!0);try{const I=await ne.get("/quotes/admin/fetch-all"),ee=[...Array.isArray(I.data)?I.data:[]].sort((ke,$e)=>{const We=ke?.created_at||ke?.updated_at||0,mt=$e?.created_at||$e?.updated_at||0;return new Date(mt)-new Date(We)});if(i(ee),_e){const ke=ee.find($e=>$e.id===_e);S(ke||null)}}catch(I){console.error(I),i([]),I.response?.status===403?V.error("Permission denied. Only CEO, Admin, or Group Manager can access this page."):V.error("Failed to fetch quotes. Please try again later.")}finally{l(!1)}},[]),K=f.useCallback(async()=>{try{const _e=await ne.get("/deals/admin/fetch-all");u(Array.isArray(_e.data)?_e.data:[])}catch(_e){console.error(_e),_e.response?.status===403&&V.warn("Unable to load deals (permission denied).")}},[]),ue=f.useCallback(async()=>{try{const _e=await ne.get("/accounts/admin/fetch-all");h(Array.isArray(_e.data)?_e.data:[])}catch(_e){console.error(_e),_e.response?.status===403&&V.warn("Unable to load accounts (permission denied).")}},[]),re=f.useCallback(async()=>{try{const _e=await ne.get("/contacts/admin/fetch-all");x(Array.isArray(_e.data)?_e.data:[])}catch(_e){console.error(_e),_e.response?.status===403&&V.warn("Unable to load contacts (permission denied).")}},[]),Le=f.useCallback(async()=>{try{const _e=await ne.get("/users/all");j(Array.isArray(_e.data)?_e.data:[])}catch(_e){console.error(_e),_e.response?.status===403&&V.warn("Unable to load users (permission denied).")}},[]);f.useEffect(()=>{z(),K(),ue(),re(),Le()},[z,K,ue,re,Le]);const De=f.useMemo(()=>{const _e=we.trim().toLowerCase(),I=se.trim();return r.filter(L=>{const ee=ze(L),ke=je(L),$e=ve(L),We=wA(L.presented_date,L.validity_days),mt=[L.quote_id,jb(L.quote_id),L.id?.toString(),ee,ke,$e,L.total_amount?.toString(),L.validity_days?.toString(),L.presented_date?Dg(L.presented_date):"",We?Dg(We):"",L.assigned_user?.first_name,L.assigned_user?.last_name,L.creator?.first_name,L.creator?.last_name,L.status,L.notes,wb(L.created_at),wb(L.updated_at)],Tt=_e===""||mt.some(Yt=>Yt==null?!1:Yt.toString().toLowerCase().includes(_e)),kt=I==="Filter by Status"||$i(L.status)===I;return Tt&&kt})},[r,we,se,ze,je,ve]),Qe=Math.max(1,Math.ceil(De.length/pe)||1);f.useEffect(()=>Ae(1),[we,se]),f.useEffect(()=>{Ae(_e=>{const I=Math.max(1,Math.ceil(De.length/pe)||1);return _e>I?I:_e})},[De.length,pe]);const tt=f.useMemo(()=>{const _e=(me-1)*pe;return De.slice(_e,_e+pe)},[De,me,pe]),Me=()=>Ae(_e=>Math.max(_e-1,1)),et=()=>Ae(_e=>Math.min(_e+1,Qe)),yt=_e=>{S(_e),he("Overview"),Ee($i(_e?.status)||"Draft")},_t=()=>{S(null),he("Overview")},Ct=_e=>{_e.target.id==="quoteModalBackdrop"&&!P&&_t()},jt=f.useCallback(()=>{T(!1),A(!1),Z(null),le(bA),M(!1)},[]),At=_e=>{_e.target.id==="modalBackdrop"&&!E&&!P&&jt()},Ge=_e=>{const{name:I,value:L}=_e.target;if(I==="deal_id"){const{accountId:ee,contactId:ke}=Ne(L);le($e=>({...$e,deal_id:L,account_id:ee,contact_id:ke}));return}le(ee=>({...ee,[I]:L}))},Be=()=>{const _e=n?.company?.tax_rate??0;le({...bA,tax_rate:_e}),A(!1),Z(null),T(!0)},ce=_e=>{if(!_e)return;S(null);const I=_e.deal?.id?String(_e.deal.id):_e.deal_id?String(_e.deal_id):"",L=I?Ne(I):{accountId:"",contactId:""},ee=_e.account?.id?String(_e.account.id):_e.account_id?String(_e.account_id):L.accountId,ke=_e.contact?.id?String(_e.contact.id):_e.contact_id?String(_e.contact_id):L.contactId,$e=_e.assigned_user?.id?String(_e.assigned_user.id):_e.assigned_to?String(_e.assigned_to):"";le({deal_id:I,account_id:ee||"",contact_id:ke||"",total_amount:_e.total_amount?.toString()||"",presented_date:J$e(_e.presented_date),validity_days:_e.validity_days!==null&&_e.validity_days!==void 0?String(_e.validity_days):"",status:$i(_e.status)||"Draft",assigned_to:$e,notes:_e.notes||"",subtotal:parseFloat(_e.subtotal)||0,tax_rate:parseFloat(_e.tax_rate)||0,tax_amount:parseFloat(_e.tax_amount)||0,discount_type:_e.discount_type||"",discount_value:parseFloat(_e.discount_value)||0,discount_amount:parseFloat(_e.discount_amount)||0,currency:_e.currency||"PHP",items:Array.isArray(_e.items)?_e.items.map(We=>({id:We.id,item_type:We.item_type||"Product",name:We.name||"",description:We.description||"",sku:We.sku||"",variant:We.variant||"",unit:We.unit||"pcs",quantity:parseFloat(We.quantity)||1,unit_price:parseFloat(We.unit_price)||0,discount_percent:parseFloat(We.discount_percent)||0,discount_amount:parseFloat(We.discount_amount)||0,line_total:parseFloat(We.line_total)||0,sort_order:We.sort_order||0})):[]}),A(!0),Z(_e.id),T(!0)},fe=_e=>{if(_e.target.checked){const I=tt.map(L=>L.id);Ke(I)}else Ke([])},H=_e=>{Ke(I=>I.includes(_e)?I.filter(L=>L!==_e):[...I,_e])},te=_e=>{if(!_e)return;const I=_e.quote_id||"this quote";D({title:"Delete Quote",message:a.jsxs("span",{children:["Are you sure you want to permanently delete"," ",a.jsx("span",{className:"font-semibold",children:I}),"? This action cannot be undone."]}),confirmLabel:"Delete Quote",cancelLabel:"Cancel",variant:"danger",action:{type:"delete",targetId:_e.id,name:I}})},q=async()=>{He.length!==0&&D({title:"Delete Quotes",message:a.jsxs("span",{children:["Are you sure you want to delete"," ",a.jsx("span",{className:"font-semibold",children:He.length})," selected quotes? This action cannot be undone."]}),confirmLabel:`Delete ${He.length} Quote(s)`,cancelLabel:"Cancel",variant:"danger",action:{type:"bulk-delete",quote_ids:He}})},[Y,U]=f.useState(!1),de=_e=>{if(_e.preventDefault(),U(!0),!y){V.error("Unable to determine current user. Please log in again.");return}if(!Q.deal_id){V.error("Deal is required.");return}if(!Q.assigned_to){V.error("Assigned To is required.");return}const L=Ne(Q.deal_id),ee=Q.items.map((Tt,kt)=>({item_type:Tt.item_type||"Product",name:Tt.name,description:Tt.description||null,sku:Tt.sku||null,variant:Tt.variant||null,unit:Tt.unit||null,quantity:parseFloat(Tt.quantity)||1,unit_price:parseFloat(Tt.unit_price)||0,discount_percent:parseFloat(Tt.discount_percent)||0,sort_order:Tt.sort_order??kt})),ke={deal_id:Number(Q.deal_id),account_id:L.accountId?Number(L.accountId):null,contact_id:L.contactId?Number(L.contactId):null,subtotal:parseFloat(Q.subtotal)||0,tax_rate:parseFloat(Q.tax_rate)||0,tax_amount:parseFloat(Q.tax_amount)||0,discount_type:Q.discount_type||null,discount_value:parseFloat(Q.discount_value)||0,discount_amount:parseFloat(Q.discount_amount)||0,total_amount:parseFloat(Q.total_amount)||0,currency:Q.currency||"PHP",presented_date:Q.presented_date||null,validity_days:Q.validity_days===""?null:Number(Q.validity_days),status:Q.status||"Draft",assigned_to:Q.assigned_to?Number(Q.assigned_to):null,notes:Q.notes?.trim()||null,items:ee},$e=k&&W?"update":"create",We=Ue(Q.deal_id),mt=$e==="create"?{...ke,created_by_id:Number(y)}:ke;D({title:$e==="create"?"Confirm New Quote":"Confirm Update",message:$e==="create"?a.jsxs("span",{children:["Are you sure you want to create a quote for"," ",a.jsx("span",{className:"font-semibold",children:We}),"?"]}):a.jsxs("span",{children:["Save changes to"," ",a.jsx("span",{className:"font-semibold",children:We}),"?"]}),confirmLabel:$e==="create"?"Create Quote":"Update Quote",cancelLabel:"Cancel",variant:"primary",action:{type:$e,payload:mt,targetId:W||null,name:We}})},Te=async()=>{if(!F?.action){D(null);return}const{action:_e}=F,{type:I,payload:L,targetId:ee,name:ke}=_e;B(!0);try{if(I==="create")M(!0),await ne.post("/quotes/admin",L),V.success("Quote created successfully."),jt(),await z();else if(I==="update"){if(!ee)throw new Error("Missing quote identifier for update.");M(!0),await ne.put(`/quotes/admin/${ee}`,L),V.success("Quote updated successfully."),jt(),await z(),w?.id===ee&&S(null)}else if(I==="delete"){if(!ee)throw new Error("Missing quote identifier for deletion.");const $e=w?.id;ge(ee),await ne.delete(`/quotes/admin/${ee}`),V.success(`Quote "${ke}" deleted successfully.`),await z($e&&$e!==ee?$e:null),$e===ee&&S(null)}else I==="bulk-delete"&&(await ne.post("/quotes/admin/bulk-delete",{quote_ids:He}),V.success(`Successfully deleted ${He.length} quotes`),Ke([]),await z())}catch($e){console.error($e);const We=I==="create"?"Failed to create quote. Please review the details and try again.":I==="update"?"Failed to update quote. Please review the details and try again.":"Failed to delete quote. Please try again.";V.error(We),(I==="create"||I==="update")&&M(!1),I==="delete"&&ge(null)}finally{(I==="create"||I==="update")&&M(!1),I==="delete"&&ge(null),B(!1),D(null)}},ie=()=>{P||D(null)},Oe=f.useCallback((_e,I)=>{const L=_e?.deal_id??_e?.deal?.id??"",ee=L?Number(L):null,ke=ee?Ne(String(ee)):{accountId:"",contactId:""},$e=_e?.account_id??_e?.account?.id??ke.accountId??null,We=_e?.contact_id??_e?.contact?.id??ke.contactId??null,mt=_e?.total_amount??0,Tt=_e?.assigned_to??_e?.assigned_user?.id??null;return{deal_id:ee,account_id:$e!=null&&String($e).trim()!==""?Number($e):null,contact_id:We!=null&&String(We).trim()!==""?Number(We):null,total_amount:Number(mt),presented_date:_e?.presented_date||null,validity_days:_e?.validity_days===""||_e?.validity_days===void 0||_e?.validity_days===null?null:Number(_e.validity_days),status:I,assigned_to:Tt!=null&&String(Tt).trim()!==""?Number(Tt):null,notes:_e?.notes?.trim()||null}},[Ne]),X=f.useCallback(async()=>{if(!w?.id)return;const _e=$i(Re),I=[_e,_e.toLowerCase()],L=async ee=>ne.patch(`/quotes/admin/${w.id}/status`,{status:ee},{headers:{"Content-Type":"application/json"}});try{let ee=!1;for(const ke of I)try{await L(ke),ee=!0;break}catch($e){if($e?.response?.status===422)continue;throw $e}if(!ee){const ke=Oe(w,_e);if(!ke.deal_id){V.error("Cannot update status: missing deal_id on selected quote.");return}if(!ke.total_amount||ke.total_amount<=0){V.error("Cannot update status: missing/invalid total_amount on selected quote.");return}await ne.put(`/quotes/admin/${w.id}`,ke)}V.success(`Quote status updated to ${_e}`),S(null),he("Overview"),await z()}catch(ee){console.error(ee);const ke=ee?.response?.data?.message||(ee?.response?.data?.errors?Object.values(ee.response.data.errors).flat().join(" "):null)||"Failed to update quote status. Please try again.";V.error(ke)}},[w,Re,z,Oe]),oe=[{label:"Filter by Status",value:"Filter by Status"},...yA.map(_e=>({label:_e.label,value:_e.value}))],Pe=F?.action?.type==="delete"?F.action.targetId:null,Ve=w&&(Ce===w.id||Pe===w.id),ft=w&&Ce===w.id,St=w?a.jsx("div",{id:"quoteModalBackdrop",onClick:Ct,className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-6xl max-h-[92vh] overflow-y-auto hide-scrollbar animate-scale-in font-inter relative",onClick:_e=>_e.stopPropagation(),children:[a.jsx("div",{className:"w-full flex flex-col items-center justify-center rounded-t-xl",children:a.jsxs("div",{className:"bg-tertiary w-full flex items-center justify-between p-3 lg:p-3 rounded-t-xl",children:[a.jsx("h1",{className:"lg:text-3xl text-xl text-white font-semibold text-center w-full",children:"Quotes"}),a.jsx("button",{onClick:_t,className:"text-gray-500 hover:text-white transition cursor-pointer",children:a.jsx(Za,{size:25})})]})}),a.jsxs("div",{className:"p-6 lg:p-4",children:[a.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between lg:flex-row lg:items-center lg:justify-between mt-3 gap-2 px-2 md:items-center lg:gap-4 md:mx-7 lg:mx-7",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[a.jsx("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-800",children:ze(w)}),a.jsx("span",{className:`text-xs sm:text-sm font-medium px-2 sm:px-3 py-1 rounded-full whitespace-nowrap ${Z$e(w.status)}`,children:vA(w.status)})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsxs("button",{className:"inline-flex items-center justify-center w-full sm:w-auto bg-white text-gray-700 px-4 py-2 rounded-md border border-gray-300 hover:bg-gray-50 disabled:opacity-70 transition text-sm focus:outline-none focus:ring-2 focus:ring-gray-300",onClick:be,disabled:G||E||P,children:[a.jsx(ia,{className:"mr-2"}),G?"Preparing...":"Print Quotation"]}),a.jsxs("button",{className:"inline-flex items-center justify-center w-full sm:w-auto bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 disabled:opacity-70 transition text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",onClick:()=>ce(w),disabled:P||F?.action?.type==="update"&&F.action.targetId===w.id,children:[a.jsx(gn,{className:"mr-2"}),"Edit"]}),a.jsx("button",{className:"inline-flex items-center justify-center w-full sm:w-auto px-4 py-2 rounded-md text-sm bg-red-500 text-white hover:bg-red-600 transition focus:outline-none focus:ring-2 focus:ring-red-400",onClick:()=>te(w),disabled:!!Ve,children:ft?"Deleting...":a.jsxs(a.Fragment,{children:[a.jsx(_a,{className:"mr-2"}),"Delete"]})})]})]}),a.jsx("div",{className:"border-b border-gray-200 my-5"}),a.jsxs("div",{className:"p-1 lg:p-4",children:[a.jsx("div",{className:"flex w-full bg-[#6A727D] text-white mt-1 overflow-x-auto mb-6",children:["Overview","Notes"].map(_e=>a.jsx("button",{onClick:()=>he(_e),className:`flex-1 min-w-[90px] px-4 py-2.5 text-xs sm:text-sm font-medium text-center transition-all duration-200 border-b-2
                    ${xe===_e?"bg-paper-white text-[#6A727D] border-white":"text-white hover:bg-[#5c636d]"}`,children:_e},_e))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 items-start",children:[a.jsxs("div",{className:"lg:col-span-3",children:[xe==="Overview"&&a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 md:p-8 border border-gray-200",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4 sm:gap-6 text-sm text-gray-700",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Quote ID:"}),a.jsx("p",{children:jb(w.quote_id)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Deal:"}),a.jsx("p",{children:ze(w)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Account:"}),a.jsx("p",{children:je(w)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Contact:"}),a.jsx("p",{children:ve(w)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Total Amount:"}),a.jsx("p",{children:w.total_amount?`${s}${Number(w.total_amount).toLocaleString()}`:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Presented Date:"}),a.jsx("p",{children:Dg(w.presented_date)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Validity Days:"}),a.jsx("p",{children:w.validity_days!==null&&w.validity_days!==void 0?w.validity_days:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Expiry Date:"}),a.jsx("p",{children:Dg(wA(w.presented_date,w.validity_days))||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Status:"}),a.jsx("p",{children:vA(w.status)})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Assigned To:"}),a.jsx("p",{children:w.assigned_user?`${w.assigned_user.first_name} ${w.assigned_user.last_name}`:"Unassigned"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created By:"}),a.jsx("p",{children:w.creator?`${w.creator.first_name} ${w.creator.last_name}`:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created At:"}),a.jsx("p",{children:wb(w.created_at)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Last Updated:"}),a.jsx("p",{children:wb(w.updated_at)||"N/A"})]})]}),w.items&&w.items.length>0&&a.jsx("div",{className:"mt-6",children:a.jsx(wd,{items:w.items,onChange:()=>{},currencySymbol:s,readOnly:!0,taxRate:parseFloat(w.tax_rate)||0,discountType:w.discount_type,discountValue:parseFloat(w.discount_value)||0})})]}),xe==="Notes"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"bg-white p-4 sm:p-6 rounded-xl border border-gray-200 shadow-sm",children:[a.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Notes:"}),a.jsx("p",{className:"text-sm text-gray-700 leading-relaxed whitespace-pre-wrap",children:w.notes||"No notes available."})]}),a.jsx(Tn,{comments:ot,onAddComment:rt})]})]}),a.jsxs("div",{className:"flex flex-col gap-4",children:[a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Quick Actions"}),a.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[a.jsxs("button",{onClick:()=>e("/admin/calls",{state:{openCallModal:!0,initialCallData:{subject:`Call regarding Quote ${jb(w.quote_id)}`,assigned_to:w.assigned_user?.id?String(w.assigned_user.id):w.assigned_to?String(w.assigned_to):"",direction:"Outgoing",status:"Planned"}}}),className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(It,{className:"text-gray-600 w-4 h-4"}),"Schedule Call"]}),a.jsxs("button",{className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",onClick:()=>e("/admin/meetings",{state:{openMeetingModal:!0,initialMeetingData:{subject:`Meeting with ${w.quote_id}`,assignedTo:w.assigned_user?.id?String(w.assigned_user.id):w.assigned_to?String(w.assigned_to):"",status:"Planned"}}}),children:[a.jsx(Pt,{className:"text-gray-600 w-4 h-4"}),"Book Meeting"]}),a.jsxs("button",{onClick:()=>e("/admin/tasks",{state:{openTaskModal:!0,initialTaskData:{subject:`Follow up with ${w.quote_id}`,assignedTo:w.assigned_user?.id?String(w.assigned_user.id):w.assigned_to?String(w.assigned_to):"",priority:"NORMAL",status:"Not Started"}}}),className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(Qt,{className:"text-gray-600 w-4 h-4"}),"Tasks"]})]})]}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm w-full",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Status"}),a.jsx("select",{className:"border border-gray-200 rounded-md px-2 sm:px-3 py-1.5 w-full text-sm mb-2 focus:ring-2 focus:ring-indigo-500 outline-none",value:Re||$i(w.status)||"Draft",onChange:_e=>Ee(_e.target.value),children:yA.map(_e=>a.jsx("option",{value:_e.value,children:_e.label},_e.value))}),a.jsx("button",{onClick:X,disabled:$i(Re)===$i(w.status),className:`w-full py-1.5 rounded-md text-sm transition focus:outline-none focus:ring-2 ${$i(Re)===$i(w.status)?"bg-gray-400 cursor-not-allowed text-white":"bg-gray-900 text-white hover:bg-gray-800 focus:ring-gray-400"}`,children:"Update"})]})]})]})]})]})]})}):null,Ht=a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[o&&a.jsx(qt,{message:"Loading quotes..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h2",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(ia,{className:"mr-2 text-blue-600"})," Quotes"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto gap-2",children:a.jsxs("button",{onClick:()=>{Be(),U(!1)},className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 rounded-md hover:bg-gray-800 text-sm sm:text-base mx-auto sm:ml-auto cursor-pointer",children:[a.jsx(aa,{className:"mr-2"})," Add Quote"]})})]}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search quotes",value:we,onChange:_e=>J(_e.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsx("div",{className:"w-full lg:w-1/4",children:a.jsx("select",{value:se,onChange:_e=>ye(_e.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:oe.map(_e=>a.jsx("option",{value:_e.value,children:_e.label},_e.value))})})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[900px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 text-sm tracking-wide font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 w-12",children:a.jsx("input",{type:"checkbox",checked:tt.length>0&&He.length===tt.length,onChange:fe,className:"cursor-pointer"})}),a.jsx("th",{className:"py-3 px-4",children:"Quote ID"}),a.jsx("th",{className:"py-3 px-4",children:"Deal"}),a.jsx("th",{className:"py-3 px-4",children:"Account"}),a.jsx("th",{className:"py-3 px-4",children:"Contact"}),a.jsx("th",{className:"py-3 px-4",children:"Total Amount"}),a.jsx("th",{className:"py-3 px-4",children:"Status"}),a.jsx("th",{className:"py-3 px-4",children:"Assigned To"}),a.jsx("th",{className:"py-3 px-4",children:"Expiry Date"}),a.jsx("th",{className:"py-3 px-4 text-center w-24",children:He.length>0?a.jsx("button",{onClick:q,className:"text-red-600 hover:text-red-800 transition p-1 rounded-full hover:bg-red-50",title:`Delete ${He.length} selected items`,children:a.jsx(_a,{size:18})}):""})]})}),a.jsx("tbody",{children:o?a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:10,children:"Loading quotes..."})}):De.length>0?tt.map(_e=>{const I=wA(_e.presented_date,_e.validity_days);return a.jsxs("tr",{className:"hover:bg-gray-50 text-sm cursor-pointer transition",onClick:()=>yt(_e),children:[a.jsx("td",{className:"py-3 px-4 align-top w-12",onClick:L=>L.stopPropagation(),children:a.jsx("input",{type:"checkbox",checked:He.includes(_e.id),onChange:()=>H(_e.id),className:"cursor-pointer"})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("div",{className:"font-medium text-blue-600 hover:underline whitespace-nowrap",children:jb(_e.quote_id)||"--"})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("div",{className:"break-words",children:ze(_e)||"--"})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("div",{className:"text-sm text-gray-700 break-words",children:je(_e)||"--"})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("div",{className:"break-words",children:ve(_e)||"--"})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("div",{className:"text-gray-700",children:_e.total_amount?`${s}${Number(_e.total_amount).toLocaleString()}`:"--"})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-medium ${X$e(_e.status)}`,children:vA(_e.status)})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("div",{children:_e.assigned_user?`${_e.assigned_user.first_name} ${_e.assigned_user.last_name}`:"Unassigned"})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("div",{className:"text-gray-500 text-xs",children:Dg(I)||"--"})}),a.jsx("td",{className:"py-3 px-4 align-top text-center w-24"})]},_e.id)}):a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:10,children:"No quotes found."})})})]})}),a.jsx(ca,{className:"mt-4",totalItems:De.length,pageSize:pe,currentPage:me,onPrev:Me,onNext:et,onPageSizeChange:_e=>{Ie(_e),Ae(1)},pageSizeOptions:[10,20,30,40,50],label:"quotes"})]}),da=_?a.jsx("div",{id:"modalBackdrop",onClick:At,className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-full sm:max-w-3xl rounded-2xl shadow-lg p-4 sm:p-6 md:p-8 relative border border-gray-200 overflow-y-auto max-h-[90vh] hide-scrollbar",onClick:_e=>_e.stopPropagation(),children:[a.jsx("button",{onClick:()=>{jt(),U(!1)},className:"absolute top-4 right-4 text-gray-500 hover:text-black transition disabled:opacity-60",disabled:E||P,children:a.jsx(ea,{size:22})}),a.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800 mb-4 sm:mb-6 flex items-center justify-center",children:k?"Edit Quote":"Add New Quote"}),a.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",onSubmit:de,children:[a.jsx(G7,{label:"Deal",name:"deal_id",value:Q.deal_id,onChange:_e=>{const{accountId:I,contactId:L}=Ne(_e);le(ee=>({...ee,deal_id:_e,account_id:I,contact_id:L}))},items:Array.isArray(c)?c:[],getLabel:_e=>`${B7(_e?.deal_id??"")} ${_e?.name??""}`.trim(),placeholder:"Search deal...",required:!0,isSubmitted:Y,disabled:E||c.length===0,className:"md:col-span-2"}),a.jsx(q7,{label:"Account",value:Je(Q.account_id)||(Q.account_id?`Account #${Q.account_id}`:""),disabled:!0}),a.jsx(q7,{label:"Contact",value:Fe(Q.contact_id)||(Q.contact_id?`Contact #${Q.contact_id}`:""),disabled:!0}),a.jsx("div",{className:"md:col-span-2 mt-2",children:a.jsx(wd,{items:Q.items,onChange:_e=>le(I=>({...I,items:_e})),currencySymbol:s,readOnly:E,taxRate:Q.tax_rate,discountType:Q.discount_type,discountValue:Q.discount_value,onTotalsChange:_e=>{le(I=>({...I,subtotal:_e.subtotal,discount_amount:_e.discount_amount,tax_amount:_e.tax_amount,total_amount:_e.total_amount}))}})}),a.jsxs("div",{className:"md:col-span-2 mt-2 p-4 bg-gray-50 rounded-lg",children:[a.jsx("h4",{className:"font-medium text-gray-700 mb-3",children:"Pricing Settings"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-600 text-xs mb-1",children:"Discount Type"}),a.jsxs("select",{value:Q.discount_type||"",onChange:_e=>le(I=>({...I,discount_type:_e.target.value})),className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm",disabled:E,children:[a.jsx("option",{value:"",children:"No Discount"}),a.jsx("option",{value:"percentage",children:"Percentage (%)"}),a.jsx("option",{value:"fixed",children:"Fixed Amount"})]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-gray-600 text-xs mb-1",children:["Discount"," ",Q.discount_type==="percentage"?"%":"Amount"]}),a.jsx("input",{type:"number",value:Q.discount_value||"",onChange:_e=>le(I=>({...I,discount_value:_e.target.value})),className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm",placeholder:"0",min:"0",max:Q.discount_type==="percentage"?"100":void 0,step:"0.01",disabled:E||!Q.discount_type})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-600 text-xs mb-1",children:"Tax Rate (%)"}),a.jsx("input",{type:"number",value:Q.tax_rate??"",onChange:_e=>le(I=>({...I,tax_rate:_e.target.value})),className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm",placeholder:"0",min:"0",max:"100",step:"0.01",disabled:E})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-600 text-xs mb-1",children:"Total Amount"}),a.jsxs("div",{className:"w-full bg-gray-100 border border-gray-300 rounded-md px-2 py-1.5 text-sm font-medium",children:[s,parseFloat(Q.total_amount||0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]})]}),a.jsx(H7,{label:"Presented Date",name:"presented_date",type:"date",value:Q.presented_date,onChange:Ge,disabled:E}),a.jsx(H7,{label:"Validity Days",name:"validity_days",type:"number",value:Q.validity_days,onChange:Ge,placeholder:"30",disabled:E}),a.jsx(G7,{label:"Assigned To",value:Q.assigned_to||"",onChange:_e=>le(I=>({...I,assigned_to:_e})),items:Array.isArray(b)?b:[],getLabel:_e=>{const I=`${_e?.first_name??""} ${_e?.last_name??""}`.trim();if(!I)return _e?.email||"";const L=_e?.role?.toUpperCase()==="CEO"?"Admin":_e?.role;return L?`${I} (${L})`:I},placeholder:"Search assignee...",required:!0,isSubmitted:Y,disabled:E}),a.jsx(s6e,{label:"Status",name:"status",value:Q.status,onChange:Ge,options:yA,required:!0,disabled:E}),a.jsx(i6e,{label:"Notes",name:"notes",value:Q.notes,onChange:Ge,placeholder:"Additional details...",rows:3,disabled:E,className:"md:col-span-2"}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-2 md:col-span-2 mt-4",children:[a.jsx("button",{type:"button",onClick:()=>{jt(),U(!1)},className:"w-full sm:w-auto px-4 py-2 text-white bg-red-400 border border-red-300 rounded hover:bg-red-500 transition disabled:opacity-70",disabled:E||P,children:"Cancel"}),a.jsx("button",{type:"submit",className:"w-full sm:w-auto px-4 py-2 text-white border border-tertiary bg-tertiary rounded hover:bg-secondary transition disabled:opacity-70",disabled:E||P,children:E?"Saving...":k?"Update Quote":"Save Quote"})]})]})]})}):null,qe=F?a.jsx(o6e,{open:!0,title:F.title,message:F.message,confirmLabel:F.confirmLabel,cancelLabel:F.cancelLabel,variant:F.variant,onConfirm:Te,onCancel:ie,loading:P}):null;return a.jsxs(a.Fragment,{children:[w?St:Ht,da,qe]})}function H7({label:e,name:t,value:n,onChange:s,placeholder:r,type:i="text",required:o=!1,disabled:l=!1,className:c="",isSubmitted:u=!1}){const d=u&&!n?.trim();return a.jsxs("div",{className:c,children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",o&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:i,name:t,value:n??"",onChange:s,placeholder:r,required:o,disabled:l,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border focus:ring-2
          ${d?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}
          ${c}
        `})]})}function q7({label:e,value:t,className:n="",disabled:s=!0}){return a.jsxs("div",{className:n,children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsx("input",{type:"text",value:t??"",disabled:s,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm outline-none disabled:bg-gray-100"})]})}function s6e({label:e,name:t,value:n,onChange:s,options:r,required:i=!1,disabled:o=!1,className:l=""}){const c=n!=null?String(n):"",d=r.some(h=>String(h.value)===c)?c:"";return a.jsxs("div",{className:l,children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsx("select",{name:t,value:d,onChange:s,required:i,disabled:o,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100",children:r.map(h=>a.jsx("option",{value:String(h.value??""),children:h.label},h.value??h.label))})]})}function G7({label:e,items:t=[],value:n="",onChange:s,getLabel:r,placeholder:i="Search...",disabled:o=!1,className:l="",required:c=!1,isSubmitted:u=!1}){const d=u&&c&&!n;return a.jsxs("div",{className:l,children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",c&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx(r6e,{items:t,value:n??"",onChange:s,getLabel:r,placeholder:i,disabled:o,hasError:d})]})}function r6e({items:e=[],value:t="",onChange:n,getLabel:s,placeholder:r="Search...",disabled:i=!1,maxRender:o=200,hasError:l=!1}){const[c,u]=f.useState(!1),[d,h]=f.useState(""),p=f.useRef(null),x=e.find(y=>String(y.id)===String(t)),b=x?s(x):"",j=f.useMemo(()=>{const y=d.trim().toLowerCase();return(y?e.filter(w=>(s(w)||"").toLowerCase().includes(y)):e).slice(0,o)},[e,d,s,o]);return f.useEffect(()=>{const y=N=>{p.current&&!p.current.contains(N.target)&&u(!1)};return document.addEventListener("mousedown",y),()=>document.removeEventListener("mousedown",y)},[]),f.useEffect(()=>{c||h("")},[c]),a.jsxs("div",{ref:p,className:"relative w-full",children:[a.jsx("input",{disabled:i,value:c?d:b,placeholder:r,onFocus:()=>!i&&u(!0),onChange:y=>{h(y.target.value),c||u(!0)},className:`w-full border rounded-md px-2 py-1.5 text-sm outline-none focus:ring-2
          ${l?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}`}),c&&!i&&a.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg overflow-hidden",children:[a.jsx("div",{className:"max-h-56 overflow-y-auto hide-scrollbar",children:j.length>0?j.map(y=>{const N=String(y.id),w=s(y),S=String(t)===N;return a.jsx("button",{type:"button",onClick:()=>{n(N),u(!1)},className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-50 ${S?"bg-blue-50":""}`,children:w||"--"},N)}):a.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No results"})}),e.length>o&&a.jsxs("div",{className:"px-3 py-2 text-[11px] text-gray-400 border-t",children:["Showing first ",o," results  keep typing to narrow."]})]})]})}function i6e({label:e,name:t,value:n,onChange:s,placeholder:r,rows:i=3,disabled:o=!1,className:l=""}){return a.jsxs("div",{className:l,children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsx("textarea",{name:t,value:n??"",onChange:s,placeholder:r,rows:i,disabled:o,className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100 resize-none"})]})}function o6e({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o=!1,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsx("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${u}`,disabled:o,children:o?"Processing...":s})]})]})})}const C1=[{value:"CEO",label:"Admin"},{value:"Group Manager",label:"Group Manager"},{value:"Manager",label:"Manager"},{value:"Sales",label:"Sales"}],Pg={firstName:"",lastName:"",email:"",password:"",role:""},l6e={CEO:"bg-purple-100 text-purple-700",ADMIN:"bg-purple-100 text-purple-700",GROUP_MANAGER:"bg-indigo-100 text-indigo-700",MANAGER:"bg-blue-100 text-blue-700",MARKETING:"bg-yellow-100 text-yellow-700",SALES:"bg-green-100 text-green-700"},ko=e=>e?e.toString().trim().replace(/([a-z0-9])([A-Z])/g,"$1_$2").replace(/\s+/g,"_").toUpperCase():"",c6e=e=>{const t=ko(e),n=C1.find(s=>ko(s.value)===t);return n?n.value:e||""},JE=e=>{const t=ko(e),n=C1.find(s=>ko(s.value)===t);return n?n.label:typeof e=="string"?e.toLowerCase().replace(/\b\w/g,s=>s.toUpperCase()):"--"},W7=e=>{if(!e)return"--";const t=new Date(e);return Number.isNaN(t.getTime())?"--":t.toLocaleString("en-US",{month:"2-digit",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).replace(",","")},jA=(e,{size:t="sm"}={})=>{const n=ko(e),s=l6e[n]||"bg-gray-100 text-gray-700",r=t==="lg"?"px-3 py-1 text-sm":t==="md"?"px-2.5 py-1 text-sm":"px-2 py-1 text-xs";return a.jsx("span",{className:`${r} font-semibold rounded-md inline-flex items-center justify-center ${s}`,children:JE(e)})},d6e=(e,t)=>{const n=e?.trim()?.[0]??"",s=t?.trim()?.[0]??"";return`${n}${s}`.toUpperCase()||"U"},V7=e=>[...e].sort((t,n)=>{const s=t.created_at?new Date(t.created_at).getTime():0;return(n.created_at?new Date(n.created_at).getTime():0)-s});function u6e(){const{user:e,loading:t}=Gt(),[n,s]=f.useState([]),[r,i]=f.useState(!1),[o,l]=f.useState(""),[c,u]=f.useState(""),[d,h]=f.useState(null),[p,x]=f.useState(!1),[b,j]=f.useState(!1),[y,N]=f.useState(null),[w,S]=f.useState(Pg),[_,T]=f.useState(!1),[k,A]=f.useState(null),[E,M]=f.useState(!1),[F,D]=f.useState(1),[P,B]=f.useState(10),[G,$]=f.useState("Overview"),[W,Z]=f.useState(""),[Q,le]=f.useState(!1),[we,J]=f.useState([]),se=ko(e?.role),ye=["ADMIN","CEO"].includes(se),Ce=!t&&ye,ge=f.useMemo(()=>{const ue=C1.filter(re=>ko(re.value)!=="CEO");return[{label:"Filter by Roles",value:""},{label:"CEO",value:"CEO"},...ue]},[]),be=f.useCallback(ue=>{ue&&(s(re=>re.map(Le=>Le.id===ue?{...Le,highlight:!0}:Le)),setTimeout(()=>{s(re=>re.map(Le=>Le.id===ue?{...Le,highlight:!1}:Le))},2e3))},[]),me=f.useCallback(async()=>{i(!0);try{const ue=await ne.get("/users/all"),re=Array.isArray(ue.data)?ue.data:[],Le=V7(re);s(Le),h(De=>De&&(Le.find(tt=>tt.id===De.id)||null)),console.log(ue.data)}catch(ue){console.error("Error fetching users:",ue);const re=ue.response?.data?.detail||"Failed to load users. Please try again later.";V.error(re)}finally{i(!1)}},[]);f.useEffect(()=>{!t&&!ye&&e&&V.error("You are not authorized to access User Management.")},[ye,t,e]),f.useEffect(()=>{t||!ye||me()},[t,ye,me]),f.useEffect(()=>{document.title="Users | Sari-Sari CRM"},[]);const Ae=f.useMemo(()=>{const ue=o.trim().toLowerCase(),re=ko(c);return V7(n.filter(Le=>{if(!Le)return!1;const De=ue===""||[Le.first_name,Le.last_name,`${Le.first_name||""} ${Le.last_name||""}`,Le.email,JE(Le.role)].filter(Boolean).some(tt=>tt.toString().toLowerCase().includes(ue)),Qe=re===""||re==="CEO"&&["CEO","ADMIN"].includes(ko(Le.role))||ko(Le.role)===re;return De&&Qe}))},[n,o,c]),pe=Math.max(1,Math.ceil(Ae.length/P)||1);f.useEffect(()=>{D(1)},[o,c,P]),f.useEffect(()=>{D(ue=>{const re=Math.max(1,Math.ceil(Ae.length/P)||1);return ue>re?re:ue})},[Ae.length,P]);const Ie=f.useMemo(()=>{const ue=(F-1)*P;return Ae.slice(ue,ue+P)},[Ae,F,P]);Ae.length===0||(F-1)*P+1,Math.min(F*P,Ae.length);const xe=()=>D(ue=>Math.max(ue-1,1)),he=()=>D(ue=>Math.min(ue+1,pe)),Re=()=>{S(Pg),j(!1),N(null),x(!0)},Ee=ue=>{h(ue),$("Overview"),Z(ue?.is_active?"Active":"Inactive")},He=ue=>{ue.target.id==="userModalBackdrop"&&!E&&Ke()},Ke=()=>{h(null)},st=(ue,re)=>{S(Le=>({...Le,[ue]:re}))},it=()=>{const ue="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*";let re="";for(let Le=0;Le<10;Le+=1)re+=ue.charAt(Math.floor(Math.random()*ue.length));st("password",re)},ot=()=>{_||E||(x(!1),S(Pg),N(null),j(!1))},rt=ue=>{S({firstName:ue.first_name||"",lastName:ue.last_name||"",email:ue.email||"",password:"",role:c6e(ue.role)}),j(!0),N(ue.id),x(!0),h(null)},at=ue=>{A({title:"Delete User",message:a.jsxs("span",{children:["Are you sure you want to delete"," ",a.jsxs("span",{className:"font-semibold",children:[ue.first_name," ",ue.last_name]}),"? This action cannot be undone."]}),confirmLabel:"Delete",cancelLabel:"Cancel",variant:"danger",action:{type:"delete",targetId:ue.id,name:`${ue.first_name||""} ${ue.last_name||""}`.trim()||ue.email||"user"}})},Je=ue=>{ue.preventDefault();const re=w.firstName.trim(),Le=w.lastName.trim(),De=w.email.trim(),Qe=w.password.trim(),tt=w.role,Me=!(b&&y);if(!re||!De||!tt){V.warn("Please fill in all required fields.");return}if(Me&&!Qe){V.warn("Please fill in all required fields.");return}if(Qe&&Qe.length<8){V.warn("Password should be at least 8 characters long.");return}const et={first_name:re,last_name:Le,email:De,role:tt};(Me||Qe)&&(et.password=Qe);const yt=`${re} ${Le}`.trim(),_t=Me?"create":"update";A({title:_t==="create"?"Confirm New User":"Confirm User Update",message:_t==="create"?a.jsxs("span",{children:["Create user ",a.jsx("span",{className:"font-semibold",children:yt})," with role"," ",a.jsx("span",{className:"font-semibold",children:JE(tt)}),"?"]}):a.jsxs("span",{children:["Save changes for"," ",a.jsx("span",{className:"font-semibold",children:yt||De}),"?"]}),confirmLabel:_t==="create"?"Create User":"Update User",cancelLabel:"Cancel",variant:"primary",action:{type:_t,payload:et,targetId:y,name:yt||De}})},Fe=async()=>{we.length!==0&&A({title:"Delete Users",message:a.jsxs("span",{children:["Are you sure you want to deactivate"," ",a.jsx("span",{className:"font-semibold",children:we.length})," selected users? This action cannot be undone."]}),confirmLabel:`Deactivate ${we.length} User(s)`,cancelLabel:"Cancel",variant:"danger",action:{type:"bulk-delete",user_ids:we}})},Ue=ue=>{if(ue.target.checked){const re=Ie.map(Le=>Le.id);J(re)}else J([])},Ne=ue=>{J(re=>re.includes(ue)?re.filter(Le=>Le!==ue):[...re,ue])},ze=async()=>{if(!k?.action){A(null);return}const{action:ue}=k,{type:re,payload:Le,targetId:De,name:Qe}=ue;M(!0),(re==="create"||re==="update")&&T(!0);try{if(re==="create"){const Me=(await ne.post("/users/createuser",Le)).data;await me(),be(Me.id),V.success(`User "${Qe}" created successfully.`),x(!1),S(Pg),N(null),j(!1)}else if(re==="update"){if(!De)throw new Error("Missing user identifier for update.");const Me=(await ne.put(`/users/updateuser/${De}`,Le)).data;await me(),h(null),be(Me.id),V.success(`User "${Qe}" updated successfully.`),x(!1),S(Pg),N(null),j(!1)}else if(re==="delete"){if(!De)throw new Error("Missing user identifier for deletion.");await ne.delete(`/users/deleteuser/${De}`),s(tt=>tt.map(Me=>Me.id===De?{...Me,is_active:!1}:Me)),d&&d.id===De&&(h(null),Z("")),V.success(`User "${Qe}" deactivated successfully.`)}else re==="bulk-delete"&&(await ne.delete("/users/admin/bulk-delete",{data:{user_ids:ue.user_ids}}),s(tt=>tt.map(Me=>ue.user_ids.includes(Me.id)?{...Me,is_active:!1}:Me)),d&&ue.user_ids.includes(d.id)&&(h(null),Z("")),V.success(`Successfully deactivated ${ue.user_ids.length} users`),J([]))}catch(tt){console.error("User management error:",tt);const Me=re==="create"?"Failed to create user. Please review the details and try again.":re==="update"?"Failed to update user. Please review the details and try again.":"Failed to delete user. Please try again.",et=tt.response?.data?.detail||Me;V.error(et)}finally{(re==="create"||re==="update")&&T(!1),M(!1),A(null)}},je=()=>{E||A(null)},ve=async()=>{if(!d||!W)return;const ue=d.is_active?"Active":"Inactive";if(W===ue)return;const re=W==="Active";le(!0);try{const De=(await ne.put(`/users/updateuser/${d.id}`,{is_active:re})).data;s(Qe=>Qe.map(tt=>tt.id===De.id?De:tt)),h(null),Z(""),V.success(`User status updated to ${W}`)}catch(Le){console.error("Failed to update user status:",Le);const De=Le.response?.data?.detail||"Failed to update user status. Please try again.";V.error(De)}finally{le(!1)}},z=a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[(r||t||!Ce)&&a.jsx(qt,{}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h1",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(jj,{className:"mr-2 text-blue-600"}),"User Management"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{type:"button",onClick:Re,className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 rounded-md hover:bg-gray-800 text-sm sm:text-base self-end sm:self-auto cursor-pointer",children:[a.jsx(rn,{className:"mr-2"})," Add User"]})})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search users",value:o,onChange:ue=>l(ue.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsx("div",{className:"w-full lg:w-1/4",children:a.jsx("select",{value:c,onChange:ue=>u(ue.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:ge.map(ue=>a.jsx("option",{value:ue.value,children:ue.label},ue.value))})})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[600px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 text-sm tracking-wide font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 w-10",children:a.jsx("input",{type:"checkbox",className:"w-4 h-4 accent-blue-600",checked:Ie.length>0&&Ie.every(ue=>we.includes(ue.id)),onChange:Ue})}),a.jsx("th",{className:"py-3 px-4",children:"Fullname"}),a.jsx("th",{className:"py-3 px-4",children:"Email"}),a.jsx("th",{className:"py-3 px-4",children:"Role"}),a.jsx("th",{className:"py-3 px-4",children:"Status"}),a.jsx("th",{className:"py-3 px-4 text-center w-24",children:we.length>0?a.jsx("button",{onClick:Fe,className:"text-red-600 hover:text-red-800 transition p-1 rounded-full hover:bg-red-50",title:`Deactivate ${we.length} selected users`,children:a.jsx(_a,{size:18})}):""})]})}),a.jsx("tbody",{children:r?a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:3,children:"Loading users..."})}):Ae.length===0?a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-400",colSpan:4,children:"No users found."})}):Ie.map(ue=>a.jsxs("tr",{className:`hover:bg-gray-50 transition-colors ${ue.highlight?"bg-green-50":""} ${ue.is_active?"":"opacity-60 bg-gray-50"}`,children:[a.jsx("td",{className:"py-3 px-4",onClick:re=>re.stopPropagation(),children:a.jsx("input",{type:"checkbox",className:"w-4 h-4 accent-blue-600",checked:we.includes(ue.id),onChange:()=>Ne(ue.id)})}),a.jsx("td",{className:"py-3 px-4 cursor-pointer",onClick:()=>Ee(ue),children:a.jsxs("div",{className:"font-medium text-blue-600 hover:underline text-sm",children:[ue.first_name," ",ue.last_name]})}),a.jsx("td",{className:"py-3 px-4 cursor-pointer text-sm",onClick:()=>Ee(ue),children:ue.email}),a.jsx("td",{className:"py-3 px-4 cursor-pointer",onClick:()=>Ee(ue),children:jA(ue.role)}),a.jsx("td",{className:"py-3 px-4 cursor-pointer",onClick:()=>Ee(ue),children:a.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-md ${ue.is_active?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:ue.is_active?"Active":"Inactive"})})]},ue.id))})]})}),a.jsx(ca,{className:"mt-4",totalItems:Ae.length,pageSize:P,currentPage:F,onPrev:xe,onNext:he,onPageSizeChange:ue=>{B(ue),D(1)},label:"users"})]}),K=d?a.jsx("div",{id:"userModalBackdrop",onClick:He,className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-6xl max-h-[92vh] overflow-y-auto hide-scrollbar animate-scale-in p-4 sm:p-6 md:p-8 font-inter relative",children:[a.jsx("div",{className:"flex justify-end w-full",children:a.jsx("button",{onClick:Ke,className:"text-gray-500 hover:text-gray-700 transition mb-5 cursor-pointer",children:a.jsx(Za,{size:30})})}),a.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between lg:flex-row lg:items-center lg:justify-between mt-3 gap-2 px-2 md:items-center lg:gap-4 md:mx-7 lg:mx-7 mb-4 lg:mb-6 md:mb-4",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[d.profile_picture?a.jsx("img",{src:d.profile_picture,alt:`${d.first_name} ${d.last_name}`,className:"w-12 h-12 sm:w-16 sm:h-16 rounded-full object-cover border border-gray-200 shadow-sm"}):a.jsx("div",{className:"w-12 h-12 sm:w-16 sm:h-16 rounded-full bg-gray-200 text-gray-700 flex items-center justify-center text-lg sm:text-xl font-semibold border border-gray-200 shadow-sm",children:d6e(d.first_name,d.last_name)}),a.jsxs("div",{children:[a.jsxs("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-800",children:[d.first_name," ",d.last_name]}),a.jsx("p",{className:"text-sm text-gray-500 break-all",children:d.email})]})]}),jA(d.role,{size:"md"})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsxs("button",{type:"button",className:"inline-flex items-center justify-center w-full sm:w-auto bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 disabled:opacity-70 transition text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",onClick:()=>rt(d),disabled:E,children:[a.jsx(hn,{className:"mr-2"}),"Edit"]}),a.jsxs("button",{type:"button",className:"inline-flex items-center justify-center w-full sm:w-auto px-4 py-2 rounded-md text-sm bg-red-500 text-white hover:bg-red-600 transition focus:outline-none focus:ring-2 focus:ring-red-400",onClick:()=>at(d),disabled:E,children:[a.jsx(_a,{className:"mr-2"}),"Delete"]})]})]}),a.jsx("div",{className:"border-b border-gray-200 mb-6"}),a.jsx("div",{className:"flex w-full bg-[#6A727D] text-white mt-1 overflow-x-auto mb-6",children:["Overview"].map(ue=>a.jsx("button",{onClick:()=>$(ue),className:`flex-1 min-w-[90px] px-4 py-2.5 text-xs sm:text-sm font-medium text-center transition-all duration-200 border-b-2
        ${G===ue?"bg-[#5c636d] text-white border-white":"text-white hover:bg-[#5c636d]"}`,children:ue},ue))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 items-start",children:[a.jsx("div",{className:"lg:col-span-3",children:G==="Overview"&&a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 md:p-8 border border-gray-200",children:a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4 sm:gap-6 text-sm text-gray-700",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Email:"}),a.jsx("p",{children:d.email||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Role:"}),a.jsx("p",{children:jA(d.role,{size:"sm"})})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Status:"}),a.jsx("p",{children:d.is_active?"Active":"Inactive"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Auth Provider:"}),a.jsx("p",{children:d.auth_provider?d.auth_provider.toString().replace(/\b\w/g,ue=>ue.toUpperCase()):"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Phone Number:"}),a.jsx("p",{children:d.phone_number||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Company:"}),a.jsx("p",{children:d.company?.company_name||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Company Number:"}),a.jsx("p",{children:d.company?.company_number||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Related to CEO:"}),a.jsx("p",{children:d.manager?`${d.manager.first_name} ${d.manager.last_name}`:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created At:"}),a.jsx("p",{children:W7(d.created_at)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Last Login:"}),a.jsx("p",{children:d.last_login?W7(d.last_login):"Never"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Profile Picture:"}),a.jsx("p",{children:d.profile_picture?a.jsx("a",{href:d.profile_picture,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline break-all",children:"View image"}):"N/A"})]})]})})}),a.jsxs("div",{className:"flex flex-col gap-4",children:[a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Quick Actions"}),a.jsx("div",{className:"flex flex-col gap-2 w-full",children:a.jsxs("button",{type:"button",onClick:()=>{if(!d.email){alert("No email address available");return}const ue=encodeURIComponent(d.email),re=encodeURIComponent(""),Le=encodeURIComponent(""),De=`https://mail.google.com/mail/?view=cm&fs=1&to=${ue}&su=${re}&body=${Le}`;window.open(De,"_blank")},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(sn,{className:"text-gray-600 w-4 h-4"}),"Send E-mail"]})})]}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm w-full",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Status"}),a.jsxs("select",{className:"border border-gray-200 rounded-md px-2 sm:px-3 py-1.5 w-full text-sm mb-2 focus:ring-2 focus:ring-indigo-500 outline-none",value:W||(d.is_active?"Active":"Inactive"),onChange:ue=>Z(ue.target.value),children:[a.jsx("option",{value:"Active",children:"Active"}),a.jsx("option",{value:"Inactive",children:"Inactive"})]}),a.jsx("button",{onClick:ve,disabled:Q||W===(d.is_active?"Active":"Inactive"),className:`w-full py-1.5 rounded-md text-sm transition focus:outline-none focus:ring-2 ${Q||W===(d.is_active?"Active":"Inactive")?"bg-gray-400 cursor-not-allowed text-white":"bg-gray-900 text-white hover:bg-gray-800 focus:ring-gray-400"}`,children:Q?"Updating...":"Update"})]})]})]})]})}):null;return a.jsxs(a.Fragment,{children:[z,K,a.jsx(m6e,{open:p,isEditing:b,isSubmitting:_,confirmProcessing:E,formData:w,onClose:ot,onSubmit:Je,onChange:st,onGeneratePassword:it}),a.jsx(f6e,{open:!!k,title:k?.title,message:k?.message,confirmLabel:k?.confirmLabel,cancelLabel:k?.cancelLabel,variant:k?.variant,loading:E,onConfirm:ze,onCancel:je})]})}function m6e({open:e,isEditing:t,isSubmitting:n,confirmProcessing:s,formData:r,onClose:i,onSubmit:o,onChange:l,onGeneratePassword:c}){if(!e)return null;const u=n||s;return a.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-2xl rounded-2xl shadow-lg border border-gray-200 p-6 sm:p-8 relative overflow-y-auto max-h-[90vh]",children:[a.jsx("button",{onClick:i,className:"absolute top-4 right-4 text-gray-500 hover:text-black transition disabled:opacity-60",disabled:u,children:a.jsx(ea,{size:22})}),a.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800 mb-6 text-center",children:t?"Edit User":"Add New User"}),a.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",onSubmit:o,children:[a.jsx(Nb,{label:"First Name",value:r.firstName,onChange:d=>l("firstName",d),placeholder:"John",required:!0,disabled:u}),a.jsx(Nb,{label:"Last Name",value:r.lastName,onChange:d=>l("lastName",d),placeholder:"Doe",required:!0,disabled:u}),a.jsx(Nb,{label:"Email",type:"email",value:r.email,onChange:d=>l("email",d),placeholder:"john.doe@company.com",required:!0,disabled:u||t}),a.jsx(Nb,{label:"Role",type:"select",value:r.role,onChange:d=>l("role",d),options:[{value:"",label:"Select role"},...C1],required:!0,disabled:u}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Password"}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2",children:[a.jsx("input",{type:"text",value:r.password,onChange:d=>l("password",d.target.value),placeholder:t?"Leave blank to keep current password":"Enter or generate password",required:!t,disabled:u,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-indigo-500 outline-none disabled:bg-gray-100"}),a.jsx("button",{type:"button",onClick:c,className:"flex items-center justify-center px-4 py-2 bg-gray-900 text-white rounded-md hover:bg-gray-800 transition disabled:opacity-60",disabled:u,children:"Generate"})]}),t?a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Setting a password will reset the user's credentials; leave it blank to keep the current password."}):a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Password must be at least 8 characters long."})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-2 md:col-span-2 mt-4",children:[a.jsx("button",{type:"button",onClick:i,className:"w-full sm:w-auto px-4 py-2 text-white bg-red-400 border border-red-300 rounded hover:bg-red-500 transition disabled:opacity-70",disabled:u,children:"Cancel"}),a.jsx("button",{type:"submit",className:"w-full sm:w-auto px-4 py-2 text-white border border-tertiary bg-tertiary rounded hover:bg-secondary transition disabled:opacity-70",disabled:u,children:n?"Saving...":t?"Update User":"Save User"})]})]})]})})}function Nb({label:e,type:t="text",value:n,onChange:s,placeholder:r,options:i=[],required:o=!1,disabled:l=!1}){return a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),t==="select"?a.jsx("select",{value:n??"",onChange:c=>s(c.target.value),required:o,disabled:l,className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-indigo-500 outline-none disabled:bg-gray-100",children:i.map(c=>a.jsx("option",{value:c.value,children:c.label},c.value))}):a.jsx("input",{type:t,value:n??"",onChange:c=>s(c.target.value),placeholder:r,required:o,disabled:l,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-indigo-500 outline-none disabled:bg-gray-100"})]})}function f6e({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o=!1,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":"bg-black hover:bg-gray-800 border border-black";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("div",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsx("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${u}`,disabled:o,children:o?"Processing...":s})]})]})})}const h6e=(e,t)=>{const n=e?.trim()?.[0]??"",s=t?.trim()?.[0]??"";return`${n}${s}`.toUpperCase()||"U"};function g6e(){const{user:e,loading:t,fetchUser:n}=Gt(),[s,r]=f.useState(!1),[i,o]=f.useState(!1),[l,c]=f.useState(!1),[u,d]=f.useState(!1),[h,p]=f.useState(!1),[x,b]=f.useState(null),[j,y]=f.useState(null),N=f.useRef(null),[w,S]=f.useState({firstName:"",lastName:"",email:"",phoneNumber:""}),[_,T]=f.useState({currentPassword:"",newPassword:"",confirmPassword:""});f.useEffect(()=>{e&&(S({firstName:e.first_name||"",lastName:e.last_name||"",email:e.email||"",phoneNumber:e.phone_number||""}),y(e.profile_picture||null))},[e]),f.useEffect(()=>{document.title="Manage Account | Sari-Sari CRM"},[]);const k=(D,P)=>{S(B=>({...B,[D]:P}))},A=(D,P)=>{T(B=>({...B,[D]:P}))},E=D=>{const P=D.target.files?.[0];if(!P)return;if(!P.type.startsWith("image/")){V.error("Please select an image file");return}if(P.size>5*1024*1024){V.error("Image size should be less than 5MB");return}const B=new FileReader;B.onloadend=()=>{b(B.result),y(B.result)},B.readAsDataURL(P)},M=async D=>{if(D.preventDefault(),!w.firstName.trim()||!w.lastName.trim()){V.warn("Please fill in all required fields.");return}r(!0);try{const P={first_name:w.firstName.trim(),last_name:w.lastName.trim(),phone_number:w.phoneNumber.trim()||null};x!==null&&(P.profile_picture=x),await ne.put("/users/me",P),await n(),o(!1),b(null),window.dispatchEvent(new CustomEvent("userProfileUpdated")),V.success("Account information updated successfully!")}catch(P){console.error("Error updating account:",P);const B=P.response?.data?.detail||"Failed to update account information. Please try again.";V.error(B)}finally{r(!1)}},F=async D=>{if(D.preventDefault(),!_.newPassword||!_.confirmPassword){V.warn("Please fill in all password fields.");return}if(_.newPassword.length<8){V.warn("Password must be at least 8 characters long.");return}if(_.newPassword!==_.confirmPassword){V.warn("New password and confirm password do not match.");return}p(!0);try{const P={password:_.newPassword};await ne.put("/users/me",P),await n(),T({currentPassword:"",newPassword:"",confirmPassword:""}),window.dispatchEvent(new CustomEvent("userProfileUpdated")),p(!1),V.success("Password changed successfully!")}catch(P){console.error("Error changing password:",P);const B=P.response?.data?.detail||"Failed to change password. Please try again.";V.error(B)}finally{p(!1)}};return a.jsxs("div",{className:"p-2 lg:p-8 font-inter relative",children:[(t||!e)&&a.jsx(qt,{}),e&&a.jsxs("div",{children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("h1",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 mb-2",children:"Manage Your Profile"}),a.jsx("p",{className:"text-gray-600 text-sm sm:text-base",children:"Update your account information and change your password"})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm p-6 mb-6",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h2",{className:"text-xl font-semibold text-gray-800 flex items-center gap-2",children:[a.jsx(ra,{className:"text-blue-600"}),"Profile Information"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:!i&&a.jsxs("button",{onClick:()=>o(!0),className:"flex items-center gap-2 px-4 py-2 bg-gray-900 text-white rounded-md hover:bg-gray-800 transition text-sm",children:[a.jsx(hn,{}),"Edit Profile"]})})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-4 mb-6 pb-6 border-b border-gray-200",children:[a.jsxs("div",{className:"flex-shrink-0 relative group",children:[j?a.jsx("div",{className:"relative",children:a.jsx("img",{src:j,alt:`${e.first_name} ${e.last_name}`,className:"w-20 h-20 sm:w-24 sm:h-24 rounded-full object-cover border-2 border-gray-200 shadow-sm"})}):a.jsx("div",{className:"w-20 h-20 sm:w-24 sm:h-24 rounded-full bg-gradient-to-br from-blue-500 to-indigo-600 text-white flex items-center justify-center text-2xl sm:text-3xl font-semibold border-2 border-gray-200 shadow-sm",children:h6e(e.first_name,e.last_name)}),i&&a.jsxs("div",{className:"absolute bottom-0 right-0",children:[a.jsx("input",{type:"file",ref:N,accept:"image/*",onChange:E,className:"hidden",id:"profile-picture-upload"}),a.jsx("label",{htmlFor:"profile-picture-upload",className:"cursor-pointer bg-gray-900 text-white p-1.5 rounded-full shadow-lg hover:bg-gray-800 transition flex items-center justify-center border-2 border-white",title:"Change profile picture",children:a.jsx(v9,{size:14})})]})]}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-800",children:[i?w.firstName:e.first_name," ",i?w.lastName:e.last_name]}),a.jsx("p",{className:"text-gray-600 text-sm",children:e.email}),a.jsx("span",{className:"inline-block mt-2 px-3 py-1 bg-blue-100 text-blue-700 text-xs font-semibold rounded-md",children:e.role.toUpperCase()==="CEO"&&"Admin"})]})]}),i?a.jsxs("form",{onSubmit:M,className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-2 text-sm",children:["First Name ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("div",{className:"relative",children:[a.jsx(ra,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),a.jsx("input",{type:"text",value:w.firstName,onChange:D=>k("firstName",D.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none",required:!0})]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-2 text-sm",children:["Last Name ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("div",{className:"relative",children:[a.jsx(ra,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),a.jsx("input",{type:"text",value:w.lastName,onChange:D=>k("lastName",D.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none",required:!0})]})]}),a.jsxs("div",{className:"sm:col-span-2",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-2 text-sm",children:"Email"}),a.jsxs("div",{className:"relative",children:[a.jsx(sn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),a.jsx("input",{type:"email",value:w.email,disabled:!0,className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md bg-gray-100 text-gray-600 cursor-not-allowed outline-none",readOnly:!0})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Email cannot be changed"})]}),a.jsxs("div",{className:"sm:col-span-2",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-2 text-sm",children:"Phone Number"}),a.jsxs("div",{className:"relative",children:[a.jsx(It,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),a.jsx("input",{type:"tel",value:w.phoneNumber,onChange:D=>k("phoneNumber",D.target.value),placeholder:"+1 (555) 123-4567",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none"})]})]})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-3 pt-4 border-t border-gray-200",children:[a.jsx("button",{type:"button",onClick:()=>{o(!1),S({firstName:e.first_name||"",lastName:e.last_name||"",email:e.email||"",phoneNumber:e.phone_number||""}),b(null),y(e.profile_picture||null),N.current&&(N.current.value="")},className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition",disabled:s,children:"Cancel"}),a.jsxs("button",{type:"submit",className:"flex items-center justify-center gap-2 px-4 py-2 bg-gray-900 text-white rounded-md hover:bg-gray-800 transition disabled:opacity-70",disabled:s,children:[a.jsx(kL,{}),s?"Saving...":"Save Changes"]})]})]}):a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"First Name"}),a.jsx("p",{className:"text-gray-800 font-medium",children:e.first_name||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Last Name"}),a.jsx("p",{className:"text-gray-800 font-medium",children:e.last_name||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Email"}),a.jsx("p",{className:"text-gray-800 font-medium",children:e.email||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Phone Number"}),a.jsx("p",{className:"text-gray-800 font-medium",children:e.phone_number||"N/A"})]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm p-6",children:[a.jsxs("h2",{className:"text-xl font-semibold text-gray-800 flex items-center gap-2 mb-6 justify-center lg:justify-start",children:[a.jsx(Do,{className:"text-blue-600"}),"Change Password"]}),a.jsxs("form",{onSubmit:F,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-2 text-sm",children:["New Password ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("div",{className:"relative",children:[a.jsx(Do,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),a.jsx("input",{type:"text",style:l?void 0:{WebkitTextSecurity:"disc"},value:_.newPassword,onChange:D=>A("newPassword",D.target.value),placeholder:"Enter new password (min. 8 characters)",className:"w-full pl-10 pr-10 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none",required:!0,minLength:8}),a.jsx("button",{type:"button",onClick:()=>c(D=>!D),className:"absolute inset-y-0 right-0 flex items-center pr-3 text-gray-700 hover:text-gray-900 focus:outline-none z-10 transition-colors cursor-pointer","aria-label":l?"Hide password":"Show password",children:l?a.jsx(Ru,{className:"size-5"}):a.jsx(md,{className:"size-5"})})]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-2 text-sm",children:["Confirm New Password ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("div",{className:"relative",children:[a.jsx(Do,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),a.jsx("input",{type:"text",style:u?void 0:{WebkitTextSecurity:"disc"},value:_.confirmPassword,onChange:D=>A("confirmPassword",D.target.value),placeholder:"Confirm new password",className:"w-full pl-10 pr-10 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none",required:!0,minLength:8}),a.jsx("button",{type:"button",onClick:()=>d(D=>!D),className:"absolute inset-y-0 right-0 flex items-center pr-3 text-gray-700 hover:text-gray-900 focus:outline-none z-10 transition-colors cursor-pointer","aria-label":u?"Hide password":"Show password",children:u?a.jsx(Ru,{className:"size-5"}):a.jsx(md,{className:"size-5"})})]})]}),a.jsx("div",{className:"pt-4 border-t border-gray-200 flex justify-center lg:justify-start",children:a.jsxs("button",{type:"submit",className:"flex items-center justify-center gap-2 px-4 py-2 bg-gray-900 text-white rounded-md hover:bg-gray-800 transition disabled:opacity-70",disabled:h,children:[a.jsx(Do,{}),h?"Changing Password...":"Change Password"]})})]})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm p-6 mt-6",children:[a.jsxs("h2",{className:"text-xl font-semibold text-gray-800 flex items-center gap-2 mb-6 justify-center lg:justify-start",children:[a.jsx(j9,{className:"text-blue-600"}),"Account Information"]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Role"}),a.jsx("span",{className:"inline-block px-3 py-1 bg-blue-100 text-blue-700 text-sm font-semibold rounded-md",children:e.role.toUpperCase()==="CEO"&&"Admin"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Status"}),a.jsx("span",{className:`inline-block px-3 py-1 text-sm font-semibold rounded-md ${e.is_active?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:e.is_active?"Active":"Inactive"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Company"}),a.jsx("p",{className:"text-gray-800 font-medium",children:e.company?.company_name||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Auth Provider"}),a.jsx("p",{className:"text-gray-800 font-medium",children:e.auth_provider?e.auth_provider.charAt(0).toUpperCase()+e.auth_provider.slice(1):"N/A"})]}),e.created_at&&a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Account Created"}),a.jsx("p",{className:"text-gray-800 font-medium",children:new Date(e.created_at).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]}),e.last_login&&a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Last Login"}),a.jsx("p",{className:"text-gray-800 font-medium",children:new Date(e.last_login).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"})})]})]})]})]})]})}function LZ({selectedDeal:e,onStatusUpdate:t,onClose:n}){const[s,r]=f.useState(e?.stage||""),[i,o]=f.useState(!1),l=Et(),c=[{value:"PROSPECTING",label:"Prospecting"},{value:"QUALIFICATION",label:"Qualification"},{value:"PROPOSAL",label:"Proposal"},{value:"NEGOTIATION",label:"Negotiation"},{value:"CLOSED_WON",label:"Closed Won"},{value:"CLOSED_LOST",label:"Closed Lost"},{value:"CLOSED_CANCELLED",label:"Closed Cancelled"}];f.useEffect(()=>{e?.stage&&r(e.stage)},[e]);const u=async()=>{if(!e||!e.id){V.error("No deal selected");return}if(!s||s===e.stage){V.info("Please select a different stage");return}const d=e.id;o(!0);try{await ne.put(`/deals/admin/${d}`,{stage:s}),n&&n(),t&&setTimeout(async()=>{await t(!0)},100),setTimeout(()=>{V.success("Deal status updated successfully")},300)}catch(h){console.error(h);const p=h.response?.data?.detail||"Failed to update deal status";V.error(p)}finally{o(!1)}};return e?a.jsxs("div",{className:"space-y-4 font-inter text-[13px] w-full sm:w-[85%] mx-auto flex flex-col gap-4",children:[a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Quick Actions"}),a.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[a.jsxs("button",{onClick:()=>{const d=e.account?.id||e.account_id;l("/admin/calls",{state:{openCallModal:!0,initialCallData:{subject:e.name?`Call regarding: ${e.name}`:"",relatedType1:"Account",relatedTo1:d,relatedType2:"Deal",relatedTo2:e.id,contactId:e.contact?.id,assigned_to:e.assigned_deals?.id?String(e.assigned_deals.id):"",assignedTo:e.assigned_to?.id?String(e.assigned_to.id):""}}})},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(It,{className:"text-gray-600 w-4 h-4"}),"Schedule Call"]}),a.jsxs("button",{type:"button",onClick:()=>{if(!e.contact?.email){alert("No email address available");return}const d=encodeURIComponent(e.contact.email),h=encodeURIComponent(""),p=encodeURIComponent(""),x=`mailto:${d}?subject=${h}&body=${p}`;window.location.href=x},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(sn,{className:"text-gray-600 w-4 h-4"}),"Send E-mail"]}),a.jsxs("button",{className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",onClick:()=>{const d=e.account?.id||e.account_id;l("/admin/meetings",{state:{openMeetingModal:!0,initialMeetingData:{subject:e.name?`Meeting: ${e.name}`:"",relatedType1:"Account",relatedTo1:d,relatedType2:"Deal",relatedTo2:e.id,assignedTo:e.assigned_deals?.id?String(e.assigned_deals.id):""}}})},children:[a.jsx(Pt,{className:"text-gray-600 w-4 h-4"}),"Book Meeting"]}),a.jsxs("button",{onClick:()=>{const d=e.account?.id||e.account_id;l("/admin/tasks",{state:{openTaskModal:!0,initialTaskData:{subject:e.name?`Task for: ${e.name}`:"",relatedType1:"Account",relatedTo1:d,relatedType2:"Deal",relatedTo2:e.id,contactId:e.contact?.id,assignedTo:e.assigned_deals?.id?String(e.assigned_deals.id):"",priority:"NORMAL",status:"Not Started"}}})},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(Qt,{className:"text-gray-600 w-4 h-4"}),"Tasks"]})]})]}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm w-full",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Promote Deal"}),a.jsx("select",{className:"border border-gray-200 rounded-md px-2 sm:px-3 py-1.5 w-full text-sm mb-2 focus:ring-2 focus:ring-gray-300 focus:outline-none",value:s,onChange:d=>r(d.target.value),disabled:i,children:c.map(d=>a.jsx("option",{value:d.value,children:d.label},d.value))}),a.jsx("button",{className:"w-full bg-gray-900 text-white py-1.5 rounded-md text-sm hover:bg-gray-800 transition disabled:opacity-50 disabled:cursor-not-allowed",onClick:u,disabled:i||!s||s===e.stage,children:i?"Updating...":"Update"})]})]}):null}function DZ({selectedDeal:e,show:t,onClose:n,activeTab:s,setActiveTab:r,onEdit:i,onDelete:o,onStatusUpdate:l,relatedActs:c}){const u=Et(),[d]=Bs(),h=d.get("id"),[p,x]=f.useState(e||null),[b,j]=f.useState(s||"Overview"),[y,N]=f.useState(null),[w,S]=f.useState(""),{userRole:_}=Ks(),T=P=>{if(!P)return"";const B=String(P).split("-");return B.length===3?`${B[0]}-${B[2]}`:String(P)},k=P=>P?new Date(P).toLocaleString("en-US",{month:"short",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).replace(",",""):"",{comments:A,addComment:E,refresh:M}=kn({relatedType:"deal",relatedId:p?.id});f.useEffect(()=>{p?.id&&M()},[p?.id,M]);const F=s!==void 0?s:b;if(f.useEffect(()=>{_.toLowerCase()==="ceo"||_.toLowerCase()==="admin"?S("admin"):_.toLowerCase()==="group manager"||_.toLowerCase()==="group_manager"?S("group-manager"):_.toLowerCase()==="manager"?S("manager"):_.toLowerCase()==="sales"?S("sales"):S("guest")},[_]),f.useEffect(()=>{(async()=>{if(h&&!e)try{const $=((await ne.get("/deals/admin/fetch-all")).data||[]).find(W=>W.id===parseInt(h));if($){const W={...$,amount:typeof $.amount=="number"?$.amount:parseFloat($.amount||0),probability:$.probability||0};x(W)}else console.warn("Deal not found with ID:",h)}catch(B){console.error("Error fetching deal:",B)}})()},[h,e]),!p&&!h||h&&!p)return null;const D=P=>({PROSPECTING:"bg-blue-100 text-blue-700",QUALIFICATION:"bg-yellow-100 text-yellow-700",PROPOSAL:"bg-orange-100 text-orange-700",NEGOTIATION:"bg-purple-100 text-purple-700",CLOSED_WON:"bg-green-100 text-green-700",CLOSED_LOST:"bg-red-100 text-red-700"})[P]||"bg-gray-100 text-gray-700";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[9999] font-inter p-2 sm:p-4 overflow-x-hidden",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-lg w-full max-w-full sm:max-w-6xl max-h-[90vh] overflow-y-auto hide-scrollbar relative box-border",children:[a.jsx("div",{className:"bg-tertiary w-full rounded-t-xl p-3 lg:p-3",children:a.jsxs("div",{className:"flex items-start justify-between w-full",children:[a.jsx("h1",{className:"lg:text-3xl text-xl text-white font-semibold text-center w-full",children:"Deal"}),a.jsx("div",{className:"flex items-center gap-2 sm:gap-3",children:a.jsx("button",{onClick:()=>{n?n():u(-1)},className:"text-gray-400 hover:text-white mt-1 cursor-pointer",children:a.jsx(ea,{size:25})})})]})}),a.jsx("div",{className:"p-4 lg:p-2 lg:mx-7",children:a.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-2 sm:gap-3 mt-3",children:[a.jsxs("div",{className:"flex flex-col gap-1",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3 lg:gap-1",children:[a.jsxs("h2",{className:"text-xl lg:text-xl font-semibold text-gray-800 break-words",children:[T(p.deal_id)," - ",p.name]}),a.jsx("span",{className:`text-xs sm:text-sm inline-block font-medium px-1.5 py-0.5 sm:px-3 sm:py-1 rounded-full break-words ${D(p.stage)}`,children:p.stage})]}),a.jsxs("p",{className:"text-gray-500 text-sm break-words",children:["Created on ",k(p.created_at)]})]}),a.jsxs("div",{className:"flex flex-col items-end gap-2",children:[a.jsxs("h2",{className:"text-xl sm:text-2xl font-bold text-gray-600 break-words",children:[""," ",p.amount?p.amount.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):"0.00"]}),a.jsx("div",{className:"w-full sm:w-40 bg-gray-200 rounded-full h-2",children:a.jsx("div",{className:"bg-green-500 h-2 rounded-full",style:{width:`${p.probability}%`}})}),a.jsxs("p",{className:"text-xs text-gray-500 break-words",children:[" ",p.probability,"% Complete"," "]}),a.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 mt-3",children:[a.jsxs("button",{type:"button",onClick:()=>{i&&i(p)},className:"inline-flex items-center justify-center bg-blue-500 text-white px-3 sm:px-4 py-1.5 sm:py-2 rounded-md hover:bg-blue-600 transition text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",children:[a.jsx(hn,{className:"mr-1 sm:mr-2",size:16}),a.jsx("span",{className:"hidden sm:inline",children:"Edit"})]}),a.jsxs("button",{type:"button",onClick:()=>{o&&o(p)},className:"inline-flex items-center justify-center px-3 sm:px-4 py-1.5 sm:py-2 rounded-md text-sm bg-red-500 text-white hover:bg-red-600 transition focus:outline-none focus:ring-2 focus:ring-red-400",children:[a.jsx(_a,{className:"mr-1 sm:mr-2",size:16}),a.jsx("span",{className:"hidden sm:inline",children:"Delete"})]})]})]})]})}),a.jsx("div",{className:"border-b border-gray-200 my-5"}),a.jsxs("div",{className:"p-6 lg:p-4",children:[a.jsx("div",{className:"flex w-full bg-[#6A727D] text-white mt-1 overflow-x-auto mb-6",children:["Overview","Notes","Activities"].map(P=>a.jsx("button",{onClick:()=>{r?r(P):j(P)},className:`flex-1 min-w-[90px] px-4 py-2.5 text-xs sm:text-sm font-medium text-center transition-all duration-200 border-b-2
                ${F===P?"bg-paper-white text-[#6A727D] border-white":"text-white hover:bg-[#5c636d]"}`,children:P},P))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 items-start",children:[a.jsxs("div",{className:"lg:col-span-3 space-y-6",children:[F==="Overview"&&a.jsxs("div",{className:"grid md:grid-cols-2 gap-4 sm:gap-6 w-full",children:[a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 sm:p-5 shadow-sm pb-20 break-words",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 sm:mb-3",children:"Deal Information"}),a.jsxs("p",{className:"text-sm sm:text-sm text-gray-700 mb-2 py-5 break-words",children:[a.jsx("strong",{children:"Description:"})," ",p.description]}),a.jsx("div",{className:"h-px bg-gray-200 w-full"}),a.jsxs("p",{className:"text-sm sm:text-sm text-gray-700 mb-2 py-5 break-words",children:[a.jsx("strong",{children:"Expected Close Date:"})," ",k(p.close_date)||"--"]}),a.jsx("div",{className:"h-px bg-gray-200 w-full"}),a.jsxs("div",{className:"mt-4 py-3 w-full",children:[a.jsxs("div",{className:"relative flex flex-col w-full",children:[a.jsx("div",{className:"absolute top-0 left-0 right-0 flex items-center justify-between w-full",children:(()=>{const P=(p?.stage||"PROSPECTING").toUpperCase(),G=(W=>W==="PROSPECTING"?0:W==="QUALIFICATION"?1:W==="PROPOSAL"?2:W==="NEGOTIATION"?3:W==="CLOSED_WON"||W==="CLOSED_LOST"?4:-1)(P);return[0,1,2,3,4].map(W=>G===W?"orange":G>W?"green":"gray").map((W,Z)=>a.jsxs(wt.Fragment,{children:[a.jsx("div",{className:`relative z-10 w-6 h-6 rounded-full border-2 ${W==="green"?"bg-green-500 border-green-500":W==="orange"?"bg-orange-400 border-orange-400":"bg-gray-300 border-gray-300"}`}),Z<4&&a.jsx("div",{className:"flex-grow h-1 bg-gray-200 mx-1 min-w-0"})]},Z))})()}),a.jsx("div",{className:"flex justify-between mt-8 gap-2 text-[9px] lg:text-[9px] sm:text-xs text-gray-600 w-full",children:["Prospecting","Qualification","Proposal","Negotiation","Closed"].map((P,B)=>a.jsx("span",{className:"text-center flex-1 break-words",children:P},B))})]}),a.jsx("p",{className:"text-sm text-orange-600 font-medium mt-6 text-center break-words",children:p.stage})]})]}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 sm:p-5 shadow-sm break-words",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-3",children:"Contact Information"}),a.jsxs("div",{className:"text-sm sm:text-sm text-gray-700 space-y-3",children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Account:"})," ",p.account?.name]}),a.jsx("div",{className:"h-px bg-gray-200 w-full"}),a.jsxs("p",{children:[a.jsx("strong",{children:"Primary Contact:"})," ",p.contact?.first_name," ",p.contact?.last_name]}),a.jsx("div",{className:"h-px bg-gray-200 w-full"}),a.jsxs("p",{children:[a.jsx("strong",{children:"Phone:"})," ",p.contact?.work_phone]}),a.jsx("div",{className:"h-px bg-gray-200 w-full"}),a.jsxs("p",{children:[a.jsx("strong",{children:"Email:"})," ",p.contact?.email]}),a.jsx("div",{className:"h-px bg-gray-200 w-full"}),a.jsxs("p",{children:[a.jsx("strong",{children:"Assigned To:"})," ",p.assigned_deals?.first_name," ",p.assigned_deals?.last_name]})]})]})]}),F==="Notes"&&a.jsxs("div",{className:"mt-4 w-full",children:[a.jsx("div",{className:"flex flex-wrap items-center justify-between mb-4 gap-2",children:a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words",children:"Deal Note"})}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 shadow-sm break-words",children:[a.jsx("div",{className:"flex items-start justify-between",children:a.jsx("div",{children:a.jsx("p",{className:"text-sm font-medium text-gray-800 break-words",children:"Note"})})}),a.jsx("div",{className:"mt-3 text-sm text-gray-700 whitespace-pre-wrap break-words",children:p.description||"No notes available."})]}),a.jsx(Tn,{comments:A,onAddComment:E})]}),s==="Activities"&&a.jsxs("div",{className:"space-y-2 w-full h-full max-h-[50dvh] overflow-y-auto bg-gray-50 p-2 hide-scrollbar rounded-lg border border-gray-200 shadow-sm",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words border-b border-gray-300 py-2",children:"Related Activities"}),a.jsxs("div",{className:"space-y-2 text-sm",children:[c.tasks&&c.tasks.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>N(y==="tasks"?null:"tasks"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Qt,{className:"text-blue-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Tasks (",c.tasks.length,")"]})]}),y==="tasks"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),y==="tasks"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:c.tasks.map((P,B)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>u(`/${w}/tasks`,{state:{taskID:P.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-blue-600 mt-1",children:a.jsx(Qt,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:P.subject||P.title||"Task"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:P.description||"No description"}),P.assigned_to&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Assigned: ",P.assigned_to.first_name," ",P.assigned_to.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:k(P.due_date||P.created_at)})]},`task-${B}`))})]}),c.meetings&&c.meetings.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>N(y==="meetings"?null:"meetings"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Pt,{className:"text-green-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Meetings (",c.meetings.length,")"]})]}),y==="meetings"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),y==="meetings"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:c.meetings.map((P,B)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>u(`/${w}/meetings`,{state:{meetingID:P.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-green-600 mt-1",children:a.jsx(Pt,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:P.subject||P.title||"Meeting"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:P.description||P.location||"No description"}),P.host&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Host: ",P.host.first_name," ",P.host.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:k(P.start_time||P.created_at)})]},`meeting-${B}`))})]}),c.calls&&c.calls.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>N(y==="calls"?null:"calls"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(It,{className:"text-purple-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Calls (",c.calls.length,")"]})]}),y==="calls"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),y==="calls"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:c.calls.map((P,B)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>u(`/${w}/calls`,{state:{callID:P.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-purple-600 mt-1",children:a.jsx(It,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:P.subject||P.title||"Call"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:P.direction||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:k(P.call_time||P.created_at)})]},`call-${B}`))})]}),c.quotes&&c.quotes.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>N(y==="quotes"?null:"quotes"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ia,{className:"text-orange-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Quotes (",c.quotes.length,")"]})]}),y==="quotes"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),y==="quotes"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:c.quotes.map((P,B)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>u(`/${w}/quotes`,{state:{quoteID:P.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-orange-600 mt-1",children:a.jsx(ia,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:(P.quote_id?P.quote_id.replace(/Q(\d+)-\d+-/,"Q$1-"):"--")||"Quote"}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:P.status||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:k(P.presented_date)||""})]},`quote-${B}`))})]}),(!c||(!c.tasks||c.tasks.length===0)&&(!c.meetings||c.meetings.length===0)&&(!c.calls||c.calls.length===0)&&(!c.quotes||c.quotes.length===0)&&(!c.deals||c.deals.length===0)&&(!c.contacts||c.contacts.length===0))&&a.jsx("div",{className:"text-center py-8 text-gray-500",children:a.jsx("p",{children:"No related activities found for this account."})})]})]}),F==="Edit"&&a.jsxs("div",{className:"mt-4 space-y-4 w-full",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words",children:"Edit Deal"}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 sm:p-5 shadow-sm w-full",children:[a.jsxs("label",{className:"block mb-3 break-words",children:[a.jsx("span",{className:"text-sm text-gray-700",children:"Deal Name"}),a.jsx("input",{type:"text",className:"mt-1 block w-full border border-gray-200 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-gray-200",defaultValue:p.name})]}),a.jsxs("label",{className:"block mb-3 break-words",children:[a.jsx("span",{className:"text-sm text-gray-700",children:"Description"}),a.jsx("textarea",{className:"mt-1 block w-full border border-gray-200 rounded-md px-3 py-2 text-sm h-24 resize-y focus:outline-none focus:ring-2 focus:ring-gray-200",defaultValue:p.description})]}),a.jsx("button",{className:"bg-gray-900 text-white px-4 py-2 rounded-md hover:bg-gray-800",children:"Save Changes"})]})]})]}),a.jsx("div",{className:"w-full lg:w-auto",children:a.jsx(LZ,{selectedDeal:p,onStatusUpdate:l,onClose:n})})]})]})]})})}function p6e(){f.useEffect(()=>{document.title="Deals | Sari-Sari CRM"},[]);const e=Et(),t=ta(),[n,s]=f.useState(""),[r,i]=f.useState("Filter by Stage"),[o,l]=f.useState("Filter by Owner"),[c,u]=f.useState(null),[d,h]=f.useState("Overview"),[p,x]=f.useState(!1),[b,j]=f.useState(null),[y,N]=f.useState(!1),[w,S]=f.useState(1),[_,T]=f.useState(10),[k,A]=f.useState(!1),[E,M]=f.useState(null),[F,D]=f.useState(!1),[P,B]=f.useState([]),[G,$]=f.useState(!1),[W,Z]=f.useState(null),[Q,le]=f.useState([]),[we,J]=f.useState([]),[se,ye]=f.useState([]),[Ce,ge]=f.useState({}),[be,me]=f.useState(null);f.useEffect(()=>{const q=t.state,Y=q?.dealID;if(Y&&!q?.openDealModal){me(Y),e(t.pathname,{replace:!0,state:{}});return}},[t,e]),f.useEffect(()=>{if(be&&b?.length>0&&!y){const q=b.find(Y=>Y.id===be);q?u(q):V.error("Deal not found."),me(null)}},[be,b,y]);const[Ae,pe]=f.useState({id:null,name:"",account_id:"",primary_contact_id:"",stage:"PROPOSAL",amount:"",close_date:"",assigned_to:"",currency:"PHP",description:""}),Ie="dealDraft:admin/deals",xe=3600*1e3,he=f.useRef(!1);f.useEffect(()=>{if(!he.current){he.current=!0;try{const q=sessionStorage.getItem(Ie);if(!q)return;const Y=JSON.parse(q);if(typeof Y?.ts=="number"&&Date.now()-Y.ts>xe){sessionStorage.removeItem(Ie);return}if(Y?.returnTo&&Y.returnTo!==t.pathname)return;Y?.dealForm&&typeof Y.dealForm=="object"&&pe(Y.dealForm),typeof Y?.isEditing=="boolean"&&$(Y.isEditing),Y?.currentDealId!==void 0&&Z(Y.currentDealId),x(!0),sessionStorage.removeItem(Ie)}catch{sessionStorage.removeItem(Ie)}}},[t.pathname]);const Re=f.useCallback(()=>{try{sessionStorage.setItem(Ie,JSON.stringify({ts:Date.now(),returnTo:t.pathname,dealForm:Ae,isEditing:G,currentDealId:W}))}catch{}},[Ie,t.pathname,Ae,G,W]),Ee=f.useCallback(()=>{Re(),window.open("/admin/accounts?openModal=1","_blank","noopener,noreferrer")},[Re]),He=f.useCallback(()=>{Re(),window.open("/admin/contacts?openModal=1","_blank","noopener,noreferrer")},[Re]),Ke={"Prospecting Stage":"PROSPECTING","Qualification Stage":"QUALIFICATION","Proposal Stage":"PROPOSAL","Negotiation Stage":"NEGOTIATION","Closed Won Stage":"CLOSED_WON","Closed Lost Stage":"CLOSED_LOST","Closed Cancelled Stage":"CLOSED_CANCELLED"},st=q=>({PROSPECTING:"Prospecting",QUALIFICATION:"Qualification",PROPOSAL:"Proposal",NEGOTIATION:"Negotiation",CLOSED_WON:"Closed Won",CLOSED_LOST:"Closed Lost",CLOSED_CANCELLED:"Closed Cancelled"})[q]||q||"--",it=q=>({PROSPECTING:"bg-blue-100 text-blue-700",QUALIFICATION:"bg-yellow-100 text-yellow-700",PROPOSAL:"bg-orange-100 text-orange-700",NEGOTIATION:"bg-purple-100 text-purple-700",CLOSED_WON:"bg-green-100 text-green-700",CLOSED_LOST:"bg-red-100 text-red-700",CLOSED_CANCELLED:"bg-red-100 text-red-700"})[q]||"bg-gray-100 text-gray-700",ot=f.useCallback(async q=>{try{const Y=await ne.get(`/activities/deal/${q}`);ge(Y.data&&typeof Y.data=="object"?Y.data:{})}catch(Y){console.error(Y),Y.response?.status===404&&(console.warn("No activities found for this account."),ge({}))}},[]),rt=q=>{if(!q)return"";const Y=String(q).split("-");return Y.length===3?`${Y[0]}-${Y[2]}`:String(q)},at=f.useMemo(()=>{const q=n.trim().toLowerCase(),Y=r.trim(),U=o.trim();return(b??[]).filter(de=>{const Te=[de?.deal_id,rt(de?.deal_id),de?.id?.toString(),de?.name,de?.description,de?.account?.name,de?.contact?.first_name,de?.contact?.last_name,st(de?.stage),de?.stage,de?.amount?.toString(),de?.close_date,de?.assigned_deals?.first_name,de?.assigned_deals?.last_name],ie=q===""||Te.some(oe=>oe==null||oe===""?!1:oe.toString().toLowerCase().includes(q)),Oe=Y==="Filter by Stage"||Y===""||de.stage===Ke[Y]||de.stage===Y,X=U==="Filter by Owner"||U===""||`${de.assigned_deals?.first_name||""} ${de.assigned_deals?.last_name||""}`.trim().toLowerCase()===U.toLowerCase();return ie&&Oe&&X})},[b,n,r,o]),Je=Math.max(1,Math.ceil(at.length/_)||1);f.useEffect(()=>{S(1)},[n,r,o,_]),f.useEffect(()=>{S(q=>{const Y=Math.max(1,Math.ceil(at.length/_)||1);return q>Y?Y:q})},[at.length,_]);const Fe=f.useMemo(()=>{const q=(w-1)*_;return at.slice(q,q+_)},[at,w,_]),Ue=()=>S(q=>Math.max(q-1,1)),Ne=()=>S(q=>Math.min(q+1,Je)),ze=()=>{pe({id:null,name:"",account_id:"",primary_contact_id:"",stage:"PROPOSAL",amount:"",close_date:"",assigned_to:"",currency:"PHP",description:""}),$(!1),Z(null),x(!0)},je=async()=>{N(!0);try{const q=await ne.get("/deals/admin/fetch-all"),U=[...Array.isArray(q.data)?q.data:[]].sort((de,Te)=>{const ie=de?.created_at?new Date(de.created_at).getTime():0;return(Te?.created_at?new Date(Te.created_at).getTime():0)-ie});j(U)}catch(q){q.response&&q.response.status===403?V.error("Permission denied. Only CEO, Admin, or Group Manager can access this page."):V.error("Failed to fetch deals. Please try again later."),console.error(q)}finally{N(!1)}},ve=async()=>{try{const q=await ne.get("/accounts/admin/fetch-all");le(Array.isArray(q.data)?q.data:[])}catch(q){console.error(q),q.response?.status===403&&V.warn("Unable to load accounts (permission denied).")}},z=async()=>{try{const q=await ne.get("/contacts/admin/fetch-all");J(Array.isArray(q.data)?q.data:[])}catch(q){console.error(q),q.response?.status===403&&V.warn("Unable to load contacts (permission denied).")}},K=async()=>{try{const q=await ne.get("/users/all");ye(Array.isArray(q.data)?q.data:[])}catch(q){console.error(q),q.response?.status===403&&V.warn("Unable to load users (permission denied).")}};f.useEffect(()=>{je(),ve(),z(),K()},[]);const ue=q=>{q&&(pe({id:q.id||null,name:q.name||"",account_id:q.account_id?.toString()||"",primary_contact_id:q.primary_contact_id?.toString()||"",stage:q.stage||"PROPOSAL",amount:q.amount?.toString()||"",close_date:q.close_date?new Date(q.close_date).toISOString().split("T")[0]:"",assigned_to:q.assigned_to?.toString()||"",currency:q.currency||"PHP",description:q.description||""}),$(!0),Z(q.id),u(null),x(!0))},re=async(q=!1)=>{try{const Y=await ne.get("/deals/admin/fetch-all"),de=[...Array.isArray(Y.data)?Y.data:[]].sort((Te,ie)=>{const Oe=Te?.created_at?new Date(Te.created_at).getTime():0;return(ie?.created_at?new Date(ie.created_at).getTime():0)-Oe});if(j(de),!q&&c&&c.id){const Te=de.find(ie=>ie.id===c.id);Te&&u({...Te})}}catch(Y){console.error("Failed to refresh deal data:",Y),await je()}},Le=q=>{const Y=q.name.trim();if(!Y){V.error("Deal name is required.");return}if(!q.account_id){V.error("Account is required.");return}const U=G&&W?"update":"create",de=Y;M({title:U==="create"?"Confirm New Deal":"Confirm Update",message:U==="create"?a.jsxs("span",{children:["Are you sure you want to create"," ",a.jsx("span",{className:"font-semibold",children:de}),"?"]}):a.jsxs("span",{children:["Save changes to ",a.jsx("span",{className:"font-semibold",children:de}),"?"]}),confirmLabel:U==="create"?"Create Deal":"Update Deal",cancelLabel:"Cancel",variant:"primary",action:{type:U,formData:q,targetId:W||null,name:de}})},De=q=>{if(!q)return;const Y=q.name||"this deal";M({title:"Delete Deal",message:a.jsxs("span",{children:["Are you sure you want to permanently delete"," ",a.jsx("span",{className:"font-semibold",children:Y}),"? This action cannot be undone."]}),confirmLabel:"Delete Deal",cancelLabel:"Cancel",variant:"danger",action:{type:"delete",targetId:q.id,name:Y}})},Qe=q=>{if(q.target.checked){const Y=Fe.map(U=>U.id);B(Y)}else B([])},tt=q=>{B(Y=>Y.includes(q)?Y.filter(U=>U!==q):[...Y,q])},Me=async()=>{P.length!==0&&M({title:"Delete Deals",message:a.jsxs("span",{children:["Are you sure you want to delete"," ",a.jsx("span",{className:"font-semibold",children:P.length})," selected deals? This action cannot be undone."]}),confirmLabel:`Delete ${P.length} Deal(s)`,cancelLabel:"Cancel",variant:"danger",action:{type:"bulk-delete",dealIds:P}})},et=async()=>{if(!E?.action){M(null);return}const{action:q}=E,{type:Y,formData:U,targetId:de,name:Te}=q;D(!0);try{if(Y==="create"){A(!0);const ie={name:U.name.trim(),account_id:parseInt(U.account_id),primary_contact_id:U.primary_contact_id?parseInt(U.primary_contact_id):null,stage:U.stage,amount:U.amount?parseFloat(U.amount):null,currency:U.currency||"PHP",close_date:U.close_date||null,description:U.description||null,assigned_to:U.assigned_to?parseInt(U.assigned_to):null};await ne.post("/deals/admin/create",ie),V.success(`Deal "${Te}" created successfully.`),x(!1),await je()}else if(Y==="update"){if(!de)throw new Error("Missing deal identifier for update.");A(!0);const ie={};U.name!==void 0&&(ie.name=U.name.trim()),U.account_id!==void 0&&U.account_id!==""&&(ie.account_id=parseInt(U.account_id)),U.primary_contact_id!==void 0&&(ie.primary_contact_id=U.primary_contact_id?parseInt(U.primary_contact_id):null),U.stage!==void 0&&(ie.stage=U.stage),U.amount!==void 0&&U.amount!==""&&(ie.amount=parseFloat(U.amount)),U.currency!==void 0&&(ie.currency=U.currency),U.close_date!==void 0&&(ie.close_date=U.close_date||null),U.description!==void 0&&(ie.description=U.description||null),U.assigned_to!==void 0&&(ie.assigned_to=U.assigned_to?parseInt(U.assigned_to):null),await ne.put(`/deals/admin/${de}`,ie),V.success(`Deal "${Te}" updated successfully.`),x(!1),await je()}else if(Y==="delete"){if(!de)throw new Error("Missing deal identifier for deletion.");await ne.delete(`/deals/admin/${de}`),V.success(`Deal "${Te}" deleted successfully.`),c?.id===de&&u(null),await je()}else if(Y==="bulk-delete"){const{dealIds:ie}=q;await ne.delete("/deals/admin/bulk-delete",{data:{deal_ids:ie}}),V.success(`Successfully deleted ${ie.length} deals`),B([]),await je()}}catch(ie){console.error(ie);const Oe=Y==="create"?"Failed to create deal. Please review the details and try again.":Y==="update"?"Failed to update deal. Please review the details and try again.":"Failed to delete deal. Please try again.",X=ie.response?.data?.detail||Oe;V.error(X)}finally{(Y==="create"||Y==="update")&&A(!1),D(!1),M(null)}},yt=()=>{F||M(null)},_t=()=>{x(!1),pe({id:null,name:"",account_id:"",primary_contact_id:"",stage:"PROPOSAL",amount:"",close_date:"",assigned_to:"",currency:"PHP",description:""}),$(!1),Z(null),A(!1)},Ct=q=>q?new Date(q).toLocaleString("en-US",{month:"short",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).replace(",",""):"",jt=(b??[]).filter(q=>q.stage==="PROSPECTING"&&q.status!=="Inactive").length,At=(b??[]).filter(q=>q.stage==="QUALIFICATION"&&q.status!=="Inactive").length,Ge=(b??[]).filter(q=>q.stage==="PROPOSAL"&&q.status!=="Inactive").length,Be=(b??[]).filter(q=>q.stage==="NEGOTIATION"&&q.status!=="Inactive").length,ce=(b??[]).filter(q=>q.stage==="CLOSED_WON"&&q.status!=="Inactive").length,fe=(b??[]).filter(q=>q.stage==="CLOSED_LOST"&&q.status!=="Inactive").length,H=(b??[]).filter(q=>q.stage==="CLOSED_CANCELLED"&&q.status!=="Inactive").length,te=[{title:"Prospecting",value:jt,icon:Nj,color:"text-blue-600",bgColor:"bg-blue-100"},{title:"Qualification",value:At,icon:gn,color:"text-yellow-600",bgColor:"bg-yellow-100"},{title:"Proposal",value:Ge,icon:sa,color:"text-orange-600",bgColor:"bg-orange-100"},{title:"Negotiation",value:Be,icon:cd,color:"text-purple-600",bgColor:"bg-purple-100"},{title:"Closed Won",value:ce,icon:La,color:"text-green-600",bgColor:"bg-green-100"},{title:"Closed Lost",value:fe,icon:Yn,color:"text-red-600",bgColor:"bg-red-100"},{title:"Closed Cancelled",value:H,icon:Yn,color:"text-gray-600",bgColor:"bg-gray-100"}];return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[y&&a.jsx(qt,{message:"Loading deals..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h1",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(sa,{className:"mr-2 text-blue-600"}),"Deals"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{onClick:ze,className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 lg:my-0 rounded-md hover:bg-gray-800 text-sm sm:text-base mx-auto sm:ml-auto cursor-pointer",children:[a.jsx(aa,{className:"mr-2"})," Add Deal"]})})]}),a.jsx("div",{className:"grid grid-cols-1 p-2 lg:grid-cols-4 gap-4 mb-6 w-full break-words overflow-hidden",children:te.map(q=>a.jsx(y6e,{...q},q.title))}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search deals",value:n,onChange:q=>s(q.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsxs("div",{className:"w-full lg:w-auto flex flex-col lg:flex-row gap-3",children:[a.jsxs("select",{value:r,onChange:q=>i(q.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full lg:w-40 focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{value:"Filter by Stage",children:"Filter by Stage"}),a.jsx("option",{value:"Prospecting Stage",children:"Prospecting"}),a.jsx("option",{value:"Qualification Stage",children:"Qualification"}),a.jsx("option",{value:"Proposal Stage",children:"Proposal"}),a.jsx("option",{value:"Negotiation Stage",children:"Negotiation"}),a.jsx("option",{value:"Closed Won Stage",children:"Closed Won"}),a.jsx("option",{value:"Closed Lost Stage",children:"Closed Lost"}),a.jsx("option",{value:"Closed Cancelled Stage",children:"Closed Cancelled"})]}),a.jsxs("select",{value:o,onChange:q=>l(q.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full lg:w-40 focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{value:"Filter by Owner",children:"Filter by Owner"}),[...new Set((b??[]).map(q=>`${q.assigned_deals?.first_name} ${q.assigned_deals?.last_name}`))].map((q,Y)=>a.jsx("option",{value:q,children:q},Y))]})]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[500px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 text-sm tracking-wide font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 w-10",children:a.jsx("input",{type:"checkbox",className:"w-4 h-4 accent-blue-600",checked:Fe.length>0&&Fe.every(q=>P.includes(q.id)),onChange:Qe})}),a.jsx("th",{className:"py-3 px-4",children:"Deal ID"}),a.jsx("th",{className:"py-3 px-4 truncate",children:"Deal Name"}),a.jsx("th",{className:"py-3 px-4",children:"Account"}),a.jsx("th",{className:"py-3 px-4",children:"Contact"}),a.jsx("th",{className:"py-3 px-4 w-48",children:"Stage/Status"}),a.jsx("th",{className:"py-3 px-4 w-48",children:"Value"}),a.jsx("th",{className:"py-3 px-4",children:"Close Date"}),a.jsx("th",{className:"py-3 px-4",children:"Owner"}),a.jsx("th",{className:"py-3 px-4 text-center w-24",children:P.length>0?a.jsx("button",{onClick:Me,className:"text-red-600 hover:text-red-800 transition p-1 rounded-full hover:bg-red-50",title:`Delete ${P.length} selected items`,children:a.jsx(_a,{size:18})}):""})]})}),a.jsx("tbody",{children:at.length>0?Fe.map(q=>a.jsxs("tr",{className:"hover:bg-gray-50 text-sm cursor-pointer",onClick:()=>{u({...q}),ot(q.id)},children:[a.jsx("td",{className:"py-3 px-4",onClick:Y=>Y.stopPropagation(),children:a.jsx("input",{type:"checkbox",className:"w-4 h-4 accent-blue-600",checked:P.includes(q.id),onChange:()=>tt(q.id)})}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",children:rt(q.deal_id)}),a.jsx("td",{className:"py-3 px-4",children:a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-blue-600 hover:underline break-all text-sm",children:q.name}),a.jsx("div",{className:"text-gray-500 text-xs break-all",children:q.description||"--"})]})}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",children:q.account?.name||"--"}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",children:q.contact?.first_name&&q.contact?.last_name?`${q.contact.first_name} ${q.contact.last_name}`:q.contact?.first_name||q.contact?.last_name||"--"}),a.jsx("td",{className:"py-3 px-4 w-48",children:q.status==="Inactive"?a.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-gray-300 text-gray-800",children:"Inactive"}):a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${it(q.stage)}`,children:st(q.stage)})}),a.jsxs("td",{className:"py-3 px-4 w-48 text-gray-800 font-medium text-sm",children:[" ",q.amount?.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})||"0.00"]}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",children:Ct(q.close_date)||"--"}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",children:q.assigned_deals?.first_name&&q.assigned_deals?.last_name?`${q.assigned_deals.first_name} ${q.assigned_deals.last_name}`:q.assigned_deals?.first_name||q.assigned_deals?.last_name||"--"})]},q.id)):a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:8,children:"No deals found."})})})]})}),a.jsx(ca,{className:"mt-4",totalItems:at.length,pageSize:_,currentPage:w,onPrev:Ue,onNext:Ne,onPageSizeChange:q=>{T(q),S(1)},pageSizeOptions:[10,20,30,40,50],label:"deals"}),p&&a.jsx(b6e,{onClose:_t,formData:Ae,setFormData:pe,isEditing:G,onSubmit:Le,isSubmitting:k||F,accounts:Q,contacts:we,users:se,onAddAccount:Ee,onAddContact:He,onRefreshAccounts:ve,onRefreshContacts:z}),c&&a.jsx(DZ,{relatedActs:Ce,selectedDeal:c,show:!!c,onClose:()=>u(null),activeTab:d,setActiveTab:h,onEdit:ue,onDelete:De,onStatusUpdate:re}),E&&a.jsx(x6e,{open:!0,title:E.title,message:E.message,confirmLabel:E.confirmLabel,cancelLabel:E.cancelLabel,variant:E.variant,onConfirm:et,onCancel:yt,loading:F})]})}function x6e({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o=!1,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[10000]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsx("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${u}`,disabled:o,children:o?"Processing...":s})]})]})})}function y6e({icon:e,title:t,value:n,color:s="text-blue-600",bgColor:r="bg-blue-100",onClick:i}){const o=()=>{typeof i=="function"?i():console.log(`Clicked: ${t}`)};return a.jsxs("div",{className:"flex items-center p-4 bg-white rounded-xl shadow-md border border-gray-200 transition-all duration-300",onClick:o,children:[a.jsx("div",{className:`flex-shrink-0 p-3 rounded-full ${r} ${s} mr-4`,children:e?a.jsx(e,{size:22}):null}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:t}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:n})]})]})}function b6e({onClose:e,formData:t,setFormData:n,isEditing:s=!1,onSubmit:r,isSubmitting:i=!1,accounts:o=[],contacts:l=[],users:c=[],onAddAccount:u,onAddContact:d,onRefreshAccounts:h,onRefreshContacts:p}){const[x,b]=f.useState(!1),j=w=>{if(w.preventDefault(),b(!0),!t.name?.trim()){V.error("Deal name is required.");return}const S=Number(t.amount);if(!t.amount||isNaN(S)||S<=0){V.error("Amount must be a number greater than 0.");return}if(!t.account_id){V.error("Please select an account.");return}if(!t.primary_contact_id){V.error("Please select a primary contact.");return}if(!t.assigned_to){V.error("Please assign this deal to a user.");return}r?.(t)},y=w=>{w.target.id==="modalBackdrop"&&e()},N=f.useMemo(()=>{const w=String(t.account_id||"").trim(),S=Array.isArray(l)?l:[];return w?S.filter(_=>{const k=[_?.account_id,_?.accountId,_?.account?.id,_?.account?.account_id,_?.account?.accountId].find(A=>A!=null&&String(A).trim()!=="");return k?String(k)===w:!1}):S},[l,t.account_id]);return f.useEffect(()=>{const w=String(t.account_id||"").trim(),S=String(t.primary_contact_id||"").trim();if(!S||!w)return;N.some(T=>String(T?.id)===S)||n(T=>({...T,primary_contact_id:""}))},[t.account_id,t.primary_contact_id,N,n]),a.jsx("div",{id:"modalBackdrop",onClick:y,className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-full sm:max-w-3xl rounded-2xl shadow-lg p-4 sm:p-6 md:p-8 relative border border-gray-200 overflow-y-auto max-h-[90vh] hide-scrollbar",onClick:w=>w.stopPropagation(),children:[a.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-gray-500 hover:text-black transition",children:a.jsx(ea,{size:22})}),a.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800 mb-4 sm:mb-6 flex items-center justify-center",children:s?"Edit Deal":"Create Deal"}),a.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",onSubmit:j,noValidate:!0,children:[a.jsx(NA,{label:"Deal Name",name:"name",value:t.name,onChange:w=>n({...t,name:w.target.value}),placeholder:"Enter deal name",required:!0,isSubmitted:x,className:"md:col-span-2"}),a.jsx(CA,{label:"Account",value:t.account_id||"",onChange:w=>n({...t,account_id:w}),items:o||[],getLabel:w=>w?.name??"",placeholder:"Search account...",disabled:i,required:!0,isSubmitted:x,actions:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{type:"button",onClick:u,disabled:i,title:"Add account",className:"inline-flex items-center justify-center w-8 h-8 rounded-md border border-gray-300 text-gray-600 hover:bg-gray-50 transition disabled:opacity-60",children:a.jsx(aa,{size:16})}),a.jsx("button",{type:"button",onClick:h,disabled:i,title:"Refresh accounts",className:"inline-flex items-center justify-center w-8 h-8 rounded-md border border-gray-300 text-gray-600 hover:bg-gray-50 transition disabled:opacity-60",children:a.jsx(Br,{size:16})})]})}),a.jsx(CA,{label:"Primary Contact",value:t.primary_contact_id||"",onChange:w=>n({...t,primary_contact_id:w}),items:N||[],getLabel:w=>`${w?.first_name??""} ${w?.last_name??""}`.trim()||w?.email||"",placeholder:"Search contact...",required:!0,isSubmitted:x,disabled:i,actions:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{type:"button",onClick:d,disabled:i,title:"Add contact",className:"inline-flex items-center justify-center w-8 h-8 rounded-md border border-gray-300 text-gray-600 hover:bg-gray-50 transition disabled:opacity-60",children:a.jsx(aa,{size:16})}),a.jsx("button",{type:"button",onClick:p,disabled:i,title:"Refresh contacts",className:"inline-flex items-center justify-center w-8 h-8 rounded-md border border-gray-300 text-gray-600 hover:bg-gray-50 transition disabled:opacity-60",children:a.jsx(Br,{size:16})})]})}),a.jsx(Y7,{label:"Stage",name:"stage",value:t.stage,onChange:w=>n({...t,stage:w.target.value}),options:[{value:"PROSPECTING",label:"Prospecting"},{value:"QUALIFICATION",label:"Qualification"},{value:"PROPOSAL",label:"Proposal"},{value:"NEGOTIATION",label:"Negotiation"},{value:"CLOSED_WON",label:"Closed Won"},{value:"CLOSED_LOST",label:"Closed Lost"},{value:"CLOSED_CANCELLED",label:"Closed Cancelled"}],disabled:i}),a.jsx(NA,{label:"Amount",name:"amount",type:"text",inputMode:"decimal",value:t.amount,onChange:w=>{let S=w.target.value;S.startsWith(".")&&(S="0"+S),!(S&&!/^\d*\.?\d*$/.test(S))&&n({...t,amount:S})},placeholder:"0.00",required:!0,isSubmitted:x}),a.jsx(Y7,{label:"Currency",name:"currency",value:t.currency||"PHP",onChange:w=>n({...t,currency:w.target.value}),options:[{value:"PHP",label:"PHP"},{value:"USD",label:"USD"}],disabled:i}),a.jsx(NA,{label:"Close Date",name:"close_date",type:"date",value:t.close_date||"",onChange:w=>n({...t,close_date:w.target.value}),disabled:i}),a.jsx(CA,{label:"Assign To",value:t.assigned_to||"",onChange:w=>n({...t,assigned_to:w}),items:c||[],getLabel:w=>`${w?.first_name??""} ${w?.last_name??""}`.trim()||w?.email||"",placeholder:"Search assignee...",disabled:i,required:!0,isSubmitted:x,className:"md:col-span-2"}),a.jsx(w6e,{label:"Description",name:"description",value:t.description,onChange:w=>n({...t,description:w.target.value}),placeholder:"Additional details...",rows:3,className:"md:col-span-2",disabled:i}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-2 md:col-span-2 mt-4",children:[a.jsx("button",{type:"button",onClick:e,className:"w-full sm:w-auto px-4 py-2 text-white bg-red-400 border border-red-300 rounded hover:bg-red-500 transition disabled:opacity-70",disabled:i,children:"Cancel"}),a.jsx("button",{type:"submit",className:"w-full sm:w-auto px-4 py-2 text-white border border-tertiary bg-tertiary rounded hover:bg-secondary transition disabled:opacity-70",disabled:i,children:i?"Saving...":s?"Update Deal":"Save Deal"})]})]})]})})}function NA({label:e,name:t,value:n,onChange:s,placeholder:r,type:i="text",required:o=!1,disabled:l=!1,className:c="",isSubmitted:u=!1}){const d=u&&!n?.trim();return a.jsxs("div",{className:c,children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",o&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:i,name:t,value:n??"",onChange:s,placeholder:r,required:o,disabled:l,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border focus:ring-2
          ${d?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}
          ${c}
        `})]})}function Y7({label:e,name:t,value:n,onChange:s,options:r,required:i=!1,disabled:o=!1,className:l=""}){return a.jsxs("div",{className:l,children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsx("select",{name:t,value:n??"",onChange:s,required:i,disabled:o,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100",children:r.map(c=>a.jsx("option",{value:c.value,children:c.label},c.value))})]})}function CA({label:e,items:t=[],value:n="",onChange:s,getLabel:r,placeholder:i="Search...",disabled:o=!1,className:l="",required:c=!1,isSubmitted:u=!1,actions:d=null}){const h=u&&c&&!n;return a.jsxs("div",{className:l,children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",c&&a.jsx("span",{className:"text-red-500",children:"*"})]}),d?a.jsx("div",{className:"flex items-center",children:d}):null]}),a.jsx(v6e,{items:t,value:n??"",onChange:s,getLabel:r,placeholder:i,disabled:o,hasError:h})]})}function v6e({items:e=[],value:t="",onChange:n,getLabel:s,placeholder:r="Search...",disabled:i=!1,maxRender:o=200,hasError:l=!1}){const[c,u]=f.useState(!1),[d,h]=f.useState(""),p=f.useRef(null),x=e.find(y=>String(y.id)===String(t)),b=x?s(x):"",j=f.useMemo(()=>{const y=d.trim().toLowerCase();return(y?e.filter(w=>(s(w)||"").toLowerCase().includes(y)):e).slice(0,o)},[e,d,s,o]);return f.useEffect(()=>{const y=N=>{p.current&&!p.current.contains(N.target)&&u(!1)};return document.addEventListener("mousedown",y),()=>document.removeEventListener("mousedown",y)},[]),f.useEffect(()=>{c||h("")},[c]),a.jsxs("div",{ref:p,className:"relative w-full",children:[a.jsx("input",{disabled:i,value:c?d:b,placeholder:r,onFocus:()=>!i&&u(!0),onChange:y=>{h(y.target.value),c||u(!0)},className:`w-full border rounded-md px-2 py-1.5 text-sm outline-none focus:ring-2
          ${l?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}`}),c&&!i&&a.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg overflow-hidden",children:[a.jsx("div",{className:"max-h-56 overflow-y-auto hide-scrollbar",children:j.length>0?j.map(y=>{const N=String(y.id),w=s(y),S=String(t)===N;return a.jsx("button",{type:"button",onClick:()=>{n(N),u(!1)},className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-50 ${S?"bg-blue-50":""}`,children:w||"--"},N)}):a.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No results"})}),e.length>o&&a.jsxs("div",{className:"px-3 py-2 text-[11px] text-gray-400 border-t",children:["Showing first ",o," results  keep typing to narrow."]})]})]})}function w6e({label:e,name:t,value:n,onChange:s,placeholder:r,required:i=!1,disabled:o=!1,className:l="",rows:c=3}){return a.jsxs("div",{className:l,children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsx("textarea",{name:t,value:n??"",onChange:s,placeholder:r,required:i,disabled:o,rows:c,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100 resize-none"})]})}var j6e=Object.defineProperty,N6e=(e,t,n)=>t in e?j6e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,SA=(e,t,n)=>(N6e(e,typeof t!="symbol"?t+"":t,n),n);let C6e=class{constructor(){SA(this,"current",this.detect()),SA(this,"handoffState","pending"),SA(this,"currentId",0)}set(t){this.current!==t&&(this.handoffState="pending",this.currentId=0,this.current=t)}reset(){this.set(this.detect())}nextId(){return++this.currentId}get isServer(){return this.current==="server"}get isClient(){return this.current==="client"}detect(){return typeof window>"u"||typeof document>"u"?"server":"client"}handoff(){this.handoffState==="pending"&&(this.handoffState="complete")}get isHandoffComplete(){return this.handoffState==="complete"}},zo=new C6e;function v0(e){var t;return zo.isServer?null:e==null?document:(t=e?.ownerDocument)!=null?t:document}function eL(e){var t,n;return zo.isServer?null:e==null?document:(n=(t=e?.getRootNode)==null?void 0:t.call(e))!=null?n:document}function PZ(e){var t,n;return(n=(t=eL(e))==null?void 0:t.activeElement)!=null?n:null}function S6e(e){return PZ(e)===e}function S1(e){typeof queueMicrotask=="function"?queueMicrotask(e):Promise.resolve().then(e).catch(t=>setTimeout(()=>{throw t}))}function fc(){let e=[],t={addEventListener(n,s,r,i){return n.addEventListener(s,r,i),t.add(()=>n.removeEventListener(s,r,i))},requestAnimationFrame(...n){let s=requestAnimationFrame(...n);return t.add(()=>cancelAnimationFrame(s))},nextFrame(...n){return t.requestAnimationFrame(()=>t.requestAnimationFrame(...n))},setTimeout(...n){let s=setTimeout(...n);return t.add(()=>clearTimeout(s))},microTask(...n){let s={current:!0};return S1(()=>{s.current&&n[0]()}),t.add(()=>{s.current=!1})},style(n,s,r){let i=n.style.getPropertyValue(s);return Object.assign(n.style,{[s]:r}),this.add(()=>{Object.assign(n.style,{[s]:i})})},group(n){let s=fc();return n(s),this.add(()=>s.dispose())},add(n){return e.includes(n)||e.push(n),()=>{let s=e.indexOf(n);if(s>=0)for(let r of e.splice(s,1))r()}},dispose(){for(let n of e.splice(0))n()}};return t}function _1(){let[e]=f.useState(fc);return f.useEffect(()=>()=>e.dispose(),[e]),e}let br=(e,t)=>{zo.isServer?f.useEffect(e,t):f.useLayoutEffect(e,t)};function fm(e){let t=f.useRef(e);return br(()=>{t.current=e},[e]),t}let Qa=function(e){let t=fm(e);return wt.useCallback((...n)=>t.current(...n),[t])};function w0(e){return f.useMemo(()=>e,Object.values(e))}let _6e=f.createContext(void 0);function A6e(){return f.useContext(_6e)}function tL(...e){return Array.from(new Set(e.flatMap(t=>typeof t=="string"?t.split(" "):[]))).filter(Boolean).join(" ")}function Jl(e,t,...n){if(e in t){let r=t[e];return typeof r=="function"?r(...n):r}let s=new Error(`Tried to handle "${e}" but there is no handler defined. Only defined handlers are: ${Object.keys(t).map(r=>`"${r}"`).join(", ")}.`);throw Error.captureStackTrace&&Error.captureStackTrace(s,Jl),s}var Ww=(e=>(e[e.None=0]="None",e[e.RenderStrategy=1]="RenderStrategy",e[e.Static=2]="Static",e))(Ww||{}),ad=(e=>(e[e.Unmount=0]="Unmount",e[e.Hidden=1]="Hidden",e))(ad||{});function Li(){let e=k6e();return f.useCallback(t=>T6e({mergeRefs:e,...t}),[e])}function T6e({ourProps:e,theirProps:t,slot:n,defaultTag:s,features:r,visible:i=!0,name:o,mergeRefs:l}){l=l??E6e;let c=OZ(t,e);if(i)return Cb(c,n,s,o,l);let u=r??0;if(u&2){let{static:d=!1,...h}=c;if(d)return Cb(h,n,s,o,l)}if(u&1){let{unmount:d=!0,...h}=c;return Jl(d?0:1,{0(){return null},1(){return Cb({...h,hidden:!0,style:{display:"none"}},n,s,o,l)}})}return Cb(c,n,s,o,l)}function Cb(e,t={},n,s,r){let{as:i=n,children:o,refName:l="ref",...c}=_A(e,["unmount","static"]),u=e.ref!==void 0?{[l]:e.ref}:{},d=typeof o=="function"?o(t):o;"className"in c&&c.className&&typeof c.className=="function"&&(c.className=c.className(t)),c["aria-labelledby"]&&c["aria-labelledby"]===c.id&&(c["aria-labelledby"]=void 0);let h={};if(t){let p=!1,x=[];for(let[b,j]of Object.entries(t))typeof j=="boolean"&&(p=!0),j===!0&&x.push(b.replace(/([A-Z])/g,y=>`-${y.toLowerCase()}`));if(p){h["data-headlessui-state"]=x.join(" ");for(let b of x)h[`data-${b}`]=""}}if(mp(i)&&(Object.keys(lu(c)).length>0||Object.keys(lu(h)).length>0))if(!f.isValidElement(d)||Array.isArray(d)&&d.length>1||D6e(d)){if(Object.keys(lu(c)).length>0)throw new Error(['Passing props on "Fragment"!',"",`The current component <${s} /> is rendering a "Fragment".`,"However we need to passthrough the following props:",Object.keys(lu(c)).concat(Object.keys(lu(h))).map(p=>`  - ${p}`).join(`
`),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "Fragment".',"Render a single element as the child so that we can forward the props onto that element."].map(p=>`  - ${p}`).join(`
`)].join(`
`))}else{let p=d.props,x=p?.className,b=typeof x=="function"?(...N)=>tL(x(...N),c.className):tL(x,c.className),j=b?{className:b}:{},y=OZ(d.props,lu(_A(c,["ref"])));for(let N in h)N in y&&delete h[N];return f.cloneElement(d,Object.assign({},y,h,u,{ref:r(L6e(d),u.ref)},j))}return f.createElement(i,Object.assign({},_A(c,["ref"]),!mp(i)&&u,!mp(i)&&h),d)}function k6e(){let e=f.useRef([]),t=f.useCallback(n=>{for(let s of e.current)s!=null&&(typeof s=="function"?s(n):s.current=n)},[]);return(...n)=>{if(!n.every(s=>s==null))return e.current=n,t}}function E6e(...e){return e.every(t=>t==null)?void 0:t=>{for(let n of e)n!=null&&(typeof n=="function"?n(t):n.current=t)}}function OZ(...e){if(e.length===0)return{};if(e.length===1)return e[0];let t={},n={};for(let s of e)for(let r in s)r.startsWith("on")&&typeof s[r]=="function"?(n[r]!=null||(n[r]=[]),n[r].push(s[r])):t[r]=s[r];if(t.disabled||t["aria-disabled"])for(let s in n)/^(on(?:Click|Pointer|Mouse|Key)(?:Down|Up|Press)?)$/.test(s)&&(n[s]=[r=>{var i;return(i=r?.preventDefault)==null?void 0:i.call(r)}]);for(let s in n)Object.assign(t,{[s](r,...i){let o=n[s];for(let l of o){if((r instanceof Event||r?.nativeEvent instanceof Event)&&r.defaultPrevented)return;l(r,...i)}}});return t}function _r(e){var t;return Object.assign(f.forwardRef(e),{displayName:(t=e.displayName)!=null?t:e.name})}function lu(e){let t=Object.assign({},e);for(let n in t)t[n]===void 0&&delete t[n];return t}function _A(e,t=[]){let n=Object.assign({},e);for(let s of t)s in n&&delete n[s];return n}function L6e(e){return wt.version.split(".")[0]>="19"?e.props.ref:e.ref}function mp(e){return e===f.Fragment||e===Symbol.for("react.fragment")}function D6e(e){return mp(e.type)}let P6e="span";var Vw=(e=>(e[e.None=1]="None",e[e.Focusable=2]="Focusable",e[e.Hidden=4]="Hidden",e))(Vw||{});function O6e(e,t){var n;let{features:s=1,...r}=e,i={ref:t,"aria-hidden":(s&2)===2?!0:(n=r["aria-hidden"])!=null?n:void 0,hidden:(s&4)===4?!0:void 0,style:{position:"fixed",top:1,left:1,width:1,height:0,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0",...(s&4)===4&&(s&2)!==2&&{display:"none"}}};return Li()({ourProps:i,theirProps:r,slot:{},defaultTag:P6e,name:"Hidden"})}let aL=_r(O6e);function M6e(e){return typeof e!="object"||e===null?!1:"nodeType"in e}function dd(e){return M6e(e)&&"tagName"in e}function Ju(e){return dd(e)&&"accessKey"in e}function nd(e){return dd(e)&&"tabIndex"in e}function I6e(e){return dd(e)&&"style"in e}function $6e(e){return Ju(e)&&e.nodeName==="IFRAME"}function R6e(e){return Ju(e)&&e.nodeName==="INPUT"}let MZ=Symbol();function z6e(e,t=!0){return Object.assign(e,{[MZ]:t})}function Xo(...e){let t=f.useRef(e);f.useEffect(()=>{t.current=e},[e]);let n=Qa(s=>{for(let r of t.current)r!=null&&(typeof r=="function"?r(s):r.current=s)});return e.every(s=>s==null||s?.[MZ])?void 0:n}let a3=f.createContext(null);a3.displayName="DescriptionContext";function IZ(){let e=f.useContext(a3);if(e===null){let t=new Error("You used a <Description /> component, but it is not inside a relevant parent.");throw Error.captureStackTrace&&Error.captureStackTrace(t,IZ),t}return e}function F6e(){let[e,t]=f.useState([]);return[e.length>0?e.join(" "):void 0,f.useMemo(()=>function(n){let s=Qa(i=>(t(o=>[...o,i]),()=>t(o=>{let l=o.slice(),c=l.indexOf(i);return c!==-1&&l.splice(c,1),l}))),r=f.useMemo(()=>({register:s,slot:n.slot,name:n.name,props:n.props,value:n.value}),[s,n.slot,n.name,n.props,n.value]);return wt.createElement(a3.Provider,{value:r},n.children)},[t])]}let U6e="p";function B6e(e,t){let n=f.useId(),s=A6e(),{id:r=`headlessui-description-${n}`,...i}=e,o=IZ(),l=Xo(t);br(()=>o.register(r),[r,o.register]);let c=w0({...o.slot,disabled:s||!1}),u={ref:l,...o.props,id:r};return Li()({ourProps:u,theirProps:i,slot:c,defaultTag:U6e,name:o.name||"Description"})}let H6e=_r(B6e),q6e=Object.assign(H6e,{});var $Z=(e=>(e.Space=" ",e.Enter="Enter",e.Escape="Escape",e.Backspace="Backspace",e.Delete="Delete",e.ArrowLeft="ArrowLeft",e.ArrowUp="ArrowUp",e.ArrowRight="ArrowRight",e.ArrowDown="ArrowDown",e.Home="Home",e.End="End",e.PageUp="PageUp",e.PageDown="PageDown",e.Tab="Tab",e))($Z||{});let G6e=f.createContext(()=>{});function W6e({value:e,children:t}){return wt.createElement(G6e.Provider,{value:e},t)}let RZ=class extends Map{constructor(t){super(),this.factory=t}get(t){let n=super.get(t);return n===void 0&&(n=this.factory(t),this.set(t,n)),n}};var V6e=Object.defineProperty,Y6e=(e,t,n)=>t in e?V6e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Q6e=(e,t,n)=>(Y6e(e,t+"",n),n),zZ=(e,t,n)=>{if(!t.has(e))throw TypeError("Cannot "+n)},li=(e,t,n)=>(zZ(e,t,"read from private field"),n?n.call(e):t.get(e)),AA=(e,t,n)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},Q7=(e,t,n,s)=>(zZ(e,t,"write to private field"),t.set(e,n),n),jo,Jg,ep;let K6e=class{constructor(t){AA(this,jo,{}),AA(this,Jg,new RZ(()=>new Set)),AA(this,ep,new Set),Q6e(this,"disposables",fc()),Q7(this,jo,t),zo.isServer&&this.disposables.microTask(()=>{this.dispose()})}dispose(){this.disposables.dispose()}get state(){return li(this,jo)}subscribe(t,n){if(zo.isServer)return()=>{};let s={selector:t,callback:n,current:t(li(this,jo))};return li(this,ep).add(s),this.disposables.add(()=>{li(this,ep).delete(s)})}on(t,n){return zo.isServer?()=>{}:(li(this,Jg).get(t).add(n),this.disposables.add(()=>{li(this,Jg).get(t).delete(n)}))}send(t){let n=this.reduce(li(this,jo),t);if(n!==li(this,jo)){Q7(this,jo,n);for(let s of li(this,ep)){let r=s.selector(li(this,jo));FZ(s.current,r)||(s.current=r,s.callback(r))}for(let s of li(this,Jg).get(t.type))s(li(this,jo),t)}}};jo=new WeakMap,Jg=new WeakMap,ep=new WeakMap;function FZ(e,t){return Object.is(e,t)?!0:typeof e!="object"||e===null||typeof t!="object"||t===null?!1:Array.isArray(e)&&Array.isArray(t)?e.length!==t.length?!1:TA(e[Symbol.iterator](),t[Symbol.iterator]()):e instanceof Map&&t instanceof Map||e instanceof Set&&t instanceof Set?e.size!==t.size?!1:TA(e.entries(),t.entries()):K7(e)&&K7(t)?TA(Object.entries(e)[Symbol.iterator](),Object.entries(t)[Symbol.iterator]()):!1}function TA(e,t){do{let n=e.next(),s=t.next();if(n.done&&s.done)return!0;if(n.done||s.done||!Object.is(n.value,s.value))return!1}while(!0)}function K7(e){if(Object.prototype.toString.call(e)!=="[object Object]")return!1;let t=Object.getPrototypeOf(e);return t===null||Object.getPrototypeOf(t)===null}var X6e=Object.defineProperty,Z6e=(e,t,n)=>t in e?X6e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,X7=(e,t,n)=>(Z6e(e,typeof t!="symbol"?t+"":t,n),n),J6e=(e=>(e[e.Push=0]="Push",e[e.Pop=1]="Pop",e))(J6e||{});let eRe={0(e,t){let n=t.id,s=e.stack,r=e.stack.indexOf(n);if(r!==-1){let i=e.stack.slice();return i.splice(r,1),i.push(n),s=i,{...e,stack:s}}return{...e,stack:[...e.stack,n]}},1(e,t){let n=t.id,s=e.stack.indexOf(n);if(s===-1)return e;let r=e.stack.slice();return r.splice(s,1),{...e,stack:r}}},tRe=class UZ extends K6e{constructor(){super(...arguments),X7(this,"actions",{push:t=>this.send({type:0,id:t}),pop:t=>this.send({type:1,id:t})}),X7(this,"selectors",{isTop:(t,n)=>t.stack[t.stack.length-1]===n,inStack:(t,n)=>t.stack.includes(n)})}static new(){return new UZ({stack:[]})}reduce(t,n){return Jl(n.type,eRe,t,n)}};const BZ=new RZ(()=>tRe.new());function HZ(e,t,n=FZ){return XOe.useSyncExternalStoreWithSelector(Qa(s=>e.subscribe(aRe,s)),Qa(()=>e.state),Qa(()=>e.state),Qa(t),n)}function aRe(e){return e}function j0(e,t){let n=f.useId(),s=BZ.get(t),[r,i]=HZ(s,f.useCallback(o=>[s.selectors.isTop(o,n),s.selectors.inStack(o,n)],[s,n]));return br(()=>{if(e)return s.actions.push(n),()=>s.actions.pop(n)},[s,e,n]),e?i?r:!0:!1}let nL=new Map,fp=new Map;function Z7(e){var t;let n=(t=fp.get(e))!=null?t:0;return fp.set(e,n+1),n!==0?()=>J7(e):(nL.set(e,{"aria-hidden":e.getAttribute("aria-hidden"),inert:e.inert}),e.setAttribute("aria-hidden","true"),e.inert=!0,()=>J7(e))}function J7(e){var t;let n=(t=fp.get(e))!=null?t:1;if(n===1?fp.delete(e):fp.set(e,n-1),n!==1)return;let s=nL.get(e);s&&(s["aria-hidden"]===null?e.removeAttribute("aria-hidden"):e.setAttribute("aria-hidden",s["aria-hidden"]),e.inert=s.inert,nL.delete(e))}function nRe(e,{allowed:t,disallowed:n}={}){let s=j0(e,"inert-others");br(()=>{var r,i;if(!s)return;let o=fc();for(let c of(r=n?.())!=null?r:[])c&&o.add(Z7(c));let l=(i=t?.())!=null?i:[];for(let c of l){if(!c)continue;let u=v0(c);if(!u)continue;let d=c.parentElement;for(;d&&d!==u.body;){for(let h of d.children)l.some(p=>h.contains(p))||o.add(Z7(h));d=d.parentElement}}return o.dispose},[s,t,n])}function sRe(e,t,n){let s=fm(r=>{let i=r.getBoundingClientRect();i.x===0&&i.y===0&&i.width===0&&i.height===0&&n()});f.useEffect(()=>{if(!e)return;let r=t===null?null:Ju(t)?t:t.current;if(!r)return;let i=fc();if(typeof ResizeObserver<"u"){let o=new ResizeObserver(()=>s.current(r));o.observe(r),i.add(()=>o.disconnect())}if(typeof IntersectionObserver<"u"){let o=new IntersectionObserver(()=>s.current(r));o.observe(r),i.add(()=>o.disconnect())}return()=>i.dispose()},[t,s,e])}let Yw=["[contentEditable=true]","[tabindex]","a[href]","area[href]","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","details>summary","textarea:not([disabled])"].map(e=>`${e}:not([tabindex='-1'])`).join(","),rRe=["[data-autofocus]"].map(e=>`${e}:not([tabindex='-1'])`).join(",");var El=(e=>(e[e.First=1]="First",e[e.Previous=2]="Previous",e[e.Next=4]="Next",e[e.Last=8]="Last",e[e.WrapAround=16]="WrapAround",e[e.NoScroll=32]="NoScroll",e[e.AutoFocus=64]="AutoFocus",e))(El||{}),sL=(e=>(e[e.Error=0]="Error",e[e.Overflow=1]="Overflow",e[e.Success=2]="Success",e[e.Underflow=3]="Underflow",e))(sL||{}),iRe=(e=>(e[e.Previous=-1]="Previous",e[e.Next=1]="Next",e))(iRe||{});function oRe(e=document.body){return e==null?[]:Array.from(e.querySelectorAll(Yw)).sort((t,n)=>Math.sign((t.tabIndex||Number.MAX_SAFE_INTEGER)-(n.tabIndex||Number.MAX_SAFE_INTEGER)))}function lRe(e=document.body){return e==null?[]:Array.from(e.querySelectorAll(rRe)).sort((t,n)=>Math.sign((t.tabIndex||Number.MAX_SAFE_INTEGER)-(n.tabIndex||Number.MAX_SAFE_INTEGER)))}var qZ=(e=>(e[e.Strict=0]="Strict",e[e.Loose=1]="Loose",e))(qZ||{});function cRe(e,t=0){var n;return e===((n=v0(e))==null?void 0:n.body)?!1:Jl(t,{0(){return e.matches(Yw)},1(){let s=e;for(;s!==null;){if(s.matches(Yw))return!0;s=s.parentElement}return!1}})}var dRe=(e=>(e[e.Keyboard=0]="Keyboard",e[e.Mouse=1]="Mouse",e))(dRe||{});typeof window<"u"&&typeof document<"u"&&(document.addEventListener("keydown",e=>{e.metaKey||e.altKey||e.ctrlKey||(document.documentElement.dataset.headlessuiFocusVisible="")},!0),document.addEventListener("click",e=>{e.detail===1?delete document.documentElement.dataset.headlessuiFocusVisible:e.detail===0&&(document.documentElement.dataset.headlessuiFocusVisible="")},!0));function $l(e){e?.focus({preventScroll:!0})}let uRe=["textarea","input"].join(",");function mRe(e){var t,n;return(n=(t=e?.matches)==null?void 0:t.call(e,uRe))!=null?n:!1}function fRe(e,t=n=>n){return e.slice().sort((n,s)=>{let r=t(n),i=t(s);if(r===null||i===null)return 0;let o=r.compareDocumentPosition(i);return o&Node.DOCUMENT_POSITION_FOLLOWING?-1:o&Node.DOCUMENT_POSITION_PRECEDING?1:0})}function hp(e,t,{sorted:n=!0,relativeTo:s=null,skipElements:r=[]}={}){let i=Array.isArray(e)?e.length>0?eL(e[0]):document:eL(e),o=Array.isArray(e)?n?fRe(e):e:t&64?lRe(e):oRe(e);r.length>0&&o.length>1&&(o=o.filter(x=>!r.some(b=>b!=null&&"current"in b?b?.current===x:b===x))),s=s??i?.activeElement;let l=(()=>{if(t&5)return 1;if(t&10)return-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),c=(()=>{if(t&1)return 0;if(t&2)return Math.max(0,o.indexOf(s))-1;if(t&4)return Math.max(0,o.indexOf(s))+1;if(t&8)return o.length-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),u=t&32?{preventScroll:!0}:{},d=0,h=o.length,p;do{if(d>=h||d+h<=0)return 0;let x=c+d;if(t&16)x=(x+h)%h;else{if(x<0)return 3;if(x>=h)return 1}p=o[x],p?.focus(u),d+=l}while(p!==PZ(p));return t&6&&mRe(p)&&p.select(),2}function GZ(){return/iPhone/gi.test(window.navigator.platform)||/Mac/gi.test(window.navigator.platform)&&window.navigator.maxTouchPoints>0}function hRe(){return/Android/gi.test(window.navigator.userAgent)}function e8(){return GZ()||hRe()}function Sb(e,t,n,s){let r=fm(n);f.useEffect(()=>{if(!e)return;function i(o){r.current(o)}return document.addEventListener(t,i,s),()=>document.removeEventListener(t,i,s)},[e,t,s])}function WZ(e,t,n,s){let r=fm(n);f.useEffect(()=>{if(!e)return;function i(o){r.current(o)}return window.addEventListener(t,i,s),()=>window.removeEventListener(t,i,s)},[e,t,s])}const t8=30;function gRe(e,t,n){let s=fm(n),r=f.useCallback(function(l,c){if(l.defaultPrevented)return;let u=c(l);if(u===null||!u.getRootNode().contains(u)||!u.isConnected)return;let d=(function h(p){return typeof p=="function"?h(p()):Array.isArray(p)||p instanceof Set?p:[p]})(t);for(let h of d)if(h!==null&&(h.contains(u)||l.composed&&l.composedPath().includes(h)))return;return!cRe(u,qZ.Loose)&&u.tabIndex!==-1&&l.preventDefault(),s.current(l,u)},[s,t]),i=f.useRef(null);Sb(e,"pointerdown",l=>{var c,u;e8()||(i.current=((u=(c=l.composedPath)==null?void 0:c.call(l))==null?void 0:u[0])||l.target)},!0),Sb(e,"pointerup",l=>{if(e8()||!i.current)return;let c=i.current;return i.current=null,r(l,()=>c)},!0);let o=f.useRef({x:0,y:0});Sb(e,"touchstart",l=>{o.current.x=l.touches[0].clientX,o.current.y=l.touches[0].clientY},!0),Sb(e,"touchend",l=>{let c={x:l.changedTouches[0].clientX,y:l.changedTouches[0].clientY};if(!(Math.abs(c.x-o.current.x)>=t8||Math.abs(c.y-o.current.y)>=t8))return r(l,()=>nd(l.target)?l.target:null)},!0),WZ(e,"blur",l=>r(l,()=>$6e(window.document.activeElement)?window.document.activeElement:null),!0)}function n3(...e){return f.useMemo(()=>v0(...e),[...e])}function VZ(e,t,n,s){let r=fm(n);f.useEffect(()=>{e=e??window;function i(o){r.current(o)}return e.addEventListener(t,i,s),()=>e.removeEventListener(t,i,s)},[e,t,s])}function pRe(e){return f.useSyncExternalStore(e.subscribe,e.getSnapshot,e.getSnapshot)}function xRe(e,t){let n=e(),s=new Set;return{getSnapshot(){return n},subscribe(r){return s.add(r),()=>s.delete(r)},dispatch(r,...i){let o=t[r].call(n,...i);o&&(n=o,s.forEach(l=>l()))}}}function yRe(){let e;return{before({doc:t}){var n;let s=t.documentElement,r=(n=t.defaultView)!=null?n:window;e=Math.max(0,r.innerWidth-s.clientWidth)},after({doc:t,d:n}){let s=t.documentElement,r=Math.max(0,s.clientWidth-s.offsetWidth),i=Math.max(0,e-r);n.style(s,"paddingRight",`${i}px`)}}}function bRe(){return GZ()?{before({doc:e,d:t,meta:n}){function s(r){for(let i of n().containers)for(let o of i())if(o.contains(r))return!0;return!1}t.microTask(()=>{var r;if(window.getComputedStyle(e.documentElement).scrollBehavior!=="auto"){let l=fc();l.style(e.documentElement,"scrollBehavior","auto"),t.add(()=>t.microTask(()=>l.dispose()))}let i=(r=window.scrollY)!=null?r:window.pageYOffset,o=null;t.addEventListener(e,"click",l=>{if(nd(l.target))try{let c=l.target.closest("a");if(!c)return;let{hash:u}=new URL(c.href),d=e.querySelector(u);nd(d)&&!s(d)&&(o=d)}catch{}},!0),t.group(l=>{t.addEventListener(e,"touchstart",c=>{if(l.dispose(),nd(c.target)&&I6e(c.target))if(s(c.target)){let u=c.target;for(;u.parentElement&&s(u.parentElement);)u=u.parentElement;l.style(u,"overscrollBehavior","contain")}else l.style(c.target,"touchAction","none")})}),t.addEventListener(e,"touchmove",l=>{if(nd(l.target)){if(R6e(l.target))return;if(s(l.target)){let c=l.target;for(;c.parentElement&&c.dataset.headlessuiPortal!==""&&!(c.scrollHeight>c.clientHeight||c.scrollWidth>c.clientWidth);)c=c.parentElement;c.dataset.headlessuiPortal===""&&l.preventDefault()}else l.preventDefault()}},{passive:!1}),t.add(()=>{var l;let c=(l=window.scrollY)!=null?l:window.pageYOffset;i!==c&&window.scrollTo(0,i),o&&o.isConnected&&(o.scrollIntoView({block:"nearest"}),o=null)})})}}:{}}function vRe(){return{before({doc:e,d:t}){t.style(e.documentElement,"overflow","hidden")}}}function a8(e){let t={};for(let n of e)Object.assign(t,n(t));return t}let Cu=xRe(()=>new Map,{PUSH(e,t){var n;let s=(n=this.get(e))!=null?n:{doc:e,count:0,d:fc(),meta:new Set,computedMeta:{}};return s.count++,s.meta.add(t),s.computedMeta=a8(s.meta),this.set(e,s),this},POP(e,t){let n=this.get(e);return n&&(n.count--,n.meta.delete(t),n.computedMeta=a8(n.meta)),this},SCROLL_PREVENT(e){let t={doc:e.doc,d:e.d,meta(){return e.computedMeta}},n=[bRe(),yRe(),vRe()];n.forEach(({before:s})=>s?.(t)),n.forEach(({after:s})=>s?.(t))},SCROLL_ALLOW({d:e}){e.dispose()},TEARDOWN({doc:e}){this.delete(e)}});Cu.subscribe(()=>{let e=Cu.getSnapshot(),t=new Map;for(let[n]of e)t.set(n,n.documentElement.style.overflow);for(let n of e.values()){let s=t.get(n.doc)==="hidden",r=n.count!==0;(r&&!s||!r&&s)&&Cu.dispatch(n.count>0?"SCROLL_PREVENT":"SCROLL_ALLOW",n),n.count===0&&Cu.dispatch("TEARDOWN",n)}});function wRe(e,t,n=()=>({containers:[]})){let s=pRe(Cu),r=t?s.get(t):void 0,i=r?r.count>0:!1;return br(()=>{if(!(!t||!e))return Cu.dispatch("PUSH",t,n),()=>Cu.dispatch("POP",t,n)},[e,t]),i}function jRe(e,t,n=()=>[document.body]){let s=j0(e,"scroll-lock");wRe(s,t,r=>{var i;return{containers:[...(i=r.containers)!=null?i:[],n]}})}function NRe(e=0){let[t,n]=f.useState(e),s=f.useCallback(c=>n(c),[]),r=f.useCallback(c=>n(u=>u|c),[]),i=f.useCallback(c=>(t&c)===c,[t]),o=f.useCallback(c=>n(u=>u&~c),[]),l=f.useCallback(c=>n(u=>u^c),[]);return{flags:t,setFlag:s,addFlag:r,hasFlag:i,removeFlag:o,toggleFlag:l}}var CRe={},n8,s8;typeof process<"u"&&typeof globalThis<"u"&&typeof Element<"u"&&((n8=process==null?void 0:CRe)==null?void 0:n8.NODE_ENV)==="test"&&typeof((s8=Element?.prototype)==null?void 0:s8.getAnimations)>"u"&&(Element.prototype.getAnimations=function(){return console.warn(["Headless UI has polyfilled `Element.prototype.getAnimations` for your tests.","Please install a proper polyfill e.g. `jsdom-testing-mocks`, to silence these warnings.","","Example usage:","```js","import { mockAnimationsApi } from 'jsdom-testing-mocks'","mockAnimationsApi()","```"].join(`
`)),[]});var SRe=(e=>(e[e.None=0]="None",e[e.Closed=1]="Closed",e[e.Enter=2]="Enter",e[e.Leave=4]="Leave",e))(SRe||{});function _Re(e){let t={};for(let n in e)e[n]===!0&&(t[`data-${n}`]="");return t}function ARe(e,t,n,s){let[r,i]=f.useState(n),{hasFlag:o,addFlag:l,removeFlag:c}=NRe(e&&r?3:0),u=f.useRef(!1),d=f.useRef(!1),h=_1();return br(()=>{var p;if(e){if(n&&i(!0),!t){n&&l(3);return}return(p=s?.start)==null||p.call(s,n),TRe(t,{inFlight:u,prepare(){d.current?d.current=!1:d.current=u.current,u.current=!0,!d.current&&(n?(l(3),c(4)):(l(4),c(2)))},run(){d.current?n?(c(3),l(4)):(c(4),l(3)):n?c(1):l(1)},done(){var x;d.current&&LRe(t)||(u.current=!1,c(7),n||i(!1),(x=s?.end)==null||x.call(s,n))}})}},[e,n,t,h]),e?[r,{closed:o(1),enter:o(2),leave:o(4),transition:o(2)||o(4)}]:[n,{closed:void 0,enter:void 0,leave:void 0,transition:void 0}]}function TRe(e,{prepare:t,run:n,done:s,inFlight:r}){let i=fc();return ERe(e,{prepare:t,inFlight:r}),i.nextFrame(()=>{n(),i.requestAnimationFrame(()=>{i.add(kRe(e,s))})}),i.dispose}function kRe(e,t){var n,s;let r=fc();if(!e)return r.dispose;let i=!1;r.add(()=>{i=!0});let o=(s=(n=e.getAnimations)==null?void 0:n.call(e).filter(l=>l instanceof CSSTransition))!=null?s:[];return o.length===0?(t(),r.dispose):(Promise.allSettled(o.map(l=>l.finished)).then(()=>{i||t()}),r.dispose)}function ERe(e,{inFlight:t,prepare:n}){if(t!=null&&t.current){n();return}let s=e.style.transition;e.style.transition="none",n(),e.offsetHeight,e.style.transition=s}function LRe(e){var t,n;return((n=(t=e.getAnimations)==null?void 0:t.call(e))!=null?n:[]).some(s=>s instanceof CSSTransition&&s.playState!=="finished")}function s3(e,t){let n=f.useRef([]),s=Qa(e);f.useEffect(()=>{let r=[...n.current];for(let[i,o]of t.entries())if(n.current[i]!==o){let l=s(t,r);return n.current=t,l}},[s,...t])}let A1=f.createContext(null);A1.displayName="OpenClosedContext";var Wi=(e=>(e[e.Open=1]="Open",e[e.Closed=2]="Closed",e[e.Closing=4]="Closing",e[e.Opening=8]="Opening",e))(Wi||{});function T1(){return f.useContext(A1)}function DRe({value:e,children:t}){return wt.createElement(A1.Provider,{value:e},t)}function PRe({children:e}){return wt.createElement(A1.Provider,{value:null},e)}function ORe(e){function t(){document.readyState!=="loading"&&(e(),document.removeEventListener("DOMContentLoaded",t))}typeof window<"u"&&typeof document<"u"&&(document.addEventListener("DOMContentLoaded",t),t())}let Zc=[];ORe(()=>{function e(t){if(!nd(t.target)||t.target===document.body||Zc[0]===t.target)return;let n=t.target;n=n.closest(Yw),Zc.unshift(n??t.target),Zc=Zc.filter(s=>s!=null&&s.isConnected),Zc.splice(10)}window.addEventListener("click",e,{capture:!0}),window.addEventListener("mousedown",e,{capture:!0}),window.addEventListener("focus",e,{capture:!0}),document.body.addEventListener("click",e,{capture:!0}),document.body.addEventListener("mousedown",e,{capture:!0}),document.body.addEventListener("focus",e,{capture:!0})});function YZ(e){let t=Qa(e),n=f.useRef(!1);f.useEffect(()=>(n.current=!1,()=>{n.current=!0,S1(()=>{n.current&&t()})}),[t])}let QZ=f.createContext(!1);function MRe(){return f.useContext(QZ)}function r8(e){return wt.createElement(QZ.Provider,{value:e.force},e.children)}function IRe(e){let t=MRe(),n=f.useContext(XZ),[s,r]=f.useState(()=>{var i;if(!t&&n!==null)return(i=n.current)!=null?i:null;if(zo.isServer)return null;let o=e?.getElementById("headlessui-portal-root");if(o)return o;if(e===null)return null;let l=e.createElement("div");return l.setAttribute("id","headlessui-portal-root"),e.body.appendChild(l)});return f.useEffect(()=>{s!==null&&(e!=null&&e.body.contains(s)||e==null||e.body.appendChild(s))},[s,e]),f.useEffect(()=>{t||n!==null&&r(n.current)},[n,r,t]),s}let KZ=f.Fragment,$Re=_r(function(e,t){let{ownerDocument:n=null,...s}=e,r=f.useRef(null),i=Xo(z6e(p=>{r.current=p}),t),o=n3(r.current),l=n??o,c=IRe(l),u=f.useContext(rL),d=_1(),h=Li();return YZ(()=>{var p;c&&c.childNodes.length<=0&&((p=c.parentElement)==null||p.removeChild(c))}),c?Gi.createPortal(wt.createElement("div",{"data-headlessui-portal":"",ref:p=>{d.dispose(),u&&p&&d.add(u.register(p))}},h({ourProps:{ref:i},theirProps:s,slot:{},defaultTag:KZ,name:"Portal"})),c):null});function RRe(e,t){let n=Xo(t),{enabled:s=!0,ownerDocument:r,...i}=e,o=Li();return s?wt.createElement($Re,{...i,ownerDocument:r,ref:n}):o({ourProps:{ref:n},theirProps:i,slot:{},defaultTag:KZ,name:"Portal"})}let zRe=f.Fragment,XZ=f.createContext(null);function FRe(e,t){let{target:n,...s}=e,r={ref:Xo(t)},i=Li();return wt.createElement(XZ.Provider,{value:n},i({ourProps:r,theirProps:s,defaultTag:zRe,name:"Popover.Group"}))}let rL=f.createContext(null);function URe(){let e=f.useContext(rL),t=f.useRef([]),n=Qa(i=>(t.current.push(i),e&&e.register(i),()=>s(i))),s=Qa(i=>{let o=t.current.indexOf(i);o!==-1&&t.current.splice(o,1),e&&e.unregister(i)}),r=f.useMemo(()=>({register:n,unregister:s,portals:t}),[n,s,t]);return[t,f.useMemo(()=>function({children:i}){return wt.createElement(rL.Provider,{value:r},i)},[r])]}let BRe=_r(RRe),ZZ=_r(FRe),HRe=Object.assign(BRe,{Group:ZZ});function qRe(e,t=typeof document<"u"?document.defaultView:null,n){let s=j0(e,"escape");VZ(t,"keydown",r=>{s&&(r.defaultPrevented||r.key===$Z.Escape&&n(r))})}function GRe(){var e;let[t]=f.useState(()=>typeof window<"u"&&typeof window.matchMedia=="function"?window.matchMedia("(pointer: coarse)"):null),[n,s]=f.useState((e=t?.matches)!=null?e:!1);return br(()=>{if(!t)return;function r(i){s(i.matches)}return t.addEventListener("change",r),()=>t.removeEventListener("change",r)},[t]),n}function WRe({defaultContainers:e=[],portals:t,mainTreeNode:n}={}){let s=Qa(()=>{var r,i;let o=v0(n),l=[];for(let c of e)c!==null&&(dd(c)?l.push(c):"current"in c&&dd(c.current)&&l.push(c.current));if(t!=null&&t.current)for(let c of t.current)l.push(c);for(let c of(r=o?.querySelectorAll("html > *, body > *"))!=null?r:[])c!==document.body&&c!==document.head&&dd(c)&&c.id!=="headlessui-portal-root"&&(n&&(c.contains(n)||c.contains((i=n?.getRootNode())==null?void 0:i.host))||l.some(u=>c.contains(u))||l.push(c));return l});return{resolveContainers:s,contains:Qa(r=>s().some(i=>i.contains(r)))}}let JZ=f.createContext(null);function i8({children:e,node:t}){let[n,s]=f.useState(null),r=eJ(t??n);return wt.createElement(JZ.Provider,{value:r},e,r===null&&wt.createElement(aL,{features:Vw.Hidden,ref:i=>{var o,l;if(i){for(let c of(l=(o=v0(i))==null?void 0:o.querySelectorAll("html > *, body > *"))!=null?l:[])if(c!==document.body&&c!==document.head&&dd(c)&&c!=null&&c.contains(i)){s(c);break}}}}))}function eJ(e=null){var t;return(t=f.useContext(JZ))!=null?t:e}function VRe(){let e=typeof document>"u";return"useSyncExternalStore"in Mu?(t=>t.useSyncExternalStore)(Mu)(()=>()=>{},()=>!1,()=>!e):!1}function k1(){let e=VRe(),[t,n]=f.useState(zo.isHandoffComplete);return t&&zo.isHandoffComplete===!1&&n(!1),f.useEffect(()=>{t!==!0&&n(!0)},[t]),f.useEffect(()=>zo.handoff(),[]),e?!1:t}function r3(){let e=f.useRef(!1);return br(()=>(e.current=!0,()=>{e.current=!1}),[]),e}var tp=(e=>(e[e.Forwards=0]="Forwards",e[e.Backwards=1]="Backwards",e))(tp||{});function YRe(){let e=f.useRef(0);return WZ(!0,"keydown",t=>{t.key==="Tab"&&(e.current=t.shiftKey?1:0)},!0),e}function tJ(e){if(!e)return new Set;if(typeof e=="function")return new Set(e());let t=new Set;for(let n of e.current)dd(n.current)&&t.add(n.current);return t}let QRe="div";var mu=(e=>(e[e.None=0]="None",e[e.InitialFocus=1]="InitialFocus",e[e.TabLock=2]="TabLock",e[e.FocusLock=4]="FocusLock",e[e.RestoreFocus=8]="RestoreFocus",e[e.AutoFocus=16]="AutoFocus",e))(mu||{});function KRe(e,t){let n=f.useRef(null),s=Xo(n,t),{initialFocus:r,initialFocusFallback:i,containers:o,features:l=15,...c}=e;k1()||(l=0);let u=n3(n.current);eze(l,{ownerDocument:u});let d=tze(l,{ownerDocument:u,container:n,initialFocus:r,initialFocusFallback:i});aze(l,{ownerDocument:u,container:n,containers:o,previousActiveElement:d});let h=YRe(),p=Qa(w=>{if(!Ju(n.current))return;let S=n.current;(_=>_())(()=>{Jl(h.current,{[tp.Forwards]:()=>{hp(S,El.First,{skipElements:[w.relatedTarget,i]})},[tp.Backwards]:()=>{hp(S,El.Last,{skipElements:[w.relatedTarget,i]})}})})}),x=j0(!!(l&2),"focus-trap#tab-lock"),b=_1(),j=f.useRef(!1),y={ref:s,onKeyDown(w){w.key=="Tab"&&(j.current=!0,b.requestAnimationFrame(()=>{j.current=!1}))},onBlur(w){if(!(l&4))return;let S=tJ(o);Ju(n.current)&&S.add(n.current);let _=w.relatedTarget;nd(_)&&_.dataset.headlessuiFocusGuard!=="true"&&(aJ(S,_)||(j.current?hp(n.current,Jl(h.current,{[tp.Forwards]:()=>El.Next,[tp.Backwards]:()=>El.Previous})|El.WrapAround,{relativeTo:w.target}):nd(w.target)&&$l(w.target)))}},N=Li();return wt.createElement(wt.Fragment,null,x&&wt.createElement(aL,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:p,features:Vw.Focusable}),N({ourProps:y,theirProps:c,defaultTag:QRe,name:"FocusTrap"}),x&&wt.createElement(aL,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:p,features:Vw.Focusable}))}let XRe=_r(KRe),ZRe=Object.assign(XRe,{features:mu});function JRe(e=!0){let t=f.useRef(Zc.slice());return s3(([n],[s])=>{s===!0&&n===!1&&S1(()=>{t.current.splice(0)}),s===!1&&n===!0&&(t.current=Zc.slice())},[e,Zc,t]),Qa(()=>{var n;return(n=t.current.find(s=>s!=null&&s.isConnected))!=null?n:null})}function eze(e,{ownerDocument:t}){let n=!!(e&8),s=JRe(n);s3(()=>{n||S6e(t?.body)&&$l(s())},[n]),YZ(()=>{n&&$l(s())})}function tze(e,{ownerDocument:t,container:n,initialFocus:s,initialFocusFallback:r}){let i=f.useRef(null),o=j0(!!(e&1),"focus-trap#initial-focus"),l=r3();return s3(()=>{if(e===0)return;if(!o){r!=null&&r.current&&$l(r.current);return}let c=n.current;c&&S1(()=>{if(!l.current)return;let u=t?.activeElement;if(s!=null&&s.current){if(s?.current===u){i.current=u;return}}else if(c.contains(u)){i.current=u;return}if(s!=null&&s.current)$l(s.current);else{if(e&16){if(hp(c,El.First|El.AutoFocus)!==sL.Error)return}else if(hp(c,El.First)!==sL.Error)return;if(r!=null&&r.current&&($l(r.current),t?.activeElement===r.current))return;console.warn("There are no focusable elements inside the <FocusTrap />")}i.current=t?.activeElement})},[r,o,e]),i}function aze(e,{ownerDocument:t,container:n,containers:s,previousActiveElement:r}){let i=r3(),o=!!(e&4);VZ(t?.defaultView,"focus",l=>{if(!o||!i.current)return;let c=tJ(s);Ju(n.current)&&c.add(n.current);let u=r.current;if(!u)return;let d=l.target;Ju(d)?aJ(c,d)?(r.current=d,$l(d)):(l.preventDefault(),l.stopPropagation(),$l(u)):$l(r.current)},!0)}function aJ(e,t){for(let n of e)if(n.contains(t))return!0;return!1}function nJ(e){var t;return!!(e.enter||e.enterFrom||e.enterTo||e.leave||e.leaveFrom||e.leaveTo)||!mp((t=e.as)!=null?t:rJ)||wt.Children.count(e.children)===1}let E1=f.createContext(null);E1.displayName="TransitionContext";var nze=(e=>(e.Visible="visible",e.Hidden="hidden",e))(nze||{});function sze(){let e=f.useContext(E1);if(e===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return e}function rze(){let e=f.useContext(L1);if(e===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return e}let L1=f.createContext(null);L1.displayName="NestingContext";function D1(e){return"children"in e?D1(e.children):e.current.filter(({el:t})=>t.current!==null).filter(({state:t})=>t==="visible").length>0}function sJ(e,t){let n=fm(e),s=f.useRef([]),r=r3(),i=_1(),o=Qa((x,b=ad.Hidden)=>{let j=s.current.findIndex(({el:y})=>y===x);j!==-1&&(Jl(b,{[ad.Unmount](){s.current.splice(j,1)},[ad.Hidden](){s.current[j].state="hidden"}}),i.microTask(()=>{var y;!D1(s)&&r.current&&((y=n.current)==null||y.call(n))}))}),l=Qa(x=>{let b=s.current.find(({el:j})=>j===x);return b?b.state!=="visible"&&(b.state="visible"):s.current.push({el:x,state:"visible"}),()=>o(x,ad.Unmount)}),c=f.useRef([]),u=f.useRef(Promise.resolve()),d=f.useRef({enter:[],leave:[]}),h=Qa((x,b,j)=>{c.current.splice(0),t&&(t.chains.current[b]=t.chains.current[b].filter(([y])=>y!==x)),t?.chains.current[b].push([x,new Promise(y=>{c.current.push(y)})]),t?.chains.current[b].push([x,new Promise(y=>{Promise.all(d.current[b].map(([N,w])=>w)).then(()=>y())})]),b==="enter"?u.current=u.current.then(()=>t?.wait.current).then(()=>j(b)):j(b)}),p=Qa((x,b,j)=>{Promise.all(d.current[b].splice(0).map(([y,N])=>N)).then(()=>{var y;(y=c.current.shift())==null||y()}).then(()=>j(b))});return f.useMemo(()=>({children:s,register:l,unregister:o,onStart:h,onStop:p,wait:u,chains:d}),[l,o,s,h,p,d,u])}let rJ=f.Fragment,iJ=Ww.RenderStrategy;function ize(e,t){var n,s;let{transition:r=!0,beforeEnter:i,afterEnter:o,beforeLeave:l,afterLeave:c,enter:u,enterFrom:d,enterTo:h,entered:p,leave:x,leaveFrom:b,leaveTo:j,...y}=e,[N,w]=f.useState(null),S=f.useRef(null),_=nJ(e),T=Xo(..._?[S,t,w]:t===null?[]:[t]),k=(n=y.unmount)==null||n?ad.Unmount:ad.Hidden,{show:A,appear:E,initial:M}=sze(),[F,D]=f.useState(A?"visible":"hidden"),P=rze(),{register:B,unregister:G}=P;br(()=>B(S),[B,S]),br(()=>{if(k===ad.Hidden&&S.current){if(A&&F!=="visible"){D("visible");return}return Jl(F,{hidden:()=>G(S),visible:()=>B(S)})}},[F,S,B,G,A,k]);let $=k1();br(()=>{if(_&&$&&F==="visible"&&S.current===null)throw new Error("Did you forget to passthrough the `ref` to the actual DOM node?")},[S,F,$,_]);let W=M&&!E,Z=E&&A&&M,Q=f.useRef(!1),le=sJ(()=>{Q.current||(D("hidden"),G(S))},P),we=Qa(me=>{Q.current=!0;let Ae=me?"enter":"leave";le.onStart(S,Ae,pe=>{pe==="enter"?i?.():pe==="leave"&&l?.()})}),J=Qa(me=>{let Ae=me?"enter":"leave";Q.current=!1,le.onStop(S,Ae,pe=>{pe==="enter"?o?.():pe==="leave"&&c?.()}),Ae==="leave"&&!D1(le)&&(D("hidden"),G(S))});f.useEffect(()=>{_&&r||(we(A),J(A))},[A,_,r]);let se=!(!r||!_||!$||W),[,ye]=ARe(se,N,A,{start:we,end:J}),Ce=lu({ref:T,className:((s=tL(y.className,Z&&u,Z&&d,ye.enter&&u,ye.enter&&ye.closed&&d,ye.enter&&!ye.closed&&h,ye.leave&&x,ye.leave&&!ye.closed&&b,ye.leave&&ye.closed&&j,!ye.transition&&A&&p))==null?void 0:s.trim())||void 0,..._Re(ye)}),ge=0;F==="visible"&&(ge|=Wi.Open),F==="hidden"&&(ge|=Wi.Closed),A&&F==="hidden"&&(ge|=Wi.Opening),!A&&F==="visible"&&(ge|=Wi.Closing);let be=Li();return wt.createElement(L1.Provider,{value:le},wt.createElement(DRe,{value:ge},be({ourProps:Ce,theirProps:y,defaultTag:rJ,features:iJ,visible:F==="visible",name:"Transition.Child"})))}function oze(e,t){let{show:n,appear:s=!1,unmount:r=!0,...i}=e,o=f.useRef(null),l=nJ(e),c=Xo(...l?[o,t]:t===null?[]:[t]);k1();let u=T1();if(n===void 0&&u!==null&&(n=(u&Wi.Open)===Wi.Open),n===void 0)throw new Error("A <Transition /> is used but it is missing a `show={true | false}` prop.");let[d,h]=f.useState(n?"visible":"hidden"),p=sJ(()=>{n||h("hidden")}),[x,b]=f.useState(!0),j=f.useRef([n]);br(()=>{x!==!1&&j.current[j.current.length-1]!==n&&(j.current.push(n),b(!1))},[j,n]);let y=f.useMemo(()=>({show:n,appear:s,initial:x}),[n,s,x]);br(()=>{n?h("visible"):!D1(p)&&o.current!==null&&h("hidden")},[n,p]);let N={unmount:r},w=Qa(()=>{var T;x&&b(!1),(T=e.beforeEnter)==null||T.call(e)}),S=Qa(()=>{var T;x&&b(!1),(T=e.beforeLeave)==null||T.call(e)}),_=Li();return wt.createElement(L1.Provider,{value:p},wt.createElement(E1.Provider,{value:y},_({ourProps:{...N,as:f.Fragment,children:wt.createElement(oJ,{ref:c,...N,...i,beforeEnter:w,beforeLeave:S})},theirProps:{},defaultTag:f.Fragment,features:iJ,visible:d==="visible",name:"Transition"})))}function lze(e,t){let n=f.useContext(E1)!==null,s=T1()!==null;return wt.createElement(wt.Fragment,null,!n&&s?wt.createElement(iL,{ref:t,...e}):wt.createElement(oJ,{ref:t,...e}))}let iL=_r(oze),oJ=_r(ize),i3=_r(lze),Sv=Object.assign(iL,{Child:i3,Root:iL});var cze=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(cze||{}),dze=(e=>(e[e.SetTitleId=0]="SetTitleId",e))(dze||{});let uze={0(e,t){return e.titleId===t.id?e:{...e,titleId:t.id}}},o3=f.createContext(null);o3.displayName="DialogContext";function P1(e){let t=f.useContext(o3);if(t===null){let n=new Error(`<${e} /> is missing a parent <Dialog /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(n,P1),n}return t}function mze(e,t){return Jl(t.type,uze,e,t)}let o8=_r(function(e,t){let n=f.useId(),{id:s=`headlessui-dialog-${n}`,open:r,onClose:i,initialFocus:o,role:l="dialog",autoFocus:c=!0,__demoMode:u=!1,unmount:d=!1,...h}=e,p=f.useRef(!1);l=(function(){return l==="dialog"||l==="alertdialog"?l:(p.current||(p.current=!0,console.warn(`Invalid role [${l}] passed to <Dialog />. Only \`dialog\` and and \`alertdialog\` are supported. Using \`dialog\` instead.`)),"dialog")})();let x=T1();r===void 0&&x!==null&&(r=(x&Wi.Open)===Wi.Open);let b=f.useRef(null),j=Xo(b,t),y=n3(b.current),N=r?0:1,[w,S]=f.useReducer(mze,{titleId:null,descriptionId:null,panelRef:f.createRef()}),_=Qa(()=>i(!1)),T=Qa(ye=>S({type:0,id:ye})),k=k1()?N===0:!1,[A,E]=URe(),M={get current(){var ye;return(ye=w.panelRef.current)!=null?ye:b.current}},F=eJ(),{resolveContainers:D}=WRe({mainTreeNode:F,portals:A,defaultContainers:[M]}),P=x!==null?(x&Wi.Closing)===Wi.Closing:!1;nRe(u||P?!1:k,{allowed:Qa(()=>{var ye,Ce;return[(Ce=(ye=b.current)==null?void 0:ye.closest("[data-headlessui-portal]"))!=null?Ce:null]}),disallowed:Qa(()=>{var ye;return[(ye=F?.closest("body > *:not(#headlessui-portal-root)"))!=null?ye:null]})});let B=BZ.get(null);br(()=>{if(k)return B.actions.push(s),()=>B.actions.pop(s)},[B,s,k]);let G=HZ(B,f.useCallback(ye=>B.selectors.isTop(ye,s),[B,s]));gRe(G,D,ye=>{ye.preventDefault(),_()}),qRe(G,y?.defaultView,ye=>{ye.preventDefault(),ye.stopPropagation(),document.activeElement&&"blur"in document.activeElement&&typeof document.activeElement.blur=="function"&&document.activeElement.blur(),_()}),jRe(u||P?!1:k,y,D),sRe(k,b,_);let[$,W]=F6e(),Z=f.useMemo(()=>[{dialogState:N,close:_,setTitleId:T,unmount:d},w],[N,_,T,d,w]),Q=w0({open:N===0}),le={ref:j,id:s,role:l,tabIndex:-1,"aria-modal":u?void 0:N===0?!0:void 0,"aria-labelledby":w.titleId,"aria-describedby":$,unmount:d},we=!GRe(),J=mu.None;k&&!u&&(J|=mu.RestoreFocus,J|=mu.TabLock,c&&(J|=mu.AutoFocus),we&&(J|=mu.InitialFocus));let se=Li();return wt.createElement(PRe,null,wt.createElement(r8,{force:!0},wt.createElement(HRe,null,wt.createElement(o3.Provider,{value:Z},wt.createElement(ZZ,{target:b},wt.createElement(r8,{force:!1},wt.createElement(W,{slot:Q},wt.createElement(E,null,wt.createElement(ZRe,{initialFocus:o,initialFocusFallback:b,containers:D,features:J},wt.createElement(W6e,{value:_},se({ourProps:le,theirProps:h,slot:Q,defaultTag:fze,features:hze,visible:N===0,name:"Dialog"})))))))))))}),fze="div",hze=Ww.RenderStrategy|Ww.Static;function gze(e,t){let{transition:n=!1,open:s,...r}=e,i=T1(),o=e.hasOwnProperty("open")||i!==null,l=e.hasOwnProperty("onClose");if(!o&&!l)throw new Error("You have to provide an `open` and an `onClose` prop to the `Dialog` component.");if(!o)throw new Error("You provided an `onClose` prop to the `Dialog`, but forgot an `open` prop.");if(!l)throw new Error("You provided an `open` prop to the `Dialog`, but forgot an `onClose` prop.");if(!i&&typeof e.open!="boolean")throw new Error(`You provided an \`open\` prop to the \`Dialog\`, but the value is not a boolean. Received: ${e.open}`);if(typeof e.onClose!="function")throw new Error(`You provided an \`onClose\` prop to the \`Dialog\`, but the value is not a function. Received: ${e.onClose}`);return(s!==void 0||n)&&!r.static?wt.createElement(i8,null,wt.createElement(Sv,{show:s,transition:n,unmount:r.unmount},wt.createElement(o8,{ref:t,...r}))):wt.createElement(i8,null,wt.createElement(o8,{ref:t,open:s,...r}))}let pze="div";function xze(e,t){let n=f.useId(),{id:s=`headlessui-dialog-panel-${n}`,transition:r=!1,...i}=e,[{dialogState:o,unmount:l},c]=P1("Dialog.Panel"),u=Xo(t,c.panelRef),d=w0({open:o===0}),h=Qa(y=>{y.stopPropagation()}),p={ref:u,id:s,onClick:h},x=r?i3:f.Fragment,b=r?{unmount:l}:{},j=Li();return wt.createElement(x,{...b},j({ourProps:p,theirProps:i,slot:d,defaultTag:pze,name:"Dialog.Panel"}))}let yze="div";function bze(e,t){let{transition:n=!1,...s}=e,[{dialogState:r,unmount:i}]=P1("Dialog.Backdrop"),o=w0({open:r===0}),l={ref:t,"aria-hidden":!0},c=n?i3:f.Fragment,u=n?{unmount:i}:{},d=Li();return wt.createElement(c,{...u},d({ourProps:l,theirProps:s,slot:o,defaultTag:yze,name:"Dialog.Backdrop"}))}let vze="h2";function wze(e,t){let n=f.useId(),{id:s=`headlessui-dialog-title-${n}`,...r}=e,[{dialogState:i,setTitleId:o}]=P1("Dialog.Title"),l=Xo(t);f.useEffect(()=>(o(s),()=>o(null)),[s,o]);let c=w0({open:i===0}),u={ref:l,id:s};return Li()({ourProps:u,theirProps:r,slot:c,defaultTag:vze,name:"Dialog.Title"})}let jze=_r(gze),Nze=_r(xze);_r(bze);let Cze=_r(wze),l8=Object.assign(jze,{Panel:Nze,Title:Cze,Description:q6e});function N0({isOpen:e,onClose:t,onSave:n,onEdit:s,setFormData:r,formData:i,isEditing:o=!1,viewMode:l=!1,users:c=[],currentUser:u,onDelete:d}){const[h,p]=f.useState([]),[x,b]=f.useState([]),[j,y]=f.useState({}),{comments:N,addComment:w,refresh:S}=kn({relatedType:"task",relatedId:i?.id});f.useEffect(()=>{i?.id&&S()},[i?.id,S]);const _=F=>{if(!F)return"";const D=String(F).split("-");return D.length===3?`${D[0]}-${D[2]}`:String(F)},T=F=>{const{name:D,value:P}=F.target;D==="subject"&&P.trim()&&y(B=>({...B,subject:!1})),r(B=>{const G={...B,[D]:P};return D==="relatedType1"&&(G.relatedTo1="",P==="Lead"?(G.relatedType2=null,G.relatedTo2=null,b([])):P==="Account"&&(G.relatedType2="Contact")),D==="relatedType2"&&(G.relatedTo2=""),G})};f.useEffect(()=>{if(!e)return;(async()=>{try{p([]);let D;i.relatedType1==="Lead"?D=await ne.get("/leads/admin/getLeads"):i.relatedType1==="Account"&&(D=await ne.get("/accounts/admin/fetch-all"));let P=[];if(D&&Array.isArray(D.data)&&(P=D.data),o&&i.relatedTo1)try{let B;i.relatedType1==="Lead"?B=await ne.get(`/leads/get/${i.relatedTo1}`):i.relatedType1==="Account"&&(B=await ne.get(`/accounts/get/${i.relatedTo1}`)),B&&B.data&&(P.some($=>String($.id)===String(i.relatedTo1))||(P=[B.data,...P]))}catch(B){console.error("Error fetching specific related item:",B)}p(P)}catch(D){console.error("Error fetching related 1 data:",D),p([])}})()},[i.relatedType1,e,o,i.relatedTo1]),f.useEffect(()=>{if(!e||l)return;(async()=>{try{if(b([]),i.relatedType1==="Account"&&i.relatedTo1){let D;i.relatedType2==="Contact"?D=await ne.get(`/contacts/from-acc/${i.relatedTo1}`):i.relatedType2==="Deal"?D=await ne.get(`/deals/from-acc/${i.relatedTo1}`):i.relatedType2==="Quote"&&(D=await ne.get(`/quotes/from-acc/${i.relatedTo1}`));let P=[];if(D&&Array.isArray(D.data)&&(P=D.data),o&&i.relatedTo2)try{let B;i.relatedType2==="Contact"?B=await ne.get(`/contacts/get/${i.relatedTo2}`):i.relatedType2==="Deal"?B=await ne.get(`/deals/get/${i.relatedTo2}`):i.relatedType2==="Quote"&&(B=await ne.get(`/quotes/get/${i.relatedTo2}`)),B&&B.data&&(P.some($=>String($.id)===String(i.relatedTo2))||(P=[B.data,...P]))}catch(B){console.error("Error fetching specific related item:",B)}b(P)}}catch(D){console.error("Error fetching related 2 data:",D),b([])}})()},[i.relatedType1,i.relatedTo1,i.relatedType2,i.relatedTo2,e,l,o]);const[k,A]=f.useState(!1);f.useEffect(()=>{e&&(A(!1),y({}))},[e]);const E=F=>{F.preventDefault(),A(!0);const D={};i.subject?.trim()||(D.subject=!0,V.error("Title is required")),y(D),i.relatedTo1||(D.relatedTo1=!0,V.error(`Please select a ${i.relatedType1||"Lead/Account"}.`)),i.assignedTo||(D.assignedTo=!0,V.error("Assigned To is required.")),!(Object.keys(D).length>0)&&n?.(i)},M=l?"Task Details":o?"Edit Task":"Create Task";return a.jsx(Sv,{appear:!0,show:e,as:f.Fragment,children:a.jsxs(l8,{as:"div",className:"relative z-50",onClose:t,children:[a.jsx(Sv.Child,{as:f.Fragment,enter:"ease-out duration-200",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-150",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:a.jsx("div",{className:"fixed inset-0 bg-black/40"})}),a.jsx("div",{className:"fixed inset-0 flex items-center justify-center p-4 overflow-y-auto",children:a.jsx("div",{className:"flex min-h-full items-center justify-center text-center",children:a.jsx(Sv.Child,{as:f.Fragment,enter:"ease-out duration-200",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-150",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:a.jsx(l8.Panel,{className:"w-full max-w-full sm:max-w-3xl text-left align-middle transform transition-all",children:a.jsxs("div",{className:"bg-white w-full min-w-sm md:min-w-lg rounded-2xl shadow-lg p-4 sm:p-6 md:p-8 relative border border-gray-200 overflow-y-auto max-h-[90vh] flex flex-col hide-scrollbar",children:[a.jsx("button",{onClick:()=>{t(),A(!1),y({})},className:"absolute top-4 right-4 text-gray-500 hover:text-black transition",children:a.jsx(Za,{size:25})}),a.jsx("h3",{className:"text-xl sm:text-2xl font-semibold text-gray-800 mb-4 sm:mb-6 flex items-center justify-center",children:M}),l&&a.jsx("div",{className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center p-4",onClick:t,children:a.jsxs("div",{className:"bg-white rounded-xl shadow-lg w-full max-w-full lg:max-w-4xl max-h-[90vh] overflow-y-auto hide-scrollbar font-manrope relative",onClick:F=>F.stopPropagation(),children:[a.jsxs("div",{className:"bg-tertiary w-full flex items-center justify-between p-3 lg:p-4 rounded-t-xl",children:[a.jsx("h1",{className:"lg:text-3xl text-xl text-white font-semibold text-center w-full",children:"Tasks"}),a.jsx("button",{onClick:()=>{t(),A(!1)},className:"text-gray-500 hover:text-white transition cursor-pointer",children:a.jsx(Za,{size:25})})]}),a.jsx("div",{className:"p-6 lg:p-4",children:a.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between lg:flex-row lg:items-center lg:justify-between mt-3 gap-2 px-2 md:items-center lg:gap-4 md:mx-7 lg:mx-7",children:[a.jsx("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:a.jsx("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-800",children:i.subject||"No Title"})}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[!((/group.manager/i.test(u?.role)||/manager/i.test(u?.role)||/sales/i.test(u?.role))&&String(i?.createdById)!==String(u?.id))&&a.jsxs("button",{className:"inline-flex items-center justify-center w-full sm:w-auto bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 transition text-sm focus:outline-none focus:ring-2 focus:ring-blue-400 cursor-pointer",onClick:()=>{r&&r(i),typeof s=="function"&&s()},children:[a.jsx(hn,{className:"mr-2"}),"Edit"]}),(/group.manager/i.test(u?.role)||/manager/i.test(u?.role)||/sales/i.test(u?.role))&&String(i?.createdById)!==String(u?.id)?null:/group.manager/i.test(u?.role)||/manager/i.test(u?.role)||/sales/i.test(u?.role)?a.jsxs("button",{className:"inline-flex items-center justify-center w-full sm:w-auto px-4 py-2 rounded-md text-sm bg-orange-500 text-white hover:bg-orange-600 transition focus:outline-none focus:ring-2 focus:ring-orange-400 cursor-pointer",onClick:()=>d(i),children:[a.jsx(Zt,{className:"mr-2"}),"Archive"]}):u?.role==="ADMIN"||u?.role==="CEO"?a.jsxs("button",{className:"inline-flex items-center justify-center w-full sm:w-auto px-4 py-2 rounded-md text-sm bg-red-500 text-white hover:bg-red-600 transition focus:outline-none focus:ring-2 focus:ring-red-400 cursor-pointer",onClick:()=>d(i),children:[a.jsx(_a,{className:"mr-2"}),"Delete"]}):null]})]})}),a.jsx("div",{className:"border-b border-gray-200 my-5"}),a.jsxs("div",{className:"p-4",children:[a.jsx("div",{className:"flex w-full bg-[#6A727D] text-white overflow-x-auto",children:a.jsx("button",{className:"flex-1 min-w-[90px] px-4 py-2 lg:text-lg text-sm font-medium text-center text-white",children:"Overview"})}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 lg:p-5 border border-gray-200 text-sm text-gray-700",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Title:"}),a.jsx("p",{children:i.subject||""})]}),i.relatedType1Text&&i.relatedTo1Text&&a.jsxs("div",{children:[a.jsxs("p",{className:"font-semibold",children:[i.relatedType1Text,":"]}),a.jsx("p",{children:i.relatedTo1Text})]}),i.relatedType2Text&&i.relatedTo2Text&&a.jsxs("div",{children:[a.jsxs("p",{className:"font-semibold",children:[i.relatedType2,":"]}),a.jsx("p",{children:i.relatedTo2Text})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Assigned To:"}),a.jsx("p",{children:i.assignedToName||""})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created By:"}),a.jsx("p",{children:i.createdBy||""})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Priority:"}),a.jsx("p",{children:i.priority||""})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Status:"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("p",{children:i.status||""}),i.rawStatus==="INACTIVE"&&(u?.role==="ADMIN"||u?.role==="CEO")&&a.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-red-600 text-white",children:"INACTIVE"})]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Due Date:"}),a.jsx("p",{children:i.dueDate||""})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("p",{className:"font-semibold",children:"Description:"}),a.jsx("p",{className:"whitespace-pre-wrap",children:i.description||""})]})]}),a.jsx(Tn,{comments:N,onAddComment:w})]})]})]})}),!l&&a.jsxs("form",{onSubmit:E,className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm flex-1",children:[a.jsxs("div",{className:"md:col-span-2",children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:["Title"," ",a.jsx("span",{className:"text-red-500 font-semibold",children:"*"})]}),a.jsx("input",{type:"text",name:"subject",value:i.subject,onChange:T,disabled:l,placeholder:"Enter task title",className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border focus:ring-2
                            ${j.subject?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}
                            ${l?"bg-gray-50 cursor-not-allowed":""}
                          `})]}),a.jsxs("div",{className:"w-full flex flex-col",children:[a.jsxs("div",{className:"relative w-25",children:[a.jsxs("select",{name:"relatedType1",onChange:T,value:i.relatedType1,disabled:l,className:"w-full pr-6 rounded-md text-sm mb-2",children:[a.jsx("option",{value:"Lead",children:"Lead"}),a.jsx("option",{value:"Account",children:"Account"})]}),a.jsx("span",{className:"absolute left-10 md:pl-6 pl-6 top-1/2 -translate-y-1/2 text-red-500 pointer-events-none",children:"*"})]}),a.jsx(kA,{disabled:!1,items:Array.isArray(h)?h:[],value:i.relatedTo1??"",placeholder:`Search ${i.relatedType1||"here"}...`,getLabel:F=>i.relatedType1==="Lead"?F.title:F.name??"",onChange:F=>r(D=>({...D,relatedTo1:F})),required:!0,isSubmitted:k})]}),a.jsxs("div",{className:"w-full flex flex-col",children:[a.jsxs("select",{name:"relatedType2",onChange:T,value:i.relatedType2??"Contact",className:"w-23 rounded-md text-sm focus:ring-2 focus:ring-blue-400 outline-none mb-2 disabled:text-gray-400 disabled:cursor-not-allowed",disabled:l||i.relatedType1==="Lead",children:[a.jsx("option",{value:"Contact",children:"Contact"}),a.jsx("option",{value:"Deal",children:"Deal"}),a.jsx("option",{value:"Quote",children:"Quote"})]}),a.jsx(kA,{disabled:i.relatedType1==="Lead",items:Array.isArray(x)?x:[],value:i.relatedTo2??"",placeholder:i.relatedType1==="Lead"?"":Array.isArray(x)&&x.length>0?`Search ${i.relatedType2||"Contact"}...`:`No ${i.relatedType2||""} data found`,getLabel:F=>i.relatedType2==="Contact"?`${F.first_name??""} ${F.last_name??""}`.trim():i.relatedType2==="Quote"?_(F.quote_id)??"":F.name??"",onChange:F=>r(D=>({...D,relatedTo2:F}))})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Description"}),a.jsx("textarea",{name:"description",value:i.description,onChange:T,disabled:l,placeholder:"Enter task description",rows:3,className:`w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none ${l?"bg-gray-50 cursor-not-allowed":""}`})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Priority"}),a.jsxs("select",{name:"priority",value:i.priority,onChange:T,disabled:l,className:`w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none ${l?"bg-gray-50 cursor-not-allowed":""}`,children:[a.jsx("option",{value:"Low",children:"Low"}),a.jsx("option",{value:"Normal",children:"Normal"}),a.jsx("option",{value:"High",children:"High"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Due Date"}),a.jsx("input",{type:"datetime-local",name:"dueDate",value:i.dueDate,onChange:T,disabled:l,className:`w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none ${l?"bg-gray-50 cursor-not-allowed":""}`})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:["Assign To"," ",u?.role!=="Sales"&&a.jsx("span",{className:"text-red-500 font-semibold",children:"*"})]}),a.jsx(kA,{items:Array.isArray(c)?c:[],value:i.assignedTo??"",placeholder:u?.role==="Sales"?`${u.first_name} ${u.last_name}`:"Search an account...",getLabel:F=>`${F.first_name} ${F.last_name}`,onChange:F=>r(D=>({...D,assignedTo:F})),disabled:l||u?.role==="Sales",required:u?.role!=="Sales",isSubmitted:k})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Status"}),a.jsxs("select",{name:"status",value:i.status,onChange:T,disabled:l,className:`w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none ${l?"bg-gray-50 cursor-not-allowed":""}`,children:[a.jsx("option",{value:"Not started",children:"Not started"}),a.jsx("option",{value:"In progress",children:"In Progress"}),a.jsx("option",{value:"Deferred",children:"Deferred"}),a.jsx("option",{value:"Completed",children:"Completed"})]})]}),!l&&a.jsxs("div",{className:"flex flex-col sm:flex-row justify-end sm:justify-end space-y-2 sm:space-y-0 sm:space-x-2 col-span-1 md:col-span-2 mt-4 w-full",children:[a.jsx("button",{type:"button",onClick:()=>{t(),A(!1),y({})},className:"w-full sm:w-auto px-4 py-2 text-white bg-red-400 border border-red-300 rounded hover:bg-red-500 transition",children:"Cancel"}),a.jsx("button",{type:"submit",className:"w-full sm:w-auto px-4 py-2 text-white border border-tertiary bg-tertiary rounded hover:bg-secondary transition",children:o?"Update Task":"Create Task"})]})]})]})})})})})]})})}function kA({items:e=[],value:t="",onChange:n,getLabel:s,placeholder:r="Search...",disabled:i=!1,maxRender:o=200,required:l=!1,isSubmitted:c=!1}){const[u,d]=f.useState(!1),[h,p]=f.useState(""),x=f.useRef(null),b=e.find(w=>String(w.id)===String(t)),j=b?s(b):"",y=l&&c&&!t,N=f.useMemo(()=>{const w=h.trim().toLowerCase();return(w?e.filter(_=>(s(_)||"").toLowerCase().includes(w)):e).slice(0,o)},[e,h,s,o]);return f.useEffect(()=>{const w=S=>{x.current&&!x.current.contains(S.target)&&d(!1)};return document.addEventListener("mousedown",w),()=>document.removeEventListener("mousedown",w)},[]),f.useEffect(()=>{u||p("")},[u]),a.jsxs("div",{ref:x,className:"relative w-full",children:[a.jsx("input",{disabled:i,value:u?h:j,placeholder:r,onFocus:()=>!i&&d(!0),onChange:w=>{p(w.target.value),u||d(!0)},className:`w-full border rounded-md px-2 py-1.5 text-sm outline-none focus:ring-2 disabled:bg-gray-100
          ${y?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}`}),u&&!i&&a.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg overflow-hidden",children:[a.jsx("div",{className:"max-h-56 overflow-y-auto",children:N.length>0?N.map(w=>{const S=String(w.id),_=s(w),T=String(t)===S;return a.jsx("button",{type:"button",onClick:()=>{n(S),d(!1)},className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-50 ${T?"bg-blue-50":""}`,children:_||"--"},S)}):a.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No results"})}),e.length>o&&a.jsxs("div",{className:"px-3 py-2 text-[11px] text-gray-400 border-t",children:["Showing first ",o," results  keep typing to narrow."]})]})]})}const c8=["Not started","In progress","Deferred","Completed"],d8={NOT_STARTED:"Not started","NOT STARTED":"Not started","TO DO":"Not started",IN_PROGRESS:"In progress","IN PROGRESS":"In progress",COMPLETED:"Completed",DEFERRED:"Deferred","Not started":"Not started","In progress":"In progress",Completed:"Completed",Deferred:"Deferred","In Progress":"In progress","To Do":"Not started",Review:"Deferred"},lJ=e=>e&&(d8[e]||d8[String(e).toUpperCase()])||"Not started",Sze=e=>{if(!e)return"";const t=new Date(e);if(Number.isNaN(t.getTime()))return"";const n=t.getTimezoneOffset();return new Date(t.getTime()-n*60*1e3).toISOString().slice(0,16)},EA=e=>{if(!e)return"";const t=new Date(e);return Number.isNaN(t.getTime())?"":t.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},_ze=e=>{const t=e.subject?.trim()??"",n=e.description?.trim()??"",s=e.notes?.trim()??"";e.priority&&String(e.priority).toUpperCase(),lJ(e.status);let r=null,i=null,o=null,l=null,c=null;e.relatedType1==="Lead"&&e.relatedTo1?r=Number(e.relatedTo1):e.relatedType1==="Account"&&e.relatedTo1&&(i=Number(e.relatedTo1)),e.relatedType1==="Account"&&(e.relatedType2==="Contact"&&e.relatedTo2?o=Number(e.relatedTo2):e.relatedType2==="Deal"&&e.relatedTo2?l=Number(e.relatedTo2):e.relatedType2==="Quote"&&e.relatedTo2&&(c=Number(e.relatedTo2)));const u=e.assignedTo?Number(e.assignedTo):null,d=o||l||i||r,h=o?"Contact":l?"Deal":i?"Account":r?"Lead":c?"Quote":null;return{title:t,description:n,priority:e.priority||"Normal",status:e.status||"Not started",due_date:e.dueDate?e.dueDate:null,assigned_to:u,notes:s,is_personal:!1,lead_id:r,account_id:i,contact_id:o,deal_id:l,quote_id:c,related_to_1:e.relatedTo1?Number(e.relatedTo1):null,related_type_1:e.relatedType1,related_to_2:e.relatedTo2?Number(e.relatedTo2):null,related_type_2:e.relatedType2,related_to:d,related_type:h}},Aze=e=>{const t=e.task_assign_to?`${e.task_assign_to.first_name} ${e.task_assign_to.last_name}`:e.assigned_to?String(e.assigned_to):"Unassigned",n=e.task_creator?`${e.task_creator.first_name} ${e.task_creator.last_name}`:e.created_by?String(e.created_by):"System",s=e.due_date||e.dueDate||null,r=e.date_assigned||e.created_at||null,i=e.contact?`${e.contact.first_name} ${e.contact.last_name}`:e.assigned_to?String(e.assigned_to.id):"Unassigned",o=G=>{if(!G)return"";const $=String(G).split("-");return $.length===3?`${$[0]}-${$[2]}`:String(G)},l=()=>e.lead?.id||e.lead_id,c=()=>e.account?.id||e.account_id,u=()=>e.contact?.id||e.contact_id,d=()=>e.deal?.id||e.deal_id,h=()=>e.quote?.id||e.quote_id,p=()=>e.task_assign_to?.id||e.assigned_to,x=()=>e.lead?.title||e.lead_id,b=()=>e.account?.name||e.account_id,j=()=>i||e.contact_id,y=()=>e.deal?.name||e.deal_id,N=()=>o(e.quote?.quote_id)||e.id;let w="Lead",S="",_="",T="",k="Lead",A="",E="",M="";const F=c(),D=b(),P=l(),B=x();if(F){w="Account",k="Account",A=D,S=String(F);const G=u(),$=d(),W=j(),Z=y(),Q=h(),le=N();G?(_="Contact",E="Contact",M=W,T=String(G)):$?(E="Deal",_="Deal",M=Z,T=String($)):Q&&(E="Quote",_="Quote",M=le,T=String(Q))}else P?(k="Lead",A=B,w="Lead",S=String(P)):e.related_type==="Account"&&(w="Account",S=String(e.related_to));return{id:e.id,title:e.title,description:e.description,priority:e.priority||"Normal",status:lJ(e.status),rawStatus:e.status,dueDate:s,dateAssigned:r,assignedToId:p()||null,assignedToName:t,createdAt:e.created_at||null,createdById:e.created_by??null,createdBy:n,notes:e.notes||"",isPersonal:!!e.is_personal,relatedType1Text:k,relatedTo1Text:A,relatedType2Text:E,relatedTo2Text:M,subject:e.title,relatedType1:w,relatedTo1:S,relatedType2:_,relatedTo2:T}};function Tze(){f.useEffect(()=>{document.title="Tasks | Sari-Sari CRM"},[]);const{user:e,loading:t}=Gt(),[n,s]=f.useState("board"),[r,i]=f.useState(!1),[o,l]=f.useState(null),[c,u]=f.useState(!1),[d,h]=f.useState([]),[p,x]=f.useState(!0),[b,j]=f.useState(""),[y,N]=f.useState("Filter by Status"),[w,S]=f.useState("Filter by Priority"),[_,T]=f.useState([]),[k,A]=f.useState(1),[E,M]=f.useState(10),[F,D]=f.useState(null),[P,B]=f.useState(!1),[G,$]=f.useState([]),[W,Z]=f.useState(null),Q=Et(),le=ta(),[we,J]=f.useState({id:"",subject:"",description:"",priority:"",status:"",dueDate:"",assignedTo:"",notes:"",relatedType1:"Lead",relatedType2:"Contact",relatedTo1:"",relatedTo2:""}),[se,ye]=f.useState(null),Ce=qx(qf(dm,{activationConstraint:{distance:8}})),ge=je=>{const{active:ve}=je,z=d.find(K=>K.id===ve.id);Z(z)},be=async je=>{const{active:ve,over:z}=je;if(Z(null),!z)return;const K=ve.id,ue=z.id,re=d.find(Le=>Le.id===K);if(!(!re||re.status===ue)){h(Le=>Le.map(De=>De.id===K?{...De,status:ue}:De));try{const Le={title:re.title,description:re.description||"",priority:re.priority||"Normal",status:ue,due_date:re.dueDate||null,assigned_to:re.assignedToId||null,related_type_1:re.relatedType1||null,related_to_1:re.relatedTo1?parseInt(re.relatedTo1,10):null,related_type_2:re.relatedType2||null,related_to_2:re.relatedTo2?parseInt(re.relatedTo2,10):null};(!Le.related_to_1||isNaN(Le.related_to_1))&&(Le.related_to_1=null),(!Le.related_to_2||isNaN(Le.related_to_2))&&(Le.related_to_2=null),await ne.put(`/tasks/${K}`,Le),V.success(`Task moved to "${ue}"`)}catch(Le){console.error("Failed to update task status:",Le),V.error("Failed to update task status"),h(De=>De.map(Qe=>Qe.id===K?{...Qe,status:re.status}:Qe))}}},me=()=>{Z(null)};f.useEffect(()=>{const je=le.state?.openTaskModal,ve=le.state?.initialTaskData,z=le.state?.taskID;je?(i(!0),ve&&J(K=>({...K,...ve})),Q(le.pathname,{replace:!0,state:{}})):z&&(ye(z),Q(le.pathname,{replace:!0,state:{}}))},[le,Q]),f.useEffect(()=>{if(se&&d.length>0&&!p){const je=d.find(ve=>ve.id===se);je?xe(je,!0):V.error("Task not found."),ye(null)}},[se,d,p]);const Ae=async()=>{try{const je=await ne.get("/users/all");T(Array.isArray(je.data)?je.data:[])}catch(je){console.error("Failed to fetch users:",je),V.error("Failed to fetch users.")}},pe=async()=>{try{x(!0);const je=await ne.get("/tasks/all"),z=(Array.isArray(je.data)?je.data:[]).map(Aze);z.sort((K,ue)=>{const re=K.createdAt?new Date(K.createdAt):0;return(ue.createdAt?new Date(ue.createdAt):0)-re}),h(z),n==="list"&&A(1)}catch(je){console.error("Failed to load tasks:",je),V.error("Failed to load tasks.")}finally{x(!1)}};f.useEffect(()=>{if(!t&&e){Ae(),pe();const je=Fj(e.id),ve=new WebSocket(je);return ve.onopen=()=>{console.log(" Connected to task notifications")},ve.onmessage=z=>{try{const K=JSON.parse(z.data);K.type==="task_status_updated"&&(V.info(` ${K.message}`,{position:"top-right",autoClose:4e3}),pe())}catch(K){console.error("Error parsing notification:",K)}},ve.onerror=z=>{console.error(" WebSocket error:",z)},ve.onclose=()=>{console.log(" Disconnected from task notifications")},()=>{ve&&ve.readyState===WebSocket.OPEN&&ve.close()}}},[t,e]);const Ie=()=>{l(null),J({id:"",subject:"",description:"",priority:"Normal",status:"Not started",dueDate:"",assignedTo:"",notes:"",relatedType1:"Lead",relatedType2:"Contact",relatedTo1:"",relatedTo2:""})},xe=(je=null,ve=!1)=>{l(je),u(ve),je?J({id:je.id,subject:je.title||"",description:je.description||"",priority:je.priority||"Normal",status:je.status||"Not started",rawStatus:je.rawStatus,dueDate:Sze(je.dueDate),assignedTo:je.assignedToId?String(je.assignedToId):"",assignedToName:je.assignedToName||"",createdBy:je.createdBy||"",notes:je.notes||"",relatedType1Text:je.relatedType1Text||"",relatedTo1Text:je.relatedTo1Text||"",relatedType2Text:je.relatedType2Text||"",relatedTo2Text:je.relatedTo2Text||"",relatedType1:je.relatedType1||"",relatedTo1:je.relatedTo1||"",relatedType2:je.relatedType2||"",relatedTo2:je.relatedTo2||""}):Ie(),i(!0)},he=()=>{i(!1),l(null),u(!1),Ie()},Re=async je=>{const ve=_ze(je);try{o&&!c?(await ne.put(`/tasks/${o.id}`,ve),V.success("Task updated successfully.")):(await ne.post("/tasks/create",ve),V.success("Task created successfully.")),i(!1),await pe()}catch(z){console.error("Failed to save task:",z);const K=z.response?.data?.detail||"Failed to save task.";V.error(K)}},Ee=je=>{je&&D({title:"Delete Task",message:a.jsxs(a.Fragment,{children:["Are you sure you want to delete ",a.jsx("span",{className:"font-semibold",children:je.title}),"?"]}),confirmLabel:"Delete Task",cancelLabel:"Cancel",variant:"danger",action:{type:"delete",targetId:je.id}})},He=()=>{if(at.every(je=>G.includes(je.id)))$(G.filter(je=>!at.map(ve=>ve.id).includes(je)));else{const je=at.map(ve=>ve.id);$([...new Set([...G,...je])])}},Ke=je=>{$(ve=>ve.includes(je)?ve.filter(z=>z!==je):[...ve,je])},st=async()=>{G.length!==0&&D({title:"Delete Tasks",message:a.jsxs("span",{children:["Are you sure you want to delete"," ",a.jsx("span",{className:"font-semibold",children:G.length})," selected tasks? This action cannot be undone."]}),confirmLabel:`Delete ${G.length} Task(s)`,cancelLabel:"Cancel",variant:"danger",action:{type:"bulk-delete",task_ids:G}})},it=async()=>{if(!F?.action){D(null);return}const{action:je}=F;B(!0);try{je.type==="delete"?(await ne.delete(`/tasks/${je.targetId}`),V.success("Task deleted successfully."),await pe()):je.type==="bulk-delete"&&(await ne.delete("/tasks/admin/bulk-delete",{data:{task_ids:je.task_ids}}),V.success(`Successfully deleted ${je.task_ids.length} tasks`),$([]),await pe())}catch(ve){console.error("Task action failed:",ve),V.error("Failed to delete task.")}finally{B(!1),D(null)}},ot=()=>{P||D(null)},rt=f.useMemo(()=>{const je=b.trim().toLowerCase();return[...d].sort((z,K)=>{const ue=z.createdAt?new Date(z.createdAt):0;return(K.createdAt?new Date(K.createdAt):0)-ue}).filter(z=>{const K=je===""||z.title?.toLowerCase().includes(je)||z.description?.toLowerCase().includes(je)||z.assignedToName?.toLowerCase().includes(je)||z.createdBy?.toLowerCase().includes(je),ue=y==="Filter by Status"||z.status===y,re=w==="Filter by Priority"||z.priority===w;return K&&ue&&re})},[d,b,y,w]);f.useEffect(()=>{A(1)},[b,y,w,n,E]),f.useEffect(()=>{if(n==="list"){const je=rt.length===0?1:Math.ceil(rt.length/E);k>je&&A(je)}},[rt.length,k,n,E]);const at=f.useMemo(()=>{if(n==="board")return rt;const je=(k-1)*E;return rt.slice(je,je+E)},[rt,k,n,E]),Je=f.useMemo(()=>{const je=new Date,ve=d.filter(z=>z.rawStatus!=="INACTIVE");return[{title:"To Do",value:ve.filter(z=>z.status==="Not started").length,icon:Vn,color:"text-blue-600",bgColor:"bg-blue-100"},{title:"In Progress",value:ve.filter(z=>z.status==="In progress").length,icon:Yi,color:"text-purple-600",bgColor:"bg-purple-100"},{title:"Completed",value:ve.filter(z=>z.status==="Completed").length,icon:La,color:"text-green-600",bgColor:"bg-green-100"},{title:"Overdue",value:ve.filter(z=>z.dueDate&&new Date(z.dueDate)<je&&z.status!=="Completed").length,icon:Fl,color:"text-red-600",bgColor:"bg-red-100"},{title:"High Priority",value:ve.filter(z=>z.priority==="High").length,icon:ec,color:"text-orange-600",bgColor:"bg-orange-100"}]},[d]),Fe=je=>je.dueDate&&new Date(je.dueDate)<new Date&&je.status!=="Completed",Ue=je=>{switch(je.status){case"Not started":return"bg-blue-50 hover:bg-blue-100 border-blue-200";case"In progress":return"bg-purple-50 hover:bg-purple-100 border-purple-200";case"Deferred":return"bg-orange-50 hover:bg-orange-100 border-orange-200";case"Completed":return"bg-green-50 hover:bg-green-100 border-green-200";default:return"bg-gray-50 hover:bg-gray-100 border-gray-100"}},Ne=je=>{switch(je){case"Not started":return"bg-blue-100 text-blue-700";case"In progress":return"bg-purple-100 text-purple-700";case"Deferred":return"bg-orange-100 text-orange-700";case"Completed":return"bg-green-100 text-green-700";default:return"bg-gray-100 text-gray-700"}},ze=je=>{switch(je){case"High":return"bg-red-100 text-red-700";case"Normal":return"bg-yellow-100 text-yellow-700";default:return"bg-gray-100 text-gray-700"}};return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 min-h-screen font-inter relative",children:[(p||t)&&a.jsx(qt,{message:"Loading tasks..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 space-y-2 sm:space-y-0",children:[a.jsxs("h1",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[a.jsx(Yi,{className:"text-blue-600"})," Tasks Board"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{type:"button",onClick:()=>xe(),className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 rounded-md hover:bg-gray-800 text-sm sm:text-base self-end sm:self-auto mt-2 lg:mt-0 cursor-pointer",children:[a.jsx(aa,{})," Create Task"]})})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 xl:grid-cols-5 gap-4 mb-6 w-full break-words overflow-hidden lg:overflow-visible",children:Je.map(je=>a.jsx(kze,{...je},je.title))}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mt-6 mb-4 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search tasks",value:b,onChange:je=>j(je.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row w-full lg:w-1/2 gap-2",children:[a.jsxs("select",{value:y,onChange:je=>N(je.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{children:"Filter by Status"}),c8.map(je=>a.jsx("option",{children:je},je))]}),a.jsxs("select",{value:w,onChange:je=>S(je.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{children:"Filter by Priority"}),a.jsx("option",{children:"High"}),a.jsx("option",{children:"Normal"}),a.jsx("option",{children:"Low"})]})]})]}),a.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[a.jsx("button",{type:"button",onClick:()=>s("board"),className:`px-4 py-2 rounded-full text-sm ${n==="board"?"bg-gray-800 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Board View"}),a.jsx("button",{type:"button",onClick:()=>s("list"),className:`px-4 py-2 rounded-full text-sm ${n==="list"?"bg-gray-800 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"List View"})]}),!p&&!t&&n==="board"&&(rt.length>0?a.jsxs(Vx,{sensors:Ce,collisionDetection:Gx,onDragStart:ge,onDragEnd:be,onDragCancel:me,children:[a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4 rounded-md",children:c8.map(je=>{const ve=at.filter(z=>z.status===je);return a.jsx(Lze,{column:je,columnTasks:ve,getTaskCardColor:Ue,isTaskOverdue:Fe,formatDateDisplay:EA,handleOpenModal:xe,handleDeleteTask:Ee,currentUser:e},je)})}),a.jsx(MN,{children:W?a.jsx(Pze,{task:W,getTaskCardColor:Ue,isTaskOverdue:Fe,formatDateDisplay:EA}):null})]}):a.jsx("div",{className:"col-span-4 text-center py-10 text-gray-500 border border-dashed rounded-xl",children:"No tasks found."})),!p&&!t&&n==="list"&&a.jsx("div",{className:"bg-white rounded-md shadow-sm overflow-hidden",children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-gray-600 text-left",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 w-10",children:a.jsx("input",{type:"checkbox",className:"w-4 h-4 accent-blue-600",checked:at.length>0&&at.every(je=>G.includes(je.id)),onChange:He})}),a.jsx("th",{className:"py-3 px-4 font-medium",children:"Task"}),a.jsx("th",{className:"py-3 px-4 font-medium",children:"Status"}),a.jsx("th",{className:"py-3 px-4 font-medium",children:"Priority"}),a.jsx("th",{className:"py-3 px-4 font-medium",children:"Assigned To"}),a.jsx("th",{className:"py-3 px-4 font-medium",children:"Date Assigned"}),a.jsx("th",{className:"py-3 px-4 font-medium text-center w-24",children:G.length>0?a.jsx("button",{onClick:st,className:"text-red-600 hover:text-red-800 transition p-1 rounded-full hover:bg-red-50",title:`Delete ${G.length} selected tasks`,children:a.jsx(_a,{size:18})}):""})]})}),a.jsx("tbody",{children:at.length>0?at.map(je=>a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors text-sm cursor-pointer",children:[a.jsx("td",{className:"py-3 px-4",onClick:ve=>ve.stopPropagation(),children:a.jsx("input",{type:"checkbox",className:"w-4 h-4 accent-blue-600",checked:G.includes(je.id),onChange:()=>Ke(je.id)})}),a.jsx("td",{className:"py-3 px-4 text-gray-700 whitespace-nowrap font-medium",onClick:()=>xe(je,!0),children:je.title}),a.jsx("td",{className:"py-3 px-4 whitespace-nowrap",onClick:()=>xe(je,!0),children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium whitespace-nowrap ${Ne(je.status||"Not started")}`,children:je.status||"Not started"}),je.rawStatus==="INACTIVE"&&(e?.role==="ADMIN"||e?.role==="CEO")&&a.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium whitespace-nowrap bg-red-600 text-white",children:"INACTIVE"})]})}),a.jsx("td",{className:"py-3 px-4 whitespace-nowrap",onClick:()=>xe(je,!0),children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium whitespace-nowrap ${ze(je.priority||"Low")}`,children:je.priority||"Low"})}),a.jsx("td",{className:"py-3 px-4 text-gray-700 whitespace-nowrap",onClick:()=>xe(je,!0),children:je.assignedToName||"Unassigned"}),a.jsx("td",{className:`py-3 px-4 text-gray-700 whitespace-nowrap ${Fe(je)?"text-red-600 font-medium":""}`,onClick:()=>xe(je,!0),children:je.dueDate?EA(je.dueDate):""}),a.jsx("td",{})]},je.id)):a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"text-center py-4 text-gray-500",children:"No tasks found."})})})]})})}),!p&&!t&&n==="list"&&a.jsx(ca,{className:"mt-6",totalItems:rt.length,pageSize:E,currentPage:rt.length===0?0:k,onPrev:()=>A(je=>Math.max(je-1,1)),onNext:()=>A(je=>Math.min(je+1,Math.max(1,Math.ceil(rt.length/E)||1))),onPageSizeChange:je=>{M(je),A(1)},pageSizeOptions:[10,20,30,40,50],label:"tasks"}),a.jsx(N0,{isOpen:r,onClose:he,onSave:Re,onEdit:()=>u(!1),setFormData:J,formData:we,isEditing:!c&&!!o,viewMode:c,users:_,currentUser:e,onDelete:Ee}),F&&a.jsx(Eze,{open:!0,title:F.title,message:F.message,confirmLabel:F.confirmLabel,cancelLabel:F.cancelLabel,variant:F.variant,onConfirm:it,onCancel:ot,loading:P})]})}function kze({icon:e,title:t,value:n,color:s,bgColor:r,onClick:i}){return a.jsxs("div",{className:"flex items-center p-4 bg-white rounded-xl shadow-md border border-gray-200 transition-all duration-300 cursor-default",onClick:i,children:[a.jsx("div",{className:`flex-shrink-0 p-3 rounded-full ${r} ${s} mr-4`,children:e?a.jsx(e,{size:22}):null}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:t}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:n})]})]})}function Eze({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r,variant:i,loading:o,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsx("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${u}`,disabled:o,children:o?"Processing...":s})]})]})})}function Lze({column:e,columnTasks:t,getTaskCardColor:n,isTaskOverdue:s,formatDateDisplay:r,handleOpenModal:i,handleDeleteTask:o,currentUser:l}){const{isOver:c,setNodeRef:u}=Qx({id:e});return a.jsxs("div",{ref:u,className:`bg-white p-4 shadow border flex flex-col relative rounded-md transition-all duration-200 min-h-[200px] ${c?"border-blue-400 bg-blue-50 ring-2 ring-blue-300":"border-gray-200"}`,children:[a.jsx("div",{className:"absolute top-0 left-0 w-full h-5 bg-secondary rounded-t-md"}),a.jsxs("div",{className:"flex items-center justify-between mb-3 pt-7",children:[a.jsx("h3",{className:"font-medium text-gray-900",children:e}),a.jsx("span",{className:"text-xs bg-gray-100 px-2 py-1 rounded-full text-gray-500",children:t.length})]}),a.jsx("div",{className:`space-y-3 flex-1 ${t.length>3?"overflow-y-auto max-h-[480px] hide-scrollbar":""}`,children:t.length>0?t.map(d=>a.jsx(Dze,{task:d,getTaskCardColor:n,isTaskOverdue:s,formatDateDisplay:r,handleOpenModal:i,handleDeleteTask:o,currentUser:l},d.id)):a.jsx("div",{className:`text-center py-10 text-gray-500 border-2 border-dashed rounded-lg ${c?"border-blue-300 bg-blue-50":"border-gray-200"}`,children:c?"Drop here":"No tasks"})})]})}function Dze({task:e,getTaskCardColor:t,isTaskOverdue:n,formatDateDisplay:s,handleOpenModal:r,handleDeleteTask:i,currentUser:o}){const{attributes:l,listeners:c,setNodeRef:u,transform:d,isDragging:h}=Yx({id:e.id}),p=d?{transform:`translate3d(${d.x}px, ${d.y}px, 0)`}:void 0;return a.jsxs("div",{ref:u,style:p,className:`border rounded-lg p-3 transition flex justify-between items-start cursor-grab active:cursor-grabbing ${t(e)} ${h?"opacity-50 shadow-lg ring-2 ring-blue-400":""}`,...c,...l,children:[a.jsxs("div",{className:"text-left flex-1",onClick:x=>{x.stopPropagation(),r(e,!0)},children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx("p",{className:"font-medium text-gray-800 text-sm",children:e.title}),e.rawStatus==="INACTIVE"&&(o?.role==="ADMIN"||o?.role==="CEO")&&a.jsx("span",{className:"px-2 py-0.5 rounded text-xs font-medium bg-red-600 text-white",children:"INACTIVE"})]}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Priority: ",e.priority]}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Assigned To: ",e.assignedToName]}),a.jsxs("p",{className:"text-xs mt-1 text-gray-500",children:["Date: ",a.jsx("span",{className:n(e)?"text-red-600":"text-gray-600",children:e.dueDate?s(e.dueDate):""})]})]}),a.jsxs("div",{className:"flex items-center gap-2 ml-3",onClick:x=>x.stopPropagation(),children:[a.jsx("button",{type:"button",onClick:x=>{x.stopPropagation(),r(e)},className:"text-blue-500 hover:text-blue-700",children:a.jsx(hn,{})}),a.jsx("button",{type:"button",onClick:x=>{x.stopPropagation(),i(e)},className:"text-red-500 hover:text-red-700",children:a.jsx(_a,{})})]})]})}function Pze({task:e,getTaskCardColor:t,isTaskOverdue:n,formatDateDisplay:s}){return a.jsx("div",{className:`border rounded-lg p-3 shadow-xl ring-2 ring-blue-400 ${t(e)}`,style:{width:"280px"},children:a.jsxs("div",{className:"text-left flex-1",children:[a.jsx("p",{className:"font-medium text-gray-800 text-sm",children:e.title}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Priority: ",e.priority]}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Assigned To: ",e.assignedToName]}),a.jsxs("p",{className:"text-xs mt-1 text-gray-500",children:["Date: ",a.jsx("span",{className:n(e)?"text-red-600":"text-gray-600",children:e.dueDate?s(e.dueDate):""})]})]})})}function LA(e){return Ot({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M368.5 240H272v-96.5c0-8.8-7.2-16-16-16s-16 7.2-16 16V240h-96.5c-8.8 0-16 7.2-16 16 0 4.4 1.8 8.4 4.7 11.3 2.9 2.9 6.9 4.7 11.3 4.7H240v96.5c0 4.4 1.8 8.4 4.7 11.3 2.9 2.9 6.9 4.7 11.3 4.7 8.8 0 16-7.2 16-16V272h96.5c8.8 0 16-7.2 16-16s-7.2-16-16-16z"},child:[]}]})(e)}function Oze(e){return Ot({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M235.4 172.2c0-11.4 9.3-19.9 20.5-19.9 11.4 0 20.7 8.5 20.7 19.9s-9.3 20-20.7 20c-11.2 0-20.5-8.6-20.5-20zm1.4 35.7H275V352h-38.2V207.9z"},child:[]},{tag:"path",attr:{d:"M256 76c48.1 0 93.3 18.7 127.3 52.7S436 207.9 436 256s-18.7 93.3-52.7 127.3S304.1 436 256 436c-48.1 0-93.3-18.7-127.3-52.7S76 304.1 76 256s18.7-93.3 52.7-127.3S207.9 76 256 76m0-28C141.1 48 48 141.1 48 256s93.1 208 208 208 208-93.1 208-208S370.9 48 256 48z"},child:[]}]})(e)}const DA={name:"",description:"",manager_id:"",user_ids:[],company_id:""};function Mze({label:e,options:t,selectedValues:n,onChange:s,disabled:r=!1,placeholder:i="Select users...",isSubmitted:o=!1,required:l=!1}){const[c,u]=f.useState(!1),[d,h]=f.useState(""),p=f.useRef(null);f.useEffect(()=>{function N(w){p.current&&!p.current.contains(w.target)&&(u(!1),h(""))}return document.addEventListener("mousedown",N),()=>document.removeEventListener("mousedown",N)},[]);const x=t.filter(N=>N.label.toLowerCase().includes(d.toLowerCase())),b=N=>{const w=n.includes(N);let S;w?S=n.filter(_=>_!==N):S=[...n,N],s(S)},j=(N,w)=>{N.stopPropagation(),s(n.filter(S=>S!==w))},y=t.filter(N=>n.includes(N.value));return a.jsxs("div",{className:"relative",ref:p,children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsxs("div",{onClick:()=>!r&&u(!c),className:`w-full border ${l&&o&&n.length===0?"border-red-500 ring-red-500":c?"border-gray-500 ring-1 ring-gray-400":"border-gray-300"} 
  rounded-md px-3 py-2 text-sm bg-white cursor-pointer min-h-[38px] flex flex-wrap items-center gap-2
  ${r?"bg-gray-100 cursor-not-allowed":""}`,children:[n.length===0&&a.jsx("span",{className:"text-gray-400 select-none",children:i}),y.map(N=>a.jsxs("span",{className:"bg-indigo-100 text-indigo-700 px-2 py-0.5 rounded text-xs flex items-center gap-1 border border-indigo-200",children:[N.label,!r&&a.jsx(ea,{className:"cursor-pointer hover:text-indigo-900",onClick:w=>j(w,N.value)})]},N.value)),a.jsx("div",{className:"ml-auto text-gray-400",children:a.jsx(Dt,{})})]}),c&&!r&&a.jsxs("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-hidden flex flex-col",children:[a.jsx("div",{className:"p-2 border-b border-gray-100 sticky top-0 bg-white",children:a.jsxs("div",{className:"flex items-center px-2 py-1 bg-gray-50 rounded border border-gray-200",children:[a.jsx(Kt,{className:"text-gray-400 mr-2"}),a.jsx("input",{type:"text",className:"bg-transparent outline-none w-full text-sm",placeholder:"Search...",value:d,onChange:N=>h(N.target.value),autoFocus:!0})]})}),a.jsx("div",{className:"overflow-y-auto flex-1",children:x.length>0?x.map(N=>{const w=n.includes(N.value);return a.jsxs("div",{onClick:()=>b(N.value),className:`px-4 py-2 text-sm cursor-pointer flex items-center justify-between hover:bg-gray-50 
                      ${w?"bg-indigo-50 text-indigo-700":"text-gray-700"}`,children:[a.jsx("span",{children:N.label}),w&&a.jsx(AL,{className:"text-indigo-600"})]},N.value)}):a.jsx("div",{className:"px-4 py-3 text-sm text-gray-500 text-center",children:"No results found"})})]})]})}function Bc(){f.useEffect(()=>{document.title="Territory | Sari-Sari CRM"},[]);const e=Et(),{id:t}=Wo(),[n,s]=f.useState(""),[r,i]=f.useState(""),[o,l]=f.useState(""),[c,u]=f.useState(null),[d,h]=f.useState(!1),[p,x]=f.useState([]),[b,j]=f.useState(!1),[y,N]=f.useState([]),[w,S]=f.useState(DA),[_,T]=f.useState(!1),[k,A]=f.useState(!1),[E,M]=f.useState(null),[F,D]=f.useState(null),[P,B]=f.useState("board"),[G,$]=f.useState(null),[W,Z]=f.useState(!1),[Q,le]=f.useState(null),[we,J]=f.useState(1),[se,ye]=f.useState(10),[Ce,ge]=f.useState([]),[be,me]=f.useState(null),Ae=f.useRef(!1),pe=f.useRef(!1),{userRole:Ie}=Ks(),xe=f.useMemo(()=>{const Me=new Map;return p.forEach(et=>{const yt=`${et.name}-${et.manager_id||"no-manager"}`;if(!Me.has(yt))Me.set(yt,{...et,territory_ids:[et.id],assigned_users_list:et.assigned_to?[et.assigned_to]:[]});else{const _t=Me.get(yt);_t.territory_ids.push(et.id),et.assigned_to&&(_t.assigned_users_list.some(Ct=>Ct.id===et.assigned_to.id)||_t.assigned_users_list.push(et.assigned_to))}}),Array.from(Me.values())},[p]),he=f.useMemo(()=>{const Me=n.trim().toLowerCase(),et=r.trim().toLowerCase(),yt=o.trim();return[...xe].sort((Ct,jt)=>{const At=Ct?.created_at?new Date(Ct.created_at):0;return(jt?.created_at?new Date(jt.created_at):0)-At}).filter(Ct=>{const jt=Ct.name?.toLowerCase()||"",At=Ct.description?.toLowerCase()||"",Ge=Ct.managed_by?`${Ct.managed_by.first_name} ${Ct.managed_by.last_name}`.toLowerCase():"",Be=Ct.status?.toString().toLowerCase()||"",ce=Ct.assigned_users_list.map(Y=>`${Y.first_name} ${Y.last_name}`.toLowerCase()).join(" "),H=Me===""||[jt,At,Ge,Be,ce].some(Y=>Y&&Y.includes(Me)),te=et===""||Be===et,q=yt===""||String(Ct.managed_by?.id||"")===yt||Ct.assigned_users_list.some(Y=>String(Y.id)===yt);return H&&te&&q})},[xe,n,r,o]);f.useEffect(()=>{if(Ae.current){Ae.current=!1;return}if(t&&xe.length>0&&!_&&!d&&!k){const Me=xe.find(et=>et.id===parseInt(t));Me&&u(Me)}!t&&!_&&!d&&u(null)},[t,xe,_,d,k]),f.useEffect(()=>{J(1)},[n,r,o]),f.useEffect(()=>{J(Me=>{const et=Math.max(1,Math.ceil(he.length/se)||1);return Me>et?et:Me})},[he.length,se]);const Re=async()=>{try{const Me=await ne.get("/users/read/territory");N(Me.data)}catch(Me){console.error("Error fetching users:",Me)}},Ee=async()=>{j(!0);try{const Me=await ne.get("/territories/fetch"),et=Array.isArray(Me.data)?Me.data:[];x(et),console.log(Me.data)}catch(Me){console.error("Error fetching territories:",Me)}finally{j(!1)}},He=async()=>{try{const Me=await ne.get("/auth/me");me(Me.data)}catch(Me){console.error("Error fetching current user:",Me)}};f.useEffect(()=>{Re(),Ee(),He()},[]);const Ke=Me=>Ie.toLowerCase()==="ceo"||Ie.toLowerCase()==="admin"?!0:Ie.toLowerCase()==="group_manager"||Ie.toLowerCase()==="group manager"?be&&Me.territory_creator?.id===be.id:!1,st=()=>Ie.toLowerCase()==="group_manager"||Ie.toLowerCase()==="group manager",it=Me=>{const{name:et,value:yt}=Me.target;S(_t=>({..._t,[et]:yt}))},ot=Me=>{S(et=>({...et,user_ids:Me}))},rt=()=>{S(DA),T(!1),M(null),h(!0)},at=(Me=!0)=>{h(!1),T(!1),M(null),S(DA)},Je=Me=>{if(!Me)return;const et=Me.assigned_users_list?Me.assigned_users_list.map(yt=>String(yt.id)):[];S({name:Me.name||"",description:Me.description||"",manager_id:Me.managed_by?String(Me.managed_by.id):"",user_ids:et,company_id:Me.company_id?String(Me.company_id):""}),T(!0),M(Me.id),u(null),h(!0)},[Fe,Ue]=f.useState(!1),Ne=Me=>{if(Me.preventDefault(),k||G)return;Ue(!0);const et=w.name.trim();if(!et){V.error("Territory name is required.");return}if(!w.manager_id){V.error("Territory manager is required.");return}if(w.user_ids.length===0){V.error("Please assign at least one user.");return}let yt=w.company_id?Number(w.company_id):null;if(!yt&&w.user_ids.length>0){const At=w.user_ids[0],Ge=y.find(Be=>String(Be.id)===String(At));Ge&&Ge.company&&(yt=Ge.company.id)}const _t=[...new Set(w.user_ids.map(At=>Number(At)))],Ct={name:et,description:w.description?.trim()||"",manager_id:w.manager_id?Number(w.manager_id):null,user_ids:_t,company_id:yt},jt=_&&E?"update":"create";$({title:jt==="create"?"Confirm New Territory":"Confirm Update",message:a.jsxs("span",{children:[jt==="create"?"Create":"Update"," territory ",a.jsx("span",{className:"font-semibold",children:et})," with ",Ct.user_ids.length," assigned users?"]}),confirmLabel:jt==="create"?"Create":"Update",cancelLabel:"Cancel",variant:"primary",action:{type:jt,payload:Ct,targetId:E,name:et}})},ze=Me=>{if(!Me)return;const et=Ie.toLowerCase()==="group_manager"||Ie.toLowerCase()==="group manager",yt=et?"Archive":"Delete",_t=et?`Are you sure you want to archive <span class="font-semibold">${Me.name}</span>? 
          <br/><span class="text-xs text-orange-500">This will archive assignments for all ${Me.assigned_users_list.length} users in this group.</span>`:`Are you sure you want to delete <span class="font-semibold">${Me.name}</span>? 
          <br/><span class="text-xs text-red-500">This will remove assignments for all ${Me.assigned_users_list.length} users in this group.</span>`,Ct={type:"bulk-delete",territory_ids:Me.territory_ids,name:Me.name};$({title:`${yt} Territory Group`,message:a.jsx("span",{dangerouslySetInnerHTML:{__html:_t}}),confirmLabel:yt,cancelLabel:"Cancel",variant:et?"warning":"danger",action:Ct})},je=async()=>{if(Ce.length===0)return;const Me=Ie.toLowerCase()==="group_manager"||Ie.toLowerCase()==="group manager",et=Me?"Archive":"Delete",yt=Me?`Are you sure you want to archive <span class="font-semibold">${Ce.length}</span> selected territories? This action cannot be undone.`:`Are you sure you want to delete <span class="font-semibold">${Ce.length}</span> selected territories? This action cannot be undone.`;$({title:`${et} Territories`,message:a.jsx("span",{dangerouslySetInnerHTML:{__html:yt}}),confirmLabel:`${et} ${Ce.length} Territory(ies)`,cancelLabel:"Cancel",variant:Me?"warning":"danger",action:{type:"bulk-delete",territory_ids:Ce}})},ve=Me=>{if(Me.target.checked){const et=re.filter(yt=>Ke(yt)).flatMap(yt=>yt.territory_ids?yt.territory_ids:[yt.id]);ge(et)}else ge([])},z=Me=>{let et=[];typeof Me=="object"&&Me.territory_ids?et=Me.territory_ids:typeof Me=="object"&&Me.id?et=[Me.id]:et=[Me],ge(yt=>et.every(Ct=>yt.includes(Ct))?yt.filter(Ct=>!et.includes(Ct)):[...yt,...et.filter(Ct=>!yt.includes(Ct))])},K=async()=>{if(!G?.action){$(null);return}const{action:Me}=G,{type:et,payload:yt,targetId:_t,name:Ct}=Me;if(!(et==="create"&&pe.current)){et==="create"&&(pe.current=!0),Z(!0);try{if(et==="create")A(!0),await ne.post("/territories/assign",yt),V.success(`Territory "${Ct}" created.`),await Ee(),await Re(),at(!1);else if(et==="update")A(!0),await ne.put(`/territories/${_t}`,yt),V.success(`Territory "${Ct}" updated.`),Ae.current=!0,at(!1),u(null),t&&e("/admin/territory"),await Ee(),await Re();else if(et==="delete"){le(_t),await ne.delete(`/territories/${_t}`);const jt=st()?"archived":"deleted";V.success(`Territory "${Ct}" ${jt}.`),await Ee(),c?.id===_t&&u(null),h(!1)}else if(et==="bulk-delete"){await ne.delete("/territories/admin/bulk-delete",{data:{territory_ids:Me.territory_ids}});const jt=st()?"archived":"deleted",At=Ct?`Territory "${Ct}" ${jt} (${Me.territory_ids.length} user(s)).`:`Successfully ${jt} ${Me.territory_ids.length} territories`;V.success(At),ge([]),await Ee(),u(null),h(!1)}}catch(jt){console.error(jt),V.error("An error occurred.")}finally{A(!1),Ue(!1),le(null),Z(!1),$(null),et==="create"&&(pe.current=!1)}}},ue=()=>{W||$(null)},re=f.useMemo(()=>{if(P==="board")return he;const Me=(we-1)*se;return he.slice(Me,Me+se)},[he,we,se,P]),Le=he.length>0,De=()=>J(Me=>Math.max(Me-1,1)),Qe=()=>J(Me=>Math.min(Me+1,Math.ceil(he.length/se)||1)),tt=Me=>!Me||Me.length===0?"Unassigned":Me.length===1?`${Me[0].first_name} ${Me[0].last_name}`:`${Me[0].first_name} ${Me[0].last_name} +${Me.length-1} more`;return a.jsx(a.Fragment,{children:a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 min-h-screen font-inter relative",children:[b&&a.jsx(qt,{message:"Loading territories..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-3 sm:gap-0 mb-7",children:[a.jsxs("h2",{className:"flex items-center text-2xl font-semibold text-gray-800",children:[a.jsx(tc,{className:"mr-2 text-blue-600"})," Territory"]}),a.jsx("div",{className:"flex justify-center lg:justify-end md:justify-end w-full",children:["ceo","admin","group manager","group_manager"].includes(Ie.toLowerCase())&&(Array.isArray(y)&&y.length>0?a.jsxs("button",{onClick:rt,className:"flex items-center bg-black text-white px-3 py-2 rounded-md hover:bg-gray-800 text-sm",children:[a.jsx(aa,{})," Create Territory"]}):a.jsxs("div",{className:"text-xs bg-red-50 p-2 rounded-lg ring ring-red-300 text-red-700 flex items-center gap-1",children:[a.jsx(Oze,{})," Add users to assign territories"]}))})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-4 shadow-sm mt-6 mb-4 flex flex-col md:flex-row items-center gap-2",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full md:w-4/4",children:[a.jsx(Kt,{className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search territory",className:"focus:outline-none w-full",value:n,onChange:Me=>s(Me.target.value)})]}),Ie.toLowerCase()!=="sales"&&a.jsx("div",{className:"flex flex-col md:flex-row gap-2 w-full md:w-1/2",children:a.jsxs("select",{className:"border border-gray-300 rounded-lg px-3 h-11 w-full text-sm",value:o,onChange:Me=>l(Me.target.value),children:[a.jsx("option",{value:"",children:"Filter by Users"}),y.map(Me=>a.jsxs("option",{value:String(Me.id),children:[Me.first_name," ",Me.last_name]},Me.id))]})})]}),a.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[a.jsx("button",{onClick:()=>B("board"),className:`px-4 py-2 rounded-full text-sm ${P==="board"?"bg-gray-800 text-white":"bg-gray-100"}`,children:"Board View"}),a.jsx("button",{onClick:()=>B("list"),className:`px-4 py-2 rounded-full text-sm ${P==="list"?"bg-gray-800 text-white":"bg-gray-100"}`,children:"List View"})]}),P==="board"&&a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4",children:Le?re.map(Me=>a.jsxs("div",{onClick:()=>{u(Me);let et;Ie.toLowerCase()==="ceo"||Ie.toLowerCase()==="admin"?et="admin":Ie.toLowerCase()==="group manager"||Ie.toLowerCase()==="group_manager"?et="group-manager":Ie.toLowerCase()==="manager"?et="manager":et="sales",e(`/${et}/territory/${Me.id}`)},className:`relative flex flex-col cursor-pointer transition p-4 border shadow ${Me.status==="Inactive"?"bg-gray-50 border-gray-300":"bg-white border-gray-200 hover:shadow-md"}`,children:[a.jsx("div",{className:`absolute top-0 left-0 w-full h-5 rounded-t-md ${Me.status==="Inactive"?"bg-gray-400":"bg-secondary"}`}),Me.status==="Inactive"&&a.jsx("span",{className:"absolute top-2 right-2 bg-red-100 text-red-700 text-xs font-semibold px-2 py-1 rounded",children:"Inactive"}),a.jsx("h3",{className:"font-medium text-gray-900 mb-2 pt-7",children:Me.name}),Me.description&&a.jsx("p",{className:"text-xs text-gray-600 mb-2 line-clamp-2",children:Me.description}),a.jsxs("div",{className:"flex items-center gap-2 text-gray-500 text-sm mb-2",children:[a.jsx(ra,{})," ",tt(Me.assigned_users_list)]}),a.jsx("div",{className:"h-px bg-gray-200 w-full mb-2"}),a.jsx("div",{className:"text-gray-400 text-xs text-right",children:Me.created_at?new Date(Me.created_at).toLocaleDateString():""})]},Me.id)):a.jsx("div",{className:"col-span-4 text-center py-10 text-gray-500 border border-dashed rounded-xl",children:"No territories found."})}),P==="list"&&a.jsx("div",{className:"bg-white rounded-md shadow-sm overflow-hidden",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-gray-600 text-left",children:a.jsxs("tr",{children:[!["sales","manager"].includes(Ie.toLowerCase())&&a.jsx("th",{className:"py-3 px-4 w-10",children:a.jsx("input",{type:"checkbox",className:"w-4 h-4 accent-blue-600",checked:(()=>{const Me=re.filter(et=>Ke(et));return Me.length===0?!1:Me.every(et=>et.territory_ids&&et.territory_ids.every(yt=>Ce.includes(yt)))})(),onChange:ve})}),a.jsx("th",{className:"py-3 px-4",children:"Territory"}),a.jsx("th",{className:"py-3 px-4",children:"Assigned To"}),a.jsx("th",{className:"py-3 px-4",children:"Manager"}),!["sales","manager"].includes(Ie.toLowerCase())&&a.jsx("th",{className:"py-3 px-4 text-center w-24",children:Ce.length>0?a.jsx("button",{onClick:je,className:`${Ie.toLowerCase()==="group_manager"||Ie.toLowerCase()==="group manager"?"text-orange-600 hover:text-orange-800 hover:bg-orange-50":"text-red-600 hover:text-red-800 hover:bg-red-50"} transition p-1 rounded-full`,title:`${Ie.toLowerCase()==="group_manager"||Ie.toLowerCase()==="group manager"?"Archive":"Delete"} ${Ce.length} selected territories`,children:Ie.toLowerCase()==="group_manager"||Ie.toLowerCase()==="group manager"?a.jsx(Zt,{size:18}):a.jsx(_a,{size:18})}):""})]})}),a.jsx("tbody",{children:Le?re.map(Me=>a.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer",children:[!["sales","manager"].includes(Ie.toLowerCase())&&a.jsx("td",{className:"py-3 px-4",onClick:et=>et.stopPropagation(),children:Ke(Me)?a.jsx("input",{type:"checkbox",className:"w-4 h-4 accent-blue-600",checked:Me.territory_ids&&Me.territory_ids.some(et=>Ce.includes(et)),onChange:()=>z(Me)}):a.jsx("div",{className:"w-4 h-4"})}),a.jsx("td",{className:"py-3 px-4 font-medium",onClick:()=>{u(Me);let et;Ie.toLowerCase()==="ceo"||Ie.toLowerCase()==="admin"?et="admin":Ie.toLowerCase()==="group manager"||Ie.toLowerCase()==="group_manager"?et="group-manager":Ie.toLowerCase()==="manager"?et="manager":et="sales",e(`/${et}/territory/${Me.id}`)},children:a.jsxs("div",{className:"flex items-center gap-2",children:[Me.name,Me.status==="Inactive"&&a.jsx("span",{className:"bg-red-100 text-red-700 text-xs font-semibold px-2 py-1 rounded",children:"Inactive"})]})}),a.jsx("td",{className:"py-3 px-4",children:tt(Me.assigned_users_list)}),a.jsx("td",{className:"py-3 px-4",children:Me.managed_by?`${Me.managed_by.first_name}`:""}),a.jsx("td",{})]},Me.id)):a.jsx("tr",{children:a.jsx("td",{colSpan:5,className:"text-center py-4 text-gray-500",children:"No territories found."})})})]})}),c&&a.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-xl p-8 relative",children:[a.jsx("button",{className:"absolute top-2 right-4 text-gray-500 hover:text-black",onClick:()=>{u(null);let Me;Ie.toLowerCase()==="ceo"||Ie.toLowerCase()==="admin"?Me="admin":Ie.toLowerCase()==="group manager"||Ie.toLowerCase()==="group_manager"?Me="group-manager":Ie.toLowerCase()==="manager"?Me="manager":Me="sales",e(`/${Me}/territory`)},children:a.jsx(ea,{size:24})}),a.jsxs("h2",{className:"text-3xl font-semibold mb-1",children:[c.name,c.status==="Inactive"&&a.jsx("span",{className:"ml-3 inline-block bg-red-100 text-red-700 text-sm font-semibold px-3 py-1 rounded",children:"Inactive"})]}),a.jsx("div",{className:"h-px bg-gray-200 w-full mb-4"}),a.jsx("p",{className:"text-gray-500 mb-1",children:"Description"}),a.jsx("p",{className:"text-gray-700 text-sm mb-6",children:c.description||""}),a.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-6 text-sm",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-gray-500",children:"Manager"}),a.jsx("div",{className:"font-medium",children:c.managed_by?`${c.managed_by.first_name} ${c.managed_by.last_name}`:"Unassigned"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-gray-500",children:"Assigned To"}),a.jsx("div",{className:"flex flex-col gap-1 mt-1 max-h-32 overflow-y-auto",children:c.assigned_users_list&&c.assigned_users_list.length>0?c.assigned_users_list.map(Me=>a.jsxs("div",{className:"flex items-center gap-2 text-gray-800 font-medium",children:[a.jsx(ra,{})," ",Me.first_name," ",Me.last_name]},Me.id)):"Unassigned"})]})]}),(Ie.toLowerCase()==="ceo"||Ie.toLowerCase()==="admin"||(Ie.toLowerCase()==="group_manager"||Ie.toLowerCase()==="group manager")&&be&&c?.territory_creator?.id===be.id)&&a.jsxs("div",{className:"flex justify-end gap-2",children:[a.jsxs("button",{onClick:()=>Je(c),className:"bg-blue-500 text-white px-4 py-2 rounded flex items-center gap-2",children:[a.jsx(hn,{})," Edit"]}),a.jsx("button",{onClick:()=>ze(c),className:`${Ie.toLowerCase()==="group_manager"||Ie.toLowerCase()==="group manager"?"bg-orange-500 hover:bg-orange-600":"bg-red-500 hover:bg-red-600"} text-white px-4 py-2 rounded flex items-center gap-2`,children:Ie.toLowerCase()==="group_manager"||Ie.toLowerCase()==="group manager"?a.jsxs(a.Fragment,{children:[a.jsx(Zt,{})," Archive"]}):a.jsxs(a.Fragment,{children:[a.jsx(_a,{})," Delete"]})})]})]})}),d&&a.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-lg w-full max-w-xl p-6 relative",children:[a.jsxs("button",{className:"absolute top-4 right-4",onClick:()=>{at(),Ue(!1)},children:[a.jsx(ea,{size:22})," "]}),a.jsx("h2",{className:"text-xl font-semibold text-center mb-6",children:_?"Edit Territory":"Create Territory"}),a.jsxs("form",{className:"space-y-4",onSubmit:Ne,noValidate:!0,children:[a.jsx(Ize,{label:"Territory Name",name:"name",value:w.name,onChange:it,required:!0,isSubmitted:Fe}),a.jsx($ze,{label:"Territory Manager",name:"manager_id",value:w.manager_id,onChange:it,options:[{value:"",label:"Assign Manager"},...y.map(Me=>({value:String(Me.id),label:`${Me.first_name} ${Me.last_name}`}))],required:!0,isSubmitted:Fe}),a.jsx(Mze,{label:a.jsxs(a.Fragment,{children:["Assign Users ",a.jsx("span",{className:"text-red-600 font-semibold",children:"*"})]}),placeholder:"Search and select users...",options:y.map(Me=>({value:String(Me.id),label:`${Me.first_name} ${Me.last_name}`})),selectedValues:w.user_ids,onChange:ot,required:!0,isSubmitted:Fe}),a.jsx(Rze,{label:"Description",name:"description",value:w.description,onChange:it}),a.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[a.jsx("button",{type:"button",onClick:()=>{at(),Ue(!1)},className:"px-4 py-2 bg-red-400 text-white rounded",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:k,className:"px-4 py-2 bg-tertiary text-white rounded",children:k?"Saving...":"Save Territory"})]})]})]})}),P==="list"&&a.jsx(ca,{className:"mt-4",totalItems:he.length,pageSize:se,currentPage:we,onPrev:De,onNext:Qe,onPageSizeChange:Me=>{ye(Me),J(1)},label:"territories"}),G&&a.jsx(zze,{open:!0,title:G.title,message:G.message,confirmLabel:G.confirmLabel,cancelLabel:G.cancelLabel,variant:G.variant,onConfirm:K,onCancel:ue,loading:W})]})})}function Ize({label:e,name:t,value:n,onChange:s,placeholder:r,type:i="text",required:o=!1,disabled:l=!1,isSubmitted:c=!1,className:u=""}){const d=c&&o&&!n?.trim();return a.jsxs("div",{children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",o&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:i,name:t,value:n??"",onChange:s,placeholder:r,required:o,disabled:l,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border focus:ring-2 disabled:bg-gray-100 ${d?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}
${u}
`})]})}function $ze({label:e,name:t,value:n,onChange:s,options:r,disabled:i=!1,required:o=!1,isSubmitted:l=!1}){const c=l&&o&&!n;return a.jsxs("div",{children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",o&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("select",{name:t,value:n??"",onChange:s,disabled:i,className:`w-full border rounded-md px-3 py-2 text-sm bg-white focus:ring-2 outline-none disabled:bg-gray-100 ${c?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-gray-400"}`,children:r.map(u=>a.jsx("option",{value:u.value,children:u.label},u.value))})]})}function Rze({label:e,name:t,value:n,onChange:s,placeholder:r,rows:i=3,disabled:o=!1}){return a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsx("textarea",{name:t,value:n??"",onChange:s,placeholder:r,rows:i,disabled:o,className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-gray-400 outline-none disabled:bg-gray-100"})]})}function zze({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o=!1,onConfirm:l,onCancel:c}){const[u,d]=f.useState(!1);if(!e)return d(!1),null;let h;i==="danger"?h="bg-red-500 hover:bg-red-600 border border-red-400":i==="warning"?h="bg-orange-500 hover:bg-orange-600 border border-orange-400":h="bg-tertiary hover:bg-secondary border border-tertiary";const p=()=>{u||o||(d(!0),l())};return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o||u,children:r}),a.jsx("button",{type:"button",onClick:p,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${h}`,disabled:o||u,children:o?"Processing...":s})]})]})})}const Fze=[{value:"PLANNED",label:"PLANNED"},{value:"HELD",label:"HELD"},{value:"NOT_HELD",label:"NOT HELD"},{value:"INACTIVE",label:"INACTIVE"}],Uze=e=>e?String(e).toUpperCase():"",fu=e=>{const t=Uze(e);return t==="PLANNED"||t==="PENDING"?"PLANNED":t==="HELD"||t==="COMPLETED"?"HELD":t==="NOT HELD"||t==="NOT_HELD"||t==="CANCELLED"?"NOT_HELD":t==="INACTIVE"?"INACTIVE":"PLANNED"},PA=e=>{const t=fu(e);return t==="PLANNED"?"PLANNED":t==="HELD"?"HELD":t==="NOT_HELD"?"NOT HELD":t==="INACTIVE"?"INACTIVE":"--"},u8=e=>{switch(fu(e)){case"PLANNED":return"bg-indigo-100 text-indigo-700";case"HELD":return"bg-green-100 text-green-700";case"NOT_HELD":return"bg-gray-200 text-gray-700";case"INACTIVE":return"bg-gray-200 text-gray-700";default:return"bg-gray-100 text-gray-700"}},m8=e=>e?new Date(e).toLocaleString("en-US",{month:"2-digit",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}):"--";function f8(){const[e,t]=f.useState(!1),[n,s]=f.useState(null),[r,i]=f.useState(null),[o,l]=f.useState(null),[c,u]=f.useState(null),[d,h]=f.useState([]),[p,x]=f.useState(null),[b,j]=f.useState(!1),[y,N]=f.useState(null),[w,S]=f.useState(!1),[_,T]=f.useState(!1),[k,A]=f.useState("PLANNED"),[E,M]=f.useState(!1),[F,D]=f.useState(!1),[P,B]=f.useState(10),[G,$]=f.useState(1),[W,Z]=f.useState([]),[Q,le]=f.useState(null),{comments:we,addComment:J,refresh:se}=kn({relatedType:"call",relatedId:n?.id});f.useEffect(()=>{n?.id&&se()},[n?.id,se]),Bs();const ye=Et(),Ce=ta(),ge=Ge=>{if(!Ge)return"";const Be=String(Ge).split("-");return Be.length===3?`${Be[0]}-${Be[2]}`:String(Ge)},me={subject:"",call_time:(()=>{const Ge=new Date,Be=Ge.getFullYear(),ce=String(Ge.getMonth()+1).padStart(2,"0"),fe=String(Ge.getDate()).padStart(2,"0");return`${Be}-${ce}-${fe}T08:00`})(),duration_minutes:"",direction:"Outgoing",status:"Planned",notes:"",relatedType1:"Lead",relatedType2:null,relatedTo1:null,relatedTo2:null,assigned_to:null},[Ae,pe]=f.useState(me);f.useEffect(()=>{const Ge=Ce.state,Be=Ge?.callID;if(Be&&!Ge?.openCallModal){le(Be),ye(Ce.pathname,{replace:!0,state:{}});return}!Ge?.openCallModal||!Ge?.initialCallData||Ge.initialCallData.relatedType1==="Lead"&&Array.isArray(o)&&o.length===0||Ge.initialCallData.relatedType1==="Account"&&(!Array.isArray(o)||o.length===0)||(t(!0),pe(ce=>({...ce,...Ge.initialCallData,relatedTo1:Ge.initialCallData.relatedTo1?String(Ge.initialCallData.relatedTo1):"",relatedTo2:Ge.initialCallData.relatedTo2?String(Ge.initialCallData.relatedTo2):""})),ye(Ce.pathname,{replace:!0,state:{}}))},[Ce.state,o]),f.useEffect(()=>{if(Q&&d.length>0&&!F){const Ge=d.find(Be=>Be.id===Q);Ge?s(Ge):V.error("Call not found."),le(null)}},[Q,d,F]);const Ie=async()=>{try{D(!0);const Ge=await ne.get("/calls/admin/fetch-all"),ce=[...Array.isArray(Ge.data)?Ge.data:[]].sort((fe,H)=>{const te=fe?.created_at?new Date(fe.created_at):0;return(H?.created_at?new Date(H.created_at):0)-te});h(ce)}catch(Ge){console.error("Error fetching calls:",Ge),V.error("Failed to load calls")}finally{D(!1)}},xe=async()=>{try{const Ge=await ne.get("/users/all");x(Ge.data)}catch(Ge){console.error("Error fetching users: ",Ge)}};f.useEffect(()=>{xe(),Ie()},[]);const[he,Re]=f.useState(""),[Ee,He]=f.useState("Filter by Status"),[Ke,st]=f.useState("Filter by Users");f.useEffect(()=>{$(1)},[he,Ee,Ke,P]);const it=f.useMemo(()=>d.filter(Ge=>{const Be=!he||[Ge.subject,Ge.notes,Ge.lead?.title,Ge.account?.name,Ge.contact?.first_name,Ge.contact?.last_name,Ge.deal?.name].some(te=>te&&String(te).toLowerCase().includes(he.toLowerCase())),ce=Ee==="Filter by Status"||fu(Ge.status)===Ee,fe=Ge.call_assign_to?`${Ge.call_assign_to.first_name} ${Ge.call_assign_to.last_name}`:"";return Be&&ce&&(Ke==="Filter by Users"||fe===Ke)}),[d,he,Ee,Ke]),ot=f.useMemo(()=>{const Ge=(G-1)*P;return it.slice(Ge,Ge+P)},[it,G,P]),rt=Array.isArray(p)?p.map(Ge=>({id:Ge.id,name:`${Ge.first_name} ${Ge.last_name}`})):[],at=()=>$(Ge=>Math.max(1,Ge-1)),Je=()=>$(Ge=>Math.min(Ge+1,Math.ceil(it.length/P)||1)),Fe=Ge=>{if(Ge.target.checked){const Be=ot.map(ce=>ce.id);Z(Be)}else Z([])},Ue=Ge=>{Z(Be=>Be.includes(Ge)?Be.filter(ce=>ce!==Ge):[...Be,Ge])},Ne=d.length,ze=d.filter(Ge=>fu(Ge.status)==="PLANNED").length,je=d.filter(Ge=>fu(Ge.status)==="HELD").length,ve=d.filter(Ge=>fu(Ge.status)==="NOT_HELD").length,z=[{title:"Total",value:Ne,icon:Us,color:"text-slate-600",bgColor:"bg-slate-100"},{title:"Planned",value:ze,icon:Vn,color:"text-indigo-600",bgColor:"bg-indigo-100"},{title:"Held",value:je,icon:La,color:"text-green-600",bgColor:"bg-green-100"},{title:"Not Held",value:ve,icon:Yn,color:"text-gray-600",bgColor:"bg-gray-100"}],[K,ue]=f.useState("Overview"),re=Ge=>{const{name:Be,value:ce}=Ge.target;pe(fe=>{const H={...fe,[Be]:ce};return Be==="relatedType1"&&(H.relatedTo1="",ce==="Lead"?(H.relatedType2=null,H.relatedTo2=null,u([])):ce==="Account"&&(H.relatedType2="Contact")),Be==="relatedType2"&&(H.relatedTo2=""),H})};f.useEffect(()=>{const Ge=async()=>{try{l([]);let Be;Ae.relatedType1==="Lead"?Be=await ne.get("/leads/admin/getLeads"):Ae.relatedType1==="Account"&&(Be=await ne.get("/accounts/admin/fetch-all")),Be&&Array.isArray(Be.data)?l(Be.data):l([])}catch(Be){console.error("Error fetching data:",Be),l([])}};Ae.relatedType1&&Ge()},[Ae.relatedType1]),f.useEffect(()=>{const Ge=async()=>{try{u([]);let Be;if(Ae.relatedType1==="Account"&&Ae.relatedTo1)Ae.relatedType2==="Contact"?Be=await ne.get(`/contacts/from-acc/${Ae.relatedTo1}`):Ae.relatedType2==="Deal"?Be=await ne.get(`/deals/from-acc/${Ae.relatedTo1}`):Ae.relatedType2==="Quote"&&(Be=await ne.get(`/quotes/from-acc/${Ae.relatedTo1}`));else{u([]);return}Be&&Array.isArray(Be.data)?u(Be.data):u([])}catch(Be){console.error("Error fetching data:",Be),u([])}};Ae.relatedType2&&Ge()},[Ae.relatedType2,Ae.relatedTo1,Ae.relatedType1]);const[Le,De]=f.useState(!1),Qe=Ge=>{Ge.preventDefault(),De(!0);const Be=Ae.subject;if(!Be||Be.trim()===""){V.error("Subject is required.");return}if(!Ae.relatedTo1){V.error(`Please select a ${Ae.relatedType1||"Lead/Account"}.`);return}if(!Ae.assigned_to){V.error("Subject is required.");return}const fe={...Ae,duration_minutes:Ae.duration_minutes?parseInt(Ae.duration_minutes,10):null,relatedTo1:Ae.relatedTo1?parseInt(Ae.relatedTo1,10):null,relatedTo2:Ae.relatedType1==="Lead"?null:Ae.relatedTo2?parseInt(Ae.relatedTo2,10):null,relatedType2:Ae.relatedType1==="Lead"?null:Ae.relatedType2,assigned_to:Ae.assigned_to?parseInt(Ae.assigned_to,10):null},H=b&&y?"update":"create",te=(Ae.subject||"").trim()||"Untitled Call";i({title:H==="create"?"Confirm New Call":"Confirm Update",message:H==="create"?`Create "${te}"?`:`Save changes to "${te}"?`,confirmLabel:H==="create"?"Create Call":"Update Call",cancelLabel:"Cancel",variant:"primary",action:{type:H,payload:fe,targetId:y||null,name:te}})},tt=Ge=>s(Ge),Me=()=>{t(!1),j(!1),N(null)},et=async()=>{W.length!==0&&i({title:"Delete Calls",message:a.jsxs("span",{children:["Are you sure you want to delete"," ",a.jsx("span",{className:"font-semibold",children:W.length})," selected calls? This action cannot be undone."]}),confirmLabel:`Delete ${W.length} Call(s)`,cancelLabel:"Cancel",variant:"danger",action:{type:"bulk-delete",call_ids:W}})},yt=async()=>{if(!r?.action){i(null);return}const{action:Ge}=r,{type:Be,payload:ce,targetId:fe,name:H}=Ge;T(!0);try{if(Be==="create")S(!0),await ne.post("/calls/create",ce),V.success(`Call "${H}" created successfully.`),t(!1),pe(me),j(!1),N(null),await Ie();else if(Be==="update"){if(!fe)throw new Error("Missing call identifier for update.");S(!0),await ne.put(`/calls/${fe}`,ce),V.success(`Call "${H}" updated successfully.`),t(!1),pe(me),j(!1),N(null),await Ie()}else if(Be==="delete"){if(!fe)throw new Error("Missing call identifier for deletion.");await ne.delete(`/calls/${fe}`),V.success(`Call "${H}" deleted successfully.`),n?.id===fe&&s(null),await Ie()}else Be==="bulk-delete"&&(await ne.delete("/calls/admin/bulk-delete",{data:{call_ids:W}}),V.success(`Successfully deleted ${W.length} calls`),Z([]),await Ie())}catch(te){const q=Be==="create"?"Failed to create call. Please review the details and try again.":Be==="update"?"Failed to update call. Please review the details and try again.":"Failed to delete call. Please try again.",Y=te?.response?.data?.detail||q;V.error(Y)}finally{(Be==="create"||Be==="update")&&S(!1),T(!1),i(null)}},_t=()=>{_||i(null)},Ct=async()=>{if(n?.id)try{M(!0),await ne.put(`/calls/${n.id}`,{status:k}),V.success(`Status updated to ${PA(k)}`),h(Ge=>Array.isArray(Ge)?Ge.map(Be=>Be.id===n.id?{...Be,status:k}:Be):Ge),s(null)}catch(Ge){const Be=Ge.response?.data?.detail||"Failed to update status.";V.error(Be)}finally{M(!1)}};f.useEffect(()=>{n&&A(fu(n.status))},[n]);const jt=n?a.jsxs("div",{id:"callModalBackdrop",onClick:Ge=>Ge.target.id==="callModalBackdrop"&&s(null),className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center p-4",children:[F&&a.jsx(qt,{message:"Loading call details..."}),a.jsxs("div",{className:"bg-white rounded-xl shadow-lg w-full max-w-full lg:max-w-4xl max-h-[95vh] overflow-y-auto hide-scrollbar relative box-border",children:[a.jsxs("div",{className:"bg-tertiary w-full rounded-t-xl p-3 lg:p-3 relative",children:[a.jsx("h1",{className:"lg:text-3xl text-xl text-white font-semibold text-center w-full",children:"Calls"}),a.jsx("button",{onClick:()=>s(null),className:"text-gray-500 hover:text-white transition cursor-pointer absolute top-3 right-3",children:a.jsx(Za,{size:25})})]}),a.jsx("div",{className:"mt-4 gap-2 px-2 lg:gap-4 lg:mx-7",children:a.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between lg:flex-row lg:items-center lg:justify-between mt-3 gap-2 px-2 md:items-center lg:gap-4 md:mx-7 lg:mx-7",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[a.jsx("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-800",children:n.subject}),a.jsx("span",{className:`text-xs sm:text-sm font-medium px-2 sm:px-3 py-1 rounded-full ${u8(n.status)}`,children:PA(n.status)})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsxs("button",{className:"inline-flex items-center justify-center w-full sm:w-auto bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 transition text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",onClick:()=>{const Ge=te=>{if(!te)return"";const q=new Date(te),Y=q.getFullYear(),U=String(q.getMonth()+1).padStart(2,"0"),de=String(q.getDate()).padStart(2,"0"),Te=String(q.getHours()).padStart(2,"0"),ie=String(q.getMinutes()).padStart(2,"0");return`${Y}-${U}-${de}T${Te}:${ie}`},Be=n.lead?"Lead":n.account?"Account":"Lead",ce=n.lead?n.lead.id:n.account?n.account.id:null,fe=Be==="Lead"?null:n.contact?"Contact":n.deal?"Deal":n.quote?"Quote":"Contact",H=Be==="Lead"?null:n.contact?n.contact.id:n.deal?n.deal.id:n.quote?n.quote.id:null;pe({subject:n.subject||"",call_time:Ge(n.call_time),duration_minutes:n.duration_minutes?String(n.duration_minutes):"",direction:n.direction||"Outgoing",status:n.status||"Planned",notes:n.notes||"",relatedType1:Be,relatedType2:fe,relatedTo1:ce?String(ce):"",relatedTo2:H?String(H):"",assigned_to:n.call_assign_to?.id?String(n.call_assign_to.id):""}),j(!0),N(n.id),s(null),t(!0)},children:[a.jsx(gn,{className:"mr-2"}),"Edit"]}),a.jsxs("button",{className:"inline-flex items-center justify-center w-full sm:w-auto px-4 py-2 rounded-md text-sm bg-red-500 text-white hover:bg-red-600 transition focus:outline-none focus:ring-2 focus:ring-red-400",onClick:()=>{const Ge=n.subject||"this call";i({title:"Delete Call",message:`Are you sure you want to permanently delete "${Ge}"? This action cannot be undone.`,confirmLabel:"Delete Call",cancelLabel:"Cancel",variant:"danger",action:{type:"delete",targetId:n.id,name:Ge}})},children:[a.jsx(_a,{className:"mr-2"}),"Delete"]})]})]})}),a.jsx("div",{className:"border-b border-gray-200 my-5"}),a.jsxs("div",{className:"p-6 lg:p-4",children:[a.jsx("div",{className:"flex w-full bg-[#6A727D] text-white mt-1 overflow-x-auto mb-6",children:["Overview","Notes"].map(Ge=>a.jsx("button",{onClick:()=>ue(Ge),className:`flex-1 min-w-[90px] px-4 py-2.5 text-xs sm:text-sm font-medium border-b-2 ${K===Ge?"bg-paper-white text-[#6A727D] border-white":"text-white hover:bg-[#5c636d]"}`,children:Ge},Ge))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 items-start",children:[a.jsxs("div",{className:"lg:col-span-3",children:[K==="Overview"&&a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 md:p-8 border border-gray-200",children:a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4 sm:gap-6 text-sm text-gray-700",children:[a.jsx(go,{label:"Call Time",value:m8(n.call_time)}),a.jsx(go,{label:"Duration",value:n.duration_minutes?`${n.duration_minutes} min`:null}),a.jsx(go,{label:"Direction",value:n.direction||"--"}),a.jsx(go,{label:"Assigned To",value:`${n.call_assign_to.first_name} ${n.call_assign_to.last_name}`}),n.lead&&a.jsx(go,{label:"Lead",value:n.lead.title}),n.account&&a.jsx(go,{label:"Account",value:n.account.name}),n.contact&&a.jsx(go,{label:"Contact",value:`${n.contact.first_name} ${n.contact.last_name}`}),n.deal&&a.jsx(go,{label:"Deal",value:n.deal.name}),n.quote&&a.jsx(go,{label:"Quote",value:ge(n.quote.quote_id)}),a.jsx(go,{label:"Created At",value:m8(n.created_at)})]})}),K==="Notes"&&a.jsxs("div",{className:"mt-4 w-full",children:[a.jsx("div",{className:"flex flex-wrap items-center justify-between mb-4 gap-2",children:a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words",children:"Call Note"})}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 shadow-sm break-words",children:[a.jsx("div",{className:"flex items-start justify-between",children:a.jsx("div",{children:a.jsx("p",{className:"text-sm font-medium text-gray-800 break-words",children:"Note"})})}),a.jsx("div",{className:"mt-3 text-sm text-gray-700 whitespace-pre-wrap break-words",children:n.notes||"No notes available."})]}),a.jsx(Tn,{comments:we,onAddComment:J})]})]}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm w-full",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Status"}),a.jsxs("select",{className:"border border-gray-200 rounded-md px-2 py-1.5 w-full text-sm mb-2",value:k,onChange:Ge=>A(Ge.target.value),children:[a.jsx("option",{value:"PLANNED",children:"PLANNED"}),a.jsx("option",{value:"HELD",children:"HELD"}),a.jsx("option",{value:"NOT_HELD",children:"NOT HELD"})]}),a.jsx("button",{onClick:Ct,disabled:E,className:"w-full py-1.5 rounded-md text-sm bg-gray-900 text-white hover:bg-gray-800 disabled:opacity-50",children:E?"Updating...":"Update"})]})]})]})]})]}):null,At=e?a.jsx("div",{id:"modalBackdrop",onClick:Ge=>Ge.target.id==="modalBackdrop"&&Me(),className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-xl rounded-2xl shadow-lg p-4 sm:p-6 md:p-8 relative border border-gray-200 overflow-y-auto max-h-[90vh] hide-scrollbar",children:[a.jsx("button",{onClick:()=>{Me(),De(!1)},className:"absolute top-4 right-4 text-gray-500 hover:text-black transition",children:a.jsx(ea,{size:22})}),a.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800 mb-4 sm:mb-6 flex items-center justify-center",children:b?"Edit Call":"Add New Call"}),a.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 w-full gap-4 text-sm",onSubmit:Qe,noValidate:!0,children:[a.jsx(Hze,{label:"Subject",className:"md:col-span-2",name:"subject",value:Ae.subject,onChange:re,isSubmitted:Le,required:!0}),a.jsxs("div",{className:"w-full flex flex-col",children:[a.jsxs("div",{className:"relative w-25",children:[a.jsxs("select",{name:"relatedType1",onChange:re,value:Ae.relatedType1,className:"outline-none cursor-pointer mb-1 w-22 text-gray-700 disabled:text-gray-400 disabled:cursor-not-allowed",disabled:w||b,children:[a.jsx("option",{value:"Lead",children:"Lead"}),a.jsx("option",{value:"Account",children:"Account"})]}),a.jsx("span",{className:"absolute left-10 md:pl-6 pl-6 top-1/2 -translate-y-1/2 text-red-500 pointer-events-none",children:"*"})]}),a.jsx(OA,{items:Array.isArray(o)?o:[],value:Ae.relatedTo1??"",placeholder:`Search ${Ae.relatedType1||"here"}...`,getLabel:Ge=>Ae.relatedType1==="Lead"?Ge.title:Ge.name??"",onChange:Ge=>pe(Be=>({...Be,relatedTo1:Ge})),required:!0,isSubmitted:Le,disabled:w||b})]}),a.jsxs("div",{className:"w-full flex flex-col",children:[a.jsxs("select",{name:"relatedType2",onChange:re,value:Ae.relatedType2??"Contact",className:"text-gray-700 outline-none cursor-pointer mb-1 w-22 disabled:text-gray-400 disabled:cursor-not-allowed",disabled:Ae.relatedType1==="Lead"||w||b,children:[a.jsx("option",{value:"Contact",children:"Contact"}),a.jsx("option",{value:"Deal",children:"Deal"}),a.jsx("option",{value:"Quote",children:"Quote"})]}),a.jsx(OA,{disabled:Ae.relatedType1==="Lead"||w||b,items:Array.isArray(c)?c:[],value:Ae.relatedTo2??"",placeholder:Ae.relatedType1==="Lead"?"":Array.isArray(c)&&c.length>0?`Search ${Ae.relatedType2||"Contact"}...`:`No ${Ae.relatedType2||""} data found`,getLabel:Ge=>Ae.relatedType2==="Contact"?`${Ge.first_name??""} ${Ge.last_name??""}`.trim():Ae.relatedType2==="Quote"?ge(Ge.quote_id)??"":Ge.name??"",onChange:Ge=>pe(Be=>({...Be,relatedTo2:Ge}))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Call Time"}),a.jsx("input",{type:"datetime-local",value:Ae.call_time,onChange:re,name:"call_time",className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100"})]}),a.jsxs("div",{className:"w-full",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Duration"}),a.jsxs("div",{className:"w-full rounded-md text-sm flex flex-row items-center justify-start",children:[a.jsx("input",{type:"tel",value:Ae.duration_minutes,onChange:re,name:"duration_minutes",className:"border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100 w-44 mr-3"}),a.jsx("p",{children:"minutes"})]})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[" ","Assign To ",a.jsx("span",{className:"text-red-600 font-semibold",children:"*"})]}),a.jsx(OA,{items:Array.isArray(p)?p:[],value:Ae.assigned_to??"",placeholder:"Search an account...",getLabel:Ge=>`${Ge.first_name} ${Ge.last_name}`,onChange:Ge=>pe(Be=>({...Be,assigned_to:Ge})),required:!0,isSubmitted:Le})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Direction"}),a.jsxs("select",{name:"direction",onChange:re,value:Ae.direction,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100",children:[a.jsx("option",{value:"Incoming",children:"Incoming"}),a.jsx("option",{value:"Outgoing",children:"Outgoing"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Status"}),a.jsxs("select",{name:"status",onChange:re,value:Ae.status,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100",children:[a.jsx("option",{value:"Planned",children:"Planned"}),a.jsx("option",{value:"Held",children:"Held"}),a.jsx("option",{value:"Not held",children:"Not held"})]})]}),a.jsx(qze,{className:"col-span-2",label:"Notes",value:Ae.notes,onChange:re,name:"notes"}),a.jsxs("div",{className:"flex flex-col md:flex-row justify-end col-span-2 mt-4 gap-2 w-full",children:[a.jsx("button",{type:"button",onClick:()=>{Me(),De(!1)},className:"w-full sm:w-auto px-4 py-2 text-white bg-red-400 border border-red-300 rounded hover:bg-red-500 transition",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:w,className:"w-full sm:w-auto px-4 py-2 text-white bg-tertiary border border-tertiary rounded hover:bg-secondary transition",children:w?"Saving...":b?"Update Call":"Save Call"})]})]})]})}):null;return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h1",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(Us,{className:"mr-2 text-blue-600"})," Calls"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto gap-2",children:a.jsxs("button",{onClick:()=>{pe(me),j(!1),N(null),t(!0),De(!1)},className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 my-1 lg:my-0 rounded-md hover:bg-gray-800 text-sm sm:text-base mx-auto sm:ml-auto cursor-pointer",children:[a.jsx(aa,{className:"mr-2"})," Add Call"]})})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-4 mb-6 w-full break-words overflow-hidden lg:overflow-visible",children:z.map(Ge=>a.jsx(Bze,{...Ge},Ge.title))}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center gap-3",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search calls",className:"focus:outline-none text-base w-full",value:he,onChange:Ge=>Re(Ge.target.value)})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row w-full lg:w-1/2 gap-2",children:[a.jsxs("select",{value:Ee,onChange:Ge=>He(Ge.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm bg-white w-full",children:[a.jsx("option",{value:"Filter by Status",children:"Filter by Status"}),Fze.map(Ge=>a.jsx("option",{value:Ge.value,children:Ge.label},Ge.value))]}),a.jsxs("select",{value:Ke,onChange:Ge=>st(Ge.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm bg-white w-full",children:[a.jsx("option",{value:"Filter by Users",children:"Filter by Users"}),rt.map(Ge=>a.jsx("option",{value:Ge.name,children:Ge.name},Ge.id))]})]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[500px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm mb-4",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 w-12",children:a.jsx("input",{type:"checkbox",checked:ot.length>0&&W.length===ot.length,onChange:Fe,className:"cursor-pointer"})}),a.jsx("th",{className:"py-3 px-4",children:"Subject"}),a.jsx("th",{className:"py-3 px-4",children:"Related To"}),a.jsx("th",{className:"py-3 px-4",children:"Call Time"}),a.jsx("th",{className:"py-3 px-4",children:"Assigned To"}),a.jsx("th",{className:"py-3 px-4",children:"Status"}),a.jsx("th",{className:"py-3 px-4 text-center w-24",children:W.length>0?a.jsx("button",{onClick:et,className:"text-red-600 hover:text-red-800 transition p-1 rounded-full hover:bg-red-50",title:`Delete ${W.length} selected calls`,children:a.jsx(_a,{size:18})}):""})]})}),a.jsx("tbody",{children:F?a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"py-10",children:a.jsx(qt,{message:"Loading calls..."})})}):ot.length>0?ot.map(Ge=>a.jsxs("tr",{onClick:()=>tt(Ge),className:"hover:bg-gray-50 cursor-pointer border-b border-gray-100",children:[a.jsx("td",{className:"py-3 px-4 align-top w-12",onClick:Be=>Be.stopPropagation(),children:a.jsx("input",{type:"checkbox",checked:W.includes(Ge.id),onChange:()=>Ue(Ge.id),className:"cursor-pointer"})}),a.jsx("td",{className:"py-3 px-4 text-blue-600 font-medium",children:Ge.subject||"--"}),a.jsxs("td",{className:"py-3 px-4",children:[Ge.lead&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:Ge.lead.title}),Ge.account&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:Ge.account.name}),Ge.contact&&a.jsxs("p",{className:"font-medium text-blue-500 text-xs",children:[Ge.contact.first_name," ",Ge.contact.last_name]}),Ge.deal&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:Ge.deal.name}),Ge.quote&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:ge(Ge.quote.quote_id)})]}),a.jsx("td",{className:"py-3 px-4 text-gray-800",children:Ge.call_time?new Date(Ge.call_time).toLocaleString():"--"}),a.jsx("td",{className:"py-3 px-4 text-gray-800",children:Ge?.call_assign_to?`${Ge.call_assign_to.first_name} ${Ge.call_assign_to.last_name}`:"--"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${u8(Ge.status)}`,children:PA(Ge.status)})}),a.jsx("td",{className:"py-3 px-4"})]},Ge.id)):a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"text-center py-4 text-gray-500",children:"No calls found."})})})]})}),a.jsx(ca,{totalItems:it.length,pageSize:P,currentPage:G,onPrev:at,onNext:Je,onPageSizeChange:Ge=>{B(Ge),$(1)},pageSizeOptions:[10,20,30,40,50],label:"calls"})]}),jt,At,r&&a.jsx(Gze,{open:!0,title:r.title,message:r.message,confirmLabel:r.confirmLabel,cancelLabel:r.cancelLabel,variant:r.variant,onConfirm:yt,onCancel:_t,loading:_})]})}function Bze({icon:e,title:t,value:n,color:s,bgColor:r}){return a.jsxs("div",{className:"flex items-center p-4 bg-white rounded-xl shadow-md border border-gray-200 transition-all duration-300",children:[a.jsx("div",{className:`p-3 rounded-full ${r} ${s} mr-4`,children:a.jsx(e,{size:22})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:t}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:n})]})]})}function Hze({label:e,name:t,value:n,onChange:s,placeholder:r="",type:i="text",required:o=!1,disabled:l=!1,isSubmitted:c=!1,className:u=""}){const d=c&&o&&!n;return a.jsxs("div",{className:u,children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",o&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:i,name:t,value:n??"",onChange:s,placeholder:r,disabled:l,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border focus:ring-2 disabled:bg-gray-100
          ${d?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}
        `})]})}function qze(e){return a.jsxs("div",{className:e.className,children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e.label}),a.jsx("textarea",{...e,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100 resize-none"})]})}function go({label:e,value:t}){return a.jsxs("p",{children:[a.jsxs("span",{className:"font-semibold",children:[e,":"]})," ",a.jsx("br",{}),a.jsx("span",{className:"break-words",children:t||"--"})]})}function Gze({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o=!1,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsx("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${u}`,disabled:o,children:o?"Processing...":s})]})]})})}function OA({items:e=[],value:t="",onChange:n,getLabel:s,placeholder:r="Search...",disabled:i=!1,maxRender:o=200,required:l=!1,isSubmitted:c=!1}){const[u,d]=f.useState(!1),[h,p]=f.useState(""),x=f.useRef(null),b=e.find(w=>String(w.id)===String(t)),j=b?s(b):"",y=l&&c&&!t,N=f.useMemo(()=>{const w=h.trim().toLowerCase();return(w?e.filter(_=>(s(_)||"").toLowerCase().includes(w)):e).slice(0,o)},[e,h,s,o]);return f.useEffect(()=>{const w=S=>{x.current&&!x.current.contains(S.target)&&d(!1)};return document.addEventListener("mousedown",w),()=>document.removeEventListener("mousedown",w)},[]),f.useEffect(()=>{u||p("")},[u]),a.jsxs("div",{ref:x,className:"relative w-full",children:[a.jsx("input",{disabled:i,value:u?h:j,placeholder:r,onFocus:()=>!i&&d(!0),onChange:w=>{p(w.target.value),u||d(!0)},className:`w-full border rounded-md px-2 py-1.5 text-sm outline-none focus:ring-2 disabled:bg-gray-100
          ${y?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}`}),u&&!i&&a.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg overflow-hidden",children:[a.jsx("div",{className:"max-h-56 overflow-y-auto",children:N.length>0?N.map(w=>{const S=String(w.id),_=s(w),T=String(t)===S;return a.jsx("button",{type:"button",onClick:()=>{n(S),d(!1)},className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-50 ${T?"bg-blue-50":""}`,children:_||"--"},S)}):a.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No results"})}),e.length>o&&a.jsxs("div",{className:"px-3 py-2 text-[11px] text-gray-400 border-t",children:["Showing first ",o," results  keep typing to narrow."]})]})]})}const O1=({onClose:e,formData:t,setFormData:n,isEditing:s=!1,onSubmit:r,isSubmitting:i=!1,users:o=[]})=>{const c=(()=>{const A=new Date,E=A.getFullYear(),M=String(A.getMonth()+1).padStart(2,"0"),F=String(A.getDate()).padStart(2,"0");return{startTime:`${E}-${M}-${F}T08:00`,endTime:`${E}-${M}-${F}T09:00`}})(),[u,d]=f.useState({subject:"",startTime:c.startTime,endTime:c.endTime,location:"",status:"Planned",notes:"",assignedTo:"",relatedType1:"Lead",relatedTo1:"",relatedType2:"Contact",relatedTo2:""}),[h,p]=f.useState([]),[x,b]=f.useState([]);f.useEffect(()=>{t!==void 0&&n&&(!t.startTime||!t.endTime)&&n(A=>({...A,startTime:A.startTime||c.startTime,endTime:A.endTime||c.endTime}))},[]);const j=A=>{if(!A)return"";const E=String(A).split("-");return E.length===3?`${E[0]}-${E[2]}`:String(A)},y=t!==void 0?t:u,N=n||d,{userRole:w}=Ks();f.useEffect(()=>{const A=async()=>{try{p([]);let E;y.relatedType1==="Lead"?E=await ne.get("/leads/admin/getLeads"):y.relatedType1==="Account"&&(E=await ne.get("/accounts/admin/fetch-all"));let M=[];if(E&&Array.isArray(E.data)&&(M=E.data),s&&y.relatedTo1)try{let F;y.relatedType1==="Lead"?F=await ne.get(`/leads/get/${y.relatedTo1}`):y.relatedType1==="Account"&&(F=await ne.get(`/accounts/get/${y.relatedTo1}`)),F&&F.data&&(M.some(P=>String(P.id)===String(y.relatedTo1))||(M=[F.data,...M]))}catch(F){console.error("Error fetching specific related item:",F)}p(M)}catch(E){console.error("Error fetching relatedTo1 data:",E),p([])}};y.relatedType1&&A()},[y.relatedType1,w,s,y.relatedTo1]),f.useEffect(()=>{const A=async()=>{try{if(b([]),y.relatedType1==="Account"&&y.relatedTo1){let E;y.relatedType2==="Contact"?E=await ne.get(`/contacts/from-acc/${y.relatedTo1}`):y.relatedType2==="Deal"?E=await ne.get(`/deals/from-acc/${y.relatedTo1}`):y.relatedType2==="Quote"&&(E=await ne.get(`/quotes/from-acc/${y.relatedTo1}`)),E&&Array.isArray(E.data)?b(E.data):b([])}else b([])}catch(E){console.error("Error fetching relatedTo2 data:",E),b([])}};y.relatedType2&&A()},[y.relatedType2,y.relatedTo1,y.relatedType1]);const S=A=>{const{name:E,value:M}=A.target;N(F=>{const D={...F,[E]:M};return E==="relatedType1"&&(F.relatedType1!==M&&(D.relatedTo1=""),M==="Lead"?(D.relatedType2=null,D.relatedTo2=null,b([])):M==="Account"&&(D.relatedType2="Contact",D.relatedTo2="")),E==="relatedType2"&&F.relatedType2!==M&&(D.relatedTo2=""),D})},[_,T]=f.useState(!1),k=A=>{if(A.preventDefault(),T(!0),y.status==="--"){V.warn("Please select a valid status.");return}const E=y.subject;if(!E||E.trim()===""){V.error("Subject is required.");return}if(!y.assignedTo){V.error("Assigned To is required.");return}if(!y.relatedTo1){V.error(`Please select a ${y.relatedType1||"Lead/Account"}.`);return}r?r(y):e()};return a.jsx("div",{id:"modalBackdrop",onClick:A=>A.target.id==="modalBackdrop"&&e(),className:"fixed inset-0 bg-black/40 flex items-center justify-center z-60 p-2 sm:p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-full sm:max-w-3xl rounded-2xl shadow-lg p-3 sm:p-6 md:p-8 relative border border-gray-200 overflow-y-auto max-h-[90vh] hide-scrollbar",children:[a.jsx("button",{onClick:e,className:"absolute top-3 right-3 sm:top-4 sm:right-4 text-gray-500 hover:text-black transition",children:a.jsx(ea,{size:22})}),a.jsx("h2",{className:"text-lg sm:text-2xl font-semibold text-gray-800 mb-4 sm:mb-6 text-center",children:s?"Edit Meeting":"Schedule Meeting"}),a.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 sm:gap-4 text-sm",onSubmit:k,noValidate:!0,children:[a.jsx(_b,{label:"Subject",name:"subject",value:y.subject,onChange:S,placeholder:"e.g. Meeting with Client",required:!0,isSubmitted:_,className:"md:col-span-2"}),a.jsxs("div",{className:"flex flex-col w-full",children:[a.jsxs("div",{className:"relative w-25",children:[a.jsxs("select",{name:"relatedType1",onChange:S,value:y.relatedType1||"Lead",className:"w-full outline-none cursor-pointer mb-1 rounded text-gray-700 disabled:text-gray-400",disabled:i,children:[a.jsx("option",{value:"Lead",children:"Lead"}),a.jsx("option",{value:"Account",children:"Account"})]}),a.jsx("span",{className:"absolute left-10 md:pl-8 pl-8 top-1/2 -translate-y-1/2 text-red-500 pointer-events-none",children:"*"})]}),a.jsx(MA,{items:Array.isArray(h)?h:[],disabled:i,value:y.relatedTo1??"",placeholder:`Search ${y.relatedType1||"here"}...`,getLabel:A=>y.relatedType1==="Lead"?A.title:A.name??"",onChange:A=>N(E=>({...E,relatedTo1:A})),required:!0,isSubmitted:_})]}),a.jsxs("div",{className:"flex flex-col w-full",children:[a.jsx("div",{className:"relative w-25",children:a.jsxs("select",{name:"relatedType2",onChange:S,value:y.relatedType2||"Contact",className:"w-full outline-none cursor-pointer mb-1 rounded text-gray-700 disabled:text-gray-400 disabled:cursor-not-allowed",disabled:i||y.relatedType1==="Lead",children:[a.jsx("option",{value:"Contact",children:"Contact"}),a.jsx("option",{value:"Deal",children:"Deal"}),a.jsx("option",{value:"Quote",children:"Quote"})]})}),a.jsx(MA,{items:Array.isArray(x)?x:[],value:y.relatedTo2??"",placeholder:y.relatedType1==="Lead"?"":x?.length?`Search ${y.relatedType2}...`:`No ${y.relatedType2} data found`,getLabel:A=>y.relatedType2==="Contact"?`${A.first_name??""} ${A.last_name??""}`.trim():y.relatedType2==="Quote"?j(A.quote_id)??"":A.name??"",onChange:A=>N(E=>({...E,relatedTo2:A})),disabled:y.relatedType1==="Lead"})]}),a.jsx(_b,{label:"Location",name:"location",className:"md:col-span-2",value:y.location,onChange:S,disabled:i}),a.jsxs("div",{className:"md:col-span-2 grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[a.jsx(_b,{label:"Start Time",name:"startTime",type:"datetime-local",value:y.startTime,onChange:S,disabled:i}),a.jsx(_b,{label:"End Time",name:"endTime",type:"datetime-local",value:y.endTime,onChange:S,disabled:i})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:["Assign To ",a.jsx("span",{className:"text-red-600 font-semibold",children:"*"})]}),a.jsx(MA,{items:Array.isArray(o)?o:[],value:y.assignedTo??"",placeholder:"Search an account...",getLabel:A=>`${A.first_name} ${A.last_name}`,onChange:A=>N(E=>({...E,assignedTo:A})),disabled:w==="Sales",required:!0,isSubmitted:_})]}),a.jsx(Wze,{label:"Status",name:"status",value:y.status,onChange:S,options:["--","Planned","Held","Not held"].map(A=>({value:A,label:A.replace("_"," ")})),disabled:i}),a.jsx(Vze,{label:"Notes",name:"notes",value:y.notes,onChange:S,rows:3,className:"md:col-span-2",disabled:i}),a.jsxs("div",{className:"md:col-span-2 flex flex-col sm:flex-row justify-end gap-2 mt-4",children:[a.jsx("button",{type:"button",onClick:e,className:"w-full sm:w-auto px-4 py-2 text-white bg-red-400 border border-red-300 rounded hover:bg-red-500 transition disabled:opacity-70",disabled:i,children:"Cancel"}),a.jsx("button",{type:"submit",className:"w-full sm:w-auto px-4 py-2 text-white border border-tertiary bg-tertiary rounded hover:bg-secondary transition disabled:opacity-70",disabled:i,children:i?"Saving...":s?"Update Meeting":"Save Meeting"})]})]})]})})};function _b({label:e,name:t,value:n,onChange:s,placeholder:r,type:i="text",required:o=!1,disabled:l=!1,className:c="",isSubmitted:u=!1}){const d=u&&!n?.trim();return a.jsxs("div",{className:c,children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",o&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:i,name:t,value:n??"",onChange:s,placeholder:r,required:o,disabled:l,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border focus:ring-2 outline-none disabled:bg-gray-100
          ${d?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}
          ${c}
        `})]})}function Wze({label:e,name:t,value:n,onChange:s,options:r,required:i=!1,disabled:o=!1,className:l="",isSubmitted:c=!1}){const u=c&&i&&!n;return a.jsxs("div",{className:l,children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",i&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("select",{name:t,value:n??"",onChange:s,required:i,disabled:o,hasError:u,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100",children:r.map(d=>a.jsx("option",{value:d.value,children:d.label},d.value))})]})}function Vze({label:e,name:t,value:n,onChange:s,placeholder:r,required:i=!1,disabled:o=!1,className:l="",rows:c=3}){return a.jsxs("div",{className:l,children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsx("textarea",{name:t,value:n??"",onChange:s,placeholder:r,required:i,disabled:o,rows:c,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100 resize-none"})]})}function MA({items:e=[],value:t="",onChange:n,getLabel:s,placeholder:r="Search...",disabled:i=!1,maxRender:o=200,required:l=!1,isSubmitted:c=!1}){const[u,d]=f.useState(!1),[h,p]=f.useState(""),x=f.useRef(null),b=e.find(w=>String(w.id)===String(t)),j=b?s(b):"",y=l&&c&&!t,N=f.useMemo(()=>{const w=h.trim().toLowerCase();return(w?e.filter(_=>(s(_)||"").toLowerCase().includes(w)):e).slice(0,o)},[e,h,s,o]);return f.useEffect(()=>{const w=S=>{x.current&&!x.current.contains(S.target)&&d(!1)};return document.addEventListener("mousedown",w),()=>document.removeEventListener("mousedown",w)},[]),f.useEffect(()=>{u||p("")},[u]),a.jsxs("div",{ref:x,className:"relative w-full",children:[a.jsx("input",{disabled:i,value:u?h:j,placeholder:r,onFocus:()=>!i&&d(!0),onChange:w=>{p(w.target.value),u||d(!0)},className:`w-full border rounded-md px-2 py-1.5 text-sm outline-none focus:ring-2 disabled:bg-gray-100
          ${y?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}`}),u&&!i&&a.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg overflow-hidden",children:[a.jsx("div",{className:"max-h-56 overflow-y-auto",children:N.length>0?N.map(w=>{const S=String(w.id),_=s(w),T=String(t)===S;return a.jsx("button",{type:"button",onClick:()=>{n(S),d(!1)},className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-50 ${T?"bg-blue-50":""}`,children:_||"--"},S)}):a.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No results"})}),e.length>o&&a.jsxs("div",{className:"px-3 py-2 text-[11px] text-gray-400 border-t",children:["Showing first ",o," results  keep typing to narrow."]})]})]})}const jd=({meeting:e,onClose:t,onEdit:n,onDelete:s,onStatusUpdate:r,currentUser:i,isSalesView:o=!1})=>{Et();const[l,c]=f.useState("Overview");f.useEffect(()=>{console.log("AdminMeetingInformation - checking permissions:"),console.log("meeting.created_by:",e?.created_by),console.log("currentUser?.id:",i?.id),console.log("Match:",e?.created_by===i?.id)},[e,i]);const u=_=>{if(!_)return"";const T=String(_).split("-");return T.length===3?`${T[0]}-${T[2]}`:String(_)},d=_=>{const T=(_||"").toUpperCase();return T==="PLANNED"||T==="IN PROGRESS"?"PLANNED":T==="HELD"||T==="DONE"?"HELD":T==="NOT HELD"?"NOT_HELD":"PLANNED"},h=_=>{const T=(_||"").toUpperCase();return T==="PLANNED"?"PLANNED":T==="HELD"?"HELD":T==="NOT HELD"||T==="NOT_HELD"?"NOT HELD":"PENDING"},[p,x]=f.useState(d(e?.status||"PENDING")),[b,j]=f.useState(!1),{comments:y,addComment:N,refresh:w}=kn({relatedType:"meeting",relatedId:e?.id});if(f.useEffect(()=>{e?.id&&w()},[e?.id,w]),!e)return null;const S=_=>{const T=(_||"").toUpperCase(),k=T==="PLANNED"?"PENDING":T==="HELD"?"COMPLETED":T==="NOT_HELD"?"CANCELLED":T;switch(T){case"PENDING":return"bg-indigo-100 text-indigo-700";case"COMPLETED":case"DONE":return"bg-green-100 text-green-700";case"CANCELLED":return"bg-gray-200 text-gray-700";case"IN PROGRESS":return"bg-blue-100 text-blue-700";default:switch(k){case"PENDING":return"bg-indigo-100 text-indigo-700";case"COMPLETED":return"bg-green-100 text-green-700";case"CANCELLED":return"bg-gray-200 text-gray-700";default:return"bg-gray-100 text-gray-700"}}};return a.jsx(a.Fragment,{children:a.jsx("div",{className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-lg w-full max-w-full lg:max-w-4xl max-h-[95vh] overflow-y-auto hide-scrollbar relative box-border",children:[a.jsxs("div",{className:"bg-tertiary w-full rounded-t-xl p-3 lg:p-3 relative",children:[a.jsx("h1",{className:"lg:text-3xl text-xl text-white font-semibold text-center w-full",children:"Meeting"}),a.jsx("button",{onClick:t,className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-white cursor-pointer",children:a.jsx(Za,{size:25})})]}),a.jsx("div",{className:"mt-4 gap-2 px-2 lg:gap-4 lg:mx-7",children:a.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between lg:flex-row lg:items-center lg:justify-between mt-3 gap-2 px-2 md:items-center lg:gap-4 md:mx-7",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[a.jsx("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-800",children:e.subject||"Meeting"}),a.jsx("span",{className:`text-xs sm:text-sm font-medium px-2 sm:px-3 py-1 rounded-full whitespace-nowrap ${S(d(e.status))}`,children:d(e.status||"PENDING").replace("_"," ")})]}),a.jsx("div",{className:"flex flex-col sm:flex-row sm:space-x-3 space-y-2 sm:space-y-0",children:(!["MANAGER","GROUP MANAGER","SALES"].includes(i?.role?.toUpperCase())||e?.created_by===i?.id)&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{type:"button",onClick:()=>{console.log("Edit button clicked"),n&&n(e)},className:"inline-flex items-center justify-center w-full sm:w-auto bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 transition text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",children:[a.jsx(hn,{className:"mr-2"}),"Edit"]}),a.jsxs("button",{type:"button",onClick:()=>{console.log("Archive button clicked"),s&&s(e)},className:`inline-flex items-center justify-center w-full sm:w-auto px-4 py-2 rounded-md text-sm text-white transition focus:outline-none ${o?"bg-orange-500 hover:bg-orange-600 focus:ring-2 focus:ring-orange-400":"bg-red-500 hover:bg-red-600 focus:ring-2 focus:ring-red-400"}`,children:[o?a.jsx(Zt,{className:"mr-2"}):a.jsx(_a,{className:"mr-2"}),o?"Archive":"Delete"]})]})})]})}),a.jsx("div",{className:"border-b border-gray-200 my-5"}),a.jsxs("div",{className:"p-6 lg:p-4",children:[a.jsx("div",{className:"flex w-full bg-[#6A727D] text-white mt-1 overflow-x-auto mb-6",children:["Overview","Notes"].map(_=>a.jsx("button",{onClick:()=>c(_),className:`flex-1 min-w-[90px] px-4 py-2.5 text-xs sm:text-sm font-medium text-center transition-all duration-200 border-b-2
        ${l===_?"bg-paper-white text-[#6A727D] border-white":"text-white hover:bg-[#5c636d]"}`,children:_},_))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 items-start",children:[a.jsxs("div",{className:"lg:col-span-3",children:[l==="Overview"&&a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 md:p-8 border border-gray-200",children:a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4 sm:gap-6 text-sm text-gray-700",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Start Time:"}),a.jsx("p",{children:e.start_time?new Date(e.start_time).toLocaleString():"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"End Time:"}),a.jsx("p",{children:e.end_time?new Date(e.end_time).toLocaleString():"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Meeting Title:"}),a.jsx("p",{children:e.subject||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Location:"}),a.jsx("p",{children:e.location||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Assigned To:"}),a.jsxs("p",{children:[e.meet_assign_to.first_name," ",e.meet_assign_to.last_name]})]}),e.lead&&a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Lead:"}),a.jsx("p",{children:e.lead.title})]}),e.account&&a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Account:"}),a.jsx("p",{children:e.account.name})]}),e.contact&&a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Contact:"}),a.jsxs("p",{children:[e.contact.first_name," ",e.contact.last_name]})]}),e.deal&&a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Deal:"}),a.jsx("p",{children:e.deal.name})]}),e.quote&&a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Quote:"}),a.jsx("p",{children:u(e.quote.quote_id)})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Status:"}),a.jsx("p",{children:d(e.status||"PENDING").replace("_"," ")})]})]})}),l==="Notes"&&a.jsxs("div",{className:"mt-4 w-full",children:[a.jsx("div",{className:"flex flex-wrap items-center justify-between mb-4 gap-2",children:a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words",children:"Meeting Note"})}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 shadow-sm break-words",children:[a.jsx("div",{className:"flex items-start justify-between",children:a.jsx("div",{children:a.jsx("p",{className:"text-sm font-medium text-gray-800 break-words",children:"Note"})})}),a.jsx("div",{className:"mt-3 text-sm text-gray-700 whitespace-pre-wrap break-words",children:e.notes||"No notes available."})]}),a.jsx(Tn,{comments:y,onAddComment:N})]})]}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm w-full",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Status"}),a.jsxs("select",{className:"border border-gray-200 rounded-md px-2 sm:px-3 py-1.5 w-full text-sm mb-2 focus:ring-2 focus:ring-indigo-500 outline-none",value:p,onChange:_=>x(_.target.value),children:[a.jsx("option",{value:"PLANNED",children:"PLANNED"}),a.jsx("option",{value:"HELD",children:"HELD"}),a.jsx("option",{value:"NOT_HELD",children:"NOT HELD"})]}),a.jsx("button",{onClick:async()=>{if(!r||!e?.id)return;const _=h(p);if(d(e.status)!==p){j(!0);try{await r(e.id,_)}catch(T){console.error("Failed to update status:",T)}finally{j(!1)}}},disabled:p===e.status||b,className:`w-full py-1.5 rounded-md text-sm transition focus:outline-none focus:ring-2 ${p===e.status||b?"bg-gray-400 cursor-not-allowed text-white":"bg-gray-900 text-white hover:bg-gray-800 focus:ring-gray-400"}`,children:b?"Updating...":"Update"})]})]})]})]})})})},cJ=e=>e?e.toUpperCase():"",Kd=e=>{const t=cJ(e);return t==="INACTIVE"?"INACTIVE":t==="PLANNED"||t==="IN PROGRESS"?"PLANNED":t==="HELD"||t==="DONE"?"HELD":t==="NOT_HELD"||t==="NOT HELD"?"NOT_HELD":"PLANNED"},Yze=e=>{if(!e)return"--";try{return new Date(e).toLocaleString()}catch{return"--"}},Qze=e=>{if(!e)return"";const t=String(e).split("-");return t.length===3?`${t[0]}-${t[2]}`:String(e)},Kze=e=>{const t=cJ(e);if(t==="INACTIVE")return"bg-gray-200 text-gray-700";switch(t==="PLANNED"?"PENDING":t==="HELD"?"COMPLETED":t==="NOT_HELD"?"CANCELLED":t){case"PENDING":return"bg-indigo-100 text-indigo-700";case"COMPLETED":case"DONE":return"bg-green-100 text-green-700";case"CANCELLED":return"bg-gray-200 text-gray-700";case"IN PROGRESS":return"bg-blue-100 text-blue-700";default:return"bg-gray-100 text-gray-700"}},IA={subject:"",startTime:"",endTime:"",location:"",status:"PLANNED",notes:"",assignedTo:"",relatedType1:"Lead",relatedTo1:"",relatedType2:null,relatedTo2:""},h8=()=>{const e=Et(),t=ta(),[n]=Bs(),s=n.get("id"),r=t.pathname==="/admin/meetings/info";f.useEffect(()=>{document.title="Meetings | Sari-Sari CRM"},[]);const[i,o]=f.useState([]),[l,c]=f.useState(!1),[u,d]=f.useState([]),[h,p]=f.useState(""),[x,b]=f.useState("Filter by Status"),[j,y]=f.useState(!1),[N,w]=f.useState(null),[S,_]=f.useState(1),[T,k]=f.useState(10),[A,E]=f.useState(IA),[M,F]=f.useState(!1),[D,P]=f.useState(null),[B,G]=f.useState(!1),[$,W]=f.useState(null),[Z,Q]=f.useState(!1),[le,we]=f.useState([]),[J,se]=f.useState(null);f.useEffect(()=>{const Fe=t.state?.openMeetingModal,Ue=t.state?.initialMeetingData?.relatedTo||n.get("id"),Ne=t.state?.meetingID;Fe||Ue?(y(!0),t.state?.initialMeetingData&&E(ze=>({...ze,...t.state.initialMeetingData})),e(t.pathname,{replace:!0,state:{}})):Ne&&(se(Ne),e(t.pathname,{replace:!0,state:{}}))},[t,n,e]),f.useEffect(()=>{if(J&&i.length>0&&!l){const Fe=i.find(Ue=>Ue.id===J);Fe?w(Fe):V.error("Meeting not found."),se(null)}},[J,i,l]);const ye=async()=>{if(s&&r){const Fe=sessionStorage.getItem("meetingDetailData");if(Fe)try{const Ue=JSON.parse(Fe);if(Ue.id===parseInt(s)){w(Ue),sessionStorage.removeItem("meetingDetailData");return}}catch(Ue){console.error(Ue)}}c(!0);try{const Fe=await ne.get("/meetings/admin/fetch-all"),Ne=[...Array.isArray(Fe.data)?Fe.data:[]].sort((ze,je)=>{const ve=ze?.created_at?new Date(ze.created_at).getTime():0;return(je?.created_at?new Date(je.created_at).getTime():0)-ve});if(o(Ne),s&&!N){const ze=Ne.find(je=>je.id===parseInt(s));ze&&w(ze)}}catch{V.error("Failed to load meetings.")}finally{c(!1)}},Ce=async()=>{try{const Fe=await ne.get("/users/all");d(Array.isArray(Fe.data)?Fe.data:[])}catch(Fe){console.error(Fe)}};f.useEffect(()=>{ye(),Ce()},[]);const ge=Fe=>p(Fe.target.value),be=Fe=>{if(Fe.target.checked){const Ue=Ee.map(Ne=>Ne.id);we(Ue)}else we([])},me=Fe=>{we(Ue=>Ue.includes(Fe)?Ue.filter(Ne=>Ne!==Fe):[...Ue,Fe])},Ae=f.useMemo(()=>{const Fe=h.trim().toLowerCase(),Ue=x.trim().toUpperCase();return i.filter(Ne=>{const ze=[Ne?.subject,Ne?.location,Ne?.notes,Ne?.lead?.title,Ne?.account?.name,Ne?.contact?.first_name,Ne?.contact?.last_name,Ne?.deal?.name,Ne?.quote?.quote_id,Ne?.meet_assign_to?.first_name,Ne?.meet_assign_to?.last_name].filter(Boolean).join(" ").toLowerCase(),je=Fe===""||ze.includes(Fe),ve=Ue==="FILTER BY STATUS"||Kd(Ne.status||"PENDING")===Ue;return je&&ve})},[i,h,x]),pe=i.length,Ie=i.filter(Fe=>Kd(Fe.status)==="PLANNED").length,xe=i.filter(Fe=>Kd(Fe.status)==="HELD").length,he=i.filter(Fe=>Kd(Fe.status)==="NOT_HELD").length,Re=[{title:"Total",value:pe,icon:Pt,color:"text-slate-600",bgColor:"bg-slate-100"},{title:"Planned",value:Ie,icon:Vn,color:"text-indigo-600",bgColor:"bg-indigo-100"},{title:"Held",value:xe,icon:La,color:"text-green-600",bgColor:"bg-green-100"},{title:"Not Held",value:he,icon:Yn,color:"text-gray-600",bgColor:"bg-gray-100"}];f.useEffect(()=>{_(1)},[h,x,T]);const Ee=f.useMemo(()=>{const Fe=(S-1)*T;return Ae.slice(Fe,Fe+T)},[Ae,S,T]),He=()=>{y(!1),E(IA),F(!1),P(null),G(!1)},Ke=()=>{E(IA),F(!1),P(null),y(!0)},st=Fe=>{let Ue="";if(Fe.meet_assign_to?.id)Ue=String(Fe.meet_assign_to.id);else if(Fe.assignedTo){const Le=u.find(De=>`${De.first_name} ${De.last_name}`===Fe.assignedTo);Ue=Le?String(Le.id):""}const Ne=Le=>{if(!Le)return"";try{const De=new Date(Le),Qe=De.getTimezoneOffset()*6e4;return new Date(De.getTime()-Qe).toISOString().slice(0,16)}catch{return""}};let ze="Lead",je="",ve="Contact",z="";if(Fe.lead)ze="Lead",je=String(Fe.lead.id);else if(Fe.account)ze="Account",je=String(Fe.account.id),Fe.contact?(ve="Contact",z=String(Fe.contact.id)):Fe.deal?(ve="Deal",z=String(Fe.deal.id)):Fe.quote&&(ve="Quote",z=String(Fe.quote.id));else if(Fe.relatedType||Fe.related_type){const Le=Fe.relatedType||Fe.related_type,De=Fe.related_to||Fe.relatedToId;Le==="Lead"?(ze="Lead",je=String(De)):(ze="Account",je=Fe.account_id?String(Fe.account_id):"")}const K={PLANNED:"Planned",HELD:"Held",NOT_HELD:"Not held"},ue=Kd(Fe.status),re=K[ue]||"Planned";E({subject:Fe.subject||Fe.activity||"",location:Fe.location||"",startTime:Ne(Fe.start_time||Fe.startTime),endTime:Ne(Fe.end_time||Fe.endTime),status:re,notes:Fe.description||Fe.notes||"",assignedTo:Ue,relatedType1:ze,relatedTo1:je,relatedType2:ve,relatedTo2:z}),F(!0),P(Fe.id),w(null),y(!0)},it=Fe=>{if(!Fe.subject?.trim())return V.error("Subject is required.");if(!Fe.startTime)return V.error("Start time is required.");if(Fe.endTime&&!(new Date(Fe.endTime)-new Date(Fe.startTime)>0))return V.error("End time must be after start time.");Fe.relatedType1,Fe.relatedTo1,Fe.relatedType1==="Account"&&Fe.relatedType2&&Fe.relatedTo2&&(Fe.relatedType2,Fe.relatedTo2);const Ue={...Fe,assignedTo:parseInt(Fe.assignedTo),relatedTo1:parseInt(Fe.relatedTo1),relatedTo2:parseInt(Fe.relatedTo2)},Ne=M&&D?"update":"create";W({title:Ne==="create"?"Confirm New Meeting":"Confirm Update",message:`Are you sure you want to ${Ne} "${Ue.subject}"?`,confirmLabel:Ne==="create"?"Create Meeting":"Update Meeting",variant:"primary",action:{type:Ne,payload:Ue,targetId:D,name:Ue.subject}})},ot=async()=>{if(!$?.action)return;const{type:Fe,payload:Ue,targetId:Ne,name:ze}=$.action;Q(!0);try{if(Fe==="create")G(!0),await ne.post("/meetings/create",Ue),V.success(`Meeting "${ze}" created.`),He(),await ye();else if(Fe==="update")G(!0),await ne.put(`/meetings/${Ne}`,Ue),V.success(`Meeting "${ze}" updated.`),He(),await ye();else if(Fe==="delete")await ne.delete(`/meetings/${Ne}`),V.success(`Meeting "${ze}" deleted.`),N?.id===Ne&&w(null),await ye();else if(Fe==="bulk-delete"){const{meeting_ids:je}=$.action;await ne.delete("/meetings/admin/bulk-delete",{data:{meeting_ids:je}}),V.success(`${je.length} meetings deleted.`),we([]),await ye()}}catch(je){const ve=je.response?.data?.detail||"Action failed.";V.error(typeof ve=="string"?ve:JSON.stringify(ve)),console.error(ve)}finally{G(!1),Q(!1),W(null)}},rt=async()=>{le.length!==0&&W({title:"Delete Meetings",message:a.jsxs("span",{children:["Are you sure you want to delete"," ",a.jsx("span",{className:"font-semibold",children:le.length})," selected meetings? This action cannot be undone."]}),confirmLabel:`Delete ${le.length} Meeting(s)`,cancelLabel:"Cancel",variant:"danger",action:{type:"bulk-delete",meeting_ids:le}})},at=Fe=>{W({title:"Delete Meeting",message:`Permanently delete "${Fe.subject}"? This action cannot be undone.`,confirmLabel:"Delete",variant:"danger",action:{type:"delete",targetId:Fe.id,name:Fe.subject}})},Je=async(Fe,Ue)=>{try{await ne.put(`/meetings/${Fe}`,{status:Ue}),V.success("Status updated"),ye(),w(null)}catch{V.error("Failed to update status")}};return r&&s?N?a.jsx(jd,{meeting:N,onClose:()=>{w(null),e("/admin/dashboard")},onEdit:st,onDelete:at,onStatusUpdate:Je,isSalesView:!1}):a.jsx(qt,{message:"Loading meeting..."}):a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[l&&a.jsx(qt,{message:"Loading meetings..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h1",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800 mb-4 lg:mb-0",children:[a.jsx(Pt,{className:"mr-2 text-blue-600"})," Meetings"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{onClick:Ke,className:"bg-black text-white px-4 py-2 rounded-md flex items-center hover:bg-gray-800",children:[a.jsx(aa,{className:"mr-2"})," Add Meeting"]})})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-4 mb-6 w-full break-words overflow-hidden lg:overflow-visible",children:Re.map(Fe=>a.jsx(Zze,{...Fe},Fe.title))}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full sm:w-auto lg:w-4/4 md:w-3/4",children:[a.jsx(Kt,{className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search meetings",value:h,onChange:ge,className:"w-full outline-none"})]}),a.jsxs("select",{value:x,onChange:Fe=>b(Fe.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm bg-white w-full sm:w-auto",children:[a.jsx("option",{children:"Filter by Status"}),a.jsx("option",{value:"PLANNED",children:"PLANNED"}),a.jsx("option",{value:"HELD",children:"HELD"}),a.jsx("option",{value:"NOT_HELD",children:"NOT HELD"})]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[500px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm mb-4",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 w-12",children:a.jsx("input",{type:"checkbox",checked:Ee.length>0&&le.length===Ee.length,onChange:be,className:"cursor-pointer"})}),a.jsx("th",{className:"py-3 px-4",children:"Subject"}),a.jsx("th",{className:"py-3 px-4",children:"Related To"}),a.jsx("th",{className:"py-3 px-4",children:"Start Time"}),a.jsx("th",{className:"py-3 px-4",children:"Assigned"}),a.jsx("th",{className:"py-3 px-4",children:"Status"}),a.jsx("th",{className:"py-3 px-4 text-center w-24",children:le.length>0?a.jsx("button",{onClick:rt,className:"text-red-600 hover:text-red-800 transition p-1 rounded-full hover:bg-red-50",title:`Delete ${le.length} selected items`,children:a.jsx(_a,{size:18})}):""})]})}),a.jsx("tbody",{children:Ee.length>0?Ee.map(Fe=>a.jsxs("tr",{onClick:()=>w(Fe),className:"hover:bg-gray-50 cursor-pointer border-b border-gray-100",children:[a.jsx("td",{className:"py-3 px-4 align-top w-12",onClick:Ue=>Ue.stopPropagation(),children:a.jsx("input",{type:"checkbox",checked:le.includes(Fe.id),onChange:()=>me(Fe.id),className:"cursor-pointer"})}),a.jsx("td",{className:"py-3 px-4 font-medium text-blue-600",children:Fe.subject}),a.jsxs("td",{className:"py-3 px-4",children:[Fe.lead&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:Fe.lead.title}),Fe.account&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:Fe.account.name}),Fe.contact&&a.jsxs("p",{className:"font-medium text-blue-500 text-xs",children:[Fe.contact.first_name," ",Fe.contact.last_name]}),Fe.deal&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:Fe.deal.name}),Fe.quote&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:Qze(Fe.quote.quote_id)})]}),a.jsx("td",{className:"py-3 px-4",children:Yze(Fe.start_time)}),a.jsxs("td",{className:"py-3 px-4",children:[Fe.meet_assign_to.first_name," ",Fe.meet_assign_to.last_name]}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${Kze(Kd(Fe.status))}`,children:Kd(Fe.status).replace("_"," ")})}),a.jsx("td",{className:"py-3 px-4 text-center"})]},Fe.id)):a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"text-center py-4 text-gray-500",children:"No meetings found."})})})]})}),a.jsx(ca,{totalItems:Ae.length,pageSize:T,currentPage:S,onPrev:()=>_(Fe=>Math.max(1,Fe-1)),onNext:()=>_(Fe=>Math.min(Fe+1,Math.ceil(Ae.length/T)||1)),onPageSizeChange:k,label:"meetings"}),j&&a.jsx(O1,{onClose:He,formData:A,setFormData:E,isEditing:M,onSubmit:it,isSubmitting:B||Z,users:u}),N&&a.jsx(jd,{meeting:N,onClose:()=>w(null),onEdit:st,onDelete:at,onStatusUpdate:Je,isSalesView:!1}),$&&a.jsx(Xze,{open:!0,title:$.title,message:$.message,confirmLabel:$.confirmLabel,variant:$.variant,onConfirm:ot,onCancel:()=>W(null),loading:Z})]})};function Xze({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{onClick:c,disabled:o,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",children:"Cancel"}),a.jsx("button",{onClick:l,disabled:o,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70
                       ${u}`,children:o?"...":s})]})]})})}function Zze({icon:e,title:t,value:n,color:s,bgColor:r}){return a.jsxs("div",{className:"flex items-center p-4 bg-white rounded-xl shadow-md border border-gray-200",children:[a.jsx("div",{className:`p-3 rounded-full ${r} ${s} mr-4`,children:a.jsx(e,{size:22})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:t}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:n})]})]})}function Jze(){const{user:e,mutate:t}=Gt(),n=f.useRef(null),[s,r]=f.useState(""),[i,o]=f.useState(""),[l,c]=f.useState(""),[u,d]=f.useState("January"),[h,p]=f.useState(0),[x,b]=f.useState(null),[j,y]=f.useState(null),[N,w]=f.useState(""),[S,_]=f.useState(!1),[T,k]=f.useState(!1),[A,E]=f.useState({type:"",text:""}),M=["January","February","March","April","May","June","July","August","September","October","November","December"];f.useEffect(()=>{e?.company&&(e.company.company_name&&r(e.company.company_name),e.company.slug&&o(e.company.slug),e.company.currency&&c(e.company.currency),e.company.quota_period&&d(e.company.quota_period),e.company.tax_rate!==void 0&&p(e.company.tax_rate),e.company.company_logo&&b(e.company.company_logo),e.company.address&&w(e.company.address))},[e]);const F=$=>{const W=$.target.files?.[0];if(!W)return;if(!W.type.startsWith("image/")){E({type:"error",text:"Please select an image file"});return}if(W.size>2*1024*1024){E({type:"error",text:"Image size should be less than 2MB"});return}const Z=new FileReader;Z.onloadend=()=>{y(Z.result)},Z.readAsDataURL(W)},D=()=>{y(""),b(null)},P=async $=>{$.preventDefault(),_(!0),E({type:"",text:""});try{const W={company_name:s,slug:i,currency:l,quota_period:u,tax_rate:parseFloat(h),address:N};j!==null&&(W.company_logo=j),await ne.put("/company/update-name",W),t&&await t(),y(null),E({type:"success",text:"Company settings updated successfully!"})}catch(W){console.error("Update error:",W);const Z=W.response?.data?.detail||"Failed to update settings.";E({type:"error",text:Z})}finally{_(!1)}},B=async()=>{k(!0),E({type:"",text:""});try{const $=await ne.get("/admin/backup/csv",{responseType:"blob"}),W=$.headers?.["content-disposition"]||"",Q=/filename="?([^";]+)"?/i.exec(W)?.[1]||"crm-backup.zip",le=window.URL.createObjectURL(new Blob([$.data])),we=document.createElement("a");we.href=le,we.setAttribute("download",Q),document.body.appendChild(we),we.click(),we.remove(),window.URL.revokeObjectURL(le)}catch($){console.error("Backup download error:",$);const W=$?.response?.data?.detail||"Failed to download backup. Please try again.";E({type:"error",text:W})}finally{k(!1)}},G=["CEO","ADMIN"].includes(e?.role?.toUpperCase());return a.jsxs("div",{className:"max-w-2xl mx-auto mt-10 bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[a.jsxs("div",{className:"bg-[#fbbf24] px-6 py-4",children:[a.jsxs("h2",{className:"text-gray-900 font-bold text-xl flex items-center gap-2",children:[a.jsx(sa,{})," Company Details"]}),a.jsx("p",{className:"text-gray-700 text-sm",children:"Manage your organization's identity and fiscal settings"})]}),a.jsxs("form",{onSubmit:P,className:"p-6 space-y-6",children:[!G&&a.jsxs("div",{className:"flex items-center gap-2 p-3 bg-amber-50 text-amber-700 rounded-lg text-sm border border-amber-200",children:[a.jsx(Fl,{}),a.jsx("span",{children:"You only have view-access. Changes can only be made by an Admin."})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Company Name"}),a.jsx("input",{type:"text",value:s,onChange:$=>r($.target.value),disabled:!G||S,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#fbbf24] focus:border-transparent outline-none transition disabled:bg-gray-50 disabled:cursor-not-allowed",placeholder:"Enter company name",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Company Slug (short name)"}),a.jsx("input",{type:"text",value:i,onChange:$=>o($.target.value),disabled:!G||S,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#fbbf24] focus:border-transparent outline-none transition disabled:bg-gray-50 disabled:cursor-not-allowed",placeholder:"e.g. sari-sari"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Shown in the sidebar header; leave blank to auto-generate."})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-gray-700 mb-2",children:[a.jsx(coe,{className:"text-gray-500"})," Company Address"]}),a.jsx("textarea",{value:N,onChange:$=>w($.target.value),disabled:!G||S,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#fbbf24] focus:border-transparent outline-none transition disabled:bg-gray-50 disabled:cursor-not-allowed resize-none",placeholder:"Enter company address",rows:3})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-gray-700 mb-2",children:[a.jsx(WI,{className:"text-gray-500"})," Company Logo"]}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"flex-shrink-0",children:j||x?a.jsx("img",{src:j||x,alt:"Company Logo",className:"w-16 h-16 object-contain border border-gray-200 rounded-lg bg-gray-50"}):a.jsx("div",{className:"w-16 h-16 border-2 border-dashed border-gray-300 rounded-lg flex items-center justify-center bg-gray-50",children:a.jsx(WI,{className:"text-gray-400 text-xl"})})}),G&&a.jsxs("div",{className:"flex flex-col gap-2",children:[a.jsx("input",{type:"file",ref:n,accept:"image/*",onChange:F,className:"hidden",id:"company-logo-upload"}),a.jsxs("button",{type:"button",onClick:()=>n.current?.click(),disabled:S,className:"flex items-center gap-2 px-3 py-1.5 text-sm border border-gray-300 rounded-lg hover:bg-gray-50 transition disabled:opacity-50",children:[a.jsx(hoe,{className:"text-gray-500"}),j||x?"Change Logo":"Upload Logo"]}),(j||x)&&a.jsx("button",{type:"button",onClick:D,disabled:S,className:"text-xs text-red-600 hover:text-red-700 transition",children:"Remove Logo"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Max 2MB, PNG or JPG"})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-gray-700 mb-2",children:[a.jsx(Pt,{className:"text-gray-500"})," Fiscal Year Start"]}),a.jsxs("div",{className:"relative",children:[a.jsx("select",{value:u,onChange:$=>d($.target.value),disabled:!G||S,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#fbbf24] focus:border-transparent outline-none appearance-none bg-white disabled:bg-gray-50 cursor-pointer",children:M.map($=>a.jsx("option",{value:$,children:$},$))}),a.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none text-gray-500",children:a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})})]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-gray-700 mb-2",children:[a.jsx(uoe,{className:"text-gray-500"})," Default Tax Rate"]}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"number",step:"0.01",value:h,onChange:$=>p($.target.value),disabled:!G||S,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#fbbf24] focus:border-transparent outline-none transition disabled:bg-gray-50",placeholder:"0.00"}),a.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-8 pointer-events-none text-gray-400 font-medium",children:"%"})]})]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-gray-700 mb-2",children:[a.jsx(w9,{className:"text-gray-500"})," Currency"]}),a.jsxs("div",{className:"flex gap-3 max-w-xs",children:[a.jsxs("label",{className:`flex-1 flex items-center justify-center gap-1 p-2 border rounded-lg cursor-pointer transition-all ${l===""?"bg-amber-50 border-[#fbbf24] text-amber-900 font-medium ring-1 ring-[#fbbf24]":"border-gray-200 hover:bg-gray-50 text-gray-600"} ${!G||S?"opacity-50 cursor-not-allowed":""}`,children:[a.jsx("input",{type:"radio",name:"currency",value:"",checked:l==="",onChange:()=>c(""),disabled:!G||S,className:"hidden"}),a.jsx("span",{className:"text-lg font-bold",children:""})," PHP"]}),a.jsxs("label",{className:`flex-1 flex items-center justify-center gap-1 p-2 border rounded-lg cursor-pointer transition-all ${l==="$"?"bg-amber-50 border-[#fbbf24] text-amber-900 font-medium ring-1 ring-[#fbbf24]":"border-gray-200 hover:bg-gray-50 text-gray-600"} ${!G||S?"opacity-50 cursor-not-allowed":""}`,children:[a.jsx("input",{type:"radio",name:"currency",value:"$",checked:l==="$",onChange:()=>c("$"),disabled:!G||S,className:"hidden"}),a.jsx("span",{className:"text-lg font-bold",children:"$"})," USD"]})]})]}),A.text&&a.jsx("div",{className:`p-3 rounded-lg text-sm border transition-all ${A.type==="success"?"bg-green-50 text-green-700 border-green-200":"bg-red-50 text-red-700 border-red-200"}`,children:A.text}),a.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:G&&a.jsxs("div",{className:"flex flex-wrap gap-3",children:[a.jsxs("button",{type:"button",onClick:B,disabled:S||T,className:"flex items-center gap-2 border border-gray-300 bg-white text-gray-700 px-4 py-2 rounded-lg font-medium hover:bg-gray-50 disabled:opacity-50 transition active:scale-95",children:[a.jsx(Vo,{}),T?"Preparing...":"Download Backup (CSV)"]}),a.jsxs("button",{type:"submit",disabled:S||T,className:"flex items-center gap-2 bg-[#1e293b] text-white px-6 py-2 rounded-lg font-medium hover:bg-[#334155] disabled:opacity-50 transition shadow-md active:scale-95",children:[a.jsx(kL,{}),S?"Updating...":"Save Settings"]})]})})]})]})}function eFe(){const[e,t]=f.useState(null),[n,s]=f.useState({subject:"",category:"",description:"",priority:"medium"}),[r,i]=f.useState(""),[o,l]=f.useState(!1),[c,u]=f.useState([{id:1,sender:"support",message:"Hello! Welcome to Sari-Sari CRM Support. How can I help you today?",timestamp:new Date}]),[d,h]=f.useState(""),[p,x]=f.useState(!1),b=f.useRef(null);f.useEffect(()=>{b.current?.scrollIntoView({behavior:"smooth"})},[c]),f.useEffect(()=>{document.title="Help Center | Sari-Sari CRM"},[]);const j=[{id:1,category:"Getting Started",title:"How to create your first account?",content:"Navigate to the Accounts page from the sidebar, click the 'Add Account' button, fill in the required information such as company name, email, and phone number, then click Save."},{id:2,category:"Getting Started",title:"How to add new contacts?",content:"Go to Contacts in the sidebar, click 'Add Contact', enter the contact details including name, email, phone, and associated account, then save the contact."},{id:3,category:"Leads & Deals",title:"How to convert a lead to a deal?",content:"Open the lead you want to convert, click on the 'Convert to Deal' button, review the pre-filled information, make any necessary adjustments, and confirm the conversion."},{id:4,category:"Leads & Deals",title:"How to manage deal stages?",content:"Deals progress through stages: Prospecting, Qualification, Proposal, Negotiation, and Closed. Update the stage by editing the deal and selecting the appropriate stage from the dropdown."},{id:5,category:"Tasks & Activities",title:"How to create and assign tasks?",content:"Navigate to Tasks, click 'Add Task', fill in the task details, assign it to a team member, set the due date and priority, then save. The assigned user will be notified."},{id:6,category:"Tasks & Activities",title:"How to schedule meetings?",content:"Go to Meetings, click 'Schedule Meeting', select participants, set the date and time, add an agenda, and save. All participants will receive calendar invites."},{id:7,category:"Reports & Analytics",title:"How to view sales performance?",content:"Access the Dashboard to see key metrics. For detailed reports, navigate to Targets to view individual and team performance against set goals."},{id:8,category:"Account Settings",title:"How to manage user permissions?",content:"Go to Users in the sidebar, select a user, and edit their role. Different roles (Admin, Manager, Sales, Marketing) have different access levels and permissions."}],y=["Technical Issue","Login Problem","Data Issue","Feature Request","Performance Issue","Other"],w=j.filter(M=>M.title.toLowerCase().includes(r.toLowerCase())||M.content.toLowerCase().includes(r.toLowerCase())||M.category.toLowerCase().includes(r.toLowerCase())).reduce((M,F)=>(M[F.category]||(M[F.category]=[]),M[F.category].push(F),M),{}),S=(M,F)=>{s(D=>({...D,[M]:F}))},_=async M=>{if(M.preventDefault(),!n.subject.trim()||!n.category||!n.description.trim()){V.warn("Please fill in all required fields.");return}l(!0),setTimeout(()=>{V.success("Your issue has been submitted successfully! We'll get back to you soon."),s({subject:"",category:"",description:"",priority:"medium"}),t(null),l(!1)},1500)},[T,k]=f.useState(null),A=M=>{if(M.preventDefault(),!d.trim())return;const F={id:c.length+1,sender:"user",message:d.trim(),timestamp:new Date};u(D=>[...D,F]),h(""),x(!0),setTimeout(()=>{const D=["Thank you for your message. Let me look into that for you.","I understand your concern. Can you provide more details?","That's a great question! Here's what I can help you with...","I'm checking our system now. Please hold on for a moment.","Thanks for reaching out! I'll make sure to assist you with this."],P=D[Math.floor(Math.random()*D.length)];u(B=>[...B,{id:B.length+1,sender:"support",message:P,timestamp:new Date}]),x(!1)},1500)},E=M=>new Date(M).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return a.jsxs("div",{className:"p-6 max-w-6xl mx-auto",children:[a.jsxs("div",{className:"mb-8 text-center",children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Help Center"}),a.jsx("p",{className:"text-gray-600",children:"How can we help you today?"})]}),a.jsxs("div",{className:"grid md:grid-cols-3 gap-6 mb-8",children:[a.jsx("div",{onClick:()=>t(e==="report"?null:"report"),className:`bg-white rounded-xl shadow-md border-2 cursor-pointer transition-all duration-300 hover:shadow-lg ${e==="report"?"border-red-400 ring-2 ring-red-100":"border-transparent hover:border-red-200"}`,children:a.jsx("div",{className:"p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-14 h-14 bg-red-100 rounded-full flex items-center justify-center",children:a.jsx(Fl,{className:"w-7 h-7 text-red-600"})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Report an Issue"}),a.jsx("p",{className:"text-gray-500 text-sm",children:"Having a problem? Let us know"})]})]}),a.jsx(Mt,{className:`w-6 h-6 text-gray-400 transition-transform duration-300 ${e==="report"?"rotate-90":""}`})]})})}),a.jsx("div",{onClick:()=>t(e==="solutions"?null:"solutions"),className:`bg-white rounded-xl shadow-md border-2 cursor-pointer transition-all duration-300 hover:shadow-lg ${e==="solutions"?"border-blue-400 ring-2 ring-blue-100":"border-transparent hover:border-blue-200"}`,children:a.jsx("div",{className:"p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-14 h-14 bg-blue-100 rounded-full flex items-center justify-center",children:a.jsx(noe,{className:"w-7 h-7 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Browse Solutions"}),a.jsx("p",{className:"text-gray-500 text-sm",children:"Find answers to common questions"})]})]}),a.jsx(Mt,{className:`w-6 h-6 text-gray-400 transition-transform duration-300 ${e==="solutions"?"rotate-90":""}`})]})})}),a.jsx("div",{onClick:()=>t(e==="chat"?null:"chat"),className:`bg-white rounded-xl shadow-md border-2 cursor-pointer transition-all duration-300 hover:shadow-lg ${e==="chat"?"border-green-400 ring-2 ring-green-100":"border-transparent hover:border-green-200"}`,children:a.jsx("div",{className:"p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("div",{className:"w-14 h-14 bg-green-100 rounded-full flex items-center justify-center relative",children:[a.jsx(By,{className:"w-7 h-7 text-green-600"}),a.jsx("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-green-500 rounded-full border-2 border-white"})]}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Live Chat Support"}),a.jsx("p",{className:"text-gray-500 text-sm",children:"Chat with our support team"})]})]}),a.jsx(Mt,{className:`w-6 h-6 text-gray-400 transition-transform duration-300 ${e==="chat"?"rotate-90":""}`})]})})})]}),e==="report"&&a.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 mb-8 animate-fade-in",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-800 flex items-center gap-2",children:[a.jsx(VI,{className:"text-red-500"}),"Report an Issue"]}),a.jsx("button",{onClick:()=>t(null),className:"p-2 hover:bg-gray-100 rounded-full transition",children:a.jsx(ea,{className:"w-5 h-5 text-gray-500"})})]}),a.jsxs("form",{onSubmit:_,className:"space-y-5",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Subject ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",value:n.subject,onChange:M=>S("subject",M.target.value),placeholder:"Brief description of the issue",className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-200 focus:border-red-400 outline-none transition"})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Category ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("select",{value:n.category,onChange:M=>S("category",M.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-200 focus:border-red-400 outline-none transition bg-white",children:[a.jsx("option",{value:"",children:"Select a category"}),y.map(M=>a.jsx("option",{value:M,children:M},M))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Priority"}),a.jsx("div",{className:"flex gap-3",children:["low","medium","high"].map(M=>a.jsx("button",{type:"button",onClick:()=>S("priority",M),className:`px-4 py-2 rounded-lg border transition capitalize ${n.priority===M?M==="high"?"bg-red-500 text-white border-red-500":M==="medium"?"bg-yellow-500 text-white border-yellow-500":"bg-green-500 text-white border-green-500":"bg-white text-gray-600 border-gray-300 hover:border-gray-400"}`,children:M},M))})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Description ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("textarea",{value:n.description,onChange:M=>S("description",M.target.value),placeholder:"Please describe the issue in detail. Include steps to reproduce if applicable.",rows:5,className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-200 focus:border-red-400 outline-none transition resize-none"})]}),a.jsx("div",{className:"flex justify-end",children:a.jsx("button",{type:"submit",disabled:o,className:"flex items-center gap-2 bg-red-500 hover:bg-red-600 text-white px-6 py-2.5 rounded-lg font-medium transition disabled:opacity-50 disabled:cursor-not-allowed",children:o?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Submitting..."]}):a.jsxs(a.Fragment,{children:[a.jsx(ok,{className:"w-4 h-4"}),"Submit Issue"]})})})]})]}),e==="solutions"&&a.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 mb-8 animate-fade-in",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-800 flex items-center gap-2",children:[a.jsx(ooe,{className:"text-blue-500"}),"Browse Solutions"]}),a.jsx("button",{onClick:()=>t(null),className:"p-2 hover:bg-gray-100 rounded-full transition",children:a.jsx(ea,{className:"w-5 h-5 text-gray-500"})})]}),a.jsxs("div",{className:"relative mb-6",children:[a.jsx(Kt,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),a.jsx("input",{type:"text",value:r,onChange:M=>i(M.target.value),placeholder:"Search for solutions...",className:"w-full pl-12 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-200 focus:border-blue-400 outline-none transition"})]}),a.jsx("div",{className:"space-y-6",children:Object.keys(w).length>0?Object.entries(w).map(([M,F])=>a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-semibold text-gray-500 uppercase tracking-wide mb-3",children:M}),a.jsx("div",{className:"space-y-2",children:F.map(D=>a.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[a.jsxs("button",{onClick:()=>k(T===D.id?null:D.id),className:"w-full px-4 py-3 flex items-center justify-between bg-gray-50 hover:bg-gray-100 transition text-left",children:[a.jsx("span",{className:"font-medium text-gray-700",children:D.title}),a.jsx(Mt,{className:`w-5 h-5 text-gray-400 transition-transform duration-200 ${T===D.id?"rotate-90":""}`})]}),T===D.id&&a.jsxs("div",{className:"px-4 py-3 bg-white border-t border-gray-200",children:[a.jsx("p",{className:"text-gray-600 text-sm leading-relaxed",children:D.content}),a.jsxs("div",{className:"mt-3 flex items-center gap-2 text-xs text-gray-500",children:[a.jsx(La,{className:"text-green-500"}),"Was this helpful?",a.jsx("button",{className:"text-blue-500 hover:underline ml-1",children:"Yes"}),a.jsx("span",{children:"|"}),a.jsx("button",{className:"text-blue-500 hover:underline",children:"No"})]})]})]},D.id))})]},M)):a.jsxs("div",{className:"text-center py-8",children:[a.jsx(Kt,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),a.jsxs("p",{className:"text-gray-500",children:['No solutions found matching "',r,'"']}),a.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:["Try a different search term or"," ",a.jsx("button",{onClick:()=>t("report"),className:"text-blue-500 hover:underline",children:"report an issue"})]})]})})]}),e==="chat"&&a.jsxs("div",{className:"bg-white rounded-xl shadow-md mb-8 animate-fade-in overflow-hidden",children:[a.jsxs("div",{className:"bg-green-500 text-white p-4 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-white/20 rounded-full flex items-center justify-center",children:a.jsx(By,{className:"w-5 h-5"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold",children:"Live Chat Support"}),a.jsxs("p",{className:"text-green-100 text-xs flex items-center gap-1",children:[a.jsx("span",{className:"w-2 h-2 bg-green-300 rounded-full animate-pulse"}),"Online - Typically replies in minutes"]})]})]}),a.jsx("button",{onClick:()=>t(null),className:"p-2 hover:bg-white/10 rounded-full transition",children:a.jsx(ea,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"h-80 overflow-y-auto p-4 bg-gray-50 space-y-4",children:[c.map(M=>a.jsx("div",{className:`flex ${M.sender==="user"?"justify-end":"justify-start"}`,children:a.jsxs("div",{className:`flex items-end gap-2 max-w-[80%] ${M.sender==="user"?"flex-row-reverse":""}`,children:[a.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 ${M.sender==="user"?"bg-blue-500 text-white":"bg-green-500 text-white"}`,children:M.sender==="user"?a.jsx(ra,{className:"w-4 h-4"}):a.jsx(By,{className:"w-4 h-4"})}),a.jsxs("div",{className:`px-4 py-2.5 rounded-2xl ${M.sender==="user"?"bg-blue-500 text-white rounded-br-md":"bg-white shadow-sm border border-gray-200 text-gray-700 rounded-bl-md"}`,children:[a.jsx("p",{className:"text-sm",children:M.message}),a.jsx("p",{className:`text-[10px] mt-1 ${M.sender==="user"?"text-blue-100":"text-gray-400"}`,children:E(M.timestamp)})]})]})},M.id)),p&&a.jsx("div",{className:"flex justify-start",children:a.jsxs("div",{className:"flex items-end gap-2",children:[a.jsx("div",{className:"w-8 h-8 rounded-full bg-green-500 text-white flex items-center justify-center",children:a.jsx(By,{className:"w-4 h-4"})}),a.jsx("div",{className:"bg-white shadow-sm border border-gray-200 px-4 py-3 rounded-2xl rounded-bl-md",children:a.jsxs("div",{className:"flex gap-1",children:[a.jsx("span",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),a.jsx("span",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),a.jsx("span",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})})]})}),a.jsx("div",{ref:b})]}),a.jsx("form",{onSubmit:A,className:"p-4 border-t border-gray-200 bg-white",children:a.jsxs("div",{className:"flex gap-3",children:[a.jsx("input",{type:"text",value:d,onChange:M=>h(M.target.value),placeholder:"Type your message...",className:"flex-1 px-4 py-2.5 border border-gray-300 rounded-full focus:ring-2 focus:ring-green-200 focus:border-green-400 outline-none transition"}),a.jsxs("button",{type:"submit",disabled:!d.trim(),className:"px-5 py-2.5 bg-green-500 hover:bg-green-600 text-white rounded-full transition disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[a.jsx(ok,{className:"w-4 h-4"}),a.jsx("span",{className:"hidden sm:inline",children:"Send"})]})]})})]}),!e&&a.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-6 text-center",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Need more help?"}),a.jsx("p",{className:"text-gray-600 mb-4",children:"Contact our support team for personalized assistance"}),a.jsx("div",{className:"flex justify-center gap-4",children:a.jsxs("a",{href:"mailto:support@example.com",className:"inline-flex items-center gap-2 bg-white px-4 py-2 rounded-lg shadow-sm hover:shadow-md transition text-gray-700",children:[a.jsx(VI,{className:"w-4 h-4"}),"Email Support"]})})]})]})}const tFe=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],Qw=e=>String(e).padStart(2,"0"),lf=e=>{if(!e)return null;const t=new Date(e);return Number.isNaN(t.getTime())?null:`${t.getFullYear()}-${Qw(t.getMonth()+1)}-${Qw(t.getDate())}`},oL=e=>new Date(e.getFullYear(),e.getMonth(),1),g8=(e,t)=>new Date(e.getFullYear(),e.getMonth()+t,1),aFe=e=>e.toLocaleDateString("en-US",{month:"long",year:"numeric"}),nFe=e=>{if(!e)return"";const t=new Date(`${e}T00:00:00`);return Number.isNaN(t.getTime())?e:t.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric"})};function $A({className:e,title:t,count:n}){return n?a.jsxs("div",{className:"flex items-center gap-1",title:t,children:[a.jsx("span",{className:`inline-block h-2 w-2 rounded-full ${e}`}),n>1&&a.jsx("span",{className:"text-[10px] text-gray-500",children:n})]}):null}function sFe(e){const t=oL(e),n=t.getMonth(),s=t.getDay(),r=new Date(t.getFullYear(),n+1,0).getDate(),i=[];for(let o=0;o<s;o++)i.push({type:"blank",key:`blank-${o}`});for(let o=1;o<=r;o++){const l=new Date(t.getFullYear(),n,o),c=`${l.getFullYear()}-${Qw(l.getMonth()+1)}-${Qw(l.getDate())}`;i.push({type:"day",key:c,day:o,dateKey:c,date:l})}for(;i.length%7!==0;)i.push({type:"blank",key:`blank-tail-${i.length}`});return i}function M1({basePath:e="",tasks:t=[],meetings:n=[],calls:s=[]}){const r=Et(),[i,o]=f.useState(()=>oL(new Date)),[l,c]=f.useState(()=>lf(new Date)),u=f.useMemo(()=>lf(new Date),[]),d=f.useMemo(()=>{const _=new Map,T=new Map,k=new Map;for(const A of t){const E=lf(A?.due_date??A?.dueDate);if(!E)continue;const M=_.get(E)??[];M.push(A),_.set(E,M)}for(const A of n){const E=lf(A?.start_time??A?.startTime);if(!E)continue;const M=T.get(E)??[];M.push(A),T.set(E,M)}for(const A of s){const E=lf(A?.call_time??A?.callTime);if(!E)continue;const M=k.get(E)??[];M.push(A),k.set(E,M)}return{taskByDay:_,meetingByDay:T,callByDay:k}},[t,n,s]),h=f.useMemo(()=>sFe(i),[i]),p=f.useMemo(()=>{if(!l)return{tasks:[],meetings:[],calls:[]};const _=d.taskByDay.get(l)??[],T=d.meetingByDay.get(l)??[],k=d.callByDay.get(l)??[],A=[...T].sort((F,D)=>{const P=F?.start_time??F?.startTime,B=D?.start_time??D?.startTime,G=P?new Date(P).getTime():0,$=B?new Date(B).getTime():0;return G-$}),E=[...k].sort((F,D)=>{const P=F?.call_time??F?.callTime,B=D?.call_time??D?.callTime,G=P?new Date(P).getTime():0,$=B?new Date(B).getTime():0;return G-$});return{tasks:[..._].sort((F,D)=>{const P=F?.due_date??F?.dueDate,B=D?.due_date??D?.dueDate,G=P?new Date(P).getTime():0,$=B?new Date(B).getTime():0;return G-$}),meetings:A,calls:E}},[l,d]),x=()=>{const _=new Date;o(oL(_)),c(lf(_))},b=f.useMemo(()=>{if(!e)return"";const _=String(e).trim();if(!_)return"";const T=_.startsWith("/")?_:`/${_}`;return T.endsWith("/")?T.slice(0,-1):T},[e]),j=(_,T)=>r(`${b}${_}`,{state:T}),y=()=>l||u,N=()=>{const _=y();j("/tasks",{openTaskModal:!0,initialTaskData:_?{dueDate:_}:void 0})},w=()=>{const _=y(),T=_?`${_}T09:00`:"",k=_?`${_}T10:00`:"";j("/meetings",{openMeetingModal:!0,initialMeetingData:{startTime:T,endTime:k}})},S=()=>{const _=y(),T=_?`${_}T08:00`:"";j("/calls",{openCallModal:!0,initialCallData:{call_time:T}})};return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 min-h-screen",children:[a.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{type:"button",onClick:()=>o(_=>g8(_,-1)),className:"px-3 py-2 rounded-lg bg-white border border-gray-200 text-gray-700 hover:bg-gray-50 cursor-pointer",children:"Prev"}),a.jsx("button",{type:"button",onClick:x,className:"px-3 py-2 rounded-lg bg-white border border-gray-200 text-gray-700 hover:bg-gray-50 cursor-pointer",children:"Today"}),a.jsx("button",{type:"button",onClick:()=>o(_=>g8(_,1)),className:"px-3 py-2 rounded-lg bg-white border border-gray-200 text-gray-700 hover:bg-gray-50 cursor-pointer",children:"Next"}),a.jsx("h2",{className:"ml-2 text-lg sm:text-xl font-semibold text-gray-800",children:aFe(i)})]}),a.jsxs("div",{className:"flex items-center gap-3 text-xs text-gray-600",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"inline-block h-2 w-2 rounded-full bg-red-500"}),a.jsx("span",{children:"Tasks (Due date)"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"inline-block h-2 w-2 rounded-full bg-green-500"}),a.jsx("span",{children:"Meetings"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"inline-block h-2 w-2 rounded-full bg-blue-500"}),a.jsx("span",{children:"Calls"})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[a.jsx("div",{className:"lg:col-span-2",children:a.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden",children:[a.jsx("div",{className:"grid grid-cols-7 bg-gray-50 border-b border-gray-200",children:tFe.map(_=>a.jsx("div",{className:"px-3 py-2 text-xs font-semibold text-gray-600",children:_},_))}),a.jsx("div",{className:"grid grid-cols-7",children:h.map(_=>{if(_.type==="blank")return a.jsx("div",{className:"h-24 border-b border-r border-gray-100 bg-white"},_.key);const T=d.taskByDay.get(_.dateKey)?.length??0,k=d.meetingByDay.get(_.dateKey)?.length??0,A=d.callByDay.get(_.dateKey)?.length??0,E=_.dateKey===l,M=_.dateKey===u;return a.jsxs("button",{type:"button",onClick:()=>c(_.dateKey),className:`h-24 w-full text-left px-2 py-2 border-b border-r border-gray-100 bg-white hover:bg-gray-50 transition cursor-pointer ${E?"ring-2 ring-indigo-500 ring-inset":""}`,children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:`text-sm font-semibold ${M?"text-indigo-700":"text-gray-700"}`,children:_.day}),M&&a.jsx("span",{className:"text-[10px] px-2 py-0.5 rounded-full bg-indigo-100 text-indigo-700",children:"Today"})]}),a.jsxs("div",{className:"mt-2 flex flex-col gap-1",children:[a.jsx($A,{className:"bg-red-500",title:"Tasks due",count:T}),a.jsx($A,{className:"bg-green-500",title:"Meetings",count:k}),a.jsx($A,{className:"bg-blue-500",title:"Calls",count:A})]})]},_.key)})})]})}),a.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-4",children:[a.jsxs("div",{className:"flex items-start justify-between gap-3 mb-3",children:[a.jsx("h3",{className:"font-semibold text-gray-800",children:nFe(l)}),a.jsxs("div",{className:"flex flex-wrap items-center justify-end gap-2",children:[a.jsxs("button",{type:"button",onClick:N,className:"px-2.5 py-1.5 rounded-lg bg-white border border-gray-200 text-xs text-gray-700 hover:bg-gray-50 flex flex-row cursor-pointer",children:[a.jsx(LA,{})," Task"]}),a.jsxs("button",{type:"button",onClick:w,className:"px-2.5 py-1.5 rounded-lg bg-white border border-gray-200 text-xs text-gray-700 hover:bg-gray-50 flex flex-row cursor-pointer",children:[a.jsx(LA,{})," Meeting"]}),a.jsxs("button",{type:"button",onClick:S,className:"px-2.5 py-1.5 rounded-lg bg-white border border-gray-200 text-xs text-gray-700 hover:bg-gray-50 flex flex-row cursor-pointer",children:[a.jsx(LA,{})," Call"]})]})]}),p.tasks.length+p.meetings.length+p.calls.length===0&&a.jsx("div",{className:"mb-3",children:a.jsx("span",{className:"text-xs text-gray-500",children:"No activity"})}),a.jsxs("div",{className:"space-y-3",children:[p.tasks.length>0&&a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 text-sm font-semibold text-gray-800 mb-1",children:[a.jsx("span",{className:"inline-block h-2 w-2 rounded-full bg-red-500"}),a.jsx("span",{children:"Tasks"})]}),a.jsx("div",{className:"space-y-1",children:p.tasks.map(_=>a.jsxs("button",{type:"button",onClick:()=>j("/tasks",{taskID:_.id}),className:"w-full text-left text-sm text-gray-700 flex items-start justify-between gap-3 rounded-lg px-2 py-1 hover:bg-gray-50 cursor-pointer",children:[a.jsx("span",{className:"truncate",children:_?.title??_?.subject??"(Untitled task)"}),a.jsx("span",{className:"text-xs text-gray-500 whitespace-nowrap",children:_?.due_date||_?.dueDate?new Date(_?.due_date??_?.dueDate).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):""})]},`task-${_.id}`))})]}),p.meetings.length>0&&a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 text-sm font-semibold text-gray-800 mb-1",children:[a.jsx("span",{className:"inline-block h-2 w-2 rounded-full bg-green-500"}),a.jsx("span",{children:"Meetings"})]}),a.jsx("div",{className:"space-y-1",children:p.meetings.map(_=>{const T=_?.start_time??_?.startTime,k=_?.end_time??_?.endTime,A=T?new Date(T):null,E=k?new Date(k):null,M=A?`${A.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}${E?`${E.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`:""}`:"";return a.jsxs("button",{type:"button",onClick:()=>j("/meetings",{meetingID:_.id}),className:"w-full text-left text-sm text-gray-700 flex items-start justify-between gap-3 rounded-lg px-2 py-1 hover:bg-gray-50 cursor-pointer",children:[a.jsx("span",{className:"truncate",children:_?.subject??_?.title??"(Untitled meeting)"}),a.jsx("span",{className:"text-xs text-gray-500 whitespace-nowrap",children:M})]},`meeting-${_.id}`)})})]}),p.calls.length>0&&a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 text-sm font-semibold text-gray-800 mb-1",children:[a.jsx("span",{className:"inline-block h-2 w-2 rounded-full bg-blue-500"}),a.jsx("span",{children:"Calls"})]}),a.jsx("div",{className:"space-y-1",children:p.calls.map(_=>{const T=_?.call_time??_?.callTime,k=T?new Date(T):null,A=k?k.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"";return a.jsxs("button",{type:"button",onClick:()=>j("/calls",{callID:_.id}),className:"w-full text-left text-sm text-gray-700 flex items-start justify-between gap-3 rounded-lg px-2 py-1 hover:bg-gray-50 cursor-pointer",children:[a.jsx("span",{className:"truncate",children:_?.subject??_?.title??"(Untitled call)"}),a.jsx("span",{className:"text-xs text-gray-500 whitespace-nowrap",children:A})]},`call-${_.id}`)})})]})]})]})]})]})}function rFe(){const{user:e,loading:t}=Gt(),[n,s]=f.useState(!1),[r,i]=f.useState([]),[o,l]=f.useState([]),[c,u]=f.useState([]);f.useEffect(()=>{document.title="Calendar | Sari-Sari CRM"},[]);const d=async()=>{try{s(!0);const[p,x,b]=await Promise.all([ne.get("/tasks/all"),ne.get("/meetings/admin/fetch-all"),ne.get("/calls/admin/fetch-all")]);i(Array.isArray(p.data)?p.data:[]),l(Array.isArray(x.data)?x.data:[]),u(Array.isArray(b.data)?b.data:[])}catch(p){console.error(p),V.error("Failed to load calendar data.")}finally{s(!1)}};f.useEffect(()=>{!t&&e&&d()},[t,e]);const h=f.useMemo(()=>({tasks:r,meetings:o,calls:c}),[r,o,c]);return a.jsxs("div",{className:"min-h-screen",children:[(n||t)&&a.jsx(qt,{message:"Loading calendar..."}),a.jsx(M1,{basePath:"/admin",...h})]})}function iFe(){const e=Et();f.useEffect(()=>{document.title="Super Admin | Sari-Sari CRM"},[]);const t=async()=>{try{await ne.post("/auth/logout"),V.success("Logged out successfully"),e("/login")}catch(r){console.error("Logout error:",r),V.error("Error logging out")}},n="flex items-center gap-3 px-3 py-2 rounded-lg bg-white text-[#1e293b] font-semibold shadow-sm",s="flex items-center gap-3 px-3 py-2 rounded-lg text-gray-300 hover:bg-[#334155] hover:text-white transition";return a.jsxs("div",{className:"flex h-screen bg-gray-100 overflow-hidden",children:[a.jsxs("div",{className:"w-64 bg-[#1e293b] text-white flex flex-col shadow-lg",children:[a.jsxs("div",{className:"px-4 py-3 bg-[#ef4444] leading-none",children:[a.jsx("p",{className:"text-white font-bold text-lg m-0 p-0",children:"Admin Panel"}),a.jsx("p",{className:"text-[12px] text-red-100 font-medium",children:"System Management"})]}),a.jsx("nav",{className:"flex-1 overflow-y-auto p-4 space-y-2",children:a.jsxs($t,{to:"/super-admin/dashboard",className:({isActive:r})=>r?n:s,children:[a.jsx(sh,{className:"text-lg"}),a.jsx("span",{children:"Tenants Dashboard"})]})}),a.jsx("div",{className:"p-4 border-t border-gray-700",children:a.jsxs("button",{onClick:t,className:"w-full flex items-center gap-3 px-3 py-2 rounded-lg text-gray-300 hover:bg-red-600 hover:text-white transition",children:[a.jsx(loe,{className:"text-lg"}),a.jsx("span",{children:"Logout"})]})})]}),a.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[a.jsxs("header",{className:"bg-white shadow-sm px-6 py-4 flex items-center justify-between",children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Admin Dashboard"}),a.jsx("div",{className:"flex items-center gap-4",children:a.jsx("span",{className:"text-sm text-gray-600",children:"System Administrator"})})]}),a.jsx("main",{className:"flex-1 overflow-y-auto bg-gray-50",children:a.jsx(th,{})})]})]})}const oFe=()=>{const[e,t]=f.useState(null),[n,s]=f.useState([]),[r,i]=f.useState(!0),[o,l]=f.useState(""),[c,u]=f.useState(null),[d,h]=f.useState(!1),[p,x]=f.useState(null),[b,j]=f.useState(null),[y,N]=f.useState("all");f.useEffect(()=>{w(),S(),_(),T()},[]);const w=async()=>{try{const D=await ne.get("/admin/stats");t(D.data)}catch(D){console.error("Error fetching stats:",D),V.error("Failed to load statistics")}},S=async()=>{try{i(!0);const D=await ne.get("/admin/tenants");console.log("Tenants API Response:",D.data),console.log("Number of tenants:",D.data.tenants?.length),s(D.data.tenants||[])}catch(D){console.error("Error fetching tenants:",D),console.error("Error details:",D.response?.data),V.error("Failed to load tenants: "+(D.response?.data?.detail||D.message))}finally{i(!1)}},_=async()=>{try{const D=await ne.get("/admin/subscriptions/alerts");x(D.data)}catch(D){console.error("Error fetching subscription alerts:",D)}},T=async()=>{try{const D=await ne.get("/admin/activity");j(D.data)}catch(D){console.error("Error fetching activity stats:",D)}},k=async D=>{try{const P=await ne.get(`/admin/tenants/${D}`);u(P.data),h(!0)}catch(P){console.error("Error fetching tenant details:",P),V.error("Failed to load tenant details")}},A=async(D,P)=>{try{const B=await ne.patch(`/admin/users/${D}/toggle-status`);V.success(B.data.message),c&&k(c.id),S()}catch(B){console.error("Error toggling user status:",B),V.error(B.response?.data?.detail||"Failed to update user status")}},E=async(D,P)=>{const B=P==="Active"?"Cancelled":"Active";if(window.confirm(`Are you sure you want to ${B==="Cancelled"?"suspend":"activate"} this subscription?`))try{const G=await ne.patch(`/admin/subscriptions/${D}/status`,{status:B});V.success(G.data.message),S(),_(),c&&k(c.id)}catch(G){console.error("Error updating subscription:",G),V.error(G.response?.data?.detail||"Failed to update subscription")}},M=()=>{w(),S(),_(),T(),V.success("Dashboard refreshed")},F=n.filter(D=>{const P=D.company_name.toLowerCase().includes(o.toLowerCase())||D.company_number.toLowerCase().includes(o.toLowerCase());if(y==="all")return P;if(!D.subscription)return y==="expired"?P:!1;const B=new Date(D.subscription.end_date),$=Math.ceil((B-new Date)/(1e3*60*60*24));return y==="active"?P&&D.subscription.status==="Active"&&$>7:y==="expiring"?P&&D.subscription.status==="Active"&&$<=7&&$>0:y==="expired"?P&&(D.subscription.status==="Expired"||$<=0):P});return r&&!e?a.jsx(qt,{}):a.jsxs("div",{className:"min-h-screen bg-gray-50 p-6",children:[a.jsxs("div",{className:"mb-8 flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Admin Dashboard"}),a.jsx("p",{className:"text-gray-600",children:"Manage all tenants and monitor system-wide statistics"})]}),a.jsxs("button",{onClick:M,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:[a.jsx(Br,{})," Refresh"]})]}),e&&a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[a.jsx(Ab,{icon:a.jsx(ac,{className:"w-8 h-8"}),title:"Total Tenants",value:e.total_tenants,bgColor:"bg-blue-500"}),a.jsx(Ab,{icon:a.jsx(Xa,{className:"w-8 h-8"}),title:"Total Users",value:e.total_users,bgColor:"bg-purple-500"}),a.jsx(Ab,{icon:a.jsx(Qi,{className:"w-8 h-8"}),title:"Active Users",value:e.active_users,bgColor:"bg-green-500"}),a.jsx(Ab,{icon:a.jsx(Ki,{className:"w-8 h-8"}),title:"Inactive Users",value:e.inactive_users,bgColor:"bg-red-500"})]}),p&&p.total_alerts>0&&a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-8 border-l-4 border-orange-500",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(Fl,{className:"text-orange-500 w-6 h-6"}),a.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Subscription Alerts"}),a.jsxs("span",{className:"ml-auto bg-orange-100 text-orange-800 px-3 py-1 rounded-full text-sm font-semibold",children:[p.total_alerts," alerts"]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[p.expiring_soon.length>0&&a.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg",children:[a.jsxs("h3",{className:"font-semibold text-yellow-800 mb-2 flex items-center gap-2",children:[a.jsx(Vn,{})," Expiring Soon (",p.expiring_soon.length,")"]}),a.jsx("div",{className:"space-y-2",children:p.expiring_soon.map(D=>a.jsxs("div",{className:"text-sm",children:[a.jsx("p",{className:"font-medium text-gray-800",children:D.company_name}),a.jsxs("p",{className:"text-gray-600",children:[D.plan_name," - ",D.days_remaining," days left"]})]},D.id))})]}),p.expired.length>0&&a.jsxs("div",{className:"bg-red-50 p-4 rounded-lg",children:[a.jsxs("h3",{className:"font-semibold text-red-800 mb-2 flex items-center gap-2",children:[a.jsx(Fl,{})," Expired (",p.expired.length,")"]}),a.jsx("div",{className:"space-y-2",children:p.expired.map(D=>a.jsxs("div",{className:"text-sm",children:[a.jsx("p",{className:"font-medium text-gray-800",children:D.company_name}),a.jsxs("p",{className:"text-gray-600",children:[D.plan_name," - Expired"]})]},D.id))})]})]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6",children:[a.jsxs("h2",{className:"text-xl font-semibold text-gray-800",children:["All Tenants (",F.length,")"]}),a.jsxs("div",{className:"flex flex-col md:flex-row gap-3 w-full md:w-auto",children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:()=>N("all"),className:`px-3 py-1 rounded-lg text-sm font-medium transition ${y==="all"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"All"}),a.jsx("button",{onClick:()=>N("active"),className:`px-3 py-1 rounded-lg text-sm font-medium transition ${y==="active"?"bg-green-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"Active"}),a.jsx("button",{onClick:()=>N("expiring"),className:`px-3 py-1 rounded-lg text-sm font-medium transition ${y==="expiring"?"bg-orange-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"Expiring"}),a.jsx("button",{onClick:()=>N("expired"),className:`px-3 py-1 rounded-lg text-sm font-medium transition ${y==="expired"?"bg-red-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"Expired"})]}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",placeholder:"Search tenants...",value:o,onChange:D=>l(D.target.value),className:"pl-10 pr-10 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent w-full md:w-64"}),a.jsx(Kt,{className:"absolute left-3 top-3 text-gray-400"}),o&&a.jsx("button",{onClick:()=>l(""),className:"absolute right-3 top-3 text-gray-400 hover:text-gray-600",children:a.jsx(ea,{})})]})]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Company"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contact"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Users"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Subscription"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:F.map(D=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center",children:[D.company_logo?a.jsx("img",{src:D.company_logo,alt:D.company_name,className:"h-10 w-10 rounded-full object-cover"}):a.jsx("div",{className:"h-10 w-10 rounded-full bg-blue-500 flex items-center justify-center text-white font-semibold",children:D.company_name.charAt(0)}),a.jsxs("div",{className:"ml-4",children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:D.company_name}),a.jsx("div",{className:"text-sm text-gray-500",children:D.company_number})]})]})}),a.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[a.jsx("div",{className:"text-sm text-gray-900",children:D.company_website||"N/A"}),a.jsx("div",{className:"text-sm text-gray-500",children:D.address||"N/A"})]}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"text-sm text-gray-900",children:[a.jsx("span",{className:"text-green-600",children:D.active_users})," / ",D.total_users]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:D.subscription?a.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${D.subscription.status==="Active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:D.subscription.plan_name}):a.jsx("span",{className:"text-sm text-gray-500",children:"No plan"})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(D.created_at).toLocaleDateString()}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:a.jsxs("button",{onClick:()=>k(D.id),className:"text-blue-600 hover:text-blue-900 flex items-center gap-1",children:[a.jsx(md,{})," View"]})})]},D.id))})]})})]}),d&&c&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex justify-between items-center",children:[a.jsxs("h3",{className:"text-xl font-semibold text-gray-800",children:[c.company_name," Details"]}),a.jsx("button",{onClick:()=>h(!1),className:"text-gray-500 hover:text-gray-700",children:""})]}),a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("h4",{className:"text-lg font-semibold mb-3",children:"Company Information"}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 bg-gray-50 p-4 rounded-lg",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Company Number"}),a.jsx("p",{className:"font-medium",children:c.company_number})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Website"}),a.jsx("p",{className:"font-medium",children:c.company_website||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Address"}),a.jsx("p",{className:"font-medium",children:c.address||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Currency"}),a.jsx("p",{className:"font-medium",children:c.currency})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Tax Rate"}),a.jsxs("p",{className:"font-medium",children:[c.tax_rate,"%"]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Territories"}),a.jsx("p",{className:"font-medium",children:c.territories_count})]})]})]}),c.subscription&&a.jsxs("div",{className:"mb-6",children:[a.jsxs("div",{className:"flex justify-between items-center mb-3",children:[a.jsx("h4",{className:"text-lg font-semibold",children:"Subscription"}),a.jsx("button",{onClick:()=>{const D=c.subscription,P=c.id;E(P,D.status)},className:`px-4 py-2 rounded-lg font-medium text-sm transition ${c.subscription.status==="Active"?"bg-red-100 text-red-700 hover:bg-red-200":"bg-green-100 text-green-700 hover:bg-green-200"}`,children:c.subscription.status==="Active"?" Suspend Subscription":" Activate Subscription"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 bg-gray-50 p-4 rounded-lg",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Plan"}),a.jsx("p",{className:"font-medium",children:c.subscription.plan_name})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Status"}),a.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${c.subscription.status==="Active"?"bg-green-100 text-green-800":c.subscription.status==="Cancelled"?"bg-orange-100 text-orange-800":"bg-red-100 text-red-800"}`,children:c.subscription.status})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Start Date"}),a.jsx("p",{className:"font-medium",children:c.subscription.start_date?new Date(c.subscription.start_date).toLocaleDateString():"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"End Date"}),a.jsx("p",{className:"font-medium",children:c.subscription.end_date?new Date(c.subscription.end_date).toLocaleDateString():"N/A"})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Days Remaining"}),a.jsx("p",{className:`font-medium ${(()=>{const D=Math.ceil((new Date(c.subscription.end_date)-new Date)/864e5);return D<=0?"text-red-600":D<=7?"text-orange-600":"text-green-600"})()}`,children:(()=>{const D=Math.ceil((new Date(c.subscription.end_date)-new Date)/864e5);return D<=0?"Expired":`${D} days`})()})]})]})]}),a.jsxs("div",{children:[a.jsxs("h4",{className:"text-lg font-semibold mb-3",children:["Users (",c.users.length,")"]}),a.jsx("div",{className:"space-y-2",children:c.users.map(D=>a.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("p",{className:"font-medium",children:[D.first_name," ",D.last_name]}),a.jsx("p",{className:"text-sm text-gray-500",children:D.email}),a.jsxs("div",{className:"flex gap-2 mt-1",children:[a.jsx("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded",children:D.role}),D.last_login&&a.jsxs("span",{className:"text-xs text-gray-500",children:["Last login: ",new Date(D.last_login).toLocaleDateString()]})]})]}),a.jsxs("button",{onClick:()=>A(D.id,D.is_active),className:`flex items-center gap-2 px-3 py-2 rounded-lg ${D.is_active?"bg-green-100 text-green-700 hover:bg-green-200":"bg-red-100 text-red-700 hover:bg-red-200"}`,children:[D.is_active?a.jsx(foe,{size:20}):a.jsx(moe,{size:20}),D.is_active?"Active":"Inactive"]})]},D.id))})]})]})]})})]})},Ab=({icon:e,title:t,value:n,bgColor:s})=>a.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-600 mb-1",children:t}),a.jsx("p",{className:"text-3xl font-bold text-gray-800",children:n})]}),a.jsx("div",{className:`${s} text-white p-3 rounded-lg`,children:e})]})});function lFe({toggleSidebar:e}){const[t,n]=f.useState(!1),[s,r]=f.useState(!1),[i,o]=f.useState([]),[l,c]=f.useState(0),u=f.useRef(null),d=f.useRef(null),h=ta(),p=Et(),{logout:x}=Ks(),{user:b,fetchUser:j}=Gt(),N={"/sales/overview":"Dashboard","/sales/accounts":"Accounts","/sales/contacts":"Contacts","/sales/leads":"Leads","/sales/deals":"Deals","/sales/quotes":"Quotes","/sales/targets":"Targets","/sales/reports":"Reports","/sales/tasks":"Tasks"}[h.pathname]||"Sales Panel";f.useEffect(()=>{j();const k=()=>{j()};return window.addEventListener("userProfileUpdated",k),()=>{window.removeEventListener("userProfileUpdated",k)}},[]),f.useEffect(()=>{const k=async()=>{try{const A=await ne.get("/logs/notifications");console.log(" Fetched notifications from DB:",A.data);const E=(A.data||[]).map(M=>{const F=M.entity_id||M.new_data?.id,D=(M.entity_type||"").toLowerCase();return S({id:M.id,type:M.notif_type||M.notification_type||M.type||w(M),title:M.title||M.description,assignedBy:M.assignedBy||M.name,createdAt:M.createdAt||M.timestamp,read:M.is_read??M.read??!1,leadId:D==="lead"?F:M.leadId||M.lead_id,taskId:D==="task"?F:M.taskId||M.task_id,contactId:D==="contact"?F:M.contactId||M.contact_id,dealId:D==="deal"?F:M.dealId||M.deal_id,accountId:D==="account"?F:M.accountId||M.account_id})});o(E),c(E.filter(M=>!M.read).length)}catch(A){console.error("Failed to load history notifications",A)}};b?.id&&k()},[b?.id]);const w=k=>{const A=String(k.action||k.type||"").toUpperCase(),E={TASK_ASSIGNMENT:"task_assignment",LEAD_ASSIGNMENT:"lead_assignment",LEAD_UPDATE:"lead_update",CONTACT_ASSIGNMENT:"contact_assignment",CONTACT_UPDATE:"contact_update",DEAL_ASSIGNMENT:"deal_assignment",DEAL_UPDATE:"deal_update",ACCOUNT_ASSIGNMENT:"account_assignment",ACCOUNT_UPDATE:"account_update",TERRITORY_ASSIGNMENT:"territory_assignment",CREATE:"create",UPDATE:"update",DELETE:"delete"};if(E[A])return E[A];const M=String(k.title||k.description||"").toLowerCase(),F=String(k.entity_type||"").toLowerCase(),D=A.includes("UPDATE"),P=A.includes("CREATE");return A.includes("DELETE"),M.includes("task")||F==="task"?D?"task_update":"task_assignment":M.includes("territory")||F==="territory"?"territory_assignment":M.includes("lead")||F==="lead"?D?"lead_update":P?"lead_assignment":"lead_update":M.includes("contact")||F==="contact"?D?"contact_update":P?"contact_assignment":"contact_update":M.includes("deal")||F==="deal"?D?"deal_update":P?"deal_assignment":"deal_update":M.includes("account")||F==="account"?D?"account_update":P?"account_assignment":"account_update":M.includes("quote")||F==="quote"?"quote":M.includes("meeting")||F==="meeting"?"meeting":M.includes("call")||F==="call"?"call":"info"},S=k=>{const A={...k};switch(A.read=!!A.read,A.type){case"territory_assignment":A.title=A.title||`You have been assigned to ${A.territoryName||"a territory"}`;break;case"lead_assigned":A.type="lead_assignment",A.title=A.title||`New lead assigned: ${A.leadName||A.company||"Lead"}`;break;case"lead_assignment":A.title=A.title||`New lead assigned: ${A.leadName||A.company||"Lead"}`;break;case"lead_update":A.title=A.title||`Lead updated: ${A.leadName||A.company||"Lead"}`;break;case"task_assignment":case"task_update":A.title=A.title||`Task: ${A.taskTitle||"Task"}`;break;case"contact_assignment":A.title=A.title||`New contact assigned: ${A.contactName||A.contact||"Contact"}`;break;case"contact_update":A.title=A.title||`Contact updated: ${A.contactName||A.contact||"Contact"}`;break;case"deal_assignment":A.title=A.title||`New deal assigned: ${A.dealName||A.name||"Deal"}`;break;case"deal_update":A.title=A.title||`Deal updated: ${A.dealName||A.name||"Deal"}`;break;case"account_assignment":A.title=A.title||`New account assigned: ${A.accountName||A.name||"Account"}`;break;case"account_update":A.title=A.title||`Account updated: ${A.accountName||A.name||"Account"}`;break;case"quote":A.title=A.title||"Quote activity";break;case"meeting":A.title=A.title||"Meeting activity";break;case"call":A.title=A.title||"Call activity";break;default:A.title=A.title||"Activity"}return A},_=k=>{switch(k.type){case"task_assignment":p(`/sales/tasks/${k.taskId||k.task_id||""}`);break;case"lead_assignment":case"lead_update":p(`/sales/leads/${k.leadId||k.lead_id||""}`);break;case"contact_assignment":case"contact_update":p(`/sales/contacts/${k.contactId||k.contact_id||""}`);break;case"deal_assignment":case"deal_update":p(`/sales/deals/${k.dealId||k.deal_id||""}`);break;case"account_assignment":case"account_update":p(`/sales/accounts/${k.accountId||k.account_id||""}`);break;default:p("/sales/overview")}},T=async k=>{if(k.read){_(k);return}try{await ne.patch(`/logs/mark-read/${k.id}`),o(A=>A.map(E=>E.id===k.id?{...E,read:!0}:E)),c(A=>A>0?A-1:0),_(k)}catch(A){console.error("Failed to mark notification as read",A),_(k)}};return f.useEffect(()=>{if(!b?.id)return;const k=Fj(b.id);console.log(" Connecting to WebSocket:",k);const A=new WebSocket(k);let E;const M=()=>{E=setTimeout(()=>{console.log(" Attempting WebSocket reconnection...")},3e3)};return A.onopen=()=>{console.log(" Sales WS Connected to:",k),clearTimeout(E)},A.onmessage=F=>{try{const D=JSON.parse(F.data);console.log(" Notification received:",D);const P=S(D);o(B=>[P,...B]),c(B=>B+1)}catch(D){console.error("Error parsing notification:",D)}},A.onclose=()=>{console.log(" Sales WS Disconnected"),M()},A.onerror=F=>{console.error(" Sales WS Error:",F)},()=>{clearTimeout(E),A&&A.readyState===WebSocket.OPEN&&A.close()}},[b?.id]),f.useEffect(()=>{function k(A){u.current&&!u.current.contains(A.target)&&n(!1),d.current&&!d.current.contains(A.target)&&r(!1)}return document.addEventListener("mousedown",k),()=>document.removeEventListener("mousedown",k)},[]),a.jsxs("header",{className:"flex justify-between items-center bg-white shadow px-4 sm:px-6 py-3 border-b relative",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("button",{onClick:e,className:"lg:hidden text-gray-700 hover:text-gray-900",children:a.jsx(rh,{className:"text-2xl"})}),b?.company?.company_logo&&a.jsx("img",{src:b.company.company_logo,alt:"Company Logo",className:"w-20 h-10 object-contain rounded"}),a.jsx("h1",{className:"text-lg sm:text-xl font-semibold text-gray-800 truncate max-w-[150px] sm:max-w-none",children:N})]}),a.jsxs("div",{className:"flex items-center space-x-3 sm:space-x-4",children:[a.jsxs("div",{className:"relative",ref:d,children:[a.jsxs("button",{onClick:()=>r(!s),className:"relative text-gray-600 hover:text-gray-800 transition",children:[a.jsx(gx,{className:"text-xl sm:text-2xl"}),l>0&&a.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-[10px] w-4 h-4 flex items-center justify-center rounded-full font-semibold",children:l})]}),s&&a.jsxs("div",{className:"absolute right-0 mt-3 w-80 bg-white rounded-xl shadow-lg border z-50 overflow-hidden animate-fade-in",children:[a.jsxs("div",{className:"p-3 border-b bg-gray-50 flex justify-between items-center",children:[a.jsx("h3",{className:"font-semibold text-gray-800 text-sm",children:"Notifications"}),i.length>0&&a.jsx("button",{onClick:async()=>{try{await ne.patch("/logs/mark-all-read"),o(k=>k.map(A=>({...A,read:!0}))),c(0)}catch(k){console.error("Failed to mark all notifications as read",k)}},className:"text-xs text-blue-600 hover:underline",children:"Clear all"})]}),a.jsx("div",{className:"max-h-80 overflow-y-auto",children:i.length>0?i.map((k,A)=>a.jsxs("div",{onClick:()=>T(k),className:`p-4 border-b hover:bg-gray-50 cursor-pointer transition ${k.read?"bg-gray-50":"bg-white"}`,children:[a.jsxs("div",{className:"flex justify-between items-center mb-1",children:[a.jsx("span",{className:`text-[10px] px-2 py-1 rounded-full font-semibold uppercase
                            ${k.type==="task_assignment"||k.type==="task_update"?"bg-purple-100 text-purple-700":k.type==="lead_assignment"||k.type==="lead_update"?"bg-green-100 text-green-700":k.type==="contact_assignment"||k.type==="contact_update"?"bg-amber-100 text-amber-700":k.type==="deal_assignment"||k.type==="deal_update"?"bg-indigo-100 text-indigo-700":k.type==="account_assignment"||k.type==="account_update"?"bg-cyan-100 text-cyan-700":k.type==="territory_assignment"?"bg-blue-100 text-blue-700":k.type==="quote"?"bg-pink-100 text-pink-700":k.type==="meeting"?"bg-teal-100 text-teal-700":k.type==="call"?"bg-red-100 text-red-700":k.type==="create"?"bg-emerald-100 text-emerald-700":k.type==="update"?"bg-yellow-100 text-yellow-700":k.type==="delete"?"bg-rose-100 text-rose-700":"bg-gray-100 text-gray-700"}`,children:k.type==="task_assignment"||k.type==="task_update"?"Task":k.type==="lead_assignment"?"Lead":k.type==="lead_update"?"Lead Update":k.type==="contact_assignment"?"Contact":k.type==="contact_update"?"Contact Update":k.type==="deal_assignment"?"Deal":k.type==="deal_update"?"Deal Update":k.type==="account_assignment"?"Account":k.type==="account_update"?"Account Update":k.type==="territory_assignment"?"Territory":k.type==="quote"?"Quote":k.type==="meeting"?"Meeting":k.type==="call"?"Call":k.type==="create"?"Created":k.type==="update"?"Updated":k.type==="delete"?"Deleted":"Activity"}),!k.read&&a.jsx("span",{className:"w-2 h-2 rounded-full bg-red-500"})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"font-medium text-gray-800 text-sm",children:k.title}),a.jsx("span",{className:"text-xs text-gray-600 mt-0.5",children:k.assignedBy?`Assigned by ${k.assignedBy}`:"System"}),a.jsx("span",{className:"text-[11px] text-gray-400 mt-1",children:k.createdAt?new Date(k.createdAt).toLocaleString():""})]})]},k.id??A)):a.jsx("div",{className:"p-6 text-center text-gray-500 text-sm",children:"No new notifications"})})]})]}),a.jsxs("div",{className:"relative",ref:u,children:[a.jsxs("button",{onClick:()=>n(!t),className:"flex items-center gap-2 cursor-pointer hover:bg-gray-100 px-2 py-1 rounded",children:[a.jsx("img",{src:b?.profile_picture||"https://via.placeholder.com/40",alt:"Profile",className:"w-8 aspect-square object-cover rounded-full"}),a.jsxs("span",{className:"hidden lg:inline text-sm font-medium text-gray-700",children:[b?.first_name," ",b?.last_name]})]}),t&&a.jsxs("div",{className:"absolute right-0 mt-2 w-64 bg-white shadow-xl rounded-xl border border-gray-200 z-50 p-4",children:[a.jsxs("div",{className:"flex flex-col items-center text-center space-y-3",children:[a.jsx("img",{src:b?.profile_picture||"https://via.placeholder.com/80",alt:"Profile",className:"w-16 h-16 rounded-full object-cover"}),a.jsxs("div",{children:[a.jsxs("h2",{className:"text-gray-800 font-semibold text-sm",children:[b?.first_name," ",b?.middle_name," ",b?.last_name]}),a.jsx("p",{className:"text-[11px] text-gray-600 font-light w-full truncate",children:"Sales"})]}),b?.company&&a.jsxs("div",{className:"flex items-center gap-2 pt-2 border-t border-gray-100 w-full justify-center",children:[b.company.company_logo&&a.jsx("img",{src:b.company.company_logo,alt:"Company Logo",className:"w-6 h-6 object-contain rounded"}),a.jsx("span",{className:"text-xs text-gray-500 truncate",children:b.company.company_name})]})]}),a.jsxs("div",{className:"mt-4 space-y-1 px-4 text-left",children:[a.jsx("button",{className:"block w-full text-sm text-gray-700 hover:bg-gray-50 py-2 rounded text-left",onClick:()=>{p("/sales/manage-account"),n(!1)},children:"Manage Your Account"}),a.jsx("div",{className:"border-t border-gray-200 my-2"}),a.jsx("button",{onClick:x,className:"block w-full text-sm text-red-600 hover:text-red-700 hover:bg-gray-50 py-2 rounded text-left",children:"Logout"})]})]})]})]})]})}function cFe(){const[e,t]=f.useState(!1),[n,s]=f.useState(!1),{user:r}=Gt(),[i,o]=f.useState(!1);f.useEffect(()=>{r&&console.log("Fetched user:",r)},[r]);const l=["/sales/overview","/sales/hub","/sales/accounts","/sales/contacts","/sales/leads","/sales/deals","/sales/quotes","/sales/targets"],c=ta();l.includes(c.pathname);const u="flex items-center gap-3 px-3 py-2 rounded-lg bg-white text-[#1e293b] font-semibold shadow-sm",d="flex items-center gap-3 px-3 py-2 rounded-lg text-gray-300 hover:bg-[#334155] hover:text-white transition";return a.jsxs("div",{className:"flex h-screen bg-gray-100 overflow-hidden",children:[a.jsxs("div",{className:`fixed top-0 left-0 h-screen w-64 bg-[#1e293b] text-white flex flex-col shadow-lg transform transition-transform duration-300 z-50
        ${e?"translate-x-0":"-translate-x-full"} lg:translate-x-0`,children:[a.jsxs("div",{className:"px-4 py-3 bg-[#fbbf24] leading-none",children:[a.jsxs("p",{className:"text-gray-900 font-bold text-lg m-0 p-0",children:[" Sari-Sari.CRM"," ",a.jsx("span",{className:"text-[12px] text-gray-700 font-medium align-bottom",children:"v2"})]}),r&&r.company&&a.jsx("p",{className:"text-[12px] text-gray-600 font-medium w-full truncate",title:r.company.company_name,children:r.company.slug||r.company.company_name})]}),a.jsxs("nav",{className:"flex-1 overflow-y-auto p-4 space-y-2 hide-scrollbar",children:[a.jsxs($t,{to:"/sales/overview",className:({isActive:h})=>h?u:d,children:[a.jsx(sh,{})," Dashboard"]}),a.jsxs("div",{children:[a.jsxs("button",{className:"w-full px-3 py-2 flex justify-between items-center text-sm font-medium text-gray-300 hover:bg-[#334155] rounded-lg transition",onClick:()=>o(!i),children:[a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx(sa,{className:"text-lg"}),"Sales"]}),a.jsx(Dt,{className:`transition-transform ${i?"rotate-180":""}`})]}),i&&a.jsxs("div",{className:"ml-6 mt-2 space-y-1",children:[a.jsxs($t,{to:"/sales/accounts",className:({isActive:h})=>h?u:d,children:[a.jsx(ac,{})," Accounts"]}),a.jsxs($t,{to:"/sales/contacts",className:({isActive:h})=>h?u:d,children:[a.jsx(ra,{})," Contacts"]}),a.jsxs($t,{to:"/sales/leads",className:({isActive:h})=>h?u:d,children:[a.jsx(rn,{})," Leads"]}),a.jsxs($t,{to:"/sales/deals",className:({isActive:h})=>h?u:d,children:[a.jsx(sa,{})," Deals"]}),a.jsxs($t,{to:"/sales/quotes",className:({isActive:h})=>h?u:d,children:[a.jsx(ia,{})," Quotes"]}),a.jsxs($t,{to:"/sales/targets",className:({isActive:h})=>h?u:d,children:[a.jsx(fr,{})," Targets"]})]})]}),a.jsxs("div",{children:[a.jsxs("button",{className:"w-full px-3 py-2 flex justify-between items-center text-sm font-medium text-gray-300 hover:bg-[#334155] rounded-lg transition",onClick:()=>s(!n),children:[a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx(Ls,{className:"text-lg"}),"Activity"]}),a.jsx(Dt,{className:`transition-transform ${n?"rotate-180":""}`})]}),n&&a.jsxs("div",{className:"ml-6 mt-2 space-y-1",children:[a.jsxs($t,{to:"/sales/calendar",className:({isActive:h})=>h?u:d,children:[a.jsx(Pt,{})," Calendar"]}),a.jsxs($t,{to:"/sales/tasks",className:({isActive:h})=>h?u:d,children:[a.jsx(Qt,{})," Tasks"]}),a.jsxs($t,{to:"/sales/meetings",className:({isActive:h})=>h?u:d,children:[a.jsx(Pt,{})," Meetings"]}),a.jsxs($t,{to:"/sales/calls",className:({isActive:h})=>h?u:d,children:[a.jsx(Us,{})," Calls"]}),a.jsxs($t,{to:"/sales/audit",className:({isActive:h})=>h?u:d,children:[a.jsx(Ls,{})," Audit"]})]})]}),a.jsx("div",{children:a.jsx($t,{to:"/sales/territory",className:({isActive:h})=>h?u:d,children:a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx(tc,{className:"text-lg"}),"Territory"]})})}),a.jsxs($t,{to:"/sales/manage-account",className:({isActive:h})=>h?u:d,children:[a.jsx(ra,{className:"text-lg"}),a.jsx("span",{children:"Your Profile"})]})]}),a.jsxs("div",{className:"px-4 py-3 text-xs text-gray-400 border-t border-gray-700",children:[" ",new Date().getFullYear()," Sari-Sari CRM"]})]}),e&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 lg:hidden",onClick:()=>t(!1)}),a.jsxs("div",{className:"flex-1 flex flex-col lg:ml-64 overflow-hidden",children:[a.jsx(lFe,{toggleSidebar:()=>t(!0)}),a.jsx("main",{className:"flex-1 p-6 overflow-auto hide-scrollbar",style:{backgroundColor:"#fffeee"},children:a.jsx(th,{})})]})]})}const dFe=e=>a.jsx(Kt,{...e}),uFe=e=>a.jsx(ac,{...e}),dJ=e=>a.jsx(Vn,{...e}),uJ=e=>a.jsx(hx,{...e}),mJ=e=>a.jsx(bj,{...e}),mFe=e=>a.jsx(Pt,{...e}),fFe=e=>a.jsx(It,{...e}),hFe=e=>a.jsx(wj,{...e}),fJ=e=>a.jsx(vj,{...e}),gFe=e=>a.jsx(Xa,{...e}),hJ=e=>a.jsx(ra,{...e}),pFe=e=>a.jsx(rn,{...e}),gJ=e=>a.jsx(sa,{...e}),xFe=e=>a.jsx(ia,{...e}),pJ=e=>a.jsx(fr,{...e}),Kw=e=>a.jsx(La,{...e}),Xw=e=>a.jsx(Pt,{...e}),Zw=e=>a.jsx(Us,{...e}),yFe=e=>a.jsx(tc,{...e}),bFe=e=>a.jsx(Ls,{...e}),xJ=(e,t="")=>{const n=parseFloat(e)||0;return new Intl.NumberFormat("en-US",{notation:"compact",compactDisplay:"short",maximumFractionDigits:1}).format(n).replace(/^/,`${t} `)},vFe=e=>{switch(e){case"Negotiation":return{text:"text-purple-700",bg:"bg-purple-100"};case"Proposal":return{text:"text-red-700",bg:"bg-red-100"};case"Qualification":return{text:"text-yellow-700",bg:"bg-yellow-100"};case"Prospecting":return{text:"text-blue-700",bg:"bg-blue-100"};case"Closed Won":return{text:"text-green-700",bg:"bg-green-100"};case"Closed Lost":return{text:"text-red-700",bg:"bg-red-100"};default:return{text:"text-gray-700",bg:"bg-gray-100"}}},wFe=e=>{switch(e){case"Website":return{text:"text-green-600",bg:"bg-green-100"};case"Referral":return{text:"text-purple-600",bg:"bg-purple-100"};case"Trade Show":return{text:"text-orange-600",bg:"bg-orange-100"};case"Cold Call":return{text:"text-red-600",bg:"bg-red-100"};default:return{text:"text-gray-600",bg:"bg-gray-100"}}},jFe=e=>{switch(e){case"call":return{Icon:fFe,color:"text-red-500",bgColor:"bg-red-100"};case"qualification":return{Icon:hFe,color:"text-green-600",bgColor:"bg-green-100"};default:return{Icon:mFe,color:"text-blue-500",bgColor:"bg-blue-100"}}},NFe=e=>{switch(e.toUpperCase()){case"HIGH":return{text:"text-red-700",bg:"bg-red-100"};case"LOW":return{text:"text-blue-700",bg:"bg-blue-100"};default:return{text:"text-gray-700",bg:"bg-gray-100"}}},CFe=({searchQuery:e,onSearchChange:t,searchResults:n,onSearchResultClick:s})=>{const r=Et(),[i,o]=f.useState(!1),l=f.useRef(null),c=[{icon:uFe,label:"Account"},{icon:hJ,label:"Contact"},{icon:pFe,label:"Leads"},{icon:gJ,label:"Deals"},{icon:xFe,label:"Quotes"},{icon:pJ,label:"Target"},{icon:Kw,label:"Task"},{icon:Xw,label:"Meeting"},{icon:Zw,label:"Call"},{icon:bFe,label:"Audit"},{icon:yFe,label:"Territory"}];f.useEffect(()=>{const h=p=>{l.current&&!l.current.contains(p.target)&&o(!1)};return document.addEventListener("mousedown",h),()=>document.removeEventListener("mousedown",h)},[]);const u=h=>{t(h.target.value),o(h.target.value.trim().length>0)},d=h=>{s&&s(h),o(!1)};return a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-3 sm:p-4 flex flex-col items-start space-y-4 w-full",children:[a.jsxs("div",{className:"w-full flex justify-center relative",ref:l,children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg lg:mt-3 px-4 py-2 w-full max-w-md md:max-w-lg lg:max-w-2xl focus-within:ring-2 focus-within:ring-blue-500 transition duration-150",children:[a.jsx(dFe,{size:20,className:"text-gray-400 mr-3 flex-shrink-0"}),a.jsx("input",{type:"text",placeholder:"Search Leads, Deals, or Accounts...",className:"focus:outline-none text-base w-full",value:e,onChange:u,onFocus:()=>e.trim().length>0&&o(!0)})]}),i&&Array.isArray(n)&&n.length>0&&a.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 mt-2 w-full max-w-md md:max-w-lg lg:max-w-2xl bg-white rounded-lg shadow-xl border border-gray-200 z-50 max-h-96 overflow-y-auto",children:n.map((h,p)=>a.jsx("div",{className:"px-4 py-3 hover:bg-gray-50 cursor-pointer border-b border-gray-100 last:border-b-0 transition duration-150",onClick:()=>d(h),children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-semibold text-gray-800 text-sm",children:h.name}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:h.type}),h.details&&a.jsx("p",{className:"text-xs text-gray-400 mt-1",children:h.details})]}),a.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${h.type==="Lead"?"bg-blue-100 text-blue-600":h.type==="Deal"?"bg-yellow-100 text-yellow-600":"bg-green-100 text-green-600"}`,children:h.type})]})},p))}),i&&e.trim().length>0&&(!Array.isArray(n)||n.length===0)&&a.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 mt-2 w-full max-w-md md:max-w-lg lg:max-w-2xl bg-white rounded-lg shadow-xl border border-gray-200 z-50 p-4 text-center text-sm text-gray-500",children:"No results found"})]}),a.jsx("div",{className:"w-full overflow-x-auto lg:overflow-x-hidden scroll-smooth flex justify-center",children:a.jsx("div",{className:"flex flex-nowrap space-x-3 lg:space-x-4 xl:space-x-3 px-2 sm:px-0",children:c.map((h,p)=>a.jsxs("div",{className:"relative flex-shrink-0 group flex items-center justify-center",children:[a.jsx("button",{className:"p-3 text-gray-500 hover:text-gray-900 transition duration-150 rounded-full hover:bg-gray-100 focus:outline-none cursor-pointer","aria-label":h.label,title:h.label,onClick:()=>{switch(h.label){case"Account":r("/sales/accounts");break;case"Contact":r("/sales/contacts");break;case"Leads":r("/sales/leads");break;case"Deals":r("/sales/deals");break;case"Quotes":r("/sales/quotes");break;case"Target":r("/sales/targets");break;case"Task":r("/sales/tasks");break;case"Meeting":r("/sales/meetings");break;case"Call":r("/sales/calls");break;case"Audit":r("/sales/audit");break;case"Territory":r("/sales/territory");break;default:console.log(`Clicked ${h.label}`)}},children:a.jsx(h.icon,{size:24,className:"lg:scale-95"})}),a.jsxs("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 px-3 py-1.5 bg-gray-900 text-white text-xs font-semibold rounded-md whitespace-nowrap opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-75 ease-in-out z-50 shadow-lg",children:[h.label,a.jsx("div",{className:"absolute top-full left-1/2 -translate-x-1/2 -mt-1 border-4 border-transparent border-t-gray-900"})]})]},p))})})]})},SFe=({action:e,description:t,entity_type:n,entity_name:s,timestamp:r})=>{const i=Et(),o=d=>{if(!d)return"Unknown";const h=new Date(d),x=new Date-h,b=Math.floor(x/6e4),j=Math.floor(x/36e5),y=Math.floor(x/864e5);return b<1?"Just now":b<60?`${b} min ago`:j<24?`${j} hour${j>1?"s":""} ago`:y<7?`${y} day${y>1?"s":""} ago`:h.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},l=e||t||"Action",c=s||n||"System",u=o(r);return a.jsxs("li",{className:"flex justify-between items-center py-2 border-b border-gray-100 last:border-b-0 cursor-pointer hover:bg-gray-50 transition duration-150 px-2 -mx-2 rounded-md",onClick:()=>i("/sales/audit"),children:[a.jsxs("p",{className:"text-sm text-gray-800 flex-grow font-medium",children:[l," ",a.jsxs("span",{className:"text-gray-500 italic text-xs",children:["(",c,")"]})]}),a.jsx("span",{className:"text-xs text-gray-400 flex-shrink-0 ml-4",children:u})]})},_Fe=({logs:e,loading:t})=>{const n=Et();return a.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg border border-gray-100 flex flex-col h-full",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h2",{className:"text-md font-semibold text-gray-800",children:"Recent Logs"}),a.jsxs("span",{className:"text-sm text-blue-500 cursor-pointer hover:underline flex items-center space-x-1 font-medium",onClick:()=>n("/sales/audit"),children:[a.jsx("span",{children:"See All"}),a.jsx(fJ,{size:14,className:"transform -rotate-45"})]})]}),e&&e.length>0?a.jsx("ul",{className:"space-y-1",children:e.slice(0,3).map((s,r)=>a.jsx(SFe,{...s},r))}):a.jsx("div",{className:"text-sm text-gray-500 py-4",children:"No recent logs"})]})},AFe=({icon:e,title:t,value:n,color:s,bgColor:r,loading:i,onClick:o})=>a.jsxs("div",{className:"flex items-center p-4 bg-white rounded-xl shadow-md border border-gray-200 transition-all duration-300",onClick:o||(()=>console.log(`Clicked metric card: ${t}`)),children:[a.jsx("div",{className:`p-3 rounded-full ${r} ${s} mr-4`,children:a.jsx(e,{size:20})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-500 font-medium uppercase",children:t}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:n||0})]})]}),TFe=({revenueData:e,loading:t})=>{const n=Et(),s=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],r=f.useMemo(()=>{if(console.log("=== RevenueChart calculateRevenueData ==="),console.log("revenueData:",e),console.log("revenueData length:",e?.length),!e||e.length===0){console.log("No revenue data, returning empty chart");const y=new Date;y.getFullYear();const N=y.getMonth(),w=[],S=[];for(let _=0;_<=N;_++)w.push(s[_]),S.push(0);return{labels:w,revenues:S,maxRevenue:0}}const l={};let c=0,u=0;console.log("Processing deals:",e.length),e.forEach((y,N)=>{const w=y.close_date||y.closeDate||null,S=w&&w!==null&&w!=="",_=y.stage||"",T=_.toUpperCase()==="CLOSED_WON"||_==="CLOSED_WON";let k=y.amount;k&&typeof k=="object"&&k.toString?k=parseFloat(k.toString()):k=parseFloat(k)||0;const A=k>0;if(T&&(u++,console.log(`Deal ${N+1} (CLOSED_WON):`,{id:y.id,name:y.name,stage:_,close_date:w,close_date_type:typeof w,amount:k,amount_type:typeof y.amount,hasCloseDate:S,hasAmount:A,willBeAdded:S&&A,allFields:Object.keys(y)})),S&&T&&A)try{let E=new Date(w);if(isNaN(E.getTime())){const M=String(w).split("T")[0];E=new Date(M+"T00:00:00")}if(isNaN(E.getTime()))console.warn(` Invalid date for deal ${y.id}:`,w,"Type:",typeof w);else{const M=E.getFullYear(),F=E.getMonth()+1,D=`${M}-${String(F).padStart(2,"0")}`;l[D]||(l[D]=0),l[D]+=k,c++,console.log(` Added deal ${y.id} to month ${D}: ${k}, total: ${l[D]}`),console.log(`  - Close date: ${w} -> Parsed: ${E.toISOString()} -> Month: ${D} (Year: ${M}, Month: ${F})`)}}catch(E){console.error("Error parsing deal date:",w,E)}else T&&console.warn(` Deal ${y.id} is CLOSED_WON but missing data:`,{hasCloseDate:S,hasAmount:A,closeDate:w,amount:k,originalAmount:y.amount})}),console.log("Summary:",{totalDeals:e.length,closedWonDeals:u,validDealsForGraph:c,monthlyRevenue:l});const d=Object.keys(l).map(y=>parseInt(y.split("-")[0])),h=d.length>0?[...new Set(d)].sort():[],p=new Date().getFullYear();new Date().getMonth();const x=[],b=[];for(let y=0;y<12;y++){const N=`${p}-${String(y+1).padStart(2,"0")}`;x.push(s[y]);const w=l[N]||0;b.push(w),w>0&&console.log(`Month ${s[y]} (${N}): ${w}`)}if(h.length>0){const y=Math.max(...h);if(y>p)for(let N=p+1;N<=y;N++)for(let w=0;w<12;w++){const S=`${N}-${String(w+1).padStart(2,"0")}`,_=l[S]||0;x.push(`${s[w]} ${N}`),b.push(_),_>0&&console.log(`Month ${s[w]} ${N} (${S}): ${_}`)}}const j=Math.max(...b,1);return console.log("Final chart data:",{labels:x,revenues:b,maxRevenue:j,hasData:b.some(y=>y>0)}),{labels:x,revenues:b,maxRevenue:j}},[e]),i=r.labels,o=r.revenues;return console.log("=== FINAL CHART DATA ==="),console.log("X Axis (Months):",i),console.log("Y Axis (Revenue):",o),console.log("Has any revenue > 0:",o.some(l=>l>0)),console.log("All revenue values:",o),console.log("Max revenue:",r.maxRevenue),a.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg h-full flex flex-col",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Revenue Overview"}),a.jsxs("span",{className:"text-sm text-blue-500 cursor-pointer hover:underline flex items-center space-x-1 font-medium",onClick:()=>n("/sales/deals"),children:[a.jsx("span",{children:"See All"}),a.jsx(fJ,{size:14,className:"transform -rotate-45"})]})]}),a.jsx("div",{className:"h-80 relative flex-1 flex items-center justify-center p-6",children:a.jsx("div",{className:"w-full h-full flex items-center justify-center",children:i&&i.length>0&&o&&o.length>0?a.jsx(mh,{xAxis:[{data:i,scaleType:"point"}],yAxis:[{valueFormatter:l=>l>=1e3?`${(l/1e3).toFixed(0)}k`:l.toString()}],series:[{data:o,showMark:!0,area:!0}],height:320,width:void 0,grid:{vertical:!0,horizontal:!0},margin:{top:40,right:40,bottom:50,left:50},sx:{width:"100%",maxWidth:"100%"}}):a.jsxs("div",{className:"text-center text-gray-500",children:[a.jsx("p",{className:"text-sm",children:"No revenue data available"}),a.jsx("p",{className:"text-xs mt-2",children:"Closed won deals with close dates will appear here"})]})})})]})},kFe=({activityData:e,loading:t})=>{const[n,s]=f.useState(!0),[r,i]=f.useState(!0),[o,l]=f.useState(!0),[c,u]=f.useState(!0),[d,h]=f.useState("monthly"),p=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],x=["Q1","Q2","Q3","Q4"],b=$=>{const W=[0,0,0,0];for(let Z=0;Z<12;Z++){const Q=Math.floor(Z/3);W[Q]+=$[Z]}return W},j=$=>[$.reduce((W,Z)=>W+Z,0)],y=f.useMemo(()=>{if(!e){const Ae=new Array(12).fill(0),pe=new Array(4).fill(0),Ie=new Array(1).fill(0);return{labels:d==="monthly"?p:d==="quarterly"?x:[new Date().getFullYear().toString()],tasksCurrentYear:d==="monthly"?Ae:d==="quarterly"?pe:Ie,tasksLastYear:d==="monthly"?Ae:d==="quarterly"?pe:Ie,meetingsCurrentYear:d==="monthly"?Ae:d==="quarterly"?pe:Ie,meetingsLastYear:d==="monthly"?Ae:d==="quarterly"?pe:Ie,callsCurrentYear:d==="monthly"?Ae:d==="quarterly"?pe:Ie,callsLastYear:d==="monthly"?Ae:d==="quarterly"?pe:Ie}}const $=e.tasks?.currentYear||new Array(12).fill(0),W=e.tasks?.lastYear||new Array(12).fill(0),Z=e.meetings?.currentYear||new Array(12).fill(0),Q=e.meetings?.lastYear||new Array(12).fill(0),le=e.calls?.currentYear||new Array(12).fill(0),we=e.calls?.lastYear||new Array(12).fill(0);let J,se,ye,Ce,ge,be,me;return d==="monthly"?(J=p,se=$,ye=W,Ce=Z,ge=Q,be=le,me=we):d==="quarterly"?(J=x,se=b($),ye=b(W),Ce=b(Z),ge=b(Q),be=b(le),me=b(we)):(J=[new Date().getFullYear().toString()],se=j($),ye=j(W),Ce=j(Z),ge=j(Q),be=j(le),me=j(we)),{labels:J,tasksCurrentYear:se,tasksLastYear:ye,meetingsCurrentYear:Ce,meetingsLastYear:ge,callsCurrentYear:be,callsLastYear:me}},[e,d]),N=y.tasksCurrentYear.some($=>$>0)||y.tasksLastYear.some($=>$>0)||y.meetingsCurrentYear.some($=>$>0)||y.meetingsLastYear.some($=>$>0)||y.callsCurrentYear.some($=>$>0)||y.callsLastYear.some($=>$>0),w=y.tasksCurrentYear.reduce(($,W)=>$+W,0),S=y.meetingsCurrentYear.reduce(($,W)=>$+W,0),_=y.callsCurrentYear.reduce(($,W)=>$+W,0),T=w+S+_,k=y.tasksLastYear.reduce(($,W)=>$+W,0),A=y.meetingsLastYear.reduce(($,W)=>$+W,0),E=y.callsLastYear.reduce(($,W)=>$+W,0),M=k+A+E,F=M>0?((T-M)/M*100).toFixed(1):0,D=k>0?((w-k)/k*100).toFixed(0):w>0?100:0,P=A>0?((S-A)/A*100).toFixed(0):S>0?100:0,B=E>0?((_-E)/E*100).toFixed(0):_>0?100:0,G=[];return n&&(G.push({data:y.tasksCurrentYear,label:`Tasks ${new Date().getFullYear()}`,color:"#10b981",showMark:!0,curve:"catmullRom"}),c&&G.push({data:y.tasksLastYear,label:`Tasks ${new Date().getFullYear()-1}`,color:"#86efac",showMark:!1,curve:"linear"})),r&&(G.push({data:y.meetingsCurrentYear,label:`Meetings ${new Date().getFullYear()}`,color:"#14b8a6",showMark:!0,curve:"catmullRom"}),c&&G.push({data:y.meetingsLastYear,label:`Meetings ${new Date().getFullYear()-1}`,color:"#5eead4",showMark:!1,curve:"linear"})),o&&(G.push({data:y.callsCurrentYear,label:`Calls ${new Date().getFullYear()}`,color:"#6366f1",showMark:!0,curve:"catmullRom"}),c&&G.push({data:y.callsLastYear,label:`Calls ${new Date().getFullYear()-1}`,color:"#a5b4fc",showMark:!1,curve:"linear"})),a.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg border border-gray-100 flex flex-col h-full",children:[a.jsxs("div",{className:"flex justify-between items-start mb-4",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("h2",{className:"text-lg font-semibold text-gray-800 flex items-center",children:["My Activities",N&&a.jsxs("span",{className:`ml-3 text-sm font-medium px-2 py-1 rounded-full ${F>=0?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:[F>=0?"":""," ",Math.abs(F),"%"]})]}),a.jsxs("select",{value:d,onChange:$=>h($.target.value),className:"text-xs px-3 py-1.5 rounded-lg border border-gray-300 bg-white text-gray-700 font-medium focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 cursor-pointer",children:[a.jsx("option",{value:"monthly",children:"Monthly"}),a.jsx("option",{value:"quarterly",children:"Quarterly"}),a.jsx("option",{value:"yearly",children:"Yearly"})]})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Track your productivity across tasks, meetings & calls"})]}),N&&a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"text-3xl font-bold text-gray-800",children:T}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Total this year"})]})]}),N&&a.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-4",children:[a.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 p-3 rounded-lg border border-green-200",children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsx(Kw,{size:16,className:"text-green-600"}),D!==0&&a.jsxs("span",{className:`text-xs font-semibold ${D>=0?"text-green-700":"text-red-600"}`,children:[D>=0?"+":"",D,"%"]})]}),a.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Tasks"}),a.jsx("p",{className:"text-xl font-bold text-green-700",children:w}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["vs ",k," last year"]})]}),a.jsxs("div",{className:"bg-gradient-to-br from-teal-50 to-teal-100 p-3 rounded-lg border border-teal-200",children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsx(Xw,{size:16,className:"text-teal-600"}),P!==0&&a.jsxs("span",{className:`text-xs font-semibold ${P>=0?"text-teal-700":"text-red-600"}`,children:[P>=0?"+":"",P,"%"]})]}),a.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Meetings"}),a.jsx("p",{className:"text-xl font-bold text-teal-700",children:S}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["vs ",A," last year"]})]}),a.jsxs("div",{className:"bg-gradient-to-br from-indigo-50 to-indigo-100 p-3 rounded-lg border border-indigo-200",children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsx(Zw,{size:16,className:"text-indigo-600"}),B!==0&&a.jsxs("span",{className:`text-xs font-semibold ${B>=0?"text-indigo-700":"text-red-600"}`,children:[B>=0?"+":"",B,"%"]})]}),a.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Calls"}),a.jsx("p",{className:"text-xl font-bold text-indigo-700",children:_}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["vs ",E," last year"]})]})]}),N&&a.jsxs("div",{className:"flex flex-wrap gap-2 mb-4 pb-4 border-b border-gray-100",children:[a.jsxs("button",{onClick:()=>s(!n),className:`text-xs px-3 py-1.5 rounded-full font-medium transition-all ${n?"bg-green-100 text-green-700 border-2 border-green-300":"bg-gray-100 text-gray-500 border-2 border-gray-200"}`,children:[a.jsx(Kw,{size:12,className:"inline mr-1"}),"Tasks"]}),a.jsxs("button",{onClick:()=>i(!r),className:`text-xs px-3 py-1.5 rounded-full font-medium transition-all ${r?"bg-teal-100 text-teal-700 border-2 border-teal-300":"bg-gray-100 text-gray-500 border-2 border-gray-200"}`,children:[a.jsx(Xw,{size:12,className:"inline mr-1"}),"Meetings"]}),a.jsxs("button",{onClick:()=>l(!o),className:`text-xs px-3 py-1.5 rounded-full font-medium transition-all ${o?"bg-indigo-100 text-indigo-700 border-2 border-indigo-300":"bg-gray-100 text-gray-500 border-2 border-gray-200"}`,children:[a.jsx(Zw,{size:12,className:"inline mr-1"}),"Calls"]}),a.jsxs("button",{onClick:()=>u(!c),className:`text-xs px-3 py-1.5 rounded-full font-medium transition-all ml-auto ${c?"bg-gray-200 text-gray-700 border-2 border-gray-300":"bg-gray-100 text-gray-500 border-2 border-gray-200"}`,children:["Compare vs ",new Date().getFullYear()-1]})]}),a.jsx("div",{className:"flex-grow min-h-[320px]",children:t?a.jsx("div",{className:"flex items-center justify-center h-full",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):N&&G.length>0?a.jsx(mh,{xAxis:[{scaleType:"point",data:y.labels}],series:G,height:320,width:void 0,grid:{vertical:!1,horizontal:!0},margin:{top:10,right:10,bottom:40,left:50},sx:{width:"100%",maxWidth:"100%","& .MuiLineElement-root":{strokeWidth:2.5},"& .MuiMarkElement-root":{scale:"0.8"}}}):N&&G.length===0?a.jsx("div",{className:"text-center text-gray-500 flex items-center justify-center h-full",children:a.jsxs("div",{children:[a.jsx(La,{size:48,className:"mx-auto mb-3 text-gray-300"}),a.jsx("p",{className:"text-sm font-medium",children:"Select at least one activity type"}),a.jsx("p",{className:"text-xs mt-2",children:"Toggle the filters above to view data"})]})}):a.jsx("div",{className:"text-center text-gray-500 flex items-center justify-center h-full",children:a.jsxs("div",{children:[a.jsx(La,{size:48,className:"mx-auto mb-3 text-gray-300"}),a.jsx("p",{className:"text-sm font-medium",children:"No completed activities yet"}),a.jsx("p",{className:"text-xs mt-2 text-gray-400",children:"Complete tasks, meetings, or calls to track your productivity"})]})})})]})},EFe=({comparisonData:e,loading:t})=>{const[n,s]=f.useState(!0),[r,i]=f.useState(!0),[o,l]=f.useState(!0),[c,u]=f.useState(!0),[d,h]=f.useState(!0),[p,x]=f.useState("monthly"),b=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],j=["Q1","Q2","Q3","Q4"],y=we=>{const J=[0,0,0,0];for(let se=0;se<12;se++){const ye=Math.floor(se/3);J[ye]+=we[se]}return J},N=we=>[we.reduce((J,se)=>J+se,0)],w=f.useMemo(()=>{if(!e){const st=new Array(12).fill(0),it=new Array(4).fill(0),ot=new Array(1).fill(0);return{labels:p==="monthly"?b:p==="quarterly"?j:[new Date().getFullYear().toString()],dealsCurrentYear:p==="monthly"?st:p==="quarterly"?it:ot,dealsLastYear:p==="monthly"?st:p==="quarterly"?it:ot,accountsCurrentYear:p==="monthly"?st:p==="quarterly"?it:ot,accountsLastYear:p==="monthly"?st:p==="quarterly"?it:ot,contactsCurrentYear:p==="monthly"?st:p==="quarterly"?it:ot,contactsLastYear:p==="monthly"?st:p==="quarterly"?it:ot,leadsCurrentYear:p==="monthly"?st:p==="quarterly"?it:ot,leadsLastYear:p==="monthly"?st:p==="quarterly"?it:ot}}const we=e.deals?.currentYear||new Array(12).fill(0),J=e.deals?.lastYear||new Array(12).fill(0),se=e.accounts?.currentYear||new Array(12).fill(0),ye=e.accounts?.lastYear||new Array(12).fill(0),Ce=e.contacts?.currentYear||new Array(12).fill(0),ge=e.contacts?.lastYear||new Array(12).fill(0),be=e.leads?.currentYear||new Array(12).fill(0),me=e.leads?.lastYear||new Array(12).fill(0);let Ae,pe,Ie,xe,he,Re,Ee,He,Ke;return p==="monthly"?(Ae=b,pe=we,Ie=J,xe=se,he=ye,Re=Ce,Ee=ge,He=be,Ke=me):p==="quarterly"?(Ae=j,pe=y(we),Ie=y(J),xe=y(se),he=y(ye),Re=y(Ce),Ee=y(ge),He=y(be),Ke=y(me)):(Ae=[new Date().getFullYear().toString()],pe=N(we),Ie=N(J),xe=N(se),he=N(ye),Re=N(Ce),Ee=N(ge),He=N(be),Ke=N(me)),{labels:Ae,dealsCurrentYear:pe,dealsLastYear:Ie,accountsCurrentYear:xe,accountsLastYear:he,contactsCurrentYear:Re,contactsLastYear:Ee,leadsCurrentYear:He,leadsLastYear:Ke}},[e,p]),S=w.dealsCurrentYear.some(we=>we>0)||w.dealsLastYear.some(we=>we>0)||w.accountsCurrentYear.some(we=>we>0)||w.accountsLastYear.some(we=>we>0)||w.contactsCurrentYear.some(we=>we>0)||w.contactsLastYear.some(we=>we>0)||w.leadsCurrentYear.some(we=>we>0)||w.leadsLastYear.some(we=>we>0),_=w.dealsCurrentYear.reduce((we,J)=>we+J,0),T=w.accountsCurrentYear.reduce((we,J)=>we+J,0),k=w.contactsCurrentYear.reduce((we,J)=>we+J,0),A=w.leadsCurrentYear.reduce((we,J)=>we+J,0),E=_+T+k+A,M=w.dealsLastYear.reduce((we,J)=>we+J,0),F=w.accountsLastYear.reduce((we,J)=>we+J,0),D=w.contactsLastYear.reduce((we,J)=>we+J,0),P=w.leadsLastYear.reduce((we,J)=>we+J,0),B=M+F+D+P,G=B>0?((E-B)/B*100).toFixed(1):0,$=M>0?((_-M)/M*100).toFixed(0):_>0?100:0,W=F>0?((T-F)/F*100).toFixed(0):T>0?100:0,Z=D>0?((k-D)/D*100).toFixed(0):k>0?100:0,Q=P>0?((A-P)/P*100).toFixed(0):A>0?100:0,le=[];return n&&(le.push({data:w.dealsCurrentYear,label:`Deals ${new Date().getFullYear()}`,color:"#f59e0b",showMark:!0,curve:"catmullRom"}),d&&le.push({data:w.dealsLastYear,label:`Deals ${new Date().getFullYear()-1}`,color:"#fcd34d",showMark:!1,curve:"linear"})),r&&(le.push({data:w.accountsCurrentYear,label:`Accounts ${new Date().getFullYear()}`,color:"#3b82f6",showMark:!0,curve:"catmullRom"}),d&&le.push({data:w.accountsLastYear,label:`Accounts ${new Date().getFullYear()-1}`,color:"#93c5fd",showMark:!1,curve:"linear"})),o&&(le.push({data:w.contactsCurrentYear,label:`Contacts ${new Date().getFullYear()}`,color:"#8b5cf6",showMark:!0,curve:"catmullRom"}),d&&le.push({data:w.contactsLastYear,label:`Contacts ${new Date().getFullYear()-1}`,color:"#c4b5fd",showMark:!1,curve:"linear"})),c&&(le.push({data:w.leadsCurrentYear,label:`Leads ${new Date().getFullYear()}`,color:"#10b981",showMark:!0,curve:"catmullRom"}),d&&le.push({data:w.leadsLastYear,label:`Leads ${new Date().getFullYear()-1}`,color:"#6ee7b7",showMark:!1,curve:"linear"})),a.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg border border-gray-100 flex flex-col h-full",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-800 flex items-center",children:["Growth Comparison",a.jsxs("span",{className:"ml-2 text-xs font-normal text-gray-500",children:["(",p.charAt(0).toUpperCase()+p.slice(1),")"]})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Compare deals, accounts, contacts, and leads creation"})]}),S&&B>0&&a.jsxs("div",{className:`text-sm font-semibold ${G>=0?"text-green-600":"text-red-600"}`,children:[G>=0?a.jsx(uJ,{className:"inline mr-1",size:16}):a.jsx(mJ,{className:"inline mr-1",size:16}),G>=0?"+":"",G,"%"]})]}),a.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[a.jsx("button",{onClick:()=>x("monthly"),className:`text-xs px-3 py-1.5 rounded-full font-medium transition-all ${p==="monthly"?"bg-blue-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"Monthly"}),a.jsx("button",{onClick:()=>x("quarterly"),className:`text-xs px-3 py-1.5 rounded-full font-medium transition-all ${p==="quarterly"?"bg-blue-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"Quarterly"}),a.jsx("button",{onClick:()=>x("yearly"),className:`text-xs px-3 py-1.5 rounded-full font-medium transition-all ${p==="yearly"?"bg-blue-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"Yearly"})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-4",children:[a.jsxs("button",{onClick:()=>s(!n),className:`text-xs px-3 py-1.5 rounded-full font-medium transition-all flex items-center ${n?"bg-amber-100 text-amber-700 border-2 border-amber-300":"bg-gray-100 text-gray-500 border-2 border-gray-200"}`,children:[a.jsx("span",{className:"mr-1.5",children:"Deals"}),a.jsx("span",{className:"font-bold",children:_}),M>0&&a.jsxs("span",{className:`ml-1.5 text-[10px] ${$>=0?"text-green-600":"text-red-600"}`,children:["(",$>=0?"+":"",$,"%)"]})]}),a.jsxs("button",{onClick:()=>i(!r),className:`text-xs px-3 py-1.5 rounded-full font-medium transition-all flex items-center ${r?"bg-blue-100 text-blue-700 border-2 border-blue-300":"bg-gray-100 text-gray-500 border-2 border-gray-200"}`,children:[a.jsx("span",{className:"mr-1.5",children:"Accounts"}),a.jsx("span",{className:"font-bold",children:T}),F>0&&a.jsxs("span",{className:`ml-1.5 text-[10px] ${W>=0?"text-green-600":"text-red-600"}`,children:["(",W>=0?"+":"",W,"%)"]})]}),a.jsxs("button",{onClick:()=>l(!o),className:`text-xs px-3 py-1.5 rounded-full font-medium transition-all flex items-center ${o?"bg-purple-100 text-purple-700 border-2 border-purple-300":"bg-gray-100 text-gray-500 border-2 border-gray-200"}`,children:[a.jsx("span",{className:"mr-1.5",children:"Contacts"}),a.jsx("span",{className:"font-bold",children:k}),D>0&&a.jsxs("span",{className:`ml-1.5 text-[10px] ${Z>=0?"text-green-600":"text-red-600"}`,children:["(",Z>=0?"+":"",Z,"%)"]})]}),a.jsxs("button",{onClick:()=>u(!c),className:`text-xs px-3 py-1.5 rounded-full font-medium transition-all flex items-center ${c?"bg-green-100 text-green-700 border-2 border-green-300":"bg-gray-100 text-gray-500 border-2 border-gray-200"}`,children:[a.jsx("span",{className:"mr-1.5",children:"Leads"}),a.jsx("span",{className:"font-bold",children:A}),P>0&&a.jsxs("span",{className:`ml-1.5 text-[10px] ${Q>=0?"text-green-600":"text-red-600"}`,children:["(",Q>=0?"+":"",Q,"%)"]})]}),B>0&&a.jsxs("button",{onClick:()=>h(!d),className:`text-xs px-3 py-1.5 rounded-full font-medium transition-all ml-auto ${d?"bg-gray-200 text-gray-700 border-2 border-gray-300":"bg-gray-100 text-gray-500 border-2 border-gray-200"}`,children:["Compare vs ",new Date().getFullYear()-1]})]}),a.jsx("div",{className:"flex-grow min-h-[320px]",children:t?a.jsx("div",{className:"flex items-center justify-center h-full",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):S&&le.length>0?a.jsx(mh,{xAxis:[{scaleType:"point",data:w.labels}],series:le,height:320,width:void 0,grid:{vertical:!1,horizontal:!0},margin:{top:10,right:10,bottom:40,left:50},sx:{width:"100%",maxWidth:"100%","& .MuiLineElement-root":{strokeWidth:2.5},"& .MuiMarkElement-root":{scale:"0.8"}}}):S&&le.length===0?a.jsx("div",{className:"text-center text-gray-500 flex items-center justify-center h-full",children:a.jsxs("div",{children:[a.jsx(La,{size:48,className:"mx-auto mb-3 text-gray-300"}),a.jsx("p",{className:"text-sm font-medium",children:"Select at least one entity type"}),a.jsx("p",{className:"text-xs mt-2",children:"Toggle the filters above to view data"})]})}):a.jsx("div",{className:"text-center text-gray-500 flex items-center justify-center h-full",children:a.jsxs("div",{children:[a.jsx(La,{size:48,className:"mx-auto mb-3 text-gray-300"}),a.jsx("p",{className:"text-sm font-medium",children:"No data yet"}),a.jsx("p",{className:"text-xs mt-2 text-gray-400",children:"Start creating deals, accounts, contacts, and leads to track growth"})]})})})]})},RA=({title:e,items:t,children:n,onSeeAll:s})=>{const r=Et(),i=()=>{if(s)s();else{const o={"Latest Leads":"/sales/leads","Latest Deals":"/sales/deals","Upcoming Activities":"/sales/tasks"};o[e]&&r(o[e])}};return a.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg flex flex-col",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:e}),a.jsx("span",{className:"text-sm text-blue-500 cursor-pointer hover:underline",onClick:i,children:"See All"})]}),n]})},LFe=({first_name:e,last_name:t,company_name:n,source:s,created_at:r,id:i})=>{const o=Et(),{text:l,bg:c}=wFe(s||"Website"),u=x=>{if(!x)return"Unknown";const b=new Date(x),y=new Date-b,N=Math.floor(y/6e4),w=Math.floor(y/36e5),S=Math.floor(y/864e5);return N<60?`${N} min ago`:w<24?b.toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}):S<7?b.toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}):b.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})},d=`${e||""} ${t||""}`.trim()||"Unknown",h=n||"Unknown Company",p=u(r);return a.jsx("div",{className:"py-3 border-b border-gray-100 last:border-b-0 cursor-pointer hover:bg-gray-50 transition duration-150 px-2 -mx-2 rounded-md",onClick:()=>i&&o(`/sales/leads/${i}`),children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-gray-800",children:d}),a.jsx("p",{className:"text-xs text-gray-500",children:h})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"text-xs text-gray-400",children:p}),a.jsx("span",{className:`inline-block mt-1 text-xs font-medium ${l} ${c} px-2 py-0.5 rounded-full`,children:s||"Website"})]})]})})},DFe=({name:e,amount:t,account:n,stage:s,created_at:r,id:i,previousAmount:o,currencySymbol:l})=>{const c=Et(),d={PROSPECTING:"Prospecting",QUALIFICATION:"Qualification",PROPOSAL:"Proposal",NEGOTIATION:"Negotiation",CLOSED_WON:"Closed Won",CLOSED_LOST:"Closed Lost"}[s]||s||"Unknown",{text:h,bg:p}=vFe(d),x=parseFloat(t||0),b=o?x>=o?"up":"down":"up",j=b==="up"?uJ:mJ,y=b==="up"?"text-green-400":"text-red-400",N=n?.name||"Unknown Company";return a.jsx("div",{className:"py-3 border-b border-gray-100 last:border-b-0 cursor-pointer hover:bg-gray-50 transition duration-150 px-2 -mx-2 rounded-md",onClick:()=>i&&c(`/sales/deals/info?id=${i}`),children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{className:"flex-shrink",children:[a.jsx("p",{className:"font-semibold text-sm text-gray-900",children:e||"Unnamed Deal"}),a.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:N}),a.jsx("span",{className:`inline-block mt-1 text-xs font-medium ${h} ${p} px-2 py-0.5 rounded-full`,children:d})]}),a.jsxs("div",{className:"text-right flex flex-col items-end flex-shrink-0",children:[a.jsx("p",{className:"text-md font-bold text-gray-800",children:xJ(x,l)}),a.jsx(j,{size:16,className:`${y} mt-1`})]})]})})},PFe=({type:e,title:t,assignedTo:n,dueDate:s,scheduledDate:r,priority:i,id:o,activityType:l,fullData:c})=>{const u=Et(),h=l||{Call:"call",Meeting:"meeting",Task:"qualification"}[e]||"meeting",{Icon:p,color:x,bgColor:b}=jFe(h),{text:j,bg:y}=NFe(i||"MEDIUM"),S=(k=>{if(!k)return"No date set";const A=new Date(k),M=A-new Date,F=Math.floor(M/864e5);return F===0?`Today, ${A.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}`:F===1?`Tomorrow, ${A.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}`:F===-1?`Yesterday, ${A.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}`:A.toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})})(s||r),_=n||"Unassigned",T=()=>{o&&(c?h==="call"?(sessionStorage.setItem("callDetailData",JSON.stringify(c)),u(`/sales/calls/info?id=${o}`)):h==="meeting"?(sessionStorage.setItem("meetingDetailData",JSON.stringify(c)),u(`/sales/meetings/info?id=${o}`)):u("/sales/tasks"):u(h==="call"?`/sales/calls/info?id=${o}`:h==="meeting"?`/sales/meetings/info?id=${o}`:"/sales/tasks"))};return a.jsxs("div",{className:"flex items-start py-3 border-b border-gray-100 last:border-b-0 cursor-pointer hover:bg-gray-50 transition duration-150 px-2 -mx-2 rounded-md",onClick:T,children:[a.jsx("div",{className:`p-2 rounded-lg ${b} mr-3 flex-shrink-0 mt-1`,children:a.jsx(p,{size:20,className:`${x}`})}),a.jsxs("div",{className:"flex-grow",children:[a.jsxs("p",{className:"font-medium text-gray-800 flex items-center mb-1",children:[a.jsx("span",{className:"text-xl leading-none mr-2",children:""}),t||"Untitled Activity"]}),a.jsxs("div",{className:"space-y-1 text-xs text-gray-500",children:[a.jsxs("p",{className:"flex items-center",children:[a.jsx(dJ,{size:14,className:"mr-1.5 text-gray-400"}),S]}),a.jsxs("p",{className:"flex items-center",children:[a.jsx(hJ,{size:14,className:"mr-1.5 text-gray-400"}),"Assigned to: ",_]})]})]}),a.jsx("span",{className:`inline-block text-xs font-medium ${j} ${y} px-2 py-0.5 rounded-full flex-shrink-0 self-center ml-4`,children:(i||"MEDIUM").toUpperCase()})]})},OFe=()=>{const e=Et(),{user:t}=Gt(),n=t?.company?.currency||"",[s,r]=f.useState({activeLeads:0,totalDeals:0,activeAccounts:0,overdueTasks:0,completedTasks:0,completedMeetings:0,completedCalls:0}),[i,o]=f.useState([]),[l,c]=f.useState([]),[u,d]=f.useState([]),[h,p]=f.useState([]),[x,b]=f.useState([]),[j,y]=f.useState([]),[N,w]=f.useState({tasks:{currentYear:new Array(12).fill(0),lastYear:new Array(12).fill(0)},meetings:{currentYear:new Array(12).fill(0),lastYear:new Array(12).fill(0)},calls:{currentYear:new Array(12).fill(0),lastYear:new Array(12).fill(0)}}),[S,_]=f.useState(!0),[T,k]=f.useState(null),[A,E]=f.useState(""),[M,F]=f.useState([]),[D,P]=f.useState([]),[B,G]=f.useState([]),[$,W]=f.useState([]),[Z,Q]=f.useState({deals:{currentYear:new Array(12).fill(0),lastYear:new Array(12).fill(0)},accounts:{currentYear:new Array(12).fill(0),lastYear:new Array(12).fill(0)},contacts:{currentYear:new Array(12).fill(0),lastYear:new Array(12).fill(0)},leads:{currentYear:new Array(12).fill(0),lastYear:new Array(12).fill(0)}}),[le,we]=f.useState([]),[J,se]=f.useState(0),[ye,Ce]=f.useState(new Date),ge=f.useRef(null),be=f.useRef(null),me=f.useMemo(()=>{try{if(!A.trim())return[];const xe=A.toLowerCase().trim(),he=[];return Array.isArray(M)&&M.forEach(Re=>{const Ee=`${Re.first_name||""} ${Re.last_name||""}`.trim().toLowerCase(),He=(Re.company_name||"").toLowerCase(),Ke=(Re.email||"").toLowerCase(),st=(Re.phone||"").toLowerCase();(Ee.includes(xe)||He.includes(xe)||Ke.includes(xe)||st.includes(xe))&&he.push({id:Re.id,name:`${Re.first_name||""} ${Re.last_name||""}`.trim()||"Unnamed Lead",type:"Lead",details:Re.company_name||"No company",route:`/sales/leads/${Re.id}`})}),Array.isArray(D)&&D.forEach(Re=>{const Ee=(Re.name||"").toLowerCase(),He=(Re.account?.name||"").toLowerCase(),Ke=(Re.description||"").toLowerCase();(Ee.includes(xe)||He.includes(xe)||Ke.includes(xe))&&he.push({id:Re.id,name:Re.name||"Unnamed Deal",type:"Deal",details:Re.account?.name||"No account",route:`/sales/deals/info?id=${Re.id}`})}),Array.isArray(B)&&B.forEach(Re=>{const Ee=(Re.name||"").toLowerCase(),He=(Re.email||"").toLowerCase(),Ke=(Re.phone||"").toLowerCase(),st=(Re.website||"").toLowerCase();(Ee.includes(xe)||He.includes(xe)||Ke.includes(xe)||st.includes(xe))&&he.push({id:Re.id,name:Re.name||"Unnamed Account",type:"Account",details:Re.email||Re.phone||"No contact info",route:"/sales/accounts"})}),Array.isArray($)&&$.forEach(Re=>{const Ee=(Re.first_name||"").toLowerCase(),He=(Re.last_name||"").toLowerCase(),Ke=`${Ee} ${He}`.trim(),st=(Re.email||"").toLowerCase(),it=(Re.phone||"").toLowerCase();(Ke.includes(xe)||Ee.includes(xe)||He.includes(xe)||st.includes(xe)||it.includes(xe))&&he.push({id:Re.id,name:Ke||"Unnamed Contact",type:"Contact",details:Re.email||Re.phone||"No contact info",route:"/sales/contacts"})}),he.slice(0,10)}catch(xe){return console.error("Error in search:",xe),[]}},[A,M,D,B,$]),Ae=xe=>{xe.route&&(e(xe.route),E(""))},pe=f.useCallback(async()=>{_(!0),k(null);try{const[xe,he,Re,Ee,He,Ke,st,it,ot]=await Promise.all([ne.get("/leads/admin/getLeads").catch(Be=>(console.error("Error fetching leads:",Be),{data:[]})),ne.get("/deals/admin/fetch-all").catch(Be=>(console.error("Error fetching deals:",Be),{data:[]})),ne.get("/accounts/admin/fetch-all").catch(Be=>(console.error("Error fetching accounts:",Be),{data:[]})),ne.get("/contacts/admin/fetch-all").catch(Be=>(console.error("Error fetching contacts:",Be),{data:[]})),ne.get("/tasks/all").catch(Be=>(console.error("Error fetching tasks:",Be),{data:[]})),ne.get("/meetings/admin/fetch-all").catch(Be=>(console.error("Error fetching meetings:",Be),{data:[]})),ne.get("/calls/admin/fetch-all").catch(Be=>(console.error("Error fetching calls:",Be),{data:[]})),ne.get("/logs/read-all").catch(Be=>(console.error("Error fetching logs:",Be),{data:[]})),ne.get("/targets/admin/fetch-all").catch(Be=>(console.error("Error fetching targets:",Be),{data:[]}))]),rt=Array.isArray(xe.data)?xe.data:[],at=Array.isArray(he.data)?he.data:[],Je=Array.isArray(Re.data)?Re.data:[],Fe=Array.isArray(Ee.data)?Ee.data:[],Ue=Array.isArray(He.data)?He.data:[],Ne=Array.isArray(Ke.data)?Ke.data:[],ze=Array.isArray(st.data)?st.data:[],je=Array.isArray(it.data)?it.data:[],ve=Array.isArray(ot.data)?ot.data:[];console.log("=== RAW DEALS API RESPONSE ==="),console.log("Deals count:",at.length),at.length>0&&(console.log("First deal sample (raw):",JSON.stringify(at[0],null,2)),console.log("First deal keys:",Object.keys(at[0]))),F(rt),P(at),G(Je),W(Fe),we(ve);const z=ve.reduce((Be,ce)=>{const fe=ce.amount||ce.value||ce.target_amount||0,H=parseFloat(typeof fe=="string"?fe.replace(/[^\d.-]/g,""):fe);return Be+(Number.isFinite(H)?H:0)},0);se(z);const K=rt.filter(Be=>Be.status&&!["Lost","Converted"].includes(Be.status)).length,ue=Ue.filter(Be=>!Be.dueDate||Be.status==="Completed"?!1:new Date(Be.dueDate)<new Date).length,re=Ue.filter(Be=>(Be.status||"").toLowerCase()==="completed").length,Le=Ne.filter(Be=>{const ce=(Be.status||"").toUpperCase();return ce==="COMPLETED"||ce==="DONE"}).length,De=ze.filter(Be=>{const ce=(Be.status||"").toUpperCase();return ce==="COMPLETED"||ce==="HELD"}).length;r({activeLeads:K,totalDeals:at.length,activeAccounts:Je.length,overdueTasks:ue,completedTasks:re,completedMeetings:Le,completedCalls:De});const Qe=[...rt].sort((Be,ce)=>new Date(ce.created_at||0)-new Date(Be.created_at||0)).slice(0,5);o(Qe);const tt=[...at].sort((Be,ce)=>new Date(ce.created_at||0)-new Date(Be.created_at||0)).slice(0,5);c(tt);const Me=new Date,et=[];ze.forEach(Be=>{const ce=Be.due_date||Be.call_time,fe=(Be.status||"").toUpperCase();if(ce){const H=new Date(ce);fe==="COMPLETED"||fe==="MISSED"||fe==="NOT_HELD"||fe==="HELD"||et.push({type:"Call",title:Be.subject||"Untitled Call",assignedTo:Be.assigned_to||(Be.call_assign_to?`${Be.call_assign_to.first_name||""} ${Be.call_assign_to.last_name||""}`.trim():"Unassigned"),scheduledDate:ce,priority:(Be.priority||"MEDIUM").toUpperCase(),id:Be.id,activityType:"call",fullData:Be})}}),Ne.forEach(Be=>{const ce=Be.dueDate||Be.start_time,fe=(Be.status||"").toUpperCase();if(ce){const H=new Date(ce);fe==="COMPLETED"||fe==="CANCELLED"||fe==="DONE"||et.push({type:"Meeting",title:Be.subject||Be.activity||"Untitled Meeting",assignedTo:Be.assignedTo||(Be.meet_assign_to?`${Be.meet_assign_to.first_name||""} ${Be.meet_assign_to.last_name||""}`.trim():"Unassigned"),scheduledDate:ce,priority:(Be.priority||"MEDIUM").toUpperCase(),id:Be.id,activityType:"meeting",fullData:Be})}});const yt={HIGH:1,MEDIUM:2,LOW:3},_t=et.sort((Be,ce)=>{const fe=yt[Be.priority]||3,H=yt[ce.priority]||3;if(fe!==H)return fe-H;const te=new Date(Be.scheduledDate||0),q=new Date(ce.scheduledDate||0);return te-q}).slice(0,5);d(_t),p(at),w((()=>{const Be=new Date().getFullYear(),ce=Be-1,fe=new Array(12).fill(0),H=new Array(12).fill(0),te=new Array(12).fill(0),q=new Array(12).fill(0),Y=new Array(12).fill(0),U=new Array(12).fill(0);console.log("=== MY ACTIVITIES DEBUG ==="),console.log("Total tasks:",Ue.length),console.log("Total meetings:",Ne.length),console.log("Total calls:",ze.length);let de=0,Te=0,ie=0;return Ue.forEach((Oe,X)=>{if(X===0&&console.log("Sample task:",{id:Oe.id,status:Oe.status,due_date:Oe.due_date,updated_at:Oe.updated_at}),(Oe.status||"").toLowerCase()!=="completed")return;de++;const Pe=Oe.completedAt||Oe.completed_at||Oe.updatedAt||Oe.updated_at||Oe.dueDate||Oe.due_date;if(Pe)try{const Ve=new Date(Pe);if(isNaN(Ve.getTime()))return;const ft=Ve.getFullYear(),St=Ve.getMonth();ft===Be?fe[St]++:ft===ce&&H[St]++}catch(Ve){console.error("Error parsing task date:",Ve)}}),Ne.forEach((Oe,X)=>{X===0&&console.log("Sample meeting:",{id:Oe.id,status:Oe.status,dueDate:Oe.dueDate,updated_at:Oe.updated_at});const oe=(Oe.status||"").toUpperCase();if(oe!=="COMPLETED"&&oe!=="DONE")return;Te++;const Pe=Oe.completedAt||Oe.completed_at||Oe.updatedAt||Oe.updated_at||Oe.dueDate||Oe.start_time;if(Pe)try{const Ve=new Date(Pe);if(isNaN(Ve.getTime()))return;const ft=Ve.getFullYear(),St=Ve.getMonth();ft===Be?te[St]++:ft===ce&&q[St]++}catch(Ve){console.error("Error parsing meeting date:",Ve)}}),ze.forEach((Oe,X)=>{X===0&&console.log("Sample call:",{id:Oe.id,status:Oe.status,due_date:Oe.due_date,updated_at:Oe.updated_at});const oe=(Oe.status||"").toUpperCase();if(oe!=="COMPLETED"&&oe!=="HELD")return;ie++;const Pe=Oe.completedAt||Oe.completed_at||Oe.updatedAt||Oe.updated_at||Oe.due_date||Oe.call_time;if(Pe)try{const Ve=new Date(Pe);if(isNaN(Ve.getTime()))return;const ft=Ve.getFullYear(),St=Ve.getMonth();ft===Be?Y[St]++:ft===ce&&U[St]++}catch(Ve){console.error("Error parsing call date:",Ve)}}),console.log("Activities summary:",{completedTasks:de,completedMeetings:Te,completedCalls:ie,tasksCurrentYear:fe,tasksLastYear:H,meetingsCurrentYear:te,meetingsLastYear:q,callsCurrentYear:Y,callsLastYear:U}),{tasks:{currentYear:fe,lastYear:H},meetings:{currentYear:te,lastYear:q},calls:{currentYear:Y,lastYear:U}}})()),Q((()=>{const Be=new Date().getFullYear(),ce=Be-1,fe=new Array(12).fill(0),H=new Array(12).fill(0),te=new Array(12).fill(0),q=new Array(12).fill(0),Y=new Array(12).fill(0),U=new Array(12).fill(0),de=new Array(12).fill(0),Te=new Array(12).fill(0);return at.forEach(ie=>{const Oe=ie.created_at||ie.createdAt;if(Oe)try{const X=new Date(Oe);if(isNaN(X.getTime()))return;const oe=X.getFullYear(),Pe=X.getMonth();oe===Be?fe[Pe]++:oe===ce&&H[Pe]++}catch(X){console.error("Error parsing deal date:",X)}}),Je.forEach(ie=>{const Oe=ie.created_at||ie.createdAt;if(Oe)try{const X=new Date(Oe);if(isNaN(X.getTime()))return;const oe=X.getFullYear(),Pe=X.getMonth();oe===Be?te[Pe]++:oe===ce&&q[Pe]++}catch(X){console.error("Error parsing account date:",X)}}),Fe.forEach(ie=>{const Oe=ie.created_at||ie.createdAt;if(Oe)try{const X=new Date(Oe);if(isNaN(X.getTime()))return;const oe=X.getFullYear(),Pe=X.getMonth();oe===Be?Y[Pe]++:oe===ce&&U[Pe]++}catch(X){console.error("Error parsing contact date:",X)}}),rt.forEach(ie=>{const Oe=ie.created_at||ie.createdAt;if(Oe)try{const X=new Date(Oe);if(isNaN(X.getTime()))return;const oe=X.getFullYear(),Pe=X.getMonth();oe===Be?de[Pe]++:oe===ce&&Te[Pe]++}catch(X){console.error("Error parsing lead date:",X)}}),console.log("Comparison data summary:",{dealsCurrentYear:fe,dealsLastYear:H,accountsCurrentYear:te,accountsLastYear:q,contactsCurrentYear:Y,contactsLastYear:U,leadsCurrentYear:de,leadsLastYear:Te}),{deals:{currentYear:fe,lastYear:H},accounts:{currentYear:te,lastYear:q},contacts:{currentYear:Y,lastYear:U},leads:{currentYear:de,lastYear:Te}}})()),console.log("=== ALL DEALS DATA ==="),console.log("Total deals:",at.length);const At=at.filter(Be=>(Be.stage||"").toUpperCase()==="CLOSED_WON");console.log("CLOSED_WON deals:",At.length),At.length>0?(console.log("=== CLOSED_WON DEALS DETAILS ==="),At.forEach((Be,ce)=>{let fe=Be.amount;fe&&typeof fe=="object"?fe.toString?fe=parseFloat(fe.toString()):fe=parseFloat(fe):fe=parseFloat(fe)||0,console.log(`Deal ${ce+1}:`,{id:Be.id,name:Be.name,stage:Be.stage,stage_upper:(Be.stage||"").toUpperCase(),amount:Be.amount,amount_parsed:fe,amount_type:typeof Be.amount,close_date:Be.close_date,close_date_type:typeof Be.close_date,close_date_value:Be.close_date?new Date(Be.close_date):null,has_close_date:!!Be.close_date,has_amount:fe>0,all_keys:Object.keys(Be),full_deal:Be})})):(console.log(" No CLOSED_WON deals found!"),console.log("All deal stages:",at.map(Be=>Be.stage))),y(at);const Ge=[...je].sort((Be,ce)=>new Date(ce.timestamp||0)-new Date(Be.timestamp||0));b(Ge)}catch(xe){console.error("Error fetching dashboard data:",xe),k("Failed to load dashboard data. Please refresh the page.")}finally{_(!1)}},[]);f.useEffect(()=>(document.title="Dashboard | Sari-Sari CRM",console.log("SalesOverview mounted, fetching data..."),pe(),ge.current=setInterval(()=>{console.log("Auto-refreshing dashboard data..."),pe(),Ce(new Date)},3e4),()=>{ge.current&&clearInterval(ge.current)}),[pe]),f.useEffect(()=>{if(!t||!t.id)return;let xe=0;const he=3;let Re=null;const Ee=()=>{const He=window.location.protocol==="https:"?"wss:":"ws:",Ke=window.location.hostname==="localhost"?"localhost:8000":window.location.host,st=`${He}//${Ke}/ws/notifications?user_id=${t.id}`;try{const it=new WebSocket(st);be.current=it,it.onopen=()=>{console.log(" WebSocket connected for dashboard updates"),xe=0},it.onmessage=ot=>{try{const rt=JSON.parse(ot.data);console.log(" Real-time notification received:",rt),rt.event&&["new_task","task_updated","new_lead","lead_updated","new_deal","deal_updated","new_account","account_updated","new_meeting","meeting_updated","new_call","call_updated"].includes(rt.event)&&(console.log(" Refreshing dashboard due to:",rt.event),pe(),Ce(new Date))}catch(rt){console.error("Error parsing WebSocket message:",rt)}},it.onerror=ot=>{xe===0&&console.warn(" WebSocket connection unavailable (this is optional)")},it.onclose=()=>{xe<he&&(xe++,Re=setTimeout(()=>{t&&t.id&&Ee()},5e3))}}catch{console.warn(" WebSocket not available (optional feature)")}};return Ee(),()=>{Re&&clearTimeout(Re),be.current&&(be.current.close(),be.current=null)}},[t,pe]);const Ie=[{icon:gFe,title:"Active Leads",value:s.activeLeads,color:"text-blue-600",bgColor:"bg-blue-50",onClick:()=>e("/sales/leads")},{icon:pJ,title:"Total Targets",value:xJ(J,n),color:"text-purple-600",bgColor:"bg-purple-50",onClick:()=>e("/sales/targets")},{icon:gJ,title:"Total Deals",value:s.totalDeals,color:"text-yellow-600",bgColor:"bg-yellow-50",onClick:()=>e("/sales/deals")},{icon:dJ,title:"Overdue Tasks",value:s.overdueTasks,color:"text-red-600",bgColor:"bg-red-50",onClick:()=>e("/sales/tasks")},{icon:Kw,title:"Completed Tasks",value:s.completedTasks,color:"text-green-600",bgColor:"bg-green-50",onClick:()=>e("/sales/tasks")},{icon:Xw,title:"Completed Meetings",value:s.completedMeetings,color:"text-teal-600",bgColor:"bg-teal-50",onClick:()=>e("/sales/meetings")},{icon:Zw,title:"Completed Calls",value:s.completedCalls,color:"text-indigo-600",bgColor:"bg-indigo-50",onClick:()=>e("/sales/calls")}];return console.log("SalesOverview rendering, loading:",S,"error:",T),a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative w-full",children:[S&&a.jsx(qt,{}),a.jsxs("div",{className:"max-w-screen-2xl mx-auto",children:[T&&a.jsx("div",{className:"mb-6 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:a.jsx("p",{className:"font-medium",children:T})}),a.jsx("div",{className:"mb-8",children:a.jsx(CFe,{searchQuery:A,onSearchChange:E,searchResults:me,onSearchResultClick:Ae})}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-7 gap-4 mb-8",children:Ie.map(xe=>a.jsx(AFe,{...xe,loading:S},xe.title))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[a.jsx(_Fe,{logs:x,loading:S}),a.jsx(kFe,{activityData:N,loading:S})]}),a.jsx("div",{className:"mb-8",children:a.jsx(IN,{leads:M,deals:D,targets:le,currencySymbol:n,basePath:"/sales",currentUser:t})}),a.jsx("div",{className:"grid grid-cols-1 mb-8",children:a.jsx(TFe,{revenueData:j,loading:S})}),a.jsx("div",{className:"grid grid-cols-1 mb-8",children:a.jsx(EFe,{comparisonData:Z,loading:S})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[a.jsx(RA,{title:"Latest Leads",children:i.length>0?i.map((xe,he)=>a.jsx(LFe,{...xe},xe.id||he)):a.jsx("div",{className:"text-sm text-gray-500 py-4 text-center",children:"No leads found"})}),a.jsx(RA,{title:"Latest Deals",children:S?a.jsxs("div",{className:"flex flex-col items-center justify-center py-8",children:[a.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-500 mb-2"}),a.jsx("div",{className:"text-sm text-gray-500",children:"Loading deals..."})]}):l.length>0?l.map((xe,he)=>a.jsx(DFe,{...xe,currencySymbol:n},xe.id||he)):a.jsx("div",{className:"text-sm text-gray-500 py-4 text-center",children:"No deals found"})}),a.jsx(RA,{title:"Upcoming Activities",children:u.length>0?u.map((xe,he)=>a.jsx(PFe,{...xe},xe.id||he)):a.jsx("div",{className:"text-sm text-gray-500 py-4 text-center",children:"No upcoming activities"})})]})]})]})},zA=[{value:"CUSTOMER",label:"Customer"},{value:"PROSPECT",label:"Prospect"},{value:"PARTNER",label:"Partner"},{value:"ACTIVE",label:"Vendor"},{value:"INACTIVE",label:"Inactive"},{value:"FORMER",label:"Delete"}],Tb={name:"",website:"",phone_number:"",billing_address:"",shipping_address:"",industry:"",parent_company:"",status:"PROSPECT",territory_id:"",assigned_to:""},Or=e=>e?e.toUpperCase():"",FA=e=>e?e.toString().toLowerCase().replace(/\b\w/g,t=>t.toUpperCase()):"--",MFe=e=>{switch(Or(e)){case"CUSTOMER":return"bg-green-600 text-white";case"PROSPECT":return"bg-purple-600 text-white";case"PARTNER":return"bg-pink-600 text-white";case"ACTIVE":return"bg-blue-600 text-white";case"INACTIVE":return"bg-gray-600 text-white";case"FORMER":return"bg-orange-600 text-white";default:return"bg-gray-500 text-white"}},IFe=e=>{switch(Or(e)){case"CUSTOMER":return"bg-green-100 text-green-700";case"PROSPECT":return"bg-purple-100 text-purple-700";case"PARTNER":return"bg-pink-100 text-pink-700";case"ACTIVE":return"bg-blue-100 text-blue-700";case"INACTIVE":return"bg-gray-200 text-gray-700";case"FORMER":return"bg-orange-100 text-orange-700";default:return"bg-gray-100 text-gray-700"}};function $Fe(){const e=Et(),t=ta(),{user:n}=Gt(),s=n?.role==="Sales";f.useEffect(()=>{document.title="Accounts | Sari-Sari CRM"},[]);const[r,i]=f.useState(!1),[o,l]=f.useState(!1),[c,u]=f.useState(!1),[d,h]=f.useState(null),[p,x]=f.useState(null),[b,j]=f.useState(Tb),[y,N]=f.useState(null),[w,S]=f.useState([]),[_,T]=f.useState(!1),[k,A]=f.useState([]),[E,M]=f.useState(null),[F,D]=f.useState([]),[P,B]=f.useState([]),[G,$]=f.useState("Filter by Status"),[W,Z]=f.useState(""),[Q,le]=f.useState(null),[we,J]=f.useState(!1),[se,ye]=f.useState(1),[Ce,ge]=f.useState(10),[be,me]=f.useState("Overview"),[Ae,pe]=f.useState(""),[Ie,xe]=f.useState(!1),[he,Re]=f.useState([]),[Ee,He]=f.useState({}),[Ke,st]=f.useState(null);f.useEffect(()=>{r&&!o&&s&&n&&!b.assigned_to&&(j(I=>({...I,assigned_to:n.id})),M(n))},[r,o,s,n,b.assigned_to]);const{comments:it,addComment:ot,refresh:rt}=kn({relatedType:"account",relatedId:y?.id});f.useEffect(()=>{y?.id&&rt()},[y?.id,rt]);const at=f.useCallback(async(I=null)=>{T(!0);try{const L=await ne.get("/accounts/admin/fetch-all"),ke=[...Array.isArray(L.data)?L.data:[]].sort(($e,We)=>{const mt=$e?.created_at||$e?.updated_at||0,Tt=We?.created_at||We?.updated_at||0;return new Date(Tt)-new Date(mt)});if(S(ke),I){const $e=ke.find(We=>We.id===I);N($e||null)}}catch(L){console.error(L),S([]),L.response?.status===403?V.error("Permission denied. Only CEO, Admin, or Group Manager can access this page."):V.error("Failed to fetch accounts. Please try again later.")}finally{T(!1)}},[N]),Je=f.useCallback(async()=>{try{const I=await ne.get("/users/all");A(Array.isArray(I.data)?I.data:[])}catch(I){console.error(I),I.response?.status===403&&V.warn("Unable to load users for assignment (permission denied).")}},[]),Fe=f.useCallback(async()=>{try{const I=await ne.get("/territories/fetch");D(Array.isArray(I.data)?I.data:[])}catch(I){console.error(I),I.response?.status===403&&V.warn("Unable to load territories (permission denied).")}},[]),Ue=f.useCallback(async()=>{try{const I=await ne.get("/accounts/admin/parent-companies");B(Array.isArray(I.data)?I.data:[])}catch(I){console.error(I),I.response?.status===403&&V.warn("Unable to load parent companies (permission denied).")}},[]),Ne=f.useCallback(async I=>{try{const L=await ne.get(`/activities/accounts/${I}`);He(L.data&&typeof L.data=="object"?L.data:{})}catch(L){console.error(L),L.response?.status===404&&(console.warn("No activities found for this account."),He({}))}},[]);f.useEffect(()=>{at(),Je(),Fe(),Ue()},[at,Je,Fe,Ue]),f.useEffect(()=>{y&&pe(Or(y.status)||"PROSPECT")},[y]);const ze=f.useMemo(()=>{const I=W.trim().toLowerCase(),L=G.trim().toUpperCase();return w.filter(ee=>{if(!(n?.role==="Admin"||n?.role==="CEO"||n?.role==="MANAGER"||n?.role==="GROUP MANAGER")&&ee.status?.toUpperCase()==="INACTIVE")return!1;const $e=[ee?.name,ee?.website,ee?.industry,ee?.territory?.name,ee?.phone_number],We=I===""||$e.some(Tt=>Tt==null?!1:Tt.toString().toLowerCase().includes(I)),mt=L==="FILTER BY STATUS"||Or(ee.status)===L;return We&&mt})},[w,W,G,n]),je=f.useMemo(()=>ze.length,[ze]),ve=f.useMemo(()=>ze.filter(I=>I.status?.toLowerCase()==="customer").length,[ze]),z=f.useMemo(()=>ze.filter(I=>I.status?.toLowerCase()==="prospect").length,[ze]),K=f.useMemo(()=>ze.filter(I=>I.status?.toLowerCase()==="partner").length,[ze]),ue=f.useMemo(()=>ze.filter(I=>I.status?.toLowerCase()==="active").length,[ze]),re=f.useMemo(()=>ze.filter(I=>I.status?.toLowerCase()==="inactive").length,[ze]),Le=f.useMemo(()=>ze.filter(I=>I.status?.toLowerCase()==="former").length,[ze]),De=f.useMemo(()=>[{title:"Total",value:je,icon:Xa,color:"text-slate-600",bgColor:"bg-slate-100"},{title:"Customers",value:ve,icon:Qi,color:"text-green-600",bgColor:"bg-green-100"},{title:"Prospects",value:z,icon:rn,color:"text-purple-600",bgColor:"bg-purple-100"},{title:"Partners",value:K,icon:ra,color:"text-pink-600",bgColor:"bg-pink-100"},{title:"Active",value:ue,icon:Qi,color:"text-blue-600",bgColor:"bg-blue-100"},{title:"Inactive",value:re,icon:Ki,color:"text-gray-600",bgColor:"bg-gray-100"},{title:"Former",value:Le,icon:Ki,color:"text-orange-600",bgColor:"bg-orange-100"}],[je,ve,z,K,ue,re,Le]),Qe=Math.max(1,Math.ceil(ze.length/Ce)||1);f.useEffect(()=>{ye(1)},[W,G]),f.useEffect(()=>{ye(I=>{const L=Math.max(1,Math.ceil(ze.length/Ce)||1);return I>L?L:I})},[ze.length,Ce]);const tt=f.useMemo(()=>{const I=(se-1)*Ce;return ze.slice(I,I+Ce)},[ze,se,Ce]),Me=I=>{if(I.target.checked){const L=tt.filter(ee=>ee.assigned_accs?.id===n?.id&&ee.acc_creator?.id===n?.id).map(ee=>ee.id);Re(L)}else Re([])},et=I=>{Re(L=>L.includes(I)?L.filter(ee=>ee!==I):[...L,I])},yt=async()=>{if(he.length===0)return;const I=n?.role==="Admin"||n?.role==="CEO"||n?.role==="MANAGER"||n?.role==="GROUP MANAGER",L=I?"delete":"archive",ee=I?"This action cannot be undone.":"These accounts will be hidden from your view but admins can still see them.",ke=!I;le({title:`${L.charAt(0).toUpperCase()+L.slice(1)} Accounts`,message:a.jsxs("span",{children:["Are you sure you want to ",L," ",a.jsx("span",{className:"font-semibold",children:he.length})," selected accounts? ",ee]}),confirmLabel:`${L.charAt(0).toUpperCase()+L.slice(1)} ${he.length} account(s)`,cancelLabel:"Cancel",variant:"danger",icon:ke?Zt:null,isArchive:ke,action:{type:"bulk-delete",accountIds:he}})};ze.length===0||(se-1)*Ce+1,Math.min(se*Ce,ze.length);const _t=()=>ye(I=>Math.max(I-1,1)),Ct=()=>ye(I=>Math.min(I+1,Qe)),jt=I=>{N(I),me("Overview"),pe(Or(I?.status)||"PROSPECT")},At=()=>N(null),Ge=I=>{I.target.id==="accountModalBackdrop"&&!we&&At()},Be=()=>{i(!1),l(!1),x(null),j(Tb),u(!1),M(null)},ce=I=>{I.target.id==="modalBackdrop"&&Be()},fe=I=>I?new Date(I).toLocaleString("en-US",{month:"short",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).replace(",",""):"",H=I=>{const{name:L,value:ee}=I.target;j(ke=>({...ke,[L]:ee}))},te=()=>{j(Tb),l(!1),x(null),i(!0)};f.useEffect(()=>{const I=new URLSearchParams(t.search||"");(t.state?.openAccountModal||I.get("openModal")==="1")&&(j(Tb),l(!1),x(null),i(!0),Oe(!1),e(t.pathname,{replace:!0,state:{}}))},[t.state,t.pathname,t.search,e]);const q=I=>{N(null);let L=null;I.assigned_accs&&(L=k.find(ee=>ee.id===I.assigned_accs.id),L||(L=I.assigned_accs)),M(L),j({name:I.name||"",website:I.website||"",phone_number:I.phone_number||"",billing_address:I.billing_address||"",shipping_address:I.shipping_address||"",parent_company:I.parent_company||"",industry:I.industry||"",status:Or(I.status)||"PROSPECT",territory_id:I.territory?.id?String(I.territory.id):"",assigned_to:I.assigned_accs?.id?String(I.assigned_accs.id):""}),l(!0),x(I.id),i(!0)},Y=I=>{if(!I)return;const L=n?.role==="Admin"||n?.role==="CEO"||n?.role==="MANAGER"||n?.role==="GROUP MANAGER",ee=L?"delete":"archive",ke=L?"This action cannot be undone.":"This account will be hidden from your view but admins can still see it.",$e=!L;le({title:`${ee.charAt(0).toUpperCase()+ee.slice(1)} Account`,message:a.jsxs("span",{children:["Are you sure you want to ",ee," the account"," ",a.jsx("span",{className:"font-semibold",children:I.name}),"? ",ke]}),confirmLabel:`${ee.charAt(0).toUpperCase()+ee.slice(1)} Account`,cancelLabel:"Cancel",variant:"danger",icon:$e?Zt:null,isArchive:$e,action:{type:"delete",targetId:I.id,name:I.name}})},U=async()=>{if(!Q?.action){le(null);return}const{action:I}=Q,{type:L,payload:ee,targetId:ke,name:$e}=I;J(!0);try{if(L==="create"){u(!0);const We=await ne.post("/accounts/admin",ee);Ue(),V.success(`Account "${$e}" created successfully.`);const mt=y?.id||null;Be(),await at(mt),!y&&We.data?.id}else if(L==="update"){if(!ke)throw new Error("Missing account identifier for update.");u(!0),await ne.put(`/accounts/admin/${ke}`,ee),V.success(`Account "${$e}" updated successfully.`);const We=y?.id&&y.id===ke?ke:null;Be(),await at(We),y?.id===ke&&N(null)}else if(L==="delete"){if(!ke)throw new Error("Missing account identifier for deletion.");const We=y?.id;h(ke);const Tt=n?.role==="Admin"||n?.role==="CEO"||n?.role==="MANAGER"||n?.role==="GROUP MANAGER"?`Account "${$e}" deleted successfully.`:`Account "${$e}" archived successfully.`;await ne.delete(`/accounts/admin/${ke}`),V.success(Tt),await at(We&&We!==ke?We:null),We===ke&&N(null)}else if(L==="bulk-delete"){const{accountIds:We}=I,Tt=n?.role==="Admin"||n?.role==="CEO"||n?.role==="MANAGER"||n?.role==="GROUP MANAGER"?"deleted":"archived";await ne.delete("/accounts/admin/bulk-delete",{data:{account_ids:We}}),V.success(`Successfully ${Tt} ${We.length} accounts`),Re([]),await at()}}catch(We){console.error(We);const mt=L==="create"?"Failed to create account. Please review the details and try again.":L==="update"?"Failed to update account. Please review the details and try again.":L==="bulk-delete"?"Failed to delete selected accounts.":"Failed to delete account. Please try again.",Tt=We.response?.data?.detail||mt;V.error(Tt),(L==="create"||L==="update")&&u(!1),L==="delete"&&h(null)}finally{(L==="create"||L==="update")&&u(!1),L==="delete"&&h(null),J(!1),le(null)}},de=()=>{we||le(null)},Te=async()=>{if(!y||!Ae)return;const I=Or(Ae),L=Or(y.status);if(I!==L){xe(!0);try{await ne.put(`/accounts/admin/${y.id}`,{status:I}),V.success(`Account status updated to ${FA(I)}`),S(ee=>ee.map(ke=>ke.id===y.id?{...ke,status:I}:ke)),N(null)}catch(ee){console.error(ee);const ke=ee.response?.data?.detail||"Failed to update account status. Please try again.";V.error(ke)}finally{xe(!1)}}},[ie,Oe]=f.useState(!1),X=I=>{I.preventDefault(),Oe(!0);const L=b.name.trim();if(!L){V.error("Account name is required.");return}if(!b.assigned_to){V.error("Assigned To is required.");return}const ke={name:L,website:b.website?.trim()||null,phone_number:b.phone_number?.trim()||null,billing_address:b.billing_address?.trim()||null,shipping_address:b.shipping_address?.trim()||null,industry:b.industry?.trim()||null,parent_company:b.parent_company?.trim()||null,status:b.status||"PROSPECT",territory_id:b.territory_id?Number(b.territory_id):null,assigned_to:b.assigned_to?Number(b.assigned_to):null},$e=o&&p?"update":"create";le({title:$e==="create"?"Confirm New Account":"Confirm Update",message:$e==="create"?a.jsxs("span",{children:["Are you sure you want to create the account"," ",a.jsx("span",{className:"font-semibold",children:L}),"?"]}):a.jsxs("span",{children:["Save changes to the account"," ",a.jsx("span",{className:"font-semibold",children:L}),"?"]}),confirmLabel:$e==="create"?"Create Account":"Update Account",cancelLabel:"Cancel",variant:"primary",action:{type:$e,payload:ke,targetId:p||null,name:L}})},oe=[{label:"Filter by Status",value:"Filter by Status"},...zA.map(I=>({label:I.label,value:I.value}))],Pe=Q?.action?.type==="delete"?Q.action.targetId:null,Ve=y&&(d===y.id||Pe===y.id),ft=y&&d===y.id,St=y?MFe(y.status):"",Ht=y?a.jsx("div",{id:"accountModalBackdrop",onClick:Ge,className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-6xl max-h-[92vh] overflow-y-auto hide-scrollbar animate-scale-in font-inter relative",onClick:I=>I.stopPropagation(),children:[a.jsxs("div",{className:"bg-tertiary w-full rounded-t-xl flex items-center justify-between p-3 lg:p-3",children:[a.jsx("h1",{className:"lg:text-3xl text-xl text-white font-semibold text-center w-full",children:"Account"}),a.jsx("button",{onClick:At,className:"text-gray-400 hover:text-white cursor-pointer",children:a.jsx(Za,{size:25})})]}),a.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between lg:flex-row lg:items-center lg:justify-between mt-3 gap-2 px-2 md:items-center lg:gap-4 md:mx-7 lg:mx-7",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[a.jsx("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-800",children:y.name}),a.jsx("span",{className:`text-xs sm:text-sm font-medium px-2 sm:px-3 py-1 rounded-full whitespace-nowrap ${St}`,children:FA(y.status)})]}),a.jsx("div",{className:"flex flex-col sm:flex-row sm:space-x-3 space-y-2 sm:space-y-0",children:y.assigned_accs&&y.assigned_accs.id===n?.id&&y.acc_creator&&y.acc_creator.id===n?.id&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{className:"inline-flex items-center justify-center w-full sm:w-auto bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 disabled:opacity-70 transition text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",onClick:()=>q(y),disabled:Q?.action?.type==="update"&&Q.action.targetId===y.id,children:[a.jsx(gn,{className:"mr-2"}),"Edit"]}),a.jsx("button",{className:"inline-flex items-center justify-center w-full sm:w-auto px-4 py-2 rounded-md text-sm bg-orange-500 text-white hover:bg-orange-600 transition focus:outline-none focus:ring-2 focus:ring-orange-400",onClick:()=>Y(y),disabled:!!Ve,children:ft?"Archiving...":a.jsxs(a.Fragment,{children:[a.jsx(Zt,{className:"mr-2"}),"Archive"]})})]})})]}),a.jsx("div",{className:"border-b border-gray-200 my-5"}),a.jsxs("div",{className:"p-6 lg:p-4",children:[a.jsx("div",{className:"flex w-full bg-[#6A727D] text-white mt-1 overflow-x-auto mb-6",children:["Overview","Activities"].map(I=>a.jsx("button",{onClick:()=>me(I),className:`flex-1 min-w-[90px] px-4 py-2.5 text-xs sm:text-sm font-medium text-center transition-all duration-200 border-b-2
        ${be===I?"bg-paper-white text-[#6A727D] border-white":"text-white hover:bg-[#5c636d]"}`,children:I},I))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 items-start",children:[a.jsxs("div",{className:"lg:col-span-3",children:[be==="Overview"&&a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 md:p-8 border border-gray-200",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4 sm:gap-6 text-sm text-gray-700",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Website:"}),a.jsx("p",{children:y.website?a.jsx("a",{href:y.website,className:"text-blue-600 hover:underline break-all",target:"_blank",rel:"noopener noreferrer",children:y.website}):"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Industry:"}),a.jsx("p",{children:y.industry||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Parent Company:"}),a.jsx("p",{children:y.parent_company||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Territory:"}),a.jsx("p",{children:y.territory?.name||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Phone Number:"}),a.jsx("p",{children:y.phone_number||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Billing Address:"}),a.jsx("p",{children:y.billing_address||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Shipping Address:"}),a.jsx("p",{children:y.shipping_address||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Assigned To:"}),a.jsx("p",{children:y.assigned_accs?`${y.assigned_accs.first_name} ${y.assigned_accs.last_name}`:"Unassigned"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created By:"}),a.jsx("p",{children:y.acc_creator?`${y.acc_creator.first_name} ${y.acc_creator.last_name}`:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created At:"}),a.jsx("p",{children:fe(y.created_at)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Last Updated:"}),a.jsx("p",{children:fe(y.updated_at)||"N/A"})]})]}),a.jsx(Tn,{comments:it,onAddComment:ot})]}),be==="Notes"&&a.jsxs("div",{className:"mt-4 w-full",children:[a.jsx("div",{className:"flex flex-wrap items-center justify-between mb-4 gap-2",children:a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words",children:"Account Note"})}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 shadow-sm break-words",children:[a.jsx("div",{className:"flex items-start justify-between",children:a.jsx("div",{children:a.jsx("p",{className:"text-sm font-medium text-gray-800 break-words",children:"Note"})})}),a.jsx("div",{className:"mt-3 text-sm text-gray-700 whitespace-pre-wrap break-words",children:w.notes||"No notes available."})]})]}),be==="Activities"&&a.jsxs("div",{className:"space-y-2 w-full h-full max-h-[50dvh] overflow-y-auto bg-gray-50 p-2 hide-scrollbar rounded-lg border border-gray-200 shadow-sm",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words border-b border-gray-300 py-2",children:"Related Activities"}),a.jsxs("div",{className:"space-y-2 text-sm",children:[Ee.tasks&&Ee.tasks.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>st(Ke==="tasks"?null:"tasks"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Qt,{className:"text-blue-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Tasks (",Ee.tasks.length,")"]})]}),Ke==="tasks"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Ke==="tasks"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:Ee.tasks.map((I,L)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/sales/tasks",{state:{taskID:I.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-blue-600 mt-1",children:a.jsx(Qt,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:I.subject||I.title||"Task"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:I.description||"No description"}),I.assigned_to&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Assigned: ",I.assigned_to.first_name," ",I.assigned_to.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:fe(I.due_date||I.created_at)})]},`task-${L}`))})]}),Ee.meetings&&Ee.meetings.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>st(Ke==="meetings"?null:"meetings"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Pt,{className:"text-green-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Meetings (",Ee.meetings.length,")"]})]}),Ke==="meetings"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Ke==="meetings"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:Ee.meetings.map((I,L)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/sales/meetings",{state:{meetingID:I.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-green-600 mt-1",children:a.jsx(Pt,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:I.subject||I.title||"Meeting"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:I.description||I.location||"No description"}),I.host&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Host: ",I.host.first_name," ",I.host.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:fe(I.start_time||I.created_at)})]},`meeting-${L}`))})]}),Ee.calls&&Ee.calls.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>st(Ke==="calls"?null:"calls"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(It,{className:"text-purple-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Calls (",Ee.calls.length,")"]})]}),Ke==="calls"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Ke==="calls"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:Ee.calls.map((I,L)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/sales/calls",{state:{callID:I.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-purple-600 mt-1",children:a.jsx(It,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:I.subject||I.title||"Call"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:I.direction||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:fe(I.call_time||I.created_at)})]},`call-${L}`))})]}),Ee.contacts&&Ee.contacts.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>st(Ke==="contacts"?null:"contacts"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ra,{className:"text-teal-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Contacts (",Ee.contacts.length,")"]})]}),Ke==="contacts"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Ke==="contacts"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:Ee.contacts.map((I,L)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/sales/contacts",{state:{contactID:I.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-teal-600 mt-1",children:a.jsx(ra,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("h4",{className:"font-medium text-blue-600 break-words text-sm",children:[I.first_name?`${I.first_name} `:"",I.last_name]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:I.title||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:fe(I.created_at)})]},`contact-${L}`))})]}),Ee.deals&&Ee.deals.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>st(Ke==="deals"?null:"deals"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(sa,{className:"text-indigo-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Deals (",Ee.deals.length,")"]})]}),Ke==="deals"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Ke==="deals"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:Ee.deals.map((I,L)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/sales/deals",{state:{dealID:I.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-indigo-600 mt-1",children:a.jsx(sa,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("h4",{className:"font-medium text-blue-600 break-words text-sm",children:[I.deal_id?I.deal_id.replace(/D(\d+)-\d+-/,"D$1-"):"--"," ",I.name||I.title||"Deal"]}),a.jsx("p",{className:"text-xs text-gray-500 break-words capitalize",children:I.stage||I.description||"No description"})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:fe(I.close_date||I.created_at)})]},`deal-${L}`))})]}),Ee.quotes&&Ee.quotes.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>st(Ke==="quotes"?null:"quotes"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ia,{className:"text-orange-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Quotes (",Ee.quotes.length,")"]})]}),Ke==="quotes"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Ke==="quotes"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:Ee.quotes.map((I,L)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/sales/quotes",{state:{quoteID:I.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-orange-600 mt-1",children:a.jsx(ia,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:(I.quote_id?I.quote_id.replace(/Q(\d+)-\d+-/,"Q$1-"):"--")||"Quote"}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:I.status||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:fe(I.presented_date)||""})]},`quote-${L}`))})]}),(!Ee||(!Ee.tasks||Ee.tasks.length===0)&&(!Ee.meetings||Ee.meetings.length===0)&&(!Ee.calls||Ee.calls.length===0)&&(!Ee.quotes||Ee.quotes.length===0)&&(!Ee.deals||Ee.deals.length===0)&&(!Ee.contacts||Ee.contacts.length===0))&&a.jsx("div",{className:"text-center py-8 text-gray-500",children:a.jsx("p",{children:"No related activities found for this account."})})]})]})]}),a.jsxs("div",{className:"flex flex-col gap-4",children:[a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Quick Actions"}),a.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[a.jsxs("button",{onClick:()=>e("/sales/calls",{state:{openCallModal:!0,initialCallData:{subject:`Call with ${y.name}`,relatedType1:"Account",relatedTo1:String(y.id),relatedType2:null,relatedTo2:null,assigned_to:y.assigned_accs?.id?String(y.assigned_accs.id):"",direction:"Outgoing",status:"Planned"}}}),className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(It,{className:"text-gray-600 w-4 h-4"}),"Schedule Call"]}),a.jsxs("button",{className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",onClick:()=>e("/sales/meetings",{state:{openMeetingModal:!0,initialMeetingData:{subject:`Meeting with ${y.name}`,relatedType1:"Account",relatedTo1:String(y.id),relatedType2:null,relatedTo2:null,assigned_to:y.assigned_accs?.id?String(y.assigned_accs.id):"",status:"Planned"}}}),children:[a.jsx(Pt,{className:"text-gray-600 w-4 h-4"}),"Book Meeting"]}),a.jsxs("button",{onClick:()=>e("/sales/tasks",{state:{openTaskModal:!0,initialTaskData:{subject:`Follow up with ${y.name}`,relatedType1:"Account",relatedTo1:String(y.id),relatedType2:null,relatedTo2:null,assignedTo:y.assigned_accs?.id?String(y.assigned_accs.id):"",priority:"NORMAL",status:"Not Started"}}}),className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(Qt,{className:"text-gray-600 w-4 h-4"}),"Tasks"]})]})]}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm w-full",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Status"}),a.jsx("select",{className:"border border-gray-200 rounded-md px-2 sm:px-3 py-1.5 w-full text-sm mb-2 focus:ring-2 focus:ring-indigo-500 outline-none",value:Ae||Or(y?.status)||"PROSPECT",onChange:I=>pe(I.target.value),children:zA.map(I=>a.jsx("option",{value:I.value,children:I.label},I.value))}),a.jsx("button",{onClick:Te,disabled:Ie||!Ae||Or(Ae)===Or(y?.status),className:`w-full py-1.5 rounded-md text-sm transition focus:outline-none focus:ring-2 ${Ie||!Ae||Or(Ae)===Or(y?.status)?"bg-gray-400 cursor-not-allowed text-white":"bg-gray-900 text-white hover:bg-gray-800 focus:ring-gray-400"}`,children:Ie?"Updating...":"Update"})]})]})]})]})]})}):null,da=a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[_&&a.jsx(qt,{message:"Loading accounts..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h2",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(Xa,{className:"mr-2 text-blue-600"}),"Accounts Management"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{onClick:()=>{te(),Oe(!1)},className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 my-1 lg:my-0 rounded-md hover:bg-gray-800 text-sm sm:text-base mx-auto sm:ml-auto cursor-pointer",children:[a.jsx(aa,{className:"mr-2"})," Add Account"]})})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4 mb-6 w-full break-words overflow-hidden lg:overflow-visible",children:De.map(I=>a.jsx(RFe,{...I},I.title))}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search accounts",value:W,onChange:I=>Z(I.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsx("div",{className:"w-full lg:w-1/4",children:a.jsx("select",{value:G,onChange:I=>$(I.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:oe.map(I=>a.jsx("option",{value:I.value,children:I.label},I.value))})})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[500px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 text-sm tracking-wide font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 text-center w-12",children:a.jsx("input",{type:"checkbox",checked:tt.length>0&&tt.filter(I=>I.assigned_accs?.id===n?.id&&I.acc_creator?.id===n?.id).every(I=>he.includes(I.id))&&tt.some(I=>I.assigned_accs?.id===n?.id&&I.acc_creator?.id===n?.id),onChange:Me,className:"form-checkbox h-4 w-4 text-blue-600 rounded focus:ring-blue-500 border-gray-300"})}),a.jsx("th",{className:"py-3 px-4 truncate",children:"Account"}),a.jsx("th",{className:"py-3 px-4",children:"Status"}),a.jsx("th",{className:"py-3 px-4",children:"Industry"}),a.jsx("th",{className:"py-3 px-4",children:"Territory"}),a.jsx("th",{className:"py-3 px-4",children:"Phone"}),a.jsx("th",{className:"py-3 px-4 text-center w-24",children:he.length>0?a.jsx("button",{onClick:yt,className:"text-orange-600 hover:text-orange-800 transition p-1 rounded-full hover:bg-orange-50",title:`Archive ${he.length} selected accounts`,children:a.jsx(Zt,{size:18})}):""})]})}),a.jsx("tbody",{children:_?a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:7,children:"Loading accounts..."})}):ze.length>0?tt.map(I=>a.jsxs("tr",{className:"hover:bg-gray-50 text-xs cursor-pointer",onClick:()=>{jt(I),Ne(I.id)},children:[a.jsx("td",{className:"py-3 px-4 text-center",children:I.assigned_accs?.id===n?.id&&I.acc_creator?.id===n?.id?a.jsx("input",{type:"checkbox",checked:he.includes(I.id),onChange:()=>et(I.id),onClick:L=>L.stopPropagation(),className:"form-checkbox h-4 w-4 text-blue-600 rounded focus:ring-blue-500 border-gray-300"}):null}),a.jsx("td",{className:"py-3 px-4",children:a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-blue-600 hover:underline break-all text-sm",children:I.name}),a.jsx("div",{className:"text-gray-500 text-xs break-all",children:I.website||"--"})]})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${IFe(I.status)}`,children:FA(I.status)})}),a.jsx("td",{className:"py-3 px-4 text-sm",children:I.industry||"--"}),a.jsx("td",{className:"py-3 px-4 text-sm",children:I.territory?.name||"--"}),a.jsx("td",{className:"py-3 px-4",children:a.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[a.jsx(It,{className:"text-gray-500"}),a.jsx("span",{children:I.phone_number||"--"})]})}),a.jsx("td",{className:"py-3 px-4"})]},I.id)):a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:7,children:"No accounts found."})})})]})}),a.jsx(ca,{className:"mt-4",totalItems:ze.length,pageSize:Ce,currentPage:se,onPrev:_t,onNext:Ct,onPageSizeChange:I=>{ge(I),ye(1)},pageSizeOptions:[10,20,30,40,50],label:"accounts"})]}),qe=r?a.jsx("div",{id:"modalBackdrop",onClick:ce,className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-full sm:max-w-3xl rounded-2xl shadow-lg p-4 sm:p-6 md:p-8 relative border border-gray-200 overflow-y-auto hide-scrollbar max-h-[90vh]",onClick:I=>I.stopPropagation(),children:[a.jsx("button",{onClick:()=>{Be(),Oe(!1)},className:"absolute top-4 right-4 text-gray-500 hover:text-black transition",disabled:c||we,children:a.jsx(ea,{size:22})}),a.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800 mb-4 sm:mb-6 flex items-center justify-center",children:o?"Edit Account":"Add New Account"}),a.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",onSubmit:X,noValidate:!0,children:[a.jsx("div",{className:"md:col-span-2",children:a.jsx(cf,{label:"Name",name:"name",value:b.name,onChange:H,placeholder:"Company name",required:!0,isSubmitted:ie})}),a.jsx(x8,{label:"Parent Company",value:b.parent_company,onChange:I=>{j(L=>({...L,parent_company:I}))},items:P.map(I=>({id:I,name:I})),getLabel:I=>I?.name||"",placeholder:"Select parent company...",disabled:c}),a.jsx(cf,{label:"Website",name:"website",value:b.website,onChange:H,placeholder:"https://example.com",disabled:c}),a.jsx(cf,{label:"Phone Number",name:"phone_number",value:b.phone_number,onChange:H,placeholder:"09xx xxx xxxx",type:"tel",disabled:c}),a.jsx(cf,{label:"Industry",name:"industry",value:b.industry,onChange:H,placeholder:"Industry",disabled:c}),a.jsx(cf,{label:"Billing Address",name:"billing_address",value:b.billing_address,onChange:H,placeholder:"Billing address",disabled:c}),a.jsx(cf,{label:"Shipping Address",name:"shipping_address",value:b.shipping_address,onChange:H,placeholder:"Shipping address",disabled:c}),a.jsx(p8,{label:"Status",name:"status",value:b.status,onChange:H,options:[{value:"",label:"Select status"},...zA],required:!0,disabled:c}),a.jsx(x8,{label:"Assigned To",value:b.assigned_to,onChange:I=>{const L=k.find(ee=>String(ee.id)===String(I));M(L),j(ee=>({...ee,assigned_to:I}))},items:k||[],getLabel:I=>`${I?.first_name??""} ${I?.last_name??""} (${I?.role??""})`.trim(),placeholder:"Search assignee...",required:!0,isSubmitted:ie,disabled:c||k.length===0||s}),a.jsx("div",{className:"md:col-span-2",children:a.jsx(p8,{label:"Territory",name:"territory_id",value:b.territory_id||"",onChange:H,options:[{value:"",label:E?E.assigned_territory&&E.assigned_territory.length>0?"Select Territory":"No territories assigned to this user":"Select a user first"},...E&&E.assigned_territory&&E.assigned_territory.map(I=>({value:String(I.id),label:I.name}))||[]],disabled:c||!E||!E.assigned_territory||E.assigned_territory.length===0})}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-end sm:justify-end space-y-2 sm:space-y-0 sm:space-x-2 col-span-1 md:col-span-2 mt-4 w-full",children:[a.jsx("button",{type:"button",onClick:()=>{Be(),Oe(!1)},className:"w-full sm:w-auto px-4 py-2 text-white bg-red-400 border border-red-300 rounded hover:bg-red-500 transition disabled:opacity-70",disabled:c||we,children:"Cancel"}),a.jsx("button",{type:"submit",className:"w-full sm:w-auto px-4 py-2 text-white border border-tertiary bg-tertiary rounded hover:bg-secondary transition disabled:opacity-70",disabled:c||we,children:c?"Saving...":o?"Update Account":"Save Account"})]})]})]})}):null,_e=Q?a.jsx(FFe,{open:!0,title:Q.title,message:Q.message,confirmLabel:Q.confirmLabel,cancelLabel:Q.cancelLabel,variant:Q.variant,onConfirm:U,onCancel:de,loading:we,icon:Q.icon,isArchive:Q.isArchive}):null;return a.jsxs(a.Fragment,{children:[da,Ht,qe,_e]})}function RFe({icon:e,title:t,value:n,color:s="text-blue-600",bgColor:r="bg-blue-100",onClick:i}){const o=()=>{typeof i=="function"?i():console.log(`Clicked: ${t}`)};return a.jsxs("div",{className:"flex items-center p-4 bg-white rounded-xl shadow-md border border-gray-200 transition-all duration-300",onClick:o,children:[a.jsx("div",{className:`flex-shrink-0 p-3 rounded-full ${r} ${s} mr-4`,children:e?a.jsx(e,{size:22}):null}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:t}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:n})]})]})}function cf({label:e,name:t,value:n,onChange:s,placeholder:r,type:i="text",required:o=!1,disabled:l=!1,className:c="",isSubmitted:u=!1}){const d=u&&!n?.trim();return a.jsxs("div",{children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",o&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:i,name:t,value:n??"",onChange:s,placeholder:r,required:o,disabled:l,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border focus:ring-2
          ${d?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}
          ${c}
        `})]})}function p8({label:e,name:t,value:n,onChange:s,options:r,required:i=!1,disabled:o=!1}){return a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsx("select",{name:t,value:n??"",onChange:s,required:i,disabled:o,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100",children:r.map(l=>a.jsx("option",{value:l.value,disabled:l.value==="",children:l.label},l.value))})]})}function x8({label:e,items:t=[],value:n="",onChange:s,getLabel:r,placeholder:i="Search...",disabled:o=!1,className:l="",required:c=!1,isSubmitted:u=!1,allowFreeText:d=!1}){const h=u&&c&&!n;return a.jsxs("div",{className:l,children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",c&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx(zFe,{items:t,value:n??"",onChange:s,getLabel:r,placeholder:i,disabled:o,hasError:h,allowFreeText:d})]})}function zFe({items:e=[],value:t="",onChange:n,getLabel:s,placeholder:r="Search...",disabled:i=!1,maxRender:o=200,hasError:l=!1,allowFreeText:c=!1}){const[u,d]=f.useState(!1),[h,p]=f.useState(""),x=f.useRef(null),b=e.find(N=>String(N.id)===String(t)),j=b?s(b):t,y=f.useMemo(()=>{const N=h.trim().toLowerCase();return(N?e.filter(S=>(s(S)||"").toLowerCase().includes(N)):e).slice(0,o)},[e,h,s,o]);return f.useEffect(()=>{const N=w=>{x.current&&!x.current.contains(w.target)&&d(!1)};return document.addEventListener("mousedown",N),()=>document.removeEventListener("mousedown",N)},[]),f.useEffect(()=>{u||p("")},[u]),a.jsxs("div",{ref:x,className:"relative w-full",children:[a.jsx("input",{disabled:i,value:u?h:j,placeholder:r,onFocus:()=>!i&&d(!0),onChange:N=>{p(N.target.value),u||d(!0)},className:`w-full border rounded-md px-2 py-1.5 text-sm outline-none focus:ring-2 disabled:bg-gray-100
          ${l?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}`}),u&&!i&&a.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg overflow-hidden",children:[a.jsxs("div",{className:"max-h-56 overflow-y-auto hide-scrollbar",children:[c&&h.trim()&&!y.some(N=>s(N).toLowerCase()===h.trim().toLowerCase())&&a.jsxs("button",{type:"button",onClick:()=>{n(h.trim()),d(!1)},className:"w-full text-left px-3 py-2 text-sm hover:bg-green-50 bg-blue-50 font-medium text-blue-700",children:['+ Add "',h.trim(),'" as new parent company']}),y.length>0?y.map(N=>{const w=String(N.id),S=s(N),_=String(t)===w;return a.jsx("button",{type:"button",onClick:()=>{n(w),d(!1)},className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-50 ${_?"bg-blue-50":""}`,children:S||"--"},w)}):!c||!h.trim()?a.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No results"}):null]}),e.length>o&&a.jsxs("div",{className:"px-3 py-2 text-[11px] text-gray-400 border-t",children:["Showing first ",o," results  keep typing to narrow."]})]})]})}function FFe({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o=!1,onConfirm:l,onCancel:c,icon:u=null,isArchive:d=!1}){if(!e)return null;const h=d?"bg-orange-500 hover:bg-orange-600 border border-orange-400":i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsxs("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 flex items-center justify-center ${h}`,disabled:o,children:[u&&a.jsx(u,{className:"mr-2",size:18}),o?"Processing...":s]})]})]})})}const kb={first_name:"",last_name:"",account_id:"",title:"",department:"",email:"",work_phone:"",mobile_phone_1:"",mobile_phone_2:"",notes:"",assigned_to:""},vl=e=>[e?.first_name,e?.last_name].filter(Boolean).join(" ").trim(),Ii=e=>e?new Date(e).toLocaleString("en-US",{month:"short",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).replace(",",""):"";function UFe(){const e=Et(),t=ta();f.useEffect(()=>{document.title="Contacts | Sari-Sari CRM"},[]);const[n,s]=f.useState([]),[r,i]=f.useState(!1),[o,l]=f.useState([]),[c,u]=f.useState([]),[d,h]=f.useState(null),[p,x]=f.useState(!1),[b,j]=f.useState(!1),[y,N]=f.useState(!1),[w,S]=f.useState(null),[_,T]=f.useState(!1),[k,A]=f.useState(null),[E,M]=f.useState(kb),[F,D]=f.useState(""),[P,B]=f.useState("Filter by Accounts"),[G,$]=f.useState(null),[W,Z]=f.useState("Overview"),[Q,le]=f.useState(1),[we,J]=f.useState(10),[se,ye]=f.useState({}),[Ce,ge]=f.useState(null),[be,me]=f.useState(null),[Ae,pe]=f.useState(null),[Ie,xe]=f.useState([]),{comments:he,addComment:Re,refresh:Ee}=kn({relatedType:"contact",relatedId:d?.id});f.useEffect(()=>{d?.id&&Ee()},[d?.id,Ee]),f.useEffect(()=>{const Y=t.state?.contactID;Y&&(pe(Y),e(t.pathname,{replace:!0,state:{}}))},[t,e]),f.useEffect(()=>{if(Ae&&n.length>0&&!r){const Y=n.find(U=>U.id===Ae);Y?h(Y):V.error("Contact not found."),pe(null)}},[Ae,n,r]),f.useEffect(()=>{async function Y(){try{const U=await ne.get("/auth/me");me(U.data)}catch(U){console.error("Failed to fetch current user",U)}}Y()},[]);const He=f.useCallback(async(Y=null)=>{i(!0);try{const U=await ne.get("/contacts/admin/fetch-all"),Te=[...Array.isArray(U.data)?U.data:[]].sort((ie,Oe)=>{const X=ie?.created_at||ie?.updated_at||0,oe=Oe?.created_at||Oe?.updated_at||0;return new Date(oe)-new Date(X)});if(s(Te),Y){const ie=Te.find(Oe=>Oe.id===Y);h(ie||null)}}catch(U){console.error(U),s([]),U.response?.status===403?V.error("Permission denied. Only CEO, Admin, or Group Manager can access this page."):V.error("Failed to fetch contacts. Please try again later.")}finally{i(!1)}},[h]),Ke=f.useCallback(async()=>{try{const Y=await ne.get("/accounts/admin/fetch-all"),de=[...Array.isArray(Y.data)?Y.data:[]].sort((Te,ie)=>(Te?.name||"").localeCompare(ie?.name||""));l(de)}catch(Y){console.error(Y),l([]),Y.response?.status===403&&V.warn("Unable to load accounts (permission denied).")}},[]),st=f.useCallback(()=>{window.open("/sales/accounts?openModal=1","_blank","noopener,noreferrer")},[]),it=f.useCallback(async()=>{try{const Y=await ne.get("/users/all"),de=[...Array.isArray(Y.data)?Y.data:[]].sort((Te,ie)=>vl(Te).localeCompare(vl(ie)));u(de)}catch(Y){console.error(Y),u([]),Y.response?.status===403&&V.warn("Unable to load users for assignment (permission denied).")}},[]),ot=f.useCallback(async Y=>{try{const U=await ne.get(`/activities/contact/${Y}`);ye(U.data&&typeof U.data=="object"?U.data:{})}catch(U){console.error(U),U.response?.status===404&&(console.warn("No activities found for this account."),ye({}))}},[]);f.useEffect(()=>{He(),Ke(),it()},[He,Ke,it]);const rt=f.useMemo(()=>{const Y=new Map;o.forEach(de=>{de?.id&&de?.name&&Y.set(String(de.id),de.name)}),n.forEach(de=>{de?.account_id&&de?.account?.name&&Y.set(String(de.account_id),de.account.name)});const U=Array.from(Y.entries()).sort((de,Te)=>de[1].localeCompare(Te[1])).map(([de,Te])=>({value:de,label:Te}));return[{value:"Filter by Accounts",label:"Filter by Accounts"},...U]},[o,n]),at=f.useMemo(()=>{const Y=F.trim().toLowerCase(),U=P.trim();return n.filter(de=>{const Te=[de?.first_name,de?.last_name,de?.email,de?.title,de?.department,de?.account?.name,de?.account?.status,de?.work_phone,de?.mobile_phone_1,de?.mobile_phone_2,de?.assigned_contact?.first_name,de?.assigned_contact?.last_name,de?.contact_creator?.first_name,de?.contact_creator?.last_name,de?.notes,Ii(de?.created_at),Ii(de?.updated_at)],ie=Y===""||Te.some(X=>X==null?!1:X.toString().toLowerCase().includes(Y)),Oe=U==="Filter by Accounts"||String(de.account_id)===U;return ie&&Oe})},[n,F,P]),Je=Math.max(1,Math.ceil(at.length/we)||1);f.useEffect(()=>{le(1)},[F,P]),f.useEffect(()=>{le(Y=>{const U=Math.max(1,Math.ceil(at.length/we)||1);return Y>U?U:Y})},[at.length,we]);const Fe=f.useMemo(()=>{const Y=(Q-1)*we;return at.slice(Y,Y+we)},[at,Q,we]),Ue=()=>le(Y=>Math.max(Y-1,1)),Ne=()=>le(Y=>Math.min(Y+1,Je)),ze=f.useMemo(()=>{if(!b||!k)return o;const Y=n.find(de=>de.id===k);return!Y||!Y.account||o.some(de=>de.id===Y.account.id)?o:[...o,Y.account]},[o,b,k,n]),je=f.useCallback(()=>{x(!1),j(!1),A(null),M(kb),N(!1),Me(!1)},[]),ve=Y=>{Y.target.id==="modalBackdrop"&&!y&&!_&&je()},z=Y=>{const{name:U,value:de}=Y.target;M(Te=>({...Te,[U]:de}))},K=()=>{M(kb),j(!1),A(null),x(!0),be?.role==="Sales"&&M(Y=>({...Y,assigned_to:be.id}))};f.useEffect(()=>{const Y=new URLSearchParams(t.search||"");(t.state?.openContactModal||Y.get("openModal")==="1")&&(M(kb),j(!1),A(null),x(!0),Me(!1),be?.role==="Sales"&&M(de=>({...de,assigned_to:be.id})),e(t.pathname,{replace:!0,state:{}}))},[t.state,t.pathname,t.search,e,be]);const ue=async Y=>{if(!Y)return;const U=await ne.get(`/accounts/get/${Y.account_id}`);M({first_name:Y.first_name||"",last_name:Y.last_name||"",account_id:U.data.id?U.data.id:"",title:Y.title||"",department:Y.department||"",email:Y.email||"",work_phone:Y.work_phone||"",mobile_phone_1:Y.mobile_phone_1||"",mobile_phone_2:Y.mobile_phone_2||"",notes:Y.notes||"",assigned_to:Y.assigned_to?String(Y.assigned_to):""}),j(!0),A(Y.id),x(!0),h(null)},re=Y=>{if(!Y)return;const U=vl(Y)||"this contact",de=be?.role==="Admin"||be?.role==="CEO"||be?.role==="MANAGER"||be?.role==="GROUP MANAGER",Te=de?"delete":"archive",ie=de?"This action cannot be undone.":"This contact will be hidden from your view but admins can still see it.",Oe=!de;S({title:`${Te.charAt(0).toUpperCase()+Te.slice(1)} Contact`,message:a.jsxs("span",{children:["Are you sure you want to ",Te," ",a.jsx("span",{className:"font-semibold",children:U}),"? ",ie]}),confirmLabel:`${Te.charAt(0).toUpperCase()+Te.slice(1)} Contact`,cancelLabel:"Cancel",variant:"danger",icon:Oe?Zt:null,isArchive:Oe,action:{type:"delete",targetId:Y.id,name:U}})},Le=()=>{const Y=Fe.filter(U=>U.assigned_contact?.id===be?.id&&U.contact_creator?.id===be?.id);Ie.length===Y.length&&Y.length>0?xe([]):xe(Y.map(U=>U.id))},De=Y=>{xe(U=>U.includes(Y)?U.filter(de=>de!==Y):[...U,Y])},Qe=async()=>{if(Ie.length===0)return;const Y=be?.role==="Admin"||be?.role==="CEO"||be?.role==="MANAGER"||be?.role==="GROUP MANAGER",U=Y?"delete":"archive",de=Y?"This action cannot be undone.":"These contacts will be hidden from your view but admins can still see them.",Te=!Y;S({title:`${U.charAt(0).toUpperCase()+U.slice(1)} Contacts`,message:a.jsxs("span",{children:["Are you sure you want to ",U," ",a.jsx("span",{className:"font-semibold",children:Ie.length})," selected contacts? ",de]}),confirmLabel:`${U.charAt(0).toUpperCase()+U.slice(1)} ${Ie.length} contact(s)`,cancelLabel:"Cancel",variant:"danger",icon:Te?Zt:null,isArchive:Te,action:{type:"bulk-delete",contactIds:Ie}})},[tt,Me]=f.useState(!1),et=Y=>{Y.preventDefault(),Me(!0);const U=E.last_name.trim();if(!U){V.error("Last name is required.");return}if(!E.account_id){V.error("Account is required.");return}if(!E.assigned_to){V.error("Assigned To is required.");return}const Te=E.email?.trim();if(!Te){V.error("Email is required.");return}if(!Te.includes("@")){V.error("Email must contain '@'.");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(Te)){V.error("Please enter a valid email address.");return}const Oe=E.first_name?.trim()||"",X={first_name:Oe,last_name:U,account_id:Number(E.account_id),title:E.title?.trim()||null,department:E.department?.trim()||null,email:E.email?.trim().toLowerCase()||null,work_phone:E.work_phone?.trim()||null,mobile_phone_1:E.mobile_phone_1?.trim()||null,mobile_phone_2:E.mobile_phone_2?.trim()||null,notes:E.notes?.trim()||null,assigned_to:E.assigned_to?Number(E.assigned_to):null},oe=b&&k?"update":"create",Pe=`${Oe} ${U}`.trim();S({title:oe==="create"?"Confirm New Contact":"Confirm Update",message:oe==="create"?a.jsxs("span",{children:["Are you sure you want to add"," ",a.jsx("span",{className:"font-semibold",children:Pe})," to your contacts?"]}):a.jsxs("span",{children:["Save changes to ",a.jsx("span",{className:"font-semibold",children:Pe}),"?"]}),confirmLabel:oe==="create"?"Create Contact":"Update Contact",cancelLabel:"Cancel",variant:"primary",action:{type:oe,payload:X,targetId:k||null,name:Pe}})},yt=async()=>{if(!w?.action){S(null);return}const{action:Y}=w,{type:U,payload:de,targetId:Te,name:ie}=Y;T(!0);try{if(U==="create"){N(!0),await ne.post("/contacts/admin",de),V.success(`Contact "${ie}" created successfully.`);const Oe=d?.id||null;je(),await He(Oe)}else if(U==="update"){if(!Te)throw new Error("Missing contact identifier for update.");N(!0),await ne.put(`/contacts/admin/${Te}`,de),V.success(`Contact "${ie}" updated successfully.`);const Oe=d?.id&&d.id===Te?Te:d?.id||null;je(),await He(Oe),d?.id===Te&&h(null)}else if(U==="delete"){if(!Te)throw new Error("Missing contact identifier for deletion.");const Oe=d?.id;$(Te);const oe=be?.role==="Admin"||be?.role==="CEO"||be?.role==="MANAGER"||be?.role==="GROUP MANAGER"?`Contact "${ie}" deleted successfully.`:`Contact "${ie}" archived successfully.`;await ne.delete(`/contacts/admin/${Te}`),V.success(oe),await He(Oe&&Oe!==Te?Oe:null),Oe===Te&&h(null)}else if(U==="bulk-delete"){const{contactIds:Oe}=Y;if(!Oe||Oe.length===0)throw new Error("No contacts provided for bulk deletion.");const oe=be?.role==="Admin"||be?.role==="CEO"||be?.role==="MANAGER"||be?.role==="GROUP MANAGER"?`Successfully deleted ${Oe.length} contact(s).`:`Successfully archived ${Oe.length} contact(s).`;await ne.delete("/contacts/admin/bulk-delete",{data:{contact_ids:Oe}}),V.success(oe),xe([]),await He(),h(null)}}catch(Oe){console.error(Oe);const X=U==="create"?"Failed to create contact. Please review the details and try again.":U==="update"?"Failed to update contact. Please review the details and try again.":U==="bulk-delete"?"Failed to delete contacts. Please try again.":"Failed to delete contact. Please try again.",oe=Oe.response?.data?.detail||X;V.error(oe)}finally{(U==="create"||U==="update")&&N(!1),U==="delete"&&$(null),T(!1),S(null)}},_t=()=>{_||S(null)},Ct=Y=>{h(Y),Z("Overview")},jt=()=>h(null),At=Y=>{Y.target.id==="contactModalBackdrop"&&!_&&jt()},Ge=w?.action?.type==="delete"?w.action.targetId:null,Be=d&&(G===d.id||Ge===d.id),ce=d&&G===d.id,fe=d?a.jsx("div",{id:"contactModalBackdrop",onClick:At,className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-6xl max-h-[92vh] overflow-y-auto hide-scrollbar animate-scale-in font-inter relative",onClick:Y=>Y.stopPropagation(),children:[a.jsxs("div",{className:"bg-tertiary w-full rounded-t-xl relative p-3 lg:p-3",children:[a.jsx("h1",{className:"lg:text-3xl text-xl text-white font-semibold text-center w-full",children:"Contact"}),a.jsx("button",{onClick:jt,className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-white cursor-pointer",children:a.jsx(Za,{size:25})})]}),a.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between lg:flex-row lg:items-center lg:justify-between mt-3 gap-2 px-2 md:items-center lg:gap-4 md:mx-7 lg:mx-7",children:[a.jsx("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:a.jsx("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-800",children:vl(d)||"Unnamed contact"})}),a.jsx("div",{className:"flex flex-col sm:flex-row sm:space-x-3 space-y-2 sm:space-y-0",children:d.assigned_contact&&d.assigned_contact.id===be?.id&&d.contact_creator&&d.contact_creator.id===be?.id&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{className:"inline-flex items-center justify-center w-full sm:w-auto bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 disabled:opacity-70 transition text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",onClick:()=>ue(d),disabled:_||w?.action?.type==="update"&&w.action.targetId===d.id,children:[a.jsx(gn,{className:"mr-2"}),"Edit"]}),a.jsx("button",{className:"inline-flex items-center justify-center w-full sm:w-auto px-4 py-2 rounded-md text-sm bg-orange-500 text-white hover:bg-orange-600 transition focus:outline-none focus:ring-2 focus:ring-orange-400",onClick:()=>re(d),disabled:!!Be,children:ce?"Archiving...":a.jsxs(a.Fragment,{children:[a.jsx(Zt,{className:"mr-2"}),"Archive"]})})]})})]}),a.jsx("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-2 px-2 lg:gap-4 md:mx-7 lg:mx-7",children:a.jsx("p",{className:"text-sm text-gray-500",children:d.account?.name||"No associated account"})}),a.jsx("div",{className:"border-b border-gray-200 my-5"}),a.jsxs("div",{className:"p-6 lg:p-4",children:[a.jsx("div",{className:"flex w-full bg-[#6A727D] text-white mt-1 overflow-x-auto mb-6",children:["Overview","Notes","Activities"].map(Y=>a.jsx("button",{onClick:()=>Z(Y),className:`flex-1 min-w-[90px] px-4 py-2.5 text-xs sm:text-sm font-medium text-center transition-all duration-200 border-b-2
        ${W===Y?"bg-paper-white text-[#6A727D] border-white":"text-white hover:bg-[#5c636d]"}`,children:Y},Y))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 items-start",children:[a.jsxs("div",{className:"lg:col-span-3",children:[W==="Overview"&&a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 md:p-8 border border-gray-200",children:a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4 sm:gap-6 text-sm text-gray-700",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Contact Name:"}),a.jsx("p",{children:vl(d)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Title:"}),a.jsx("p",{children:d.title||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Email:"}),a.jsx("p",{children:d.email?a.jsx("a",{href:`mailto:${d.email}`,className:"text-blue-600 hover:underline break-all",children:d.email}):"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Department:"}),a.jsx("p",{children:d.department||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Work Phone:"}),a.jsx("p",{children:d.work_phone||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Mobile Phone 1:"}),a.jsx("p",{children:d.mobile_phone_1||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Mobile Phone 2:"}),a.jsx("p",{children:d.mobile_phone_2||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Assigned To:"}),a.jsx("p",{children:d.assigned_contact?`${d.assigned_contact.first_name} ${d.assigned_contact.last_name}`:"Unassigned"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created By:"}),a.jsx("p",{children:d.contact_creator?`${d.contact_creator.first_name} ${d.contact_creator.last_name}`:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created At:"}),a.jsx("p",{children:Ii(d.created_at)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Last Updated:"}),a.jsx("p",{children:Ii(d.updated_at)||"N/A"})]})]})}),W==="Notes"&&a.jsxs("div",{className:"mt-4 w-full",children:[a.jsx("div",{className:"flex flex-wrap items-center justify-between mb-4 gap-2",children:a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words",children:"Contact Note"})}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 shadow-sm break-words",children:[a.jsx("div",{className:"flex items-start justify-between",children:a.jsx("div",{children:a.jsx("p",{className:"text-sm font-medium text-gray-800 break-words",children:"Note"})})}),a.jsx("div",{className:"mt-3 text-sm text-gray-700 whitespace-pre-wrap break-words",children:d.notes||"No notes available."})]}),a.jsx(Tn,{comments:he,onAddComment:Re})]}),W==="Activities"&&a.jsxs("div",{className:"space-y-2 w-full h-full max-h-[50dvh] overflow-y-auto bg-gray-50 p-2 hide-scrollbar rounded-lg border border-gray-200 shadow-sm",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words border-b border-gray-300 py-2",children:"Related Activities"}),a.jsxs("div",{className:"space-y-2 text-sm",children:[se.tasks&&se.tasks.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>ge(Ce==="tasks"?null:"tasks"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Qt,{className:"text-blue-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Tasks (",se.tasks.length,")"]})]}),Ce==="tasks"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Ce==="tasks"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:se.tasks.map((Y,U)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words",children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-blue-600 mt-1",children:a.jsx(Qt,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:Y.subject||Y.title||"Task"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:Y.description||"No description"}),Y.assigned_to&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Assigned: ",Y.assigned_to.first_name," ",Y.assigned_to.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:Ii(Y.due_date||Y.created_at)})]},`task-${U}`))})]}),se.meetings&&se.meetings.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>ge(Ce==="meetings"?null:"meetings"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Pt,{className:"text-green-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Meetings (",se.meetings.length,")"]})]}),Ce==="meetings"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Ce==="meetings"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:se.meetings.map((Y,U)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words",children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-green-600 mt-1",children:a.jsx(Pt,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:Y.subject||Y.title||"Meeting"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:Y.description||Y.location||"No description"}),Y.host&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Host: ",Y.host.first_name," ",Y.host.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:Ii(Y.start_time||Y.created_at)})]},`meeting-${U}`))})]}),se.calls&&se.calls.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>ge(Ce==="calls"?null:"calls"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(It,{className:"text-purple-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Calls (",se.calls.length,")"]})]}),Ce==="calls"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Ce==="calls"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:se.calls.map((Y,U)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words",children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-purple-600 mt-1",children:a.jsx(It,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:Y.subject||Y.title||"Call"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:Y.direction||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:Ii(Y.call_time||Y.created_at)})]},`call-${U}`))})]}),se.contacts&&se.contacts.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>ge(Ce==="contacts"?null:"contacts"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ra,{className:"text-teal-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Contacts (",se.contacts.length,")"]})]}),Ce==="contacts"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Ce==="contacts"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:se.contacts.map((Y,U)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words",children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-teal-600 mt-1",children:a.jsx(ra,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("h4",{className:"font-medium text-blue-600 break-words text-sm",children:[Y.first_name?`${Y.first_name} `:"",Y.last_name]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:Y.title||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:Ii(Y.created_at)})]},`contact-${U}`))})]}),se.deals&&se.deals.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>ge(Ce==="deals"?null:"deals"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(sa,{className:"text-indigo-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Deals (",se.deals.length,")"]})]}),Ce==="deals"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Ce==="deals"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:se.deals.map((Y,U)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words",children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-indigo-600 mt-1",children:a.jsx(sa,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("h4",{className:"font-medium text-blue-600 break-words text-sm",children:[Y.deal_id?Y.deal_id.replace(/D(\d+)-\d+-/,"D$1-"):"--"," ",Y.name||Y.title||"Deal"]}),a.jsx("p",{className:"text-xs text-gray-500 break-words capitalize",children:Y.stage||Y.description||"No description"})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:Ii(Y.close_date||Y.created_at)})]},`deal-${U}`))})]}),se.quotes&&se.quotes.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>ge(Ce==="quotes"?null:"quotes"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ia,{className:"text-orange-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Quotes (",se.quotes.length,")"]})]}),Ce==="quotes"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Ce==="quotes"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:se.quotes.map((Y,U)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words",children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-orange-600 mt-1",children:a.jsx(ia,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:(Y.quote_id?Y.quote_id.replace(/Q(\d+)-\d+-/,"Q$1-"):"--")||"Quote"}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:Y.status||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:Ii(Y.presented_date)||""})]},`quote-${U}`))})]}),(!se||(!se.tasks||se.tasks.length===0)&&(!se.meetings||se.meetings.length===0)&&(!se.calls||se.calls.length===0)&&(!se.quotes||se.quotes.length===0)&&(!se.deals||se.deals.length===0)&&(!se.contacts||se.contacts.length===0))&&a.jsx("div",{className:"text-center py-8 text-gray-500",children:a.jsx("p",{children:"No related activities found for this account."})})]})]})]}),a.jsx("div",{className:"flex flex-col gap-4",children:a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Quick Actions"}),a.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[a.jsxs("button",{onClick:()=>e("/sales/calls",{state:{openCallModal:!0,initialCallData:{subject:`Call with ${vl(d)||""}`.trim(),relatedType1:"Account",relatedTo1:d?.account_id?String(d.account_id):d?.account?.id?String(d.account.id):"",relatedType2:"Contact",relatedTo2:d?.id?String(d.id):"",assigned_to:d?.assigned_contact?.id?String(d.assigned_contact.id):"",direction:"Outgoing",status:"Planned"}}}),className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(It,{className:"text-gray-600 w-4 h-4"}),"Schedule Call"]}),a.jsxs("button",{type:"button",onClick:()=>{if(!d?.email){alert("No email address available");return}const Y=encodeURIComponent(d.email),U=encodeURIComponent(""),de=encodeURIComponent(""),Te=`mailto:${Y}?subject=${U}&body=${de}`;window.location.href=Te},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(sn,{className:"text-gray-600 w-4 h-4"}),"Send E-mail"]}),a.jsxs("button",{className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",onClick:()=>e("/sales/meetings",{state:{openMeetingModal:!0,initialMeetingData:{subject:`Meeting with ${vl(d)||""}`.trim(),relatedType1:"Account",relatedTo1:d?.account_id?String(d.account_id):d?.account?.id?String(d.account.id):"",relatedType2:"Contact",relatedTo2:d?.id?String(d.id):"",assignedTo:d?.assigned_contact?.id?String(d.assigned_contact.id):"",status:"Planned"}}}),children:[a.jsx(Pt,{className:"text-gray-600 w-4 h-4"}),"Book Meeting"]}),a.jsxs("button",{onClick:()=>e("/sales/tasks",{state:{openTaskModal:!0,initialTaskData:{subject:`Task for ${vl(d)||""}`.trim(),relatedType1:"Account",relatedTo1:d?.account_id?String(d.account_id):d?.account?.id?String(d.account.id):"",relatedType2:"Contact",relatedTo2:d?.id?String(d.id):"",assignedTo:d?.assigned_contact?.id?String(d.assigned_contact.id):"",priority:"NORMAL",status:"Not Started"}}}),className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(Qt,{className:"text-gray-600 w-4 h-4"}),"Tasks"]})]})]})})]})]})]})}):null,H=a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[r&&a.jsx(qt,{message:"Loading contacts..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0 w-full",children:[a.jsxs("h2",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(Xa,{className:"mr-2 text-blue-600"})," Contacts Management"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{onClick:()=>{K(),Me(!1)},className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 rounded-md hover:bg-gray-800 text-sm sm:text-base self-end sm:self-auto cursor-pointer",children:[a.jsx(aa,{className:"mr-2"})," Add Contact"]})})]}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search contacts",value:F,onChange:Y=>D(Y.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsx("div",{className:"w-full lg:w-1/4",children:a.jsx("select",{value:P,onChange:Y=>B(Y.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:rt.map(Y=>a.jsx("option",{value:Y.value,children:Y.label},Y.value??Y.label))})})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[600px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 text-sm tracking-wide font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 text-center w-12",children:a.jsx("input",{type:"checkbox",checked:Fe.length>0&&Fe.filter(Y=>Y.assigned_contact?.id===be?.id&&Y.contact_creator?.id===be?.id).every(Y=>Ie.includes(Y.id))&&Fe.some(Y=>Y.assigned_contact?.id===be?.id&&Y.contact_creator?.id===be?.id),onChange:Le,className:"form-checkbox h-4 w-4 text-blue-600 rounded focus:ring-blue-500 border-gray-300"})}),a.jsx("th",{className:"py-3 px-4 truncate",children:"Contact"}),a.jsx("th",{className:"py-3 px-4",children:"Account"}),a.jsx("th",{className:"py-3 px-4 truncate",children:"Contact Info"}),a.jsx("th",{className:"py-3 px-4",children:"Department"}),a.jsx("th",{className:"py-3 px-4",children:"Assigned To"}),a.jsx("th",{className:"py-3 px-4",children:"Created"}),a.jsx("th",{className:"py-3 px-4 text-center w-24",children:Ie.length>0?a.jsx("button",{onClick:Qe,className:"text-orange-600 hover:text-orange-800 transition p-1 rounded-full hover:bg-orange-50",title:`Archive ${Ie.length} selected contacts`,children:a.jsx(Zt,{size:18})}):""})]})}),a.jsx("tbody",{children:r?a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:8,children:"Loading contacts..."})}):at.length>0?Fe.map(Y=>{const U=[{Icon:sn,value:Y.email,key:"email"},{Icon:It,value:Y.work_phone,key:"work_phone"}].filter(de=>!!de.value);return a.jsxs("tr",{className:"hover:bg-gray-50 text-sm cursor-pointer transition",children:[a.jsx("td",{className:"py-3 px-4 align-top text-center",onClick:de=>de.stopPropagation(),children:Y.assigned_contact&&Y.assigned_contact.id===be?.id&&Y.contact_creator&&Y.contact_creator.id===be?.id?a.jsx("input",{type:"checkbox",checked:Ie.includes(Y.id),onChange:()=>De(Y.id),className:"form-checkbox h-4 w-4 text-blue-600 rounded focus:ring-blue-500 border-gray-300",onClick:de=>de.stopPropagation()}):null}),a.jsxs("td",{className:"py-3 px-4 align-top",onClick:()=>{Ct(Y),ot(Y.id)},children:[a.jsx("div",{className:"font-medium text-blue-600 hover:underline break-all text-sm",children:vl(Y)||"--"}),a.jsx("div",{className:"text-xs text-gray-500",children:Y.title||"No title"})]}),a.jsx("td",{className:"py-3 px-4 align-top",onClick:()=>{Ct(Y),ot(Y.id)},children:a.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-700",children:[a.jsx(Kx,{className:"text-gray-500 flex-shrink-0"}),a.jsx("span",{className:"break-words",children:Y.account?.name||"--"})]})}),a.jsx("td",{className:"py-3 px-4 align-top",onClick:()=>{Ct(Y),ot(Y.id)},children:U.length>0?a.jsx("div",{className:"space-y-1 text-gray-700",children:U.map(({Icon:de,value:Te,key:ie})=>{const Oe=wt.createElement(de,{className:"text-gray-500 flex-shrink-0"});return a.jsxs("div",{className:"flex items-center space-x-2 break-all text-sm",children:[Oe,a.jsx("span",{children:Te})]},ie)})}):a.jsx("span",{className:"text-gray-400 text-sm",children:"--"})}),a.jsx("td",{className:"py-3 px-4 align-top",onClick:()=>{Ct(Y),ot(Y.id)},children:a.jsxs("div",{className:"flex items-center space-x-2 text-gray-700 text-sm",children:[a.jsx(sa,{className:"text-gray-500 flex-shrink-0"}),a.jsx("span",{children:Y.department||"--"})]})}),a.jsx("td",{className:"py-3 px-4 align-top",onClick:()=>{Ct(Y),ot(Y.id)},children:a.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[a.jsx(ra,{className:"text-gray-500 flex-shrink-0"}),a.jsx("span",{children:Y.assigned_contact?`${Y.assigned_contact.first_name} ${Y.assigned_contact.last_name}`:"Unassigned"})]})}),a.jsx("td",{className:"py-3 px-4 align-top",onClick:()=>{Ct(Y),ot(Y.id)},children:a.jsxs("div",{className:"flex items-center space-x-2 text-gray-500",children:[a.jsx(Pt,{className:"text-gray-500 flex-shrink-0"}),a.jsx("span",{className:"text-xs",children:Ii(Y.created_at)||"--"})]})})]},Y.id)}):a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:8,children:"No contacts found."})})})]})}),a.jsx(ca,{className:"mt-4",totalItems:at.length,pageSize:we,currentPage:Q,onPrev:Ue,onNext:Ne,onPageSizeChange:Y=>{J(Y),le(1)},pageSizeOptions:[10,20,30,40,50],label:"contacts"})]}),te=p?a.jsx("div",{id:"modalBackdrop",onClick:ve,className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-full sm:max-w-3xl rounded-2xl shadow-lg p-4 sm:p-6 md:p-8 relative border border-gray-200 overflow-y-auto max-h-[90vh] hide-scrollbar",onClick:Y=>Y.stopPropagation(),children:[a.jsx("button",{onClick:()=>{je(),Me(!1)},className:"absolute top-4 right-4 text-gray-500 hover:text-black transition disabled:opacity-60",disabled:y||_,children:a.jsx(ea,{size:22})}),a.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800 mb-4 sm:mb-6 flex items-center justify-center",children:b?"Edit Contact":"Add New Contact"}),a.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",onSubmit:et,noValidate:!0,children:[a.jsx(Hc,{label:"First Name",name:"first_name",value:E.first_name,onChange:z,placeholder:"First name",disabled:y}),a.jsx(Hc,{label:"Last Name",name:"last_name",value:E.last_name,onChange:z,placeholder:"Last name",required:!0,isSubmitted:tt}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:col-span-2",children:[a.jsx(y8,{label:"Account",value:E.account_id,onChange:Y=>M(U=>({...U,account_id:Y})),items:b?ze:o||[],getLabel:Y=>Y?.name??"",placeholder:"Search account...",actions:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{type:"button",onClick:st,disabled:y,title:"Add account",className:"inline-flex items-center justify-center w-4 h-4 rounded-sm border border-gray-300 text-gray-600 hover:bg-gray-50 transition disabled:opacity-60",children:a.jsx(aa,{size:16})}),a.jsx("button",{type:"button",onClick:Ke,disabled:y,title:"Refresh accounts",className:"inline-flex items-center justify-center w-4 h-3 text-gray-600 hover:bg-gray-50 transition disabled:opacity-60",children:a.jsx(Br,{size:16})})]}),disabled:y||(b?ze.length===0:o.length===0),required:!0,isSubmitted:tt}),a.jsx(y8,{label:"Assigned To",value:E.assigned_to,onChange:Y=>M(U=>({...U,assigned_to:Y})),items:c||[],getLabel:Y=>`${Y?.first_name??""} ${Y?.last_name??""} (${Y?.role??""})`.trim(),placeholder:"Search assignee...",required:!0,isSubmitted:tt,disabled:y||c.length===0||be?.role==="Sales"})]}),a.jsx(Hc,{label:"Title",name:"title",value:E.title,onChange:z,placeholder:"Job title",disabled:y}),a.jsx(Hc,{label:"Department",name:"department",value:E.department,onChange:z,placeholder:"Department",disabled:y}),a.jsx(Hc,{label:"Email",name:"email",type:"email",value:E.email,onChange:z,placeholder:"example@email.com",required:!0,isSubmitted:tt}),a.jsx(Hc,{label:"Work Phone",name:"work_phone",value:E.work_phone,onChange:z,placeholder:"09xx xxx xxxx",disabled:y}),a.jsx(Hc,{label:"Mobile Phone 1",name:"mobile_phone_1",value:E.mobile_phone_1,onChange:z,placeholder:"09xx xxx xxxx",disabled:y}),a.jsx(Hc,{label:"Mobile Phone 2",name:"mobile_phone_2",value:E.mobile_phone_2,onChange:z,placeholder:"09xx xxx xxxx",disabled:y}),a.jsx(HFe,{label:"Notes",name:"notes",value:E.notes,onChange:z,placeholder:"Additional details...",rows:3,disabled:y,className:"md:col-span-2"}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-2 md:col-span-2 mt-4",children:[a.jsx("button",{type:"button",onClick:()=>{je(),Me(!1)},className:"w-full sm:w-auto px-4 py-2 text-white bg-red-400 border border-red-300 rounded hover:bg-red-500 transition disabled:opacity-70",disabled:y||_,children:"Cancel"}),a.jsx("button",{type:"submit",className:"w-full sm:w-auto px-4 py-2 text-white border border-tertiary bg-tertiary rounded hover:bg-secondary transition disabled:opacity-70",disabled:y||_,children:y?"Saving...":b?"Update Contact":"Save Contact"})]})]})]})}):null,q=w?a.jsx(qFe,{open:!0,title:w.title,message:w.message,confirmLabel:w.confirmLabel,cancelLabel:w.cancelLabel,variant:w.variant,onConfirm:yt,onCancel:_t,loading:_,icon:w.icon,isArchive:w.isArchive}):null;return a.jsxs(a.Fragment,{children:[H,fe,te,q]})}function Hc({label:e,name:t,value:n,onChange:s,placeholder:r,type:i="text",required:o=!1,disabled:l=!1,isSubmitted:c=!1,className:u=""}){const d=c&&!n?.trim();return a.jsxs("div",{children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",o&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:i,name:t,value:n??"",onChange:s,placeholder:r,required:o,disabled:l,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border focus:ring-2
          ${d?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}
          ${u}
        `})]})}function y8({label:e,items:t=[],value:n="",onChange:s,getLabel:r,placeholder:i="Search...",disabled:o=!1,className:l="",required:c=!1,isSubmitted:u=!1,actions:d=null}){const h=u&&c&&!n;return a.jsxs("div",{className:l,children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",c&&a.jsx("span",{className:"text-red-500",children:"*"})]}),d?a.jsx("div",{className:"flex items-center",children:d}):null]}),a.jsx(BFe,{items:t,value:n??"",onChange:s,getLabel:r,placeholder:i,disabled:o,hasError:h})]})}function BFe({items:e=[],value:t="",onChange:n,getLabel:s,placeholder:r="Search...",disabled:i=!1,maxRender:o=200,hasError:l=!1}){const[c,u]=f.useState(!1),[d,h]=f.useState(""),p=f.useRef(null),x=e.find(y=>String(y.id)===String(t)),b=x?s(x):"",j=f.useMemo(()=>{const y=d.trim().toLowerCase();return(y?e.filter(w=>(s(w)||"").toLowerCase().includes(y)):e).slice(0,o)},[e,d,s,o]);return f.useEffect(()=>{const y=N=>{p.current&&!p.current.contains(N.target)&&u(!1)};return document.addEventListener("mousedown",y),()=>document.removeEventListener("mousedown",y)},[]),f.useEffect(()=>{c||h("")},[c]),a.jsxs("div",{ref:p,className:"relative w-full",children:[a.jsx("input",{disabled:i,value:c?d:b,placeholder:r,onFocus:()=>!i&&u(!0),onChange:y=>{h(y.target.value),c||u(!0)},className:`w-full border rounded-md px-2 py-1.5 text-sm outline-none focus:ring-2 disabled:bg-gray-100
          ${l?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}`}),c&&!i&&a.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg overflow-hidden",children:[a.jsx("div",{className:"max-h-56 overflow-y-auto",children:j.length>0?j.map(y=>{const N=String(y.id),w=s(y),S=String(t)===N;return a.jsx("button",{type:"button",onClick:()=>{n(N),u(!1)},className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-50 ${S?"bg-blue-50":""}`,children:w||"--"},N)}):a.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No results"})}),e.length>o&&a.jsxs("div",{className:"px-3 py-2 text-[11px] text-gray-400 border-t",children:["Showing first ",o," results  keep typing to narrow."]})]})]})}function HFe({label:e,name:t,value:n,onChange:s,placeholder:r,rows:i=3,disabled:o=!1,className:l=""}){return a.jsxs("div",{className:l,children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsx("textarea",{name:t,value:n??"",onChange:s,placeholder:r,rows:i,disabled:o,className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100 resize-none"})]})}function qFe({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o=!1,onConfirm:l,onCancel:c,icon:u=null,isArchive:d=!1}){if(!e)return null;const h=d?"bg-orange-500 hover:bg-orange-600 border border-orange-400":i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsxs("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 flex items-center justify-center ${h}`,disabled:o,children:[u&&a.jsx(u,{className:"mr-2",size:18}),o?"Processing...":s]})]})]})})}const UA=e=>e?new Date(e).toLocaleString("en-US",{month:"short",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).replace(",",""):"";function yJ({lead:e,onBack:t,fetchLeads:n,onEdit:s,onArchive:r,setSelectedLead:i,relatedActs:o}){const l=Et(),{leadID:c}=Wo(),{user:u}=Gt(),[d,h]=f.useState(e||null),[p,x]=f.useState("Overview"),[b,j]=f.useState(""),y=d?.status?.toUpperCase()==="QUALIFIED",[N,w]=f.useState(null),S=d&&u&&d.creator?.id===u.id,[_,T]=f.useState({name:"",website:"",countryCode:"",phone_number:"",billing_address:"",shipping_address:"",industry:"",status:"Prospect",territory_id:null,assigned_to:null,created_by:null}),[k,A]=f.useState({last_name:"",first_name:"",account_id:null,title:"",department:"",email:"",work_phone:"",mobile_phone_1:"",mobile_phone_2:"",notes:"",assigned_to:null,created_by:null}),[E,M]=f.useState({name:"Converted from Lead",account_id:null,primary_contact_id:null,stage:"Prospecting",probability:10,amount:0,currency:"PHP",description:"Initial deal from lead conversion.",assigned_to:null,created_by:null}),F=async()=>{try{if(e){h(e),j(e.status||"New");return}if(!c)return;const $=await ne.get(`/leads/get/${c}`);h($.data),j($.data.status||"New"),T({name:$.data.company_name||"",website:"",countryCode:"+63",phone_number:"",billing_address:"",shipping_address:"",industry:"",status:"Prospect",territory_id:$.data.territory?.id||null,assigned_to:$.data.assigned_to?.id||null,created_by:$.data.creator?.id||null}),A({last_name:$.data.last_name||"",first_name:$.data.first_name||"",account_id:null,title:$.data.title||"",department:$.data.department||"",email:$.data.email||"",work_phone:$.data.work_phone||"",mobile_phone_1:$.data.mobile_phone_1||"",mobile_phone_2:$.data.mobile_phone_2||"",notes:"",assigned_to:$.data.assigned_to?.id||null,created_by:$.data.creator?.id||null}),M({name:"Converted from Lead",account_id:null,primary_contact_id:null,stage:"Prospecting",probability:10,amount:0,currency:"PHP",description:"Initial deal from lead conversion.",assigned_to:$.data.assigned_to?.id||null,created_by:$.data.creator?.id||null})}catch($){console.error($)}};f.useEffect(()=>{e?(h(e),j(e.status||"New")):c&&F()},[c,e]);const D=async()=>{try{if(b==="Converted"&&d?.status?.toUpperCase()!=="QUALIFIED"){V.error("Lead must be Qualified before it can be converted.");return}const $=await ne.put(`/leads/${d.id}/update/status`,{status:b});V.success("Lead status updated successfully");const W={...d,status:$.data.status};h(W),i&&i(W),n&&n(),t&&t()}catch($){console.error($),V.error("Failed to update lead status")}},P=async $=>{const W={..._,assigned_to:$.assigned_to?.id,billing_address:$.address,shipping_address:$.address,created_by:$.creator?.id,industry:null,name:$.company_name,phone_number:$.work_phone,status:"Prospect",territory_id:$.territory?.id,website:""};console.log("Account data: ",W),console.log("Contact data: ",k),console.log("Deal data: ",E),console.log("Lead data: ",$);try{const Q=(await ne.post("/accounts/convertedLead",W)).data.id,le={...k,account_id:Q,assigned_to:$.assigned_to?.id,created_by:$.creator?.id,department:$.department,email:$.email,first_name:$.first_name,last_name:$.last_name,mobile_phone_1:$.mobile_phone_1,mobile_phone_2:$.mobile_phone_2,notes:$.notes,title:$.title,work_phone:$.work_phone},J=(await ne.post("/contacts/convertedLead",le)).data.id,se=()=>{switch(E.stage){case"PROSPECTING":return 10;case"QUALIFICATION":return 25;case"PROPOSAL":return 60;case"NEGOTIATION":return 80;case"CLOSED_WON":return 100;case"CLOSED_LOST":return 0;default:return 0}},ye=E.amount&&E.amount!==""?parseFloat(E.amount):0,Ce={...E,account_id:Q,assigned_to:$.assigned_to?.id,created_by:$.creator?.id,primary_contact_id:J,probability:se(),stage:"Prospecting"},ge=await ne.post("/deals/convertedLead",Ce),be=await ne.put(`/leads/convert/${$.id}`);i&&i(null),n(),V.success("Lead converted successfully!"),t()}catch(Z){console.error("Error during conversion:",Z);const Q=Z.response?.data?.detail||Z.message||"Failed to convert lead. Please try again.";V.error(Q)}},B=$=>{switch(($||"").toUpperCase()){case"NEW":return"bg-indigo-100 text-indigo-700";case"CONTACTED":return"bg-blue-100 text-blue-700";case"QUALIFIED":return"bg-green-100 text-green-700";case"CONVERTED":return"bg-emerald-100 text-emerald-700";case"LOST":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-700"}},G=$=>$.toString().toLowerCase().replace(/\b\w/g,W=>W.toUpperCase());return d?a.jsx(a.Fragment,{children:a.jsx("div",{className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-lg w-full max-w-full sm:max-w-6xl max-h-[90vh] overflow-y-auto hide-scrollbar relative box-border",children:[a.jsx("div",{className:"bg-tertiary w-full rounded-t-xl p-3 lg:p-3",children:a.jsxs("div",{className:"flex items-start justify-between w-full",children:[a.jsx("h1",{className:"lg:text-3xl text-xl text-white font-semibold text-center w-full",children:"Lead"}),a.jsx("button",{onClick:()=>{t?t():l(-1)},className:"text-gray-400 hover:text-white mt-1 cursor-pointer",children:a.jsx(Za,{size:25})})]})}),a.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between lg:flex-row lg:items-center lg:justify-between mt-3 gap-2 px-2 md:items-center lg:gap-4 md:mx-7 lg:mx-7",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[a.jsxs("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-800",children:[d.first_name," ",d.last_name]}),a.jsx("span",{className:`text-xs sm:text-sm font-medium px-2 sm:px-3 py-1 rounded-full whitespace-nowrap ${B(d.status)}`,children:G(d.status||"New")}),a.jsx("div",{className:"flex flex-col",children:a.jsx("button",{onClick:()=>P(d),disabled:!y,title:y?"Convert Lead":"Lead must be Qualified before converting",className:`px-3 sm:px-4 py-1.5 sm:py-2 rounded-md font-medium text-xs sm:text-sm transition focus:outline-none focus:ring-2
      ${y?"bg-green-600 hover:bg-green-700 text-white focus:ring-green-400":"bg-gray-200 text-gray-400 cursor-not-allowed"}
    `,children:"Convert"})})]}),S&&a.jsxs("div",{className:"flex flex-col sm:flex-row sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsxs("button",{type:"button",onClick:()=>{s&&d&&s(d)},className:"inline-flex items-center justify-center w-full sm:w-auto bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 transition text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",children:[a.jsx(hn,{className:"mr-2"}),"Edit"]}),a.jsxs("button",{type:"button",onClick:()=>{r&&d&&r(d)},className:"inline-flex items-center justify-center w-full sm:w-auto px-4 py-2 rounded-md text-sm bg-orange-500 text-white hover:bg-orange-600 transition focus:outline-none focus:ring-2 focus:ring-orange-400",children:[a.jsx(Zt,{className:"mr-2"}),"Archive"]})]})]}),a.jsx("div",{className:"border-b border-gray-200 my-5"}),a.jsxs("div",{className:"p-4 lg:p-4",children:[a.jsx("div",{className:"flex w-full bg-[#6A727D] text-white mt-1 overflow-x-auto mb-6",children:["Overview","Notes","Activities"].map($=>a.jsx("button",{onClick:()=>x($),className:`flex-1 min-w-[90px] px-4 py-2.5 text-xs sm:text-sm font-medium text-center transition-all duration-200 border-b-2
        ${p===$?"bg-paper-white text-[#6A727D] border-white":"text-white hover:bg-[#5c636d]"}`,children:$},$))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 items-start",children:[a.jsxs("div",{className:"lg:col-span-3",children:[p==="Overview"&&a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 md:p-8 border border-gray-200",children:a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4 sm:gap-6 text-sm text-gray-700",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Name:"}),a.jsxs("p",{children:[d.first_name," ",d.last_name||"N/A"]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Company:"}),a.jsx("p",{children:d.company_name||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Job Title:"}),a.jsx("p",{children:d.title||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Department:"}),a.jsx("p",{children:d.department||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Email:"}),a.jsx("p",{children:d.email||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Territory:"}),a.jsx("p",{children:d.territory?.name||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Assigned To:"}),a.jsx("p",{children:d.assigned_to?`${d.assigned_to.first_name} ${d.assigned_to.last_name}`:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created By:"}),a.jsx("p",{children:d.creator?`${d.creator.first_name} ${d.creator.last_name}`:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Work Phone:"}),a.jsx("p",{children:d.work_phone||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Mobile Phone 1:"}),a.jsx("p",{children:d.mobile_phone_1||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Mobile Phone 2:"}),a.jsx("p",{children:d.mobile_phone_2||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Source:"}),a.jsx("p",{children:d.source||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Address:"}),a.jsx("p",{children:d.address||"N/A"})]})]})}),p==="Notes"&&a.jsxs("div",{className:"mt-4 w-full",children:[a.jsx("div",{className:"flex flex-wrap items-center justify-between mb-4 gap-2",children:a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words",children:"Lead Note"})}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 shadow-sm break-words",children:[a.jsx("div",{className:"flex items-start justify-between",children:a.jsx("div",{children:a.jsx("p",{className:"text-sm font-medium text-gray-800 break-words",children:"Note"})})}),a.jsx("div",{className:"mt-3 text-sm text-gray-700 whitespace-pre-wrap break-words",children:d.notes||"No notes available."})]})]}),p==="Activities"&&a.jsxs("div",{className:"space-y-2 w-full h-full max-h-[50dvh] overflow-y-auto bg-gray-50 p-2 hide-scrollbar rounded-lg border border-gray-200 shadow-sm",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words border-b border-gray-300 py-2",children:"Related Activities"}),a.jsxs("div",{className:"space-y-2 text-sm",children:[o.tasks&&o.tasks.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>w(N==="tasks"?null:"tasks"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Qt,{className:"text-blue-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Tasks (",o.tasks.length,")"]})]}),N==="tasks"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),N==="tasks"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:o.tasks.map(($,W)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words",children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-blue-600 mt-1",children:a.jsx(Qt,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:$.subject||$.title||"Task"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:$.description||"No description"}),$.assigned_to&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Assigned:"," ",$.assigned_to.first_name," ",$.assigned_to.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:UA($.due_date||$.created_at)})]},`task-${W}`))})]}),o.meetings&&o.meetings.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>w(N==="meetings"?null:"meetings"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Pt,{className:"text-green-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Meetings (",o.meetings.length,")"]})]}),N==="meetings"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),N==="meetings"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:o.meetings.map(($,W)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words",children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-green-600 mt-1",children:a.jsx(Pt,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:$.subject||$.title||"Meeting"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:$.description||$.location||"No description"}),$.host&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Host: ",$.host.first_name," ",$.host.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:UA($.start_time||$.created_at)})]},`meeting-${W}`))})]}),o.calls&&o.calls.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>w(N==="calls"?null:"calls"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(It,{className:"text-purple-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Calls (",o.calls.length,")"]})]}),N==="calls"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),N==="calls"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:o.calls.map(($,W)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words",children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-purple-600 mt-1",children:a.jsx(It,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:$.subject||$.title||"Call"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:$.direction||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:UA($.call_time||$.created_at)})]},`call-${W}`))})]}),(!o||(!o.tasks||o.tasks.length===0)&&(!o.meetings||o.meetings.length===0)&&(!o.calls||o.calls.length===0)&&(!o.quotes||o.quotes.length===0)&&(!o.deals||o.deals.length===0)&&(!o.contacts||o.contacts.length===0))&&a.jsx("div",{className:"text-center py-8 text-gray-500",children:a.jsx("p",{children:"No related activities found for this account."})})]})]})]}),a.jsxs("div",{className:"flex flex-col gap-4",children:[a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Quick Actions"}),a.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[a.jsxs("button",{onClick:()=>{d&&l("/sales/calls",{state:{openCallModal:!0,initialCallData:{subject:d.title?`Call regarding ${d.title}`:`Call with ${d.first_name} ${d.last_name}`,relatedType1:"Lead",relatedTo1:String(d.id),relatedType2:null,relatedTo2:null,assigned_to:d.assigned_to?.id?String(d.assigned_to.id):"",direction:"Outgoing",status:"Planned"}}})},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(It,{className:"text-gray-600 w-4 h-4"}),"Schedule Call"]}),a.jsxs("button",{type:"button",onClick:()=>{if(!d?.email){alert("No email address available");return}const $=encodeURIComponent(d.email),W=encodeURIComponent(""),Z=encodeURIComponent(""),Q=`mailto:${$}?subject=${W}&body=${Z}`;window.location.href=Q},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(sn,{className:"text-gray-600 w-4 h-4"}),"Send E-mail"]}),a.jsxs("button",{className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",onClick:()=>{d&&l("/sales/meetings",{state:{openMeetingModal:!0,initialMeetingData:{subject:d.title?`Meeting regarding ${d.title}`:`Meeting with ${d.first_name||""} ${d.last_name||""}`.trim(),relatedType1:"Lead",relatedTo1:String(d.id),relatedType2:null,relatedTo2:null,assignedTo:d.assigned_to?.id?String(d.assigned_to.id):"",status:"Planned"}}})},children:[a.jsx(Pt,{className:"text-gray-600 w-4 h-4"}),"Book Meeting"]}),a.jsxs("button",{onClick:()=>{d&&l("/sales/tasks",{state:{openTaskModal:!0,initialTaskData:{subject:d.title?`Follow up on ${d.title}`:`Follow up with ${d.first_name||""} ${d.last_name||""}`.trim(),relatedType1:"Lead",relatedTo1:String(d.id),relatedType2:null,relatedTo2:null,assignedTo:d.assigned_to?.id?String(d.assigned_to.id):"",priority:"NORMAL",status:"Not Started"}}})},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(Qt,{className:"text-gray-600 w-4 h-4"}),"Tasks"]})]})]}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm w-full",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Status"}),a.jsxs("select",{className:"border border-gray-200 rounded-md px-2 sm:px-3 py-1.5 w-full text-sm mb-2 focus:ring-2 focus:ring-indigo-500 outline-none",value:b,onChange:$=>j($.target.value),children:[a.jsx("option",{value:"New",children:"New"}),a.jsx("option",{value:"Contacted",children:"Contacted"}),a.jsx("option",{value:"Qualified",children:"Qualified"}),d?.status?.toUpperCase()==="QUALIFIED"&&a.jsx("option",{value:"Converted",children:"Converted"}),a.jsx("option",{value:"Lost",children:"Lost"})]}),a.jsx("button",{onClick:D,disabled:b===d.status,className:`w-full py-1.5 rounded-md text-sm transition focus:outline-none focus:ring-2 ${b===d.status?"bg-gray-400 cursor-not-allowed text-white":"bg-gray-900 text-white hover:bg-gray-800 focus:ring-gray-400"}`,children:"Update"})]})]})]})]})]})})}):null}const GFe=oh.all(),BA=GFe.map((e,t)=>({code:`+${e.countryCallingCode}`,name:e.countryCode,id:`${e.countryCallingCode}-${e.countryCode}-${t}`})),WFe=e=>e.toString().toLowerCase().replace(/\b\w/g,t=>t.toUpperCase()),VFe=e=>{switch(e.toUpperCase()){case"NEW":return"bg-indigo-100 text-indigo-700";case"CONTACTED":return"bg-blue-100 text-blue-700";case"QUALIFIED":return"bg-green-100 text-green-700";case"CONVERTED":return"bg-emerald-100 text-emerald-700";case"LOST":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-700"}},HA={first_name:"",last_name:"",company_name:"",title:"",department:"",email:"",work_ccode:"+63",work_phone:"",m1_ccode:"+63",mobile_phone_1:"",m2_ccode:"+63",mobile_phone_2:"",address:"",notes:"",source:"",territory_id:null,lead_owner:null,status:"New"};function YFe(){const e=Et(),{leadID:t}=Wo();Bs();const[n,s]=f.useState(null),[r,i]=f.useState(!1),[o,l]=f.useState(null),[c,u]=f.useState(null),[d,h]=f.useState([]),[p,x]=f.useState(!1),[b,j]=f.useState(""),[y,N]=f.useState("Filter by Status"),[w,S]=f.useState(1),[_,T]=f.useState(10),[k,A]=f.useState(HA),[E,M]=f.useState(!1),[F,D]=f.useState(null),[P,B]=f.useState(!1),[G,$]=f.useState(null),[W,Z]=f.useState(!1),[Q,le]=f.useState({}),[we,J]=f.useState(new Set),[se,ye]=f.useState(!1),[Ce,ge]=f.useState(null);f.useRef(null);const[be,me]=f.useState(!1),[Ae,pe]=f.useState(null),[Ie,xe]=f.useState({name:"",website:"",countryCode:"+63",phone_number:"",combinedPhoneNumbers:"",billing_address:"",shipping_address:"",industry:"",status:"Prospect",territory_id:null,assigned_to:null,created_by:null}),[he,Re]=f.useState({last_name:"",first_name:"",account_id:null,title:"",department:"",email:"",work_phone:"",mobile_phone_1:"",mobile_phone_2:"",notes:"",assigned_to:null,created_by:null}),[Ee,He]=f.useState({name:"Converted from Lead",account_id:null,primary_contact_id:null,stage:"PROSPECTING",probability:10,amount:0,currency:"PHP",description:"Initial deal from lead conversion.",assigned_to:null,created_by:null});f.useEffect(()=>{document.title="Leads | Sari-Sari CRM"},[]);const Ke=async()=>{try{const te=await ne.get("/leads/getUsers");l(te.data)}catch(te){console.error(`Error fetching users: ${te}`)}},st=async()=>{x(!0);try{const te=await ne.get("/leads/admin/getLeads");h(te.data),console.log(te.data)}catch(te){console.error(`Error fetching leads: ${te}`)}finally{x(!1)}};f.useEffect(()=>{Ke(),st()},[]);const{user:it}=Gt(),ot=it?.role==="Sales";f.useEffect(()=>{r&&!E&&ot&&it&&!k.lead_owner&&(A(te=>({...te,lead_owner:it.id})),u(it))},[r,E,ot,it,k.lead_owner]),f.useEffect(()=>{if(t&&d.length>0&&!r&&!E){const te=d.find(q=>q.id===Number(t));te&&s(te)}else!t&&!n&&s(null)},[t,d,r,E]),f.useEffect(()=>{if(Ae){const q=(de=>{if(!de)return{code:"+63",number:""};const Te=de.match(/^(\+\d+)\s(.+)$/);if(Te)return{code:Te[1],number:Te[2]};if(de.startsWith("+")){const ie=de.match(/^(\+\d{1,3})/);if(ie)return{code:ie[1],number:de.substring(ie[1].length).trim()}}return{code:"+63",number:de}})(Ae.work_phone),Y=[];Ae.work_phone&&Y.push(`Work: ${Ae.work_phone}`),Ae.mobile_phone_1&&Y.push(`Mobile 1: ${Ae.mobile_phone_1}`),Ae.mobile_phone_2&&Y.push(`Mobile 2: ${Ae.mobile_phone_2}`);const U=Y.length>0?Y.join(" | "):"";xe({name:Ae.company_name||"",website:"",countryCode:q.code,phone_number:q.number,combinedPhoneNumbers:U,billing_address:Ae.address||"",shipping_address:Ae.address||"",industry:"",status:"Prospect",territory_id:Ae.assigned_to?.territory?.id||null,assigned_to:Ae.assigned_to?.id||null,created_by:Ae.creator?.id||null}),Re({last_name:Ae.last_name||"",first_name:Ae.first_name||"",account_id:null,title:Ae.title||"",department:Ae.department||"",email:Ae.email||"",work_phone:Ae.work_phone||"",mobile_phone_1:Ae.mobile_phone_1||"",mobile_phone_2:Ae.mobile_phone_2||"",notes:Ae.notes||"",assigned_to:Ae.assigned_to?.id||null,created_by:Ae.creator?.id||null}),He({name:"Converted from Lead",account_id:null,primary_contact_id:null,stage:"PROSPECTING",probability:10,amount:0,currency:"PHP",description:"Initial deal from lead conversion.",assigned_to:Ae.assigned_to?.id||null,created_by:Ae.creator?.id||null})}},[Ae]);const rt=te=>j(te.target.value),at=f.useMemo(()=>{const te=b.trim().toLowerCase(),q=y.trim().toUpperCase();let Y=d.filter(U=>{const de=[U?.first_name,U?.last_name,U?.company_name,U?.title,U?.email,U?.work_phone,U?.assigned_to?`${U.assigned_to.first_name} ${U.assigned_to.last_name}`:""],Te=te===""||de.some(Oe=>Oe==null||Oe===""?!1:Oe.toString().toLowerCase().includes(te));let ie=!1;if(q==="FILTER BY STATUS"){const Oe=U.status?U.status.toUpperCase():"";ie=Oe!=="CONVERTED"&&Oe!=="INACTIVE"}else ie=(U.status?U.status.toUpperCase():"")===q;return Te&&ie});return Y.sort((U,de)=>{const Te=new Date(U.created_at).getTime();return new Date(de.created_at).getTime()-Te}),Y},[d,b,y]),Je=Math.max(1,Math.ceil(at.length/_)||1);f.useEffect(()=>{S(1)},[b,y]),f.useEffect(()=>{S(te=>{const q=Math.max(1,Math.ceil(at.length/_)||1);return te>q?q:te})},[at.length,_]);const Fe=f.useMemo(()=>{const te=(w-1)*_;return at.slice(te,te+_)},[at,w,_]),Ue=()=>S(te=>Math.max(te-1,1)),Ne=()=>S(te=>Math.min(te+1,Je)),ze=f.useCallback(async te=>{try{const q=await ne.get(`/activities/lead/${te}`);le(q.data&&typeof q.data=="object"?q.data:{})}catch(q){console.error(q),q.response?.status===404&&(console.warn("No activities found for this account."),le({}))}},[]),je=te=>{s(te),ze(te.id)},ve=()=>{s(null),t&&e("/admin/leads",{replace:!0})},z=()=>{i(!1),A(HA),M(!1),D(null),B(!1),u(null),sessionStorage.removeItem("editLeadData")},K=te=>{te.target.id==="modalBackdrop"&&z()},ue=()=>{A(HA),M(!1),D(null),u(null),i(!0)},re=te=>{if(!te){console.error("handleEditClick: lead is null or undefined");return}console.log("handleEditClick called with lead:",te),console.log("Current state - leadID:",t,"selectedLead:",n,"showModal:",r);const q=ie=>{if(!ie)return{code:"+63",number:""};const Oe=ie.match(/^(\+\d+)\s(.+)$/);return Oe?{code:Oe[1],number:Oe[2]}:{code:"+63",number:ie}},Y=q(te.work_phone),U=q(te.mobile_phone_1),de=q(te.mobile_phone_2);let Te="";if(te.assigned_to){Te=String(te.assigned_to.id);const ie=o?.find(Oe=>Oe.id===te.assigned_to.id);u(ie)}A({first_name:te.first_name||"",last_name:te.last_name||"",company_name:te.company_name||"",title:te.title||"",department:te.department||"",email:te.email||"",work_ccode:Y.code,work_phone:Y.number,m1_ccode:U.code,mobile_phone_1:U.number,m2_ccode:de.code,mobile_phone_2:de.number,address:te.address||"",notes:te.notes||"",source:te.source||"",territory_id:te.territory?.id||null,lead_owner:Te,status:te.status||"New"}),M(!0),D(te.id),n?(console.log("Coming from detail view - closing detail modal and showing edit form"),s(null),i(!0)):(console.log("Already in list view - showing modal"),i(!0))},Le=te=>{if(!te){console.error("handleArchive: lead is null or undefined");return}const q=`${te.first_name} ${te.last_name}`||"this lead";$({title:"Archive Lead",message:a.jsxs("span",{children:["Are you sure you want to archive"," ",a.jsx("span",{className:"font-semibold",children:q}),"? You can restore it later if needed."]}),confirmLabel:"Archive Lead",cancelLabel:"Cancel",variant:"archive",action:{type:"archive",targetId:te.id,name:q}})},De=te=>{const q=d.find(U=>U.id===te);!q||!(q.creator?.id===it?.id)||J(U=>{const de=new Set(U);return de.has(te)?de.delete(te):de.add(te),de})},Qe=()=>{const te=Fe.filter(q=>q.creator?.id===it?.id);we.size===te.length&&te.length>0?J(new Set):J(new Set(te.map(q=>q.id)))},tt=()=>{if(we.size===0){V.warning("Please select at least one lead to archive.");return}const te=we.size;$({title:"Archive Leads",message:a.jsxs("span",{children:["Are you sure you want to archive ",a.jsx("span",{className:"font-semibold",children:te})," lead",te>1?"s":"","? They will be marked as inactive."]}),confirmLabel:`Archive ${te} Lead${te>1?"s":""}`,cancelLabel:"Cancel",variant:"archive",action:{type:"bulk-archive",targetIds:Array.from(we)}})},Me=te=>{const{name:q,value:Y}=te.target;if(A(U=>({...U,[q]:Y})),q==="lead_owner"){const U=o.find(de=>de.id===parseInt(Y));u(U)}},[et,yt]=f.useState(!1),_t=te=>{if(te.preventDefault(),yt(!0),!k.last_name?.trim()){V.error("Last name is required.");return}if(!k.email?.trim()){V.error("Email is required.");return}if(!k.email.includes("@")){V.error("Email must contain '@'.");return}if(!k.lead_owner){V.error("Please assign a lead owner.");return}const q={...k,territory_id:k.territory_id?parseInt(k.territory_id):null,lead_owner:parseInt(k.lead_owner),work_phone:`${k.work_ccode} ${k.work_phone}`,mobile_phone_1:`${k.m1_ccode} ${k.mobile_phone_1}`,mobile_phone_2:`${k.m2_ccode} ${k.mobile_phone_2}`},Y=E&&F?"update":"create",U=`${k.first_name} ${k.last_name}`;$({title:Y==="create"?"Confirm New Lead":"Confirm Update",message:Y==="create"?a.jsxs("span",{children:["Are you sure you want to create a new lead for"," ",a.jsx("span",{className:"font-semibold",children:U}),"?"]}):a.jsxs("span",{children:["Save changes to ",a.jsx("span",{className:"font-semibold",children:U}),"?"]}),confirmLabel:Y==="create"?"Create Lead":"Update Lead",cancelLabel:"Cancel",variant:"primary",action:{type:Y,payload:q,targetId:F||null,name:U}})},Ct=async()=>{if(!G?.action){$(null);return}const{action:te}=G,{type:q,payload:Y,targetId:U,name:de,lead:Te}=te;console.log(Y),Z(!0);try{if(q==="create")B(!0),await ne.post("/leads/create",Y),V.success(`Lead "${de}" created successfully.`),z(),await st();else if(q==="update"){if(!U)throw new Error("Missing lead identifier for update.");B(!0);const ie=await ne.put(`/leads/${U}`,Y);V.success(`Lead "${de}" updated successfully.`),n&&n.id===U&&s(null),z(),await st()}else if(q==="delete"){if(!U)throw new Error("Missing lead identifier for deletion.");await ne.delete(`/leads/${U}`),V.success(`Lead "${de}" deleted successfully.`),n?.id===U&&s(null),await st()}else if(q==="archive"){if(!U)throw new Error("Missing lead identifier for archiving.");const ie=n?.id;ge(U),await ne.put(`/leads/${U}`,{status:"Inactive"}),V.success(`Lead "${de}" archived successfully.`),await st(),ie===U&&s(null)}else if(q==="bulk-archive"){const ie=te.targetIds;if(!ie||ie.length===0)throw new Error("Missing leads to archive.");ye(!0),await Promise.all(ie.map(Oe=>ne.put(`/leads/${Oe}`,{status:"Inactive"}))),V.success(`${ie.length} lead${ie.length>1?"s":""} archived successfully.`),J(new Set),n&&ie.includes(n.id)&&s(null),await st()}}catch(ie){console.error(ie);const Oe=q==="create"?"Failed to create lead. Please review the details and try again.":q==="update"?"Failed to update lead. Please review the details and try again.":q==="delete"?"Failed to delete lead. Please try again.":q==="archive"?"Failed to archive lead. Please try again.":"Failed to archive leads. Please try again.",X=ie.response?.data?.detail||Oe;V.error(X)}finally{(q==="create"||q==="update")&&B(!1),q==="archive"&&ge(null),q==="bulk-archive"&&ye(!1),q!=="edit"&&(Z(!1),$(null))}},jt=()=>{W||$(null)},At=d.filter(te=>te.status==="New").length,Ge=d.filter(te=>te.status==="Contacted").length,Be=d.filter(te=>te.status==="Qualified").length,ce=d.filter(te=>te.status==="Converted").length,fe=d.filter(te=>te.status==="Lost").length,H=[{title:"New",value:At,icon:rn,color:"text-indigo-600",bgColor:"bg-indigo-100"},{title:"Contacted",value:Ge,icon:It,color:"text-blue-600",bgColor:"bg-blue-100"},{title:"Qualified",value:Be,icon:La,color:"text-green-600",bgColor:"bg-green-100"},{title:"Converted",value:ce,icon:ec,color:"text-emerald-600",bgColor:"bg-emerald-100"},{title:"Lost",value:fe,icon:Yn,color:"text-red-600",bgColor:"bg-red-100"}];return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[p&&a.jsx(qt,{message:"Loading leads..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h1",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(rn,{className:"mr-2 text-blue-600"}),"Leads"]}),a.jsx("div",{className:"flex justify-center lg:justify-end gap-3 w-full sm:w-auto",children:a.jsxs("button",{onClick:()=>{ue(),yt(!1)},className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 rounded-md hover:bg-gray-800 text-sm sm:text-base self-end sm:self-auto cursor-pointer",children:[a.jsx(aa,{className:"mr-2"})," Add Lead"]})})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 xl:grid-cols-5 gap-4 mb-6 w-full break-words overflow-hidden lg:overflow-visible",children:H.map(te=>a.jsx(KFe,{...te},te.title))}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search leads",value:b,onChange:rt,className:"focus:outline-none text-base w-full"})]}),a.jsx("div",{className:"w-full lg:w-1/4",children:a.jsxs("select",{value:y,onChange:te=>N(te.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{value:"Filter by Status",children:"Filter by Status"}),a.jsx("option",{value:"New",children:"New"}),a.jsx("option",{value:"Contacted",children:"Contacted"}),a.jsx("option",{value:"Qualified",children:"Qualified"}),a.jsx("option",{value:"Converted",children:"Converted"}),a.jsx("option",{value:"Lost",children:"Lost"})]})})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[600px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 text-sm tracking-wide font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 w-12",children:a.jsx("input",{type:"checkbox",checked:we.size>0&&we.size===Fe.filter(te=>te.creator?.id===it?.id).length&&Fe.filter(te=>te.creator?.id===it?.id).length>0,onChange:Qe,className:"w-4 h-4 cursor-pointer"})}),a.jsx("th",{className:"py-3 px-4",children:"Name"}),a.jsx("th",{className:"py-3 px-4",children:"Company"}),a.jsx("th",{className:"py-3 px-4",children:"Job Title"}),a.jsx("th",{className:"py-3 px-4",children:"Email"}),a.jsx("th",{className:"py-3 px-4",children:"Assigned To"}),a.jsx("th",{className:"py-3 px-4",children:"Status"}),a.jsx("th",{className:"py-3 px-4 w-12",children:we.size>0&&a.jsx("button",{onClick:tt,className:"text-orange-500 hover:text-orange-700 transition",title:"Archive selected leads",disabled:se,children:a.jsx(Zt,{size:18})})})]})}),a.jsx("tbody",{children:at.length>0?Fe.map(te=>a.jsxs("tr",{className:"hover:bg-gray-50 text-sm cursor-pointer transition",onClick:()=>je(te),children:[a.jsx("td",{className:"py-3 px-4 w-12",onClick:q=>q.stopPropagation(),children:te.creator?.id===it?.id&&a.jsx("input",{type:"checkbox",checked:we.has(te.id),onChange:q=>{q.stopPropagation(),De(te.id)},className:"w-4 h-4 cursor-pointer"})}),a.jsx("td",{className:"py-3 px-4",children:a.jsxs("div",{className:"font-medium text-blue-600 hover:underline break-all text-sm",children:[te.first_name," ",te.last_name]})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("div",{className:"font-medium text-gray-800 text-sm leading-tight",children:te.company_name||"--"})}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",children:te.title||"--"}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",children:te.email||"--"}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",children:te.assigned_to?`${te.assigned_to.first_name} ${te.assigned_to.last_name}`:"--"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium whitespace-nowrap ${VFe(te.status||"New")}`,children:WFe(te.status||"New")})}),a.jsx("td",{className:"py-3 px-4 w-12"})]},te.id)):a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:8,children:"No leads found."})})})]})}),a.jsx(ca,{className:"mt-4",totalItems:at.length,pageSize:_,currentPage:w,onPrev:Ue,onNext:Ne,onPageSizeChange:te=>{T(te),S(1)},pageSizeOptions:[10,20,30,40,50],label:"leads"}),r&&a.jsx("div",{id:"modalBackdrop",onClick:K,className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-full sm:max-w-3xl rounded-2xl shadow-lg p-4 sm:p-6 md:p-8 relative border border-gray-200 overflow-y-auto max-h-[90vh] hide-scrollbar",onClick:te=>te.stopPropagation(),children:[a.jsx("button",{onClick:()=>{z(),yt(!1)},className:"absolute top-4 right-4 text-gray-500 hover:text-black transition",children:a.jsx(ea,{size:22})}),a.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800 mb-4 sm:mb-6 flex items-center justify-center",children:E?"Edit Lead":"Add New Lead"}),a.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 text-sm",children:[a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"First Name"}),a.jsx("input",{type:"text",name:"first_name",value:k.first_name,onChange:Me,placeholder:"Joe",className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:["Last Name ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",placeholder:"Smith",name:"last_name",value:k.last_name,onChange:Me,required:!0,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border
                      ${et&&!k.last_name?.trim()?"border-red-400 focus:ring-red-400":"border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"}
                  focus:ring-2`})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Company "}),a.jsx("input",{type:"text",placeholder:"ABC Company",name:"company_name",value:k.company_name,onChange:Me,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Job Title"}),a.jsx("input",{type:"text",placeholder:"ABC Agenda",name:"title",value:k.title,onChange:Me,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Department"}),a.jsx("input",{type:"text",placeholder:"Sales",name:"department",value:k.department,onChange:Me,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:["Email",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"email",placeholder:"abc@gmail.com",name:"email",value:k.email,onChange:Me,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border
                       ${et&&!k.email?.trim()?"border-red-400 focus:ring-red-400":"border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"}
                      focus:ring-2`})]}),a.jsxs("div",{className:"flex flex-col col-span-1 md:col-span-2 lg:col-span-1",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Work Phone"}),a.jsxs("div",{className:"w-full border border-gray-300 rounded-md focus-within:ring-2 focus-within:ring-blue-400 outline-none flex flex-row gap-1",children:[a.jsx("select",{name:"work_ccode",value:k.work_ccode,onChange:Me,className:"outline-none cursor-pointer py-1.5 px-2 border-r border-gray-400 text-sm",children:BA.map(te=>a.jsx("option",{value:te.code,children:te.code},te.id))}),a.jsx("input",{type:"text",placeholder:"9----------",name:"work_phone",value:k.work_phone,onChange:Me,className:"w-full outline-none px-2 py-1.5 text-sm"})]})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Mobile Phone 1"}),a.jsxs("div",{className:"w-full border border-gray-300 rounded-md focus-within:ring-2 focus-within:ring-blue-400 outline-none flex flex-row gap-1",children:[a.jsx("select",{name:"m1_ccode",value:k.m1_ccode,onChange:Me,className:"outline-none cursor-pointer py-1.5 px-2 border-r border-gray-400 text-sm",children:BA.map(te=>a.jsx("option",{value:te.code,children:te.code},te.id))}),a.jsx("input",{type:"text",placeholder:"9----------",name:"mobile_phone_1",value:k.mobile_phone_1,onChange:Me,className:"w-full outline-none px-2 py-1.5 text-sm"})]})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Mobile Phone 2"}),a.jsxs("div",{className:"w-full border border-gray-300 rounded-md focus-within:ring-2 focus-within:ring-blue-400 outline-none flex flex-row gap-1",children:[a.jsx("select",{name:"m2_ccode",value:k.m2_ccode,onChange:Me,className:"outline-none cursor-pointer py-1.5 px-2 border-r border-gray-400 text-sm",children:BA.map(te=>a.jsx("option",{value:te.code,children:te.code},te.id))}),a.jsx("input",{type:"text",placeholder:"9----------",name:"mobile_phone_2",value:k.mobile_phone_2,onChange:Me,className:"w-full outline-none px-2 py-1.5 text-sm"})]})]}),a.jsxs("div",{className:"flex flex-col col-span-1 sm:col-span-2 lg:col-span-3",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Address"}),a.jsx("input",{type:"text",name:"address",value:k.address,onChange:Me,placeholder:"Street No., Street Name, City, State/Province, Postal Code",className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"})]}),a.jsxs("div",{className:"flex flex-col col-span-1 md:col-span-2 lg:col-span-1",children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:["Assign To",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("div",{className:`w-full rounded-lg ${et&&!k.lead_owner?"border border-red-400":"border border-gray-300"}`,children:a.jsx(XFe,{items:Array.isArray(o)?o:[],value:k.lead_owner??"",placeholder:"Search a user...",disabled:P||ot,getLabel:te=>`${te.first_name} ${te.last_name}`,onChange:te=>{const q=o.find(U=>String(U.id)===String(te));u(q);let Y=null;q&&q.assigned_territory&&q.assigned_territory.length===1&&(Y=q.assigned_territory[0].id),A(U=>({...U,lead_owner:te,territory_id:Y}))}})})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Territory"}),a.jsxs("select",{name:"territory_id",value:k.territory_id||"",onChange:Me,disabled:!c||!c.assigned_territory||c.assigned_territory.length===0,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm bg-white focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100 disabled:text-gray-500",children:[a.jsx("option",{value:"",disabled:!0,children:c?c.assigned_territory&&c.assigned_territory.length>0?"Select Territory":"No territories assigned to this user":"Select a user first"}),c&&c.assigned_territory&&c.assigned_territory.map(te=>a.jsx("option",{value:te.id,children:te.name},te.id))]})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Source"}),a.jsxs("select",{className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none",defaultValue:"",name:"source",value:k.source,onChange:Me,children:[a.jsx("option",{value:"",disabled:!0,children:"Select Source"}),a.jsx("option",{value:"Website",children:"Website"}),a.jsx("option",{value:"Referral",children:"Referral"}),a.jsx("option",{value:"Cold call",children:"Cold call"}),a.jsx("option",{value:"Event",children:"Event"}),a.jsx("option",{value:"Other",children:"Other"})]})]}),a.jsxs("div",{className:"flex flex-col col-span-1 sm:col-span-2 lg:col-span-3",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Notes"}),a.jsx("textarea",{placeholder:"Additional details...",name:"notes",value:k.notes,onChange:Me,rows:3,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none resize-none"})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-2 mt-4 col-span-1 sm:col-span-2 lg:col-span-3",children:[a.jsx("button",{type:"button",onClick:()=>{z(),yt(!1)},className:"w-full sm:w-auto px-4 py-2 text-white bg-red-400 border border-red-300 rounded hover:bg-red-500 transition disabled:opacity-70",disabled:P||W,children:"Cancel"}),a.jsx("button",{type:"submit",onClick:_t,className:"w-full sm:w-auto px-4 py-2 text-white border border-tertiary bg-tertiary rounded hover:bg-secondary transition disabled:opacity-70",disabled:P||W,children:P||W?"Processing...":E?"Update Lead":"Save Lead"})]})]})]})}),G&&a.jsx(QFe,{open:!0,title:G.title,message:G.message,confirmLabel:G.confirmLabel,cancelLabel:G.cancelLabel,variant:G.variant,onConfirm:Ct,onCancel:jt,loading:W}),n&&!r&&!E&&a.jsx(yJ,{relatedActs:Q,lead:n,onBack:ve,fetchLeads:st,setSelectedLead:s,onEdit:re,onArchive:Le})]})}function QFe({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o=!1,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":i==="archive"?"bg-orange-500 hover:bg-orange-600 border border-orange-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsx("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${u}`,disabled:o,children:o?"Processing...":s})]})]})})}function KFe({icon:e,title:t,value:n,color:s="text-blue-600",bgColor:r="bg-blue-100",onClick:i}){const o=()=>{typeof i=="function"?i():console.log(`Clicked: ${t}`)};return a.jsxs("div",{className:"flex items-center p-4 bg-white rounded-xl shadow-md border border-gray-200 transition-all duration-300",onClick:o,children:[a.jsx("div",{className:`flex-shrink-0 p-3 rounded-full ${r} ${s} mr-4`,children:e?a.jsx(e,{size:22}):null}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:t}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:n})]})]})}function XFe({items:e=[],value:t="",onChange:n,getLabel:s,placeholder:r="Search...",disabled:i=!1,maxRender:o=200}){const[l,c]=f.useState(!1),[u,d]=f.useState(""),h=f.useRef(null),p=e.find(j=>String(j.id)===String(t)),x=p?s(p):"",b=f.useMemo(()=>{const j=u.trim().toLowerCase();return(j?e.filter(N=>(s(N)||"").toLowerCase().includes(j)):e).slice(0,o)},[e,u,s,o]);return f.useEffect(()=>{const j=y=>{h.current&&!h.current.contains(y.target)&&c(!1)};return document.addEventListener("mousedown",j),()=>document.removeEventListener("mousedown",j)},[]),f.useEffect(()=>{l||d("")},[l]),a.jsxs("div",{ref:h,className:"relative w-full",children:[a.jsx("input",{disabled:i,value:l?u:x,placeholder:r,onFocus:()=>!i&&c(!0),onChange:j=>{d(j.target.value),l||c(!0)},className:"w-full rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100"}),l&&!i&&a.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg overflow-hidden",children:[a.jsx("div",{className:"max-h-56 overflow-y-auto",children:b.length>0?b.map(j=>{const y=String(j.id),N=s(j),w=String(t)===y;return a.jsx("button",{type:"button",onClick:()=>{n(y),c(!1)},className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-50 ${w?"bg-blue-50":""}`,children:N||"--"},y)}):a.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No results"})}),e.length>o&&a.jsxs("div",{className:"px-3 py-2 text-[11px] text-gray-400 border-t",children:["Showing first ",o," results  keep typing to narrow."]})]})]})}const Eb={accountName:"Josh Inc.",companyNumber:"09135007323",companyWebsite:"joshenc.com",industry:"Agriculture",billingAddress:"#1 Pilar Las Pinas City",shippingAddress:"#3 BNW ASS-CBN",firstName:"Josh",lastName:"Vergara",department:"Administration",title:"CEO",workPhone:"09253677323",email:"josh@joshinc.com",mobile1:"09253677323",mobile2:"0907452874",dealName:"Josh Deal",dealAmount:"60.00",stage:"Prospecting",territory:"Cavite",description:"Initial lead conversion deal.",dealTitle:"New Client Agreement"},es=({label:e,value:t,name:n,className:s=""})=>a.jsxs("div",{className:`flex flex-col ${s}`,children:[a.jsx("label",{className:"text-xs text-gray-500 mb-1",children:e}),a.jsx("input",{type:"text",name:n,defaultValue:t,readOnly:!0,className:"w-full border border-gray-300 p-2 rounded-lg text-sm focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 outline-none bg-gray-50"})]}),ZFe=({data:e})=>a.jsxs("div",{className:"space-y-6 p-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-700",children:"Account Information"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsx(es,{label:"Company Number",name:"companyNumber",value:e.companyNumber}),a.jsx(es,{label:"Company Website",name:"companyWebsite",value:e.companyWebsite}),a.jsx(es,{label:"Industry",name:"industry",value:e.industry})]}),a.jsx(es,{label:"Billing Address",name:"billingAddress",value:e.billingAddress,className:"col-span-3"}),a.jsx(es,{label:"Shipping Address",name:"shippingAddress",value:e.shippingAddress,className:"col-span-3"})]}),JFe=({data:e})=>a.jsxs("div",{className:"space-y-6 p-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-700",children:"Contact Information"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx(es,{label:"First Name",name:"firstName",value:e.firstName}),a.jsx(es,{label:"Last Name",name:"lastName",value:e.lastName}),a.jsx(es,{label:"Department",name:"department",value:e.department}),a.jsx(es,{label:"Title",name:"title",value:e.title}),a.jsx(es,{label:"Work Phone",name:"workPhone",value:e.workPhone}),a.jsx(es,{label:"Email",name:"email",value:e.email}),a.jsx(es,{label:"Mobile Number 1",name:"mobile1",value:e.mobile1}),a.jsx(es,{label:"Mobile Number 2",name:"mobile2",value:e.mobile2})]})]}),eUe=({data:e})=>a.jsxs("div",{className:"space-y-6 p-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-700",children:"Deal"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx(es,{label:"Deal Name",name:"dealName",value:e.dealName}),a.jsxs("div",{className:"flex",children:[a.jsx(es,{label:"Deal Amount",name:"dealAmount",value:e.dealAmount,className:"flex-grow"}),a.jsx("div",{className:"flex flex-col justify-end ml-1",children:a.jsx("span",{className:"text-sm font-medium text-gray-600 border border-gray-300 bg-gray-100 p-2 rounded-r-lg h-10 flex items-center",children:"PHP"})})]}),a.jsx(es,{label:"Stage",name:"stage",value:e.stage}),a.jsx(es,{label:"Territory",name:"territory",value:e.territory})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx(es,{label:"Description",name:"description",value:e.description}),a.jsx(es,{label:"Title",name:"dealTitle",value:e.dealTitle})]})]});function tUe({isOpen:e,onClose:t}){const[n,s]=f.useState(1),r=3;if(!e)return null;const i=()=>{n<r?s(n+1):(t(),s(1))},o=()=>{n>1&&s(n-1)},l=[{id:1,name:"Account"},{id:2,name:"Contact"},{id:3,name:"Deal"}],c=()=>{switch(n){case 1:return a.jsx(ZFe,{data:Eb});case 2:return a.jsx(JFe,{data:Eb});case 3:return a.jsx(eUe,{data:Eb});default:return null}};return a.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-[800px] h-[600px] overflow-hidden flex flex-col",children:[a.jsxs("div",{className:"p-6 border-b border-gray-200 flex justify-between items-start",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wider",children:"Convert Lead"}),a.jsx("h1",{className:"text-2xl font-bold text-gray-900 mt-1",children:Eb.accountName})]}),a.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition",children:a.jsx($N,{className:"w-6 h-6"})})]}),a.jsx("div",{className:"flex border-b border-gray-200 bg-gray-50",children:l.map(u=>a.jsx("button",{onClick:()=>s(u.id),className:`flex-1 py-3 px-6 text-sm font-medium transition ${n===u.id?"bg-white text-gray-800 border-b-2 border-indigo-600":"bg-gray-600 text-white hover:bg-gray-700"}`,children:u.name},u.id))}),a.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:c()}),a.jsxs("div",{className:"p-4 border-t border-gray-200 bg-gray-50 flex justify-end space-x-3",children:[n>1&&a.jsx("button",{onClick:o,className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-100 flex items-center",children:"Cancel"}),n<r?a.jsx("button",{onClick:i,className:"px-5 py-2 text-white bg-gray-900 rounded-xl hover:bg-gray-800 transition",children:"Next"}):a.jsx("button",{onClick:i,className:"px-5 py-2 text-white bg-gray-900 rounded-xl hover:bg-gray-800 transition",children:"Convert"})]})]})})}function bJ({selectedDeal:e,onStatusUpdate:t,onClose:n}){const[s,r]=f.useState(e?.stage||""),[i,o]=f.useState(!1),l=Et(),{user:c}=Gt();f.useEffect(()=>{console.log("SalesDealsQuickAction mounted sahdksd",e),console.log("User sadad:",c)},[e,c]);const u=[{value:"PROSPECTING",label:"Prospecting"},{value:"QUALIFICATION",label:"Qualification"},{value:"PROPOSAL",label:"Proposal"},{value:"NEGOTIATION",label:"Negotiation"},{value:"CLOSED_WON",label:"Closed Won"},{value:"CLOSED_LOST",label:"Closed Lost"}];f.useEffect(()=>{e?.stage&&r(e.stage)},[e]);const d=async()=>{if(!e||!e.id){V.error("No deal selected");return}if(!s||s===e.stage){V.info("Please select a different stage");return}const h=e.id;o(!0);try{await ne.put(`/deals/admin/${h}`,{stage:s}),n&&n(),t&&setTimeout(async()=>{await t(!0)},100),setTimeout(()=>{V.success("Deal status updated successfully")},300)}catch(p){console.error(p);const x=p.response?.data?.detail||"Failed to update deal status";V.error(x)}finally{o(!1)}};return e?a.jsxs("div",{className:"space-y-4 font-inter text-[13px] w-full sm:w-[85%] mx-auto flex flex-col gap-4",children:[a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Quick Actions"}),a.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[a.jsxs("button",{onClick:()=>{const h=e.account?.id||e.account_id;l("/sales/calls",{state:{openCallModal:!0,initialCallData:{subject:e.name?`Call regarding: ${e.name}`:"",relatedType1:"Account",relatedTo1:h,relatedType2:"Deal",relatedTo2:e.id,contactId:e.contact?.id,assigned_to:e.assigned_deals?.id?String(e.assigned_deals.id):"",assignedTo:e.assigned_to?.id?String(e.assigned_to.id):""}}})},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(It,{className:"text-gray-600 w-4 h-4"}),"Schedule Call"]}),a.jsxs("button",{type:"button",onClick:()=>{if(!e.contact?.email){alert("No email address available");return}const h=encodeURIComponent(e.contact.email),p=encodeURIComponent(""),x=encodeURIComponent(""),b=`mailto:${h}?subject=${p}&body=${x}`;window.location.href=b},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(sn,{className:"text-gray-600 w-4 h-4"}),"Send E-mail"]}),a.jsxs("button",{className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",onClick:()=>{const h=e.account?.id||e.account_id;l("/sales/meetings",{state:{openMeetingModal:!0,initialMeetingData:{subject:e.name?`Meeting: ${e.name}`:"",relatedType1:"Account",relatedTo1:h,relatedType2:"Deal",relatedTo2:e.id,assignedTo:e.assigned_deals?.id?String(e.assigned_deals.id):""}}})},children:[a.jsx(Pt,{className:"text-gray-600 w-4 h-4"}),"Book Meeting"]}),a.jsxs("button",{onClick:()=>{const h=e.account?.id||e.account_id;l("/sales/tasks",{state:{openTaskModal:!0,initialTaskData:{subject:e.name?`Task for: ${e.name}`:"",relatedType1:"Account",relatedTo1:h,relatedType2:"Deal",relatedTo2:e.id,contactId:e.contact?.id,assignedTo:e.assigned_deals?.id?String(e.assigned_deals.id):"",priority:"NORMAL",status:"Not Started"}}})},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(Qt,{className:"text-gray-600 w-4 h-4"}),"Tasks"]})]})]}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm w-full",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Promote Deal"}),a.jsx("select",{className:"border border-gray-200 rounded-md px-2 sm:px-3 py-1.5 w-full text-sm mb-2 focus:ring-2 focus:ring-gray-300 focus:outline-none",value:s,onChange:h=>r(h.target.value),disabled:i||e.created_by!==c?.id&&e.assigned_to!==c?.id,children:u.map(h=>a.jsx("option",{value:h.value,children:h.label},h.value))}),(e.created_by===c?.id||e.assigned_to===c?.id)&&a.jsx("button",{className:"w-full bg-gray-900 text-white py-1.5 rounded-md text-sm hover:bg-gray-800 transition disabled:opacity-50 disabled:cursor-not-allowed",onClick:d,disabled:i||!s||s===e.stage,children:i?"Updating...":"Update"})]})]}):null}function vJ({selectedDeal:e,relatedActs:t={},show:n,onClose:s,activeTab:r,setActiveTab:i,onEdit:o,onDelete:l,onStatusUpdate:c}){const u=Et(),[d]=Bs(),h=d.get("id"),[p,x]=f.useState(e||null),[b,j]=f.useState(r||"Overview"),[y,N]=f.useState(null),{user:w}=Gt(),{comments:S,addComment:_,refresh:T}=kn({relatedType:"deal",relatedId:p?.id});f.useEffect(()=>{p?.id&&T()},[p?.id,T]);const k=r!==void 0?r:b,A=(()=>{const D=String(w?.role||"").toLowerCase();return D==="ceo"||D==="admin"?"admin":D==="manager"?"manager":D==="sales"?"sales":D==="group manager"||D==="group_manager"||D==="group-manager"?"group-manager":"guest"})();if(f.useEffect(()=>{(async()=>{if(h&&!e)try{const G=((await ne.get("/deals/admin/fetch-all")).data||[]).find($=>$.id===parseInt(h));if(G){const $={...G,amount:typeof G.amount=="number"?G.amount:parseFloat(G.amount||0),probability:G.probability||0};x($)}else console.warn("Deal not found with ID:",h)}catch(P){console.error("Error fetching deal:",P)}})()},[h,e]),!p&&!h||h&&!p)return null;const E=D=>({PROSPECTING:"bg-blue-100 text-blue-700",QUALIFICATION:"bg-yellow-100 text-yellow-700",PROPOSAL:"bg-orange-100 text-orange-700",NEGOTIATION:"bg-purple-100 text-purple-700",CLOSED_WON:"bg-green-100 text-green-700",CLOSED_LOST:"bg-red-100 text-red-700"})[D]||"bg-gray-100 text-gray-700",M=D=>{if(!D)return"";const P=String(D).split("-");return P.length===3?`${P[0]}-${P[2]}`:String(D)},F=D=>D?new Date(D).toLocaleString("en-US",{month:"short",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).replace(",",""):"";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[9999] font-inter p-2 sm:p-4 overflow-x-hidden",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-lg w-full max-w-full sm:max-w-6xl max-h-[90vh] overflow-y-auto hide-scrollbar relative box-border",children:[a.jsx("div",{className:"bg-tertiary w-full rounded-t-xl p-3 lg:p-3",children:a.jsxs("div",{className:"flex items-start justify-between w-full",children:[a.jsx("h1",{className:"lg:text-3xl text-xl text-white font-semibold text-center w-full",children:"Deal"}),a.jsx("div",{className:"flex items-center gap-2 sm:gap-3",children:a.jsx("button",{onClick:()=>{s?s():u(-1)},className:"text-gray-400 hover:text-white mt-1 cursor-pointer",children:a.jsx(ea,{size:25})})})]})}),a.jsx("div",{className:"p-4 lg:p-2 lg:mx-7",children:a.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-2 sm:gap-3 mt-3",children:[a.jsxs("div",{className:"flex flex-col gap-1",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3 lg:gap-1",children:[a.jsxs("h2",{className:"text-xl lg:text-xl font-semibold text-gray-800 break-words",children:[M(p.deal_id)," - ",p.name]}),a.jsx("span",{className:`text-xs sm:text-sm inline-block font-medium px-1.5 py-0.5 sm:px-3 sm:py-1 rounded-full break-words ${E(p.stage)}`,children:p.stage})]}),a.jsxs("p",{className:"text-gray-500 text-sm break-words",children:["Created on ",F(p.created_at)]})]}),a.jsxs("div",{className:"flex flex-col items-end gap-2",children:[a.jsxs("h2",{className:"text-xl sm:text-2xl font-bold text-gray-600 break-words",children:[" ",p.amount?p.amount.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):"0.00"]}),a.jsx("div",{className:"w-full sm:w-40 bg-gray-200 rounded-full h-2",children:a.jsx("div",{className:"bg-green-500 h-2 rounded-full",style:{width:`${p.probability}%`}})}),a.jsxs("p",{className:"text-xs text-gray-500 break-words",children:[" ",p.probability,"% Complete "]}),p.deal_creator?.id===w?.id&&a.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 mt-3",children:[a.jsxs("button",{type:"button",onClick:()=>{o&&o(p)},className:"inline-flex items-center justify-center bg-blue-500 text-white px-3 sm:px-4 py-1.5 sm:py-2 rounded-md hover:bg-blue-600 transition text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",children:[a.jsx(hn,{className:"mr-1 sm:mr-2",size:16}),a.jsx("span",{className:"hidden sm:inline",children:"Edit"})]}),a.jsxs("button",{type:"button",onClick:()=>{l&&l(p)},className:"inline-flex items-center justify-center px-3 sm:px-4 py-1.5 sm:py-2 rounded-md text-sm bg-orange-500 text-white hover:bg-orange-600 transition focus:outline-none focus:ring-2 focus:ring-orange-400",children:[a.jsx(Zt,{className:"mr-1 sm:mr-2",size:16}),a.jsx("span",{className:"hidden sm:inline",children:"Archive"})]})]})]})]})}),a.jsx("div",{className:"border-b border-gray-200 my-5"}),a.jsxs("div",{className:"p-6 lg:p-4",children:[a.jsx("div",{className:"flex w-full bg-[#6A727D] text-white mt-1 overflow-x-auto mb-6",children:["Overview","Notes","Activities"].map(D=>a.jsx("button",{onClick:()=>{i?i(D):j(D)},className:`flex-1 min-w-[90px] px-4 py-2.5 text-xs sm:text-sm font-medium text-center transition-all duration-200 border-b-2
                ${k===D?"bg-paper-white text-[#6A727D] border-white":"text-white hover:bg-[#5c636d]"}`,children:D},D))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 items-start",children:[a.jsxs("div",{className:"lg:col-span-3 space-y-6",children:[k==="Overview"&&a.jsxs("div",{className:"grid md:grid-cols-2 gap-4 sm:gap-6 w-full",children:[a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 sm:p-5 shadow-sm pb-20 break-words",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 sm:mb-3",children:"Deal Information"}),a.jsxs("p",{className:"text-sm sm:text-sm text-gray-700 mb-2 py-5 break-words",children:[a.jsx("strong",{children:"Description:"})," ",p.description]}),a.jsx("div",{className:"h-px bg-gray-200 w-full"}),a.jsxs("p",{className:"text-sm sm:text-sm text-gray-700 mb-2 py-5 break-words",children:[a.jsx("strong",{children:"Expected Close Date:"})," ",F(p.close_date)||"--"]}),a.jsx("div",{className:"h-px bg-gray-200 w-full"}),a.jsxs("div",{className:"mt-4 py-3 w-full",children:[a.jsxs("div",{className:"relative flex flex-col w-full",children:[a.jsx("div",{className:"absolute top-0 left-0 right-0 flex items-center justify-between w-full",children:(()=>{const D=(p?.stage||"PROSPECTING").toUpperCase(),B=($=>$==="PROSPECTING"?0:$==="QUALIFICATION"?1:$==="PROPOSAL"?2:$==="NEGOTIATION"?3:$==="CLOSED_WON"||$==="CLOSED_LOST"?4:-1)(D);return[0,1,2,3,4].map($=>B===$?"orange":B>$?"green":"gray").map(($,W)=>a.jsxs(wt.Fragment,{children:[a.jsx("div",{className:`relative z-10 w-6 h-6 rounded-full border-2 ${$==="green"?"bg-green-500 border-green-500":$==="orange"?"bg-orange-400 border-orange-400":"bg-gray-300 border-gray-300"}`}),W<4&&a.jsx("div",{className:"flex-grow h-1 bg-gray-200 mx-1 min-w-0"})]},W))})()}),a.jsx("div",{className:"flex justify-between mt-8 gap-2 text-[9px] lg:text-[9px] sm:text-xs text-gray-600 w-full",children:["Prospecting","Qualification","Proposal","Negotiation","Closed"].map((D,P)=>a.jsx("span",{className:"text-center flex-1 break-words",children:D},P))})]}),a.jsx("p",{className:"text-sm text-orange-600 font-medium mt-6 text-center break-words",children:p.stage})]})]}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 sm:p-5 shadow-sm break-words",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-3",children:"Contact Information"}),a.jsxs("div",{className:"text-sm sm:text-sm text-gray-700 space-y-3",children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Account:"})," ",p.account?.name]}),a.jsx("div",{className:"h-px bg-gray-200 w-full"}),a.jsxs("p",{children:[a.jsx("strong",{children:"Primary Contact:"})," ",p.contact?.first_name," ",p.contact?.last_name]}),a.jsx("div",{className:"h-px bg-gray-200 w-full"}),a.jsxs("p",{children:[a.jsx("strong",{children:"Phone:"})," ",p.contact?.work_phone]}),a.jsx("div",{className:"h-px bg-gray-200 w-full"}),a.jsxs("p",{children:[a.jsx("strong",{children:"Email:"})," ",p.contact?.email]}),a.jsx("div",{className:"h-px bg-gray-200 w-full"}),a.jsxs("p",{children:[a.jsx("strong",{children:"Assigned To:"})," ",p.assigned_deals?.first_name," ",p.assigned_deals?.last_name]})]})]})]}),k==="Notes"&&a.jsxs("div",{className:"mt-4 w-full",children:[a.jsx("div",{className:"flex flex-wrap items-center justify-between mb-4 gap-2",children:a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words",children:"Deal Note"})}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 shadow-sm break-words",children:[a.jsx("div",{className:"flex items-start justify-between",children:a.jsx("div",{children:a.jsx("p",{className:"text-sm font-medium text-gray-800 break-words",children:"Note"})})}),a.jsx("div",{className:"mt-3 text-sm text-gray-700 whitespace-pre-wrap break-words",children:p.description||"No notes available."})]}),a.jsx(Tn,{comments:S,onAddComment:_})]}),k==="Activities"&&a.jsxs("div",{className:"space-y-2 w-full h-full max-h-[50dvh] overflow-y-auto bg-gray-50 p-2 hide-scrollbar rounded-lg border border-gray-200 shadow-sm",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words border-b border-gray-300 py-2",children:"Related Activities"}),a.jsxs("div",{className:"space-y-2 text-sm",children:[t.tasks&&t.tasks.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>N(y==="tasks"?null:"tasks"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Qt,{className:"text-blue-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Tasks (",t.tasks.length,")"]})]}),y==="tasks"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),y==="tasks"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:t.tasks.map((D,P)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>u(`/${A}/tasks`,{state:{taskID:D.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-blue-600 mt-1",children:a.jsx(Qt,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:D.subject||D.title||"Task"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:D.description||"No description"}),D.assigned_to&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Assigned: ",D.assigned_to.first_name," ",D.assigned_to.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:F(D.due_date||D.created_at)})]},`task-${P}`))})]}),t.meetings&&t.meetings.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>N(y==="meetings"?null:"meetings"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Pt,{className:"text-green-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Meetings (",t.meetings.length,")"]})]}),y==="meetings"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),y==="meetings"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:t.meetings.map((D,P)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>u(`/${A}/meetings`,{state:{meetingID:D.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-green-600 mt-1",children:a.jsx(Pt,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:D.subject||D.title||"Meeting"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:D.description||D.location||"No description"}),D.host&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Host: ",D.host.first_name," ",D.host.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:F(D.start_time||D.created_at)})]},`meeting-${P}`))})]}),t.calls&&t.calls.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>N(y==="calls"?null:"calls"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(It,{className:"text-purple-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Calls (",t.calls.length,")"]})]}),y==="calls"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),y==="calls"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:t.calls.map((D,P)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>u(`/${A}/calls`,{state:{callID:D.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-purple-600 mt-1",children:a.jsx(It,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:D.subject||D.title||"Call"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:D.direction||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:F(D.call_time||D.created_at)})]},`call-${P}`))})]}),t.quotes&&t.quotes.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>N(y==="quotes"?null:"quotes"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ia,{className:"text-orange-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Quotes (",t.quotes.length,")"]})]}),y==="quotes"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),y==="quotes"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:t.quotes.map((D,P)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>u(`/${A}/quotes`,{state:{quoteID:D.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-orange-600 mt-1",children:a.jsx(ia,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:(D.quote_id?D.quote_id.replace(/Q(\d+)-\d+-/,"Q$1-"):"--")||"Quote"}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:D.status||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:F(D.presented_date)||""})]},`quote-${P}`))})]}),(!t||(!t.tasks||t.tasks.length===0)&&(!t.meetings||t.meetings.length===0)&&(!t.calls||t.calls.length===0)&&(!t.quotes||t.quotes.length===0)&&(!t.deals||t.deals.length===0)&&(!t.contacts||t.contacts.length===0))&&a.jsx("div",{className:"text-center py-8 text-gray-500",children:a.jsx("p",{children:"No related activities found for this account."})})]})]}),k==="Edit"&&a.jsxs("div",{className:"mt-4 space-y-4 w-full",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words",children:"Edit Deal"}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 sm:p-5 shadow-sm w-full",children:[a.jsxs("label",{className:"block mb-3 break-words",children:[a.jsx("span",{className:"text-sm text-gray-700",children:"Deal Name"}),a.jsx("input",{type:"text",className:"mt-1 block w-full border border-gray-200 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-gray-200",defaultValue:p.name})]}),a.jsxs("label",{className:"block mb-3 break-words",children:[a.jsx("span",{className:"text-sm text-gray-700",children:"Description"}),a.jsx("textarea",{className:"mt-1 block w-full border border-gray-200 rounded-md px-3 py-2 text-sm h-24 resize-y focus:outline-none focus:ring-2 focus:ring-gray-200",defaultValue:p.description})]}),a.jsx("button",{className:"bg-gray-900 text-white px-4 py-2 rounded-md hover:bg-gray-800",children:"Save Changes"})]})]})]}),a.jsx("div",{className:"w-full lg:w-auto",children:a.jsx(bJ,{selectedDeal:p,onStatusUpdate:c,onClose:s})})]})]})]})})}function aUe(){f.useEffect(()=>{document.title="Deals | Sari-Sari CRM"},[]);const e=Et(),t=ta(),[n,s]=f.useState(""),[r,i]=f.useState("Filter by Stage"),[o,l]=f.useState("Filter by Owner"),[c,u]=f.useState(null),[d,h]=f.useState("Overview"),[p,x]=f.useState(!1),[b,j]=f.useState(null),[y,N]=f.useState(!1),[w,S]=f.useState(1),[_,T]=f.useState(10),[k,A]=f.useState(!1),[E,M]=f.useState(null),[F,D]=f.useState(!1),[P,B]=f.useState(!1),[G,$]=f.useState(null),[W,Z]=f.useState([]),[Q,le]=f.useState([]),[we,J]=f.useState([]),[se,ye]=f.useState({}),[Ce,ge]=f.useState(null),[be,me]=f.useState(new Set),[Ae,pe]=f.useState(!1);f.useEffect(()=>{const oe=t.state,Pe=oe?.dealID;if(Pe&&!oe?.openDealModal){ge(Pe),e(t.pathname,{replace:!0,state:{}});return}},[t,e]),f.useEffect(()=>{if(Ce&&b?.length>0&&!y){const oe=b.find(Pe=>Pe.id===Ce);oe?u(oe):V.error("Deal not found."),ge(null)}},[Ce,b,y]);const[Ie,xe]=f.useState({id:null,name:"",account_id:"",primary_contact_id:"",stage:"PROPOSAL",amount:"",close_date:"",assigned_to:"",currency:"PHP",description:""}),[he,Re]=f.useState(null),[Ee,He]=f.useState(null),Ke="dealDraft:sales/deals",st=3600*1e3,it=f.useRef(!1),ot=oe=>{if(!oe)return"";const Pe=String(oe).split("-");return Pe.length===3?`${Pe[0]}-${Pe[2]}`:String(oe)},rt=oe=>oe?new Date(oe).toLocaleString("en-US",{month:"short",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).replace(",",""):"";f.useEffect(()=>{if(!it.current){it.current=!0;try{const oe=sessionStorage.getItem(Ke);if(!oe)return;const Pe=JSON.parse(oe);if(typeof Pe?.ts=="number"&&Date.now()-Pe.ts>st){sessionStorage.removeItem(Ke);return}if(Pe?.returnTo&&Pe.returnTo!==t.pathname)return;Pe?.dealForm&&typeof Pe.dealForm=="object"&&xe(Pe.dealForm),typeof Pe?.isEditing=="boolean"&&B(Pe.isEditing),Pe?.currentDealId!==void 0&&$(Pe.currentDealId),x(!0),sessionStorage.removeItem(Ke)}catch{sessionStorage.removeItem(Ke)}}},[t.pathname]);const at=f.useCallback(()=>{try{sessionStorage.setItem(Ke,JSON.stringify({ts:Date.now(),returnTo:t.pathname,dealForm:Ie,isEditing:P,currentDealId:G}))}catch{}},[Ke,t.pathname,Ie,P,G]),Je=f.useCallback(()=>{at(),window.open("/sales/accounts?openModal=1","_blank","noopener,noreferrer")},[at]),Fe=f.useCallback(()=>{at(),window.open("/sales/contacts?openModal=1","_blank","noopener,noreferrer")},[at]),Ue={"Prospecting Stage":"PROSPECTING","Qualification Stage":"QUALIFICATION","Proposal Stage":"PROPOSAL","Negotiation Stage":"NEGOTIATION","Closed Won Stage":"CLOSED_WON","Closed Lost Stage":"CLOSED_LOST","Closed Cancelled Stage":"CLOSED_CANCELLED"},Ne=oe=>({PROSPECTING:"Prospecting",QUALIFICATION:"Qualification",PROPOSAL:"Proposal",NEGOTIATION:"Negotiation",CLOSED_WON:"Closed Won",CLOSED_LOST:"Closed Lost",CLOSED_CANCELLED:"Closed Cancelled"})[oe]||oe||"--",ze=oe=>({PROSPECTING:"bg-blue-100 text-blue-700",QUALIFICATION:"bg-yellow-100 text-yellow-700",PROPOSAL:"bg-orange-100 text-orange-700",NEGOTIATION:"bg-purple-100 text-purple-700",CLOSED_WON:"bg-green-100 text-green-700",CLOSED_LOST:"bg-red-100 text-red-700",CLOSED_CANCELLED:"bg-red-100 text-red-700"})[oe]||"bg-gray-100 text-gray-700",je=f.useCallback(async oe=>{try{const Pe=await ne.get(`/activities/deal/${oe}`);ye(Pe.data&&typeof Pe.data=="object"?Pe.data:{})}catch(Pe){console.error(Pe),Pe.response?.status===404&&(console.warn("No activities found for this account."),ye({}))}},[]),ve=f.useMemo(()=>{const oe=n.trim().toLowerCase(),Pe=r.trim(),Ve=o.trim();return(b??[]).filter(ft=>{const St=[ft?.deal_id,ot(ft?.deal_id),ft?.id?.toString(),ft?.name,ft?.description,ft?.account?.name,ft?.contact?.first_name,ft?.contact?.last_name,Ne(ft?.stage),ft?.stage,ft?.amount?.toString(),ft?.close_date,ft?.assigned_deals?.first_name,ft?.assigned_deals?.last_name],Ht=oe===""||St.some(_e=>_e==null||_e===""?!1:_e.toString().toLowerCase().includes(oe)),da=Pe==="Filter by Stage"||Pe===""||ft.stage===Ue[Pe]||ft.stage===Pe,qe=Ve==="Filter by Owner"||Ve===""||`${ft.assigned_deals?.first_name||""} ${ft.assigned_deals?.last_name||""}`.trim().toLowerCase()===Ve.toLowerCase();return Ht&&da&&qe})},[b,n,r,o]),z=Math.max(1,Math.ceil(ve.length/_)||1);f.useEffect(()=>{S(1)},[n,r,o]),f.useEffect(()=>{S(oe=>{const Pe=Math.max(1,Math.ceil(ve.length/_)||1);return oe>Pe?Pe:oe})},[ve.length,_]);const K=f.useMemo(()=>{const oe=(w-1)*_;return ve.slice(oe,oe+_)},[ve,w,_]),ue=()=>S(oe=>Math.max(oe-1,1)),re=()=>S(oe=>Math.min(oe+1,z)),Le=()=>{xe({id:null,name:"",account_id:"",primary_contact_id:"",stage:"PROPOSAL",amount:"",close_date:"",assigned_to:"",currency:"PHP",description:""}),B(!1),$(null),x(!0)},De=async()=>{N(!0);try{const oe=await ne.get("/deals/admin/fetch-all"),Ve=[...Array.isArray(oe.data)?oe.data:[]].sort((ft,St)=>{const Ht=ft?.created_at?new Date(ft.created_at).getTime():0;return(St?.created_at?new Date(St.created_at).getTime():0)-Ht});j(Ve)}catch(oe){oe.response&&oe.response.status===403?V.error("Permission denied. Only CEO, Admin, or Group Manager can access this page."):V.error("Failed to fetch deals. Please try again later."),console.error(oe)}finally{N(!1)}},Qe=async()=>{try{const oe=await ne.get("/accounts/admin/fetch-all");Z(Array.isArray(oe.data)?oe.data:[])}catch(oe){console.error(oe),oe.response?.status===403&&V.warn("Unable to load accounts (permission denied).")}},tt=async()=>{try{const oe=await ne.get("/contacts/admin/fetch-all");le(Array.isArray(oe.data)?oe.data:[])}catch(oe){console.error(oe),oe.response?.status===403&&V.warn("Unable to load contacts (permission denied).")}},Me=async()=>{try{const oe=await ne.get("/users/all");J(Array.isArray(oe.data)?oe.data:[])}catch(oe){console.error(oe),oe.response?.status===403&&V.warn("Unable to load users (permission denied).")}};f.useEffect(()=>{De(),Qe(),tt(),Me()},[]);const{user:et}=Gt(),yt=et?.role==="Sales";f.useEffect(()=>{p&&!P&&yt&&et&&!Ie.assigned_to&&xe(oe=>({...oe,assigned_to:et.id}))},[p,P,yt,et,Ie.assigned_to]);const _t=async oe=>{oe&&(xe({id:oe.id||null,name:oe.name||"",account_id:oe.account_id?.toString()||"",primary_contact_id:oe.primary_contact_id?.toString()||"",stage:oe.stage||"PROPOSAL",amount:oe.amount?.toString()||"",close_date:oe.close_date?new Date(oe.close_date).toISOString().split("T")[0]:"",assigned_to:oe.assigned_to?.toString()||"",currency:oe.currency||"PHP",description:oe.description||""}),Re(oe.account||null),He(oe.contact||null),B(!0),$(oe.id),u(null),x(!0))},Ct=async(oe=!1)=>{try{const Pe=await ne.get("/deals/admin/fetch-all"),ft=[...Array.isArray(Pe.data)?Pe.data:[]].sort((St,Ht)=>{const da=St?.created_at?new Date(St.created_at).getTime():0;return(Ht?.created_at?new Date(Ht.created_at).getTime():0)-da});if(j(ft),!oe&&c&&c.id){const St=ft.find(Ht=>Ht.id===c.id);St&&u({...St})}}catch(Pe){console.error("Failed to refresh deal data:",Pe),await De()}},jt=oe=>{const Pe=oe.name.trim();if(!Pe){V.error("Deal name is required.");return}if(!oe.account_id){V.error("Account is required.");return}const Ve=P&&G?"update":"create",ft=Pe;M({title:Ve==="create"?"Confirm New Deal":"Confirm Update",message:Ve==="create"?a.jsxs("span",{children:["Are you sure you want to create"," ",a.jsx("span",{className:"font-semibold",children:ft}),"?"]}):a.jsxs("span",{children:["Save changes to ",a.jsx("span",{className:"font-semibold",children:ft}),"?"]}),confirmLabel:Ve==="create"?"Create Deal":"Update Deal",cancelLabel:"Cancel",variant:"primary",action:{type:Ve,formData:oe,targetId:G||null,name:ft}})},At=oe=>{const Pe=K?.find(Ve=>Ve.id===oe);Pe&&Pe.deal_creator?.id===et?.id&&me(Ve=>{const ft=new Set(Ve);return ft.has(oe)?ft.delete(oe):ft.add(oe),ft})},Ge=()=>{const oe=K?.filter(Pe=>Pe.deal_creator?.id===et?.id)||[];be.size===oe.length&&oe.length>0?me(new Set):me(new Set(oe.map(Pe=>Pe.id)))},Be=()=>{if(be.size===0)return;const oe=be.size;M({title:"Archive Deals",message:a.jsxs("span",{children:["Are you sure you want to archive"," ",a.jsx("span",{className:"font-semibold",children:oe})," deal",oe!==1?"s":"","? You can restore them later if needed."]}),confirmLabel:`Archive ${oe} Deal${oe!==1?"s":""}`,cancelLabel:"Cancel",variant:"archive",action:{type:"bulk-archive",targetIds:Array.from(be),count:oe}})},ce=oe=>{if(!oe)return;const Pe=oe.name||"this deal";M({title:"Archive Deal",message:a.jsxs("span",{children:["Are you sure you want to archive"," ",a.jsx("span",{className:"font-semibold",children:Pe}),"? You can restore it later if needed."]}),confirmLabel:"Archive Deal",cancelLabel:"Cancel",variant:"archive",action:{type:"archive",targetId:oe.id,name:Pe}})},fe=async()=>{if(!E?.action){M(null);return}const{action:oe}=E,{type:Pe,formData:Ve,targetId:ft,name:St}=oe;D(!0);try{if(Pe==="create"){A(!0);const Ht={name:Ve.name.trim(),account_id:parseInt(Ve.account_id),primary_contact_id:Ve.primary_contact_id?parseInt(Ve.primary_contact_id):null,stage:Ve.stage,amount:Ve.amount?parseFloat(Ve.amount):null,currency:Ve.currency||"PHP",close_date:Ve.close_date||null,description:Ve.description||null,assigned_to:Ve.assigned_to?parseInt(Ve.assigned_to):null};await ne.post("/deals/admin/create",Ht),V.success(`Deal "${St}" created successfully.`),x(!1),await De()}else if(Pe==="update"){if(!ft)throw new Error("Missing deal identifier for update.");A(!0);const Ht={};Ve.name!==void 0&&(Ht.name=Ve.name.trim()),Ve.account_id!==void 0&&Ve.account_id!==""&&(Ht.account_id=parseInt(Ve.account_id)),Ve.primary_contact_id!==void 0&&(Ht.primary_contact_id=Ve.primary_contact_id?parseInt(Ve.primary_contact_id):null),Ve.stage!==void 0&&(Ht.stage=Ve.stage),Ve.amount!==void 0&&Ve.amount!==""&&(Ht.amount=parseFloat(Ve.amount)),Ve.currency!==void 0&&(Ht.currency=Ve.currency),Ve.close_date!==void 0&&(Ht.close_date=Ve.close_date||null),Ve.description!==void 0&&(Ht.description=Ve.description||null),Ve.assigned_to!==void 0&&(Ht.assigned_to=Ve.assigned_to?parseInt(Ve.assigned_to):null),await ne.put(`/deals/admin/${ft}`,Ht),V.success(`Deal "${St}" updated successfully.`),x(!1),await De()}else if(Pe==="delete"){if(!ft)throw new Error("Missing deal identifier for deletion.");await ne.delete(`/deals/admin/${ft}`),V.success(`Deal "${St}" deleted successfully.`),c?.id===ft&&u(null),await De()}else if(Pe==="archive"){if(!ft)throw new Error("Missing deal identifier for archive.");await ne.put(`/deals/single-archive/${ft}`),V.success(`Deal "${St}" archived successfully.`),c?.id===ft&&u(null),await De()}else if(Pe==="bulk-archive"){if(pe(!0),!oe.targetIds||oe.targetIds.length===0)throw new Error("No deals selected for archiving.");await ne.put("/deals/bulk-archive",{deal_ids:oe.targetIds}),V.success(`${oe.count} deal${oe.count!==1?"s":""} archived successfully.`),me(new Set),c&&oe.targetIds.includes(c.id)&&u(null),await De()}}catch(Ht){console.error(Ht);const da=Pe==="create"?"Failed to create deal. Please review the details and try again.":Pe==="update"?"Failed to update deal. Please review the details and try again.":Pe==="bulk-archive"?"Failed to archive deals. Please try again.":Pe==="archive"?"Failed to archive deal. Please try again.":"Failed to delete deal. Please try again.",qe=Ht.response?.data?.detail||da;V.error(qe)}finally{(Pe==="create"||Pe==="update")&&A(!1),Pe==="bulk-archive"&&pe(!1),D(!1),M(null)}},H=()=>{F||M(null)},te=()=>{x(!1),xe({id:null,name:"",account_id:"",primary_contact_id:"",stage:"PROPOSAL",amount:"",close_date:"",assigned_to:"",currency:"PHP",description:""}),Re(null),He(null),B(!1),$(null),A(!1)},q=(b??[]).filter(oe=>oe.stage==="PROSPECTING").length,Y=(b??[]).filter(oe=>oe.stage==="QUALIFICATION").length,U=(b??[]).filter(oe=>oe.stage==="PROPOSAL").length,de=(b??[]).filter(oe=>oe.stage==="NEGOTIATION").length,Te=(b??[]).filter(oe=>oe.stage==="CLOSED_WON").length,ie=(b??[]).filter(oe=>oe.stage==="CLOSED_LOST").length,Oe=(b??[]).filter(oe=>oe.stage==="CLOSED_CANCELLED").length,X=[{title:"Prospecting",value:q,icon:Nj,color:"text-blue-600",bgColor:"bg-blue-100"},{title:"Qualification",value:Y,icon:gn,color:"text-yellow-600",bgColor:"bg-yellow-100"},{title:"Proposal",value:U,icon:sa,color:"text-orange-600",bgColor:"bg-orange-100"},{title:"Negotiation",value:de,icon:cd,color:"text-purple-600",bgColor:"bg-purple-100"},{title:"Closed Won",value:Te,icon:La,color:"text-green-600",bgColor:"bg-green-100"},{title:"Closed Lost",value:ie,icon:Yn,color:"text-red-600",bgColor:"bg-red-100"},{title:"Closed Cancelled",value:Oe,icon:Yn,color:"text-gray-600",bgColor:"bg-gray-100"}];return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[y&&a.jsx(qt,{message:"Loading deals..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h1",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(sa,{className:"mr-2 text-blue-600"}),"Deals"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{onClick:Le,className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 lg:my-0 rounded-md hover:bg-gray-800 text-sm sm:text-base mx-auto sm:ml-auto cursor-pointer",children:[a.jsx(aa,{className:"mr-2"})," Add Deal"]})})]}),a.jsx("div",{className:"grid grid-cols-1 p-2 lg:grid-cols-4 gap-4 mb-6 w-full break-words overflow-hidden",children:X.map(oe=>a.jsx(sUe,{...oe},oe.title))}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search deals",value:n,onChange:oe=>s(oe.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsxs("div",{className:"w-full lg:w-auto flex flex-col lg:flex-row gap-3",children:[a.jsxs("select",{value:r,onChange:oe=>i(oe.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full lg:w-40 focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{value:"Filter by Stage",children:"Filter by Stage"}),a.jsx("option",{value:"Prospecting Stage",children:"Prospecting"}),a.jsx("option",{value:"Qualification Stage",children:"Qualification"}),a.jsx("option",{value:"Proposal Stage",children:"Proposal"}),a.jsx("option",{value:"Negotiation Stage",children:"Negotiation"}),a.jsx("option",{value:"Closed Won Stage",children:"Closed Won"}),a.jsx("option",{value:"Closed Lost Stage",children:"Closed Lost"}),a.jsx("option",{value:"Closed Cancelled Stage",children:"Closed Cancelled"})]}),a.jsxs("select",{value:o,onChange:oe=>l(oe.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full lg:w-40 focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{value:"Filter by Owner",children:"Filter by Owner"}),[...new Set((b??[]).map(oe=>`${oe.assigned_deals?.first_name} ${oe.assigned_deals?.last_name}`))].map((oe,Pe)=>a.jsx("option",{value:oe,children:oe},Pe))]})]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[500px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 text-sm tracking-wide font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 w-12",children:a.jsx("input",{type:"checkbox",checked:be.size>0&&be.size===K?.filter(oe=>oe.deal_creator?.id===et?.id).length&&K?.filter(oe=>oe.deal_creator?.id===et?.id).length>0,onChange:Ge,className:"w-4 h-4 cursor-pointer"})}),a.jsx("th",{className:"py-3 px-4",children:"Deal ID"}),a.jsx("th",{className:"py-3 px-4 truncate",children:"Deal Name"}),a.jsx("th",{className:"py-3 px-4",children:"Account"}),a.jsx("th",{className:"py-3 px-4",children:"Contact"}),a.jsx("th",{className:"py-3 px-4 w-48",children:"Stage"}),a.jsx("th",{className:"py-3 px-4 w-48",children:"Value"}),a.jsx("th",{className:"py-3 px-4",children:"Close Date"}),a.jsx("th",{className:"py-3 px-4",children:"Owner"}),a.jsx("th",{className:"py-3 px-4 w-12",children:be.size>0&&a.jsx("button",{onClick:Be,className:"text-orange-500 hover:text-orange-700 transition",title:"Archive selected deals",disabled:Ae,children:a.jsx(Zt,{size:18})})})]})}),a.jsx("tbody",{children:ve.length>0?K.map(oe=>a.jsxs("tr",{className:"hover:bg-gray-50 text-sm cursor-pointer",onClick:()=>{u({...oe}),je(oe.id)},children:[a.jsx("td",{className:"py-3 px-4",children:et?.id===oe.deal_creator?.id&&a.jsx("input",{type:"checkbox",checked:be.has(oe.id),onClick:Pe=>{Pe.stopPropagation()},onChange:Pe=>{Pe.stopPropagation(),At(oe.id)},className:"w-4 h-4 cursor-pointer"})}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",children:ot(oe.deal_id)}),a.jsx("td",{className:"py-3 px-4",children:a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-blue-600 hover:underline break-all text-sm",children:oe.name}),a.jsx("div",{className:"text-gray-500 text-xs break-all",children:oe.description||"--"})]})}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",children:oe.account?.name||"--"}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",children:oe.contact?.first_name&&oe.contact?.last_name?`${oe.contact.first_name} ${oe.contact.last_name}`:oe.contact?.first_name||oe.contact?.last_name||"--"}),a.jsx("td",{className:"py-3 px-4 w-48",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${ze(oe.stage)}`,children:Ne(oe.stage)})}),a.jsxs("td",{className:"py-3 px-4 w-48 text-gray-800 font-medium text-sm",children:[" ",oe.amount?.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})||"0.00"]}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",children:rt(oe.close_date)||"--"}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",children:oe.assigned_deals?.first_name&&oe.assigned_deals?.last_name?`${oe.assigned_deals.first_name} ${oe.assigned_deals.last_name}`:oe.assigned_deals?.first_name||oe.assigned_deals?.last_name||"--"})]},oe.id)):a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:9,children:"No deals found."})})})]})}),a.jsx(ca,{className:"mt-4",totalItems:ve.length,pageSize:_,currentPage:w,onPrev:ue,onNext:re,onPageSizeChange:oe=>{T(oe),S(1)},pageSizeOptions:[10,20,30,40,50],label:"deals"}),p&&a.jsx(rUe,{onClose:te,formData:Ie,setFormData:xe,isEditing:P,onSubmit:jt,isSubmitting:k||F,accounts:W,contacts:Q,users:we,currentAccount:he,currentContact:Ee,onAddAccount:Je,onAddContact:Fe,onRefreshAccounts:Qe,onRefreshContacts:tt}),c&&a.jsx(vJ,{relatedActs:se,selectedDeal:c,show:!!c,onClose:()=>u(null),activeTab:d,setActiveTab:h,onEdit:_t,onDelete:ce,onStatusUpdate:Ct}),E&&a.jsx(nUe,{open:!0,title:E.title,message:E.message,confirmLabel:E.confirmLabel,cancelLabel:E.cancelLabel,variant:E.variant,onConfirm:fe,onCancel:H,loading:F})]})}function nUe({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o=!1,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":i==="archive"?"bg-orange-500 hover:bg-orange-600 border border-orange-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[10000]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsx("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${u}`,disabled:o,children:o?"Processing...":s})]})]})})}function sUe({icon:e,title:t,value:n,color:s="text-blue-600",bgColor:r="bg-blue-100",onClick:i}){const o=()=>{typeof i=="function"?i():console.log(`Clicked: ${t}`)};return a.jsxs("div",{className:"flex items-center p-4 bg-white rounded-xl shadow-md border border-gray-200 transition-all duration-300",onClick:o,children:[a.jsx("div",{className:`flex-shrink-0 p-3 rounded-full ${r} ${s} mr-4`,children:e?a.jsx(e,{size:22}):null}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:t}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:n})]})]})}function rUe({onClose:e,formData:t,setFormData:n,isEditing:s=!1,onSubmit:r,isSubmitting:i=!1,accounts:o=[],contacts:l=[],users:c=[],currentAccount:u=null,currentContact:d=null,onAddAccount:h,onAddContact:p,onRefreshAccounts:x,onRefreshContacts:b}){const{user:j}=Gt(),y=j?.role==="Sales";f.useEffect(()=>{!s&&y&&j&&!t.assigned_to&&n(k=>({...k,assigned_to:j.id}))},[s,y,j,t.assigned_to,n]);const[N,w]=f.useState(!1),S=k=>{if(k.preventDefault(),w(!0),!t.name?.trim()){V.error("Deal name is required.");return}const A=Number(t.amount);if(!t.amount||isNaN(A)||A<=0){V.error("Amount must be a number greater than 0.");return}if(!t.account_id){V.error("Please select an account.");return}if(!t.primary_contact_id){V.error("Please select a primary contact.");return}r?.(t)},_=k=>{k.target.id==="modalBackdrop"&&e()},T=f.useMemo(()=>{const k=String(t.account_id||"").trim(),A=Array.isArray(l)?l:[];return k?A.filter(E=>{const F=[E?.account_id,E?.accountId,E?.account?.id,E?.account?.account_id,E?.account?.accountId].find(D=>D!=null&&String(D).trim()!=="");return F?String(F)===k:!1}):A},[l,t.account_id]);return f.useEffect(()=>{const k=String(t.account_id||"").trim(),A=String(t.primary_contact_id||"").trim();if(!A||!k)return;T.some(M=>String(M?.id)===A)||n(M=>({...M,primary_contact_id:""}))},[t.account_id,t.primary_contact_id,T,n]),a.jsx("div",{id:"modalBackdrop",onClick:_,className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-full sm:max-w-3xl rounded-2xl shadow-lg p-4 sm:p-6 md:p-8 relative border border-gray-200 overflow-y-auto max-h-[90vh] hide-scrollbar",onClick:k=>k.stopPropagation(),children:[a.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-gray-500 hover:text-black transition",children:a.jsx(ea,{size:22})}),a.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800 mb-4 sm:mb-6 flex items-center justify-center",children:s?"Edit Deal":"Create Deal"}),a.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",onSubmit:S,noValidate:!0,children:[a.jsx(qA,{label:"Deal Name",name:"name",value:t.name,onChange:k=>n({...t,name:k.target.value}),placeholder:"Enter deal name",required:!0,isSubmitted:N,className:"md:col-span-2"}),a.jsx(GA,{label:"Account",value:t.account_id||"",onChange:k=>n({...t,account_id:k}),items:o||[],getLabel:k=>k?.name??"",placeholder:"Search account...",disabled:i,currentItem:u,actions:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{type:"button",onClick:h,disabled:i,title:"Add account",className:"inline-flex items-center justify-center w-8 h-8 rounded-md border border-gray-300 text-gray-600 hover:bg-gray-50 transition disabled:opacity-60",children:a.jsx(aa,{size:16})}),a.jsx("button",{type:"button",onClick:x,disabled:i,title:"Refresh accounts",className:"inline-flex items-center justify-center w-8 h-8 rounded-md border border-gray-300 text-gray-600 hover:bg-gray-50 transition disabled:opacity-60",children:a.jsx(Br,{size:16})})]}),required:!0,isSubmitted:N}),a.jsx(GA,{label:"Primary Contact",value:t.primary_contact_id||"",onChange:k=>n({...t,primary_contact_id:k}),items:T||[],getLabel:k=>`${k?.first_name??""} ${k?.last_name??""}`.trim()||k?.email||"",placeholder:"Search contact...",disabled:i,currentItem:d,actions:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{type:"button",onClick:p,disabled:i,title:"Add contact",className:"inline-flex items-center justify-center w-8 h-8 rounded-md border border-gray-300 text-gray-600 hover:bg-gray-50 transition disabled:opacity-60",children:a.jsx(aa,{size:16})}),a.jsx("button",{type:"button",onClick:b,disabled:i,title:"Refresh contacts",className:"inline-flex items-center justify-center w-8 h-8 rounded-md border border-gray-300 text-gray-600 hover:bg-gray-50 transition disabled:opacity-60",children:a.jsx(Br,{size:16})})]}),required:!0,isSubmitted:N}),a.jsx(b8,{label:"Stage",name:"stage",value:t.stage,onChange:k=>n({...t,stage:k.target.value}),options:[{value:"PROSPECTING",label:"Prospecting"},{value:"QUALIFICATION",label:"Qualification"},{value:"PROPOSAL",label:"Proposal"},{value:"NEGOTIATION",label:"Negotiation"},{value:"CLOSED_WON",label:"Closed Won"},{value:"CLOSED_LOST",label:"Closed Lost"},{value:"CLOSED_CANCELLED",label:"Closed Cancelled"}],disabled:i}),a.jsx(qA,{label:"Amount",name:"amount",type:"text",inputMode:"decimal",value:t.amount,onChange:k=>{let A=k.target.value;A.startsWith(".")&&(A="0"+A),!(A&&!/^\d*\.?\d*$/.test(A))&&n({...t,amount:A})},placeholder:"0.00",required:!0,isSubmitted:N}),a.jsx(b8,{label:"Currency",name:"currency",value:t.currency||"PHP",onChange:k=>n({...t,currency:k.target.value}),options:[{value:"PHP",label:"PHP"},{value:"USD",label:"USD"}],disabled:i}),a.jsx(qA,{label:"Close Date",name:"close_date",type:"date",value:t.close_date||"",onChange:k=>n({...t,close_date:k.target.value}),disabled:i}),a.jsx(GA,{label:"Assign To",value:t.assigned_to||"",onChange:k=>n({...t,assigned_to:k}),items:c||[],getLabel:k=>`${k?.first_name??""} ${k?.last_name??""}`.trim()||k?.email||"",placeholder:"Search assignee...",required:!0,disabled:i||y,className:"md:col-span-2"}),a.jsx(oUe,{label:"Description",name:"description",value:t.description,onChange:k=>n({...t,description:k.target.value}),placeholder:"Additional details...",rows:3,className:"md:col-span-2",disabled:i}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-2 md:col-span-2 mt-4",children:[a.jsx("button",{type:"button",onClick:e,className:"w-full sm:w-auto px-4 py-2 text-white bg-red-400 border border-red-300 rounded hover:bg-red-500 transition disabled:opacity-70",disabled:i,children:"Cancel"}),a.jsx("button",{type:"submit",className:"w-full sm:w-auto px-4 py-2 text-white border border-tertiary bg-tertiary rounded hover:bg-secondary transition disabled:opacity-70",disabled:i,children:i?"Saving...":s?"Update Deal":"Save Deal"})]})]})]})})}function qA({label:e,name:t,value:n,onChange:s,placeholder:r,type:i="text",required:o=!1,disabled:l=!1,className:c="",isSubmitted:u=!1}){const d=u&&!n?.trim();return a.jsxs("div",{className:c,children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",o&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:i,name:t,value:n??"",onChange:s,placeholder:r,required:o,disabled:l,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border focus:ring-2 disabled:bg-gray-100
          ${d?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}
          ${c}
        `})]})}function b8({label:e,name:t,value:n,onChange:s,options:r,required:i=!1,disabled:o=!1,className:l=""}){return a.jsxs("div",{className:l,children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsx("select",{name:t,value:n??"",onChange:s,required:i,disabled:o,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100",children:r.map(c=>a.jsx("option",{value:c.value,children:c.label},c.value))})]})}function GA({label:e,items:t=[],value:n="",onChange:s,getLabel:r,placeholder:i="Search...",disabled:o=!1,className:l="",currentItem:c=null,required:u=!1,isSubmitted:d=!1,actions:h=null}){const p=d&&u&&!n;return a.jsxs("div",{className:l,children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",u&&a.jsx("span",{className:"text-red-500",children:"*"})]}),h?a.jsx("div",{className:"flex items-center",children:h}):null]}),a.jsx(iUe,{items:t,value:n??"",onChange:s,getLabel:r,placeholder:i,disabled:o,currentItem:c,hasError:p})]})}function iUe({items:e=[],value:t="",onChange:n,getLabel:s,placeholder:r="Search...",disabled:i=!1,maxRender:o=200,currentItem:l=null,hasError:c={hasError:c}}){const[u,d]=f.useState(!1),[h,p]=f.useState(""),x=f.useRef(null),j=e.find(w=>String(w.id)===String(t))||l,y=j?s(j):"",N=f.useMemo(()=>{const w=h.trim().toLowerCase();return(w?e.filter(_=>(s(_)||"").toLowerCase().includes(w)):e).slice(0,o)},[e,h,s,o]);return f.useEffect(()=>{const w=S=>{x.current&&!x.current.contains(S.target)&&d(!1)};return document.addEventListener("mousedown",w),()=>document.removeEventListener("mousedown",w)},[]),f.useEffect(()=>{u||p("")},[u]),a.jsxs("div",{ref:x,className:"relative w-full",children:[a.jsx("input",{disabled:i,value:u?h:y,placeholder:r,onFocus:()=>!i&&d(!0),onChange:w=>{p(w.target.value),u||d(!0)},className:`w-full border rounded-md px-2 py-1.5 text-sm outline-none focus:ring-2 disabled:bg-gray-100
          ${c?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}`}),u&&!i&&a.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg overflow-hidden",children:[a.jsx("div",{className:"max-h-56 overflow-y-auto hide-scrollbar",children:N.length>0?N.map(w=>{const S=String(w.id),_=s(w),T=String(t)===S;return a.jsx("button",{type:"button",onClick:()=>{n(S),d(!1)},className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-50 ${T?"bg-blue-50":""}`,children:_||"--"},S)}):a.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No results"})}),e.length>o&&a.jsxs("div",{className:"px-3 py-2 text-[11px] text-gray-400 border-t",children:["Showing first ",o," results  keep typing to narrow."]})]})]})}function oUe({label:e,name:t,value:n,onChange:s,placeholder:r,required:i=!1,disabled:o=!1,className:l="",rows:c=3}){return a.jsxs("div",{className:l,children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsx("textarea",{name:t,value:n??"",onChange:s,placeholder:r,required:i,disabled:o,rows:c,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100 resize-none"})]})}const WA=[{value:"Draft",label:"Draft"},{value:"Presented",label:"Presented"},{value:"Accepted",label:"Accepted"},{value:"Rejected",label:"Rejected"}],VA={deal_id:"",account_id:"",contact_id:"",total_amount:"",presented_date:"",validity_days:"",status:"Draft",assigned_to:"",notes:"",subtotal:0,tax_rate:0,tax_amount:0,discount_type:"",discount_value:0,discount_amount:0,currency:"PHP",items:[]},Ri=e=>{if(!e)return"Draft";const t=e.toString().trim().toLowerCase();return{draft:"Draft",presented:"Presented",accepted:"Accepted",rejected:"Rejected"}[t]||"Draft"},YA=e=>e?e.toString().toLowerCase().replace(/\b\w/g,t=>t.toUpperCase()):"--",lUe=e=>{switch(Ri(e).toLowerCase()){case"draft":return"bg-gray-100 text-gray-700";case"presented":return"bg-yellow-100 text-yellow-700";case"accepted":return"bg-green-100 text-green-700";case"rejected":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-700"}},cUe=e=>{switch(Ri(e).toLowerCase()){case"draft":return"bg-gray-600 text-white";case"presented":return"bg-yellow-600 text-white";case"accepted":return"bg-green-600 text-white";case"rejected":return"bg-red-600 text-white";default:return"bg-gray-600 text-white"}},Lb=e=>e?new Date(e).toLocaleString("en-US",{month:"2-digit",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).replace(",",""):"",Og=e=>e?new Date(e).toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"numeric"}):"",dUe=e=>{if(!e)return"";if(typeof e=="string"&&e.match(/^\d{4}-\d{2}-\d{2}$/))return e;try{const t=new Date(e);if(isNaN(t.getTime()))return"";const n=t.getFullYear(),s=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0");return`${n}-${s}-${r}`}catch{return""}},QA=(e,t)=>{if(!e||t==null||t==="")return"";const n=Number(t);if(Number.isNaN(n))return"";const s=new Date(e);return isNaN(s.getTime())?"":(s.setDate(s.getDate()+n),s.toISOString().slice(0,10))},v8=e=>{if(!e)return"";const t=String(e).split("-");return t.length===3?`${t[0]}-${t[2]}`:String(e)},Db=e=>{if(!e)return"";const t=String(e).split("-");return t.length===3?`${t[0]}-${t[2]}`:String(e)},Jw=e=>{if(!e)return null;if(typeof e=="number")return e;if(typeof e=="string"&&e.trim()&&!Number.isNaN(Number(e)))return Number(e);if(typeof e=="object"){if(e.id&&!Number.isNaN(Number(e.id)))return Number(e.id);if(e.user?.id&&!Number.isNaN(Number(e.user.id)))return Number(e.user.id);if(e.data?.id&&!Number.isNaN(Number(e.data.id)))return Number(e.data.id);if(e.profile?.id&&!Number.isNaN(Number(e.profile.id)))return Number(e.profile.id)}return null},uUe=()=>{const e=["user","currentUser","userData","authUser","profile"];for(const s of e){const r=localStorage.getItem(s);if(r)try{const i=JSON.parse(r),o=Jw(i);if(o)return o}catch{}}const t=localStorage.getItem("user_id"),n=Jw(t);return n||null},mUe=e=>{if(!e)return"";const n=[e.account_id,e.accountId,e.account?.id,e.account?.account_id,e.account?.accountId].find(s=>s!=null&&String(s).trim()!=="");return n?String(n):""},fUe=e=>{if(!e)return"";const n=[e.contact_id,e.contactId,e.contact?.id,e.primary_contact_id,e.primaryContactId,e.primary_contact?.id,e.primaryContact?.id].find(s=>s!=null&&String(s).trim()!=="");return n?String(n):""};function hUe(){const e=Et(),t=ta(),{user:n}=Gt(),s=n?.company?.currency||"";f.useEffect(()=>{document.title="Quotes | Sari-Sari CRM"},[]);const[r,i]=f.useState([]),[o,l]=f.useState(!1),[c,u]=f.useState([]),[d,h]=f.useState([]),[p,x]=f.useState([]),[b,j]=f.useState([]),[y,N]=f.useState(null),[w,S]=f.useState(null),[_,T]=f.useState(!1),[k,A]=f.useState(!1),[E,M]=f.useState(!1),[F,D]=f.useState(null),[P,B]=f.useState(!1),[G,$]=f.useState(!1),[W,Z]=f.useState(null),[Q,le]=f.useState(VA),[we,J]=f.useState(""),[se,ye]=f.useState("Filter by Status"),[Ce,ge]=f.useState(null),be=f.useCallback(async()=>{if(w)try{$(!0);const L=(await ne.get("/company/invoice-info"))?.data;e(`/sales/quotes/${encodeURIComponent(w.id)}/print`,{state:{quote:w,companyInfo:L}})}catch(I){const L=I?.response?.data?.detail||I?.message||"Failed to open print page.";V.error(L)}finally{$(!1)}},[w,e]),[me,Ae]=f.useState(1),[pe,Ie]=f.useState(10),[xe,he]=f.useState("Overview"),[Re,Ee]=f.useState("Draft"),[He,Ke]=f.useState([]),[st,it]=f.useState(null),{comments:ot,addComment:rt,refresh:at}=kn({relatedType:"quote",relatedId:w?.id});f.useEffect(()=>{w?.id&&at()},[w?.id,at]),f.useEffect(()=>{const L=t.state?.quoteID;if(L){it(L),e(t.pathname,{replace:!0,state:{}});return}},[t,e]),f.useEffect(()=>{if(st&&r.length>0&&!o){const I=r.find(L=>L.id===st);I?S(I):V.error("Quote not found."),it(null)}},[st,r,o]),f.useEffect(()=>{let I=!0;return(async()=>{const ee=uUe();if(ee&&I){N(ee);return}try{const ke=await ne.get("/auth/me"),$e=Jw(ke?.data);if($e&&I){N($e);return}}catch{}try{const ke=await ne.get("/users/me"),$e=Jw(ke?.data);if($e&&I){N($e);return}}catch{}I&&N(null)})(),()=>{I=!1}},[]);const Je=f.useCallback(I=>I&&d.find(ee=>String(ee.id)===String(I))?.name||"",[d]),Fe=f.useCallback(I=>{if(!I)return"";const L=p.find(ee=>String(ee.id)===String(I));return L?`${L.first_name} ${L.last_name}`.trim():""},[p]),Ue=f.useCallback(I=>{if(!I)return"--";const L=c.find(ee=>String(ee.id)===String(I));return L?.deal_name||L?.name||`Deal #${v8(I)}`},[c]),Ne=f.useCallback(I=>{const L=c.find($e=>String($e.id)===String(I)),ee=mUe(L);let ke=fUe(L);if(!ke&&ee){const $e=p.filter(We=>String(We.account_id||"")===String(ee));if($e.length>0){const We=[...$e].sort((mt,Tt)=>{const kt=`${mt.first_name||""} ${mt.last_name||""}`.trim().toLowerCase(),Yt=`${Tt.first_name||""} ${Tt.last_name||""}`.trim().toLowerCase();return kt.localeCompare(Yt)});ke=String(We[0].id)}}if(ee&&ke){const $e=p.find(We=>String(We.id)===String(ke));$e?.account_id&&String($e.account_id)!==String(ee)&&(ke="")}return{accountId:ee||"",contactId:ke||""}},[c,p]),ze=f.useCallback(I=>{if(!I)return"--";if(I.deal?.deal_name)return I.deal.deal_name;if(I.deal?.name)return I.deal.name;const L=I.deal_id||I.deal?.id;return L?Ue(L):"--"},[Ue]),je=f.useCallback(I=>{if(!I)return"--";if(I.account?.name)return I.account.name;let L=I.account_id||I.account?.id;if(!L){const ee=I.deal_id||I.deal?.id;ee&&(L=Ne(ee).accountId)}return L?Je(L)||`Account #${L}`:"--"},[Ne,Je]),ve=f.useCallback(I=>{if(!I)return"--";if(I.contact?.first_name||I.contact?.last_name)return`${I.contact?.first_name||""} ${I.contact?.last_name||""}`.trim()||"--";let L=I.contact_id||I.contact?.id;if(!L){const ke=I.deal_id||I.deal?.id;ke&&(L=Ne(ke).contactId)}return(L?Fe(L):"")||(L?`Contact #${L}`:"--")},[Ne,Fe]),z=f.useCallback(async(I=null)=>{l(!0);try{const L=await ne.get("/quotes/admin/fetch-all"),ke=[...Array.isArray(L.data)?L.data:[]].sort(($e,We)=>{const mt=$e?.created_at||$e?.updated_at||0,Tt=We?.created_at||We?.updated_at||0;return new Date(Tt)-new Date(mt)});if(i(ke),I){const $e=ke.find(We=>We.id===I);S($e||null)}}catch(L){console.error(L),i([]),L.response?.status===403?V.error("Permission denied. Only CEO, Admin, or Group Manager can access this page."):V.error("Failed to fetch quotes. Please try again later.")}finally{l(!1)}},[]),K=f.useCallback(async()=>{try{const I=await ne.get("/deals/admin/fetch-all");u(Array.isArray(I.data)?I.data:[])}catch(I){console.error(I),I.response?.status===403&&V.warn("Unable to load deals (permission denied).")}},[]),ue=f.useCallback(async()=>{try{const I=await ne.get("/accounts/admin/fetch-all");h(Array.isArray(I.data)?I.data:[])}catch(I){console.error(I),I.response?.status===403&&V.warn("Unable to load accounts (permission denied).")}},[]),re=f.useCallback(async()=>{try{const I=await ne.get("/contacts/admin/fetch-all");x(Array.isArray(I.data)?I.data:[])}catch(I){console.error(I),I.response?.status===403&&V.warn("Unable to load contacts (permission denied).")}},[]),Le=f.useCallback(async()=>{try{const I=await ne.get("/users/all");j(Array.isArray(I.data)?I.data:[])}catch(I){console.error(I),I.response?.status===403&&V.warn("Unable to load users (permission denied).")}},[]);f.useEffect(()=>{z(),K(),ue(),re(),Le()},[z,K,ue,re,Le]);const De=f.useMemo(()=>{const I=we.trim().toLowerCase(),L=se.trim();return r.filter(ee=>{const ke=ze(ee),$e=je(ee),We=ve(ee),mt=QA(ee.presented_date,ee.validity_days),Tt=[ee.quote_id,Db(ee.quote_id),ee.id?.toString(),ke,$e,We,ee.total_amount?.toString(),ee.validity_days?.toString(),ee.presented_date?Og(ee.presented_date):"",mt?Og(mt):"",ee.assigned_user?.first_name,ee.assigned_user?.last_name,ee.creator?.first_name,ee.creator?.last_name,ee.status,ee.notes,Lb(ee.created_at),Lb(ee.updated_at)],kt=I===""||Tt.some(En=>En==null?!1:En.toString().toLowerCase().includes(I)),Yt=L==="Filter by Status"||Ri(ee.status)===L;return kt&&Yt})},[r,we,se,ze,je,ve]),Qe=Math.max(1,Math.ceil(De.length/pe)||1);f.useEffect(()=>Ae(1),[we,se]),f.useEffect(()=>{Ae(I=>{const L=Math.max(1,Math.ceil(De.length/pe)||1);return I>L?L:I})},[De.length,pe]);const tt=f.useMemo(()=>{const I=(me-1)*pe;return De.slice(I,I+pe)},[De,me,pe]),Me=()=>Ae(I=>Math.max(I-1,1)),et=()=>Ae(I=>Math.min(I+1,Qe)),yt=I=>{S(I),he("Overview"),Ee(Ri(I?.status)||"Draft")},_t=()=>{S(null),he("Overview")},Ct=I=>{I.target.id==="quoteModalBackdrop"&&!P&&_t()},jt=f.useCallback(()=>{T(!1),A(!1),Z(null),le(VA),M(!1)},[]),At=I=>{I.target.id==="modalBackdrop"&&!E&&!P&&jt()},Ge=I=>{const{name:L,value:ee}=I.target;if(L==="deal_id"){const{accountId:ke,contactId:$e}=Ne(ee);le(We=>({...We,deal_id:ee,account_id:ke,contact_id:$e}));return}le(ke=>({...ke,[L]:ee}))},Be=()=>{const I={...VA};n?.role?.toUpperCase()==="SALES"&&y&&(I.assigned_to=String(y)),le(I),A(!1),Z(null),T(!0)},ce=I=>{if(!I)return;S(null);const L=I.deal?.id?String(I.deal.id):I.deal_id?String(I.deal_id):"",ee=L?Ne(L):{accountId:"",contactId:""},ke=I.account?.id?String(I.account.id):I.account_id?String(I.account_id):ee.accountId,$e=I.contact?.id?String(I.contact.id):I.contact_id?String(I.contact_id):ee.contactId,We=I.assigned_user?.id?String(I.assigned_user.id):I.assigned_to?String(I.assigned_to):"";le({deal_id:L,account_id:ke||"",contact_id:$e||"",total_amount:I.total_amount?.toString()||"",presented_date:dUe(I.presented_date),validity_days:I.validity_days!==null&&I.validity_days!==void 0?String(I.validity_days):"",status:Ri(I.status)||"Draft",assigned_to:We,notes:I.notes||"",subtotal:parseFloat(I.subtotal)||0,tax_rate:parseFloat(I.tax_rate)||0,tax_amount:parseFloat(I.tax_amount)||0,discount_type:I.discount_type||"",discount_value:parseFloat(I.discount_value)||0,discount_amount:parseFloat(I.discount_amount)||0,currency:I.currency||"PHP",items:Array.isArray(I.items)?I.items.map(mt=>({id:mt.id,item_type:mt.item_type||"Product",name:mt.name||"",description:mt.description||"",sku:mt.sku||"",variant:mt.variant||"",unit:mt.unit||"pcs",quantity:parseFloat(mt.quantity)||1,unit_price:parseFloat(mt.unit_price)||0,discount_percent:parseFloat(mt.discount_percent)||0,discount_amount:parseFloat(mt.discount_amount)||0,line_total:parseFloat(mt.line_total)||0,sort_order:mt.sort_order||0})):[]}),A(!0),Z(I.id),T(!0)},fe=I=>{if(I.target.checked){const L=tt.filter(ee=>ee.created_by===y).map(ee=>ee.id);Ke(L)}else Ke([])},H=I=>{Ke(L=>L.includes(I)?L.filter(ee=>ee!==I):[...L,I])},te=tt.filter(I=>I.created_by===y),q=I=>{if(!I)return;const L=I.quote_id||"this quote";D({title:"Archive Quote",message:a.jsxs("span",{children:["Are you sure you want to archive"," ",a.jsx("span",{className:"font-semibold",children:L}),"? This action cannot be undone."]}),confirmLabel:"Archive Quote",cancelLabel:"Cancel",variant:"danger",action:{type:"delete",targetId:I.id,name:L}})},Y=async()=>{He.length!==0&&D({title:"Archive Quotes",message:a.jsxs("span",{children:["Are you sure you want to archive"," ",a.jsx("span",{className:"font-semibold",children:He.length})," selected quotes? This action cannot be undone."]}),confirmLabel:`Archive ${He.length} Quote(s)`,cancelLabel:"Cancel",variant:"danger",action:{type:"bulk-delete",quote_ids:He}})},[U,de]=f.useState(!1),Te=I=>{if(I.preventDefault(),de(!0),!y){V.error("Unable to determine current user. Please log in again.");return}if(!Q.deal_id){V.error("Deal is required.");return}if(!Q.assigned_to&&n?.role?.toUpperCase()!=="SALES"){V.error("Assigned To is required.");return}const ee=Ne(Q.deal_id),ke=Q.items.map((kt,Yt)=>({item_type:kt.item_type||"Product",name:kt.name,description:kt.description||null,sku:kt.sku||null,variant:kt.variant||null,unit:kt.unit||null,quantity:parseFloat(kt.quantity)||1,unit_price:parseFloat(kt.unit_price)||0,discount_percent:parseFloat(kt.discount_percent)||0,sort_order:kt.sort_order??Yt})),$e={deal_id:Number(Q.deal_id),account_id:ee.accountId?Number(ee.accountId):null,contact_id:ee.contactId?Number(ee.contactId):null,subtotal:parseFloat(Q.subtotal)||0,tax_rate:parseFloat(Q.tax_rate)||0,tax_amount:parseFloat(Q.tax_amount)||0,discount_type:Q.discount_type||null,discount_value:parseFloat(Q.discount_value)||0,discount_amount:parseFloat(Q.discount_amount)||0,total_amount:parseFloat(Q.total_amount)||0,currency:Q.currency||"PHP",presented_date:Q.presented_date||null,validity_days:Q.validity_days===""?null:Number(Q.validity_days),status:Q.status||"Draft",assigned_to:Q.assigned_to?Number(Q.assigned_to):null,notes:Q.notes?.trim()||null,items:ke},We=k&&W?"update":"create",mt=Ue(Q.deal_id),Tt=We==="create"?{...$e,created_by_id:Number(y)}:$e;D({title:We==="create"?"Confirm New Quote":"Confirm Update",message:We==="create"?a.jsxs("span",{children:["Are you sure you want to create a quote for"," ",a.jsx("span",{className:"font-semibold",children:mt}),"?"]}):a.jsxs("span",{children:["Save changes to"," ",a.jsx("span",{className:"font-semibold",children:mt}),"?"]}),confirmLabel:We==="create"?"Create Quote":"Update Quote",cancelLabel:"Cancel",variant:"primary",action:{type:We,payload:Tt,targetId:W||null,name:mt}})},ie=async()=>{if(!F?.action){D(null);return}const{action:I}=F,{type:L,payload:ee,targetId:ke,name:$e}=I;B(!0);try{if(L==="create")M(!0),await ne.post("/quotes/admin",ee),V.success("Quote created successfully."),jt(),await z();else if(L==="update"){if(!ke)throw new Error("Missing quote identifier for update.");M(!0),await ne.put(`/quotes/admin/${ke}`,ee),V.success("Quote updated successfully."),jt(),await z(),w?.id===ke&&S(null)}else if(L==="delete"){if(!ke)throw new Error("Missing quote identifier for deletion.");const We=w?.id;ge(ke),await ne.delete(`/quotes/admin/${ke}`),V.success(`Quote "${$e}" archived successfully.`),await z(We&&We!==ke?We:null),We===ke&&S(null)}else L==="bulk-delete"&&(await ne.post("/quotes/admin/bulk-delete",{quote_ids:He}),V.success(`Successfully archived ${He.length} quotes`),Ke([]),await z())}catch(We){console.error(We);const mt=L==="create"?"Failed to create quote. Please review the details and try again.":L==="update"?"Failed to update quote. Please review the details and try again.":"Failed to archive quote. Please try again.";V.error(mt),(L==="create"||L==="update")&&M(!1),L==="delete"&&ge(null)}finally{(L==="create"||L==="update")&&M(!1),L==="delete"&&ge(null),B(!1),D(null)}},Oe=()=>{P||D(null)},X=f.useCallback((I,L)=>{const ee=I?.deal_id??I?.deal?.id??"",ke=ee?Number(ee):null,$e=ke?Ne(String(ke)):{accountId:"",contactId:""},We=I?.account_id??I?.account?.id??$e.accountId??null,mt=I?.contact_id??I?.contact?.id??$e.contactId??null,Tt=I?.total_amount??0,kt=I?.assigned_to??I?.assigned_user?.id??null;return{deal_id:ke,account_id:We!=null&&String(We).trim()!==""?Number(We):null,contact_id:mt!=null&&String(mt).trim()!==""?Number(mt):null,total_amount:Number(Tt),presented_date:I?.presented_date||null,validity_days:I?.validity_days===""||I?.validity_days===void 0||I?.validity_days===null?null:Number(I.validity_days),status:L,assigned_to:kt!=null&&String(kt).trim()!==""?Number(kt):null,notes:I?.notes?.trim()||null}},[Ne]),oe=f.useCallback(async()=>{if(!w?.id)return;const I=Ri(Re),L=[I,I.toLowerCase()],ee=async ke=>ne.patch(`/quotes/admin/${w.id}/status`,{status:ke},{headers:{"Content-Type":"application/json"}});try{let ke=!1;for(const $e of L)try{await ee($e),ke=!0;break}catch(We){if(We?.response?.status===422)continue;throw We}if(!ke){const $e=X(w,I);if(!$e.deal_id){V.error("Cannot update status: missing deal_id on selected quote.");return}if(!$e.total_amount||$e.total_amount<=0){V.error("Cannot update status: missing/invalid total_amount on selected quote.");return}await ne.put(`/quotes/admin/${w.id}`,$e)}V.success(`Quote status updated to ${I}`),S(null),he("Overview"),await z()}catch(ke){console.error(ke);const $e=ke?.response?.data?.message||(ke?.response?.data?.errors?Object.values(ke.response.data.errors).flat().join(" "):null)||"Failed to update quote status. Please try again.";V.error($e)}},[w,Re,z,X]),Pe=[{label:"Filter by Status",value:"Filter by Status"},...WA.map(I=>({label:I.label,value:I.value}))],Ve=F?.action?.type==="delete"?F.action.targetId:null,ft=w&&(Ce===w.id||Ve===w.id),St=w&&Ce===w.id,Ht=w?a.jsx("div",{id:"quoteModalBackdrop",onClick:Ct,className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-6xl max-h-[92vh] overflow-y-auto hide-scrollbar animate-scale-in font-inter relative",onClick:I=>I.stopPropagation(),children:[a.jsx("div",{className:"w-full flex flex-col items-center justify-center rounded-t-xl",children:a.jsxs("div",{className:"bg-tertiary w-full flex items-center justify-between p-3 lg:p-3 rounded-t-xl",children:[a.jsx("h1",{className:"lg:text-3xl text-xl text-white font-semibold text-center w-full",children:"Quotes"}),a.jsx("button",{onClick:_t,className:"text-gray-500 hover:text-white transition cursor-pointer",children:a.jsx(Za,{size:25})})]})}),a.jsxs("div",{className:"p-6 lg:p-4",children:[a.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between lg:flex-row lg:items-center lg:justify-between mt-3 gap-2 px-2 md:items-center lg:gap-4 md:mx-7 lg:mx-7",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[a.jsx("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-800",children:ze(w)}),a.jsx("span",{className:`text-xs sm:text-sm font-medium px-2 sm:px-3 py-1 rounded-full whitespace-nowrap ${cUe(w.status)}`,children:YA(w.status)})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsxs("button",{className:"inline-flex items-center justify-center w-full sm:w-auto bg-white text-gray-700 px-4 py-2 rounded-md border border-gray-300 hover:bg-gray-50 disabled:opacity-70 transition text-sm focus:outline-none focus:ring-2 focus:ring-gray-300",onClick:be,disabled:G||E||P,children:[a.jsx(ia,{className:"mr-2"}),G?"Preparing...":"Print Quotation"]}),y===w.created_by&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{className:"inline-flex items-center justify-center w-full sm:w-auto bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 disabled:opacity-70 transition text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",onClick:()=>ce(w),disabled:P||F?.action?.type==="update"&&F.action.targetId===w.id,children:[a.jsx(gn,{className:"mr-2"}),"Edit"]}),a.jsx("button",{className:"inline-flex items-center justify-center w-full sm:w-auto px-4 py-2 rounded-md text-sm bg-orange-500 text-white hover:bg-orange-600 transition focus:outline-none focus:ring-2 focus:ring-orange-400",onClick:()=>q(w),disabled:!!ft,children:St?"Archiving...":a.jsxs(a.Fragment,{children:[a.jsx(Zt,{className:"mr-2"}),"Archive"]})})]})]})]}),a.jsx("div",{className:"border-b border-gray-200 my-5"}),a.jsxs("div",{className:"p-1 lg:p-4",children:[a.jsx("div",{className:"flex w-full bg-[#6A727D] text-white mt-1 overflow-x-auto mb-6",children:["Overview","Notes"].map(I=>a.jsx("button",{onClick:()=>he(I),className:`flex-1 min-w-[90px] px-4 py-2.5 text-xs sm:text-sm font-medium text-center transition-all duration-200 border-b-2
                    ${xe===I?"bg-paper-white text-[#6A727D] border-white":"text-white hover:bg-[#5c636d]"}`,children:I},I))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 items-start",children:[a.jsxs("div",{className:"lg:col-span-3",children:[xe==="Overview"&&a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 md:p-8 border border-gray-200",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4 sm:gap-6 text-sm text-gray-700",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Quote ID:"}),a.jsx("p",{children:Db(w.quote_id)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Deal:"}),a.jsx("p",{children:ze(w)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Account:"}),a.jsx("p",{children:je(w)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Contact:"}),a.jsx("p",{children:ve(w)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Total Amount:"}),a.jsx("p",{children:w.total_amount?`${s}${Number(w.total_amount).toLocaleString()}`:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Presented Date:"}),a.jsx("p",{children:Og(w.presented_date)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Validity Days:"}),a.jsx("p",{children:w.validity_days!==null&&w.validity_days!==void 0?w.validity_days:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Expiry Date:"}),a.jsx("p",{children:Og(QA(w.presented_date,w.validity_days))||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Status:"}),a.jsx("p",{children:YA(w.status)})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Assigned To:"}),a.jsx("p",{children:w.assigned_user?`${w.assigned_user.first_name} ${w.assigned_user.last_name}`:"Unassigned"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created By:"}),a.jsx("p",{children:w.creator?`${w.creator.first_name} ${w.creator.last_name}`:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created At:"}),a.jsx("p",{children:Lb(w.created_at)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Last Updated:"}),a.jsx("p",{children:Lb(w.updated_at)||"N/A"})]})]}),w.items&&w.items.length>0&&a.jsx("div",{className:"mt-6",children:a.jsx(wd,{items:w.items,onChange:()=>{},currencySymbol:s,readOnly:!0,taxRate:parseFloat(w.tax_rate)||0,discountType:w.discount_type,discountValue:parseFloat(w.discount_value)||0})})]}),xe==="Notes"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"bg-white p-4 sm:p-6 rounded-xl border border-gray-200 shadow-sm",children:[a.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Notes:"}),a.jsx("p",{className:"text-sm text-gray-700 leading-relaxed whitespace-pre-wrap",children:w.notes||"No notes available."})]}),a.jsx(Tn,{comments:ot,onAddComment:rt})]})]}),a.jsxs("div",{className:"flex flex-col gap-4",children:[a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Quick Actions"}),a.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[a.jsxs("button",{onClick:()=>e("/sales/calls",{state:{openCallModal:!0,initialCallData:{subject:`Call regarding Quote ${Db(w.quote_id)}`,assigned_to:w.assigned_user?.id?String(w.assigned_user.id):w.assigned_to?String(w.assigned_to):"",direction:"Outgoing",status:"Planned"}}}),className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(It,{className:"text-gray-600 w-4 h-4"}),"Schedule Call"]}),a.jsxs("button",{className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",onClick:()=>e("/sales/meetings",{state:{openMeetingModal:!0,initialMeetingData:{subject:`Meeting with ${w.quote_id}`,assignedTo:w.assigned_user?.id?String(w.assigned_user.id):w.assigned_to?String(w.assigned_to):"",status:"Planned"}}}),children:[a.jsx(Pt,{className:"text-gray-600 w-4 h-4"}),"Book Meeting"]}),a.jsxs("button",{onClick:()=>e("/sales/tasks",{state:{openTaskModal:!0,initialTaskData:{subject:`Follow up with ${w.quote_id}`,assignedTo:w.assigned_user?.id?String(w.assigned_user.id):w.assigned_to?String(w.assigned_to):"",priority:"NORMAL",status:"Not Started"}}}),className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(Qt,{className:"text-gray-600 w-4 h-4"}),"Tasks"]})]})]}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm w-full",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Status"}),a.jsx("select",{className:"border border-gray-200 rounded-md px-2 sm:px-3 py-1.5 w-full text-sm mb-2 focus:ring-2 focus:ring-indigo-500 outline-none",value:Re||Ri(w.status)||"Draft",onChange:I=>Ee(I.target.value),children:WA.map(I=>a.jsx("option",{value:I.value,children:I.label},I.value))}),a.jsx("button",{onClick:oe,disabled:Ri(Re)===Ri(w.status),className:`w-full py-1.5 rounded-md text-sm transition focus:outline-none focus:ring-2 ${Ri(Re)===Ri(w.status)?"bg-gray-400 cursor-not-allowed text-white":"bg-gray-900 text-white hover:bg-gray-800 focus:ring-gray-400"}`,children:"Update"})]})]})]})]})]})]})}):null,da=a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[o&&a.jsx(qt,{message:"Loading quotes..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h2",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(ia,{className:"mr-2 text-blue-600"})," Quotes"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto gap-2",children:a.jsxs("button",{onClick:()=>{Be(),de(!1)},className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 rounded-md hover:bg-gray-800 text-sm sm:text-base mx-auto sm:ml-auto cursor-pointer",children:[a.jsx(aa,{className:"mr-2"})," Add Quote"]})})]}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search quotes",value:we,onChange:I=>J(I.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsx("div",{className:"w-full lg:w-1/4",children:a.jsx("select",{value:se,onChange:I=>ye(I.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:Pe.map(I=>a.jsx("option",{value:I.value,children:I.label},I.value))})})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[900px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 text-sm tracking-wide font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 w-12",children:a.jsx("input",{type:"checkbox",checked:te.length>0&&He.length===te.length,onChange:fe,className:"cursor-pointer"})}),a.jsx("th",{className:"py-3 px-4",children:"Quote ID"}),a.jsx("th",{className:"py-3 px-4",children:"Deal"}),a.jsx("th",{className:"py-3 px-4",children:"Account"}),a.jsx("th",{className:"py-3 px-4",children:"Contact"}),a.jsx("th",{className:"py-3 px-4",children:"Total Amount"}),a.jsx("th",{className:"py-3 px-4",children:"Status"}),a.jsx("th",{className:"py-3 px-4",children:"Assigned To"}),a.jsx("th",{className:"py-3 px-4",children:"Expiry Date"}),a.jsx("th",{className:"py-3 px-4 text-center w-24",children:He.length>0?a.jsx("button",{onClick:Y,className:"text-orange-600 hover:text-orange-800 transition p-1 rounded-full hover:bg-orange-50",title:`Archive ${He.length} selected items`,children:a.jsx(Zt,{size:18})}):""})]})}),a.jsx("tbody",{children:o?a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:10,children:"Loading quotes..."})}):De.length>0?tt.map(I=>{const L=QA(I.presented_date,I.validity_days);return a.jsxs("tr",{className:"hover:bg-gray-50 text-sm cursor-pointer transition",onClick:()=>yt(I),children:[a.jsx("td",{className:"py-3 px-4 align-top w-12",onClick:ee=>ee.stopPropagation(),children:I.created_by===y&&a.jsx("input",{type:"checkbox",checked:He.includes(I.id),onChange:()=>H(I.id),className:"cursor-pointer"})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("div",{className:"font-medium text-blue-600 hover:underline whitespace-nowrap",children:Db(I.quote_id)||"--"})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("div",{className:"break-words",children:ze(I)||"--"})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("div",{className:"text-sm text-gray-700 break-words",children:je(I)||"--"})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("div",{className:"break-words",children:ve(I)||"--"})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("div",{className:"text-gray-700",children:I.total_amount?`${s}${Number(I.total_amount).toLocaleString()}`:"--"})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-medium ${lUe(I.status)}`,children:YA(I.status)})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("div",{children:I.assigned_user?`${I.assigned_user.first_name} ${I.assigned_user.last_name}`:"Unassigned"})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("div",{className:"text-gray-500 text-xs",children:Og(L)||"--"})}),a.jsx("td",{className:"py-3 px-4 align-top text-center w-24"})]},I.id)}):a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:10,children:"No quotes found."})})})]})}),a.jsx(ca,{className:"mt-4",totalItems:De.length,pageSize:pe,currentPage:me,onPrev:Me,onNext:et,onPageSizeChange:I=>{Ie(I),Ae(1)},pageSizeOptions:[10,20,30,40,50],label:"quotes"})]}),qe=_?a.jsx("div",{id:"modalBackdrop",onClick:At,className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-full sm:max-w-3xl rounded-2xl shadow-lg p-4 sm:p-6 md:p-8 relative border border-gray-200 overflow-y-auto max-h-[90vh] hide-scrollbar",onClick:I=>I.stopPropagation(),children:[a.jsx("button",{onClick:()=>{jt(),de(!1)},className:"absolute top-4 right-4 text-gray-500 hover:text-black transition disabled:opacity-60",disabled:E||P,children:a.jsx(ea,{size:22})}),a.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800 mb-4 sm:mb-6 flex items-center justify-center",children:k?"Edit Quote":"Add New Quote"}),a.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",onSubmit:Te,children:[a.jsx(N8,{label:"Deal",name:"deal_id",value:Q.deal_id,onChange:I=>{const{accountId:L,contactId:ee}=Ne(I);le(ke=>({...ke,deal_id:I,account_id:L,contact_id:ee}))},items:Array.isArray(c)?c:[],getLabel:I=>`${v8(I?.deal_id??"")} ${I?.name??""}`.trim(),placeholder:"Search deal...",required:!0,isSubmitted:U,disabled:E||c.length===0,className:"md:col-span-2"}),a.jsx(j8,{label:"Account",value:Je(Q.account_id)||(Q.account_id?`Account #${Q.account_id}`:""),disabled:!0}),a.jsx(j8,{label:"Contact",value:Fe(Q.contact_id)||(Q.contact_id?`Contact #${Q.contact_id}`:""),disabled:!0}),a.jsx("div",{className:"md:col-span-2 mt-2",children:a.jsx(wd,{items:Q.items,onChange:I=>le(L=>({...L,items:I})),currencySymbol:s,readOnly:E,taxRate:Q.tax_rate,discountType:Q.discount_type,discountValue:Q.discount_value,onTotalsChange:I=>{le(L=>({...L,subtotal:I.subtotal,discount_amount:I.discount_amount,tax_amount:I.tax_amount,total_amount:I.total_amount}))}})}),a.jsxs("div",{className:"md:col-span-2 mt-2 p-4 bg-gray-50 rounded-lg",children:[a.jsx("h4",{className:"font-medium text-gray-700 mb-3",children:"Pricing Settings"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-600 text-xs mb-1",children:"Discount Type"}),a.jsxs("select",{value:Q.discount_type||"",onChange:I=>le(L=>({...L,discount_type:I.target.value})),className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm",disabled:E,children:[a.jsx("option",{value:"",children:"No Discount"}),a.jsx("option",{value:"percentage",children:"Percentage (%)"}),a.jsx("option",{value:"fixed",children:"Fixed Amount"})]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-gray-600 text-xs mb-1",children:["Discount"," ",Q.discount_type==="percentage"?"%":"Amount"]}),a.jsx("input",{type:"number",value:Q.discount_value||"",onChange:I=>le(L=>({...L,discount_value:I.target.value})),className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm",placeholder:"0",min:"0",max:Q.discount_type==="percentage"?"100":void 0,step:"0.01",disabled:E||!Q.discount_type})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-600 text-xs mb-1",children:"Tax Rate (%)"}),a.jsx("input",{type:"number",value:Q.tax_rate||"",onChange:I=>le(L=>({...L,tax_rate:I.target.value})),className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm",placeholder:"0",min:"0",max:"100",step:"0.01",disabled:E})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-600 text-xs mb-1",children:"Total Amount"}),a.jsxs("div",{className:"w-full bg-gray-100 border border-gray-300 rounded-md px-2 py-1.5 text-sm font-medium",children:[s,parseFloat(Q.total_amount||0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]})]}),a.jsx(w8,{label:"Presented Date",name:"presented_date",type:"date",value:Q.presented_date,onChange:Ge,disabled:E}),a.jsx(w8,{label:"Validity Days",name:"validity_days",type:"number",value:Q.validity_days,onChange:Ge,placeholder:"30",disabled:E}),n?.role?.toUpperCase()==="SALES"?a.jsxs("div",{children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:["Assigned To ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("div",{className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm bg-white text-black font-medium",children:(()=>{const I=b.find(L=>String(L.id)===Q.assigned_to);return I?`${I.first_name} ${I.last_name}`:"Assigning..."})()})]}):a.jsx(N8,{label:"Assigned To",value:Q.assigned_to||"",onChange:I=>le(L=>({...L,assigned_to:I})),items:Array.isArray(b)?b:[],getLabel:I=>{const L=`${I?.first_name??""} ${I?.last_name??""}`.trim();return L?I?.role?`${L} (${I.role})`:L:I?.email||""},placeholder:"Search assignee...",required:!0,isSubmitted:U,disabled:E}),a.jsx(gUe,{label:"Status",name:"status",value:Q.status,onChange:Ge,options:WA,required:!0,disabled:E}),a.jsx(xUe,{label:"Notes",name:"notes",value:Q.notes,onChange:Ge,placeholder:"Additional details...",rows:3,disabled:E,className:"md:col-span-2"}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-2 md:col-span-2 mt-4",children:[a.jsx("button",{type:"button",onClick:()=>{jt(),de(!1)},className:"w-full sm:w-auto px-4 py-2 text-white bg-gray-400 border border-gray-300 rounded hover:bg-gray-500 transition disabled:opacity-70",disabled:E||P,children:"Cancel"}),a.jsx("button",{type:"submit",className:"w-full sm:w-auto px-4 py-2 text-white border border-tertiary bg-tertiary rounded hover:bg-secondary transition disabled:opacity-70",disabled:E||P,children:E?"Saving...":k?"Update Quote":"Save Quote"})]})]})]})}):null,_e=F?a.jsx(yUe,{open:!0,title:F.title,message:F.message,confirmLabel:F.confirmLabel,cancelLabel:F.cancelLabel,variant:F.variant,onConfirm:ie,onCancel:Oe,loading:P}):null;return a.jsxs(a.Fragment,{children:[w?Ht:da,qe,_e]})}function w8({label:e,name:t,value:n,onChange:s,placeholder:r,type:i="text",required:o=!1,disabled:l=!1,className:c="",isSubmitted:u=!1}){const d=u&&!n?.trim();return a.jsxs("div",{className:c,children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",o&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:i,name:t,value:n??"",onChange:s,placeholder:r,required:o,disabled:l,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border focus:ring-2
          ${d?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}
          ${c}
        `})]})}function j8({label:e,value:t,className:n="",disabled:s=!0}){return a.jsxs("div",{className:n,children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsx("input",{type:"text",value:t??"",disabled:s,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm outline-none disabled:bg-gray-100"})]})}function gUe({label:e,name:t,value:n,onChange:s,options:r,required:i=!1,disabled:o=!1,className:l=""}){const c=n!=null?String(n):"",d=r.some(h=>String(h.value)===c)?c:"";return a.jsxs("div",{className:l,children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsx("select",{name:t,value:d,onChange:s,required:i,disabled:o,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100",children:r.map(h=>a.jsx("option",{value:String(h.value??""),children:h.label},h.value??h.label))})]})}function N8({label:e,items:t=[],value:n="",onChange:s,getLabel:r,placeholder:i="Search...",disabled:o=!1,className:l="",required:c=!1,isSubmitted:u=!1}){const d=u&&c&&!n;return a.jsxs("div",{className:l,children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",c&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx(pUe,{items:t,value:n??"",onChange:s,getLabel:r,placeholder:i,disabled:o,hasError:d})]})}function pUe({items:e=[],value:t="",onChange:n,getLabel:s,placeholder:r="Search...",disabled:i=!1,maxRender:o=200,hasError:l=!1}){const[c,u]=f.useState(!1),[d,h]=f.useState(""),p=f.useRef(null),x=e.find(y=>String(y.id)===String(t)),b=x?s(x):"",j=f.useMemo(()=>{const y=d.trim().toLowerCase();return(y?e.filter(w=>(s(w)||"").toLowerCase().includes(y)):e).slice(0,o)},[e,d,s,o]);return f.useEffect(()=>{const y=N=>{p.current&&!p.current.contains(N.target)&&u(!1)};return document.addEventListener("mousedown",y),()=>document.removeEventListener("mousedown",y)},[]),f.useEffect(()=>{c||h("")},[c]),a.jsxs("div",{ref:p,className:"relative w-full",children:[a.jsx("input",{disabled:i,value:c?d:b,placeholder:r,onFocus:()=>!i&&u(!0),onChange:y=>{h(y.target.value),c||u(!0)},className:`w-full border rounded-md px-2 py-1.5 text-sm outline-none focus:ring-2
          ${l?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}`}),c&&!i&&a.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg overflow-hidden",children:[a.jsx("div",{className:"max-h-56 overflow-y-auto hide-scrollbar",children:j.length>0?j.map(y=>{const N=String(y.id),w=s(y),S=String(t)===N;return a.jsx("button",{type:"button",onClick:()=>{n(N),u(!1)},className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-50 ${S?"bg-blue-50":""}`,children:w||"--"},N)}):a.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No results"})}),e.length>o&&a.jsxs("div",{className:"px-3 py-2 text-[11px] text-gray-400 border-t",children:["Showing first ",o," results  keep typing to narrow."]})]})]})}function xUe({label:e,name:t,value:n,onChange:s,placeholder:r,rows:i=3,disabled:o=!1,className:l=""}){return a.jsxs("div",{className:l,children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsx("textarea",{name:t,value:n??"",onChange:s,placeholder:r,rows:i,disabled:o,className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100 resize-none"})]})}function yUe({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o=!1,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-orange-500 hover:bg-orange-600 border border-orange-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsx("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${u}`,disabled:o,children:o?"Processing...":s})]})]})})}function bUe(){const{userRole:e}=Ks();return a.jsx(N1,{currentUserRole:e,currentUserId:null})}function vUe(){f.useEffect(()=>{document.title="Audit | Sari-Sari CRM"},[]);const[e,t]=f.useState(null),[n,s]=f.useState(""),[r,i]=f.useState("Filter by Actions"),[o,l]=f.useState(1),[c,u]=f.useState(10),d=async()=>{try{const w=await ne.get("/logs/read-all");t(w.data)}catch(w){console.error("Error fetching audit logs:",w)}};f.useEffect(()=>{d()},[]);const h=f.useMemo(()=>{if(!Array.isArray(e))return[];const w=n.trim().toLowerCase(),S=r?.toUpperCase?.()||"ALL";return e.filter(T=>{const k=T.timestamp?new Date(T.timestamp).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}):"",A=`${T.entity_type||""} ${T.entity_name||T.entity_details?.name||T.entity_details?.title||T.entity_id||""}`,E=`${T.logger?.first_name||""} ${T.logger?.last_name||""}`,M=[k,E,T.action,T.entity_type,A,T.description],F=w===""||M.some(P=>P==null?!1:P.toString().toLowerCase().includes(w)),D=S==="FILTER BY ACTIONS"||(T.action||"").toUpperCase()===S;return F&&D}).sort((T,k)=>{const A=T.timestamp?new Date(T.timestamp).getTime():0;return(k.timestamp?new Date(k.timestamp).getTime():0)-A})},[e,n,r]),p=Math.max(1,Math.ceil(h.length/c)||1);f.useEffect(()=>{l(1)},[n,r]),f.useEffect(()=>{l(w=>{const S=Math.max(1,Math.ceil(h.length/c)||1);return w>S?S:w})},[h.length,c]);const x=f.useMemo(()=>{const w=(o-1)*c;return h.slice(w,w+c)},[h,o,c]);h.length===0||(o-1)*c+1,Math.min(o*c,h.length);const b=()=>l(w=>Math.max(w-1,1)),j=()=>l(w=>Math.min(w+1,p)),y=()=>{if(!h.length){Jx.error("No logs to export!");return}const w=["Timestamp","User","Action","Resource","Details"],S=h.map(E=>[new Date(E.timestamp).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}),`${E.logger?.first_name||""} ${E.logger?.last_name||""}`.trim(),E.action,`${E.entity_type}: ${E.entity_id}`,E.description||""]),_=[w.join(","),...S.map(E=>E.map(M=>`"${String(M).replace(/"/g,'""')}"`).join(","))].join(`
`),T=new Blob([_],{type:"text/csv;charset=utf-8;"}),k=URL.createObjectURL(T),A=document.createElement("a");A.href=k,A.download=`AuditLogs_${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(A),A.click(),document.body.removeChild(A),URL.revokeObjectURL(k)},N=w=>{switch((w||"").toUpperCase()){case"CREATE":return"bg-green-100 text-green-700";case"UPDATE":case"EDIT":return"bg-blue-100 text-blue-700";case"DELETE":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-700"}};return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[e===null&&a.jsx(qt,{message:"Loading audit logs..."}),a.jsx(Zx,{toastOptions:{duration:1e3}}),a.jsxs("div",{className:"bg-blue-50 border-l-4 border-blue-400 p-4 mb-6 rounded-r-md flex items-center",children:[a.jsx(Pt,{className:"text-blue-600 mr-3 flex-shrink-0",size:20}),a.jsxs("p",{className:"text-sm text-blue-700",children:[a.jsx("span",{className:"font-semibold",children:"Data Retention Policy:"})," Audit logs are automatically purged after 6 months to optimize system performance."]})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-5 space-y-3 sm:space-y-0",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Ls,{className:"text-blue-600",size:20}),a.jsx("h2",{className:"text-2xl sm:text-xl font-semibold text-gray-700",children:"Audit Logs"})]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 rounded-md hover:bg-gray-800 text-sm sm:text-base self-end sm:self-auto cursor-pointer",onClick:y,children:[a.jsx(Vo,{className:"mr-2"}),"Export Logs"]})})]}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition bg-white",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search audit logs",value:n,onChange:w=>s(w.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsx("div",{className:"w-full lg:w-1/4",children:a.jsxs("select",{value:r,onChange:w=>i(w.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{value:"Filter by Actions",children:"Filter by Actions"}),a.jsx("option",{value:"CREATE",children:"CREATE"}),a.jsx("option",{value:"DELETE",children:"DELETE"}),a.jsx("option",{value:"UPDATE",children:"UPDATE"})]})})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[600px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 text-sm tracking-wide font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4",children:"Timestamp"}),a.jsx("th",{className:"py-3 px-4",children:"User"}),a.jsx("th",{className:"py-3 px-4",children:"Action"}),a.jsx("th",{className:"py-3 px-4",children:"Resource"}),a.jsx("th",{className:"py-3 px-4",children:"Details"})]})}),a.jsx("tbody",{children:Array.isArray(h)&&h.length>0?x.map((w,S)=>a.jsxs("tr",{className:"hover:bg-gray-50 text-sm",children:[a.jsx("td",{className:"py-3 px-4 text-gray-700 whitespace-nowrap",children:new Date(w.timestamp).toLocaleString("en-US",{month:"numeric",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}).replace(",","")}),a.jsx("td",{className:"py-3 px-4 text-gray-700",children:w.name}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium whitespace-nowrap ${N(w.action)}`,children:w.action})}),a.jsxs("td",{className:"py-3 px-4 text-gray-700",children:[w.entity_type,": ",w.entity_id]}),a.jsx("td",{className:"py-3 px-4 text-gray-700",children:w.description})]},S)):a.jsx("tr",{children:a.jsx("td",{className:"py-3 px-4 text-sm text-gray-500 text-center",colSpan:5,children:"No activities to show."})})})]})}),a.jsx(ca,{className:"mt-4",totalItems:h.length,pageSize:c,currentPage:o,onPrev:b,onNext:j,onPageSizeChange:w=>{u(w),l(1)},pageSizeOptions:[10,20,30,40,50],label:"logs"})]})}const C8=["Not started","In progress","Deferred","Completed"],S8={NOT_STARTED:"Not started","NOT STARTED":"Not started","TO DO":"Not started",IN_PROGRESS:"In progress","IN PROGRESS":"In progress",COMPLETED:"Completed",DEFERRED:"Deferred","Not started":"Not started","In progress":"In progress",Completed:"Completed",Deferred:"Deferred","In Progress":"In progress","To Do":"Not started",Review:"Deferred"},wJ=e=>e&&(S8[e]||S8[String(e).toUpperCase()])||"Not started",wUe=e=>{if(!e)return"";const t=new Date(e);if(Number.isNaN(t.getTime()))return"";const n=t.getTimezoneOffset();return new Date(t.getTime()-n*60*1e3).toISOString().slice(0,16)},KA=e=>{if(!e)return"";const t=new Date(e);return Number.isNaN(t.getTime())?"":t.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},jUe=e=>{const t=e.subject?.trim()??"",n=e.description?.trim()??"",s=e.notes?.trim()??"";e.priority&&String(e.priority).toUpperCase(),wJ(e.status);let r=null,i=null,o=null,l=null,c=null;e.relatedType1==="Lead"&&e.relatedTo1?r=Number(e.relatedTo1):e.relatedType1==="Account"&&e.relatedTo1&&(i=Number(e.relatedTo1)),e.relatedType1==="Account"&&(e.relatedType2==="Contact"&&e.relatedTo2?o=Number(e.relatedTo2):e.relatedType2==="Deal"&&e.relatedTo2?l=Number(e.relatedTo2):e.relatedType2==="Quote"&&e.relatedTo2&&(c=Number(e.relatedTo2)));const u=e.assignedTo?Number(e.assignedTo):null,d=o||l||i||r,h=o?"Contact":l?"Deal":i?"Account":r?"Lead":c?"Quote":null;return{title:t,description:n,priority:e.priority||"Normal",status:e.status||"Not started",due_date:e.dueDate?e.dueDate:null,assigned_to:u,notes:s,is_personal:!1,lead_id:r,account_id:i,contact_id:o,deal_id:l,quote_id:c,related_to_1:e.relatedTo1?Number(e.relatedTo1):null,related_type_1:e.relatedType1,related_to_2:e.relatedTo2?Number(e.relatedTo2):null,related_type_2:e.relatedType2,related_to:d,related_type:h}},NUe=e=>{const t=e.task_assign_to?`${e.task_assign_to.first_name} ${e.task_assign_to.last_name}`:e.assigned_to?String(e.assigned_to):"Unassigned",n=e.task_creator?`${e.task_creator.first_name} ${e.task_creator.last_name}`:e.created_by?String(e.created_by):"System",s=e.due_date||e.dueDate||null,r=e.date_assigned||e.created_at||null,i=e.contact?`${e.contact.first_name} ${e.contact.last_name}`:e.assigned_to?String(e.assigned_to.id):"Unassigned",o=G=>{if(!G)return"";const $=String(G).split("-");return $.length===3?`${$[0]}-${$[2]}`:String(G)},l=()=>e.lead?.id||e.lead_id,c=()=>e.account?.id||e.account_id,u=()=>e.contact?.id||e.contact_id,d=()=>e.deal?.id||e.deal_id,h=()=>e.quote?.id||e.quote_id,p=()=>e.task_assign_to?.id||e.assigned_to,x=()=>e.lead?.title||e.lead_id,b=()=>e.account?.name||e.account_id,j=()=>i||e.contact_id,y=()=>e.deal?.name||e.deal_id,N=()=>o(e.quote?.quote_id)||e.id;let w="Lead",S="",_="",T="",k="Lead",A="",E="",M="";const F=c(),D=b(),P=l(),B=x();if(F){w="Account",k="Account",A=D,S=String(F);const G=u(),$=d(),W=j(),Z=y(),Q=h(),le=N();G?(_="Contact",E="Contact",M=W,T=String(G)):$?(E="Deal",_="Deal",M=Z,T=String($)):Q&&(E="Quote",_="Quote",M=le,T=String(Q))}else P?(k="Lead",A=B,w="Lead",S=String(P)):e.related_type==="Account"&&(w="Account",S=String(e.related_to));return{id:e.id,title:e.title,description:e.description,priority:e.priority||"Normal",status:wJ(e.status),dueDate:s,dateAssigned:r,assignedToId:p()||null,assignedToName:t,createdAt:e.created_at||null,createdById:e.task_creator?.id??null,createdBy:n,notes:e.notes||"",isPersonal:!!e.is_personal,relatedType1Text:k,relatedTo1Text:A,relatedType2Text:E,relatedTo2Text:M,subject:e.title,relatedType1:w,relatedTo1:S,relatedType2:_,relatedTo2:T}};function CUe(){f.useEffect(()=>{document.title="Tasks | Sari-Sari CRM"},[]);const{user:e,loading:t}=Gt(),[n,s]=f.useState("board"),[r,i]=f.useState(!1),[o,l]=f.useState(null),[c,u]=f.useState(!1),[d,h]=f.useState([]),[p,x]=f.useState(!0),[b,j]=f.useState(""),[y,N]=f.useState("Filter by Status"),[w,S]=f.useState("Filter by Priority"),[_,T]=f.useState([]),[k,A]=f.useState(1),[E,M]=f.useState(10),[F,D]=f.useState(null),[P,B]=f.useState(!1),[G,$]=f.useState([]),[W,Z]=f.useState(null),Q=Et(),le=ta(),[we,J]=f.useState({id:"",subject:"",description:"",priority:"",status:"",dueDate:"",assignedTo:"",notes:"",createdById:null,relatedType1:"Lead",relatedType2:"Contact",relatedTo1:"",relatedTo2:""}),[se,ye]=f.useState(null),Ce=qx(qf(dm,{activationConstraint:{distance:8}})),ge=z=>{const{active:K}=z,ue=d.find(re=>re.id===K.id);Z(ue)},be=async z=>{const{active:K,over:ue}=z;if(Z(null),!ue)return;const re=K.id,Le=ue.id,De=d.find(Qe=>Qe.id===re);if(!(!De||De.status===Le)){h(Qe=>Qe.map(tt=>tt.id===re?{...tt,status:Le}:tt));try{const Qe={title:De.title,description:De.description||"",priority:De.priority||"Normal",status:Le,due_date:De.dueDate||null,assigned_to:De.assignedToId||null,related_type_1:De.relatedType1||null,related_to_1:De.relatedTo1?parseInt(De.relatedTo1,10):null,related_type_2:De.relatedType2||null,related_to_2:De.relatedTo2?parseInt(De.relatedTo2,10):null};(!Qe.related_to_1||isNaN(Qe.related_to_1))&&(Qe.related_to_1=null),(!Qe.related_to_2||isNaN(Qe.related_to_2))&&(Qe.related_to_2=null),await ne.put(`/tasks/${re}`,Qe),V.success(`Task moved to "${Le}"`)}catch(Qe){console.error("Failed to update task status:",Qe),V.error("Failed to update task status"),h(tt=>tt.map(Me=>Me.id===re?{...Me,status:De.status}:Me))}}},me=()=>{Z(null)};f.useEffect(()=>{const z=le.state?.openTaskModal,K=le.state?.initialTaskData,ue=le.state?.taskID;z?(i(!0),K&&J(re=>({...re,...K})),Q(le.pathname,{replace:!0,state:{}})):ue&&(ye(ue),Q(le.pathname,{replace:!0,state:{}}))},[le,Q]),f.useEffect(()=>{if(se&&d.length>0&&!p){const z=d.find(K=>K.id===se);z?xe(z,!0):V.error("Task not found."),ye(null)}},[se,d,p]);const Ae=async()=>{try{const z=await ne.get("/users/all");T(Array.isArray(z.data)?z.data:[])}catch(z){console.error("Failed to fetch users:",z),V.error("Failed to fetch users.")}},pe=async()=>{try{x(!0);const z=await ne.get("/tasks/all"),ue=(Array.isArray(z.data)?z.data:[]).map(NUe);ue.sort((re,Le)=>{const De=re.createdAt?new Date(re.createdAt):0;return(Le.createdAt?new Date(Le.createdAt):0)-De}),h(ue),n==="list"&&A(1)}catch(z){console.error("Failed to load tasks:",z),V.error("Failed to load tasks.")}finally{x(!1)}};f.useEffect(()=>{if(!t&&e){Ae(),pe();const z=Fj(e.id),K=new WebSocket(z);return K.onopen=()=>{console.log(" Connected to task notifications")},K.onmessage=ue=>{try{const re=JSON.parse(ue.data);re.type==="task_status_updated"&&(V.info(` ${re.message}`,{position:"top-right",autoClose:4e3}),pe())}catch(re){console.error("Error parsing notification:",re)}},K.onerror=ue=>{console.error(" WebSocket error:",ue)},K.onclose=()=>{console.log(" Disconnected from task notifications")},()=>{K.readyState===WebSocket.OPEN&&K.close()}}},[t,e]);const Ie=()=>{l(null),J({id:"",subject:"",description:"",priority:"Normal",status:"Not started",dueDate:"",assignedTo:e?.role==="Sales"?String(e.id):"",notes:"",createdById:null,relatedType1:"Lead",relatedType2:"Contact",relatedTo1:"",relatedTo2:""})},xe=(z=null,K=!1)=>{l(z),u(K),z?J({id:z.id,subject:z.title||"",description:z.description||"",priority:z.priority||"Normal",status:z.status||"Not started",dueDate:wUe(z.dueDate),assignedTo:z.assignedToId?String(z.assignedToId):"",assignedToName:z.assignedToName||"",createdBy:z.createdBy||"",notes:z.notes||"",createdById:z.createdById||null,relatedType1Text:z.relatedType1Text||"",relatedTo1Text:z.relatedTo1Text||"",relatedType2Text:z.relatedType2Text||"",relatedTo2Text:z.relatedTo2Text||"",relatedType1:z.relatedType1||"",relatedTo1:z.relatedTo1||"",relatedType2:z.relatedType2||"",relatedTo2:z.relatedTo2||""}):Ie(),i(!0)},he=()=>{i(!1),l(null),u(!1),Ie()},Re=async z=>{const K=jUe(z);try{o&&!c?(await ne.put(`/tasks/${o.id}`,K),V.success("Task updated successfully.")):(await ne.post("/tasks/create",K),V.success("Task created successfully.")),i(!1),await pe()}catch(ue){console.error("Failed to save task:",ue);const re=ue.response?.data?.detail||"Failed to save task.";V.error(re)}},Ee=z=>{z&&D({title:"Archive Task",message:a.jsxs(a.Fragment,{children:["Are you sure you want to archive ",a.jsx("span",{className:"font-semibold",children:z.title}),"?"]}),confirmLabel:"Archive Task",cancelLabel:"Cancel",variant:"warning",action:{type:"archive",targetId:z.id}})},He=z=>/sales/i.test(e?.role)?String(z?.createdById)===String(e?.id):!0,Ke=()=>Fe.filter(z=>He(z)),st=()=>{const z=Ke();if(z.length!==0)if(z.every(K=>G.includes(K.id)))$(G.filter(K=>!z.map(ue=>ue.id).includes(K)));else{const K=z.map(ue=>ue.id);$([...new Set([...G,...K])])}},it=z=>{const K=Fe.find(ue=>ue.id===z);He(K)&&$(ue=>ue.includes(z)?ue.filter(re=>re!==z):[...ue,z])},ot=async()=>{G.length!==0&&D({title:"Archive Tasks",message:a.jsxs("span",{children:["Are you sure you want to archive"," ",a.jsx("span",{className:"font-semibold",children:G.length})," selected tasks?"]}),confirmLabel:`Archive ${G.length} Task(s)`,cancelLabel:"Cancel",variant:"warning",action:{type:"bulk-archive",task_ids:G}})},rt=async()=>{if(!F?.action){D(null);return}const{action:z}=F;B(!0);try{z.type==="archive"?(await ne.delete(`/tasks/${z.targetId}`),V.success("Task archived successfully."),await pe()):z.type==="bulk-archive"&&(await ne.post("/tasks/bulk-archive",{task_ids:z.task_ids}),V.success(`Successfully archived ${z.task_ids.length} tasks`),$([]),await pe())}catch(K){console.error("Task action failed:",K);const ue=K.response?.data?.detail||"Failed to archive task.";V.error(ue)}finally{B(!1),D(null)}},at=()=>{P||D(null)},Je=f.useMemo(()=>{const z=b.trim().toLowerCase();return[...d].sort((ue,re)=>{const Le=ue.createdAt?new Date(ue.createdAt):0;return(re.createdAt?new Date(re.createdAt):0)-Le}).filter(ue=>{const re=z===""||ue.title?.toLowerCase().includes(z)||ue.description?.toLowerCase().includes(z)||ue.assignedToName?.toLowerCase().includes(z)||ue.createdBy?.toLowerCase().includes(z),Le=y==="Filter by Status"||ue.status===y,De=w==="Filter by Priority"||ue.priority===w;return re&&Le&&De})},[d,b,y,w]);f.useEffect(()=>{A(1)},[b,y,w,n,E]),f.useEffect(()=>{if(n==="list"){const z=Je.length===0?1:Math.ceil(Je.length/E);k>z&&A(z)}},[Je.length,k,n,E]);const Fe=f.useMemo(()=>{if(n==="board")return Je;const z=(k-1)*E;return Je.slice(z,z+E)},[Je,k,n,E]),Ue=f.useMemo(()=>{const z=new Date;return[{title:"To Do",value:d.filter(K=>K.status==="Not started").length,icon:Vn,color:"text-blue-600",bgColor:"bg-blue-100"},{title:"In Progress",value:d.filter(K=>K.status==="In progress").length,icon:Yi,color:"text-purple-600",bgColor:"bg-purple-100"},{title:"Completed",value:d.filter(K=>K.status==="Completed").length,icon:La,color:"text-green-600",bgColor:"bg-green-100"},{title:"Overdue",value:d.filter(K=>K.dueDate&&new Date(K.dueDate)<z&&K.status!=="Completed").length,icon:Fl,color:"text-red-600",bgColor:"bg-red-100"},{title:"High Priority",value:d.filter(K=>K.priority==="High").length,icon:ec,color:"text-orange-600",bgColor:"bg-orange-100"}]},[d]),Ne=z=>z.dueDate&&new Date(z.dueDate)<new Date&&z.status!=="Completed",ze=z=>{switch(z.status){case"Not started":return"bg-blue-50 hover:bg-blue-100 border-blue-200";case"In progress":return"bg-purple-50 hover:bg-purple-100 border-purple-200";case"Deferred":return"bg-orange-50 hover:bg-orange-100 border-orange-200";case"Completed":return"bg-green-50 hover:bg-green-100 border-green-200";default:return"bg-gray-50 hover:bg-gray-100 border-gray-100"}},je=z=>{switch(z){case"Not started":return"bg-blue-100 text-blue-700";case"In progress":return"bg-purple-100 text-purple-700";case"Deferred":return"bg-orange-100 text-orange-700";case"Completed":return"bg-green-100 text-green-700";default:return"bg-gray-100 text-gray-700"}},ve=z=>{switch(z){case"High":return"bg-red-100 text-red-700";case"Normal":return"bg-yellow-100 text-yellow-700";default:return"bg-gray-100 text-gray-700"}};return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 min-h-screen font-inter relative",children:[(p||t)&&a.jsx(qt,{message:"Loading tasks..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 space-y-2 sm:space-y-0",children:[a.jsxs("h1",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[a.jsx(Yi,{className:"text-blue-600"})," Tasks Board"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{type:"button",onClick:()=>xe(),className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 rounded-md hover:bg-gray-800 text-sm sm:text-base self-end sm:self-auto mt-2 lg:mt-0 cursor-pointer",children:[a.jsx(aa,{})," Create Task"]})})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 xl:grid-cols-5 gap-4 mb-6 w-full break-words overflow-hidden lg:overflow-visible",children:Ue.map(z=>a.jsx(SUe,{...z},z.title))}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mt-6 mb-4 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search tasks",value:b,onChange:z=>j(z.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row w-full lg:w-1/2 gap-2",children:[a.jsxs("select",{value:y,onChange:z=>N(z.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{children:"Filter by Status"}),C8.map(z=>a.jsx("option",{children:z},z))]}),a.jsxs("select",{value:w,onChange:z=>S(z.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{children:"Filter by Priority"}),a.jsx("option",{children:"High"}),a.jsx("option",{children:"Normal"}),a.jsx("option",{children:"Low"})]})]})]}),a.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[a.jsx("button",{type:"button",onClick:()=>s("board"),className:`px-4 py-2 rounded-full text-sm ${n==="board"?"bg-gray-800 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Board View"}),a.jsx("button",{type:"button",onClick:()=>s("list"),className:`px-4 py-2 rounded-full text-sm ${n==="list"?"bg-gray-800 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"List View"})]}),!p&&!t&&n==="board"&&(Je.length>0?a.jsxs(Vx,{sensors:Ce,collisionDetection:Gx,onDragStart:ge,onDragEnd:be,onDragCancel:me,children:[a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4 rounded-md",children:C8.map(z=>{const K=Fe.filter(ue=>ue.status===z);return a.jsx(AUe,{column:z,columnTasks:K,getTaskCardColor:ze,isTaskOverdue:Ne,formatDateDisplay:KA,handleOpenModal:xe,handleArchiveTask:Ee,currentUser:e},z)})}),a.jsx(MN,{children:W?a.jsx(kUe,{task:W,getTaskCardColor:ze,isTaskOverdue:Ne,formatDateDisplay:KA}):null})]}):a.jsx("div",{className:"col-span-4 text-center py-10 text-gray-500 border border-dashed rounded-xl",children:"No tasks found."})),!p&&!t&&n==="list"&&a.jsx("div",{className:"bg-white rounded-md shadow-sm overflow-hidden",children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-gray-600 text-left",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 w-10",children:a.jsx("input",{type:"checkbox",className:"w-4 h-4 accent-blue-600",checked:Ke().length>0&&Ke().every(z=>G.includes(z.id)),onChange:st})}),a.jsx("th",{className:"py-3 px-4 font-medium",children:"Task"}),a.jsx("th",{className:"py-3 px-4 font-medium",children:"Status"}),a.jsx("th",{className:"py-3 px-4 font-medium",children:"Priority"}),a.jsx("th",{className:"py-3 px-4 font-medium",children:"Assigned To"}),a.jsx("th",{className:"py-3 px-4 font-medium",children:a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("span",{children:"Date Assigned"}),a.jsx("div",{className:"w-8 h-8 flex items-center justify-center",children:G.length>0&&/sales/i.test(e?.role)&&a.jsx("button",{onClick:ot,className:"text-orange-600 hover:text-orange-800 transition p-1 rounded-full hover:bg-orange-50",title:`Archive ${G.length} selected tasks`,children:a.jsx(Zt,{size:18})})})]})})]})}),a.jsx("tbody",{children:Fe.length>0?Fe.map(z=>a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors text-sm cursor-pointer",children:[a.jsx("td",{className:"py-3 px-4",onClick:K=>K.stopPropagation(),children:He(z)&&a.jsx("input",{type:"checkbox",className:"w-4 h-4 accent-blue-600",checked:G.includes(z.id),onChange:()=>it(z.id)})}),a.jsx("td",{className:"py-3 px-4 text-gray-700 whitespace-nowrap font-medium",onClick:()=>xe(z,!0),children:z.title}),a.jsx("td",{className:"py-3 px-4 whitespace-nowrap",onClick:()=>xe(z,!0),children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium whitespace-nowrap ${je(z.status||"Not started")}`,children:z.status||"Not started"})}),a.jsx("td",{className:"py-3 px-4 whitespace-nowrap",onClick:()=>xe(z,!0),children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium whitespace-nowrap ${ve(z.priority||"Low")}`,children:z.priority||"Low"})}),a.jsx("td",{className:"py-3 px-4 text-gray-700 whitespace-nowrap",onClick:()=>xe(z,!0),children:z.assignedToName||"Unassigned"}),a.jsx("td",{className:`py-3 px-4 text-gray-700 whitespace-nowrap ${Ne(z)?"text-red-600 font-medium":""}`,onClick:()=>xe(z,!0),children:z.dueDate?KA(z.dueDate):""})]},z.id)):a.jsx("tr",{children:a.jsx("td",{colSpan:6,className:"text-center py-4 text-gray-500",children:"No tasks found."})})})]})})}),!p&&!t&&n==="list"&&a.jsx(ca,{className:"mt-6",totalItems:Je.length,pageSize:E,currentPage:Je.length===0?0:k,onPrev:()=>A(z=>Math.max(z-1,1)),onNext:()=>A(z=>Math.min(z+1,Math.max(1,Math.ceil(Je.length/E)||1))),onPageSizeChange:z=>{M(z),A(1)},pageSizeOptions:[10,20,30,40,50],label:"tasks"}),a.jsx(N0,{isOpen:r,onClose:he,onSave:Re,onEdit:()=>u(!1),setFormData:J,formData:we,isEditing:!c&&!!o,viewMode:c,users:_,currentUser:e,onDelete:Ee}),F&&a.jsx(_Ue,{open:!0,title:F.title,message:F.message,confirmLabel:F.confirmLabel,cancelLabel:F.cancelLabel,variant:F.variant,onConfirm:rt,onCancel:at,loading:P})]})}function SUe({icon:e,title:t,value:n,color:s,bgColor:r,onClick:i}){return a.jsxs("div",{className:"flex items-center p-4 bg-white rounded-xl shadow-md border border-gray-200 transition-all duration-300 cursor-default",onClick:i,children:[a.jsx("div",{className:`flex-shrink-0 p-3 rounded-full ${r} ${s} mr-4`,children:e?a.jsx(e,{size:22}):null}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:t}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:n})]})]})}function _Ue({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r,variant:i,loading:o,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":i==="warning"?"bg-orange-500 hover:bg-orange-600 border border-orange-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsx("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${u}`,disabled:o,children:o?"Processing...":s})]})]})})}function AUe({column:e,columnTasks:t,getTaskCardColor:n,isTaskOverdue:s,formatDateDisplay:r,handleOpenModal:i,handleArchiveTask:o,currentUser:l}){const{isOver:c,setNodeRef:u}=Qx({id:e});return a.jsxs("div",{ref:u,className:`bg-white p-4 shadow border flex flex-col relative rounded-md transition-all duration-200 min-h-[200px] ${c?"border-blue-400 bg-blue-50 ring-2 ring-blue-300":"border-gray-200"}`,children:[a.jsx("div",{className:"absolute top-0 left-0 w-full h-5 bg-secondary rounded-t-md"}),a.jsxs("div",{className:"flex items-center justify-between mb-3 pt-7",children:[a.jsx("h3",{className:"font-medium text-gray-900",children:e}),a.jsx("span",{className:"text-xs bg-gray-100 px-2 py-1 rounded-full text-gray-500",children:t.length})]}),a.jsx("div",{className:`space-y-3 flex-1 ${t.length>3?"overflow-y-auto max-h-[480px] hide-scrollbar":""}`,children:t.length>0?t.map(d=>a.jsx(TUe,{task:d,getTaskCardColor:n,isTaskOverdue:s,formatDateDisplay:r,handleOpenModal:i,handleArchiveTask:o,currentUser:l},d.id)):a.jsx("div",{className:`text-center py-10 text-gray-500 border-2 border-dashed rounded-lg ${c?"border-blue-300 bg-blue-50":"border-gray-200"}`,children:c?"Drop here":"No tasks"})})]})}function TUe({task:e,getTaskCardColor:t,isTaskOverdue:n,formatDateDisplay:s,handleOpenModal:r,handleArchiveTask:i,currentUser:o}){const{attributes:l,listeners:c,setNodeRef:u,transform:d,isDragging:h}=Yx({id:e.id}),p=d?{transform:`translate3d(${d.x}px, ${d.y}px, 0)`}:void 0;return a.jsxs("div",{ref:u,style:p,className:`border rounded-lg p-3 transition flex justify-between items-start cursor-grab active:cursor-grabbing ${t(e)} ${h?"opacity-50 shadow-lg ring-2 ring-blue-400":""}`,...c,...l,children:[a.jsxs("div",{className:"text-left flex-1",onClick:x=>{x.stopPropagation(),r(e,!0)},children:[a.jsx("p",{className:"font-medium text-gray-800 text-sm",children:e.title}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Priority: ",e.priority]}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Assigned To: ",e.assignedToName]}),a.jsxs("p",{className:"text-xs mt-1 text-gray-500",children:["Date: ",a.jsx("span",{className:n(e)?"text-red-600":"text-gray-600",children:e.dueDate?s(e.dueDate):""})]})]}),a.jsx("div",{className:"flex items-center gap-2 ml-3",onClick:x=>x.stopPropagation(),children:(String(e.createdById)===String(o?.id)||!/sales/i.test(o?.role))&&a.jsxs(a.Fragment,{children:[a.jsx("button",{type:"button",onClick:x=>{x.stopPropagation(),r(e)},className:"text-blue-500 hover:text-blue-700",children:a.jsx(hn,{})}),a.jsx("button",{type:"button",onClick:x=>{x.stopPropagation(),i(e)},className:"text-orange-500 hover:text-orange-700",children:a.jsx(Zt,{})})]})})]})}function kUe({task:e,getTaskCardColor:t,isTaskOverdue:n,formatDateDisplay:s}){return a.jsx("div",{className:`border rounded-lg p-3 shadow-xl ring-2 ring-blue-400 ${t(e)}`,style:{width:"280px"},children:a.jsxs("div",{className:"text-left flex-1",children:[a.jsx("p",{className:"font-medium text-gray-800 text-sm",children:e.title}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Priority: ",e.priority]}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Assigned To: ",e.assignedToName]}),a.jsxs("p",{className:"text-xs mt-1 text-gray-500",children:["Date: ",a.jsx("span",{className:n(e)?"text-red-600":"text-gray-600",children:e.dueDate?s(e.dueDate):""})]})]})})}const jJ=e=>e?e.toUpperCase():"",Xd=e=>{const t=jJ(e);return t==="PLANNED"||t==="IN PROGRESS"?"PLANNED":t==="HELD"||t==="DONE"?"HELD":t==="NOT_HELD"||t==="NOT HELD"?"NOT_HELD":"PLANNED"},EUe=e=>{if(!e)return"";const t=String(e).split("-");return t.length===3?`${t[0]}-${t[2]}`:String(e)},LUe=e=>{if(!e)return"--";try{return new Date(e).toLocaleString()}catch{return"--"}},DUe=e=>{const t=jJ(e);switch(t==="PLANNED"?"PENDING":t==="HELD"?"COMPLETED":t==="NOT_HELD"?"CANCELLED":t){case"PENDING":return"bg-indigo-100 text-indigo-700";case"COMPLETED":case"DONE":return"bg-green-100 text-green-700";case"CANCELLED":return"bg-gray-200 text-gray-700";case"IN PROGRESS":return"bg-blue-100 text-blue-700";default:return"bg-gray-100 text-gray-700"}},XA={subject:"",startTime:"",endTime:"",location:"",status:"PLANNED",notes:"",assignedTo:"",relatedType1:"Lead",relatedTo1:"",relatedType2:null,relatedTo2:""},PUe=()=>{const e=Et(),t=ta(),{user:n}=Gt(),s=n?.role==="Sales",[r]=Bs(),i=r.get("id"),o=t.pathname==="/admin/meetings/info";f.useEffect(()=>{document.title="Meetings | Sari-Sari CRM"},[]);const[l,c]=f.useState([]),[u,d]=f.useState(!1),[h,p]=f.useState([]),[x,b]=f.useState(""),[j,y]=f.useState("Filter by Status"),[N,w]=f.useState(!1),[S,_]=f.useState(null),[T,k]=f.useState(1),[A,E]=f.useState(10),[M,F]=f.useState(XA),[D,P]=f.useState(!1),[B,G]=f.useState(null),[$,W]=f.useState(!1),[Z,Q]=f.useState(null),[le,we]=f.useState(!1),[J,se]=f.useState(null),[ye,Ce]=f.useState([]),[ge,be]=f.useState(null);f.useEffect(()=>{N&&!D&&s&&n&&!M.assignedTo&&F(ve=>({...ve,assignedTo:n.id}))},[N,D,n,s]),f.useEffect(()=>{const ve=t.state?.openMeetingModal,z=t.state?.initialMeetingData?.relatedTo||r.get("id"),K=t.state?.meetingID;ve||z?(w(!0),t.state?.initialMeetingData&&F(ue=>({...ue,...t.state.initialMeetingData})),e(t.pathname,{replace:!0,state:{}})):K&&(se(K),e(t.pathname,{replace:!0,state:{}}))},[t,r,e]),f.useEffect(()=>{if(J&&l.length>0&&!u){const ve=l.find(z=>z.id===J);ve?_(ve):V.error("Meeting not found."),se(null)}},[J,l,u]);const me=async()=>{if(i&&o){const ve=sessionStorage.getItem("meetingDetailData");if(ve)try{const z=JSON.parse(ve);if(z.id===parseInt(i)){_(z),sessionStorage.removeItem("meetingDetailData");return}}catch(z){console.error(z)}}d(!0);try{const ve=await ne.get("/meetings/admin/fetch-all"),K=[...Array.isArray(ve.data)?ve.data:[]].sort((ue,re)=>{const Le=ue?.created_at?new Date(ue.created_at).getTime():0;return(re?.created_at?new Date(re.created_at).getTime():0)-Le});if(c(K),i&&!S){const ue=K.find(re=>re.id===parseInt(i));ue&&_(ue)}}catch{V.error("Failed to load meetings.")}finally{d(!1)}},Ae=async()=>{try{const ve=await ne.get("/users/all");p(Array.isArray(ve.data)?ve.data:[])}catch(ve){console.error(ve)}};f.useEffect(()=>{async function ve(){try{const z=await ne.get("/auth/me");be(z.data)}catch(z){console.error("Failed to fetch current user",z)}}ve()},[]),f.useEffect(()=>{me(),Ae()},[]);const pe=ve=>b(ve.target.value),Ie=f.useMemo(()=>{const ve=x.trim().toLowerCase(),z=j.trim().toUpperCase();return l.filter(K=>{const ue=[K?.subject,K?.location,K?.notes,K?.lead?.title,K?.account?.name,K?.contact?.first_name,K?.contact?.last_name,K?.deal?.name,K?.quote?.quote_id,K?.meet_assign_to?.first_name,K?.meet_assign_to?.last_name].filter(Boolean).join(" ").toLowerCase(),re=ve===""||ue.includes(ve),Le=z==="FILTER BY STATUS"||Xd(K.status||"PENDING")===z;return re&&Le})},[l,x,j]),xe=l.length,he=l.filter(ve=>Xd(ve.status)==="PLANNED").length,Re=l.filter(ve=>Xd(ve.status)==="HELD").length,Ee=l.filter(ve=>Xd(ve.status)==="NOT_HELD").length,He=[{title:"Total",value:xe,icon:Pt,color:"text-slate-600",bgColor:"bg-slate-100"},{title:"Planned",value:he,icon:Vn,color:"text-indigo-600",bgColor:"bg-indigo-100"},{title:"Held",value:Re,icon:La,color:"text-green-600",bgColor:"bg-green-100"},{title:"Not Held",value:Ee,icon:Yn,color:"text-gray-600",bgColor:"bg-gray-100"}],Ke=f.useMemo(()=>{const ve=(T-1)*A;return Ie.slice(ve,ve+A)},[Ie,T,A]),st=()=>{w(!1),F(XA),P(!1),G(null),W(!1)},it=()=>{F(XA),P(!1),G(null),w(!0)},ot=ve=>{let z="";if(ve.meet_assign_to?.id)z=String(ve.meet_assign_to.id);else if(ve.assignedTo){const et=h.find(yt=>`${yt.first_name} ${yt.last_name}`===ve.assignedTo);z=et?String(et.id):""}const K=et=>{if(!et)return"";try{const yt=new Date(et),_t=yt.getTimezoneOffset()*6e4;return new Date(yt.getTime()-_t).toISOString().slice(0,16)}catch{return""}};let ue="Lead",re="",Le="Contact",De="";if(ve.lead)ue="Lead",re=String(ve.lead.id);else if(ve.account)ue="Account",re=String(ve.account.id),ve.contact?(Le="Contact",De=String(ve.contact.id)):ve.deal?(Le="Deal",De=String(ve.deal.id)):ve.quote&&(Le="Quote",De=String(ve.quote.id));else if(ve.relatedType||ve.related_type){const et=ve.relatedType||ve.related_type,yt=ve.related_to||ve.relatedToId;et==="Lead"?(ue="Lead",re=String(yt)):(ue="Account",re=ve.account_id?String(ve.account_id):"")}const Qe={PLANNED:"Planned",HELD:"Held",NOT_HELD:"Not held"},tt=Xd(ve.status),Me=Qe[tt]||"Planned";F({subject:ve.subject||ve.activity||"",location:ve.location||"",startTime:K(ve.start_time||ve.startTime),endTime:K(ve.end_time||ve.endTime),status:Me,notes:ve.description||ve.notes||"",assignedTo:z,relatedType1:ue,relatedTo1:re,relatedType2:Le,relatedTo2:De}),P(!0),G(ve.id),_(null),w(!0)},rt=ve=>{if(!ve.subject?.trim())return V.error("Subject is required.");if(!ve.startTime)return V.error("Start time is required.");if(ve.endTime&&!(new Date(ve.endTime)-new Date(ve.startTime)>0))return V.error("End time must be after start time.");ve.relatedType1,ve.relatedTo1,ve.relatedType1==="Account"&&ve.relatedType2&&ve.relatedTo2&&(ve.relatedType2,ve.relatedTo2);const z={...ve,assignedTo:parseInt(ve.assignedTo),relatedTo1:parseInt(ve.relatedTo1),relatedTo2:parseInt(ve.relatedTo2)},K=D&&B?"update":"create";Q({title:K==="create"?"Confirm New Meeting":"Confirm Update",message:`Are you sure you want to ${K} "${z.subject}"?`,confirmLabel:K==="create"?"Create Meeting":"Update Meeting",variant:"primary",action:{type:K,payload:z,targetId:B,name:z.subject}})},at=async()=>{if(!Z?.action)return;const{type:ve,payload:z,targetId:K,name:ue}=Z.action;we(!0);try{ve==="create"?(W(!0),await ne.post("/meetings/create",z),V.success(`Meeting "${ue}" created.`),st(),await me()):ve==="update"?(W(!0),await ne.put(`/meetings/${K}`,z),V.success(`Meeting "${ue}" updated.`),st(),await me()):ve==="delete"?(await ne.delete(`/meetings/${K}`),V.success(`Meeting "${ue}" archived.`),S?.id===K&&_(null),await me()):ve==="bulk-delete"&&(await ne.post("/meetings/sales/bulk-delete",{meeting_ids:Z.action.meetingIds}),V.success(`Successfully archived ${Z.action.meetingIds.length} meeting(s)`),Ce([]),await me())}catch(re){const Le=re.response?.data?.detail||"Action failed.";V.error(typeof Le=="string"?Le:JSON.stringify(Le)),console.error(Le)}finally{W(!1),we(!1),Q(null)}},Je=ve=>{Ne("single")},Fe=()=>{const ve=Ke.filter(z=>z.created_by===ge?.id);ye.length===ve.length&&ve.length>0?Ce([]):Ce(ve.map(z=>z.id))},Ue=ve=>{Ce(z=>z.includes(ve)?z.filter(K=>K!==ve):[...z,ve])},Ne=ve=>{if(ve==="single"){const z=S.subject||"this meeting";Q({title:"Archive Meeting",message:`Are you sure you want to archive "${z}"?`,confirmLabel:"Archive Meeting",cancelLabel:"Cancel",variant:"archive",action:{type:"delete",targetId:S.id,name:z}})}else if(ve==="bulk"){if(ye.length===0)return;Q({title:"Archive Meetings",message:a.jsxs("span",{children:["Are you sure you want to archive"," ",a.jsx("span",{className:"font-semibold",children:ye.length})," selected meetings?"]}),confirmLabel:`Archive ${ye.length} meeting(s)`,cancelLabel:"Cancel",variant:"archive",action:{type:"bulk-delete",meetingIds:ye}})}},ze=()=>{Ne("bulk")},je=async(ve,z)=>{try{await ne.put(`/meetings/${ve}`,{status:z}),V.success("Status updated"),me(),_(null)}catch{V.error("Failed to update status")}};return o&&i?S?a.jsx(jd,{meeting:S,onClose:()=>{_(null),e("/admin/dashboard")},onEdit:ot,onDelete:Je,onStatusUpdate:je,currentUser:ge,isSalesView:!0}):a.jsx(qt,{message:"Loading meeting..."}):a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[u&&a.jsx(qt,{message:"Loading meetings..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h1",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800 mb-4 lg:mb-0",children:[a.jsx(Pt,{className:"mr-2 text-blue-600"})," Meetings"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{onClick:it,className:"bg-black text-white px-4 py-2 rounded-md flex items-center hover:bg-gray-800",children:[a.jsx(aa,{className:"mr-2"})," Add Meeting"]})})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-4 mb-6 w-full break-words overflow-hidden lg:overflow-visible",children:He.map(ve=>a.jsx(MUe,{...ve},ve.title))}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full sm:w-auto lg:w-4/4 md:w-3/4",children:[a.jsx(Kt,{className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search meetings",value:x,onChange:pe,className:"w-full outline-none"})]}),a.jsxs("select",{value:j,onChange:ve=>y(ve.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm bg-white w-full sm:w-auto",children:[a.jsx("option",{children:"Filter by Status"}),a.jsx("option",{value:"PLANNED",children:"PLANNED"}),a.jsx("option",{value:"HELD",children:"HELD"}),a.jsx("option",{value:"NOT_HELD",children:"NOT HELD"})]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[500px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm mb-4",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 text-center w-12",children:a.jsx("input",{type:"checkbox",checked:Ke.length>0&&Ke.filter(ve=>ve.created_by===ge?.id).every(ve=>ye.includes(ve.id))&&Ke.some(ve=>ve.created_by===ge?.id),onChange:Fe,className:"form-checkbox h-4 w-4 text-blue-600 rounded focus:ring-blue-500 border-gray-300"})}),a.jsx("th",{className:"py-3 px-4",children:"Subject"}),a.jsx("th",{className:"py-3 px-4",children:"Related To"}),a.jsx("th",{className:"py-3 px-4",children:"Start Time"}),a.jsx("th",{className:"py-3 px-4",children:"Assigned"}),a.jsx("th",{className:"py-3 px-4",children:"Status"}),a.jsx("th",{className:"py-3 px-4 text-center w-24",children:ye.length>0?a.jsx("button",{onClick:ze,className:"text-orange-600 hover:text-orange-800 transition p-1 rounded-full hover:bg-orange-50",title:`Archive ${ye.length} selected meetings`,children:a.jsx(Zt,{size:18})}):""})]})}),a.jsx("tbody",{children:Ke.length>0?Ke.map(ve=>a.jsxs("tr",{onClick:()=>_(ve),className:"hover:bg-gray-50 cursor-pointer border-b border-gray-100",children:[a.jsx("td",{className:"py-3 px-4 text-center",onClick:z=>z.stopPropagation(),children:ge&&ve.created_by===ge.id?a.jsx("input",{type:"checkbox",checked:ye.includes(ve.id),onChange:()=>Ue(ve.id),className:"form-checkbox h-4 w-4 text-blue-600 rounded focus:ring-blue-500 border-gray-300",onClick:z=>z.stopPropagation()}):null}),a.jsx("td",{className:"py-3 px-4 font-medium text-blue-600",children:ve.subject}),a.jsxs("td",{className:"py-3 px-4",children:[ve.lead&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:ve.lead.title}),ve.account&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:ve.account.name}),ve.contact&&a.jsxs("p",{className:"font-medium text-blue-500 text-xs",children:[ve.contact.first_name," ",ve.contact.last_name]}),ve.deal&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:ve.deal.name}),ve.quote&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:EUe(ve.quote.quote_id)})]}),a.jsx("td",{className:"py-3 px-4",children:LUe(ve.start_time)}),a.jsxs("td",{className:"py-3 px-4",children:[ve.meet_assign_to.first_name," ",ve.meet_assign_to.last_name]}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${DUe(Xd(ve.status))}`,children:Xd(ve.status).replace("_"," ")})}),a.jsx("td",{className:"py-3 px-4"})]},ve.id)):a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"text-center py-4 text-gray-500",children:"No meetings found."})})})]})}),a.jsx(ca,{totalItems:Ie.length,pageSize:A,currentPage:T,onPrev:()=>k(ve=>Math.max(1,ve-1)),onNext:()=>k(ve=>ve+1),onPageSizeChange:ve=>{E(ve),k(1)},pageSizeOptions:[10,20,30,40,50],label:"meetings"}),N&&a.jsx(O1,{onClose:st,formData:M,setFormData:F,isEditing:D,onSubmit:rt,isSubmitting:$||le,users:h,currentUser:n}),S&&a.jsx(jd,{meeting:S,onClose:()=>_(null),onEdit:ot,onDelete:Je,onStatusUpdate:je,currentUser:ge,isSalesView:!0}),Z&&a.jsx(OUe,{open:!0,title:Z.title,message:Z.message,confirmLabel:Z.confirmLabel,variant:Z.variant,onConfirm:at,onCancel:()=>Q(null),loading:le})]})};function OUe({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":i==="archive"?"bg-orange-500 hover:bg-orange-600 border border-orange-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{onClick:c,disabled:o,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",children:"Cancel"}),a.jsx("button",{onClick:l,disabled:o,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70
                       ${u}`,children:o?"...":s})]})]})})}function MUe({icon:e,title:t,value:n,color:s,bgColor:r}){return a.jsxs("div",{className:"flex items-center p-4 bg-white rounded-xl shadow-md border border-gray-200",children:[a.jsx("div",{className:`p-3 rounded-full ${r} ${s} mr-4`,children:a.jsx(e,{size:22})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:t}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:n})]})]})}const IUe=[{value:"PLANNED",label:"PLANNED"},{value:"HELD",label:"HELD"},{value:"NOT_HELD",label:"NOT HELD"}],$Ue=e=>e?String(e).toUpperCase():"",hu=e=>{const t=$Ue(e);return t==="PLANNED"||t==="PENDING"?"PLANNED":t==="HELD"||t==="COMPLETED"?"HELD":t==="NOT HELD"||t==="NOT_HELD"||t==="CANCELLED"?"NOT_HELD":"PLANNED"},ZA=e=>{const t=hu(e);return t==="PLANNED"?"PLANNED":t==="HELD"?"HELD":t==="NOT_HELD"?"NOT HELD":"--"},_8=e=>{switch(hu(e)){case"PLANNED":return"bg-indigo-100 text-indigo-700";case"HELD":return"bg-green-100 text-green-700";case"NOT_HELD":return"bg-gray-200 text-gray-700";default:return"bg-gray-100 text-gray-700"}},JA=e=>{if(!e)return"";const t=String(e).split("-");return t.length===3?`${t[0]}-${t[2]}`:String(e)},A8=e=>e?new Date(e).toLocaleString("en-US",{month:"2-digit",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}):"--";function RUe(){const[e,t]=f.useState(!1),[n,s]=f.useState(null),[r,i]=f.useState(null),[o,l]=f.useState(null),[c,u]=f.useState(null),[d,h]=f.useState([]),[p,x]=f.useState(null),[b,j]=f.useState(!1),[y,N]=f.useState(null),[w,S]=f.useState(!1),[_,T]=f.useState(!1),[k,A]=f.useState("PLANNED"),[E,M]=f.useState(!1),[F,D]=f.useState(!1),[P,B]=f.useState(1),[G,$]=f.useState(10),[W,Z]=f.useState(null),[Q,le]=f.useState([]),[we,J]=f.useState(null),{comments:se,addComment:ye,refresh:Ce}=kn({relatedType:"call",relatedId:n?.id});f.useEffect(()=>{n?.id&&Ce()},[n?.id,Ce]),Bs();const ge=Et(),be=ta(),{user:me}=Gt(),Ae=me?.role==="Sales",Ie={subject:"",call_time:(()=>{const ce=new Date,fe=ce.getFullYear(),H=String(ce.getMonth()+1).padStart(2,"0"),te=String(ce.getDate()).padStart(2,"0");return`${fe}-${H}-${te}T08:00`})(),duration_minutes:"",direction:"Outgoing",status:"Planned",notes:"",relatedType1:"Lead",relatedType2:null,relatedTo1:null,relatedTo2:null,assigned_to:null},[xe,he]=f.useState(Ie);f.useEffect(()=>{e&&!b&&Ae&&me&&!xe.assigned_to&&he(ce=>({...ce,assigned_to:me.id}))},[e,b,me,Ae]),f.useEffect(()=>{const ce=be.state,fe=ce?.callID;if(fe&&!ce?.openCallModal){Z(fe),ge(be.pathname,{replace:!0,state:{}});return}!ce?.openCallModal||!ce?.initialCallData||ce.initialCallData.relatedType1==="Lead"&&Array.isArray(o)&&o.length===0||ce.initialCallData.relatedType1==="Account"&&(!Array.isArray(o)||o.length===0)||(t(!0),he(H=>({...H,...ce.initialCallData,relatedTo1:ce.initialCallData.relatedTo1?String(ce.initialCallData.relatedTo1):"",relatedTo2:ce.initialCallData.relatedTo2?String(ce.initialCallData.relatedTo2):""})),ge(be.pathname,{replace:!0,state:{}}))},[be.state,o]),f.useEffect(()=>{if(W&&d.length>0&&!F){const ce=d.find(fe=>fe.id===W);ce?s(ce):V.error("Call not found."),Z(null)}},[W,d,F]);const Re=async()=>{try{D(!0);const ce=await ne.get("/calls/admin/fetch-all"),H=[...Array.isArray(ce.data)?ce.data:[]].sort((te,q)=>{const Y=te?.created_at?new Date(te.created_at):0;return(q?.created_at?new Date(q.created_at):0)-Y});h(H)}catch(ce){console.error("Error fetching calls:",ce),V.error("Failed to load calls")}finally{D(!1)}},Ee=async()=>{try{const ce=await ne.get("/users/all");x(ce.data)}catch(ce){console.error("Error fetching users: ",ce)}};f.useEffect(()=>{async function ce(){try{const fe=await ne.get("/auth/me");J(fe.data)}catch(fe){console.error("Failed to fetch current user",fe)}}ce()},[]),f.useEffect(()=>{Ee(),Re()},[]);const[He,Ke]=f.useState(""),[st,it]=f.useState("Filter by Status"),[ot,rt]=f.useState("Filter by Users");f.useEffect(()=>{B(1)},[He,st,ot,G]);const at=f.useMemo(()=>d.filter(ce=>{const fe=!He||[ce.subject,ce.notes,ce.lead?.title,ce.account?.name,ce.contact?.first_name,ce.contact?.last_name,ce.deal?.name].some(Y=>Y&&String(Y).toLowerCase().includes(He.toLowerCase())),H=st==="Filter by Status"||hu(ce.status)===st,te=ce.call_assign_to?`${ce.call_assign_to.first_name} ${ce.call_assign_to.last_name}`:"";return fe&&H&&(ot==="Filter by Users"||te===ot)}),[d,He,st,ot]),Je=Array.isArray(p)?p.map(ce=>({id:ce.id,name:`${ce.first_name} ${ce.last_name}`})):[],Fe=f.useMemo(()=>{const ce=(P-1)*G;return at.slice(ce,ce+G)},[at,P,G]),Ue=at.length,Ne=at.filter(ce=>hu(ce.status)==="PLANNED").length,ze=at.filter(ce=>hu(ce.status)==="HELD").length,je=at.filter(ce=>hu(ce.status)==="NOT_HELD").length,ve=[{title:"Total",value:Ue,icon:Us,color:"text-slate-600",bgColor:"bg-slate-100"},{title:"Planned",value:Ne,icon:Vn,color:"text-indigo-600",bgColor:"bg-indigo-100"},{title:"Held",value:ze,icon:La,color:"text-green-600",bgColor:"bg-green-100"},{title:"Not Held",value:je,icon:Yn,color:"text-gray-600",bgColor:"bg-gray-100"}],[z,K]=f.useState("Overview"),ue=ce=>{const{name:fe,value:H}=ce.target;he(te=>{const q={...te,[fe]:H};return fe==="relatedType1"&&(q.relatedTo1="",H==="Lead"?(q.relatedType2=null,q.relatedTo2=null,u([])):H==="Account"&&(q.relatedType2="Contact")),fe==="relatedType2"&&(q.relatedTo2=""),q})};f.useEffect(()=>{const ce=async()=>{try{l([]);let fe;xe.relatedType1==="Lead"?fe=await ne.get("/leads/admin/getLeads"):xe.relatedType1==="Account"&&(fe=await ne.get("/accounts/admin/fetch-all"));let H=[];if(fe&&Array.isArray(fe.data)?H=fe.data:H=[],b&&xe.relatedTo1)try{let te;xe.relatedType1==="Lead"?te=await ne.get(`/leads/get/${xe.relatedTo1}`):xe.relatedType1==="Account"&&(te=await ne.get(`/accounts/get/${xe.relatedTo1}`)),te&&te.data&&(H.some(Y=>String(Y.id)===String(xe.relatedTo1))||(H=[te.data,...H]))}catch(te){console.error("Error fetching specific related item:",te)}l(H)}catch(fe){console.error("Error fetching data:",fe),l([])}};xe.relatedType1&&ce()},[xe.relatedType1,b,xe.relatedTo1]),f.useEffect(()=>{const ce=async()=>{try{u([]);let fe;if(xe.relatedType1==="Account"&&xe.relatedTo1)xe.relatedType2==="Contact"?fe=await ne.get(`/contacts/from-acc/${xe.relatedTo1}`):xe.relatedType2==="Deal"?fe=await ne.get(`/deals/from-acc/${xe.relatedTo1}`):xe.relatedType2==="Quote"&&(fe=await ne.get(`/quotes/from-acc/${xe.relatedTo1}`));else{u([]);return}fe&&Array.isArray(fe.data)?u(fe.data):u([])}catch(fe){console.error("Error fetching data:",fe),u([])}};xe.relatedType2&&ce()},[xe.relatedType2,xe.relatedTo1,xe.relatedType1]);const[re,Le]=f.useState(!1),De=ce=>{ce.preventDefault(),Le(!0);const fe=xe.subject;if(!fe||fe.trim()===""){V.error("Subject is required.");return}if(!xe.relatedTo1){V.error(`Please select a ${xe.relatedType1||"Lead/Account"}.`);return}if(!xe.assigned_to){V.error("Subject is required.");return}const te={...xe,duration_minutes:xe.duration_minutes?parseInt(xe.duration_minutes,10):null,relatedTo1:xe.relatedTo1?parseInt(xe.relatedTo1,10):null,relatedTo2:xe.relatedType1==="Lead"?null:xe.relatedTo2?parseInt(xe.relatedTo2,10):null,relatedType2:xe.relatedType1==="Lead"?null:xe.relatedType2,assigned_to:xe.assigned_to?parseInt(xe.assigned_to,10):null},q=b&&y?"update":"create",Y=(xe.subject||"").trim()||"Untitled Call";i({title:q==="create"?"Confirm New Call":"Confirm Update",message:q==="create"?`Create "${Y}"?`:`Save changes to "${Y}"?`,confirmLabel:q==="create"?"Create Call":"Update Call",cancelLabel:"Cancel",variant:"primary",action:{type:q,payload:te,targetId:y||null,name:Y}})},Qe=ce=>s(ce),tt=()=>{t(!1),j(!1),N(null)},Me=async()=>{if(!r?.action){i(null);return}const{action:ce}=r,{type:fe,payload:H,targetId:te,name:q,callIds:Y}=ce;T(!0);try{if(fe==="bulk-delete")await ne.post("/calls/bulk-delete",{call_ids:Y}),V.success(`Successfully archived ${Y.length} call(s).`),le([]),await Re();else if(fe==="create")S(!0),await ne.post("/calls/create",H),V.success(`Call "${q}" created successfully.`),t(!1),he(Ie),j(!1),N(null),await Re();else if(fe==="update"){if(!te)throw new Error("Missing call identifier for update.");S(!0),await ne.put(`/calls/${te}`,H),V.success(`Call "${q}" updated successfully.`),t(!1),he(Ie),j(!1),N(null),await Re()}else if(fe==="delete"){if(!te)throw new Error("Missing call identifier for archival.");await ne.delete(`/calls/${te}`),V.success(`Call "${q}" archived successfully.`),n?.id===te&&s(null),await Re()}}catch(U){const de=fe==="create"?"Failed to create call. Please review the details and try again.":fe==="update"?"Failed to update call. Please review the details and try again.":"Failed to archive call. Please try again.",Te=U?.response?.data?.detail||de;V.error(Te)}finally{(fe==="create"||fe==="update")&&S(!1),T(!1),i(null)}},et=()=>{_||i(null)},yt=async()=>{if(n?.id)try{M(!0),await ne.put(`/calls/${n.id}`,{status:k}),V.success(`Status updated to ${ZA(k)}`),h(ce=>Array.isArray(ce)?ce.map(fe=>fe.id===n.id?{...fe,status:k}:fe):ce),s(null)}catch(ce){const fe=ce.response?.data?.detail||"Failed to update status.";V.error(fe)}finally{M(!1)}},_t=()=>{const ce=Fe.filter(fe=>fe.call_creator?.id===we?.id);Q.length===ce.length&&ce.length>0?le([]):le(ce.map(fe=>fe.id))},Ct=ce=>{le(fe=>fe.includes(ce)?fe.filter(H=>H!==ce):[...fe,ce])},jt=ce=>{if(ce==="single"){const fe=n.subject||"this call";i({title:"Archive Call",message:`Are you sure you want to archive "${fe}"? This call will be hidden from your view but admins can still see it.`,confirmLabel:"Archive Call",cancelLabel:"Cancel",variant:"warning",action:{type:"delete",targetId:n.id,name:fe}})}else if(ce==="bulk"){if(Q.length===0)return;i({title:"Archive Calls",message:a.jsxs("span",{children:["Are you sure you want to archive"," ",a.jsx("span",{className:"font-semibold",children:Q.length})," selected calls? These calls will be hidden from your view but admins can still see them."]}),confirmLabel:`Archive ${Q.length} call(s)`,cancelLabel:"Cancel",variant:"warning",action:{type:"bulk-delete",callIds:Q}})}},At=()=>{jt("bulk")};f.useEffect(()=>{n&&A(hu(n.status))},[n]);const Ge=n?a.jsxs("div",{id:"callModalBackdrop",onClick:ce=>ce.target.id==="callModalBackdrop"&&s(null),className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center p-4",children:[F&&a.jsx(qt,{message:"Loading call details..."}),a.jsxs("div",{className:"bg-white rounded-xl shadow-lg w-full max-w-full lg:max-w-4xl max-h-[95vh] overflow-y-auto hide-scrollbar relative box-border",children:[a.jsxs("div",{className:"bg-tertiary w-full rounded-t-xl p-3 lg:p-3 relative",children:[a.jsx("h1",{className:"lg:text-3xl text-xl text-white font-semibold text-center w-full",children:"Calls"}),a.jsx("button",{onClick:()=>s(null),className:"text-gray-500 hover:text-white transition cursor-pointer absolute top-3 right-3",children:a.jsx(Za,{size:25})})]}),a.jsx("div",{className:"mt-4 gap-2 px-2 lg:gap-4 lg:mx-7",children:a.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between lg:flex-row lg:items-center lg:justify-between mt-3 gap-2 px-2 md:items-center lg:gap-4 md:mx-7 lg:mx-7",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[a.jsx("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-800",children:n.subject}),a.jsx("span",{className:`text-xs sm:text-sm font-medium px-2 sm:px-3 py-1 rounded-full ${_8(n.status)}`,children:ZA(n.status)})]}),a.jsx("div",{className:"flex flex-col sm:flex-row sm:space-x-3 space-y-2 sm:space-y-0",children:n.call_creator?.id===we?.id&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{className:"inline-flex items-center justify-center w-full sm:w-auto bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 transition text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",onClick:()=>{const ce=Y=>{if(!Y)return"";const U=new Date(Y),de=U.getFullYear(),Te=String(U.getMonth()+1).padStart(2,"0"),ie=String(U.getDate()).padStart(2,"0"),Oe=String(U.getHours()).padStart(2,"0"),X=String(U.getMinutes()).padStart(2,"0");return`${de}-${Te}-${ie}T${Oe}:${X}`},fe=n.lead?"Lead":n.account?"Account":"Lead",H=n.lead?n.lead.id:n.account?n.account.id:null,te=fe==="Lead"?null:n.contact?"Contact":n.deal?"Deal":n.quote?"Quote":"Contact",q=fe==="Lead"?null:n.contact?n.contact.id:n.deal?n.deal.id:n.quote?n.quote.id:null;he({subject:n.subject||"",call_time:ce(n.call_time),duration_minutes:n.duration_minutes?String(n.duration_minutes):"",direction:n.direction||"Outgoing",status:n.status||"Planned",notes:n.notes||"",relatedType1:fe,relatedType2:te,relatedTo1:H?String(H):"",relatedTo2:q?String(q):"",assigned_to:n.call_assign_to?.id?String(n.call_assign_to.id):""}),j(!0),N(n.id),s(null),t(!0)},children:[a.jsx(gn,{className:"mr-2"}),"Edit"]}),a.jsxs("button",{className:"inline-flex items-center justify-center w-full sm:w-auto px-4 py-2 rounded-md text-sm bg-orange-500 text-white hover:bg-orange-600 transition focus:outline-none focus:ring-2 focus:ring-orange-400",onClick:()=>jt("single"),children:[a.jsx(Zt,{className:"mr-2"}),"Archive"]})]})})]})}),a.jsx("div",{className:"border-b border-gray-200 my-5"}),a.jsxs("div",{className:"p-6 lg:p-4",children:[a.jsx("div",{className:"flex w-full bg-[#6A727D] text-white mt-1 overflow-x-auto mb-6",children:["Overview","Notes"].map(ce=>a.jsx("button",{onClick:()=>K(ce),className:`flex-1 min-w-[90px] px-4 py-2.5 text-xs sm:text-sm font-medium border-b-2 ${z===ce?"bg-paper-white text-[#6A727D] border-white":"text-white hover:bg-[#5c636d]"}`,children:ce},ce))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 items-start",children:[a.jsxs("div",{className:"lg:col-span-3",children:[z==="Overview"&&a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 md:p-8 border border-gray-200",children:a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4 sm:gap-6 text-sm text-gray-700",children:[a.jsx(po,{label:"Call Time",value:A8(n.call_time)}),a.jsx(po,{label:"Duration",value:n.duration_minutes?`${n.duration_minutes} min`:null}),a.jsx(po,{label:"Direction",value:n.direction||"--"}),a.jsx(po,{label:"Assigned To",value:`${n.call_assign_to.first_name} ${n.call_assign_to.last_name}`}),n.lead&&a.jsx(po,{label:"Lead",value:n.lead.title}),n.account&&a.jsx(po,{label:"Account",value:n.account.name}),n.contact&&a.jsx(po,{label:"Contact",value:`${n.contact.first_name} ${n.contact.last_name}`}),n.deal&&a.jsx(po,{label:"Deal",value:n.deal.name}),n.quote&&a.jsx(po,{label:"Quote",value:JA(n.quote.quote_id)}),a.jsx(po,{label:"Created At",value:A8(n.created_at)})]})}),z==="Notes"&&a.jsxs("div",{className:"mt-4 w-full",children:[a.jsx("div",{className:"flex flex-wrap items-center justify-between mb-4 gap-2",children:a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words",children:"Call Note"})}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 shadow-sm break-words",children:[a.jsx("div",{className:"flex items-start justify-between",children:a.jsx("div",{children:a.jsx("p",{className:"text-sm font-medium text-gray-800 break-words",children:"Note"})})}),a.jsx("div",{className:"mt-3 text-sm text-gray-700 whitespace-pre-wrap break-words",children:n.notes||"No notes available."})]}),a.jsx(Tn,{comments:se,onAddComment:ye})]})]}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm w-full",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Status"}),a.jsxs("select",{className:"border border-gray-200 rounded-md px-2 py-1.5 w-full text-sm mb-2",value:k,onChange:ce=>A(ce.target.value),children:[a.jsx("option",{value:"PLANNED",children:"PLANNED"}),a.jsx("option",{value:"HELD",children:"HELD"}),a.jsx("option",{value:"NOT_HELD",children:"NOT HELD"})]}),a.jsx("button",{onClick:yt,disabled:E,className:"w-full py-1.5 rounded-md text-sm bg-gray-900 text-white hover:bg-gray-800 disabled:opacity-50",children:E?"Updating...":"Update"})]})]})]})]})]}):null,Be=e?a.jsx("div",{id:"modalBackdrop",onClick:ce=>ce.target.id==="modalBackdrop"&&tt(),className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-xl rounded-2xl shadow-lg p-4 sm:p-6 md:p-8 relative border border-gray-200 overflow-y-auto max-h-[90vh] hide-scrollbar",children:[a.jsx("button",{onClick:()=>{tt(),Le(!1)},className:"absolute top-4 right-4 text-gray-500 hover:text-black transition",children:a.jsx(ea,{size:22})}),a.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800 mb-4 sm:mb-6 flex items-center justify-center",children:b?"Edit Call":"Add New Call"}),a.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 w-full gap-4 text-sm",onSubmit:De,noValidate:!0,children:[a.jsx(FUe,{label:"Subject",className:"md:col-span-2",name:"subject",value:xe.subject,onChange:ue,isSubmitted:re,required:!0}),a.jsxs("div",{className:"w-full flex flex-col",children:[a.jsxs("div",{className:"relative w-25",children:[a.jsxs("select",{name:"relatedType1",onChange:ue,value:xe.relatedType1,className:"outline-none cursor-pointer mb-1 w-22 text-gray-700 disabled:text-gray-400 disabled:cursor-not-allowed",disabled:w,children:[a.jsx("option",{value:"Lead",children:"Lead"}),a.jsx("option",{value:"Account",children:"Account"})]}),a.jsx("span",{className:"absolute left-10 md:pl-6 pl-6 top-1/2 -translate-y-1/2 text-red-500 pointer-events-none",children:"*"})]}),a.jsx(eT,{items:Array.isArray(o)?o:[],value:xe.relatedTo1??"",placeholder:`Search ${xe.relatedType1||"here"}...`,getLabel:ce=>xe.relatedType1==="Lead"?ce.title:ce.name??"",onChange:ce=>he(fe=>({...fe,relatedTo1:ce})),required:!0,isSubmitted:re,disabled:w})]}),a.jsxs("div",{className:"w-full flex flex-col",children:[a.jsxs("select",{name:"relatedType2",onChange:ue,value:xe.relatedType2??"Contact",className:"text-gray-700 outline-none cursor-pointer mb-1 w-22 disabled:text-gray-400 disabled:cursor-not-allowed",disabled:xe.relatedType1==="Lead"||w,children:[a.jsx("option",{value:"Contact",children:"Contact"}),a.jsx("option",{value:"Deal",children:"Deal"}),a.jsx("option",{value:"Quote",children:"Quote"})]}),a.jsx(eT,{disabled:xe.relatedType1==="Lead"||w,items:Array.isArray(c)?c:[],value:xe.relatedTo2??"",placeholder:xe.relatedType1==="Lead"?"":Array.isArray(c)&&c.length>0?`Search ${xe.relatedType2||"Contact"}...`:`No ${xe.relatedType2||""} data found`,getLabel:ce=>xe.relatedType2==="Contact"?`${ce.first_name??""} ${ce.last_name??""}`.trim():xe.relatedType2==="Quote"?JA(ce.quote_id)??"":ce.name??"",onChange:ce=>he(fe=>({...fe,relatedTo2:ce}))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Call Time"}),a.jsx("input",{type:"datetime-local",value:xe.call_time,onChange:ue,name:"call_time",className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100"})]}),a.jsxs("div",{className:"w-full",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Duration"}),a.jsxs("div",{className:"w-full rounded-md text-sm flex flex-row items-center justify-start",children:[a.jsx("input",{type:"tel",value:xe.duration_minutes,onChange:ue,name:"duration_minutes",className:"border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100 w-44 mr-3"}),a.jsx("p",{children:"minutes"})]})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:["Assign To ",a.jsx("span",{className:"text-red-600 font-semibold",children:"*"})]}),a.jsx(eT,{items:Array.isArray(p)?p:[],value:xe.assigned_to??"",placeholder:"Search an account...",getLabel:ce=>`${ce.first_name} ${ce.last_name}`,onChange:ce=>he(fe=>({...fe,assigned_to:ce})),disabled:Ae,required:!0,isSubmitted:re})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Direction"}),a.jsxs("select",{name:"direction",onChange:ue,value:xe.direction,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100",children:[a.jsx("option",{value:"Incoming",children:"Incoming"}),a.jsx("option",{value:"Outgoing",children:"Outgoing"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Status"}),a.jsxs("select",{name:"status",onChange:ue,value:xe.status,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100",children:[a.jsx("option",{value:"Planned",children:"Planned"}),a.jsx("option",{value:"Held",children:"Held"}),a.jsx("option",{value:"Not held",children:"Not held"})]})]}),a.jsx(UUe,{className:"col-span-2",label:"Notes",value:xe.notes,onChange:ue,name:"notes"}),a.jsxs("div",{className:"flex flex-col md:flex-row justify-end col-span-2 mt-4 gap-2 w-full",children:[a.jsx("button",{type:"button",onClick:()=>{tt(),Le(!1)},className:"w-full sm:w-auto px-4 py-2 text-white bg-red-400 border border-red-300 rounded hover:bg-red-500 transition",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:w,className:"w-full sm:w-auto px-4 py-2 text-white bg-tertiary border border-tertiary rounded hover:bg-secondary transition",children:w?"Saving...":b?"Update Call":"Save Call"})]})]})]})}):null;return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h1",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(Us,{className:"mr-2 text-blue-600"})," Calls"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{onClick:()=>{he(Ie),j(!1),N(null),t(!0),Le(!1)},className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 my-1 lg:my-0 rounded-md hover:bg-gray-800 text-sm sm:text-base mx-auto sm:ml-auto cursor-pointer",children:[a.jsx(aa,{className:"mr-2"})," Add Call"]})})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-4 mb-6 w-full break-words overflow-hidden lg:overflow-visible",children:ve.map(ce=>a.jsx(zUe,{...ce},ce.title))}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center gap-3",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search calls",className:"focus:outline-none text-base w-full",value:He,onChange:ce=>Ke(ce.target.value)})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row w-full lg:w-1/2 gap-2",children:[a.jsxs("select",{value:st,onChange:ce=>it(ce.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm bg-white w-full",children:[a.jsx("option",{value:"Filter by Status",children:"Filter by Status"}),IUe.map(ce=>a.jsx("option",{value:ce.value,children:ce.label},ce.value))]}),a.jsxs("select",{value:ot,onChange:ce=>rt(ce.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm bg-white w-full",children:[a.jsx("option",{value:"Filter by Users",children:"Filter by Users"}),Je.map(ce=>a.jsx("option",{value:ce.name,children:ce.name},ce.id))]})]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[500px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm mb-4",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 text-center w-12",children:a.jsx("input",{type:"checkbox",checked:Fe.length>0&&Fe.filter(ce=>ce.call_creator?.id===we?.id).every(ce=>Q.includes(ce.id))&&Fe.some(ce=>ce.call_creator?.id===we?.id),onChange:_t,className:"form-checkbox h-4 w-4 text-blue-600 rounded focus:ring-blue-500 border-gray-300"})}),a.jsx("th",{className:"py-3 px-4",children:"Subject"}),a.jsx("th",{className:"py-3 px-4",children:"Related To"}),a.jsx("th",{className:"py-3 px-4",children:"Call Time"}),a.jsx("th",{className:"py-3 px-4",children:"Assigned To"}),a.jsx("th",{className:"py-3 px-4",children:"Status"}),a.jsx("th",{className:"py-3 px-4 text-center w-24",children:Q.length>0?a.jsx("button",{onClick:At,className:"text-orange-600 hover:text-orange-800 transition p-1 rounded-full hover:bg-orange-50",title:`Archive ${Q.length} selected calls`,children:a.jsx(Zt,{size:18})}):""})]})}),a.jsx("tbody",{children:F?a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"py-10",children:a.jsx(qt,{message:"Loading calls..."})})}):Fe.length>0?Fe.map(ce=>a.jsxs("tr",{onClick:()=>Qe(ce),className:"hover:bg-gray-50 cursor-pointer border-b border-gray-100",children:[a.jsx("td",{className:"py-3 px-4 align-top text-center",onClick:fe=>fe.stopPropagation(),children:ce.call_creator?.id===we?.id?a.jsx("input",{type:"checkbox",checked:Q.includes(ce.id),onChange:()=>Ct(ce.id),className:"form-checkbox h-4 w-4 text-blue-600 rounded focus:ring-blue-500 border-gray-300",onClick:fe=>fe.stopPropagation()}):null}),a.jsx("td",{className:"py-3 px-4 text-blue-600 font-medium",children:ce.subject||"--"}),a.jsxs("td",{className:"py-3 px-4",children:[ce.lead&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:ce.lead.title}),ce.account&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:ce.account.name}),ce.contact&&a.jsxs("p",{className:"font-medium text-blue-500 text-xs",children:[ce.contact.first_name," ",ce.contact.last_name]}),ce.deal&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:ce.deal.name}),ce.quote&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:JA(ce.quote.quote_id)})]}),a.jsx("td",{className:"py-3 px-4 text-gray-800",children:ce.call_time?new Date(ce.call_time).toLocaleString():"--"}),a.jsx("td",{className:"py-3 px-4 text-gray-800",children:ce?.call_assign_to?`${ce.call_assign_to.first_name} ${ce.call_assign_to.last_name}`:"--"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${_8(ce.status)}`,children:ZA(ce.status)})}),a.jsx("td",{})]},ce.id)):a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"text-center py-4 text-gray-500",children:"No calls found."})})})]})}),a.jsx(ca,{totalItems:at.length,pageSize:G,currentPage:P,onPrev:()=>B(ce=>Math.max(ce-1,1)),onNext:()=>B(ce=>Math.min(ce+1,Math.max(1,Math.ceil(at.length/G)||1))),onPageSizeChange:ce=>{$(ce),B(1)},pageSizeOptions:[10,20,30,40,50],label:"calls"})]}),Ge,Be,r&&a.jsx(BUe,{open:!0,title:r.title,message:r.message,confirmLabel:r.confirmLabel,variant:r.variant,onConfirm:Me,onCancel:et,loading:_})]})}function zUe({icon:e,title:t,value:n,color:s,bgColor:r}){return a.jsxs("div",{className:"flex items-center p-4 bg-white rounded-xl shadow-md border border-gray-200 transition-all duration-300",children:[a.jsx("div",{className:`p-3 rounded-full ${r} ${s} mr-4`,children:a.jsx(e,{size:22})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:t}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:n})]})]})}function FUe({label:e,name:t,value:n,onChange:s,placeholder:r="",type:i="text",required:o=!1,disabled:l=!1,isSubmitted:c=!1,className:u=""}){const d=c&&o&&!n;return a.jsxs("div",{className:u,children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",o&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:i,name:t,value:n??"",onChange:s,placeholder:r,disabled:l,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border focus:ring-2 disabled:bg-gray-100
          ${d?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}
        `})]})}function UUe(e){return a.jsxs("div",{className:e.className,children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e.label}),a.jsx("textarea",{...e,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100 resize-none"})]})}function po({label:e,value:t}){return a.jsxs("p",{children:[a.jsxs("span",{className:"font-semibold",children:[e,":"]})," ",a.jsx("br",{}),a.jsx("span",{className:"break-words",children:t||"--"})]})}function BUe({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o=!1,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="warning"?"bg-orange-500 hover:bg-orange-600 border border-orange-400":i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsx("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${u}`,disabled:o,children:o?"Processing...":s})]})]})})}function eT({items:e=[],value:t="",onChange:n,getLabel:s,placeholder:r="Search...",disabled:i=!1,maxRender:o=200,required:l=!1,isSubmitted:c=!1}){const[u,d]=f.useState(!1),[h,p]=f.useState(""),x=f.useRef(null),b=e.find(w=>String(w.id)===String(t)),j=b?s(b):"",y=l&&c&&!t,N=f.useMemo(()=>{const w=h.trim().toLowerCase();return(w?e.filter(_=>(s(_)||"").toLowerCase().includes(w)):e).slice(0,o)},[e,h,s,o]);return f.useEffect(()=>{const w=S=>{x.current&&!x.current.contains(S.target)&&d(!1)};return document.addEventListener("mousedown",w),()=>document.removeEventListener("mousedown",w)},[]),f.useEffect(()=>{u||p("")},[u]),a.jsxs("div",{ref:x,className:"relative w-full",children:[a.jsx("input",{disabled:i,value:u?h:j,placeholder:r,onFocus:()=>!i&&d(!0),onChange:w=>{p(w.target.value),u||d(!0)},className:`w-full border rounded-md px-2 py-1.5 text-sm outline-none focus:ring-2 disabled:bg-gray-100
          ${y?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}`}),u&&!i&&a.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg overflow-hidden",children:[a.jsx("div",{className:"max-h-56 overflow-y-auto",children:N.length>0?N.map(w=>{const S=String(w.id),_=s(w),T=String(t)===S;return a.jsx("button",{type:"button",onClick:()=>{n(S),d(!1)},className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-50 ${T?"bg-blue-50":""}`,children:_||"--"},S)}):a.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No results"})}),e.length>o&&a.jsxs("div",{className:"px-3 py-2 text-[11px] text-gray-400 border-t",children:["Showing first ",o," results  keep typing to narrow."]})]})]})}function HUe(){const{user:e,loading:t}=Gt(),[n,s]=f.useState(!1),[r,i]=f.useState([]),[o,l]=f.useState([]),[c,u]=f.useState([]);f.useEffect(()=>{document.title="Calendar | Sari-Sari CRM"},[]);const d=async()=>{try{s(!0);const[p,x,b]=await Promise.all([ne.get("/tasks/all"),ne.get("/meetings/admin/fetch-all"),ne.get("/calls/admin/fetch-all")]);i(Array.isArray(p.data)?p.data:[]),l(Array.isArray(x.data)?x.data:[]),u(Array.isArray(b.data)?b.data:[])}catch(p){console.error(p),V.error("Failed to load calendar data.")}finally{s(!1)}};f.useEffect(()=>{!t&&e&&d()},[t,e]);const h=f.useMemo(()=>({tasks:r,meetings:o,calls:c}),[r,o,c]);return a.jsxs("div",{className:"min-h-screen",children:[(n||t)&&a.jsx(qt,{message:"Loading calendar..."}),a.jsx(M1,{basePath:"/sales",...h})]})}function qUe({toggleSidebar:e}){const[t,n]=f.useState(!1),[s,r]=f.useState(!1),[i,o]=f.useState([]),[l,c]=f.useState(0),u=f.useRef(null),d=f.useRef(null),h=ta(),p=Et(),{logout:x}=Ks(),{user:b,fetchUser:j}=Gt(),N={"/manager/dashboard":"Dashboard","/manager/accounts":"Accounts","/manager/contacts":"Contacts","/reports":"Reports","/leads":"Leads","/manager/Audit":"Audit","/manager/targets":"Targets","/manager/leads":"Leads","/manager/quotes":"Quotes","/manager/users":"Users","/manager/deals":"Deals"}[h.pathname]||"Manager Panel";return f.useEffect(()=>{j()},[]),f.useEffect(()=>{const w=()=>j();return window.addEventListener("userProfileUpdated",w),()=>window.removeEventListener("userProfileUpdated",w)},[j]),f.useEffect(()=>{if(!b?.id)return;const w=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1",S=window.location.protocol==="https:"?"wss:":"ws:",_=w?"localhost:8000":window.location.host,T=`${S}//${_}/ws/notifications?user_id=${b.id}`,k=new WebSocket(T);return k.onmessage=A=>{const E=JSON.parse(A.data);o(M=>[E,...M]),c(M=>M+1)},()=>k.close()},[b?.id]),f.useEffect(()=>{function w(S){u.current&&!u.current.contains(S.target)&&n(!1),d.current&&!d.current.contains(S.target)&&r(!1)}return document.addEventListener("mousedown",w),()=>document.removeEventListener("mousedown",w)},[]),a.jsxs("header",{className:"flex justify-between items-center bg-white shadow px-4 sm:px-6 py-3 border-b relative z-50",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("button",{onClick:e,className:"lg:hidden text-gray-700 hover:text-gray-900",children:a.jsx(rh,{className:"text-2xl"})}),a.jsx("h1",{className:"text-lg font-semibold text-gray-800",children:N})]}),a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs("div",{className:"relative",ref:d,children:[a.jsxs("button",{onClick:()=>r(!s),className:"relative text-gray-600 hover:text-gray-800 transition",children:[a.jsx(gx,{className:"text-xl"}),l>0&&a.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-[10px] w-4 h-4 flex items-center justify-center rounded-full font-semibold",children:l})]}),s&&a.jsxs("div",{className:"absolute right-0 mt-3 w-80 bg-white rounded-xl shadow-lg border z-50 overflow-hidden animate-in fade-in slide-in-from-top-2 duration-200",children:[a.jsxs("div",{className:"p-3 border-b bg-gray-50 flex justify-between items-center",children:[a.jsx("h3",{className:"font-semibold text-gray-800 text-sm",children:"Notifications"}),a.jsx("button",{onClick:()=>{o([]),c(0)},className:"text-xs text-blue-600 hover:underline",children:"Clear All"})]}),a.jsx("div",{className:"max-h-60 overflow-y-auto",children:i.length>0?i.map((w,S)=>a.jsx("div",{className:"p-3 border-b text-sm hover:bg-gray-50 cursor-pointer transition",children:w.title||w.message||"New Notification"},S)):a.jsx("div",{className:"p-4 text-center text-gray-500 text-xs",children:"No notifications"})})]})]}),a.jsxs("div",{className:"relative",ref:u,children:[a.jsxs("button",{onClick:()=>n(!t),className:"flex items-center gap-2 cursor-pointer hover:bg-gray-100 px-2 py-1 rounded transition",children:[a.jsx("img",{src:b?.profile_picture||"https://via.placeholder.com/40",alt:"Profile",className:"w-8 h-8 object-cover rounded-full border border-gray-200"}),a.jsxs("span",{className:"hidden lg:inline text-sm font-medium text-gray-700",children:[b?.first_name," ",b?.last_name]})]}),t&&a.jsxs("div",{className:"absolute right-0 mt-2 w-64 bg-white shadow-xl rounded-xl border border-gray-200 z-50 p-4 animate-in fade-in slide-in-from-top-2 duration-200",children:[a.jsxs("div",{className:"flex flex-col items-center text-center space-y-3",children:[a.jsx("img",{src:b?.profile_picture||"https://via.placeholder.com/80",alt:"Profile Large",className:"w-16 h-16 rounded-full object-cover border-2 border-gray-100"}),a.jsxs("div",{children:[a.jsxs("h2",{className:"text-gray-800 font-semibold text-sm",children:[b?.first_name," ",b?.middle_name," ",b?.last_name]}),a.jsx("p",{className:"text-[11px] text-gray-600 font-light w-full truncate",children:"Manager"})]})]}),a.jsxs("div",{className:"mt-6 space-y-1 px-2",children:[a.jsx("button",{onClick:()=>{p("/manager/manage-account"),n(!1)},className:"block w-full text-sm text-gray-700 hover:bg-gray-50 p-2 rounded text-left transition",children:"Manage Your Account"}),a.jsx("div",{className:"border-t border-gray-100 my-2"}),a.jsx("button",{onClick:x,className:"block w-full text-sm text-red-600 hover:bg-red-50 p-2 rounded text-left transition font-medium",children:"Logout"})]})]})]})]})]})}function GUe(){const[e,t]=f.useState(!1),[n,s]=f.useState(!1),[r,i]=f.useState(!1),[o,l]=f.useState(!1),c=ta(),{user:u}=Gt();f.useEffect(()=>{u&&console.log("Fetched user:",u)},[u]),f.useEffect(()=>{document.title="Panel | Sari-Sari CRM"},[]);const d="flex items-center gap-3 px-3 py-2 rounded-lg bg-white text-[#1e293b] font-semibold shadow-sm",h="flex items-center gap-3 px-3 py-2 rounded-lg text-gray-300 hover:bg-[#334155] hover:text-white transition";return["/manager/accounts","/manager/contacts","/manager/leads","/manager/deals","/manager/quotes","/manager/targets","/manager/meetings","/manager/manage-account"].includes(c.pathname),a.jsxs("div",{className:"flex h-screen bg-gray-100 overflow-hidden",children:[a.jsxs("div",{className:`fixed top-0 left-0 h-screen w-64 bg-[#1e293b] text-white flex flex-col shadow-lg transform transition-transform duration-300 z-50
          ${o?"translate-x-0":"-translate-x-full"} lg:translate-x-0`,children:[a.jsxs("div",{className:"px-4 py-3 bg-[#fbbf24] leading-none",children:[a.jsxs("p",{className:"text-gray-900 font-bold text-lg m-0 p-0",children:[" Sari-Sari.CRM"," ",a.jsx("span",{className:"text-[12px] text-gray-700 font-medium align-bottom",children:"v2"})]}),u&&u.company&&a.jsx("p",{className:"text-[12px] text-gray-600 font-medium w-full truncate",title:u.company.company_name,children:u.company.slug||u.company.company_name})]}),a.jsxs("nav",{className:"flex-1 overflow-y-auto p-4 space-y-2 hide-scrollbar",children:[a.jsxs($t,{to:"/manager/dashboard",className:({isActive:x})=>x?d:h,children:[a.jsx(sh,{className:"text-lg"}),a.jsx("span",{children:"Dashboard"})]}),a.jsxs("div",{children:[a.jsxs("button",{className:"w-full px-3 py-2 flex justify-between items-center text-sm font-medium text-gray-300 hover:bg-[#334155] rounded-lg transition",onClick:()=>t(!e),children:[a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx(sa,{className:"text-lg"}),"Sales"]}),a.jsx(Dt,{className:`transition-transform ${e?"rotate-180":""}`})]}),e&&a.jsxs("div",{className:"ml-6 mt-2 space-y-1",children:[a.jsxs($t,{to:"/manager/accounts",className:({isActive:x})=>x?d:h,children:[a.jsx(ac,{})," Accounts"]}),a.jsxs($t,{to:"/manager/contacts",className:({isActive:x})=>x?d:h,children:[a.jsx(ra,{})," Contacts"]}),a.jsxs($t,{to:"/manager/leads",className:({isActive:x})=>x?d:h,children:[a.jsx(rn,{})," Leads"]}),a.jsxs($t,{to:"/manager/deals",className:({isActive:x})=>x?d:h,children:[a.jsx(sa,{})," Deals"]}),a.jsxs($t,{to:"/manager/quotes",className:({isActive:x})=>x?d:h,children:[a.jsx(ia,{})," Quotes"]}),a.jsxs($t,{to:"/manager/targets",className:({isActive:x})=>x?d:h,children:[a.jsx(fr,{})," Targets"]})]})]}),a.jsxs("div",{children:[a.jsxs("button",{className:"w-full px-3 py-2 flex justify-between items-center text-sm font-medium text-gray-300 hover:bg-[#334155] rounded-lg transition",onClick:()=>s(!n),children:[a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx(Ls,{className:"text-lg"}),"Activity"]}),a.jsx(Dt,{className:`transition-transform ${n?"rotate-180":""}`})]}),n&&a.jsxs("div",{className:"ml-6 mt-2 space-y-1",children:[a.jsxs($t,{to:"/manager/calendar",className:({isActive:x})=>x?d:h,children:[a.jsx(Pt,{})," Calendar"]}),a.jsxs($t,{to:"/manager/tasks",className:({isActive:x})=>x?d:h,children:[a.jsx(Qt,{})," Tasks"]}),a.jsxs($t,{to:"/manager/meetings",className:({isActive:x})=>x?d:h,children:[a.jsx(Pt,{})," Meetings"]}),a.jsxs($t,{to:"/manager/calls",className:({isActive:x})=>x?d:h,children:[a.jsx(Us,{})," Calls"]}),a.jsxs($t,{to:"/manager/audit",className:({isActive:x})=>x?d:h,children:[a.jsx(Ls,{})," Audit"]})]})]}),a.jsx("div",{children:a.jsx($t,{to:"/manager/territory",className:({isActive:x})=>x?d:h,children:a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx(tc,{className:"text-lg"}),"Territory"]})})}),a.jsxs("div",{children:[a.jsxs("button",{className:"w-full px-3 py-2 flex justify-between items-center text-sm font-medium text-gray-300 hover:bg-[#334155] rounded-lg transition",onClick:()=>i(!r),children:[a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx(EL,{className:"text-lg"}),"Settings"]}),a.jsx(Dt,{className:`transition-transform ${r?"rotate-180":""}`})]}),r&&a.jsxs("div",{className:"ml-6 mt-2 space-y-1",children:[a.jsxs($t,{to:"/manager/users",className:({isActive:x})=>x?d:h,children:[a.jsx(Xa,{})," Users"]}),a.jsxs($t,{to:"/manager/manage-account",className:({isActive:x})=>x?d:h,children:[a.jsx(ra,{})," Your Profile"]})]})]})]}),a.jsxs("div",{className:"px-4 py-3 text-xs text-gray-400 border-t border-gray-700",children:[" ",new Date().getFullYear()," Sari-Sari CRM"]})]}),o&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 lg:hidden",onClick:()=>l(!1)}),a.jsxs("div",{className:"flex-1 flex flex-col lg:ml-64 overflow-hidden",children:[a.jsx(qUe,{toggleSidebar:()=>l(!o)}),a.jsx("main",{className:"flex-1 p-6 overflow-auto hide-scrollbar",style:{backgroundColor:"#fffeee"},children:a.jsx(th,{})})]})]})}const WUe=e=>a.jsx(Kt,{...e}),VUe=e=>a.jsx(ac,{...e}),NJ=e=>a.jsx(Vn,{...e}),YUe=e=>a.jsx(hx,{...e}),QUe=e=>a.jsx(bj,{...e}),KUe=e=>a.jsx(Pt,{...e}),XUe=e=>a.jsx(It,{...e}),ZUe=e=>a.jsx(wj,{...e}),CJ=e=>a.jsx(vj,{...e}),JUe=e=>a.jsx(Xa,{...e}),SJ=e=>a.jsx(ra,{...e}),e7e=e=>a.jsx(rn,{...e}),_J=e=>a.jsx(sa,{...e}),t7e=e=>a.jsx(ia,{...e}),AJ=e=>a.jsx(fr,{...e}),a7e=e=>a.jsx(La,{...e}),n7e=e=>a.jsx(Pt,{...e}),s7e=e=>a.jsx(Us,{...e}),r7e=e=>a.jsx(tc,{...e}),i7e=e=>a.jsx(Ls,{...e}),TJ=(e,t="")=>{const n=parseFloat(e)||0;return new Intl.NumberFormat("en-US",{notation:"compact",compactDisplay:"short",maximumFractionDigits:1}).format(n).replace(/^/,`${t} `)},o7e=e=>{switch(e){case"Negotiation":return{text:"text-purple-700",bg:"bg-purple-100"};case"Proposal":return{text:"text-red-700",bg:"bg-red-100"};case"Qualification":return{text:"text-yellow-700",bg:"bg-yellow-100"};case"Prospecting":return{text:"text-blue-700",bg:"bg-blue-100"};case"Closed Won":return{text:"text-green-700",bg:"bg-green-100"};case"Closed Lost":return{text:"text-red-700",bg:"bg-red-100"};default:return{text:"text-gray-700",bg:"bg-gray-100"}}},l7e=e=>{switch(e){case"Website":return{text:"text-green-600",bg:"bg-green-100"};case"Referral":return{text:"text-purple-600",bg:"bg-purple-100"};case"Trade Show":return{text:"text-orange-600",bg:"bg-orange-100"};case"Cold Call":return{text:"text-red-600",bg:"bg-red-100"};default:return{text:"text-gray-600",bg:"bg-gray-100"}}},c7e=e=>{switch(e){case"call":return{Icon:XUe,color:"text-red-500",bgColor:"bg-red-100"};case"qualification":return{Icon:ZUe,color:"text-green-600",bgColor:"bg-green-100"};default:return{Icon:KUe,color:"text-blue-500",bgColor:"bg-blue-100"}}},d7e=e=>{switch(e.toUpperCase()){case"HIGH":return{text:"text-red-700",bg:"bg-red-100"};case"LOW":return{text:"text-blue-700",bg:"bg-blue-100"};default:return{text:"text-gray-700",bg:"bg-gray-100"}}},u7e=({searchQuery:e,onSearchChange:t,searchResults:n,onSearchResultClick:s})=>{const r=Et(),[i,o]=f.useState(!1),l=f.useRef(null),c=[{icon:VUe,label:"Account"},{icon:SJ,label:"Contact"},{icon:e7e,label:"Leads"},{icon:_J,label:"Deals"},{icon:t7e,label:"Quotes"},{icon:AJ,label:"Target"},{icon:a7e,label:"Task"},{icon:n7e,label:"Meeting"},{icon:s7e,label:"Call"},{icon:i7e,label:"Audit"},{icon:r7e,label:"Territory"}];f.useEffect(()=>{const h=p=>{l.current&&!l.current.contains(p.target)&&o(!1)};return document.addEventListener("mousedown",h),()=>document.removeEventListener("mousedown",h)},[]);const u=h=>{t(h.target.value),o(h.target.value.trim().length>0)},d=h=>{s&&s(h),o(!1)};return a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-3 sm:p-4 flex flex-col items-start space-y-4 w-full",children:[a.jsxs("div",{className:"w-full flex justify-center relative",ref:l,children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg lg:mt-3 px-4 py-2 w-full max-w-md md:max-w-lg lg:max-w-2xl focus-within:ring-2 focus-within:ring-blue-500 transition duration-150",children:[a.jsx(WUe,{size:20,className:"text-gray-400 mr-3 flex-shrink-0"}),a.jsx("input",{type:"text",placeholder:"Search Leads, Deals, or Accounts...",className:"focus:outline-none text-base w-full",value:e,onChange:u,onFocus:()=>e.trim().length>0&&o(!0)})]}),i&&Array.isArray(n)&&n.length>0&&a.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 mt-2 w-full max-w-md md:max-w-lg lg:max-w-2xl bg-white rounded-lg shadow-xl border border-gray-200 z-50 max-h-96 overflow-y-auto",children:n.map((h,p)=>a.jsx("div",{className:"px-4 py-3 hover:bg-gray-50 cursor-pointer border-b border-gray-100 last:border-b-0 transition duration-150",onClick:()=>d(h),children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-semibold text-gray-800 text-sm",children:h.name}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:h.type}),h.details&&a.jsx("p",{className:"text-xs text-gray-400 mt-1",children:h.details})]}),a.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${h.type==="Lead"?"bg-blue-100 text-blue-600":h.type==="Deal"?"bg-yellow-100 text-yellow-600":"bg-green-100 text-green-600"}`,children:h.type})]})},p))}),i&&e.trim().length>0&&(!Array.isArray(n)||n.length===0)&&a.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 mt-2 w-full max-w-md md:max-w-lg lg:max-w-2xl bg-white rounded-lg shadow-xl border border-gray-200 z-50 p-4 text-center text-sm text-gray-500",children:"No results found"})]}),a.jsx("div",{className:"w-full overflow-x-auto lg:overflow-x-hidden scroll-smooth flex justify-center",children:a.jsx("div",{className:"flex flex-nowrap space-x-3 lg:space-x-4 xl:space-x-3 px-2 sm:px-0",children:c.map((h,p)=>a.jsxs("div",{className:"relative flex-shrink-0 group",children:[a.jsx("button",{className:"p-3 text-gray-500 hover:text-gray-900 transition duration-150 rounded-full hover:bg-gray-100 focus:outline-none cursor-pointer","aria-label":h.label,title:h.label,onClick:()=>{switch(h.label){case"Account":r("/manager/accounts");break;case"Contact":r("/manager/contacts");break;case"Leads":r("/manager/leads");break;case"Deals":r("/manager/deals");break;case"Quotes":r("/manager/quotes");break;case"Target":r("/manager/targets");break;case"Task":r("/manager/tasks");break;case"Meeting":r("/manager/meetings");break;case"Call":r("/manager/calls");break;case"Audit":r("/manager/audit");break;case"Territory":r("/manager/territory");break;default:console.log(`Clicked ${h.label}`)}},children:a.jsx(h.icon,{size:24,className:"lg:scale-95"})}),a.jsxs("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 px-3 py-1.5 bg-gray-900 text-white text-xs font-semibold rounded-md whitespace-nowrap opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-75 ease-in-out z-50 shadow-lg",children:[h.label,a.jsx("div",{className:"absolute top-full left-1/2 -translate-x-1/2 -mt-1 border-4 border-transparent border-t-gray-900"})]})]},p))})})]})},m7e=({action:e,description:t,entity_type:n,entity_name:s,timestamp:r})=>{const i=Et(),o=d=>{if(!d)return"Unknown";const h=new Date(d),x=new Date-h,b=Math.floor(x/6e4),j=Math.floor(x/36e5),y=Math.floor(x/864e5);return b<1?"Just now":b<60?`${b} min ago`:j<24?`${j} hour${j>1?"s":""} ago`:y<7?`${y} day${y>1?"s":""} ago`:h.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},l=e||t||"Action",c=s||n||"System",u=o(r);return a.jsxs("li",{className:"flex justify-between items-center py-2 border-b border-gray-100 last:border-b-0 cursor-pointer hover:bg-gray-50 transition duration-150 px-2 -mx-2 rounded-md",onClick:()=>i("/manager/audit"),children:[a.jsxs("p",{className:"text-sm text-gray-800 flex-grow font-medium",children:[l," ",a.jsxs("span",{className:"text-gray-500 italic text-xs",children:["(",c,")"]})]}),a.jsx("span",{className:"text-xs text-gray-400 flex-shrink-0 ml-4",children:u})]})},f7e=({logs:e,loading:t})=>{const n=Et();return a.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg border border-gray-100 flex flex-col h-full",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h2",{className:"text-md font-semibold text-gray-800",children:"Recent Logs"}),a.jsxs("span",{className:"text-sm text-blue-500 cursor-pointer hover:underline flex items-center space-x-1 font-medium",onClick:()=>n("/manager/audit"),children:[a.jsx("span",{children:"See All"}),a.jsx(CJ,{size:14,className:"transform -rotate-45"})]})]}),e&&e.length>0?a.jsx("ul",{className:"space-y-1",children:e.slice(0,3).map((s,r)=>a.jsx(m7e,{...s},r))}):a.jsx("div",{className:"text-sm text-gray-500 py-4",children:"No recent logs"})]})},h7e=({icon:e,title:t,value:n,color:s,bgColor:r,loading:i,onClick:o})=>a.jsxs("div",{className:"flex items-center p-4 bg-white rounded-xl shadow-md border border-gray-200 transition-all duration-300",onClick:o||(()=>console.log(`Clicked metric card: ${t}`)),children:[a.jsx("div",{className:`p-3 rounded-full ${r} ${s} mr-4`,children:a.jsx(e,{size:20})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-500 font-medium uppercase",children:t}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:n||0})]})]}),g7e=({revenueData:e,loading:t})=>{const n=Et(),s=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],r=f.useMemo(()=>{if(console.log("=== RevenueChart calculateRevenueData ==="),console.log("revenueData:",e),console.log("revenueData length:",e?.length),!e||e.length===0){console.log("No revenue data, returning empty chart");const y=new Date;y.getFullYear();const N=y.getMonth(),w=[],S=[];for(let _=0;_<=N;_++)w.push(s[_]),S.push(0);return{labels:w,revenues:S,maxRevenue:0}}const l={};let c=0,u=0;console.log("Processing deals:",e.length),e.forEach((y,N)=>{const w=y.close_date||y.closeDate||null,S=w&&w!==null&&w!=="",_=y.stage||"",T=_.toUpperCase()==="CLOSED_WON"||_==="CLOSED_WON";let k=y.amount;k&&typeof k=="object"&&k.toString?k=parseFloat(k.toString()):k=parseFloat(k)||0;const A=k>0;if(T&&(u++,console.log(`Deal ${N+1} (CLOSED_WON):`,{id:y.id,name:y.name,stage:_,close_date:w,close_date_type:typeof w,amount:k,amount_type:typeof y.amount,hasCloseDate:S,hasAmount:A,willBeAdded:S&&A,allFields:Object.keys(y)})),S&&T&&A)try{let E=new Date(w);if(isNaN(E.getTime())){const M=String(w).split("T")[0];E=new Date(M+"T00:00:00")}if(isNaN(E.getTime()))console.warn(` Invalid date for deal ${y.id}:`,w,"Type:",typeof w);else{const M=E.getFullYear(),F=E.getMonth()+1,D=`${M}-${String(F).padStart(2,"0")}`;l[D]||(l[D]=0),l[D]+=k,c++,console.log(` Added deal ${y.id} to month ${D}: ${k}, total: ${l[D]}`),console.log(`  - Close date: ${w} -> Parsed: ${E.toISOString()} -> Month: ${D} (Year: ${M}, Month: ${F})`)}}catch(E){console.error("Error parsing deal date:",w,E)}else T&&console.warn(` Deal ${y.id} is CLOSED_WON but missing data:`,{hasCloseDate:S,hasAmount:A,closeDate:w,amount:k,originalAmount:y.amount})}),console.log("Summary:",{totalDeals:e.length,closedWonDeals:u,validDealsForGraph:c,monthlyRevenue:l});const d=Object.keys(l).map(y=>parseInt(y.split("-")[0])),h=d.length>0?[...new Set(d)].sort():[],p=new Date().getFullYear();new Date().getMonth();const x=[],b=[];for(let y=0;y<12;y++){const N=`${p}-${String(y+1).padStart(2,"0")}`;x.push(s[y]);const w=l[N]||0;b.push(w),w>0&&console.log(`Month ${s[y]} (${N}): ${w}`)}if(h.length>0){const y=Math.max(...h);if(y>p)for(let N=p+1;N<=y;N++)for(let w=0;w<12;w++){const S=`${N}-${String(w+1).padStart(2,"0")}`,_=l[S]||0;x.push(`${s[w]} ${N}`),b.push(_),_>0&&console.log(`Month ${s[w]} ${N} (${S}): ${_}`)}}const j=Math.max(...b,1);return console.log("Final chart data:",{labels:x,revenues:b,maxRevenue:j,hasData:b.some(y=>y>0)}),{labels:x,revenues:b,maxRevenue:j}},[e]),i=r.labels,o=r.revenues;return console.log("=== FINAL CHART DATA ==="),console.log("X Axis (Months):",i),console.log("Y Axis (Revenue):",o),console.log("Has any revenue > 0:",o.some(l=>l>0)),console.log("All revenue values:",o),console.log("Max revenue:",r.maxRevenue),a.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg h-full flex flex-col",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Revenue Overview"}),a.jsxs("span",{className:"text-sm text-blue-500 cursor-pointer hover:underline flex items-center space-x-1 font-medium",onClick:()=>n("/manager/deals"),children:[a.jsx("span",{children:"See All"}),a.jsx(CJ,{size:14,className:"transform -rotate-45"})]})]}),a.jsx("div",{className:"h-80 relative flex-1 flex items-center justify-center p-6",children:a.jsx("div",{className:"w-full h-full flex items-center justify-center",children:i&&i.length>0&&o&&o.length>0?a.jsx(mh,{xAxis:[{data:i,scaleType:"point"}],yAxis:[{valueFormatter:l=>l>=1e3?`${(l/1e3).toFixed(0)}k`:l.toString()}],series:[{data:o,showMark:!0,area:!0}],height:320,width:void 0,grid:{vertical:!0,horizontal:!0},margin:{top:40,right:40,bottom:50,left:50},sx:{width:"100%",maxWidth:"100%"}}):a.jsxs("div",{className:"text-center text-gray-500",children:[a.jsx("p",{className:"text-sm",children:"No revenue data available"}),a.jsx("p",{className:"text-xs mt-2",children:"Closed won deals with close dates will appear here"})]})})})]})},tT=({title:e,items:t,children:n,onSeeAll:s})=>{const r=Et(),i=()=>{if(s)s();else{const o={"Latest Leads":"/manager/leads","Latest Deals":"/manager/deals","Upcoming Activities":"/manager/tasks"};o[e]&&r(o[e])}};return a.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg flex flex-col",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:e}),a.jsx("span",{className:"text-sm text-blue-500 cursor-pointer hover:underline",onClick:i,children:"See All"})]}),n]})},p7e=({first_name:e,last_name:t,company_name:n,source:s,created_at:r,id:i})=>{const o=Et(),{text:l,bg:c}=l7e(s||"Website"),u=x=>{if(!x)return"Unknown";const b=new Date(x),y=new Date-b,N=Math.floor(y/6e4),w=Math.floor(y/36e5),S=Math.floor(y/864e5);return N<60?`${N} min ago`:w<24?b.toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}):S<7?b.toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}):b.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})},d=`${e||""} ${t||""}`.trim()||"Unknown",h=n||"Unknown Company",p=u(r);return a.jsx("div",{className:"py-3 border-b border-gray-100 last:border-b-0 cursor-pointer hover:bg-gray-50 transition duration-150 px-2 -mx-2 rounded-md",onClick:()=>i&&o(`/manager/leads/${i}`),children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-gray-800",children:d}),a.jsx("p",{className:"text-xs text-gray-500",children:h})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"text-xs text-gray-400",children:p}),a.jsx("span",{className:`inline-block mt-1 text-xs font-medium ${l} ${c} px-2 py-0.5 rounded-full`,children:s||"Website"})]})]})})},x7e=({name:e,amount:t,account:n,stage:s,created_at:r,id:i,previousAmount:o,currencySymbol:l})=>{const c=Et(),d={PROSPECTING:"Prospecting",QUALIFICATION:"Qualification",PROPOSAL:"Proposal",NEGOTIATION:"Negotiation",CLOSED_WON:"Closed Won",CLOSED_LOST:"Closed Lost"}[s]||s||"Unknown",{text:h,bg:p}=o7e(d),x=parseFloat(t||0),b=o?x>=o?"up":"down":"up",j=b==="up"?YUe:QUe,y=b==="up"?"text-green-400":"text-red-400",N=n?.name||"Unknown Company";return a.jsx("div",{className:"py-3 border-b border-gray-100 last:border-b-0 cursor-pointer hover:bg-gray-50 transition duration-150 px-2 -mx-2 rounded-md",onClick:()=>i&&c(`/manager/deals/info?id=${i}`),children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{className:"flex-shrink",children:[a.jsx("p",{className:"font-semibold text-sm text-gray-900",children:e||"Unnamed Deal"}),a.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:N}),a.jsx("span",{className:`inline-block mt-1 text-xs font-medium ${h} ${p} px-2 py-0.5 rounded-full`,children:d})]}),a.jsxs("div",{className:"text-right flex flex-col items-end flex-shrink-0",children:[a.jsx("p",{className:"text-md font-bold text-gray-800",children:TJ(x,l)}),a.jsx(j,{size:16,className:`${y} mt-1`})]})]})})},y7e=({type:e,title:t,assignedTo:n,dueDate:s,scheduledDate:r,priority:i,id:o,activityType:l,fullData:c})=>{const u=Et(),h=l||{Call:"call",Meeting:"meeting",Task:"qualification"}[e]||"meeting",{Icon:p,color:x,bgColor:b}=c7e(h),{text:j,bg:y}=d7e(i||"MEDIUM"),S=(k=>{if(!k)return"No date set";const A=new Date(k),M=A-new Date,F=Math.floor(M/864e5);return F===0?`Today, ${A.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}`:F===1?`Tomorrow, ${A.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}`:F===-1?`Yesterday, ${A.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}`:A.toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})})(s||r),_=n||"Unassigned",T=()=>{o&&(c?h==="call"?(sessionStorage.setItem("callDetailData",JSON.stringify(c)),u(`/manager/calls/info?id=${o}`)):h==="meeting"?(sessionStorage.setItem("meetingDetailData",JSON.stringify(c)),u(`/manager/meetings/info?id=${o}`)):u("/manager/tasks"):u(h==="call"?`/manager/calls/info?id=${o}`:h==="meeting"?`/manager/meetings/info?id=${o}`:"/manager/tasks"))};return a.jsxs("div",{className:"flex items-start py-3 border-b border-gray-100 last:border-b-0 cursor-pointer hover:bg-gray-50 transition duration-150 px-2 -mx-2 rounded-md",onClick:T,children:[a.jsx("div",{className:`p-2 rounded-lg ${b} mr-3 flex-shrink-0 mt-1`,children:a.jsx(p,{size:20,className:`${x}`})}),a.jsxs("div",{className:"flex-grow",children:[a.jsxs("p",{className:"font-medium text-gray-800 flex items-center mb-1",children:[a.jsx("span",{className:"text-xl leading-none mr-2",children:""}),t||"Untitled Activity"]}),a.jsxs("div",{className:"space-y-1 text-xs text-gray-500",children:[a.jsxs("p",{className:"flex items-center",children:[a.jsx(NJ,{size:14,className:"mr-1.5 text-gray-400"}),S]}),a.jsxs("p",{className:"flex items-center",children:[a.jsx(SJ,{size:14,className:"mr-1.5 text-gray-400"}),"Assigned to: ",_]})]})]}),a.jsx("span",{className:`inline-block text-xs font-medium ${j} ${y} px-2 py-0.5 rounded-full flex-shrink-0 self-center ml-4`,children:(i||"MEDIUM").toUpperCase()})]})},b7e=()=>{const e=Et(),{user:t}=Gt(),n=t?.company?.currency||"",[s,r]=f.useState({activeLeads:0,totalDeals:0,activeAccounts:0,overdueTasks:0}),[i,o]=f.useState([]),[l,c]=f.useState([]),[u,d]=f.useState([]),[h,p]=f.useState([]),[x,b]=f.useState([]),[j,y]=f.useState([]),[N,w]=f.useState(!0),[S,_]=f.useState(null),[T,k]=f.useState(""),[A,E]=f.useState([]),[M,F]=f.useState([]),[D,P]=f.useState([]),[B,G]=f.useState([]),[$,W]=f.useState(0),[Z,Q]=f.useState(new Date),le=f.useRef(null),we=f.useRef(null),J=f.useMemo(()=>{try{if(!T.trim())return[];const ge=T.toLowerCase().trim(),be=[];return Array.isArray(A)&&A.forEach(me=>{const Ae=`${me.first_name||""} ${me.last_name||""}`.trim().toLowerCase(),pe=(me.company_name||"").toLowerCase(),Ie=(me.email||"").toLowerCase(),xe=(me.phone||"").toLowerCase();(Ae.includes(ge)||pe.includes(ge)||Ie.includes(ge)||xe.includes(ge))&&be.push({id:me.id,name:`${me.first_name||""} ${me.last_name||""}`.trim()||"Unnamed Lead",type:"Lead",details:me.company_name||"No company",route:`/manager/leads/${me.id}`})}),Array.isArray(M)&&M.forEach(me=>{const Ae=(me.name||"").toLowerCase(),pe=(me.account?.name||"").toLowerCase(),Ie=(me.description||"").toLowerCase();(Ae.includes(ge)||pe.includes(ge)||Ie.includes(ge))&&be.push({id:me.id,name:me.name||"Unnamed Deal",type:"Deal",details:me.account?.name||"No account",route:`/manager/deals/info?id=${me.id}`})}),Array.isArray(D)&&D.forEach(me=>{const Ae=(me.name||"").toLowerCase(),pe=(me.email||"").toLowerCase(),Ie=(me.phone||"").toLowerCase(),xe=(me.website||"").toLowerCase();(Ae.includes(ge)||pe.includes(ge)||Ie.includes(ge)||xe.includes(ge))&&be.push({id:me.id,name:me.name||"Unnamed Account",type:"Account",details:me.email||me.phone||"No contact info",route:"/manager/accounts"})}),be.slice(0,10)}catch(ge){return console.error("Error in search:",ge),[]}},[T,A,M,D]),se=ge=>{ge.route&&(e(ge.route),k(""))},ye=f.useCallback(async()=>{w(!0),_(null);try{const[ge,be,me,Ae,pe,Ie,xe,he]=await Promise.all([ne.get("/leads/admin/getLeads").catch(re=>(console.error("Error fetching leads:",re),{data:[]})),ne.get("/deals/admin/fetch-all").catch(re=>(console.error("Error fetching deals:",re),{data:[]})),ne.get("/accounts/admin/fetch-all").catch(re=>(console.error("Error fetching accounts:",re),{data:[]})),ne.get("/tasks/all").catch(re=>(console.error("Error fetching tasks:",re),{data:[]})),ne.get("/meetings/admin/fetch-all").catch(re=>(console.error("Error fetching meetings:",re),{data:[]})),ne.get("/calls/admin/fetch-all").catch(re=>(console.error("Error fetching calls:",re),{data:[]})),ne.get("/logs/read-all").catch(re=>(console.error("Error fetching logs:",re),{data:[]})),ne.get("/targets/admin/fetch-all").catch(re=>(console.error("Error fetching targets:",re),{data:[]}))]),Re=Array.isArray(ge.data)?ge.data:[],Ee=Array.isArray(be.data)?be.data:[],He=Array.isArray(me.data)?me.data:[],Ke=Array.isArray(Ae.data)?Ae.data:[],st=Array.isArray(pe.data)?pe.data:[],it=Array.isArray(Ie.data)?Ie.data:[],ot=Array.isArray(xe.data)?xe.data:[],rt=Array.isArray(he.data)?he.data:[];console.log("=== RAW DEALS API RESPONSE ==="),console.log("Deals count:",Ee.length),Ee.length>0&&(console.log("First deal sample (raw):",JSON.stringify(Ee[0],null,2)),console.log("First deal keys:",Object.keys(Ee[0]))),E(Re),F(Ee),P(He),G(rt);const at=rt.reduce((re,Le)=>{const De=Le.amount||Le.value||Le.target_amount||0,Qe=parseFloat(typeof De=="string"?De.replace(/[^\d.-]/g,""):De);return re+(Number.isFinite(Qe)?Qe:0)},0);W(at);const Je=Re.filter(re=>re.status&&!["Lost","Converted"].includes(re.status)).length,Fe=Ke.filter(re=>!re.dueDate||re.status==="Completed"?!1:new Date(re.dueDate)<new Date).length;r({activeLeads:Je,totalDeals:Ee.length,activeAccounts:He.length,overdueTasks:Fe});const Ue=[...Re].sort((re,Le)=>new Date(Le.created_at||0)-new Date(re.created_at||0)).slice(0,5);o(Ue);const Ne=[...Ee].sort((re,Le)=>new Date(Le.created_at||0)-new Date(re.created_at||0)).slice(0,5);c(Ne);const ze=new Date,je=[];it.forEach(re=>{const Le=re.due_date||re.call_time,De=(re.status||"").toUpperCase();if(Le){const Qe=new Date(Le);De==="COMPLETED"||De==="MISSED"||De==="NOT_HELD"||De==="HELD"||je.push({type:"Call",title:re.subject||"Untitled Call",assignedTo:re.assigned_to||(re.call_assign_to?`${re.call_assign_to.first_name||""} ${re.call_assign_to.last_name||""}`.trim():"Unassigned"),scheduledDate:Le,priority:(re.priority||"MEDIUM").toUpperCase(),id:re.id,activityType:"call",fullData:re})}}),st.forEach(re=>{const Le=re.dueDate||re.start_time,De=(re.status||"").toUpperCase();if(Le){const Qe=new Date(Le);De==="COMPLETED"||De==="CANCELLED"||De==="DONE"||je.push({type:"Meeting",title:re.subject||re.activity||"Untitled Meeting",assignedTo:re.assignedTo||(re.meet_assign_to?`${re.meet_assign_to.first_name||""} ${re.meet_assign_to.last_name||""}`.trim():"Unassigned"),scheduledDate:Le,priority:(re.priority||"MEDIUM").toUpperCase(),id:re.id,activityType:"meeting",fullData:re})}});const ve={HIGH:1,MEDIUM:2,LOW:3},z=je.sort((re,Le)=>{const De=ve[re.priority]||3,Qe=ve[Le.priority]||3;if(De!==Qe)return De-Qe;const tt=new Date(re.scheduledDate||0),Me=new Date(Le.scheduledDate||0);return tt-Me}).slice(0,5);d(z),p(Ee),console.log("=== ALL DEALS DATA ==="),console.log("Total deals:",Ee.length);const K=Ee.filter(re=>(re.stage||"").toUpperCase()==="CLOSED_WON");console.log("CLOSED_WON deals:",K.length),K.length>0?(console.log("=== CLOSED_WON DEALS DETAILS ==="),K.forEach((re,Le)=>{let De=re.amount;De&&typeof De=="object"?De.toString?De=parseFloat(De.toString()):De=parseFloat(De):De=parseFloat(De)||0,console.log(`Deal ${Le+1}:`,{id:re.id,name:re.name,stage:re.stage,stage_upper:(re.stage||"").toUpperCase(),amount:re.amount,amount_parsed:De,amount_type:typeof re.amount,close_date:re.close_date,close_date_type:typeof re.close_date,close_date_value:re.close_date?new Date(re.close_date):null,has_close_date:!!re.close_date,has_amount:De>0,all_keys:Object.keys(re),full_deal:re})})):(console.log(" No CLOSED_WON deals found!"),console.log("All deal stages:",Ee.map(re=>re.stage))),y(Ee);const ue=[...ot].sort((re,Le)=>new Date(Le.timestamp||0)-new Date(re.timestamp||0));b(ue)}catch(ge){console.error("Error fetching dashboard data:",ge),_("Failed to load dashboard data. Please refresh the page.")}finally{w(!1)}},[]);f.useEffect(()=>(document.title="Dashboard | Sari-Sari CRM",console.log("ManagerDashboard mounted, fetching data..."),ye(),le.current=setInterval(()=>{console.log("Auto-refreshing dashboard data..."),ye(),Q(new Date)},3e4),()=>{le.current&&clearInterval(le.current)}),[ye]),f.useEffect(()=>{if(!t||!t.id)return;let ge=0;const be=3;let me=null;const Ae=()=>{const pe=window.location.protocol==="https:"?"wss:":"ws:",Ie=window.location.hostname==="localhost"?"localhost:8000":window.location.host,xe=`${pe}//${Ie}/ws/notifications?user_id=${t.id}`;try{const he=new WebSocket(xe);we.current=he,he.onopen=()=>{console.log(" WebSocket connected for dashboard updates"),ge=0},he.onmessage=Re=>{try{const Ee=JSON.parse(Re.data);console.log(" Real-time notification received:",Ee),Ee.event&&["new_task","task_updated","new_lead","lead_updated","new_deal","deal_updated","new_account","account_updated","new_meeting","meeting_updated","new_call","call_updated"].includes(Ee.event)&&(console.log(" Refreshing dashboard due to:",Ee.event),ye(),Q(new Date))}catch(Ee){console.error("Error parsing WebSocket message:",Ee)}},he.onerror=Re=>{ge===0&&console.warn(" WebSocket connection unavailable (this is optional)")},he.onclose=()=>{ge<be&&(ge++,me=setTimeout(()=>{t&&t.id&&Ae()},5e3))}}catch{console.warn(" WebSocket not available (optional feature)")}};return Ae(),()=>{me&&clearTimeout(me),we.current&&(we.current.close(),we.current=null)}},[t,ye]);const Ce=[{icon:JUe,title:"Active Leads",value:s.activeLeads,color:"text-blue-600",bgColor:"bg-blue-50",onClick:()=>e("/manager/leads")},{icon:AJ,title:"Total Targets",value:TJ($,n),color:"text-purple-600",bgColor:"bg-purple-50",onClick:()=>e("/manager/targets")},{icon:_J,title:"Total Deals",value:s.totalDeals,color:"text-yellow-600",bgColor:"bg-yellow-50",onClick:()=>e("/manager/deals")},{icon:NJ,title:"Overdue Tasks",value:s.overdueTasks,color:"text-red-600",bgColor:"bg-red-50",onClick:()=>e("/manager/tasks")}];return console.log("ManagerDashboard rendering, loading:",N,"error:",S),a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative w-full",children:[N&&a.jsx(qt,{}),a.jsxs("div",{className:"max-w-screen-2xl mx-auto",children:[S&&a.jsx("div",{className:"mb-6 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:a.jsx("p",{className:"font-medium",children:S})}),a.jsx("div",{className:"mb-8",children:a.jsx(u7e,{searchQuery:T,onSearchChange:k,searchResults:J,onSearchResultClick:se})}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-4 mb-8",children:Ce.map(ge=>a.jsx(h7e,{...ge,loading:N},ge.title))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[a.jsx(f7e,{logs:x,loading:N}),a.jsx(wD,{currencySymbol:n})]}),a.jsx("div",{className:"mb-8",children:a.jsx(IN,{leads:A,deals:M,targets:B,currencySymbol:n,basePath:"/manager"})}),a.jsx("div",{className:"grid grid-cols-1 mb-8",children:a.jsx(g7e,{revenueData:j,loading:N})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[a.jsx(tT,{title:"Latest Leads",children:i.length>0?i.map((ge,be)=>a.jsx(p7e,{...ge},ge.id||be)):a.jsx("div",{className:"text-sm text-gray-500 py-4 text-center",children:"No leads found"})}),a.jsx(tT,{title:"Latest Deals",children:N?a.jsxs("div",{className:"flex flex-col items-center justify-center py-8",children:[a.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-500 mb-2"}),a.jsx("div",{className:"text-sm text-gray-500",children:"Loading deals..."})]}):l.length>0?l.map((ge,be)=>a.jsx(x7e,{...ge,currencySymbol:n},ge.id||be)):a.jsx("div",{className:"text-sm text-gray-500 py-4 text-center",children:"No deals found"})}),a.jsx(tT,{title:"Upcoming Activities",children:u.length>0?u.map((ge,be)=>a.jsx(y7e,{...ge},ge.id||be)):a.jsx("div",{className:"text-sm text-gray-500 py-4 text-center",children:"No upcoming activities"})})]})]})]})},aT=[{value:"CUSTOMER",label:"Customer"},{value:"PROSPECT",label:"Prospect"},{value:"PARTNER",label:"Partner"},{value:"ACTIVE",label:"Vendor"},{value:"INACTIVE",label:"Inactive"},{value:"FORMER",label:"Delete"}],Pb={name:"",website:"",phone_number:"",billing_address:"",shipping_address:"",industry:"",parent_company:"",status:"PROSPECT",territory_id:"",assigned_to:""},cr=e=>e?e.toUpperCase():"",nT=e=>e?e.toString().toLowerCase().replace(/\b\w/g,t=>t.toUpperCase()):"--",v7e=e=>{switch(cr(e)){case"CUSTOMER":return"bg-green-600 text-white";case"PROSPECT":return"bg-purple-600 text-white";case"PARTNER":return"bg-pink-600 text-white";case"ACTIVE":return"bg-blue-600 text-white";case"INACTIVE":return"bg-gray-600 text-white";case"FORMER":return"bg-orange-600 text-white";default:return"bg-gray-500 text-white"}},w7e=e=>{switch(cr(e)){case"CUSTOMER":return"bg-green-100 text-green-700";case"PROSPECT":return"bg-purple-100 text-purple-700";case"PARTNER":return"bg-pink-100 text-pink-700";case"ACTIVE":return"bg-blue-100 text-blue-700";case"INACTIVE":return"bg-gray-200 text-gray-700";case"FORMER":return"bg-orange-100 text-orange-700";default:return"bg-gray-100 text-gray-700"}};function j7e(){const e=Et(),t=ta(),{user:n}=Gt();f.useEffect(()=>{document.title="Accounts | Sari-Sari CRM"},[]);const[s,r]=f.useState(!1),[i,o]=f.useState(!1),[l,c]=f.useState(!1),[u,d]=f.useState(null),[h,p]=f.useState(null),[x,b]=f.useState(Pb),[j,y]=f.useState(null),[N,w]=f.useState([]),[S,_]=f.useState(!1),[T,k]=f.useState([]),[A,E]=f.useState(null),[M,F]=f.useState([]),[D,P]=f.useState([]),[B,G]=f.useState("Filter by Status"),[$,W]=f.useState(""),[Z,Q]=f.useState(null),[le,we]=f.useState(!1),[J,se]=f.useState(1),[ye,Ce]=f.useState(10),[ge,be]=f.useState("Overview"),[me,Ae]=f.useState(""),[pe,Ie]=f.useState(!1),[xe,he]=f.useState({}),[Re,Ee]=f.useState(null),[He,Ke]=f.useState(new Set),[st,it]=f.useState(!1),{comments:ot,addComment:rt,refresh:at}=kn({relatedType:"account",relatedId:j?.id});f.useEffect(()=>{j?.id&&at()},[j?.id,at]);const Je=f.useCallback(async(L=null)=>{_(!0);try{const ee=await ne.get("/accounts/admin/fetch-all"),$e=[...Array.isArray(ee.data)?ee.data:[]].sort((We,mt)=>{const Tt=We?.created_at||We?.updated_at||0,kt=mt?.created_at||mt?.updated_at||0;return new Date(kt)-new Date(Tt)});if(w($e),L){const We=$e.find(mt=>mt.id===L);y(We||null)}}catch(ee){console.error(ee),w([]),ee.response?.status===403?V.error("Permission denied. Only CEO, Admin, or Group Manager can access this page."):V.error("Failed to fetch accounts. Please try again later.")}finally{_(!1)}},[y]),Fe=f.useCallback(async()=>{try{const L=await ne.get("/users/all");k(Array.isArray(L.data)?L.data:[])}catch(L){console.error(L),L.response?.status===403&&V.warn("Unable to load users for assignment (permission denied).")}},[]),Ue=f.useCallback(async()=>{try{const L=await ne.get("/territories/fetch");F(Array.isArray(L.data)?L.data:[])}catch(L){console.error(L),L.response?.status===403&&V.warn("Unable to load territories (permission denied).")}},[]),Ne=f.useCallback(async()=>{try{const L=await ne.get("/accounts/admin/parent-companies");P(Array.isArray(L.data)?L.data:[])}catch(L){console.error(L),L.response?.status===403&&V.warn("Unable to load parent companies (permission denied).")}},[]),ze=f.useCallback(async L=>{try{const ee=await ne.get(`/activities/accounts/${L}`);he(ee.data&&typeof ee.data=="object"?ee.data:{})}catch(ee){console.error(ee),ee.response?.status===404&&(console.warn("No activities found for this account."),he({}))}},[]);f.useEffect(()=>{Je(),Fe(),Ue(),Ne()},[Je,Fe,Ue,Ne]),f.useEffect(()=>{j&&Ae(cr(j.status)||"PROSPECT")},[j]);const je=N.length,ve=f.useMemo(()=>N.filter(L=>L.status?.toLowerCase()==="customer").length,[N]),z=f.useMemo(()=>N.filter(L=>L.status?.toLowerCase()==="prospect").length,[N]),K=f.useMemo(()=>N.filter(L=>L.status?.toLowerCase()==="partner").length,[N]),ue=f.useMemo(()=>N.filter(L=>L.status?.toLowerCase()==="active").length,[N]),re=f.useMemo(()=>N.filter(L=>L.status?.toLowerCase()==="inactive").length,[N]),Le=f.useMemo(()=>N.filter(L=>L.status?.toLowerCase()==="former").length,[N]),De=f.useMemo(()=>[{title:"Total",value:je,icon:Xa,color:"text-slate-600",bgColor:"bg-slate-100"},{title:"Customers",value:ve,icon:Qi,color:"text-green-600",bgColor:"bg-green-100"},{title:"Prospects",value:z,icon:rn,color:"text-purple-600",bgColor:"bg-purple-100"},{title:"Partners",value:K,icon:ra,color:"text-pink-600",bgColor:"bg-pink-100"},{title:"Active",value:ue,icon:Qi,color:"text-blue-600",bgColor:"bg-blue-100"},{title:"Inactive",value:re,icon:Ki,color:"text-gray-600",bgColor:"bg-gray-100"},{title:"Former",value:Le,icon:Ki,color:"text-orange-600",bgColor:"bg-orange-100"}],[je,ve,z,K,ue,re,Le]),Qe=f.useMemo(()=>{const L=$.trim().toLowerCase(),ee=B.trim().toUpperCase();return N.filter(ke=>{const $e=[ke?.name,ke?.website,ke?.industry,ke?.territory?.name,ke?.phone_number],We=L===""||$e.some(Yt=>Yt==null?!1:Yt.toString().toLowerCase().includes(L)),mt=ee==="FILTER BY STATUS"||cr(ke.status)===ee,kt=cr(ke.status)==="INACTIVE"&&ee!=="INACTIVE";return We&&mt&&!kt})},[N,$,B]),tt=Math.max(1,Math.ceil(Qe.length/ye)||1);f.useEffect(()=>{se(1)},[$,B]),f.useEffect(()=>{se(L=>{const ee=Math.max(1,Math.ceil(Qe.length/ye)||1);return L>ee?ee:L})},[Qe.length]);const Me=f.useMemo(()=>{const L=(J-1)*ye;return Qe.slice(L,L+ye)},[Qe,J]);Qe.length===0||(J-1)*ye+1,Math.min(J*ye,Qe.length);const et=()=>se(L=>Math.max(L-1,1)),yt=()=>se(L=>Math.min(L+1,tt)),_t=L=>{y(L),be("Overview"),Ae(cr(L?.status)||"PROSPECT")},Ct=()=>y(null),jt=L=>{L.target.id==="accountModalBackdrop"&&!le&&Ct()},At=()=>{r(!1),o(!1),p(null),b(Pb),c(!1),E(null)},Ge=L=>{L.target.id==="modalBackdrop"&&At()},Be=L=>L?new Date(L).toLocaleString("en-US",{month:"short",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).replace(",",""):"",ce=L=>{const{name:ee,value:ke}=L.target;b($e=>({...$e,[ee]:ke}))},fe=()=>{b(Pb),o(!1),p(null),r(!0)};f.useEffect(()=>{const L=new URLSearchParams(t.search||"");(t.state?.openAccountModal||L.get("openModal")==="1")&&(b(Pb),o(!1),p(null),r(!0),X(!1),e(t.pathname,{replace:!0,state:{}}))},[t.state,t.pathname,t.search,e]);const H=L=>{y(null),L.assigned_accs?E(L.assigned_accs):E(null),b({name:L.name||"",website:L.website||"",phone_number:L.phone_number||"",billing_address:L.billing_address||"",shipping_address:L.shipping_address||"",parent_company:L.parent_company||"",industry:L.industry||"",status:cr(L.status)||"PROSPECT",territory_id:L.territory?.id?String(L.territory.id):"",assigned_to:L.assigned_accs?.id?String(L.assigned_accs.id):""}),o(!0),p(L.id),r(!0)},te=L=>{L&&Q({title:"Archive Account",message:a.jsxs("span",{children:["Are you sure you want to archive the account"," ",a.jsx("span",{className:"font-semibold",children:L.name}),"? You can restore it later if needed."]}),confirmLabel:"Archive Account",cancelLabel:"Cancel",variant:"archive",action:{type:"archive",targetId:L.id,name:L.name}})},q=L=>{const ee=Me.find(ke=>ke.id===L);ee&&ee.acc_creator?.id===n?.id&&Ke(ke=>{const $e=new Set(ke);return $e.has(L)?$e.delete(L):$e.add(L),$e})},Y=()=>{const L=Me.filter(ee=>ee.acc_creator?.id===n?.id);He.size===L.length&&L.length>0?Ke(new Set):Ke(new Set(L.map(ee=>ee.id)))},U=()=>{if(He.size===0)return;const L=He.size;Q({title:"Archive Accounts",message:a.jsxs("span",{children:["Are you sure you want to archive"," ",a.jsx("span",{className:"font-semibold",children:L})," account",L!==1?"s":"","? You can restore them later if needed."]}),confirmLabel:`Archive ${L} Account${L!==1?"s":""}`,cancelLabel:"Cancel",variant:"archive",action:{type:"bulk-archive",targetIds:Array.from(He),count:L}})},de=async()=>{if(!Z?.action){Q(null);return}const{action:L}=Z,{type:ee,payload:ke,targetId:$e,name:We,targetIds:mt,count:Tt}=L;we(!0);try{if(ee==="create"){c(!0);const kt=await ne.post("/accounts/admin",ke);Ne(),V.success(`Account "${We}" created successfully.`);const Yt=j?.id||null;At(),await Je(Yt),!j&&kt.data?.id}else if(ee==="update"){if(!$e)throw new Error("Missing account identifier for update.");c(!0),await ne.put(`/accounts/admin/${$e}`,ke),V.success(`Account "${We}" updated successfully.`);const kt=j?.id&&j.id===$e?$e:null;At(),await Je(kt),j?.id===$e&&y(null)}else if(ee==="archive"){if(!$e)throw new Error("Missing account identifier for archiving.");const kt=j?.id;d($e),await ne.put(`/accounts/admin/${$e}`,{status:"INACTIVE"}),V.success(`Account "${We}" archived successfully.`),await Je(kt&&kt!==$e?kt:null),kt===$e&&y(null)}else if(ee==="bulk-archive"){if(!mt||mt.length===0)throw new Error("Missing account identifiers for bulk archiving.");it(!0),await Promise.all(mt.map(kt=>ne.put(`/accounts/admin/${kt}`,{status:"INACTIVE"}))),V.success(`${Tt} account${Tt!==1?"s":""} archived successfully.`),Ke(new Set),await Je(),y(null)}}catch(kt){console.error(kt);const Yt=ee==="create"?"Failed to create account. Please review the details and try again.":ee==="update"?"Failed to update account. Please review the details and try again.":ee==="bulk-archive"?"Failed to archive accounts. Please try again.":"Failed to archive account. Please try again.",En=kt.response?.data?.detail||Yt;V.error(En),(ee==="create"||ee==="update")&&c(!1),ee==="archive"&&d(null),ee==="bulk-archive"&&it(!1)}finally{(ee==="create"||ee==="update")&&c(!1),ee==="archive"&&d(null),ee==="bulk-archive"&&it(!1),we(!1),Q(null)}},Te=()=>{le||Q(null)},ie=async()=>{if(!j||!me)return;const L=cr(me),ee=cr(j.status);if(L!==ee){Ie(!0);try{await ne.put(`/accounts/admin/${j.id}`,{status:L}),V.success(`Account status updated to ${nT(L)}`),w(ke=>ke.map($e=>$e.id===j.id?{...$e,status:L}:$e)),y(null)}catch(ke){console.error(ke);const $e=ke.response?.data?.detail||"Failed to update account status. Please try again.";V.error($e)}finally{Ie(!1)}}},[Oe,X]=f.useState(!1),oe=L=>{L.preventDefault(),X(!0);const ee=x.name.trim();if(!ee){V.error("Account name is required.");return}if(!x.assigned_to){V.error("Assigned To is required.");return}const $e={name:ee,website:x.website?.trim()||null,phone_number:x.phone_number?.trim()||null,billing_address:x.billing_address?.trim()||null,shipping_address:x.shipping_address?.trim()||null,industry:x.industry?.trim()||null,parent_company:x.parent_company?.trim()||null,status:x.status||"PROSPECT",territory_id:x.territory_id?Number(x.territory_id):null,assigned_to:x.assigned_to?Number(x.assigned_to):null},We=i&&h?"update":"create";Q({title:We==="create"?"Confirm New Account":"Confirm Update",message:We==="create"?a.jsxs("span",{children:["Are you sure you want to create the account"," ",a.jsx("span",{className:"font-semibold",children:ee}),"?"]}):a.jsxs("span",{children:["Save changes to the account"," ",a.jsx("span",{className:"font-semibold",children:ee}),"?"]}),confirmLabel:We==="create"?"Create Account":"Update Account",cancelLabel:"Cancel",variant:"primary",action:{type:We,payload:$e,targetId:h||null,name:ee}})},Pe=[{label:"Filter by Status",value:"Filter by Status"},...aT.map(L=>({label:L.label,value:L.value}))],Ve=Z?.action?.type==="delete"?Z.action.targetId:null,ft=j&&(u===j.id||Ve===j.id),St=j&&u===j.id,Ht=j?v7e(j.status):"",da=j?a.jsx("div",{id:"accountModalBackdrop",onClick:jt,className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-6xl max-h-[92vh] overflow-y-auto hide-scrollbar animate-scale-in font-inter relative",onClick:L=>L.stopPropagation(),children:[a.jsxs("div",{className:"bg-tertiary w-full rounded-t-xl flex items-center justify-between p-3 lg:p-3",children:[a.jsx("h1",{className:"lg:text-3xl text-xl text-white font-semibold text-center w-full",children:"Account"}),a.jsx("button",{onClick:Ct,className:"text-gray-400 hover:text-white cursor-pointer",children:a.jsx(Za,{size:25})})]}),a.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between lg:flex-row lg:items-center lg:justify-between mt-3 gap-2 px-2 md:items-center lg:gap-4 md:mx-7 lg:mx-7",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[a.jsx("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-800",children:j.name}),a.jsx("span",{className:`text-xs sm:text-sm font-medium px-2 sm:px-3 py-1 rounded-full whitespace-nowrap ${Ht}`,children:nT(j.status)})]}),n?.id===j?.acc_creator?.id&&a.jsxs("div",{className:"flex flex-col sm:flex-row sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsxs("button",{className:"inline-flex items-center justify-center w-full sm:w-auto bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 disabled:opacity-70 transition text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",onClick:()=>H(j),disabled:Z?.action?.type==="update"&&Z.action.targetId===j.id,children:[a.jsx(gn,{className:"mr-2"}),"Edit"]}),a.jsx("button",{className:"inline-flex items-center justify-center w-full sm:w-auto px-4 py-2 rounded-md text-sm bg-orange-500 text-white hover:bg-orange-600 transition focus:outline-none focus:ring-2 focus:ring-orange-400",onClick:()=>te(j),disabled:!!ft,children:St?"Archiving...":a.jsxs(a.Fragment,{children:[a.jsx(Zt,{className:"mr-2"}),"Archive"]})})]})]}),a.jsx("div",{className:"border-b border-gray-200 my-5"}),a.jsxs("div",{className:"p-6 lg:p-4",children:[a.jsx("div",{className:"flex w-full bg-[#6A727D] text-white mt-1 overflow-x-auto mb-6",children:["Overview","Activities"].map(L=>a.jsx("button",{onClick:()=>be(L),className:`flex-1 min-w-[90px] px-4 py-2.5 text-xs sm:text-sm font-medium text-center transition-all duration-200 border-b-2
        ${ge===L?"bg-paper-white text-[#6A727D] border-white":"text-white hover:bg-[#5c636d]"}`,children:L},L))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 items-start",children:[a.jsxs("div",{className:"lg:col-span-3",children:[ge==="Overview"&&a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 md:p-8 border border-gray-200",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4 sm:gap-6 text-sm text-gray-700",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Website:"}),a.jsx("p",{children:j.website?a.jsx("a",{href:j.website,className:"text-blue-600 hover:underline break-all",target:"_blank",rel:"noopener noreferrer",children:j.website}):"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Industry:"}),a.jsx("p",{children:j.industry||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Parent Company:"}),a.jsx("p",{children:j.parent_company||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Territory:"}),a.jsx("p",{children:j.territory?.name||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Phone Number:"}),a.jsx("p",{children:j.phone_number||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Billing Address:"}),a.jsx("p",{children:j.billing_address||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Shipping Address:"}),a.jsx("p",{children:j.shipping_address||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Assigned To:"}),a.jsx("p",{children:j.assigned_accs?`${j.assigned_accs.first_name} ${j.assigned_accs.last_name}`:"Unassigned"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created By:"}),a.jsx("p",{children:j.acc_creator?`${j.acc_creator.first_name} ${j.acc_creator.last_name}`:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created At:"}),a.jsx("p",{children:Be(j.created_at)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Last Updated:"}),a.jsx("p",{children:Be(j.updated_at)||"N/A"})]})]}),a.jsx(Tn,{comments:ot,onAddComment:rt})]}),ge==="Notes"&&a.jsxs("div",{className:"mt-4 w-full",children:[a.jsx("div",{className:"flex flex-wrap items-center justify-between mb-4 gap-2",children:a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words",children:"Account Note"})}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 shadow-sm break-words",children:[a.jsx("div",{className:"flex items-start justify-between",children:a.jsx("div",{children:a.jsx("p",{className:"text-sm font-medium text-gray-800 break-words",children:"Note"})})}),a.jsx("div",{className:"mt-3 text-sm text-gray-700 whitespace-pre-wrap break-words",children:N.notes||"No notes available."})]})]}),ge==="Activities"&&a.jsxs("div",{className:"space-y-2 w-full h-full max-h-[50dvh] overflow-y-auto bg-gray-50 p-2 hide-scrollbar rounded-lg border border-gray-200 shadow-sm",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words border-b border-gray-300 py-2",children:"Related Activities"}),a.jsxs("div",{className:"space-y-2 text-sm",children:[xe.tasks&&xe.tasks.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>Ee(Re==="tasks"?null:"tasks"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Qt,{className:"text-blue-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Tasks (",xe.tasks.length,")"]})]}),Re==="tasks"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Re==="tasks"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:xe.tasks.map((L,ee)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/manager/tasks",{state:{taskID:L.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-blue-600 mt-1",children:a.jsx(Qt,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:L.subject||L.title||"Task"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:L.description||"No description"}),L.assigned_to&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Assigned: ",L.assigned_to.first_name," ",L.assigned_to.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:Be(L.due_date||L.created_at)})]},`task-${ee}`))})]}),xe.meetings&&xe.meetings.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>Ee(Re==="meetings"?null:"meetings"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Pt,{className:"text-green-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Meetings (",xe.meetings.length,")"]})]}),Re==="meetings"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Re==="meetings"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:xe.meetings.map((L,ee)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/manager/meetings",{state:{meetingID:L.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-green-600 mt-1",children:a.jsx(Pt,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:L.subject||L.title||"Meeting"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:L.description||L.location||"No description"}),L.host&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Host: ",L.host.first_name," ",L.host.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:Be(L.start_time||L.created_at)})]},`meeting-${ee}`))})]}),xe.calls&&xe.calls.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>Ee(Re==="calls"?null:"calls"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(It,{className:"text-purple-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Calls (",xe.calls.length,")"]})]}),Re==="calls"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Re==="calls"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:xe.calls.map((L,ee)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/manager/calls",{state:{callID:L.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-purple-600 mt-1",children:a.jsx(It,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:L.subject||L.title||"Call"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:L.direction||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:Be(L.call_time||L.created_at)})]},`call-${ee}`))})]}),xe.contacts&&xe.contacts.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>Ee(Re==="contacts"?null:"contacts"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ra,{className:"text-teal-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Contacts (",xe.contacts.length,")"]})]}),Re==="contacts"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Re==="contacts"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:xe.contacts.map((L,ee)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/manager/contacts",{state:{contactID:L.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-teal-600 mt-1",children:a.jsx(ra,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("h4",{className:"font-medium text-blue-600 break-words text-sm",children:[L.first_name?`${L.first_name} `:"",L.last_name]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:L.title||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:Be(L.created_at)})]},`contact-${ee}`))})]}),xe.deals&&xe.deals.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>Ee(Re==="deals"?null:"deals"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(sa,{className:"text-indigo-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Deals (",xe.deals.length,")"]})]}),Re==="deals"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Re==="deals"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:xe.deals.map((L,ee)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/manager/deals",{state:{dealID:L.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-indigo-600 mt-1",children:a.jsx(sa,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("h4",{className:"font-medium text-blue-600 break-words text-sm",children:[L.deal_id?L.deal_id.replace(/D(\d+)-\d+-/,"D$1-"):"--"," ",L.name||L.title||"Deal"]}),a.jsx("p",{className:"text-xs text-gray-500 break-words capitalize",children:L.stage||L.description||"No description"})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:Be(L.close_date||L.created_at)})]},`deal-${ee}`))})]}),xe.quotes&&xe.quotes.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>Ee(Re==="quotes"?null:"quotes"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ia,{className:"text-orange-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Quotes (",xe.quotes.length,")"]})]}),Re==="quotes"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Re==="quotes"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:xe.quotes.map((L,ee)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/manager/quotes",{state:{quoteID:L.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-orange-600 mt-1",children:a.jsx(ia,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:(L.quote_id?L.quote_id.replace(/Q(\d+)-\d+-/,"Q$1-"):"--")||"Quote"}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:L.status||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:Be(L.presented_date)||""})]},`quote-${ee}`))})]}),(!xe||(!xe.tasks||xe.tasks.length===0)&&(!xe.meetings||xe.meetings.length===0)&&(!xe.calls||xe.calls.length===0)&&(!xe.quotes||xe.quotes.length===0)&&(!xe.deals||xe.deals.length===0)&&(!xe.contacts||xe.contacts.length===0))&&a.jsx("div",{className:"text-center py-8 text-gray-500",children:a.jsx("p",{children:"No related activities found for this account."})})]})]})]}),a.jsxs("div",{className:"flex flex-col gap-4",children:[a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Quick Actions"}),a.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[a.jsxs("button",{onClick:()=>e("/manager/calls",{state:{openCallModal:!0,initialCallData:{subject:`Call with ${j.name}`,relatedType1:"Account",relatedTo1:String(j.id),relatedType2:null,relatedTo2:null,assigned_to:j.assigned_accs?.id?String(j.assigned_accs.id):"",direction:"Outgoing",status:"Planned"}}}),className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(It,{className:"text-gray-600 w-4 h-4"}),"Schedule Call"]}),a.jsxs("button",{className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",onClick:()=>e("/manager/meetings",{state:{openMeetingModal:!0,initialMeetingData:{subject:`Meeting with ${j.name}`,relatedType1:"Account",relatedTo1:String(j.id),relatedType2:null,relatedTo2:null,assignedTo:j.assigned_accs?.id?String(j.assigned_accs.id):"",status:"Planned"}}}),children:[a.jsx(Pt,{className:"text-gray-600 w-4 h-4"}),"Book Meeting"]}),a.jsxs("button",{onClick:()=>e("/manager/tasks",{state:{openTaskModal:!0,initialTaskData:{subject:`Follow up with ${j.name}`,relatedType1:"Account",relatedTo1:String(j.id),relatedType2:null,relatedTo2:null,assignedTo:j.assigned_accs?.id?String(j.assigned_accs.id):"",priority:"NORMAL",status:"Not Started"}}}),className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(Qt,{className:"text-gray-600 w-4 h-4"}),"Tasks"]})]})]}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm w-full",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Status"}),a.jsx("select",{className:"border border-gray-200 rounded-md px-2 sm:px-3 py-1.5 w-full text-sm mb-2 focus:ring-2 focus:ring-indigo-500 outline-none",value:me||cr(j?.status)||"PROSPECT",onChange:L=>Ae(L.target.value),children:aT.map(L=>a.jsx("option",{value:L.value,children:L.label},L.value))}),a.jsx("button",{onClick:ie,disabled:pe||!me||cr(me)===cr(j?.status),className:`w-full py-1.5 rounded-md text-sm transition focus:outline-none focus:ring-2 ${pe||!me||cr(me)===cr(j?.status)?"bg-gray-400 cursor-not-allowed text-white":"bg-gray-900 text-white hover:bg-gray-800 focus:ring-gray-400"}`,children:pe?"Updating...":"Update"})]})]})]})]})]})}):null,qe=a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[S&&a.jsx(qt,{message:"Loading accounts..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h2",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(Xa,{className:"mr-2 text-blue-600"}),"Accounts Management"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{onClick:()=>{fe(),X(!1)},className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 my-1 lg:my-0 rounded-md hover:bg-gray-800 text-sm sm:text-base mx-auto sm:ml-auto cursor-pointer",children:[a.jsx(aa,{className:"mr-2"})," Add Account"]})})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4 mb-6 w-full break-words overflow-hidden lg:overflow-visible",children:De.map(L=>a.jsx(N7e,{...L},L.title))}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search accounts",value:$,onChange:L=>W(L.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsx("div",{className:"w-full lg:w-1/4",children:a.jsx("select",{value:B,onChange:L=>G(L.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:Pe.map(L=>a.jsx("option",{value:L.value,children:L.label},L.value))})})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[500px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 text-sm tracking-wide font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 w-12",children:a.jsx("input",{type:"checkbox",checked:He.size>0&&He.size===Me.filter(L=>L.acc_creator?.id===n?.id).length&&Me.filter(L=>L.acc_creator?.id===n?.id).length>0,onChange:Y,className:"w-4 h-4 cursor-pointer"})}),a.jsx("th",{className:"py-3 px-4 truncate",children:"Account"}),a.jsx("th",{className:"py-3 px-4",children:"Status"}),a.jsx("th",{className:"py-3 px-4",children:"Industry"}),a.jsx("th",{className:"py-3 px-4",children:"Territory"}),a.jsx("th",{className:"py-3 px-4",children:"Phone"}),a.jsx("th",{className:"py-3 px-4 w-12",children:He.size>0&&a.jsx("button",{onClick:U,className:"text-orange-500 hover:text-orange-700 transition",title:"Archive selected accounts",children:a.jsx(Zt,{size:18})})})]})}),a.jsx("tbody",{children:S?a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:7,children:"Loading accounts..."})}):Qe.length>0?Me.map(L=>a.jsxs("tr",{className:"hover:bg-gray-50 text-xs",children:[a.jsx("td",{className:"py-3 px-4",children:L.acc_creator?.id===n?.id&&a.jsx("input",{type:"checkbox",checked:He.has(L.id),onChange:ee=>{ee.stopPropagation(),q(L.id)},className:"w-4 h-4 cursor-pointer"})}),a.jsx("td",{className:"py-3 px-4 cursor-pointer",onClick:()=>{_t(L),ze(L.id)},children:a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-blue-600 hover:underline break-all text-sm",children:L.name}),a.jsx("div",{className:"text-gray-500 text-xs break-all",children:L.website||"--"})]})}),a.jsx("td",{className:"py-3 px-4 cursor-pointer",onClick:()=>{_t(L),ze(L.id)},children:a.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${w7e(L.status)}`,children:nT(L.status)})}),a.jsx("td",{className:"py-3 px-4 text-sm cursor-pointer",onClick:()=>{_t(L),ze(L.id)},children:L.industry||"--"}),a.jsx("td",{className:"py-3 px-4 text-sm cursor-pointer",onClick:()=>{_t(L),ze(L.id)},children:L.territory?.name||"--"}),a.jsx("td",{className:"py-3 px-4 cursor-pointer",onClick:()=>{_t(L),ze(L.id)},children:a.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[a.jsx(It,{className:"text-gray-500"}),a.jsx("span",{children:L.phone_number||"--"})]})})]},L.id)):a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:7,children:"No accounts found."})})})]})}),a.jsx(ca,{className:"mt-4",totalItems:Qe.length,pageSize:ye,currentPage:J,onPrev:et,onNext:yt,onPageSizeChange:L=>{Ce(L),se(1)},pageSizeOptions:[10,20,30,40,50],label:"accounts"})]}),_e=s?a.jsx("div",{id:"modalBackdrop",onClick:Ge,className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-full sm:max-w-3xl rounded-2xl shadow-lg p-4 sm:p-6 md:p-8 relative border border-gray-200 overflow-y-auto hide-scrollbar max-h-[90vh]",onClick:L=>L.stopPropagation(),children:[a.jsx("button",{onClick:()=>{At(),X(!1)},className:"absolute top-4 right-4 text-gray-500 hover:text-black transition",disabled:l||le,children:a.jsx(ea,{size:22})}),a.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800 mb-4 sm:mb-6 flex items-center justify-center",children:i?"Edit Account":"Add New Account"}),a.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",onSubmit:oe,noValidate:!0,children:[a.jsx("div",{className:"md:col-span-2",children:a.jsx(df,{label:"Name",name:"name",value:x.name,onChange:ce,placeholder:"Company name",required:!0,isSubmitted:Oe})}),a.jsx(k8,{label:"Parent Company",value:x.parent_company,onChange:L=>{b(ee=>({...ee,parent_company:L}))},items:D.map(L=>({id:L,name:L})),getLabel:L=>L?.name||"",placeholder:"Select parent company...",disabled:l}),a.jsx(df,{label:"Website",name:"website",value:x.website,onChange:ce,placeholder:"https://example.com",disabled:l}),a.jsx(df,{label:"Phone Number",name:"phone_number",value:x.phone_number,onChange:ce,placeholder:"09xx xxx xxxx",type:"tel",disabled:l}),a.jsx(df,{label:"Industry",name:"industry",value:x.industry,onChange:ce,placeholder:"Industry",disabled:l}),a.jsx(df,{label:"Billing Address",name:"billing_address",value:x.billing_address,onChange:ce,placeholder:"Billing address",disabled:l}),a.jsx(df,{label:"Shipping Address",name:"shipping_address",value:x.shipping_address,onChange:ce,placeholder:"Shipping address",disabled:l}),a.jsx(T8,{label:"Status",name:"status",value:x.status,onChange:ce,options:[{value:"",label:"Select status"},...aT],required:!0,disabled:l}),a.jsx(k8,{label:"Assigned To",value:x.assigned_to,onChange:L=>{const ee=T.find($e=>String($e.id)===String(L));E(ee);let ke=null;ee&&ee.assigned_territory&&ee.assigned_territory.length===1&&(ke=ee.assigned_territory[0].id),b($e=>({...$e,assigned_to:L,territory_id:ke}))},items:T||[],getLabel:L=>`${L?.first_name??""} ${L?.last_name??""} (${L?.role??""})`.trim(),placeholder:"Search assignee...",required:!0,isSubmitted:Oe,disabled:l||T.length===0}),a.jsx("div",{className:"md:col-span-2",children:a.jsx(T8,{label:"Territory",name:"territory_id",value:x.territory_id||"",onChange:ce,options:[{value:"",label:A?A.assigned_territory&&A.assigned_territory.length>0?"Select Territory":"No territories assigned to this user":"Select a user first"},...A&&A.assigned_territory&&A.assigned_territory.map(L=>({value:String(L.id),label:L.name}))||[]],disabled:l||!A||!A.assigned_territory||A.assigned_territory.length===0})}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-end sm:justify-end space-y-2 sm:space-y-0 sm:space-x-2 col-span-1 md:col-span-2 mt-4 w-full",children:[a.jsx("button",{type:"button",onClick:()=>{At(),X(!1)},className:"w-full sm:w-auto px-4 py-2 text-white bg-red-400 border border-red-300 rounded hover:bg-red-500 transition disabled:opacity-70",disabled:l||le,children:"Cancel"}),a.jsx("button",{type:"submit",className:"w-full sm:w-auto px-4 py-2 text-white border border-tertiary bg-tertiary rounded hover:bg-secondary transition disabled:opacity-70",disabled:l||le,children:l?"Saving...":i?"Update Account":"Save Account"})]})]})]})}):null,I=Z?a.jsx(S7e,{open:!0,title:Z.title,message:Z.message,confirmLabel:Z.confirmLabel,cancelLabel:Z.cancelLabel,variant:Z.variant,onConfirm:de,onCancel:Te,loading:le}):null;return a.jsxs(a.Fragment,{children:[qe,da,_e,I]})}function N7e({icon:e,title:t,value:n,color:s="text-blue-600",bgColor:r="bg-blue-100",onClick:i}){const o=()=>{typeof i=="function"?i():console.log(`Clicked: ${t}`)};return a.jsxs("div",{className:"flex items-center p-4 bg-white rounded-xl shadow-md border border-gray-200 transition-all duration-300",onClick:o,children:[a.jsx("div",{className:`flex-shrink-0 p-3 rounded-full ${r} ${s} mr-4`,children:e?a.jsx(e,{size:22}):null}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:t}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:n})]})]})}function df({label:e,name:t,value:n,onChange:s,placeholder:r,type:i="text",required:o=!1,disabled:l=!1,className:c="",isSubmitted:u=!1}){const d=u&&!n?.trim();return a.jsxs("div",{children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",o&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:i,name:t,value:n??"",onChange:s,placeholder:r,required:o,disabled:l,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border focus:ring-2
          ${d?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}
          ${c}
        `})]})}function T8({label:e,name:t,value:n,onChange:s,options:r,required:i=!1,disabled:o=!1}){return a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsx("select",{name:t,value:n??"",onChange:s,required:i,disabled:o,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100",children:r.map(l=>a.jsx("option",{value:l.value,children:l.label},l.value))})]})}function k8({label:e,items:t=[],value:n="",onChange:s,getLabel:r,placeholder:i="Search...",disabled:o=!1,className:l="",required:c=!1,isSubmitted:u=!1,allowFreeText:d=!1}){const h=u&&c&&!n;return a.jsxs("div",{className:l,children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",c&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx(C7e,{items:t,value:n??"",onChange:s,getLabel:r,placeholder:i,disabled:o,hasError:h,allowFreeText:d})]})}function C7e({items:e=[],value:t="",onChange:n,getLabel:s,placeholder:r="Search...",disabled:i=!1,maxRender:o=200,hasError:l=!1,allowFreeText:c=!1}){const[u,d]=f.useState(!1),[h,p]=f.useState(""),x=f.useRef(null),b=e.find(N=>String(N.id)===String(t)),j=b?s(b):t,y=f.useMemo(()=>{const N=h.trim().toLowerCase();return(N?e.filter(S=>(s(S)||"").toLowerCase().includes(N)):e).slice(0,o)},[e,h,s,o]);return f.useEffect(()=>{const N=w=>{x.current&&!x.current.contains(w.target)&&d(!1)};return document.addEventListener("mousedown",N),()=>document.removeEventListener("mousedown",N)},[]),f.useEffect(()=>{u||p("")},[u]),a.jsxs("div",{ref:x,className:"relative w-full",children:[a.jsx("input",{disabled:i,value:u?h:j,placeholder:r,onFocus:()=>!i&&d(!0),onChange:N=>{p(N.target.value),u||d(!0)},className:`w-full border rounded-md px-2 py-1.5 text-sm outline-none focus:ring-2
          ${l?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}`}),u&&!i&&a.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg overflow-hidden",children:[a.jsxs("div",{className:"max-h-56 overflow-y-auto hide-scrollbar",children:[c&&h.trim()&&!y.some(N=>s(N).toLowerCase()===h.trim().toLowerCase())&&a.jsxs("button",{type:"button",onClick:()=>{n(h.trim()),d(!1)},className:"w-full text-left px-3 py-2 text-sm hover:bg-green-50 bg-blue-50 font-medium text-blue-700",children:['+ Add "',h.trim(),'" as new parent company']}),y.length>0?y.map(N=>{const w=String(N.id),S=s(N),_=String(t)===w;return a.jsx("button",{type:"button",onClick:()=>{n(w),d(!1)},className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-50 ${_?"bg-blue-50":""}`,children:S||"--"},w)}):!c||!h.trim()?a.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No results"}):null]}),e.length>o&&a.jsxs("div",{className:"px-3 py-2 text-[11px] text-gray-400 border-t",children:["Showing first ",o," results  keep typing to narrow."]})]})]})}function S7e({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o=!1,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":i==="archive"?"bg-orange-500 hover:bg-orange-600 border border-orange-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsx("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${u}`,disabled:o,children:o?"Processing...":s})]})]})})}const Ob={first_name:"",last_name:"",account_id:"",title:"",department:"",email:"",work_phone:"",mobile_phone_1:"",mobile_phone_2:"",notes:"",assigned_to:""},wl=e=>[e?.first_name,e?.last_name].filter(Boolean).join(" ").trim(),xo=e=>e?new Date(e).toLocaleString("en-US",{month:"short",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).replace(",",""):"";function _7e(){const e=Et(),t=ta(),{user:n}=Gt();f.useEffect(()=>{document.title="Contacts | Sari-Sari CRM"},[]);const[s,r]=f.useState([]),[i,o]=f.useState(!1),[l,c]=f.useState([]),[u,d]=f.useState([]),[h,p]=f.useState(null),[x,b]=f.useState(!1),[j,y]=f.useState(!1),[N,w]=f.useState(!1),[S,_]=f.useState(null),[T,k]=f.useState(!1),[A,E]=f.useState(null),[M,F]=f.useState(Ob),[D,P]=f.useState(""),[B,G]=f.useState("Filter by Accounts"),[$,W]=f.useState(null),[Z,Q]=f.useState("Overview"),[le,we]=f.useState(1),[J,se]=f.useState(10),[ye,Ce]=f.useState({}),[ge,be]=f.useState(null),[me,Ae]=f.useState(null),[pe,Ie]=f.useState(new Set),[xe,he]=f.useState(!1),{comments:Re,addComment:Ee,refresh:He}=kn({relatedType:"contact",relatedId:h?.id});f.useEffect(()=>{h?.id&&He()},[h?.id,He]),f.useEffect(()=>{const U=t.state?.contactID;U&&(Ae(U),e(t.pathname,{replace:!0,state:{}}))},[t,e]),f.useEffect(()=>{if(me&&s.length>0&&!i){const U=s.find(de=>de.id===me);U?p(U):V.error("Contact not found."),Ae(null)}},[me,s,i]);const Ke=f.useCallback(async(U=null)=>{o(!0);try{const de=await ne.get("/contacts/admin/fetch-all"),ie=[...Array.isArray(de.data)?de.data:[]].sort((Oe,X)=>{const oe=Oe?.created_at||Oe?.updated_at||0,Pe=X?.created_at||X?.updated_at||0;return new Date(Pe)-new Date(oe)});if(r(ie),U){const Oe=ie.find(X=>X.id===U);p(Oe||null)}}catch(de){console.error(de),r([]),de.response?.status===403?V.error("Permission denied. Only CEO, Admin, or Group Manager can access this page."):V.error("Failed to fetch contacts. Please try again later.")}finally{o(!1)}},[p]),st=f.useCallback(async()=>{try{const U=await ne.get("/accounts/admin/fetch-all"),Te=[...Array.isArray(U.data)?U.data:[]].sort((ie,Oe)=>(ie?.name||"").localeCompare(Oe?.name||""));c(Te)}catch(U){console.error(U),c([]),U.response?.status===403&&V.warn("Unable to load accounts (permission denied).")}},[]),it=f.useCallback(()=>{window.open("/manager/accounts?openModal=1","_blank","noopener,noreferrer")},[]),ot=f.useCallback(async()=>{try{const U=await ne.get("/users/all"),Te=[...Array.isArray(U.data)?U.data:[]].sort((ie,Oe)=>wl(ie).localeCompare(wl(Oe)));d(Te)}catch(U){console.error(U),d([]),U.response?.status===403&&V.warn("Unable to load users for assignment (permission denied).")}},[]),rt=f.useCallback(async U=>{try{const de=await ne.get(`/activities/contact/${U}`);Ce(de.data&&typeof de.data=="object"?de.data:{})}catch(de){console.error(de),de.response?.status===404&&(console.warn("No activities found for this account."),Ce({}))}},[]);f.useEffect(()=>{Ke(),st(),ot()},[Ke,st,ot]);const at=f.useMemo(()=>{const U=new Map;l.forEach(Te=>{Te?.id&&Te?.name&&U.set(String(Te.id),Te.name)}),s.forEach(Te=>{Te?.account_id&&Te?.account?.name&&U.set(String(Te.account_id),Te.account.name)});const de=Array.from(U.entries()).sort((Te,ie)=>Te[1].localeCompare(ie[1])).map(([Te,ie])=>({value:Te,label:ie}));return[{value:"Filter by Accounts",label:"Filter by Accounts"},...de]},[l,s]),Je=f.useMemo(()=>{const U=D.trim().toLowerCase(),de=B.trim();return s.filter(Te=>{const ie=[Te?.first_name,Te?.last_name,Te?.email,Te?.title,Te?.department,Te?.account?.name,Te?.account?.status,Te?.work_phone,Te?.mobile_phone_1,Te?.mobile_phone_2,Te?.assigned_contact?.first_name,Te?.assigned_contact?.last_name,Te?.contact_creator?.first_name,Te?.contact_creator?.last_name,Te?.notes,xo(Te?.created_at),xo(Te?.updated_at)],Oe=U===""||ie.some(Pe=>Pe==null?!1:Pe.toString().toLowerCase().includes(U)),X=de==="Filter by Accounts"||String(Te.account_id)===de,oe=Te?.status!=="Inactive";return Oe&&X&&oe})},[s,D,B]),Fe=Math.max(1,Math.ceil(Je.length/J)||1);f.useEffect(()=>{we(1)},[D,B]),f.useEffect(()=>{we(U=>{const de=Math.max(1,Math.ceil(Je.length/J)||1);return U>de?de:U})},[Je.length]);const Ue=f.useMemo(()=>{const U=(le-1)*J;return Je.slice(U,U+J)},[Je,le,J]),Ne=()=>we(U=>Math.max(U-1,1)),ze=()=>we(U=>Math.min(U+1,Fe)),je=f.useMemo(()=>{if(!j||!A)return l;const U=s.find(Te=>Te.id===A);return!U||!U.account||l.some(Te=>Te.id===U.account.id)?l:[...l,U.account]},[l,j,A,s]),ve=f.useCallback(()=>{b(!1),y(!1),E(null),F(Ob),w(!1),et(!1)},[]),z=U=>{U.target.id==="modalBackdrop"&&!N&&!T&&ve()},K=U=>{const{name:de,value:Te}=U.target;F(ie=>({...ie,[de]:Te}))},ue=()=>{F(Ob),y(!1),E(null),b(!0)};f.useEffect(()=>{const U=new URLSearchParams(t.search||"");(t.state?.openContactModal||U.get("openModal")==="1")&&(F(Ob),y(!1),E(null),b(!0),et(!1),e(t.pathname,{replace:!0,state:{}}))},[t.state,t.pathname,t.search,e]);const re=async U=>{if(!U)return;const de=await ne.get(`/accounts/get/${U.account_id}`);F({first_name:U.first_name||"",last_name:U.last_name||"",account_id:de.data.id?de.data.id:"",title:U.title||"",department:U.department||"",email:U.email||"",work_phone:U.work_phone||"",mobile_phone_1:U.mobile_phone_1||"",mobile_phone_2:U.mobile_phone_2||"",notes:U.notes||"",assigned_to:U.assigned_to?String(U.assigned_to):""}),y(!0),E(U.id),b(!0),p(null)},Le=U=>{if(!U)return;const de=wl(U)||"this contact";_({title:"Archive Contact",message:a.jsxs("span",{children:["Are you sure you want to archive"," ",a.jsx("span",{className:"font-semibold",children:de}),"? You can restore it later if needed."]}),confirmLabel:"Archive Contact",cancelLabel:"Cancel",variant:"archive",action:{type:"archive",targetId:U.id,name:de}})},De=U=>{const de=Ue.find(Te=>Te.id===U);de&&de.contact_creator?.id===n?.id&&Ie(Te=>{const ie=new Set(Te);return ie.has(U)?ie.delete(U):ie.add(U),ie})},Qe=()=>{const U=Ue.filter(de=>de.contact_creator?.id===n?.id);pe.size===U.length&&U.length>0?Ie(new Set):Ie(new Set(U.map(de=>de.id)))},tt=()=>{if(pe.size===0)return;const U=pe.size;_({title:"Archive Contacts",message:a.jsxs("span",{children:["Are you sure you want to archive"," ",a.jsx("span",{className:"font-semibold",children:U})," contact",U!==1?"s":"","? You can restore them later if needed."]}),confirmLabel:`Archive ${U} Contact${U!==1?"s":""}`,cancelLabel:"Cancel",variant:"archive",action:{type:"bulk-archive",targetIds:Array.from(pe),count:U}})},[Me,et]=f.useState(!1),yt=U=>{U.preventDefault(),et(!0);const de=M.last_name.trim();if(!de){V.error("Last name is required.");return}if(!M.account_id){V.error("Account is required.");return}if(!M.assigned_to){V.error("Assigned To is required.");return}const ie=M.email?.trim();if(!ie){V.error("Email is required.");return}if(!ie.includes("@")){V.error("Email must contain '@'.");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(ie)){V.error("Please enter a valid email address.");return}const X=M.first_name?.trim()||"",oe={first_name:X,last_name:de,account_id:Number(M.account_id),title:M.title?.trim()||null,department:M.department?.trim()||null,email:M.email?.trim().toLowerCase()||null,work_phone:M.work_phone?.trim()||null,mobile_phone_1:M.mobile_phone_1?.trim()||null,mobile_phone_2:M.mobile_phone_2?.trim()||null,notes:M.notes?.trim()||null,assigned_to:M.assigned_to?Number(M.assigned_to):null},Pe=j&&A?"update":"create",Ve=`${X} ${de}`.trim();_({title:Pe==="create"?"Confirm New Contact":"Confirm Update",message:Pe==="create"?a.jsxs("span",{children:["Are you sure you want to add"," ",a.jsx("span",{className:"font-semibold",children:Ve})," to your contacts?"]}):a.jsxs("span",{children:["Save changes to ",a.jsx("span",{className:"font-semibold",children:Ve}),"?"]}),confirmLabel:Pe==="create"?"Create Contact":"Update Contact",cancelLabel:"Cancel",variant:"primary",action:{type:Pe,payload:oe,targetId:A||null,name:Ve}})},_t=async()=>{if(!S?.action){_(null);return}const{action:U}=S,{type:de,payload:Te,targetId:ie,name:Oe}=U;k(!0);try{if(de==="create"){w(!0),await ne.post("/contacts/admin",Te),V.success(`Contact "${Oe}" created successfully.`);const X=h?.id||null;ve(),await Ke(X)}else if(de==="update"){if(!ie)throw new Error("Missing contact identifier for update.");w(!0),await ne.put(`/contacts/admin/${ie}`,Te),V.success(`Contact "${Oe}" updated successfully.`);const X=h?.id&&h.id===ie?ie:h?.id||null;ve(),await Ke(X),h?.id===ie&&p(null)}else if(de==="archive"){if(!ie)throw new Error("Missing contact identifier for archiving.");const X=h?.id;W(ie),await ne.put(`/contacts/admin/${ie}`,{status:"Inactive"}),V.success(`Contact "${Oe}" archived successfully.`),await Ke(X&&X!==ie?X:null),X===ie&&p(null)}else if(de==="bulk-archive"){const{targetIds:X,count:oe}=U;if(!X||X.length===0)throw new Error("Missing contact identifiers for bulk archiving.");he(!0),await Promise.all(X.map(Pe=>ne.put(`/contacts/admin/${Pe}`,{status:"Inactive"}))),V.success(`${oe} contact${oe!==1?"s":""} archived successfully.`),Ie(new Set),await Ke(),p(null)}}catch(X){console.error(X);const oe=de==="create"?"Failed to create contact. Please review the details and try again.":de==="update"?"Failed to update contact. Please review the details and try again.":de==="bulk-archive"?"Failed to archive contacts. Please try again.":"Failed to archive contact. Please try again.",Pe=X.response?.data?.detail||oe;V.error(Pe)}finally{(de==="create"||de==="update")&&w(!1),de==="archive"&&W(null),de==="bulk-archive"&&he(!1),k(!1),_(null)}},Ct=()=>{T||_(null)},jt=U=>{p(U),Q("Overview")},At=()=>p(null),Ge=U=>{U.target.id==="contactModalBackdrop"&&!T&&At()},Be=S?.action?.type==="delete"?S.action.targetId:null,ce=h&&($===h.id||Be===h.id),fe=h&&$===h.id,H=h?a.jsx("div",{id:"contactModalBackdrop",onClick:Ge,className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-6xl max-h-[92vh] overflow-y-auto hide-scrollbar animate-scale-in font-inter relative",onClick:U=>U.stopPropagation(),children:[a.jsxs("div",{className:"bg-tertiary w-full rounded-t-xl relative p-3 lg:p-3",children:[a.jsx("h1",{className:"lg:text-3xl text-xl text-white font-semibold text-center w-full",children:"Contact"}),a.jsx("button",{onClick:At,className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-white cursor-pointer",children:a.jsx(Za,{size:25})})]}),a.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between lg:flex-row lg:items-center lg:justify-between mt-3 gap-2 px-2 md:items-center lg:gap-4 md:mx-7 lg:mx-7",children:[a.jsx("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:a.jsx("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-800",children:wl(h)||"Unnamed contact"})}),a.jsx("div",{className:"flex flex-col sm:flex-row sm:space-x-3 space-y-2 sm:space-y-0",children:n?.id===h?.contact_creator?.id&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{className:"inline-flex items-center justify-center w-full sm:w-auto bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 disabled:opacity-70 transition text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",onClick:()=>re(h),disabled:T||S?.action?.type==="update"&&S.action.targetId===h.id,children:[a.jsx(gn,{className:"mr-2"}),"Edit"]}),a.jsx("button",{className:"inline-flex items-center justify-center w-full sm:w-auto px-4 py-2 rounded-md text-sm bg-orange-500 text-white hover:bg-orange-600 transition focus:outline-none focus:ring-2 focus:ring-orange-400",onClick:()=>Le(h),disabled:!!ce,children:fe?"Archiving...":a.jsxs(a.Fragment,{children:[a.jsx(Zt,{className:"mr-2"}),"Archive"]})})]})})]}),a.jsx("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-2 px-2 lg:gap-4 md:mx-7 lg:mx-7",children:a.jsx("p",{className:"text-sm text-gray-500",children:h.account?.name||"No associated account"})}),a.jsx("div",{className:"border-b border-gray-200 my-5"}),a.jsxs("div",{className:"p-6 lg:p-4",children:[a.jsx("div",{className:"flex w-full bg-[#6A727D] text-white mt-1 overflow-x-auto mb-6",children:["Overview","Notes","Activities"].map(U=>a.jsx("button",{onClick:()=>Q(U),className:`flex-1 min-w-[90px] px-4 py-2.5 text-xs sm:text-sm font-medium text-center transition-all duration-200 border-b-2
        ${Z===U?"bg-paper-white text-[#6A727D] border-white":"text-white hover:bg-[#5c636d]"}`,children:U},U))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 items-start",children:[a.jsxs("div",{className:"lg:col-span-3",children:[Z==="Overview"&&a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 md:p-8 border border-gray-200",children:a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4 sm:gap-6 text-sm text-gray-700",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Contact Name:"}),a.jsx("p",{children:wl(h)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Title:"}),a.jsx("p",{children:h.title||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Email:"}),a.jsx("p",{children:h.email?a.jsx("a",{href:`mailto:${h.email}`,className:"text-blue-600 hover:underline break-all",children:h.email}):"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Department:"}),a.jsx("p",{children:h.department||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Work Phone:"}),a.jsx("p",{children:h.work_phone||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Mobile Phone 1:"}),a.jsx("p",{children:h.mobile_phone_1||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Mobile Phone 2:"}),a.jsx("p",{children:h.mobile_phone_2||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Assigned To:"}),a.jsx("p",{children:h.assigned_contact?`${h.assigned_contact.first_name} ${h.assigned_contact.last_name}`:"Unassigned"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created By:"}),a.jsx("p",{children:h.contact_creator?`${h.contact_creator.first_name} ${h.contact_creator.last_name}`:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created At:"}),a.jsx("p",{children:xo(h.created_at)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Last Updated:"}),a.jsx("p",{children:xo(h.updated_at)||"N/A"})]})]})}),Z==="Notes"&&a.jsxs("div",{className:"mt-4 w-full",children:[a.jsx("div",{className:"flex flex-wrap items-center justify-between mb-4 gap-2",children:a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words",children:"Contact Note"})}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 shadow-sm break-words",children:[a.jsx("div",{className:"flex items-start justify-between",children:a.jsx("div",{children:a.jsx("p",{className:"text-sm font-medium text-gray-800 break-words",children:"Note"})})}),a.jsx("div",{className:"mt-3 text-sm text-gray-700 whitespace-pre-wrap break-words",children:h.notes||"No notes available."})]}),a.jsx(Tn,{comments:Re,onAddComment:Ee})]}),Z==="Activities"&&a.jsxs("div",{className:"space-y-2 w-full h-full max-h-[50dvh] overflow-y-auto bg-gray-50 p-2 hide-scrollbar rounded-lg border border-gray-200 shadow-sm",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words border-b border-gray-300 py-2",children:"Related Activities"}),a.jsxs("div",{className:"space-y-2 text-sm",children:[ye.tasks&&ye.tasks.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>be(ge==="tasks"?null:"tasks"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Qt,{className:"text-blue-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Tasks (",ye.tasks.length,")"]})]}),ge==="tasks"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),ge==="tasks"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:ye.tasks.map((U,de)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/manager/tasks",{state:{taskID:U.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-blue-600 mt-1",children:a.jsx(Qt,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:U.subject||U.title||"Task"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:U.description||"No description"}),U.assigned_to&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Assigned: ",U.assigned_to.first_name," ",U.assigned_to.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:xo(U.due_date||U.created_at)})]},`task-${de}`))})]}),ye.meetings&&ye.meetings.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>be(ge==="meetings"?null:"meetings"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Pt,{className:"text-green-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Meetings (",ye.meetings.length,")"]})]}),ge==="meetings"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),ge==="meetings"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:ye.meetings.map((U,de)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/manager/meetings",{state:{meetingID:U.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-green-600 mt-1",children:a.jsx(Pt,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:U.subject||U.title||"Meeting"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:U.description||U.location||"No description"}),U.host&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Host: ",U.host.first_name," ",U.host.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:xo(U.start_time||U.created_at)})]},`meeting-${de}`))})]}),ye.calls&&ye.calls.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>be(ge==="calls"?null:"calls"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(It,{className:"text-purple-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Calls (",ye.calls.length,")"]})]}),ge==="calls"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),ge==="calls"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:ye.calls.map((U,de)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/manager/calls",{state:{callID:U.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-purple-600 mt-1",children:a.jsx(It,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:U.subject||U.title||"Call"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:U.direction||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:xo(U.call_time||U.created_at)})]},`call-${de}`))})]}),ye.deals&&ye.deals.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>be(ge==="deals"?null:"deals"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(sa,{className:"text-indigo-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Deals (",ye.deals.length,")"]})]}),ge==="deals"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),ge==="deals"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:ye.deals.map((U,de)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/manager/deals",{state:{dealID:U.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-indigo-600 mt-1",children:a.jsx(sa,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("h4",{className:"font-medium text-blue-600 break-words text-sm",children:[U.deal_id?U.deal_id.replace(/D(\d+)-\d+-/,"D$1-"):"--"," ",U.name||U.title||"Deal"]}),a.jsx("p",{className:"text-xs text-gray-500 break-words capitalize",children:U.stage||U.description||"No description"})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:xo(U.close_date||U.created_at)})]},`deal-${de}`))})]}),ye.quotes&&ye.quotes.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>be(ge==="quotes"?null:"quotes"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ia,{className:"text-orange-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Quotes (",ye.quotes.length,")"]})]}),ge==="quotes"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),ge==="quotes"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:ye.quotes.map((U,de)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/manager/quotes",{state:{quoteID:U.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-orange-600 mt-1",children:a.jsx(ia,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:(U.quote_id?U.quote_id.replace(/Q(\d+)-\d+-/,"Q$1-"):"--")||"Quote"}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:U.status||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:xo(U.presented_date)||""})]},`quote-${de}`))})]}),(!ye||(!ye.tasks||ye.tasks.length===0)&&(!ye.meetings||ye.meetings.length===0)&&(!ye.calls||ye.calls.length===0)&&(!ye.quotes||ye.quotes.length===0)&&(!ye.deals||ye.deals.length===0)&&(!ye.contacts||ye.contacts.length===0))&&a.jsx("div",{className:"text-center py-8 text-gray-500",children:a.jsx("p",{children:"No related activities found for this account."})})]})]})]}),a.jsx("div",{className:"flex flex-col gap-4",children:a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Quick Actions"}),a.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[a.jsxs("button",{onClick:()=>e("/manager/calls",{state:{openCallModal:!0,initialCallData:{subject:`Call with ${wl(h)||""}`.trim(),relatedType1:"Account",relatedTo1:h?.account_id?String(h.account_id):h?.account?.id?String(h.account.id):"",relatedType2:"Contact",relatedTo2:h?.id?String(h.id):"",assigned_to:h?.assigned_contact?.id?String(h.assigned_contact.id):"",direction:"Outgoing",status:"Planned"}}}),className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(It,{className:"text-gray-600 w-4 h-4"}),"Schedule Call"]}),a.jsxs("button",{type:"button",onClick:()=>{if(!h?.email){alert("No email address available");return}const U=encodeURIComponent(h.email),de=encodeURIComponent(""),Te=encodeURIComponent(""),ie=`mailto:${U}?subject=${de}&body=${Te}`;window.location.href=ie},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(sn,{className:"text-gray-600 w-4 h-4"}),"Send E-mail"]}),a.jsxs("button",{className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",onClick:()=>e("/manager/meetings",{state:{openMeetingModal:!0,initialMeetingData:{subject:`Meeting with ${wl(h)||""}`.trim(),relatedType1:"Account",relatedTo1:h?.account_id?String(h.account_id):h?.account?.id?String(h.account.id):"",relatedType2:"Contact",relatedTo2:h?.id?String(h.id):"",assignedTo:h?.assigned_contact?.id?String(h.assigned_contact.id):"",status:"Planned"}}}),children:[a.jsx(Pt,{className:"text-gray-600 w-4 h-4"}),"Book Meeting"]}),a.jsxs("button",{onClick:()=>e("/manager/tasks",{state:{openTaskModal:!0,initialTaskData:{subject:`Task for ${wl(h)||""}`.trim(),relatedType1:"Account",relatedTo1:h?.account_id?String(h.account_id):h?.account?.id?String(h.account.id):"",relatedType2:"Contact",relatedTo2:h?.id?String(h.id):"",assignedTo:h?.assigned_contact?.id?String(h.assigned_contact.id):"",priority:"NORMAL",status:"Not Started"}}}),className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(Qt,{className:"text-gray-600 w-4 h-4"}),"Tasks"]})]})]})})]})]})]})}):null,te=a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[i&&a.jsx(qt,{message:"Loading contacts..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0 w-full",children:[a.jsxs("h2",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(Xa,{className:"mr-2 text-blue-600"})," Contacts Management"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{onClick:()=>{ue(),et(!1)},className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 rounded-md hover:bg-gray-800 text-sm sm:text-base self-end sm:self-auto cursor-pointer",children:[a.jsx(aa,{className:"mr-2"})," Add Contact"]})})]}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search contacts",value:D,onChange:U=>P(U.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsx("div",{className:"w-full lg:w-1/4",children:a.jsx("select",{value:B,onChange:U=>G(U.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:at.map(U=>a.jsx("option",{value:U.value,children:U.label},U.value??U.label))})})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[600px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 text-sm tracking-wide font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 w-12",children:a.jsx("input",{type:"checkbox",checked:pe.size>0&&pe.size===Ue.filter(U=>U.contact_creator?.id===n?.id).length&&Ue.filter(U=>U.contact_creator?.id===n?.id).length>0,onChange:Qe,className:"w-4 h-4 cursor-pointer"})}),a.jsx("th",{className:"py-3 px-4 truncate",children:"Contact"}),a.jsx("th",{className:"py-3 px-4",children:"Account"}),a.jsx("th",{className:"py-3 px-4 truncate",children:"Contact Info"}),a.jsx("th",{className:"py-3 px-4",children:"Department"}),a.jsx("th",{className:"py-3 px-4",children:"Assigned To"}),a.jsx("th",{className:"py-3 px-4",children:"Created"}),a.jsx("th",{className:"py-3 px-4 w-12",children:pe.size>0&&a.jsx("button",{onClick:tt,className:"text-orange-500 hover:text-orange-700 transition",title:"Archive selected contacts",disabled:xe,children:a.jsx(Zt,{size:18})})})]})}),a.jsx("tbody",{children:i?a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:8,children:"Loading contacts..."})}):Je.length>0?Ue.map(U=>{const de=[{Icon:sn,value:U.email,key:"email"},{Icon:It,value:U.work_phone,key:"work_phone"}].filter(Te=>!!Te.value);return a.jsxs("tr",{className:"hover:bg-gray-50 text-sm cursor-pointer transition",children:[a.jsx("td",{className:"py-3 px-4",children:n?.id===U.contact_creator?.id&&a.jsx("input",{type:"checkbox",checked:pe.has(U.id),onChange:Te=>{Te.stopPropagation(),De(U.id)},className:"w-4 h-4 cursor-pointer"})}),a.jsxs("td",{className:"py-3 px-4 align-top",onClick:()=>{jt(U),rt(U.id)},children:[a.jsx("div",{className:"font-medium text-blue-600 hover:underline break-all text-sm",children:wl(U)||"--"}),a.jsx("div",{className:"text-xs text-gray-500",children:U.title||"No title"})]}),a.jsx("td",{className:"py-3 px-4 align-top",onClick:()=>{jt(U),rt(U.id)},children:a.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-700",children:[a.jsx(Kx,{className:"text-gray-500 flex-shrink-0"}),a.jsx("span",{className:"break-words",children:U.account?.name||"--"})]})}),a.jsx("td",{className:"py-3 px-4 align-top",onClick:()=>{jt(U),rt(U.id)},children:de.length>0?a.jsx("div",{className:"space-y-1 text-gray-700",children:de.map(({Icon:Te,value:ie,key:Oe})=>{const X=wt.createElement(Te,{className:"text-gray-500 flex-shrink-0"});return a.jsxs("div",{className:"flex items-center space-x-2 break-all text-sm",children:[X,a.jsx("span",{children:ie})]},Oe)})}):a.jsx("span",{className:"text-gray-400 text-sm",children:"--"})}),a.jsx("td",{className:"py-3 px-4 align-top",onClick:()=>{jt(U),rt(U.id)},children:a.jsxs("div",{className:"flex items-center space-x-2 text-gray-700 text-sm",children:[a.jsx(sa,{className:"text-gray-500 flex-shrink-0"}),a.jsx("span",{children:U.department||"--"})]})}),a.jsx("td",{className:"py-3 px-4 align-top",onClick:()=>{jt(U),rt(U.id)},children:a.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[a.jsx(ra,{className:"text-gray-500 flex-shrink-0"}),a.jsx("span",{children:U.assigned_contact?`${U.assigned_contact.first_name} ${U.assigned_contact.last_name}`:"Unassigned"})]})}),a.jsx("td",{className:"py-3 px-4 align-top",onClick:()=>{jt(U),rt(U.id)},children:a.jsxs("div",{className:"flex items-center space-x-2 text-gray-500",children:[a.jsx(Pt,{className:"text-gray-500 flex-shrink-0"}),a.jsx("span",{className:"text-xs",children:xo(U.created_at)||"--"})]})})]},U.id)}):a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:8,children:"No contacts found."})})})]})}),a.jsx(ca,{className:"mt-4",totalItems:Je.length,pageSize:J,currentPage:le,onPrev:Ne,onNext:ze,onPageSizeChange:U=>{se(U),we(1)},pageSizeOptions:[10,20,30,40,50],label:"contacts"})]}),q=x?a.jsx("div",{id:"modalBackdrop",onClick:z,className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-full sm:max-w-3xl rounded-2xl shadow-lg p-4 sm:p-6 md:p-8 relative border border-gray-200 overflow-y-auto max-h-[90vh] hide-scrollbar",onClick:U=>U.stopPropagation(),children:[a.jsx("button",{onClick:()=>{ve(),et(!1)},className:"absolute top-4 right-4 text-gray-500 hover:text-black transition disabled:opacity-60",disabled:N||T,children:a.jsx(ea,{size:22})}),a.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800 mb-4 sm:mb-6 flex items-center justify-center",children:j?"Edit Contact":"Add New Contact"}),a.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",onSubmit:yt,noValidate:!0,children:[a.jsx(qc,{label:"First Name",name:"first_name",value:M.first_name,onChange:K,placeholder:"First name",disabled:N}),a.jsx(qc,{label:"Last Name",name:"last_name",value:M.last_name,onChange:K,placeholder:"Last name",required:!0,isSubmitted:Me}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:col-span-2",children:[a.jsx(E8,{label:"Account",value:M.account_id,onChange:U=>F(de=>({...de,account_id:U})),items:j?je:l||[],getLabel:U=>U?.name??"",placeholder:"Search account...",actions:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{type:"button",onClick:it,disabled:N,title:"Add account",className:"inline-flex items-center justify-center w-4 h-4 rounded-sm border border-gray-300 text-gray-600 hover:bg-gray-50 transition disabled:opacity-60",children:a.jsx(aa,{size:16})}),a.jsx("button",{type:"button",onClick:st,disabled:N,title:"Refresh accounts",className:"inline-flex items-center justify-center w-4 h-3 text-gray-600 hover:bg-gray-50 transition disabled:opacity-60",children:a.jsx(Br,{size:16})})]}),disabled:N||(j?je.length===0:l.length===0),required:!0,isSubmitted:Me}),a.jsx(E8,{label:"Assigned To",value:M.assigned_to,onChange:U=>F(de=>({...de,assigned_to:U})),items:u||[],getLabel:U=>`${U?.first_name??""} ${U?.last_name??""} (${U?.role??""})`.trim(),placeholder:"Search assignee...",required:!0,isSubmitted:Me,disabled:N||u.length===0})]}),a.jsx(qc,{label:"Title",name:"title",value:M.title,onChange:K,placeholder:"Job title",disabled:N}),a.jsx(qc,{label:"Department",name:"department",value:M.department,onChange:K,placeholder:"Department",disabled:N}),a.jsx(qc,{label:"Email",name:"email",type:"email",value:M.email,onChange:K,placeholder:"example@email.com",required:!0,isSubmitted:Me}),a.jsx(qc,{label:"Work Phone",name:"work_phone",value:M.work_phone,onChange:K,placeholder:"09xx xxx xxxx",disabled:N}),a.jsx(qc,{label:"Mobile Phone 1",name:"mobile_phone_1",value:M.mobile_phone_1,onChange:K,placeholder:"09xx xxx xxxx",disabled:N}),a.jsx(qc,{label:"Mobile Phone 2",name:"mobile_phone_2",value:M.mobile_phone_2,onChange:K,placeholder:"09xx xxx xxxx",disabled:N}),a.jsx(T7e,{label:"Notes",name:"notes",value:M.notes,onChange:K,placeholder:"Additional details...",rows:3,disabled:N,className:"md:col-span-2"}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-2 md:col-span-2 mt-4",children:[a.jsx("button",{type:"button",onClick:()=>{ve(),et(!1)},className:"w-full sm:w-auto px-4 py-2 text-white bg-red-400 border border-red-300 rounded hover:bg-red-500 transition disabled:opacity-70",disabled:N||T,children:"Cancel"}),a.jsx("button",{type:"submit",className:"w-full sm:w-auto px-4 py-2 text-white border border-tertiary bg-tertiary rounded hover:bg-secondary transition disabled:opacity-70",disabled:N||T,children:N?"Saving...":j?"Update Contact":"Save Contact"})]})]})]})}):null,Y=S?a.jsx(k7e,{open:!0,title:S.title,message:S.message,confirmLabel:S.confirmLabel,cancelLabel:S.cancelLabel,variant:S.variant,onConfirm:_t,onCancel:Ct,loading:T}):null;return a.jsxs(a.Fragment,{children:[te,H,q,Y]})}function qc({label:e,name:t,value:n,onChange:s,placeholder:r,type:i="text",required:o=!1,disabled:l=!1,isSubmitted:c=!1,className:u=""}){const d=c&&!n?.trim();return a.jsxs("div",{children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",o&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:i,name:t,value:n??"",onChange:s,placeholder:r,required:o,disabled:l,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border focus:ring-2
          ${d?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}
          ${u}
        `})]})}function E8({label:e,items:t=[],value:n="",onChange:s,getLabel:r,placeholder:i="Search...",disabled:o=!1,className:l="",required:c=!1,isSubmitted:u=!1,actions:d=null}){const h=u&&c&&!n;return a.jsxs("div",{className:l,children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",c&&a.jsx("span",{className:"text-red-500",children:"*"})]}),d?a.jsx("div",{className:"flex items-center",children:d}):null]}),a.jsx(A7e,{items:t,value:n??"",onChange:s,getLabel:r,placeholder:i,disabled:o,hasError:h})]})}function A7e({items:e=[],value:t="",onChange:n,getLabel:s,placeholder:r="Search...",disabled:i=!1,maxRender:o=200,hasError:l=!1}){const[c,u]=f.useState(!1),[d,h]=f.useState(""),p=f.useRef(null),x=e.find(y=>String(y.id)===String(t)),b=x?s(x):"",j=f.useMemo(()=>{const y=d.trim().toLowerCase();return(y?e.filter(w=>(s(w)||"").toLowerCase().includes(y)):e).slice(0,o)},[e,d,s,o]);return f.useEffect(()=>{const y=N=>{p.current&&!p.current.contains(N.target)&&u(!1)};return document.addEventListener("mousedown",y),()=>document.removeEventListener("mousedown",y)},[]),f.useEffect(()=>{c||h("")},[c]),a.jsxs("div",{ref:p,className:"relative w-full",children:[a.jsx("input",{disabled:i,value:c?d:b,placeholder:r,onFocus:()=>!i&&u(!0),onChange:y=>{h(y.target.value),c||u(!0)},className:`w-full border rounded-md px-2 py-1.5 text-sm outline-none focus:ring-2
          ${l?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}`}),c&&!i&&a.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg overflow-hidden",children:[a.jsx("div",{className:"max-h-56 overflow-y-auto",children:j.length>0?j.map(y=>{const N=String(y.id),w=s(y),S=String(t)===N;return a.jsx("button",{type:"button",onClick:()=>{n(N),u(!1)},className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-50 ${S?"bg-blue-50":""}`,children:w||"--"},N)}):a.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No results"})}),e.length>o&&a.jsxs("div",{className:"px-3 py-2 text-[11px] text-gray-400 border-t",children:["Showing first ",o," results  keep typing to narrow."]})]})]})}function T7e({label:e,name:t,value:n,onChange:s,placeholder:r,rows:i=3,disabled:o=!1,className:l=""}){return a.jsxs("div",{className:l,children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsx("textarea",{name:t,value:n??"",onChange:s,placeholder:r,rows:i,disabled:o,className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100 resize-none"})]})}function k7e({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o=!1,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":i==="archive"?"bg-orange-500 hover:bg-orange-600 border border-orange-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsx("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${u}`,disabled:o,children:o?"Processing...":s})]})]})})}const sT=e=>e?new Date(e).toLocaleString("en-US",{month:"short",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).replace(",",""):"";function kJ({lead:e,onBack:t,fetchLeads:n,onEdit:s,onArchive:r,setSelectedLead:i,relatedActs:o}){const l=Et(),{leadID:c}=Wo(),{user:u}=Gt(),[d,h]=f.useState(e||null),[p,x]=f.useState("Overview"),[b,j]=f.useState(""),y=d?.status?.toUpperCase()==="QUALIFIED",[N,w]=f.useState(null),S=d&&u&&d.creator?.id===u.id,[_,T]=f.useState({name:"",website:"",countryCode:"",phone_number:"",billing_address:"",shipping_address:"",industry:"",status:"Prospect",territory_id:null,assigned_to:null,created_by:null}),[k,A]=f.useState({last_name:"",first_name:"",account_id:null,title:"",department:"",email:"",work_phone:"",mobile_phone_1:"",mobile_phone_2:"",notes:"",assigned_to:null,created_by:null}),[E,M]=f.useState({name:"Converted from Lead",account_id:null,primary_contact_id:null,stage:"Prospecting",probability:10,amount:0,currency:"PHP",description:"Initial deal from lead conversion.",assigned_to:null,created_by:null}),F=async()=>{try{if(e){h(e),j(e.status||"New");return}if(!c)return;const $=await ne.get(`/leads/get/${c}`);h($.data),j($.data.status||"New"),T({name:$.data.company_name||"",website:"",countryCode:"+63",phone_number:"",billing_address:"",shipping_address:"",industry:"",status:"Prospect",territory_id:$.data.territory?.id||null,assigned_to:$.data.assigned_to?.id||null,created_by:$.data.creator?.id||null}),A({last_name:$.data.last_name||"",first_name:$.data.first_name||"",account_id:null,title:$.data.title||"",department:$.data.department||"",email:$.data.email||"",work_phone:$.data.work_phone||"",mobile_phone_1:$.data.mobile_phone_1||"",mobile_phone_2:$.data.mobile_phone_2||"",notes:"",assigned_to:$.data.assigned_to?.id||null,created_by:$.data.creator?.id||null}),M({name:"Converted from Lead",account_id:null,primary_contact_id:null,stage:"Prospecting",probability:10,amount:0,currency:"PHP",description:"Initial deal from lead conversion.",assigned_to:$.data.assigned_to?.id||null,created_by:$.data.creator?.id||null})}catch($){console.error($)}};f.useEffect(()=>{e?(h(e),j(e.status||"New")):c&&F()},[c,e]);const D=async()=>{try{if(b==="Converted"&&d?.status?.toUpperCase()!=="QUALIFIED"){V.error("Lead must be Qualified before it can be converted.");return}const $=await ne.put(`/leads/${d.id}/update/status`,{status:b});V.success("Lead status updated successfully");const W={...d,status:$.data.status};h(W),i&&i(W),n&&n(),t&&t()}catch($){console.error($),V.error("Failed to update lead status")}},P=async $=>{const W={..._,assigned_to:$.assigned_to?.id,billing_address:$.address,shipping_address:$.address,created_by:$.creator?.id,industry:null,name:$.company_name,phone_number:$.work_phone,status:"Prospect",territory_id:$.territory?.id,website:""};console.log("Account data: ",W),console.log("Contact data: ",k),console.log("Deal data: ",E),console.log("Lead data: ",$);try{const Q=(await ne.post("/accounts/convertedLead",W)).data.id,le={...k,account_id:Q,assigned_to:$.assigned_to?.id,created_by:$.creator?.id,department:$.department,email:$.email,first_name:$.first_name,last_name:$.last_name,mobile_phone_1:$.mobile_phone_1,mobile_phone_2:$.mobile_phone_2,notes:$.notes,title:$.title,work_phone:$.work_phone},J=(await ne.post("/contacts/convertedLead",le)).data.id,se=()=>{switch(E.stage){case"PROSPECTING":return 10;case"QUALIFICATION":return 25;case"PROPOSAL":return 60;case"NEGOTIATION":return 80;case"CLOSED_WON":return 100;case"CLOSED_LOST":return 0;default:return 0}},ye=E.amount&&E.amount!==""?parseFloat(E.amount):0,Ce={...E,account_id:Q,assigned_to:$.assigned_to?.id,created_by:$.creator?.id,primary_contact_id:J,probability:se(),stage:"Prospecting"},ge=await ne.post("/deals/convertedLead",Ce),be=await ne.put(`/leads/convert/${$.id}`);i&&i(null),n(),V.success("Lead converted successfully!"),t()}catch(Z){console.error("Error during conversion:",Z);const Q=Z.response?.data?.detail||Z.message||"Failed to convert lead. Please try again.";V.error(Q)}},B=$=>{switch(($||"").toUpperCase()){case"NEW":return"bg-indigo-100 text-indigo-700";case"CONTACTED":return"bg-blue-100 text-blue-700";case"QUALIFIED":return"bg-green-100 text-green-700";case"CONVERTED":return"bg-emerald-100 text-emerald-700";case"LOST":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-700"}},G=$=>$.toString().toLowerCase().replace(/\b\w/g,W=>W.toUpperCase());return d?a.jsx(a.Fragment,{children:a.jsx("div",{className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-lg w-full max-w-full sm:max-w-6xl max-h-[90vh] overflow-y-auto hide-scrollbar relative box-border",children:[a.jsx("div",{className:"bg-tertiary w-full rounded-t-xl p-3 lg:p-3",children:a.jsxs("div",{className:"flex items-start justify-between w-full",children:[a.jsx("h1",{className:"lg:text-3xl text-xl text-white font-semibold text-center w-full",children:"Lead"}),a.jsx("button",{onClick:()=>{t?t():l(-1)},className:"text-gray-400 hover:text-white mt-1 cursor-pointer",children:a.jsx(Za,{size:25})})]})}),a.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between lg:flex-row lg:items-center lg:justify-between mt-3 gap-2 px-2 md:items-center lg:gap-4 md:mx-7 lg:mx-7",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[a.jsxs("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-800",children:[d.first_name," ",d.last_name]}),a.jsx("span",{className:`text-xs sm:text-sm font-medium px-2 sm:px-3 py-1 rounded-full whitespace-nowrap ${B(d.status)}`,children:G(d.status||"New")}),a.jsx("div",{className:"flex flex-col",children:a.jsx("button",{onClick:()=>P(d),disabled:!y,title:y?"Convert Lead":"Lead must be Qualified before converting",className:`px-3 sm:px-4 py-1.5 sm:py-2 rounded-md font-medium text-xs sm:text-sm transition focus:outline-none focus:ring-2
      ${y?"bg-green-600 hover:bg-green-700 text-white focus:ring-green-400":"bg-gray-200 text-gray-400 cursor-not-allowed"}
    `,children:"Convert"})})]}),S&&a.jsxs("div",{className:"flex flex-col sm:flex-row sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsxs("button",{type:"button",onClick:()=>{s&&d&&s(d)},className:"inline-flex items-center justify-center w-full sm:w-auto bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 transition text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",children:[a.jsx(hn,{className:"mr-2"}),"Edit"]}),a.jsxs("button",{type:"button",onClick:()=>{r&&d&&r(d)},className:"inline-flex items-center justify-center w-full sm:w-auto px-4 py-2 rounded-md text-sm bg-orange-500 text-white hover:bg-orange-600 transition focus:outline-none focus:ring-2 focus:ring-orange-400",children:[a.jsx(Zt,{className:"mr-2"}),"Archive"]})]})]}),a.jsx("div",{className:"border-b border-gray-200 my-5"}),a.jsxs("div",{className:"p-4 lg:p-4",children:[a.jsx("div",{className:"flex w-full bg-[#6A727D] text-white mt-1 overflow-x-auto mb-6",children:["Overview","Notes","Activities"].map($=>a.jsx("button",{onClick:()=>x($),className:`flex-1 min-w-[90px] px-4 py-2.5 text-xs sm:text-sm font-medium text-center transition-all duration-200 border-b-2
        ${p===$?"bg-paper-white text-[#6A727D] border-white":"text-white hover:bg-[#5c636d]"}`,children:$},$))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 items-start",children:[a.jsxs("div",{className:"lg:col-span-3",children:[p==="Overview"&&a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 md:p-8 border border-gray-200",children:a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4 sm:gap-6 text-sm text-gray-700",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Name:"}),a.jsxs("p",{children:[d.first_name," ",d.last_name||"N/A"]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Company:"}),a.jsx("p",{children:d.company_name||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Job Title:"}),a.jsx("p",{children:d.title||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Department:"}),a.jsx("p",{children:d.department||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Email:"}),a.jsx("p",{children:d.email||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Territory:"}),a.jsx("p",{children:d.territory?.name||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Assigned To:"}),a.jsx("p",{children:d.assigned_to?`${d.assigned_to.first_name} ${d.assigned_to.last_name}`:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created By:"}),a.jsx("p",{children:d.creator?`${d.creator.first_name} ${d.creator.last_name}`:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Work Phone:"}),a.jsx("p",{children:d.work_phone||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Mobile Phone 1:"}),a.jsx("p",{children:d.mobile_phone_1||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Mobile Phone 2:"}),a.jsx("p",{children:d.mobile_phone_2||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Source:"}),a.jsx("p",{children:d.source||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Address:"}),a.jsx("p",{children:d.address||"N/A"})]})]})}),p==="Notes"&&a.jsxs("div",{className:"mt-4 w-full",children:[a.jsx("div",{className:"flex flex-wrap items-center justify-between mb-4 gap-2",children:a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words",children:"Lead Note"})}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 shadow-sm break-words",children:[a.jsx("div",{className:"flex items-start justify-between",children:a.jsx("div",{children:a.jsx("p",{className:"text-sm font-medium text-gray-800 break-words",children:"Note"})})}),a.jsx("div",{className:"mt-3 text-sm text-gray-700 whitespace-pre-wrap break-words",children:d.notes||"No notes available."})]})]}),p==="Activities"&&a.jsxs("div",{className:"space-y-2 w-full h-full max-h-[50dvh] overflow-y-auto bg-gray-50 p-2 hide-scrollbar rounded-lg border border-gray-200 shadow-sm",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words border-b border-gray-300 py-2",children:"Related Activities"}),a.jsxs("div",{className:"space-y-2 text-sm",children:[o.tasks&&o.tasks.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>w(N==="tasks"?null:"tasks"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Qt,{className:"text-blue-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Tasks (",o.tasks.length,")"]})]}),N==="tasks"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),N==="tasks"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:o.tasks.map(($,W)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>l("/manager/tasks",{state:{taskID:$.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-blue-600 mt-1",children:a.jsx(Qt,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:$.subject||$.title||"Task"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:$.description||"No description"}),$.assigned_to&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Assigned:"," ",$.assigned_to.first_name," ",$.assigned_to.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:sT($.due_date||$.created_at)})]},`task-${W}`))})]}),o.meetings&&o.meetings.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>w(N==="meetings"?null:"meetings"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Pt,{className:"text-green-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Meetings (",o.meetings.length,")"]})]}),N==="meetings"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),N==="meetings"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:o.meetings.map(($,W)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>l("/manager/meetings",{state:{meetingID:$.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-green-600 mt-1",children:a.jsx(Pt,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:$.subject||$.title||"Meeting"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:$.description||$.location||"No description"}),$.host&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Host: ",$.host.first_name," ",$.host.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:sT($.start_time||$.created_at)})]},`meeting-${W}`))})]}),o.calls&&o.calls.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>w(N==="calls"?null:"calls"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(It,{className:"text-purple-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Calls (",o.calls.length,")"]})]}),N==="calls"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),N==="calls"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:o.calls.map(($,W)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>l("/manager/calls",{state:{callID:$.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-purple-600 mt-1",children:a.jsx(It,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:$.subject||$.title||"Call"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:$.direction||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:sT($.call_time||$.created_at)})]},`call-${W}`))})]}),(!o||(!o.tasks||o.tasks.length===0)&&(!o.meetings||o.meetings.length===0)&&(!o.calls||o.calls.length===0)&&(!o.quotes||o.quotes.length===0)&&(!o.deals||o.deals.length===0)&&(!o.contacts||o.contacts.length===0))&&a.jsx("div",{className:"text-center py-8 text-gray-500",children:a.jsx("p",{children:"No related activities found for this account."})})]})]})]}),a.jsxs("div",{className:"flex flex-col gap-4",children:[a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Quick Actions"}),a.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[a.jsxs("button",{onClick:()=>{d&&l("/manager/calls",{state:{openCallModal:!0,initialCallData:{subject:d.title?`Call regarding ${d.title}`:`Call with ${d.first_name} ${d.last_name}`,relatedType1:"Lead",relatedTo1:String(d.id),relatedType2:null,relatedTo2:null,assigned_to:d.assigned_to?.id?String(d.assigned_to.id):"",direction:"Outgoing",status:"Planned"}}})},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(It,{className:"text-gray-600 w-4 h-4"}),"Schedule Call"]}),a.jsxs("button",{type:"button",onClick:()=>{if(!d?.email){alert("No email address available");return}const $=encodeURIComponent(d.email),W=encodeURIComponent(""),Z=encodeURIComponent(""),Q=`mailto:${$}?subject=${W}&body=${Z}`;window.location.href=Q},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(sn,{className:"text-gray-600 w-4 h-4"}),"Send E-mail"]}),a.jsxs("button",{className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",onClick:()=>{d&&l("/manager/meetings",{state:{openMeetingModal:!0,initialMeetingData:{subject:d.title?`Meeting regarding ${d.title}`:`Meeting with ${d.first_name||""} ${d.last_name||""}`.trim(),relatedType1:"Lead",relatedTo1:String(d.id),relatedType2:null,relatedTo2:null,assignedTo:d.assigned_to?.id?String(d.assigned_to.id):"",status:"Planned"}}})},children:[a.jsx(Pt,{className:"text-gray-600 w-4 h-4"}),"Book Meeting"]}),a.jsxs("button",{onClick:()=>{d&&l("/manager/tasks",{state:{openTaskModal:!0,initialTaskData:{subject:d.title?`Follow up on ${d.title}`:`Follow up with ${d.first_name||""} ${d.last_name||""}`.trim(),relatedType1:"Lead",relatedTo1:String(d.id),relatedType2:null,relatedTo2:null,assignedTo:d.assigned_to?.id?String(d.assigned_to.id):"",priority:"NORMAL",status:"Not Started"}}})},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(Qt,{className:"text-gray-600 w-4 h-4"}),"Tasks"]})]})]}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm w-full",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Status"}),a.jsxs("select",{className:"border border-gray-200 rounded-md px-2 sm:px-3 py-1.5 w-full text-sm mb-2 focus:ring-2 focus:ring-indigo-500 outline-none",value:b,onChange:$=>j($.target.value),children:[a.jsx("option",{value:"New",children:"New"}),a.jsx("option",{value:"Contacted",children:"Contacted"}),a.jsx("option",{value:"Qualified",children:"Qualified"}),d?.status?.toUpperCase()==="QUALIFIED"&&a.jsx("option",{value:"Converted",children:"Converted"}),a.jsx("option",{value:"Lost",children:"Lost"})]}),a.jsx("button",{onClick:D,disabled:b===d.status,className:`w-full py-1.5 rounded-md text-sm transition focus:outline-none focus:ring-2 ${b===d.status?"bg-gray-400 cursor-not-allowed text-white":"bg-gray-900 text-white hover:bg-gray-800 focus:ring-gray-400"}`,children:"Update"})]})]})]})]})]})})}):null}const E7e=oh.all(),rT=E7e.map((e,t)=>({code:`+${e.countryCallingCode}`,name:e.countryCode,id:`${e.countryCallingCode}-${e.countryCode}-${t}`})),L7e=e=>e.toString().toLowerCase().replace(/\b\w/g,t=>t.toUpperCase()),D7e=e=>{switch(e.toUpperCase()){case"NEW":return"bg-indigo-100 text-indigo-700";case"CONTACTED":return"bg-blue-100 text-blue-700";case"QUALIFIED":return"bg-green-100 text-green-700";case"CONVERTED":return"bg-emerald-100 text-emerald-700";case"LOST":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-700"}},iT={first_name:"",last_name:"",company_name:"",title:"",department:"",email:"",work_ccode:"+63",work_phone:"",m1_ccode:"+63",mobile_phone_1:"",m2_ccode:"+63",mobile_phone_2:"",address:"",notes:"",source:"",territory_id:null,lead_owner:null,status:"New"};function P7e(){const e=Et(),{leadID:t}=Wo(),{user:n}=Gt();Bs();const[s,r]=f.useState(null),[i,o]=f.useState(!1),[l,c]=f.useState(null),[u,d]=f.useState(null),[h,p]=f.useState([]),[x,b]=f.useState(!1),[j,y]=f.useState(""),[N,w]=f.useState("Filter by Status"),[S,_]=f.useState(1),[T,k]=f.useState(10),[A,E]=f.useState(iT),[M,F]=f.useState(!1),[D,P]=f.useState(null),[B,G]=f.useState(!1),[$,W]=f.useState(null),[Z,Q]=f.useState(!1),[le,we]=f.useState({}),[J,se]=f.useState(new Set),[ye,Ce]=f.useState(!1),[ge,be]=f.useState(null);f.useRef(null);const[me,Ae]=f.useState(!1),[pe,Ie]=f.useState(null),[xe,he]=f.useState({name:"",website:"",countryCode:"+63",phone_number:"",combinedPhoneNumbers:"",billing_address:"",shipping_address:"",industry:"",status:"Prospect",territory_id:null,assigned_to:null,created_by:null}),[Re,Ee]=f.useState({last_name:"",first_name:"",account_id:null,title:"",department:"",email:"",work_phone:"",mobile_phone_1:"",mobile_phone_2:"",notes:"",assigned_to:null,created_by:null}),[He,Ke]=f.useState({name:"Converted from Lead",account_id:null,primary_contact_id:null,stage:"PROSPECTING",probability:10,amount:0,currency:"PHP",description:"Initial deal from lead conversion.",assigned_to:null,created_by:null});f.useEffect(()=>{document.title="Leads | Sari-Sari CRM"},[]);const st=async()=>{try{const H=await ne.get("/leads/getUsers");c(H.data)}catch(H){console.error(`Error fetching users: ${H}`)}},it=async()=>{b(!0);try{const H=await ne.get("/leads/admin/getLeads");p(H.data),console.log(H.data)}catch(H){console.error(`Error fetching leads: ${H}`)}finally{b(!1)}};f.useEffect(()=>{st(),it()},[]),f.useEffect(()=>{if(t&&h.length>0&&!i&&!M){const H=h.find(te=>te.id===Number(t));H&&r(H)}else!t&&!s&&r(null)},[t,h,i,M]),f.useEffect(()=>{if(pe){const te=(U=>{if(!U)return{code:"+63",number:""};const de=U.match(/^(\+\d+)\s(.+)$/);if(de)return{code:de[1],number:de[2]};if(U.startsWith("+")){const Te=U.match(/^(\+\d{1,3})/);if(Te)return{code:Te[1],number:U.substring(Te[1].length).trim()}}return{code:"+63",number:U}})(pe.work_phone),q=[];pe.work_phone&&q.push(`Work: ${pe.work_phone}`),pe.mobile_phone_1&&q.push(`Mobile 1: ${pe.mobile_phone_1}`),pe.mobile_phone_2&&q.push(`Mobile 2: ${pe.mobile_phone_2}`);const Y=q.length>0?q.join(" | "):"";he({name:pe.company_name||"",website:"",countryCode:te.code,phone_number:te.number,combinedPhoneNumbers:Y,billing_address:pe.address||"",shipping_address:pe.address||"",industry:"",status:"Prospect",territory_id:pe.assigned_to?.territory?.id||null,assigned_to:pe.assigned_to?.id||null,created_by:pe.creator?.id||null}),Ee({last_name:pe.last_name||"",first_name:pe.first_name||"",account_id:null,title:pe.title||"",department:pe.department||"",email:pe.email||"",work_phone:pe.work_phone||"",mobile_phone_1:pe.mobile_phone_1||"",mobile_phone_2:pe.mobile_phone_2||"",notes:pe.notes||"",assigned_to:pe.assigned_to?.id||null,created_by:pe.creator?.id||null}),Ke({name:"Converted from Lead",account_id:null,primary_contact_id:null,stage:"PROSPECTING",probability:10,amount:0,currency:"PHP",description:"Initial deal from lead conversion.",assigned_to:pe.assigned_to?.id||null,created_by:pe.creator?.id||null})}},[pe]);const ot=H=>y(H.target.value),rt=f.useMemo(()=>{const H=j.trim().toLowerCase(),te=N.trim().toUpperCase();let q=h.filter(Y=>{const U=Y?.status!=="Inactive",de=[Y?.first_name,Y?.last_name,Y?.company_name,Y?.title,Y?.email,Y?.work_phone,Y?.assigned_to?`${Y.assigned_to.first_name} ${Y.assigned_to.last_name}`:""],Te=H===""||de.some(Oe=>Oe==null||Oe===""?!1:Oe.toString().toLowerCase().includes(H));let ie=!1;return te==="FILTER BY STATUS"?ie=(Y.status?Y.status.toUpperCase():"")!=="CONVERTED":ie=(Y.status?Y.status.toUpperCase():"")===te,Te&&ie&&U});return q.sort((Y,U)=>{const de=new Date(Y.created_at).getTime();return new Date(U.created_at).getTime()-de}),q},[h,j,N]),at=Math.max(1,Math.ceil(rt.length/T)||1);f.useEffect(()=>{_(1)},[j,N]),f.useEffect(()=>{_(H=>{const te=Math.max(1,Math.ceil(rt.length/T)||1);return H>te?te:H})},[rt.length]);const Je=f.useMemo(()=>{const H=(S-1)*T;return rt.slice(H,H+T)},[rt,S]),Fe=()=>_(H=>Math.max(H-1,1)),Ue=()=>_(H=>Math.min(H+1,at)),Ne=f.useCallback(async H=>{try{const te=await ne.get(`/activities/lead/${H}`);we(te.data&&typeof te.data=="object"?te.data:{})}catch(te){console.error(te),te.response?.status===404&&(console.warn("No activities found for this account."),we({}))}},[]),ze=H=>{r(H),Ne(H.id)},je=()=>{r(null),t&&e("/admin/leads",{replace:!0})},ve=()=>{o(!1),E(iT),F(!1),P(null),G(!1),d(null),sessionStorage.removeItem("editLeadData")},z=H=>{H.target.id==="modalBackdrop"&&ve()},K=()=>{E(iT),F(!1),P(null),d(null),o(!0)},ue=H=>{if(!H){console.error("handleEditClick: lead is null or undefined");return}console.log("handleEditClick called with lead:",H),console.log("Current state - leadID:",t,"selectedLead:",s,"showModal:",i);const te=Te=>{if(!Te)return{code:"+63",number:""};const ie=Te.match(/^(\+\d+)\s(.+)$/);return ie?{code:ie[1],number:ie[2]}:{code:"+63",number:Te}},q=te(H.work_phone),Y=te(H.mobile_phone_1),U=te(H.mobile_phone_2);let de="";if(H.assigned_to){de=String(H.assigned_to.id);const Te=l?.find(ie=>ie.id===H.assigned_to.id);d(Te)}E({first_name:H.first_name||"",last_name:H.last_name||"",company_name:H.company_name||"",title:H.title||"",department:H.department||"",email:H.email||"",work_ccode:q.code,work_phone:q.number,m1_ccode:Y.code,mobile_phone_1:Y.number,m2_ccode:U.code,mobile_phone_2:U.number,address:H.address||"",notes:H.notes||"",source:H.source||"",territory_id:H.territory?.id||null,lead_owner:de,status:H.status||"New"}),F(!0),P(H.id),s?(console.log("Coming from detail view - closing detail modal and showing edit form"),r(null),o(!0)):(console.log("Already in list view - showing modal"),o(!0))},re=H=>{if(!H){console.error("handleArchive: lead is null or undefined");return}const te=`${H.first_name} ${H.last_name}`||"this lead";W({title:"Archive Lead",message:a.jsxs("span",{children:["Are you sure you want to archive"," ",a.jsx("span",{className:"font-semibold",children:te}),"? You can restore it later if needed."]}),confirmLabel:"Archive Lead",cancelLabel:"Cancel",variant:"archive",action:{type:"archive",targetId:H.id,name:te}})},Le=H=>{const te=Je.find(q=>q.id===H);te&&te.creator?.id===n?.id&&se(q=>{const Y=new Set(q);return Y.has(H)?Y.delete(H):Y.add(H),Y})},De=()=>{const H=Je.filter(te=>te.creator?.id===n?.id);J.size===H.length&&H.length>0?se(new Set):se(new Set(H.map(te=>te.id)))},Qe=()=>{if(J.size===0)return;const H=J.size;W({title:"Archive Leads",message:a.jsxs("span",{children:["Are you sure you want to archive"," ",a.jsx("span",{className:"font-semibold",children:H})," lead",H!==1?"s":"","? You can restore them later if needed."]}),confirmLabel:`Archive ${H} Lead${H!==1?"s":""}`,cancelLabel:"Cancel",variant:"archive",action:{type:"bulk-archive",targetIds:Array.from(J),count:H}})},tt=H=>{const{name:te,value:q}=H.target;if(E(Y=>({...Y,[te]:q})),te==="lead_owner"){const Y=l.find(U=>U.id===parseInt(q));d(Y)}},[Me,et]=f.useState(!1),yt=H=>{if(H.preventDefault(),et(!0),!A.last_name?.trim()){V.error("Last name is required.");return}if(!A.email?.trim()){V.error("Email is required.");return}if(!A.email.includes("@")){V.error("Email must contain '@'.");return}if(!A.lead_owner){V.error("Please assign a lead owner.");return}const te={...A,territory_id:A.territory_id?parseInt(A.territory_id):null,lead_owner:parseInt(A.lead_owner),work_phone:`${A.work_ccode} ${A.work_phone}`,mobile_phone_1:`${A.m1_ccode} ${A.mobile_phone_1}`,mobile_phone_2:`${A.m2_ccode} ${A.mobile_phone_2}`},q=M&&D?"update":"create",Y=`${A.first_name} ${A.last_name}`;W({title:q==="create"?"Confirm New Lead":"Confirm Update",message:q==="create"?a.jsxs("span",{children:["Are you sure you want to create a new lead for"," ",a.jsx("span",{className:"font-semibold",children:Y}),"?"]}):a.jsxs("span",{children:["Save changes to ",a.jsx("span",{className:"font-semibold",children:Y}),"?"]}),confirmLabel:q==="create"?"Create Lead":"Update Lead",cancelLabel:"Cancel",variant:"primary",action:{type:q,payload:te,targetId:D||null,name:Y}})},_t=async()=>{if(!$?.action){W(null);return}const{action:H}=$,{type:te,payload:q,targetId:Y,name:U,targetIds:de,count:Te}=H;console.log(q),Q(!0);try{if(te==="create")G(!0),await ne.post("/leads/create",q),V.success(`Lead "${U}" created successfully.`),ve(),await it();else if(te==="update"){if(!Y)throw new Error("Missing lead identifier for update.");G(!0);const ie=await ne.put(`/leads/${Y}`,q);V.success(`Lead "${U}" updated successfully.`),s&&s.id===Y&&r(null),ve(),await it()}else if(te==="archive"){if(!Y)throw new Error("Missing lead identifier for archiving.");const ie=s?.id;be(Y),await ne.put(`/leads/${Y}`,{status:"Inactive"}),V.success(`Lead "${U}" archived successfully.`),await it(),ie===Y&&r(null)}else if(te==="bulk-archive"){if(!de||de.length===0)throw new Error("Missing lead identifiers for bulk archiving.");Ce(!0),await Promise.all(de.map(ie=>ne.put(`/leads/${ie}`,{status:"Inactive"}))),V.success(`${Te} lead${Te!==1?"s":""} archived successfully.`),se(new Set),await it(),r(null)}}catch(ie){console.error(ie);const Oe=te==="create"?"Failed to create lead. Please review the details and try again.":te==="update"?"Failed to update lead. Please review the details and try again.":te==="bulk-archive"?"Failed to archive leads. Please try again.":"Failed to archive lead. Please try again.",X=ie.response?.data?.detail||Oe;V.error(X)}finally{(te==="create"||te==="update")&&G(!1),te==="archive"&&be(null),te==="bulk-archive"&&Ce(!1),te!=="edit"&&(Q(!1),W(null))}},Ct=()=>{Z||W(null)},jt=h.filter(H=>H.status==="New").length,At=h.filter(H=>H.status==="Contacted").length,Ge=h.filter(H=>H.status==="Qualified").length,Be=h.filter(H=>H.status==="Converted").length,ce=h.filter(H=>H.status==="Lost").length,fe=[{title:"New",value:jt,icon:rn,color:"text-indigo-600",bgColor:"bg-indigo-100"},{title:"Contacted",value:At,icon:It,color:"text-blue-600",bgColor:"bg-blue-100"},{title:"Qualified",value:Ge,icon:La,color:"text-green-600",bgColor:"bg-green-100"},{title:"Converted",value:Be,icon:ec,color:"text-emerald-600",bgColor:"bg-emerald-100"},{title:"Lost",value:ce,icon:Yn,color:"text-red-600",bgColor:"bg-red-100"}];return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[x&&a.jsx(qt,{message:"Loading leads..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h1",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(rn,{className:"mr-2 text-blue-600"}),"Leads"]}),a.jsx("div",{className:"flex justify-center lg:justify-end gap-3 w-full sm:w-auto",children:a.jsxs("button",{onClick:()=>{K(),et(!1)},className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 rounded-md hover:bg-gray-800 text-sm sm:text-base self-end sm:self-auto cursor-pointer",children:[a.jsx(aa,{className:"mr-2"})," Add Lead"]})})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 xl:grid-cols-5 gap-4 mb-6 w-full break-words overflow-hidden lg:overflow-visible",children:fe.map(H=>a.jsx(M7e,{...H},H.title))}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search leads",value:j,onChange:ot,className:"focus:outline-none text-base w-full"})]}),a.jsx("div",{className:"w-full lg:w-1/4",children:a.jsxs("select",{value:N,onChange:H=>w(H.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{value:"Filter by Status",children:"Filter by Status"}),a.jsx("option",{value:"New",children:"New"}),a.jsx("option",{value:"Contacted",children:"Contacted"}),a.jsx("option",{value:"Qualified",children:"Qualified"}),a.jsx("option",{value:"Converted",children:"Converted"}),a.jsx("option",{value:"Lost",children:"Lost"})]})})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[500px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 text-sm tracking-wide font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 w-12",children:a.jsx("input",{type:"checkbox",checked:J.size>0&&J.size===Je.filter(H=>H.creator?.id===n?.id).length&&Je.filter(H=>H.creator?.id===n?.id).length>0,onChange:De,className:"w-4 h-4 cursor-pointer"})}),a.jsx("th",{className:"py-3 px-4",children:"Name"}),a.jsx("th",{className:"py-3 px-4",children:"Company"}),a.jsx("th",{className:"py-3 px-4",children:"Job Title"}),a.jsx("th",{className:"py-3 px-4",children:"Email"}),a.jsx("th",{className:"py-3 px-4",children:"Assigned To"}),a.jsx("th",{className:"py-3 px-4",children:"Status"}),a.jsx("th",{className:"py-3 px-4 w-12",children:J.size>0&&a.jsx("button",{onClick:Qe,className:"text-orange-500 hover:text-orange-700 transition",title:"Archive selected leads",disabled:ye,children:a.jsx(Zt,{size:18})})})]})}),a.jsx("tbody",{children:rt.length>0?Je.map(H=>a.jsxs("tr",{className:"hover:bg-gray-50 text-sm cursor-pointer",children:[a.jsx("td",{className:"py-3 px-4",children:n?.id===H.creator?.id&&a.jsx("input",{type:"checkbox",checked:J.has(H.id),onChange:te=>{te.stopPropagation(),Le(H.id)},className:"w-4 h-4 cursor-pointer"})}),a.jsx("td",{className:"py-3 px-4 align-top",onClick:()=>ze(H),children:a.jsxs("div",{className:"font-medium text-blue-600 hover:underline break-all text-sm",children:[H.first_name," ",H.last_name]})}),a.jsx("td",{className:"py-3 px-4 align-top",onClick:()=>ze(H),children:a.jsx("div",{className:"font-medium text-gray-800 text-sm leading-tight",children:H.company_name||"--"})}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",onClick:()=>ze(H),children:H.title||"--"}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",onClick:()=>ze(H),children:H.email||"--"}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",onClick:()=>ze(H),children:H.assigned_to?`${H.assigned_to.first_name} ${H.assigned_to.last_name}`:"--"}),a.jsx("td",{className:"py-3 px-4",onClick:()=>ze(H),children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium whitespace-nowrap ${D7e(H.status||"New")}`,children:L7e(H.status||"New")})}),a.jsx("td",{className:"py-3 px-4"})]},H.id)):a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:8,children:"No leads found."})})})]})}),a.jsx(ca,{className:"mt-4",totalItems:rt.length,pageSize:T,currentPage:S,onPrev:Fe,onNext:Ue,onPageSizeChange:H=>{k(H),_(1)},pageSizeOptions:[10,20,30,40,50],label:"leads"}),i&&a.jsx("div",{id:"modalBackdrop",onClick:z,className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-full sm:max-w-3xl rounded-2xl shadow-lg p-4 sm:p-6 md:p-8 relative border border-gray-200 overflow-y-auto max-h-[90vh] hide-scrollbar",onClick:H=>H.stopPropagation(),children:[a.jsx("button",{onClick:()=>{ve(),et(!1)},className:"absolute top-4 right-4 text-gray-500 hover:text-black transition",children:a.jsx(ea,{size:22})}),a.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800 mb-4 sm:mb-6 flex items-center justify-center",children:M?"Edit Lead":"Add New Lead"}),a.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 text-sm",children:[a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"First Name"}),a.jsx("input",{type:"text",name:"first_name",value:A.first_name,onChange:tt,placeholder:"Joe",className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:["Last Name ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",placeholder:"Smith",name:"last_name",value:A.last_name,onChange:tt,required:!0,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border
                      ${Me&&!A.last_name?.trim()?"border-red-400 focus:ring-red-400":"border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"}
                  focus:ring-2`})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Company "}),a.jsx("input",{type:"text",placeholder:"ABC Company",name:"company_name",value:A.company_name,onChange:tt,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Job Title"}),a.jsx("input",{type:"text",placeholder:"ABC Agenda",name:"title",value:A.title,onChange:tt,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Department"}),a.jsx("input",{type:"text",placeholder:"Sales",name:"department",value:A.department,onChange:tt,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:["Email",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"email",placeholder:"abc@gmail.com",name:"email",value:A.email,onChange:tt,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border
                       ${Me&&!A.email?.trim()?"border-red-400 focus:ring-red-400":"border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"}
                      focus:ring-2`})]}),a.jsxs("div",{className:"flex flex-col col-span-1 md:col-span-2 lg:col-span-1",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Work Phone"}),a.jsxs("div",{className:"w-full border border-gray-300 rounded-md focus-within:ring-2 focus-within:ring-blue-400 outline-none flex flex-row gap-1",children:[a.jsx("select",{name:"work_ccode",value:A.work_ccode,onChange:tt,className:"outline-none cursor-pointer py-1.5 px-2 border-r border-gray-400 text-sm",children:rT.map(H=>a.jsx("option",{value:H.code,children:H.code},H.id))}),a.jsx("input",{type:"text",placeholder:"9----------",name:"work_phone",value:A.work_phone,onChange:tt,className:"w-full outline-none px-2 py-1.5 text-sm"})]})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Mobile Phone 1"}),a.jsxs("div",{className:"w-full border border-gray-300 rounded-md focus-within:ring-2 focus-within:ring-blue-400 outline-none flex flex-row gap-1",children:[a.jsx("select",{name:"m1_ccode",value:A.m1_ccode,onChange:tt,className:"outline-none cursor-pointer py-1.5 px-2 border-r border-gray-400 text-sm",children:rT.map(H=>a.jsx("option",{value:H.code,children:H.code},H.id))}),a.jsx("input",{type:"text",placeholder:"9----------",name:"mobile_phone_1",value:A.mobile_phone_1,onChange:tt,className:"w-full outline-none px-2 py-1.5 text-sm"})]})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Mobile Phone 2"}),a.jsxs("div",{className:"w-full border border-gray-300 rounded-md focus-within:ring-2 focus-within:ring-blue-400 outline-none flex flex-row gap-1",children:[a.jsx("select",{name:"m2_ccode",value:A.m2_ccode,onChange:tt,className:"outline-none cursor-pointer py-1.5 px-2 border-r border-gray-400 text-sm",children:rT.map(H=>a.jsx("option",{value:H.code,children:H.code},H.id))}),a.jsx("input",{type:"text",placeholder:"9----------",name:"mobile_phone_2",value:A.mobile_phone_2,onChange:tt,className:"w-full outline-none px-2 py-1.5 text-sm"})]})]}),a.jsxs("div",{className:"flex flex-col col-span-1 sm:col-span-2 lg:col-span-3",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Address"}),a.jsx("input",{type:"text",name:"address",value:A.address,onChange:tt,placeholder:"Street No., Street Name, City, State/Province, Postal Code",className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"})]}),a.jsxs("div",{className:"flex flex-col col-span-1 md:col-span-2 lg:col-span-1",children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:["Assign To ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("div",{className:`w-full rounded-lg ${Me&&!A.lead_owner?"border border-red-400":"border border-gray-300"}`,children:a.jsx(I7e,{items:Array.isArray(l)?l:[],value:A.lead_owner??"",placeholder:"Search a user...",getLabel:H=>`${H.first_name} ${H.last_name}`,onChange:H=>{const te=l.find(Y=>String(Y.id)===String(H));d(te);let q=null;te&&te.assigned_territory&&te.assigned_territory.length===1&&(q=te.assigned_territory[0].id),E(Y=>({...Y,lead_owner:H,territory_id:q}))}})})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Territory"}),a.jsxs("select",{name:"territory_id",value:A.territory_id||"",onChange:tt,disabled:!u||!u.assigned_territory||u.assigned_territory.length===0,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm bg-white focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100 disabled:text-gray-500",children:[a.jsx("option",{value:"",disabled:!0,children:u?u.assigned_territory&&u.assigned_territory.length>0?"Select Territory":"No territories assigned to this user":"Select a user first"}),u&&u.assigned_territory&&u.assigned_territory.map(H=>a.jsx("option",{value:H.id,children:H.name},H.id))]})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Source"}),a.jsxs("select",{className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none",defaultValue:"",name:"source",value:A.source,onChange:tt,children:[a.jsx("option",{value:"",disabled:!0,children:"Select Source"}),a.jsx("option",{value:"Website",children:"Website"}),a.jsx("option",{value:"Referral",children:"Referral"}),a.jsx("option",{value:"Cold call",children:"Cold call"}),a.jsx("option",{value:"Event",children:"Event"}),a.jsx("option",{value:"Other",children:"Other"})]})]}),a.jsxs("div",{className:"flex flex-col col-span-1 sm:col-span-2 lg:col-span-3",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Notes"}),a.jsx("textarea",{placeholder:"Additional details...",name:"notes",value:A.notes,onChange:tt,rows:3,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none resize-none"})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-2 mt-4 col-span-1 sm:col-span-2 lg:col-span-3",children:[a.jsx("button",{type:"button",onClick:()=>{ve(),et(!1)},className:"w-full sm:w-auto px-4 py-2 text-white bg-red-400 border border-red-300 rounded hover:bg-red-500 transition disabled:opacity-70",disabled:B||Z,children:"Cancel"}),a.jsx("button",{type:"submit",onClick:yt,className:"w-full sm:w-auto px-4 py-2 text-white border border-tertiary bg-tertiary rounded hover:bg-secondary transition disabled:opacity-70",disabled:B||Z,children:B||Z?"Processing...":M?"Update Lead":"Save Lead"})]})]})]})}),$&&a.jsx(O7e,{open:!0,title:$.title,message:$.message,confirmLabel:$.confirmLabel,cancelLabel:$.cancelLabel,variant:$.variant,onConfirm:_t,onCancel:Ct,loading:Z}),s&&!i&&!M&&a.jsx(kJ,{relatedActs:le,lead:s,onBack:je,fetchLeads:it,setSelectedLead:r,onEdit:ue,onArchive:re})]})}function O7e({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o=!1,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":i==="archive"?"bg-orange-500 hover:bg-orange-600 border border-orange-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsx("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${u}`,disabled:o,children:o?"Processing...":s})]})]})})}function M7e({icon:e,title:t,value:n,color:s="text-blue-600",bgColor:r="bg-blue-100",onClick:i}){const o=()=>{typeof i=="function"?i():console.log(`Clicked: ${t}`)};return a.jsxs("div",{className:"flex items-center p-4 bg-white rounded-xl shadow-md border border-gray-200 transition-all duration-300",onClick:o,children:[a.jsx("div",{className:`flex-shrink-0 p-3 rounded-full ${r} ${s} mr-4`,children:e?a.jsx(e,{size:22}):null}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:t}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:n})]})]})}function I7e({items:e=[],value:t="",onChange:n,getLabel:s,placeholder:r="Search...",disabled:i=!1,maxRender:o=200}){const[l,c]=f.useState(!1),[u,d]=f.useState(""),h=f.useRef(null),p=e.find(j=>String(j.id)===String(t)),x=p?s(p):"",b=f.useMemo(()=>{const j=u.trim().toLowerCase();return(j?e.filter(N=>(s(N)||"").toLowerCase().includes(j)):e).slice(0,o)},[e,u,s,o]);return f.useEffect(()=>{const j=y=>{h.current&&!h.current.contains(y.target)&&c(!1)};return document.addEventListener("mousedown",j),()=>document.removeEventListener("mousedown",j)},[]),f.useEffect(()=>{l||d("")},[l]),a.jsxs("div",{ref:h,className:"relative w-full",children:[a.jsx("input",{disabled:i,value:l?u:x,placeholder:r,onFocus:()=>!i&&c(!0),onChange:j=>{d(j.target.value),l||c(!0)},className:"w-full rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100"}),l&&!i&&a.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg overflow-hidden",children:[a.jsx("div",{className:"max-h-56 overflow-y-auto",children:b.length>0?b.map(j=>{const y=String(j.id),N=s(j),w=String(t)===y;return a.jsx("button",{type:"button",onClick:()=>{n(y),c(!1)},className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-50 ${w?"bg-blue-50":""}`,children:N||"--"},y)}):a.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No results"})}),e.length>o&&a.jsxs("div",{className:"px-3 py-2 text-[11px] text-gray-400 border-t",children:["Showing first ",o," results  keep typing to narrow."]})]})]})}const Mb={accountName:"Josh Inc.",companyNumber:"09135007323",companyWebsite:"joshenc.com",industry:"Agriculture",billingAddress:"#1 Pilar Las Pinas City",shippingAddress:"#3 BNW ASS-CBN",firstName:"Josh",lastName:"Vergara",department:"Administration",title:"CEO",workPhone:"09253677323",email:"josh@joshinc.com",mobile1:"09253677323",mobile2:"0907452874",dealName:"Josh Deal",dealAmount:"60.00",stage:"Prospecting",territory:"Cavite",description:"Initial lead conversion deal.",dealTitle:"New Client Agreement"},ts=({label:e,value:t,name:n,className:s=""})=>a.jsxs("div",{className:`flex flex-col ${s}`,children:[a.jsx("label",{className:"text-xs text-gray-500 mb-1",children:e}),a.jsx("input",{type:"text",name:n,defaultValue:t,readOnly:!0,className:"w-full border border-gray-300 p-2 rounded-lg text-sm focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 outline-none bg-gray-50"})]}),$7e=({data:e})=>a.jsxs("div",{className:"space-y-6 p-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-700",children:"Account Information"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsx(ts,{label:"Company Number",name:"companyNumber",value:e.companyNumber}),a.jsx(ts,{label:"Company Website",name:"companyWebsite",value:e.companyWebsite}),a.jsx(ts,{label:"Industry",name:"industry",value:e.industry})]}),a.jsx(ts,{label:"Billing Address",name:"billingAddress",value:e.billingAddress,className:"col-span-3"}),a.jsx(ts,{label:"Shipping Address",name:"shippingAddress",value:e.shippingAddress,className:"col-span-3"})]}),R7e=({data:e})=>a.jsxs("div",{className:"space-y-6 p-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-700",children:"Contact Information"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx(ts,{label:"First Name",name:"firstName",value:e.firstName}),a.jsx(ts,{label:"Last Name",name:"lastName",value:e.lastName}),a.jsx(ts,{label:"Department",name:"department",value:e.department}),a.jsx(ts,{label:"Title",name:"title",value:e.title}),a.jsx(ts,{label:"Work Phone",name:"workPhone",value:e.workPhone}),a.jsx(ts,{label:"Email",name:"email",value:e.email}),a.jsx(ts,{label:"Mobile Number 1",name:"mobile1",value:e.mobile1}),a.jsx(ts,{label:"Mobile Number 2",name:"mobile2",value:e.mobile2})]})]}),z7e=({data:e})=>a.jsxs("div",{className:"space-y-6 p-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-700",children:"Deal"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx(ts,{label:"Deal Name",name:"dealName",value:e.dealName}),a.jsxs("div",{className:"flex",children:[a.jsx(ts,{label:"Deal Amount",name:"dealAmount",value:e.dealAmount,className:"flex-grow"}),a.jsx("div",{className:"flex flex-col justify-end ml-1",children:a.jsx("span",{className:"text-sm font-medium text-gray-600 border border-gray-300 bg-gray-100 p-2 rounded-r-lg h-10 flex items-center",children:"PHP"})})]}),a.jsx(ts,{label:"Stage",name:"stage",value:e.stage}),a.jsx(ts,{label:"Territory",name:"territory",value:e.territory})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx(ts,{label:"Description",name:"description",value:e.description}),a.jsx(ts,{label:"Title",name:"dealTitle",value:e.dealTitle})]})]});function F7e({isOpen:e,onClose:t}){const[n,s]=f.useState(1),r=3;if(!e)return null;const i=()=>{n<r?s(n+1):(t(),s(1))},o=()=>{n>1&&s(n-1)},l=[{id:1,name:"Account"},{id:2,name:"Contact"},{id:3,name:"Deal"}],c=()=>{switch(n){case 1:return a.jsx($7e,{data:Mb});case 2:return a.jsx(R7e,{data:Mb});case 3:return a.jsx(z7e,{data:Mb});default:return null}};return a.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-[800px] h-[600px] overflow-hidden flex flex-col",children:[a.jsxs("div",{className:"p-6 border-b border-gray-200 flex justify-between items-start",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wider",children:"Convert Lead"}),a.jsx("h1",{className:"text-2xl font-bold text-gray-900 mt-1",children:Mb.accountName})]}),a.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition",children:a.jsx($N,{className:"w-6 h-6"})})]}),a.jsx("div",{className:"flex border-b border-gray-200 bg-gray-50",children:l.map(u=>a.jsx("button",{onClick:()=>s(u.id),className:`flex-1 py-3 px-6 text-sm font-medium transition ${n===u.id?"bg-white text-gray-800 border-b-2 border-indigo-600":"bg-gray-600 text-white hover:bg-gray-700"}`,children:u.name},u.id))}),a.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:c()}),a.jsxs("div",{className:"p-4 border-t border-gray-200 bg-gray-50 flex justify-end space-x-3",children:[n>1&&a.jsx("button",{onClick:o,className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-100 flex items-center",children:"Cancel"}),n<r?a.jsx("button",{onClick:i,className:"px-5 py-2 text-white bg-gray-900 rounded-xl hover:bg-gray-800 transition",children:"Next"}):a.jsx("button",{onClick:i,className:"px-5 py-2 text-white bg-gray-900 rounded-xl hover:bg-gray-800 transition",children:"Convert"})]})]})})}function EJ({selectedDeal:e,onStatusUpdate:t,onClose:n}){const[s,r]=f.useState(e?.stage||""),[i,o]=f.useState(!1),l=Et(),{user:c}=Gt();f.useEffect(()=>{console.log("ManagerDealsInformation mounted sahdksd",e),console.log("User sadad:",c)},[e,c]);const u=[{value:"PROSPECTING",label:"Prospecting"},{value:"QUALIFICATION",label:"Qualification"},{value:"PROPOSAL",label:"Proposal"},{value:"NEGOTIATION",label:"Negotiation"},{value:"CLOSED_WON",label:"Closed Won"},{value:"CLOSED_LOST",label:"Closed Lost"}];f.useEffect(()=>{e?.stage&&r(e.stage)},[e]);const d=async()=>{if(!e||!e.id){V.error("No deal selected");return}if(!s||s===e.stage){V.info("Please select a different stage");return}const h=e.id;o(!0);try{await ne.put(`/deals/admin/${h}`,{stage:s}),n&&n(),t&&setTimeout(async()=>{await t(!0)},100),setTimeout(()=>{V.success("Deal status updated successfully")},300)}catch(p){console.error(p);const x=p.response?.data?.detail||"Failed to update deal status";V.error(x)}finally{o(!1)}};return e?a.jsxs("div",{className:"space-y-4 font-inter text-[13px] w-full sm:w-[85%] mx-auto flex flex-col gap-4",children:[a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Quick Actions"}),a.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[a.jsxs("button",{onClick:()=>{const h=e.account?.id||e.account_id;l("/manager/calls",{state:{openCallModal:!0,initialCallData:{subject:e.name?`Call regarding: ${e.name}`:"",relatedType1:"Account",relatedTo1:h,relatedType2:"Deal",relatedTo2:e.id,contactId:e.contact?.id,assigned_to:e.assigned_deals?.id?String(e.assigned_deals.id):"",assignedTo:e.assigned_to?.id?String(e.assigned_to.id):""}}})},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(It,{className:"text-gray-600 w-4 h-4"}),"Schedule Call"]}),a.jsxs("button",{type:"button",onClick:()=>{if(!e.contact?.email){alert("No email address available");return}const h=encodeURIComponent(e.contact.email),p=encodeURIComponent(""),x=encodeURIComponent(""),b=`mailto:${h}?subject=${p}&body=${x}`;window.location.href=b},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(sn,{className:"text-gray-600 w-4 h-4"}),"Send E-mail"]}),a.jsxs("button",{className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",onClick:()=>{const h=e.account?.id||e.account_id;l("/manager/meetings",{state:{openMeetingModal:!0,initialMeetingData:{subject:e.name?`Meeting: ${e.name}`:"",relatedType1:"Account",relatedTo1:h,relatedType2:"Deal",relatedTo2:e.id,assignedTo:e.assigned_deals?.id?String(e.assigned_deals.id):""}}})},children:[a.jsx(Pt,{className:"text-gray-600 w-4 h-4"}),"Book Meeting"]}),a.jsxs("button",{onClick:()=>{const h=e.account?.id||e.account_id;l("/manager/tasks",{state:{openTaskModal:!0,initialTaskData:{subject:e.name?`Task for: ${e.name}`:"",relatedType1:"Account",relatedTo1:h,relatedType2:"Deal",relatedTo2:e.id,contactId:e.contact?.id,assignedTo:e.assigned_deals?.id?String(e.assigned_deals.id):"",priority:"NORMAL",status:"Not Started"}}})},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(Qt,{className:"text-gray-600 w-4 h-4"}),"Tasks"]})]})]}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm w-full",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Promote Deal"}),a.jsx("select",{className:"border border-gray-200 rounded-md px-2 sm:px-3 py-1.5 w-full text-sm mb-2 focus:ring-2 focus:ring-gray-300 focus:outline-none",value:s,onChange:h=>r(h.target.value),disabled:i||e.created_by!==c?.id&&e.assigned_to!==c?.id,children:u.map(h=>a.jsx("option",{value:h.value,children:h.label},h.value))}),(e.created_by===c?.id||e.assigned_to===c?.id)&&a.jsx("button",{className:"w-full bg-gray-900 text-white py-1.5 rounded-md text-sm hover:bg-gray-800 transition disabled:opacity-50 disabled:cursor-not-allowed",onClick:d,disabled:i||!s||s===e.stage,children:i?"Updating...":"Update"})]})]}):null}function LJ({selectedDeal:e,relatedActs:t={},show:n,onClose:s,activeTab:r,setActiveTab:i,onEdit:o,onDelete:l,onStatusUpdate:c}){const u=Et(),[d]=Bs(),h=d.get("id"),[p,x]=f.useState(e||null),[b,j]=f.useState(r||"Overview"),[y,N]=f.useState(null),{user:w}=Gt(),{comments:S,addComment:_,refresh:T}=kn({relatedType:"deal",relatedId:p?.id});f.useEffect(()=>{p?.id&&T()},[p?.id,T]);const k=r!==void 0?r:b,A=(()=>{const D=String(w?.role||"").toLowerCase();return D==="ceo"||D==="admin"?"admin":D==="manager"?"manager":D==="sales"?"sales":D==="group manager"||D==="group_manager"||D==="group-manager"?"group-manager":"guest"})();if(f.useEffect(()=>{(async()=>{if(h&&!e)try{const G=((await ne.get("/deals/admin/fetch-all")).data||[]).find($=>$.id===parseInt(h));if(G){const $={...G,amount:typeof G.amount=="number"?G.amount:parseFloat(G.amount||0),probability:G.probability||0};x($)}else console.warn("Deal not found with ID:",h)}catch(P){console.error("Error fetching deal:",P)}})()},[h,e]),!p&&!h||h&&!p)return null;const E=D=>({PROSPECTING:"bg-blue-100 text-blue-700",QUALIFICATION:"bg-yellow-100 text-yellow-700",PROPOSAL:"bg-orange-100 text-orange-700",NEGOTIATION:"bg-purple-100 text-purple-700",CLOSED_WON:"bg-green-100 text-green-700",CLOSED_LOST:"bg-red-100 text-red-700"})[D]||"bg-gray-100 text-gray-700",M=D=>{if(!D)return"";const P=String(D).split("-");return P.length===3?`${P[0]}-${P[2]}`:String(D)},F=D=>D?new Date(D).toLocaleString("en-US",{month:"short",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).replace(",",""):"";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[9999] font-inter p-2 sm:p-4 overflow-x-hidden",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-lg w-full max-w-full sm:max-w-6xl max-h-[90vh] overflow-y-auto hide-scrollbar relative box-border",children:[a.jsx("div",{className:"bg-tertiary w-full rounded-t-xl p-3 lg:p-3",children:a.jsxs("div",{className:"flex items-start justify-between w-full",children:[a.jsx("h1",{className:"lg:text-3xl text-xl text-white font-semibold text-center w-full",children:"Deal"}),a.jsx("div",{className:"flex items-center gap-2 sm:gap-3",children:a.jsx("button",{onClick:()=>{s?s():u(-1)},className:"text-gray-400 hover:text-white mt-1 cursor-pointer",children:a.jsx(ea,{size:25})})})]})}),a.jsx("div",{className:"p-4 lg:p-2 lg:mx-7",children:a.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-2 sm:gap-3 mt-3",children:[a.jsxs("div",{className:"flex flex-col gap-1",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3 lg:gap-1",children:[a.jsxs("h2",{className:"text-xl lg:text-xl font-semibold text-gray-800 break-words",children:[M(p.deal_id)," - ",p.name]}),a.jsx("span",{className:`text-xs sm:text-sm inline-block font-medium px-1.5 py-0.5 sm:px-3 sm:py-1 rounded-full break-words ${E(p.stage)}`,children:p.stage})]}),a.jsxs("p",{className:"text-gray-500 text-sm break-words",children:["Created on ",F(p.created_at)]})]}),a.jsxs("div",{className:"flex flex-col items-end gap-2",children:[a.jsxs("h2",{className:"text-xl sm:text-2xl font-bold text-gray-600 break-words",children:[" ",p.amount?p.amount.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):"0.00"]}),a.jsx("div",{className:"w-full sm:w-40 bg-gray-200 rounded-full h-2",children:a.jsx("div",{className:"bg-green-500 h-2 rounded-full",style:{width:`${p.probability}%`}})}),a.jsxs("p",{className:"text-xs text-gray-500 break-words",children:[" ",p.probability,"% Complete "]}),p.deal_creator?.id===w?.id&&a.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 mt-3",children:[a.jsxs("button",{type:"button",onClick:()=>{o&&o(p)},className:"inline-flex items-center justify-center bg-blue-500 text-white px-3 sm:px-4 py-1.5 sm:py-2 rounded-md hover:bg-blue-600 transition text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",children:[a.jsx(hn,{className:"mr-1 sm:mr-2",size:16}),a.jsx("span",{className:"hidden sm:inline",children:"Edit"})]}),a.jsxs("button",{type:"button",onClick:()=>{l&&l(p)},className:"inline-flex items-center justify-center px-3 sm:px-4 py-1.5 sm:py-2 rounded-md text-sm bg-orange-500 text-white hover:bg-orange-600 transition focus:outline-none focus:ring-2 focus:ring-orange-400",children:[a.jsx(Zt,{className:"mr-1 sm:mr-2",size:16}),a.jsx("span",{className:"hidden sm:inline",children:"Archive"})]})]})]})]})}),a.jsx("div",{className:"border-b border-gray-200 my-5"}),a.jsxs("div",{className:"p-6 lg:p-4",children:[a.jsx("div",{className:"flex w-full bg-[#6A727D] text-white mt-1 overflow-x-auto mb-6",children:["Overview","Notes","Activities"].map(D=>a.jsx("button",{onClick:()=>{i?i(D):j(D)},className:`flex-1 min-w-[90px] px-4 py-2.5 text-xs sm:text-sm font-medium text-center transition-all duration-200 border-b-2
                ${k===D?"bg-paper-white text-[#6A727D] border-white":"text-white hover:bg-[#5c636d]"}`,children:D},D))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 items-start",children:[a.jsxs("div",{className:"lg:col-span-3 space-y-6",children:[k==="Overview"&&a.jsxs("div",{className:"grid md:grid-cols-2 gap-4 sm:gap-6 w-full",children:[a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 sm:p-5 shadow-sm pb-20 break-words",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 sm:mb-3",children:"Deal Information"}),a.jsxs("p",{className:"text-sm sm:text-sm text-gray-700 mb-2 py-5 break-words",children:[a.jsx("strong",{children:"Description:"})," ",p.description]}),a.jsx("div",{className:"h-px bg-gray-200 w-full"}),a.jsxs("p",{className:"text-sm sm:text-sm text-gray-700 mb-2 py-5 break-words",children:[a.jsx("strong",{children:"Expected Close Date:"})," ",F(p.close_date)||"--"]}),a.jsx("div",{className:"h-px bg-gray-200 w-full"}),a.jsxs("div",{className:"mt-4 py-3 w-full",children:[a.jsxs("div",{className:"relative flex flex-col w-full",children:[a.jsx("div",{className:"absolute top-0 left-0 right-0 flex items-center justify-between w-full",children:(()=>{const D=(p?.stage||"PROSPECTING").toUpperCase(),B=($=>$==="PROSPECTING"?0:$==="QUALIFICATION"?1:$==="PROPOSAL"?2:$==="NEGOTIATION"?3:$==="CLOSED_WON"||$==="CLOSED_LOST"?4:-1)(D);return[0,1,2,3,4].map($=>B===$?"orange":B>$?"green":"gray").map(($,W)=>a.jsxs(wt.Fragment,{children:[a.jsx("div",{className:`relative z-10 w-6 h-6 rounded-full border-2 ${$==="green"?"bg-green-500 border-green-500":$==="orange"?"bg-orange-400 border-orange-400":"bg-gray-300 border-gray-300"}`}),W<4&&a.jsx("div",{className:"flex-grow h-1 bg-gray-200 mx-1 min-w-0"})]},W))})()}),a.jsx("div",{className:"flex justify-between mt-8 gap-2 text-[9px] lg:text-[9px] sm:text-xs text-gray-600 w-full",children:["Prospecting","Qualification","Proposal","Negotiation","Closed"].map((D,P)=>a.jsx("span",{className:"text-center flex-1 break-words",children:D},P))})]}),a.jsx("p",{className:"text-sm text-orange-600 font-medium mt-6 text-center break-words",children:p.stage})]})]}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 sm:p-5 shadow-sm break-words",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-3",children:"Contact Information"}),a.jsxs("div",{className:"text-sm sm:text-sm text-gray-700 space-y-3",children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Account:"})," ",p.account?.name]}),a.jsx("div",{className:"h-px bg-gray-200 w-full"}),a.jsxs("p",{children:[a.jsx("strong",{children:"Primary Contact:"})," ",p.contact?.first_name," ",p.contact?.last_name]}),a.jsx("div",{className:"h-px bg-gray-200 w-full"}),a.jsxs("p",{children:[a.jsx("strong",{children:"Phone:"})," ",p.contact?.work_phone]}),a.jsx("div",{className:"h-px bg-gray-200 w-full"}),a.jsxs("p",{children:[a.jsx("strong",{children:"Email:"})," ",p.contact?.email]}),a.jsx("div",{className:"h-px bg-gray-200 w-full"}),a.jsxs("p",{children:[a.jsx("strong",{children:"Assigned To:"})," ",p.assigned_deals?.first_name," ",p.assigned_deals?.last_name]})]})]})]}),k==="Notes"&&a.jsxs("div",{className:"mt-4 w-full",children:[a.jsx("div",{className:"flex flex-wrap items-center justify-between mb-4 gap-2",children:a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words",children:"Deal Note"})}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 shadow-sm break-words",children:[a.jsx("div",{className:"flex items-start justify-between",children:a.jsx("div",{children:a.jsx("p",{className:"text-sm font-medium text-gray-800 break-words",children:"Note"})})}),a.jsx("div",{className:"mt-3 text-sm text-gray-700 whitespace-pre-wrap break-words",children:p.description||"No notes available."})]}),a.jsx(Tn,{comments:S,onAddComment:_})]}),k==="Activities"&&a.jsxs("div",{className:"space-y-2 w-full h-full max-h-[50dvh] overflow-y-auto bg-gray-50 p-2 hide-scrollbar rounded-lg border border-gray-200 shadow-sm",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words border-b border-gray-300 py-2",children:"Related Activities"}),a.jsxs("div",{className:"space-y-2 text-sm",children:[t.tasks&&t.tasks.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>N(y==="tasks"?null:"tasks"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Qt,{className:"text-blue-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Tasks (",t.tasks.length,")"]})]}),y==="tasks"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),y==="tasks"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:t.tasks.map((D,P)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>u(`/${A}/tasks`,{state:{taskID:D.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-blue-600 mt-1",children:a.jsx(Qt,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:D.subject||D.title||"Task"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:D.description||"No description"}),D.assigned_to&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Assigned: ",D.assigned_to.first_name," ",D.assigned_to.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:F(D.due_date||D.created_at)})]},`task-${P}`))})]}),t.meetings&&t.meetings.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>N(y==="meetings"?null:"meetings"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Pt,{className:"text-green-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Meetings (",t.meetings.length,")"]})]}),y==="meetings"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),y==="meetings"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:t.meetings.map((D,P)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>u(`/${A}/meetings`,{state:{meetingID:D.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-green-600 mt-1",children:a.jsx(Pt,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:D.subject||D.title||"Meeting"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:D.description||D.location||"No description"}),D.host&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Host: ",D.host.first_name," ",D.host.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:F(D.start_time||D.created_at)})]},`meeting-${P}`))})]}),t.calls&&t.calls.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>N(y==="calls"?null:"calls"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(It,{className:"text-purple-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Calls (",t.calls.length,")"]})]}),y==="calls"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),y==="calls"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:t.calls.map((D,P)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>u(`/${A}/calls`,{state:{callID:D.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-purple-600 mt-1",children:a.jsx(It,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:D.subject||D.title||"Call"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:D.direction||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:F(D.call_time||D.created_at)})]},`call-${P}`))})]}),t.quotes&&t.quotes.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>N(y==="quotes"?null:"quotes"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ia,{className:"text-orange-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Quotes (",t.quotes.length,")"]})]}),y==="quotes"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),y==="quotes"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:t.quotes.map((D,P)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>u(`/${A}/quotes`,{state:{quoteID:D.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-orange-600 mt-1",children:a.jsx(ia,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:(D.quote_id?D.quote_id.replace(/Q(\d+)-\d+-/,"Q$1-"):"--")||"Quote"}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:D.status||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:F(D.presented_date)||""})]},`quote-${P}`))})]}),(!t||(!t.tasks||t.tasks.length===0)&&(!t.meetings||t.meetings.length===0)&&(!t.calls||t.calls.length===0)&&(!t.quotes||t.quotes.length===0)&&(!t.deals||t.deals.length===0)&&(!t.contacts||t.contacts.length===0))&&a.jsx("div",{className:"text-center py-8 text-gray-500",children:a.jsx("p",{children:"No related activities found for this account."})})]})]}),k==="Edit"&&a.jsxs("div",{className:"mt-4 space-y-4 w-full",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words",children:"Edit Deal"}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 sm:p-5 shadow-sm w-full",children:[a.jsxs("label",{className:"block mb-3 break-words",children:[a.jsx("span",{className:"text-sm text-gray-700",children:"Deal Name"}),a.jsx("input",{type:"text",className:"mt-1 block w-full border border-gray-200 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-gray-200",defaultValue:p.name})]}),a.jsxs("label",{className:"block mb-3 break-words",children:[a.jsx("span",{className:"text-sm text-gray-700",children:"Description"}),a.jsx("textarea",{className:"mt-1 block w-full border border-gray-200 rounded-md px-3 py-2 text-sm h-24 resize-y focus:outline-none focus:ring-2 focus:ring-gray-200",defaultValue:p.description})]}),a.jsx("button",{className:"bg-gray-900 text-white px-4 py-2 rounded-md hover:bg-gray-800",children:"Save Changes"})]})]})]}),a.jsx("div",{className:"w-full lg:w-auto",children:a.jsx(EJ,{selectedDeal:p,onStatusUpdate:c,onClose:s})})]})]})]})})}function U7e(){f.useEffect(()=>{document.title="Deals | Sari-Sari CRM"},[]);const e=Et(),t=ta(),[n,s]=f.useState(""),[r,i]=f.useState("Filter by Stage"),[o,l]=f.useState("Filter by Owner"),[c,u]=f.useState(null),[d,h]=f.useState("Overview"),[p,x]=f.useState(!1),[b,j]=f.useState(null),[y,N]=f.useState(!1),[w,S]=f.useState(1),[_,T]=f.useState(10),[k,A]=f.useState(!1),[E,M]=f.useState(null),[F,D]=f.useState(!1),[P,B]=f.useState(!1),[G,$]=f.useState(null),[W,Z]=f.useState([]),[Q,le]=f.useState([]),[we,J]=f.useState([]),[se,ye]=f.useState({}),[Ce,ge]=f.useState(null),[be,me]=f.useState(new Set),[Ae,pe]=f.useState(!1),{user:Ie}=Gt();f.useEffect(()=>{const X=t.state,oe=X?.dealID;if(oe&&!X?.openDealModal){ge(oe),e(t.pathname,{replace:!0,state:{}});return}},[t,e]),f.useEffect(()=>{if(Ce&&b?.length>0&&!y){const X=b.find(oe=>oe.id===Ce);X?u(X):V.error("Deal not found."),ge(null)}},[Ce,b,y]);const[xe,he]=f.useState({id:null,name:"",account_id:"",primary_contact_id:"",stage:"PROPOSAL",amount:"",close_date:"",assigned_to:"",currency:"PHP",description:""}),[Re,Ee]=f.useState(null),[He,Ke]=f.useState(null),st="dealDraft:manager/deals",it=3600*1e3,ot=f.useRef(!1),rt=X=>{if(!X)return"";const oe=String(X).split("-");return oe.length===3?`${oe[0]}-${oe[2]}`:String(X)},at=X=>X?new Date(X).toLocaleString("en-US",{month:"short",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).replace(",",""):"";f.useEffect(()=>{if(!ot.current){ot.current=!0;try{const X=sessionStorage.getItem(st);if(!X)return;const oe=JSON.parse(X);if(typeof oe?.ts=="number"&&Date.now()-oe.ts>it){sessionStorage.removeItem(st);return}if(oe?.returnTo&&oe.returnTo!==t.pathname)return;oe?.dealForm&&typeof oe.dealForm=="object"&&he(oe.dealForm),typeof oe?.isEditing=="boolean"&&B(oe.isEditing),oe?.currentDealId!==void 0&&$(oe.currentDealId),x(!0),sessionStorage.removeItem(st)}catch{sessionStorage.removeItem(st)}}},[t.pathname]);const Je=f.useCallback(()=>{try{sessionStorage.setItem(st,JSON.stringify({ts:Date.now(),returnTo:t.pathname,dealForm:xe,isEditing:P,currentDealId:G}))}catch{}},[st,t.pathname,xe,P,G]),Fe=f.useCallback(()=>{Je(),window.open("/manager/accounts?openModal=1","_blank","noopener,noreferrer")},[Je]),Ue=f.useCallback(()=>{Je(),window.open("/manager/contacts?openModal=1","_blank","noopener,noreferrer")},[Je]),Ne={"Prospecting Stage":"PROSPECTING","Qualification Stage":"QUALIFICATION","Proposal Stage":"PROPOSAL","Negotiation Stage":"NEGOTIATION","Closed Won Stage":"CLOSED_WON","Closed Lost Stage":"CLOSED_LOST","Closed Cancelled Stage":"CLOSED_CANCELLED"},ze=X=>({PROSPECTING:"Prospecting",QUALIFICATION:"Qualification",PROPOSAL:"Proposal",NEGOTIATION:"Negotiation",CLOSED_WON:"Closed Won",CLOSED_LOST:"Closed Lost",CLOSED_CANCELLED:"Closed Cancelled"})[X]||X||"--",je=X=>({PROSPECTING:"bg-blue-100 text-blue-700",QUALIFICATION:"bg-yellow-100 text-yellow-700",PROPOSAL:"bg-orange-100 text-orange-700",NEGOTIATION:"bg-purple-100 text-purple-700",CLOSED_WON:"bg-green-100 text-green-700",CLOSED_LOST:"bg-red-100 text-red-700",CLOSED_CANCELLED:"bg-red-100 text-red-700"})[X]||"bg-gray-100 text-gray-700",ve=f.useCallback(async X=>{try{const oe=await ne.get(`/activities/deal/${X}`);ye(oe.data&&typeof oe.data=="object"?oe.data:{})}catch(oe){console.error(oe),oe.response?.status===404&&(console.warn("No activities found for this account."),ye({}))}},[]),z=f.useMemo(()=>{const X=n.trim().toLowerCase(),oe=r.trim(),Pe=o.trim();return(b??[]).filter(Ve=>{const ft=[Ve?.deal_id,rt(Ve?.deal_id),Ve?.id?.toString(),Ve?.name,Ve?.description,Ve?.account?.name,Ve?.contact?.first_name,Ve?.contact?.last_name,ze(Ve?.stage),Ve?.stage,Ve?.amount?.toString(),Ve?.close_date,Ve?.assigned_deals?.first_name,Ve?.assigned_deals?.last_name],St=X===""||ft.some(qe=>qe==null||qe===""?!1:qe.toString().toLowerCase().includes(X)),Ht=oe==="Filter by Stage"||oe===""||Ve.stage===Ne[oe]||Ve.stage===oe,da=Pe==="Filter by Owner"||Pe===""||`${Ve.assigned_deals?.first_name||""} ${Ve.assigned_deals?.last_name||""}`.trim().toLowerCase()===Pe.toLowerCase();return St&&Ht&&da})},[b,n,r,o]),K=Math.max(1,Math.ceil(z.length/_)||1);f.useEffect(()=>{S(1)},[n,r,o]),f.useEffect(()=>{S(X=>{const oe=Math.max(1,Math.ceil(z.length/_)||1);return X>oe?oe:X})},[z.length]);const ue=f.useMemo(()=>{const X=(w-1)*_;return z.slice(X,X+_)},[z,w]),re=()=>S(X=>Math.max(X-1,1)),Le=()=>S(X=>Math.min(X+1,K)),De=()=>{he({id:null,name:"",account_id:"",primary_contact_id:"",stage:"PROPOSAL",amount:"",close_date:"",assigned_to:"",currency:"PHP",description:""}),B(!1),$(null),x(!0)},Qe=async()=>{N(!0);try{const X=await ne.get("/deals/admin/fetch-all"),Pe=[...Array.isArray(X.data)?X.data:[]].sort((Ve,ft)=>{const St=Ve?.created_at?new Date(Ve.created_at).getTime():0;return(ft?.created_at?new Date(ft.created_at).getTime():0)-St});j(Pe)}catch(X){X.response&&X.response.status===403?V.error("Permission denied. Only CEO, Admin, or Group Manager can access this page."):V.error("Failed to fetch deals. Please try again later."),console.error(X)}finally{N(!1)}},tt=async()=>{try{const X=await ne.get("/accounts/admin/fetch-all");Z(Array.isArray(X.data)?X.data:[])}catch(X){console.error(X),X.response?.status===403&&V.warn("Unable to load accounts (permission denied).")}},Me=async()=>{try{const X=await ne.get("/contacts/admin/fetch-all");le(Array.isArray(X.data)?X.data:[])}catch(X){console.error(X),X.response?.status===403&&V.warn("Unable to load contacts (permission denied).")}},et=async()=>{try{const X=await ne.get("/users/all");J(Array.isArray(X.data)?X.data:[])}catch(X){console.error(X),X.response?.status===403&&V.warn("Unable to load users (permission denied).")}};f.useEffect(()=>{Qe(),tt(),Me(),et()},[]);const yt=async X=>{X&&(he({id:X.id||null,name:X.name||"",account_id:X.account_id?.toString()||"",primary_contact_id:X.primary_contact_id?.toString()||"",stage:X.stage||"PROPOSAL",amount:X.amount?.toString()||"",close_date:X.close_date?new Date(X.close_date).toISOString().split("T")[0]:"",assigned_to:X.assigned_to?.toString()||"",currency:X.currency||"PHP",description:X.description||""}),Ee(X.account||null),Ke(X.contact||null),B(!0),$(X.id),u(null),x(!0))},_t=async(X=!1)=>{try{const oe=await ne.get("/deals/admin/fetch-all"),Ve=[...Array.isArray(oe.data)?oe.data:[]].sort((ft,St)=>{const Ht=ft?.created_at?new Date(ft.created_at).getTime():0;return(St?.created_at?new Date(St.created_at).getTime():0)-Ht});if(j(Ve),!X&&c&&c.id){const ft=Ve.find(St=>St.id===c.id);ft&&u({...ft})}}catch(oe){console.error("Failed to refresh deal data:",oe),await Qe()}},Ct=X=>{const oe=X.name.trim();if(!oe){V.error("Deal name is required.");return}if(!X.account_id){V.error("Account is required.");return}const Pe=P&&G?"update":"create",Ve=oe;M({title:Pe==="create"?"Confirm New Deal":"Confirm Update",message:Pe==="create"?a.jsxs("span",{children:["Are you sure you want to create"," ",a.jsx("span",{className:"font-semibold",children:Ve}),"?"]}):a.jsxs("span",{children:["Save changes to ",a.jsx("span",{className:"font-semibold",children:Ve}),"?"]}),confirmLabel:Pe==="create"?"Create Deal":"Update Deal",cancelLabel:"Cancel",variant:"primary",action:{type:Pe,formData:X,targetId:G||null,name:Ve}})},jt=X=>{const oe=ue?.find(Pe=>Pe.id===X);oe&&oe.deal_creator?.id===Ie?.id&&me(Pe=>{const Ve=new Set(Pe);return Ve.has(X)?Ve.delete(X):Ve.add(X),Ve})},At=()=>{const X=ue?.filter(oe=>oe.deal_creator?.id===Ie?.id)||[];be.size===X.length&&X.length>0?me(new Set):me(new Set(X.map(oe=>oe.id)))},Ge=()=>{if(be.size===0)return;const X=be.size;M({title:"Archive Deals",message:a.jsxs("span",{children:["Are you sure you want to archive"," ",a.jsx("span",{className:"font-semibold",children:X})," deal",X!==1?"s":"","? You can restore them later if needed."]}),confirmLabel:`Archive ${X} Deal${X!==1?"s":""}`,cancelLabel:"Cancel",variant:"archive",action:{type:"bulk-archive",targetIds:Array.from(be),count:X}})},Be=X=>{if(!X)return;const oe=X.name||"this deal";M({title:"Archive Deal",message:a.jsxs("span",{children:["Are you sure you want to archive"," ",a.jsx("span",{className:"font-semibold",children:oe}),"? You can restore it later if needed."]}),confirmLabel:"Archive Deal",cancelLabel:"Cancel",variant:"archive",action:{type:"archive",targetId:X.id,name:oe}})},ce=async()=>{if(!E?.action){M(null);return}const{action:X}=E,{type:oe,formData:Pe,targetId:Ve,name:ft}=X;D(!0);try{if(oe==="create"){A(!0);const St={name:Pe.name.trim(),account_id:parseInt(Pe.account_id),primary_contact_id:Pe.primary_contact_id?parseInt(Pe.primary_contact_id):null,stage:Pe.stage,amount:Pe.amount?parseFloat(Pe.amount):null,currency:Pe.currency||"PHP",close_date:Pe.close_date||null,description:Pe.description||null,assigned_to:Pe.assigned_to?parseInt(Pe.assigned_to):null};await ne.post("/deals/admin/create",St),V.success(`Deal "${ft}" created successfully.`),x(!1),await Qe()}else if(oe==="update"){if(!Ve)throw new Error("Missing deal identifier for update.");A(!0);const St={};Pe.name!==void 0&&(St.name=Pe.name.trim()),Pe.account_id!==void 0&&Pe.account_id!==""&&(St.account_id=parseInt(Pe.account_id)),Pe.primary_contact_id!==void 0&&(St.primary_contact_id=Pe.primary_contact_id?parseInt(Pe.primary_contact_id):null),Pe.stage!==void 0&&(St.stage=Pe.stage),Pe.amount!==void 0&&Pe.amount!==""&&(St.amount=parseFloat(Pe.amount)),Pe.currency!==void 0&&(St.currency=Pe.currency),Pe.close_date!==void 0&&(St.close_date=Pe.close_date||null),Pe.description!==void 0&&(St.description=Pe.description||null),Pe.assigned_to!==void 0&&(St.assigned_to=Pe.assigned_to?parseInt(Pe.assigned_to):null),await ne.put(`/deals/admin/${Ve}`,St),V.success(`Deal "${ft}" updated successfully.`),x(!1),await Qe()}else if(oe==="delete"){if(!Ve)throw new Error("Missing deal identifier for deletion.");await ne.delete(`/deals/admin/${Ve}`),V.success(`Deal "${ft}" deleted successfully.`),c?.id===Ve&&u(null),await Qe()}else if(oe==="archive"){if(!Ve)throw new Error("Missing deal identifier for archive.");await ne.put(`/deals/single-archive/${Ve}`),V.success(`Deal "${ft}" archived successfully.`),c?.id===Ve&&u(null),await Qe()}else if(oe==="bulk-archive"){if(pe(!0),!X.targetIds||X.targetIds.length===0)throw new Error("No deals selected for archiving.");await ne.put("/deals/bulk-archive",{deal_ids:X.targetIds}),V.success(`${X.count} deal${X.count!==1?"s":""} archived successfully.`),me(new Set),c&&X.targetIds.includes(c.id)&&u(null),await Qe()}}catch(St){console.error(St);const Ht=oe==="create"?"Failed to create deal. Please review the details and try again.":oe==="update"?"Failed to update deal. Please review the details and try again.":oe==="bulk-archive"?"Failed to archive deals. Please try again.":oe==="archive"?"Failed to archive deal. Please try again.":"Failed to delete deal. Please try again.",da=St.response?.data?.detail||Ht;V.error(da)}finally{(oe==="create"||oe==="update")&&A(!1),oe==="bulk-archive"&&pe(!1),D(!1),M(null)}},fe=()=>{F||M(null)},H=()=>{x(!1),he({id:null,name:"",account_id:"",primary_contact_id:"",stage:"PROPOSAL",amount:"",close_date:"",assigned_to:"",currency:"PHP",description:""}),Ee(null),Ke(null),B(!1),$(null),A(!1)},te=(b??[]).filter(X=>X.stage==="PROSPECTING").length,q=(b??[]).filter(X=>X.stage==="QUALIFICATION").length,Y=(b??[]).filter(X=>X.stage==="PROPOSAL").length,U=(b??[]).filter(X=>X.stage==="NEGOTIATION").length,de=(b??[]).filter(X=>X.stage==="CLOSED_WON").length,Te=(b??[]).filter(X=>X.stage==="CLOSED_LOST").length,ie=(b??[]).filter(X=>X.stage==="CLOSED_CANCELLED").length,Oe=[{title:"Prospecting",value:te,icon:Nj,color:"text-blue-600",bgColor:"bg-blue-100"},{title:"Qualification",value:q,icon:gn,color:"text-yellow-600",bgColor:"bg-yellow-100"},{title:"Proposal",value:Y,icon:sa,color:"text-orange-600",bgColor:"bg-orange-100"},{title:"Negotiation",value:U,icon:cd,color:"text-purple-600",bgColor:"bg-purple-100"},{title:"Closed Won",value:de,icon:La,color:"text-green-600",bgColor:"bg-green-100"},{title:"Closed Lost",value:Te,icon:Yn,color:"text-red-600",bgColor:"bg-red-100"},{title:"Closed Cancelled",value:ie,icon:Yn,color:"text-gray-600",bgColor:"bg-gray-100"}];return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[y&&a.jsx(qt,{message:"Loading deals..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h1",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(sa,{className:"mr-2 text-blue-600"}),"Deals"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{onClick:De,className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 lg:my-0 rounded-md hover:bg-gray-800 text-sm sm:text-base mx-auto sm:ml-auto cursor-pointer",children:[a.jsx(aa,{className:"mr-2"})," Add Deal"]})})]}),a.jsx("div",{className:"grid grid-cols-1 p-2 lg:grid-cols-4 gap-4 mb-6 w-full break-words overflow-hidden",children:Oe.map(X=>a.jsx(H7e,{...X},X.title))}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search deals",value:n,onChange:X=>s(X.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsxs("div",{className:"w-full lg:w-auto flex flex-col lg:flex-row gap-3",children:[a.jsxs("select",{value:r,onChange:X=>i(X.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full lg:w-40 focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{value:"Filter by Stage",children:"Filter by Stage"}),a.jsx("option",{value:"Prospecting Stage",children:"Prospecting"}),a.jsx("option",{value:"Qualification Stage",children:"Qualification"}),a.jsx("option",{value:"Proposal Stage",children:"Proposal"}),a.jsx("option",{value:"Negotiation Stage",children:"Negotiation"}),a.jsx("option",{value:"Closed Won Stage",children:"Closed Won"}),a.jsx("option",{value:"Closed Lost Stage",children:"Closed Lost"}),a.jsx("option",{value:"Closed Cancelled Stage",children:"Closed Cancelled"})]}),a.jsxs("select",{value:o,onChange:X=>l(X.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full lg:w-40 focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{value:"Filter by Owner",children:"Filter by Owner"}),[...new Set((b??[]).map(X=>`${X.assigned_deals?.first_name} ${X.assigned_deals?.last_name}`))].map((X,oe)=>a.jsx("option",{value:X,children:X},oe))]})]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[500px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 text-sm tracking-wide font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 w-12",children:a.jsx("input",{type:"checkbox",checked:be.size>0&&be.size===ue?.filter(X=>X.deal_creator?.id===Ie?.id).length&&ue?.filter(X=>X.deal_creator?.id===Ie?.id).length>0,onChange:At,className:"w-4 h-4 cursor-pointer"})}),a.jsx("th",{className:"py-3 px-4",children:"Deal ID"}),a.jsx("th",{className:"py-3 px-4 truncate",children:"Deal Name"}),a.jsx("th",{className:"py-3 px-4",children:"Account"}),a.jsx("th",{className:"py-3 px-4",children:"Contact"}),a.jsx("th",{className:"py-3 px-4 w-48",children:"Stage"}),a.jsx("th",{className:"py-3 px-4 w-48",children:"Value"}),a.jsx("th",{className:"py-3 px-4",children:"Close Date"}),a.jsx("th",{className:"py-3 px-4",children:"Owner"}),a.jsx("th",{className:"py-3 px-4 w-12",children:be.size>0&&a.jsx("button",{onClick:Ge,className:"text-orange-500 hover:text-orange-700 transition",title:"Archive selected deals",disabled:Ae,children:a.jsx(Zt,{size:18})})})]})}),a.jsx("tbody",{children:z.length>0?ue.map(X=>a.jsxs("tr",{className:"hover:bg-gray-50 text-sm cursor-pointer",onClick:()=>{u({...X}),ve(X.id)},children:[a.jsx("td",{className:"py-3 px-4",children:Ie?.id===X.deal_creator?.id&&a.jsx("input",{type:"checkbox",checked:be.has(X.id),onClick:oe=>{oe.stopPropagation()},onChange:oe=>{oe.stopPropagation(),jt(X.id)},className:"w-4 h-4 cursor-pointer"})}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",children:rt(X.deal_id)}),a.jsx("td",{className:"py-3 px-4",children:a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-blue-600 hover:underline break-all text-sm",children:X.name}),a.jsx("div",{className:"text-gray-500 text-xs break-all",children:X.description||"--"})]})}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",children:X.account?.name||"--"}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",children:X.contact?.first_name&&X.contact?.last_name?`${X.contact.first_name} ${X.contact.last_name}`:X.contact?.first_name||X.contact?.last_name||"--"}),a.jsx("td",{className:"py-3 px-4 w-48",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${je(X.stage)}`,children:ze(X.stage)})}),a.jsxs("td",{className:"py-3 px-4 w-48 text-gray-800 font-medium text-sm",children:[" ",X.amount?.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})||"0.00"]}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",children:at(X.close_date)||"--"}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",children:X.assigned_deals?.first_name&&X.assigned_deals?.last_name?`${X.assigned_deals.first_name} ${X.assigned_deals.last_name}`:X.assigned_deals?.first_name||X.assigned_deals?.last_name||"--"})]},X.id)):a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:8,children:"No deals found."})})})]})}),a.jsx(ca,{className:"mt-4",totalItems:z.length,pageSize:_,currentPage:w,onPrev:re,onNext:Le,onPageSizeChange:X=>{T(X),S(1)},pageSizeOptions:[10,20,30,40,50],label:"deals"}),p&&a.jsx(q7e,{onClose:H,formData:xe,setFormData:he,isEditing:P,onSubmit:Ct,isSubmitting:k||F,accounts:W,contacts:Q,users:we,currentAccount:Re,currentContact:He,onAddAccount:Fe,onAddContact:Ue,onRefreshAccounts:tt,onRefreshContacts:Me}),c&&a.jsx(LJ,{relatedActs:se,selectedDeal:c,show:!!c,onClose:()=>u(null),activeTab:d,setActiveTab:h,onEdit:yt,onDelete:Be,onStatusUpdate:_t}),E&&a.jsx(B7e,{open:!0,title:E.title,message:E.message,confirmLabel:E.confirmLabel,cancelLabel:E.cancelLabel,variant:E.variant,onConfirm:ce,onCancel:fe,loading:F})]})}function B7e({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o=!1,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":i==="archive"?"bg-orange-500 hover:bg-orange-600 border border-orange-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[10000]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsx("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${u}`,disabled:o,children:o?"Processing...":s})]})]})})}function H7e({icon:e,title:t,value:n,color:s="text-blue-600",bgColor:r="bg-blue-100",onClick:i}){const o=()=>{typeof i=="function"?i():console.log(`Clicked: ${t}`)};return a.jsxs("div",{className:"flex items-center p-4 bg-white rounded-xl shadow-md border border-gray-200 transition-all duration-300",onClick:o,children:[a.jsx("div",{className:`flex-shrink-0 p-3 rounded-full ${r} ${s} mr-4`,children:e?a.jsx(e,{size:22}):null}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:t}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:n})]})]})}function q7e({onClose:e,formData:t,setFormData:n,isEditing:s=!1,onSubmit:r,isSubmitting:i=!1,accounts:o=[],contacts:l=[],users:c=[],currentAccount:u=null,currentContact:d=null,onAddAccount:h,onAddContact:p,onRefreshAccounts:x,onRefreshContacts:b}){const[j,y]=f.useState(!1),N=_=>{if(_.preventDefault(),y(!0),!t.name?.trim()){V.error("Deal name is required.");return}const T=Number(t.amount);if(!t.amount||isNaN(T)||T<=0){V.error("Amount must be a number greater than 0.");return}if(!t.account_id){V.error("Please select an account.");return}if(!t.primary_contact_id){V.error("Please select a primary contact.");return}if(!t.assigned_to){V.error("Please assign this deal to a user.");return}r?.(t)},w=_=>{_.target.id==="modalBackdrop"&&e()},S=f.useMemo(()=>{const _=String(t.account_id||"").trim(),T=Array.isArray(l)?l:[];return _?T.filter(k=>{const E=[k?.account_id,k?.accountId,k?.account?.id,k?.account?.account_id,k?.account?.accountId].find(M=>M!=null&&String(M).trim()!=="");return E?String(E)===_:!1}):T},[l,t.account_id]);return f.useEffect(()=>{const _=String(t.account_id||"").trim(),T=String(t.primary_contact_id||"").trim();if(!T||!_)return;S.some(A=>String(A?.id)===T)||n(A=>({...A,primary_contact_id:""}))},[t.account_id,t.primary_contact_id,S,n]),a.jsx("div",{id:"modalBackdrop",onClick:w,className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-full sm:max-w-3xl rounded-2xl shadow-lg p-4 sm:p-6 md:p-8 relative border border-gray-200 overflow-y-auto max-h-[90vh] hide-scrollbar",onClick:_=>_.stopPropagation(),children:[a.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-gray-500 hover:text-black transition",children:a.jsx(ea,{size:22})}),a.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800 mb-4 sm:mb-6 flex items-center justify-center",children:s?"Edit Deal":"Create Deal"}),a.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",onSubmit:N,noValidate:!0,children:[a.jsx(oT,{label:"Deal Name",name:"name",value:t.name,onChange:_=>n({...t,name:_.target.value}),placeholder:"Enter deal name",required:!0,isSubmitted:j,className:"md:col-span-2"}),a.jsx(lT,{label:"Account",value:t.account_id||"",onChange:_=>n({...t,account_id:_}),items:o||[],getLabel:_=>_?.name??"",placeholder:"Search account...",disabled:i,currentItem:u,required:!0,isSubmitted:j,actions:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{type:"button",onClick:h,disabled:i,title:"Add account",className:"inline-flex items-center justify-center w-8 h-8 rounded-md border border-gray-300 text-gray-600 hover:bg-gray-50 transition disabled:opacity-60",children:a.jsx(aa,{size:16})}),a.jsx("button",{type:"button",onClick:x,disabled:i,title:"Refresh accounts",className:"inline-flex items-center justify-center w-8 h-8 rounded-md border border-gray-300 text-gray-600 hover:bg-gray-50 transition disabled:opacity-60",children:a.jsx(Br,{size:16})})]})}),a.jsx(lT,{label:"Primary Contact",value:t.primary_contact_id||"",onChange:_=>n({...t,primary_contact_id:_}),items:S||[],getLabel:_=>`${_?.first_name??""} ${_?.last_name??""}`.trim()||_?.email||"",placeholder:"Search contact...",disabled:i,currentItem:d,required:!0,isSubmitted:j,actions:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{type:"button",onClick:p,disabled:i,title:"Add contact",className:"inline-flex items-center justify-center w-8 h-8 rounded-md border border-gray-300 text-gray-600 hover:bg-gray-50 transition disabled:opacity-60",children:a.jsx(aa,{size:16})}),a.jsx("button",{type:"button",onClick:b,disabled:i,title:"Refresh contacts",className:"inline-flex items-center justify-center w-8 h-8 rounded-md border border-gray-300 text-gray-600 hover:bg-gray-50 transition disabled:opacity-60",children:a.jsx(Br,{size:16})})]})}),a.jsx(L8,{label:"Stage",name:"stage",value:t.stage,onChange:_=>n({...t,stage:_.target.value}),options:[{value:"PROSPECTING",label:"Prospecting"},{value:"QUALIFICATION",label:"Qualification"},{value:"PROPOSAL",label:"Proposal"},{value:"NEGOTIATION",label:"Negotiation"},{value:"CLOSED_WON",label:"Closed Won"},{value:"CLOSED_LOST",label:"Closed Lost"},{value:"CLOSED_CANCELLED",label:"Closed Cancelled"}],disabled:i}),a.jsx(oT,{label:"Amount",name:"amount",type:"text",inputMode:"decimal",value:t.amount,onChange:_=>{let T=_.target.value;T.startsWith(".")&&(T="0"+T),!(T&&!/^\d*\.?\d*$/.test(T))&&n({...t,amount:T})},placeholder:"0.00",required:!0,isSubmitted:j}),a.jsx(L8,{label:"Currency",name:"currency",value:t.currency||"PHP",onChange:_=>n({...t,currency:_.target.value}),options:[{value:"PHP",label:"PHP"},{value:"USD",label:"USD"}],disabled:i}),a.jsx(oT,{label:"Close Date",name:"close_date",type:"date",value:t.close_date||"",onChange:_=>n({...t,close_date:_.target.value}),disabled:i}),a.jsx(lT,{label:"Assign To",value:t.assigned_to||"",onChange:_=>n({...t,assigned_to:_}),items:c||[],getLabel:_=>`${_?.first_name??""} ${_?.last_name??""}`.trim()||_?.email||"",placeholder:"Search assignee...",disabled:i,required:!0,isSubmitted:j,className:"md:col-span-2"}),a.jsx(W7e,{label:"Description",name:"description",value:t.description,onChange:_=>n({...t,description:_.target.value}),placeholder:"Additional details...",rows:3,className:"md:col-span-2",disabled:i}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-2 md:col-span-2 mt-4",children:[a.jsx("button",{type:"button",onClick:e,className:"w-full sm:w-auto px-4 py-2 text-white bg-red-400 border border-red-300 rounded hover:bg-red-500 transition disabled:opacity-70",disabled:i,children:"Cancel"}),a.jsx("button",{type:"submit",className:"w-full sm:w-auto px-4 py-2 text-white border border-tertiary bg-tertiary rounded hover:bg-secondary transition disabled:opacity-70",disabled:i,children:i?"Saving...":s?"Update Deal":"Save Deal"})]})]})]})})}function oT({label:e,name:t,value:n,onChange:s,placeholder:r,type:i="text",required:o=!1,disabled:l=!1,className:c="",isSubmitted:u=!1}){const d=u&&!n?.trim();return a.jsxs("div",{className:c,children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",o&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:i,name:t,value:n??"",onChange:s,placeholder:r,required:o,disabled:l,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border focus:ring-2
          ${d?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}
          ${c}
        `})]})}function L8({label:e,name:t,value:n,onChange:s,options:r,required:i=!1,disabled:o=!1,className:l=""}){return a.jsxs("div",{className:l,children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsx("select",{name:t,value:n??"",onChange:s,required:i,disabled:o,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100",children:r.map(c=>a.jsx("option",{value:c.value,children:c.label},c.value))})]})}function lT({label:e,items:t=[],value:n="",onChange:s,getLabel:r,placeholder:i="Search...",disabled:o=!1,className:l="",currentItem:c=null,required:u=!1,isSubmitted:d=!1,actions:h=null}){const p=d&&u&&!n;return a.jsxs("div",{className:l,children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",u&&a.jsx("span",{className:"text-red-500",children:"*"})]}),h?a.jsx("div",{className:"flex items-center",children:h}):null]}),a.jsx(G7e,{items:t,value:n??"",onChange:s,getLabel:r,placeholder:i,disabled:o,currentItem:c,hasError:p})]})}function G7e({items:e=[],value:t="",onChange:n,getLabel:s,placeholder:r="Search...",disabled:i=!1,maxRender:o=200,currentItem:l=null,hasError:c=!1}){const[u,d]=f.useState(!1),[h,p]=f.useState(""),x=f.useRef(null),j=e.find(w=>String(w.id)===String(t))||l,y=j?s(j):"",N=f.useMemo(()=>{const w=h.trim().toLowerCase();return(w?e.filter(_=>(s(_)||"").toLowerCase().includes(w)):e).slice(0,o)},[e,h,s,o]);return f.useEffect(()=>{const w=S=>{x.current&&!x.current.contains(S.target)&&d(!1)};return document.addEventListener("mousedown",w),()=>document.removeEventListener("mousedown",w)},[]),f.useEffect(()=>{u||p("")},[u]),a.jsxs("div",{ref:x,className:"relative w-full",children:[a.jsx("input",{disabled:i,value:u?h:y,placeholder:r,onFocus:()=>!i&&d(!0),onChange:w=>{p(w.target.value),u||d(!0)},className:`w-full border rounded-md px-2 py-1.5 text-sm outline-none focus:ring-2
          ${c?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}`}),u&&!i&&a.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg overflow-hidden",children:[a.jsx("div",{className:"max-h-56 overflow-y-auto hide-scrollbar",children:N.length>0?N.map(w=>{const S=String(w.id),_=s(w),T=String(t)===S;return a.jsx("button",{type:"button",onClick:()=>{n(S),d(!1)},className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-50 ${T?"bg-blue-50":""}`,children:_||"--"},S)}):a.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No results"})}),e.length>o&&a.jsxs("div",{className:"px-3 py-2 text-[11px] text-gray-400 border-t",children:["Showing first ",o," results  keep typing to narrow."]})]})]})}function W7e({label:e,name:t,value:n,onChange:s,placeholder:r,required:i=!1,disabled:o=!1,className:l="",rows:c=3}){return a.jsxs("div",{className:l,children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsx("textarea",{name:t,value:n??"",onChange:s,placeholder:r,required:i,disabled:o,rows:c,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100 resize-none"})]})}const cT=[{value:"Draft",label:"Draft"},{value:"Presented",label:"Presented"},{value:"Accepted",label:"Accepted"},{value:"Rejected",label:"Rejected"}],dT={deal_id:"",account_id:"",contact_id:"",total_amount:"",presented_date:"",validity_days:"",status:"Draft",assigned_to:"",notes:"",subtotal:0,tax_rate:0,tax_amount:0,discount_type:"",discount_value:0,discount_amount:0,currency:"PHP",items:[]},zi=e=>{if(!e)return"Draft";const t=e.toString().trim().toLowerCase();return{draft:"Draft",presented:"Presented",accepted:"Accepted",rejected:"Rejected"}[t]||"Draft"},uT=e=>e?e.toString().toLowerCase().replace(/\b\w/g,t=>t.toUpperCase()):"--",V7e=e=>{switch(zi(e).toLowerCase()){case"draft":return"bg-gray-100 text-gray-700";case"presented":return"bg-yellow-100 text-yellow-700";case"accepted":return"bg-green-100 text-green-700";case"rejected":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-700"}},Y7e=e=>{switch(zi(e).toLowerCase()){case"draft":return"bg-gray-600 text-white";case"presented":return"bg-yellow-600 text-white";case"accepted":return"bg-green-600 text-white";case"rejected":return"bg-red-600 text-white";default:return"bg-gray-600 text-white"}},Ib=e=>e?new Date(e).toLocaleString("en-US",{month:"2-digit",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).replace(",",""):"",Mg=e=>e?new Date(e).toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"numeric"}):"",Q7e=e=>{if(!e)return"";if(typeof e=="string"&&e.match(/^\d{4}-\d{2}-\d{2}$/))return e;try{const t=new Date(e);if(isNaN(t.getTime()))return"";const n=t.getFullYear(),s=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0");return`${n}-${s}-${r}`}catch{return""}},mT=(e,t)=>{if(!e||t==null||t==="")return"";const n=Number(t);if(Number.isNaN(n))return"";const s=new Date(e);return isNaN(s.getTime())?"":(s.setDate(s.getDate()+n),s.toISOString().slice(0,10))},D8=e=>{if(!e)return"";const t=String(e).split("-");return t.length===3?`${t[0]}-${t[2]}`:String(e)},$b=e=>{if(!e)return"";const t=String(e).split("-");return t.length===3?`${t[0]}-${t[2]}`:String(e)},ej=e=>{if(!e)return null;if(typeof e=="number")return e;if(typeof e=="string"&&e.trim()&&!Number.isNaN(Number(e)))return Number(e);if(typeof e=="object"){if(e.id&&!Number.isNaN(Number(e.id)))return Number(e.id);if(e.user?.id&&!Number.isNaN(Number(e.user.id)))return Number(e.user.id);if(e.data?.id&&!Number.isNaN(Number(e.data.id)))return Number(e.data.id);if(e.profile?.id&&!Number.isNaN(Number(e.profile.id)))return Number(e.profile.id)}return null},K7e=()=>{const e=["user","currentUser","userData","authUser","profile"];for(const s of e){const r=localStorage.getItem(s);if(r)try{const i=JSON.parse(r),o=ej(i);if(o)return o}catch{}}const t=localStorage.getItem("user_id"),n=ej(t);return n||null},X7e=e=>{if(!e)return"";const n=[e.account_id,e.accountId,e.account?.id,e.account?.account_id,e.account?.accountId].find(s=>s!=null&&String(s).trim()!=="");return n?String(n):""},Z7e=e=>{if(!e)return"";const n=[e.contact_id,e.contactId,e.contact?.id,e.primary_contact_id,e.primaryContactId,e.primary_contact?.id,e.primaryContact?.id].find(s=>s!=null&&String(s).trim()!=="");return n?String(n):""};function J7e(){const e=Et(),t=ta(),{user:n}=Gt(),s=n?.company?.currency||"";f.useEffect(()=>{document.title="Quotes | Sari-Sari CRM"},[]);const[r,i]=f.useState([]),[o,l]=f.useState(!1),[c,u]=f.useState([]),[d,h]=f.useState([]),[p,x]=f.useState([]),[b,j]=f.useState([]),[y,N]=f.useState(null),[w,S]=f.useState(null),[_,T]=f.useState(!1),[k,A]=f.useState(!1),[E,M]=f.useState(!1),[F,D]=f.useState(null),[P,B]=f.useState(!1),[G,$]=f.useState(!1),[W,Z]=f.useState(null),[Q,le]=f.useState(dT),[we,J]=f.useState(""),[se,ye]=f.useState("Filter by Status"),[Ce,ge]=f.useState(null),be=f.useCallback(async()=>{if(w)try{$(!0);const L=(await ne.get("/company/invoice-info"))?.data;e(`/manager/quotes/${encodeURIComponent(w.id)}/print`,{state:{quote:w,companyInfo:L}})}catch(I){const L=I?.response?.data?.detail||I?.message||"Failed to open print page.";V.error(L)}finally{$(!1)}},[w,e]),[me,Ae]=f.useState(1),[pe,Ie]=f.useState(10),[xe,he]=f.useState("Overview"),[Re,Ee]=f.useState("Draft"),[He,Ke]=f.useState([]),[st,it]=f.useState(null),{comments:ot,addComment:rt,refresh:at}=kn({relatedType:"quote",relatedId:w?.id});f.useEffect(()=>{w?.id&&at()},[w?.id,at]),f.useEffect(()=>{const L=t.state?.quoteID;if(L){it(L),e(t.pathname,{replace:!0,state:{}});return}},[t,e]),f.useEffect(()=>{if(st&&r.length>0&&!o){const I=r.find(L=>L.id===st);I?S(I):V.error("Quote not found."),it(null)}},[st,r,o]),f.useEffect(()=>{let I=!0;return(async()=>{const ee=K7e();if(ee&&I){N(ee);return}try{const ke=await ne.get("/auth/me"),$e=ej(ke?.data);if($e&&I){N($e);return}}catch{}try{const ke=await ne.get("/users/me"),$e=ej(ke?.data);if($e&&I){N($e);return}}catch{}I&&N(null)})(),()=>{I=!1}},[]);const Je=f.useCallback(I=>I&&d.find(ee=>String(ee.id)===String(I))?.name||"",[d]),Fe=f.useCallback(I=>{if(!I)return"";const L=p.find(ee=>String(ee.id)===String(I));return L?`${L.first_name} ${L.last_name}`.trim():""},[p]),Ue=f.useCallback(I=>{if(!I)return"--";const L=c.find(ee=>String(ee.id)===String(I));return L?.deal_name||L?.name||`Deal #${D8(I)}`},[c]),Ne=f.useCallback(I=>{const L=c.find($e=>String($e.id)===String(I)),ee=X7e(L);let ke=Z7e(L);if(!ke&&ee){const $e=p.filter(We=>String(We.account_id||"")===String(ee));if($e.length>0){const We=[...$e].sort((mt,Tt)=>{const kt=`${mt.first_name||""} ${mt.last_name||""}`.trim().toLowerCase(),Yt=`${Tt.first_name||""} ${Tt.last_name||""}`.trim().toLowerCase();return kt.localeCompare(Yt)});ke=String(We[0].id)}}if(ee&&ke){const $e=p.find(We=>String(We.id)===String(ke));$e?.account_id&&String($e.account_id)!==String(ee)&&(ke="")}return{accountId:ee||"",contactId:ke||""}},[c,p]),ze=f.useCallback(I=>{if(!I)return"--";if(I.deal?.deal_name)return I.deal.deal_name;if(I.deal?.name)return I.deal.name;const L=I.deal_id||I.deal?.id;return L?Ue(L):"--"},[Ue]),je=f.useCallback(I=>{if(!I)return"--";if(I.account?.name)return I.account.name;let L=I.account_id||I.account?.id;if(!L){const ee=I.deal_id||I.deal?.id;ee&&(L=Ne(ee).accountId)}return L?Je(L)||`Account #${L}`:"--"},[Ne,Je]),ve=f.useCallback(I=>{if(!I)return"--";if(I.contact?.first_name||I.contact?.last_name)return`${I.contact?.first_name||""} ${I.contact?.last_name||""}`.trim()||"--";let L=I.contact_id||I.contact?.id;if(!L){const ke=I.deal_id||I.deal?.id;ke&&(L=Ne(ke).contactId)}return(L?Fe(L):"")||(L?`Contact #${L}`:"--")},[Ne,Fe]),z=f.useCallback(async(I=null)=>{l(!0);try{const L=await ne.get("/quotes/admin/fetch-all"),ke=[...Array.isArray(L.data)?L.data:[]].sort(($e,We)=>{const mt=$e?.created_at||$e?.updated_at||0,Tt=We?.created_at||We?.updated_at||0;return new Date(Tt)-new Date(mt)});if(i(ke),I){const $e=ke.find(We=>We.id===I);S($e||null)}}catch(L){console.error(L),i([]),L.response?.status===403?V.error("Permission denied. Only CEO, Admin, or Group Manager can access this page."):V.error("Failed to fetch quotes. Please try again later.")}finally{l(!1)}},[]),K=f.useCallback(async()=>{try{const I=await ne.get("/deals/admin/fetch-all");u(Array.isArray(I.data)?I.data:[])}catch(I){console.error(I),I.response?.status===403&&V.warn("Unable to load deals (permission denied).")}},[]),ue=f.useCallback(async()=>{try{const I=await ne.get("/accounts/admin/fetch-all");h(Array.isArray(I.data)?I.data:[])}catch(I){console.error(I),I.response?.status===403&&V.warn("Unable to load accounts (permission denied).")}},[]),re=f.useCallback(async()=>{try{const I=await ne.get("/contacts/admin/fetch-all");x(Array.isArray(I.data)?I.data:[])}catch(I){console.error(I),I.response?.status===403&&V.warn("Unable to load contacts (permission denied).")}},[]),Le=f.useCallback(async()=>{try{const I=await ne.get("/users/all");j(Array.isArray(I.data)?I.data:[])}catch(I){console.error(I),I.response?.status===403&&V.warn("Unable to load users (permission denied).")}},[]);f.useEffect(()=>{z(),K(),ue(),re(),Le()},[z,K,ue,re,Le]);const De=f.useMemo(()=>{const I=we.trim().toLowerCase(),L=se.trim();return r.filter(ee=>{const ke=ze(ee),$e=je(ee),We=ve(ee),mt=mT(ee.presented_date,ee.validity_days),Tt=[ee.quote_id,$b(ee.quote_id),ee.id?.toString(),ke,$e,We,ee.total_amount?.toString(),ee.validity_days?.toString(),ee.presented_date?Mg(ee.presented_date):"",mt?Mg(mt):"",ee.assigned_user?.first_name,ee.assigned_user?.last_name,ee.creator?.first_name,ee.creator?.last_name,ee.status,ee.notes,Ib(ee.created_at),Ib(ee.updated_at)],kt=I===""||Tt.some(En=>En==null?!1:En.toString().toLowerCase().includes(I)),Yt=L==="Filter by Status"||zi(ee.status)===L;return kt&&Yt})},[r,we,se,ze,je,ve]),Qe=Math.max(1,Math.ceil(De.length/pe)||1);f.useEffect(()=>Ae(1),[we,se]),f.useEffect(()=>{Ae(I=>{const L=Math.max(1,Math.ceil(De.length/pe)||1);return I>L?L:I})},[De.length,pe]);const tt=f.useMemo(()=>{const I=(me-1)*pe;return De.slice(I,I+pe)},[De,me,pe]),Me=()=>Ae(I=>Math.max(I-1,1)),et=()=>Ae(I=>Math.min(I+1,Qe)),yt=I=>{S(I),he("Overview"),Ee(zi(I?.status)||"Draft")},_t=()=>{S(null),he("Overview")},Ct=I=>{I.target.id==="quoteModalBackdrop"&&!P&&_t()},jt=f.useCallback(()=>{T(!1),A(!1),Z(null),le(dT),M(!1)},[]),At=I=>{I.target.id==="modalBackdrop"&&!E&&!P&&jt()},Ge=I=>{const{name:L,value:ee}=I.target;if(L==="deal_id"){const{accountId:ke,contactId:$e}=Ne(ee);le(We=>({...We,deal_id:ee,account_id:ke,contact_id:$e}));return}le(ke=>({...ke,[L]:ee}))},Be=()=>{le(dT),A(!1),Z(null),T(!0)},ce=I=>{if(!I)return;S(null);const L=I.deal?.id?String(I.deal.id):I.deal_id?String(I.deal_id):"",ee=L?Ne(L):{accountId:"",contactId:""},ke=I.account?.id?String(I.account.id):I.account_id?String(I.account_id):ee.accountId,$e=I.contact?.id?String(I.contact.id):I.contact_id?String(I.contact_id):ee.contactId,We=I.assigned_user?.id?String(I.assigned_user.id):I.assigned_to?String(I.assigned_to):"";le({deal_id:L,account_id:ke||"",contact_id:$e||"",total_amount:I.total_amount?.toString()||"",presented_date:Q7e(I.presented_date),validity_days:I.validity_days!==null&&I.validity_days!==void 0?String(I.validity_days):"",status:zi(I.status)||"Draft",assigned_to:We,notes:I.notes||"",subtotal:parseFloat(I.subtotal)||0,tax_rate:parseFloat(I.tax_rate)||0,tax_amount:parseFloat(I.tax_amount)||0,discount_type:I.discount_type||"",discount_value:parseFloat(I.discount_value)||0,discount_amount:parseFloat(I.discount_amount)||0,currency:I.currency||"PHP",items:Array.isArray(I.items)?I.items.map(mt=>({id:mt.id,item_type:mt.item_type||"Product",name:mt.name||"",description:mt.description||"",sku:mt.sku||"",variant:mt.variant||"",unit:mt.unit||"pcs",quantity:parseFloat(mt.quantity)||1,unit_price:parseFloat(mt.unit_price)||0,discount_percent:parseFloat(mt.discount_percent)||0,discount_amount:parseFloat(mt.discount_amount)||0,line_total:parseFloat(mt.line_total)||0,sort_order:mt.sort_order||0})):[]}),A(!0),Z(I.id),T(!0)},fe=I=>{if(I.target.checked){const L=tt.filter(ee=>ee.created_by===y).map(ee=>ee.id);Ke(L)}else Ke([])},H=I=>{Ke(L=>L.includes(I)?L.filter(ee=>ee!==I):[...L,I])},te=tt.filter(I=>I.created_by===y),q=I=>{if(!I)return;const L=I.quote_id||"this quote";D({title:"Archive Quote",message:a.jsxs("span",{children:["Are you sure you want to archive"," ",a.jsx("span",{className:"font-semibold",children:L}),"? This action cannot be undone."]}),confirmLabel:"Archive Quote",cancelLabel:"Cancel",variant:"danger",action:{type:"delete",targetId:I.id,name:L}})},Y=async()=>{He.length!==0&&D({title:"Archive Quotes",message:a.jsxs("span",{children:["Are you sure you want to archive"," ",a.jsx("span",{className:"font-semibold",children:He.length})," selected quotes? This action cannot be undone."]}),confirmLabel:`Archive ${He.length} Quote(s)`,cancelLabel:"Cancel",variant:"danger",action:{type:"bulk-delete",quote_ids:He}})},[U,de]=f.useState(!1),Te=I=>{if(I.preventDefault(),de(!0),!y){V.error("Unable to determine current user. Please log in again.");return}if(!Q.deal_id){V.error("Deal is required.");return}if(!Q.assigned_to){V.error("Assigned To is required.");return}const ee=Ne(Q.deal_id),ke=Q.items.map((kt,Yt)=>({item_type:kt.item_type||"Product",name:kt.name,description:kt.description||null,sku:kt.sku||null,variant:kt.variant||null,unit:kt.unit||null,quantity:parseFloat(kt.quantity)||1,unit_price:parseFloat(kt.unit_price)||0,discount_percent:parseFloat(kt.discount_percent)||0,sort_order:kt.sort_order??Yt})),$e={deal_id:Number(Q.deal_id),account_id:ee.accountId?Number(ee.accountId):null,contact_id:ee.contactId?Number(ee.contactId):null,subtotal:parseFloat(Q.subtotal)||0,tax_rate:parseFloat(Q.tax_rate)||0,tax_amount:parseFloat(Q.tax_amount)||0,discount_type:Q.discount_type||null,discount_value:parseFloat(Q.discount_value)||0,discount_amount:parseFloat(Q.discount_amount)||0,total_amount:parseFloat(Q.total_amount)||0,currency:Q.currency||"PHP",presented_date:Q.presented_date||null,validity_days:Q.validity_days===""?null:Number(Q.validity_days),status:Q.status||"Draft",assigned_to:Q.assigned_to?Number(Q.assigned_to):null,notes:Q.notes?.trim()||null,items:ke},We=k&&W?"update":"create",mt=Ue(Q.deal_id),Tt=We==="create"?{...$e,created_by_id:Number(y)}:$e;D({title:We==="create"?"Confirm New Quote":"Confirm Update",message:We==="create"?a.jsxs("span",{children:["Are you sure you want to create a quote for"," ",a.jsx("span",{className:"font-semibold",children:mt}),"?"]}):a.jsxs("span",{children:["Save changes to"," ",a.jsx("span",{className:"font-semibold",children:mt}),"?"]}),confirmLabel:We==="create"?"Create Quote":"Update Quote",cancelLabel:"Cancel",variant:"primary",action:{type:We,payload:Tt,targetId:W||null,name:mt}})},ie=async()=>{if(!F?.action){D(null);return}const{action:I}=F,{type:L,payload:ee,targetId:ke,name:$e}=I;B(!0);try{if(L==="create")M(!0),await ne.post("/quotes/admin",ee),V.success("Quote created successfully."),jt(),await z();else if(L==="update"){if(!ke)throw new Error("Missing quote identifier for update.");M(!0),await ne.put(`/quotes/admin/${ke}`,ee),V.success("Quote updated successfully."),jt(),await z(),w?.id===ke&&S(null)}else if(L==="delete"){if(!ke)throw new Error("Missing quote identifier for deletion.");const We=w?.id;ge(ke),await ne.delete(`/quotes/admin/${ke}`),V.success(`Quote "${$e}" archived successfully.`),await z(We&&We!==ke?We:null),We===ke&&S(null)}else L==="bulk-delete"&&(await ne.post("/quotes/admin/bulk-delete",{quote_ids:He}),V.success(`Successfully archived ${He.length} quotes`),Ke([]),await z())}catch(We){console.error(We);const mt=L==="create"?"Failed to create quote. Please review the details and try again.":L==="update"?"Failed to update quote. Please review the details and try again.":"Failed to delete quote. Please try again.";V.error(mt),(L==="create"||L==="update")&&M(!1),L==="delete"&&ge(null)}finally{(L==="create"||L==="update")&&M(!1),L==="delete"&&ge(null),B(!1),D(null)}},Oe=()=>{P||D(null)},X=f.useCallback((I,L)=>{const ee=I?.deal_id??I?.deal?.id??"",ke=ee?Number(ee):null,$e=ke?Ne(String(ke)):{accountId:"",contactId:""},We=I?.account_id??I?.account?.id??$e.accountId??null,mt=I?.contact_id??I?.contact?.id??$e.contactId??null,Tt=I?.total_amount??0,kt=I?.assigned_to??I?.assigned_user?.id??null;return{deal_id:ke,account_id:We!=null&&String(We).trim()!==""?Number(We):null,contact_id:mt!=null&&String(mt).trim()!==""?Number(mt):null,total_amount:Number(Tt),presented_date:I?.presented_date||null,validity_days:I?.validity_days===""||I?.validity_days===void 0||I?.validity_days===null?null:Number(I.validity_days),status:L,assigned_to:kt!=null&&String(kt).trim()!==""?Number(kt):null,notes:I?.notes?.trim()||null}},[Ne]),oe=f.useCallback(async()=>{if(!w?.id)return;const I=zi(Re),L=[I,I.toLowerCase()],ee=async ke=>ne.patch(`/quotes/admin/${w.id}/status`,{status:ke},{headers:{"Content-Type":"application/json"}});try{let ke=!1;for(const $e of L)try{await ee($e),ke=!0;break}catch(We){if(We?.response?.status===422)continue;throw We}if(!ke){const $e=X(w,I);if(!$e.deal_id){V.error("Cannot update status: missing deal_id on selected quote.");return}if(!$e.total_amount||$e.total_amount<=0){V.error("Cannot update status: missing/invalid total_amount on selected quote.");return}await ne.put(`/quotes/admin/${w.id}`,$e)}V.success(`Quote status updated to ${I}`),S(null),he("Overview"),await z()}catch(ke){console.error(ke);const $e=ke?.response?.data?.message||(ke?.response?.data?.errors?Object.values(ke.response.data.errors).flat().join(" "):null)||"Failed to update quote status. Please try again.";V.error($e)}},[w,Re,z,X]),Pe=[{label:"Filter by Status",value:"Filter by Status"},...cT.map(I=>({label:I.label,value:I.value}))],Ve=F?.action?.type==="delete"?F.action.targetId:null,ft=w&&(Ce===w.id||Ve===w.id),St=w&&Ce===w.id,Ht=w?a.jsx("div",{id:"quoteModalBackdrop",onClick:Ct,className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-6xl max-h-[92vh] overflow-y-auto hide-scrollbar animate-scale-in font-inter relative",onClick:I=>I.stopPropagation(),children:[a.jsx("div",{className:"w-full flex flex-col items-center justify-center rounded-t-xl",children:a.jsxs("div",{className:"bg-tertiary w-full flex items-center justify-between p-3 lg:p-3 rounded-t-xl",children:[a.jsx("h1",{className:"lg:text-3xl text-xl text-white font-semibold text-center w-full",children:"Quotes"}),a.jsx("button",{onClick:_t,className:"text-gray-500 hover:text-white transition cursor-pointer",children:a.jsx(Za,{size:25})})]})}),a.jsxs("div",{className:"p-6 lg:p-4",children:[a.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between lg:flex-row lg:items-center lg:justify-between mt-3 gap-2 px-2 md:items-center lg:gap-4 md:mx-7 lg:mx-7",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[a.jsx("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-800",children:ze(w)}),a.jsx("span",{className:`text-xs sm:text-sm font-medium px-2 sm:px-3 py-1 rounded-full whitespace-nowrap ${Y7e(w.status)}`,children:uT(w.status)})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsxs("button",{className:"inline-flex items-center justify-center w-full sm:w-auto bg-white text-gray-700 px-4 py-2 rounded-md border border-gray-300 hover:bg-gray-50 disabled:opacity-70 transition text-sm focus:outline-none focus:ring-2 focus:ring-gray-300",onClick:be,disabled:G||E||P,children:[a.jsx(ia,{className:"mr-2"}),G?"Preparing...":"Print Quotation"]}),y===w.created_by&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{className:"inline-flex items-center justify-center w-full sm:w-auto bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 disabled:opacity-70 transition text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",onClick:()=>ce(w),disabled:P||F?.action?.type==="update"&&F.action.targetId===w.id,children:[a.jsx(gn,{className:"mr-2"}),"Edit"]}),a.jsx("button",{className:"inline-flex items-center justify-center w-full sm:w-auto px-4 py-2 rounded-md text-sm bg-orange-500 text-white hover:bg-orange-600 transition focus:outline-none focus:ring-2 focus:ring-orange-400",onClick:()=>q(w),disabled:!!ft,children:St?"Archiving...":a.jsxs(a.Fragment,{children:[a.jsx(Zt,{className:"mr-2"}),"Archive"]})})]})]})]}),a.jsx("div",{className:"border-b border-gray-200 my-5"}),a.jsxs("div",{className:"p-1 lg:p-4",children:[a.jsx("div",{className:"flex w-full bg-[#6A727D] text-white mt-1 overflow-x-auto mb-6",children:["Overview","Notes"].map(I=>a.jsx("button",{onClick:()=>he(I),className:`flex-1 min-w-[90px] px-4 py-2.5 text-xs sm:text-sm font-medium text-center transition-all duration-200 border-b-2
                    ${xe===I?"bg-paper-white text-[#6A727D] border-white":"text-white hover:bg-[#5c636d]"}`,children:I},I))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 items-start",children:[a.jsxs("div",{className:"lg:col-span-3",children:[xe==="Overview"&&a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 md:p-8 border border-gray-200",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4 sm:gap-6 text-sm text-gray-700",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Quote ID:"}),a.jsx("p",{children:$b(w.quote_id)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Deal:"}),a.jsx("p",{children:ze(w)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Account:"}),a.jsx("p",{children:je(w)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Contact:"}),a.jsx("p",{children:ve(w)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Total Amount:"}),a.jsx("p",{children:w.total_amount?`${s}${Number(w.total_amount).toLocaleString()}`:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Presented Date:"}),a.jsx("p",{children:Mg(w.presented_date)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Validity Days:"}),a.jsx("p",{children:w.validity_days!==null&&w.validity_days!==void 0?w.validity_days:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Expiry Date:"}),a.jsx("p",{children:Mg(mT(w.presented_date,w.validity_days))||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Status:"}),a.jsx("p",{children:uT(w.status)})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Assigned To:"}),a.jsx("p",{children:w.assigned_user?`${w.assigned_user.first_name} ${w.assigned_user.last_name}`:"Unassigned"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created By:"}),a.jsx("p",{children:w.creator?`${w.creator.first_name} ${w.creator.last_name}`:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created At:"}),a.jsx("p",{children:Ib(w.created_at)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Last Updated:"}),a.jsx("p",{children:Ib(w.updated_at)||"N/A"})]})]}),w.items&&w.items.length>0&&a.jsx("div",{className:"mt-6",children:a.jsx(wd,{items:w.items,onChange:()=>{},currencySymbol:s,readOnly:!0,taxRate:parseFloat(w.tax_rate)||0,discountType:w.discount_type,discountValue:parseFloat(w.discount_value)||0})})]}),xe==="Notes"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"bg-white p-4 sm:p-6 rounded-xl border border-gray-200 shadow-sm",children:[a.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Notes:"}),a.jsx("p",{className:"text-sm text-gray-700 leading-relaxed whitespace-pre-wrap",children:w.notes||"No notes available."})]}),a.jsx(Tn,{comments:ot,onAddComment:rt})]})]}),a.jsxs("div",{className:"flex flex-col gap-4",children:[a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Quick Actions"}),a.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[a.jsxs("button",{onClick:()=>e("/manager/calls",{state:{openCallModal:!0,initialCallData:{subject:`Call regarding Quote ${$b(w.quote_id)}`,assigned_to:w.assigned_user?.id?String(w.assigned_user.id):w.assigned_to?String(w.assigned_to):"",direction:"Outgoing",status:"Planned"}}}),className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(It,{className:"text-gray-600 w-4 h-4"}),"Schedule Call"]}),a.jsxs("button",{className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",onClick:()=>e("/manager/meetings",{state:{openMeetingModal:!0,initialMeetingData:{subject:`Meeting with ${w.quote_id}`,assignedTo:w.assigned_user?.id?String(w.assigned_user.id):w.assigned_to?String(w.assigned_to):"",status:"Planned"}}}),children:[a.jsx(Pt,{className:"text-gray-600 w-4 h-4"}),"Book Meeting"]}),a.jsxs("button",{onClick:()=>e("/manager/tasks",{state:{openTaskModal:!0,initialTaskData:{subject:`Follow up with ${w.quote_id}`,assignedTo:w.assigned_user?.id?String(w.assigned_user.id):w.assigned_to?String(w.assigned_to):"",priority:"NORMAL",status:"Not Started"}}}),className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(Qt,{className:"text-gray-600 w-4 h-4"}),"Tasks"]})]})]}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm w-full",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Status"}),a.jsx("select",{className:"border border-gray-200 rounded-md px-2 sm:px-3 py-1.5 w-full text-sm mb-2 focus:ring-2 focus:ring-indigo-500 outline-none",value:Re||zi(w.status)||"Draft",onChange:I=>Ee(I.target.value),children:cT.map(I=>a.jsx("option",{value:I.value,children:I.label},I.value))}),a.jsx("button",{onClick:oe,disabled:zi(Re)===zi(w.status),className:`w-full py-1.5 rounded-md text-sm transition focus:outline-none focus:ring-2 ${zi(Re)===zi(w.status)?"bg-gray-400 cursor-not-allowed text-white":"bg-gray-900 text-white hover:bg-gray-800 focus:ring-gray-400"}`,children:"Update"})]})]})]})]})]})]})}):null,da=a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[o&&a.jsx(qt,{message:"Loading quotes..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h2",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(ia,{className:"mr-2 text-blue-600"})," Quotes"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto gap-2",children:a.jsxs("button",{onClick:()=>{Be(),de(!1)},className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 rounded-md hover:bg-gray-800 text-sm sm:text-base mx-auto sm:ml-auto cursor-pointer",children:[a.jsx(aa,{className:"mr-2"})," Add Quote"]})})]}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search quotes",value:we,onChange:I=>J(I.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsx("div",{className:"w-full lg:w-1/4",children:a.jsx("select",{value:se,onChange:I=>ye(I.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:Pe.map(I=>a.jsx("option",{value:I.value,children:I.label},I.value))})})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[900px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 text-sm tracking-wide font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 w-12",children:a.jsx("input",{type:"checkbox",checked:te.length>0&&He.length===te.length,onChange:fe,className:"cursor-pointer"})}),a.jsx("th",{className:"py-3 px-4",children:"Quote ID"}),a.jsx("th",{className:"py-3 px-4",children:"Deal"}),a.jsx("th",{className:"py-3 px-4",children:"Account"}),a.jsx("th",{className:"py-3 px-4",children:"Contact"}),a.jsx("th",{className:"py-3 px-4",children:"Total Amount"}),a.jsx("th",{className:"py-3 px-4",children:"Status"}),a.jsx("th",{className:"py-3 px-4",children:"Assigned To"}),a.jsx("th",{className:"py-3 px-4",children:"Expiry Date"}),a.jsx("th",{className:"py-3 px-4 text-center w-24",children:He.length>0?a.jsx("button",{onClick:Y,className:"text-orange-600 hover:text-orange-800 transition p-1 rounded-full hover:bg-orange-50",title:`Archive ${He.length} selected items`,children:a.jsx(Zt,{size:18})}):""})]})}),a.jsx("tbody",{children:o?a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:10,children:"Loading quotes..."})}):De.length>0?tt.map(I=>{const L=mT(I.presented_date,I.validity_days);return a.jsxs("tr",{className:"hover:bg-gray-50 text-sm cursor-pointer transition",onClick:()=>yt(I),children:[a.jsx("td",{className:"py-3 px-4 align-top w-12",onClick:ee=>ee.stopPropagation(),children:I.created_by===y&&a.jsx("input",{type:"checkbox",checked:He.includes(I.id),onChange:()=>H(I.id),className:"cursor-pointer"})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("div",{className:"font-medium text-blue-600 hover:underline whitespace-nowrap",children:$b(I.quote_id)||"--"})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("div",{className:"break-words",children:ze(I)||"--"})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("div",{className:"text-sm text-gray-700 break-words",children:je(I)||"--"})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("div",{className:"break-words",children:ve(I)||"--"})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("div",{className:"text-gray-700",children:I.total_amount?`${s}${Number(I.total_amount).toLocaleString()}`:"--"})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-medium ${V7e(I.status)}`,children:uT(I.status)})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("div",{children:I.assigned_user?`${I.assigned_user.first_name} ${I.assigned_user.last_name}`:"Unassigned"})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("div",{className:"text-gray-500 text-xs",children:Mg(L)||"--"})}),a.jsx("td",{className:"py-3 px-4 align-top text-center w-24"})]},I.id)}):a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:10,children:"No quotes found."})})})]})}),a.jsx(ca,{className:"mt-4",totalItems:De.length,pageSize:pe,currentPage:me,onPrev:Me,onNext:et,onPageSizeChange:I=>{Ie(I),Ae(1)},pageSizeOptions:[10,20,30,40,50],label:"quotes"})]}),qe=_?a.jsx("div",{id:"modalBackdrop",onClick:At,className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-full sm:max-w-3xl rounded-2xl shadow-lg p-4 sm:p-6 md:p-8 relative border border-gray-200 overflow-y-auto max-h-[90vh] hide-scrollbar",onClick:I=>I.stopPropagation(),children:[a.jsx("button",{onClick:()=>{jt(),de(!1)},className:"absolute top-4 right-4 text-gray-500 hover:text-black transition disabled:opacity-60",disabled:E||P,children:a.jsx(ea,{size:22})}),a.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800 mb-4 sm:mb-6 flex items-center justify-center",children:k?"Edit Quote":"Add New Quote"}),a.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",onSubmit:Te,children:[a.jsx(M8,{label:"Deal",name:"deal_id",value:Q.deal_id,onChange:I=>{const{accountId:L,contactId:ee}=Ne(I);le(ke=>({...ke,deal_id:I,account_id:L,contact_id:ee}))},items:Array.isArray(c)?c:[],getLabel:I=>`${D8(I?.deal_id??"")} ${I?.name??""}`.trim(),placeholder:"Search deal...",required:!0,isSubmitted:U,disabled:E||c.length===0,className:"md:col-span-2"}),a.jsx(O8,{label:"Account",value:Je(Q.account_id)||(Q.account_id?`Account #${Q.account_id}`:""),disabled:!0}),a.jsx(O8,{label:"Contact",value:Fe(Q.contact_id)||(Q.contact_id?`Contact #${Q.contact_id}`:""),disabled:!0}),a.jsx("div",{className:"md:col-span-2 mt-2",children:a.jsx(wd,{items:Q.items,onChange:I=>le(L=>({...L,items:I})),currencySymbol:s,readOnly:E,taxRate:Q.tax_rate,discountType:Q.discount_type,discountValue:Q.discount_value,onTotalsChange:I=>{le(L=>({...L,subtotal:I.subtotal,discount_amount:I.discount_amount,tax_amount:I.tax_amount,total_amount:I.total_amount}))}})}),a.jsxs("div",{className:"md:col-span-2 mt-2 p-4 bg-gray-50 rounded-lg",children:[a.jsx("h4",{className:"font-medium text-gray-700 mb-3",children:"Pricing Settings"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-600 text-xs mb-1",children:"Discount Type"}),a.jsxs("select",{value:Q.discount_type||"",onChange:I=>le(L=>({...L,discount_type:I.target.value})),className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm",disabled:E,children:[a.jsx("option",{value:"",children:"No Discount"}),a.jsx("option",{value:"percentage",children:"Percentage (%)"}),a.jsx("option",{value:"fixed",children:"Fixed Amount"})]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-gray-600 text-xs mb-1",children:["Discount"," ",Q.discount_type==="percentage"?"%":"Amount"]}),a.jsx("input",{type:"number",value:Q.discount_value||"",onChange:I=>le(L=>({...L,discount_value:I.target.value})),className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm",placeholder:"0",min:"0",max:Q.discount_type==="percentage"?"100":void 0,step:"0.01",disabled:E||!Q.discount_type})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-600 text-xs mb-1",children:"Tax Rate (%)"}),a.jsx("input",{type:"number",value:Q.tax_rate||"",onChange:I=>le(L=>({...L,tax_rate:I.target.value})),className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm",placeholder:"0",min:"0",max:"100",step:"0.01",disabled:E})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-600 text-xs mb-1",children:"Total Amount"}),a.jsxs("div",{className:"w-full bg-gray-100 border border-gray-300 rounded-md px-2 py-1.5 text-sm font-medium",children:[s,parseFloat(Q.total_amount||0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]})]}),a.jsx(P8,{label:"Presented Date",name:"presented_date",type:"date",value:Q.presented_date,onChange:Ge,disabled:E}),a.jsx(P8,{label:"Validity Days",name:"validity_days",type:"number",value:Q.validity_days,onChange:Ge,placeholder:"30",disabled:E}),a.jsx(M8,{label:"Assigned To",value:Q.assigned_to||"",onChange:I=>le(L=>({...L,assigned_to:I})),items:Array.isArray(b)?b:[],getLabel:I=>{const L=`${I?.first_name??""} ${I?.last_name??""}`.trim();return L?I?.role?`${L} (${I.role})`:L:I?.email||""},placeholder:"Search assignee...",required:!0,isSubmitted:U,disabled:E}),a.jsx(e8e,{label:"Status",name:"status",value:Q.status,onChange:Ge,options:cT,required:!0,disabled:E}),a.jsx(a8e,{label:"Notes",name:"notes",value:Q.notes,onChange:Ge,placeholder:"Additional details...",rows:3,disabled:E,className:"md:col-span-2"}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-2 md:col-span-2 mt-4",children:[a.jsx("button",{type:"button",onClick:()=>{jt(),de(!1)},className:"w-full sm:w-auto px-4 py-2 text-white bg-red-400 border border-red-300 rounded hover:bg-red-500 transition disabled:opacity-70",disabled:E||P,children:"Cancel"}),a.jsx("button",{type:"submit",className:"w-full sm:w-auto px-4 py-2 text-white border border-tertiary bg-tertiary rounded hover:bg-secondary transition disabled:opacity-70",disabled:E||P,children:E?"Saving...":k?"Update Quote":"Save Quote"})]})]})]})}):null,_e=F?a.jsx(n8e,{open:!0,title:F.title,message:F.message,confirmLabel:F.confirmLabel,cancelLabel:F.cancelLabel,variant:F.variant,onConfirm:ie,onCancel:Oe,loading:P}):null;return a.jsxs(a.Fragment,{children:[w?Ht:da,qe,_e]})}function P8({label:e,name:t,value:n,onChange:s,placeholder:r,type:i="text",required:o=!1,disabled:l=!1,className:c="",isSubmitted:u=!1}){const d=u&&!n?.trim();return a.jsxs("div",{className:c,children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",o&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:i,name:t,value:n??"",onChange:s,placeholder:r,required:o,disabled:l,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border focus:ring-2
          ${d?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}
          ${c}
        `})]})}function O8({label:e,value:t,className:n="",disabled:s=!0}){return a.jsxs("div",{className:n,children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsx("input",{type:"text",value:t??"",disabled:s,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm outline-none disabled:bg-gray-100"})]})}function e8e({label:e,name:t,value:n,onChange:s,options:r,required:i=!1,disabled:o=!1,className:l=""}){const c=n!=null?String(n):"",d=r.some(h=>String(h.value)===c)?c:"";return a.jsxs("div",{className:l,children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsx("select",{name:t,value:d,onChange:s,required:i,disabled:o,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100",children:r.map(h=>a.jsx("option",{value:String(h.value??""),children:h.label},h.value??h.label))})]})}function M8({label:e,items:t=[],value:n="",onChange:s,getLabel:r,placeholder:i="Search...",disabled:o=!1,className:l="",required:c=!1,isSubmitted:u=!1}){const d=u&&c&&!n;return a.jsxs("div",{className:l,children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",c&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx(t8e,{items:t,value:n??"",onChange:s,getLabel:r,placeholder:i,disabled:o,hasError:d})]})}function t8e({items:e=[],value:t="",onChange:n,getLabel:s,placeholder:r="Search...",disabled:i=!1,maxRender:o=200,hasError:l=!1}){const[c,u]=f.useState(!1),[d,h]=f.useState(""),p=f.useRef(null),x=e.find(y=>String(y.id)===String(t)),b=x?s(x):"",j=f.useMemo(()=>{const y=d.trim().toLowerCase();return(y?e.filter(w=>(s(w)||"").toLowerCase().includes(y)):e).slice(0,o)},[e,d,s,o]);return f.useEffect(()=>{const y=N=>{p.current&&!p.current.contains(N.target)&&u(!1)};return document.addEventListener("mousedown",y),()=>document.removeEventListener("mousedown",y)},[]),f.useEffect(()=>{c||h("")},[c]),a.jsxs("div",{ref:p,className:"relative w-full",children:[a.jsx("input",{disabled:i,value:c?d:b,placeholder:r,onFocus:()=>!i&&u(!0),onChange:y=>{h(y.target.value),c||u(!0)},className:`w-full border rounded-md px-2 py-1.5 text-sm outline-none focus:ring-2
          ${l?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}`}),c&&!i&&a.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg overflow-hidden",children:[a.jsx("div",{className:"max-h-56 overflow-y-auto hide-scrollbar",children:j.length>0?j.map(y=>{const N=String(y.id),w=s(y),S=String(t)===N;return a.jsx("button",{type:"button",onClick:()=>{n(N),u(!1)},className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-50 ${S?"bg-blue-50":""}`,children:w||"--"},N)}):a.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No results"})}),e.length>o&&a.jsxs("div",{className:"px-3 py-2 text-[11px] text-gray-400 border-t",children:["Showing first ",o," results  keep typing to narrow."]})]})]})}function a8e({label:e,name:t,value:n,onChange:s,placeholder:r,rows:i=3,disabled:o=!1,className:l=""}){return a.jsxs("div",{className:l,children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsx("textarea",{name:t,value:n??"",onChange:s,placeholder:r,rows:i,disabled:o,className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100 resize-none"})]})}function n8e({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o=!1,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-orange-500 hover:bg-orange-600 border border-orange-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsx("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${u}`,disabled:o,children:o?"Processing...":s})]})]})})}function s8e(){const{userRole:e}=Ks();return a.jsx(N1,{currentUserRole:e,currentUserId:null})}function r8e(){f.useEffect(()=>{document.title="Audit | Sari-Sari CRM"},[]);const[e,t]=f.useState(null),[n,s]=f.useState(""),[r,i]=f.useState("Filter by Actions"),[o,l]=f.useState(1),[c,u]=f.useState(10),d=async()=>{try{const w=await ne.get("/logs/read-all");t(w.data)}catch(w){console.error("Error fetching audit logs:",w)}};f.useEffect(()=>{d()},[]);const h=f.useMemo(()=>{if(!Array.isArray(e))return[];const w=n.trim().toLowerCase(),S=r?.toUpperCase?.()||"ALL";return e.filter(T=>{const k=T.timestamp?new Date(T.timestamp).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}):"",A=`${T.entity_type||""} ${T.entity_name||T.entity_details?.name||T.entity_details?.title||T.entity_id||""}`,E=`${T.logger?.first_name||""} ${T.logger?.last_name||""}`,M=[k,E,T.action,T.entity_type,A,T.description],F=w===""||M.some(P=>P==null?!1:P.toString().toLowerCase().includes(w)),D=S==="FILTER BY ACTIONS"||(T.action||"").toUpperCase()===S;return F&&D}).sort((T,k)=>{const A=T.timestamp?new Date(T.timestamp).getTime():0;return(k.timestamp?new Date(k.timestamp).getTime():0)-A})},[e,n,r]),p=Math.max(1,Math.ceil(h.length/c)||1);f.useEffect(()=>{l(1)},[n,r]),f.useEffect(()=>{l(w=>{const S=Math.max(1,Math.ceil(h.length/c)||1);return w>S?S:w})},[h.length]);const x=f.useMemo(()=>{const w=(o-1)*c;return h.slice(w,w+c)},[h,o]);h.length===0||(o-1)*c+1,Math.min(o*c,h.length);const b=()=>l(w=>Math.max(w-1,1)),j=()=>l(w=>Math.min(w+1,p)),y=()=>{if(!h.length){Jx.error("No logs to export!");return}const w=["Timestamp","User","Action","Resource","Details"],S=h.map(E=>[new Date(E.timestamp).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}),`${E.logger?.first_name||""} ${E.logger?.last_name||""}`.trim(),E.action,`${E.entity_type}: ${E.entity_id}`,E.description||""]),_=[w.join(","),...S.map(E=>E.map(M=>`"${String(M).replace(/"/g,'""')}"`).join(","))].join(`
`),T=new Blob([_],{type:"text/csv;charset=utf-8;"}),k=URL.createObjectURL(T),A=document.createElement("a");A.href=k,A.download=`AuditLogs_${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(A),A.click(),document.body.removeChild(A),URL.revokeObjectURL(k)},N=w=>{switch((w||"").toUpperCase()){case"CREATE":return"bg-green-100 text-green-700";case"UPDATE":case"EDIT":return"bg-blue-100 text-blue-700";case"DELETE":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-700"}};return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[e===null&&a.jsx(qt,{message:"Loading audit logs..."}),a.jsx(Zx,{toastOptions:{duration:1e3}}),a.jsxs("div",{className:"bg-blue-50 border-l-4 border-blue-400 p-4 mb-6 rounded-r-md flex items-center",children:[a.jsx(Pt,{className:"text-blue-600 mr-3 flex-shrink-0",size:20}),a.jsxs("p",{className:"text-sm text-blue-700",children:[a.jsx("span",{className:"font-semibold",children:"Data Retention Policy:"})," Audit logs are automatically purged after 6 months to optimize system performance."]})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-5 space-y-3 sm:space-y-0",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Ls,{className:"text-blue-600",size:20}),a.jsx("h2",{className:"text-2xl sm:text-xl font-semibold text-gray-700",children:"Audit Logs"})]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 rounded-md hover:bg-gray-800 text-sm sm:text-base self-end sm:self-auto cursor-pointer",onClick:y,children:[a.jsx(Vo,{className:"mr-2"}),"Export Logs"]})})]}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition bg-white",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search audit logs",value:n,onChange:w=>s(w.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsx("div",{className:"w-full lg:w-1/4",children:a.jsxs("select",{value:r,onChange:w=>i(w.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{value:"Filter by Actions",children:"Filter by Actions"}),a.jsx("option",{value:"CREATE",children:"CREATE"}),a.jsx("option",{value:"DELETE",children:"DELETE"}),a.jsx("option",{value:"UPDATE",children:"UPDATE"})]})})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[600px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 text-sm tracking-wide font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4",children:"Timestamp"}),a.jsx("th",{className:"py-3 px-4",children:"User"}),a.jsx("th",{className:"py-3 px-4",children:"Action"}),a.jsx("th",{className:"py-3 px-4",children:"Resource"}),a.jsx("th",{className:"py-3 px-4",children:"Details"})]})}),a.jsx("tbody",{children:Array.isArray(h)&&h.length>0?x.map((w,S)=>a.jsxs("tr",{className:"hover:bg-gray-50 text-sm",children:[a.jsx("td",{className:"py-3 px-4 text-gray-700 whitespace-nowrap",children:new Date(w.timestamp).toLocaleString("en-US",{month:"numeric",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}).replace(",","")}),a.jsx("td",{className:"py-3 px-4 text-gray-700",children:w.name}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium whitespace-nowrap ${N(w.action)}`,children:w.action})}),a.jsxs("td",{className:"py-3 px-4 text-gray-700",children:[w.entity_type,": ",w.entity_id]}),a.jsx("td",{className:"py-3 px-4 text-gray-700",children:w.description})]},S)):a.jsx("tr",{children:a.jsx("td",{className:"py-3 px-4 text-sm text-gray-500 text-center",colSpan:5,children:"No activities to show."})})})]})}),a.jsx(ca,{className:"mt-4",totalItems:h.length,pageSize:c,currentPage:o,onPrev:b,onNext:j,onPageSizeChange:w=>{u(w),l(1)},pageSizeOptions:[10,20,30,40,50],label:"logs"})]})}const i8e=[{value:"PLANNED",label:"PLANNED"},{value:"HELD",label:"HELD"},{value:"NOT_HELD",label:"NOT HELD"}],o8e=e=>e?String(e).toUpperCase():"",gu=e=>{const t=o8e(e);return t==="PLANNED"||t==="PENDING"?"PLANNED":t==="HELD"||t==="COMPLETED"?"HELD":t==="NOT HELD"||t==="NOT_HELD"||t==="CANCELLED"?"NOT_HELD":"PLANNED"},fT=e=>{const t=gu(e);return t==="PLANNED"?"PLANNED":t==="HELD"?"HELD":t==="NOT_HELD"?"NOT HELD":"--"},I8=e=>{switch(gu(e)){case"PLANNED":return"bg-indigo-100 text-indigo-700";case"HELD":return"bg-green-100 text-green-700";case"NOT_HELD":return"bg-gray-200 text-gray-700";default:return"bg-gray-100 text-gray-700"}},$8=e=>e?new Date(e).toLocaleString("en-US",{month:"2-digit",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}):"--";function l8e(){const[e,t]=f.useState(!1),[n,s]=f.useState(null),[r,i]=f.useState(null),[o,l]=f.useState(null),[c,u]=f.useState(null),[d,h]=f.useState([]),[p,x]=f.useState(null),[b,j]=f.useState(!1),[y,N]=f.useState(null),[w,S]=f.useState(!1),[_,T]=f.useState(!1),[k,A]=f.useState("PLANNED"),[E,M]=f.useState(!1),[F,D]=f.useState(!1),[P,B]=f.useState(null),[G,$]=f.useState(new Set),[W,Z]=f.useState(!1),{user:Q}=Gt(),{comments:le,addComment:we,refresh:J}=kn({relatedType:"call",relatedId:n?.id});f.useEffect(()=>{n?.id&&J()},[n?.id,J]),Bs();const se=Et(),ye=ta(),Ce=fe=>{if(!fe)return"";const H=String(fe).split("-");return H.length===3?`${H[0]}-${H[2]}`:String(fe)},be={subject:"",call_time:(()=>{const fe=new Date,H=fe.getFullYear(),te=String(fe.getMonth()+1).padStart(2,"0"),q=String(fe.getDate()).padStart(2,"0");return`${H}-${te}-${q}T08:00`})(),duration_minutes:"",direction:"Outgoing",status:"Planned",notes:"",relatedType1:"Lead",relatedType2:null,relatedTo1:null,relatedTo2:null,assigned_to:null},[me,Ae]=f.useState(be);f.useEffect(()=>{const fe=ye.state,H=fe?.callID;if(H&&!fe?.openCallModal){B(H),se(ye.pathname,{replace:!0,state:{}});return}!fe?.openCallModal||!fe?.initialCallData||fe.initialCallData.relatedType1==="Lead"&&Array.isArray(o)&&o.length===0||fe.initialCallData.relatedType1==="Account"&&(!Array.isArray(o)||o.length===0)||(t(!0),Ae(te=>({...te,...fe.initialCallData,relatedTo1:fe.initialCallData.relatedTo1?String(fe.initialCallData.relatedTo1):"",relatedTo2:fe.initialCallData.relatedTo2?String(fe.initialCallData.relatedTo2):""})),se(ye.pathname,{replace:!0,state:{}}))},[ye.state,o]),f.useEffect(()=>{if(P&&d.length>0&&!F){const fe=d.find(H=>H.id===P);fe?s(fe):V.error("Call not found."),B(null)}},[P,d,F]);const pe=async()=>{try{D(!0);const fe=await ne.get("/calls/admin/fetch-all"),te=[...Array.isArray(fe.data)?fe.data:[]].sort((q,Y)=>{const U=q?.created_at?new Date(q.created_at):0;return(Y?.created_at?new Date(Y.created_at):0)-U});h(te)}catch(fe){console.error("Error fetching calls:",fe),V.error("Failed to load calls")}finally{D(!1)}},Ie=async()=>{try{const fe=await ne.get("/users/all");x(fe.data)}catch(fe){console.error("Error fetching users: ",fe)}};f.useEffect(()=>{Ie(),pe()},[]);const[xe,he]=f.useState(""),[Re,Ee]=f.useState("Filter by Status"),[He,Ke]=f.useState("Filter by Users"),[st,it]=f.useState(1),[ot,rt]=f.useState(10);f.useEffect(()=>{it(1)},[xe,Re,He,ot]);const at=Array.isArray(p)?p.map(fe=>({id:fe.id,name:`${fe.first_name} ${fe.last_name}`})):[],Fe=["GROUP MANAGER","MANAGER","SALES"].includes(Q?.role?.toUpperCase())?d.filter(fe=>fe.status!=="INACTIVE"):d,Ue=f.useMemo(()=>Fe.filter(fe=>{const H=!xe||[fe.subject,fe.notes,fe.lead?.title,fe.account?.name,fe.contact?.first_name,fe.contact?.last_name,fe.deal?.name].some(U=>U&&String(U).toLowerCase().includes(xe.toLowerCase())),te=Re==="Filter by Status"||gu(fe.status)===Re,q=fe.call_assign_to?`${fe.call_assign_to.first_name} ${fe.call_assign_to.last_name}`:"";return H&&te&&(He==="Filter by Users"||q===He)}),[Fe,xe,Re,He]),Ne=f.useMemo(()=>{const fe=(st-1)*ot;return Ue.slice(fe,fe+ot)},[Ue,st,ot]),ze=Fe.length,je=Fe.filter(fe=>gu(fe.status)==="PLANNED").length,ve=Fe.filter(fe=>gu(fe.status)==="HELD").length,z=Fe.filter(fe=>gu(fe.status)==="NOT_HELD").length,K=[{title:"Total",value:ze,icon:Us,color:"text-slate-600",bgColor:"bg-slate-100"},{title:"Planned",value:je,icon:Vn,color:"text-indigo-600",bgColor:"bg-indigo-100"},{title:"Held",value:ve,icon:La,color:"text-green-600",bgColor:"bg-green-100"},{title:"Not Held",value:z,icon:Yn,color:"text-gray-600",bgColor:"bg-gray-100"}],[ue,re]=f.useState("Overview"),Le=fe=>{const{name:H,value:te}=fe.target;Ae(q=>{const Y={...q,[H]:te};return H==="relatedType1"&&(Y.relatedTo1="",te==="Lead"?(Y.relatedType2=null,Y.relatedTo2=null,u([])):te==="Account"&&(Y.relatedType2="Contact")),H==="relatedType2"&&(Y.relatedTo2=""),Y})};f.useEffect(()=>{const fe=async()=>{try{l([]);let H;me.relatedType1==="Lead"?H=await ne.get("/leads/admin/getLeads"):me.relatedType1==="Account"&&(H=await ne.get("/accounts/admin/fetch-all"));let te=[];if(H&&Array.isArray(H.data)?te=H.data:te=[],b&&me.relatedTo1)try{let q;me.relatedType1==="Lead"?q=await ne.get(`/leads/get/${me.relatedTo1}`):me.relatedType1==="Account"&&(q=await ne.get(`/accounts/get/${me.relatedTo1}`)),q&&q.data&&(te.some(U=>String(U.id)===String(me.relatedTo1))||(te=[q.data,...te]))}catch(q){console.error("Error fetching specific related item:",q)}l(te)}catch(H){console.error("Error fetching data:",H),l([])}};me.relatedType1&&fe()},[me.relatedType1,b,me.relatedTo1]),f.useEffect(()=>{const fe=async()=>{try{u([]);let H;if(me.relatedType1==="Account"&&me.relatedTo1)me.relatedType2==="Contact"?H=await ne.get(`/contacts/from-acc/${me.relatedTo1}`):me.relatedType2==="Deal"?H=await ne.get(`/deals/from-acc/${me.relatedTo1}`):me.relatedType2==="Quote"&&(H=await ne.get(`/quotes/from-acc/${me.relatedTo1}`));else{u([]);return}H&&Array.isArray(H.data)?u(H.data):u([])}catch(H){console.error("Error fetching data:",H),u([])}};me.relatedType2&&fe()},[me.relatedType2,me.relatedTo1,me.relatedType1]);const[De,Qe]=f.useState(!1),tt=fe=>{fe.preventDefault(),Qe(!0);const H=me.subject;if(!H||H.trim()===""){V.error("Subject is required.");return}if(!me.relatedTo1){V.error(`Please select a ${me.relatedType1||"Lead/Account"}.`);return}if(!me.assigned_to){V.error("Subject is required.");return}const q={...me,duration_minutes:me.duration_minutes?parseInt(me.duration_minutes,10):null,relatedTo1:me.relatedTo1?parseInt(me.relatedTo1,10):null,relatedTo2:me.relatedType1==="Lead"?null:me.relatedTo2?parseInt(me.relatedTo2,10):null,relatedType2:me.relatedType1==="Lead"?null:me.relatedType2,assigned_to:me.assigned_to?parseInt(me.assigned_to,10):null},Y=b&&y?"update":"create",U=(me.subject||"").trim()||"Untitled Call";i({title:Y==="create"?"Confirm New Call":"Confirm Update",message:Y==="create"?`Create "${U}"?`:`Save changes to "${U}"?`,confirmLabel:Y==="create"?"Create Call":"Update Call",cancelLabel:"Cancel",variant:"primary",action:{type:Y,payload:q,targetId:y||null,name:U}})},Me=fe=>s(fe),et=()=>{t(!1),j(!1),N(null)},yt=async()=>{if(!r?.action){i(null);return}const{action:fe}=r,{type:H,payload:te,targetId:q,name:Y}=fe;T(!0);try{if(H==="create")S(!0),await ne.post("/calls/create",te),V.success(`Call "${Y}" created successfully.`),t(!1),Ae(be),j(!1),N(null),await pe();else if(H==="update"){if(!q)throw new Error("Missing call identifier for update.");S(!0),await ne.put(`/calls/${q}`,te),V.success(`Call "${Y}" updated successfully.`),t(!1),Ae(be),j(!1),N(null),await pe()}else if(H==="delete"){if(!q)throw new Error("Missing call identifier for archiving.");await ne.put(`/calls/${q}`,{status:"INACTIVE"}),V.success(`Call "${Y}" archived successfully.`),n?.id===q&&s(null),await pe()}else if(H==="bulk-delete"){const{targetIds:U,count:de}=fe;if(!U||U.length===0)throw new Error("Missing call identifiers for bulk archiving.");Z(!0),await ne.put("/calls/bulk-archive",{call_ids:U}),V.success(`${de} call${de!==1?"s":""} archived successfully.`),$(new Set),await pe(),n&&G.has(n.id)&&s(null)}}catch(U){const de=H==="create"?"Failed to create call. Please review the details and try again.":H==="update"?"Failed to update call. Please review the details and try again.":H==="bulk-delete"?"Failed to archive calls. Please try again.":"Failed to archive call. Please try again.",Te=U?.response?.data?.detail||de;V.error(Te)}finally{(H==="create"||H==="update")&&S(!1),H==="bulk-delete"&&Z(!1),T(!1),i(null)}},_t=()=>{_||i(null)},Ct=async()=>{if(n?.id)try{M(!0),await ne.put(`/calls/${n.id}`,{status:k}),V.success(`Status updated to ${fT(k)}`),h(fe=>Array.isArray(fe)?fe.map(H=>H.id===n.id?{...H,status:k}:H):fe),s(null)}catch(fe){const H=fe.response?.data?.detail||"Failed to update status.";V.error(H)}finally{M(!1)}},jt=fe=>{const H=Ne.find(te=>te.id===fe);H&&H.call_creator?.id===Q?.id&&$(te=>{const q=new Set(te);return q.has(fe)?q.delete(fe):q.add(fe),q})},At=()=>{const fe=Ne.filter(H=>H.call_creator?.id===Q?.id);G.size===fe.length&&fe.length>0?$(new Set):$(new Set(fe.map(H=>H.id)))},Ge=()=>{if(G.size===0)return;const fe=G.size;i({title:"Archive Calls",message:a.jsxs("span",{children:["Are you sure you want to archive"," ",a.jsx("span",{className:"font-semibold",children:fe})," call",fe!==1?"s":"","? You can restore them later if needed."]}),confirmLabel:`Archive ${fe} Call${fe!==1?"s":""}`,cancelLabel:"Cancel",variant:"archive",action:{type:"bulk-delete",targetIds:Array.from(G),count:fe}})};f.useEffect(()=>{n&&A(gu(n.status))},[n]);const Be=n?a.jsxs("div",{id:"callModalBackdrop",onClick:fe=>fe.target.id==="callModalBackdrop"&&s(null),className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center p-4",children:[F&&a.jsx(qt,{message:"Loading call details..."}),a.jsxs("div",{className:"bg-white rounded-xl shadow-lg w-full max-w-full lg:max-w-4xl max-h-[95vh] overflow-y-auto hide-scrollbar relative box-border",children:[a.jsxs("div",{className:"bg-tertiary w-full rounded-t-xl p-3 lg:p-3 relative",children:[a.jsx("h1",{className:"lg:text-3xl text-xl text-white font-semibold text-center w-full",children:"Calls"}),a.jsx("button",{onClick:()=>s(null),className:"text-gray-500 hover:text-white transition cursor-pointer absolute top-3 right-3",children:a.jsx(Za,{size:25})})]}),a.jsx("div",{className:"mt-4 gap-2 px-2 lg:gap-4 lg:mx-7",children:a.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between lg:flex-row lg:items-center lg:justify-between mt-3 gap-2 px-2 md:items-center lg:gap-4 md:mx-7 lg:mx-7",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[a.jsx("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-800",children:n.subject}),a.jsx("span",{className:`text-xs sm:text-sm font-medium px-2 sm:px-3 py-1 rounded-full ${I8(n.status)}`,children:fT(n.status)})]}),a.jsx("div",{className:"flex flex-col sm:flex-row sm:space-x-3 space-y-2 sm:space-y-0",children:Q?.id===n?.call_creator?.id&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{className:"inline-flex items-center justify-center w-full sm:w-auto bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 transition text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",onClick:()=>{const fe=U=>{if(!U)return"";const de=new Date(U),Te=de.getFullYear(),ie=String(de.getMonth()+1).padStart(2,"0"),Oe=String(de.getDate()).padStart(2,"0"),X=String(de.getHours()).padStart(2,"0"),oe=String(de.getMinutes()).padStart(2,"0");return`${Te}-${ie}-${Oe}T${X}:${oe}`},H=n.lead?"Lead":n.account?"Account":"Lead",te=n.lead?n.lead.id:n.account?n.account.id:null,q=H==="Lead"?null:n.contact?"Contact":n.deal?"Deal":n.quote?"Quote":"Contact",Y=H==="Lead"?null:n.contact?n.contact.id:n.deal?n.deal.id:n.quote?n.quote.id:null;Ae({subject:n.subject||"",call_time:fe(n.call_time),duration_minutes:n.duration_minutes?String(n.duration_minutes):"",direction:n.direction||"Outgoing",status:n.status||"Planned",notes:n.notes||"",relatedType1:H,relatedType2:q,relatedTo1:te?String(te):"",relatedTo2:Y?String(Y):"",assigned_to:n.call_assign_to?.id?String(n.call_assign_to.id):""}),j(!0),N(n.id),s(null),t(!0)},children:[a.jsx(gn,{className:"mr-2"}),"Edit"]}),a.jsxs("button",{className:"inline-flex items-center justify-center w-full sm:w-auto px-4 py-2 rounded-md text-sm bg-orange-500 text-white hover:bg-orange-600 transition focus:outline-none focus:ring-2 focus:ring-orange-400",onClick:()=>{const fe=n.subject||"this call";i({title:"Archive Call",message:`Are you sure you want to archive "${fe}"? You can restore it later if needed.`,confirmLabel:"Archive Call",cancelLabel:"Cancel",variant:"archive",action:{type:"delete",targetId:n.id,name:fe}})},children:[a.jsx(Zt,{className:"mr-2"}),"Archive"]})]})})]})}),a.jsx("div",{className:"border-b border-gray-200 my-5"}),a.jsxs("div",{className:"p-6 lg:p-4",children:[a.jsx("div",{className:"flex w-full bg-[#6A727D] text-white mt-1 overflow-x-auto mb-6",children:["Overview","Notes"].map(fe=>a.jsx("button",{onClick:()=>re(fe),className:`flex-1 min-w-[90px] px-4 py-2.5 text-xs sm:text-sm font-medium border-b-2 ${ue===fe?"bg-paper-white text-[#6A727D] border-white":"text-white hover:bg-[#5c636d]"}`,children:fe},fe))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 items-start",children:[a.jsxs("div",{className:"lg:col-span-3",children:[ue==="Overview"&&a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 md:p-8 border border-gray-200",children:a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4 sm:gap-6 text-sm text-gray-700",children:[a.jsx(yo,{label:"Call Time",value:$8(n.call_time)}),a.jsx(yo,{label:"Duration",value:n.duration_minutes?`${n.duration_minutes} min`:null}),a.jsx(yo,{label:"Direction",value:n.direction||"--"}),a.jsx(yo,{label:"Assigned To",value:`${n.call_assign_to.first_name} ${n.call_assign_to.last_name}`}),n.lead&&a.jsx(yo,{label:"Lead",value:n.lead.title}),n.account&&a.jsx(yo,{label:"Account",value:n.account.name}),n.contact&&a.jsx(yo,{label:"Contact",value:`${n.contact.first_name} ${n.contact.last_name}`}),n.deal&&a.jsx(yo,{label:"Deal",value:n.deal.name}),n.quote&&a.jsx(yo,{label:"Quote",value:Ce(n.quote.quote_id)}),a.jsx(yo,{label:"Created At",value:$8(n.created_at)})]})}),ue==="Notes"&&a.jsxs("div",{className:"mt-4 w-full",children:[a.jsx("div",{className:"flex flex-wrap items-center justify-between mb-4 gap-2",children:a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words",children:"Call Note"})}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 shadow-sm break-words",children:[a.jsx("div",{className:"flex items-start justify-between",children:a.jsx("div",{children:a.jsx("p",{className:"text-sm font-medium text-gray-800 break-words",children:"Note"})})}),a.jsx("div",{className:"mt-3 text-sm text-gray-700 whitespace-pre-wrap break-words",children:n.notes||"No notes available."})]}),a.jsx(Tn,{comments:le,onAddComment:we})]})]}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm w-full",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Status"}),a.jsxs("select",{className:"border border-gray-200 rounded-md px-2 py-1.5 w-full text-sm mb-2",value:k,onChange:fe=>A(fe.target.value),children:[a.jsx("option",{value:"PLANNED",children:"PLANNED"}),a.jsx("option",{value:"HELD",children:"HELD"}),a.jsx("option",{value:"NOT_HELD",children:"NOT HELD"})]}),a.jsx("button",{onClick:Ct,disabled:E,className:"w-full py-1.5 rounded-md text-sm bg-gray-900 text-white hover:bg-gray-800 disabled:opacity-50",children:E?"Updating...":"Update"})]})]})]})]})]}):null,ce=e?a.jsx("div",{id:"modalBackdrop",onClick:fe=>fe.target.id==="modalBackdrop"&&et(),className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-xl rounded-2xl shadow-lg p-4 sm:p-6 md:p-8 relative border border-gray-200 overflow-y-auto max-h-[90vh] hide-scrollbar",children:[a.jsx("button",{onClick:()=>{et(),Qe(!1)},className:"absolute top-4 right-4 text-gray-500 hover:text-black transition",children:a.jsx(ea,{size:22})}),a.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800 mb-4 sm:mb-6 flex items-center justify-center",children:b?"Edit Call":"Add New Call"}),a.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 w-full gap-4 text-sm",onSubmit:tt,noValidate:!0,children:[a.jsx(d8e,{label:"Subject",className:"md:col-span-2",name:"subject",value:me.subject,onChange:Le,isSubmitted:De,required:!0}),a.jsxs("div",{className:"w-full flex flex-col",children:[a.jsxs("div",{className:"relative w-25",children:[a.jsxs("select",{name:"relatedType1",onChange:Le,value:me.relatedType1,className:"outline-none cursor-pointer mb-1 w-22 text-gray-700 disabled:text-gray-400 disabled:cursor-not-allowed",disabled:w,children:[a.jsx("option",{value:"Lead",children:"Lead"}),a.jsx("option",{value:"Account",children:"Account"})]}),a.jsx("span",{className:"absolute left-10 md:pl-6 pl-6 top-1/2 -translate-y-1/2 text-red-500 pointer-events-none",children:"*"})]}),a.jsx(hT,{items:Array.isArray(o)?o:[],value:me.relatedTo1??"",placeholder:`Search ${me.relatedType1||"here"}...`,getLabel:fe=>me.relatedType1==="Lead"?fe.title:fe.name??"",onChange:fe=>Ae(H=>({...H,relatedTo1:fe})),required:!0,isSubmitted:De,disabled:w})]}),a.jsxs("div",{className:"w-full flex flex-col",children:[a.jsxs("select",{name:"relatedType2",onChange:Le,value:me.relatedType2??"Contact",className:"text-gray-700 outline-none cursor-pointer mb-1 w-22 disabled:text-gray-400 disabled:cursor-not-allowed",disabled:me.relatedType1==="Lead"||w,children:[a.jsx("option",{value:"Contact",children:"Contact"}),a.jsx("option",{value:"Deal",children:"Deal"}),a.jsx("option",{value:"Quote",children:"Quote"})]}),a.jsx(hT,{disabled:me.relatedType1==="Lead"||w,items:Array.isArray(c)?c:[],value:me.relatedTo2??"",placeholder:me.relatedType1==="Lead"?"":Array.isArray(c)&&c.length>0?`Search ${me.relatedType2||"Contact"}...`:`No ${me.relatedType2||""} data found`,getLabel:fe=>me.relatedType2==="Contact"?`${fe.first_name??""} ${fe.last_name??""}`.trim():me.relatedType2==="Quote"?Ce(fe.quote_id)??"":fe.name??"",onChange:fe=>Ae(H=>({...H,relatedTo2:fe}))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Call Time"}),a.jsx("input",{type:"datetime-local",value:me.call_time,onChange:Le,name:"call_time",className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100"})]}),a.jsxs("div",{className:"w-full",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Duration"}),a.jsxs("div",{className:"w-full rounded-md text-sm flex flex-row items-center justify-start",children:[a.jsx("input",{type:"tel",value:me.duration_minutes,onChange:Le,name:"duration_minutes",className:"border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100 w-44 mr-3"}),a.jsx("p",{children:"minutes"})]})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:["Assign To ",a.jsx("span",{className:"text-red-500 font-semibold",children:"*"})]}),a.jsx(hT,{items:Array.isArray(p)?p:[],value:me.assigned_to??"",placeholder:"Search an account...",getLabel:fe=>`${fe.first_name} ${fe.last_name}`,onChange:fe=>Ae(H=>({...H,assigned_to:fe})),required:!0,isSubmitted:De})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Direction"}),a.jsxs("select",{name:"direction",onChange:Le,value:me.direction,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100",children:[a.jsx("option",{value:"Incoming",children:"Incoming"}),a.jsx("option",{value:"Outgoing",children:"Outgoing"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Status"}),a.jsxs("select",{name:"status",onChange:Le,value:me.status,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100",children:[a.jsx("option",{value:"Planned",children:"Planned"}),a.jsx("option",{value:"Held",children:"Held"}),a.jsx("option",{value:"Not held",children:"Not held"})]})]}),a.jsx(u8e,{className:"col-span-2",label:"Notes",value:me.notes,onChange:Le,name:"notes"}),a.jsxs("div",{className:"flex flex-col md:flex-row justify-end col-span-2 mt-4 gap-2 w-full",children:[a.jsx("button",{type:"button",onClick:()=>{et(),Qe(!1)},className:"w-full sm:w-auto px-4 py-2 text-white bg-red-400 border border-red-300 rounded hover:bg-red-500 transition",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:w,className:"w-full sm:w-auto px-4 py-2 text-white bg-tertiary border border-tertiary rounded hover:bg-secondary transition",children:w?"Saving...":b?"Update Call":"Save Call"})]})]})]})}):null;return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h1",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(Us,{className:"mr-2 text-blue-600"})," Calls"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{onClick:()=>{Ae(be),j(!1),N(null),t(!0),Qe(!1)},className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 my-1 lg:my-0 rounded-md hover:bg-gray-800 text-sm sm:text-base mx-auto sm:ml-auto cursor-pointer",children:[a.jsx(aa,{className:"mr-2"})," Add Call"]})})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-4 mb-6 w-full break-words overflow-hidden lg:overflow-visible",children:K.map(fe=>a.jsx(c8e,{...fe},fe.title))}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center gap-3",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search calls",className:"focus:outline-none text-base w-full",value:xe,onChange:fe=>he(fe.target.value)})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row w-full lg:w-1/2 gap-2",children:[a.jsxs("select",{value:Re,onChange:fe=>Ee(fe.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm bg-white w-full",children:[a.jsx("option",{value:"Filter by Status",children:"Filter by Status"}),i8e.map(fe=>a.jsx("option",{value:fe.value,children:fe.label},fe.value))]}),a.jsxs("select",{value:He,onChange:fe=>Ke(fe.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm bg-white w-full",children:[a.jsx("option",{value:"Filter by Users",children:"Filter by Users"}),at.map(fe=>a.jsx("option",{value:fe.name,children:fe.name},fe.id))]})]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[500px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm mb-4",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 w-12",children:a.jsx("input",{type:"checkbox",checked:G.size>0&&G.size===Ne.filter(fe=>fe.call_creator?.id===Q?.id).length&&Ne.filter(fe=>fe.call_creator?.id===Q?.id).length>0,onChange:At,className:"w-4 h-4 cursor-pointer"})}),a.jsx("th",{className:"py-3 px-4",children:"Subject"}),a.jsx("th",{className:"py-3 px-4",children:"Related To"}),a.jsx("th",{className:"py-3 px-4",children:"Call Time"}),a.jsx("th",{className:"py-3 px-4",children:"Assigned To"}),a.jsx("th",{className:"py-3 px-4",children:"Status"}),a.jsx("th",{className:"py-3 px-4 w-12",children:G.size>0&&a.jsx("button",{onClick:Ge,className:"text-orange-500 hover:text-orange-700 transition",title:"Archive selected calls",disabled:W,children:a.jsx(Zt,{size:18})})})]})}),a.jsx("tbody",{children:F?a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"py-10",children:a.jsx(qt,{message:"Loading calls..."})})}):Ne.length>0?Ne.map(fe=>a.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer border-b border-gray-100",children:[a.jsx("td",{className:"py-3 px-4",children:Q?.id===fe.call_creator?.id&&a.jsx("input",{type:"checkbox",checked:G.has(fe.id),onChange:H=>{H.stopPropagation(),jt(fe.id)},className:"w-4 h-4 cursor-pointer"})}),a.jsx("td",{className:"py-3 px-4 text-blue-600 font-medium",onClick:()=>Me(fe),children:fe.subject||"--"}),a.jsxs("td",{className:"py-3 px-4",onClick:()=>Me(fe),children:[fe.lead&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:fe.lead.title}),fe.account&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:fe.account.name}),fe.contact&&a.jsxs("p",{className:"font-medium text-blue-500 text-xs",children:[fe.contact.first_name," ",fe.contact.last_name]}),fe.deal&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:fe.deal.name}),fe.quote&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:Ce(fe.quote.quote_id)})]}),a.jsx("td",{className:"py-3 px-4 text-gray-800",onClick:()=>Me(fe),children:fe.call_time?new Date(fe.call_time).toLocaleString():"--"}),a.jsx("td",{className:"py-3 px-4 text-gray-800",onClick:()=>Me(fe),children:fe?.call_assign_to?`${fe.call_assign_to.first_name} ${fe.call_assign_to.last_name}`:"--"}),a.jsx("td",{className:"py-3 px-4",onClick:()=>Me(fe),children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${I8(fe.status)}`,children:fT(fe.status)})}),a.jsx("td",{className:"py-3 px-4"})]},fe.id)):a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"text-center py-4 text-gray-500",children:"No calls found."})})})]})}),a.jsx(ca,{totalItems:Ue.length,pageSize:ot,currentPage:st,onPrev:()=>it(fe=>Math.max(1,fe-1)),onNext:()=>it(fe=>fe+1),onPageSizeChange:fe=>{rt(fe),it(1)},pageSizeOptions:[10,20,30,40,50],label:"calls"})]}),Be,ce,r&&a.jsx(m8e,{open:!0,title:r.title,message:r.message,confirmLabel:r.confirmLabel,cancelLabel:r.cancelLabel,variant:r.variant,onConfirm:yt,onCancel:_t,loading:_})]})}function c8e({icon:e,title:t,value:n,color:s,bgColor:r}){return a.jsxs("div",{className:"flex items-center p-4 bg-white rounded-xl shadow-md border border-gray-200 transition-all duration-300",children:[a.jsx("div",{className:`p-3 rounded-full ${r} ${s} mr-4`,children:a.jsx(e,{size:22})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:t}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:n})]})]})}function d8e({label:e,name:t,value:n,onChange:s,placeholder:r="",type:i="text",required:o=!1,disabled:l=!1,isSubmitted:c=!1,className:u=""}){const d=c&&o&&!n;return a.jsxs("div",{className:u,children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",o&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:i,name:t,value:n??"",onChange:s,placeholder:r,disabled:l,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border focus:ring-2 disabled:bg-gray-100
          ${d?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}
        `})]})}function u8e(e){return a.jsxs("div",{className:e.className,children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e.label}),a.jsx("textarea",{...e,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100 resize-none"})]})}function yo({label:e,value:t}){return a.jsxs("p",{children:[a.jsxs("span",{className:"font-semibold",children:[e,":"]})," ",a.jsx("br",{}),a.jsx("span",{className:"break-words",children:t||"--"})]})}function m8e({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o=!1,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":i==="archive"?"bg-orange-500 hover:bg-orange-600 border border-orange-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsx("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${u}`,disabled:o,children:o?"Processing...":s})]})]})})}function hT({items:e=[],value:t="",onChange:n,getLabel:s,placeholder:r="Search...",disabled:i=!1,maxRender:o=200,required:l=!1,isSubmitted:c=!1}){const[u,d]=f.useState(!1),[h,p]=f.useState(""),x=f.useRef(null),b=e.find(w=>String(w.id)===String(t)),j=b?s(b):"",y=l&&c&&!t,N=f.useMemo(()=>{const w=h.trim().toLowerCase();return(w?e.filter(_=>(s(_)||"").toLowerCase().includes(w)):e).slice(0,o)},[e,h,s,o]);return f.useEffect(()=>{const w=S=>{x.current&&!x.current.contains(S.target)&&d(!1)};return document.addEventListener("mousedown",w),()=>document.removeEventListener("mousedown",w)},[]),f.useEffect(()=>{u||p("")},[u]),a.jsxs("div",{ref:x,className:"relative w-full",children:[a.jsx("input",{disabled:i,value:u?h:j,placeholder:r,onFocus:()=>!i&&d(!0),onChange:w=>{p(w.target.value),u||d(!0)},className:`w-full border rounded-md px-2 py-1.5 text-sm outline-none focus:ring-2 disabled:bg-gray-100
          ${y?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}`}),u&&!i&&a.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg overflow-hidden",children:[a.jsx("div",{className:"max-h-56 overflow-y-auto",children:N.length>0?N.map(w=>{const S=String(w.id),_=s(w),T=String(t)===S;return a.jsx("button",{type:"button",onClick:()=>{n(S),d(!1)},className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-50 ${T?"bg-blue-50":""}`,children:_||"--"},S)}):a.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No results"})}),e.length>o&&a.jsxs("div",{className:"px-3 py-2 text-[11px] text-gray-400 border-t",children:["Showing first ",o," results  keep typing to narrow."]})]})]})}const R8=["Not started","In progress","Deferred","Completed"],z8={NOT_STARTED:"Not started","NOT STARTED":"Not started","TO DO":"Not started",IN_PROGRESS:"In progress","IN PROGRESS":"In progress",COMPLETED:"Completed",DEFERRED:"Deferred","Not started":"Not started","In progress":"In progress",Completed:"Completed",Deferred:"Deferred","In Progress":"In progress","To Do":"Not started",Review:"Deferred"},DJ=e=>e&&(z8[e]||z8[String(e).toUpperCase()])||"Not started",f8e=e=>{if(!e)return"";const t=new Date(e);if(Number.isNaN(t.getTime()))return"";const n=t.getTimezoneOffset();return new Date(t.getTime()-n*60*1e3).toISOString().slice(0,16)},gT=e=>{if(!e)return"";const t=new Date(e);return Number.isNaN(t.getTime())?"":t.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},h8e=e=>{const t=e.subject?.trim()??"",n=e.description?.trim()??"",s=e.notes?.trim()??"";e.priority&&String(e.priority).toUpperCase(),DJ(e.status);let r=null,i=null,o=null,l=null,c=null;e.relatedType1==="Lead"&&e.relatedTo1?r=Number(e.relatedTo1):e.relatedType1==="Account"&&e.relatedTo1&&(i=Number(e.relatedTo1)),e.relatedType1==="Account"&&(e.relatedType2==="Contact"&&e.relatedTo2?o=Number(e.relatedTo2):e.relatedType2==="Deal"&&e.relatedTo2?l=Number(e.relatedTo2):e.relatedType2==="Quote"&&e.relatedTo2&&(c=Number(e.relatedTo2)));const u=e.assignedTo?Number(e.assignedTo):null,d=o||l||i||r,h=o?"Contact":l?"Deal":i?"Account":r?"Lead":c?"Quote":null;return{title:t,description:n,priority:e.priority||"Normal",status:e.status||"Not started",due_date:e.dueDate?e.dueDate:null,assigned_to:u,notes:s,is_personal:!1,lead_id:r,account_id:i,contact_id:o,deal_id:l,quote_id:c,related_to_1:e.relatedTo1?Number(e.relatedTo1):null,related_type_1:e.relatedType1,related_to_2:e.relatedTo2?Number(e.relatedTo2):null,related_type_2:e.relatedType2,related_to:d,related_type:h}},g8e=e=>{const t=e.task_assign_to?`${e.task_assign_to.first_name} ${e.task_assign_to.last_name}`:e.assigned_to?String(e.assigned_to):"Unassigned",n=e.task_creator?`${e.task_creator.first_name} ${e.task_creator.last_name}`:e.created_by?String(e.created_by):"System",s=e.due_date||e.dueDate||null,r=e.date_assigned||e.created_at||null,i=e.contact?`${e.contact.first_name} ${e.contact.last_name}`:e.assigned_to?String(e.assigned_to.id):"Unassigned",o=G=>{if(!G)return"";const $=String(G).split("-");return $.length===3?`${$[0]}-${$[2]}`:String(G)},l=()=>e.lead?.id||e.lead_id,c=()=>e.account?.id||e.account_id,u=()=>e.contact?.id||e.contact_id,d=()=>e.deal?.id||e.deal_id,h=()=>e.quote?.id||e.quote_id,p=()=>e.task_assign_to?.id||e.assigned_to,x=()=>e.lead?.title||e.lead_id,b=()=>e.account?.name||e.account_id,j=()=>i||e.contact_id,y=()=>e.deal?.name||e.deal_id,N=()=>o(e.quote?.quote_id)||e.id;let w="Lead",S="",_="",T="",k="Lead",A="",E="",M="";const F=c(),D=b(),P=l(),B=x();if(F){w="Account",k="Account",A=D,S=String(F);const G=u(),$=d(),W=j(),Z=y(),Q=h(),le=N();G?(_="Contact",E="Contact",M=W,T=String(G)):$?(E="Deal",_="Deal",M=Z,T=String($)):Q&&(E="Quote",_="Quote",M=le,T=String(Q))}else P?(k="Lead",A=B,w="Lead",S=String(P)):e.related_type==="Account"&&(w="Account",S=String(e.related_to));return{id:e.id,title:e.title,description:e.description,priority:e.priority||"Normal",status:DJ(e.status),dueDate:s,dateAssigned:r,assignedToId:p()||null,assignedToName:t,createdAt:e.created_at||null,createdById:e.created_by??null,createdBy:n,notes:e.notes||"",isPersonal:!!e.is_personal,relatedType1Text:k,relatedTo1Text:A,relatedType2Text:E,relatedTo2Text:M,subject:e.title,relatedType1:w,relatedTo1:S,relatedType2:_,relatedTo2:T}};function p8e(){f.useEffect(()=>{document.title="Tasks | Sari-Sari CRM"},[]);const{user:e,loading:t}=Gt(),[n,s]=f.useState("board"),[r,i]=f.useState(!1),[o,l]=f.useState(null),[c,u]=f.useState(!1),[d,h]=f.useState([]),[p,x]=f.useState(!0),[b,j]=f.useState(""),[y,N]=f.useState("Filter by Status"),[w,S]=f.useState("Filter by Priority"),[_,T]=f.useState([]),[k,A]=f.useState(1),[E,M]=f.useState(10),[F,D]=f.useState(null),[P,B]=f.useState(!1),[G,$]=f.useState([]),[W,Z]=f.useState(null),Q=Et(),le=ta(),[we,J]=f.useState({id:"",subject:"",description:"",priority:"",status:"",dueDate:"",assignedTo:"",notes:"",relatedType1:"Lead",relatedType2:"Contact",relatedTo1:"",relatedTo2:""}),[se,ye]=f.useState(null),Ce=qx(qf(dm,{activationConstraint:{distance:8}})),ge=z=>{const{active:K}=z,ue=d.find(re=>re.id===K.id);Z(ue)},be=async z=>{const{active:K,over:ue}=z;if(Z(null),!ue)return;const re=K.id,Le=ue.id,De=d.find(Qe=>Qe.id===re);if(!(!De||De.status===Le)){h(Qe=>Qe.map(tt=>tt.id===re?{...tt,status:Le}:tt));try{const Qe={title:De.title,description:De.description||"",priority:De.priority||"Normal",status:Le,due_date:De.dueDate||null,assigned_to:De.assignedToId||null,related_type_1:De.relatedType1||null,related_to_1:De.relatedTo1?parseInt(De.relatedTo1,10):null,related_type_2:De.relatedType2||null,related_to_2:De.relatedTo2?parseInt(De.relatedTo2,10):null};(!Qe.related_to_1||isNaN(Qe.related_to_1))&&(Qe.related_to_1=null),(!Qe.related_to_2||isNaN(Qe.related_to_2))&&(Qe.related_to_2=null),await ne.put(`/tasks/${re}`,Qe),V.success(`Task moved to "${Le}"`)}catch(Qe){console.error("Failed to update task status:",Qe),V.error("Failed to update task status"),h(tt=>tt.map(Me=>Me.id===re?{...Me,status:De.status}:Me))}}},me=()=>{Z(null)};f.useEffect(()=>{const z=le.state?.openTaskModal,K=le.state?.initialTaskData,ue=le.state?.taskID;z?(i(!0),K&&J(re=>({...re,...K})),Q(le.pathname,{replace:!0,state:{}})):ue&&(ye(ue),Q(le.pathname,{replace:!0,state:{}}))},[le,Q]),f.useEffect(()=>{if(se&&d.length>0&&!p){const z=d.find(K=>K.id===se);z?xe(z,!0):V.error("Task not found."),ye(null)}},[se,d,p]);const Ae=async()=>{try{const z=await ne.get("/users/all");T(Array.isArray(z.data)?z.data:[])}catch(z){console.error("Failed to fetch users:",z),V.error("Failed to fetch users.")}},pe=async()=>{try{x(!0);const z=await ne.get("/tasks/all"),ue=(Array.isArray(z.data)?z.data:[]).map(g8e);ue.sort((re,Le)=>{const De=re.createdAt?new Date(re.createdAt):0;return(Le.createdAt?new Date(Le.createdAt):0)-De}),h(ue),n==="list"&&A(1)}catch(z){console.error("Failed to load tasks:",z),V.error("Failed to load tasks.")}finally{x(!1)}};f.useEffect(()=>{!t&&e&&(Ae(),pe())},[t,e]);const Ie=()=>{l(null),J({id:"",subject:"",description:"",priority:"Normal",status:"Not started",dueDate:"",assignedTo:"",notes:"",relatedType1:"Lead",relatedType2:"Contact",relatedTo1:"",relatedTo2:""})},xe=(z=null,K=!1)=>{l(z),u(K),z?J({id:z.id,subject:z.title||"",description:z.description||"",priority:z.priority||"Normal",status:z.status||"Not started",dueDate:f8e(z.dueDate),assignedTo:z.assignedToId?String(z.assignedToId):"",assignedToName:z.assignedToName||"",createdBy:z.createdBy||"",createdById:z.createdById||null,notes:z.notes||"",relatedType1Text:z.relatedType1Text||"",relatedTo1Text:z.relatedTo1Text||"",relatedType2Text:z.relatedType2Text||"",relatedTo2Text:z.relatedTo2Text||"",relatedType1:z.relatedType1||"",relatedTo1:z.relatedTo1||"",relatedType2:z.relatedType2||"",relatedTo2:z.relatedTo2||""}):Ie(),i(!0)},he=()=>{i(!1),l(null),u(!1),Ie()},Re=async z=>{const K=h8e(z);try{o&&!c?(await ne.put(`/tasks/${o.id}`,K),V.success("Task updated successfully.")):(await ne.post("/tasks/create",K),V.success("Task created successfully.")),i(!1),await pe()}catch(ue){console.error("Failed to save task:",ue);const re=ue.response?.data?.detail||"Failed to save task.";V.error(re)}},Ee=z=>{if(!z)return;const K=/manager/i.test(e?.role);D({title:K?"Archive Task":"Delete Task",message:a.jsxs(a.Fragment,{children:["Are you sure you want to ",K?"archive":"delete"," ",a.jsx("span",{className:"font-semibold",children:z.title}),"?",K?a.jsx("span",{children:" This action will mark the task as inactive."}):a.jsx("span",{children:" This action cannot be undone."})]}),confirmLabel:K?"Archive Task":"Delete Task",cancelLabel:"Cancel",variant:K?"warning":"danger",action:{type:"delete",targetId:z.id}})},He=()=>{if(Fe.every(z=>G.includes(z.id)))$(G.filter(z=>!Fe.map(K=>K.id).includes(z)));else{const z=Fe.map(K=>K.id);$([...new Set([...G,...z])])}},Ke=z=>{Je(at.find(K=>K.id===z))&&$(K=>K.includes(z)?K.filter(ue=>ue!==z):[...K,z])},st=async()=>{if(G.length===0)return;const z=/manager/i.test(e?.role);D({title:z?"Archive Tasks":"Delete Tasks",message:a.jsxs("span",{children:["Are you sure you want to ",z?"archive":"delete"," ",a.jsx("span",{className:"font-semibold",children:G.length})," selected tasks? ",z?"This action will mark the tasks as inactive.":"This action cannot be undone."]}),confirmLabel:z?`Archive ${G.length} Task(s)`:`Delete ${G.length} Task(s)`,cancelLabel:"Cancel",variant:z?"warning":"danger",action:{type:"bulk-delete",task_ids:G}})},it=async()=>{if(!F?.action){D(null);return}const{action:z}=F;B(!0);const K=/manager/i.test(e?.role);try{z.type==="delete"?(await ne.delete(`/tasks/${z.targetId}`),V.success(K?"Task archived successfully.":"Task deleted successfully."),await pe()):z.type==="bulk-delete"&&(K?(await ne.post("/tasks/bulk-archive",{task_ids:z.task_ids}),V.success(`Successfully archived ${z.task_ids.length} tasks`)):(await ne.delete("/tasks/admin/bulk-delete",{data:{task_ids:z.task_ids}}),V.success(`Successfully deleted ${z.task_ids.length} tasks`)),$([]),await pe())}catch(ue){console.error("Task action failed:",ue),V.error(K?"Failed to archive task.":"Failed to delete task.")}finally{B(!1),D(null)}},ot=()=>{P||D(null)},rt=f.useMemo(()=>{const z=b.trim().toLowerCase();return[...d].sort((ue,re)=>{const Le=ue.createdAt?new Date(ue.createdAt):0;return(re.createdAt?new Date(re.createdAt):0)-Le}).filter(ue=>{const re=z===""||ue.title?.toLowerCase().includes(z)||ue.description?.toLowerCase().includes(z)||ue.assignedToName?.toLowerCase().includes(z)||ue.createdBy?.toLowerCase().includes(z),Le=y==="Filter by Status"||ue.status===y,De=w==="Filter by Priority"||ue.priority===w;return re&&Le&&De})},[d,b,y,w]);f.useEffect(()=>{A(1)},[b,y,w,n,E]),f.useEffect(()=>{if(n==="list"){const z=rt.length===0?1:Math.ceil(rt.length/E);k>z&&A(z)}},[rt.length,k,n,E]);const at=f.useMemo(()=>{if(n==="board")return rt;const z=(k-1)*E;return rt.slice(z,z+E)},[rt,k,n,E]),Je=z=>/manager/i.test(e?.role)?String(z?.createdById)===String(e?.id):!0,Fe=f.useMemo(()=>at.filter(Je),[at,e?.role,e?.id]),Ue=f.useMemo(()=>{const z=new Date;return[{title:"To Do",value:d.filter(K=>K.status==="Not started").length,icon:Vn,color:"text-blue-600",bgColor:"bg-blue-100"},{title:"In Progress",value:d.filter(K=>K.status==="In progress").length,icon:Yi,color:"text-purple-600",bgColor:"bg-purple-100"},{title:"Completed",value:d.filter(K=>K.status==="Completed").length,icon:La,color:"text-green-600",bgColor:"bg-green-100"},{title:"Overdue",value:d.filter(K=>K.dueDate&&new Date(K.dueDate)<z&&K.status!=="Completed").length,icon:Fl,color:"text-red-600",bgColor:"bg-red-100"},{title:"High Priority",value:d.filter(K=>K.priority==="High").length,icon:ec,color:"text-orange-600",bgColor:"bg-orange-100"}]},[d]),Ne=z=>z.dueDate&&new Date(z.dueDate)<new Date&&z.status!=="Completed",ze=z=>{switch(z.status){case"Not started":return"bg-blue-50 hover:bg-blue-100 border-blue-200";case"In progress":return"bg-purple-50 hover:bg-purple-100 border-purple-200";case"Deferred":return"bg-orange-50 hover:bg-orange-100 border-orange-200";case"Completed":return"bg-green-50 hover:bg-green-100 border-green-200";default:return"bg-gray-50 hover:bg-gray-100 border-gray-100"}},je=z=>{switch(z){case"Not started":return"bg-blue-100 text-blue-700";case"In progress":return"bg-purple-100 text-purple-700";case"Deferred":return"bg-orange-100 text-orange-700";case"Completed":return"bg-green-100 text-green-700";default:return"bg-gray-100 text-gray-700"}},ve=z=>{switch(z){case"High":return"bg-red-100 text-red-700";case"Normal":return"bg-yellow-100 text-yellow-700";default:return"bg-gray-100 text-gray-700"}};return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 min-h-screen font-inter relative",children:[(p||t)&&a.jsx(qt,{message:"Loading tasks..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 space-y-2 sm:space-y-0",children:[a.jsxs("h1",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[a.jsx(Yi,{className:"text-blue-600"})," Tasks Board"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{type:"button",onClick:()=>xe(),className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 rounded-md hover:bg-gray-800 text-sm sm:text-base self-end sm:self-auto mt-2 lg:mt-0 cursor-pointer",children:[a.jsx(aa,{})," Create Task"]})})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 xl:grid-cols-5 gap-4 mb-6 w-full break-words overflow-hidden lg:overflow-visible",children:Ue.map(z=>a.jsx(x8e,{...z},z.title))}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mt-6 mb-4 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search tasks",value:b,onChange:z=>j(z.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row w-full lg:w-1/2 gap-2",children:[a.jsxs("select",{value:y,onChange:z=>N(z.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{children:"Filter by Status"}),R8.map(z=>a.jsx("option",{children:z},z))]}),a.jsxs("select",{value:w,onChange:z=>S(z.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{children:"Filter by Priority"}),a.jsx("option",{children:"High"}),a.jsx("option",{children:"Normal"}),a.jsx("option",{children:"Low"})]})]})]}),a.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[a.jsx("button",{type:"button",onClick:()=>s("board"),className:`px-4 py-2 rounded-full text-sm ${n==="board"?"bg-gray-800 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Board View"}),a.jsx("button",{type:"button",onClick:()=>s("list"),className:`px-4 py-2 rounded-full text-sm ${n==="list"?"bg-gray-800 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"List View"})]}),!p&&!t&&n==="board"&&(rt.length>0?a.jsxs(Vx,{sensors:Ce,collisionDetection:Gx,onDragStart:ge,onDragEnd:be,onDragCancel:me,children:[a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4 rounded-md",children:R8.map(z=>{const K=at.filter(ue=>ue.status===z);return a.jsx(b8e,{column:z,columnTasks:K,getTaskCardColor:ze,isTaskOverdue:Ne,formatDateDisplay:gT,handleOpenModal:xe,handleDeleteTask:Ee,currentUser:e,isTaskDeletable:Je},z)})}),a.jsx(MN,{children:W?a.jsx(w8e,{task:W,getTaskCardColor:ze,isTaskOverdue:Ne,formatDateDisplay:gT}):null})]}):a.jsx("div",{className:"col-span-4 text-center py-10 text-gray-500 border border-dashed rounded-xl",children:"No tasks found."})),!p&&!t&&n==="list"&&a.jsx("div",{className:"bg-white rounded-md shadow-sm overflow-hidden",children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-gray-600 text-left",children:a.jsxs("tr",{children:[/manager/i.test(e?.role)?a.jsx("th",{className:"py-3 px-4 w-10",children:a.jsx("input",{type:"checkbox",className:"w-4 h-4 accent-blue-600",checked:Fe.length>0&&Fe.every(z=>G.includes(z.id)),onChange:He})}):a.jsx("th",{className:"py-3 px-4 w-10"}),a.jsx("th",{className:"py-3 px-4 font-medium",children:"Task"}),a.jsx("th",{className:"py-3 px-4 font-medium",children:"Status"}),a.jsx("th",{className:"py-3 px-4 font-medium",children:"Priority"}),a.jsx("th",{className:"py-3 px-4 font-medium",children:"Assigned To"}),a.jsx("th",{className:"py-3 px-4 font-medium",children:a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("span",{children:"Date Assigned"}),a.jsx("div",{className:"w-8 h-8 flex items-center justify-center",children:G.length>0&&/manager/i.test(e?.role)&&a.jsx("button",{onClick:st,className:"text-orange-600 hover:text-orange-800 transition p-1 rounded-full hover:bg-orange-50",title:`Archive ${G.length} selected tasks`,children:a.jsx(Zt,{size:18})})})]})})]})}),a.jsx("tbody",{children:at.length>0?at.map(z=>a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors text-sm cursor-pointer",children:[a.jsx("td",{className:"py-3 px-4",onClick:K=>K.stopPropagation(),children:Je(z)&&a.jsx("input",{type:"checkbox",className:"w-4 h-4 accent-blue-600",checked:G.includes(z.id),onChange:()=>Ke(z.id)})}),a.jsx("td",{className:"py-3 px-4 text-gray-700 whitespace-nowrap font-medium",onClick:()=>xe(z,!0),children:z.title}),a.jsx("td",{className:"py-3 px-4 whitespace-nowrap",onClick:()=>xe(z,!0),children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium whitespace-nowrap ${je(z.status||"Not started")}`,children:z.status||"Not started"})}),a.jsx("td",{className:"py-3 px-4 whitespace-nowrap",onClick:()=>xe(z,!0),children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium whitespace-nowrap ${ve(z.priority||"Low")}`,children:z.priority||"Low"})}),a.jsx("td",{className:"py-3 px-4 text-gray-700 whitespace-nowrap",onClick:()=>xe(z,!0),children:z.assignedToName||"Unassigned"}),a.jsx("td",{className:`py-3 px-4 text-gray-700 whitespace-nowrap ${Ne(z)?"text-red-600 font-medium":""}`,onClick:()=>xe(z,!0),children:z.dueDate?gT(z.dueDate):""})]},z.id)):a.jsx("tr",{children:a.jsx("td",{colSpan:6,className:"text-center py-4 text-gray-500",children:"No tasks found."})})})]})})}),!p&&!t&&n==="list"&&a.jsx(ca,{className:"mt-6",totalItems:rt.length,pageSize:E,currentPage:rt.length===0?0:k,onPrev:()=>A(z=>Math.max(z-1,1)),onNext:()=>A(z=>Math.min(z+1,Math.max(1,Math.ceil(rt.length/E)||1))),onPageSizeChange:z=>{M(z),A(1)},pageSizeOptions:[10,20,30,40,50],label:"tasks"}),a.jsx(N0,{isOpen:r,onClose:he,onSave:Re,onEdit:()=>u(!1),setFormData:J,formData:we,isEditing:!c&&!!o,viewMode:c,users:_,currentUser:e,onDelete:Ee}),F&&a.jsx(y8e,{open:!0,title:F.title,message:F.message,confirmLabel:F.confirmLabel,cancelLabel:F.cancelLabel,variant:F.variant,onConfirm:it,onCancel:ot,loading:P})]})}function x8e({icon:e,title:t,value:n,color:s,bgColor:r,onClick:i}){return a.jsxs("div",{className:"flex items-center p-4 bg-white rounded-xl shadow-md border border-gray-200 transition-all duration-300 cursor-default",onClick:i,children:[a.jsx("div",{className:`flex-shrink-0 p-3 rounded-full ${r} ${s} mr-4`,children:e?a.jsx(e,{size:22}):null}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:t}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:n})]})]})}function y8e({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r,variant:i,loading:o,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":i==="warning"?"bg-orange-500 hover:bg-orange-600 border border-orange-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsx("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${u}`,disabled:o,children:o?"Processing...":s})]})]})})}function b8e({column:e,columnTasks:t,getTaskCardColor:n,isTaskOverdue:s,formatDateDisplay:r,handleOpenModal:i,handleDeleteTask:o,currentUser:l,isTaskDeletable:c}){const{isOver:u,setNodeRef:d}=Qx({id:e});return a.jsxs("div",{ref:d,className:`bg-white p-4 shadow border flex flex-col relative rounded-md transition-all duration-200 min-h-[200px] ${u?"border-blue-400 bg-blue-50 ring-2 ring-blue-300":"border-gray-200"}`,children:[a.jsx("div",{className:"absolute top-0 left-0 w-full h-5 bg-secondary rounded-t-md"}),a.jsxs("div",{className:"flex items-center justify-between mb-3 pt-7",children:[a.jsx("h3",{className:"font-medium text-gray-900",children:e}),a.jsx("span",{className:"text-xs bg-gray-100 px-2 py-1 rounded-full text-gray-500",children:t.length})]}),a.jsx("div",{className:`space-y-3 flex-1 ${t.length>3?"overflow-y-auto max-h-[480px] hide-scrollbar":""}`,children:t.length>0?t.map(h=>a.jsx(v8e,{task:h,getTaskCardColor:n,isTaskOverdue:s,formatDateDisplay:r,handleOpenModal:i,handleDeleteTask:o,currentUser:l,isTaskDeletable:c},h.id)):a.jsx("div",{className:`text-center py-10 text-gray-500 border-2 border-dashed rounded-lg ${u?"border-blue-300 bg-blue-50":"border-gray-200"}`,children:u?"Drop here":"No tasks"})})]})}function v8e({task:e,getTaskCardColor:t,isTaskOverdue:n,formatDateDisplay:s,handleOpenModal:r,handleDeleteTask:i,currentUser:o,isTaskDeletable:l}){const{attributes:c,listeners:u,setNodeRef:d,transform:h,isDragging:p}=Yx({id:e.id}),x=!(/manager/i.test(o?.role)&&String(e?.createdById)!==String(o?.id)),b=h?{transform:`translate3d(${h.x}px, ${h.y}px, 0)`}:void 0;return a.jsxs("div",{ref:d,style:b,className:`border rounded-lg p-3 transition flex justify-between items-start cursor-grab active:cursor-grabbing ${t(e)} ${p?"opacity-50 shadow-lg ring-2 ring-blue-400":""}`,...u,...c,children:[a.jsxs("div",{className:"text-left flex-1",onClick:j=>{j.stopPropagation(),r(e,!0)},children:[a.jsx("p",{className:"font-medium text-gray-800 text-sm",children:e.title}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Priority: ",e.priority]}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Assigned To: ",e.assignedToName]}),a.jsxs("p",{className:"text-xs mt-1 text-gray-500",children:["Date: ",a.jsx("span",{className:n(e)?"text-red-600":"text-gray-600",children:e.dueDate?s(e.dueDate):""})]})]}),x&&a.jsxs("div",{className:"flex items-center gap-2 ml-3",onClick:j=>j.stopPropagation(),children:[a.jsx("button",{type:"button",onClick:j=>{j.stopPropagation(),r(e)},className:"text-blue-500 hover:text-blue-700",children:a.jsx(hn,{})}),a.jsx("button",{type:"button",onClick:j=>{j.stopPropagation(),i(e)},className:`${/manager/i.test(o?.role)?"text-orange-500 hover:text-orange-700":"text-red-500 hover:text-red-700"}`,children:/manager/i.test(o?.role)?a.jsx(Zt,{}):a.jsx(_a,{})})]})]})}function w8e({task:e,getTaskCardColor:t,isTaskOverdue:n,formatDateDisplay:s}){return a.jsx("div",{className:`border rounded-lg p-3 shadow-xl ring-2 ring-blue-400 ${t(e)}`,style:{width:"280px"},children:a.jsxs("div",{className:"text-left flex-1",children:[a.jsx("p",{className:"font-medium text-gray-800 text-sm",children:e.title}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Priority: ",e.priority]}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Assigned To: ",e.assignedToName]}),a.jsxs("p",{className:"text-xs mt-1 text-gray-500",children:["Date: ",a.jsx("span",{className:n(e)?"text-red-600":"text-gray-600",children:e.dueDate?s(e.dueDate):""})]})]})})}const PJ=e=>e?e.toUpperCase():"",Zd=e=>{const t=PJ(e);return t==="PLANNED"||t==="IN PROGRESS"?"PLANNED":t==="HELD"||t==="DONE"?"HELD":t==="NOT_HELD"||t==="NOT HELD"?"NOT_HELD":"PLANNED"},j8e=e=>{if(!e)return"";const t=String(e).split("-");return t.length===3?`${t[0]}-${t[2]}`:String(e)},N8e=e=>{if(!e)return"--";try{return new Date(e).toLocaleString()}catch{return"--"}},C8e=e=>{const t=PJ(e);switch(t==="PLANNED"?"PENDING":t==="HELD"?"COMPLETED":t==="NOT_HELD"?"CANCELLED":t){case"PENDING":return"bg-indigo-100 text-indigo-700";case"COMPLETED":case"DONE":return"bg-green-100 text-green-700";case"CANCELLED":return"bg-gray-200 text-gray-700";case"IN PROGRESS":return"bg-blue-100 text-blue-700";default:return"bg-gray-100 text-gray-700"}},pT={subject:"",startTime:"",endTime:"",location:"",status:"PLANNED",notes:"",assignedTo:"",relatedType1:"Lead",relatedTo1:"",relatedType2:null,relatedTo2:""},S8e=()=>{const e=Et(),t=ta(),[n]=Bs(),s=n.get("id"),r=t.pathname==="/admin/meetings/info";f.useEffect(()=>{document.title="Meetings | Sari-Sari CRM"},[]);const[i,o]=f.useState([]),[l,c]=f.useState(!1),[u,d]=f.useState([]),[h,p]=f.useState(""),[x,b]=f.useState("Filter by Status"),[j,y]=f.useState(!1),[N,w]=f.useState(null),[S,_]=f.useState(1),[T,k]=f.useState(10),[A,E]=f.useState(pT),[M,F]=f.useState(!1),[D,P]=f.useState(null),[B,G]=f.useState(!1),[$,W]=f.useState(null),[Z,Q]=f.useState(!1),[le,we]=f.useState(null),[J,se]=f.useState(new Set),[ye,Ce]=f.useState(!1),{user:ge}=Gt();f.useEffect(()=>{const z=t.state?.openMeetingModal,K=t.state?.initialMeetingData?.relatedTo||n.get("id"),ue=t.state?.meetingID;z||K?(y(!0),t.state?.initialMeetingData&&E(re=>({...re,...t.state.initialMeetingData})),e(t.pathname,{replace:!0,state:{}})):ue&&(we(ue),e(t.pathname,{replace:!0,state:{}}))},[t,n,e]),f.useEffect(()=>{console.log("ManagerMeetings - Current User:",ge),console.log("Current User Role:",ge?.role),console.log("Is non-admin:",["GROUP MANAGER","MANAGER","SALES"].includes(ge?.role?.toUpperCase()))},[ge]),f.useEffect(()=>{if(le&&i.length>0&&!l){const z=i.find(K=>K.id===le);z?w(z):V.error("Meeting not found."),we(null)}},[le,i,l]);const be=async()=>{if(s&&r){const z=sessionStorage.getItem("meetingDetailData");if(z)try{const K=JSON.parse(z);if(K.id===parseInt(s)){w(K),sessionStorage.removeItem("meetingDetailData");return}}catch(K){console.error(K)}}c(!0);try{console.log("=== FETCH MEETINGS START ===");const z=await ne.get("/meetings/admin/fetch-all"),K=Array.isArray(z.data)?z.data:[];console.log("Total meetings fetched:",K.length),console.log("Meeting statuses:",K.map(re=>({id:re.id,subject:re.subject,status:re.status})));const ue=[...K].sort((re,Le)=>{const De=re?.created_at?new Date(re.created_at).getTime():0;return(Le?.created_at?new Date(Le.created_at).getTime():0)-De});if(o(ue),console.log("Meetings set after sort"),console.log("=== FETCH MEETINGS COMPLETE ==="),s&&!N){const re=ue.find(Le=>Le.id===parseInt(s));re&&w(re)}}catch(z){console.error("fetchMeetings error:",z),V.error("Failed to load meetings.")}finally{c(!1)}},me=async()=>{try{const z=await ne.get("/users/all");d(Array.isArray(z.data)?z.data:[])}catch(z){console.error(z)}};f.useEffect(()=>{be(),me()},[]);const Ae=z=>p(z.target.value),Ie=["GROUP MANAGER","MANAGER","SALES"].includes(ge?.role?.toUpperCase()),xe=Ie?i.filter(z=>{const K=z.status?.toUpperCase()==="INACTIVE";return K&&console.log(`Filtering out INACTIVE meeting: ${z.subject} (status: ${z.status})`),!K}):i;console.log("=== FILTER SUMMARY ==="),console.log("User role:",ge?.role),console.log("Is non-admin:",Ie),console.log("Total meetings:",i.length),console.log("Visible meetings after filter:",xe.length),console.log("=== END FILTER SUMMARY ===");const he=f.useMemo(()=>{const z=h.trim().toLowerCase(),K=x.trim().toUpperCase();return xe.filter(ue=>{const re=[ue?.subject,ue?.location,ue?.notes,ue?.lead?.title,ue?.account?.name,ue?.contact?.first_name,ue?.contact?.last_name,ue?.deal?.name,ue?.quote?.quote_id,ue?.meet_assign_to?.first_name,ue?.meet_assign_to?.last_name].filter(Boolean).join(" ").toLowerCase(),Le=z===""||re.includes(z),De=K==="FILTER BY STATUS"||Zd(ue.status||"PENDING")===K;return Le&&De})},[xe,h,x]),Re=xe.length,Ee=xe.filter(z=>Zd(z.status)==="PLANNED").length,He=xe.filter(z=>Zd(z.status)==="HELD").length,Ke=xe.filter(z=>Zd(z.status)==="NOT_HELD").length,st=[{title:"Total",value:Re,icon:Pt,color:"text-slate-600",bgColor:"bg-slate-100"},{title:"Planned",value:Ee,icon:Vn,color:"text-indigo-600",bgColor:"bg-indigo-100"},{title:"Held",value:He,icon:La,color:"text-green-600",bgColor:"bg-green-100"},{title:"Not Held",value:Ke,icon:Yn,color:"text-gray-600",bgColor:"bg-gray-100"}],it=f.useMemo(()=>{const z=(S-1)*T;return he.slice(z,z+T)},[he,S]),ot=()=>{y(!1),E(pT),F(!1),P(null),G(!1)},rt=()=>{E(pT),F(!1),P(null),y(!0)},at=z=>{let K="";if(z.meet_assign_to?.id)K=String(z.meet_assign_to.id);else if(z.assignedTo){const yt=u.find(_t=>`${_t.first_name} ${_t.last_name}`===z.assignedTo);K=yt?String(yt.id):""}const ue=yt=>{if(!yt)return"";try{const _t=new Date(yt),Ct=_t.getTimezoneOffset()*6e4;return new Date(_t.getTime()-Ct).toISOString().slice(0,16)}catch{return""}};let re="Lead",Le="",De="Contact",Qe="";if(z.lead)re="Lead",Le=String(z.lead.id);else if(z.account)re="Account",Le=String(z.account.id),z.contact?(De="Contact",Qe=String(z.contact.id)):z.deal?(De="Deal",Qe=String(z.deal.id)):z.quote&&(De="Quote",Qe=String(z.quote.id));else if(z.relatedType||z.related_type){const yt=z.relatedType||z.related_type,_t=z.related_to||z.relatedToId;yt==="Lead"?(re="Lead",Le=String(_t)):(re="Account",Le=z.account_id?String(z.account_id):"")}const tt={PLANNED:"Planned",HELD:"Held",NOT_HELD:"Not held"},Me=Zd(z.status),et=tt[Me]||"Planned";E({subject:z.subject||z.activity||"",location:z.location||"",startTime:ue(z.start_time||z.startTime),endTime:ue(z.end_time||z.endTime),status:et,notes:z.description||z.notes||"",assignedTo:K,relatedType1:re,relatedTo1:Le,relatedType2:De,relatedTo2:Qe}),F(!0),P(z.id),w(null),y(!0)},Je=z=>{if(!z.subject?.trim())return V.error("Subject is required.");if(!z.startTime)return V.error("Start time is required.");if(z.endTime&&!(new Date(z.endTime)-new Date(z.startTime)>0))return V.error("End time must be after start time.");z.relatedType1,z.relatedTo1,z.relatedType1==="Account"&&z.relatedType2&&z.relatedTo2&&(z.relatedType2,z.relatedTo2);const K={...z,assignedTo:parseInt(z.assignedTo),relatedTo1:parseInt(z.relatedTo1),relatedTo2:parseInt(z.relatedTo2)},ue=M&&D?"update":"create";W({title:ue==="create"?"Confirm New Meeting":"Confirm Update",message:`Are you sure you want to ${ue} "${K.subject}"?`,confirmLabel:ue==="create"?"Create Meeting":"Update Meeting",variant:"primary",action:{type:ue,payload:K,targetId:D,name:K.subject}})},Fe=async()=>{if(!$?.action)return;const{type:z,payload:K,targetId:ue,name:re,targetIds:Le,count:De}=$.action;Q(!0);try{if(z==="create")G(!0),await ne.post("/meetings/create",K),V.success(`Meeting "${re}" created.`),ot(),await be();else if(z==="update")G(!0),await ne.put(`/meetings/${ue}`,K),V.success(`Meeting "${re}" updated.`),ot(),await be();else if(z==="delete"){console.log("=== ARCHIVE FLOW START ==="),console.log("Archiving meeting:",ue),console.log("Meeting name:",re);try{const Qe=await ne.delete(`/meetings/${ue}`);console.log("Archive API response:",Qe),console.log("Response data:",Qe.data),V.success(`Meeting "${re}" archived successfully.`),N?.id===ue&&w(null),console.log("Calling fetchMeetings to refresh list..."),await be(),console.log("=== ARCHIVE FLOW COMPLETE ===")}catch(Qe){throw console.error("Archive failed:",Qe),Qe}}else if(z==="bulk-delete"){if(!Le||Le.length===0)throw new Error("Missing meeting identifiers for bulk archiving.");console.log("Bulk archiving meetings:",Le),Ce(!0),await ne.put("/meetings/bulk-archive",{meeting_ids:Le}),V.success(`${De} meeting${De!==1?"s":""} archived successfully.`),se(new Set),await be(),N&&J.has(N.id)&&w(null)}}catch(Qe){console.error("Error in handleConfirmAction:",Qe),console.error("Error response:",Qe?.response),console.error("Error details:",Qe?.response?.data);const tt=z==="create"?"Failed to create meeting. Please review the details and try again.":z==="update"?"Failed to update meeting. Please review the details and try again.":z==="bulk-delete"?"Failed to archive meetings. Please try again.":"Failed to delete meeting. Please try again.",Me=Qe?.response?.data?.detail||tt;V.error(Me)}finally{(z==="create"||z==="update")&&G(!1),z==="bulk-delete"&&Ce(!1),Q(!1),W(null)}},Ue=z=>{console.log("Delete button clicked for meeting:",z),console.log("Meeting created_by:",z.created_by),console.log("Current user ID:",ge?.id),console.log("Can delete?:",z.created_by===ge?.id),W({title:"Archive Meeting",message:`Are you sure you want to archive "${z.subject||z.activity}"? You can restore it later if needed.`,confirmLabel:"Archive",variant:"archive",action:{type:"delete",targetId:z.id,name:z.subject||z.activity}})},Ne=async(z,K)=>{try{await ne.put(`/meetings/${z}`,{status:K}),V.success("Status updated"),be(),w(null)}catch{V.error("Failed to update status")}},ze=z=>{const K=it.find(ue=>ue.id===z);K&&K.created_by===ge?.id&&se(ue=>{const re=new Set(ue);return re.has(z)?re.delete(z):re.add(z),re})},je=()=>{const z=it.filter(K=>K.created_by===ge?.id);J.size===z.length?se(new Set):se(new Set(z.map(K=>K.id)))},ve=()=>{if(J.size===0)return;const z=J.size;W({title:"Archive Meetings",message:a.jsxs("span",{children:["Are you sure you want to archive"," ",a.jsx("span",{className:"font-semibold",children:z})," meeting",z!==1?"s":"","? You can restore them later if needed."]}),confirmLabel:`Archive ${z} Meeting${z!==1?"s":""}`,cancelLabel:"Cancel",variant:"archive",action:{type:"bulk-delete",targetIds:Array.from(J),count:z}})};return r&&s?N?a.jsx(jd,{meeting:N,onClose:()=>{w(null),e("/admin/dashboard")},onEdit:at,onDelete:Ue,onStatusUpdate:Ne,currentUser:ge,isSalesView:!0}):a.jsx(qt,{message:"Loading meeting..."}):a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[l&&a.jsx(qt,{message:"Loading meetings..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h1",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800 mb-4 lg:mb-0",children:[a.jsx(Pt,{className:"mr-2 text-blue-600"})," Meetings"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{onClick:rt,className:"bg-black text-white px-4 py-2 rounded-md flex items-center hover:bg-gray-800",children:[a.jsx(aa,{className:"mr-2"})," Add Meeting"]})})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-4 mb-6 w-full break-words overflow-hidden lg:overflow-visible",children:st.map(z=>a.jsx(A8e,{...z},z.title))}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full sm:w-auto lg:w-4/4 md:w-3/4",children:[a.jsx(Kt,{className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search meetings",value:h,onChange:Ae,className:"w-full outline-none"})]}),a.jsxs("select",{value:x,onChange:z=>b(z.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm bg-white w-full sm:w-auto",children:[a.jsx("option",{children:"Filter by Status"}),a.jsx("option",{value:"PLANNED",children:"PLANNED"}),a.jsx("option",{value:"HELD",children:"HELD"}),a.jsx("option",{value:"NOT_HELD",children:"NOT HELD"})]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[500px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm mb-4",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 w-12",children:a.jsx("input",{type:"checkbox",checked:J.size===it.filter(z=>z.created_by===ge?.id).length&&it.filter(z=>z.created_by===ge?.id).length>0,onChange:je,className:"w-4 h-4 cursor-pointer rounded border-gray-300"})}),a.jsx("th",{className:"py-3 px-4",children:"Subject"}),a.jsx("th",{className:"py-3 px-4",children:"Related To"}),a.jsx("th",{className:"py-3 px-4",children:"Start Time"}),a.jsx("th",{className:"py-3 px-4",children:"Assigned"}),a.jsx("th",{className:"py-3 px-4",children:"Status"}),a.jsx("th",{className:"py-3 px-4 w-12",children:J.size>0&&a.jsx("button",{onClick:ve,className:"text-orange-500 hover:text-orange-700 transition",title:"Archive selected meetings",disabled:ye,children:a.jsx(Zt,{size:18})})})]})}),a.jsx("tbody",{children:it.length>0?it.map(z=>a.jsxs("tr",{onClick:()=>w(z),className:"hover:bg-gray-50 cursor-pointer border-b border-gray-100",children:[a.jsx("td",{className:"py-3 px-4",onClick:K=>K.stopPropagation(),children:ge?.id===z.created_by&&a.jsx("input",{type:"checkbox",checked:J.has(z.id),onChange:K=>{K.stopPropagation(),ze(z.id)},className:"w-4 h-4 cursor-pointer rounded border-gray-300"})}),a.jsx("td",{className:"py-3 px-4 font-medium text-blue-600",children:z.subject}),a.jsxs("td",{className:"py-3 px-4",children:[z.lead&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:z.lead.title}),z.account&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:z.account.name}),z.contact&&a.jsxs("p",{className:"font-medium text-blue-500 text-xs",children:[z.contact.first_name," ",z.contact.last_name]}),z.deal&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:z.deal.name}),z.quote&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:j8e(z.quote.quote_id)})]}),a.jsx("td",{className:"py-3 px-4",children:N8e(z.start_time)}),a.jsxs("td",{className:"py-3 px-4",children:[z.meet_assign_to.first_name," ",z.meet_assign_to.last_name]}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${C8e(Zd(z.status))}`,children:Zd(z.status).replace("_"," ")})})]},z.id)):a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"text-center py-4 text-gray-500",children:"No meetings found."})})})]})}),a.jsx(ca,{totalItems:he.length,pageSize:T,currentPage:S,onPrev:()=>_(z=>Math.max(1,z-1)),onNext:()=>_(z=>z+1),onPageSizeChange:z=>{k(z),_(1)},pageSizeOptions:[10,20,30,40,50],label:"meetings"}),j&&a.jsx(O1,{onClose:ot,formData:A,setFormData:E,isEditing:M,onSubmit:Je,isSubmitting:B||Z,users:u}),N&&a.jsx(jd,{meeting:N,onClose:()=>w(null),onEdit:at,onDelete:Ue,onStatusUpdate:Ne,currentUser:ge,isSalesView:!0}),$&&a.jsx(_8e,{open:!0,title:$.title,message:$.message,confirmLabel:$.confirmLabel,variant:$.variant,onConfirm:Fe,onCancel:()=>W(null),loading:Z})]})};function _8e({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":i==="archive"?"bg-orange-500 hover:bg-orange-600 border border-orange-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{onClick:c,disabled:o,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",children:"Cancel"}),a.jsx("button",{onClick:l,disabled:o,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70
                       ${u}`,children:o?"...":s})]})]})})}function A8e({icon:e,title:t,value:n,color:s,bgColor:r}){return a.jsxs("div",{className:"flex items-center p-4 bg-white rounded-xl shadow-md border border-gray-200",children:[a.jsx("div",{className:`p-3 rounded-full ${r} ${s} mr-4`,children:a.jsx(e,{size:22})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:t}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:n})]})]})}const I1=[{value:"CEO",label:"CEO"},{value:"Admin",label:"Admin"},{value:"Group Manager",label:"Group Manager"},{value:"Manager",label:"Manager"},{value:"Marketing",label:"Marketing"},{value:"Sales",label:"Sales"}],Rb={firstName:"",lastName:"",email:"",password:"",role:""},T8e={CEO:"bg-purple-100 text-purple-700",ADMIN:"bg-purple-100 text-purple-700",GROUP_MANAGER:"bg-indigo-100 text-indigo-700",MANAGER:"bg-blue-100 text-blue-700",MARKETING:"bg-yellow-100 text-yellow-700",SALES:"bg-green-100 text-green-700"},Eo=e=>e?e.toString().trim().replace(/([a-z0-9])([A-Z])/g,"$1_$2").replace(/\s+/g,"_").toUpperCase():"",k8e=e=>{const t=Eo(e),n=I1.find(s=>Eo(s.value)===t);return n?n.value:e||""},lL=e=>{const t=Eo(e),n=I1.find(s=>Eo(s.value)===t);return n?n.label:typeof e=="string"?e.toLowerCase().replace(/\b\w/g,s=>s.toUpperCase()):"--"},F8=e=>{if(!e)return"--";const t=new Date(e);return Number.isNaN(t.getTime())?"--":t.toLocaleString("en-US",{month:"2-digit",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).replace(",","")},xT=(e,{size:t="sm"}={})=>{const n=Eo(e),s=T8e[n]||"bg-gray-100 text-gray-700",r=t==="lg"?"px-3 py-1 text-sm":t==="md"?"px-2.5 py-1 text-sm":"px-2 py-1 text-xs";return a.jsx("span",{className:`${r} font-semibold rounded-md inline-flex items-center justify-center ${s}`,children:lL(e)})},E8e=(e,t)=>{const n=e?.trim()?.[0]??"",s=t?.trim()?.[0]??"";return`${n}${s}`.toUpperCase()||"U"},U8=e=>[...e].sort((t,n)=>{const s=t.created_at?new Date(t.created_at).getTime():0;return(n.created_at?new Date(n.created_at).getTime():0)-s});function L8e(){const{user:e,loading:t}=Gt(),[n,s]=f.useState([]),[r,i]=f.useState(!1),[o,l]=f.useState(""),[c,u]=f.useState(""),[d,h]=f.useState(null),[p,x]=f.useState(!1),[b,j]=f.useState(!1),[y,N]=f.useState(null),[w,S]=f.useState(Rb),[_,T]=f.useState(!1),[k,A]=f.useState(null),[E,M]=f.useState(!1),[F,D]=f.useState(1),[P,B]=f.useState(10),[G,$]=f.useState("Overview"),[W,Z]=f.useState(""),[Q,le]=f.useState(!1),we=Eo(e?.role),J=["ADMIN","CEO","GROUP MANAGER","MANAGER"].includes(we),se=!t&&J,ye=f.useMemo(()=>{const Ue=I1.filter(Ne=>Eo(Ne.value)!=="CEO");return[{label:"Filter by Roles",value:""},{label:"CEO",value:"CEO"},...Ue]},[]),Ce=f.useCallback(Ue=>{Ue&&(s(Ne=>Ne.map(ze=>ze.id===Ue?{...ze,highlight:!0}:ze)),setTimeout(()=>{s(Ne=>Ne.map(ze=>ze.id===Ue?{...ze,highlight:!1}:ze))},2e3))},[]),ge=f.useCallback(async()=>{i(!0);try{const Ue=await ne.get("/users/all"),Ne=Array.isArray(Ue.data)?Ue.data:[],ze=U8(Ne);s(ze),h(je=>je&&(ze.find(z=>z.id===je.id)||null)),console.log(Ue.data)}catch(Ue){console.error("Error fetching users:",Ue);const Ne=Ue.response?.data?.detail||"Failed to load users. Please try again later.";V.error(Ne)}finally{i(!1)}},[]);f.useEffect(()=>{!t&&!J&&e&&V.error("You are not authorized to access User Management.")},[J,t,e]),f.useEffect(()=>{t||!J||ge()},[t,J,ge]),f.useEffect(()=>{document.title="Users | Sari-Sari CRM"},[]);const be=f.useMemo(()=>{const Ue=o.trim().toLowerCase(),Ne=Eo(c);return U8(n.filter(ze=>{if(!ze)return!1;const je=Ue===""||[ze.first_name,ze.last_name,`${ze.first_name||""} ${ze.last_name||""}`,ze.email,lL(ze.role)].filter(Boolean).some(z=>z.toString().toLowerCase().includes(Ue)),ve=Ne===""||Ne==="CEO"&&["CEO","ADMIN"].includes(Eo(ze.role))||Eo(ze.role)===Ne;return je&&ve}))},[n,o,c]),me=Math.max(1,Math.ceil(be.length/P)||1);f.useEffect(()=>{D(1)},[o,c]),f.useEffect(()=>{D(Ue=>{const Ne=Math.max(1,Math.ceil(be.length/P)||1);return Ue>Ne?Ne:Ue})},[be.length]);const Ae=f.useMemo(()=>{const Ue=(F-1)*P;return be.slice(Ue,Ue+P)},[be,F]);be.length===0||(F-1)*P+1,Math.min(F*P,be.length);const pe=()=>D(Ue=>Math.max(Ue-1,1)),Ie=()=>D(Ue=>Math.min(Ue+1,me)),xe=Ue=>{console.log(Ue),h(Ue),$("Overview"),Z(Ue?.is_active?"Active":"Inactive")},he=Ue=>{Ue.target.id==="userModalBackdrop"&&!E&&Re()},Re=()=>{h(null)},Ee=(Ue,Ne)=>{S(ze=>({...ze,[Ue]:Ne}))},He=()=>{const Ue="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*";let Ne="";for(let ze=0;ze<10;ze+=1)Ne+=Ue.charAt(Math.floor(Math.random()*Ue.length));Ee("password",Ne)},Ke=()=>{_||E||(x(!1),S(Rb),N(null),j(!1))},st=Ue=>{S({firstName:Ue.first_name||"",lastName:Ue.last_name||"",email:Ue.email||"",password:"",role:k8e(Ue.role)}),j(!0),N(Ue.id),x(!0),h(null)},it=Ue=>{Ue.preventDefault();const Ne=w.firstName.trim(),ze=w.lastName.trim(),je=w.email.trim(),ve=w.password.trim(),z="Sales",K=!(b&&y);if(!Ne||!je||!z){V.warn("Please fill in all required fields.");return}if(K&&!ve){V.warn("Please fill in all required fields.");return}if(ve&&ve.length<8){V.warn("Password should be at least 8 characters long.");return}const ue={first_name:Ne,last_name:ze,email:je,role:z};console.log(ue),(K||ve)&&(ue.password=ve);const re=`${Ne} ${ze}`.trim(),Le=K?"create":"update";A({title:Le==="create"?"Confirm New User":"Confirm User Update",message:Le==="create"?a.jsxs("span",{children:["Create user ",a.jsx("span",{className:"font-semibold",children:re})," with role"," ",a.jsx("span",{className:"font-semibold",children:lL(z)}),"?"]}):a.jsxs("span",{children:["Save changes for"," ",a.jsx("span",{className:"font-semibold",children:re||je}),"?"]}),confirmLabel:Le==="create"?"Create User":"Update User",cancelLabel:"Cancel",variant:"primary",action:{type:Le,payload:ue,targetId:y,name:re||je}})},ot=async()=>{if(!k?.action){A(null);return}const{action:Ue}=k,{type:Ne,payload:ze,targetId:je,name:ve}=Ue;M(!0),(Ne==="create"||Ne==="update")&&T(!0);try{if(Ne==="create"){const K=(await ne.post("/users/createuser",ze)).data;await ge(),Ce(K.id),V.success(`User "${ve}" created successfully.`),x(!1),S(Rb),N(null),j(!1)}else if(Ne==="update"){if(!je)throw new Error("Missing user identifier for update.");const K=(await ne.put(`/users/updateuser/${je}`,ze)).data;await ge(),h(null),Ce(K.id),V.success(`User "${ve}" updated successfully.`),x(!1),S(Rb),N(null),j(!1)}else if(Ne==="delete"){if(!je)throw new Error("Missing user identifier for deletion.");await ne.delete(`/users/deleteuser/${je}`),s(z=>z.map(K=>K.id===je?{...K,is_active:!1}:K)),d&&d.id===je&&(h(null),Z("")),V.success(`User "${ve}" deactivated successfully.`)}}catch(z){console.error("User management error:",z);const K=Ne==="create"?"Failed to create user. Please review the details and try again.":Ne==="update"?"Failed to update user. Please review the details and try again.":"Failed to delete user. Please try again.",ue=z.response?.data?.detail||K;V.error(ue)}finally{(Ne==="create"||Ne==="update")&&T(!1),M(!1),A(null)}},rt=()=>{E||A(null)},at=async()=>{if(!d||!W)return;const Ue=d.is_active?"Active":"Inactive";if(W===Ue)return;const Ne=W==="Active";le(!0);try{const je=(await ne.put(`/users/updateuser/${d.id}`,{is_active:Ne})).data;s(ve=>ve.map(z=>z.id===je.id?je:z)),h(null),Z(""),V.success(`User status updated to ${W}`)}catch(ze){console.error("Failed to update user status:",ze);const je=ze.response?.data?.detail||"Failed to update user status. Please try again.";V.error(je)}finally{le(!1)}},Je=a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[(r||t||!se)&&a.jsx(qt,{}),a.jsx("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:a.jsxs("h1",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(jj,{className:"mr-2 text-blue-600"}),"User Management"]})}),a.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search users",value:o,onChange:Ue=>l(Ue.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsx("div",{className:"w-full lg:w-1/4",children:a.jsx("select",{value:c,onChange:Ue=>u(Ue.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:ye.map(Ue=>a.jsx("option",{value:Ue.value,children:Ue.label},Ue.value))})})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[600px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 text-sm tracking-wide font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4",children:"Fullname"}),a.jsx("th",{className:"py-3 px-4",children:"Email"}),a.jsx("th",{className:"py-3 px-4",children:"Role"}),a.jsx("th",{className:"py-3 px-4",children:"Status"})]})}),a.jsx("tbody",{children:r?a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:3,children:"Loading users..."})}):be.length===0?a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-400",colSpan:4,children:"No users found."})}):Ae.map(Ue=>a.jsxs("tr",{className:`hover:bg-gray-50 transition-colors ${Ue.highlight?"bg-green-50":""} ${Ue.is_active?"":"opacity-60 bg-gray-50"}`,children:[a.jsx("td",{className:"py-3 px-4 cursor-pointer",onClick:()=>xe(Ue),children:a.jsxs("div",{className:"font-medium text-blue-600 hover:underline text-sm",children:[Ue.first_name," ",Ue.last_name]})}),a.jsx("td",{className:"py-3 px-4 cursor-pointer text-sm",onClick:()=>xe(Ue),children:Ue.email}),a.jsx("td",{className:"py-3 px-4 cursor-pointer",onClick:()=>xe(Ue),children:xT(Ue.role)}),a.jsx("td",{className:"py-3 px-4 cursor-pointer",onClick:()=>xe(Ue),children:a.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-md ${Ue.is_active?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:Ue.is_active?"Active":"Inactive"})})]},Ue.id))})]})}),a.jsx(ca,{className:"mt-4",totalItems:be.length,pageSize:P,currentPage:F,onPrev:pe,onNext:Ie,onPageSizeChange:Ue=>{B(Ue),D(1)},pageSizeOptions:[10,20,30,40,50],label:"users"})]}),Fe=d?a.jsx("div",{id:"userModalBackdrop",onClick:he,className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-6xl max-h-[92vh] overflow-y-auto hide-scrollbar animate-scale-in p-4 sm:p-6 md:p-8 font-inter relative",children:[a.jsx("div",{className:"flex justify-end w-full",children:a.jsx("button",{onClick:Re,className:"text-gray-500 hover:text-gray-700 transition mb-5 cursor-pointer",children:a.jsx(Za,{size:30})})}),a.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between lg:flex-row lg:items-center lg:justify-between mt-3 gap-2 px-2 md:items-center lg:gap-4 md:mx-7 lg:mx-7 mb-4 lg:mb-6 md:mb-4",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[d.profile_picture?a.jsx("img",{src:d.profile_picture,alt:`${d.first_name} ${d.last_name}`,className:"w-12 h-12 sm:w-16 sm:h-16 rounded-full object-cover border border-gray-200 shadow-sm"}):a.jsx("div",{className:"w-12 h-12 sm:w-16 sm:h-16 rounded-full bg-gray-200 text-gray-700 flex items-center justify-center text-lg sm:text-xl font-semibold border border-gray-200 shadow-sm",children:E8e(d.first_name,d.last_name)}),a.jsxs("div",{children:[a.jsxs("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-800",children:[d.first_name," ",d.last_name]}),a.jsx("p",{className:"text-sm text-gray-500 break-all",children:d.email})]})]}),xT(d.role,{size:"md"})]}),!["CEO","ADMIN","GROUP MANAGER","GROUP_MANAGER"].includes(d.role.toUpperCase())&&a.jsx("div",{className:"flex flex-col sm:flex-row sm:space-x-3 space-y-2 sm:space-y-0",children:a.jsxs("button",{type:"button",className:"inline-flex items-center justify-center w-full sm:w-auto bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 disabled:opacity-70 transition text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",onClick:()=>st(d),disabled:E,children:[a.jsx(hn,{className:"mr-2"}),"Edit"]})})]}),a.jsx("div",{className:"border-b border-gray-200 mb-6"}),a.jsx("div",{className:"flex w-full bg-[#6A727D] text-white mt-1 overflow-x-auto mb-6",children:["Overview"].map(Ue=>a.jsx("button",{onClick:()=>$(Ue),className:`flex-1 min-w-[90px] px-4 py-2.5 text-xs sm:text-sm font-medium text-center transition-all duration-200 border-b-2
        ${G===Ue?"bg-[#5c636d] text-white border-white":"text-white hover:bg-[#5c636d]"}`,children:Ue},Ue))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 items-start",children:[a.jsx("div",{className:"lg:col-span-3",children:G==="Overview"&&a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 md:p-8 border border-gray-200",children:a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4 sm:gap-6 text-sm text-gray-700",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Email:"}),a.jsx("p",{children:d.email||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Role:"}),a.jsx("p",{children:xT(d.role,{size:"sm"})})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Status:"}),a.jsx("p",{children:d.is_active?"Active":"Inactive"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Auth Provider:"}),a.jsx("p",{children:d.auth_provider?d.auth_provider.toString().replace(/\b\w/g,Ue=>Ue.toUpperCase()):"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Phone Number:"}),a.jsx("p",{children:d.phone_number||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Company:"}),a.jsx("p",{children:d.company?.company_name||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Company Number:"}),a.jsx("p",{children:d.company?.company_number||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Related to CEO:"}),a.jsx("p",{children:d.manager?`${d.manager.first_name} ${d.manager.last_name}`:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created At:"}),a.jsx("p",{children:F8(d.created_at)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Last Login:"}),a.jsx("p",{children:d.last_login?F8(d.last_login):"Never"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Profile Picture:"}),a.jsx("p",{children:d.profile_picture?a.jsx("a",{href:d.profile_picture,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline break-all",children:"View image"}):"N/A"})]})]})})}),a.jsxs("div",{className:"flex flex-col gap-4",children:[a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Quick Actions"}),a.jsx("div",{className:"flex flex-col gap-2 w-full",children:a.jsxs("button",{type:"button",onClick:()=>{if(!d.email){alert("No email address available");return}const Ue=encodeURIComponent(d.email),Ne=encodeURIComponent(""),ze=encodeURIComponent(""),je=`https://mail.google.com/mail/?view=cm&fs=1&to=${Ue}&su=${Ne}&body=${ze}`;window.open(je,"_blank")},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(sn,{className:"text-gray-600 w-4 h-4"}),"Send E-mail"]})})]}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm w-full",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Status"}),a.jsxs("select",{className:"border border-gray-200 rounded-md px-2 sm:px-3 py-1.5 w-full text-sm mb-2 focus:ring-2 focus:ring-indigo-500 outline-none",value:W||(d.is_active?"Active":"Inactive"),onChange:Ue=>Z(Ue.target.value),children:[a.jsx("option",{value:"Active",children:"Active"}),a.jsx("option",{value:"Inactive",children:"Inactive"})]}),a.jsx("button",{onClick:at,disabled:Q||W===(d.is_active?"Active":"Inactive"),className:`w-full py-1.5 rounded-md text-sm transition focus:outline-none focus:ring-2 ${Q||W===(d.is_active?"Active":"Inactive")?"bg-gray-400 cursor-not-allowed text-white":"bg-gray-900 text-white hover:bg-gray-800 focus:ring-gray-400"}`,children:Q?"Updating...":"Update"})]})]})]})]})}):null;return a.jsxs(a.Fragment,{children:[Je,Fe,a.jsx(D8e,{open:p,isEditing:b,isSubmitting:_,confirmProcessing:E,formData:w,onClose:Ke,onSubmit:it,onChange:Ee,onGeneratePassword:He}),a.jsx(P8e,{open:!!k,title:k?.title,message:k?.message,confirmLabel:k?.confirmLabel,cancelLabel:k?.cancelLabel,variant:k?.variant,loading:E,onConfirm:ot,onCancel:rt})]})}function D8e({open:e,isEditing:t,isSubmitting:n,confirmProcessing:s,formData:r,onClose:i,onSubmit:o,onChange:l,onGeneratePassword:c}){if(!e)return null;const u=n||s;return a.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-2xl rounded-2xl shadow-lg border border-gray-200 p-6 sm:p-8 relative overflow-y-auto max-h-[90vh]",children:[a.jsx("button",{onClick:i,className:"absolute top-4 right-4 text-gray-500 hover:text-black transition disabled:opacity-60",disabled:u,children:a.jsx(ea,{size:22})}),a.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800 mb-6 text-center",children:t?"Edit User":"Add New User"}),a.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",onSubmit:o,children:[a.jsx(zb,{label:"First Name",value:r.firstName,onChange:d=>l("firstName",d),placeholder:"John",required:!0,disabled:u}),a.jsx(zb,{label:"Last Name",value:r.lastName,onChange:d=>l("lastName",d),placeholder:"Doe",required:!0,disabled:u}),a.jsx(zb,{label:"Email",type:"email",value:r.email,onChange:d=>l("email",d),placeholder:"john.doe@company.com",required:!0,disabled:u||t}),a.jsx(zb,{label:"Role",type:"select",disabled:!0,value:"Sales",onChange:d=>l("role",d),options:[{value:"",label:"Select role"},...I1],required:!0}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Password"}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2",children:[a.jsx("input",{type:"text",value:r.password,onChange:d=>l("password",d.target.value),placeholder:t?"Leave blank to keep current password":"Enter or generate password",required:!t,disabled:u,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-indigo-500 outline-none disabled:bg-gray-100"}),a.jsx("button",{type:"button",onClick:c,className:"flex items-center justify-center px-4 py-2 bg-gray-900 text-white rounded-md hover:bg-gray-800 transition disabled:opacity-60",disabled:u,children:"Generate"})]}),t?a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Setting a password will reset the user's credentials; leave it blank to keep the current password."}):a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Password must be at least 8 characters long."})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-2 md:col-span-2 mt-4",children:[a.jsx("button",{type:"button",onClick:i,className:"w-full sm:w-auto px-4 py-2 text-white bg-red-400 border border-red-300 rounded hover:bg-red-500 transition disabled:opacity-70",disabled:u,children:"Cancel"}),a.jsx("button",{type:"submit",className:"w-full sm:w-auto px-4 py-2 text-white border border-tertiary bg-tertiary rounded hover:bg-secondary transition disabled:opacity-70",disabled:u,children:n?"Saving...":t?"Update User":"Save User"})]})]})]})})}function zb({label:e,type:t="text",value:n,onChange:s,placeholder:r,options:i=[],required:o=!1,disabled:l=!1}){return a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),t==="select"?a.jsx("select",{value:n??"",onChange:c=>s(c.target.value),required:o,disabled:l,className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-indigo-500 outline-none disabled:bg-gray-100",children:i.map(c=>a.jsx("option",{value:c.value,children:c.label},c.value))}):a.jsx("input",{type:t,value:n??"",onChange:c=>s(c.target.value),placeholder:r,required:o,disabled:l,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-indigo-500 outline-none disabled:bg-gray-100"})]})}function P8e({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o=!1,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":"bg-black hover:bg-gray-800 border border-black";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("div",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsx("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${u}`,disabled:o,children:o?"Processing...":s})]})]})})}function O8e(){const{user:e,loading:t}=Gt(),[n,s]=f.useState(!1),[r,i]=f.useState([]),[o,l]=f.useState([]),[c,u]=f.useState([]);f.useEffect(()=>{document.title="Calendar | Sari-Sari CRM"},[]);const d=f.useCallback(async()=>{try{s(!0);const[p,x,b]=await Promise.all([ne.get("/tasks/all"),ne.get("/meetings/admin/fetch-all"),ne.get("/calls/admin/fetch-all")]),j=Array.isArray(p.data)?p.data:[],y=Array.isArray(x.data)?x.data:[],N=Array.isArray(b.data)?b.data:[],S=["GROUP MANAGER","MANAGER","SALES"].includes(e?.role?.toUpperCase()),_=S?y.filter(k=>k?.status?.toUpperCase()!=="INACTIVE"):y,T=S?N.filter(k=>k?.status!=="INACTIVE"):N;i(j),l(_),u(T)}catch(p){console.error(p),V.error("Failed to load calendar data.")}finally{s(!1)}},[e?.role]);f.useEffect(()=>{!t&&e&&d()},[t,e,d]);const h=f.useMemo(()=>({tasks:r,meetings:o,calls:c}),[r,o,c]);return a.jsxs("div",{className:"min-h-screen",children:[(n||t)&&a.jsx(qt,{message:"Loading calendar..."}),a.jsx(M1,{basePath:"/manager",...h})]})}function M8e({toggleSidebar:e}){const[t,n]=f.useState(!1),s=f.useRef(null),r=ta(),{logout:i}=Ks(),{user:o,fetchUser:l}=Gt(),c={"/marketing/dashboard":"Dashboard","/marketing/contacts":"Contacts","/marketing/accounts":"Accounts","/marketing/leads":"Leads","/marketing/tasks":"Tasks","/marketing/campaigns":"Campaign","/marketing/templates":"Templates"};f.useEffect(()=>{l()},[]);const u=c[r.pathname]||"Marketing Panel";return f.useEffect(()=>{function d(h){s.current&&!s.current.contains(h.target)&&n(!1)}return document.addEventListener("mousedown",d),()=>document.removeEventListener("mousedown",d)},[]),a.jsxs("header",{className:"flex justify-between items-center bg-white shadow px-6 py-3 border-b relative",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("button",{onClick:e,className:"lg:hidden text-gray-700 hover:text-gray-900",children:a.jsx(rh,{className:"text-2xl"})}),a.jsx("h1",{className:"text-lg font-semibold text-gray-800",children:u})]}),a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs("button",{className:"relative text-gray-600 hover:text-gray-800",children:[a.jsx(gx,{className:"text-xl"}),a.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs w-4 h-4 flex items-center justify-center rounded-full",children:"3"})]}),a.jsxs("div",{className:"relative",ref:s,children:[a.jsxs("button",{onClick:()=>n(!t),className:"flex items-center gap-2 cursor-pointer hover:bg-gray-100 px-2 py-1 rounded",children:[a.jsx("img",{src:o?.profile_picture,alt:"",className:"w-8 aspect-square object-cover rounded-full"}),a.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[o?.first_name," ",o?.last_name]})]}),t&&a.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-gray-100 shadow-lg rounded border z-50",children:a.jsxs("div",{className:"flex flex-col",children:[a.jsx("button",{className:"px-4 py-2 text-sm hover:bg-gray-200 text-left",children:"Manage Account"}),a.jsx("div",{className:"border-t my-1"}),a.jsx("button",{onClick:i,className:"px-4 py-2 text-sm bg-red-500 text-white rounded mx-2 my-2 hover:bg-red-600",children:"Logout"})]})})]})]})]})}function I8e(){const[e,t]=f.useState(!1),[n,s]=f.useState(!1),[r,i]=f.useState(!1),[o,l]=f.useState(!1),c=ta(),{fetchUser:u}=Gt();f.useEffect(()=>{u()},[]),f.useEffect(()=>{document.title="Panel | Sari-Sari CRM"},[]);const d="flex items-center gap-3 px-3 py-2 rounded-lg bg-white text-[#1e293b] font-semibold shadow-sm",h="flex items-center gap-3 px-3 py-2 rounded-lg text-gray-300 hover:bg-[#334155] hover:text-white transition",p=["/marketing/campaigns","/marketing/templates"],x=["/marketing/accounts","/marketing/contacts","/marketing/leads"],b=["/marketing/tasks"],j=p.includes(c.pathname),y=x.includes(c.pathname),N=b.includes(c.pathname);return f.useEffect(()=>{j&&t(!0),y&&s(!0),N&&i(!0)},[j,y,N]),a.jsxs("div",{className:"flex h-screen bg-gray-100 overflow-hidden",children:[a.jsxs("div",{className:`fixed top-0 left-0 h-screen w-64 bg-[#1e293b] text-white flex flex-col shadow-lg transform transition-transform duration-300 z-50
          ${o?"translate-x-0":"-translate-x-full"} lg:translate-x-0`,children:[a.jsx("div",{className:"bg-[#fbbf24] text-gray-900 font-bold text-xl px-6 py-4.5 tracking-wide",children:"Marketing CRM"}),a.jsxs("nav",{className:"flex-1 overflow-y-auto p-4 space-y-2",children:[a.jsxs($t,{to:"/marketing/dashboard",className:({isActive:w})=>w?d:h,children:[a.jsx(sh,{className:"text-lg"}),a.jsx("span",{children:"Dashboard"})]}),a.jsxs("div",{children:[a.jsxs("button",{className:"w-full px-3 py-2 flex justify-between items-center text-sm font-medium text-gray-300 hover:bg-[#334155] rounded-lg transition",onClick:()=>s(!n),children:[a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx(sa,{className:"text-lg"}),"Sales"]}),a.jsx(Dt,{className:`transition-transform ${n?"rotate-180":""}`})]}),n&&a.jsxs("div",{className:"ml-6 mt-2 space-y-1",children:[a.jsxs($t,{to:"/marketing/accounts",className:({isActive:w})=>w?d:h,children:[a.jsx(Xa,{})," Accounts"]}),a.jsxs($t,{to:"/marketing/contacts",className:({isActive:w})=>w?d:h,children:[a.jsx(ra,{})," Contacts"]}),a.jsxs($t,{to:"/marketing/leads",className:({isActive:w})=>w?d:h,children:[a.jsx(rn,{})," Leads"]})]})]}),a.jsxs("div",{children:[a.jsxs("button",{className:"w-full px-3 py-2 flex justify-between items-center text-sm font-medium text-gray-300 hover:bg-[#334155] rounded-lg transition",onClick:()=>t(!e),children:[a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx(fr,{className:"text-lg"}),"Tools"]}),a.jsx(Dt,{className:`transition-transform ${e?"rotate-180":""}`})]}),e&&a.jsxs("div",{className:"ml-6 mt-2 space-y-1",children:[a.jsxs($t,{to:"/marketing/campaigns",className:({isActive:w})=>w?d:h,children:[a.jsx(ok,{})," Campaign"]}),a.jsxs($t,{to:"/marketing/templates",className:({isActive:w})=>w?d:h,children:[a.jsx(TL,{})," Templates"]})]})]}),a.jsxs("div",{children:[a.jsxs("button",{className:"w-full px-3 py-2 flex justify-between items-center text-sm font-medium text-gray-300 hover:bg-[#334155] rounded-lg transition",onClick:()=>i(!r),children:[a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx(Ls,{className:"text-lg"}),"Activity"]}),a.jsx(Dt,{className:`transition-transform ${r?"rotate-180":""}`})]}),r&&a.jsx("div",{className:"ml-6 mt-2 space-y-1",children:a.jsxs($t,{to:"/marketing/tasks",className:({isActive:w})=>w?d:h,children:[a.jsx(Qt,{})," Tasks"]})})]})]}),a.jsxs("div",{className:"px-4 py-3 text-xs text-gray-400 border-t border-gray-700",children:[" ",new Date().getFullYear()," Marketing CRM"]})]}),o&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 lg:hidden",onClick:()=>l(!1)}),a.jsxs("div",{className:"flex-1 flex flex-col lg:ml-64 overflow-hidden",children:[a.jsx(M8e,{toggleSidebar:()=>l(!o)}),a.jsx("main",{className:"flex-1 p-6 overflow-auto",style:{backgroundColor:"#fffeee"},children:a.jsx(th,{})})]})]})}function C0(e){return e+.5|0}const sd=(e,t,n)=>Math.max(Math.min(e,n),t);function ap(e){return sd(C0(e*2.55),0,255)}function ud(e){return sd(C0(e*255),0,255)}function Al(e){return sd(C0(e/2.55)/100,0,1)}function B8(e){return sd(C0(e*100),0,100)}const ci={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},cL=[..."0123456789ABCDEF"],$8e=e=>cL[e&15],R8e=e=>cL[(e&240)>>4]+cL[e&15],Fb=e=>(e&240)>>4===(e&15),z8e=e=>Fb(e.r)&&Fb(e.g)&&Fb(e.b)&&Fb(e.a);function F8e(e){var t=e.length,n;return e[0]==="#"&&(t===4||t===5?n={r:255&ci[e[1]]*17,g:255&ci[e[2]]*17,b:255&ci[e[3]]*17,a:t===5?ci[e[4]]*17:255}:(t===7||t===9)&&(n={r:ci[e[1]]<<4|ci[e[2]],g:ci[e[3]]<<4|ci[e[4]],b:ci[e[5]]<<4|ci[e[6]],a:t===9?ci[e[7]]<<4|ci[e[8]]:255})),n}const U8e=(e,t)=>e<255?t(e):"";function B8e(e){var t=z8e(e)?$8e:R8e;return e?"#"+t(e.r)+t(e.g)+t(e.b)+U8e(e.a,t):void 0}const H8e=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function OJ(e,t,n){const s=t*Math.min(n,1-n),r=(i,o=(i+e/30)%12)=>n-s*Math.max(Math.min(o-3,9-o,1),-1);return[r(0),r(8),r(4)]}function q8e(e,t,n){const s=(r,i=(r+e/60)%6)=>n-n*t*Math.max(Math.min(i,4-i,1),0);return[s(5),s(3),s(1)]}function G8e(e,t,n){const s=OJ(e,1,.5);let r;for(t+n>1&&(r=1/(t+n),t*=r,n*=r),r=0;r<3;r++)s[r]*=1-t-n,s[r]+=t;return s}function W8e(e,t,n,s,r){return e===r?(t-n)/s+(t<n?6:0):t===r?(n-e)/s+2:(e-t)/s+4}function l3(e){const n=e.r/255,s=e.g/255,r=e.b/255,i=Math.max(n,s,r),o=Math.min(n,s,r),l=(i+o)/2;let c,u,d;return i!==o&&(d=i-o,u=l>.5?d/(2-i-o):d/(i+o),c=W8e(n,s,r,d,i),c=c*60+.5),[c|0,u||0,l]}function c3(e,t,n,s){return(Array.isArray(t)?e(t[0],t[1],t[2]):e(t,n,s)).map(ud)}function d3(e,t,n){return c3(OJ,e,t,n)}function V8e(e,t,n){return c3(G8e,e,t,n)}function Y8e(e,t,n){return c3(q8e,e,t,n)}function MJ(e){return(e%360+360)%360}function Q8e(e){const t=H8e.exec(e);let n=255,s;if(!t)return;t[5]!==s&&(n=t[6]?ap(+t[5]):ud(+t[5]));const r=MJ(+t[2]),i=+t[3]/100,o=+t[4]/100;return t[1]==="hwb"?s=V8e(r,i,o):t[1]==="hsv"?s=Y8e(r,i,o):s=d3(r,i,o),{r:s[0],g:s[1],b:s[2],a:n}}function K8e(e,t){var n=l3(e);n[0]=MJ(n[0]+t),n=d3(n),e.r=n[0],e.g=n[1],e.b=n[2]}function X8e(e){if(!e)return;const t=l3(e),n=t[0],s=B8(t[1]),r=B8(t[2]);return e.a<255?`hsla(${n}, ${s}%, ${r}%, ${Al(e.a)})`:`hsl(${n}, ${s}%, ${r}%)`}const H8={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},q8={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function Z8e(){const e={},t=Object.keys(q8),n=Object.keys(H8);let s,r,i,o,l;for(s=0;s<t.length;s++){for(o=l=t[s],r=0;r<n.length;r++)i=n[r],l=l.replace(i,H8[i]);i=parseInt(q8[o],16),e[l]=[i>>16&255,i>>8&255,i&255]}return e}let Ub;function J8e(e){Ub||(Ub=Z8e(),Ub.transparent=[0,0,0,0]);const t=Ub[e.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:t.length===4?t[3]:255}}const eBe=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function tBe(e){const t=eBe.exec(e);let n=255,s,r,i;if(t){if(t[7]!==s){const o=+t[7];n=t[8]?ap(o):sd(o*255,0,255)}return s=+t[1],r=+t[3],i=+t[5],s=255&(t[2]?ap(s):sd(s,0,255)),r=255&(t[4]?ap(r):sd(r,0,255)),i=255&(t[6]?ap(i):sd(i,0,255)),{r:s,g:r,b:i,a:n}}}function aBe(e){return e&&(e.a<255?`rgba(${e.r}, ${e.g}, ${e.b}, ${Al(e.a)})`:`rgb(${e.r}, ${e.g}, ${e.b})`)}const yT=e=>e<=.0031308?e*12.92:Math.pow(e,1/2.4)*1.055-.055,uf=e=>e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4);function nBe(e,t,n){const s=uf(Al(e.r)),r=uf(Al(e.g)),i=uf(Al(e.b));return{r:ud(yT(s+n*(uf(Al(t.r))-s))),g:ud(yT(r+n*(uf(Al(t.g))-r))),b:ud(yT(i+n*(uf(Al(t.b))-i))),a:e.a+n*(t.a-e.a)}}function Bb(e,t,n){if(e){let s=l3(e);s[t]=Math.max(0,Math.min(s[t]+s[t]*n,t===0?360:1)),s=d3(s),e.r=s[0],e.g=s[1],e.b=s[2]}}function IJ(e,t){return e&&Object.assign(t||{},e)}function G8(e){var t={r:0,g:0,b:0,a:255};return Array.isArray(e)?e.length>=3&&(t={r:e[0],g:e[1],b:e[2],a:255},e.length>3&&(t.a=ud(e[3]))):(t=IJ(e,{r:0,g:0,b:0,a:1}),t.a=ud(t.a)),t}function sBe(e){return e.charAt(0)==="r"?tBe(e):Q8e(e)}class Zp{constructor(t){if(t instanceof Zp)return t;const n=typeof t;let s;n==="object"?s=G8(t):n==="string"&&(s=F8e(t)||J8e(t)||sBe(t)),this._rgb=s,this._valid=!!s}get valid(){return this._valid}get rgb(){var t=IJ(this._rgb);return t&&(t.a=Al(t.a)),t}set rgb(t){this._rgb=G8(t)}rgbString(){return this._valid?aBe(this._rgb):void 0}hexString(){return this._valid?B8e(this._rgb):void 0}hslString(){return this._valid?X8e(this._rgb):void 0}mix(t,n){if(t){const s=this.rgb,r=t.rgb;let i;const o=n===i?.5:n,l=2*o-1,c=s.a-r.a,u=((l*c===-1?l:(l+c)/(1+l*c))+1)/2;i=1-u,s.r=255&u*s.r+i*r.r+.5,s.g=255&u*s.g+i*r.g+.5,s.b=255&u*s.b+i*r.b+.5,s.a=o*s.a+(1-o)*r.a,this.rgb=s}return this}interpolate(t,n){return t&&(this._rgb=nBe(this._rgb,t._rgb,n)),this}clone(){return new Zp(this.rgb)}alpha(t){return this._rgb.a=ud(t),this}clearer(t){const n=this._rgb;return n.a*=1-t,this}greyscale(){const t=this._rgb,n=C0(t.r*.3+t.g*.59+t.b*.11);return t.r=t.g=t.b=n,this}opaquer(t){const n=this._rgb;return n.a*=1+t,this}negate(){const t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return Bb(this._rgb,2,t),this}darken(t){return Bb(this._rgb,2,-t),this}saturate(t){return Bb(this._rgb,1,t),this}desaturate(t){return Bb(this._rgb,1,-t),this}rotate(t){return K8e(this._rgb,t),this}}function jl(){}const rBe=(()=>{let e=0;return()=>e++})();function Pa(e){return e==null}function is(e){if(Array.isArray&&Array.isArray(e))return!0;const t=Object.prototype.toString.call(e);return t.slice(0,7)==="[object"&&t.slice(-6)==="Array]"}function Na(e){return e!==null&&Object.prototype.toString.call(e)==="[object Object]"}function Ci(e){return(typeof e=="number"||e instanceof Number)&&isFinite(+e)}function bo(e,t){return Ci(e)?e:t}function ma(e,t){return typeof e>"u"?t:e}const iBe=(e,t)=>typeof e=="string"&&e.endsWith("%")?parseFloat(e)/100:+e/t,$J=(e,t)=>typeof e=="string"&&e.endsWith("%")?parseFloat(e)/100*t:+e;function an(e,t,n){if(e&&typeof e.call=="function")return e.apply(n,t)}function Ra(e,t,n,s){let r,i,o;if(is(e))for(i=e.length,r=0;r<i;r++)t.call(n,e[r],r);else if(Na(e))for(o=Object.keys(e),i=o.length,r=0;r<i;r++)t.call(n,e[o[r]],o[r])}function tj(e,t){let n,s,r,i;if(!e||!t||e.length!==t.length)return!1;for(n=0,s=e.length;n<s;++n)if(r=e[n],i=t[n],r.datasetIndex!==i.datasetIndex||r.index!==i.index)return!1;return!0}function aj(e){if(is(e))return e.map(aj);if(Na(e)){const t=Object.create(null),n=Object.keys(e),s=n.length;let r=0;for(;r<s;++r)t[n[r]]=aj(e[n[r]]);return t}return e}function RJ(e){return["__proto__","prototype","constructor"].indexOf(e)===-1}function oBe(e,t,n,s){if(!RJ(e))return;const r=t[e],i=n[e];Na(r)&&Na(i)?Jp(r,i,s):t[e]=aj(i)}function Jp(e,t,n){const s=is(t)?t:[t],r=s.length;if(!Na(e))return e;n=n||{};const i=n.merger||oBe;let o;for(let l=0;l<r;++l){if(o=s[l],!Na(o))continue;const c=Object.keys(o);for(let u=0,d=c.length;u<d;++u)i(c[u],e,o,n)}return e}function gp(e,t){return Jp(e,t,{merger:lBe})}function lBe(e,t,n){if(!RJ(e))return;const s=t[e],r=n[e];Na(s)&&Na(r)?gp(s,r):Object.prototype.hasOwnProperty.call(t,e)||(t[e]=aj(r))}const W8={"":e=>e,x:e=>e.x,y:e=>e.y};function cBe(e){const t=e.split("."),n=[];let s="";for(const r of t)s+=r,s.endsWith("\\")?s=s.slice(0,-1)+".":(n.push(s),s="");return n}function dBe(e){const t=cBe(e);return n=>{for(const s of t){if(s==="")break;n=n&&n[s]}return n}}function em(e,t){return(W8[t]||(W8[t]=dBe(t)))(e)}function u3(e){return e.charAt(0).toUpperCase()+e.slice(1)}const ex=e=>typeof e<"u",Nd=e=>typeof e=="function",V8=(e,t)=>{if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0};function uBe(e){return e.type==="mouseup"||e.type==="click"||e.type==="contextmenu"}const Fa=Math.PI,_n=2*Fa,mBe=_n+Fa,nj=Number.POSITIVE_INFINITY,fBe=Fa/180,os=Fa/2,Jd=Fa/4,Y8=Fa*2/3,zJ=Math.log10,Fo=Math.sign;function pp(e,t,n){return Math.abs(e-t)<n}function Q8(e){const t=Math.round(e);e=pp(e,t,e/1e3)?t:e;const n=Math.pow(10,Math.floor(zJ(e))),s=e/n;return(s<=1?1:s<=2?2:s<=5?5:10)*n}function hBe(e){const t=[],n=Math.sqrt(e);let s;for(s=1;s<n;s++)e%s===0&&(t.push(s),t.push(e/s));return n===(n|0)&&t.push(n),t.sort((r,i)=>r-i).pop(),t}function gBe(e){return typeof e=="symbol"||typeof e=="object"&&e!==null&&!(Symbol.toPrimitive in e||"toString"in e||"valueOf"in e)}function tx(e){return!gBe(e)&&!isNaN(parseFloat(e))&&isFinite(e)}function pBe(e,t){const n=Math.round(e);return n-t<=e&&n+t>=e}function xBe(e,t,n){let s,r,i;for(s=0,r=e.length;s<r;s++)i=e[s][n],isNaN(i)||(t.min=Math.min(t.min,i),t.max=Math.max(t.max,i))}function Pl(e){return e*(Fa/180)}function yBe(e){return e*(180/Fa)}function K8(e){if(!Ci(e))return;let t=1,n=0;for(;Math.round(e*t)/t!==e;)t*=10,n++;return n}function FJ(e,t){const n=t.x-e.x,s=t.y-e.y,r=Math.sqrt(n*n+s*s);let i=Math.atan2(s,n);return i<-.5*Fa&&(i+=_n),{angle:i,distance:r}}function dL(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function bBe(e,t){return(e-t+mBe)%_n-Fa}function Ui(e){return(e%_n+_n)%_n}function ax(e,t,n,s){const r=Ui(e),i=Ui(t),o=Ui(n),l=Ui(i-r),c=Ui(o-r),u=Ui(r-i),d=Ui(r-o);return r===i||r===o||s&&i===o||l>c&&u<d}function Rs(e,t,n){return Math.max(t,Math.min(n,e))}function vBe(e){return Rs(e,-32768,32767)}function rd(e,t,n,s=1e-6){return e>=Math.min(t,n)-s&&e<=Math.max(t,n)+s}function m3(e,t,n){n=n||(o=>e[o]<t);let s=e.length-1,r=0,i;for(;s-r>1;)i=r+s>>1,n(i)?r=i:s=i;return{lo:r,hi:s}}const Su=(e,t,n,s)=>m3(e,n,s?r=>{const i=e[r][t];return i<n||i===n&&e[r+1][t]===n}:r=>e[r][t]<n),wBe=(e,t,n)=>m3(e,n,s=>e[s][t]>=n);function jBe(e,t,n){let s=0,r=e.length;for(;s<r&&e[s]<t;)s++;for(;r>s&&e[r-1]>n;)r--;return s>0||r<e.length?e.slice(s,r):e}const UJ=["push","pop","shift","splice","unshift"];function NBe(e,t){if(e._chartjs){e._chartjs.listeners.push(t);return}Object.defineProperty(e,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[t]}}),UJ.forEach(n=>{const s="_onData"+u3(n),r=e[n];Object.defineProperty(e,n,{configurable:!0,enumerable:!1,value(...i){const o=r.apply(this,i);return e._chartjs.listeners.forEach(l=>{typeof l[s]=="function"&&l[s](...i)}),o}})})}function X8(e,t){const n=e._chartjs;if(!n)return;const s=n.listeners,r=s.indexOf(t);r!==-1&&s.splice(r,1),!(s.length>0)&&(UJ.forEach(i=>{delete e[i]}),delete e._chartjs)}function BJ(e){const t=new Set(e);return t.size===e.length?e:Array.from(t)}const HJ=(function(){return typeof window>"u"?function(e){return e()}:window.requestAnimationFrame})();function qJ(e,t){let n=[],s=!1;return function(...r){n=r,s||(s=!0,HJ.call(window,()=>{s=!1,e.apply(t,n)}))}}function CBe(e,t){let n;return function(...s){return t?(clearTimeout(n),n=setTimeout(e,t,s)):e.apply(this,s),t}}const f3=e=>e==="start"?"left":e==="end"?"right":"center",Os=(e,t,n)=>e==="start"?t:e==="end"?n:(t+n)/2,SBe=(e,t,n,s)=>e===(s?"left":"right")?n:e==="center"?(t+n)/2:t;function _Be(e,t,n){const s=t.length;let r=0,i=s;if(e._sorted){const{iScale:o,vScale:l,_parsed:c}=e,u=e.dataset&&e.dataset.options?e.dataset.options.spanGaps:null,d=o.axis,{min:h,max:p,minDefined:x,maxDefined:b}=o.getUserBounds();if(x){if(r=Math.min(Su(c,d,h).lo,n?s:Su(t,d,o.getPixelForValue(h)).lo),u){const j=c.slice(0,r+1).reverse().findIndex(y=>!Pa(y[l.axis]));r-=Math.max(0,j)}r=Rs(r,0,s-1)}if(b){let j=Math.max(Su(c,o.axis,p,!0).hi+1,n?0:Su(t,d,o.getPixelForValue(p),!0).hi+1);if(u){const y=c.slice(j-1).findIndex(N=>!Pa(N[l.axis]));j+=Math.max(0,y)}i=Rs(j,r,s)-r}else i=s-r}return{start:r,count:i}}function ABe(e){const{xScale:t,yScale:n,_scaleRanges:s}=e,r={xmin:t.min,xmax:t.max,ymin:n.min,ymax:n.max};if(!s)return e._scaleRanges=r,!0;const i=s.xmin!==t.min||s.xmax!==t.max||s.ymin!==n.min||s.ymax!==n.max;return Object.assign(s,r),i}const Hb=e=>e===0||e===1,Z8=(e,t,n)=>-(Math.pow(2,10*(e-=1))*Math.sin((e-t)*_n/n)),J8=(e,t,n)=>Math.pow(2,-10*e)*Math.sin((e-t)*_n/n)+1,xp={linear:e=>e,easeInQuad:e=>e*e,easeOutQuad:e=>-e*(e-2),easeInOutQuad:e=>(e/=.5)<1?.5*e*e:-.5*(--e*(e-2)-1),easeInCubic:e=>e*e*e,easeOutCubic:e=>(e-=1)*e*e+1,easeInOutCubic:e=>(e/=.5)<1?.5*e*e*e:.5*((e-=2)*e*e+2),easeInQuart:e=>e*e*e*e,easeOutQuart:e=>-((e-=1)*e*e*e-1),easeInOutQuart:e=>(e/=.5)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2),easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>(e-=1)*e*e*e*e+1,easeInOutQuint:e=>(e/=.5)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2),easeInSine:e=>-Math.cos(e*os)+1,easeOutSine:e=>Math.sin(e*os),easeInOutSine:e=>-.5*(Math.cos(Fa*e)-1),easeInExpo:e=>e===0?0:Math.pow(2,10*(e-1)),easeOutExpo:e=>e===1?1:-Math.pow(2,-10*e)+1,easeInOutExpo:e=>Hb(e)?e:e<.5?.5*Math.pow(2,10*(e*2-1)):.5*(-Math.pow(2,-10*(e*2-1))+2),easeInCirc:e=>e>=1?e:-(Math.sqrt(1-e*e)-1),easeOutCirc:e=>Math.sqrt(1-(e-=1)*e),easeInOutCirc:e=>(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1),easeInElastic:e=>Hb(e)?e:Z8(e,.075,.3),easeOutElastic:e=>Hb(e)?e:J8(e,.075,.3),easeInOutElastic(e){return Hb(e)?e:e<.5?.5*Z8(e*2,.1125,.45):.5+.5*J8(e*2-1,.1125,.45)},easeInBack(e){return e*e*((1.70158+1)*e-1.70158)},easeOutBack(e){return(e-=1)*e*((1.70158+1)*e+1.70158)+1},easeInOutBack(e){let t=1.70158;return(e/=.5)<1?.5*(e*e*(((t*=1.525)+1)*e-t)):.5*((e-=2)*e*(((t*=1.525)+1)*e+t)+2)},easeInBounce:e=>1-xp.easeOutBounce(1-e),easeOutBounce(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},easeInOutBounce:e=>e<.5?xp.easeInBounce(e*2)*.5:xp.easeOutBounce(e*2-1)*.5+.5};function h3(e){if(e&&typeof e=="object"){const t=e.toString();return t==="[object CanvasPattern]"||t==="[object CanvasGradient]"}return!1}function eB(e){return h3(e)?e:new Zp(e)}function bT(e){return h3(e)?e:new Zp(e).saturate(.5).darken(.1).hexString()}const TBe=["x","y","borderWidth","radius","tension"],kBe=["color","borderColor","backgroundColor"];function EBe(e){e.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),e.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>t!=="onProgress"&&t!=="onComplete"&&t!=="fn"}),e.set("animations",{colors:{type:"color",properties:kBe},numbers:{type:"number",properties:TBe}}),e.describe("animations",{_fallback:"animation"}),e.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>t|0}}}})}function LBe(e){e.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const tB=new Map;function DBe(e,t){t=t||{};const n=e+JSON.stringify(t);let s=tB.get(n);return s||(s=new Intl.NumberFormat(e,t),tB.set(n,s)),s}function g3(e,t,n){return DBe(t,n).format(e)}const PBe={values(e){return is(e)?e:""+e},numeric(e,t,n){if(e===0)return"0";const s=this.chart.options.locale;let r,i=e;if(n.length>1){const u=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(u<1e-4||u>1e15)&&(r="scientific"),i=OBe(e,n)}const o=zJ(Math.abs(i)),l=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),c={notation:r,minimumFractionDigits:l,maximumFractionDigits:l};return Object.assign(c,this.options.ticks.format),g3(e,s,c)}};function OBe(e,t){let n=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;return Math.abs(n)>=1&&e!==Math.floor(e)&&(n=e-Math.floor(e)),n}var GJ={formatters:PBe};function MBe(e){e.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,n)=>n.lineWidth,tickColor:(t,n)=>n.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:GJ.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),e.route("scale.ticks","color","","color"),e.route("scale.grid","color","","borderColor"),e.route("scale.border","color","","borderColor"),e.route("scale.title","color","","color"),e.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&t!=="callback"&&t!=="parser",_indexable:t=>t!=="borderDash"&&t!=="tickBorderDash"&&t!=="dash"}),e.describe("scales",{_fallback:"scale"}),e.describe("scale.ticks",{_scriptable:t=>t!=="backdropPadding"&&t!=="callback",_indexable:t=>t!=="backdropPadding"})}const tm=Object.create(null),uL=Object.create(null);function yp(e,t){if(!t)return e;const n=t.split(".");for(let s=0,r=n.length;s<r;++s){const i=n[s];e=e[i]||(e[i]=Object.create(null))}return e}function vT(e,t,n){return typeof t=="string"?Jp(yp(e,t),n):Jp(yp(e,""),t)}class IBe{constructor(t,n){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=s=>s.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(s,r)=>bT(r.backgroundColor),this.hoverBorderColor=(s,r)=>bT(r.borderColor),this.hoverColor=(s,r)=>bT(r.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t),this.apply(n)}set(t,n){return vT(this,t,n)}get(t){return yp(this,t)}describe(t,n){return vT(uL,t,n)}override(t,n){return vT(tm,t,n)}route(t,n,s,r){const i=yp(this,t),o=yp(this,s),l="_"+n;Object.defineProperties(i,{[l]:{value:i[n],writable:!0},[n]:{enumerable:!0,get(){const c=this[l],u=o[r];return Na(c)?Object.assign({},u,c):ma(c,u)},set(c){this[l]=c}}})}apply(t){t.forEach(n=>n(this))}}var On=new IBe({_scriptable:e=>!e.startsWith("on"),_indexable:e=>e!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[EBe,LBe,MBe]);function $Be(e){return!e||Pa(e.size)||Pa(e.family)?null:(e.style?e.style+" ":"")+(e.weight?e.weight+" ":"")+e.size+"px "+e.family}function aB(e,t,n,s,r){let i=t[r];return i||(i=t[r]=e.measureText(r).width,n.push(r)),i>s&&(s=i),s}function eu(e,t,n){const s=e.currentDevicePixelRatio,r=n!==0?Math.max(n/2,.5):0;return Math.round((t-r)*s)/s+r}function nB(e,t){!t&&!e||(t=t||e.getContext("2d"),t.save(),t.resetTransform(),t.clearRect(0,0,e.width,e.height),t.restore())}function mL(e,t,n,s){WJ(e,t,n,s,null)}function WJ(e,t,n,s,r){let i,o,l,c,u,d,h,p;const x=t.pointStyle,b=t.rotation,j=t.radius;let y=(b||0)*fBe;if(x&&typeof x=="object"&&(i=x.toString(),i==="[object HTMLImageElement]"||i==="[object HTMLCanvasElement]")){e.save(),e.translate(n,s),e.rotate(y),e.drawImage(x,-x.width/2,-x.height/2,x.width,x.height),e.restore();return}if(!(isNaN(j)||j<=0)){switch(e.beginPath(),x){default:r?e.ellipse(n,s,r/2,j,0,0,_n):e.arc(n,s,j,0,_n),e.closePath();break;case"triangle":d=r?r/2:j,e.moveTo(n+Math.sin(y)*d,s-Math.cos(y)*j),y+=Y8,e.lineTo(n+Math.sin(y)*d,s-Math.cos(y)*j),y+=Y8,e.lineTo(n+Math.sin(y)*d,s-Math.cos(y)*j),e.closePath();break;case"rectRounded":u=j*.516,c=j-u,o=Math.cos(y+Jd)*c,h=Math.cos(y+Jd)*(r?r/2-u:c),l=Math.sin(y+Jd)*c,p=Math.sin(y+Jd)*(r?r/2-u:c),e.arc(n-h,s-l,u,y-Fa,y-os),e.arc(n+p,s-o,u,y-os,y),e.arc(n+h,s+l,u,y,y+os),e.arc(n-p,s+o,u,y+os,y+Fa),e.closePath();break;case"rect":if(!b){c=Math.SQRT1_2*j,d=r?r/2:c,e.rect(n-d,s-c,2*d,2*c);break}y+=Jd;case"rectRot":h=Math.cos(y)*(r?r/2:j),o=Math.cos(y)*j,l=Math.sin(y)*j,p=Math.sin(y)*(r?r/2:j),e.moveTo(n-h,s-l),e.lineTo(n+p,s-o),e.lineTo(n+h,s+l),e.lineTo(n-p,s+o),e.closePath();break;case"crossRot":y+=Jd;case"cross":h=Math.cos(y)*(r?r/2:j),o=Math.cos(y)*j,l=Math.sin(y)*j,p=Math.sin(y)*(r?r/2:j),e.moveTo(n-h,s-l),e.lineTo(n+h,s+l),e.moveTo(n+p,s-o),e.lineTo(n-p,s+o);break;case"star":h=Math.cos(y)*(r?r/2:j),o=Math.cos(y)*j,l=Math.sin(y)*j,p=Math.sin(y)*(r?r/2:j),e.moveTo(n-h,s-l),e.lineTo(n+h,s+l),e.moveTo(n+p,s-o),e.lineTo(n-p,s+o),y+=Jd,h=Math.cos(y)*(r?r/2:j),o=Math.cos(y)*j,l=Math.sin(y)*j,p=Math.sin(y)*(r?r/2:j),e.moveTo(n-h,s-l),e.lineTo(n+h,s+l),e.moveTo(n+p,s-o),e.lineTo(n-p,s+o);break;case"line":o=r?r/2:Math.cos(y)*j,l=Math.sin(y)*j,e.moveTo(n-o,s-l),e.lineTo(n+o,s+l);break;case"dash":e.moveTo(n,s),e.lineTo(n+Math.cos(y)*(r?r/2:j),s+Math.sin(y)*j);break;case!1:e.closePath();break}e.fill(),t.borderWidth>0&&e.stroke()}}function nx(e,t,n){return n=n||.5,!t||e&&e.x>t.left-n&&e.x<t.right+n&&e.y>t.top-n&&e.y<t.bottom+n}function p3(e,t){e.save(),e.beginPath(),e.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),e.clip()}function x3(e){e.restore()}function RBe(e,t,n,s,r){if(!t)return e.lineTo(n.x,n.y);if(r==="middle"){const i=(t.x+n.x)/2;e.lineTo(i,t.y),e.lineTo(i,n.y)}else r==="after"!=!!s?e.lineTo(t.x,n.y):e.lineTo(n.x,t.y);e.lineTo(n.x,n.y)}function zBe(e,t,n,s){if(!t)return e.lineTo(n.x,n.y);e.bezierCurveTo(s?t.cp1x:t.cp2x,s?t.cp1y:t.cp2y,s?n.cp2x:n.cp1x,s?n.cp2y:n.cp1y,n.x,n.y)}function FBe(e,t){t.translation&&e.translate(t.translation[0],t.translation[1]),Pa(t.rotation)||e.rotate(t.rotation),t.color&&(e.fillStyle=t.color),t.textAlign&&(e.textAlign=t.textAlign),t.textBaseline&&(e.textBaseline=t.textBaseline)}function UBe(e,t,n,s,r){if(r.strikethrough||r.underline){const i=e.measureText(s),o=t-i.actualBoundingBoxLeft,l=t+i.actualBoundingBoxRight,c=n-i.actualBoundingBoxAscent,u=n+i.actualBoundingBoxDescent,d=r.strikethrough?(c+u)/2:u;e.strokeStyle=e.fillStyle,e.beginPath(),e.lineWidth=r.decorationWidth||2,e.moveTo(o,d),e.lineTo(l,d),e.stroke()}}function BBe(e,t){const n=e.fillStyle;e.fillStyle=t.color,e.fillRect(t.left,t.top,t.width,t.height),e.fillStyle=n}function sx(e,t,n,s,r,i={}){const o=is(t)?t:[t],l=i.strokeWidth>0&&i.strokeColor!=="";let c,u;for(e.save(),e.font=r.string,FBe(e,i),c=0;c<o.length;++c)u=o[c],i.backdrop&&BBe(e,i.backdrop),l&&(i.strokeColor&&(e.strokeStyle=i.strokeColor),Pa(i.strokeWidth)||(e.lineWidth=i.strokeWidth),e.strokeText(u,n,s,i.maxWidth)),e.fillText(u,n,s,i.maxWidth),UBe(e,n,s,u,i),s+=Number(r.lineHeight);e.restore()}function sj(e,t){const{x:n,y:s,w:r,h:i,radius:o}=t;e.arc(n+o.topLeft,s+o.topLeft,o.topLeft,1.5*Fa,Fa,!0),e.lineTo(n,s+i-o.bottomLeft),e.arc(n+o.bottomLeft,s+i-o.bottomLeft,o.bottomLeft,Fa,os,!0),e.lineTo(n+r-o.bottomRight,s+i),e.arc(n+r-o.bottomRight,s+i-o.bottomRight,o.bottomRight,os,0,!0),e.lineTo(n+r,s+o.topRight),e.arc(n+r-o.topRight,s+o.topRight,o.topRight,0,-os,!0),e.lineTo(n+o.topLeft,s)}const HBe=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,qBe=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function GBe(e,t){const n=(""+e).match(HBe);if(!n||n[1]==="normal")return t*1.2;switch(e=+n[2],n[3]){case"px":return e;case"%":e/=100;break}return t*e}const WBe=e=>+e||0;function y3(e,t){const n={},s=Na(t),r=s?Object.keys(t):t,i=Na(e)?s?o=>ma(e[o],e[t[o]]):o=>e[o]:()=>e;for(const o of r)n[o]=WBe(i(o));return n}function VJ(e){return y3(e,{top:"y",right:"x",bottom:"y",left:"x"})}function Tf(e){return y3(e,["topLeft","topRight","bottomLeft","bottomRight"])}function Si(e){const t=VJ(e);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function zs(e,t){e=e||{},t=t||On.font;let n=ma(e.size,t.size);typeof n=="string"&&(n=parseInt(n,10));let s=ma(e.style,t.style);s&&!(""+s).match(qBe)&&(console.warn('Invalid font style specified: "'+s+'"'),s=void 0);const r={family:ma(e.family,t.family),lineHeight:GBe(ma(e.lineHeight,t.lineHeight),n),size:n,style:s,weight:ma(e.weight,t.weight),string:""};return r.string=$Be(r),r}function qb(e,t,n,s){let r,i,o;for(r=0,i=e.length;r<i;++r)if(o=e[r],o!==void 0&&o!==void 0)return o}function VBe(e,t,n){const{min:s,max:r}=e,i=$J(t,(r-s)/2),o=(l,c)=>n&&l===0?0:l+c;return{min:o(s,-Math.abs(i)),max:o(r,i)}}function hm(e,t){return Object.assign(Object.create(e),t)}function b3(e,t=[""],n,s,r=()=>e[0]){const i=n||e;typeof s>"u"&&(s=XJ("_fallback",e));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:e,_rootScopes:i,_fallback:s,_getTarget:r,override:l=>b3([l,...e],t,i,s)};return new Proxy(o,{deleteProperty(l,c){return delete l[c],delete l._keys,delete e[0][c],!0},get(l,c){return QJ(l,c,()=>tHe(c,t,e,l))},getOwnPropertyDescriptor(l,c){return Reflect.getOwnPropertyDescriptor(l._scopes[0],c)},getPrototypeOf(){return Reflect.getPrototypeOf(e[0])},has(l,c){return rB(l).includes(c)},ownKeys(l){return rB(l)},set(l,c,u){const d=l._storage||(l._storage=r());return l[c]=d[c]=u,delete l._keys,!0}})}function Qf(e,t,n,s){const r={_cacheable:!1,_proxy:e,_context:t,_subProxy:n,_stack:new Set,_descriptors:YJ(e,s),setContext:i=>Qf(e,i,n,s),override:i=>Qf(e.override(i),t,n,s)};return new Proxy(r,{deleteProperty(i,o){return delete i[o],delete e[o],!0},get(i,o,l){return QJ(i,o,()=>QBe(i,o,l))},getOwnPropertyDescriptor(i,o){return i._descriptors.allKeys?Reflect.has(e,o)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(e,o)},getPrototypeOf(){return Reflect.getPrototypeOf(e)},has(i,o){return Reflect.has(e,o)},ownKeys(){return Reflect.ownKeys(e)},set(i,o,l){return e[o]=l,delete i[o],!0}})}function YJ(e,t={scriptable:!0,indexable:!0}){const{_scriptable:n=t.scriptable,_indexable:s=t.indexable,_allKeys:r=t.allKeys}=e;return{allKeys:r,scriptable:n,indexable:s,isScriptable:Nd(n)?n:()=>n,isIndexable:Nd(s)?s:()=>s}}const YBe=(e,t)=>e?e+u3(t):t,v3=(e,t)=>Na(t)&&e!=="adapters"&&(Object.getPrototypeOf(t)===null||t.constructor===Object);function QJ(e,t,n){if(Object.prototype.hasOwnProperty.call(e,t)||t==="constructor")return e[t];const s=n();return e[t]=s,s}function QBe(e,t,n){const{_proxy:s,_context:r,_subProxy:i,_descriptors:o}=e;let l=s[t];return Nd(l)&&o.isScriptable(t)&&(l=KBe(t,l,e,n)),is(l)&&l.length&&(l=XBe(t,l,e,o.isIndexable)),v3(t,l)&&(l=Qf(l,r,i&&i[t],o)),l}function KBe(e,t,n,s){const{_proxy:r,_context:i,_subProxy:o,_stack:l}=n;if(l.has(e))throw new Error("Recursion detected: "+Array.from(l).join("->")+"->"+e);l.add(e);let c=t(i,o||s);return l.delete(e),v3(e,c)&&(c=w3(r._scopes,r,e,c)),c}function XBe(e,t,n,s){const{_proxy:r,_context:i,_subProxy:o,_descriptors:l}=n;if(typeof i.index<"u"&&s(e))return t[i.index%t.length];if(Na(t[0])){const c=t,u=r._scopes.filter(d=>d!==c);t=[];for(const d of c){const h=w3(u,r,e,d);t.push(Qf(h,i,o&&o[e],l))}}return t}function KJ(e,t,n){return Nd(e)?e(t,n):e}const ZBe=(e,t)=>e===!0?t:typeof e=="string"?em(t,e):void 0;function JBe(e,t,n,s,r){for(const i of t){const o=ZBe(n,i);if(o){e.add(o);const l=KJ(o._fallback,n,r);if(typeof l<"u"&&l!==n&&l!==s)return l}else if(o===!1&&typeof s<"u"&&n!==s)return null}return!1}function w3(e,t,n,s){const r=t._rootScopes,i=KJ(t._fallback,n,s),o=[...e,...r],l=new Set;l.add(s);let c=sB(l,o,n,i||n,s);return c===null||typeof i<"u"&&i!==n&&(c=sB(l,o,i,c,s),c===null)?!1:b3(Array.from(l),[""],r,i,()=>eHe(t,n,s))}function sB(e,t,n,s,r){for(;n;)n=JBe(e,t,n,s,r);return n}function eHe(e,t,n){const s=e._getTarget();t in s||(s[t]={});const r=s[t];return is(r)&&Na(n)?n:r||{}}function tHe(e,t,n,s){let r;for(const i of t)if(r=XJ(YBe(i,e),n),typeof r<"u")return v3(e,r)?w3(n,s,e,r):r}function XJ(e,t){for(const n of t){if(!n)continue;const s=n[e];if(typeof s<"u")return s}}function rB(e){let t=e._keys;return t||(t=e._keys=aHe(e._scopes)),t}function aHe(e){const t=new Set;for(const n of e)for(const s of Object.keys(n).filter(r=>!r.startsWith("_")))t.add(s);return Array.from(t)}const nHe=Number.EPSILON||1e-14,Kf=(e,t)=>t<e.length&&!e[t].skip&&e[t],ZJ=e=>e==="x"?"y":"x";function sHe(e,t,n,s){const r=e.skip?t:e,i=t,o=n.skip?t:n,l=dL(i,r),c=dL(o,i);let u=l/(l+c),d=c/(l+c);u=isNaN(u)?0:u,d=isNaN(d)?0:d;const h=s*u,p=s*d;return{previous:{x:i.x-h*(o.x-r.x),y:i.y-h*(o.y-r.y)},next:{x:i.x+p*(o.x-r.x),y:i.y+p*(o.y-r.y)}}}function rHe(e,t,n){const s=e.length;let r,i,o,l,c,u=Kf(e,0);for(let d=0;d<s-1;++d)if(c=u,u=Kf(e,d+1),!(!c||!u)){if(pp(t[d],0,nHe)){n[d]=n[d+1]=0;continue}r=n[d]/t[d],i=n[d+1]/t[d],l=Math.pow(r,2)+Math.pow(i,2),!(l<=9)&&(o=3/Math.sqrt(l),n[d]=r*o*t[d],n[d+1]=i*o*t[d])}}function iHe(e,t,n="x"){const s=ZJ(n),r=e.length;let i,o,l,c=Kf(e,0);for(let u=0;u<r;++u){if(o=l,l=c,c=Kf(e,u+1),!l)continue;const d=l[n],h=l[s];o&&(i=(d-o[n])/3,l[`cp1${n}`]=d-i,l[`cp1${s}`]=h-i*t[u]),c&&(i=(c[n]-d)/3,l[`cp2${n}`]=d+i,l[`cp2${s}`]=h+i*t[u])}}function oHe(e,t="x"){const n=ZJ(t),s=e.length,r=Array(s).fill(0),i=Array(s);let o,l,c,u=Kf(e,0);for(o=0;o<s;++o)if(l=c,c=u,u=Kf(e,o+1),!!c){if(u){const d=u[t]-c[t];r[o]=d!==0?(u[n]-c[n])/d:0}i[o]=l?u?Fo(r[o-1])!==Fo(r[o])?0:(r[o-1]+r[o])/2:r[o-1]:r[o]}rHe(e,r,i),iHe(e,i,t)}function Gb(e,t,n){return Math.max(Math.min(e,n),t)}function lHe(e,t){let n,s,r,i,o,l=nx(e[0],t);for(n=0,s=e.length;n<s;++n)o=i,i=l,l=n<s-1&&nx(e[n+1],t),i&&(r=e[n],o&&(r.cp1x=Gb(r.cp1x,t.left,t.right),r.cp1y=Gb(r.cp1y,t.top,t.bottom)),l&&(r.cp2x=Gb(r.cp2x,t.left,t.right),r.cp2y=Gb(r.cp2y,t.top,t.bottom)))}function cHe(e,t,n,s,r){let i,o,l,c;if(t.spanGaps&&(e=e.filter(u=>!u.skip)),t.cubicInterpolationMode==="monotone")oHe(e,r);else{let u=s?e[e.length-1]:e[0];for(i=0,o=e.length;i<o;++i)l=e[i],c=sHe(u,l,e[Math.min(i+1,o-(s?0:1))%o],t.tension),l.cp1x=c.previous.x,l.cp1y=c.previous.y,l.cp2x=c.next.x,l.cp2y=c.next.y,u=l}t.capBezierPoints&&lHe(e,n)}function j3(){return typeof window<"u"&&typeof document<"u"}function N3(e){let t=e.parentNode;return t&&t.toString()==="[object ShadowRoot]"&&(t=t.host),t}function rj(e,t,n){let s;return typeof e=="string"?(s=parseInt(e,10),e.indexOf("%")!==-1&&(s=s/100*t.parentNode[n])):s=e,s}const $1=e=>e.ownerDocument.defaultView.getComputedStyle(e,null);function dHe(e,t){return $1(e).getPropertyValue(t)}const uHe=["top","right","bottom","left"];function Ou(e,t,n){const s={};n=n?"-"+n:"";for(let r=0;r<4;r++){const i=uHe[r];s[i]=parseFloat(e[t+"-"+i+n])||0}return s.width=s.left+s.right,s.height=s.top+s.bottom,s}const mHe=(e,t,n)=>(e>0||t>0)&&(!n||!n.shadowRoot);function fHe(e,t){const n=e.touches,s=n&&n.length?n[0]:e,{offsetX:r,offsetY:i}=s;let o=!1,l,c;if(mHe(r,i,e.target))l=r,c=i;else{const u=t.getBoundingClientRect();l=s.clientX-u.left,c=s.clientY-u.top,o=!0}return{x:l,y:c,box:o}}function cu(e,t){if("native"in e)return e;const{canvas:n,currentDevicePixelRatio:s}=t,r=$1(n),i=r.boxSizing==="border-box",o=Ou(r,"padding"),l=Ou(r,"border","width"),{x:c,y:u,box:d}=fHe(e,n),h=o.left+(d&&l.left),p=o.top+(d&&l.top);let{width:x,height:b}=t;return i&&(x-=o.width+l.width,b-=o.height+l.height),{x:Math.round((c-h)/x*n.width/s),y:Math.round((u-p)/b*n.height/s)}}function hHe(e,t,n){let s,r;if(t===void 0||n===void 0){const i=e&&N3(e);if(!i)t=e.clientWidth,n=e.clientHeight;else{const o=i.getBoundingClientRect(),l=$1(i),c=Ou(l,"border","width"),u=Ou(l,"padding");t=o.width-u.width-c.width,n=o.height-u.height-c.height,s=rj(l.maxWidth,i,"clientWidth"),r=rj(l.maxHeight,i,"clientHeight")}}return{width:t,height:n,maxWidth:s||nj,maxHeight:r||nj}}const id=e=>Math.round(e*10)/10;function gHe(e,t,n,s){const r=$1(e),i=Ou(r,"margin"),o=rj(r.maxWidth,e,"clientWidth")||nj,l=rj(r.maxHeight,e,"clientHeight")||nj,c=hHe(e,t,n);let{width:u,height:d}=c;if(r.boxSizing==="content-box"){const p=Ou(r,"border","width"),x=Ou(r,"padding");u-=x.width+p.width,d-=x.height+p.height}return u=Math.max(0,u-i.width),d=Math.max(0,s?u/s:d-i.height),u=id(Math.min(u,o,c.maxWidth)),d=id(Math.min(d,l,c.maxHeight)),u&&!d&&(d=id(u/2)),(t!==void 0||n!==void 0)&&s&&c.height&&d>c.height&&(d=c.height,u=id(Math.floor(d*s))),{width:u,height:d}}function iB(e,t,n){const s=t||1,r=id(e.height*s),i=id(e.width*s);e.height=id(e.height),e.width=id(e.width);const o=e.canvas;return o.style&&(n||!o.style.height&&!o.style.width)&&(o.style.height=`${e.height}px`,o.style.width=`${e.width}px`),e.currentDevicePixelRatio!==s||o.height!==r||o.width!==i?(e.currentDevicePixelRatio=s,o.height=r,o.width=i,e.ctx.setTransform(s,0,0,s,0,0),!0):!1}const pHe=(function(){let e=!1;try{const t={get passive(){return e=!0,!1}};j3()&&(window.addEventListener("test",null,t),window.removeEventListener("test",null,t))}catch{}return e})();function oB(e,t){const n=dHe(e,t),s=n&&n.match(/^(\d+)(\.\d+)?px$/);return s?+s[1]:void 0}function du(e,t,n,s){return{x:e.x+n*(t.x-e.x),y:e.y+n*(t.y-e.y)}}function xHe(e,t,n,s){return{x:e.x+n*(t.x-e.x),y:s==="middle"?n<.5?e.y:t.y:s==="after"?n<1?e.y:t.y:n>0?t.y:e.y}}function yHe(e,t,n,s){const r={x:e.cp2x,y:e.cp2y},i={x:t.cp1x,y:t.cp1y},o=du(e,r,n),l=du(r,i,n),c=du(i,t,n),u=du(o,l,n),d=du(l,c,n);return du(u,d,n)}const bHe=function(e,t){return{x(n){return e+e+t-n},setWidth(n){t=n},textAlign(n){return n==="center"?n:n==="right"?"left":"right"},xPlus(n,s){return n-s},leftForLtr(n,s){return n-s}}},vHe=function(){return{x(e){return e},setWidth(e){},textAlign(e){return e},xPlus(e,t){return e+t},leftForLtr(e,t){return e}}};function kf(e,t,n){return e?bHe(t,n):vHe()}function JJ(e,t){let n,s;(t==="ltr"||t==="rtl")&&(n=e.canvas.style,s=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",t,"important"),e.prevTextDirection=s)}function eee(e,t){t!==void 0&&(delete e.prevTextDirection,e.canvas.style.setProperty("direction",t[0],t[1]))}function tee(e){return e==="angle"?{between:ax,compare:bBe,normalize:Ui}:{between:rd,compare:(t,n)=>t-n,normalize:t=>t}}function lB({start:e,end:t,count:n,loop:s,style:r}){return{start:e%n,end:t%n,loop:s&&(t-e+1)%n===0,style:r}}function wHe(e,t,n){const{property:s,start:r,end:i}=n,{between:o,normalize:l}=tee(s),c=t.length;let{start:u,end:d,loop:h}=e,p,x;if(h){for(u+=c,d+=c,p=0,x=c;p<x&&o(l(t[u%c][s]),r,i);++p)u--,d--;u%=c,d%=c}return d<u&&(d+=c),{start:u,end:d,loop:h,style:e.style}}function jHe(e,t,n){if(!n)return[e];const{property:s,start:r,end:i}=n,o=t.length,{compare:l,between:c,normalize:u}=tee(s),{start:d,end:h,loop:p,style:x}=wHe(e,t,n),b=[];let j=!1,y=null,N,w,S;const _=()=>c(r,S,N)&&l(r,S)!==0,T=()=>l(i,N)===0||c(i,S,N),k=()=>j||_(),A=()=>!j||T();for(let E=d,M=d;E<=h;++E)w=t[E%o],!w.skip&&(N=u(w[s]),N!==S&&(j=c(N,r,i),y===null&&k()&&(y=l(N,r)===0?E:M),y!==null&&A()&&(b.push(lB({start:y,end:E,loop:p,count:o,style:x})),y=null),M=E,S=N));return y!==null&&b.push(lB({start:y,end:h,loop:p,count:o,style:x})),b}function NHe(e,t){const n=[],s=e.segments;for(let r=0;r<s.length;r++){const i=jHe(s[r],e.points,t);i.length&&n.push(...i)}return n}function CHe(e,t,n,s){let r=0,i=t-1;if(n&&!s)for(;r<t&&!e[r].skip;)r++;for(;r<t&&e[r].skip;)r++;for(r%=t,n&&(i+=r);i>r&&e[i%t].skip;)i--;return i%=t,{start:r,end:i}}function SHe(e,t,n,s){const r=e.length,i=[];let o=t,l=e[t],c;for(c=t+1;c<=n;++c){const u=e[c%r];u.skip||u.stop?l.skip||(s=!1,i.push({start:t%r,end:(c-1)%r,loop:s}),t=o=u.stop?c:null):(o=c,l.skip&&(t=c)),l=u}return o!==null&&i.push({start:t%r,end:o%r,loop:s}),i}function _He(e,t){const n=e.points,s=e.options.spanGaps,r=n.length;if(!r)return[];const i=!!e._loop,{start:o,end:l}=CHe(n,r,i,s);if(s===!0)return cB(e,[{start:o,end:l,loop:i}],n,t);const c=l<o?l+r:l,u=!!e._fullLoop&&o===0&&l===r-1;return cB(e,SHe(n,o,c,u),n,t)}function cB(e,t,n,s){return!s||!s.setContext||!n?t:AHe(e,t,n,s)}function AHe(e,t,n,s){const r=e._chart.getContext(),i=dB(e.options),{_datasetIndex:o,options:{spanGaps:l}}=e,c=n.length,u=[];let d=i,h=t[0].start,p=h;function x(b,j,y,N){const w=l?-1:1;if(b!==j){for(b+=c;n[b%c].skip;)b-=w;for(;n[j%c].skip;)j+=w;b%c!==j%c&&(u.push({start:b%c,end:j%c,loop:y,style:N}),d=N,h=j%c)}}for(const b of t){h=l?h:b.start;let j=n[h%c],y;for(p=h+1;p<=b.end;p++){const N=n[p%c];y=dB(s.setContext(hm(r,{type:"segment",p0:j,p1:N,p0DataIndex:(p-1)%c,p1DataIndex:p%c,datasetIndex:o}))),THe(y,d)&&x(h,p-1,b.loop,d),j=N,d=y}h<p-1&&x(h,p-1,b.loop,d)}return u}function dB(e){return{backgroundColor:e.backgroundColor,borderCapStyle:e.borderCapStyle,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderJoinStyle:e.borderJoinStyle,borderWidth:e.borderWidth,borderColor:e.borderColor}}function THe(e,t){if(!t)return!1;const n=[],s=function(r,i){return h3(i)?(n.includes(i)||n.push(i),n.indexOf(i)):i};return JSON.stringify(e,s)!==JSON.stringify(t,s)}function Wb(e,t,n){return e.options.clip?e[n]:t[n]}function kHe(e,t){const{xScale:n,yScale:s}=e;return n&&s?{left:Wb(n,t,"left"),right:Wb(n,t,"right"),top:Wb(s,t,"top"),bottom:Wb(s,t,"bottom")}:t}function EHe(e,t){const n=t._clip;if(n.disabled)return!1;const s=kHe(t,e.chartArea);return{left:n.left===!1?0:s.left-(n.left===!0?0:n.left),right:n.right===!1?e.width:s.right+(n.right===!0?0:n.right),top:n.top===!1?0:s.top-(n.top===!0?0:n.top),bottom:n.bottom===!1?e.height:s.bottom+(n.bottom===!0?0:n.bottom)}}class LHe{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,n,s,r){const i=n.listeners[r],o=n.duration;i.forEach(l=>l({chart:t,initial:n.initial,numSteps:o,currentStep:Math.min(s-n.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=HJ.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(t=Date.now()){let n=0;this._charts.forEach((s,r)=>{if(!s.running||!s.items.length)return;const i=s.items;let o=i.length-1,l=!1,c;for(;o>=0;--o)c=i[o],c._active?(c._total>s.duration&&(s.duration=c._total),c.tick(t),l=!0):(i[o]=i[i.length-1],i.pop());l&&(r.draw(),this._notify(r,s,t,"progress")),i.length||(s.running=!1,this._notify(r,s,t,"complete"),s.initial=!1),n+=i.length}),this._lastDate=t,n===0&&(this._running=!1)}_getAnims(t){const n=this._charts;let s=n.get(t);return s||(s={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},n.set(t,s)),s}listen(t,n,s){this._getAnims(t).listeners[n].push(s)}add(t,n){!n||!n.length||this._getAnims(t).items.push(...n)}has(t){return this._getAnims(t).items.length>0}start(t){const n=this._charts.get(t);n&&(n.running=!0,n.start=Date.now(),n.duration=n.items.reduce((s,r)=>Math.max(s,r._duration),0),this._refresh())}running(t){if(!this._running)return!1;const n=this._charts.get(t);return!(!n||!n.running||!n.items.length)}stop(t){const n=this._charts.get(t);if(!n||!n.items.length)return;const s=n.items;let r=s.length-1;for(;r>=0;--r)s[r].cancel();n.items=[],this._notify(t,n,Date.now(),"complete")}remove(t){return this._charts.delete(t)}}var Cl=new LHe;const uB="transparent",DHe={boolean(e,t,n){return n>.5?t:e},color(e,t,n){const s=eB(e||uB),r=s.valid&&eB(t||uB);return r&&r.valid?r.mix(s,n).hexString():t},number(e,t,n){return e+(t-e)*n}};class PHe{constructor(t,n,s,r){const i=n[s];r=qb([t.to,r,i,t.from]);const o=qb([t.from,i,r]);this._active=!0,this._fn=t.fn||DHe[t.type||typeof o],this._easing=xp[t.easing]||xp.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=n,this._prop=s,this._from=o,this._to=r,this._promises=void 0}active(){return this._active}update(t,n,s){if(this._active){this._notify(!1);const r=this._target[this._prop],i=s-this._start,o=this._duration-i;this._start=s,this._duration=Math.floor(Math.max(o,t.duration)),this._total+=i,this._loop=!!t.loop,this._to=qb([t.to,n,r,t.from]),this._from=qb([t.from,r,n])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(t){const n=t-this._start,s=this._duration,r=this._prop,i=this._from,o=this._loop,l=this._to;let c;if(this._active=i!==l&&(o||n<s),!this._active){this._target[r]=l,this._notify(!0);return}if(n<0){this._target[r]=i;return}c=n/s%2,c=o&&c>1?2-c:c,c=this._easing(Math.min(1,Math.max(0,c))),this._target[r]=this._fn(i,l,c)}wait(){const t=this._promises||(this._promises=[]);return new Promise((n,s)=>{t.push({res:n,rej:s})})}_notify(t){const n=t?"res":"rej",s=this._promises||[];for(let r=0;r<s.length;r++)s[r][n]()}}class aee{constructor(t,n){this._chart=t,this._properties=new Map,this.configure(n)}configure(t){if(!Na(t))return;const n=Object.keys(On.animation),s=this._properties;Object.getOwnPropertyNames(t).forEach(r=>{const i=t[r];if(!Na(i))return;const o={};for(const l of n)o[l]=i[l];(is(i.properties)&&i.properties||[r]).forEach(l=>{(l===r||!s.has(l))&&s.set(l,o)})})}_animateOptions(t,n){const s=n.options,r=MHe(t,s);if(!r)return[];const i=this._createAnimations(r,s);return s.$shared&&OHe(t.options.$animations,s).then(()=>{t.options=s},()=>{}),i}_createAnimations(t,n){const s=this._properties,r=[],i=t.$animations||(t.$animations={}),o=Object.keys(n),l=Date.now();let c;for(c=o.length-1;c>=0;--c){const u=o[c];if(u.charAt(0)==="$")continue;if(u==="options"){r.push(...this._animateOptions(t,n));continue}const d=n[u];let h=i[u];const p=s.get(u);if(h)if(p&&h.active()){h.update(p,d,l);continue}else h.cancel();if(!p||!p.duration){t[u]=d;continue}i[u]=h=new PHe(p,t,u,d),r.push(h)}return r}update(t,n){if(this._properties.size===0){Object.assign(t,n);return}const s=this._createAnimations(t,n);if(s.length)return Cl.add(this._chart,s),!0}}function OHe(e,t){const n=[],s=Object.keys(t);for(let r=0;r<s.length;r++){const i=e[s[r]];i&&i.active()&&n.push(i.wait())}return Promise.all(n)}function MHe(e,t){if(!t)return;let n=e.options;if(!n){e.options=t;return}return n.$shared&&(e.options=n=Object.assign({},n,{$shared:!1,$animations:{}})),n}function mB(e,t){const n=e&&e.options||{},s=n.reverse,r=n.min===void 0?t:0,i=n.max===void 0?t:0;return{start:s?i:r,end:s?r:i}}function IHe(e,t,n){if(n===!1)return!1;const s=mB(e,n),r=mB(t,n);return{top:r.end,right:s.end,bottom:r.start,left:s.start}}function $He(e){let t,n,s,r;return Na(e)?(t=e.top,n=e.right,s=e.bottom,r=e.left):t=n=s=r=e,{top:t,right:n,bottom:s,left:r,disabled:e===!1}}function nee(e,t){const n=[],s=e._getSortedDatasetMetas(t);let r,i;for(r=0,i=s.length;r<i;++r)n.push(s[r].index);return n}function fB(e,t,n,s={}){const r=e.keys,i=s.mode==="single";let o,l,c,u;if(t===null)return;let d=!1;for(o=0,l=r.length;o<l;++o){if(c=+r[o],c===n){if(d=!0,s.all)continue;break}u=e.values[c],Ci(u)&&(i||t===0||Fo(t)===Fo(u))&&(t+=u)}return!d&&!s.all?0:t}function RHe(e,t){const{iScale:n,vScale:s}=t,r=n.axis==="x"?"x":"y",i=s.axis==="x"?"x":"y",o=Object.keys(e),l=new Array(o.length);let c,u,d;for(c=0,u=o.length;c<u;++c)d=o[c],l[c]={[r]:d,[i]:e[d]};return l}function wT(e,t){const n=e&&e.options.stacked;return n||n===void 0&&t.stack!==void 0}function zHe(e,t,n){return`${e.id}.${t.id}.${n.stack||n.type}`}function FHe(e){const{min:t,max:n,minDefined:s,maxDefined:r}=e.getUserBounds();return{min:s?t:Number.NEGATIVE_INFINITY,max:r?n:Number.POSITIVE_INFINITY}}function UHe(e,t,n){const s=e[t]||(e[t]={});return s[n]||(s[n]={})}function hB(e,t,n,s){for(const r of t.getMatchingVisibleMetas(s).reverse()){const i=e[r.index];if(n&&i>0||!n&&i<0)return r.index}return null}function gB(e,t){const{chart:n,_cachedMeta:s}=e,r=n._stacks||(n._stacks={}),{iScale:i,vScale:o,index:l}=s,c=i.axis,u=o.axis,d=zHe(i,o,s),h=t.length;let p;for(let x=0;x<h;++x){const b=t[x],{[c]:j,[u]:y}=b,N=b._stacks||(b._stacks={});p=N[u]=UHe(r,d,j),p[l]=y,p._top=hB(p,o,!0,s.type),p._bottom=hB(p,o,!1,s.type);const w=p._visualValues||(p._visualValues={});w[l]=y}}function jT(e,t){const n=e.scales;return Object.keys(n).filter(s=>n[s].axis===t).shift()}function BHe(e,t){return hm(e,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}function HHe(e,t,n){return hm(e,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:n,index:t,mode:"default",type:"data"})}function Ig(e,t){const n=e.controller.index,s=e.vScale&&e.vScale.axis;if(s){t=t||e._parsed;for(const r of t){const i=r._stacks;if(!i||i[s]===void 0||i[s][n]===void 0)return;delete i[s][n],i[s]._visualValues!==void 0&&i[s]._visualValues[n]!==void 0&&delete i[s]._visualValues[n]}}}const NT=e=>e==="reset"||e==="none",pB=(e,t)=>t?e:Object.assign({},e),qHe=(e,t,n)=>e&&!t.hidden&&t._stacked&&{keys:nee(n,!0),values:null};class R1{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(t,n){this.chart=t,this._ctx=t.ctx,this.index=n,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const t=this._cachedMeta;this.configure(),this.linkScales(),t._stacked=wT(t.vScale,t),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(t){this.index!==t&&Ig(this._cachedMeta),this.index=t}linkScales(){const t=this.chart,n=this._cachedMeta,s=this.getDataset(),r=(h,p,x,b)=>h==="x"?p:h==="r"?b:x,i=n.xAxisID=ma(s.xAxisID,jT(t,"x")),o=n.yAxisID=ma(s.yAxisID,jT(t,"y")),l=n.rAxisID=ma(s.rAxisID,jT(t,"r")),c=n.indexAxis,u=n.iAxisID=r(c,i,o,l),d=n.vAxisID=r(c,o,i,l);n.xScale=this.getScaleForId(i),n.yScale=this.getScaleForId(o),n.rScale=this.getScaleForId(l),n.iScale=this.getScaleForId(u),n.vScale=this.getScaleForId(d)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(t){return this.chart.scales[t]}_getOtherScale(t){const n=this._cachedMeta;return t===n.iScale?n.vScale:n.iScale}reset(){this._update("reset")}_destroy(){const t=this._cachedMeta;this._data&&X8(this._data,this),t._stacked&&Ig(t)}_dataCheck(){const t=this.getDataset(),n=t.data||(t.data=[]),s=this._data;if(Na(n)){const r=this._cachedMeta;this._data=RHe(n,r)}else if(s!==n){if(s){X8(s,this);const r=this._cachedMeta;Ig(r),r._parsed=[]}n&&Object.isExtensible(n)&&NBe(n,this),this._syncList=[],this._data=n}}addElements(){const t=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(t.dataset=new this.datasetElementType)}buildOrUpdateElements(t){const n=this._cachedMeta,s=this.getDataset();let r=!1;this._dataCheck();const i=n._stacked;n._stacked=wT(n.vScale,n),n.stack!==s.stack&&(r=!0,Ig(n),n.stack=s.stack),this._resyncElements(t),(r||i!==n._stacked)&&(gB(this,n._parsed),n._stacked=wT(n.vScale,n))}configure(){const t=this.chart.config,n=t.datasetScopeKeys(this._type),s=t.getOptionScopes(this.getDataset(),n,!0);this.options=t.createResolver(s,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(t,n){const{_cachedMeta:s,_data:r}=this,{iScale:i,_stacked:o}=s,l=i.axis;let c=t===0&&n===r.length?!0:s._sorted,u=t>0&&s._parsed[t-1],d,h,p;if(this._parsing===!1)s._parsed=r,s._sorted=!0,p=r;else{is(r[t])?p=this.parseArrayData(s,r,t,n):Na(r[t])?p=this.parseObjectData(s,r,t,n):p=this.parsePrimitiveData(s,r,t,n);const x=()=>h[l]===null||u&&h[l]<u[l];for(d=0;d<n;++d)s._parsed[d+t]=h=p[d],c&&(x()&&(c=!1),u=h);s._sorted=c}o&&gB(this,p)}parsePrimitiveData(t,n,s,r){const{iScale:i,vScale:o}=t,l=i.axis,c=o.axis,u=i.getLabels(),d=i===o,h=new Array(r);let p,x,b;for(p=0,x=r;p<x;++p)b=p+s,h[p]={[l]:d||i.parse(u[b],b),[c]:o.parse(n[b],b)};return h}parseArrayData(t,n,s,r){const{xScale:i,yScale:o}=t,l=new Array(r);let c,u,d,h;for(c=0,u=r;c<u;++c)d=c+s,h=n[d],l[c]={x:i.parse(h[0],d),y:o.parse(h[1],d)};return l}parseObjectData(t,n,s,r){const{xScale:i,yScale:o}=t,{xAxisKey:l="x",yAxisKey:c="y"}=this._parsing,u=new Array(r);let d,h,p,x;for(d=0,h=r;d<h;++d)p=d+s,x=n[p],u[d]={x:i.parse(em(x,l),p),y:o.parse(em(x,c),p)};return u}getParsed(t){return this._cachedMeta._parsed[t]}getDataElement(t){return this._cachedMeta.data[t]}applyStack(t,n,s){const r=this.chart,i=this._cachedMeta,o=n[t.axis],l={keys:nee(r,!0),values:n._stacks[t.axis]._visualValues};return fB(l,o,i.index,{mode:s})}updateRangeFromParsed(t,n,s,r){const i=s[n.axis];let o=i===null?NaN:i;const l=r&&s._stacks[n.axis];r&&l&&(r.values=l,o=fB(r,i,this._cachedMeta.index)),t.min=Math.min(t.min,o),t.max=Math.max(t.max,o)}getMinMax(t,n){const s=this._cachedMeta,r=s._parsed,i=s._sorted&&t===s.iScale,o=r.length,l=this._getOtherScale(t),c=qHe(n,s,this.chart),u={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:d,max:h}=FHe(l);let p,x;function b(){x=r[p];const j=x[l.axis];return!Ci(x[t.axis])||d>j||h<j}for(p=0;p<o&&!(!b()&&(this.updateRangeFromParsed(u,t,x,c),i));++p);if(i){for(p=o-1;p>=0;--p)if(!b()){this.updateRangeFromParsed(u,t,x,c);break}}return u}getAllParsedValues(t){const n=this._cachedMeta._parsed,s=[];let r,i,o;for(r=0,i=n.length;r<i;++r)o=n[r][t.axis],Ci(o)&&s.push(o);return s}getMaxOverflow(){return!1}getLabelAndValue(t){const n=this._cachedMeta,s=n.iScale,r=n.vScale,i=this.getParsed(t);return{label:s?""+s.getLabelForValue(i[s.axis]):"",value:r?""+r.getLabelForValue(i[r.axis]):""}}_update(t){const n=this._cachedMeta;this.update(t||"default"),n._clip=$He(ma(this.options.clip,IHe(n.xScale,n.yScale,this.getMaxOverflow())))}update(t){}draw(){const t=this._ctx,n=this.chart,s=this._cachedMeta,r=s.data||[],i=n.chartArea,o=[],l=this._drawStart||0,c=this._drawCount||r.length-l,u=this.options.drawActiveElementsOnTop;let d;for(s.dataset&&s.dataset.draw(t,i,l,c),d=l;d<l+c;++d){const h=r[d];h.hidden||(h.active&&u?o.push(h):h.draw(t,i))}for(d=0;d<o.length;++d)o[d].draw(t,i)}getStyle(t,n){const s=n?"active":"default";return t===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(s):this.resolveDataElementOptions(t||0,s)}getContext(t,n,s){const r=this.getDataset();let i;if(t>=0&&t<this._cachedMeta.data.length){const o=this._cachedMeta.data[t];i=o.$context||(o.$context=HHe(this.getContext(),t,o)),i.parsed=this.getParsed(t),i.raw=r.data[t],i.index=i.dataIndex=t}else i=this.$context||(this.$context=BHe(this.chart.getContext(),this.index)),i.dataset=r,i.index=i.datasetIndex=this.index;return i.active=!!n,i.mode=s,i}resolveDatasetElementOptions(t){return this._resolveElementOptions(this.datasetElementType.id,t)}resolveDataElementOptions(t,n){return this._resolveElementOptions(this.dataElementType.id,n,t)}_resolveElementOptions(t,n="default",s){const r=n==="active",i=this._cachedDataOpts,o=t+"-"+n,l=i[o],c=this.enableOptionSharing&&ex(s);if(l)return pB(l,c);const u=this.chart.config,d=u.datasetElementScopeKeys(this._type,t),h=r?[`${t}Hover`,"hover",t,""]:[t,""],p=u.getOptionScopes(this.getDataset(),d),x=Object.keys(On.elements[t]),b=()=>this.getContext(s,r,n),j=u.resolveNamedOptions(p,x,b,h);return j.$shared&&(j.$shared=c,i[o]=Object.freeze(pB(j,c))),j}_resolveAnimations(t,n,s){const r=this.chart,i=this._cachedDataOpts,o=`animation-${n}`,l=i[o];if(l)return l;let c;if(r.options.animation!==!1){const d=this.chart.config,h=d.datasetAnimationScopeKeys(this._type,n),p=d.getOptionScopes(this.getDataset(),h);c=d.createResolver(p,this.getContext(t,s,n))}const u=new aee(r,c&&c.animations);return c&&c._cacheable&&(i[o]=Object.freeze(u)),u}getSharedOptions(t){if(t.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},t))}includeOptions(t,n){return!n||NT(t)||this.chart._animationsDisabled}_getSharedOptions(t,n){const s=this.resolveDataElementOptions(t,n),r=this._sharedOptions,i=this.getSharedOptions(s),o=this.includeOptions(n,i)||i!==r;return this.updateSharedOptions(i,n,s),{sharedOptions:i,includeOptions:o}}updateElement(t,n,s,r){NT(r)?Object.assign(t,s):this._resolveAnimations(n,r).update(t,s)}updateSharedOptions(t,n,s){t&&!NT(n)&&this._resolveAnimations(void 0,n).update(t,s)}_setStyle(t,n,s,r){t.active=r;const i=this.getStyle(n,r);this._resolveAnimations(n,s,r).update(t,{options:!r&&this.getSharedOptions(i)||i})}removeHoverStyle(t,n,s){this._setStyle(t,s,"active",!1)}setHoverStyle(t,n,s){this._setStyle(t,s,"active",!0)}_removeDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!1)}_setDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!0)}_resyncElements(t){const n=this._data,s=this._cachedMeta.data;for(const[l,c,u]of this._syncList)this[l](c,u);this._syncList=[];const r=s.length,i=n.length,o=Math.min(i,r);o&&this.parse(0,o),i>r?this._insertElements(r,i-r,t):i<r&&this._removeElements(i,r-i)}_insertElements(t,n,s=!0){const r=this._cachedMeta,i=r.data,o=t+n;let l;const c=u=>{for(u.length+=n,l=u.length-1;l>=o;l--)u[l]=u[l-n]};for(c(i),l=t;l<o;++l)i[l]=new this.dataElementType;this._parsing&&c(r._parsed),this.parse(t,n),s&&this.updateElements(i,t,n,"reset")}updateElements(t,n,s,r){}_removeElements(t,n){const s=this._cachedMeta;if(this._parsing){const r=s._parsed.splice(t,n);s._stacked&&Ig(s,r)}s.data.splice(t,n)}_sync(t){if(this._parsing)this._syncList.push(t);else{const[n,s,r]=t;this[n](s,r)}this.chart._dataChanges.push([this.index,...t])}_onDataPush(){const t=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-t,t])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(t,n){n&&this._sync(["_removeElements",t,n]);const s=arguments.length-2;s&&this._sync(["_insertElements",t,s])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}function GHe(e,t){if(!e._cache.$bar){const n=e.getMatchingVisibleMetas(t);let s=[];for(let r=0,i=n.length;r<i;r++)s=s.concat(n[r].controller.getAllParsedValues(e));e._cache.$bar=BJ(s.sort((r,i)=>r-i))}return e._cache.$bar}function WHe(e){const t=e.iScale,n=GHe(t,e.type);let s=t._length,r,i,o,l;const c=()=>{o===32767||o===-32768||(ex(l)&&(s=Math.min(s,Math.abs(o-l)||s)),l=o)};for(r=0,i=n.length;r<i;++r)o=t.getPixelForValue(n[r]),c();for(l=void 0,r=0,i=t.ticks.length;r<i;++r)o=t.getPixelForTick(r),c();return s}function VHe(e,t,n,s){const r=n.barThickness;let i,o;return Pa(r)?(i=t.min*n.categoryPercentage,o=n.barPercentage):(i=r*s,o=1),{chunk:i/s,ratio:o,start:t.pixels[e]-i/2}}function YHe(e,t,n,s){const r=t.pixels,i=r[e];let o=e>0?r[e-1]:null,l=e<r.length-1?r[e+1]:null;const c=n.categoryPercentage;o===null&&(o=i-(l===null?t.end-t.start:l-i)),l===null&&(l=i+i-o);const u=i-(i-Math.min(o,l))/2*c;return{chunk:Math.abs(l-o)/2*c/s,ratio:n.barPercentage,start:u}}function QHe(e,t,n,s){const r=n.parse(e[0],s),i=n.parse(e[1],s),o=Math.min(r,i),l=Math.max(r,i);let c=o,u=l;Math.abs(o)>Math.abs(l)&&(c=l,u=o),t[n.axis]=u,t._custom={barStart:c,barEnd:u,start:r,end:i,min:o,max:l}}function see(e,t,n,s){return is(e)?QHe(e,t,n,s):t[n.axis]=n.parse(e,s),t}function xB(e,t,n,s){const r=e.iScale,i=e.vScale,o=r.getLabels(),l=r===i,c=[];let u,d,h,p;for(u=n,d=n+s;u<d;++u)p=t[u],h={},h[r.axis]=l||r.parse(o[u],u),c.push(see(p,h,i,u));return c}function CT(e){return e&&e.barStart!==void 0&&e.barEnd!==void 0}function KHe(e,t,n){return e!==0?Fo(e):(t.isHorizontal()?1:-1)*(t.min>=n?1:-1)}function XHe(e){let t,n,s,r,i;return e.horizontal?(t=e.base>e.x,n="left",s="right"):(t=e.base<e.y,n="bottom",s="top"),t?(r="end",i="start"):(r="start",i="end"),{start:n,end:s,reverse:t,top:r,bottom:i}}function ZHe(e,t,n,s){let r=t.borderSkipped;const i={};if(!r){e.borderSkipped=i;return}if(r===!0){e.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:o,end:l,reverse:c,top:u,bottom:d}=XHe(e);r==="middle"&&n&&(e.enableBorderRadius=!0,(n._top||0)===s?r=u:(n._bottom||0)===s?r=d:(i[yB(d,o,l,c)]=!0,r=u)),i[yB(r,o,l,c)]=!0,e.borderSkipped=i}function yB(e,t,n,s){return s?(e=JHe(e,t,n),e=bB(e,n,t)):e=bB(e,t,n),e}function JHe(e,t,n){return e===t?n:e===n?t:e}function bB(e,t,n){return e==="start"?t:e==="end"?n:e}function e9e(e,{inflateAmount:t},n){e.inflateAmount=t==="auto"?n===1?.33:0:t}class t9e extends R1{static id="bar";static defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};static overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};parsePrimitiveData(t,n,s,r){return xB(t,n,s,r)}parseArrayData(t,n,s,r){return xB(t,n,s,r)}parseObjectData(t,n,s,r){const{iScale:i,vScale:o}=t,{xAxisKey:l="x",yAxisKey:c="y"}=this._parsing,u=i.axis==="x"?l:c,d=o.axis==="x"?l:c,h=[];let p,x,b,j;for(p=s,x=s+r;p<x;++p)j=n[p],b={},b[i.axis]=i.parse(em(j,u),p),h.push(see(em(j,d),b,o,p));return h}updateRangeFromParsed(t,n,s,r){super.updateRangeFromParsed(t,n,s,r);const i=s._custom;i&&n===this._cachedMeta.vScale&&(t.min=Math.min(t.min,i.min),t.max=Math.max(t.max,i.max))}getMaxOverflow(){return 0}getLabelAndValue(t){const n=this._cachedMeta,{iScale:s,vScale:r}=n,i=this.getParsed(t),o=i._custom,l=CT(o)?"["+o.start+", "+o.end+"]":""+r.getLabelForValue(i[r.axis]);return{label:""+s.getLabelForValue(i[s.axis]),value:l}}initialize(){this.enableOptionSharing=!0,super.initialize();const t=this._cachedMeta;t.stack=this.getDataset().stack}update(t){const n=this._cachedMeta;this.updateElements(n.data,0,n.data.length,t)}updateElements(t,n,s,r){const i=r==="reset",{index:o,_cachedMeta:{vScale:l}}=this,c=l.getBasePixel(),u=l.isHorizontal(),d=this._getRuler(),{sharedOptions:h,includeOptions:p}=this._getSharedOptions(n,r);for(let x=n;x<n+s;x++){const b=this.getParsed(x),j=i||Pa(b[l.axis])?{base:c,head:c}:this._calculateBarValuePixels(x),y=this._calculateBarIndexPixels(x,d),N=(b._stacks||{})[l.axis],w={horizontal:u,base:j.base,enableBorderRadius:!N||CT(b._custom)||o===N._top||o===N._bottom,x:u?j.head:y.center,y:u?y.center:j.head,height:u?y.size:Math.abs(j.size),width:u?Math.abs(j.size):y.size};p&&(w.options=h||this.resolveDataElementOptions(x,t[x].active?"active":r));const S=w.options||t[x].options;ZHe(w,S,N,o),e9e(w,S,d.ratio),this.updateElement(t[x],x,w,r)}}_getStacks(t,n){const{iScale:s}=this._cachedMeta,r=s.getMatchingVisibleMetas(this._type).filter(d=>d.controller.options.grouped),i=s.options.stacked,o=[],l=this._cachedMeta.controller.getParsed(n),c=l&&l[s.axis],u=d=>{const h=d._parsed.find(x=>x[s.axis]===c),p=h&&h[d.vScale.axis];if(Pa(p)||isNaN(p))return!0};for(const d of r)if(!(n!==void 0&&u(d))&&((i===!1||o.indexOf(d.stack)===-1||i===void 0&&d.stack===void 0)&&o.push(d.stack),d.index===t))break;return o.length||o.push(void 0),o}_getStackCount(t){return this._getStacks(void 0,t).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const t=this.chart.scales,n=this.chart.options.indexAxis;return Object.keys(t).filter(s=>t[s].axis===n).shift()}_getAxis(){const t={},n=this.getFirstScaleIdForIndexAxis();for(const s of this.chart.data.datasets)t[ma(this.chart.options.indexAxis==="x"?s.xAxisID:s.yAxisID,n)]=!0;return Object.keys(t)}_getStackIndex(t,n,s){const r=this._getStacks(t,s),i=n!==void 0?r.indexOf(n):-1;return i===-1?r.length-1:i}_getRuler(){const t=this.options,n=this._cachedMeta,s=n.iScale,r=[];let i,o;for(i=0,o=n.data.length;i<o;++i)r.push(s.getPixelForValue(this.getParsed(i)[s.axis],i));const l=t.barThickness;return{min:l||WHe(n),pixels:r,start:s._startPixel,end:s._endPixel,stackCount:this._getStackCount(),scale:s,grouped:t.grouped,ratio:l?1:t.categoryPercentage*t.barPercentage}}_calculateBarValuePixels(t){const{_cachedMeta:{vScale:n,_stacked:s,index:r},options:{base:i,minBarLength:o}}=this,l=i||0,c=this.getParsed(t),u=c._custom,d=CT(u);let h=c[n.axis],p=0,x=s?this.applyStack(n,c,s):h,b,j;x!==h&&(p=x-h,x=h),d&&(h=u.barStart,x=u.barEnd-u.barStart,h!==0&&Fo(h)!==Fo(u.barEnd)&&(p=0),p+=h);const y=!Pa(i)&&!d?i:p;let N=n.getPixelForValue(y);if(this.chart.getDataVisibility(t)?b=n.getPixelForValue(p+x):b=N,j=b-N,Math.abs(j)<o){j=KHe(j,n,l)*o,h===l&&(N-=j/2);const w=n.getPixelForDecimal(0),S=n.getPixelForDecimal(1),_=Math.min(w,S),T=Math.max(w,S);N=Math.max(Math.min(N,T),_),b=N+j,s&&!d&&(c._stacks[n.axis]._visualValues[r]=n.getValueForPixel(b)-n.getValueForPixel(N))}if(N===n.getPixelForValue(l)){const w=Fo(j)*n.getLineWidthForValue(l)/2;N+=w,j-=w}return{size:j,base:N,head:b,center:b+j/2}}_calculateBarIndexPixels(t,n){const s=n.scale,r=this.options,i=r.skipNull,o=ma(r.maxBarThickness,1/0);let l,c;const u=this._getAxisCount();if(n.grouped){const d=i?this._getStackCount(t):n.stackCount,h=r.barThickness==="flex"?YHe(t,n,r,d*u):VHe(t,n,r,d*u),p=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,x=this._getAxis().indexOf(ma(p,this.getFirstScaleIdForIndexAxis())),b=this._getStackIndex(this.index,this._cachedMeta.stack,i?t:void 0)+x;l=h.start+h.chunk*b+h.chunk/2,c=Math.min(o,h.chunk*h.ratio)}else l=s.getPixelForValue(this.getParsed(t)[s.axis],t),c=Math.min(o,n.min*n.ratio);return{base:l-c/2,head:l+c/2,center:l,size:c}}draw(){const t=this._cachedMeta,n=t.vScale,s=t.data,r=s.length;let i=0;for(;i<r;++i)this.getParsed(i)[n.axis]!==null&&!s[i].hidden&&s[i].draw(this._ctx)}}function a9e(e,t,n){let s=1,r=1,i=0,o=0;if(t<_n){const l=e,c=l+t,u=Math.cos(l),d=Math.sin(l),h=Math.cos(c),p=Math.sin(c),x=(S,_,T)=>ax(S,l,c,!0)?1:Math.max(_,_*n,T,T*n),b=(S,_,T)=>ax(S,l,c,!0)?-1:Math.min(_,_*n,T,T*n),j=x(0,u,h),y=x(os,d,p),N=b(Fa,u,h),w=b(Fa+os,d,p);s=(j-N)/2,r=(y-w)/2,i=-(j+N)/2,o=-(y+w)/2}return{ratioX:s,ratioY:r,offsetX:i,offsetY:o}}class n9e extends R1{static id="doughnut";static defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};static descriptors={_scriptable:t=>t!=="spacing",_indexable:t=>t!=="spacing"&&!t.startsWith("borderDash")&&!t.startsWith("hoverBorderDash")};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const n=t.data,{labels:{pointStyle:s,textAlign:r,color:i,useBorderRadius:o,borderRadius:l}}=t.legend.options;return n.labels.length&&n.datasets.length?n.labels.map((c,u)=>{const h=t.getDatasetMeta(0).controller.getStyle(u);return{text:c,fillStyle:h.backgroundColor,fontColor:i,hidden:!t.getDataVisibility(u),lineDash:h.borderDash,lineDashOffset:h.borderDashOffset,lineJoin:h.borderJoinStyle,lineWidth:h.borderWidth,strokeStyle:h.borderColor,textAlign:r,pointStyle:s,borderRadius:o&&(l||h.borderRadius),index:u}}):[]}},onClick(t,n,s){s.chart.toggleDataVisibility(n.index),s.chart.update()}}}};constructor(t,n){super(t,n),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(t,n){const s=this.getDataset().data,r=this._cachedMeta;if(this._parsing===!1)r._parsed=s;else{let i=c=>+s[c];if(Na(s[t])){const{key:c="value"}=this._parsing;i=u=>+em(s[u],c)}let o,l;for(o=t,l=t+n;o<l;++o)r._parsed[o]=i(o)}}_getRotation(){return Pl(this.options.rotation-90)}_getCircumference(){return Pl(this.options.circumference)}_getRotationExtents(){let t=_n,n=-_n;for(let s=0;s<this.chart.data.datasets.length;++s)if(this.chart.isDatasetVisible(s)&&this.chart.getDatasetMeta(s).type===this._type){const r=this.chart.getDatasetMeta(s).controller,i=r._getRotation(),o=r._getCircumference();t=Math.min(t,i),n=Math.max(n,i+o)}return{rotation:t,circumference:n-t}}update(t){const n=this.chart,{chartArea:s}=n,r=this._cachedMeta,i=r.data,o=this.getMaxBorderWidth()+this.getMaxOffset(i)+this.options.spacing,l=Math.max((Math.min(s.width,s.height)-o)/2,0),c=Math.min(iBe(this.options.cutout,l),1),u=this._getRingWeight(this.index),{circumference:d,rotation:h}=this._getRotationExtents(),{ratioX:p,ratioY:x,offsetX:b,offsetY:j}=a9e(h,d,c),y=(s.width-o)/p,N=(s.height-o)/x,w=Math.max(Math.min(y,N)/2,0),S=$J(this.options.radius,w),_=Math.max(S*c,0),T=(S-_)/this._getVisibleDatasetWeightTotal();this.offsetX=b*S,this.offsetY=j*S,r.total=this.calculateTotal(),this.outerRadius=S-T*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-T*u,0),this.updateElements(i,0,i.length,t)}_circumference(t,n){const s=this.options,r=this._cachedMeta,i=this._getCircumference();return n&&s.animation.animateRotate||!this.chart.getDataVisibility(t)||r._parsed[t]===null||r.data[t].hidden?0:this.calculateCircumference(r._parsed[t]*i/_n)}updateElements(t,n,s,r){const i=r==="reset",o=this.chart,l=o.chartArea,u=o.options.animation,d=(l.left+l.right)/2,h=(l.top+l.bottom)/2,p=i&&u.animateScale,x=p?0:this.innerRadius,b=p?0:this.outerRadius,{sharedOptions:j,includeOptions:y}=this._getSharedOptions(n,r);let N=this._getRotation(),w;for(w=0;w<n;++w)N+=this._circumference(w,i);for(w=n;w<n+s;++w){const S=this._circumference(w,i),_=t[w],T={x:d+this.offsetX,y:h+this.offsetY,startAngle:N,endAngle:N+S,circumference:S,outerRadius:b,innerRadius:x};y&&(T.options=j||this.resolveDataElementOptions(w,_.active?"active":r)),N+=S,this.updateElement(_,w,T,r)}}calculateTotal(){const t=this._cachedMeta,n=t.data;let s=0,r;for(r=0;r<n.length;r++){const i=t._parsed[r];i!==null&&!isNaN(i)&&this.chart.getDataVisibility(r)&&!n[r].hidden&&(s+=Math.abs(i))}return s}calculateCircumference(t){const n=this._cachedMeta.total;return n>0&&!isNaN(t)?_n*(Math.abs(t)/n):0}getLabelAndValue(t){const n=this._cachedMeta,s=this.chart,r=s.data.labels||[],i=g3(n._parsed[t],s.options.locale);return{label:r[t]||"",value:i}}getMaxBorderWidth(t){let n=0;const s=this.chart;let r,i,o,l,c;if(!t){for(r=0,i=s.data.datasets.length;r<i;++r)if(s.isDatasetVisible(r)){o=s.getDatasetMeta(r),t=o.data,l=o.controller;break}}if(!t)return 0;for(r=0,i=t.length;r<i;++r)c=l.resolveDataElementOptions(r),c.borderAlign!=="inner"&&(n=Math.max(n,c.borderWidth||0,c.hoverBorderWidth||0));return n}getMaxOffset(t){let n=0;for(let s=0,r=t.length;s<r;++s){const i=this.resolveDataElementOptions(s);n=Math.max(n,i.offset||0,i.hoverOffset||0)}return n}_getRingWeightOffset(t){let n=0;for(let s=0;s<t;++s)this.chart.isDatasetVisible(s)&&(n+=this._getRingWeight(s));return n}_getRingWeight(t){return Math.max(ma(this.chart.data.datasets[t].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}class s9e extends R1{static id="line";static defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1};static overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(t){const n=this._cachedMeta,{dataset:s,data:r=[],_dataset:i}=n,o=this.chart._animationsDisabled;let{start:l,count:c}=_Be(n,r,o);this._drawStart=l,this._drawCount=c,ABe(n)&&(l=0,c=r.length),s._chart=this.chart,s._datasetIndex=this.index,s._decimated=!!i._decimated,s.points=r;const u=this.resolveDatasetElementOptions(t);this.options.showLine||(u.borderWidth=0),u.segment=this.options.segment,this.updateElement(s,void 0,{animated:!o,options:u},t),this.updateElements(r,l,c,t)}updateElements(t,n,s,r){const i=r==="reset",{iScale:o,vScale:l,_stacked:c,_dataset:u}=this._cachedMeta,{sharedOptions:d,includeOptions:h}=this._getSharedOptions(n,r),p=o.axis,x=l.axis,{spanGaps:b,segment:j}=this.options,y=tx(b)?b:Number.POSITIVE_INFINITY,N=this.chart._animationsDisabled||i||r==="none",w=n+s,S=t.length;let _=n>0&&this.getParsed(n-1);for(let T=0;T<S;++T){const k=t[T],A=N?k:{};if(T<n||T>=w){A.skip=!0;continue}const E=this.getParsed(T),M=Pa(E[x]),F=A[p]=o.getPixelForValue(E[p],T),D=A[x]=i||M?l.getBasePixel():l.getPixelForValue(c?this.applyStack(l,E,c):E[x],T);A.skip=isNaN(F)||isNaN(D)||M,A.stop=T>0&&Math.abs(E[p]-_[p])>y,j&&(A.parsed=E,A.raw=u.data[T]),h&&(A.options=d||this.resolveDataElementOptions(T,k.active?"active":r)),N||this.updateElement(k,T,A,r),_=E}}getMaxOverflow(){const t=this._cachedMeta,n=t.dataset,s=n.options&&n.options.borderWidth||0,r=t.data||[];if(!r.length)return s;const i=r[0].size(this.resolveDataElementOptions(0)),o=r[r.length-1].size(this.resolveDataElementOptions(r.length-1));return Math.max(s,i,o)/2}draw(){const t=this._cachedMeta;t.dataset.updateControlPoints(this.chart.chartArea,t.iScale.axis),super.draw()}}class r9e extends n9e{static id="pie";static defaults={cutout:0,rotation:0,circumference:360,radius:"100%"}}function tu(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class C3{static override(t){Object.assign(C3.prototype,t)}options;constructor(t){this.options=t||{}}init(){}formats(){return tu()}parse(){return tu()}format(){return tu()}add(){return tu()}diff(){return tu()}startOf(){return tu()}endOf(){return tu()}}var i9e={_date:C3};function o9e(e,t,n,s){const{controller:r,data:i,_sorted:o}=e,l=r._cachedMeta.iScale,c=e.dataset&&e.dataset.options?e.dataset.options.spanGaps:null;if(l&&t===l.axis&&t!=="r"&&o&&i.length){const u=l._reversePixels?wBe:Su;if(s){if(r._sharedOptions){const d=i[0],h=typeof d.getRange=="function"&&d.getRange(t);if(h){const p=u(i,t,n-h),x=u(i,t,n+h);return{lo:p.lo,hi:x.hi}}}}else{const d=u(i,t,n);if(c){const{vScale:h}=r._cachedMeta,{_parsed:p}=e,x=p.slice(0,d.lo+1).reverse().findIndex(j=>!Pa(j[h.axis]));d.lo-=Math.max(0,x);const b=p.slice(d.hi).findIndex(j=>!Pa(j[h.axis]));d.hi+=Math.max(0,b)}return d}}return{lo:0,hi:i.length-1}}function z1(e,t,n,s,r){const i=e.getSortedVisibleDatasetMetas(),o=n[t];for(let l=0,c=i.length;l<c;++l){const{index:u,data:d}=i[l],{lo:h,hi:p}=o9e(i[l],t,o,r);for(let x=h;x<=p;++x){const b=d[x];b.skip||s(b,u,x)}}}function l9e(e){const t=e.indexOf("x")!==-1,n=e.indexOf("y")!==-1;return function(s,r){const i=t?Math.abs(s.x-r.x):0,o=n?Math.abs(s.y-r.y):0;return Math.sqrt(Math.pow(i,2)+Math.pow(o,2))}}function ST(e,t,n,s,r){const i=[];return!r&&!e.isPointInArea(t)||z1(e,n,t,function(l,c,u){!r&&!nx(l,e.chartArea,0)||l.inRange(t.x,t.y,s)&&i.push({element:l,datasetIndex:c,index:u})},!0),i}function c9e(e,t,n,s){let r=[];function i(o,l,c){const{startAngle:u,endAngle:d}=o.getProps(["startAngle","endAngle"],s),{angle:h}=FJ(o,{x:t.x,y:t.y});ax(h,u,d)&&r.push({element:o,datasetIndex:l,index:c})}return z1(e,n,t,i),r}function d9e(e,t,n,s,r,i){let o=[];const l=l9e(n);let c=Number.POSITIVE_INFINITY;function u(d,h,p){const x=d.inRange(t.x,t.y,r);if(s&&!x)return;const b=d.getCenterPoint(r);if(!(!!i||e.isPointInArea(b))&&!x)return;const y=l(t,b);y<c?(o=[{element:d,datasetIndex:h,index:p}],c=y):y===c&&o.push({element:d,datasetIndex:h,index:p})}return z1(e,n,t,u),o}function _T(e,t,n,s,r,i){return!i&&!e.isPointInArea(t)?[]:n==="r"&&!s?c9e(e,t,n,r):d9e(e,t,n,s,r,i)}function vB(e,t,n,s,r){const i=[],o=n==="x"?"inXRange":"inYRange";let l=!1;return z1(e,n,t,(c,u,d)=>{c[o]&&c[o](t[n],r)&&(i.push({element:c,datasetIndex:u,index:d}),l=l||c.inRange(t.x,t.y,r))}),s&&!l?[]:i}var u9e={modes:{index(e,t,n,s){const r=cu(t,e),i=n.axis||"x",o=n.includeInvisible||!1,l=n.intersect?ST(e,r,i,s,o):_T(e,r,i,!1,s,o),c=[];return l.length?(e.getSortedVisibleDatasetMetas().forEach(u=>{const d=l[0].index,h=u.data[d];h&&!h.skip&&c.push({element:h,datasetIndex:u.index,index:d})}),c):[]},dataset(e,t,n,s){const r=cu(t,e),i=n.axis||"xy",o=n.includeInvisible||!1;let l=n.intersect?ST(e,r,i,s,o):_T(e,r,i,!1,s,o);if(l.length>0){const c=l[0].datasetIndex,u=e.getDatasetMeta(c).data;l=[];for(let d=0;d<u.length;++d)l.push({element:u[d],datasetIndex:c,index:d})}return l},point(e,t,n,s){const r=cu(t,e),i=n.axis||"xy",o=n.includeInvisible||!1;return ST(e,r,i,s,o)},nearest(e,t,n,s){const r=cu(t,e),i=n.axis||"xy",o=n.includeInvisible||!1;return _T(e,r,i,n.intersect,s,o)},x(e,t,n,s){const r=cu(t,e);return vB(e,r,"x",n.intersect,s)},y(e,t,n,s){const r=cu(t,e);return vB(e,r,"y",n.intersect,s)}}};const ree=["left","top","right","bottom"];function $g(e,t){return e.filter(n=>n.pos===t)}function wB(e,t){return e.filter(n=>ree.indexOf(n.pos)===-1&&n.box.axis===t)}function Rg(e,t){return e.sort((n,s)=>{const r=t?s:n,i=t?n:s;return r.weight===i.weight?r.index-i.index:r.weight-i.weight})}function m9e(e){const t=[];let n,s,r,i,o,l;for(n=0,s=(e||[]).length;n<s;++n)r=e[n],{position:i,options:{stack:o,stackWeight:l=1}}=r,t.push({index:n,box:r,pos:i,horizontal:r.isHorizontal(),weight:r.weight,stack:o&&i+o,stackWeight:l});return t}function f9e(e){const t={};for(const n of e){const{stack:s,pos:r,stackWeight:i}=n;if(!s||!ree.includes(r))continue;const o=t[s]||(t[s]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=i}return t}function h9e(e,t){const n=f9e(e),{vBoxMaxWidth:s,hBoxMaxHeight:r}=t;let i,o,l;for(i=0,o=e.length;i<o;++i){l=e[i];const{fullSize:c}=l.box,u=n[l.stack],d=u&&l.stackWeight/u.weight;l.horizontal?(l.width=d?d*s:c&&t.availableWidth,l.height=r):(l.width=s,l.height=d?d*r:c&&t.availableHeight)}return n}function g9e(e){const t=m9e(e),n=Rg(t.filter(u=>u.box.fullSize),!0),s=Rg($g(t,"left"),!0),r=Rg($g(t,"right")),i=Rg($g(t,"top"),!0),o=Rg($g(t,"bottom")),l=wB(t,"x"),c=wB(t,"y");return{fullSize:n,leftAndTop:s.concat(i),rightAndBottom:r.concat(c).concat(o).concat(l),chartArea:$g(t,"chartArea"),vertical:s.concat(r).concat(c),horizontal:i.concat(o).concat(l)}}function jB(e,t,n,s){return Math.max(e[n],t[n])+Math.max(e[s],t[s])}function iee(e,t){e.top=Math.max(e.top,t.top),e.left=Math.max(e.left,t.left),e.bottom=Math.max(e.bottom,t.bottom),e.right=Math.max(e.right,t.right)}function p9e(e,t,n,s){const{pos:r,box:i}=n,o=e.maxPadding;if(!Na(r)){n.size&&(e[r]-=n.size);const h=s[n.stack]||{size:0,count:1};h.size=Math.max(h.size,n.horizontal?i.height:i.width),n.size=h.size/h.count,e[r]+=n.size}i.getPadding&&iee(o,i.getPadding());const l=Math.max(0,t.outerWidth-jB(o,e,"left","right")),c=Math.max(0,t.outerHeight-jB(o,e,"top","bottom")),u=l!==e.w,d=c!==e.h;return e.w=l,e.h=c,n.horizontal?{same:u,other:d}:{same:d,other:u}}function x9e(e){const t=e.maxPadding;function n(s){const r=Math.max(t[s]-e[s],0);return e[s]+=r,r}e.y+=n("top"),e.x+=n("left"),n("right"),n("bottom")}function y9e(e,t){const n=t.maxPadding;function s(r){const i={left:0,top:0,right:0,bottom:0};return r.forEach(o=>{i[o]=Math.max(t[o],n[o])}),i}return s(e?["left","right"]:["top","bottom"])}function np(e,t,n,s){const r=[];let i,o,l,c,u,d;for(i=0,o=e.length,u=0;i<o;++i){l=e[i],c=l.box,c.update(l.width||t.w,l.height||t.h,y9e(l.horizontal,t));const{same:h,other:p}=p9e(t,n,l,s);u|=h&&r.length,d=d||p,c.fullSize||r.push(l)}return u&&np(r,t,n,s)||d}function Vb(e,t,n,s,r){e.top=n,e.left=t,e.right=t+s,e.bottom=n+r,e.width=s,e.height=r}function NB(e,t,n,s){const r=n.padding;let{x:i,y:o}=t;for(const l of e){const c=l.box,u=s[l.stack]||{placed:0,weight:1},d=l.stackWeight/u.weight||1;if(l.horizontal){const h=t.w*d,p=u.size||c.height;ex(u.start)&&(o=u.start),c.fullSize?Vb(c,r.left,o,n.outerWidth-r.right-r.left,p):Vb(c,t.left+u.placed,o,h,p),u.start=o,u.placed+=h,o=c.bottom}else{const h=t.h*d,p=u.size||c.width;ex(u.start)&&(i=u.start),c.fullSize?Vb(c,i,r.top,p,n.outerHeight-r.bottom-r.top):Vb(c,i,t.top+u.placed,p,h),u.start=i,u.placed+=h,i=c.right}}t.x=i,t.y=o}var pi={addBox(e,t){e.boxes||(e.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(n){t.draw(n)}}]},e.boxes.push(t)},removeBox(e,t){const n=e.boxes?e.boxes.indexOf(t):-1;n!==-1&&e.boxes.splice(n,1)},configure(e,t,n){t.fullSize=n.fullSize,t.position=n.position,t.weight=n.weight},update(e,t,n,s){if(!e)return;const r=Si(e.options.layout.padding),i=Math.max(t-r.width,0),o=Math.max(n-r.height,0),l=g9e(e.boxes),c=l.vertical,u=l.horizontal;Ra(e.boxes,j=>{typeof j.beforeLayout=="function"&&j.beforeLayout()});const d=c.reduce((j,y)=>y.box.options&&y.box.options.display===!1?j:j+1,0)||1,h=Object.freeze({outerWidth:t,outerHeight:n,padding:r,availableWidth:i,availableHeight:o,vBoxMaxWidth:i/2/d,hBoxMaxHeight:o/2}),p=Object.assign({},r);iee(p,Si(s));const x=Object.assign({maxPadding:p,w:i,h:o,x:r.left,y:r.top},r),b=h9e(c.concat(u),h);np(l.fullSize,x,h,b),np(c,x,h,b),np(u,x,h,b)&&np(c,x,h,b),x9e(x),NB(l.leftAndTop,x,h,b),x.x+=x.w,x.y+=x.h,NB(l.rightAndBottom,x,h,b),e.chartArea={left:x.left,top:x.top,right:x.left+x.w,bottom:x.top+x.h,height:x.h,width:x.w},Ra(l.chartArea,j=>{const y=j.box;Object.assign(y,e.chartArea),y.update(x.w,x.h,{left:0,top:0,right:0,bottom:0})})}};class oee{acquireContext(t,n){}releaseContext(t){return!1}addEventListener(t,n,s){}removeEventListener(t,n,s){}getDevicePixelRatio(){return 1}getMaximumSize(t,n,s,r){return n=Math.max(0,n||t.width),s=s||t.height,{width:n,height:Math.max(0,r?Math.floor(n/r):s)}}isAttached(t){return!0}updateConfig(t){}}class b9e extends oee{acquireContext(t){return t&&t.getContext&&t.getContext("2d")||null}updateConfig(t){t.options.animation=!1}}const _v="$chartjs",v9e={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},CB=e=>e===null||e==="";function w9e(e,t){const n=e.style,s=e.getAttribute("height"),r=e.getAttribute("width");if(e[_v]={initial:{height:s,width:r,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",CB(r)){const i=oB(e,"width");i!==void 0&&(e.width=i)}if(CB(s))if(e.style.height==="")e.height=e.width/(t||2);else{const i=oB(e,"height");i!==void 0&&(e.height=i)}return e}const lee=pHe?{passive:!0}:!1;function j9e(e,t,n){e&&e.addEventListener(t,n,lee)}function N9e(e,t,n){e&&e.canvas&&e.canvas.removeEventListener(t,n,lee)}function C9e(e,t){const n=v9e[e.type]||e.type,{x:s,y:r}=cu(e,t);return{type:n,chart:t,native:e,x:s!==void 0?s:null,y:r!==void 0?r:null}}function ij(e,t){for(const n of e)if(n===t||n.contains(t))return!0}function S9e(e,t,n){const s=e.canvas,r=new MutationObserver(i=>{let o=!1;for(const l of i)o=o||ij(l.addedNodes,s),o=o&&!ij(l.removedNodes,s);o&&n()});return r.observe(document,{childList:!0,subtree:!0}),r}function _9e(e,t,n){const s=e.canvas,r=new MutationObserver(i=>{let o=!1;for(const l of i)o=o||ij(l.removedNodes,s),o=o&&!ij(l.addedNodes,s);o&&n()});return r.observe(document,{childList:!0,subtree:!0}),r}const rx=new Map;let SB=0;function cee(){const e=window.devicePixelRatio;e!==SB&&(SB=e,rx.forEach((t,n)=>{n.currentDevicePixelRatio!==e&&t()}))}function A9e(e,t){rx.size||window.addEventListener("resize",cee),rx.set(e,t)}function T9e(e){rx.delete(e),rx.size||window.removeEventListener("resize",cee)}function k9e(e,t,n){const s=e.canvas,r=s&&N3(s);if(!r)return;const i=qJ((l,c)=>{const u=r.clientWidth;n(l,c),u<r.clientWidth&&n()},window),o=new ResizeObserver(l=>{const c=l[0],u=c.contentRect.width,d=c.contentRect.height;u===0&&d===0||i(u,d)});return o.observe(r),A9e(e,i),o}function AT(e,t,n){n&&n.disconnect(),t==="resize"&&T9e(e)}function E9e(e,t,n){const s=e.canvas,r=qJ(i=>{e.ctx!==null&&n(C9e(i,e))},e);return j9e(s,t,r),r}class L9e extends oee{acquireContext(t,n){const s=t&&t.getContext&&t.getContext("2d");return s&&s.canvas===t?(w9e(t,n),s):null}releaseContext(t){const n=t.canvas;if(!n[_v])return!1;const s=n[_v].initial;["height","width"].forEach(i=>{const o=s[i];Pa(o)?n.removeAttribute(i):n.setAttribute(i,o)});const r=s.style||{};return Object.keys(r).forEach(i=>{n.style[i]=r[i]}),n.width=n.width,delete n[_v],!0}addEventListener(t,n,s){this.removeEventListener(t,n);const r=t.$proxies||(t.$proxies={}),o={attach:S9e,detach:_9e,resize:k9e}[n]||E9e;r[n]=o(t,n,s)}removeEventListener(t,n){const s=t.$proxies||(t.$proxies={}),r=s[n];if(!r)return;({attach:AT,detach:AT,resize:AT}[n]||N9e)(t,n,r),s[n]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(t,n,s,r){return gHe(t,n,s,r)}isAttached(t){const n=t&&N3(t);return!!(n&&n.isConnected)}}function D9e(e){return!j3()||typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas?b9e:L9e}let hc=class{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(t){const{x:n,y:s}=this.getProps(["x","y"],t);return{x:n,y:s}}hasValue(){return tx(this.x)&&tx(this.y)}getProps(t,n){const s=this.$animations;if(!n||!s)return this;const r={};return t.forEach(i=>{r[i]=s[i]&&s[i].active()?s[i]._to:this[i]}),r}};function P9e(e,t){const n=e.options.ticks,s=O9e(e),r=Math.min(n.maxTicksLimit||s,s),i=n.major.enabled?I9e(t):[],o=i.length,l=i[0],c=i[o-1],u=[];if(o>r)return $9e(t,u,i,o/r),u;const d=M9e(i,t,r);if(o>0){let h,p;const x=o>1?Math.round((c-l)/(o-1)):null;for(Yb(t,u,d,Pa(x)?0:l-x,l),h=0,p=o-1;h<p;h++)Yb(t,u,d,i[h],i[h+1]);return Yb(t,u,d,c,Pa(x)?t.length:c+x),u}return Yb(t,u,d),u}function O9e(e){const t=e.options.offset,n=e._tickSize(),s=e._length/n+(t?0:1),r=e._maxLength/n;return Math.floor(Math.min(s,r))}function M9e(e,t,n){const s=R9e(e),r=t.length/n;if(!s)return Math.max(r,1);const i=hBe(s);for(let o=0,l=i.length-1;o<l;o++){const c=i[o];if(c>r)return c}return Math.max(r,1)}function I9e(e){const t=[];let n,s;for(n=0,s=e.length;n<s;n++)e[n].major&&t.push(n);return t}function $9e(e,t,n,s){let r=0,i=n[0],o;for(s=Math.ceil(s),o=0;o<e.length;o++)o===i&&(t.push(e[o]),r++,i=n[r*s])}function Yb(e,t,n,s,r){const i=ma(s,0),o=Math.min(ma(r,e.length),e.length);let l=0,c,u,d;for(n=Math.ceil(n),r&&(c=r-s,n=c/Math.floor(c/n)),d=i;d<0;)l++,d=Math.round(i+l*n);for(u=Math.max(i,0);u<o;u++)u===d&&(t.push(e[u]),l++,d=Math.round(i+l*n))}function R9e(e){const t=e.length;let n,s;if(t<2)return!1;for(s=e[0],n=1;n<t;++n)if(e[n]-e[n-1]!==s)return!1;return s}const z9e=e=>e==="left"?"right":e==="right"?"left":e,_B=(e,t,n)=>t==="top"||t==="left"?e[t]+n:e[t]-n,AB=(e,t)=>Math.min(t||e,e);function TB(e,t){const n=[],s=e.length/t,r=e.length;let i=0;for(;i<r;i+=s)n.push(e[Math.floor(i)]);return n}function F9e(e,t,n){const s=e.ticks.length,r=Math.min(t,s-1),i=e._startPixel,o=e._endPixel,l=1e-6;let c=e.getPixelForTick(r),u;if(!(n&&(s===1?u=Math.max(c-i,o-c):t===0?u=(e.getPixelForTick(1)-c)/2:u=(c-e.getPixelForTick(r-1))/2,c+=r<t?u:-u,c<i-l||c>o+l)))return c}function U9e(e,t){Ra(e,n=>{const s=n.gc,r=s.length/2;let i;if(r>t){for(i=0;i<r;++i)delete n.data[s[i]];s.splice(0,r)}})}function zg(e){return e.drawTicks?e.tickLength:0}function kB(e,t){if(!e.display)return 0;const n=zs(e.font,t),s=Si(e.padding);return(is(e.text)?e.text.length:1)*n.lineHeight+s.height}function B9e(e,t){return hm(e,{scale:t,type:"scale"})}function H9e(e,t,n){return hm(e,{tick:n,index:t,type:"tick"})}function q9e(e,t,n){let s=f3(e);return(n&&t!=="right"||!n&&t==="right")&&(s=z9e(s)),s}function G9e(e,t,n,s){const{top:r,left:i,bottom:o,right:l,chart:c}=e,{chartArea:u,scales:d}=c;let h=0,p,x,b;const j=o-r,y=l-i;if(e.isHorizontal()){if(x=Os(s,i,l),Na(n)){const N=Object.keys(n)[0],w=n[N];b=d[N].getPixelForValue(w)+j-t}else n==="center"?b=(u.bottom+u.top)/2+j-t:b=_B(e,n,t);p=l-i}else{if(Na(n)){const N=Object.keys(n)[0],w=n[N];x=d[N].getPixelForValue(w)-y+t}else n==="center"?x=(u.left+u.right)/2-y+t:x=_B(e,n,t);b=Os(s,o,r),h=n==="left"?-os:os}return{titleX:x,titleY:b,maxWidth:p,rotation:h}}class Ah extends hc{constructor(t){super(),this.id=t.id,this.type=t.type,this.options=void 0,this.ctx=t.ctx,this.chart=t.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(t){this.options=t.setContext(this.getContext()),this.axis=t.axis,this._userMin=this.parse(t.min),this._userMax=this.parse(t.max),this._suggestedMin=this.parse(t.suggestedMin),this._suggestedMax=this.parse(t.suggestedMax)}parse(t,n){return t}getUserBounds(){let{_userMin:t,_userMax:n,_suggestedMin:s,_suggestedMax:r}=this;return t=bo(t,Number.POSITIVE_INFINITY),n=bo(n,Number.NEGATIVE_INFINITY),s=bo(s,Number.POSITIVE_INFINITY),r=bo(r,Number.NEGATIVE_INFINITY),{min:bo(t,s),max:bo(n,r),minDefined:Ci(t),maxDefined:Ci(n)}}getMinMax(t){let{min:n,max:s,minDefined:r,maxDefined:i}=this.getUserBounds(),o;if(r&&i)return{min:n,max:s};const l=this.getMatchingVisibleMetas();for(let c=0,u=l.length;c<u;++c)o=l[c].controller.getMinMax(this,t),r||(n=Math.min(n,o.min)),i||(s=Math.max(s,o.max));return n=i&&n>s?s:n,s=r&&n>s?n:s,{min:bo(n,bo(s,n)),max:bo(s,bo(n,s))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]}getLabelItems(t=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(t))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){an(this.options.beforeUpdate,[this])}update(t,n,s){const{beginAtZero:r,grace:i,ticks:o}=this.options,l=o.sampleSize;this.beforeUpdate(),this.maxWidth=t,this.maxHeight=n,this._margins=s=Object.assign({left:0,right:0,top:0,bottom:0},s),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+s.left+s.right:this.height+s.top+s.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=VBe(this,i,r),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const c=l<this.ticks.length;this._convertTicksToLabels(c?TB(this.ticks,l):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||o.source==="auto")&&(this.ticks=P9e(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),c&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let t=this.options.reverse,n,s;this.isHorizontal()?(n=this.left,s=this.right):(n=this.top,s=this.bottom,t=!t),this._startPixel=n,this._endPixel=s,this._reversePixels=t,this._length=s-n,this._alignToPixels=this.options.alignToPixels}afterUpdate(){an(this.options.afterUpdate,[this])}beforeSetDimensions(){an(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){an(this.options.afterSetDimensions,[this])}_callHooks(t){this.chart.notifyPlugins(t,this.getContext()),an(this.options[t],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){an(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(t){const n=this.options.ticks;let s,r,i;for(s=0,r=t.length;s<r;s++)i=t[s],i.label=an(n.callback,[i.value,s,t],this)}afterTickToLabelConversion(){an(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){an(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const t=this.options,n=t.ticks,s=AB(this.ticks.length,t.ticks.maxTicksLimit),r=n.minRotation||0,i=n.maxRotation;let o=r,l,c,u;if(!this._isVisible()||!n.display||r>=i||s<=1||!this.isHorizontal()){this.labelRotation=r;return}const d=this._getLabelSizes(),h=d.widest.width,p=d.highest.height,x=Rs(this.chart.width-h,0,this.maxWidth);l=t.offset?this.maxWidth/s:x/(s-1),h+6>l&&(l=x/(s-(t.offset?.5:1)),c=this.maxHeight-zg(t.grid)-n.padding-kB(t.title,this.chart.options.font),u=Math.sqrt(h*h+p*p),o=yBe(Math.min(Math.asin(Rs((d.highest.height+6)/l,-1,1)),Math.asin(Rs(c/u,-1,1))-Math.asin(Rs(p/u,-1,1)))),o=Math.max(r,Math.min(i,o))),this.labelRotation=o}afterCalculateLabelRotation(){an(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){an(this.options.beforeFit,[this])}fit(){const t={width:0,height:0},{chart:n,options:{ticks:s,title:r,grid:i}}=this,o=this._isVisible(),l=this.isHorizontal();if(o){const c=kB(r,n.options.font);if(l?(t.width=this.maxWidth,t.height=zg(i)+c):(t.height=this.maxHeight,t.width=zg(i)+c),s.display&&this.ticks.length){const{first:u,last:d,widest:h,highest:p}=this._getLabelSizes(),x=s.padding*2,b=Pl(this.labelRotation),j=Math.cos(b),y=Math.sin(b);if(l){const N=s.mirror?0:y*h.width+j*p.height;t.height=Math.min(this.maxHeight,t.height+N+x)}else{const N=s.mirror?0:j*h.width+y*p.height;t.width=Math.min(this.maxWidth,t.width+N+x)}this._calculatePadding(u,d,y,j)}}this._handleMargins(),l?(this.width=this._length=n.width-this._margins.left-this._margins.right,this.height=t.height):(this.width=t.width,this.height=this._length=n.height-this._margins.top-this._margins.bottom)}_calculatePadding(t,n,s,r){const{ticks:{align:i,padding:o},position:l}=this.options,c=this.labelRotation!==0,u=l!=="top"&&this.axis==="x";if(this.isHorizontal()){const d=this.getPixelForTick(0)-this.left,h=this.right-this.getPixelForTick(this.ticks.length-1);let p=0,x=0;c?u?(p=r*t.width,x=s*n.height):(p=s*t.height,x=r*n.width):i==="start"?x=n.width:i==="end"?p=t.width:i!=="inner"&&(p=t.width/2,x=n.width/2),this.paddingLeft=Math.max((p-d+o)*this.width/(this.width-d),0),this.paddingRight=Math.max((x-h+o)*this.width/(this.width-h),0)}else{let d=n.height/2,h=t.height/2;i==="start"?(d=0,h=t.height):i==="end"&&(d=n.height,h=0),this.paddingTop=d+o,this.paddingBottom=h+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){an(this.options.afterFit,[this])}isHorizontal(){const{axis:t,position:n}=this.options;return n==="top"||n==="bottom"||t==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(t){this.beforeTickToLabelConversion(),this.generateTickLabels(t);let n,s;for(n=0,s=t.length;n<s;n++)Pa(t[n].label)&&(t.splice(n,1),s--,n--);this.afterTickToLabelConversion()}_getLabelSizes(){let t=this._labelSizes;if(!t){const n=this.options.ticks.sampleSize;let s=this.ticks;n<s.length&&(s=TB(s,n)),this._labelSizes=t=this._computeLabelSizes(s,s.length,this.options.ticks.maxTicksLimit)}return t}_computeLabelSizes(t,n,s){const{ctx:r,_longestTextCache:i}=this,o=[],l=[],c=Math.floor(n/AB(n,s));let u=0,d=0,h,p,x,b,j,y,N,w,S,_,T;for(h=0;h<n;h+=c){if(b=t[h].label,j=this._resolveTickFontOptions(h),r.font=y=j.string,N=i[y]=i[y]||{data:{},gc:[]},w=j.lineHeight,S=_=0,!Pa(b)&&!is(b))S=aB(r,N.data,N.gc,S,b),_=w;else if(is(b))for(p=0,x=b.length;p<x;++p)T=b[p],!Pa(T)&&!is(T)&&(S=aB(r,N.data,N.gc,S,T),_+=w);o.push(S),l.push(_),u=Math.max(S,u),d=Math.max(_,d)}U9e(i,n);const k=o.indexOf(u),A=l.indexOf(d),E=M=>({width:o[M]||0,height:l[M]||0});return{first:E(0),last:E(n-1),widest:E(k),highest:E(A),widths:o,heights:l}}getLabelForValue(t){return t}getPixelForValue(t,n){return NaN}getValueForPixel(t){}getPixelForTick(t){const n=this.ticks;return t<0||t>n.length-1?null:this.getPixelForValue(n[t].value)}getPixelForDecimal(t){this._reversePixels&&(t=1-t);const n=this._startPixel+t*this._length;return vBe(this._alignToPixels?eu(this.chart,n,0):n)}getDecimalForPixel(t){const n=(t-this._startPixel)/this._length;return this._reversePixels?1-n:n}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:t,max:n}=this;return t<0&&n<0?n:t>0&&n>0?t:0}getContext(t){const n=this.ticks||[];if(t>=0&&t<n.length){const s=n[t];return s.$context||(s.$context=H9e(this.getContext(),t,s))}return this.$context||(this.$context=B9e(this.chart.getContext(),this))}_tickSize(){const t=this.options.ticks,n=Pl(this.labelRotation),s=Math.abs(Math.cos(n)),r=Math.abs(Math.sin(n)),i=this._getLabelSizes(),o=t.autoSkipPadding||0,l=i?i.widest.width+o:0,c=i?i.highest.height+o:0;return this.isHorizontal()?c*s>l*r?l/s:c/r:c*r<l*s?c/s:l/r}_isVisible(){const t=this.options.display;return t!=="auto"?!!t:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(t){const n=this.axis,s=this.chart,r=this.options,{grid:i,position:o,border:l}=r,c=i.offset,u=this.isHorizontal(),h=this.ticks.length+(c?1:0),p=zg(i),x=[],b=l.setContext(this.getContext()),j=b.display?b.width:0,y=j/2,N=function(W){return eu(s,W,j)};let w,S,_,T,k,A,E,M,F,D,P,B;if(o==="top")w=N(this.bottom),A=this.bottom-p,M=w-y,D=N(t.top)+y,B=t.bottom;else if(o==="bottom")w=N(this.top),D=t.top,B=N(t.bottom)-y,A=w+y,M=this.top+p;else if(o==="left")w=N(this.right),k=this.right-p,E=w-y,F=N(t.left)+y,P=t.right;else if(o==="right")w=N(this.left),F=t.left,P=N(t.right)-y,k=w+y,E=this.left+p;else if(n==="x"){if(o==="center")w=N((t.top+t.bottom)/2+.5);else if(Na(o)){const W=Object.keys(o)[0],Z=o[W];w=N(this.chart.scales[W].getPixelForValue(Z))}D=t.top,B=t.bottom,A=w+y,M=A+p}else if(n==="y"){if(o==="center")w=N((t.left+t.right)/2);else if(Na(o)){const W=Object.keys(o)[0],Z=o[W];w=N(this.chart.scales[W].getPixelForValue(Z))}k=w-y,E=k-p,F=t.left,P=t.right}const G=ma(r.ticks.maxTicksLimit,h),$=Math.max(1,Math.ceil(h/G));for(S=0;S<h;S+=$){const W=this.getContext(S),Z=i.setContext(W),Q=l.setContext(W),le=Z.lineWidth,we=Z.color,J=Q.dash||[],se=Q.dashOffset,ye=Z.tickWidth,Ce=Z.tickColor,ge=Z.tickBorderDash||[],be=Z.tickBorderDashOffset;_=F9e(this,S,c),_!==void 0&&(T=eu(s,_,le),u?k=E=F=P=T:A=M=D=B=T,x.push({tx1:k,ty1:A,tx2:E,ty2:M,x1:F,y1:D,x2:P,y2:B,width:le,color:we,borderDash:J,borderDashOffset:se,tickWidth:ye,tickColor:Ce,tickBorderDash:ge,tickBorderDashOffset:be}))}return this._ticksLength=h,this._borderValue=w,x}_computeLabelItems(t){const n=this.axis,s=this.options,{position:r,ticks:i}=s,o=this.isHorizontal(),l=this.ticks,{align:c,crossAlign:u,padding:d,mirror:h}=i,p=zg(s.grid),x=p+d,b=h?-d:x,j=-Pl(this.labelRotation),y=[];let N,w,S,_,T,k,A,E,M,F,D,P,B="middle";if(r==="top")k=this.bottom-b,A=this._getXAxisLabelAlignment();else if(r==="bottom")k=this.top+b,A=this._getXAxisLabelAlignment();else if(r==="left"){const $=this._getYAxisLabelAlignment(p);A=$.textAlign,T=$.x}else if(r==="right"){const $=this._getYAxisLabelAlignment(p);A=$.textAlign,T=$.x}else if(n==="x"){if(r==="center")k=(t.top+t.bottom)/2+x;else if(Na(r)){const $=Object.keys(r)[0],W=r[$];k=this.chart.scales[$].getPixelForValue(W)+x}A=this._getXAxisLabelAlignment()}else if(n==="y"){if(r==="center")T=(t.left+t.right)/2-x;else if(Na(r)){const $=Object.keys(r)[0],W=r[$];T=this.chart.scales[$].getPixelForValue(W)}A=this._getYAxisLabelAlignment(p).textAlign}n==="y"&&(c==="start"?B="top":c==="end"&&(B="bottom"));const G=this._getLabelSizes();for(N=0,w=l.length;N<w;++N){S=l[N],_=S.label;const $=i.setContext(this.getContext(N));E=this.getPixelForTick(N)+i.labelOffset,M=this._resolveTickFontOptions(N),F=M.lineHeight,D=is(_)?_.length:1;const W=D/2,Z=$.color,Q=$.textStrokeColor,le=$.textStrokeWidth;let we=A;o?(T=E,A==="inner"&&(N===w-1?we=this.options.reverse?"left":"right":N===0?we=this.options.reverse?"right":"left":we="center"),r==="top"?u==="near"||j!==0?P=-D*F+F/2:u==="center"?P=-G.highest.height/2-W*F+F:P=-G.highest.height+F/2:u==="near"||j!==0?P=F/2:u==="center"?P=G.highest.height/2-W*F:P=G.highest.height-D*F,h&&(P*=-1),j!==0&&!$.showLabelBackdrop&&(T+=F/2*Math.sin(j))):(k=E,P=(1-D)*F/2);let J;if($.showLabelBackdrop){const se=Si($.backdropPadding),ye=G.heights[N],Ce=G.widths[N];let ge=P-se.top,be=0-se.left;switch(B){case"middle":ge-=ye/2;break;case"bottom":ge-=ye;break}switch(A){case"center":be-=Ce/2;break;case"right":be-=Ce;break;case"inner":N===w-1?be-=Ce:N>0&&(be-=Ce/2);break}J={left:be,top:ge,width:Ce+se.width,height:ye+se.height,color:$.backdropColor}}y.push({label:_,font:M,textOffset:P,options:{rotation:j,color:Z,strokeColor:Q,strokeWidth:le,textAlign:we,textBaseline:B,translation:[T,k],backdrop:J}})}return y}_getXAxisLabelAlignment(){const{position:t,ticks:n}=this.options;if(-Pl(this.labelRotation))return t==="top"?"left":"right";let r="center";return n.align==="start"?r="left":n.align==="end"?r="right":n.align==="inner"&&(r="inner"),r}_getYAxisLabelAlignment(t){const{position:n,ticks:{crossAlign:s,mirror:r,padding:i}}=this.options,o=this._getLabelSizes(),l=t+i,c=o.widest.width;let u,d;return n==="left"?r?(d=this.right+i,s==="near"?u="left":s==="center"?(u="center",d+=c/2):(u="right",d+=c)):(d=this.right-l,s==="near"?u="right":s==="center"?(u="center",d-=c/2):(u="left",d=this.left)):n==="right"?r?(d=this.left+i,s==="near"?u="right":s==="center"?(u="center",d-=c/2):(u="left",d-=c)):(d=this.left+l,s==="near"?u="left":s==="center"?(u="center",d+=c/2):(u="right",d=this.right)):u="right",{textAlign:u,x:d}}_computeLabelArea(){if(this.options.ticks.mirror)return;const t=this.chart,n=this.options.position;if(n==="left"||n==="right")return{top:0,left:this.left,bottom:t.height,right:this.right};if(n==="top"||n==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:t.width}}drawBackground(){const{ctx:t,options:{backgroundColor:n},left:s,top:r,width:i,height:o}=this;n&&(t.save(),t.fillStyle=n,t.fillRect(s,r,i,o),t.restore())}getLineWidthForValue(t){const n=this.options.grid;if(!this._isVisible()||!n.display)return 0;const r=this.ticks.findIndex(i=>i.value===t);return r>=0?n.setContext(this.getContext(r)).lineWidth:0}drawGrid(t){const n=this.options.grid,s=this.ctx,r=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(t));let i,o;const l=(c,u,d)=>{!d.width||!d.color||(s.save(),s.lineWidth=d.width,s.strokeStyle=d.color,s.setLineDash(d.borderDash||[]),s.lineDashOffset=d.borderDashOffset,s.beginPath(),s.moveTo(c.x,c.y),s.lineTo(u.x,u.y),s.stroke(),s.restore())};if(n.display)for(i=0,o=r.length;i<o;++i){const c=r[i];n.drawOnChartArea&&l({x:c.x1,y:c.y1},{x:c.x2,y:c.y2},c),n.drawTicks&&l({x:c.tx1,y:c.ty1},{x:c.tx2,y:c.ty2},{color:c.tickColor,width:c.tickWidth,borderDash:c.tickBorderDash,borderDashOffset:c.tickBorderDashOffset})}}drawBorder(){const{chart:t,ctx:n,options:{border:s,grid:r}}=this,i=s.setContext(this.getContext()),o=s.display?i.width:0;if(!o)return;const l=r.setContext(this.getContext(0)).lineWidth,c=this._borderValue;let u,d,h,p;this.isHorizontal()?(u=eu(t,this.left,o)-o/2,d=eu(t,this.right,l)+l/2,h=p=c):(h=eu(t,this.top,o)-o/2,p=eu(t,this.bottom,l)+l/2,u=d=c),n.save(),n.lineWidth=i.width,n.strokeStyle=i.color,n.beginPath(),n.moveTo(u,h),n.lineTo(d,p),n.stroke(),n.restore()}drawLabels(t){if(!this.options.ticks.display)return;const s=this.ctx,r=this._computeLabelArea();r&&p3(s,r);const i=this.getLabelItems(t);for(const o of i){const l=o.options,c=o.font,u=o.label,d=o.textOffset;sx(s,u,0,d,c,l)}r&&x3(s)}drawTitle(){const{ctx:t,options:{position:n,title:s,reverse:r}}=this;if(!s.display)return;const i=zs(s.font),o=Si(s.padding),l=s.align;let c=i.lineHeight/2;n==="bottom"||n==="center"||Na(n)?(c+=o.bottom,is(s.text)&&(c+=i.lineHeight*(s.text.length-1))):c+=o.top;const{titleX:u,titleY:d,maxWidth:h,rotation:p}=G9e(this,c,n,l);sx(t,s.text,0,0,i,{color:s.color,maxWidth:h,rotation:p,textAlign:q9e(l,n,r),textBaseline:"middle",translation:[u,d]})}draw(t){this._isVisible()&&(this.drawBackground(),this.drawGrid(t),this.drawBorder(),this.drawTitle(),this.drawLabels(t))}_layers(){const t=this.options,n=t.ticks&&t.ticks.z||0,s=ma(t.grid&&t.grid.z,-1),r=ma(t.border&&t.border.z,0);return!this._isVisible()||this.draw!==Ah.prototype.draw?[{z:n,draw:i=>{this.draw(i)}}]:[{z:s,draw:i=>{this.drawBackground(),this.drawGrid(i),this.drawTitle()}},{z:r,draw:()=>{this.drawBorder()}},{z:n,draw:i=>{this.drawLabels(i)}}]}getMatchingVisibleMetas(t){const n=this.chart.getSortedVisibleDatasetMetas(),s=this.axis+"AxisID",r=[];let i,o;for(i=0,o=n.length;i<o;++i){const l=n[i];l[s]===this.id&&(!t||l.type===t)&&r.push(l)}return r}_resolveTickFontOptions(t){const n=this.options.ticks.setContext(this.getContext(t));return zs(n.font)}_maxDigits(){const t=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/t}}class Qb{constructor(t,n,s){this.type=t,this.scope=n,this.override=s,this.items=Object.create(null)}isForType(t){return Object.prototype.isPrototypeOf.call(this.type.prototype,t.prototype)}register(t){const n=Object.getPrototypeOf(t);let s;Y9e(n)&&(s=this.register(n));const r=this.items,i=t.id,o=this.scope+"."+i;if(!i)throw new Error("class does not have id: "+t);return i in r||(r[i]=t,W9e(t,o,s),this.override&&On.override(t.id,t.overrides)),o}get(t){return this.items[t]}unregister(t){const n=this.items,s=t.id,r=this.scope;s in n&&delete n[s],r&&s in On[r]&&(delete On[r][s],this.override&&delete tm[s])}}function W9e(e,t,n){const s=Jp(Object.create(null),[n?On.get(n):{},On.get(t),e.defaults]);On.set(t,s),e.defaultRoutes&&V9e(t,e.defaultRoutes),e.descriptors&&On.describe(t,e.descriptors)}function V9e(e,t){Object.keys(t).forEach(n=>{const s=n.split("."),r=s.pop(),i=[e].concat(s).join("."),o=t[n].split("."),l=o.pop(),c=o.join(".");On.route(i,r,c,l)})}function Y9e(e){return"id"in e&&"defaults"in e}class Q9e{constructor(){this.controllers=new Qb(R1,"datasets",!0),this.elements=new Qb(hc,"elements"),this.plugins=new Qb(Object,"plugins"),this.scales=new Qb(Ah,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...t){this._each("register",t)}remove(...t){this._each("unregister",t)}addControllers(...t){this._each("register",t,this.controllers)}addElements(...t){this._each("register",t,this.elements)}addPlugins(...t){this._each("register",t,this.plugins)}addScales(...t){this._each("register",t,this.scales)}getController(t){return this._get(t,this.controllers,"controller")}getElement(t){return this._get(t,this.elements,"element")}getPlugin(t){return this._get(t,this.plugins,"plugin")}getScale(t){return this._get(t,this.scales,"scale")}removeControllers(...t){this._each("unregister",t,this.controllers)}removeElements(...t){this._each("unregister",t,this.elements)}removePlugins(...t){this._each("unregister",t,this.plugins)}removeScales(...t){this._each("unregister",t,this.scales)}_each(t,n,s){[...n].forEach(r=>{const i=s||this._getRegistryForType(r);s||i.isForType(r)||i===this.plugins&&r.id?this._exec(t,i,r):Ra(r,o=>{const l=s||this._getRegistryForType(o);this._exec(t,l,o)})})}_exec(t,n,s){const r=u3(t);an(s["before"+r],[],s),n[t](s),an(s["after"+r],[],s)}_getRegistryForType(t){for(let n=0;n<this._typedRegistries.length;n++){const s=this._typedRegistries[n];if(s.isForType(t))return s}return this.plugins}_get(t,n,s){const r=n.get(t);if(r===void 0)throw new Error('"'+t+'" is not a registered '+s+".");return r}}var Co=new Q9e;class K9e{constructor(){this._init=void 0}notify(t,n,s,r){if(n==="beforeInit"&&(this._init=this._createDescriptors(t,!0),this._notify(this._init,t,"install")),this._init===void 0)return;const i=r?this._descriptors(t).filter(r):this._descriptors(t),o=this._notify(i,t,n,s);return n==="afterDestroy"&&(this._notify(i,t,"stop"),this._notify(this._init,t,"uninstall"),this._init=void 0),o}_notify(t,n,s,r){r=r||{};for(const i of t){const o=i.plugin,l=o[s],c=[n,r,i.options];if(an(l,c,o)===!1&&r.cancelable)return!1}return!0}invalidate(){Pa(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(t){if(this._cache)return this._cache;const n=this._cache=this._createDescriptors(t);return this._notifyStateChanges(t),n}_createDescriptors(t,n){const s=t&&t.config,r=ma(s.options&&s.options.plugins,{}),i=X9e(s);return r===!1&&!n?[]:J9e(t,i,r,n)}_notifyStateChanges(t){const n=this._oldCache||[],s=this._cache,r=(i,o)=>i.filter(l=>!o.some(c=>l.plugin.id===c.plugin.id));this._notify(r(n,s),t,"stop"),this._notify(r(s,n),t,"start")}}function X9e(e){const t={},n=[],s=Object.keys(Co.plugins.items);for(let i=0;i<s.length;i++)n.push(Co.getPlugin(s[i]));const r=e.plugins||[];for(let i=0;i<r.length;i++){const o=r[i];n.indexOf(o)===-1&&(n.push(o),t[o.id]=!0)}return{plugins:n,localIds:t}}function Z9e(e,t){return!t&&e===!1?null:e===!0?{}:e}function J9e(e,{plugins:t,localIds:n},s,r){const i=[],o=e.getContext();for(const l of t){const c=l.id,u=Z9e(s[c],r);u!==null&&i.push({plugin:l,options:eqe(e.config,{plugin:l,local:n[c]},u,o)})}return i}function eqe(e,{plugin:t,local:n},s,r){const i=e.pluginScopeKeys(t),o=e.getOptionScopes(s,i);return n&&t.defaults&&o.push(t.defaults),e.createResolver(o,r,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function fL(e,t){const n=On.datasets[e]||{};return((t.datasets||{})[e]||{}).indexAxis||t.indexAxis||n.indexAxis||"x"}function tqe(e,t){let n=e;return e==="_index_"?n=t:e==="_value_"&&(n=t==="x"?"y":"x"),n}function aqe(e,t){return e===t?"_index_":"_value_"}function EB(e){if(e==="x"||e==="y"||e==="r")return e}function nqe(e){if(e==="top"||e==="bottom")return"x";if(e==="left"||e==="right")return"y"}function hL(e,...t){if(EB(e))return e;for(const n of t){const s=n.axis||nqe(n.position)||e.length>1&&EB(e[0].toLowerCase());if(s)return s}throw new Error(`Cannot determine type of '${e}' axis. Please provide 'axis' or 'position' option.`)}function LB(e,t,n){if(n[t+"AxisID"]===e)return{axis:t}}function sqe(e,t){if(t.data&&t.data.datasets){const n=t.data.datasets.filter(s=>s.xAxisID===e||s.yAxisID===e);if(n.length)return LB(e,"x",n[0])||LB(e,"y",n[0])}return{}}function rqe(e,t){const n=tm[e.type]||{scales:{}},s=t.scales||{},r=fL(e.type,t),i=Object.create(null);return Object.keys(s).forEach(o=>{const l=s[o];if(!Na(l))return console.error(`Invalid scale configuration for scale: ${o}`);if(l._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${o}`);const c=hL(o,l,sqe(o,e),On.scales[l.type]),u=aqe(c,r),d=n.scales||{};i[o]=gp(Object.create(null),[{axis:c},l,d[c],d[u]])}),e.data.datasets.forEach(o=>{const l=o.type||e.type,c=o.indexAxis||fL(l,t),d=(tm[l]||{}).scales||{};Object.keys(d).forEach(h=>{const p=tqe(h,c),x=o[p+"AxisID"]||p;i[x]=i[x]||Object.create(null),gp(i[x],[{axis:p},s[x],d[h]])})}),Object.keys(i).forEach(o=>{const l=i[o];gp(l,[On.scales[l.type],On.scale])}),i}function dee(e){const t=e.options||(e.options={});t.plugins=ma(t.plugins,{}),t.scales=rqe(e,t)}function uee(e){return e=e||{},e.datasets=e.datasets||[],e.labels=e.labels||[],e}function iqe(e){return e=e||{},e.data=uee(e.data),dee(e),e}const DB=new Map,mee=new Set;function Kb(e,t){let n=DB.get(e);return n||(n=t(),DB.set(e,n),mee.add(n)),n}const Fg=(e,t,n)=>{const s=em(t,n);s!==void 0&&e.add(s)};class oqe{constructor(t){this._config=iqe(t),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(t){this._config.type=t}get data(){return this._config.data}set data(t){this._config.data=uee(t)}get options(){return this._config.options}set options(t){this._config.options=t}get plugins(){return this._config.plugins}update(){const t=this._config;this.clearCache(),dee(t)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(t){return Kb(t,()=>[[`datasets.${t}`,""]])}datasetAnimationScopeKeys(t,n){return Kb(`${t}.transition.${n}`,()=>[[`datasets.${t}.transitions.${n}`,`transitions.${n}`],[`datasets.${t}`,""]])}datasetElementScopeKeys(t,n){return Kb(`${t}-${n}`,()=>[[`datasets.${t}.elements.${n}`,`datasets.${t}`,`elements.${n}`,""]])}pluginScopeKeys(t){const n=t.id,s=this.type;return Kb(`${s}-plugin-${n}`,()=>[[`plugins.${n}`,...t.additionalOptionScopes||[]]])}_cachedScopes(t,n){const s=this._scopeCache;let r=s.get(t);return(!r||n)&&(r=new Map,s.set(t,r)),r}getOptionScopes(t,n,s){const{options:r,type:i}=this,o=this._cachedScopes(t,s),l=o.get(n);if(l)return l;const c=new Set;n.forEach(d=>{t&&(c.add(t),d.forEach(h=>Fg(c,t,h))),d.forEach(h=>Fg(c,r,h)),d.forEach(h=>Fg(c,tm[i]||{},h)),d.forEach(h=>Fg(c,On,h)),d.forEach(h=>Fg(c,uL,h))});const u=Array.from(c);return u.length===0&&u.push(Object.create(null)),mee.has(n)&&o.set(n,u),u}chartOptionScopes(){const{options:t,type:n}=this;return[t,tm[n]||{},On.datasets[n]||{},{type:n},On,uL]}resolveNamedOptions(t,n,s,r=[""]){const i={$shared:!0},{resolver:o,subPrefixes:l}=PB(this._resolverCache,t,r);let c=o;if(cqe(o,n)){i.$shared=!1,s=Nd(s)?s():s;const u=this.createResolver(t,s,l);c=Qf(o,s,u)}for(const u of n)i[u]=c[u];return i}createResolver(t,n,s=[""],r){const{resolver:i}=PB(this._resolverCache,t,s);return Na(n)?Qf(i,n,void 0,r):i}}function PB(e,t,n){let s=e.get(t);s||(s=new Map,e.set(t,s));const r=n.join();let i=s.get(r);return i||(i={resolver:b3(t,n),subPrefixes:n.filter(l=>!l.toLowerCase().includes("hover"))},s.set(r,i)),i}const lqe=e=>Na(e)&&Object.getOwnPropertyNames(e).some(t=>Nd(e[t]));function cqe(e,t){const{isScriptable:n,isIndexable:s}=YJ(e);for(const r of t){const i=n(r),o=s(r),l=(o||i)&&e[r];if(i&&(Nd(l)||lqe(l))||o&&is(l))return!0}return!1}var dqe="4.5.1";const uqe=["top","bottom","left","right","chartArea"];function OB(e,t){return e==="top"||e==="bottom"||uqe.indexOf(e)===-1&&t==="x"}function MB(e,t){return function(n,s){return n[e]===s[e]?n[t]-s[t]:n[e]-s[e]}}function IB(e){const t=e.chart,n=t.options.animation;t.notifyPlugins("afterRender"),an(n&&n.onComplete,[e],t)}function mqe(e){const t=e.chart,n=t.options.animation;an(n&&n.onProgress,[e],t)}function fee(e){return j3()&&typeof e=="string"?e=document.getElementById(e):e&&e.length&&(e=e[0]),e&&e.canvas&&(e=e.canvas),e}const Av={},$B=e=>{const t=fee(e);return Object.values(Av).filter(n=>n.canvas===t).pop()};function fqe(e,t,n){const s=Object.keys(e);for(const r of s){const i=+r;if(i>=t){const o=e[r];delete e[r],(n>0||i>t)&&(e[i+n]=o)}}}function hqe(e,t,n,s){return!n||e.type==="mouseout"?null:s?t:e}let F1=class{static defaults=On;static instances=Av;static overrides=tm;static registry=Co;static version=dqe;static getChart=$B;static register(...t){Co.add(...t),RB()}static unregister(...t){Co.remove(...t),RB()}constructor(t,n){const s=this.config=new oqe(n),r=fee(t),i=$B(r);if(i)throw new Error("Canvas is already in use. Chart with ID '"+i.id+"' must be destroyed before the canvas with ID '"+i.canvas.id+"' can be reused.");const o=s.createResolver(s.chartOptionScopes(),this.getContext());this.platform=new(s.platform||D9e(r)),this.platform.updateConfig(s);const l=this.platform.acquireContext(r,o.aspectRatio),c=l&&l.canvas,u=c&&c.height,d=c&&c.width;if(this.id=rBe(),this.ctx=l,this.canvas=c,this.width=d,this.height=u,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new K9e,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=CBe(h=>this.update(h),o.resizeDelay||0),this._dataChanges=[],Av[this.id]=this,!l||!c){console.error("Failed to create chart: can't acquire context from the given item");return}Cl.listen(this,"complete",IB),Cl.listen(this,"progress",mqe),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:t,maintainAspectRatio:n},width:s,height:r,_aspectRatio:i}=this;return Pa(t)?n&&i?i:r?s/r:null:t}get data(){return this.config.data}set data(t){this.config.data=t}get options(){return this._options}set options(t){this.config.options=t}get registry(){return Co}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():iB(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return nB(this.canvas,this.ctx),this}stop(){return Cl.stop(this),this}resize(t,n){Cl.running(this)?this._resizeBeforeDraw={width:t,height:n}:this._resize(t,n)}_resize(t,n){const s=this.options,r=this.canvas,i=s.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(r,t,n,i),l=s.devicePixelRatio||this.platform.getDevicePixelRatio(),c=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,iB(this,l,!0)&&(this.notifyPlugins("resize",{size:o}),an(s.onResize,[this,o],this),this.attached&&this._doResize(c)&&this.render())}ensureScalesHaveIDs(){const n=this.options.scales||{};Ra(n,(s,r)=>{s.id=r})}buildOrUpdateScales(){const t=this.options,n=t.scales,s=this.scales,r=Object.keys(s).reduce((o,l)=>(o[l]=!1,o),{});let i=[];n&&(i=i.concat(Object.keys(n).map(o=>{const l=n[o],c=hL(o,l),u=c==="r",d=c==="x";return{options:l,dposition:u?"chartArea":d?"bottom":"left",dtype:u?"radialLinear":d?"category":"linear"}}))),Ra(i,o=>{const l=o.options,c=l.id,u=hL(c,l),d=ma(l.type,o.dtype);(l.position===void 0||OB(l.position,u)!==OB(o.dposition))&&(l.position=o.dposition),r[c]=!0;let h=null;if(c in s&&s[c].type===d)h=s[c];else{const p=Co.getScale(d);h=new p({id:c,type:d,ctx:this.ctx,chart:this}),s[h.id]=h}h.init(l,t)}),Ra(r,(o,l)=>{o||delete s[l]}),Ra(s,o=>{pi.configure(this,o,o.options),pi.addBox(this,o)})}_updateMetasets(){const t=this._metasets,n=this.data.datasets.length,s=t.length;if(t.sort((r,i)=>r.index-i.index),s>n){for(let r=n;r<s;++r)this._destroyDatasetMeta(r);t.splice(n,s-n)}this._sortedMetasets=t.slice(0).sort(MB("order","index"))}_removeUnreferencedMetasets(){const{_metasets:t,data:{datasets:n}}=this;t.length>n.length&&delete this._stacks,t.forEach((s,r)=>{n.filter(i=>i===s._dataset).length===0&&this._destroyDatasetMeta(r)})}buildOrUpdateControllers(){const t=[],n=this.data.datasets;let s,r;for(this._removeUnreferencedMetasets(),s=0,r=n.length;s<r;s++){const i=n[s];let o=this.getDatasetMeta(s);const l=i.type||this.config.type;if(o.type&&o.type!==l&&(this._destroyDatasetMeta(s),o=this.getDatasetMeta(s)),o.type=l,o.indexAxis=i.indexAxis||fL(l,this.options),o.order=i.order||0,o.index=s,o.label=""+i.label,o.visible=this.isDatasetVisible(s),o.controller)o.controller.updateIndex(s),o.controller.linkScales();else{const c=Co.getController(l),{datasetElementType:u,dataElementType:d}=On.datasets[l];Object.assign(c,{dataElementType:Co.getElement(d),datasetElementType:u&&Co.getElement(u)}),o.controller=new c(this,s),t.push(o.controller)}}return this._updateMetasets(),t}_resetElements(){Ra(this.data.datasets,(t,n)=>{this.getDatasetMeta(n).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(t){const n=this.config;n.update();const s=this._options=n.createResolver(n.chartOptionScopes(),this.getContext()),r=this._animationsDisabled=!s.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:t,cancelable:!0})===!1)return;const i=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let u=0,d=this.data.datasets.length;u<d;u++){const{controller:h}=this.getDatasetMeta(u),p=!r&&i.indexOf(h)===-1;h.buildOrUpdateElements(p),o=Math.max(+h.getMaxOverflow(),o)}o=this._minPadding=s.layout.autoPadding?o:0,this._updateLayout(o),r||Ra(i,u=>{u.reset()}),this._updateDatasets(t),this.notifyPlugins("afterUpdate",{mode:t}),this._layers.sort(MB("z","_idx"));const{_active:l,_lastEvent:c}=this;c?this._eventHandler(c,!0):l.length&&this._updateHoverStyles(l,l,!0),this.render()}_updateScales(){Ra(this.scales,t=>{pi.removeBox(this,t)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const t=this.options,n=new Set(Object.keys(this._listeners)),s=new Set(t.events);(!V8(n,s)||!!this._responsiveListeners!==t.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:t}=this,n=this._getUniformDataChanges()||[];for(const{method:s,start:r,count:i}of n){const o=s==="_removeElements"?-i:i;fqe(t,r,o)}}_getUniformDataChanges(){const t=this._dataChanges;if(!t||!t.length)return;this._dataChanges=[];const n=this.data.datasets.length,s=i=>new Set(t.filter(o=>o[0]===i).map((o,l)=>l+","+o.splice(1).join(","))),r=s(0);for(let i=1;i<n;i++)if(!V8(r,s(i)))return;return Array.from(r).map(i=>i.split(",")).map(i=>({method:i[1],start:+i[2],count:+i[3]}))}_updateLayout(t){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;pi.update(this,this.width,this.height,t);const n=this.chartArea,s=n.width<=0||n.height<=0;this._layers=[],Ra(this.boxes,r=>{s&&r.position==="chartArea"||(r.configure&&r.configure(),this._layers.push(...r._layers()))},this),this._layers.forEach((r,i)=>{r._idx=i}),this.notifyPlugins("afterLayout")}_updateDatasets(t){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:t,cancelable:!0})!==!1){for(let n=0,s=this.data.datasets.length;n<s;++n)this.getDatasetMeta(n).controller.configure();for(let n=0,s=this.data.datasets.length;n<s;++n)this._updateDataset(n,Nd(t)?t({datasetIndex:n}):t);this.notifyPlugins("afterDatasetsUpdate",{mode:t})}}_updateDataset(t,n){const s=this.getDatasetMeta(t),r={meta:s,index:t,mode:n,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",r)!==!1&&(s.controller._update(n),r.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",r))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(Cl.has(this)?this.attached&&!Cl.running(this)&&Cl.start(this):(this.draw(),IB({chart:this})))}draw(){let t;if(this._resizeBeforeDraw){const{width:s,height:r}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(s,r)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const n=this._layers;for(t=0;t<n.length&&n[t].z<=0;++t)n[t].draw(this.chartArea);for(this._drawDatasets();t<n.length;++t)n[t].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(t){const n=this._sortedMetasets,s=[];let r,i;for(r=0,i=n.length;r<i;++r){const o=n[r];(!t||o.visible)&&s.push(o)}return s}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const t=this.getSortedVisibleDatasetMetas();for(let n=t.length-1;n>=0;--n)this._drawDataset(t[n]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(t){const n=this.ctx,s={meta:t,index:t.index,cancelable:!0},r=EHe(this,t);this.notifyPlugins("beforeDatasetDraw",s)!==!1&&(r&&p3(n,r),t.controller.draw(),r&&x3(n),s.cancelable=!1,this.notifyPlugins("afterDatasetDraw",s))}isPointInArea(t){return nx(t,this.chartArea,this._minPadding)}getElementsAtEventForMode(t,n,s,r){const i=u9e.modes[n];return typeof i=="function"?i(this,t,s,r):[]}getDatasetMeta(t){const n=this.data.datasets[t],s=this._metasets;let r=s.filter(i=>i&&i._dataset===n).pop();return r||(r={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:n&&n.order||0,index:t,_dataset:n,_parsed:[],_sorted:!1},s.push(r)),r}getContext(){return this.$context||(this.$context=hm(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(t){const n=this.data.datasets[t];if(!n)return!1;const s=this.getDatasetMeta(t);return typeof s.hidden=="boolean"?!s.hidden:!n.hidden}setDatasetVisibility(t,n){const s=this.getDatasetMeta(t);s.hidden=!n}toggleDataVisibility(t){this._hiddenIndices[t]=!this._hiddenIndices[t]}getDataVisibility(t){return!this._hiddenIndices[t]}_updateVisibility(t,n,s){const r=s?"show":"hide",i=this.getDatasetMeta(t),o=i.controller._resolveAnimations(void 0,r);ex(n)?(i.data[n].hidden=!s,this.update()):(this.setDatasetVisibility(t,s),o.update(i,{visible:s}),this.update(l=>l.datasetIndex===t?r:void 0))}hide(t,n){this._updateVisibility(t,n,!1)}show(t,n){this._updateVisibility(t,n,!0)}_destroyDatasetMeta(t){const n=this._metasets[t];n&&n.controller&&n.controller._destroy(),delete this._metasets[t]}_stop(){let t,n;for(this.stop(),Cl.remove(this),t=0,n=this.data.datasets.length;t<n;++t)this._destroyDatasetMeta(t)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:t,ctx:n}=this;this._stop(),this.config.clearCache(),t&&(this.unbindEvents(),nB(t,n),this.platform.releaseContext(n),this.canvas=null,this.ctx=null),delete Av[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...t){return this.canvas.toDataURL(...t)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const t=this._listeners,n=this.platform,s=(i,o)=>{n.addEventListener(this,i,o),t[i]=o},r=(i,o,l)=>{i.offsetX=o,i.offsetY=l,this._eventHandler(i)};Ra(this.options.events,i=>s(i,r))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const t=this._responsiveListeners,n=this.platform,s=(c,u)=>{n.addEventListener(this,c,u),t[c]=u},r=(c,u)=>{t[c]&&(n.removeEventListener(this,c,u),delete t[c])},i=(c,u)=>{this.canvas&&this.resize(c,u)};let o;const l=()=>{r("attach",l),this.attached=!0,this.resize(),s("resize",i),s("detach",o)};o=()=>{this.attached=!1,r("resize",i),this._stop(),this._resize(0,0),s("attach",l)},n.isAttached(this.canvas)?l():o()}unbindEvents(){Ra(this._listeners,(t,n)=>{this.platform.removeEventListener(this,n,t)}),this._listeners={},Ra(this._responsiveListeners,(t,n)=>{this.platform.removeEventListener(this,n,t)}),this._responsiveListeners=void 0}updateHoverStyle(t,n,s){const r=s?"set":"remove";let i,o,l,c;for(n==="dataset"&&(i=this.getDatasetMeta(t[0].datasetIndex),i.controller["_"+r+"DatasetHoverStyle"]()),l=0,c=t.length;l<c;++l){o=t[l];const u=o&&this.getDatasetMeta(o.datasetIndex).controller;u&&u[r+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(t){const n=this._active||[],s=t.map(({datasetIndex:i,index:o})=>{const l=this.getDatasetMeta(i);if(!l)throw new Error("No dataset found at index "+i);return{datasetIndex:i,element:l.data[o],index:o}});!tj(s,n)&&(this._active=s,this._lastEvent=null,this._updateHoverStyles(s,n))}notifyPlugins(t,n,s){return this._plugins.notify(this,t,n,s)}isPluginEnabled(t){return this._plugins._cache.filter(n=>n.plugin.id===t).length===1}_updateHoverStyles(t,n,s){const r=this.options.hover,i=(c,u)=>c.filter(d=>!u.some(h=>d.datasetIndex===h.datasetIndex&&d.index===h.index)),o=i(n,t),l=s?t:i(t,n);o.length&&this.updateHoverStyle(o,r.mode,!1),l.length&&r.mode&&this.updateHoverStyle(l,r.mode,!0)}_eventHandler(t,n){const s={event:t,replay:n,cancelable:!0,inChartArea:this.isPointInArea(t)},r=o=>(o.options.events||this.options.events).includes(t.native.type);if(this.notifyPlugins("beforeEvent",s,r)===!1)return;const i=this._handleEvent(t,n,s.inChartArea);return s.cancelable=!1,this.notifyPlugins("afterEvent",s,r),(i||s.changed)&&this.render(),this}_handleEvent(t,n,s){const{_active:r=[],options:i}=this,o=n,l=this._getActiveElements(t,r,s,o),c=uBe(t),u=hqe(t,this._lastEvent,s,c);s&&(this._lastEvent=null,an(i.onHover,[t,l,this],this),c&&an(i.onClick,[t,l,this],this));const d=!tj(l,r);return(d||n)&&(this._active=l,this._updateHoverStyles(l,r,n)),this._lastEvent=u,d}_getActiveElements(t,n,s,r){if(t.type==="mouseout")return[];if(!s)return n;const i=this.options.hover;return this.getElementsAtEventForMode(t,i.mode,i,r)}};function RB(){return Ra(F1.instances,e=>e._plugins.invalidate())}function gqe(e,t,n){const{startAngle:s,x:r,y:i,outerRadius:o,innerRadius:l,options:c}=t,{borderWidth:u,borderJoinStyle:d}=c,h=Math.min(u/o,Ui(s-n));if(e.beginPath(),e.arc(r,i,o-u/2,s+h/2,n-h/2),l>0){const p=Math.min(u/l,Ui(s-n));e.arc(r,i,l+u/2,n-p/2,s+p/2,!0)}else{const p=Math.min(u/2,o*Ui(s-n));if(d==="round")e.arc(r,i,p,n-Fa/2,s+Fa/2,!0);else if(d==="bevel"){const x=2*p*p,b=-x*Math.cos(n+Fa/2)+r,j=-x*Math.sin(n+Fa/2)+i,y=x*Math.cos(s+Fa/2)+r,N=x*Math.sin(s+Fa/2)+i;e.lineTo(b,j),e.lineTo(y,N)}}e.closePath(),e.moveTo(0,0),e.rect(0,0,e.canvas.width,e.canvas.height),e.clip("evenodd")}function pqe(e,t,n){const{startAngle:s,pixelMargin:r,x:i,y:o,outerRadius:l,innerRadius:c}=t;let u=r/l;e.beginPath(),e.arc(i,o,l,s-u,n+u),c>r?(u=r/c,e.arc(i,o,c,n+u,s-u,!0)):e.arc(i,o,r,n+os,s-os),e.closePath(),e.clip()}function xqe(e){return y3(e,["outerStart","outerEnd","innerStart","innerEnd"])}function yqe(e,t,n,s){const r=xqe(e.options.borderRadius),i=(n-t)/2,o=Math.min(i,s*t/2),l=c=>{const u=(n-Math.min(i,c))*s/2;return Rs(c,0,Math.min(i,u))};return{outerStart:l(r.outerStart),outerEnd:l(r.outerEnd),innerStart:Rs(r.innerStart,0,o),innerEnd:Rs(r.innerEnd,0,o)}}function mf(e,t,n,s){return{x:n+e*Math.cos(t),y:s+e*Math.sin(t)}}function oj(e,t,n,s,r,i){const{x:o,y:l,startAngle:c,pixelMargin:u,innerRadius:d}=t,h=Math.max(t.outerRadius+s+n-u,0),p=d>0?d+s+n+u:0;let x=0;const b=r-c;if(s){const $=d>0?d-s:0,W=h>0?h-s:0,Z=($+W)/2,Q=Z!==0?b*Z/(Z+s):b;x=(b-Q)/2}const j=Math.max(.001,b*h-n/Fa)/h,y=(b-j)/2,N=c+y+x,w=r-y-x,{outerStart:S,outerEnd:_,innerStart:T,innerEnd:k}=yqe(t,p,h,w-N),A=h-S,E=h-_,M=N+S/A,F=w-_/E,D=p+T,P=p+k,B=N+T/D,G=w-k/P;if(e.beginPath(),i){const $=(M+F)/2;if(e.arc(o,l,h,M,$),e.arc(o,l,h,$,F),_>0){const le=mf(E,F,o,l);e.arc(le.x,le.y,_,F,w+os)}const W=mf(P,w,o,l);if(e.lineTo(W.x,W.y),k>0){const le=mf(P,G,o,l);e.arc(le.x,le.y,k,w+os,G+Math.PI)}const Z=(w-k/p+(N+T/p))/2;if(e.arc(o,l,p,w-k/p,Z,!0),e.arc(o,l,p,Z,N+T/p,!0),T>0){const le=mf(D,B,o,l);e.arc(le.x,le.y,T,B+Math.PI,N-os)}const Q=mf(A,N,o,l);if(e.lineTo(Q.x,Q.y),S>0){const le=mf(A,M,o,l);e.arc(le.x,le.y,S,N-os,M)}}else{e.moveTo(o,l);const $=Math.cos(M)*h+o,W=Math.sin(M)*h+l;e.lineTo($,W);const Z=Math.cos(F)*h+o,Q=Math.sin(F)*h+l;e.lineTo(Z,Q)}e.closePath()}function bqe(e,t,n,s,r){const{fullCircles:i,startAngle:o,circumference:l}=t;let c=t.endAngle;if(i){oj(e,t,n,s,c,r);for(let u=0;u<i;++u)e.fill();isNaN(l)||(c=o+(l%_n||_n))}return oj(e,t,n,s,c,r),e.fill(),c}function vqe(e,t,n,s,r){const{fullCircles:i,startAngle:o,circumference:l,options:c}=t,{borderWidth:u,borderJoinStyle:d,borderDash:h,borderDashOffset:p,borderRadius:x}=c,b=c.borderAlign==="inner";if(!u)return;e.setLineDash(h||[]),e.lineDashOffset=p,b?(e.lineWidth=u*2,e.lineJoin=d||"round"):(e.lineWidth=u,e.lineJoin=d||"bevel");let j=t.endAngle;if(i){oj(e,t,n,s,j,r);for(let y=0;y<i;++y)e.stroke();isNaN(l)||(j=o+(l%_n||_n))}b&&pqe(e,t,j),c.selfJoin&&j-o>=Fa&&x===0&&d!=="miter"&&gqe(e,t,j),i||(oj(e,t,n,s,j,r),e.stroke())}class wqe extends hc{static id="arc";static defaults={borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1};static defaultRoutes={backgroundColor:"backgroundColor"};static descriptors={_scriptable:!0,_indexable:t=>t!=="borderDash"};circumference;endAngle;fullCircles;innerRadius;outerRadius;pixelMargin;startAngle;constructor(t){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,t&&Object.assign(this,t)}inRange(t,n,s){const r=this.getProps(["x","y"],s),{angle:i,distance:o}=FJ(r,{x:t,y:n}),{startAngle:l,endAngle:c,innerRadius:u,outerRadius:d,circumference:h}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],s),p=(this.options.spacing+this.options.borderWidth)/2,x=ma(h,c-l),b=ax(i,l,c)&&l!==c,j=x>=_n||b,y=rd(o,u+p,d+p);return j&&y}getCenterPoint(t){const{x:n,y:s,startAngle:r,endAngle:i,innerRadius:o,outerRadius:l}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],t),{offset:c,spacing:u}=this.options,d=(r+i)/2,h=(o+l+u+c)/2;return{x:n+Math.cos(d)*h,y:s+Math.sin(d)*h}}tooltipPosition(t){return this.getCenterPoint(t)}draw(t){const{options:n,circumference:s}=this,r=(n.offset||0)/4,i=(n.spacing||0)/2,o=n.circular;if(this.pixelMargin=n.borderAlign==="inner"?.33:0,this.fullCircles=s>_n?Math.floor(s/_n):0,s===0||this.innerRadius<0||this.outerRadius<0)return;t.save();const l=(this.startAngle+this.endAngle)/2;t.translate(Math.cos(l)*r,Math.sin(l)*r);const c=1-Math.sin(Math.min(Fa,s||0)),u=r*c;t.fillStyle=n.backgroundColor,t.strokeStyle=n.borderColor,bqe(t,this,u,i,o),vqe(t,this,u,i,o),t.restore()}}function hee(e,t,n=t){e.lineCap=ma(n.borderCapStyle,t.borderCapStyle),e.setLineDash(ma(n.borderDash,t.borderDash)),e.lineDashOffset=ma(n.borderDashOffset,t.borderDashOffset),e.lineJoin=ma(n.borderJoinStyle,t.borderJoinStyle),e.lineWidth=ma(n.borderWidth,t.borderWidth),e.strokeStyle=ma(n.borderColor,t.borderColor)}function jqe(e,t,n){e.lineTo(n.x,n.y)}function Nqe(e){return e.stepped?RBe:e.tension||e.cubicInterpolationMode==="monotone"?zBe:jqe}function gee(e,t,n={}){const s=e.length,{start:r=0,end:i=s-1}=n,{start:o,end:l}=t,c=Math.max(r,o),u=Math.min(i,l),d=r<o&&i<o||r>l&&i>l;return{count:s,start:c,loop:t.loop,ilen:u<c&&!d?s+u-c:u-c}}function Cqe(e,t,n,s){const{points:r,options:i}=t,{count:o,start:l,loop:c,ilen:u}=gee(r,n,s),d=Nqe(i);let{move:h=!0,reverse:p}=s||{},x,b,j;for(x=0;x<=u;++x)b=r[(l+(p?u-x:x))%o],!b.skip&&(h?(e.moveTo(b.x,b.y),h=!1):d(e,j,b,p,i.stepped),j=b);return c&&(b=r[(l+(p?u:0))%o],d(e,j,b,p,i.stepped)),!!c}function Sqe(e,t,n,s){const r=t.points,{count:i,start:o,ilen:l}=gee(r,n,s),{move:c=!0,reverse:u}=s||{};let d=0,h=0,p,x,b,j,y,N;const w=_=>(o+(u?l-_:_))%i,S=()=>{j!==y&&(e.lineTo(d,y),e.lineTo(d,j),e.lineTo(d,N))};for(c&&(x=r[w(0)],e.moveTo(x.x,x.y)),p=0;p<=l;++p){if(x=r[w(p)],x.skip)continue;const _=x.x,T=x.y,k=_|0;k===b?(T<j?j=T:T>y&&(y=T),d=(h*d+_)/++h):(S(),e.lineTo(_,T),b=k,h=0,j=y=T),N=T}S()}function gL(e){const t=e.options,n=t.borderDash&&t.borderDash.length;return!e._decimated&&!e._loop&&!t.tension&&t.cubicInterpolationMode!=="monotone"&&!t.stepped&&!n?Sqe:Cqe}function _qe(e){return e.stepped?xHe:e.tension||e.cubicInterpolationMode==="monotone"?yHe:du}function Aqe(e,t,n,s){let r=t._path;r||(r=t._path=new Path2D,t.path(r,n,s)&&r.closePath()),hee(e,t.options),e.stroke(r)}function Tqe(e,t,n,s){const{segments:r,options:i}=t,o=gL(t);for(const l of r)hee(e,i,l.style),e.beginPath(),o(e,t,l,{start:n,end:n+s-1})&&e.closePath(),e.stroke()}const kqe=typeof Path2D=="function";function Eqe(e,t,n,s){kqe&&!t.options.segment?Aqe(e,t,n,s):Tqe(e,t,n,s)}class Lqe extends hc{static id="line";static defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};static descriptors={_scriptable:!0,_indexable:t=>t!=="borderDash"&&t!=="fill"};constructor(t){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,t&&Object.assign(this,t)}updateControlPoints(t,n){const s=this.options;if((s.tension||s.cubicInterpolationMode==="monotone")&&!s.stepped&&!this._pointsUpdated){const r=s.spanGaps?this._loop:this._fullLoop;cHe(this._points,s,t,r,n),this._pointsUpdated=!0}}set points(t){this._points=t,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=_He(this,this.options.segment))}first(){const t=this.segments,n=this.points;return t.length&&n[t[0].start]}last(){const t=this.segments,n=this.points,s=t.length;return s&&n[t[s-1].end]}interpolate(t,n){const s=this.options,r=t[n],i=this.points,o=NHe(this,{property:n,start:r,end:r});if(!o.length)return;const l=[],c=_qe(s);let u,d;for(u=0,d=o.length;u<d;++u){const{start:h,end:p}=o[u],x=i[h],b=i[p];if(x===b){l.push(x);continue}const j=Math.abs((r-x[n])/(b[n]-x[n])),y=c(x,b,j,s.stepped);y[n]=t[n],l.push(y)}return l.length===1?l[0]:l}pathSegment(t,n,s){return gL(this)(t,this,n,s)}path(t,n,s){const r=this.segments,i=gL(this);let o=this._loop;n=n||0,s=s||this.points.length-n;for(const l of r)o&=i(t,this,l,{start:n,end:n+s-1});return!!o}draw(t,n,s,r){const i=this.options||{};(this.points||[]).length&&i.borderWidth&&(t.save(),Eqe(t,this,s,r),t.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}function zB(e,t,n,s){const r=e.options,{[n]:i}=e.getProps([n],s);return Math.abs(t-i)<r.radius+r.hitRadius}class Dqe extends hc{static id="point";parsed;skip;stop;static defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(t){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,t&&Object.assign(this,t)}inRange(t,n,s){const r=this.options,{x:i,y:o}=this.getProps(["x","y"],s);return Math.pow(t-i,2)+Math.pow(n-o,2)<Math.pow(r.hitRadius+r.radius,2)}inXRange(t,n){return zB(this,t,"x",n)}inYRange(t,n){return zB(this,t,"y",n)}getCenterPoint(t){const{x:n,y:s}=this.getProps(["x","y"],t);return{x:n,y:s}}size(t){t=t||this.options||{};let n=t.radius||0;n=Math.max(n,n&&t.hoverRadius||0);const s=n&&t.borderWidth||0;return(n+s)*2}draw(t,n){const s=this.options;this.skip||s.radius<.1||!nx(this,n,this.size(s)/2)||(t.strokeStyle=s.borderColor,t.lineWidth=s.borderWidth,t.fillStyle=s.backgroundColor,mL(t,s,this.x,this.y))}getRange(){const t=this.options||{};return t.radius+t.hitRadius}}function pee(e,t){const{x:n,y:s,base:r,width:i,height:o}=e.getProps(["x","y","base","width","height"],t);let l,c,u,d,h;return e.horizontal?(h=o/2,l=Math.min(n,r),c=Math.max(n,r),u=s-h,d=s+h):(h=i/2,l=n-h,c=n+h,u=Math.min(s,r),d=Math.max(s,r)),{left:l,top:u,right:c,bottom:d}}function od(e,t,n,s){return e?0:Rs(t,n,s)}function Pqe(e,t,n){const s=e.options.borderWidth,r=e.borderSkipped,i=VJ(s);return{t:od(r.top,i.top,0,n),r:od(r.right,i.right,0,t),b:od(r.bottom,i.bottom,0,n),l:od(r.left,i.left,0,t)}}function Oqe(e,t,n){const{enableBorderRadius:s}=e.getProps(["enableBorderRadius"]),r=e.options.borderRadius,i=Tf(r),o=Math.min(t,n),l=e.borderSkipped,c=s||Na(r);return{topLeft:od(!c||l.top||l.left,i.topLeft,0,o),topRight:od(!c||l.top||l.right,i.topRight,0,o),bottomLeft:od(!c||l.bottom||l.left,i.bottomLeft,0,o),bottomRight:od(!c||l.bottom||l.right,i.bottomRight,0,o)}}function Mqe(e){const t=pee(e),n=t.right-t.left,s=t.bottom-t.top,r=Pqe(e,n/2,s/2),i=Oqe(e,n/2,s/2);return{outer:{x:t.left,y:t.top,w:n,h:s,radius:i},inner:{x:t.left+r.l,y:t.top+r.t,w:n-r.l-r.r,h:s-r.t-r.b,radius:{topLeft:Math.max(0,i.topLeft-Math.max(r.t,r.l)),topRight:Math.max(0,i.topRight-Math.max(r.t,r.r)),bottomLeft:Math.max(0,i.bottomLeft-Math.max(r.b,r.l)),bottomRight:Math.max(0,i.bottomRight-Math.max(r.b,r.r))}}}}function TT(e,t,n,s){const r=t===null,i=n===null,l=e&&!(r&&i)&&pee(e,s);return l&&(r||rd(t,l.left,l.right))&&(i||rd(n,l.top,l.bottom))}function Iqe(e){return e.topLeft||e.topRight||e.bottomLeft||e.bottomRight}function $qe(e,t){e.rect(t.x,t.y,t.w,t.h)}function kT(e,t,n={}){const s=e.x!==n.x?-t:0,r=e.y!==n.y?-t:0,i=(e.x+e.w!==n.x+n.w?t:0)-s,o=(e.y+e.h!==n.y+n.h?t:0)-r;return{x:e.x+s,y:e.y+r,w:e.w+i,h:e.h+o,radius:e.radius}}class Rqe extends hc{static id="bar";static defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(t){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,t&&Object.assign(this,t)}draw(t){const{inflateAmount:n,options:{borderColor:s,backgroundColor:r}}=this,{inner:i,outer:o}=Mqe(this),l=Iqe(o.radius)?sj:$qe;t.save(),(o.w!==i.w||o.h!==i.h)&&(t.beginPath(),l(t,kT(o,n,i)),t.clip(),l(t,kT(i,-n,o)),t.fillStyle=s,t.fill("evenodd")),t.beginPath(),l(t,kT(i,n)),t.fillStyle=r,t.fill(),t.restore()}inRange(t,n,s){return TT(this,t,n,s)}inXRange(t,n){return TT(this,t,null,n)}inYRange(t,n){return TT(this,null,t,n)}getCenterPoint(t){const{x:n,y:s,base:r,horizontal:i}=this.getProps(["x","y","base","horizontal"],t);return{x:i?(n+r)/2:n,y:i?s:(s+r)/2}}getRange(t){return t==="x"?this.width/2:this.height/2}}const FB=(e,t)=>{let{boxHeight:n=t,boxWidth:s=t}=e;return e.usePointStyle&&(n=Math.min(n,t),s=e.pointStyleWidth||Math.min(s,t)),{boxWidth:s,boxHeight:n,itemHeight:Math.max(t,n)}},zqe=(e,t)=>e!==null&&t!==null&&e.datasetIndex===t.datasetIndex&&e.index===t.index;class UB extends hc{constructor(t){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,n,s){this.maxWidth=t,this.maxHeight=n,this._margins=s,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const t=this.options.labels||{};let n=an(t.generateLabels,[this.chart],this)||[];t.filter&&(n=n.filter(s=>t.filter(s,this.chart.data))),t.sort&&(n=n.sort((s,r)=>t.sort(s,r,this.chart.data))),this.options.reverse&&n.reverse(),this.legendItems=n}fit(){const{options:t,ctx:n}=this;if(!t.display){this.width=this.height=0;return}const s=t.labels,r=zs(s.font),i=r.size,o=this._computeTitleHeight(),{boxWidth:l,itemHeight:c}=FB(s,i);let u,d;n.font=r.string,this.isHorizontal()?(u=this.maxWidth,d=this._fitRows(o,i,l,c)+10):(d=this.maxHeight,u=this._fitCols(o,r,l,c)+10),this.width=Math.min(u,t.maxWidth||this.maxWidth),this.height=Math.min(d,t.maxHeight||this.maxHeight)}_fitRows(t,n,s,r){const{ctx:i,maxWidth:o,options:{labels:{padding:l}}}=this,c=this.legendHitBoxes=[],u=this.lineWidths=[0],d=r+l;let h=t;i.textAlign="left",i.textBaseline="middle";let p=-1,x=-d;return this.legendItems.forEach((b,j)=>{const y=s+n/2+i.measureText(b.text).width;(j===0||u[u.length-1]+y+2*l>o)&&(h+=d,u[u.length-(j>0?0:1)]=0,x+=d,p++),c[j]={left:0,top:x,row:p,width:y,height:r},u[u.length-1]+=y+l}),h}_fitCols(t,n,s,r){const{ctx:i,maxHeight:o,options:{labels:{padding:l}}}=this,c=this.legendHitBoxes=[],u=this.columnSizes=[],d=o-t;let h=l,p=0,x=0,b=0,j=0;return this.legendItems.forEach((y,N)=>{const{itemWidth:w,itemHeight:S}=Fqe(s,n,i,y,r);N>0&&x+S+2*l>d&&(h+=p+l,u.push({width:p,height:x}),b+=p+l,j++,p=x=0),c[N]={left:b,top:x,col:j,width:w,height:S},p=Math.max(p,w),x+=S+l}),h+=p,u.push({width:p,height:x}),h}adjustHitBoxes(){if(!this.options.display)return;const t=this._computeTitleHeight(),{legendHitBoxes:n,options:{align:s,labels:{padding:r},rtl:i}}=this,o=kf(i,this.left,this.width);if(this.isHorizontal()){let l=0,c=Os(s,this.left+r,this.right-this.lineWidths[l]);for(const u of n)l!==u.row&&(l=u.row,c=Os(s,this.left+r,this.right-this.lineWidths[l])),u.top+=this.top+t+r,u.left=o.leftForLtr(o.x(c),u.width),c+=u.width+r}else{let l=0,c=Os(s,this.top+t+r,this.bottom-this.columnSizes[l].height);for(const u of n)u.col!==l&&(l=u.col,c=Os(s,this.top+t+r,this.bottom-this.columnSizes[l].height)),u.top=c,u.left+=this.left+r,u.left=o.leftForLtr(o.x(u.left),u.width),c+=u.height+r}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const t=this.ctx;p3(t,this),this._draw(),x3(t)}}_draw(){const{options:t,columnSizes:n,lineWidths:s,ctx:r}=this,{align:i,labels:o}=t,l=On.color,c=kf(t.rtl,this.left,this.width),u=zs(o.font),{padding:d}=o,h=u.size,p=h/2;let x;this.drawTitle(),r.textAlign=c.textAlign("left"),r.textBaseline="middle",r.lineWidth=.5,r.font=u.string;const{boxWidth:b,boxHeight:j,itemHeight:y}=FB(o,h),N=function(k,A,E){if(isNaN(b)||b<=0||isNaN(j)||j<0)return;r.save();const M=ma(E.lineWidth,1);if(r.fillStyle=ma(E.fillStyle,l),r.lineCap=ma(E.lineCap,"butt"),r.lineDashOffset=ma(E.lineDashOffset,0),r.lineJoin=ma(E.lineJoin,"miter"),r.lineWidth=M,r.strokeStyle=ma(E.strokeStyle,l),r.setLineDash(ma(E.lineDash,[])),o.usePointStyle){const F={radius:j*Math.SQRT2/2,pointStyle:E.pointStyle,rotation:E.rotation,borderWidth:M},D=c.xPlus(k,b/2),P=A+p;WJ(r,F,D,P,o.pointStyleWidth&&b)}else{const F=A+Math.max((h-j)/2,0),D=c.leftForLtr(k,b),P=Tf(E.borderRadius);r.beginPath(),Object.values(P).some(B=>B!==0)?sj(r,{x:D,y:F,w:b,h:j,radius:P}):r.rect(D,F,b,j),r.fill(),M!==0&&r.stroke()}r.restore()},w=function(k,A,E){sx(r,E.text,k,A+y/2,u,{strikethrough:E.hidden,textAlign:c.textAlign(E.textAlign)})},S=this.isHorizontal(),_=this._computeTitleHeight();S?x={x:Os(i,this.left+d,this.right-s[0]),y:this.top+d+_,line:0}:x={x:this.left+d,y:Os(i,this.top+_+d,this.bottom-n[0].height),line:0},JJ(this.ctx,t.textDirection);const T=y+d;this.legendItems.forEach((k,A)=>{r.strokeStyle=k.fontColor,r.fillStyle=k.fontColor;const E=r.measureText(k.text).width,M=c.textAlign(k.textAlign||(k.textAlign=o.textAlign)),F=b+p+E;let D=x.x,P=x.y;c.setWidth(this.width),S?A>0&&D+F+d>this.right&&(P=x.y+=T,x.line++,D=x.x=Os(i,this.left+d,this.right-s[x.line])):A>0&&P+T>this.bottom&&(D=x.x=D+n[x.line].width+d,x.line++,P=x.y=Os(i,this.top+_+d,this.bottom-n[x.line].height));const B=c.x(D);if(N(B,P,k),D=SBe(M,D+b+p,S?D+F:this.right,t.rtl),w(c.x(D),P,k),S)x.x+=F+d;else if(typeof k.text!="string"){const G=u.lineHeight;x.y+=xee(k,G)+d}else x.y+=T}),eee(this.ctx,t.textDirection)}drawTitle(){const t=this.options,n=t.title,s=zs(n.font),r=Si(n.padding);if(!n.display)return;const i=kf(t.rtl,this.left,this.width),o=this.ctx,l=n.position,c=s.size/2,u=r.top+c;let d,h=this.left,p=this.width;if(this.isHorizontal())p=Math.max(...this.lineWidths),d=this.top+u,h=Os(t.align,h,this.right-p);else{const b=this.columnSizes.reduce((j,y)=>Math.max(j,y.height),0);d=u+Os(t.align,this.top,this.bottom-b-t.labels.padding-this._computeTitleHeight())}const x=Os(l,h,h+p);o.textAlign=i.textAlign(f3(l)),o.textBaseline="middle",o.strokeStyle=n.color,o.fillStyle=n.color,o.font=s.string,sx(o,n.text,x,d,s)}_computeTitleHeight(){const t=this.options.title,n=zs(t.font),s=Si(t.padding);return t.display?n.lineHeight+s.height:0}_getLegendItemAt(t,n){let s,r,i;if(rd(t,this.left,this.right)&&rd(n,this.top,this.bottom)){for(i=this.legendHitBoxes,s=0;s<i.length;++s)if(r=i[s],rd(t,r.left,r.left+r.width)&&rd(n,r.top,r.top+r.height))return this.legendItems[s]}return null}handleEvent(t){const n=this.options;if(!Hqe(t.type,n))return;const s=this._getLegendItemAt(t.x,t.y);if(t.type==="mousemove"||t.type==="mouseout"){const r=this._hoveredItem,i=zqe(r,s);r&&!i&&an(n.onLeave,[t,r,this],this),this._hoveredItem=s,s&&!i&&an(n.onHover,[t,s,this],this)}else s&&an(n.onClick,[t,s,this],this)}}function Fqe(e,t,n,s,r){const i=Uqe(s,e,t,n),o=Bqe(r,s,t.lineHeight);return{itemWidth:i,itemHeight:o}}function Uqe(e,t,n,s){let r=e.text;return r&&typeof r!="string"&&(r=r.reduce((i,o)=>i.length>o.length?i:o)),t+n.size/2+s.measureText(r).width}function Bqe(e,t,n){let s=e;return typeof t.text!="string"&&(s=xee(t,n)),s}function xee(e,t){const n=e.text?e.text.length:0;return t*n}function Hqe(e,t){return!!((e==="mousemove"||e==="mouseout")&&(t.onHover||t.onLeave)||t.onClick&&(e==="click"||e==="mouseup"))}var qqe={id:"legend",_element:UB,start(e,t,n){const s=e.legend=new UB({ctx:e.ctx,options:n,chart:e});pi.configure(e,s,n),pi.addBox(e,s)},stop(e){pi.removeBox(e,e.legend),delete e.legend},beforeUpdate(e,t,n){const s=e.legend;pi.configure(e,s,n),s.options=n},afterUpdate(e){const t=e.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent(e,t){t.replay||e.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(e,t,n){const s=t.datasetIndex,r=n.chart;r.isDatasetVisible(s)?(r.hide(s),t.hidden=!0):(r.show(s),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:e=>e.chart.options.color,boxWidth:40,padding:10,generateLabels(e){const t=e.data.datasets,{labels:{usePointStyle:n,pointStyle:s,textAlign:r,color:i,useBorderRadius:o,borderRadius:l}}=e.legend.options;return e._getSortedDatasetMetas().map(c=>{const u=c.controller.getStyle(n?0:void 0),d=Si(u.borderWidth);return{text:t[c.index].label,fillStyle:u.backgroundColor,fontColor:i,hidden:!c.visible,lineCap:u.borderCapStyle,lineDash:u.borderDash,lineDashOffset:u.borderDashOffset,lineJoin:u.borderJoinStyle,lineWidth:(d.width+d.height)/4,strokeStyle:u.borderColor,pointStyle:s||u.pointStyle,rotation:u.rotation,textAlign:r||u.textAlign,borderRadius:o&&(l||u.borderRadius),datasetIndex:c.index}},this)}},title:{color:e=>e.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:e=>!e.startsWith("on"),labels:{_scriptable:e=>!["generateLabels","filter","sort"].includes(e)}}};class yee extends hc{constructor(t){super(),this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,n){const s=this.options;if(this.left=0,this.top=0,!s.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=t,this.height=this.bottom=n;const r=is(s.text)?s.text.length:1;this._padding=Si(s.padding);const i=r*zs(s.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=i:this.width=i}isHorizontal(){const t=this.options.position;return t==="top"||t==="bottom"}_drawArgs(t){const{top:n,left:s,bottom:r,right:i,options:o}=this,l=o.align;let c=0,u,d,h;return this.isHorizontal()?(d=Os(l,s,i),h=n+t,u=i-s):(o.position==="left"?(d=s+t,h=Os(l,r,n),c=Fa*-.5):(d=i-t,h=Os(l,n,r),c=Fa*.5),u=r-n),{titleX:d,titleY:h,maxWidth:u,rotation:c}}draw(){const t=this.ctx,n=this.options;if(!n.display)return;const s=zs(n.font),i=s.lineHeight/2+this._padding.top,{titleX:o,titleY:l,maxWidth:c,rotation:u}=this._drawArgs(i);sx(t,n.text,0,0,s,{color:n.color,maxWidth:c,rotation:u,textAlign:f3(n.align),textBaseline:"middle",translation:[o,l]})}}function Gqe(e,t){const n=new yee({ctx:e.ctx,options:t,chart:e});pi.configure(e,n,t),pi.addBox(e,n),e.titleBlock=n}var Wqe={id:"title",_element:yee,start(e,t,n){Gqe(e,n)},stop(e){const t=e.titleBlock;pi.removeBox(e,t),delete e.titleBlock},beforeUpdate(e,t,n){const s=e.titleBlock;pi.configure(e,s,n),s.options=n},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const sp={average(e){if(!e.length)return!1;let t,n,s=new Set,r=0,i=0;for(t=0,n=e.length;t<n;++t){const l=e[t].element;if(l&&l.hasValue()){const c=l.tooltipPosition();s.add(c.x),r+=c.y,++i}}return i===0||s.size===0?!1:{x:[...s].reduce((l,c)=>l+c)/s.size,y:r/i}},nearest(e,t){if(!e.length)return!1;let n=t.x,s=t.y,r=Number.POSITIVE_INFINITY,i,o,l;for(i=0,o=e.length;i<o;++i){const c=e[i].element;if(c&&c.hasValue()){const u=c.getCenterPoint(),d=dL(t,u);d<r&&(r=d,l=c)}}if(l){const c=l.tooltipPosition();n=c.x,s=c.y}return{x:n,y:s}}};function No(e,t){return t&&(is(t)?Array.prototype.push.apply(e,t):e.push(t)),e}function Sl(e){return(typeof e=="string"||e instanceof String)&&e.indexOf(`
`)>-1?e.split(`
`):e}function Vqe(e,t){const{element:n,datasetIndex:s,index:r}=t,i=e.getDatasetMeta(s).controller,{label:o,value:l}=i.getLabelAndValue(r);return{chart:e,label:o,parsed:i.getParsed(r),raw:e.data.datasets[s].data[r],formattedValue:l,dataset:i.getDataset(),dataIndex:r,datasetIndex:s,element:n}}function BB(e,t){const n=e.chart.ctx,{body:s,footer:r,title:i}=e,{boxWidth:o,boxHeight:l}=t,c=zs(t.bodyFont),u=zs(t.titleFont),d=zs(t.footerFont),h=i.length,p=r.length,x=s.length,b=Si(t.padding);let j=b.height,y=0,N=s.reduce((_,T)=>_+T.before.length+T.lines.length+T.after.length,0);if(N+=e.beforeBody.length+e.afterBody.length,h&&(j+=h*u.lineHeight+(h-1)*t.titleSpacing+t.titleMarginBottom),N){const _=t.displayColors?Math.max(l,c.lineHeight):c.lineHeight;j+=x*_+(N-x)*c.lineHeight+(N-1)*t.bodySpacing}p&&(j+=t.footerMarginTop+p*d.lineHeight+(p-1)*t.footerSpacing);let w=0;const S=function(_){y=Math.max(y,n.measureText(_).width+w)};return n.save(),n.font=u.string,Ra(e.title,S),n.font=c.string,Ra(e.beforeBody.concat(e.afterBody),S),w=t.displayColors?o+2+t.boxPadding:0,Ra(s,_=>{Ra(_.before,S),Ra(_.lines,S),Ra(_.after,S)}),w=0,n.font=d.string,Ra(e.footer,S),n.restore(),y+=b.width,{width:y,height:j}}function Yqe(e,t){const{y:n,height:s}=t;return n<s/2?"top":n>e.height-s/2?"bottom":"center"}function Qqe(e,t,n,s){const{x:r,width:i}=s,o=n.caretSize+n.caretPadding;if(e==="left"&&r+i+o>t.width||e==="right"&&r-i-o<0)return!0}function Kqe(e,t,n,s){const{x:r,width:i}=n,{width:o,chartArea:{left:l,right:c}}=e;let u="center";return s==="center"?u=r<=(l+c)/2?"left":"right":r<=i/2?u="left":r>=o-i/2&&(u="right"),Qqe(u,e,t,n)&&(u="center"),u}function HB(e,t,n){const s=n.yAlign||t.yAlign||Yqe(e,n);return{xAlign:n.xAlign||t.xAlign||Kqe(e,t,n,s),yAlign:s}}function Xqe(e,t){let{x:n,width:s}=e;return t==="right"?n-=s:t==="center"&&(n-=s/2),n}function Zqe(e,t,n){let{y:s,height:r}=e;return t==="top"?s+=n:t==="bottom"?s-=r+n:s-=r/2,s}function qB(e,t,n,s){const{caretSize:r,caretPadding:i,cornerRadius:o}=e,{xAlign:l,yAlign:c}=n,u=r+i,{topLeft:d,topRight:h,bottomLeft:p,bottomRight:x}=Tf(o);let b=Xqe(t,l);const j=Zqe(t,c,u);return c==="center"?l==="left"?b+=u:l==="right"&&(b-=u):l==="left"?b-=Math.max(d,p)+r:l==="right"&&(b+=Math.max(h,x)+r),{x:Rs(b,0,s.width-t.width),y:Rs(j,0,s.height-t.height)}}function Xb(e,t,n){const s=Si(n.padding);return t==="center"?e.x+e.width/2:t==="right"?e.x+e.width-s.right:e.x+s.left}function GB(e){return No([],Sl(e))}function Jqe(e,t,n){return hm(e,{tooltip:t,tooltipItems:n,type:"tooltip"})}function WB(e,t){const n=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return n?e.override(n):e}const bee={beforeTitle:jl,title(e){if(e.length>0){const t=e[0],n=t.chart.data.labels,s=n?n.length:0;if(this&&this.options&&this.options.mode==="dataset")return t.dataset.label||"";if(t.label)return t.label;if(s>0&&t.dataIndex<s)return n[t.dataIndex]}return""},afterTitle:jl,beforeBody:jl,beforeLabel:jl,label(e){if(this&&this.options&&this.options.mode==="dataset")return e.label+": "+e.formattedValue||e.formattedValue;let t=e.dataset.label||"";t&&(t+=": ");const n=e.formattedValue;return Pa(n)||(t+=n),t},labelColor(e){const n=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{borderColor:n.borderColor,backgroundColor:n.backgroundColor,borderWidth:n.borderWidth,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(e){const n=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{pointStyle:n.pointStyle,rotation:n.rotation}},afterLabel:jl,afterBody:jl,beforeFooter:jl,footer:jl,afterFooter:jl};function or(e,t,n,s){const r=e[t].call(n,s);return typeof r>"u"?bee[t].call(n,s):r}class VB extends hc{static positioners=sp;constructor(t){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=t.chart,this.options=t.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(t){this.options=t,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const t=this._cachedAnimations;if(t)return t;const n=this.chart,s=this.options.setContext(this.getContext()),r=s.enabled&&n.options.animation&&s.animations,i=new aee(this.chart,r);return r._cacheable&&(this._cachedAnimations=Object.freeze(i)),i}getContext(){return this.$context||(this.$context=Jqe(this.chart.getContext(),this,this._tooltipItems))}getTitle(t,n){const{callbacks:s}=n,r=or(s,"beforeTitle",this,t),i=or(s,"title",this,t),o=or(s,"afterTitle",this,t);let l=[];return l=No(l,Sl(r)),l=No(l,Sl(i)),l=No(l,Sl(o)),l}getBeforeBody(t,n){return GB(or(n.callbacks,"beforeBody",this,t))}getBody(t,n){const{callbacks:s}=n,r=[];return Ra(t,i=>{const o={before:[],lines:[],after:[]},l=WB(s,i);No(o.before,Sl(or(l,"beforeLabel",this,i))),No(o.lines,or(l,"label",this,i)),No(o.after,Sl(or(l,"afterLabel",this,i))),r.push(o)}),r}getAfterBody(t,n){return GB(or(n.callbacks,"afterBody",this,t))}getFooter(t,n){const{callbacks:s}=n,r=or(s,"beforeFooter",this,t),i=or(s,"footer",this,t),o=or(s,"afterFooter",this,t);let l=[];return l=No(l,Sl(r)),l=No(l,Sl(i)),l=No(l,Sl(o)),l}_createItems(t){const n=this._active,s=this.chart.data,r=[],i=[],o=[];let l=[],c,u;for(c=0,u=n.length;c<u;++c)l.push(Vqe(this.chart,n[c]));return t.filter&&(l=l.filter((d,h,p)=>t.filter(d,h,p,s))),t.itemSort&&(l=l.sort((d,h)=>t.itemSort(d,h,s))),Ra(l,d=>{const h=WB(t.callbacks,d);r.push(or(h,"labelColor",this,d)),i.push(or(h,"labelPointStyle",this,d)),o.push(or(h,"labelTextColor",this,d))}),this.labelColors=r,this.labelPointStyles=i,this.labelTextColors=o,this.dataPoints=l,l}update(t,n){const s=this.options.setContext(this.getContext()),r=this._active;let i,o=[];if(!r.length)this.opacity!==0&&(i={opacity:0});else{const l=sp[s.position].call(this,r,this._eventPosition);o=this._createItems(s),this.title=this.getTitle(o,s),this.beforeBody=this.getBeforeBody(o,s),this.body=this.getBody(o,s),this.afterBody=this.getAfterBody(o,s),this.footer=this.getFooter(o,s);const c=this._size=BB(this,s),u=Object.assign({},l,c),d=HB(this.chart,s,u),h=qB(s,u,d,this.chart);this.xAlign=d.xAlign,this.yAlign=d.yAlign,i={opacity:1,x:h.x,y:h.y,width:c.width,height:c.height,caretX:l.x,caretY:l.y}}this._tooltipItems=o,this.$context=void 0,i&&this._resolveAnimations().update(this,i),t&&s.external&&s.external.call(this,{chart:this.chart,tooltip:this,replay:n})}drawCaret(t,n,s,r){const i=this.getCaretPosition(t,s,r);n.lineTo(i.x1,i.y1),n.lineTo(i.x2,i.y2),n.lineTo(i.x3,i.y3)}getCaretPosition(t,n,s){const{xAlign:r,yAlign:i}=this,{caretSize:o,cornerRadius:l}=s,{topLeft:c,topRight:u,bottomLeft:d,bottomRight:h}=Tf(l),{x:p,y:x}=t,{width:b,height:j}=n;let y,N,w,S,_,T;return i==="center"?(_=x+j/2,r==="left"?(y=p,N=y-o,S=_+o,T=_-o):(y=p+b,N=y+o,S=_-o,T=_+o),w=y):(r==="left"?N=p+Math.max(c,d)+o:r==="right"?N=p+b-Math.max(u,h)-o:N=this.caretX,i==="top"?(S=x,_=S-o,y=N-o,w=N+o):(S=x+j,_=S+o,y=N+o,w=N-o),T=S),{x1:y,x2:N,x3:w,y1:S,y2:_,y3:T}}drawTitle(t,n,s){const r=this.title,i=r.length;let o,l,c;if(i){const u=kf(s.rtl,this.x,this.width);for(t.x=Xb(this,s.titleAlign,s),n.textAlign=u.textAlign(s.titleAlign),n.textBaseline="middle",o=zs(s.titleFont),l=s.titleSpacing,n.fillStyle=s.titleColor,n.font=o.string,c=0;c<i;++c)n.fillText(r[c],u.x(t.x),t.y+o.lineHeight/2),t.y+=o.lineHeight+l,c+1===i&&(t.y+=s.titleMarginBottom-l)}}_drawColorBox(t,n,s,r,i){const o=this.labelColors[s],l=this.labelPointStyles[s],{boxHeight:c,boxWidth:u}=i,d=zs(i.bodyFont),h=Xb(this,"left",i),p=r.x(h),x=c<d.lineHeight?(d.lineHeight-c)/2:0,b=n.y+x;if(i.usePointStyle){const j={radius:Math.min(u,c)/2,pointStyle:l.pointStyle,rotation:l.rotation,borderWidth:1},y=r.leftForLtr(p,u)+u/2,N=b+c/2;t.strokeStyle=i.multiKeyBackground,t.fillStyle=i.multiKeyBackground,mL(t,j,y,N),t.strokeStyle=o.borderColor,t.fillStyle=o.backgroundColor,mL(t,j,y,N)}else{t.lineWidth=Na(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,t.strokeStyle=o.borderColor,t.setLineDash(o.borderDash||[]),t.lineDashOffset=o.borderDashOffset||0;const j=r.leftForLtr(p,u),y=r.leftForLtr(r.xPlus(p,1),u-2),N=Tf(o.borderRadius);Object.values(N).some(w=>w!==0)?(t.beginPath(),t.fillStyle=i.multiKeyBackground,sj(t,{x:j,y:b,w:u,h:c,radius:N}),t.fill(),t.stroke(),t.fillStyle=o.backgroundColor,t.beginPath(),sj(t,{x:y,y:b+1,w:u-2,h:c-2,radius:N}),t.fill()):(t.fillStyle=i.multiKeyBackground,t.fillRect(j,b,u,c),t.strokeRect(j,b,u,c),t.fillStyle=o.backgroundColor,t.fillRect(y,b+1,u-2,c-2))}t.fillStyle=this.labelTextColors[s]}drawBody(t,n,s){const{body:r}=this,{bodySpacing:i,bodyAlign:o,displayColors:l,boxHeight:c,boxWidth:u,boxPadding:d}=s,h=zs(s.bodyFont);let p=h.lineHeight,x=0;const b=kf(s.rtl,this.x,this.width),j=function(E){n.fillText(E,b.x(t.x+x),t.y+p/2),t.y+=p+i},y=b.textAlign(o);let N,w,S,_,T,k,A;for(n.textAlign=o,n.textBaseline="middle",n.font=h.string,t.x=Xb(this,y,s),n.fillStyle=s.bodyColor,Ra(this.beforeBody,j),x=l&&y!=="right"?o==="center"?u/2+d:u+2+d:0,_=0,k=r.length;_<k;++_){for(N=r[_],w=this.labelTextColors[_],n.fillStyle=w,Ra(N.before,j),S=N.lines,l&&S.length&&(this._drawColorBox(n,t,_,b,s),p=Math.max(h.lineHeight,c)),T=0,A=S.length;T<A;++T)j(S[T]),p=h.lineHeight;Ra(N.after,j)}x=0,p=h.lineHeight,Ra(this.afterBody,j),t.y-=i}drawFooter(t,n,s){const r=this.footer,i=r.length;let o,l;if(i){const c=kf(s.rtl,this.x,this.width);for(t.x=Xb(this,s.footerAlign,s),t.y+=s.footerMarginTop,n.textAlign=c.textAlign(s.footerAlign),n.textBaseline="middle",o=zs(s.footerFont),n.fillStyle=s.footerColor,n.font=o.string,l=0;l<i;++l)n.fillText(r[l],c.x(t.x),t.y+o.lineHeight/2),t.y+=o.lineHeight+s.footerSpacing}}drawBackground(t,n,s,r){const{xAlign:i,yAlign:o}=this,{x:l,y:c}=t,{width:u,height:d}=s,{topLeft:h,topRight:p,bottomLeft:x,bottomRight:b}=Tf(r.cornerRadius);n.fillStyle=r.backgroundColor,n.strokeStyle=r.borderColor,n.lineWidth=r.borderWidth,n.beginPath(),n.moveTo(l+h,c),o==="top"&&this.drawCaret(t,n,s,r),n.lineTo(l+u-p,c),n.quadraticCurveTo(l+u,c,l+u,c+p),o==="center"&&i==="right"&&this.drawCaret(t,n,s,r),n.lineTo(l+u,c+d-b),n.quadraticCurveTo(l+u,c+d,l+u-b,c+d),o==="bottom"&&this.drawCaret(t,n,s,r),n.lineTo(l+x,c+d),n.quadraticCurveTo(l,c+d,l,c+d-x),o==="center"&&i==="left"&&this.drawCaret(t,n,s,r),n.lineTo(l,c+h),n.quadraticCurveTo(l,c,l+h,c),n.closePath(),n.fill(),r.borderWidth>0&&n.stroke()}_updateAnimationTarget(t){const n=this.chart,s=this.$animations,r=s&&s.x,i=s&&s.y;if(r||i){const o=sp[t.position].call(this,this._active,this._eventPosition);if(!o)return;const l=this._size=BB(this,t),c=Object.assign({},o,this._size),u=HB(n,t,c),d=qB(t,c,u,n);(r._to!==d.x||i._to!==d.y)&&(this.xAlign=u.xAlign,this.yAlign=u.yAlign,this.width=l.width,this.height=l.height,this.caretX=o.x,this.caretY=o.y,this._resolveAnimations().update(this,d))}}_willRender(){return!!this.opacity}draw(t){const n=this.options.setContext(this.getContext());let s=this.opacity;if(!s)return;this._updateAnimationTarget(n);const r={width:this.width,height:this.height},i={x:this.x,y:this.y};s=Math.abs(s)<.001?0:s;const o=Si(n.padding),l=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;n.enabled&&l&&(t.save(),t.globalAlpha=s,this.drawBackground(i,t,r,n),JJ(t,n.textDirection),i.y+=o.top,this.drawTitle(i,t,n),this.drawBody(i,t,n),this.drawFooter(i,t,n),eee(t,n.textDirection),t.restore())}getActiveElements(){return this._active||[]}setActiveElements(t,n){const s=this._active,r=t.map(({datasetIndex:l,index:c})=>{const u=this.chart.getDatasetMeta(l);if(!u)throw new Error("Cannot find a dataset at index "+l);return{datasetIndex:l,element:u.data[c],index:c}}),i=!tj(s,r),o=this._positionChanged(r,n);(i||o)&&(this._active=r,this._eventPosition=n,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(t,n,s=!0){if(n&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const r=this.options,i=this._active||[],o=this._getActiveElements(t,i,n,s),l=this._positionChanged(o,t),c=n||!tj(o,i)||l;return c&&(this._active=o,(r.enabled||r.external)&&(this._eventPosition={x:t.x,y:t.y},this.update(!0,n))),c}_getActiveElements(t,n,s,r){const i=this.options;if(t.type==="mouseout")return[];if(!r)return n.filter(l=>this.chart.data.datasets[l.datasetIndex]&&this.chart.getDatasetMeta(l.datasetIndex).controller.getParsed(l.index)!==void 0);const o=this.chart.getElementsAtEventForMode(t,i.mode,i,s);return i.reverse&&o.reverse(),o}_positionChanged(t,n){const{caretX:s,caretY:r,options:i}=this,o=sp[i.position].call(this,t,n);return o!==!1&&(s!==o.x||r!==o.y)}}var eGe={id:"tooltip",_element:VB,positioners:sp,afterInit(e,t,n){n&&(e.tooltip=new VB({chart:e,options:n}))},beforeUpdate(e,t,n){e.tooltip&&e.tooltip.initialize(n)},reset(e,t,n){e.tooltip&&e.tooltip.initialize(n)},afterDraw(e){const t=e.tooltip;if(t&&t._willRender()){const n={tooltip:t};if(e.notifyPlugins("beforeTooltipDraw",{...n,cancelable:!0})===!1)return;t.draw(e.ctx),e.notifyPlugins("afterTooltipDraw",n)}},afterEvent(e,t){if(e.tooltip){const n=t.replay;e.tooltip.handleEvent(t.event,n,t.inChartArea)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(e,t)=>t.bodyFont.size,boxWidth:(e,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:bee},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:e=>e!=="filter"&&e!=="itemSort"&&e!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const tGe=(e,t,n,s)=>(typeof t=="string"?(n=e.push(t)-1,s.unshift({index:n,label:t})):isNaN(t)&&(n=null),n);function aGe(e,t,n,s){const r=e.indexOf(t);if(r===-1)return tGe(e,t,n,s);const i=e.lastIndexOf(t);return r!==i?n:r}const nGe=(e,t)=>e===null?null:Rs(Math.round(e),0,t);function YB(e){const t=this.getLabels();return e>=0&&e<t.length?t[e]:e}class sGe extends Ah{static id="category";static defaults={ticks:{callback:YB}};constructor(t){super(t),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(t){const n=this._addedLabels;if(n.length){const s=this.getLabels();for(const{index:r,label:i}of n)s[r]===i&&s.splice(r,1);this._addedLabels=[]}super.init(t)}parse(t,n){if(Pa(t))return null;const s=this.getLabels();return n=isFinite(n)&&s[n]===t?n:aGe(s,t,ma(n,t),this._addedLabels),nGe(n,s.length-1)}determineDataLimits(){const{minDefined:t,maxDefined:n}=this.getUserBounds();let{min:s,max:r}=this.getMinMax(!0);this.options.bounds==="ticks"&&(t||(s=0),n||(r=this.getLabels().length-1)),this.min=s,this.max=r}buildTicks(){const t=this.min,n=this.max,s=this.options.offset,r=[];let i=this.getLabels();i=t===0&&n===i.length-1?i:i.slice(t,n+1),this._valueRange=Math.max(i.length-(s?0:1),1),this._startValue=this.min-(s?.5:0);for(let o=t;o<=n;o++)r.push({value:o});return r}getLabelForValue(t){return YB.call(this,t)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(t){return typeof t!="number"&&(t=this.parse(t)),t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getPixelForTick(t){const n=this.ticks;return t<0||t>n.length-1?null:this.getPixelForValue(n[t].value)}getValueForPixel(t){return Math.round(this._startValue+this.getDecimalForPixel(t)*this._valueRange)}getBasePixel(){return this.bottom}}function rGe(e,t){const n=[],{bounds:r,step:i,min:o,max:l,precision:c,count:u,maxTicks:d,maxDigits:h,includeBounds:p}=e,x=i||1,b=d-1,{min:j,max:y}=t,N=!Pa(o),w=!Pa(l),S=!Pa(u),_=(y-j)/(h+1);let T=Q8((y-j)/b/x)*x,k,A,E,M;if(T<1e-14&&!N&&!w)return[{value:j},{value:y}];M=Math.ceil(y/T)-Math.floor(j/T),M>b&&(T=Q8(M*T/b/x)*x),Pa(c)||(k=Math.pow(10,c),T=Math.ceil(T*k)/k),r==="ticks"?(A=Math.floor(j/T)*T,E=Math.ceil(y/T)*T):(A=j,E=y),N&&w&&i&&pBe((l-o)/i,T/1e3)?(M=Math.round(Math.min((l-o)/T,d)),T=(l-o)/M,A=o,E=l):S?(A=N?o:A,E=w?l:E,M=u-1,T=(E-A)/M):(M=(E-A)/T,pp(M,Math.round(M),T/1e3)?M=Math.round(M):M=Math.ceil(M));const F=Math.max(K8(T),K8(A));k=Math.pow(10,Pa(c)?F:c),A=Math.round(A*k)/k,E=Math.round(E*k)/k;let D=0;for(N&&(p&&A!==o?(n.push({value:o}),A<o&&D++,pp(Math.round((A+D*T)*k)/k,o,QB(o,_,e))&&D++):A<o&&D++);D<M;++D){const P=Math.round((A+D*T)*k)/k;if(w&&P>l)break;n.push({value:P})}return w&&p&&E!==l?n.length&&pp(n[n.length-1].value,l,QB(l,_,e))?n[n.length-1].value=l:n.push({value:l}):(!w||E===l)&&n.push({value:E}),n}function QB(e,t,{horizontal:n,minRotation:s}){const r=Pl(s),i=(n?Math.sin(r):Math.cos(r))||.001,o=.75*t*(""+e).length;return Math.min(t/i,o)}class iGe extends Ah{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(t,n){return Pa(t)||(typeof t=="number"||t instanceof Number)&&!isFinite(+t)?null:+t}handleTickRangeOptions(){const{beginAtZero:t}=this.options,{minDefined:n,maxDefined:s}=this.getUserBounds();let{min:r,max:i}=this;const o=c=>r=n?r:c,l=c=>i=s?i:c;if(t){const c=Fo(r),u=Fo(i);c<0&&u<0?l(0):c>0&&u>0&&o(0)}if(r===i){let c=i===0?1:Math.abs(i*.05);l(i+c),t||o(r-c)}this.min=r,this.max=i}getTickLimit(){const t=this.options.ticks;let{maxTicksLimit:n,stepSize:s}=t,r;return s?(r=Math.ceil(this.max/s)-Math.floor(this.min/s)+1,r>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${s} would result generating up to ${r} ticks. Limiting to 1000.`),r=1e3)):(r=this.computeTickLimit(),n=n||11),n&&(r=Math.min(n,r)),r}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const t=this.options,n=t.ticks;let s=this.getTickLimit();s=Math.max(2,s);const r={maxTicks:s,bounds:t.bounds,min:t.min,max:t.max,precision:n.precision,step:n.stepSize,count:n.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:n.minRotation||0,includeBounds:n.includeBounds!==!1},i=this._range||this,o=rGe(r,i);return t.bounds==="ticks"&&xBe(o,this,"value"),t.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}configure(){const t=this.ticks;let n=this.min,s=this.max;if(super.configure(),this.options.offset&&t.length){const r=(s-n)/Math.max(t.length-1,1)/2;n-=r,s+=r}this._startValue=n,this._endValue=s,this._valueRange=s-n}getLabelForValue(t){return g3(t,this.chart.options.locale,this.options.ticks.format)}}class oGe extends iGe{static id="linear";static defaults={ticks:{callback:GJ.formatters.numeric}};determineDataLimits(){const{min:t,max:n}=this.getMinMax(!0);this.min=Ci(t)?t:0,this.max=Ci(n)?n:1,this.handleTickRangeOptions()}computeTickLimit(){const t=this.isHorizontal(),n=t?this.width:this.height,s=Pl(this.options.ticks.minRotation),r=(t?Math.sin(s):Math.cos(s))||.001,i=this._resolveTickFontOptions(0);return Math.ceil(n/Math.min(40,i.lineHeight/r))}getPixelForValue(t){return t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getValueForPixel(t){return this._startValue+this.getDecimalForPixel(t)*this._valueRange}}const U1={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},mr=Object.keys(U1);function KB(e,t){return e-t}function XB(e,t){if(Pa(t))return null;const n=e._adapter,{parser:s,round:r,isoWeekday:i}=e._parseOpts;let o=t;return typeof s=="function"&&(o=s(o)),Ci(o)||(o=typeof s=="string"?n.parse(o,s):n.parse(o)),o===null?null:(r&&(o=r==="week"&&(tx(i)||i===!0)?n.startOf(o,"isoWeek",i):n.startOf(o,r)),+o)}function ZB(e,t,n,s){const r=mr.length;for(let i=mr.indexOf(e);i<r-1;++i){const o=U1[mr[i]],l=o.steps?o.steps:Number.MAX_SAFE_INTEGER;if(o.common&&Math.ceil((n-t)/(l*o.size))<=s)return mr[i]}return mr[r-1]}function lGe(e,t,n,s,r){for(let i=mr.length-1;i>=mr.indexOf(n);i--){const o=mr[i];if(U1[o].common&&e._adapter.diff(r,s,o)>=t-1)return o}return mr[n?mr.indexOf(n):0]}function cGe(e){for(let t=mr.indexOf(e)+1,n=mr.length;t<n;++t)if(U1[mr[t]].common)return mr[t]}function JB(e,t,n){if(!n)e[t]=!0;else if(n.length){const{lo:s,hi:r}=m3(n,t),i=n[s]>=t?n[s]:n[r];e[i]=!0}}function dGe(e,t,n,s){const r=e._adapter,i=+r.startOf(t[0].value,s),o=t[t.length-1].value;let l,c;for(l=i;l<=o;l=+r.add(l,1,s))c=n[l],c>=0&&(t[c].major=!0);return t}function eH(e,t,n){const s=[],r={},i=t.length;let o,l;for(o=0;o<i;++o)l=t[o],r[l]=o,s.push({value:l,major:!1});return i===0||!n?s:dGe(e,s,r,n)}class tH extends Ah{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(t){super(t),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(t,n={}){const s=t.time||(t.time={}),r=this._adapter=new i9e._date(t.adapters.date);r.init(n),gp(s.displayFormats,r.formats()),this._parseOpts={parser:s.parser,round:s.round,isoWeekday:s.isoWeekday},super.init(t),this._normalized=n.normalized}parse(t,n){return t===void 0?null:XB(this,t)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const t=this.options,n=this._adapter,s=t.time.unit||"day";let{min:r,max:i,minDefined:o,maxDefined:l}=this.getUserBounds();function c(u){!o&&!isNaN(u.min)&&(r=Math.min(r,u.min)),!l&&!isNaN(u.max)&&(i=Math.max(i,u.max))}(!o||!l)&&(c(this._getLabelBounds()),(t.bounds!=="ticks"||t.ticks.source!=="labels")&&c(this.getMinMax(!1))),r=Ci(r)&&!isNaN(r)?r:+n.startOf(Date.now(),s),i=Ci(i)&&!isNaN(i)?i:+n.endOf(Date.now(),s)+1,this.min=Math.min(r,i-1),this.max=Math.max(r+1,i)}_getLabelBounds(){const t=this.getLabelTimestamps();let n=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;return t.length&&(n=t[0],s=t[t.length-1]),{min:n,max:s}}buildTicks(){const t=this.options,n=t.time,s=t.ticks,r=s.source==="labels"?this.getLabelTimestamps():this._generate();t.bounds==="ticks"&&r.length&&(this.min=this._userMin||r[0],this.max=this._userMax||r[r.length-1]);const i=this.min,o=this.max,l=jBe(r,i,o);return this._unit=n.unit||(s.autoSkip?ZB(n.minUnit,this.min,this.max,this._getLabelCapacity(i)):lGe(this,l.length,n.minUnit,this.min,this.max)),this._majorUnit=!s.major.enabled||this._unit==="year"?void 0:cGe(this._unit),this.initOffsets(r),t.reverse&&l.reverse(),eH(this,l,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(t=>+t.value))}initOffsets(t=[]){let n=0,s=0,r,i;this.options.offset&&t.length&&(r=this.getDecimalForValue(t[0]),t.length===1?n=1-r:n=(this.getDecimalForValue(t[1])-r)/2,i=this.getDecimalForValue(t[t.length-1]),t.length===1?s=i:s=(i-this.getDecimalForValue(t[t.length-2]))/2);const o=t.length<3?.5:.25;n=Rs(n,0,o),s=Rs(s,0,o),this._offsets={start:n,end:s,factor:1/(n+1+s)}}_generate(){const t=this._adapter,n=this.min,s=this.max,r=this.options,i=r.time,o=i.unit||ZB(i.minUnit,n,s,this._getLabelCapacity(n)),l=ma(r.ticks.stepSize,1),c=o==="week"?i.isoWeekday:!1,u=tx(c)||c===!0,d={};let h=n,p,x;if(u&&(h=+t.startOf(h,"isoWeek",c)),h=+t.startOf(h,u?"day":o),t.diff(s,n,o)>1e5*l)throw new Error(n+" and "+s+" are too far apart with stepSize of "+l+" "+o);const b=r.ticks.source==="data"&&this.getDataTimestamps();for(p=h,x=0;p<s;p=+t.add(p,l,o),x++)JB(d,p,b);return(p===s||r.bounds==="ticks"||x===1)&&JB(d,p,b),Object.keys(d).sort(KB).map(j=>+j)}getLabelForValue(t){const n=this._adapter,s=this.options.time;return s.tooltipFormat?n.format(t,s.tooltipFormat):n.format(t,s.displayFormats.datetime)}format(t,n){const r=this.options.time.displayFormats,i=this._unit,o=n||r[i];return this._adapter.format(t,o)}_tickFormatFunction(t,n,s,r){const i=this.options,o=i.ticks.callback;if(o)return an(o,[t,n,s],this);const l=i.time.displayFormats,c=this._unit,u=this._majorUnit,d=c&&l[c],h=u&&l[u],p=s[n],x=u&&h&&p&&p.major;return this._adapter.format(t,r||(x?h:d))}generateTickLabels(t){let n,s,r;for(n=0,s=t.length;n<s;++n)r=t[n],r.label=this._tickFormatFunction(r.value,n,t)}getDecimalForValue(t){return t===null?NaN:(t-this.min)/(this.max-this.min)}getPixelForValue(t){const n=this._offsets,s=this.getDecimalForValue(t);return this.getPixelForDecimal((n.start+s)*n.factor)}getValueForPixel(t){const n=this._offsets,s=this.getDecimalForPixel(t)/n.factor-n.end;return this.min+s*(this.max-this.min)}_getLabelSize(t){const n=this.options.ticks,s=this.ctx.measureText(t).width,r=Pl(this.isHorizontal()?n.maxRotation:n.minRotation),i=Math.cos(r),o=Math.sin(r),l=this._resolveTickFontOptions(0).size;return{w:s*i+l*o,h:s*o+l*i}}_getLabelCapacity(t){const n=this.options.time,s=n.displayFormats,r=s[n.unit]||s.millisecond,i=this._tickFormatFunction(t,0,eH(this,[t],this._majorUnit),r),o=this._getLabelSize(i),l=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return l>0?l:1}getDataTimestamps(){let t=this._cache.data||[],n,s;if(t.length)return t;const r=this.getMatchingVisibleMetas();if(this._normalized&&r.length)return this._cache.data=r[0].controller.getAllParsedValues(this);for(n=0,s=r.length;n<s;++n)t=t.concat(r[n].controller.getAllParsedValues(this));return this._cache.data=this.normalize(t)}getLabelTimestamps(){const t=this._cache.labels||[];let n,s;if(t.length)return t;const r=this.getLabels();for(n=0,s=r.length;n<s;++n)t.push(XB(this,r[n]));return this._cache.labels=this._normalized?t:this.normalize(t)}normalize(t){return BJ(t.sort(KB))}}function Zb(e,t,n){let s=0,r=e.length-1,i,o,l,c;n?(t>=e[s].pos&&t<=e[r].pos&&({lo:s,hi:r}=Su(e,"pos",t)),{pos:i,time:l}=e[s],{pos:o,time:c}=e[r]):(t>=e[s].time&&t<=e[r].time&&({lo:s,hi:r}=Su(e,"time",t)),{time:i,pos:l}=e[s],{time:o,pos:c}=e[r]);const u=o-i;return u?l+(c-l)*(t-i)/u:l}class $Ye extends tH{static id="timeseries";static defaults=tH.defaults;constructor(t){super(t),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const t=this._getTimestampsForTable(),n=this._table=this.buildLookupTable(t);this._minPos=Zb(n,this.min),this._tableRange=Zb(n,this.max)-this._minPos,super.initOffsets(t)}buildLookupTable(t){const{min:n,max:s}=this,r=[],i=[];let o,l,c,u,d;for(o=0,l=t.length;o<l;++o)u=t[o],u>=n&&u<=s&&r.push(u);if(r.length<2)return[{time:n,pos:0},{time:s,pos:1}];for(o=0,l=r.length;o<l;++o)d=r[o+1],c=r[o-1],u=r[o],Math.round((d+c)/2)!==u&&i.push({time:u,pos:o/(l-1)});return i}_generate(){const t=this.min,n=this.max;let s=super.getDataTimestamps();return(!s.includes(t)||!s.length)&&s.splice(0,0,t),(!s.includes(n)||s.length===1)&&s.push(n),s.sort((r,i)=>r-i)}_getTimestampsForTable(){let t=this._cache.all||[];if(t.length)return t;const n=this.getDataTimestamps(),s=this.getLabelTimestamps();return n.length&&s.length?t=this.normalize(n.concat(s)):t=n.length?n:s,t=this._cache.all=t,t}getDecimalForValue(t){return(Zb(this._table,t)-this._minPos)/this._tableRange}getValueForPixel(t){const n=this._offsets,s=this.getDecimalForPixel(t)/n.factor-n.end;return Zb(this._table,s*this._tableRange+this._minPos,!0)}}const vee="label";function aH(e,t){typeof e=="function"?e(t):e&&(e.current=t)}function uGe(e,t){const n=e.options;n&&t&&Object.assign(n,t)}function wee(e,t){e.labels=t}function jee(e,t,n=vee){const s=[];e.datasets=t.map(r=>{const i=e.datasets.find(o=>o[n]===r[n]);return!i||!r.data||s.includes(i)?{...r}:(s.push(i),Object.assign(i,r),i)})}function mGe(e,t=vee){const n={labels:[],datasets:[]};return wee(n,e.labels),jee(n,e.datasets,t),n}function fGe(e,t){const{height:n=150,width:s=300,redraw:r=!1,datasetIdKey:i,type:o,data:l,options:c,plugins:u=[],fallbackContent:d,updateMode:h,...p}=e,x=f.useRef(null),b=f.useRef(null),j=()=>{x.current&&(b.current=new F1(x.current,{type:o,data:mGe(l,i),options:c&&{...c},plugins:u}),aH(t,b.current))},y=()=>{aH(t,null),b.current&&(b.current.destroy(),b.current=null)};return f.useEffect(()=>{!r&&b.current&&c&&uGe(b.current,c)},[r,c]),f.useEffect(()=>{!r&&b.current&&wee(b.current.config.data,l.labels)},[r,l.labels]),f.useEffect(()=>{!r&&b.current&&l.datasets&&jee(b.current.config.data,l.datasets,i)},[r,l.datasets]),f.useEffect(()=>{b.current&&(r?(y(),setTimeout(j)):b.current.update(h))},[r,c,l.labels,l.datasets,h]),f.useEffect(()=>{b.current&&(y(),setTimeout(j))},[o]),f.useEffect(()=>(j(),()=>y()),[]),a.jsx("canvas",{ref:x,role:"img",height:n,width:s,...p,children:d})}const hGe=f.forwardRef(fGe);function S3(e,t){return F1.register(t),f.forwardRef((n,s)=>a.jsx(hGe,{...n,ref:s,type:e}))}const gGe=S3("line",s9e),pGe=S3("bar",t9e),xGe=S3("pie",r9e);F1.register(sGe,oGe,Rqe,Lqe,Dqe,wqe,Wqe,eGe,qqe);const Nee=e=>a.jsx(Xa,{...e}),yGe=e=>a.jsx(w9,{...e}),bGe=e=>a.jsx(hx,{...e}),vGe=e=>a.jsx(La,{...e}),Cee=e=>a.jsx(ia,{...e}),wGe=e=>a.jsx(Hue,{...e}),jGe=[{icon:Nee,title:"Total Contacts",value:128,color:"text-blue-600",bgColor:"bg-blue-50"},{icon:Cee,title:"Emails Sent",value:450,color:"text-purple-600",bgColor:"bg-purple-50"},{icon:bGe,title:"Active Campaigns",value:9,color:"text-green-600",bgColor:"bg-green-50"},{icon:yGe,title:"Revenue",value:125e3,color:"text-yellow-600",bgColor:"bg-yellow-50"}],NGe=[{name:"Emma Watty",company:"Tech Interaction Inc.",assignedBy:"Alice Smith",source:"Website",date:"Oct 10, 2:10 PM"},{name:"John Johnny",company:"Capital Business Co.",assignedBy:"Bob Johnson",source:"Referral",date:"Oct 9, 12:00 AM"},{name:"Annie Arnty",company:"Dynamic Systems Inc.",assignedBy:"Catherine Lee",source:"Trade Show",date:"Oct 8, 1:25 PM"},{name:"James Wilson",company:"Global Services LLC",assignedBy:"David Kim",source:"Cold Call",date:"Oct 7, 11:15 AM"}],CGe={labels:["Week 1","Week 2","Week 3","Week 4"],datasets:[{label:"Leads",data:[50,75,60,90],backgroundColor:"rgba(96, 165, 250, 0.6)",borderColor:"rgba(96, 165, 250, 1)",borderWidth:1},{label:"Conversions",data:[10,20,15,25],backgroundColor:"rgba(34, 197, 94, 0.6)",borderColor:"rgba(34, 197, 94, 1)",borderWidth:1}]},SGe={responsive:!0,plugins:{legend:{position:"top",labels:{color:"#374151"}},title:{display:!0,color:"#111827",font:{size:18}}}},_Ge={labels:["Leads","Conversions"],datasets:[{label:"Leads Status",data:[75,25],backgroundColor:["rgba(96, 165, 250, 0.6)","rgba(34, 197, 94, 0.6)"],borderColor:["rgba(96, 165, 250, 1)","rgba(34, 197, 94, 1)"],borderWidth:1}]},AGe={responsive:!0,plugins:{legend:{position:"top",labels:{color:"#374151"}},title:{display:!0,color:"#111827",font:{size:18}}}},TGe=e=>{switch(e){case"Website":return{text:"text-green-600",bg:"bg-green-100"};case"Referral":return{text:"text-purple-600",bg:"bg-purple-100"};case"Trade Show":return{text:"text-orange-600",bg:"bg-orange-100"};case"Cold Call":return{text:"text-red-600",bg:"bg-red-100"};default:return{text:"text-gray-600",bg:"bg-gray-100"}}},kGe=()=>{const e=[{icon:Nee,label:"New Contact"},{icon:Cee,label:"New Campaign"},{icon:vGe,label:"New Task"},{icon:wGe,label:"New Leads"}];return a.jsxs("div",{className:"bg-white rounded-xl shadow-md p-4 flex flex-col md:flex-row items-center space-y-3 md:space-y-0 md:space-x-4",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 py-2 flex-grow focus-within:ring-2 focus-within:ring-indigo-500 transition w-full md:max-w-3xl",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search Contacts, Leads, or Campaigns...",className:"focus:outline-none text-base w-full"})]}),a.jsx("div",{className:"flex space-x-3 md:ml-auto",children:e.map((t,n)=>a.jsxs("div",{className:"relative group",children:[a.jsx("button",{className:"p-2 text-gray-500 hover:text-gray-900 transition rounded-full hover:bg-gray-100 focus:outline-none",children:a.jsx(t.icon,{size:20})}),a.jsx("span",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-1 bg-gray-800 text-white text-xs rounded-md whitespace-nowrap opacity-0 invisible group-hover:opacity-100 group-hover:visible transition",children:t.label})]},n))})]})},EGe=({icon:e,title:t,value:n,color:s,bgColor:r})=>a.jsxs("div",{className:"flex items-center p-4 bg-white rounded-xl shadow-lg transition duration-300 hover:shadow-xl hover:ring-2 hover:ring-blue-500 cursor-pointer",onClick:()=>console.log(`Clicked metric card: ${t}`),children:[a.jsx("div",{className:`p-3 rounded-full ${r} ${s} mr-4`,children:a.jsx(e,{size:22})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:t}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:n})]})]}),LGe=({name:e,company:t,assignedBy:n,source:s,date:r})=>{const{text:i,bg:o}=TGe(s);return a.jsx("div",{className:"py-3 border-b border-gray-100 last:border-b-0 cursor-pointer hover:bg-gray-50 px-2 -mx-2 rounded-md",children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-gray-800",children:e}),a.jsx("p",{className:"text-xs text-gray-500",children:t}),n&&a.jsxs("p",{className:"text-xs text-gray-500",children:["Assigned by:"," ",a.jsx("span",{className:"font-semibold text-gray-700",children:n})]})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"text-xs text-gray-400",children:r}),a.jsx("span",{className:`inline-block mt-1 text-xs font-medium ${i} ${o} px-2 py-0.5 rounded-full`,children:s})]})]})})},DGe=({title:e,children:t})=>a.jsxs("div",{className:"bg-white p-5 rounded-xl shadow-md flex flex-col",children:[a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:e}),a.jsx("span",{className:"text-sm text-indigo-500 cursor-pointer hover:underline",children:"See All"})]}),t]}),PGe=({title:e,chartData:t,chartOptions:n})=>{const[s,r]=f.useState("bar"),i=s==="pie"?_Ge:t,o=s==="pie"?AGe:n,l=s==="line"?gGe:s==="pie"?xGe:pGe,c=s==="pie"?250:300;return a.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-md flex flex-col hover:shadow-lg transition",children:[a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:e}),a.jsxs("select",{value:s,onChange:u=>r(u.target.value),className:"border border-gray-300 rounded-md px-2 py-1 text-sm",children:[a.jsx("option",{value:"bar",children:"Bar"}),a.jsx("option",{value:"line",children:"Line"}),a.jsx("option",{value:"pie",children:"Pie"})]})]}),a.jsx("div",{className:"w-full flex justify-center",style:{height:c},children:a.jsx(l,{data:i,options:o})})]})};function OGe(){const{user:e}=Gt();return f.useEffect(()=>{document.title="Dashboard | Sari-Sari CRM"},[]),a.jsx("div",{className:"min-h-screen pt-5 pb-10 font-sans",children:a.jsxs("main",{className:"max-w-screen-2xl mx-auto px-4 sm:px-6 lg:px-8",children:[a.jsxs("div",{className:"text-xl font-bold mb-4",children:["Welcome back, ",e?.name||"Marketing","! Heres your marketing overview."]}),a.jsx(kGe,{}),a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-6",children:jGe.map(t=>a.jsx(EGe,{...t},t.title))}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:[a.jsx(PGe,{title:"Leads & Conversions",chartData:CGe,chartOptions:SGe}),a.jsx(DGe,{title:"Latest Leads",children:NGe.map((t,n)=>a.jsx(LGe,{...t},n))})]})]})})}function MGe(){f.useEffect(()=>{document.title="Accounts | Sari-Sari CRM"},[]);const[e,t]=f.useState(null),[n,s]=f.useState(""),[r,i]=f.useState("All Statuses"),o=f.useMemo(()=>[{company:"Acme Corporation",url:"https://acme.com",status:"CUSTOMER",industry:"Technology",territory:"North Region",phone_number:"+1-555-0100",billing_address:"123 Main St, North City",shipping_address:"456 Elm St, North City",created_by:"John Appleseed",created_date:"2024-01-10",last_updated:"2025-09-25 14:30"},{company:"Beta Solutions",url:"https://beta.com",status:"PROSPECT",industry:"Finance",territory:"South Region",phone_number:"+1-555-0200",billing_address:"789 Pine St, South City",shipping_address:"101 Maple St, South City",created_by:"Jane Doe",created_date:"2024-03-05",last_updated:"2025-10-01 10:15"},{company:"Gamma Partners",url:"https://gamma.com",status:"PARTNER",industry:"Retail",territory:"East Region",phone_number:"+1-555-0300",billing_address:"234 Oak St, East City",shipping_address:"345 Birch St, East City",created_by:"Alice Smith",created_date:"2023-12-20",last_updated:"2025-08-15 09:45"},{company:"Delta Corp",url:"https://delta.com",status:"INACTIVE",industry:"Logistics",territory:"West Region",phone_number:"+1-555-0400",billing_address:"987 Cedar St, West City",shipping_address:"654 Pine St, West City",created_by:"Bob Johnson",created_date:"2023-11-15",last_updated:"2025-06-12 11:20"}],[]),l=h=>t(h),c=()=>t(null),u=f.useMemo(()=>[{title:"Total Accounts",value:o.length,color:"text-yellow-600",bgColor:"bg-yellow-50",icon:Xa},{title:"Customers",value:o.filter(h=>h.status==="CUSTOMER").length,color:"text-green-600",bgColor:"bg-green-50",icon:Qi},{title:"Prospects",value:o.filter(h=>h.status==="PROSPECT").length,color:"text-purple-600",bgColor:"bg-purple-50",icon:rn},{title:"Partners",value:o.filter(h=>h.status==="PARTNER").length,color:"text-pink-600",bgColor:"bg-pink-50",icon:ra},{title:"Active",value:o.filter(h=>h.status==="CUSTOMER"||h.status==="PARTNER").length,color:"text-blue-600",bgColor:"bg-blue-50",icon:Qi},{title:"Inactive",value:o.filter(h=>h.status==="INACTIVE").length,color:"text-gray-600",bgColor:"bg-gray-50",icon:Ki},{title:"Former",value:o.filter(h=>h.status==="FORMER").length,color:"text-orange-600",bgColor:"bg-orange-50",icon:Ki}],[o]);if(e)return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter",children:[a.jsxs("div",{className:"mb-6",children:[a.jsxs("button",{onClick:c,className:"inline-flex items-center text-sm sm:text-base text-gray-500 hover:text-gray-700 transition mb-4 sm:mb-6 cursor-pointer",children:[a.jsx(am,{className:"mr-1 w-4 h-4 sm:w-5 sm:h-5"})," Back"]}),a.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6",children:a.jsx("div",{children:a.jsxs("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-800 flex items-center gap-2",children:[e.company,a.jsx("span",{className:`inline-block text-xs px-2 py-0.5 rounded ${e.status==="CUSTOMER"?"bg-green-600 text-white":e.status==="PROSPECT"?"bg-purple-600 text-white":e.status==="PARTNER"?"bg-pink-600 text-white":"bg-gray-500 text-white"}`,children:e.status})]})})})]}),a.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 sm:p-6 shadow-sm overflow-x-auto",children:[a.jsx("h2",{className:"text-lg sm:text-xl font-semibold mb-3 sm:mb-4 text-gray-800",children:"Account Details"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 text-sm text-gray-700",children:[a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:"Website:"})," ",a.jsx("br",{}),a.jsx("a",{href:e.url,className:"text-blue-600 hover:underline break-words",children:e.url})]}),a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:"Industry:"})," ",a.jsx("br",{}),e.industry]}),a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:"Territory:"})," ",a.jsx("br",{}),e.territory]}),a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:"Phone Number:"})," ",a.jsx("br",{}),e.phone_number]}),a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:"Billing Address:"})," ",a.jsx("br",{}),e.billing_address]}),a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:"Shipping Address:"})," ",a.jsx("br",{}),e.shipping_address]}),a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:"Created By:"})," ",a.jsx("br",{}),e.created_by," on ",e.created_date]}),a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:"Last Updated:"})," ",a.jsx("br",{}),e.last_updated]})]})]})]});const d=o.filter(h=>{const p=h.company.toLowerCase().includes(n.toLowerCase())||h.url.toLowerCase().includes(n.toLowerCase())||h.industry.toLowerCase().includes(n.toLowerCase())||h.territory.toLowerCase().includes(n.toLowerCase())||h.phone_number.toLowerCase().includes(n.toLowerCase()),x=r==="All Statuses"||r==="Active"&&(h.status==="CUSTOMER"||h.status==="PARTNER")||r==="Inactive"&&h.status==="INACTIVE"||r==="Former"&&h.status==="FORMER"||h.status.toLowerCase()===r.toLowerCase();return p&&x});return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-sans",children:[a.jsx("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:a.jsxs("h1",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(Xa,{className:"mr-2 text-blue-600"}),"Accounts List"]})}),a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 xl:grid-cols-4 md:grid-cols-4 gap-4 mb-6",children:u.map(h=>a.jsx(IGe,{...h},h.title))}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search by company, website, industry, territory, or phone...",value:n,onChange:h=>s(h.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsx("div",{className:"w-full lg:w-1/4",children:a.jsxs("select",{value:r,onChange:h=>i(h.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{children:"All Statuses"}),a.jsx("option",{children:"Customer"}),a.jsx("option",{children:"Prospect"}),a.jsx("option",{children:"Partner"}),a.jsx("option",{children:"Active"}),a.jsx("option",{children:"Inactive"}),a.jsx("option",{children:"Former"})]})})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[500px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4",children:"Company"}),a.jsx("th",{className:"py-3 px-4",children:"Status"}),a.jsx("th",{className:"py-3 px-4",children:"Industry"}),a.jsx("th",{className:"py-3 px-4",children:"Territory"}),a.jsx("th",{className:"py-3 px-4",children:"Phone"})]})}),a.jsxs("tbody",{children:[d.map((h,p)=>a.jsxs("tr",{className:"hover:bg-gray-50 text-xs cursor-pointer",onClick:()=>l(h),children:[a.jsx("td",{className:"py-3 px-4 break-words",children:a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-blue-600 hover:underline break-words",children:h.company}),a.jsx("div",{className:"text-gray-500 text-xs break-words",children:h.url})]})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${h.status==="CUSTOMER"?"bg-green-100 text-green-700":h.status==="PROSPECT"?"bg-purple-100 text-purple-700":h.status==="PARTNER"?"bg-pink-100 text-pink-700":h.status==="INACTIVE"?"bg-gray-100 text-gray-700":"bg-orange-100 text-orange-700"}`,children:h.status})}),a.jsx("td",{className:"py-3 px-4 break-words",children:h.industry}),a.jsx("td",{className:"py-3 px-4 break-words",children:h.territory}),a.jsxs("td",{className:"py-3 px-4 flex items-center space-x-2 break-words",children:[a.jsx(It,{className:"text-gray-500"}),a.jsx("span",{children:h.phone_number})]})]},p)),d.length===0&&a.jsx("tr",{children:a.jsx("td",{colSpan:5,className:"py-4 text-center text-gray-500",children:"No accounts match your search/filter."})})]})]})})]})}const IGe=({icon:e,title:t,value:n,color:s,bgColor:r})=>a.jsxs("div",{className:"flex items-center p-4 bg-white rounded-xl shadow-md hover:shadow-lg hover:ring-2 hover:ring-blue-500 cursor-pointer transition-all duration-300",onClick:()=>console.log(`Clicked: ${t}`),children:[a.jsx("div",{className:`flex-shrink-0 p-3 rounded-full ${r} ${s} mr-4`,children:a.jsx(e,{size:22})}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:t}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:n})]})]});function $Ge(){f.useEffect(()=>{document.title="Contacts | Sari-Sari CRM"},[]);const[e,t]=f.useState(!1),[n,s]=f.useState(null),[r,i]=f.useState(!1),[o,l]=f.useState(""),[c,u]=f.useState("All Contacts"),[d,h]=f.useState([{id:1,name:"John Smith",title:"Marketing Director",account:"Acme Corporation",email:"john.smith@acme.com",phone1:"+1-555-0101",phone2:"+1-555-0102",department:"Marketing",assigned:"Jane Sales",created:"1/10/2024",mobile:"09217229846",workPhone:"(555) 123-4567",createdBy:"John Appleseed",lastUpdated:"2025-09-21 15:30",notes:"Key marketing partner for Q4 campaigns."}]),[p,x]=f.useState({id:null,name:"",email:"",workPhone:"",title:"",department:"",phone1:"",phone2:"",account:"",assigned:"",notes:""}),b=T=>{T.target.id==="modalBackdrop"&&t(!1)},j=T=>{s(T)},y=()=>{s(null)},N=()=>{i(!1),x({id:null,name:"",email:"",workPhone:"",title:"",department:"",phone1:"",phone2:"",account:"",assigned:"",notes:""}),t(!0)},w=(T,k)=>{k.stopPropagation(),i(!0),x(T),t(!0)},S=T=>{const{name:k,value:A}=T.target;x(E=>({...E,[k]:A}))},_=T=>{if(T.preventDefault(),r)h(k=>k.map(A=>A.id===p.id?{...p}:A));else{const k={...p,id:Date.now(),created:new Date().toLocaleDateString(),createdBy:"Admin User"};h(A=>[...A,k])}t(!1)};return n?a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter",children:[a.jsxs("button",{onClick:y,className:"inline-flex items-center text-sm sm:text-base text-gray-500 hover:text-gray-700 transition mb-4 sm:mb-6 cursor-pointer",children:[a.jsx(am,{className:"mr-1 w-4 h-4 sm:w-5 sm:h-5"})," Back"]}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:space-x-3",children:[a.jsx("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-800",children:n.account}),a.jsx("span",{className:"mt-1 sm:mt-0 bg-blue-600 text-white text-xs sm:text-sm px-2 py-0.5 rounded w-fit",children:"Active"})]}),a.jsx("div",{className:"flex flex-col sm:flex-row sm:space-x-3 space-y-2 sm:space-y-0 mt-3 sm:mt-0",children:a.jsxs("button",{className:"w-full sm:w-auto bg-gray-800 text-white px-5 py-2 rounded-md hover:bg-gray-900 transition flex items-center gap-2",children:[a.jsx(Vo,{}),"Export"]})})]}),a.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 sm:p-6 w-full max-w-full lg:max-w-6xl shadow-sm overflow-x-auto mx-auto",children:[a.jsx("h2",{className:"text-lg sm:text-xl font-semibold mb-3 sm:mb-4 text-gray-800",children:"Contact Details"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4 text-sm text-gray-700",children:[a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:"Primary Contact:"})," ",a.jsx("br",{}),n.name]}),a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:"Email:"})," ",a.jsx("br",{}),n.email]}),a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:"Created By:"})," ",a.jsx("br",{}),n.createdBy," on ",n.created]}),a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:"Title:"})," ",a.jsx("br",{}),n.title]}),a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:"Assigned To:"})," ",a.jsx("br",{}),n.assigned]}),a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:"Work Phone:"})," ",a.jsx("br",{}),n.workPhone]}),a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:"Account:"})," ",a.jsx("br",{}),n.account]}),a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:"Mobile Phone:"})," ",a.jsx("br",{}),n.phone1]}),a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:"Last Updated:"})," ",a.jsx("br",{}),n.lastUpdated]})]}),a.jsxs("div",{className:"mt-6 border-gray-200 pt-4",children:[a.jsx("h3",{className:"text-md sm:text-lg font-semibold text-gray-800 mb-2",children:"Notes"}),a.jsx("p",{className:"text-sm text-gray-700 leading-relaxed",children:n.notes?n.notes:"No additional notes were provided for this contact."})]})]})]}):a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h2",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(Xa,{className:"mr-2 text-blue-600"})," Contacts Management"]}),a.jsx("button",{onClick:N,className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 rounded-md hover:bg-gray-800 text-sm sm:text-base transition",children:" Add Contact"})]}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search Contacts...",value:o,onChange:T=>l(T.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsx("div",{className:"w-full lg:w-1/4",children:a.jsxs("select",{value:c,onChange:T=>u(T.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{children:"All Contacts"}),a.jsx("option",{children:"Option 1"}),a.jsx("option",{children:"Option 2"}),a.jsx("option",{children:"Option 3"})]})})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-[600px] w-full border border-gray-200 rounded-lg bg-white shadow-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-sm text-gray-600",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4",children:"Contact"}),a.jsx("th",{className:"py-3 px-4",children:"Account"}),a.jsx("th",{className:"py-3 px-4",children:"Contact Info"}),a.jsx("th",{className:"py-3 px-4",children:"Department"}),a.jsx("th",{className:"py-3 px-4",children:"Assigned To"}),a.jsx("th",{className:"py-3 px-4",children:"Created"}),a.jsx("th",{className:"py-3 px-4 text-center",children:"Actions"})]})}),a.jsx("tbody",{className:"text-xs text-gray-700",children:d.map((T,k)=>a.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>j(T),children:[a.jsx("td",{className:"py-3 px-4",children:a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-blue-600 hover:underline break-all",children:T.name}),a.jsx("div",{className:"text-xs text-gray-500",children:T.title})]})}),a.jsx("td",{className:"py-3 px-4",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Kx,{className:"text-gray-500"}),a.jsx("span",{children:T.account})]})}),a.jsx("td",{className:"py-3 px-4",children:a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(sn,{className:"text-gray-500"}),a.jsx("span",{children:T.email})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(It,{className:"text-gray-500"}),a.jsx("span",{children:T.phone1})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(It,{className:"text-gray-500"}),a.jsx("span",{children:T.phone2})]})]})}),a.jsx("td",{className:"py-3 px-4",children:T.department}),a.jsx("td",{className:"py-3 px-4",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(ra,{className:"text-gray-500"}),a.jsx("span",{children:T.assigned})]})}),a.jsx("td",{className:"py-3 px-4",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Pt,{className:"text-gray-500"}),a.jsx("span",{children:T.created})]})}),a.jsx("td",{className:"py-3 px-4 text-center",children:a.jsx("div",{className:"flex justify-center",children:a.jsx("button",{onClick:A=>w(T,A),className:"text-blue-500 hover:text-blue-700",children:a.jsx(gn,{})})})})]},k))})]})}),e&&a.jsx("div",{id:"modalBackdrop",onClick:b,className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-full sm:max-w-3xl rounded-2xl shadow-lg p-4 sm:p-6 md:p-8 relative border border-gray-200 overflow-y-auto max-h-[90vh]",onClick:T=>T.stopPropagation(),children:[a.jsx("button",{onClick:()=>t(!1),className:"absolute top-4 right-4 text-gray-500 hover:text-black transition",children:a.jsx(ea,{size:22})}),a.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800 mb-4 sm:mb-6 text-center",children:r?"Edit Contact":"Add New Contact"}),a.jsxs("form",{onSubmit:_,className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4 text-sm",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Name"}),a.jsx("input",{type:"text",name:"name",value:p.name,onChange:S,placeholder:"Full name",className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Email"}),a.jsx("input",{type:"email",name:"email",value:p.email,onChange:S,placeholder:"example@email.com",className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Work Phone"}),a.jsx("input",{type:"text",name:"workPhone",value:p.workPhone,onChange:S,placeholder:"09 --- --- ---",className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"})]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Title"}),a.jsx("input",{type:"text",name:"title",value:p.title,onChange:S,placeholder:"Job title",className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Department"}),a.jsx("input",{type:"text",name:"department",value:p.department,onChange:S,placeholder:"Marketing / Sales",className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Phone Number 1"}),a.jsx("input",{type:"text",name:"phone1",value:p.phone1,onChange:S,placeholder:"09 --- --- ---",className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"})]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Account"}),a.jsx("input",{type:"text",name:"account",value:p.account,onChange:S,placeholder:"Company name",className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Assign To"}),a.jsxs("select",{name:"assigned",value:p.assigned,onChange:S,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none",children:[a.jsx("option",{value:"",children:"Assign To"}),a.jsx("option",{value:"Smith",children:"Smith"}),a.jsx("option",{value:"Doe",children:"Doe"}),a.jsx("option",{value:"Jane Sales",children:"Jane Sales"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Phone Number 2"}),a.jsx("input",{type:"text",name:"phone2",value:p.phone2,onChange:S,placeholder:"09 --- --- ---",className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"})]})]}),a.jsxs("div",{className:"flex flex-col col-span-1 sm:col-span-2 md:col-span-3",children:[a.jsx("label",{className:"text-gray-700 font-medium mb-1 text-sm",children:"Notes"}),a.jsx("textarea",{name:"notes",value:p.notes,onChange:S,placeholder:"Additional details...",rows:3,className:"border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-400 outline-none resize-none"})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-2 mt-4 col-span-1 sm:col-span-2 md:col-span-3",children:[a.jsx("button",{type:"button",onClick:()=>t(!1),className:"px-4 py-2 text-white bg-red-400 border border-red-300 rounded hover:bg-red-500 transition",children:"Cancel"}),a.jsx("button",{type:"submit",className:"px-4 py-2 text-white bg-blue-600 border border-blue-500 rounded hover:bg-blue-700 transition",children:"Save Contact"})]})]})]})})]})}const Jb={accountName:"Josh Inc.",companyNumber:"09135007323",companyWebsite:"joshenc.com",industry:"Agriculture",billingAddress:"#1 Pilar Las Pinas City",shippingAddress:"#3 BNW ASS-CBN",firstName:"Josh",lastName:"Vergara",department:"Administration",title:"CEO",workPhone:"09253677323",email:"josh@joshinc.com",mobile1:"09253677323",mobile2:"0907452874",dealName:"Josh Deal",dealAmount:"60.00",stage:"Prospecting",territory:"Cavite",description:"Initial lead conversion deal.",dealTitle:"New Client Agreement"},as=({label:e,value:t,name:n,className:s=""})=>a.jsxs("div",{className:`flex flex-col ${s}`,children:[a.jsx("label",{className:"text-xs text-gray-500 mb-1",children:e}),a.jsx("input",{type:"text",name:n,defaultValue:t,readOnly:!0,className:"w-full border border-gray-300 p-2 rounded-lg text-sm focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 outline-none bg-gray-50"})]}),RGe=({data:e})=>a.jsxs("div",{className:"space-y-6 p-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-700",children:"Account Information"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsx(as,{label:"Company Number",name:"companyNumber",value:e.companyNumber}),a.jsx(as,{label:"Company Website",name:"companyWebsite",value:e.companyWebsite}),a.jsx(as,{label:"Industry",name:"industry",value:e.industry})]}),a.jsx(as,{label:"Billing Address",name:"billingAddress",value:e.billingAddress,className:"col-span-3"}),a.jsx(as,{label:"Shipping Address",name:"shippingAddress",value:e.shippingAddress,className:"col-span-3"})]}),zGe=({data:e})=>a.jsxs("div",{className:"space-y-6 p-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-700",children:"Contact Information"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx(as,{label:"First Name",name:"firstName",value:e.firstName}),a.jsx(as,{label:"Last Name",name:"lastName",value:e.lastName}),a.jsx(as,{label:"Department",name:"department",value:e.department}),a.jsx(as,{label:"Title",name:"title",value:e.title}),a.jsx(as,{label:"Work Phone",name:"workPhone",value:e.workPhone}),a.jsx(as,{label:"Email",name:"email",value:e.email}),a.jsx(as,{label:"Mobile Number 1",name:"mobile1",value:e.mobile1}),a.jsx(as,{label:"Mobile Number 2",name:"mobile2",value:e.mobile2})]})]}),FGe=({data:e})=>a.jsxs("div",{className:"space-y-6 p-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-700",children:"Deal"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx(as,{label:"Deal Name",name:"dealName",value:e.dealName}),a.jsxs("div",{className:"flex",children:[a.jsx(as,{label:"Deal Amount",name:"dealAmount",value:e.dealAmount,className:"flex-grow"}),a.jsx("div",{className:"flex flex-col justify-end ml-1",children:a.jsx("span",{className:"text-sm font-medium text-gray-600 border border-gray-300 bg-gray-100 p-2 rounded-r-lg h-10 flex items-center",children:"PHP"})})]}),a.jsx(as,{label:"Stage",name:"stage",value:e.stage}),a.jsx(as,{label:"Territory",name:"territory",value:e.territory})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx(as,{label:"Description",name:"description",value:e.description}),a.jsx(as,{label:"Title",name:"dealTitle",value:e.dealTitle})]})]});function See({isOpen:e,onClose:t}){const[n,s]=f.useState(1),r=3;if(!e)return null;const i=()=>{n<r?s(n+1):(t(),s(1))},o=()=>{n>1&&s(n-1)},l=[{id:1,name:"Account"},{id:2,name:"Contact"},{id:3,name:"Deal"}],c=()=>{switch(n){case 1:return a.jsx(RGe,{data:Jb});case 2:return a.jsx(zGe,{data:Jb});case 3:return a.jsx(FGe,{data:Jb});default:return null}};return a.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-[800px] h-[600px] overflow-hidden flex flex-col",children:[a.jsxs("div",{className:"p-6 border-b border-gray-200 flex justify-between items-start",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wider",children:"Convert Lead"}),a.jsx("h1",{className:"text-2xl font-bold text-gray-900 mt-1",children:Jb.accountName})]}),a.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition",children:a.jsx($N,{className:"w-6 h-6"})})]}),a.jsx("div",{className:"flex border-b border-gray-200 bg-gray-50",children:l.map(u=>a.jsx("button",{onClick:()=>s(u.id),className:`flex-1 py-3 px-6 text-sm font-medium transition ${n===u.id?"bg-white text-gray-800 border-b-2 border-indigo-600":"bg-gray-600 text-white hover:bg-gray-700"}`,children:u.name},u.id))}),a.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:c()}),a.jsxs("div",{className:"p-4 border-t border-gray-200 bg-gray-50 flex justify-end space-x-3",children:[n>1&&a.jsx("button",{onClick:o,className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-100 flex items-center",children:"Cancel"}),n<r?a.jsx("button",{onClick:i,className:"px-5 py-2 text-white bg-gray-900 rounded-xl hover:bg-gray-800 transition",children:"Next"}):a.jsx("button",{onClick:i,className:"px-5 py-2 text-white bg-gray-900 rounded-xl hover:bg-gray-800 transition",children:"Convert"})]})]})})}const UGe={name:"Josh Vergara",status:"New",company:"Josh Inc.",title:"CEO",department:"Administration",email:"josh@joshinc.com",territory:"Cavite",assignedTo:"Admin",createdBy:"Admin",workPhone:"09253677323",phone1:"09253677323",phone2:"0907452874",source:"Website",addressLine1:"#1 Pilar Las Pinas",addressLine2:"Suite 400",city:"Las Pinas",state:"Metro Manila",zipCode:"1740",notes:"Interested in our premium plan."};function _ee({lead:e=UGe,onBack:t}){const[n,s]=f.useState(!1);return e?a.jsxs("div",{className:"p-4 sm:p-6 md:p-8 font-inter min-h-screen",children:[a.jsxs("button",{onClick:t,className:"inline-flex items-center text-sm sm:text-base text-gray-500 hover:text-gray-700 transition mb-4 sm:mb-6 cursor-pointer",children:[a.jsx(am,{className:"mr-1 w-4 h-4 sm:w-5 sm:h-5"})," Back"]}),a.jsx("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between mb-6 sm:mb-8 gap-2 sm:gap-4",children:a.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[a.jsx("h1",{className:"text-xl sm:text-2xl font-semibold",children:e.name}),a.jsx("span",{className:"bg-blue-100 text-blue-700 text-xs sm:text-sm font-medium px-2 sm:px-3 py-1 rounded-full",children:e.status}),a.jsx("div",{className:"flex flex-wrap items-center ml-0 sm:ml-1",children:a.jsx("button",{onClick:()=>s(!0),className:"bg-green-600 hover:bg-green-700 text-white px-3 sm:px-5 py-1.5 sm:py-2 rounded-lg font-medium text-xs sm:text-sm",children:"Convert"})})]})}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 md:p-8 border border-gray-200 mb-6 sm:mb-8",children:[a.jsx("h2",{className:"text-lg sm:text-xl font-semibold mb-4 sm:mb-6",children:"Lead Details"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 sm:gap-6 text-sm text-gray-700",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Name:"}),a.jsx("p",{children:e.name})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Company:"}),a.jsx("p",{children:e.company})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Title:"}),a.jsx("p",{children:e.title})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Department:"}),a.jsx("p",{children:e.department})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Email:"}),a.jsx("p",{children:e.email})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Territory:"}),a.jsx("p",{children:e.territory})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Assign To:"}),a.jsx("p",{children:e.assignedTo})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created By:"}),a.jsx("p",{children:e.createdBy})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Work Phone:"}),a.jsx("p",{children:e.workPhone})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Mobile Phone 1:"}),a.jsx("p",{children:e.phone1})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Mobile Phone 2:"}),a.jsx("p",{children:e.phone2})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Source:"}),a.jsx("p",{children:e.source})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6 mb-6 sm:mb-8",children:[a.jsxs("div",{className:"bg-white p-4 sm:p-6 rounded-xl border border-gray-200",children:[a.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Address:"}),a.jsxs("p",{className:"text-sm text-gray-700 leading-relaxed",children:[e.addressLine1," ",a.jsx("br",{}),e.addressLine2," ",a.jsx("br",{}),e.city,", ",e.state," ",e.zipCode]})]}),a.jsxs("div",{className:"bg-white p-4 sm:p-6 rounded-xl border border-gray-200",children:[a.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Notes:"}),a.jsx("p",{className:"text-sm text-gray-700 leading-relaxed",children:e.notes||"No notes available."})]})]}),a.jsxs("div",{className:"bg-white p-4 sm:p-6 rounded-xl border border-gray-200",children:[a.jsx("h3",{className:"font-semibold text-gray-800 mb-4 sm:mb-6",children:"Related Activities"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 sm:gap-8 text-sm",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold mb-2",children:"Tasks (2)"}),a.jsxs("div",{className:"space-y-1 text-gray-700",children:[a.jsx("p",{children:"Schedule follow-up call"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Due: 2025-09-15 | In Progress"}),a.jsx("p",{children:"Schedule follow-up call"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Due: 2025-09-18 | In Progress"})]}),a.jsx("a",{href:"#",className:"text-blue-600 hover:underline text-xs font-medium mt-2 inline-block",children:"View All Tasks"})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold mb-2",children:"Calls (2)"}),a.jsxs("div",{className:"space-y-1 text-gray-700",children:[a.jsx("p",{children:"Initial discovery call"}),a.jsx("p",{className:"text-xs text-gray-500",children:"2025-09-10 | Completed"}),a.jsx("p",{children:"Initial discovery call"}),a.jsx("p",{className:"text-xs text-gray-500",children:"2025-09-11 | Completed"})]}),a.jsx("a",{href:"#",className:"text-blue-600 hover:underline text-xs font-medium mt-2 inline-block",children:"View All Calls"})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold mb-2",children:"Meeting (0)"}),a.jsx("p",{className:"text-gray-500",children:"No meetings associated."}),a.jsx("a",{href:"#",className:"text-blue-600 hover:underline text-xs font-medium mt-2 inline-block",children:"View All Meetings"})]})]})]}),a.jsx(See,{isOpen:n,onClose:()=>s(!1)})]}):null}const BGe=oh.all(),ET=BGe.map(e=>({code:`+${e.countryCallingCode}`,name:e.countryCode}));function HGe(){const[e,t]=f.useState(null),[n,s]=f.useState(!1),[r,i]=f.useState(null),[o,l]=f.useState([{id:1,first_name:"Jane",last_name:"Doe"},{id:2,first_name:"John",last_name:"Smith"},{id:3,first_name:"Mary",last_name:"Johnson"}]),[c,u]=f.useState([{id:1,name:"Joshua Vergara",status:"Qualified",title:"Marketing Director",email:"sarah.williams@innovateco.com",phone1:"9271229484",phone2:"---------",workPhone:"999123-4567",work_ccode:"+63",m1_ccode:"+63",m2_ccode:"+63",territory:"East Coast",department:"Marketing",company:"Innovate Co.",createdBy:"John Appleseed",createdAt:"2025-09-10 09:30",lastUpdated:"2025-09-12 14:45",source:"Website",assignedTo:"Jane Doe",address:"123 Main St, City, Country",notes:"Important client"}]),[d,h]=f.useState({work_ccode:"+63",work_phone:"",m1_ccode:"+63",mobile_phone_1:"",m2_ccode:"+63",mobile_phone_2:""});f.useEffect(()=>{document.title="Leads | Sari-Sari CRM"},[]);const p=A=>t(A),x=()=>t(null),[b,j]=f.useState(""),[y,N]=f.useState("All Accounts"),w=()=>{s(!1),i(null),h({work_ccode:"+63",work_phone:"",m1_ccode:"+63",mobile_phone_1:"",m2_ccode:"+63",mobile_phone_2:""})},S=A=>{i(A),s(!0),h({work_ccode:A.work_ccode||"+63",work_phone:A.workPhone||"",m1_ccode:A.m1_ccode||"+63",mobile_phone_1:A.phone1||"",m2_ccode:A.m2_ccode||"+63",mobile_phone_2:A.phone2||""})},_=A=>{window.confirm("Are you sure you want to delete this lead?")&&u(c.filter(E=>E.id!==A))},T=A=>{const{name:E,value:M}=A.target;h(F=>({...F,[E]:M}))},k=A=>{A.preventDefault();const E=new FormData(A.target),M=Object.fromEntries(E.entries());M.name=`${M.firstName} ${M.lastName}`,M.assignedTo=o.find(F=>F.id.toString()===M.assignedTo)?.first_name+" "+o.find(F=>F.id.toString()===M.assignedTo)?.last_name,M.work_ccode=d.work_ccode,M.workPhone=d.work_phone,M.m1_ccode=d.m1_ccode,M.phone1=d.mobile_phone_1,M.m2_ccode=d.m2_ccode,M.phone2=d.mobile_phone_2,u(r?c.map(F=>F.id===r.id?{...F,...M}:F):[...c,{...M,id:c.length+1,createdAt:new Date().toISOString(),lastUpdated:new Date().toISOString()}]),w()};return e?a.jsx(_ee,{lead:e,onBack:x}):a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between mb-6 gap-3",children:[a.jsxs("h2",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(rn,{className:"mr-2 text-blue-600"})," Leads"]}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 w-full sm:w-auto",children:[a.jsxs("button",{className:"flex items-center justify-center border border-tertiary text-tertiary px-4 py-2 gap-2 rounded-md hover:bg-gray-800 hover:text-white transition w-full sm:w-auto",children:[a.jsx(Vo,{})," Download"]}),a.jsx("button",{onClick:()=>s(!0),className:"flex items-center justify-center bg-black text-white px-4 py-2 rounded-md hover:bg-gray-800 transition w-full sm:w-auto",children:" Add Leads"})]})]}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search Leads...",value:b,onChange:A=>j(A.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsx("div",{className:"w-full lg:w-1/4",children:a.jsxs("select",{value:y,onChange:A=>N(A.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{children:"All Leads"}),a.jsx("option",{children:"New"}),a.jsx("option",{children:"Contacted"}),a.jsx("option",{children:"Qualified"}),a.jsx("option",{children:"Converted"}),a.jsx("option",{children:"Lost"})]})})]}),a.jsxs("div",{className:"bg-white shadow-sm overflow-x-auto rounded-md border border-gray-200",children:[a.jsxs("div",{className:"grid grid-cols-9 min-w-[800px] bg-gray-100 font-bold text-gray-600 text-sm px-4 py-3",children:[a.jsx("div",{children:"Name"}),a.jsx("div",{children:"Account"}),a.jsx("div",{children:"Title"}),a.jsx("div",{children:"Department"}),a.jsx("div",{children:"Email"}),a.jsx("div",{children:"Work Phone"}),a.jsx("div",{children:"Assigned To"}),a.jsx("div",{children:"Updated"}),a.jsx("div",{className:"text-center",children:"Actions"})]}),c.map(A=>a.jsxs("div",{className:"grid grid-cols-9 min-w-[800px] px-4 py-3 text-xs hover:bg-gray-100 transition cursor-pointer gap-x-4",onClick:()=>p(A),children:[a.jsx("div",{className:"truncate",children:A.name}),a.jsx("div",{className:"truncate",children:A.company}),a.jsx("div",{className:"truncate",children:A.title}),a.jsx("div",{className:"truncate",children:A.department}),a.jsx("div",{className:"truncate",children:A.email}),a.jsxs("div",{className:"truncate",children:[A.work_ccode," ",A.workPhone]}),a.jsx("div",{className:"truncate",children:A.assignedTo}),a.jsx("div",{className:"truncate",children:A.lastUpdated}),a.jsxs("div",{className:"flex justify-center space-x-2",children:[a.jsx("button",{className:"text-blue-500 hover:text-blue-700",onClick:E=>{E.stopPropagation(),S(A)},children:a.jsx(gn,{})}),a.jsx("button",{className:"text-red-500 hover:text-red-700",onClick:E=>{E.stopPropagation(),_(A.id)},children:a.jsx(_a,{})})]})]},A.id))]}),n&&a.jsx("div",{id:"modalBackdrop",onClick:w,className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-3xl rounded-xl shadow-lg p-5 sm:p-6 relative border border-gray-200 my-6 max-h-[90vh] overflow-y-auto",onClick:A=>A.stopPropagation(),children:[a.jsx("button",{onClick:w,className:"absolute top-3 right-3 text-gray-400 hover:text-black transition",children:a.jsx(ea,{size:20})}),a.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-gray-800 mb-4 text-center",children:r?"Edit Lead":"Add New Lead"}),a.jsxs("form",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 text-xs sm:text-sm",onSubmit:k,children:[a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"text-gray-700 font-medium mb-1",children:"First Name"}),a.jsx("input",{name:"firstName",type:"text",placeholder:"Joe",defaultValue:r?r.name.split(" ")[0]:"",className:"border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-400 outline-none",required:!0})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"text-gray-700 font-medium mb-1",children:"Last Name"}),a.jsx("input",{name:"lastName",type:"text",placeholder:"Smith",defaultValue:r?r.name.split(" ")[1]:"",className:"border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-400 outline-none",required:!0})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"text-gray-700 font-medium mb-1",children:"Company"}),a.jsx("input",{name:"company",type:"text",placeholder:"ABC Company",defaultValue:r?.company||"",className:"border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-400 outline-none"})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"text-gray-700 font-medium mb-1",children:"Title"}),a.jsx("input",{name:"title",type:"text",placeholder:"ABC Agenda",defaultValue:r?.title||"",className:"border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-400 outline-none"})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"text-gray-700 font-medium mb-1",children:"Department"}),a.jsx("input",{name:"department",type:"text",placeholder:"Sales",defaultValue:r?.department||"",className:"border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-400 outline-none"})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"text-gray-700 font-medium mb-1",children:"Email"}),a.jsx("input",{name:"email",type:"text",placeholder:"abc@gmail.com",defaultValue:r?.email||"",className:"border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-400 outline-none"})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"text-gray-700 font-medium mb-1",children:"Work Phone"}),a.jsxs("div",{className:"border border-gray-300 rounded-md flex flex-row w-full gap-1",children:[a.jsx("select",{name:"work_ccode",value:d.work_ccode,onChange:T,className:"outline-none cursor-pointer py-2 border-r border-gray-400 w-15",children:ET.map(A=>a.jsx("option",{value:A.code,children:A.code},A.code))}),a.jsx("input",{type:"text",name:"work_phone",placeholder:"9----------",value:d.work_phone,onChange:T,className:"w-full outline-none"})]})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"text-gray-700 font-medium mb-1",children:"Mobile Phone 1"}),a.jsxs("div",{className:"border border-gray-300 rounded-md flex flex-row w-full gap-1",children:[a.jsx("select",{name:"m1_ccode",value:d.m1_ccode,onChange:T,className:"outline-none cursor-pointer py-2 border-r border-gray-400 w-15",children:ET.map(A=>a.jsx("option",{value:A.code,children:A.code},A.code))}),a.jsx("input",{type:"text",name:"mobile_phone_1",placeholder:"9----------",value:d.mobile_phone_1,onChange:T,className:"w-full outline-none"})]})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"text-gray-700 font-medium mb-1",children:"Mobile Phone 2"}),a.jsxs("div",{className:"border border-gray-300 rounded-md flex flex-row w-full gap-1",children:[a.jsx("select",{name:"m2_ccode",value:d.m2_ccode,onChange:T,className:"outline-none cursor-pointer py-2 border-r border-gray-400 w-15",children:ET.map(A=>a.jsx("option",{value:A.code,children:A.code},A.code))}),a.jsx("input",{type:"text",name:"mobile_phone_2",placeholder:"9----------",value:d.mobile_phone_2,onChange:T,className:"w-full outline-none"})]})]}),a.jsxs("div",{className:"flex flex-col col-span-1 sm:col-span-2 lg:col-span-3",children:[a.jsx("label",{className:"text-gray-700 font-medium mb-1",children:"Address"}),a.jsx("input",{name:"address",type:"text",placeholder:"Street No., Street Name, City, State/Province, Postal Code",defaultValue:r?.address||"",className:"border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-400 outline-none"})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"text-gray-700 font-medium mb-1",children:"Assign To"}),a.jsxs("select",{name:"assignedTo",defaultValue:o.find(A=>`${A.first_name} ${A.last_name}`===r?.assignedTo)?.id||"",className:"border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-400 outline-none",children:[a.jsx("option",{value:"",disabled:!0,children:"Select user"}),o.map(A=>a.jsxs("option",{value:A.id,children:[A.first_name," ",A.last_name]},A.id))]})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"text-gray-700 font-medium mb-1",children:"Territory"}),a.jsx("input",{type:"text",disabled:!0,name:"territory_id",placeholder:"Assign a user",className:"border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-400 outline-none"})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"text-gray-700 font-medium mb-1",children:"Source"}),a.jsxs("select",{className:"border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-400 outline-none",defaultValue:r?.source||"",name:"source",children:[a.jsx("option",{value:"",disabled:!0,children:"Select Source"}),a.jsx("option",{value:"Website",children:"Website"}),a.jsx("option",{value:"Referral",children:"Referral"}),a.jsx("option",{value:"Cold call",children:"Cold call"}),a.jsx("option",{value:"Event",children:"Event"}),a.jsx("option",{value:"Other",children:"Other"})]})]}),a.jsxs("div",{className:"flex flex-col col-span-1 sm:col-span-2 lg:col-span-3",children:[a.jsx("label",{className:"text-gray-700 font-medium mb-1",children:"Notes"}),a.jsx("textarea",{name:"notes",placeholder:"Additional details...",rows:3,defaultValue:r?.notes||"",className:"border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-400 outline-none resize-none"})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-2 mt-2 col-span-1 sm:col-span-2 lg:col-span-3",children:[a.jsx("button",{type:"button",onClick:w,className:"px-4 py-2 text-white bg-red-400 border border-red-300 rounded hover:bg-red-500 transition",children:"Cancel"}),a.jsx("button",{type:"submit",className:"px-4 py-2 text-white border border-tertiary bg-tertiary rounded hover:bg-secondary transition",children:r?"Update Lead":"Save Lead"})]})]})]})})]})}const nH=["To Do","In Progress","Review","Completed"],Ug=10,qGe=e=>{if(!e)return"";const t=new Date(e);if(Number.isNaN(t.getTime()))return"";const n=t.getTimezoneOffset();return new Date(t.getTime()-n*60*1e3).toISOString().slice(0,16)},sH=e=>{if(!e)return"";const t=new Date(e);return Number.isNaN(t.getTime())?"":t.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},GGe=e=>{const t=e.subject?.trim()??"",n=e.description?.trim()??"",s=e.notes?.trim()??"";e.priority&&String(e.priority).toUpperCase(),e.status&&String(e.status).toUpperCase();let r=null,i=null,o=null,l=null;e.relatedType1==="Lead"&&e.relatedTo1?r=Number(e.relatedTo1):e.relatedType1==="Account"&&e.relatedTo1&&(i=Number(e.relatedTo1)),e.relatedType1==="Account"&&(e.relatedType2==="Contact"&&e.relatedTo2?o=Number(e.relatedTo2):e.relatedType2==="Deal"&&e.relatedTo2&&(l=Number(e.relatedTo2)));const c=e.assignedTo?Number(e.assignedTo):null,u=o||l||i||r,d=o?"Contact":l?"Deal":i?"Account":r?"Lead":null;return{title:t,description:n,priority:e.priority||"Normal",status:e.status||"Not started",due_date:e.dueDate?e.dueDate:null,assigned_to:c,notes:s,is_personal:!1,lead_id:r,account_id:i,contact_id:o,deal_id:l,related_to_1:e.relatedTo1?Number(e.relatedTo1):null,related_type_1:e.relatedType1,related_to_2:e.relatedTo2?Number(e.relatedTo2):null,related_type_2:e.relatedType2,related_to:u,related_type:d}},WGe=e=>{const t=e.task_assign_to?`${e.task_assign_to.first_name} ${e.task_assign_to.last_name}`:e.assigned_to?String(e.assigned_to):"Unassigned",n=e.task_creator?`${e.task_creator.first_name} ${e.task_creator.last_name}`:e.created_by?String(e.created_by):"System",s=e.due_date||e.dueDate||null,r=e.date_assigned||e.created_at||null,i=e.contact?`${e.contact.first_name} ${e.contact.last_name}`:e.assigned_to?String(e.assigned_to.id):"Unassigned",o=()=>e.lead?.id||e.lead_id,l=()=>e.account?.id||e.account_id,c=()=>e.contact?.id||e.contact_id,u=()=>e.deal?.id||e.deal_id,d=()=>e.task_assign_to?.id||e.assigned_to,h=()=>e.lead?.title||e.lead_id,p=()=>e.account?.name||e.account_id,x=()=>i||e.contact_id,b=()=>e.deal?.name||e.deal_id;let j="Lead",y="",N="",w="",S="Lead",_="",T="",k="";const A=l(),E=p(),M=o(),F=h();if(A){j="Account",S="Account",_=E,y=String(A);const D=c(),P=u(),B=x(),G=b();D?(N="Contact",T="Contact",k=B,w=String(D)):P&&(T="Deal",N="Deal",k=G,w=String(P))}else M?(S="Lead",_=F,j="Lead",y=String(M)):e.related_type==="Account"&&(j="Account",y=String(e.related_to));return{id:e.id,title:e.title,description:e.description,priority:e.priority||"Normal",status:e.status||"Not started",dueDate:s,dateAssigned:r,assignedToId:d()||null,assignedToName:t,createdAt:e.created_at||null,createdById:e.created_by??null,createdBy:n,notes:e.notes||"",isPersonal:!!e.is_personal,relatedType1Text:S,relatedTo1Text:_,relatedType2Text:T,relatedTo2Text:k,subject:e.title,relatedType1:j,relatedTo1:y,relatedType2:N,relatedTo2:w}};function VGe(){f.useEffect(()=>{document.title="Tasks | Sari-Sari CRM"},[]);const{user:e,loading:t}=Gt(),[n,s]=f.useState("board"),[r,i]=f.useState(!1),[o,l]=f.useState(null),[c,u]=f.useState(!1),[d,h]=f.useState([]),[p,x]=f.useState(!0),[b,j]=f.useState(""),[y,N]=f.useState("Filter by Status"),[w,S]=f.useState("Filter by Priority"),[_,T]=f.useState([]),[k,A]=f.useState(1),[E,M]=f.useState(null),[F,D]=f.useState(!1),P=Et(),B=ta(),[G,$]=f.useState({id:"",subject:"",description:"",priority:"",status:"",dueDate:"",assignedTo:"",notes:"",relatedType1:"Lead",relatedType2:"Contact",relatedTo1:"",relatedTo2:""});f.useEffect(()=>{const he=B.state?.openTaskModal,Re=B.state?.initialTaskData;he&&(i(!0),Re&&$(Ee=>({...Ee,...Re})),P(B.pathname,{replace:!0,state:{}}))},[B,P]);const W=async()=>{try{const he=await ne.get("/users/all");T(Array.isArray(he.data)?he.data:[])}catch(he){console.error("Failed to fetch users:",he),V.error("Failed to fetch users.")}},Z=async()=>{try{x(!0);const he=await ne.get("/tasks/all"),Ee=(Array.isArray(he.data)?he.data:[]).map(WGe);Ee.sort((He,Ke)=>{const st=He.createdAt?new Date(He.createdAt):0;return(Ke.createdAt?new Date(Ke.createdAt):0)-st}),console.log("Fetched Tasks:",Ee),h(Ee),n==="list"&&A(1)}catch(he){console.error("Failed to load tasks:",he),V.error("Failed to load tasks.")}finally{x(!1)}};f.useEffect(()=>{!t&&e&&(W(),Z())},[t,e]);const Q=()=>{l(null),$({id:"",subject:"",description:"",priority:"Normal",status:"Not started",dueDate:"",assignedTo:"",notes:"",relatedType1:"Lead",relatedType2:"Contact",relatedTo1:"",relatedTo2:""})},le=(he=null,Re=!1)=>{l(he),u(Re),he?$({id:he.id,subject:he.title||"",description:he.description||"",priority:he.priority||"Normal",status:he.status||"Not started",dueDate:qGe(he.dueDate),assignedTo:he.assignedToId?String(he.assignedToId):"",notes:he.notes||"",relatedType1Text:he.relatedType1Text||"",relatedTo1Text:he.relatedTo1Text||"",relatedType2Text:he.relatedType2Text||"",relatedTo2Text:he.relatedTo2Text||"",relatedType1:he.relatedType1||"",relatedTo1:he.relatedTo1||"",relatedType2:he.relatedType2||"",relatedTo2:he.relatedTo2||""}):Q(),i(!0)},we=()=>{i(!1),l(null),u(!1),Q()},J=async he=>{const Re=GGe(he);try{o&&!c?(await ne.put(`/tasks/${o.id}`,Re),V.success("Task updated successfully.")):(await ne.post("/tasks/create",Re),V.success("Task created successfully.")),i(!1),await Z()}catch(Ee){console.error("Failed to save task:",Ee);const He=Ee.response?.data?.detail||"Failed to save task.";V.error(He)}},se=he=>{he&&M({title:"Delete Task",message:a.jsxs(a.Fragment,{children:["Are you sure you want to delete ",a.jsx("span",{className:"font-semibold",children:he.title}),"?"]}),confirmLabel:"Delete Task",cancelLabel:"Cancel",variant:"danger",action:{type:"delete",targetId:he.id}})},ye=async()=>{if(!E?.action){M(null);return}const{action:he}=E;D(!0);try{he.type==="delete"&&(await ne.delete(`/tasks/${he.targetId}`),V.success("Task deleted successfully."),await Z())}catch(Re){console.error("Task action failed:",Re),V.error("Failed to delete task.")}finally{D(!1),M(null)}},Ce=()=>{F||M(null)},ge=f.useMemo(()=>{const he=b.trim().toLowerCase();return[...d].sort((Ee,He)=>{const Ke=Ee.createdAt?new Date(Ee.createdAt):0;return(He.createdAt?new Date(He.createdAt):0)-Ke}).filter(Ee=>{const He=he===""||Ee.title?.toLowerCase().includes(he)||Ee.description?.toLowerCase().includes(he)||Ee.assignedToName?.toLowerCase().includes(he)||Ee.createdBy?.toLowerCase().includes(he),Ke=y==="Filter by Status"||Ee.status===y,st=w==="Filter by Priority"||Ee.priority===w;return He&&Ke&&st})},[d,b,y,w]);f.useEffect(()=>{A(1)},[b,y,w,n]),f.useEffect(()=>{if(n==="list"){const he=ge.length===0?1:Math.ceil(ge.length/Ug);k>he&&A(he)}},[ge.length,k,n]);const be=f.useMemo(()=>{if(n==="board")return ge;const he=(k-1)*Ug;return ge.slice(he,he+Ug)},[ge,k,n]),me=f.useMemo(()=>{const he=new Date;return[{title:"To Do",value:d.filter(Re=>Re.status==="Not started").length,icon:Vn,color:"text-blue-600",bgColor:"bg-blue-100"},{title:"In Progress",value:d.filter(Re=>Re.status==="In progress").length,icon:Yi,color:"text-purple-600",bgColor:"bg-purple-100"},{title:"Completed",value:d.filter(Re=>Re.status==="Completed").length,icon:La,color:"text-green-600",bgColor:"bg-green-100"},{title:"Overdue",value:d.filter(Re=>Re.dueDate&&new Date(Re.dueDate)<he&&Re.status!=="Completed").length,icon:Fl,color:"text-red-600",bgColor:"bg-red-100"},{title:"High Priority",value:d.filter(Re=>Re.priority==="High").length,icon:ec,color:"text-orange-600",bgColor:"bg-orange-100"}]},[d]),Ae=he=>he.dueDate&&new Date(he.dueDate)<new Date&&he.status!=="Completed",pe=he=>{switch(he.status){case"To Do":return"bg-blue-50 hover:bg-blue-100 border-blue-200";case"In Progress":return"bg-purple-50 hover:bg-purple-100 border-purple-200";case"Review":return"bg-orange-50 hover:bg-orange-100 border-orange-200";case"Completed":return"bg-green-50 hover:bg-green-100 border-green-200";default:return"bg-gray-50 hover:bg-gray-100 border-gray-100"}},Ie=he=>{switch(he){case"To Do":return"bg-blue-100 text-blue-700";case"In Progress":return"bg-purple-100 text-purple-700";case"Review":return"bg-orange-100 text-orange-700";case"Completed":return"bg-green-100 text-green-700";default:return"bg-gray-100 text-gray-700"}},xe=he=>{switch(he){case"High":return"bg-red-100 text-red-700";case"Normal":return"bg-yellow-100 text-yellow-700";default:return"bg-gray-100 text-gray-700"}};return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 min-h-screen font-inter relative",children:[(p||t)&&a.jsx(qt,{message:"Loading tasks..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 space-y-2 sm:space-y-0",children:[a.jsxs("h1",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[a.jsx(Yi,{className:"text-blue-600"})," Tasks Board"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{type:"button",onClick:()=>le(),className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 rounded-md hover:bg-gray-800 text-sm sm:text-base self-end sm:self-auto mt-2 lg:mt-0 cursor-pointer",children:[a.jsx(aa,{})," Create Task"]})})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 xl:grid-cols-5 gap-4 mb-6 w-full break-words overflow-hidden lg:overflow-visible",children:me.map(he=>a.jsx(YGe,{...he},he.title))}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mt-6 mb-4 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search tasks",value:b,onChange:he=>j(he.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row w-full lg:w-1/2 gap-2",children:[a.jsxs("select",{value:y,onChange:he=>N(he.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{children:"Filter by Status"}),nH.map(he=>a.jsx("option",{children:he},he))]}),a.jsxs("select",{value:w,onChange:he=>S(he.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{children:"Filter by Priority"}),a.jsx("option",{children:"High"}),a.jsx("option",{children:"Normal"}),a.jsx("option",{children:"Low"})]})]})]}),a.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[a.jsx("button",{type:"button",onClick:()=>s("board"),className:`px-4 py-2 rounded-full text-sm ${n==="board"?"bg-gray-800 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Board View"}),a.jsx("button",{type:"button",onClick:()=>s("list"),className:`px-4 py-2 rounded-full text-sm ${n==="list"?"bg-gray-800 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"List View"})]}),!p&&!t&&ge.length===0&&a.jsx("p",{className:"text-center text-gray-500 mt-10 p-4 bg-white shadow rounded-lg",children:"No tasks found matching current filters."}),!p&&!t&&ge.length>0&&n==="board"&&a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4 rounded-md",children:nH.map(he=>{const Re=be.filter(Ee=>Ee.status===he);return a.jsxs("div",{className:"bg-white p-4 shadow border border-gray-200 flex flex-col relative",children:[a.jsx("div",{className:"absolute top-0 left-0 w-full h-5 bg-secondary rounded-t-md"}),a.jsxs("div",{className:"flex items-center justify-between mb-3 pt-7",children:[a.jsx("h3",{className:"font-medium text-gray-900",children:he}),a.jsx("span",{className:"text-xs bg-gray-100 px-2 py-1 rounded-full text-gray-500",children:Re.length})]}),a.jsx("div",{className:`space-y-3 ${Re.length>3?"overflow-y-auto max-h-[480px] hide-scrollbar":""}`,children:Re.length>0?Re.map(Ee=>a.jsxs("div",{className:`border rounded-lg p-3 transition flex justify-between items-start cursor-pointer ${pe(Ee)}`,onClick:()=>le(Ee,!0),children:[a.jsxs("div",{className:"text-left flex-1",children:[a.jsx("p",{className:"font-medium text-gray-800 text-sm",children:Ee.title}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Priority: ",Ee.priority]}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Assigned To: ",Ee.assignedToName]}),a.jsxs("p",{className:"text-xs mt-1 text-gray-500",children:["Date: ",a.jsx("span",{className:Ae(Ee)?"text-red-600":"text-gray-600",children:Ee.dateAssigned?sH(Ee.dateAssigned):""})]})]}),a.jsxs("div",{className:"flex items-center gap-2 ml-3",children:[a.jsx("button",{type:"button",onClick:He=>{He.stopPropagation(),le(Ee)},className:"text-blue-500 hover:text-blue-700",children:a.jsx(hn,{})}),a.jsx("button",{type:"button",onClick:He=>{He.stopPropagation(),se(Ee)},className:"text-red-500 hover:text-red-700",children:a.jsx(_a,{})})]})]},Ee.id)):a.jsx("p",{className:"text-sm text-gray-400 text-center py-4",children:"No tasks"})})]},he)})}),!p&&!t&&ge.length>0&&n==="list"&&a.jsx("div",{className:"bg-white rounded-md shadow-sm overflow-hidden",children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-gray-600 text-left",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 font-medium",children:"Task"}),a.jsx("th",{className:"py-3 px-4 font-medium",children:"Status"}),a.jsx("th",{className:"py-3 px-4 font-medium",children:"Priority"}),a.jsx("th",{className:"py-3 px-4 font-medium",children:"Assigned To"}),a.jsx("th",{className:"py-3 px-4 font-medium",children:"Date Assigned"}),a.jsx("th",{className:"py-3 px-4 font-medium",children:"Actions"})]})}),a.jsx("tbody",{children:be.map(he=>a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors text-sm cursor-pointer",onClick:()=>{console.log("Opening task in view mode:",he),le(he,!0)},children:[a.jsx("td",{className:"py-3 px-4 text-gray-700 whitespace-nowrap font-medium",children:he.title}),a.jsx("td",{className:"py-3 px-4 whitespace-nowrap",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium whitespace-nowrap ${Ie(he.status||"To Do")}`,children:he.status||"To Do"})}),a.jsx("td",{className:"py-3 px-4 whitespace-nowrap",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium whitespace-nowrap ${xe(he.priority||"Low")}`,children:he.priority||"Low"})}),a.jsx("td",{className:"py-3 px-4 text-gray-700 whitespace-nowrap",children:he.assignedToName||"Unassigned"}),a.jsx("td",{className:`py-3 px-4 text-gray-700 whitespace-nowrap ${Ae(he)?"text-red-600 font-medium":""}`,children:he.dateAssigned?sH(he.dateAssigned):""}),a.jsx("td",{className:"py-3 px-4 whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center gap-3",onClick:Re=>Re.stopPropagation(),children:[a.jsxs("button",{type:"button",onClick:()=>le(he),className:"text-blue-500 hover:text-blue-700 flex items-center gap-1",children:[a.jsx(hn,{})," Edit"]}),a.jsxs("button",{type:"button",onClick:()=>se(he),className:"text-red-500 hover:text-red-700 flex items-center gap-1",children:[a.jsx(_a,{})," Delete"]})]})})]},he.id))})]})})}),!p&&!t&&n==="list"&&a.jsx(ca,{className:"mt-6",totalItems:ge.length,pageSize:Ug,currentPage:ge.length===0?0:k,onPrev:()=>A(he=>Math.max(he-1,1)),onNext:()=>A(he=>Math.min(he+1,Math.max(1,Math.ceil(ge.length/Ug)||1))),label:"tasks"}),a.jsx(N0,{isOpen:r,onClose:we,onSave:J,onEdit:()=>u(!1),setFormData:$,formData:G,isEditing:!c&&!!o,viewMode:c,users:_,currentUser:e,onDelete:se}),E&&a.jsx(QGe,{open:!0,title:E.title,message:E.message,confirmLabel:E.confirmLabel,cancelLabel:E.cancelLabel,variant:E.variant,onConfirm:ye,onCancel:Ce,loading:F})]})}function YGe({icon:e,title:t,value:n,color:s,bgColor:r,onClick:i}){return a.jsxs("div",{className:"flex items-center p-4 bg-white rounded-xl shadow-md border border-gray-200 transition-all duration-300 cursor-default",onClick:i,children:[a.jsx("div",{className:`flex-shrink-0 p-3 rounded-full ${r} ${s} mr-4`,children:e?a.jsx(e,{size:22}):null}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:t}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:n})]})]})}function QGe({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r,variant:i,loading:o,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsx("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${u}`,disabled:o,children:o?"Processing...":s})]})]})})}function KGe(){f.useEffect(()=>{document.title="Campaign | Sari-Sari CRM"},[]);const[e,t]=f.useState(!1),[n,s]=f.useState(!1),[r,i]=f.useState(null),[o,l]=f.useState(""),[c,u]=f.useState("All Statuses"),[d,h]=f.useState({show:!1,action:null,campaign:null}),[p,x]=f.useState([{id:1,name:"Christmas Promo 2025",subject:" Holiday Discounts Await You!",content:"Spread holiday cheer with exclusive deals this Christmas season!",status:"Scheduled",recipients:1200,scheduleDate:"2025-12-15T10:00",created:"2025-10-20",createdBy:"Marketing Team"},{id:2,name:"New Year Kickoff",subject:"Start 2026 with Big Savings!",content:"Kick off your year right with amazing offers from us!",status:"Draft",recipients:"",scheduleDate:"",created:"2025-10-25",createdBy:"Marketing Team"}]),[b,j]=f.useState({id:null,name:"",subject:"",content:"",status:"Draft",recipients:"",scheduleDate:""}),y=p.filter(D=>{const P=c==="All Statuses"||D.status===c,B=D.name.toLowerCase().includes(o.toLowerCase())||D.subject.toLowerCase().includes(o.toLowerCase());return P&&B}),N=()=>{s(!1),j({id:null,name:"",subject:"",content:"",status:"Draft",recipients:"",scheduleDate:""}),t(!0)},w=(D,P)=>{P.stopPropagation(),s(!0),j(D),t(!0)},S=(D,P)=>{P.stopPropagation(),h({show:!0,action:"delete",campaign:D})},_=D=>{D.preventDefault(),h({show:!0,action:n?"edit":"add",campaign:{...b}})},T=()=>{if(d.action==="add"){const D={...d.campaign,id:Date.now(),created:new Date().toLocaleDateString(),createdBy:"Marketing Team"};x(P=>[...P,D]),t(!1)}else d.action==="edit"?(x(D=>D.map(P=>P.id===d.campaign.id?{...d.campaign}:P)),t(!1)):d.action==="delete"&&x(D=>D.filter(P=>P.id!==d.campaign.id));h({show:!1,action:null,campaign:null})},k=()=>{h({show:!1,action:null,campaign:null})},A=D=>i(D),E=()=>i(null),M=D=>{const{name:P,value:B}=D.target;j(G=>({...G,[P]:B}))},F=D=>{D.target.id==="modalBackdrop"&&t(!1)};return r?a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter",children:[a.jsxs("button",{onClick:E,className:"inline-flex items-center text-sm sm:text-base text-gray-500 hover:text-gray-700 transition mb-6 cursor-pointer",children:[a.jsx(am,{className:"mr-1 w-5 h-5"})," Back"]}),a.jsx("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center mb-6",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-800",children:r.name}),a.jsx("span",{className:`text-xs sm:text-sm px-2 py-0.5 rounded ${r.status==="Scheduled"?"bg-yellow-100 text-yellow-700":r.status==="Sent"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-600"}`,children:r.status})]})}),a.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[a.jsx("h2",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Campaign Information"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 text-sm text-gray-700",children:[a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:"Subject:"})," ",a.jsx("br",{}),r.subject]}),a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:"Created By:"})," ",a.jsx("br",{}),r.createdBy]}),a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:"Created On:"})," ",a.jsx("br",{}),r.created]}),a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:"Scheduled Date:"})," ",a.jsx("br",{}),r.scheduleDate?new Date(r.scheduleDate).toLocaleString():""]}),a.jsxs("p",{className:"sm:col-span-2",children:[a.jsx("span",{className:"font-semibold",children:"Email Content:"})," ",a.jsx("br",{}),r.content]}),r.status==="Scheduled"&&a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:"Recipients:"})," ",a.jsx("br",{}),r.recipients]})]})]})]}):a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h2",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(sn,{className:"mr-2 text-blue-600"})," Email Campaigns"]}),a.jsx("button",{onClick:N,className:"flex items-center bg-black text-white px-4 py-2 rounded-md hover:bg-gray-800 transition text-sm sm:text-base shadow-sm",children:" New Campaign"})]}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search by campaign name or email subject...",value:o,onChange:D=>l(D.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsx("div",{className:"w-full lg:w-1/4",children:a.jsxs("select",{value:c,onChange:D=>u(D.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{children:"All Statuses"}),a.jsx("option",{children:"Draft"}),a.jsx("option",{children:"Scheduled"}),a.jsx("option",{children:"Sent"})]})})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-[700px] w-full border border-gray-200 rounded-lg bg-white shadow-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-sm text-gray-600",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4",children:"Campaign Name"}),a.jsx("th",{className:"py-3 px-4",children:"Email Subject"}),a.jsx("th",{className:"py-3 px-4",children:"Status"}),a.jsx("th",{className:"py-3 px-4",children:"Recipients"}),a.jsx("th",{className:"py-3 px-4",children:"Scheduled Date"}),a.jsx("th",{className:"py-3 px-4 text-center",children:"Actions"})]})}),a.jsx("tbody",{className:"text-sm text-gray-700",children:y.map((D,P)=>a.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer transition",onClick:()=>A(D),children:[a.jsx("td",{className:"py-3 px-4 font-medium text-blue-600",children:D.name}),a.jsx("td",{className:"py-3 px-4",children:D.subject}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${D.status==="Scheduled"?"bg-yellow-100 text-yellow-700":D.status==="Sent"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-600"}`,children:D.status})}),a.jsx("td",{className:"py-3 px-4",children:D.recipients?`${D.recipients} emails`:""}),a.jsx("td",{className:"py-3 px-4",children:D.scheduleDate?new Date(D.scheduleDate).toLocaleString():""}),a.jsx("td",{className:"py-3 px-4 text-center",onClick:B=>B.stopPropagation(),children:a.jsxs("div",{className:"flex justify-center gap-3",children:[a.jsx("button",{onClick:B=>w(D,B),className:"text-blue-500 hover:text-blue-700",children:a.jsx(gn,{})}),a.jsx("button",{onClick:B=>S(D,B),className:"text-red-500 hover:text-red-700",children:a.jsx(_a,{})})]})})]},P))})]})}),e&&a.jsx("div",{id:"modalBackdrop",onClick:F,className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-2xl rounded-xl shadow-lg p-5 sm:p-6 relative border border-gray-200 my-6 max-h-[90vh] overflow-y-auto",onClick:D=>D.stopPropagation(),children:[a.jsx("button",{onClick:()=>t(!1),className:"absolute top-3 right-3 text-gray-400 hover:text-black transition",children:a.jsx(ea,{size:20})}),a.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-gray-800 mb-4 text-center",children:n?"Edit Campaign":"Add New Campaign"}),a.jsxs("form",{onSubmit:_,className:"grid grid-cols-1 sm:grid-cols-2 gap-4 text-sm",children:[a.jsxs("div",{className:"flex flex-col",children:[a.jsxs("label",{className:"text-gray-700 font-medium mb-1",children:["Campaign Name ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",name:"name",value:b.name,onChange:M,placeholder:"e.g. Summer Sale Blast",required:!0,className:"border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-400 outline-none"})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsxs("label",{className:"text-gray-700 font-medium mb-1",children:["Email Subject ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",name:"subject",value:b.subject,onChange:M,placeholder:"e.g. Big discounts await you!",required:!0,className:"border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-400 outline-none"})]}),a.jsxs("div",{className:"flex flex-col sm:col-span-2",children:[a.jsxs("label",{className:"text-gray-700 font-medium mb-1",children:["Campaign Status ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("select",{name:"status",value:b.status,onChange:M,required:!0,className:"border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-400 outline-none",children:[a.jsx("option",{value:"Draft",children:"Draft"}),a.jsx("option",{value:"Scheduled",children:"Scheduled"}),a.jsx("option",{value:"Sent",children:"Sent"})]})]}),b.status==="Scheduled"&&a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:col-span-2",children:[a.jsxs("div",{className:"flex flex-col",children:[a.jsxs("label",{className:"text-gray-700 font-medium mb-1",children:["Scheduled Date ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"datetime-local",name:"scheduleDate",value:b.scheduleDate,onChange:M,required:!0,className:"border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-400 outline-none"})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsxs("label",{className:"text-gray-700 font-medium mb-1",children:["Recipient Count ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"number",name:"recipients",value:b.recipients,onChange:M,placeholder:"e.g. 500",required:!0,className:"border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-400 outline-none"})]})]}),a.jsxs("div",{className:"flex flex-col sm:col-span-2",children:[a.jsxs("label",{className:"text-gray-700 font-medium mb-1",children:["Email Content ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("textarea",{name:"content",rows:4,value:b.content,onChange:M,placeholder:"Write your email message here...",required:!0,className:"border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-400 outline-none resize-none"})]}),a.jsxs("div",{className:"flex justify-end gap-2 sm:col-span-2 pt-3 border-t border-gray-100 mt-2",children:[a.jsx("button",{type:"button",onClick:()=>t(!1),className:"px-4 py-2 text-gray-700 bg-gray-100 border border-gray-300 rounded-md hover:bg-gray-200 transition",children:"Cancel"}),a.jsx("button",{type:"submit",className:"px-4 py-2 bg-black text-white rounded-md hover:bg-gray-800 transition",children:"Save Campaign"})]})]})]})}),d.show&&a.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 relative border border-gray-200",children:[a.jsx("button",{onClick:k,className:"absolute top-3 right-3 text-gray-400 hover:text-black transition",children:a.jsx(ea,{size:20})}),a.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-gray-800 mb-4 text-center",children:d.action==="delete"?"Confirm Delete":d.action==="edit"?"Confirm Edit":"Confirm Add"}),a.jsx("p",{className:"text-center text-gray-600 mb-6",children:d.action==="delete"?a.jsxs(a.Fragment,{children:["Are you sure you want to delete the campaign"," ",a.jsx("span",{className:"font-semibold",children:d.campaign.name}),"?"]}):d.action==="edit"?a.jsxs(a.Fragment,{children:["Save changes to"," ",a.jsx("span",{className:"font-semibold",children:d.campaign.name}),"?"]}):a.jsxs(a.Fragment,{children:["Add new campaign"," ",a.jsx("span",{className:"font-semibold",children:d.campaign.name}),"?"]})}),a.jsxs("div",{className:"flex justify-center gap-4",children:[a.jsx("button",{onClick:k,className:"px-4 py-2 text-gray-700 bg-gray-100 border border-gray-300 rounded-md hover:bg-gray-200 transition",children:"Cancel"}),a.jsx("button",{onClick:T,className:"px-4 py-2 bg-black text-white rounded-md hover:bg-gray-800 transition",children:"Confirm"})]})]})})]})}const XGe=[{id:1,name:"Welcome E-mail",category:"Welcome",subject:"Welcome to {company}!",body:`Hi {name}, Welcome to {company}! We're excited to have you on board.

Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed vel quam vitae erat venenatis feugiat. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas.

Best regards, The Team`,createdBy:"Angel Angelo",date:"12/10/23"},{id:2,name:"Product Demo Follow-up",category:"Follow-up",subject:"Thanks for checking out our demo",body:`Hi {name}, Thank you for taking the time to view our product demo.
Do you have any questions? Let's schedule a call to discuss how we can help {company}.

Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed vel quam vitae erat venenatis feugiat. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas.

Best, Sales Team`,createdBy:"Angel Angelo",date:"12/10/23"}],rH={Welcome:"bg-orange-100 text-orange-700","Follow-up":"bg-blue-100 text-blue-700",Newsletter:"bg-green-100 text-green-700",Promotional:"bg-purple-100 text-purple-700",default:"bg-gray-100 text-gray-800"};function ZGe(){f.useEffect(()=>{document.title="Templates | Sari-Sari CRM"},[]);const[e,t]=f.useState(XGe),[n,s]=f.useState(!1),[r,i]=f.useState(null),[o,l]=f.useState(null),[c,u]=f.useState(""),[d,h]=f.useState("All Categories"),[p,x]=f.useState({name:"",category:"",subject:"",body:""}),[b,j]=f.useState({show:!1,action:null,template:null}),y=()=>{l(null),i(null),s(!1)},N=P=>{x({...p,[P.target.name]:P.target.value})},w=()=>{j({show:!0,action:"add",template:{...p}})},S=P=>{i(P),x({name:P.name,category:P.category,subject:P.subject,body:P.body})},_=()=>{j({show:!0,action:"edit",template:{...p,id:r.id}})},T=P=>{j({show:!0,action:"delete",template:P})},k=P=>{Jx.success(`Template "${P.name}" selected for use!`),j({show:!1,action:null,template:null})},A=()=>{const P=b.template;if(b.action==="add"){const B={...P,id:e.length+1,createdBy:"You",date:new Date().toLocaleDateString()};t(G=>[B,...G]),s(!1),x({name:"",category:"",subject:"",body:""})}else b.action==="edit"?(t(B=>B.map(G=>G.id===P.id?{...P}:G).sort((G,$)=>new Date($.date).getTime()-new Date(G.date).getTime())),i(null),x({name:"",category:"",subject:"",body:""}),l(null)):b.action==="delete"&&(t(B=>B.filter(G=>G.id!==P.id)),l(null));j({show:!1,action:null,template:null})},E=()=>{j({show:!1,action:null,template:null})},M=P=>l(P),F=e.filter(P=>P.name.toLowerCase().includes(c.toLowerCase())&&(d==="All Categories"||P.category===d)),D=(P,B=!1)=>a.jsxs("div",{className:"flex flex-col justify-between h-full",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:P.name}),a.jsx("span",{className:`text-xs px-3 py-1 rounded-md ${rH[P.category]||rH.default}`,children:P.category})]}),a.jsx("p",{className:"text-gray-600 mb-2 text-sm",children:P.subject}),a.jsx("div",{className:`text-gray-800 text-sm p-2 rounded-md ${B?"bg-gray-50 max-h-40 overflow-y-auto":"truncate"} whitespace-pre-line`,style:B?{}:{display:"-webkit-box",WebkitLineClamp:7,WebkitBoxOrient:"vertical",overflow:"hidden"},children:P.body})]}),a.jsxs("div",{className:"flex justify-between items-center mt-4",children:[!B&&a.jsxs("button",{onClick:G=>{G.stopPropagation(),k(P)},className:"flex items-center gap-1 bg-black text-white px-3 py-1 rounded-md text-sm hover:bg-gray-900 transition",children:[a.jsx(ia,{})," Use Template"]}),B&&a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("button",{onClick:G=>{G.stopPropagation(),S(P)},className:"flex items-center gap-1 bg-black text-white px-3 py-1 rounded-md text-sm hover:bg-gray-900 transition",children:[a.jsx(hn,{})," Edit"]}),a.jsxs("button",{onClick:G=>{G.stopPropagation(),T(P)},className:"flex items-center gap-1 bg-red-500 text-white px-3 py-1 rounded-md text-sm hover:bg-red-600 transition",children:[a.jsx(_a,{})," Delete"]})]}),a.jsxs("p",{className:"text-gray-400 text-xs text-right",children:["Created by: ",P.createdBy," | ",P.date]})]})]});return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter min-h-screen",children:[a.jsx(Zx,{position:"top-center",reverseOrder:!1}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h2",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(ia,{className:"mr-2 text-black"})," Templates"]}),a.jsx("button",{onClick:()=>{s(!0),i(null),x({name:"",category:"",subject:"",body:""})},className:"flex items-center bg-black text-white px-4 py-2 rounded-md hover:bg-gray-800 transition text-sm sm:text-base shadow-sm",children:" New Template"})]}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search by template name...",value:c,onChange:P=>u(P.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsx("div",{className:"w-full lg:w-1/4",children:a.jsxs("select",{value:d,onChange:P=>h(P.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{children:"All Categories"}),a.jsx("option",{children:"Welcome"}),a.jsx("option",{children:"Follow-up"}),a.jsx("option",{children:"Newsletter"}),a.jsx("option",{children:"Promotional"})]})})]}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:F.map(P=>a.jsxs("div",{onClick:()=>M(P),className:"bg-white rounded-2xl shadow-lg border border-gray-100 hover:shadow-xl cursor-pointer flex flex-col justify-between h-80 transition",children:[a.jsx("div",{className:"h-2 w-full rounded-t-2xl bg-black"}),a.jsx("div",{className:"p-4 flex-grow",children:D(P)})]},P.id))}),(n||r)&&a.jsx("div",{onClick:y,className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-2xl rounded-xl shadow-lg p-5 sm:p-6 relative border border-gray-200 my-6 max-h-[90vh] overflow-y-auto",onClick:P=>P.stopPropagation(),children:[a.jsx("button",{onClick:y,className:"absolute top-3 right-3 text-gray-400 hover:text-black transition",children:a.jsx(ea,{size:20})}),a.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-gray-800 mb-4 text-center",children:r?"Edit Template":"Create New Template"}),a.jsxs("form",{onSubmit:P=>{P.preventDefault(),r?_():w()},className:"grid grid-cols-1 sm:grid-cols-2 gap-4 text-sm",children:[a.jsxs("div",{className:"flex flex-col",children:[a.jsxs("label",{className:"text-gray-700 font-medium mb-1",children:["Template Name ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",name:"name",value:p.name,onChange:N,placeholder:"e.g. Welcome Email",required:!0,className:"border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-black outline-none"})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsxs("label",{className:"text-gray-700 font-medium mb-1",children:["Category ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("select",{name:"category",value:p.category,onChange:N,required:!0,className:"border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-black outline-none",children:[a.jsx("option",{value:"",children:"Select Category"}),a.jsx("option",{value:"Welcome",children:"Welcome"}),a.jsx("option",{value:"Follow-up",children:"Follow-up"}),a.jsx("option",{value:"Newsletter",children:"Newsletter"}),a.jsx("option",{value:"Promotional",children:"Promotional"})]})]}),a.jsxs("div",{className:"flex flex-col sm:col-span-2",children:[a.jsxs("label",{className:"text-gray-700 font-medium mb-1",children:["Subject Line ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",name:"subject",value:p.subject,onChange:N,placeholder:"e.g. Welcome to our service!",required:!0,className:"border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-black outline-none"})]}),a.jsxs("div",{className:"flex flex-col sm:col-span-2",children:[a.jsxs("label",{className:"text-gray-700 font-medium mb-1",children:["Email Body ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("textarea",{name:"body",rows:4,value:p.body,onChange:N,placeholder:"Write your email message here...",required:!0,className:"border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-black outline-none resize-none"})]}),a.jsxs("div",{className:"flex justify-end gap-2 sm:col-span-2 pt-3 border-t border-gray-100 mt-2",children:[a.jsx("button",{type:"button",onClick:y,className:"px-4 py-2 text-gray-700 bg-gray-100 border border-gray-300 rounded-md hover:bg-gray-200 transition",children:"Cancel"}),a.jsx("button",{type:"submit",className:"px-4 py-2 bg-black text-white rounded-md hover:bg-gray-800 transition",children:r?"Update Template":"Create Template"})]})]})]})}),o&&!r&&a.jsx("div",{onClick:y,className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"rounded-2xl shadow-lg cursor-default h-80 w-full max-w-md overflow-hidden flex flex-col",onClick:P=>P.stopPropagation(),children:[a.jsx("div",{className:"h-2 w-full rounded-t-2xl bg-black"}),a.jsx("div",{className:"p-4 flex-grow overflow-y-auto bg-gray-50",children:D(o,!0)})]})}),b.show&&a.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 relative border border-gray-200",children:[a.jsx("button",{onClick:E,className:"absolute top-3 right-3 text-gray-400 hover:text-black transition",children:a.jsx(ea,{size:20})}),a.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-gray-800 mb-4 text-center",children:b.action==="delete"?"Confirm Delete":b.action==="edit"?"Confirm Update":b.action==="add"?"Confirm Add":"Confirm Use"}),a.jsx("p",{className:"text-center text-gray-600 mb-6",children:b.action==="delete"?a.jsxs(a.Fragment,{children:["Are you sure you want to delete the template"," ",a.jsx("span",{className:"font-semibold",children:b.template.name}),"?"]}):b.action==="edit"?a.jsxs(a.Fragment,{children:["Save changes to"," ",a.jsx("span",{className:"font-semibold",children:b.template.name}),"?"]}):b.action==="add"?a.jsxs(a.Fragment,{children:["Add new template"," ",a.jsx("span",{className:"font-semibold",children:b.template.name}),"?"]}):a.jsxs(a.Fragment,{children:["Use template"," ",a.jsx("span",{className:"font-semibold",children:b.template.name}),"?"]})}),a.jsxs("div",{className:"flex justify-center gap-4",children:[a.jsx("button",{onClick:E,className:"px-4 py-2 text-gray-700 bg-gray-100 border border-gray-300 rounded-md hover:bg-gray-200 transition",children:"Cancel"}),a.jsx("button",{onClick:A,className:"px-4 py-2 bg-black text-white rounded-md hover:bg-gray-800 transition",children:"Confirm"})]})]})})]})}const Tv=e=>{if(e==null||e==="")return 0;const t=Number(e);return Number.isFinite(t)?t:0},ff=(e,t="")=>{const n=Tv(e);return`${t}${n.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`},iH=e=>{if(!e)return"";const t=new Date(e);if(Number.isNaN(t.getTime()))return"";const n=t.getFullYear(),s=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0");return`${n}-${s}-${r}`},JGe=e=>{if(!e)return"";const t=new Date(e);return Number.isNaN(t.getTime())?"":t.toLocaleDateString(void 0,{year:"numeric",month:"long",day:"2-digit"})},eWe=e=>{if(!e)return"";const t=String(e).split("-");return t.length===3?`${t[0]}-${t[2]}`:String(e)},oH=(e,t,n)=>{const s=new Date,r=e?.contact?`${e.contact.first_name||""} ${e.contact.last_name||""}`.trim():"",i=e?.validity_days?String(e.validity_days):"";return{issuedDate:iH(e?.presented_date)||iH(s),subject:"Price Quotation",forName:e?.account?.name||"",attn:r,intro:"We are pleased to submit our proposal as follows:",notes:e?.notes||"",terms:{validity:i?`${i} days from the date of quotation.`:"",payment:"",deliveryPeriod:"",deliveryPoint:""},preparedBy:t?`${t.first_name||""} ${t.last_name||""}`.trim():"",approvedBy:n?.ceo_name||"Admin"}};function ev(){const e=Et(),t=ta(),{quoteId:n}=Wo(),{user:s}=Gt(),r=s?.company?.currency||"",i=f.useMemo(()=>`quote-print:${n||""}`,[n]),[o,l]=f.useState(()=>{const _=t.state?.quote;return _&&String(_.id)===String(n)?_:null}),[c,u]=f.useState(()=>t.state?.companyInfo||null),[d,h]=f.useState(!1),[p,x]=f.useState(()=>{try{const _=sessionStorage.getItem(i);return _?JSON.parse(_):null}catch{return null}});f.useEffect(()=>{if(!n)return;let _=!0;return(async()=>{try{h(!0);const A=!c?await ne.get("/company/invoice-info"):null;if(!_)return;if(A?.data&&u(A.data),!o){const E=await ne.get("/quotes/admin/fetch-all"),F=(Array.isArray(E?.data)?E.data:[]).find(D=>String(D.id)===String(n));F&&l(F)}}catch(k){const A=k?.response?.data?.detail||k?.message||"Failed to load quotation.";V.error(A)}finally{_&&h(!1)}})(),()=>{_=!1}},[n]),f.useEffect(()=>{o&&x(_=>{if(_)return _;try{const k=sessionStorage.getItem(i);if(k)return JSON.parse(k)}catch{}const T=oH(o,s,c);try{sessionStorage.setItem(i,JSON.stringify(T))}catch{}return T})},[o,s,c,i]);const b=_=>{x(_);try{sessionStorage.setItem(i,JSON.stringify(_))}catch{}},j=Array.isArray(o?.items)?o.items:[],y=Tv(o?.discount_amount),N=Tv(o?.tax_rate);if(!p)return a.jsx("div",{className:"p-6",children:a.jsx("div",{className:"text-gray-700",children:d?"Loading...":""})});const w=p.preparedBy||(s?`${s.first_name||""} ${s.last_name||""}`.trim():""),S=p.approvedBy||c?.ceo_name||"CEO";return a.jsxs("div",{className:"min-h-screen bg-gray-50 quote-print-root",children:[a.jsx("style",{children:`
        @page { size: A4; margin: 5mm; }
        @media print {
          html, body { margin: 0 !important; padding: 0 !important; }
          .no-print { display: none !important; }
          .print-surface { box-shadow: none !important; border: none !important; }
          body { background: white !important; }
          .quote-print-root { background: white !important; }

          /* Remove screen gutters/max-width so print is tight */
          .quote-print-page { max-width: none !important; margin: 0 !important; padding: 0 !important; }

          * { -webkit-print-color-adjust: exact; print-color-adjust: exact; }

          /* Keep the quote meta proportions while printing (left 2 cols + fixed quotation col) */
          .quote-meta-grid { grid-template-columns: 1fr 1fr 240px !important; padding: 0px; }
        }
      `}),a.jsx("div",{className:"no-print sticky top-0 z-10 bg-white border-b border-gray-200",children:a.jsxs("div",{className:"max-w-5xl mx-auto px-4 py-3 flex items-center justify-between gap-3",children:[a.jsx("button",{type:"button",className:"px-3 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-50 text-sm",onClick:()=>e(-1),children:"Back"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{type:"button",className:"px-3 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-50 text-sm",onClick:()=>{if(!o)return;const _=oH(o,s,c);b(_)},disabled:!o,children:"Reset fields"}),a.jsx("button",{type:"button",className:"px-4 py-2 rounded-md bg-blue-600 text-white hover:bg-blue-700 text-sm disabled:opacity-70",onClick:()=>window.print(),disabled:!o||d,children:"Print"})]})]})}),a.jsxs("div",{className:"max-w-5xl mx-auto px-4 py-6 quote-print-page",children:[a.jsx("div",{className:"no-print bg-white border border-gray-200 rounded-xl p-4 mb-4",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Date"}),a.jsx("input",{type:"date",className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm",value:p.issuedDate||"",onChange:_=>b({...p,issuedDate:_.target.value})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Subject"}),a.jsx("input",{type:"text",className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm",value:p.subject||"",onChange:_=>b({...p,subject:_.target.value})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"For"}),a.jsx("input",{type:"text",className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm",value:p.forName||"",onChange:_=>b({...p,forName:_.target.value})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Attn"}),a.jsx("input",{type:"text",className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm",value:p.attn||"",onChange:_=>b({...p,attn:_.target.value})})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Intro"}),a.jsx("textarea",{className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm min-h-[70px]",value:p.intro||"",onChange:_=>b({...p,intro:_.target.value})})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Notes"}),a.jsx("textarea",{className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm min-h-[70px]",value:p.notes||"",onChange:_=>b({...p,notes:_.target.value})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Terms: Validity"}),a.jsx("input",{type:"text",className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm",value:p.terms?.validity||"",onChange:_=>b({...p,terms:{...p.terms,validity:_.target.value}})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Terms: Payment"}),a.jsx("input",{type:"text",className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm",value:p.terms?.payment||"",onChange:_=>b({...p,terms:{...p.terms,payment:_.target.value}})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Terms: Delivery Period"}),a.jsx("input",{type:"text",className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm",value:p.terms?.deliveryPeriod||"",onChange:_=>b({...p,terms:{...p.terms,deliveryPeriod:_.target.value}})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Terms: Delivery Point"}),a.jsx("input",{type:"text",className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm",value:p.terms?.deliveryPoint||"",onChange:_=>b({...p,terms:{...p.terms,deliveryPoint:_.target.value}})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Approved by"}),a.jsx("input",{type:"text",className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm",value:p.approvedBy||"",onChange:_=>b({...p,approvedBy:_.target.value})})]})]})}),a.jsxs("div",{className:"print-surface bg-white border border-gray-200 rounded-xl shadow-sm p-6",children:[a.jsxs("div",{className:"flex items-center justify-between gap-4 border-b border-gray-300 pb-3",children:[a.jsxs("div",{className:"min-w-0 w-4/5",children:[a.jsx("div",{className:"text-xl font-bold text-gray-900 uppercase",children:c?.company_name||""}),c?.address?a.jsx("div",{className:"text-sm text-gray-700",children:c.address}):null,c?.company_number?a.jsx("div",{className:"text-sm text-gray-700",children:c.company_number}):null,c?.ceo_email?a.jsxs("div",{className:"text-sm text-gray-700",children:["Email: ",c.ceo_email]}):null,c?.company_website?a.jsxs("div",{className:"text-sm text-gray-700",children:["Web: ",c.company_website]}):null]}),a.jsx("div",{className:"flex items-start gap-3 w-1/6",children:c?.company_logo?a.jsx("img",{src:c.company_logo,alt:"Company logo",className:"w-full h-auto object-contain"}):null})]}),a.jsxs("div",{className:"mt-4",children:[a.jsxs("div",{className:"quote-meta-grid grid grid-cols-3 text-sm border border-gray-300",children:[a.jsxs("div",{className:"flex gap-2 p-2 border border-gray-300 col-span-2",children:[a.jsx("div",{className:"w-16 font-semibold",children:"For:"}),a.jsx("div",{className:"min-w-0 break-words",children:p.forName||""})]}),a.jsx("div",{className:"quote-meta-quote justify-center text-center p-1 border-b border-t border-r border-gray-300",children:a.jsx("div",{className:"text-xl font-bold text-gray-900",children:"QUOTATION"})}),a.jsxs("div",{className:"flex gap-2 p-2 border border-gray-300 col-span-2",children:[a.jsx("div",{className:"w-16 font-semibold",children:"Attn:"}),a.jsx("div",{className:"min-w-0 break-words",children:p.attn||""})]}),a.jsx("div",{className:"quote-meta-quote justify-center text-center p-2 border-t border-r border-gray-300",children:a.jsxs("div",{className:"text-sm text-gray-700",children:["No."," ",a.jsx("span",{className:"font-semibold",children:eWe(o?.quote_id||o?.id)})]})}),a.jsxs("div",{className:"flex gap-2 p-2 border border-gray-300 col-span-2",children:[a.jsx("div",{className:"w-16 font-semibold",children:"Subject:"}),a.jsx("div",{className:"min-w-0 break-words",children:p.subject||""})]}),a.jsx("div",{className:"quote-meta-quote md:justify-center border-r border-b border-gray-300 text-center p-2",children:a.jsx("div",{className:"text-sm text-gray-700",children:JGe(p.issuedDate)})})]}),a.jsx("div",{className:"mt-4 text-sm text-gray-900 whitespace-pre-wrap",children:p.intro||""})]}),a.jsx("div",{className:"mt-4 overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm border border-gray-400 border-collapse",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gray-100",children:[a.jsx("th",{className:"border border-gray-400 px-2 py-2 w-14",children:"Item"}),a.jsx("th",{className:"border border-gray-400 px-2 py-2 text-left",children:"Description"}),a.jsx("th",{className:"border border-gray-400 px-2 py-2 w-20",children:"Qty"}),a.jsx("th",{className:"border border-gray-400 px-2 py-2 w-20",children:"Unit"}),a.jsx("th",{className:"border border-gray-400 px-2 py-2 w-28",children:"Unit Price"}),a.jsx("th",{className:"border border-gray-400 px-2 py-2 w-28",children:"Total Cost"})]})}),a.jsx("tbody",{children:j.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:6,className:"border border-gray-400 px-2 py-4 text-center text-gray-600",children:"No line items."})}):j.map((_,T)=>{const k=_?.name?String(_.name).trim():"",A=_?.description?String(_.description).trim():"",E=_?.variant?String(_.variant).trim():"",M=_?.sku?String(_.sku).trim():"",F=E&&M?`${E} (${M})`:M?`(${M})`:E,P=[k,A,F].map(B=>B?String(B).trim():"").filter(Boolean).join(`
`);return a.jsxs("tr",{children:[a.jsx("td",{className:"border border-gray-400 px-2 py-2 text-center",children:T+1}),a.jsx("td",{className:"border border-gray-400 px-2 py-2 whitespace-pre-wrap",children:P}),a.jsx("td",{className:"border border-gray-400 px-2 py-2 text-center",children:Tv(_?.quantity)||""}),a.jsx("td",{className:"border border-gray-400 px-2 py-2 text-center",children:_?.unit||""}),a.jsx("td",{className:"border border-gray-400 px-2 py-2 text-right",children:ff(_?.unit_price,r)}),a.jsx("td",{className:"border border-gray-400 px-2 py-2 text-right",children:ff(_?.line_total,r)})]},_?.id??T)})})]})}),a.jsx("div",{className:"mt-4 flex justify-end",children:a.jsx("table",{className:"text-sm border border-gray-400 border-collapse min-w-[280px]",children:a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsx("td",{className:"border border-gray-400 px-3 py-2 font-semibold",children:"SUB TOTAL"}),a.jsx("td",{className:"border border-gray-400 px-3 py-2 text-right",children:ff(o?.subtotal,r)})]}),y>0?a.jsxs("tr",{children:[a.jsx("td",{className:"border border-gray-400 px-3 py-2 font-semibold",children:"Less: Discount"}),a.jsx("td",{className:"border border-gray-400 px-3 py-2 text-right",children:ff(o?.discount_amount,r)})]}):null,a.jsxs("tr",{children:[a.jsxs("td",{className:"border border-gray-400 px-3 py-2 font-semibold",children:["Tax ",N.toFixed(0),"%"]}),a.jsx("td",{className:"border border-gray-400 px-3 py-2 text-right",children:ff(o?.tax_amount,r)})]}),a.jsxs("tr",{children:[a.jsx("td",{className:"border border-gray-400 px-3 py-2 font-bold",children:"TOTAL"}),a.jsx("td",{className:"border border-gray-400 px-3 py-2 text-right font-bold",children:ff(o?.total_amount,r)})]})]})})}),a.jsxs("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-bold text-gray-900 mb-2",children:"TERMS & CONDITIONS:"}),a.jsxs("div",{className:"text-sm",children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsx("div",{className:"w-28 font-semibold",children:"Validity"}),a.jsxs("div",{className:"flex-1",children:[": ",p.terms?.validity||""]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("div",{className:"w-28 font-semibold",children:"Payment"}),a.jsxs("div",{className:"flex-1",children:[": ",p.terms?.payment||""]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("div",{className:"w-28 font-semibold",children:"Delivery Period"}),a.jsxs("div",{className:"flex-1",children:[": ",p.terms?.deliveryPeriod||""]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("div",{className:"w-28 font-semibold",children:"Delivery Point"}),a.jsxs("div",{className:"flex-1",children:[": ",p.terms?.deliveryPoint||""]})]})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-bold text-gray-900 mb-2",children:"NOTE:"}),a.jsx("div",{className:"text-sm whitespace-pre-wrap text-gray-900",children:p.notes||""})]})]}),a.jsxs("div",{className:"mt-10 grid grid-cols-2 gap-10 text-sm",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-gray-700",children:"Prepared by:"}),a.jsx("div",{className:"mt-8 border-b border-gray-400"}),a.jsx("div",{className:"mt-2 font-semibold",children:w})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-gray-700",children:"Approved by:"}),a.jsx("div",{className:"mt-8 border-b border-gray-400"}),a.jsx("div",{className:"mt-2 font-semibold",children:S})]})]}),a.jsx("div",{className:"mt-6 text-xs text-gray-500",children:"Generated from Sari-Sari CRM quotation."})]})]})]})}function tWe({toggleSidebar:e}){const[t,n]=f.useState(!1),[s,r]=f.useState(!1),[i,o]=f.useState([]),[l,c]=f.useState(0),u=f.useRef(null),d=f.useRef(null),h=ta(),p=Et(),{logout:x}=Ks(),{user:b,fetchUser:j}=Gt(),N={"/group-manager/dashboard":"Dashboard","/group-manager/accounts":"Accounts","/group-manager/contacts":"Contacts","/reports":"Reports","/leads":"Leads","/group-manager/Audit":"Audit","/group-manager/targets":"Targets","/group-manager/leads":"Leads","/group-manager/quotes":"Quotes","/group-manager/users":"Users","/group-manager/deals":"Deals"}[h.pathname]||"Group Manager Panel";return f.useEffect(()=>{j()},[]),f.useEffect(()=>{const w=()=>{j()};return window.addEventListener("userProfileUpdated",w),()=>{window.removeEventListener("userProfileUpdated",w)}},[j]),f.useEffect(()=>{if(!b?.id)return;const w=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1",S=window.location.protocol==="https:"?"wss:":"ws:",_=w?"localhost:8000":window.location.host,T=`${S}//${_}/ws/notifications?user_id=${b.id}`,k=new WebSocket(T);return k.onmessage=A=>{const E=JSON.parse(A.data);o(M=>[E,...M]),c(M=>M+1)},()=>k.close()},[b?.id]),f.useEffect(()=>{function w(S){u.current&&!u.current.contains(S.target)&&n(!1),d.current&&!d.current.contains(S.target)&&r(!1)}return document.addEventListener("mousedown",w),()=>document.removeEventListener("mousedown",w)},[]),a.jsxs("header",{className:"flex justify-between items-center bg-white shadow px-4 sm:px-6 py-3 border-b relative z-50",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("button",{onClick:e,className:"lg:hidden text-gray-700 hover:text-gray-900",children:a.jsx(rh,{className:"text-2xl"})}),a.jsx("h1",{className:"text-lg font-semibold text-gray-800",children:N})]}),a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs("div",{className:"relative",ref:d,children:[a.jsxs("button",{onClick:()=>r(!s),className:"relative text-gray-600 hover:text-gray-800 transition",children:[a.jsx(gx,{className:"text-xl"}),l>0&&a.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-[10px] w-4 h-4 flex items-center justify-center rounded-full font-semibold",children:l})]}),s&&a.jsxs("div",{className:"absolute right-0 mt-3 w-80 bg-white rounded-xl shadow-lg border z-50 overflow-hidden animate-in fade-in slide-in-from-top-2 duration-200",children:[a.jsxs("div",{className:"p-3 border-b bg-gray-50 flex justify-between items-center",children:[a.jsx("h3",{className:"font-semibold text-gray-800 text-sm",children:"Notifications"}),a.jsx("button",{onClick:()=>{o([]),c(0)},className:"text-xs text-blue-600 hover:underline",children:"Clear All"})]}),a.jsx("div",{className:"max-h-60 overflow-y-auto",children:i.length>0?i.map((w,S)=>a.jsx("div",{className:"p-3 border-b text-sm hover:bg-gray-50 cursor-pointer transition",children:w.title||w.message||"New Notification"},S)):a.jsx("div",{className:"p-4 text-center text-gray-500 text-xs",children:"No notifications"})})]})]}),a.jsxs("div",{className:"relative",ref:u,children:[a.jsxs("button",{onClick:()=>n(!t),className:"flex items-center gap-2 cursor-pointer hover:bg-gray-100 px-2 py-1 rounded transition",children:[a.jsx("img",{src:b?.profile_picture||"https://via.placeholder.com/40",alt:"Profile",className:"w-8 h-8 object-cover rounded-full border border-gray-200"}),a.jsxs("span",{className:"hidden lg:inline text-sm font-medium text-gray-700",children:[b?.first_name," ",b?.last_name]})]}),t&&a.jsxs("div",{className:"absolute right-0 mt-2 w-64 bg-white shadow-xl rounded-xl border border-gray-200 z-50 p-4 animate-in fade-in slide-in-from-top-2 duration-200",children:[a.jsxs("div",{className:"flex flex-col items-center text-center space-y-3",children:[a.jsx("img",{src:b?.profile_picture||"https://via.placeholder.com/80",alt:"Profile Large",className:"w-16 h-16 rounded-full object-cover border-2 border-gray-100"}),a.jsxs("div",{children:[a.jsxs("h2",{className:"text-gray-800 font-semibold text-sm",children:[b?.first_name," ",b?.middle_name," ",b?.last_name]}),a.jsx("p",{className:"text-[11px] text-gray-600 font-light w-full truncate",children:"Group Manager"})]})]}),a.jsxs("div",{className:"mt-6 space-y-1 px-2",children:[a.jsx("button",{onClick:()=>{p("/group-manager/users"),n(!1)},className:"block w-full text-sm text-gray-700 hover:bg-gray-50 p-2 rounded text-left transition",children:"Invite Your Team"}),a.jsx("button",{onClick:()=>{p("/group-manager/manage-account"),n(!1)},className:"block w-full text-sm text-gray-700 hover:bg-gray-50 p-2 rounded text-left transition",children:"Manage Your Account"}),a.jsx("div",{className:"border-t border-gray-100 my-2"}),a.jsx("button",{onClick:x,className:"block w-full text-sm text-red-600 hover:bg-red-50 p-2 rounded text-left transition font-medium",children:"Logout"})]})]})]})]})]})}function aWe(){const[e,t]=f.useState(!1),[n,s]=f.useState(!1),[r,i]=f.useState(!1),[o,l]=f.useState(!1),c=ta(),{user:u}=Gt();f.useEffect(()=>{u&&console.log("Fetched user:",u)},[u]),f.useEffect(()=>{console.log("Simulating user fetch... (no backend)")},[]),f.useEffect(()=>{document.title="Panel | Sari-Sari CRM"},[]);const d="flex items-center gap-3 px-3 py-2 rounded-lg bg-white text-[#1e293b] font-semibold shadow-sm",h="flex items-center gap-3 px-3 py-2 rounded-lg text-gray-300 hover:bg-[#334155] hover:text-white transition";return["/group-manager/accounts","/group-manager/contacts","/group-manager/leads","/group-manager/deals","/group-manager/quotes","/group-manager/targets","/group-manager/meetings"].includes(c.pathname),a.jsxs("div",{className:"flex h-screen bg-gray-100 overflow-hidden",children:[a.jsxs("div",{className:`fixed top-0 left-0 h-screen w-64 bg-[#1e293b] text-white flex flex-col shadow-lg transform transition-transform duration-300 z-50
          ${o?"translate-x-0":"-translate-x-full"} lg:translate-x-0`,children:[a.jsxs("div",{className:"px-4 py-3 bg-[#fbbf24] leading-none",children:[a.jsxs("p",{className:"text-gray-900 font-bold text-lg m-0 p-0",children:[" Sari-Sari.CRM"," ",a.jsx("span",{className:"text-[12px] text-gray-700 font-medium align-bottom",children:"v2"})]}),u&&u.company&&a.jsx("p",{className:"text-[12px] text-gray-600 font-medium w-full truncate",title:u.company.company_name,children:u.company.slug||u.company.company_name})]}),a.jsxs("nav",{className:"flex-1 overflow-y-auto p-4 space-y-2 hide-scrollbar",children:[a.jsxs($t,{to:"/group-manager/dashboard",className:({isActive:x})=>x?d:h,children:[a.jsx(sh,{className:"text-lg"}),a.jsx("span",{children:"Dashboard"})]}),a.jsxs("div",{children:[a.jsxs("button",{className:"w-full px-3 py-2 flex justify-between items-center text-sm font-medium text-gray-300 hover:bg-[#334155] rounded-lg transition",onClick:()=>t(!e),children:[a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx(sa,{className:"text-lg"}),"Sales"]}),a.jsx(Dt,{className:`transition-transform ${e?"rotate-180":""}`})]}),e&&a.jsxs("div",{className:"ml-6 mt-2 space-y-1",children:[a.jsxs($t,{to:"/group-manager/accounts",className:({isActive:x})=>x?d:h,children:[a.jsx(ac,{})," Accounts"]}),a.jsxs($t,{to:"/group-manager/contacts",className:({isActive:x})=>x?d:h,children:[a.jsx(ra,{})," Contacts"]}),a.jsxs($t,{to:"/group-manager/leads",className:({isActive:x})=>x?d:h,children:[a.jsx(rn,{})," Leads"]}),a.jsxs($t,{to:"/group-manager/deals",className:({isActive:x})=>x?d:h,children:[a.jsx(sa,{})," Deals"]}),a.jsxs($t,{to:"/group-manager/quotes",className:({isActive:x})=>x?d:h,children:[a.jsx(ia,{})," Quotes"]}),a.jsxs($t,{to:"/group-manager/targets",className:({isActive:x})=>x?d:h,children:[a.jsx(fr,{})," Targets"]})]})]}),a.jsxs("div",{children:[a.jsxs("button",{className:"w-full px-3 py-2 flex justify-between items-center text-sm font-medium text-gray-300 hover:bg-[#334155] rounded-lg transition",onClick:()=>s(!n),children:[a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx(Ls,{className:"text-lg"}),"Activity"]}),a.jsx(Dt,{className:`transition-transform ${n?"rotate-180":""}`})]}),n&&a.jsxs("div",{className:"ml-6 mt-2 space-y-1",children:[a.jsxs($t,{to:"/group-manager/calendar",className:({isActive:x})=>x?d:h,children:[a.jsx(Pt,{})," Calendar"]}),a.jsxs($t,{to:"/group-manager/tasks",className:({isActive:x})=>x?d:h,children:[a.jsx(Qt,{})," Tasks"]}),a.jsxs($t,{to:"/group-manager/meetings",className:({isActive:x})=>x?d:h,children:[a.jsx(Pt,{})," Meetings"]}),a.jsxs($t,{to:"/group-manager/calls",className:({isActive:x})=>x?d:h,children:[a.jsx(Us,{})," Calls"]}),a.jsxs($t,{to:"/group-manager/audit",className:({isActive:x})=>x?d:h,children:[a.jsx(Ls,{})," Audit"]})]})]}),a.jsx("div",{children:a.jsx($t,{to:"/group-manager/territory",className:({isActive:x})=>x?d:h,children:a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx(tc,{className:"text-lg"}),"Territory"]})})}),a.jsxs("div",{children:[a.jsxs("button",{className:"w-full px-3 py-2 flex justify-between items-center text-sm font-medium text-gray-300 hover:bg-[#334155] rounded-lg transition",onClick:()=>i(!r),children:[a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx(EL,{className:"text-lg"}),"Settings"]}),a.jsx(Dt,{className:`transition-transform ${r?"rotate-180":""}`})]}),r&&a.jsxs("div",{className:"ml-6 mt-2 space-y-1",children:[a.jsxs($t,{to:"/group-manager/users",className:({isActive:x})=>x?d:h,children:[a.jsx(Xa,{})," Users"]}),a.jsxs($t,{to:"/group-manager/manage-account",className:({isActive:x})=>x?d:h,children:[a.jsx(ra,{})," Your Profile"]})]})]})]}),a.jsxs("div",{className:"px-4 py-3 text-xs text-gray-400 border-t border-gray-700",children:[" ",new Date().getFullYear()," Sari-Sari CRM"]})]}),o&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 lg:hidden",onClick:()=>l(!1)}),a.jsxs("div",{className:"flex-1 flex flex-col lg:ml-64 overflow-hidden",children:[a.jsx(tWe,{toggleSidebar:()=>l(!o)}),a.jsx("main",{className:"flex-1 p-6 overflow-auto hide-scrollbar",style:{backgroundColor:"#fffeee"},children:a.jsx(th,{})})]})]})}const nWe=e=>a.jsx(Kt,{...e}),sWe=e=>a.jsx(ac,{...e}),Aee=e=>a.jsx(Vn,{...e}),rWe=e=>a.jsx(hx,{...e}),iWe=e=>a.jsx(bj,{...e}),oWe=e=>a.jsx(Pt,{...e}),lWe=e=>a.jsx(It,{...e}),cWe=e=>a.jsx(wj,{...e}),Tee=e=>a.jsx(vj,{...e}),dWe=e=>a.jsx(Xa,{...e}),kee=e=>a.jsx(ra,{...e}),uWe=e=>a.jsx(rn,{...e}),Eee=e=>a.jsx(sa,{...e}),mWe=e=>a.jsx(ia,{...e}),Lee=e=>a.jsx(fr,{...e}),fWe=e=>a.jsx(La,{...e}),hWe=e=>a.jsx(Pt,{...e}),gWe=e=>a.jsx(Us,{...e}),pWe=e=>a.jsx(tc,{...e}),xWe=e=>a.jsx(Ls,{...e}),Dee=(e,t="")=>{const n=parseFloat(e)||0;return new Intl.NumberFormat("en-US",{notation:"compact",compactDisplay:"short",maximumFractionDigits:1}).format(n).replace(/^/,`${t} `)},yWe=e=>{switch(e){case"Negotiation":return{text:"text-purple-700",bg:"bg-purple-100"};case"Proposal":return{text:"text-red-700",bg:"bg-red-100"};case"Qualification":return{text:"text-yellow-700",bg:"bg-yellow-100"};case"Prospecting":return{text:"text-blue-700",bg:"bg-blue-100"};case"Closed Won":return{text:"text-green-700",bg:"bg-green-100"};case"Closed Lost":return{text:"text-red-700",bg:"bg-red-100"};default:return{text:"text-gray-700",bg:"bg-gray-100"}}},bWe=e=>{switch(e){case"Website":return{text:"text-green-600",bg:"bg-green-100"};case"Referral":return{text:"text-purple-600",bg:"bg-purple-100"};case"Trade Show":return{text:"text-orange-600",bg:"bg-orange-100"};case"Cold Call":return{text:"text-red-600",bg:"bg-red-100"};default:return{text:"text-gray-600",bg:"bg-gray-100"}}},vWe=e=>{switch(e){case"call":return{Icon:lWe,color:"text-red-500",bgColor:"bg-red-100"};case"qualification":return{Icon:cWe,color:"text-green-600",bgColor:"bg-green-100"};default:return{Icon:oWe,color:"text-blue-500",bgColor:"bg-blue-100"}}},wWe=e=>{switch(e.toUpperCase()){case"HIGH":return{text:"text-red-700",bg:"bg-red-100"};case"LOW":return{text:"text-blue-700",bg:"bg-blue-100"};default:return{text:"text-gray-700",bg:"bg-gray-100"}}},jWe=({searchQuery:e,onSearchChange:t,searchResults:n,onSearchResultClick:s})=>{const r=Et(),[i,o]=f.useState(!1),l=f.useRef(null),c=[{icon:sWe,label:"Account"},{icon:kee,label:"Contact"},{icon:uWe,label:"Leads"},{icon:Eee,label:"Deals"},{icon:mWe,label:"Quotes"},{icon:Lee,label:"Target"},{icon:fWe,label:"Task"},{icon:hWe,label:"Meeting"},{icon:gWe,label:"Call"},{icon:xWe,label:"Audit"},{icon:pWe,label:"Territory"}];f.useEffect(()=>{const h=p=>{l.current&&!l.current.contains(p.target)&&o(!1)};return document.addEventListener("mousedown",h),()=>document.removeEventListener("mousedown",h)},[]);const u=h=>{t(h.target.value),o(h.target.value.trim().length>0)},d=h=>{s&&s(h),o(!1)};return a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-3 sm:p-4 flex flex-col items-start space-y-4 w-full",children:[a.jsxs("div",{className:"w-full flex justify-center relative",ref:l,children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg lg:mt-3 px-4 py-2 w-full max-w-md md:max-w-lg lg:max-w-2xl focus-within:ring-2 focus-within:ring-blue-500 transition duration-150",children:[a.jsx(nWe,{size:20,className:"text-gray-400 mr-3 flex-shrink-0"}),a.jsx("input",{type:"text",placeholder:"Search Leads, Deals, or Accounts...",className:"focus:outline-none text-base w-full",value:e,onChange:u,onFocus:()=>e.trim().length>0&&o(!0)})]}),i&&Array.isArray(n)&&n.length>0&&a.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 mt-2 w-full max-w-md md:max-w-lg lg:max-w-2xl bg-white rounded-lg shadow-xl border border-gray-200 z-50 max-h-96 overflow-y-auto",children:n.map((h,p)=>a.jsx("div",{className:"px-4 py-3 hover:bg-gray-50 cursor-pointer border-b border-gray-100 last:border-b-0 transition duration-150",onClick:()=>d(h),children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-semibold text-gray-800 text-sm",children:h.name}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:h.type}),h.details&&a.jsx("p",{className:"text-xs text-gray-400 mt-1",children:h.details})]}),a.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${h.type==="Lead"?"bg-blue-100 text-blue-600":h.type==="Deal"?"bg-yellow-100 text-yellow-600":"bg-green-100 text-green-600"}`,children:h.type})]})},p))}),i&&e.trim().length>0&&(!Array.isArray(n)||n.length===0)&&a.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 mt-2 w-full max-w-md md:max-w-lg lg:max-w-2xl bg-white rounded-lg shadow-xl border border-gray-200 z-50 p-4 text-center text-sm text-gray-500",children:"No results found"})]}),a.jsx("div",{className:"w-full overflow-x-auto lg:overflow-x-hidden scroll-smooth flex justify-center",children:a.jsx("div",{className:"flex flex-nowrap space-x-3 lg:space-x-4 xl:space-x-3 px-2 sm:px-0",children:c.map((h,p)=>a.jsxs("div",{className:"relative flex-shrink-0 group",children:[a.jsx("button",{className:"p-3 text-gray-500 hover:text-gray-900 transition duration-150 rounded-full hover:bg-gray-100 focus:outline-none cursor-pointer","aria-label":h.label,title:h.label,onClick:()=>{switch(h.label){case"Account":r("/group-manager/accounts");break;case"Contact":r("/group-manager/contacts");break;case"Leads":r("/group-manager/leads");break;case"Deals":r("/group-manager/deals");break;case"Quotes":r("/group-manager/quotes");break;case"Target":r("/group-manager/targets");break;case"Task":r("/group-manager/tasks");break;case"Meeting":r("/group-manager/meetings");break;case"Call":r("/group-manager/calls");break;case"Audit":r("/group-manager/audit");break;case"Territory":r("/group-manager/territory");break;default:console.log(`Clicked ${h.label}`)}},children:a.jsx(h.icon,{size:24,className:"lg:scale-95"})}),a.jsxs("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 px-3 py-1.5 bg-gray-900 text-white text-xs font-semibold rounded-md whitespace-nowrap opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-75 ease-in-out z-50 shadow-lg",children:[h.label,a.jsx("div",{className:"absolute top-full left-1/2 -translate-x-1/2 -mt-1 border-4 border-transparent border-t-gray-900"})]})]},p))})})]})},NWe=({action:e,description:t,entity_type:n,entity_name:s,timestamp:r})=>{const i=Et(),o=d=>{if(!d)return"Unknown";const h=new Date(d),x=new Date-h,b=Math.floor(x/6e4),j=Math.floor(x/36e5),y=Math.floor(x/864e5);return b<1?"Just now":b<60?`${b} min ago`:j<24?`${j} hour${j>1?"s":""} ago`:y<7?`${y} day${y>1?"s":""} ago`:h.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},l=e||t||"Action",c=s||n||"System",u=o(r);return a.jsxs("li",{className:"flex justify-between items-center py-2 border-b border-gray-100 last:border-b-0 cursor-pointer hover:bg-gray-50 transition duration-150 px-2 -mx-2 rounded-md",onClick:()=>i("/group-manager/audit"),children:[a.jsxs("p",{className:"text-sm text-gray-800 flex-grow font-medium",children:[l," ",a.jsxs("span",{className:"text-gray-500 italic text-xs",children:["(",c,")"]})]}),a.jsx("span",{className:"text-xs text-gray-400 flex-shrink-0 ml-4",children:u})]})},CWe=({logs:e,loading:t})=>{const n=Et();return a.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg border border-gray-100 flex flex-col h-full",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h2",{className:"text-md font-semibold text-gray-800",children:"Recent Logs"}),a.jsxs("span",{className:"text-sm text-blue-500 cursor-pointer hover:underline flex items-center space-x-1 font-medium",onClick:()=>n("/group-manager/audit"),children:[a.jsx("span",{children:"See All"}),a.jsx(Tee,{size:14,className:"transform -rotate-45"})]})]}),e&&e.length>0?a.jsx("ul",{className:"space-y-1",children:e.slice(0,3).map((s,r)=>a.jsx(NWe,{...s},r))}):a.jsx("div",{className:"text-sm text-gray-500 py-4",children:"No recent logs"})]})},SWe=({icon:e,title:t,value:n,color:s,bgColor:r,loading:i,onClick:o})=>a.jsxs("div",{className:"flex items-center p-4 bg-white rounded-xl shadow-md border border-gray-200 transition-all duration-300",onClick:o||(()=>console.log(`Clicked metric card: ${t}`)),children:[a.jsx("div",{className:`p-3 rounded-full ${r} ${s} mr-4`,children:a.jsx(e,{size:20})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-500 font-medium uppercase",children:t}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:n||0})]})]}),_We=({revenueData:e,loading:t})=>{const n=Et(),s=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],r=f.useMemo(()=>{if(console.log("=== RevenueChart calculateRevenueData ==="),console.log("revenueData:",e),console.log("revenueData length:",e?.length),!e||e.length===0){console.log("No revenue data, returning empty chart");const y=new Date;y.getFullYear();const N=y.getMonth(),w=[],S=[];for(let _=0;_<=N;_++)w.push(s[_]),S.push(0);return{labels:w,revenues:S,maxRevenue:0}}const l={};let c=0,u=0;console.log("Processing deals:",e.length),e.forEach((y,N)=>{const w=y.close_date||y.closeDate||null,S=w&&w!==null&&w!=="",_=y.stage||"",T=_.toUpperCase()==="CLOSED_WON"||_==="CLOSED_WON";let k=y.amount;k&&typeof k=="object"&&k.toString?k=parseFloat(k.toString()):k=parseFloat(k)||0;const A=k>0;if(T&&(u++,console.log(`Deal ${N+1} (CLOSED_WON):`,{id:y.id,name:y.name,stage:_,close_date:w,close_date_type:typeof w,amount:k,amount_type:typeof y.amount,hasCloseDate:S,hasAmount:A,willBeAdded:S&&A,allFields:Object.keys(y)})),S&&T&&A)try{let E=new Date(w);if(isNaN(E.getTime())){const M=String(w).split("T")[0];E=new Date(M+"T00:00:00")}if(isNaN(E.getTime()))console.warn(` Invalid date for deal ${y.id}:`,w,"Type:",typeof w);else{const M=E.getFullYear(),F=E.getMonth()+1,D=`${M}-${String(F).padStart(2,"0")}`;l[D]||(l[D]=0),l[D]+=k,c++,console.log(` Added deal ${y.id} to month ${D}: ${k}, total: ${l[D]}`),console.log(`  - Close date: ${w} -> Parsed: ${E.toISOString()} -> Month: ${D} (Year: ${M}, Month: ${F})`)}}catch(E){console.error("Error parsing deal date:",w,E)}else T&&console.warn(` Deal ${y.id} is CLOSED_WON but missing data:`,{hasCloseDate:S,hasAmount:A,closeDate:w,amount:k,originalAmount:y.amount})}),console.log("Summary:",{totalDeals:e.length,closedWonDeals:u,validDealsForGraph:c,monthlyRevenue:l});const d=Object.keys(l).map(y=>parseInt(y.split("-")[0])),h=d.length>0?[...new Set(d)].sort():[],p=new Date().getFullYear();new Date().getMonth();const x=[],b=[];for(let y=0;y<12;y++){const N=`${p}-${String(y+1).padStart(2,"0")}`;x.push(s[y]);const w=l[N]||0;b.push(w),w>0&&console.log(`Month ${s[y]} (${N}): ${w}`)}if(h.length>0){const y=Math.max(...h);if(y>p)for(let N=p+1;N<=y;N++)for(let w=0;w<12;w++){const S=`${N}-${String(w+1).padStart(2,"0")}`,_=l[S]||0;x.push(`${s[w]} ${N}`),b.push(_),_>0&&console.log(`Month ${s[w]} ${N} (${S}): ${_}`)}}const j=Math.max(...b,1);return console.log("Final chart data:",{labels:x,revenues:b,maxRevenue:j,hasData:b.some(y=>y>0)}),{labels:x,revenues:b,maxRevenue:j}},[e]),i=r.labels,o=r.revenues;return console.log("=== FINAL CHART DATA ==="),console.log("X Axis (Months):",i),console.log("Y Axis (Revenue):",o),console.log("Has any revenue > 0:",o.some(l=>l>0)),console.log("All revenue values:",o),console.log("Max revenue:",r.maxRevenue),a.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg h-full flex flex-col",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Revenue Overview"}),a.jsxs("span",{className:"text-sm text-blue-500 cursor-pointer hover:underline flex items-center space-x-1 font-medium",onClick:()=>n("/group-manager/deals"),children:[a.jsx("span",{children:"See All"}),a.jsx(Tee,{size:14,className:"transform -rotate-45"})]})]}),a.jsx("div",{className:"h-80 relative flex-1 flex items-center justify-center p-6",children:a.jsx("div",{className:"w-full h-full flex items-center justify-center",children:i&&i.length>0&&o&&o.length>0?a.jsx(mh,{xAxis:[{data:i,scaleType:"point"}],yAxis:[{valueFormatter:l=>l>=1e3?`${(l/1e3).toFixed(0)}k`:l.toString()}],series:[{data:o,showMark:!0,area:!0}],height:320,width:void 0,grid:{vertical:!0,horizontal:!0},margin:{top:40,right:40,bottom:50,left:50},sx:{width:"100%",maxWidth:"100%"}}):a.jsxs("div",{className:"text-center text-gray-500",children:[a.jsx("p",{className:"text-sm",children:"No revenue data available"}),a.jsx("p",{className:"text-xs mt-2",children:"Closed won deals with close dates will appear here"})]})})})]})},LT=({title:e,items:t,children:n,onSeeAll:s})=>{const r=Et(),i=()=>{if(s)s();else{const o={"Latest Leads":"/group-manager/leads","Latest Deals":"/group-manager/deals","Upcoming Activities":"/group-manager/tasks"};o[e]&&r(o[e])}};return a.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg flex flex-col",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:e}),a.jsx("span",{className:"text-sm text-blue-500 cursor-pointer hover:underline",onClick:i,children:"See All"})]}),n]})},AWe=({first_name:e,last_name:t,company_name:n,source:s,created_at:r,id:i})=>{const o=Et(),{text:l,bg:c}=bWe(s||"Website"),u=x=>{if(!x)return"Unknown";const b=new Date(x),y=new Date-b,N=Math.floor(y/6e4),w=Math.floor(y/36e5),S=Math.floor(y/864e5);return N<60?`${N} min ago`:w<24?b.toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}):S<7?b.toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}):b.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})},d=`${e||""} ${t||""}`.trim()||"Unknown",h=n||"Unknown Company",p=u(r);return a.jsx("div",{className:"py-3 border-b border-gray-100 last:border-b-0 cursor-pointer hover:bg-gray-50 transition duration-150 px-2 -mx-2 rounded-md",onClick:()=>i&&o(`/group-manager/leads/${i}`),children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-gray-800",children:d}),a.jsx("p",{className:"text-xs text-gray-500",children:h})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"text-xs text-gray-400",children:p}),a.jsx("span",{className:`inline-block mt-1 text-xs font-medium ${l} ${c} px-2 py-0.5 rounded-full`,children:s||"Website"})]})]})})},TWe=({name:e,amount:t,account:n,stage:s,created_at:r,id:i,previousAmount:o,currencySymbol:l})=>{const c=Et(),d={PROSPECTING:"Prospecting",QUALIFICATION:"Qualification",PROPOSAL:"Proposal",NEGOTIATION:"Negotiation",CLOSED_WON:"Closed Won",CLOSED_LOST:"Closed Lost"}[s]||s||"Unknown",{text:h,bg:p}=yWe(d),x=parseFloat(t||0),b=o?x>=o?"up":"down":"up",j=b==="up"?rWe:iWe,y=b==="up"?"text-green-400":"text-red-400",N=n?.name||"Unknown Company";return a.jsx("div",{className:"py-3 border-b border-gray-100 last:border-b-0 cursor-pointer hover:bg-gray-50 transition duration-150 px-2 -mx-2 rounded-md",onClick:()=>i&&c(`/group-manager/deals/info?id=${i}`),children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{className:"flex-shrink",children:[a.jsx("p",{className:"font-semibold text-sm text-gray-900",children:e||"Unnamed Deal"}),a.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:N}),a.jsx("span",{className:`inline-block mt-1 text-xs font-medium ${h} ${p} px-2 py-0.5 rounded-full`,children:d})]}),a.jsxs("div",{className:"text-right flex flex-col items-end flex-shrink-0",children:[a.jsx("p",{className:"text-md font-bold text-gray-800",children:Dee(x,l)}),a.jsx(j,{size:16,className:`${y} mt-1`})]})]})})},kWe=({type:e,title:t,assignedTo:n,dueDate:s,scheduledDate:r,priority:i,id:o,activityType:l,fullData:c})=>{const u=Et(),h=l||{Call:"call",Meeting:"meeting",Task:"qualification"}[e]||"meeting",{Icon:p,color:x,bgColor:b}=vWe(h),{text:j,bg:y}=wWe(i||"MEDIUM"),S=(k=>{if(!k)return"No date set";const A=new Date(k),M=A-new Date,F=Math.floor(M/864e5);return F===0?`Today, ${A.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}`:F===1?`Tomorrow, ${A.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}`:F===-1?`Yesterday, ${A.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}`:A.toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})})(s||r),_=n||"Unassigned",T=()=>{o&&(c?h==="call"?(sessionStorage.setItem("callDetailData",JSON.stringify(c)),u(`/group-manager/calls/info?id=${o}`)):h==="meeting"?(sessionStorage.setItem("meetingDetailData",JSON.stringify(c)),u(`/group-manager/meetings/info?id=${o}`)):u("/group-manager/tasks"):u(h==="call"?`/group-manager/calls/info?id=${o}`:h==="meeting"?`/group-manager/meetings/info?id=${o}`:"/group-manager/tasks"))};return a.jsxs("div",{className:"flex items-start py-3 border-b border-gray-100 last:border-b-0 cursor-pointer hover:bg-gray-50 transition duration-150 px-2 -mx-2 rounded-md",onClick:T,children:[a.jsx("div",{className:`p-2 rounded-lg ${b} mr-3 flex-shrink-0 mt-1`,children:a.jsx(p,{size:20,className:`${x}`})}),a.jsxs("div",{className:"flex-grow",children:[a.jsxs("p",{className:"font-medium text-gray-800 flex items-center mb-1",children:[a.jsx("span",{className:"text-xl leading-none mr-2",children:""}),t||"Untitled Activity"]}),a.jsxs("div",{className:"space-y-1 text-xs text-gray-500",children:[a.jsxs("p",{className:"flex items-center",children:[a.jsx(Aee,{size:14,className:"mr-1.5 text-gray-400"}),S]}),a.jsxs("p",{className:"flex items-center",children:[a.jsx(kee,{size:14,className:"mr-1.5 text-gray-400"}),"Assigned to: ",_]})]})]}),a.jsx("span",{className:`inline-block text-xs font-medium ${j} ${y} px-2 py-0.5 rounded-full flex-shrink-0 self-center ml-4`,children:(i||"MEDIUM").toUpperCase()})]})},EWe=()=>{const e=Et(),{user:t}=Gt(),n=t?.company?.currency||"",[s,r]=f.useState({activeLeads:0,totalDeals:0,activeAccounts:0,overdueTasks:0}),[i,o]=f.useState([]),[l,c]=f.useState([]),[u,d]=f.useState([]),[h,p]=f.useState([]),[x,b]=f.useState([]),[j,y]=f.useState([]),[N,w]=f.useState(!0),[S,_]=f.useState(null),[T,k]=f.useState(""),[A,E]=f.useState([]),[M,F]=f.useState([]),[D,P]=f.useState([]),[B,G]=f.useState([]),[$,W]=f.useState(0),[Z,Q]=f.useState(new Date),le=f.useRef(null),we=f.useRef(null),J=f.useMemo(()=>{try{if(!T.trim())return[];const ge=T.toLowerCase().trim(),be=[];return Array.isArray(A)&&A.forEach(me=>{const Ae=`${me.first_name||""} ${me.last_name||""}`.trim().toLowerCase(),pe=(me.company_name||"").toLowerCase(),Ie=(me.email||"").toLowerCase(),xe=(me.phone||"").toLowerCase();(Ae.includes(ge)||pe.includes(ge)||Ie.includes(ge)||xe.includes(ge))&&be.push({id:me.id,name:`${me.first_name||""} ${me.last_name||""}`.trim()||"Unnamed Lead",type:"Lead",details:me.company_name||"No company",route:`/group-manager/leads/${me.id}`})}),Array.isArray(M)&&M.forEach(me=>{const Ae=(me.name||"").toLowerCase(),pe=(me.account?.name||"").toLowerCase(),Ie=(me.description||"").toLowerCase();(Ae.includes(ge)||pe.includes(ge)||Ie.includes(ge))&&be.push({id:me.id,name:me.name||"Unnamed Deal",type:"Deal",details:me.account?.name||"No account",route:`/group-manager/deals/info?id=${me.id}`})}),Array.isArray(D)&&D.forEach(me=>{const Ae=(me.name||"").toLowerCase(),pe=(me.email||"").toLowerCase(),Ie=(me.phone||"").toLowerCase(),xe=(me.website||"").toLowerCase();(Ae.includes(ge)||pe.includes(ge)||Ie.includes(ge)||xe.includes(ge))&&be.push({id:me.id,name:me.name||"Unnamed Account",type:"Account",details:me.email||me.phone||"No contact info",route:"/group-manager/accounts"})}),be.slice(0,10)}catch(ge){return console.error("Error in search:",ge),[]}},[T,A,M,D]),se=ge=>{ge.route&&(e(ge.route),k(""))},ye=f.useCallback(async()=>{w(!0),_(null);try{const[ge,be,me,Ae,pe,Ie,xe,he]=await Promise.all([ne.get("/leads/admin/getLeads").catch(re=>(console.error("Error fetching leads:",re),{data:[]})),ne.get("/deals/admin/fetch-all").catch(re=>(console.error("Error fetching deals:",re),{data:[]})),ne.get("/accounts/admin/fetch-all").catch(re=>(console.error("Error fetching accounts:",re),{data:[]})),ne.get("/tasks/all").catch(re=>(console.error("Error fetching tasks:",re),{data:[]})),ne.get("/meetings/admin/fetch-all").catch(re=>(console.error("Error fetching meetings:",re),{data:[]})),ne.get("/calls/admin/fetch-all").catch(re=>(console.error("Error fetching calls:",re),{data:[]})),ne.get("/logs/read-all").catch(re=>(console.error("Error fetching logs:",re),{data:[]})),ne.get("/targets/admin/fetch-all").catch(re=>(console.error("Error fetching targets:",re),{data:[]}))]),Re=Array.isArray(ge.data)?ge.data:[],Ee=Array.isArray(be.data)?be.data:[],He=Array.isArray(me.data)?me.data:[],Ke=Array.isArray(Ae.data)?Ae.data:[],st=Array.isArray(pe.data)?pe.data:[],it=Array.isArray(Ie.data)?Ie.data:[],ot=Array.isArray(xe.data)?xe.data:[],rt=Array.isArray(he.data)?he.data:[];console.log("=== RAW DEALS API RESPONSE ==="),console.log("Deals count:",Ee.length),Ee.length>0&&(console.log("First deal sample (raw):",JSON.stringify(Ee[0],null,2)),console.log("First deal keys:",Object.keys(Ee[0]))),E(Re),F(Ee),P(He),G(rt);const at=rt.reduce((re,Le)=>{const De=Le.amount||Le.value||Le.target_amount||0,Qe=parseFloat(typeof De=="string"?De.replace(/[^\d.-]/g,""):De);return re+(Number.isFinite(Qe)?Qe:0)},0);W(at);const Je=Re.filter(re=>re.status&&!["Lost","Converted"].includes(re.status)).length,Fe=Ke.filter(re=>!re.dueDate||re.status==="Completed"?!1:new Date(re.dueDate)<new Date).length;r({activeLeads:Je,totalDeals:Ee.length,activeAccounts:He.length,overdueTasks:Fe});const Ue=[...Re].sort((re,Le)=>new Date(Le.created_at||0)-new Date(re.created_at||0)).slice(0,5);o(Ue);const Ne=[...Ee].sort((re,Le)=>new Date(Le.created_at||0)-new Date(re.created_at||0)).slice(0,5);c(Ne);const ze=new Date,je=[];it.forEach(re=>{const Le=re.due_date||re.call_time,De=(re.status||"").toUpperCase();if(Le){const Qe=new Date(Le);De==="COMPLETED"||De==="MISSED"||De==="NOT_HELD"||De==="HELD"||je.push({type:"Call",title:re.subject||"Untitled Call",assignedTo:re.assigned_to||(re.call_assign_to?`${re.call_assign_to.first_name||""} ${re.call_assign_to.last_name||""}`.trim():"Unassigned"),scheduledDate:Le,priority:(re.priority||"MEDIUM").toUpperCase(),id:re.id,activityType:"call",fullData:re})}}),st.forEach(re=>{const Le=re.dueDate||re.start_time,De=(re.status||"").toUpperCase();if(Le){const Qe=new Date(Le);De==="COMPLETED"||De==="CANCELLED"||De==="DONE"||je.push({type:"Meeting",title:re.subject||re.activity||"Untitled Meeting",assignedTo:re.assignedTo||(re.meet_assign_to?`${re.meet_assign_to.first_name||""} ${re.meet_assign_to.last_name||""}`.trim():"Unassigned"),scheduledDate:Le,priority:(re.priority||"MEDIUM").toUpperCase(),id:re.id,activityType:"meeting",fullData:re})}});const ve={HIGH:1,MEDIUM:2,LOW:3},z=je.sort((re,Le)=>{const De=ve[re.priority]||3,Qe=ve[Le.priority]||3;if(De!==Qe)return De-Qe;const tt=new Date(re.scheduledDate||0),Me=new Date(Le.scheduledDate||0);return tt-Me}).slice(0,5);d(z),p(Ee),console.log("=== ALL DEALS DATA ==="),console.log("Total deals:",Ee.length);const K=Ee.filter(re=>(re.stage||"").toUpperCase()==="CLOSED_WON");console.log("CLOSED_WON deals:",K.length),K.length>0?(console.log("=== CLOSED_WON DEALS DETAILS ==="),K.forEach((re,Le)=>{let De=re.amount;De&&typeof De=="object"?De.toString?De=parseFloat(De.toString()):De=parseFloat(De):De=parseFloat(De)||0,console.log(`Deal ${Le+1}:`,{id:re.id,name:re.name,stage:re.stage,stage_upper:(re.stage||"").toUpperCase(),amount:re.amount,amount_parsed:De,amount_type:typeof re.amount,close_date:re.close_date,close_date_type:typeof re.close_date,close_date_value:re.close_date?new Date(re.close_date):null,has_close_date:!!re.close_date,has_amount:De>0,all_keys:Object.keys(re),full_deal:re})})):(console.log(" No CLOSED_WON deals found!"),console.log("All deal stages:",Ee.map(re=>re.stage))),y(Ee);const ue=[...ot].sort((re,Le)=>new Date(Le.timestamp||0)-new Date(re.timestamp||0));b(ue)}catch(ge){console.error("Error fetching dashboard data:",ge),_("Failed to load dashboard data. Please refresh the page.")}finally{w(!1)}},[]);f.useEffect(()=>(document.title="Dashboard | Sari-Sari CRM",console.log("TManagerDashboard mounted, fetching data..."),ye(),le.current=setInterval(()=>{console.log("Auto-refreshing dashboard data..."),ye(),Q(new Date)},3e4),()=>{le.current&&clearInterval(le.current)}),[ye]),f.useEffect(()=>{if(!t||!t.id)return;let ge=0;const be=3;let me=null;const Ae=()=>{const pe=window.location.protocol==="https:"?"wss:":"ws:",Ie=window.location.hostname==="localhost"?"localhost:8000":window.location.host,xe=`${pe}//${Ie}/ws/notifications?user_id=${t.id}`;try{const he=new WebSocket(xe);we.current=he,he.onopen=()=>{console.log(" WebSocket connected for dashboard updates"),ge=0},he.onmessage=Re=>{try{const Ee=JSON.parse(Re.data);console.log(" Real-time notification received:",Ee),Ee.event&&["new_task","task_updated","new_lead","lead_updated","new_deal","deal_updated","new_account","account_updated","new_meeting","meeting_updated","new_call","call_updated"].includes(Ee.event)&&(console.log(" Refreshing dashboard due to:",Ee.event),ye(),Q(new Date))}catch(Ee){console.error("Error parsing WebSocket message:",Ee)}},he.onerror=Re=>{ge===0&&console.warn(" WebSocket connection unavailable (this is optional)")},he.onclose=()=>{ge<be&&(ge++,me=setTimeout(()=>{t&&t.id&&Ae()},5e3))}}catch{console.warn(" WebSocket not available (optional feature)")}};return Ae(),()=>{me&&clearTimeout(me),we.current&&(we.current.close(),we.current=null)}},[t,ye]);const Ce=[{icon:dWe,title:"Active Leads",value:s.activeLeads,color:"text-blue-600",bgColor:"bg-blue-50",onClick:()=>e("/group-manager/leads")},{icon:Lee,title:"Total Targets",value:Dee($,n),color:"text-purple-600",bgColor:"bg-purple-50",onClick:()=>e("/group-manager/targets")},{icon:Eee,title:"Total Deals",value:s.totalDeals,color:"text-yellow-600",bgColor:"bg-yellow-50",onClick:()=>e("/group-manager/deals")},{icon:Aee,title:"Overdue Tasks",value:s.overdueTasks,color:"text-red-600",bgColor:"bg-red-50",onClick:()=>e("/group-manager/tasks")}];return console.log("TManagerDashboard rendering, loading:",N,"error:",S),a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative w-full",children:[N&&a.jsx(qt,{}),a.jsxs("div",{className:"max-w-screen-2xl mx-auto",children:[S&&a.jsx("div",{className:"mb-6 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:a.jsx("p",{className:"font-medium",children:S})}),a.jsx("div",{className:"mb-8",children:a.jsx(jWe,{searchQuery:T,onSearchChange:k,searchResults:J,onSearchResultClick:se})}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-4 mb-8",children:Ce.map(ge=>a.jsx(SWe,{...ge,loading:N},ge.title))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[a.jsx(CWe,{logs:x,loading:N}),a.jsx(wD,{currencySymbol:n})]}),a.jsx("div",{className:"mb-8",children:a.jsx(IN,{leads:A,deals:M,targets:B,currencySymbol:n,basePath:"/group-manager"})}),a.jsx("div",{className:"grid grid-cols-1 mb-8",children:a.jsx(_We,{revenueData:j,loading:N})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[a.jsx(LT,{title:"Latest Leads",children:i.length>0?i.map((ge,be)=>a.jsx(AWe,{...ge},ge.id||be)):a.jsx("div",{className:"text-sm text-gray-500 py-4 text-center",children:"No leads found"})}),a.jsx(LT,{title:"Latest Deals",children:N?a.jsxs("div",{className:"flex flex-col items-center justify-center py-8",children:[a.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-500 mb-2"}),a.jsx("div",{className:"text-sm text-gray-500",children:"Loading deals..."})]}):l.length>0?l.map((ge,be)=>a.jsx(TWe,{...ge,currencySymbol:n},ge.id||be)):a.jsx("div",{className:"text-sm text-gray-500 py-4 text-center",children:"No deals found"})}),a.jsx(LT,{title:"Upcoming Activities",children:u.length>0?u.map((ge,be)=>a.jsx(kWe,{...ge},ge.id||be)):a.jsx("div",{className:"text-sm text-gray-500 py-4 text-center",children:"No upcoming activities"})})]})]})]})},DT=[{value:"CUSTOMER",label:"Customer"},{value:"PROSPECT",label:"Prospect"},{value:"PARTNER",label:"Partner"},{value:"ACTIVE",label:"Vendor"},{value:"INACTIVE",label:"Inactive"},{value:"FORMER",label:"Delete"}],tv={name:"",website:"",phone_number:"",billing_address:"",shipping_address:"",industry:"",parent_company:"",status:"PROSPECT",territory_id:"",assigned_to:""},dr=e=>e?e.toUpperCase():"",PT=e=>e?e.toString().toLowerCase().replace(/\b\w/g,t=>t.toUpperCase()):"--",LWe=e=>{switch(dr(e)){case"CUSTOMER":return"bg-green-600 text-white";case"PROSPECT":return"bg-purple-600 text-white";case"PARTNER":return"bg-pink-600 text-white";case"ACTIVE":return"bg-blue-600 text-white";case"INACTIVE":return"bg-gray-600 text-white";case"FORMER":return"bg-orange-600 text-white";default:return"bg-gray-500 text-white"}},DWe=e=>{switch(dr(e)){case"CUSTOMER":return"bg-green-100 text-green-700";case"PROSPECT":return"bg-purple-100 text-purple-700";case"PARTNER":return"bg-pink-100 text-pink-700";case"ACTIVE":return"bg-blue-100 text-blue-700";case"INACTIVE":return"bg-gray-200 text-gray-700";case"FORMER":return"bg-orange-100 text-orange-700";default:return"bg-gray-100 text-gray-700"}};function PWe(){const e=Et(),t=ta(),{user:n}=Gt();f.useEffect(()=>{document.title="Accounts | Sari-Sari CRM"},[]);const[s,r]=f.useState(!1),[i,o]=f.useState(!1),[l,c]=f.useState(!1),[u,d]=f.useState(null),[h,p]=f.useState(null),[x,b]=f.useState(tv),[j,y]=f.useState(null),[N,w]=f.useState([]),[S,_]=f.useState(!1),[T,k]=f.useState([]),[A,E]=f.useState(null),[M,F]=f.useState([]),[D,P]=f.useState([]),[B,G]=f.useState("Filter by Status"),[$,W]=f.useState(""),[Z,Q]=f.useState(null),[le,we]=f.useState(!1),[J,se]=f.useState(1),[ye,Ce]=f.useState(10),[ge,be]=f.useState("Overview"),[me,Ae]=f.useState(""),[pe,Ie]=f.useState(!1),[xe,he]=f.useState({}),[Re,Ee]=f.useState(null),[He,Ke]=f.useState(new Set),[st,it]=f.useState(!1),{comments:ot,addComment:rt,refresh:at}=kn({relatedType:"account",relatedId:j?.id});f.useEffect(()=>{j?.id&&at()},[j?.id,at]);const Je=f.useCallback(async(L=null)=>{_(!0);try{const ee=await ne.get("/accounts/admin/fetch-all"),$e=[...Array.isArray(ee.data)?ee.data:[]].sort((We,mt)=>{const Tt=We?.created_at||We?.updated_at||0,kt=mt?.created_at||mt?.updated_at||0;return new Date(kt)-new Date(Tt)});if(w($e),L){const We=$e.find(mt=>mt.id===L);y(We||null)}}catch(ee){console.error(ee),w([]),ee.response?.status===403?V.error("Permission denied. Only CEO, Admin, or Group Manager can access this page."):V.error("Failed to fetch accounts. Please try again later.")}finally{_(!1)}},[y]),Fe=f.useCallback(async()=>{try{const L=await ne.get("/users/all");k(Array.isArray(L.data)?L.data:[])}catch(L){console.error(L),L.response?.status===403&&V.warn("Unable to load users for assignment (permission denied).")}},[]),Ue=f.useCallback(async()=>{try{const L=await ne.get("/territories/fetch");F(Array.isArray(L.data)?L.data:[])}catch(L){console.error(L),L.response?.status===403&&V.warn("Unable to load territories (permission denied).")}},[]),Ne=f.useCallback(async()=>{try{const L=await ne.get("/accounts/admin/parent-companies");P(Array.isArray(L.data)?L.data:[])}catch(L){console.error(L),L.response?.status===403&&V.warn("Unable to load parent companies (permission denied).")}},[]),ze=f.useCallback(async L=>{try{const ee=await ne.get(`/activities/accounts/${L}`);he(ee.data&&typeof ee.data=="object"?ee.data:{})}catch(ee){console.error(ee),ee.response?.status===404&&(console.warn("No activities found for this account."),he({}))}},[]);f.useEffect(()=>{Je(),Fe(),Ue(),Ne()},[Je,Fe,Ue,Ne]),f.useEffect(()=>{j&&Ae(dr(j.status)||"PROSPECT")},[j]);const je=N.length,ve=f.useMemo(()=>N.filter(L=>L.status?.toLowerCase()==="customer").length,[N]),z=f.useMemo(()=>N.filter(L=>L.status?.toLowerCase()==="prospect").length,[N]),K=f.useMemo(()=>N.filter(L=>L.status?.toLowerCase()==="partner").length,[N]),ue=f.useMemo(()=>N.filter(L=>L.status?.toLowerCase()==="active").length,[N]),re=f.useMemo(()=>N.filter(L=>L.status?.toLowerCase()==="inactive").length,[N]),Le=f.useMemo(()=>N.filter(L=>L.status?.toLowerCase()==="former").length,[N]),De=f.useMemo(()=>[{title:"Total",value:je,icon:Xa,color:"text-slate-600",bgColor:"bg-slate-100"},{title:"Customers",value:ve,icon:Qi,color:"text-green-600",bgColor:"bg-green-100"},{title:"Prospects",value:z,icon:rn,color:"text-purple-600",bgColor:"bg-purple-100"},{title:"Partners",value:K,icon:ra,color:"text-pink-600",bgColor:"bg-pink-100"},{title:"Active",value:ue,icon:Qi,color:"text-blue-600",bgColor:"bg-blue-100"},{title:"Inactive",value:re,icon:Ki,color:"text-gray-600",bgColor:"bg-gray-100"},{title:"Former",value:Le,icon:Ki,color:"text-orange-600",bgColor:"bg-orange-100"}],[je,ve,z,K,ue,re,Le]),Qe=f.useMemo(()=>{const L=$.trim().toLowerCase(),ee=B.trim().toUpperCase();return N.filter(ke=>{const $e=[ke?.name,ke?.website,ke?.industry,ke?.territory?.name,ke?.phone_number],We=L===""||$e.some(Qr=>Qr==null?!1:Qr.toString().toLowerCase().includes(L)),mt=ee==="FILTER BY STATUS"||dr(ke.status)===ee;let Tt=!0;const kt=n?.role?.toUpperCase();if(kt!=="GROUP MANAGER"&&kt!=="CEO"&&kt!=="ADMIN"){const Qr=ke?.assigned_to?.id===n?.id||ke?.assigned_to===n?.id,S0=ke?.acc_creator?.id===n?.id;Tt=Qr||S0}const En=dr(ke.status)==="INACTIVE"&&ee!=="INACTIVE";return We&&mt&&Tt&&!En})},[N,$,B,n?.id]),tt=Math.max(1,Math.ceil(Qe.length/ye)||1);f.useEffect(()=>{se(1)},[$,B,ye]),f.useEffect(()=>{se(L=>{const ee=Math.max(1,Math.ceil(Qe.length/ye)||1);return L>ee?ee:L})},[Qe.length,ye]);const Me=f.useMemo(()=>{const L=(J-1)*ye;return Qe.slice(L,L+ye)},[Qe,J,ye]);Qe.length===0||(J-1)*ye+1,Math.min(J*ye,Qe.length);const et=()=>se(L=>Math.max(L-1,1)),yt=()=>se(L=>Math.min(L+1,tt)),_t=L=>{y(L),be("Overview"),Ae(dr(L?.status)||"PROSPECT")},Ct=()=>y(null),jt=L=>{L.target.id==="accountModalBackdrop"&&!le&&Ct()},At=()=>{r(!1),o(!1),p(null),b(tv),c(!1),E(null)},Ge=L=>{L.target.id==="modalBackdrop"&&At()},Be=L=>L?new Date(L).toLocaleString("en-US",{month:"short",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).replace(",",""):"",ce=L=>{const{name:ee,value:ke}=L.target;b($e=>({...$e,[ee]:ke}))},fe=()=>{b(tv),o(!1),p(null),r(!0)};f.useEffect(()=>{const L=new URLSearchParams(t.search||"");(t.state?.openAccountModal||L.get("openModal")==="1")&&(b(tv),o(!1),p(null),r(!0),X(!1),e(t.pathname,{replace:!0,state:{}}))},[t.state,t.pathname,t.search,e]);const H=L=>{y(null),L.assigned_accs?E(L.assigned_accs):E(null),b({name:L.name||"",website:L.website||"",phone_number:L.phone_number||"",billing_address:L.billing_address||"",shipping_address:L.shipping_address||"",parent_company:L.parent_company||"",industry:L.industry||"",status:dr(L.status)||"PROSPECT",territory_id:L.territory?.id?String(L.territory.id):"",assigned_to:L.assigned_accs?.id?String(L.assigned_accs.id):""}),o(!0),p(L.id),r(!0)},te=L=>{L&&Q({title:"Archive Account",message:a.jsxs("span",{children:["Are you sure you want to archive the account"," ",a.jsx("span",{className:"font-semibold",children:L.name}),"? You can restore it later if needed."]}),confirmLabel:"Archive Account",cancelLabel:"Cancel",variant:"archive",action:{type:"archive",targetId:L.id,name:L.name}})},q=L=>{const ee=Me.find(ke=>ke.id===L);ee&&ee.acc_creator?.id===n?.id&&Ke(ke=>{const $e=new Set(ke);return $e.has(L)?$e.delete(L):$e.add(L),$e})},Y=()=>{const L=Me.filter(ee=>ee.acc_creator?.id===n?.id);He.size===L.length&&L.length>0?Ke(new Set):Ke(new Set(L.map(ee=>ee.id)))},U=()=>{if(He.size===0)return;const L=He.size;Q({title:"Archive Accounts",message:a.jsxs("span",{children:["Are you sure you want to archive"," ",a.jsx("span",{className:"font-semibold",children:L})," account",L!==1?"s":"","? You can restore them later if needed."]}),confirmLabel:`Archive ${L} Account${L!==1?"s":""}`,cancelLabel:"Cancel",variant:"archive",action:{type:"bulk-archive",targetIds:Array.from(He),count:L}})},de=async()=>{if(!Z?.action){Q(null);return}const{action:L}=Z,{type:ee,payload:ke,targetId:$e,name:We,targetIds:mt,count:Tt}=L;we(!0);try{if(ee==="create"){c(!0);const kt=await ne.post("/accounts/admin",ke);Ne(),V.success(`Account "${We}" created successfully.`);const Yt=j?.id||null;At(),await Je(Yt),!j&&kt.data?.id}else if(ee==="update"){if(!$e)throw new Error("Missing account identifier for update.");c(!0),await ne.put(`/accounts/admin/${$e}`,ke),V.success(`Account "${We}" updated successfully.`);const kt=j?.id&&j.id===$e?$e:null;At(),await Je(kt),j?.id===$e&&y(null)}else if(ee==="archive"){if(!$e)throw new Error("Missing account identifier for archiving.");const kt=j?.id;d($e),await ne.put(`/accounts/admin/${$e}`,{status:"INACTIVE"}),V.success(`Account "${We}" archived successfully.`),await Je(kt&&kt!==$e?kt:null),kt===$e&&y(null)}else if(ee==="bulk-archive"){if(!mt||mt.length===0)throw new Error("Missing account identifiers for bulk archiving.");it(!0),await Promise.all(mt.map(kt=>ne.put(`/accounts/admin/${kt}`,{status:"INACTIVE"}))),V.success(`${Tt} account${Tt!==1?"s":""} archived successfully.`),Ke(new Set),await Je(),y(null)}}catch(kt){console.error(kt);const Yt=ee==="create"?"Failed to create account. Please review the details and try again.":ee==="update"?"Failed to update account. Please review the details and try again.":ee==="bulk-archive"?"Failed to archive accounts. Please try again.":"Failed to archive account. Please try again.",En=kt.response?.data?.detail||Yt;V.error(En),(ee==="create"||ee==="update")&&c(!1),ee==="archive"&&d(null),ee==="bulk-archive"&&it(!1)}finally{(ee==="create"||ee==="update")&&c(!1),ee==="archive"&&d(null),ee==="bulk-archive"&&it(!1),we(!1),Q(null)}},Te=()=>{le||Q(null)},ie=async()=>{if(!j||!me)return;const L=dr(me),ee=dr(j.status);if(L!==ee){Ie(!0);try{await ne.put(`/accounts/admin/${j.id}`,{status:L}),V.success(`Account status updated to ${PT(L)}`),w(ke=>ke.map($e=>$e.id===j.id?{...$e,status:L}:$e)),y(null)}catch(ke){console.error(ke);const $e=ke.response?.data?.detail||"Failed to update account status. Please try again.";V.error($e)}finally{Ie(!1)}}},[Oe,X]=f.useState(!1),oe=L=>{L.preventDefault(),X(!0);const ee=x.name.trim();if(!ee){V.error("Account name is required.");return}if(!x.assigned_to){V.error("Assigned To is required.");return}const $e={name:ee,website:x.website?.trim()||null,phone_number:x.phone_number?.trim()||null,billing_address:x.billing_address?.trim()||null,shipping_address:x.shipping_address?.trim()||null,industry:x.industry?.trim()||null,parent_company:x.parent_company?.trim()||null,status:x.status||"PROSPECT",territory_id:x.territory_id?Number(x.territory_id):null,assigned_to:x.assigned_to?Number(x.assigned_to):null},We=i&&h?"update":"create";Q({title:We==="create"?"Confirm New Account":"Confirm Update",message:We==="create"?a.jsxs("span",{children:["Are you sure you want to create the account"," ",a.jsx("span",{className:"font-semibold",children:ee}),"?"]}):a.jsxs("span",{children:["Save changes to the account"," ",a.jsx("span",{className:"font-semibold",children:ee}),"?"]}),confirmLabel:We==="create"?"Create Account":"Update Account",cancelLabel:"Cancel",variant:"primary",action:{type:We,payload:$e,targetId:h||null,name:ee}})},Pe=[{label:"Filter by Status",value:"Filter by Status"},...DT.map(L=>({label:L.label,value:L.value}))],Ve=Z?.action?.type==="delete"?Z.action.targetId:null,ft=j&&(u===j.id||Ve===j.id),St=j&&u===j.id,Ht=j?LWe(j.status):"",da=j?a.jsx("div",{id:"accountModalBackdrop",onClick:jt,className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-6xl max-h-[92vh] overflow-y-auto hide-scrollbar animate-scale-in font-inter relative",onClick:L=>L.stopPropagation(),children:[a.jsxs("div",{className:"bg-tertiary w-full rounded-t-xl flex items-center justify-between p-3 lg:p-3",children:[a.jsx("h1",{className:"lg:text-3xl text-xl text-white font-semibold text-center w-full",children:"Account"}),a.jsx("button",{onClick:Ct,className:"text-gray-400 hover:text-white cursor-pointer",children:a.jsx(Za,{size:25})})]}),a.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between lg:flex-row lg:items-center lg:justify-between mt-3 gap-2 px-2 md:items-center lg:gap-4 md:mx-7 lg:mx-7",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[a.jsx("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-800",children:j.name}),a.jsx("span",{className:`text-xs sm:text-sm font-medium px-2 sm:px-3 py-1 rounded-full whitespace-nowrap ${Ht}`,children:PT(j.status)})]}),n?.id===j?.acc_creator?.id&&a.jsxs("div",{className:"flex flex-col sm:flex-row sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsxs("button",{className:"inline-flex items-center justify-center w-full sm:w-auto bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 disabled:opacity-70 transition text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",onClick:()=>H(j),disabled:Z?.action?.type==="update"&&Z.action.targetId===j.id,children:[a.jsx(gn,{className:"mr-2"}),"Edit"]}),a.jsx("button",{className:"inline-flex items-center justify-center w-full sm:w-auto px-4 py-2 rounded-md text-sm bg-orange-500 text-white hover:bg-orange-600 transition focus:outline-none focus:ring-2 focus:ring-orange-400",onClick:()=>te(j),disabled:!!ft,children:St?"Archiving...":a.jsxs(a.Fragment,{children:[a.jsx(Zt,{className:"mr-2"}),"Archive"]})})]})]}),a.jsx("div",{className:"border-b border-gray-200 my-5"}),a.jsxs("div",{className:"p-6 lg:p-4",children:[a.jsx("div",{className:"flex w-full bg-[#6A727D] text-white mt-1 overflow-x-auto mb-6",children:["Overview","Activities"].map(L=>a.jsx("button",{onClick:()=>be(L),className:`flex-1 min-w-[90px] px-4 py-2.5 text-xs sm:text-sm font-medium text-center transition-all duration-200 border-b-2
        ${ge===L?"bg-paper-white text-[#6A727D] border-white":"text-white hover:bg-[#5c636d]"}`,children:L},L))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 items-start",children:[a.jsxs("div",{className:"lg:col-span-3",children:[ge==="Overview"&&a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 md:p-8 border border-gray-200",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4 sm:gap-6 text-sm text-gray-700",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Website:"}),a.jsx("p",{children:j.website?a.jsx("a",{href:j.website,className:"text-blue-600 hover:underline break-all",target:"_blank",rel:"noopener noreferrer",children:j.website}):"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Industry:"}),a.jsx("p",{children:j.industry||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Parent Company:"}),a.jsx("p",{children:j.parent_company||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Territory:"}),a.jsx("p",{children:j.territory?.name||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Phone Number:"}),a.jsx("p",{children:j.phone_number||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Billing Address:"}),a.jsx("p",{children:j.billing_address||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Shipping Address:"}),a.jsx("p",{children:j.shipping_address||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Assigned To:"}),a.jsx("p",{children:j.assigned_accs?`${j.assigned_accs.first_name} ${j.assigned_accs.last_name}`:"Unassigned"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created By:"}),a.jsx("p",{children:j.acc_creator?`${j.acc_creator.first_name} ${j.acc_creator.last_name}`:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created At:"}),a.jsx("p",{children:Be(j.created_at)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Last Updated:"}),a.jsx("p",{children:Be(j.updated_at)||"N/A"})]})]}),a.jsx(Tn,{comments:ot,onAddComment:rt})]}),ge==="Notes"&&a.jsxs("div",{className:"mt-4 w-full",children:[a.jsx("div",{className:"flex flex-wrap items-center justify-between mb-4 gap-2",children:a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words",children:"Account Note"})}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 shadow-sm break-words",children:[a.jsx("div",{className:"flex items-start justify-between",children:a.jsx("div",{children:a.jsx("p",{className:"text-sm font-medium text-gray-800 break-words",children:"Note"})})}),a.jsx("div",{className:"mt-3 text-sm text-gray-700 whitespace-pre-wrap break-words",children:N.notes||"No notes available."})]})]}),ge==="Activities"&&a.jsxs("div",{className:"space-y-2 w-full h-full max-h-[50dvh] overflow-y-auto bg-gray-50 p-2 hide-scrollbar rounded-lg border border-gray-200 shadow-sm",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words border-b border-gray-300 py-2",children:"Related Activities"}),a.jsxs("div",{className:"space-y-2 text-sm",children:[xe.tasks&&xe.tasks.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>Ee(Re==="tasks"?null:"tasks"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Qt,{className:"text-blue-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Tasks (",xe.tasks.length,")"]})]}),Re==="tasks"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Re==="tasks"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:xe.tasks.map((L,ee)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/group-manager/tasks",{state:{taskID:L.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-blue-600 mt-1",children:a.jsx(Qt,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:L.subject||L.title||"Task"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:L.description||"No description"}),L.assigned_to&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Assigned: ",L.assigned_to.first_name," ",L.assigned_to.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:Be(L.due_date||L.created_at)})]},`task-${ee}`))})]}),xe.meetings&&xe.meetings.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>Ee(Re==="meetings"?null:"meetings"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Pt,{className:"text-green-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Meetings (",xe.meetings.length,")"]})]}),Re==="meetings"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Re==="meetings"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:xe.meetings.map((L,ee)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/group-manager/meetings",{state:{meetingID:L.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-green-600 mt-1",children:a.jsx(Pt,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:L.subject||L.title||"Meeting"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:L.description||L.location||"No description"}),L.host&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Host: ",L.host.first_name," ",L.host.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:Be(L.start_time||L.created_at)})]},`meeting-${ee}`))})]}),xe.calls&&xe.calls.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>Ee(Re==="calls"?null:"calls"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(It,{className:"text-purple-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Calls (",xe.calls.length,")"]})]}),Re==="calls"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Re==="calls"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:xe.calls.map((L,ee)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/group-manager/calls",{state:{callID:L.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-purple-600 mt-1",children:a.jsx(It,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:L.subject||L.title||"Call"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:L.direction||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:Be(L.call_time||L.created_at)})]},`call-${ee}`))})]}),xe.contacts&&xe.contacts.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>Ee(Re==="contacts"?null:"contacts"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ra,{className:"text-teal-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Contacts (",xe.contacts.length,")"]})]}),Re==="contacts"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Re==="contacts"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:xe.contacts.map((L,ee)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/group-manager/contacts",{state:{contactID:L.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-teal-600 mt-1",children:a.jsx(ra,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("h4",{className:"font-medium text-blue-600 break-words text-sm",children:[L.first_name?`${L.first_name} `:"",L.last_name]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:L.title||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:Be(L.created_at)})]},`contact-${ee}`))})]}),xe.deals&&xe.deals.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>Ee(Re==="deals"?null:"deals"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(sa,{className:"text-indigo-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Deals (",xe.deals.length,")"]})]}),Re==="deals"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Re==="deals"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:xe.deals.map((L,ee)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/group-manager/deals",{state:{dealID:L.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-indigo-600 mt-1",children:a.jsx(sa,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("h4",{className:"font-medium text-blue-600 break-words text-sm",children:[L.deal_id?L.deal_id.replace(/D(\d+)-\d+-/,"D$1-"):"--"," ",L.name||L.title||"Deal"]}),a.jsx("p",{className:"text-xs text-gray-500 break-words capitalize",children:L.stage||L.description||"No description"})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:Be(L.close_date||L.created_at)})]},`deal-${ee}`))})]}),xe.quotes&&xe.quotes.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>Ee(Re==="quotes"?null:"quotes"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ia,{className:"text-orange-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Quotes (",xe.quotes.length,")"]})]}),Re==="quotes"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Re==="quotes"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:xe.quotes.map((L,ee)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/group-manager/quotes",{state:{quoteID:L.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-orange-600 mt-1",children:a.jsx(ia,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:(L.quote_id?L.quote_id.replace(/Q(\d+)-\d+-/,"Q$1-"):"--")||"Quote"}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:L.status||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:Be(L.presented_date)||""})]},`quote-${ee}`))})]}),(!xe||(!xe.tasks||xe.tasks.length===0)&&(!xe.meetings||xe.meetings.length===0)&&(!xe.calls||xe.calls.length===0)&&(!xe.quotes||xe.quotes.length===0)&&(!xe.deals||xe.deals.length===0)&&(!xe.contacts||xe.contacts.length===0))&&a.jsx("div",{className:"text-center py-8 text-gray-500",children:a.jsx("p",{children:"No related activities found for this account."})})]})]})]}),a.jsxs("div",{className:"flex flex-col gap-4",children:[a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Quick Actions"}),a.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[a.jsxs("button",{onClick:()=>e("/group-manager/calls",{state:{openCallModal:!0,initialCallData:{subject:`Call with ${j.name}`,relatedType1:"Account",relatedTo1:String(j.id),relatedType2:null,relatedTo2:null,assigned_to:j.assigned_accs?.id?String(j.assigned_accs.id):"",direction:"Outgoing",status:"Planned"}}}),className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(It,{className:"text-gray-600 w-4 h-4"}),"Schedule Call"]}),a.jsxs("button",{className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",onClick:()=>e("/group-manager/meetings",{state:{openMeetingModal:!0,initialMeetingData:{subject:`Meeting with ${j.name}`,relatedType1:"Account",relatedTo1:String(j.id),relatedType2:null,relatedTo2:null,assignedTo:j.assigned_accs?.id?String(j.assigned_accs.id):"",status:"Planned"}}}),children:[a.jsx(Pt,{className:"text-gray-600 w-4 h-4"}),"Book Meeting"]}),a.jsxs("button",{onClick:()=>e("/group-manager/tasks",{state:{openTaskModal:!0,initialTaskData:{subject:`Follow up with ${j.name}`,relatedType1:"Account",relatedTo1:String(j.id),relatedType2:null,relatedTo2:null,assignedTo:j.assigned_accs?.id?String(j.assigned_accs.id):"",priority:"NORMAL",status:"Not Started"}}}),className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(Qt,{className:"text-gray-600 w-4 h-4"}),"Tasks"]})]})]}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm w-full",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Status"}),a.jsx("select",{className:"border border-gray-200 rounded-md px-2 sm:px-3 py-1.5 w-full text-sm mb-2 focus:ring-2 focus:ring-indigo-500 outline-none",value:me||dr(j?.status)||"PROSPECT",onChange:L=>Ae(L.target.value),children:DT.map(L=>a.jsx("option",{value:L.value,children:L.label},L.value))}),a.jsx("button",{onClick:ie,disabled:pe||!me||dr(me)===dr(j?.status),className:`w-full py-1.5 rounded-md text-sm transition focus:outline-none focus:ring-2 ${pe||!me||dr(me)===dr(j?.status)?"bg-gray-400 cursor-not-allowed text-white":"bg-gray-900 text-white hover:bg-gray-800 focus:ring-gray-400"}`,children:pe?"Updating...":"Update"})]})]})]})]})]})}):null,qe=a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[S&&a.jsx(qt,{message:"Loading accounts..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h2",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(Xa,{className:"mr-2 text-blue-600"}),"Accounts Management"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{onClick:()=>{fe(),X(!1)},className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 my-1 lg:my-0 rounded-md hover:bg-gray-800 text-sm sm:text-base mx-auto sm:ml-auto cursor-pointer",children:[a.jsx(aa,{className:"mr-2"})," Add Account"]})})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4 mb-6 w-full break-words overflow-hidden lg:overflow-visible",children:De.map(L=>a.jsx(OWe,{...L},L.title))}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search accounts",value:$,onChange:L=>W(L.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsx("div",{className:"w-full lg:w-1/4",children:a.jsx("select",{value:B,onChange:L=>G(L.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:Pe.map(L=>a.jsx("option",{value:L.value,children:L.label},L.value))})})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[500px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 text-sm tracking-wide font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 w-12",children:a.jsx("input",{type:"checkbox",checked:He.size>0&&He.size===Me.filter(L=>L.acc_creator?.id===n?.id).length&&Me.filter(L=>L.acc_creator?.id===n?.id).length>0,onChange:Y,className:"w-4 h-4 cursor-pointer rounded border-gray-300",title:Me.some(L=>L.acc_creator?.id===n?.id)?He.size===Me.filter(L=>L.acc_creator?.id===n?.id).length?"Deselect all":"Select all":"No accounts to select"})}),a.jsx("th",{className:"py-3 px-4 truncate",children:"Account"}),a.jsx("th",{className:"py-3 px-4",children:"Status"}),a.jsx("th",{className:"py-3 px-4",children:"Industry"}),a.jsx("th",{className:"py-3 px-4",children:"Territory"}),a.jsx("th",{className:"py-3 px-4",children:"Phone"}),a.jsx("th",{className:"py-3 px-4 w-12",children:He.size>0&&a.jsx("button",{onClick:U,disabled:st,title:`Archive ${He.size} account${He.size!==1?"s":""}`,className:"text-orange-500 hover:text-orange-700 disabled:opacity-50 transition",children:a.jsx(Zt,{size:18})})})]})}),a.jsx("tbody",{children:S?a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:7,children:"Loading accounts..."})}):Qe.length>0?Me.map(L=>a.jsxs("tr",{className:"hover:bg-gray-50 text-xs cursor-pointer",children:[a.jsx("td",{className:"py-3 px-4",children:L.acc_creator?.id===n?.id?a.jsx("input",{type:"checkbox",checked:He.has(L.id),onChange:ee=>{ee.stopPropagation(),q(L.id)},className:"w-4 h-4 cursor-pointer rounded border-gray-300"}):null}),a.jsx("td",{className:"py-3 px-4",onClick:()=>{_t(L),ze(L.id)},children:a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-blue-600 hover:underline break-all text-sm",children:L.name}),a.jsx("div",{className:"text-gray-500 text-xs break-all",children:L.website||"--"})]})}),a.jsx("td",{className:"py-3 px-4",onClick:()=>{_t(L),ze(L.id)},children:a.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${DWe(L.status)}`,children:PT(L.status)})}),a.jsx("td",{className:"py-3 px-4 text-sm",onClick:()=>{_t(L),ze(L.id)},children:L.industry||"--"}),a.jsx("td",{className:"py-3 px-4 text-sm",onClick:()=>{_t(L),ze(L.id)},children:L.territory?.name||"--"}),a.jsx("td",{className:"py-3 px-4",onClick:()=>{_t(L),ze(L.id)},children:a.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[a.jsx(It,{className:"text-gray-500"}),a.jsx("span",{children:L.phone_number||"--"})]})})]},L.id)):a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:7,children:"No accounts found."})})})]})}),a.jsx(ca,{className:"mt-4",totalItems:Qe.length,pageSize:ye,currentPage:J,onPrev:et,onNext:yt,onPageSizeChange:Ce,label:"accounts"})]}),_e=s?a.jsx("div",{id:"modalBackdrop",onClick:Ge,className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-full sm:max-w-3xl rounded-2xl shadow-lg p-4 sm:p-6 md:p-8 relative border border-gray-200 overflow-y-auto hide-scrollbar max-h-[90vh]",onClick:L=>L.stopPropagation(),children:[a.jsx("button",{onClick:()=>{At(),X(!1)},className:"absolute top-4 right-4 text-gray-500 hover:text-black transition",disabled:l||le,children:a.jsx(ea,{size:22})}),a.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800 mb-4 sm:mb-6 flex items-center justify-center",children:i?"Edit Account":"Add New Account"}),a.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",onSubmit:oe,noValidate:!0,children:[a.jsx("div",{className:"md:col-span-2",children:a.jsx(hf,{label:"Name",name:"name",value:x.name,onChange:ce,placeholder:"Company name",required:!0,isSubmitted:Oe})}),a.jsx(cH,{label:"Parent Company",value:x.parent_company,onChange:L=>{b(ee=>({...ee,parent_company:L}))},items:D.map(L=>({id:L,name:L})),getLabel:L=>L?.name||"",placeholder:"Select parent company...",disabled:l}),a.jsx(hf,{label:"Website",name:"website",value:x.website,onChange:ce,placeholder:"https://example.com",disabled:l}),a.jsx(hf,{label:"Phone Number",name:"phone_number",value:x.phone_number,onChange:ce,placeholder:"09xx xxx xxxx",type:"tel",disabled:l}),a.jsx(hf,{label:"Industry",name:"industry",value:x.industry,onChange:ce,placeholder:"Industry",disabled:l}),a.jsx(hf,{label:"Billing Address",name:"billing_address",value:x.billing_address,onChange:ce,placeholder:"Billing address",disabled:l}),a.jsx(hf,{label:"Shipping Address",name:"shipping_address",value:x.shipping_address,onChange:ce,placeholder:"Shipping address",disabled:l}),a.jsx(lH,{label:"Status",name:"status",value:x.status,onChange:ce,options:[{value:"",label:"Select status"},...DT],required:!0,disabled:l}),a.jsx(cH,{label:"Assigned To",value:x.assigned_to,onChange:L=>{const ee=T.find($e=>String($e.id)===String(L));E(ee);let ke=null;ee&&ee.assigned_territory&&ee.assigned_territory.length===1&&(ke=ee.assigned_territory[0].id),b($e=>({...$e,assigned_to:L,territory_id:ke}))},items:T||[],getLabel:L=>`${L?.first_name??""} ${L?.last_name??""} (${L?.role??""})`.trim(),placeholder:"Search assignee...",required:!0,isSubmitted:Oe,disabled:l||T.length===0}),a.jsx("div",{className:"md:col-span-2",children:a.jsx(lH,{label:"Territory",name:"territory_id",value:x.territory_id||"",onChange:ce,options:[{value:"",label:A?A.assigned_territory&&A.assigned_territory.length>0?"Select Territory":"No territories assigned to this user":"Select a user first"},...A&&A.assigned_territory&&A.assigned_territory.map(L=>({value:String(L.id),label:L.name}))||[]],disabled:l||!A||!A.assigned_territory||A.assigned_territory.length===0})}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-end sm:justify-end space-y-2 sm:space-y-0 sm:space-x-2 col-span-1 md:col-span-2 mt-4 w-full",children:[a.jsx("button",{type:"button",onClick:()=>{At(),X(!1)},className:"w-full sm:w-auto px-4 py-2 text-white bg-red-400 border border-red-300 rounded hover:bg-red-500 transition disabled:opacity-70",disabled:l||le,children:"Cancel"}),a.jsx("button",{type:"submit",className:"w-full sm:w-auto px-4 py-2 text-white border border-tertiary bg-tertiary rounded hover:bg-secondary transition disabled:opacity-70",disabled:l||le,children:l?"Saving...":i?"Update Account":"Save Account"})]})]})]})}):null,I=Z?a.jsx(IWe,{open:!0,title:Z.title,message:Z.message,confirmLabel:Z.confirmLabel,cancelLabel:Z.cancelLabel,variant:Z.variant,onConfirm:de,onCancel:Te,loading:le}):null;return a.jsxs(a.Fragment,{children:[qe,da,_e,I]})}function OWe({icon:e,title:t,value:n,color:s="text-blue-600",bgColor:r="bg-blue-100",onClick:i}){const o=()=>{typeof i=="function"?i():console.log(`Clicked: ${t}`)};return a.jsxs("div",{className:"flex items-center p-4 bg-white rounded-xl shadow-md border border-gray-200 transition-all duration-300",onClick:o,children:[a.jsx("div",{className:`flex-shrink-0 p-3 rounded-full ${r} ${s} mr-4`,children:e?a.jsx(e,{size:22}):null}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:t}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:n})]})]})}function hf({label:e,name:t,value:n,onChange:s,placeholder:r,type:i="text",required:o=!1,disabled:l=!1,className:c="",isSubmitted:u=!1}){const d=u&&!n?.trim();return a.jsxs("div",{children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",o&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:i,name:t,value:n??"",onChange:s,placeholder:r,required:o,disabled:l,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border focus:ring-2
          ${d?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}
          ${c}
        `})]})}function lH({label:e,name:t,value:n,onChange:s,options:r,required:i=!1,disabled:o=!1}){return a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsx("select",{name:t,value:n??"",onChange:s,required:i,disabled:o,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100",children:r.map(l=>a.jsx("option",{value:l.value,children:l.label},l.value))})]})}function cH({label:e,items:t=[],value:n="",onChange:s,getLabel:r,placeholder:i="Search...",disabled:o=!1,className:l="",required:c=!1,isSubmitted:u=!1,allowFreeText:d=!1}){const h=u&&c&&!n;return a.jsxs("div",{className:l,children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",c&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx(MWe,{items:t,value:n??"",onChange:s,getLabel:r,placeholder:i,disabled:o,hasError:h,allowFreeText:d})]})}function MWe({items:e=[],value:t="",onChange:n,getLabel:s,placeholder:r="Search...",disabled:i=!1,maxRender:o=200,hasError:l=!1,allowFreeText:c=!1}){const[u,d]=f.useState(!1),[h,p]=f.useState(""),x=f.useRef(null),b=e.find(N=>String(N.id)===String(t)),j=b?s(b):t,y=f.useMemo(()=>{const N=h.trim().toLowerCase();return(N?e.filter(S=>(s(S)||"").toLowerCase().includes(N)):e).slice(0,o)},[e,h,s,o]);return f.useEffect(()=>{const N=w=>{x.current&&!x.current.contains(w.target)&&d(!1)};return document.addEventListener("mousedown",N),()=>document.removeEventListener("mousedown",N)},[]),f.useEffect(()=>{u||p("")},[u]),a.jsxs("div",{ref:x,className:"relative w-full",children:[a.jsx("input",{disabled:i,value:u?h:j,placeholder:r,onFocus:()=>!i&&d(!0),onChange:N=>{p(N.target.value),u||d(!0)},className:`w-full border rounded-md px-2 py-1.5 text-sm outline-none focus:ring-2
          ${l?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}`}),u&&!i&&a.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg overflow-hidden",children:[a.jsxs("div",{className:"max-h-56 overflow-y-auto hide-scrollbar",children:[c&&h.trim()&&!y.some(N=>s(N).toLowerCase()===h.trim().toLowerCase())&&a.jsxs("button",{type:"button",onClick:()=>{n(h.trim()),d(!1)},className:"w-full text-left px-3 py-2 text-sm hover:bg-green-50 bg-blue-50 font-medium text-blue-700",children:['+ Add "',h.trim(),'" as new parent company']}),y.length>0?y.map(N=>{const w=String(N.id),S=s(N),_=String(t)===w;return a.jsx("button",{type:"button",onClick:()=>{n(w),d(!1)},className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-50 ${_?"bg-blue-50":""}`,children:S||"--"},w)}):!c||!h.trim()?a.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No results"}):null]}),e.length>o&&a.jsxs("div",{className:"px-3 py-2 text-[11px] text-gray-400 border-t",children:["Showing first ",o," results  keep typing to narrow."]})]})]})}function IWe({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o=!1,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="archive"?"bg-orange-500 hover:bg-orange-600 border border-orange-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsx("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${u}`,disabled:o,children:o?"Processing...":s})]})]})})}const av={first_name:"",last_name:"",account_id:"",title:"",department:"",email:"",work_phone:"",mobile_phone_1:"",mobile_phone_2:"",notes:"",assigned_to:""},Nl=e=>[e?.first_name,e?.last_name].filter(Boolean).join(" ").trim(),vo=e=>e?new Date(e).toLocaleString("en-US",{month:"short",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).replace(",",""):"";function $We(){const e=Et(),t=ta(),{user:n}=Gt();f.useEffect(()=>{document.title="Contacts | Sari-Sari CRM"},[]);const[s,r]=f.useState([]),[i,o]=f.useState(!1),[l,c]=f.useState([]),[u,d]=f.useState([]),[h,p]=f.useState(null),[x,b]=f.useState(!1),[j,y]=f.useState(!1),[N,w]=f.useState(!1),[S,_]=f.useState(null),[T,k]=f.useState(!1),[A,E]=f.useState(null),[M,F]=f.useState(av),[D,P]=f.useState(""),[B,G]=f.useState("Filter by Accounts"),[$,W]=f.useState(null),[Z,Q]=f.useState("Overview"),[le,we]=f.useState(1),[J,se]=f.useState(10),[ye,Ce]=f.useState({}),[ge,be]=f.useState(null),[me,Ae]=f.useState(null),[pe,Ie]=f.useState(new Set),[xe,he]=f.useState(!1),{comments:Re,addComment:Ee,refresh:He}=kn({relatedType:"contact",relatedId:h?.id});f.useEffect(()=>{h?.id&&He()},[h?.id,He]),f.useEffect(()=>{const U=t.state?.contactID;U&&(Ae(U),e(t.pathname,{replace:!0,state:{}}))},[t,e]),f.useEffect(()=>{if(me&&s.length>0&&!i){const U=s.find(de=>de.id===me);U?p(U):V.error("Contact not found."),Ae(null)}},[me,s,i]);const Ke=f.useCallback(async(U=null)=>{o(!0);try{const de=await ne.get("/contacts/admin/fetch-all"),ie=[...Array.isArray(de.data)?de.data:[]].sort((Oe,X)=>{const oe=Oe?.created_at||Oe?.updated_at||0,Pe=X?.created_at||X?.updated_at||0;return new Date(Pe)-new Date(oe)});if(r(ie),U){const Oe=ie.find(X=>X.id===U);p(Oe||null)}}catch(de){console.error(de),r([]),de.response?.status===403?V.error("Permission denied. Only CEO, Admin, or Group Manager can access this page."):V.error("Failed to fetch contacts. Please try again later.")}finally{o(!1)}},[p]),st=f.useCallback(async()=>{try{const U=await ne.get("/accounts/admin/fetch-all"),Te=[...Array.isArray(U.data)?U.data:[]].sort((ie,Oe)=>(ie?.name||"").localeCompare(Oe?.name||""));c(Te)}catch(U){console.error(U),c([]),U.response?.status===403&&V.warn("Unable to load accounts (permission denied).")}},[]),it=f.useCallback(()=>{window.open("/group-manager/accounts?openModal=1","_blank","noopener,noreferrer")},[]),ot=f.useCallback(async()=>{try{const U=await ne.get("/users/all"),Te=[...Array.isArray(U.data)?U.data:[]].sort((ie,Oe)=>Nl(ie).localeCompare(Nl(Oe)));d(Te)}catch(U){console.error(U),d([]),U.response?.status===403&&V.warn("Unable to load users for assignment (permission denied).")}},[]),rt=f.useCallback(async U=>{try{const de=await ne.get(`/activities/contact/${U}`);Ce(de.data&&typeof de.data=="object"?de.data:{})}catch(de){console.error(de),de.response?.status===404&&(console.warn("No activities found for this account."),Ce({}))}},[]);f.useEffect(()=>{Ke(),st(),ot()},[Ke,st,ot]);const at=f.useMemo(()=>{const U=new Map;l.forEach(Te=>{Te?.id&&Te?.name&&U.set(String(Te.id),Te.name)}),s.forEach(Te=>{Te?.account_id&&Te?.account?.name&&U.set(String(Te.account_id),Te.account.name)});const de=Array.from(U.entries()).sort((Te,ie)=>Te[1].localeCompare(ie[1])).map(([Te,ie])=>({value:Te,label:ie}));return[{value:"Filter by Accounts",label:"Filter by Accounts"},...de]},[l,s]),Je=f.useMemo(()=>{const U=D.trim().toLowerCase(),de=B.trim();return s.filter(Te=>{const ie=[Te?.first_name,Te?.last_name,Te?.email,Te?.title,Te?.department,Te?.account?.name,Te?.account?.status,Te?.work_phone,Te?.mobile_phone_1,Te?.mobile_phone_2,Te?.assigned_contact?.first_name,Te?.assigned_contact?.last_name,Te?.contact_creator?.first_name,Te?.contact_creator?.last_name,Te?.notes,vo(Te?.created_at),vo(Te?.updated_at)],Oe=U===""||ie.some(ft=>ft==null?!1:ft.toString().toLowerCase().includes(U)),X=de==="Filter by Accounts"||String(Te.account_id)===de,oe=Te?.status!=="Inactive";let Pe=!0;const Ve=n?.role?.toUpperCase();if(Ve!=="GROUP MANAGER"&&Ve!=="CEO"&&Ve!=="ADMIN"){const ft=Te?.assigned_to===n?.id,St=Te?.created_by===n?.id;Pe=ft||St}return Oe&&X&&oe&&Pe})},[s,D,B,n?.id]),Fe=Math.max(1,Math.ceil(Je.length/J)||1);f.useEffect(()=>{we(1)},[D,B,J]),f.useEffect(()=>{we(U=>{const de=Math.max(1,Math.ceil(Je.length/J)||1);return U>de?de:U})},[Je.length,J]);const Ue=f.useMemo(()=>{const U=(le-1)*J;return Je.slice(U,U+J)},[Je,le,J]),Ne=()=>we(U=>Math.max(U-1,1)),ze=()=>we(U=>Math.min(U+1,Fe)),je=f.useMemo(()=>{if(!j||!A)return l;const U=s.find(Te=>Te.id===A);return!U||!U.account||l.some(Te=>Te.id===U.account.id)?l:[...l,U.account]},[l,j,A,s]),ve=f.useCallback(()=>{b(!1),y(!1),E(null),F(av),w(!1),et(!1)},[]),z=U=>{U.target.id==="modalBackdrop"&&!N&&!T&&ve()},K=U=>{const{name:de,value:Te}=U.target;F(ie=>({...ie,[de]:Te}))},ue=()=>{F(av),y(!1),E(null),b(!0)};f.useEffect(()=>{const U=new URLSearchParams(t.search||"");(t.state?.openContactModal||U.get("openModal")==="1")&&(F(av),y(!1),E(null),b(!0),et(!1),e(t.pathname,{replace:!0,state:{}}))},[t.state,t.pathname,t.search,e]);const re=async U=>{if(!U)return;const de=await ne.get(`/accounts/get/${U.account_id}`);F({first_name:U.first_name||"",last_name:U.last_name||"",account_id:de.data.id?de.data.id:"",title:U.title||"",department:U.department||"",email:U.email||"",work_phone:U.work_phone||"",mobile_phone_1:U.mobile_phone_1||"",mobile_phone_2:U.mobile_phone_2||"",notes:U.notes||"",assigned_to:U.assigned_to?String(U.assigned_to):""}),y(!0),E(U.id),b(!0),p(null)},Le=U=>{if(!U)return;const de=Nl(U)||"this contact";_({title:"Archive Contact",message:a.jsxs("span",{children:["Are you sure you want to archive"," ",a.jsx("span",{className:"font-semibold",children:de}),"? You can restore it later if needed."]}),confirmLabel:"Archive Contact",cancelLabel:"Cancel",variant:"archive",action:{type:"archive",targetId:U.id,name:de}})},De=U=>{const de=Ue.find(Te=>Te.id===U);de&&de.contact_creator?.id===n?.id&&Ie(Te=>{const ie=new Set(Te);return ie.has(U)?ie.delete(U):ie.add(U),ie})},Qe=()=>{const U=Ue.filter(de=>de.contact_creator?.id===n?.id);pe.size===U.length&&U.length>0?Ie(new Set):Ie(new Set(U.map(de=>de.id)))},tt=()=>{if(pe.size===0)return;const U=pe.size;_({title:"Archive Contacts",message:a.jsxs("span",{children:["Are you sure you want to archive"," ",a.jsx("span",{className:"font-semibold",children:U})," contact",U!==1?"s":"","? You can restore them later if needed."]}),confirmLabel:`Archive ${U} Contact${U!==1?"s":""}`,cancelLabel:"Cancel",variant:"archive",action:{type:"bulk-archive",targetIds:Array.from(pe),count:U}})},[Me,et]=f.useState(!1),yt=U=>{U.preventDefault(),et(!0);const de=M.last_name.trim();if(!de){V.error("Last name is required.");return}if(!M.account_id){V.error("Account is required.");return}if(!M.assigned_to){V.error("Assigned To is required.");return}const ie=M.email?.trim();if(!ie){V.error("Email is required.");return}if(!ie.includes("@")){V.error("Email must contain '@'.");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(ie)){V.error("Please enter a valid email address.");return}const X=M.first_name?.trim()||"",oe={first_name:X,last_name:de,account_id:Number(M.account_id),title:M.title?.trim()||null,department:M.department?.trim()||null,email:M.email?.trim().toLowerCase()||null,work_phone:M.work_phone?.trim()||null,mobile_phone_1:M.mobile_phone_1?.trim()||null,mobile_phone_2:M.mobile_phone_2?.trim()||null,notes:M.notes?.trim()||null,assigned_to:M.assigned_to?Number(M.assigned_to):null},Pe=j&&A?"update":"create",Ve=`${X} ${de}`.trim();_({title:Pe==="create"?"Confirm New Contact":"Confirm Update",message:Pe==="create"?a.jsxs("span",{children:["Are you sure you want to add"," ",a.jsx("span",{className:"font-semibold",children:Ve})," to your contacts?"]}):a.jsxs("span",{children:["Save changes to ",a.jsx("span",{className:"font-semibold",children:Ve}),"?"]}),confirmLabel:Pe==="create"?"Create Contact":"Update Contact",cancelLabel:"Cancel",variant:"primary",action:{type:Pe,payload:oe,targetId:A||null,name:Ve}})},_t=async()=>{if(!S?.action){_(null);return}const{action:U}=S,{type:de,payload:Te,targetId:ie,name:Oe}=U;k(!0);try{if(de==="create"){w(!0),await ne.post("/contacts/admin",Te),V.success(`Contact "${Oe}" created successfully.`);const X=h?.id||null;ve(),await Ke(X)}else if(de==="update"){if(!ie)throw new Error("Missing contact identifier for update.");w(!0),await ne.put(`/contacts/admin/${ie}`,Te),V.success(`Contact "${Oe}" updated successfully.`);const X=h?.id&&h.id===ie?ie:h?.id||null;ve(),await Ke(X),h?.id===ie&&p(null)}else if(de==="archive"){if(!ie)throw new Error("Missing contact identifier for archiving.");const X=h?.id;W(ie),await ne.put(`/contacts/admin/${ie}`,{status:"Inactive"}),V.success(`Contact "${Oe}" archived successfully.`),await Ke(X&&X!==ie?X:null),X===ie&&p(null)}else if(de==="bulk-archive"){const{targetIds:X,count:oe}=U;if(!X||X.length===0)throw new Error("Missing contact identifiers for bulk archiving.");he(!0),await Promise.all(X.map(Pe=>ne.put(`/contacts/admin/${Pe}`,{status:"Inactive"}))),V.success(`${oe} contact${oe!==1?"s":""} archived successfully.`),Ie(new Set),await Ke(),p(null)}}catch(X){console.error(X);const oe=de==="create"?"Failed to create contact. Please review the details and try again.":de==="update"?"Failed to update contact. Please review the details and try again.":de==="bulk-archive"?"Failed to archive contacts. Please try again.":"Failed to archive contact. Please try again.",Pe=X.response?.data?.detail||oe;V.error(Pe)}finally{(de==="create"||de==="update")&&w(!1),de==="archive"&&W(null),de==="bulk-archive"&&he(!1),k(!1),_(null)}},Ct=()=>{T||_(null)},jt=U=>{p(U),Q("Overview")},At=()=>p(null),Ge=U=>{U.target.id==="contactModalBackdrop"&&!T&&At()},Be=S?.action?.type==="delete"?S.action.targetId:null,ce=h&&($===h.id||Be===h.id),fe=h&&$===h.id,H=h?a.jsx("div",{id:"contactModalBackdrop",onClick:Ge,className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-6xl max-h-[92vh] overflow-y-auto hide-scrollbar animate-scale-in font-inter relative",onClick:U=>U.stopPropagation(),children:[a.jsxs("div",{className:"bg-tertiary w-full rounded-t-xl relative p-3 lg:p-3",children:[a.jsx("h1",{className:"lg:text-3xl text-xl text-white font-semibold text-center w-full",children:"Contact"}),a.jsx("button",{onClick:At,className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-white cursor-pointer",children:a.jsx(Za,{size:25})})]}),a.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between lg:flex-row lg:items-center lg:justify-between mt-3 gap-2 px-2 md:items-center lg:gap-4 md:mx-7 lg:mx-7",children:[a.jsx("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:a.jsx("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-800",children:Nl(h)||"Unnamed contact"})}),a.jsx("div",{className:"flex flex-col sm:flex-row sm:space-x-3 space-y-2 sm:space-y-0",children:n?.id===h?.contact_creator?.id&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{className:"inline-flex items-center justify-center w-full sm:w-auto bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 disabled:opacity-70 transition text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",onClick:()=>re(h),disabled:T||S?.action?.type==="update"&&S.action.targetId===h.id,children:[a.jsx(gn,{className:"mr-2"}),"Edit"]}),a.jsx("button",{className:"inline-flex items-center justify-center w-full sm:w-auto px-4 py-2 rounded-md text-sm bg-orange-500 text-white hover:bg-orange-600 transition focus:outline-none focus:ring-2 focus:ring-orange-400",onClick:()=>Le(h),disabled:!!ce,children:fe?"Archiving...":a.jsxs(a.Fragment,{children:[a.jsx(Zt,{className:"mr-2"}),"Archive"]})})]})})]}),a.jsx("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-2 px-2 lg:gap-4 md:mx-7 lg:mx-7",children:a.jsx("p",{className:"text-sm text-gray-500",children:h.account?.name||"No associated account"})}),a.jsx("div",{className:"border-b border-gray-200 my-5"}),a.jsxs("div",{className:"p-6 lg:p-4",children:[a.jsx("div",{className:"flex w-full bg-[#6A727D] text-white mt-1 overflow-x-auto mb-6",children:["Overview","Notes","Activities"].map(U=>a.jsx("button",{onClick:()=>Q(U),className:`flex-1 min-w-[90px] px-4 py-2.5 text-xs sm:text-sm font-medium text-center transition-all duration-200 border-b-2
        ${Z===U?"bg-paper-white text-[#6A727D] border-white":"text-white hover:bg-[#5c636d]"}`,children:U},U))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 items-start",children:[a.jsxs("div",{className:"lg:col-span-3",children:[Z==="Overview"&&a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 md:p-8 border border-gray-200",children:a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4 sm:gap-6 text-sm text-gray-700",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Contact Name:"}),a.jsx("p",{children:Nl(h)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Title:"}),a.jsx("p",{children:h.title||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Email:"}),a.jsx("p",{children:h.email?a.jsx("a",{href:`mailto:${h.email}`,className:"text-blue-600 hover:underline break-all",children:h.email}):"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Department:"}),a.jsx("p",{children:h.department||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Work Phone:"}),a.jsx("p",{children:h.work_phone||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Mobile Phone 1:"}),a.jsx("p",{children:h.mobile_phone_1||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Mobile Phone 2:"}),a.jsx("p",{children:h.mobile_phone_2||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Assigned To:"}),a.jsx("p",{children:h.assigned_contact?`${h.assigned_contact.first_name} ${h.assigned_contact.last_name}`:"Unassigned"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created By:"}),a.jsx("p",{children:h.contact_creator?`${h.contact_creator.first_name} ${h.contact_creator.last_name}`:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created At:"}),a.jsx("p",{children:vo(h.created_at)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Last Updated:"}),a.jsx("p",{children:vo(h.updated_at)||"N/A"})]})]})}),Z==="Notes"&&a.jsxs("div",{className:"mt-4 w-full",children:[a.jsx("div",{className:"flex flex-wrap items-center justify-between mb-4 gap-2",children:a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words",children:"Contact Note"})}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 shadow-sm break-words",children:[a.jsx("div",{className:"flex items-start justify-between",children:a.jsx("div",{children:a.jsx("p",{className:"text-sm font-medium text-gray-800 break-words",children:"Note"})})}),a.jsx("div",{className:"mt-3 text-sm text-gray-700 whitespace-pre-wrap break-words",children:h.notes||"No notes available."})]}),a.jsx(Tn,{comments:Re,onAddComment:Ee})]}),Z==="Activities"&&a.jsxs("div",{className:"space-y-2 w-full h-full max-h-[50dvh] overflow-y-auto bg-gray-50 p-2 hide-scrollbar rounded-lg border border-gray-200 shadow-sm",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words border-b border-gray-300 py-2",children:"Related Activities"}),a.jsxs("div",{className:"space-y-2 text-sm",children:[ye.tasks&&ye.tasks.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>be(ge==="tasks"?null:"tasks"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Qt,{className:"text-blue-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Tasks (",ye.tasks.length,")"]})]}),ge==="tasks"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),ge==="tasks"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:ye.tasks.map((U,de)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/group-manager/tasks",{state:{taskID:U.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-blue-600 mt-1",children:a.jsx(Qt,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:U.subject||U.title||"Task"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:U.description||"No description"}),U.assigned_to&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Assigned: ",U.assigned_to.first_name," ",U.assigned_to.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:vo(U.due_date||U.created_at)})]},`task-${de}`))})]}),ye.meetings&&ye.meetings.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>be(ge==="meetings"?null:"meetings"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Pt,{className:"text-green-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Meetings (",ye.meetings.length,")"]})]}),ge==="meetings"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),ge==="meetings"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:ye.meetings.map((U,de)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/group-manager/meetings",{state:{meetingID:U.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-green-600 mt-1",children:a.jsx(Pt,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:U.subject||U.title||"Meeting"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:U.description||U.location||"No description"}),U.host&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Host: ",U.host.first_name," ",U.host.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:vo(U.start_time||U.created_at)})]},`meeting-${de}`))})]}),ye.calls&&ye.calls.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>be(ge==="calls"?null:"calls"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(It,{className:"text-purple-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Calls (",ye.calls.length,")"]})]}),ge==="calls"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),ge==="calls"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:ye.calls.map((U,de)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/group-manager/calls",{state:{callID:U.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-purple-600 mt-1",children:a.jsx(It,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:U.subject||U.title||"Call"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:U.direction||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:vo(U.call_time||U.created_at)})]},`call-${de}`))})]}),ye.deals&&ye.deals.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>be(ge==="deals"?null:"deals"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(sa,{className:"text-indigo-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Deals (",ye.deals.length,")"]})]}),ge==="deals"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),ge==="deals"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:ye.deals.map((U,de)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/group-manager/deals",{state:{dealID:U.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-indigo-600 mt-1",children:a.jsx(sa,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("h4",{className:"font-medium text-blue-600 break-words text-sm",children:[U.deal_id?U.deal_id.replace(/D(\d+)-\d+-/,"D$1-"):"--"," ",U.name||U.title||"Deal"]}),a.jsx("p",{className:"text-xs text-gray-500 break-words capitalize",children:U.stage||U.description||"No description"})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:vo(U.close_date||U.created_at)})]},`deal-${de}`))})]}),ye.quotes&&ye.quotes.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>be(ge==="quotes"?null:"quotes"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ia,{className:"text-orange-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Quotes (",ye.quotes.length,")"]})]}),ge==="quotes"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),ge==="quotes"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:ye.quotes.map((U,de)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/group-manager/quotes",{state:{quoteID:U.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-orange-600 mt-1",children:a.jsx(ia,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:(U.quote_id?U.quote_id.replace(/Q(\d+)-\d+-/,"Q$1-"):"--")||"Quote"}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:U.status||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:vo(U.presented_date)||""})]},`quote-${de}`))})]}),(!ye||(!ye.tasks||ye.tasks.length===0)&&(!ye.meetings||ye.meetings.length===0)&&(!ye.calls||ye.calls.length===0)&&(!ye.quotes||ye.quotes.length===0)&&(!ye.deals||ye.deals.length===0)&&(!ye.contacts||ye.contacts.length===0))&&a.jsx("div",{className:"text-center py-8 text-gray-500",children:a.jsx("p",{children:"No related activities found for this account."})})]})]})]}),a.jsx("div",{className:"flex flex-col gap-4",children:a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Quick Actions"}),a.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[a.jsxs("button",{onClick:()=>e("/group-manager/calls",{state:{openCallModal:!0,initialCallData:{subject:`Call with ${Nl(h)||""}`.trim(),relatedType1:"Account",relatedTo1:h?.account_id?String(h.account_id):h?.account?.id?String(h.account.id):"",relatedType2:"Contact",relatedTo2:h?.id?String(h.id):"",assigned_to:h?.assigned_contact?.id?String(h.assigned_contact.id):"",direction:"Outgoing",status:"Planned"}}}),className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(It,{className:"text-gray-600 w-4 h-4"}),"Schedule Call"]}),a.jsxs("button",{type:"button",onClick:()=>{if(!h?.email){alert("No email address available");return}const U=encodeURIComponent(h.email),de=encodeURIComponent(""),Te=encodeURIComponent(""),ie=`mailto:${U}?subject=${de}&body=${Te}`;window.location.href=ie},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(sn,{className:"text-gray-600 w-4 h-4"}),"Send E-mail"]}),a.jsxs("button",{className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",onClick:()=>e("/group-manager/meetings",{state:{openMeetingModal:!0,initialMeetingData:{subject:`Meeting with ${Nl(h)||""}`.trim(),relatedType1:"Account",relatedTo1:h?.account_id?String(h.account_id):h?.account?.id?String(h.account.id):"",relatedType2:"Contact",relatedTo2:h?.id?String(h.id):"",assignedTo:h?.assigned_contact?.id?String(h.assigned_contact.id):"",status:"Planned"}}}),children:[a.jsx(Pt,{className:"text-gray-600 w-4 h-4"}),"Book Meeting"]}),a.jsxs("button",{onClick:()=>e("/group-manager/tasks",{state:{openTaskModal:!0,initialTaskData:{subject:`Task for ${Nl(h)||""}`.trim(),relatedType1:"Account",relatedTo1:h?.account_id?String(h.account_id):h?.account?.id?String(h.account.id):"",relatedType2:"Contact",relatedTo2:h?.id?String(h.id):"",assignedTo:h?.assigned_contact?.id?String(h.assigned_contact.id):"",priority:"NORMAL",status:"Not Started"}}}),className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(Qt,{className:"text-gray-600 w-4 h-4"}),"Tasks"]})]})]})})]})]})]})}):null,te=a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[i&&a.jsx(qt,{message:"Loading contacts..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0 w-full",children:[a.jsxs("h2",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(Xa,{className:"mr-2 text-blue-600"})," Contacts Management"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{onClick:()=>{ue(),et(!1)},className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 rounded-md hover:bg-gray-800 text-sm sm:text-base self-end sm:self-auto cursor-pointer",children:[a.jsx(aa,{className:"mr-2"})," Add Contact"]})})]}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search contacts",value:D,onChange:U=>P(U.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsx("div",{className:"w-full lg:w-1/4",children:a.jsx("select",{value:B,onChange:U=>G(U.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:at.map(U=>a.jsx("option",{value:U.value,children:U.label},U.value??U.label))})})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[600px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 text-sm tracking-wide font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 w-12",children:a.jsx("input",{type:"checkbox",checked:pe.size>0&&pe.size===Ue.filter(U=>U.contact_creator?.id===n?.id).length&&Ue.filter(U=>U.contact_creator?.id===n?.id).length>0,onChange:Qe,className:"w-4 h-4 cursor-pointer"})}),a.jsx("th",{className:"py-3 px-4 truncate",children:"Contact"}),a.jsx("th",{className:"py-3 px-4",children:"Account"}),a.jsx("th",{className:"py-3 px-4 truncate",children:"Contact Info"}),a.jsx("th",{className:"py-3 px-4",children:"Department"}),a.jsx("th",{className:"py-3 px-4",children:"Assigned To"}),a.jsx("th",{className:"py-3 px-4",children:"Created"}),a.jsx("th",{className:"py-3 px-4 w-12",children:pe.size>0&&a.jsx("button",{onClick:tt,className:"text-orange-500 hover:text-orange-700 transition",title:"Archive selected contacts",disabled:xe,children:a.jsx(Zt,{size:18})})})]})}),a.jsx("tbody",{children:i?a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:8,children:"Loading contacts..."})}):Je.length>0?Ue.map(U=>{const de=[{Icon:sn,value:U.email,key:"email"},{Icon:It,value:U.work_phone,key:"work_phone"}].filter(Te=>!!Te.value);return a.jsxs("tr",{className:"hover:bg-gray-50 text-sm cursor-pointer transition",children:[a.jsx("td",{className:"py-3 px-4",children:n?.id===U.contact_creator?.id&&a.jsx("input",{type:"checkbox",checked:pe.has(U.id),onChange:Te=>{Te.stopPropagation(),De(U.id)},className:"w-4 h-4 cursor-pointer"})}),a.jsxs("td",{className:"py-3 px-4 align-top",onClick:()=>{jt(U),rt(U.id)},children:[a.jsx("div",{className:"font-medium text-blue-600 hover:underline break-all text-sm",children:Nl(U)||"--"}),a.jsx("div",{className:"text-xs text-gray-500",children:U.title||"No title"})]}),a.jsx("td",{className:"py-3 px-4 align-top",onClick:()=>{jt(U),rt(U.id)},children:a.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-700",children:[a.jsx(Kx,{className:"text-gray-500 flex-shrink-0"}),a.jsx("span",{className:"break-words",children:U.account?.name||"--"})]})}),a.jsx("td",{className:"py-3 px-4 align-top",onClick:()=>{jt(U),rt(U.id)},children:de.length>0?a.jsx("div",{className:"space-y-1 text-gray-700",children:de.map(({Icon:Te,value:ie,key:Oe})=>{const X=wt.createElement(Te,{className:"text-gray-500 flex-shrink-0"});return a.jsxs("div",{className:"flex items-center space-x-2 break-all text-sm",children:[X,a.jsx("span",{children:ie})]},Oe)})}):a.jsx("span",{className:"text-gray-400 text-sm",children:"--"})}),a.jsx("td",{className:"py-3 px-4 align-top",onClick:()=>{jt(U),rt(U.id)},children:a.jsxs("div",{className:"flex items-center space-x-2 text-gray-700 text-sm",children:[a.jsx(sa,{className:"text-gray-500 flex-shrink-0"}),a.jsx("span",{children:U.department||"--"})]})}),a.jsx("td",{className:"py-3 px-4 align-top",onClick:()=>{jt(U),rt(U.id)},children:a.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[a.jsx(ra,{className:"text-gray-500 flex-shrink-0"}),a.jsx("span",{children:U.assigned_contact?`${U.assigned_contact.first_name} ${U.assigned_contact.last_name}`:"Unassigned"})]})}),a.jsx("td",{className:"py-3 px-4 align-top",onClick:()=>{jt(U),rt(U.id)},children:a.jsxs("div",{className:"flex items-center space-x-2 text-gray-500",children:[a.jsx(Pt,{className:"text-gray-500 flex-shrink-0"}),a.jsx("span",{className:"text-xs",children:vo(U.created_at)||"--"})]})}),a.jsx("td",{className:"py-3 px-4"})]},U.id)}):a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:8,children:"No contacts found."})})})]})}),a.jsx(ca,{className:"mt-4",totalItems:Je.length,pageSize:J,currentPage:le,onPrev:Ne,onNext:ze,onPageSizeChange:se,label:"contacts"})]}),q=x?a.jsx("div",{id:"modalBackdrop",onClick:z,className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-full sm:max-w-3xl rounded-2xl shadow-lg p-4 sm:p-6 md:p-8 relative border border-gray-200 overflow-y-auto max-h-[90vh] hide-scrollbar",onClick:U=>U.stopPropagation(),children:[a.jsx("button",{onClick:()=>{ve(),et(!1)},className:"absolute top-4 right-4 text-gray-500 hover:text-black transition disabled:opacity-60",disabled:N||T,children:a.jsx(ea,{size:22})}),a.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800 mb-4 sm:mb-6 flex items-center justify-center",children:j?"Edit Contact":"Add New Contact"}),a.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",onSubmit:yt,noValidate:!0,children:[a.jsx(Gc,{label:"First Name",name:"first_name",value:M.first_name,onChange:K,placeholder:"First name",disabled:N}),a.jsx(Gc,{label:"Last Name",name:"last_name",value:M.last_name,onChange:K,placeholder:"Last name",required:!0,isSubmitted:Me}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:col-span-2",children:[a.jsx(dH,{label:"Account",value:M.account_id,onChange:U=>F(de=>({...de,account_id:U})),items:j?je:l||[],getLabel:U=>U?.name??"",placeholder:"Search account...",actions:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{type:"button",onClick:it,disabled:N,title:"Add account",className:"inline-flex items-center justify-center w-4 h-4 rounded-sm border border-gray-300 text-gray-600 hover:bg-gray-50 transition disabled:opacity-60",children:a.jsx(aa,{size:16})}),a.jsx("button",{type:"button",onClick:st,disabled:N,title:"Refresh accounts",className:"inline-flex items-center justify-center w-4 h-3 text-gray-600 hover:bg-gray-50 transition disabled:opacity-60",children:a.jsx(Br,{size:16})})]}),disabled:N||(j?je.length===0:l.length===0),required:!0,isSubmitted:Me}),a.jsx(dH,{label:"Assigned To",value:M.assigned_to,onChange:U=>F(de=>({...de,assigned_to:U})),items:u||[],getLabel:U=>`${U?.first_name??""} ${U?.last_name??""} (${U?.role??""})`.trim(),placeholder:"Search assignee...",required:!0,isSubmitted:Me,disabled:N||u.length===0})]}),a.jsx(Gc,{label:"Title",name:"title",value:M.title,onChange:K,placeholder:"Job title",disabled:N}),a.jsx(Gc,{label:"Department",name:"department",value:M.department,onChange:K,placeholder:"Department",disabled:N}),a.jsx(Gc,{label:"Email",name:"email",type:"email",value:M.email,onChange:K,placeholder:"example@email.com",required:!0,isSubmitted:Me}),a.jsx(Gc,{label:"Work Phone",name:"work_phone",value:M.work_phone,onChange:K,placeholder:"09xx xxx xxxx",disabled:N}),a.jsx(Gc,{label:"Mobile Phone 1",name:"mobile_phone_1",value:M.mobile_phone_1,onChange:K,placeholder:"09xx xxx xxxx",disabled:N}),a.jsx(Gc,{label:"Mobile Phone 2",name:"mobile_phone_2",value:M.mobile_phone_2,onChange:K,placeholder:"09xx xxx xxxx",disabled:N}),a.jsx(zWe,{label:"Notes",name:"notes",value:M.notes,onChange:K,placeholder:"Additional details...",rows:3,disabled:N,className:"md:col-span-2"}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-2 md:col-span-2 mt-4",children:[a.jsx("button",{type:"button",onClick:()=>{ve(),et(!1)},className:"w-full sm:w-auto px-4 py-2 text-white bg-red-400 border border-red-300 rounded hover:bg-red-500 transition disabled:opacity-70",disabled:N||T,children:"Cancel"}),a.jsx("button",{type:"submit",className:"w-full sm:w-auto px-4 py-2 text-white border border-tertiary bg-tertiary rounded hover:bg-secondary transition disabled:opacity-70",disabled:N||T,children:N?"Saving...":j?"Update Contact":"Save Contact"})]})]})]})}):null,Y=S?a.jsx(FWe,{open:!0,title:S.title,message:S.message,confirmLabel:S.confirmLabel,cancelLabel:S.cancelLabel,variant:S.variant,onConfirm:_t,onCancel:Ct,loading:T}):null;return a.jsxs(a.Fragment,{children:[te,H,q,Y]})}function Gc({label:e,name:t,value:n,onChange:s,placeholder:r,type:i="text",required:o=!1,disabled:l=!1,isSubmitted:c=!1,className:u=""}){const d=c&&!n?.trim();return a.jsxs("div",{children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",o&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:i,name:t,value:n??"",onChange:s,placeholder:r,required:o,disabled:l,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border focus:ring-2
          ${d?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}
          ${u}
        `})]})}function dH({label:e,items:t=[],value:n="",onChange:s,getLabel:r,placeholder:i="Search...",disabled:o=!1,className:l="",required:c=!1,isSubmitted:u=!1,actions:d=null}){const h=u&&c&&!n;return a.jsxs("div",{className:l,children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",c&&a.jsx("span",{className:"text-red-500",children:"*"})]}),d?a.jsx("div",{className:"flex items-center",children:d}):null]}),a.jsx(RWe,{items:t,value:n??"",onChange:s,getLabel:r,placeholder:i,disabled:o,hasError:h})]})}function RWe({items:e=[],value:t="",onChange:n,getLabel:s,placeholder:r="Search...",disabled:i=!1,maxRender:o=200,hasError:l=!1}){const[c,u]=f.useState(!1),[d,h]=f.useState(""),p=f.useRef(null),x=e.find(y=>String(y.id)===String(t)),b=x?s(x):"",j=f.useMemo(()=>{const y=d.trim().toLowerCase();return(y?e.filter(w=>(s(w)||"").toLowerCase().includes(y)):e).slice(0,o)},[e,d,s,o]);return f.useEffect(()=>{const y=N=>{p.current&&!p.current.contains(N.target)&&u(!1)};return document.addEventListener("mousedown",y),()=>document.removeEventListener("mousedown",y)},[]),f.useEffect(()=>{c||h("")},[c]),a.jsxs("div",{ref:p,className:"relative w-full",children:[a.jsx("input",{disabled:i,value:c?d:b,placeholder:r,onFocus:()=>!i&&u(!0),onChange:y=>{h(y.target.value),c||u(!0)},className:`w-full border rounded-md px-2 py-1.5 text-sm outline-none focus:ring-2
          ${l?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}`}),c&&!i&&a.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg overflow-hidden",children:[a.jsx("div",{className:"max-h-56 overflow-y-auto",children:j.length>0?j.map(y=>{const N=String(y.id),w=s(y),S=String(t)===N;return a.jsx("button",{type:"button",onClick:()=>{n(N),u(!1)},className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-50 ${S?"bg-blue-50":""}`,children:w||"--"},N)}):a.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No results"})}),e.length>o&&a.jsxs("div",{className:"px-3 py-2 text-[11px] text-gray-400 border-t",children:["Showing first ",o," results  keep typing to narrow."]})]})]})}function zWe({label:e,name:t,value:n,onChange:s,placeholder:r,rows:i=3,disabled:o=!1,className:l=""}){return a.jsxs("div",{className:l,children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsx("textarea",{name:t,value:n??"",onChange:s,placeholder:r,rows:i,disabled:o,className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100 resize-none"})]})}function FWe({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o=!1,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":i==="archive"?"bg-orange-500 hover:bg-orange-600 border border-orange-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsx("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${u}`,disabled:o,children:o?"Processing...":s})]})]})})}const OT=e=>e?new Date(e).toLocaleString("en-US",{month:"short",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).replace(",",""):"";function Pee({lead:e,onBack:t,fetchLeads:n,onEdit:s,onArchive:r,setSelectedLead:i,relatedActs:o}){const l=Et(),{leadID:c}=Wo(),{user:u}=Gt(),[d,h]=f.useState(e||null),[p,x]=f.useState("Overview"),[b,j]=f.useState(""),y=d?.status?.toUpperCase()==="QUALIFIED",[N,w]=f.useState(null),S=d&&u&&d.creator?.id===u.id,[_,T]=f.useState({name:"",website:"",countryCode:"",phone_number:"",billing_address:"",shipping_address:"",industry:"",status:"Prospect",territory_id:null,assigned_to:null,created_by:null}),[k,A]=f.useState({last_name:"",first_name:"",account_id:null,title:"",department:"",email:"",work_phone:"",mobile_phone_1:"",mobile_phone_2:"",notes:"",assigned_to:null,created_by:null}),[E,M]=f.useState({name:"Converted from Lead",account_id:null,primary_contact_id:null,stage:"Prospecting",probability:10,amount:0,currency:"PHP",description:"Initial deal from lead conversion.",assigned_to:null,created_by:null}),F=async()=>{try{if(e){h(e),j(e.status||"New");return}if(!c)return;const $=await ne.get(`/leads/get/${c}`);h($.data),j($.data.status||"New"),T({name:$.data.company_name||"",website:"",countryCode:"+63",phone_number:"",billing_address:"",shipping_address:"",industry:"",status:"Prospect",territory_id:$.data.territory?.id||null,assigned_to:$.data.assigned_to?.id||null,created_by:$.data.creator?.id||null}),A({last_name:$.data.last_name||"",first_name:$.data.first_name||"",account_id:null,title:$.data.title||"",department:$.data.department||"",email:$.data.email||"",work_phone:$.data.work_phone||"",mobile_phone_1:$.data.mobile_phone_1||"",mobile_phone_2:$.data.mobile_phone_2||"",notes:"",assigned_to:$.data.assigned_to?.id||null,created_by:$.data.creator?.id||null}),M({name:"Converted from Lead",account_id:null,primary_contact_id:null,stage:"Prospecting",probability:10,amount:0,currency:"PHP",description:"Initial deal from lead conversion.",assigned_to:$.data.assigned_to?.id||null,created_by:$.data.creator?.id||null})}catch($){console.error($)}};f.useEffect(()=>{e?(h(e),j(e.status||"New")):c&&F()},[c,e]);const D=async()=>{try{if(b==="Converted"&&d?.status?.toUpperCase()!=="QUALIFIED"){V.error("Lead must be Qualified before it can be converted.");return}const $=await ne.put(`/leads/${d.id}/update/status`,{status:b});V.success("Lead status updated successfully");const W={...d,status:$.data.status};h(W),i&&i(W),n&&n(),t&&t()}catch($){console.error($),V.error("Failed to update lead status")}},P=async $=>{const W={..._,assigned_to:$.assigned_to?.id,billing_address:$.address,shipping_address:$.address,created_by:$.creator?.id,industry:null,name:$.company_name,phone_number:$.work_phone,status:"Prospect",territory_id:$.territory?.id,website:""};console.log("Account data: ",W),console.log("Contact data: ",k),console.log("Deal data: ",E),console.log("Lead data: ",$);try{const Q=(await ne.post("/accounts/convertedLead",W)).data.id,le={...k,account_id:Q,assigned_to:$.assigned_to?.id,created_by:$.creator?.id,department:$.department,email:$.email,first_name:$.first_name,last_name:$.last_name,mobile_phone_1:$.mobile_phone_1,mobile_phone_2:$.mobile_phone_2,notes:$.notes,title:$.title,work_phone:$.work_phone},J=(await ne.post("/contacts/convertedLead",le)).data.id,se=()=>{switch(E.stage){case"PROSPECTING":return 10;case"QUALIFICATION":return 25;case"PROPOSAL":return 60;case"NEGOTIATION":return 80;case"CLOSED_WON":return 100;case"CLOSED_LOST":return 0;default:return 0}},ye=E.amount&&E.amount!==""?parseFloat(E.amount):0,Ce={...E,account_id:Q,assigned_to:$.assigned_to?.id,created_by:$.creator?.id,primary_contact_id:J,probability:se(),stage:"Prospecting"},ge=await ne.post("/deals/convertedLead",Ce),be=await ne.put(`/leads/convert/${$.id}`);i&&i(null),n(),V.success("Lead converted successfully!"),t()}catch(Z){console.error("Error during conversion:",Z);const Q=Z.response?.data?.detail||Z.message||"Failed to convert lead. Please try again.";V.error(Q)}},B=$=>{switch(($||"").toUpperCase()){case"NEW":return"bg-indigo-100 text-indigo-700";case"CONTACTED":return"bg-blue-100 text-blue-700";case"QUALIFIED":return"bg-green-100 text-green-700";case"CONVERTED":return"bg-emerald-100 text-emerald-700";case"LOST":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-700"}},G=$=>$.toString().toLowerCase().replace(/\b\w/g,W=>W.toUpperCase());return d?a.jsx(a.Fragment,{children:a.jsx("div",{className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-lg w-full max-w-full sm:max-w-6xl max-h-[90vh] overflow-y-auto hide-scrollbar relative box-border",children:[a.jsx("div",{className:"bg-tertiary w-full rounded-t-xl p-3 lg:p-3",children:a.jsxs("div",{className:"flex items-start justify-between w-full",children:[a.jsx("h1",{className:"lg:text-3xl text-xl text-white font-semibold text-center w-full",children:"Lead"}),a.jsx("button",{onClick:()=>{t?t():l(-1)},className:"text-gray-400 hover:text-white mt-1 cursor-pointer",children:a.jsx(Za,{size:25})})]})}),a.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between lg:flex-row lg:items-center lg:justify-between mt-3 gap-2 px-2 md:items-center lg:gap-4 md:mx-7 lg:mx-7",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[a.jsxs("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-800",children:[d.first_name," ",d.last_name]}),a.jsx("span",{className:`text-xs sm:text-sm font-medium px-2 sm:px-3 py-1 rounded-full whitespace-nowrap ${B(d.status)}`,children:G(d.status||"New")}),a.jsx("div",{className:"flex flex-col",children:a.jsx("button",{onClick:()=>P(d),disabled:!y,title:y?"Convert Lead":"Lead must be Qualified before converting",className:`px-3 sm:px-4 py-1.5 sm:py-2 rounded-md font-medium text-xs sm:text-sm transition focus:outline-none focus:ring-2
      ${y?"bg-green-600 hover:bg-green-700 text-white focus:ring-green-400":"bg-gray-200 text-gray-400 cursor-not-allowed"}
    `,children:"Convert"})})]}),a.jsx("div",{className:"flex flex-col sm:flex-row sm:space-x-3 space-y-2 sm:space-y-0",children:S&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{type:"button",onClick:()=>{s&&d&&s(d)},className:"inline-flex items-center justify-center w-full sm:w-auto bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 transition text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",children:[a.jsx(hn,{className:"mr-2"}),"Edit"]}),a.jsxs("button",{type:"button",onClick:()=>{r&&d&&r(d)},className:"inline-flex items-center justify-center w-full sm:w-auto px-4 py-2 rounded-md text-sm bg-orange-500 text-white hover:bg-orange-600 transition focus:outline-none focus:ring-2 focus:ring-orange-400",children:[a.jsx(Zt,{className:"mr-2"}),"Archive"]})]})})]}),a.jsx("div",{className:"border-b border-gray-200 my-5"}),a.jsxs("div",{className:"p-4 lg:p-4",children:[a.jsx("div",{className:"flex w-full bg-[#6A727D] text-white mt-1 overflow-x-auto mb-6",children:["Overview","Notes","Activities"].map($=>a.jsx("button",{onClick:()=>x($),className:`flex-1 min-w-[90px] px-4 py-2.5 text-xs sm:text-sm font-medium text-center transition-all duration-200 border-b-2
        ${p===$?"bg-paper-white text-[#6A727D] border-white":"text-white hover:bg-[#5c636d]"}`,children:$},$))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 items-start",children:[a.jsxs("div",{className:"lg:col-span-3",children:[p==="Overview"&&a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 md:p-8 border border-gray-200",children:a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4 sm:gap-6 text-sm text-gray-700",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Name:"}),a.jsxs("p",{children:[d.first_name," ",d.last_name||"N/A"]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Company:"}),a.jsx("p",{children:d.company_name||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Job Title:"}),a.jsx("p",{children:d.title||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Department:"}),a.jsx("p",{children:d.department||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Email:"}),a.jsx("p",{children:d.email||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Territory:"}),a.jsx("p",{children:d.territory?.name||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Assigned To:"}),a.jsx("p",{children:d.assigned_to?`${d.assigned_to.first_name} ${d.assigned_to.last_name}`:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created By:"}),a.jsx("p",{children:d.creator?`${d.creator.first_name} ${d.creator.last_name}`:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Work Phone:"}),a.jsx("p",{children:d.work_phone||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Mobile Phone 1:"}),a.jsx("p",{children:d.mobile_phone_1||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Mobile Phone 2:"}),a.jsx("p",{children:d.mobile_phone_2||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Source:"}),a.jsx("p",{children:d.source||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Address:"}),a.jsx("p",{children:d.address||"N/A"})]})]})}),p==="Notes"&&a.jsxs("div",{className:"mt-4 w-full",children:[a.jsx("div",{className:"flex flex-wrap items-center justify-between mb-4 gap-2",children:a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words",children:"Lead Note"})}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 shadow-sm break-words",children:[a.jsx("div",{className:"flex items-start justify-between",children:a.jsx("div",{children:a.jsx("p",{className:"text-sm font-medium text-gray-800 break-words",children:"Note"})})}),a.jsx("div",{className:"mt-3 text-sm text-gray-700 whitespace-pre-wrap break-words",children:d.notes||"No notes available."})]})]}),p==="Activities"&&a.jsxs("div",{className:"space-y-2 w-full h-full max-h-[50dvh] overflow-y-auto bg-gray-50 p-2 hide-scrollbar rounded-lg border border-gray-200 shadow-sm",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words border-b border-gray-300 py-2",children:"Related Activities"}),a.jsxs("div",{className:"space-y-2 text-sm",children:[o.tasks&&o.tasks.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>w(N==="tasks"?null:"tasks"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Qt,{className:"text-blue-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Tasks (",o.tasks.length,")"]})]}),N==="tasks"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),N==="tasks"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:o.tasks.map(($,W)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>l("/group-manager/tasks",{state:{taskID:$.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-blue-600 mt-1",children:a.jsx(Qt,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:$.subject||$.title||"Task"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:$.description||"No description"}),$.assigned_to&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Assigned:"," ",$.assigned_to.first_name," ",$.assigned_to.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:OT($.due_date||$.created_at)})]},`task-${W}`))})]}),o.meetings&&o.meetings.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>w(N==="meetings"?null:"meetings"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Pt,{className:"text-green-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Meetings (",o.meetings.length,")"]})]}),N==="meetings"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),N==="meetings"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:o.meetings.map(($,W)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>l("/group-manager/meetings",{state:{meetingID:$.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-green-600 mt-1",children:a.jsx(Pt,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:$.subject||$.title||"Meeting"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:$.description||$.location||"No description"}),$.host&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Host: ",$.host.first_name," ",$.host.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:OT($.start_time||$.created_at)})]},`meeting-${W}`))})]}),o.calls&&o.calls.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>w(N==="calls"?null:"calls"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(It,{className:"text-purple-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Calls (",o.calls.length,")"]})]}),N==="calls"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),N==="calls"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:o.calls.map(($,W)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>l("/group-manager/calls",{state:{callID:$.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-purple-600 mt-1",children:a.jsx(It,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:$.subject||$.title||"Call"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:$.direction||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:OT($.call_time||$.created_at)})]},`call-${W}`))})]}),(!o||(!o.tasks||o.tasks.length===0)&&(!o.meetings||o.meetings.length===0)&&(!o.calls||o.calls.length===0)&&(!o.quotes||o.quotes.length===0)&&(!o.deals||o.deals.length===0)&&(!o.contacts||o.contacts.length===0))&&a.jsx("div",{className:"text-center py-8 text-gray-500",children:a.jsx("p",{children:"No related activities found for this account."})})]})]})]}),a.jsxs("div",{className:"flex flex-col gap-4",children:[a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Quick Actions"}),a.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[a.jsxs("button",{onClick:()=>{d&&l("/group-manager/calls",{state:{openCallModal:!0,initialCallData:{subject:d.title?`Call regarding ${d.title}`:`Call with ${d.first_name} ${d.last_name}`,relatedType1:"Lead",relatedTo1:String(d.id),relatedType2:null,relatedTo2:null,assigned_to:d.assigned_to?.id?String(d.assigned_to.id):"",direction:"Outgoing",status:"Planned"}}})},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(It,{className:"text-gray-600 w-4 h-4"}),"Schedule Call"]}),a.jsxs("button",{type:"button",onClick:()=>{if(!d?.email){alert("No email address available");return}const $=encodeURIComponent(d.email),W=encodeURIComponent(""),Z=encodeURIComponent(""),Q=`mailto:${$}?subject=${W}&body=${Z}`;window.location.href=Q},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(sn,{className:"text-gray-600 w-4 h-4"}),"Send E-mail"]}),a.jsxs("button",{className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",onClick:()=>{d&&l("/group-manager/meetings",{state:{openMeetingModal:!0,initialMeetingData:{subject:d.title?`Meeting regarding ${d.title}`:`Meeting with ${d.first_name||""} ${d.last_name||""}`.trim(),relatedType1:"Lead",relatedTo1:String(d.id),relatedType2:null,relatedTo2:null,assignedTo:d.assigned_to?.id?String(d.assigned_to.id):"",status:"Planned"}}})},children:[a.jsx(Pt,{className:"text-gray-600 w-4 h-4"}),"Book Meeting"]}),a.jsxs("button",{onClick:()=>{d&&l("/group-manager/tasks",{state:{openTaskModal:!0,initialTaskData:{subject:d.title?`Follow up on ${d.title}`:`Follow up with ${d.first_name||""} ${d.last_name||""}`.trim(),relatedType1:"Lead",relatedTo1:String(d.id),relatedType2:null,relatedTo2:null,assignedTo:d.assigned_to?.id?String(d.assigned_to.id):"",priority:"NORMAL",status:"Not Started"}}})},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(Qt,{className:"text-gray-600 w-4 h-4"}),"Tasks"]})]})]}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm w-full",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Status"}),a.jsxs("select",{className:"border border-gray-200 rounded-md px-2 sm:px-3 py-1.5 w-full text-sm mb-2 focus:ring-2 focus:ring-indigo-500 outline-none",value:b,onChange:$=>j($.target.value),children:[a.jsx("option",{value:"New",children:"New"}),a.jsx("option",{value:"Contacted",children:"Contacted"}),a.jsx("option",{value:"Qualified",children:"Qualified"}),d?.status?.toUpperCase()==="QUALIFIED"&&a.jsx("option",{value:"Converted",children:"Converted"}),a.jsx("option",{value:"Lost",children:"Lost"})]}),a.jsx("button",{onClick:D,disabled:b===d.status,className:`w-full py-1.5 rounded-md text-sm transition focus:outline-none focus:ring-2 ${b===d.status?"bg-gray-400 cursor-not-allowed text-white":"bg-gray-900 text-white hover:bg-gray-800 focus:ring-gray-400"}`,children:"Update"})]})]})]})]})]})})}):null}const UWe=oh.all(),MT=UWe.map((e,t)=>({code:`+${e.countryCallingCode}`,name:e.countryCode,id:`${e.countryCallingCode}-${e.countryCode}-${t}`})),BWe=e=>e.toString().toLowerCase().replace(/\b\w/g,t=>t.toUpperCase()),HWe=e=>{switch(e.toUpperCase()){case"NEW":return"bg-indigo-100 text-indigo-700";case"CONTACTED":return"bg-blue-100 text-blue-700";case"QUALIFIED":return"bg-green-100 text-green-700";case"CONVERTED":return"bg-emerald-100 text-emerald-700";case"LOST":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-700"}},IT={first_name:"",last_name:"",company_name:"",title:"",department:"",email:"",work_ccode:"+63",work_phone:"",m1_ccode:"+63",mobile_phone_1:"",m2_ccode:"+63",mobile_phone_2:"",address:"",notes:"",source:"",territory_id:null,lead_owner:null,status:"New"};function qWe(){const e=Et(),{leadID:t}=Wo(),{user:n}=Gt();Bs();const[s,r]=f.useState(null),[i,o]=f.useState(!1),[l,c]=f.useState(null),[u,d]=f.useState(null),[h,p]=f.useState([]),[x,b]=f.useState(!1),[j,y]=f.useState(""),[N,w]=f.useState("Filter by Status"),[S,_]=f.useState(1),[T,k]=f.useState(10),[A,E]=f.useState(IT),[M,F]=f.useState(!1),[D,P]=f.useState(null),[B,G]=f.useState(!1),[$,W]=f.useState(null),[Z,Q]=f.useState(!1),[le,we]=f.useState({}),[J,se]=f.useState(new Set),[ye,Ce]=f.useState(!1),[ge,be]=f.useState(null);f.useRef(null);const[me,Ae]=f.useState(!1),[pe,Ie]=f.useState(null),[xe,he]=f.useState({name:"",website:"",countryCode:"+63",phone_number:"",combinedPhoneNumbers:"",billing_address:"",shipping_address:"",industry:"",status:"Prospect",territory_id:null,assigned_to:null,created_by:null}),[Re,Ee]=f.useState({last_name:"",first_name:"",account_id:null,title:"",department:"",email:"",work_phone:"",mobile_phone_1:"",mobile_phone_2:"",notes:"",assigned_to:null,created_by:null}),[He,Ke]=f.useState({name:"Converted from Lead",account_id:null,primary_contact_id:null,stage:"PROSPECTING",probability:10,amount:0,currency:"PHP",description:"Initial deal from lead conversion.",assigned_to:null,created_by:null});f.useEffect(()=>{document.title="Leads | Sari-Sari CRM"},[]);const st=async()=>{try{const H=await ne.get("/leads/getUsers");c(H.data)}catch(H){console.error(`Error fetching users: ${H}`)}},it=async()=>{b(!0);try{const H=await ne.get("/leads/admin/getLeads");p(H.data),console.log(H.data)}catch(H){console.error(`Error fetching leads: ${H}`)}finally{b(!1)}};f.useEffect(()=>{st(),it()},[]),f.useEffect(()=>{if(t&&h.length>0&&!i&&!M){const H=h.find(te=>te.id===Number(t));H&&r(H)}else!t&&!s&&r(null)},[t,h,i,M]),f.useEffect(()=>{if(pe){const te=(U=>{if(!U)return{code:"+63",number:""};const de=U.match(/^(\+\d+)\s(.+)$/);if(de)return{code:de[1],number:de[2]};if(U.startsWith("+")){const Te=U.match(/^(\+\d{1,3})/);if(Te)return{code:Te[1],number:U.substring(Te[1].length).trim()}}return{code:"+63",number:U}})(pe.work_phone),q=[];pe.work_phone&&q.push(`Work: ${pe.work_phone}`),pe.mobile_phone_1&&q.push(`Mobile 1: ${pe.mobile_phone_1}`),pe.mobile_phone_2&&q.push(`Mobile 2: ${pe.mobile_phone_2}`);const Y=q.length>0?q.join(" | "):"";he({name:pe.company_name||"",website:"",countryCode:te.code,phone_number:te.number,combinedPhoneNumbers:Y,billing_address:pe.address||"",shipping_address:pe.address||"",industry:"",status:"Prospect",territory_id:pe.assigned_to?.territory?.id||null,assigned_to:pe.assigned_to?.id||null,created_by:pe.creator?.id||null}),Ee({last_name:pe.last_name||"",first_name:pe.first_name||"",account_id:null,title:pe.title||"",department:pe.department||"",email:pe.email||"",work_phone:pe.work_phone||"",mobile_phone_1:pe.mobile_phone_1||"",mobile_phone_2:pe.mobile_phone_2||"",notes:pe.notes||"",assigned_to:pe.assigned_to?.id||null,created_by:pe.creator?.id||null}),Ke({name:"Converted from Lead",account_id:null,primary_contact_id:null,stage:"PROSPECTING",probability:10,amount:0,currency:"PHP",description:"Initial deal from lead conversion.",assigned_to:pe.assigned_to?.id||null,created_by:pe.creator?.id||null})}},[pe]);const ot=H=>y(H.target.value),rt=f.useMemo(()=>{const H=j.trim().toLowerCase(),te=N.trim().toUpperCase();let q=h.filter(Y=>{const U=Y?.status!=="Inactive",de=[Y?.first_name,Y?.last_name,Y?.company_name,Y?.title,Y?.email,Y?.work_phone,Y?.assigned_to?`${Y.assigned_to.first_name} ${Y.assigned_to.last_name}`:""],Te=H===""||de.some(Oe=>Oe==null||Oe===""?!1:Oe.toString().toLowerCase().includes(H));let ie=!1;return te==="FILTER BY STATUS"?ie=(Y.status?Y.status.toUpperCase():"")!=="CONVERTED":ie=(Y.status?Y.status.toUpperCase():"")===te,Te&&ie&&U});return q.sort((Y,U)=>{const de=new Date(Y.created_at).getTime();return new Date(U.created_at).getTime()-de}),q},[h,j,N]),at=Math.max(1,Math.ceil(rt.length/T)||1);f.useEffect(()=>{_(1)},[j,N,T]),f.useEffect(()=>{_(H=>{const te=Math.max(1,Math.ceil(rt.length/T)||1);return H>te?te:H})},[rt.length,T]);const Je=f.useMemo(()=>{const H=(S-1)*T;return rt.slice(H,H+T)},[rt,S,T]),Fe=()=>_(H=>Math.max(H-1,1)),Ue=()=>_(H=>Math.min(H+1,at)),Ne=f.useCallback(async H=>{try{const te=await ne.get(`/activities/lead/${H}`);we(te.data&&typeof te.data=="object"?te.data:{})}catch(te){console.error(te),te.response?.status===404&&(console.warn("No activities found for this account."),we({}))}},[]),ze=H=>{r(H),Ne(H.id)},je=()=>{r(null),t&&e("/admin/leads",{replace:!0})},ve=()=>{o(!1),E(IT),F(!1),P(null),G(!1),d(null),sessionStorage.removeItem("editLeadData")},z=H=>{H.target.id==="modalBackdrop"&&ve()},K=()=>{E(IT),F(!1),P(null),d(null),o(!0)},ue=H=>{if(!H){console.error("handleEditClick: lead is null or undefined");return}console.log("handleEditClick called with lead:",H),console.log("Current state - leadID:",t,"selectedLead:",s,"showModal:",i);const te=Te=>{if(!Te)return{code:"+63",number:""};const ie=Te.match(/^(\+\d+)\s(.+)$/);return ie?{code:ie[1],number:ie[2]}:{code:"+63",number:Te}},q=te(H.work_phone),Y=te(H.mobile_phone_1),U=te(H.mobile_phone_2);let de="";if(H.assigned_to){de=String(H.assigned_to.id);const Te=l?.find(ie=>ie.id===H.assigned_to.id);d(Te)}E({first_name:H.first_name||"",last_name:H.last_name||"",company_name:H.company_name||"",title:H.title||"",department:H.department||"",email:H.email||"",work_ccode:q.code,work_phone:q.number,m1_ccode:Y.code,mobile_phone_1:Y.number,m2_ccode:U.code,mobile_phone_2:U.number,address:H.address||"",notes:H.notes||"",source:H.source||"",territory_id:H.territory?.id||null,lead_owner:de,status:H.status||"New"}),F(!0),P(H.id),s?(console.log("Coming from detail view - closing detail modal and showing edit form"),r(null),o(!0)):(console.log("Already in list view - showing modal"),o(!0))},re=H=>{if(!H){console.error("handleArchive: lead is null or undefined");return}const te=`${H.first_name} ${H.last_name}`||"this lead";W({title:"Archive Lead",message:a.jsxs("span",{children:["Are you sure you want to archive"," ",a.jsx("span",{className:"font-semibold",children:te}),"? You can restore it later if needed."]}),confirmLabel:"Archive Lead",cancelLabel:"Cancel",variant:"archive",action:{type:"archive",targetId:H.id,name:te}})},Le=H=>{const te=Je.find(q=>q.id===H);te&&te.creator?.id===n?.id&&se(q=>{const Y=new Set(q);return Y.has(H)?Y.delete(H):Y.add(H),Y})},De=()=>{const H=Je.filter(te=>te.creator?.id===n?.id);J.size===H.length&&H.length>0?se(new Set):se(new Set(H.map(te=>te.id)))},Qe=()=>{if(J.size===0)return;const H=J.size;W({title:"Archive Leads",message:a.jsxs("span",{children:["Are you sure you want to archive"," ",a.jsx("span",{className:"font-semibold",children:H})," lead",H!==1?"s":"","? You can restore them later if needed."]}),confirmLabel:`Archive ${H} Lead${H!==1?"s":""}`,cancelLabel:"Cancel",variant:"archive",action:{type:"bulk-archive",targetIds:Array.from(J),count:H}})},tt=H=>{const{name:te,value:q}=H.target;if(E(Y=>({...Y,[te]:q})),te==="lead_owner"){const Y=l.find(U=>U.id===parseInt(q));d(Y)}},[Me,et]=f.useState(!1),yt=H=>{if(H.preventDefault(),et(!0),!A.last_name?.trim()){V.error("Last name is required.");return}if(!A.email?.trim()){V.error("Email is required.");return}if(!A.email.includes("@")){V.error("Email must contain '@'.");return}if(!A.lead_owner){V.error("Please assign a lead owner.");return}const te={...A,territory_id:A.territory_id?parseInt(A.territory_id):null,lead_owner:parseInt(A.lead_owner),work_phone:`${A.work_ccode} ${A.work_phone}`,mobile_phone_1:`${A.m1_ccode} ${A.mobile_phone_1}`,mobile_phone_2:`${A.m2_ccode} ${A.mobile_phone_2}`},q=M&&D?"update":"create",Y=`${A.first_name} ${A.last_name}`;W({title:q==="create"?"Confirm New Lead":"Confirm Update",message:q==="create"?a.jsxs("span",{children:["Are you sure you want to create a new lead for"," ",a.jsx("span",{className:"font-semibold",children:Y}),"?"]}):a.jsxs("span",{children:["Save changes to ",a.jsx("span",{className:"font-semibold",children:Y}),"?"]}),confirmLabel:q==="create"?"Create Lead":"Update Lead",cancelLabel:"Cancel",variant:"primary",action:{type:q,payload:te,targetId:D||null,name:Y}})},_t=async()=>{if(!$?.action){W(null);return}const{action:H}=$,{type:te,payload:q,targetId:Y,name:U,targetIds:de,count:Te}=H;console.log(q),Q(!0);try{if(te==="create")G(!0),await ne.post("/leads/create",q),V.success(`Lead "${U}" created successfully.`),ve(),await it();else if(te==="update"){if(!Y)throw new Error("Missing lead identifier for update.");G(!0);const ie=await ne.put(`/leads/${Y}`,q);V.success(`Lead "${U}" updated successfully.`),s&&s.id===Y&&r(null),ve(),await it()}else if(te==="archive"){if(!Y)throw new Error("Missing lead identifier for archiving.");const ie=s?.id;be(Y),await ne.put(`/leads/${Y}`,{status:"Inactive"}),V.success(`Lead "${U}" archived successfully.`),await it(),ie===Y&&r(null)}else if(te==="bulk-archive"){if(!de||de.length===0)throw new Error("Missing lead identifiers for bulk archiving.");Ce(!0),await Promise.all(de.map(ie=>ne.put(`/leads/${ie}`,{status:"Inactive"}))),V.success(`${Te} lead${Te!==1?"s":""} archived successfully.`),se(new Set),await it(),r(null)}}catch(ie){console.error(ie);const Oe=te==="create"?"Failed to create lead. Please review the details and try again.":te==="update"?"Failed to update lead. Please review the details and try again.":te==="bulk-archive"?"Failed to archive leads. Please try again.":"Failed to archive lead. Please try again.",X=ie.response?.data?.detail||Oe;V.error(X)}finally{(te==="create"||te==="update")&&G(!1),te==="archive"&&be(null),te==="bulk-archive"&&Ce(!1),te!=="edit"&&(Q(!1),W(null))}},Ct=()=>{Z||W(null)},jt=h.filter(H=>H.status==="New").length,At=h.filter(H=>H.status==="Contacted").length,Ge=h.filter(H=>H.status==="Qualified").length,Be=h.filter(H=>H.status==="Converted").length,ce=h.filter(H=>H.status==="Lost").length,fe=[{title:"New",value:jt,icon:rn,color:"text-indigo-600",bgColor:"bg-indigo-100"},{title:"Contacted",value:At,icon:It,color:"text-blue-600",bgColor:"bg-blue-100"},{title:"Qualified",value:Ge,icon:La,color:"text-green-600",bgColor:"bg-green-100"},{title:"Converted",value:Be,icon:ec,color:"text-emerald-600",bgColor:"bg-emerald-100"},{title:"Lost",value:ce,icon:Yn,color:"text-red-600",bgColor:"bg-red-100"}];return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[x&&a.jsx(qt,{message:"Loading leads..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h1",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(rn,{className:"mr-2 text-blue-600"}),"Leads"]}),a.jsxs("div",{className:"flex justify-center lg:justify-end gap-3 w-full sm:w-auto",children:[a.jsxs("button",{onClick:()=>{V.info("Download functionality coming soon")},className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 rounded-md hover:bg-gray-800 text-sm sm:text-base self-end sm:self-auto cursor-pointer",children:[a.jsx(Vo,{className:"mr-2"})," Download"]}),a.jsxs("button",{onClick:()=>{K(),et(!1)},className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 rounded-md hover:bg-gray-800 text-sm sm:text-base self-end sm:self-auto cursor-pointer",children:[a.jsx(aa,{className:"mr-2"})," Add Lead"]})]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 xl:grid-cols-5 gap-4 mb-6 w-full break-words overflow-hidden lg:overflow-visible",children:fe.map(H=>a.jsx(WWe,{...H},H.title))}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search leads",value:j,onChange:ot,className:"focus:outline-none text-base w-full"})]}),a.jsx("div",{className:"w-full lg:w-1/4",children:a.jsxs("select",{value:N,onChange:H=>w(H.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{value:"Filter by Status",children:"Filter by Status"}),a.jsx("option",{value:"New",children:"New"}),a.jsx("option",{value:"Contacted",children:"Contacted"}),a.jsx("option",{value:"Qualified",children:"Qualified"}),a.jsx("option",{value:"Converted",children:"Converted"}),a.jsx("option",{value:"Lost",children:"Lost"})]})})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[500px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 text-sm tracking-wide font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 w-12",children:a.jsx("input",{type:"checkbox",checked:J.size>0&&J.size===Je.filter(H=>H.creator?.id===n?.id).length&&Je.filter(H=>H.creator?.id===n?.id).length>0,onChange:De,className:"w-4 h-4 cursor-pointer"})}),a.jsx("th",{className:"py-3 px-4",children:"Name"}),a.jsx("th",{className:"py-3 px-4",children:"Company"}),a.jsx("th",{className:"py-3 px-4",children:"Job Title"}),a.jsx("th",{className:"py-3 px-4",children:"Email"}),a.jsx("th",{className:"py-3 px-4",children:"Assigned To"}),a.jsx("th",{className:"py-3 px-4",children:"Status"}),a.jsx("th",{className:"py-3 px-4 w-12",children:J.size>0&&a.jsx("button",{onClick:Qe,className:"text-orange-500 hover:text-orange-700 transition",title:"Archive selected leads",disabled:ye,children:a.jsx(Zt,{size:18})})})]})}),a.jsx("tbody",{children:rt.length>0?Je.map(H=>a.jsxs("tr",{className:"hover:bg-gray-50 text-sm cursor-pointer",children:[a.jsx("td",{className:"py-3 px-4",children:n?.id===H.creator?.id&&a.jsx("input",{type:"checkbox",checked:J.has(H.id),onChange:te=>{te.stopPropagation(),Le(H.id)},className:"w-4 h-4 cursor-pointer"})}),a.jsx("td",{className:"py-3 px-4 align-top",onClick:()=>ze(H),children:a.jsxs("div",{className:"font-medium text-blue-600 hover:underline break-all text-sm",children:[H.first_name," ",H.last_name]})}),a.jsx("td",{className:"py-3 px-4 align-top",onClick:()=>ze(H),children:a.jsx("div",{className:"font-medium text-gray-800 text-sm leading-tight",children:H.company_name||"--"})}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",onClick:()=>ze(H),children:H.title||"--"}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",onClick:()=>ze(H),children:H.email||"--"}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",onClick:()=>ze(H),children:H.assigned_to?`${H.assigned_to.first_name} ${H.assigned_to.last_name}`:"--"}),a.jsx("td",{className:"py-3 px-4",onClick:()=>ze(H),children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium whitespace-nowrap ${HWe(H.status||"New")}`,children:BWe(H.status||"New")})}),a.jsx("td",{className:"py-3 px-4"})]},H.id)):a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:8,children:"No leads found."})})})]})}),a.jsx(ca,{className:"mt-4",totalItems:rt.length,pageSize:T,currentPage:S,onPrev:Fe,onNext:Ue,onPageSizeChange:k,label:"leads"}),i&&a.jsx("div",{id:"modalBackdrop",onClick:z,className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-full sm:max-w-3xl rounded-2xl shadow-lg p-4 sm:p-6 md:p-8 relative border border-gray-200 overflow-y-auto max-h-[90vh] hide-scrollbar",onClick:H=>H.stopPropagation(),children:[a.jsx("button",{onClick:()=>{ve(),et(!1)},className:"absolute top-4 right-4 text-gray-500 hover:text-black transition",children:a.jsx(ea,{size:22})}),a.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800 mb-4 sm:mb-6 flex items-center justify-center",children:M?"Edit Lead":"Add New Lead"}),a.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 text-sm",children:[a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"First Name"}),a.jsx("input",{type:"text",name:"first_name",value:A.first_name,onChange:tt,placeholder:"Joe",className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:["Last Name ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",placeholder:"Smith",name:"last_name",value:A.last_name,onChange:tt,required:!0,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border
                      ${Me&&!A.last_name?.trim()?"border-red-400 focus:ring-red-400":"border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"}
                  focus:ring-2`})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Company "}),a.jsx("input",{type:"text",placeholder:"ABC Company",name:"company_name",value:A.company_name,onChange:tt,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Job Title"}),a.jsx("input",{type:"text",placeholder:"ABC Agenda",name:"title",value:A.title,onChange:tt,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Department"}),a.jsx("input",{type:"text",placeholder:"Sales",name:"department",value:A.department,onChange:tt,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:["Email",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"email",placeholder:"abc@gmail.com",name:"email",value:A.email,onChange:tt,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border
                       ${Me&&!A.email?.trim()?"border-red-400 focus:ring-red-400":"border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"}
                      focus:ring-2`})]}),a.jsxs("div",{className:"flex flex-col col-span-1 md:col-span-2 lg:col-span-1",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Work Phone"}),a.jsxs("div",{className:"w-full border border-gray-300 rounded-md focus-within:ring-2 focus-within:ring-blue-400 outline-none flex flex-row gap-1",children:[a.jsx("select",{name:"work_ccode",value:A.work_ccode,onChange:tt,className:"outline-none cursor-pointer py-1.5 px-2 border-r border-gray-400 text-sm",children:MT.map(H=>a.jsx("option",{value:H.code,children:H.code},H.id))}),a.jsx("input",{type:"text",placeholder:"9----------",name:"work_phone",value:A.work_phone,onChange:tt,className:"w-full outline-none px-2 py-1.5 text-sm"})]})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Mobile Phone 1"}),a.jsxs("div",{className:"w-full border border-gray-300 rounded-md focus-within:ring-2 focus-within:ring-blue-400 outline-none flex flex-row gap-1",children:[a.jsx("select",{name:"m1_ccode",value:A.m1_ccode,onChange:tt,className:"outline-none cursor-pointer py-1.5 px-2 border-r border-gray-400 text-sm",children:MT.map(H=>a.jsx("option",{value:H.code,children:H.code},H.id))}),a.jsx("input",{type:"text",placeholder:"9----------",name:"mobile_phone_1",value:A.mobile_phone_1,onChange:tt,className:"w-full outline-none px-2 py-1.5 text-sm"})]})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Mobile Phone 2"}),a.jsxs("div",{className:"w-full border border-gray-300 rounded-md focus-within:ring-2 focus-within:ring-blue-400 outline-none flex flex-row gap-1",children:[a.jsx("select",{name:"m2_ccode",value:A.m2_ccode,onChange:tt,className:"outline-none cursor-pointer py-1.5 px-2 border-r border-gray-400 text-sm",children:MT.map(H=>a.jsx("option",{value:H.code,children:H.code},H.id))}),a.jsx("input",{type:"text",placeholder:"9----------",name:"mobile_phone_2",value:A.mobile_phone_2,onChange:tt,className:"w-full outline-none px-2 py-1.5 text-sm"})]})]}),a.jsxs("div",{className:"flex flex-col col-span-1 sm:col-span-2 lg:col-span-3",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Address"}),a.jsx("input",{type:"text",name:"address",value:A.address,onChange:tt,placeholder:"Street No., Street Name, City, State/Province, Postal Code",className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"})]}),a.jsxs("div",{className:"flex flex-col col-span-1 md:col-span-2 lg:col-span-1",children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:["Assign To ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("div",{className:`w-full rounded-lg ${Me&&!A.lead_owner?"border border-red-400":"border border-gray-300"}`,children:a.jsx(VWe,{items:Array.isArray(l)?l:[],value:A.lead_owner??"",placeholder:"Search a user...",getLabel:H=>`${H.first_name} ${H.last_name}`,onChange:H=>{const te=l.find(Y=>String(Y.id)===String(H));d(te);let q=null;te&&te.assigned_territory&&te.assigned_territory.length===1&&(q=te.assigned_territory[0].id),E(Y=>({...Y,lead_owner:H,territory_id:q}))}})})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Territory"}),a.jsxs("select",{name:"territory_id",value:A.territory_id||"",onChange:tt,disabled:!u||!u.assigned_territory||u.assigned_territory.length===0,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm bg-white focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100 disabled:text-gray-500",children:[a.jsx("option",{value:"",disabled:!0,children:u?u.assigned_territory&&u.assigned_territory.length>0?"Select Territory":"No territories assigned to this user":"Select a user first"}),u&&u.assigned_territory&&u.assigned_territory.map(H=>a.jsx("option",{value:H.id,children:H.name},H.id))]})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Source"}),a.jsxs("select",{className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none",defaultValue:"",name:"source",value:A.source,onChange:tt,children:[a.jsx("option",{value:"",disabled:!0,children:"Select Source"}),a.jsx("option",{value:"Website",children:"Website"}),a.jsx("option",{value:"Referral",children:"Referral"}),a.jsx("option",{value:"Cold call",children:"Cold call"}),a.jsx("option",{value:"Event",children:"Event"}),a.jsx("option",{value:"Other",children:"Other"})]})]}),a.jsxs("div",{className:"flex flex-col col-span-1 sm:col-span-2 lg:col-span-3",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Notes"}),a.jsx("textarea",{placeholder:"Additional details...",name:"notes",value:A.notes,onChange:tt,rows:3,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none resize-none"})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-2 mt-4 col-span-1 sm:col-span-2 lg:col-span-3",children:[a.jsx("button",{type:"button",onClick:()=>{ve(),et(!1)},className:"w-full sm:w-auto px-4 py-2 text-white bg-red-400 border border-red-300 rounded hover:bg-red-500 transition disabled:opacity-70",disabled:B||Z,children:"Cancel"}),a.jsx("button",{type:"submit",onClick:yt,className:"w-full sm:w-auto px-4 py-2 text-white border border-tertiary bg-tertiary rounded hover:bg-secondary transition disabled:opacity-70",disabled:B||Z,children:B||Z?"Processing...":M?"Update Lead":"Save Lead"})]})]})]})}),$&&a.jsx(GWe,{open:!0,title:$.title,message:$.message,confirmLabel:$.confirmLabel,cancelLabel:$.cancelLabel,variant:$.variant,onConfirm:_t,onCancel:Ct,loading:Z}),s&&!i&&!M&&a.jsx(Pee,{relatedActs:le,lead:s,onBack:je,fetchLeads:it,setSelectedLead:r,onEdit:ue,onArchive:re})]})}function GWe({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o=!1,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":i==="archive"?"bg-orange-500 hover:bg-orange-600 border border-orange-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsx("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${u}`,disabled:o,children:o?"Processing...":s})]})]})})}function WWe({icon:e,title:t,value:n,color:s="text-blue-600",bgColor:r="bg-blue-100",onClick:i}){const o=()=>{typeof i=="function"?i():console.log(`Clicked: ${t}`)};return a.jsxs("div",{className:"flex items-center p-4 bg-white rounded-xl shadow-md border border-gray-200 transition-all duration-300",onClick:o,children:[a.jsx("div",{className:`flex-shrink-0 p-3 rounded-full ${r} ${s} mr-4`,children:e?a.jsx(e,{size:22}):null}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:t}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:n})]})]})}function VWe({items:e=[],value:t="",onChange:n,getLabel:s,placeholder:r="Search...",disabled:i=!1,maxRender:o=200}){const[l,c]=f.useState(!1),[u,d]=f.useState(""),h=f.useRef(null),p=e.find(j=>String(j.id)===String(t)),x=p?s(p):"",b=f.useMemo(()=>{const j=u.trim().toLowerCase();return(j?e.filter(N=>(s(N)||"").toLowerCase().includes(j)):e).slice(0,o)},[e,u,s,o]);return f.useEffect(()=>{const j=y=>{h.current&&!h.current.contains(y.target)&&c(!1)};return document.addEventListener("mousedown",j),()=>document.removeEventListener("mousedown",j)},[]),f.useEffect(()=>{l||d("")},[l]),a.jsxs("div",{ref:h,className:"relative w-full",children:[a.jsx("input",{disabled:i,value:l?u:x,placeholder:r,onFocus:()=>!i&&c(!0),onChange:j=>{d(j.target.value),l||c(!0)},className:"w-full rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100"}),l&&!i&&a.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg overflow-hidden",children:[a.jsx("div",{className:"max-h-56 overflow-y-auto",children:b.length>0?b.map(j=>{const y=String(j.id),N=s(j),w=String(t)===y;return a.jsx("button",{type:"button",onClick:()=>{n(y),c(!1)},className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-50 ${w?"bg-blue-50":""}`,children:N||"--"},y)}):a.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No results"})}),e.length>o&&a.jsxs("div",{className:"px-3 py-2 text-[11px] text-gray-400 border-t",children:["Showing first ",o," results  keep typing to narrow."]})]})]})}const nv={accountName:"Josh Inc.",companyNumber:"09135007323",companyWebsite:"joshenc.com",industry:"Agriculture",billingAddress:"#1 Pilar Las Pinas City",shippingAddress:"#3 BNW ASS-CBN",firstName:"Josh",lastName:"Vergara",department:"Administration",title:"CEO",workPhone:"09253677323",email:"josh@joshinc.com",mobile1:"09253677323",mobile2:"0907452874",dealName:"Josh Deal",dealAmount:"60.00",stage:"Prospecting",territory:"Cavite",description:"Initial lead conversion deal.",dealTitle:"New Client Agreement"},ns=({label:e,value:t,name:n,className:s=""})=>a.jsxs("div",{className:`flex flex-col ${s}`,children:[a.jsx("label",{className:"text-xs text-gray-500 mb-1",children:e}),a.jsx("input",{type:"text",name:n,defaultValue:t,readOnly:!0,className:"w-full border border-gray-300 p-2 rounded-lg text-sm focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 outline-none bg-gray-50"})]}),YWe=({data:e})=>a.jsxs("div",{className:"space-y-6 p-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-700",children:"Account Information"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsx(ns,{label:"Company Number",name:"companyNumber",value:e.companyNumber}),a.jsx(ns,{label:"Company Website",name:"companyWebsite",value:e.companyWebsite}),a.jsx(ns,{label:"Industry",name:"industry",value:e.industry})]}),a.jsx(ns,{label:"Billing Address",name:"billingAddress",value:e.billingAddress,className:"col-span-3"}),a.jsx(ns,{label:"Shipping Address",name:"shippingAddress",value:e.shippingAddress,className:"col-span-3"})]}),QWe=({data:e})=>a.jsxs("div",{className:"space-y-6 p-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-700",children:"Contact Information"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx(ns,{label:"First Name",name:"firstName",value:e.firstName}),a.jsx(ns,{label:"Last Name",name:"lastName",value:e.lastName}),a.jsx(ns,{label:"Department",name:"department",value:e.department}),a.jsx(ns,{label:"Title",name:"title",value:e.title}),a.jsx(ns,{label:"Work Phone",name:"workPhone",value:e.workPhone}),a.jsx(ns,{label:"Email",name:"email",value:e.email}),a.jsx(ns,{label:"Mobile Number 1",name:"mobile1",value:e.mobile1}),a.jsx(ns,{label:"Mobile Number 2",name:"mobile2",value:e.mobile2})]})]}),KWe=({data:e})=>a.jsxs("div",{className:"space-y-6 p-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-700",children:"Deal"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx(ns,{label:"Deal Name",name:"dealName",value:e.dealName}),a.jsxs("div",{className:"flex",children:[a.jsx(ns,{label:"Deal Amount",name:"dealAmount",value:e.dealAmount,className:"flex-grow"}),a.jsx("div",{className:"flex flex-col justify-end ml-1",children:a.jsx("span",{className:"text-sm font-medium text-gray-600 border border-gray-300 bg-gray-100 p-2 rounded-r-lg h-10 flex items-center",children:"PHP"})})]}),a.jsx(ns,{label:"Stage",name:"stage",value:e.stage}),a.jsx(ns,{label:"Territory",name:"territory",value:e.territory})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx(ns,{label:"Description",name:"description",value:e.description}),a.jsx(ns,{label:"Title",name:"dealTitle",value:e.dealTitle})]})]});function XWe({isOpen:e,onClose:t}){const[n,s]=f.useState(1),r=3;if(!e)return null;const i=()=>{n<r?s(n+1):(t(),s(1))},o=()=>{n>1&&s(n-1)},l=[{id:1,name:"Account"},{id:2,name:"Contact"},{id:3,name:"Deal"}],c=()=>{switch(n){case 1:return a.jsx(YWe,{data:nv});case 2:return a.jsx(QWe,{data:nv});case 3:return a.jsx(KWe,{data:nv});default:return null}};return a.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-[800px] h-[600px] overflow-hidden flex flex-col",children:[a.jsxs("div",{className:"p-6 border-b border-gray-200 flex justify-between items-start",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wider",children:"Convert Lead"}),a.jsx("h1",{className:"text-2xl font-bold text-gray-900 mt-1",children:nv.accountName})]}),a.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition",children:a.jsx($N,{className:"w-6 h-6"})})]}),a.jsx("div",{className:"flex border-b border-gray-200 bg-gray-50",children:l.map(u=>a.jsx("button",{onClick:()=>s(u.id),className:`flex-1 py-3 px-6 text-sm font-medium transition ${n===u.id?"bg-white text-gray-800 border-b-2 border-indigo-600":"bg-gray-600 text-white hover:bg-gray-700"}`,children:u.name},u.id))}),a.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:c()}),a.jsxs("div",{className:"p-4 border-t border-gray-200 bg-gray-50 flex justify-end space-x-3",children:[n>1&&a.jsx("button",{onClick:o,className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-100 flex items-center",children:"Cancel"}),n<r?a.jsx("button",{onClick:i,className:"px-5 py-2 text-white bg-gray-900 rounded-xl hover:bg-gray-800 transition",children:"Next"}):a.jsx("button",{onClick:i,className:"px-5 py-2 text-white bg-gray-900 rounded-xl hover:bg-gray-800 transition",children:"Convert"})]})]})})}function Oee({selectedDeal:e,onStatusUpdate:t,onClose:n}){const[s,r]=f.useState(e?.stage||""),[i,o]=f.useState(!1),l=Et(),{user:c}=Gt();f.useEffect(()=>{console.log("Group Manager DealsInformation mounted sahdksd",e),console.log("User sadad:",c)},[e,c]);const u=[{value:"PROSPECTING",label:"Prospecting"},{value:"QUALIFICATION",label:"Qualification"},{value:"PROPOSAL",label:"Proposal"},{value:"NEGOTIATION",label:"Negotiation"},{value:"CLOSED_WON",label:"Closed Won"},{value:"CLOSED_LOST",label:"Closed Lost"},{value:"CLOSED_CANCELLED",label:"Closed Cancelled"}];f.useEffect(()=>{e?.stage&&r(e.stage)},[e]);const d=async()=>{if(!e||!e.id){V.error("No deal selected");return}if(!s||s===e.stage){V.info("Please select a different stage");return}const h=e.id;o(!0);try{await ne.put(`/deals/admin/${h}`,{stage:s}),n&&n(),t&&setTimeout(async()=>{await t(!0)},100),setTimeout(()=>{V.success("Deal status updated successfully")},300)}catch(p){console.error(p);const x=p.response?.data?.detail||"Failed to update deal status";V.error(x)}finally{o(!1)}};return e?a.jsxs("div",{className:"space-y-4 font-inter text-[13px] w-full sm:w-[85%] mx-auto flex flex-col gap-4",children:[a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Quick Actions"}),a.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[a.jsxs("button",{onClick:()=>{const h=e.account?.id||e.account_id;l("/group-manager/calls",{state:{openCallModal:!0,initialCallData:{subject:e.name?`Call regarding: ${e.name}`:"",relatedType1:"Account",relatedTo1:h,relatedType2:"Deal",relatedTo2:e.id,contactId:e.contact?.id,assigned_to:e.assigned_deals?.id?String(e.assigned_deals.id):"",assignedTo:e.assigned_to?.id?String(e.assigned_to.id):""}}})},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(It,{className:"text-gray-600 w-4 h-4"}),"Schedule Call"]}),a.jsxs("button",{type:"button",onClick:()=>{if(!e.contact?.email){alert("No email address available");return}const h=encodeURIComponent(e.contact.email),p=encodeURIComponent(""),x=encodeURIComponent(""),b=`mailto:${h}?subject=${p}&body=${x}`;window.location.href=b},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(sn,{className:"text-gray-600 w-4 h-4"}),"Send E-mail"]}),a.jsxs("button",{className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",onClick:()=>{const h=e.account?.id||e.account_id;l("/group-manager/meetings",{state:{openMeetingModal:!0,initialMeetingData:{subject:e.name?`Meeting: ${e.name}`:"",relatedType1:"Account",relatedTo1:h,relatedType2:"Deal",relatedTo2:e.id,assignedTo:e.assigned_deals?.id?String(e.assigned_deals.id):""}}})},children:[a.jsx(Pt,{className:"text-gray-600 w-4 h-4"}),"Book Meeting"]}),a.jsxs("button",{onClick:()=>{const h=e.account?.id||e.account_id;l("/group-manager/tasks",{state:{openTaskModal:!0,initialTaskData:{subject:e.name?`Task for: ${e.name}`:"",relatedType1:"Account",relatedTo1:h,relatedType2:"Deal",relatedTo2:e.id,contactId:e.contact?.id,assignedTo:e.assigned_deals?.id?String(e.assigned_deals.id):"",priority:"NORMAL",status:"Not Started"}}})},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(Qt,{className:"text-gray-600 w-4 h-4"}),"Tasks"]})]})]}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm w-full",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Promote Deal"}),a.jsx("select",{className:"border border-gray-200 rounded-md px-2 sm:px-3 py-1.5 w-full text-sm mb-2 focus:ring-2 focus:ring-gray-300 focus:outline-none",value:s,onChange:h=>r(h.target.value),disabled:i||e.created_by!==c?.id&&e.assigned_to!==c?.id,children:u.map(h=>a.jsx("option",{value:h.value,children:h.label},h.value))}),(e.created_by===c?.id||e.assigned_to===c?.id)&&a.jsx("button",{className:"w-full bg-gray-900 text-white py-1.5 rounded-md text-sm hover:bg-gray-800 transition disabled:opacity-50 disabled:cursor-not-allowed",onClick:d,disabled:i||!s||s===e.stage,children:i?"Updating...":"Update"})]})]}):null}function Mee({selectedDeal:e,relatedActs:t={},show:n,onClose:s,activeTab:r,setActiveTab:i,onEdit:o,onDelete:l,onStatusUpdate:c}){const u=Et(),[d]=Bs(),h=d.get("id"),[p,x]=f.useState(e||null),[b,j]=f.useState(r||"Overview"),[y,N]=f.useState(null),{user:w}=Gt(),{comments:S,addComment:_,refresh:T}=kn({relatedType:"deal",relatedId:p?.id});f.useEffect(()=>{p?.id&&T()},[p?.id,T]);const k=r!==void 0?r:b,A=(()=>{const D=String(w?.role||"").toLowerCase();return D==="ceo"||D==="admin"?"admin":D==="manager"?"manager":D==="sales"?"sales":D==="group manager"||D==="group_manager"||D==="group-manager"?"group-manager":"guest"})(),E=D=>{if(!D)return"";const P=String(D).split("-");return P.length===3?`${P[0]}-${P[2]}`:String(D)},M=D=>D?new Date(D).toLocaleString("en-US",{month:"short",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).replace(",",""):"";if(f.useEffect(()=>{(async()=>{if(h&&!e)try{const G=((await ne.get("/deals/admin/fetch-all")).data||[]).find($=>$.id===parseInt(h));if(G){const $={...G,amount:typeof G.amount=="number"?G.amount:parseFloat(G.amount||0),probability:G.probability||0};x($)}else console.warn("Deal not found with ID:",h)}catch(P){console.error("Error fetching deal:",P)}})()},[h,e]),!p&&!h||h&&!p)return null;const F=D=>({PROSPECTING:"bg-blue-100 text-blue-700",QUALIFICATION:"bg-yellow-100 text-yellow-700",PROPOSAL:"bg-orange-100 text-orange-700",NEGOTIATION:"bg-purple-100 text-purple-700",CLOSED_WON:"bg-green-100 text-green-700",CLOSED_LOST:"bg-red-100 text-red-700"})[D]||"bg-gray-100 text-gray-700";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[9999] font-inter p-2 sm:p-4 overflow-x-hidden",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-lg w-full max-w-full sm:max-w-6xl max-h-[90vh] overflow-y-auto hide-scrollbar relative box-border",children:[a.jsx("div",{className:"bg-tertiary w-full rounded-t-xl p-3 lg:p-3",children:a.jsxs("div",{className:"flex items-start justify-between w-full",children:[a.jsx("h1",{className:"lg:text-3xl text-xl text-white font-semibold text-center w-full",children:"Deal"}),a.jsx("div",{className:"flex items-center gap-2 sm:gap-3",children:a.jsx("button",{onClick:()=>{s?s():u(-1)},className:"text-gray-400 hover:text-white mt-1 cursor-pointer",children:a.jsx(ea,{size:25})})})]})}),a.jsx("div",{className:"p-4 lg:p-2 lg:mx-7",children:a.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-2 sm:gap-3 mt-3",children:[a.jsxs("div",{className:"flex flex-col gap-1",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3 lg:gap-1",children:[a.jsxs("h2",{className:"text-xl lg:text-xl font-semibold text-gray-800 break-words",children:[E(p.deal_id)," - ",p.name]}),a.jsx("span",{className:`text-xs sm:text-sm inline-block font-medium px-1.5 py-0.5 sm:px-3 sm:py-1 rounded-full break-words ${F(p.stage)}`,children:p.stage})]}),a.jsxs("p",{className:"text-gray-500 text-sm break-words",children:["Created on ",M(p.created_at)]})]}),a.jsxs("div",{className:"flex flex-col items-end gap-2",children:[a.jsxs("h2",{className:"text-xl sm:text-2xl font-bold text-gray-600 break-words",children:[" ",p.amount?p.amount.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):"0.00"]}),a.jsx("div",{className:"w-full sm:w-40 bg-gray-200 rounded-full h-2",children:a.jsx("div",{className:"bg-green-500 h-2 rounded-full",style:{width:`${p.probability}%`}})}),a.jsxs("p",{className:"text-xs text-gray-500 break-words",children:[" ",p.probability,"% Complete "]}),p.deal_creator?.id===w?.id&&a.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 mt-3",children:[a.jsxs("button",{type:"button",onClick:()=>{o&&o(p)},className:"inline-flex items-center justify-center bg-blue-500 text-white px-3 sm:px-4 py-1.5 sm:py-2 rounded-md hover:bg-blue-600 transition text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",children:[a.jsx(hn,{className:"mr-1 sm:mr-2",size:16}),a.jsx("span",{className:"hidden sm:inline",children:"Edit"})]}),a.jsxs("button",{type:"button",onClick:()=>{l&&l(p)},className:"inline-flex items-center justify-center px-3 sm:px-4 py-1.5 sm:py-2 rounded-md text-sm bg-orange-500 text-white hover:bg-orange-600 transition focus:outline-none focus:ring-2 focus:ring-orange-400",children:[a.jsx(Zt,{className:"mr-1 sm:mr-2",size:16}),a.jsx("span",{className:"hidden sm:inline",children:"Archive"})]})]})]})]})}),a.jsx("div",{className:"border-b border-gray-200 my-5"}),a.jsxs("div",{className:"p-6 lg:p-4",children:[a.jsx("div",{className:"flex w-full bg-[#6A727D] text-white mt-1 overflow-x-auto mb-6",children:["Overview","Notes","Activities"].map(D=>a.jsx("button",{onClick:()=>{i?i(D):j(D)},className:`flex-1 min-w-[90px] px-4 py-2.5 text-xs sm:text-sm font-medium text-center transition-all duration-200 border-b-2
                ${k===D?"bg-paper-white text-[#6A727D] border-white":"text-white hover:bg-[#5c636d]"}`,children:D},D))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 items-start",children:[a.jsxs("div",{className:"lg:col-span-3 space-y-6",children:[k==="Overview"&&a.jsxs("div",{className:"grid md:grid-cols-2 gap-4 sm:gap-6 w-full",children:[a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 sm:p-5 shadow-sm pb-20 break-words",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 sm:mb-3",children:"Deal Information"}),a.jsxs("p",{className:"text-sm sm:text-sm text-gray-700 mb-2 py-5 break-words",children:[a.jsx("strong",{children:"Description:"})," ",p.description]}),a.jsx("div",{className:"h-px bg-gray-200 w-full"}),a.jsxs("p",{className:"text-sm sm:text-sm text-gray-700 mb-2 py-5 break-words",children:[a.jsx("strong",{children:"Expected Close Date:"})," ",M(p.close_date)||"--"]}),a.jsx("div",{className:"h-px bg-gray-200 w-full"}),a.jsxs("div",{className:"mt-4 py-3 w-full",children:[a.jsxs("div",{className:"relative flex flex-col w-full",children:[a.jsx("div",{className:"absolute top-0 left-0 right-0 flex items-center justify-between w-full",children:(()=>{const D=(p?.stage||"PROSPECTING").toUpperCase(),B=($=>$==="PROSPECTING"?0:$==="QUALIFICATION"?1:$==="PROPOSAL"?2:$==="NEGOTIATION"?3:$==="CLOSED_WON"||$==="CLOSED_LOST"?4:-1)(D);return[0,1,2,3,4].map($=>B===$?"orange":B>$?"green":"gray").map(($,W)=>a.jsxs(wt.Fragment,{children:[a.jsx("div",{className:`relative z-10 w-6 h-6 rounded-full border-2 ${$==="green"?"bg-green-500 border-green-500":$==="orange"?"bg-orange-400 border-orange-400":"bg-gray-300 border-gray-300"}`}),W<4&&a.jsx("div",{className:"flex-grow h-1 bg-gray-200 mx-1 min-w-0"})]},W))})()}),a.jsx("div",{className:"flex justify-between mt-8 gap-2 text-[9px] lg:text-[9px] sm:text-xs text-gray-600 w-full",children:["Prospecting","Qualification","Proposal","Negotiation","Closed"].map((D,P)=>a.jsx("span",{className:"text-center flex-1 break-words",children:D},P))})]}),a.jsx("p",{className:"text-sm text-orange-600 font-medium mt-6 text-center break-words",children:p.stage})]})]}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 sm:p-5 shadow-sm break-words",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-3",children:"Contact Information"}),a.jsxs("div",{className:"text-sm sm:text-sm text-gray-700 space-y-3",children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Account:"})," ",p.account?.name]}),a.jsx("div",{className:"h-px bg-gray-200 w-full"}),a.jsxs("p",{children:[a.jsx("strong",{children:"Primary Contact:"})," ",p.contact?.first_name," ",p.contact?.last_name]}),a.jsx("div",{className:"h-px bg-gray-200 w-full"}),a.jsxs("p",{children:[a.jsx("strong",{children:"Phone:"})," ",p.contact?.work_phone]}),a.jsx("div",{className:"h-px bg-gray-200 w-full"}),a.jsxs("p",{children:[a.jsx("strong",{children:"Email:"})," ",p.contact?.email]}),a.jsx("div",{className:"h-px bg-gray-200 w-full"}),a.jsxs("p",{children:[a.jsx("strong",{children:"Assigned To:"})," ",p.assigned_deals?.first_name," ",p.assigned_deals?.last_name]})]})]})]}),k==="Notes"&&a.jsxs("div",{className:"mt-4 w-full",children:[a.jsx("div",{className:"flex flex-wrap items-center justify-between mb-4 gap-2",children:a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words",children:"Deal Note"})}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 shadow-sm break-words",children:[a.jsx("div",{className:"flex items-start justify-between",children:a.jsx("div",{children:a.jsx("p",{className:"text-sm font-medium text-gray-800 break-words",children:"Note"})})}),a.jsx("div",{className:"mt-3 text-sm text-gray-700 whitespace-pre-wrap break-words",children:p.description||"No notes available."})]}),a.jsx(Tn,{comments:S,onAddComment:_})]}),k==="Activities"&&a.jsxs("div",{className:"space-y-2 w-full h-full max-h-[50dvh] overflow-y-auto bg-gray-50 p-2 hide-scrollbar rounded-lg border border-gray-200 shadow-sm",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words border-b border-gray-300 py-2",children:"Related Activities"}),a.jsxs("div",{className:"space-y-2 text-sm",children:[t.tasks&&t.tasks.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>N(y==="tasks"?null:"tasks"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Qt,{className:"text-blue-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Tasks (",t.tasks.length,")"]})]}),y==="tasks"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),y==="tasks"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:t.tasks.map((D,P)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>u(`/${A}/tasks`,{state:{taskID:D.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-blue-600 mt-1",children:a.jsx(Qt,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:D.subject||D.title||"Task"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:D.description||"No description"}),D.assigned_to&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Assigned: ",D.assigned_to.first_name," ",D.assigned_to.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:M(D.due_date||D.created_at)})]},`task-${P}`))})]}),t.meetings&&t.meetings.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>N(y==="meetings"?null:"meetings"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Pt,{className:"text-green-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Meetings (",t.meetings.length,")"]})]}),y==="meetings"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),y==="meetings"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:t.meetings.map((D,P)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>u(`/${A}/meetings`,{state:{meetingID:D.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-green-600 mt-1",children:a.jsx(Pt,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:D.subject||D.title||"Meeting"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:D.description||D.location||"No description"}),D.host&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Host: ",D.host.first_name," ",D.host.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:M(D.start_time||D.created_at)})]},`meeting-${P}`))})]}),t.calls&&t.calls.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>N(y==="calls"?null:"calls"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(It,{className:"text-purple-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Calls (",t.calls.length,")"]})]}),y==="calls"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),y==="calls"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:t.calls.map((D,P)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>u(`/${A}/calls`,{state:{callID:D.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-purple-600 mt-1",children:a.jsx(It,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:D.subject||D.title||"Call"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:D.direction||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:M(D.call_time||D.created_at)})]},`call-${P}`))})]}),t.quotes&&t.quotes.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>N(y==="quotes"?null:"quotes"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ia,{className:"text-orange-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Quotes (",t.quotes.length,")"]})]}),y==="quotes"?a.jsx(Dt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),y==="quotes"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:t.quotes.map((D,P)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>u(`/${A}/quotes`,{state:{quoteID:D.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-orange-600 mt-1",children:a.jsx(ia,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:(D.quote_id?D.quote_id.replace(/Q(\d+)-\d+-/,"Q$1-"):"--")||"Quote"}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:D.status||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:M(D.presented_date)||""})]},`quote-${P}`))})]}),(!t||(!t.tasks||t.tasks.length===0)&&(!t.meetings||t.meetings.length===0)&&(!t.calls||t.calls.length===0)&&(!t.quotes||t.quotes.length===0)&&(!t.deals||t.deals.length===0)&&(!t.contacts||t.contacts.length===0))&&a.jsx("div",{className:"text-center py-8 text-gray-500",children:a.jsx("p",{children:"No related activities found for this account."})})]})]}),k==="Edit"&&a.jsxs("div",{className:"mt-4 space-y-4 w-full",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words",children:"Edit Deal"}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 sm:p-5 shadow-sm w-full",children:[a.jsxs("label",{className:"block mb-3 break-words",children:[a.jsx("span",{className:"text-sm text-gray-700",children:"Deal Name"}),a.jsx("input",{type:"text",className:"mt-1 block w-full border border-gray-200 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-gray-200",defaultValue:p.name})]}),a.jsxs("label",{className:"block mb-3 break-words",children:[a.jsx("span",{className:"text-sm text-gray-700",children:"Description"}),a.jsx("textarea",{className:"mt-1 block w-full border border-gray-200 rounded-md px-3 py-2 text-sm h-24 resize-y focus:outline-none focus:ring-2 focus:ring-gray-200",defaultValue:p.description})]}),a.jsx("button",{className:"bg-gray-900 text-white px-4 py-2 rounded-md hover:bg-gray-800",children:"Save Changes"})]})]})]}),a.jsx("div",{className:"w-full lg:w-auto",children:a.jsx(Oee,{selectedDeal:p,onStatusUpdate:c,onClose:s})})]})]})]})})}const ZWe=10;function JWe(){f.useEffect(()=>{document.title="Deals | Sari-Sari CRM"},[]);const e=Et(),t=ta(),{user:n}=Gt(),[s,r]=f.useState(""),[i,o]=f.useState("Filter by Stage"),[l,c]=f.useState("Filter by Owner"),[u,d]=f.useState(null),[h,p]=f.useState("Overview"),[x,b]=f.useState(!1),[j,y]=f.useState(null),[N,w]=f.useState(!1),[S,_]=f.useState(1),[T,k]=f.useState(10),[A,E]=f.useState(!1),[M,F]=f.useState(null),[D,P]=f.useState(!1),[B,G]=f.useState(!1),[$,W]=f.useState(null),[Z,Q]=f.useState([]),[le,we]=f.useState([]),[J,se]=f.useState([]),[ye,Ce]=f.useState({}),[ge,be]=f.useState(null),[me,Ae]=f.useState(new Set),[pe,Ie]=f.useState(!1),xe=X=>{if(!X)return"";const oe=String(X).split("-");return oe.length===3?`${oe[0]}-${oe[2]}`:String(X)},he=X=>X?new Date(X).toLocaleString("en-US",{month:"short",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).replace(",",""):"";f.useEffect(()=>{const X=t.state,oe=X?.dealID;if(oe&&!X?.openDealModal){be(oe),e(t.pathname,{replace:!0,state:{}});return}},[t,e]),f.useEffect(()=>{if(ge&&j?.length>0&&!N){const X=j.find(oe=>oe.id===ge);X?d(X):V.error("Deal not found."),be(null)}},[ge,j,N]);const[Re,Ee]=f.useState({id:null,name:"",account_id:"",primary_contact_id:"",stage:"PROPOSAL",amount:"",close_date:"",assigned_to:"",currency:"PHP",description:""}),[He,Ke]=f.useState(null),[st,it]=f.useState(null),ot="dealDraft:group-manager/deals",rt=3600*1e3,at=f.useRef(!1);f.useEffect(()=>{if(!at.current){at.current=!0;try{const X=sessionStorage.getItem(ot);if(!X)return;const oe=JSON.parse(X);if(typeof oe?.ts=="number"&&Date.now()-oe.ts>rt){sessionStorage.removeItem(ot);return}if(oe?.returnTo&&oe.returnTo!==t.pathname)return;oe?.dealForm&&typeof oe.dealForm=="object"&&Ee(oe.dealForm),typeof oe?.isEditing=="boolean"&&G(oe.isEditing),oe?.currentDealId!==void 0&&W(oe.currentDealId),b(!0),sessionStorage.removeItem(ot)}catch{sessionStorage.removeItem(ot)}}},[t.pathname]);const Je=f.useCallback(()=>{try{sessionStorage.setItem(ot,JSON.stringify({ts:Date.now(),returnTo:t.pathname,dealForm:Re,isEditing:B,currentDealId:$}))}catch{}},[ot,t.pathname,Re,B,$]),Fe=f.useCallback(()=>{Je(),window.open("/group-manager/accounts?openModal=1","_blank","noopener,noreferrer")},[Je]),Ue=f.useCallback(()=>{Je(),window.open("/group-manager/contacts?openModal=1","_blank","noopener,noreferrer")},[Je]),Ne={"Prospecting Stage":"PROSPECTING","Qualification Stage":"QUALIFICATION","Proposal Stage":"PROPOSAL","Negotiation Stage":"NEGOTIATION","Closed Won Stage":"CLOSED_WON","Closed Lost Stage":"CLOSED_LOST","Closed Cancelled Stage":"CLOSED_CANCELLED"},ze=X=>({PROSPECTING:"Prospecting",QUALIFICATION:"Qualification",PROPOSAL:"Proposal",NEGOTIATION:"Negotiation",CLOSED_WON:"Closed Won",CLOSED_LOST:"Closed Lost",CLOSED_CANCELLED:"Closed Cancelled"})[X]||X||"--",je=X=>({PROSPECTING:"bg-blue-100 text-blue-700",QUALIFICATION:"bg-yellow-100 text-yellow-700",PROPOSAL:"bg-orange-100 text-orange-700",NEGOTIATION:"bg-purple-100 text-purple-700",CLOSED_WON:"bg-green-100 text-green-700",CLOSED_LOST:"bg-red-100 text-red-700",CLOSED_CANCELLED:"bg-red-100 text-red-700"})[X]||"bg-gray-100 text-gray-700",ve=X=>{const oe=De?.find(Pe=>Pe.id===X);oe&&oe.deal_creator?.id===n?.id&&Ae(Pe=>{const Ve=new Set(Pe);return Ve.has(X)?Ve.delete(X):Ve.add(X),Ve})},z=()=>{const X=De?.filter(oe=>oe.deal_creator?.id===n?.id)||[];me.size===X.length&&X.length>0?Ae(new Set):Ae(new Set(X.map(oe=>oe.id)))},K=()=>{if(me.size===0)return;const X=me.size;F({title:"Archive Deals",message:a.jsxs("span",{children:["Are you sure you want to archive"," ",a.jsx("span",{className:"font-semibold",children:X})," deal",X!==1?"s":"","? You can restore them later if needed."]}),confirmLabel:`Archive ${X} Deal${X!==1?"s":""}`,cancelLabel:"Cancel",variant:"archive",action:{type:"bulk-archive",targetIds:Array.from(me),count:X}})},ue=f.useCallback(async X=>{try{const oe=await ne.get(`/activities/deal/${X}`);Ce(oe.data&&typeof oe.data=="object"?oe.data:{})}catch(oe){console.error(oe),oe.response?.status===404&&(console.warn("No activities found for this account."),Ce({}))}},[]),re=f.useMemo(()=>{const X=s.trim().toLowerCase(),oe=i.trim(),Pe=l.trim();return(j??[]).filter(Ve=>{const ft=[Ve?.deal_id,xe(Ve?.deal_id),Ve?.id?.toString(),Ve?.name,Ve?.description,Ve?.account?.name,Ve?.contact?.first_name,Ve?.contact?.last_name,ze(Ve?.stage),Ve?.stage,Ve?.amount?.toString(),Ve?.close_date,Ve?.assigned_deals?.first_name,Ve?.assigned_deals?.last_name],St=X===""||ft.some(qe=>qe==null||qe===""?!1:qe.toString().toLowerCase().includes(X)),Ht=oe==="Filter by Stage"||oe===""||Ve.stage===Ne[oe]||Ve.stage===oe,da=Pe==="Filter by Owner"||Pe===""||`${Ve.assigned_deals?.first_name||""} ${Ve.assigned_deals?.last_name||""}`.trim().toLowerCase()===Pe.toLowerCase();return St&&Ht&&da})},[j,s,i,l]),Le=Math.max(1,Math.ceil(re.length/ZWe)||1);f.useEffect(()=>{_(1)},[s,i,l]),f.useEffect(()=>{_(X=>{const oe=Math.max(1,Math.ceil(re.length/T)||1);return X>oe?oe:X})},[re.length,T]);const De=f.useMemo(()=>{const X=(S-1)*T;return re.slice(X,X+T)},[re,S,T]),Qe=()=>_(X=>Math.max(X-1,1)),tt=()=>_(X=>Math.min(X+1,Le)),Me=()=>{Ee({id:null,name:"",account_id:"",primary_contact_id:"",stage:"PROPOSAL",amount:"",close_date:"",assigned_to:"",currency:"PHP",description:""}),G(!1),W(null),b(!0)},et=async()=>{w(!0);try{const X=await ne.get("/deals/admin/fetch-all"),Pe=[...Array.isArray(X.data)?X.data:[]].sort((Ve,ft)=>{const St=Ve?.created_at?new Date(Ve.created_at).getTime():0;return(ft?.created_at?new Date(ft.created_at).getTime():0)-St});y(Pe)}catch(X){X.response&&X.response.status===403?V.error("Permission denied. Only CEO, Admin, or Group Manager can access this page."):V.error("Failed to fetch deals. Please try again later."),console.error(X)}finally{w(!1)}},yt=async()=>{try{const X=await ne.get("/accounts/admin/fetch-all");Q(Array.isArray(X.data)?X.data:[])}catch(X){console.error(X),X.response?.status===403&&V.warn("Unable to load accounts (permission denied).")}},_t=async()=>{try{const X=await ne.get("/contacts/admin/fetch-all");we(Array.isArray(X.data)?X.data:[])}catch(X){console.error(X),X.response?.status===403&&V.warn("Unable to load contacts (permission denied).")}},Ct=async()=>{try{const X=await ne.get("/users/all");se(Array.isArray(X.data)?X.data:[])}catch(X){console.error(X),X.response?.status===403&&V.warn("Unable to load users (permission denied).")}};f.useEffect(()=>{et(),yt(),_t(),Ct()},[]);const jt=async X=>{X&&(Ee({id:X.id||null,name:X.name||"",account_id:X.account_id?.toString()||"",primary_contact_id:X.primary_contact_id?.toString()||"",stage:X.stage||"PROPOSAL",amount:X.amount?.toString()||"",close_date:X.close_date?new Date(X.close_date).toISOString().split("T")[0]:"",assigned_to:X.assigned_to?.toString()||"",currency:X.currency||"PHP",description:X.description||""}),Ke(X.account||null),it(X.contact||null),G(!0),W(X.id),d(null),b(!0))},At=async(X=!1)=>{try{const oe=await ne.get("/deals/admin/fetch-all"),Ve=[...Array.isArray(oe.data)?oe.data:[]].sort((ft,St)=>{const Ht=ft?.created_at?new Date(ft.created_at).getTime():0;return(St?.created_at?new Date(St.created_at).getTime():0)-Ht});if(y(Ve),!X&&u&&u.id){const ft=Ve.find(St=>St.id===u.id);ft&&d({...ft})}}catch(oe){console.error("Failed to refresh deal data:",oe),await et()}},Ge=X=>{const oe=X.name.trim();if(!oe){V.error("Deal name is required.");return}if(!X.account_id){V.error("Account is required.");return}const Pe=B&&$?"update":"create",Ve=oe;F({title:Pe==="create"?"Confirm New Deal":"Confirm Update",message:Pe==="create"?a.jsxs("span",{children:["Are you sure you want to create"," ",a.jsx("span",{className:"font-semibold",children:Ve}),"?"]}):a.jsxs("span",{children:["Save changes to ",a.jsx("span",{className:"font-semibold",children:Ve}),"?"]}),confirmLabel:Pe==="create"?"Create Deal":"Update Deal",cancelLabel:"Cancel",variant:"primary",action:{type:Pe,formData:X,targetId:$||null,name:Ve}})},Be=X=>{if(!X)return;const oe=X.name||"this deal";F({title:"Archive Deal",message:a.jsxs("span",{children:["Are you sure you want to archive"," ",a.jsx("span",{className:"font-semibold",children:oe}),"? You can restore it later if needed."]}),confirmLabel:"Archive Deal",cancelLabel:"Cancel",variant:"archive",action:{type:"archive-single",targetId:X.id,name:oe}})},ce=async()=>{if(!M?.action){F(null);return}const{action:X}=M,{type:oe,formData:Pe,targetId:Ve,name:ft}=X;P(!0);try{if(oe==="create"){E(!0);const St={name:Pe.name.trim(),account_id:parseInt(Pe.account_id),primary_contact_id:Pe.primary_contact_id?parseInt(Pe.primary_contact_id):null,stage:Pe.stage,amount:Pe.amount?parseFloat(Pe.amount):null,currency:Pe.currency||"PHP",close_date:Pe.close_date||null,description:Pe.description||null,assigned_to:Pe.assigned_to?parseInt(Pe.assigned_to):null};await ne.post("/deals/admin/create",St),V.success(`Deal "${ft}" created successfully.`),b(!1),await et()}else if(oe==="update"){if(!Ve)throw new Error("Missing deal identifier for update.");E(!0);const St={};Pe.name!==void 0&&(St.name=Pe.name.trim()),Pe.account_id!==void 0&&Pe.account_id!==""&&(St.account_id=parseInt(Pe.account_id)),Pe.primary_contact_id!==void 0&&(St.primary_contact_id=Pe.primary_contact_id?parseInt(Pe.primary_contact_id):null),Pe.stage!==void 0&&(St.stage=Pe.stage),Pe.amount!==void 0&&Pe.amount!==""&&(St.amount=parseFloat(Pe.amount)),Pe.currency!==void 0&&(St.currency=Pe.currency),Pe.close_date!==void 0&&(St.close_date=Pe.close_date||null),Pe.description!==void 0&&(St.description=Pe.description||null),Pe.assigned_to!==void 0&&(St.assigned_to=Pe.assigned_to?parseInt(Pe.assigned_to):null),await ne.put(`/deals/admin/${Ve}`,St),V.success(`Deal "${ft}" updated successfully.`),b(!1),await et()}else if(oe==="archive-single"){if(!Ve)throw new Error("Missing deal identifier for archiving.");await ne.put(`/deals/single-archive/${Ve}`),V.success(`Deal "${ft}" archived successfully.`),u?.id===Ve&&d(null),await et()}else if(oe==="bulk-archive"){if(Ie(!0),!X.targetIds||X.targetIds.length===0)throw new Error("No deals selected for archiving.");await ne.put("/deals/bulk-archive",{deal_ids:X.targetIds}),V.success(`${X.count} deal${X.count!==1?"s":""} archived successfully.`),Ae(new Set),u&&X.targetIds.includes(u.id)&&d(null),await et()}}catch(St){console.error(St);const Ht=oe==="create"?"Failed to create deal. Please review the details and try again.":oe==="update"?"Failed to update deal. Please review the details and try again.":oe==="bulk-archive"?"Failed to archive deals. Please try again.":"Failed to archive deal. Please try again.",da=St.response?.data?.detail||Ht;V.error(da)}finally{(oe==="create"||oe==="update")&&E(!1),oe==="bulk-archive"&&Ie(!1),P(!1),F(null)}},fe=()=>{D||F(null)},H=()=>{b(!1),Ee({id:null,name:"",account_id:"",primary_contact_id:"",stage:"PROPOSAL",amount:"",close_date:"",assigned_to:"",currency:"PHP",description:""}),Ke(null),it(null),G(!1),W(null),E(!1)},te=(j??[]).filter(X=>X.stage==="PROSPECTING").length,q=(j??[]).filter(X=>X.stage==="QUALIFICATION").length,Y=(j??[]).filter(X=>X.stage==="PROPOSAL").length,U=(j??[]).filter(X=>X.stage==="NEGOTIATION").length,de=(j??[]).filter(X=>X.stage==="CLOSED_WON").length,Te=(j??[]).filter(X=>X.stage==="CLOSED_LOST").length,ie=(j??[]).filter(X=>X.stage==="CLOSED_CANCELLED").length,Oe=[{title:"Prospecting",value:te,icon:Nj,color:"text-blue-600",bgColor:"bg-blue-100"},{title:"Qualification",value:q,icon:gn,color:"text-yellow-600",bgColor:"bg-yellow-100"},{title:"Proposal",value:Y,icon:sa,color:"text-orange-600",bgColor:"bg-orange-100"},{title:"Negotiation",value:U,icon:cd,color:"text-purple-600",bgColor:"bg-purple-100"},{title:"Closed Won",value:de,icon:La,color:"text-green-600",bgColor:"bg-green-100"},{title:"Closed Lost",value:Te,icon:Yn,color:"text-red-600",bgColor:"bg-red-100"},{title:"Closed Cancelled",value:ie,icon:Yn,color:"text-gray-600",bgColor:"bg-gray-100"}];return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[N&&a.jsx(qt,{message:"Loading deals..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h1",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(sa,{className:"mr-2 text-blue-600"}),"Deals"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{onClick:Me,className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 lg:my-0 rounded-md hover:bg-gray-800 text-sm sm:text-base mx-auto sm:ml-auto cursor-pointer",children:[a.jsx(aa,{className:"mr-2"})," Add Deal"]})})]}),a.jsx("div",{className:"grid grid-cols-1 p-2 lg:grid-cols-4 gap-4 mb-6 w-full break-words overflow-hidden",children:Oe.map(X=>a.jsx(tVe,{...X},X.title))}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search deals",value:s,onChange:X=>r(X.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsxs("div",{className:"w-full lg:w-auto flex flex-col lg:flex-row gap-3",children:[a.jsxs("select",{value:i,onChange:X=>o(X.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full lg:w-40 focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{value:"Filter by Stage",children:"Filter by Stage"}),a.jsx("option",{value:"Prospecting Stage",children:"Prospecting"}),a.jsx("option",{value:"Qualification Stage",children:"Qualification"}),a.jsx("option",{value:"Proposal Stage",children:"Proposal"}),a.jsx("option",{value:"Negotiation Stage",children:"Negotiation"}),a.jsx("option",{value:"Closed Won Stage",children:"Closed Won"}),a.jsx("option",{value:"Closed Lost Stage",children:"Closed Lost"}),a.jsx("option",{value:"Closed Cancelled Stage",children:"Closed Cancelled"})]}),a.jsxs("select",{value:l,onChange:X=>c(X.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full lg:w-40 focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{value:"Filter by Owner",children:"Filter by Owner"}),[...new Set((j??[]).map(X=>`${X.assigned_deals?.first_name} ${X.assigned_deals?.last_name}`))].map((X,oe)=>a.jsx("option",{value:X,children:X},oe))]})]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[500px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 text-sm tracking-wide font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 w-12",children:a.jsx("input",{type:"checkbox",checked:me.size>0&&me.size===De?.filter(X=>X.deal_creator?.id===n?.id).length&&De?.filter(X=>X.deal_creator?.id===n?.id).length>0,onChange:z,className:"w-4 h-4 cursor-pointer"})}),a.jsx("th",{className:"py-3 px-4",children:"Deal ID"}),a.jsx("th",{className:"py-3 px-4 truncate",children:"Deal Name"}),a.jsx("th",{className:"py-3 px-4",children:"Account"}),a.jsx("th",{className:"py-3 px-4",children:"Contact"}),a.jsx("th",{className:"py-3 px-4 w-48",children:"Stage"}),a.jsx("th",{className:"py-3 px-4 w-48",children:"Value"}),a.jsx("th",{className:"py-3 px-4",children:"Close Date"}),a.jsx("th",{className:"py-3 px-4",children:"Owner"}),a.jsx("th",{className:"py-3 px-4 w-12",children:me.size>0&&a.jsx("button",{onClick:K,className:"text-orange-500 hover:text-orange-700 transition",title:"Archive selected deals",disabled:pe,children:a.jsx(Zt,{size:18})})})]})}),a.jsx("tbody",{children:re.length>0?De.map(X=>a.jsxs("tr",{className:"hover:bg-gray-50 text-sm cursor-pointer",onClick:()=>{d({...X}),ue(X.id)},children:[a.jsx("td",{className:"py-3 px-4",children:n?.id===X.deal_creator?.id&&a.jsx("input",{type:"checkbox",checked:me.has(X.id),onClick:oe=>{oe.stopPropagation()},onChange:oe=>{oe.stopPropagation(),ve(X.id)},className:"w-4 h-4 cursor-pointer"})}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",children:xe(X.deal_id)}),a.jsx("td",{className:"py-3 px-4",children:a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-blue-600 hover:underline break-all text-sm",children:X.name}),a.jsx("div",{className:"text-gray-500 text-xs break-all",children:X.description||"--"})]})}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",children:X.account?.name||"--"}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",children:X.contact?.first_name&&X.contact?.last_name?`${X.contact.first_name} ${X.contact.last_name}`:X.contact?.first_name||X.contact?.last_name||"--"}),a.jsx("td",{className:"py-3 px-4 w-48",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${je(X.stage)}`,children:ze(X.stage)})}),a.jsxs("td",{className:"py-3 px-4 w-48 text-gray-800 font-medium text-sm",children:[" ",X.amount?.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})||"0.00"]}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",children:he(X.close_date)||"--"}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",children:X.assigned_deals?.first_name&&X.assigned_deals?.last_name?`${X.assigned_deals.first_name} ${X.assigned_deals.last_name}`:X.assigned_deals?.first_name||X.assigned_deals?.last_name||"--"})]},X.id)):a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:10,children:"No deals found."})})})]})}),a.jsx(ca,{className:"mt-4",totalItems:re.length,pageSize:T,currentPage:S,onPrev:Qe,onNext:tt,onPageSizeChange:k,label:"deals"}),x&&a.jsx(aVe,{onClose:H,formData:Re,setFormData:Ee,isEditing:B,onSubmit:Ge,isSubmitting:A||D,accounts:Z,contacts:le,users:J,currentAccount:He,currentContact:st,onAddAccount:Fe,onAddContact:Ue,onRefreshAccounts:yt,onRefreshContacts:_t}),u&&a.jsx(Mee,{relatedActs:ye,selectedDeal:u,show:!!u,onClose:()=>d(null),activeTab:h,setActiveTab:p,onEdit:jt,onDelete:Be,onStatusUpdate:At}),M&&a.jsx(eVe,{open:!0,title:M.title,message:M.message,confirmLabel:M.confirmLabel,cancelLabel:M.cancelLabel,variant:M.variant,onConfirm:ce,onCancel:fe,loading:D})]})}function eVe({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o=!1,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="archive"?"bg-orange-500 hover:bg-orange-600 border border-orange-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[10000]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsx("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${u}`,disabled:o,children:o?"Processing...":s})]})]})})}function tVe({icon:e,title:t,value:n,color:s="text-blue-600",bgColor:r="bg-blue-100",onClick:i}){const o=()=>{typeof i=="function"?i():console.log(`Clicked: ${t}`)};return a.jsxs("div",{className:"flex items-center p-4 bg-white rounded-xl shadow-md border border-gray-200 transition-all duration-300",onClick:o,children:[a.jsx("div",{className:`flex-shrink-0 p-3 rounded-full ${r} ${s} mr-4`,children:e?a.jsx(e,{size:22}):null}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:t}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:n})]})]})}function aVe({onClose:e,formData:t,setFormData:n,isEditing:s=!1,onSubmit:r,isSubmitting:i=!1,accounts:o=[],contacts:l=[],users:c=[],currentAccount:u=null,currentContact:d=null,onAddAccount:h,onAddContact:p,onRefreshAccounts:x,onRefreshContacts:b}){const[j,y]=f.useState(!1),N=_=>{if(_.preventDefault(),y(!0),!t.name?.trim()){V.error("Deal name is required.");return}const T=Number(t.amount);if(!t.amount||isNaN(T)||T<=0){V.error("Amount must be a number greater than 0.");return}if(!t.account_id){V.error("Please select an account.");return}if(!t.primary_contact_id){V.error("Please select a primary contact.");return}if(!t.assigned_to){V.error("Please assign this deal to a user.");return}r?.(t)},w=_=>{_.target.id==="modalBackdrop"&&e()},S=f.useMemo(()=>{const _=String(t.account_id||"").trim(),T=Array.isArray(l)?l:[];return _?T.filter(k=>{const E=[k?.account_id,k?.accountId,k?.account?.id,k?.account?.account_id,k?.account?.accountId].find(M=>M!=null&&String(M).trim()!=="");return E?String(E)===_:!1}):T},[l,t.account_id]);return f.useEffect(()=>{const _=String(t.account_id||"").trim(),T=String(t.primary_contact_id||"").trim();if(!T||!_)return;S.some(A=>String(A?.id)===T)||n(A=>({...A,primary_contact_id:""}))},[t.account_id,t.primary_contact_id,S,n]),a.jsx("div",{id:"modalBackdrop",onClick:w,className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-full sm:max-w-3xl rounded-2xl shadow-lg p-4 sm:p-6 md:p-8 relative border border-gray-200 overflow-y-auto max-h-[90vh] hide-scrollbar",onClick:_=>_.stopPropagation(),children:[a.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-gray-500 hover:text-black transition",children:a.jsx(ea,{size:22})}),a.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800 mb-4 sm:mb-6 flex items-center justify-center",children:s?"Edit Deal":"Create Deal"}),a.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",onSubmit:N,noValidate:!0,children:[a.jsx($T,{label:"Deal Name",name:"name",value:t.name,onChange:_=>n({...t,name:_.target.value}),placeholder:"Enter deal name",required:!0,isSubmitted:j,className:"md:col-span-2"}),a.jsx(RT,{label:"Account",value:t.account_id||"",onChange:_=>n({...t,account_id:_}),items:o||[],getLabel:_=>_?.name??"",placeholder:"Search account...",disabled:i,currentItem:u,actions:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{type:"button",onClick:h,disabled:i,title:"Add account",className:"inline-flex items-center justify-center w-8 h-8 rounded-md border border-gray-300 text-gray-600 hover:bg-gray-50 transition disabled:opacity-60",children:a.jsx(aa,{size:16})}),a.jsx("button",{type:"button",onClick:x,disabled:i,title:"Refresh accounts",className:"inline-flex items-center justify-center w-8 h-8 rounded-md border border-gray-300 text-gray-600 hover:bg-gray-50 transition disabled:opacity-60",children:a.jsx(Br,{size:16})})]}),required:!0,isSubmitted:j}),a.jsx(RT,{label:"Primary Contact",value:t.primary_contact_id||"",onChange:_=>n({...t,primary_contact_id:_}),items:S||[],getLabel:_=>`${_?.first_name??""} ${_?.last_name??""}`.trim()||_?.email||"",placeholder:"Search contact...",disabled:i,currentItem:d,actions:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{type:"button",onClick:p,disabled:i,title:"Add contact",className:"inline-flex items-center justify-center w-8 h-8 rounded-md border border-gray-300 text-gray-600 hover:bg-gray-50 transition disabled:opacity-60",children:a.jsx(aa,{size:16})}),a.jsx("button",{type:"button",onClick:b,disabled:i,title:"Refresh contacts",className:"inline-flex items-center justify-center w-8 h-8 rounded-md border border-gray-300 text-gray-600 hover:bg-gray-50 transition disabled:opacity-60",children:a.jsx(Br,{size:16})})]}),required:!0,isSubmitted:j}),a.jsx(uH,{label:"Stage",name:"stage",value:t.stage,onChange:_=>n({...t,stage:_.target.value}),options:[{value:"PROSPECTING",label:"Prospecting"},{value:"QUALIFICATION",label:"Qualification"},{value:"PROPOSAL",label:"Proposal"},{value:"NEGOTIATION",label:"Negotiation"},{value:"CLOSED_WON",label:"Closed Won"},{value:"CLOSED_LOST",label:"Closed Lost"},{value:"CLOSED_CANCELLED",label:"Closed Cancelled"}],disabled:i}),a.jsx($T,{label:"Amount",name:"amount",type:"text",inputMode:"decimal",value:t.amount,onChange:_=>{let T=_.target.value;T.startsWith(".")&&(T="0"+T),!(T&&!/^\d*\.?\d*$/.test(T))&&n({...t,amount:T})},placeholder:"0.00",required:!0,isSubmitted:j}),a.jsx(uH,{label:"Currency",name:"currency",value:t.currency||"PHP",onChange:_=>n({...t,currency:_.target.value}),options:[{value:"PHP",label:"PHP"},{value:"USD",label:"USD"}],disabled:i}),a.jsx($T,{label:"Close Date",name:"close_date",type:"date",value:t.close_date||"",onChange:_=>n({...t,close_date:_.target.value}),disabled:i}),a.jsx(RT,{label:"Assign To",value:t.assigned_to||"",onChange:_=>n({...t,assigned_to:_}),items:c||[],getLabel:_=>`${_?.first_name??""} ${_?.last_name??""}`.trim()||_?.email||"",placeholder:"Search assignee...",disabled:i,required:!0,isSubmitted:j,className:"md:col-span-2"}),a.jsx(sVe,{label:"Description",name:"description",value:t.description,onChange:_=>n({...t,description:_.target.value}),placeholder:"Additional details...",rows:3,className:"md:col-span-2",disabled:i}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-2 md:col-span-2 mt-4",children:[a.jsx("button",{type:"button",onClick:e,className:"w-full sm:w-auto px-4 py-2 text-white bg-red-400 border border-red-300 rounded hover:bg-red-500 transition disabled:opacity-70",disabled:i,children:"Cancel"}),a.jsx("button",{type:"submit",className:"w-full sm:w-auto px-4 py-2 text-white border border-tertiary bg-tertiary rounded hover:bg-secondary transition disabled:opacity-70",disabled:i,children:i?"Saving...":s?"Update Deal":"Save Deal"})]})]})]})})}function $T({label:e,name:t,value:n,onChange:s,placeholder:r,type:i="text",required:o=!1,disabled:l=!1,className:c="",isSubmitted:u=!1}){const d=u&&!n?.trim();return a.jsxs("div",{className:c,children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",o&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:i,name:t,value:n??"",onChange:s,placeholder:r,required:o,disabled:l,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border focus:ring-2
          ${d?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}
          ${c}
        `})]})}function uH({label:e,name:t,value:n,onChange:s,options:r,required:i=!1,disabled:o=!1,className:l=""}){return a.jsxs("div",{className:l,children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsx("select",{name:t,value:n??"",onChange:s,required:i,disabled:o,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100",children:r.map(c=>a.jsx("option",{value:c.value,children:c.label},c.value))})]})}function RT({label:e,items:t=[],value:n="",onChange:s,getLabel:r,placeholder:i="Search...",disabled:o=!1,className:l="",currentItem:c=null,required:u=!1,isSubmitted:d=!1,actions:h=null}){const p=d&&u&&!n;return a.jsxs("div",{className:l,children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",u&&a.jsx("span",{className:"text-red-500",children:"*"})]}),h?a.jsx("div",{className:"flex items-center",children:h}):null]}),a.jsx(nVe,{items:t,value:n??"",onChange:s,getLabel:r,placeholder:i,disabled:o,currentItem:c,hasError:p})]})}function nVe({items:e=[],value:t="",onChange:n,getLabel:s,placeholder:r="Search...",disabled:i=!1,maxRender:o=200,currentItem:l=null,hasError:c=!1}){const[u,d]=f.useState(!1),[h,p]=f.useState(""),x=f.useRef(null),j=e.find(w=>String(w.id)===String(t))||l,y=j?s(j):"",N=f.useMemo(()=>{const w=h.trim().toLowerCase();return(w?e.filter(_=>(s(_)||"").toLowerCase().includes(w)):e).slice(0,o)},[e,h,s,o]);return f.useEffect(()=>{const w=S=>{x.current&&!x.current.contains(S.target)&&d(!1)};return document.addEventListener("mousedown",w),()=>document.removeEventListener("mousedown",w)},[]),f.useEffect(()=>{u||p("")},[u]),a.jsxs("div",{ref:x,className:"relative w-full",children:[a.jsx("input",{disabled:i,value:u?h:y,placeholder:r,onFocus:()=>!i&&d(!0),onChange:w=>{p(w.target.value),u||d(!0)},className:`w-full border rounded-md px-2 py-1.5 text-sm outline-none focus:ring-2
          ${c?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}`}),u&&!i&&a.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg overflow-hidden",children:[a.jsx("div",{className:"max-h-56 overflow-y-auto hide-scrollbar",children:N.length>0?N.map(w=>{const S=String(w.id),_=s(w),T=String(t)===S;return a.jsx("button",{type:"button",onClick:()=>{n(S),d(!1)},className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-50 ${T?"bg-blue-50":""}`,children:_||"--"},S)}):a.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No results"})}),e.length>o&&a.jsxs("div",{className:"px-3 py-2 text-[11px] text-gray-400 border-t",children:["Showing first ",o," results  keep typing to narrow."]})]})]})}function sVe({label:e,name:t,value:n,onChange:s,placeholder:r,required:i=!1,disabled:o=!1,className:l="",rows:c=3}){return a.jsxs("div",{className:l,children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsx("textarea",{name:t,value:n??"",onChange:s,placeholder:r,required:i,disabled:o,rows:c,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100 resize-none"})]})}const zT=[{value:"Draft",label:"Draft"},{value:"Presented",label:"Presented"},{value:"Accepted",label:"Accepted"},{value:"Rejected",label:"Rejected"}],FT={deal_id:"",account_id:"",contact_id:"",total_amount:"",presented_date:"",validity_days:"",status:"Draft",assigned_to:"",notes:"",subtotal:0,tax_rate:0,tax_amount:0,discount_type:"",discount_value:0,discount_amount:0,currency:"PHP",items:[]},Fi=e=>{if(!e)return"Draft";const t=e.toString().trim().toLowerCase();return{draft:"Draft",presented:"Presented",accepted:"Accepted",rejected:"Rejected"}[t]||"Draft"},UT=e=>e?e.toString().toLowerCase().replace(/\b\w/g,t=>t.toUpperCase()):"--",rVe=e=>{switch(Fi(e).toLowerCase()){case"draft":return"bg-gray-100 text-gray-700";case"presented":return"bg-yellow-100 text-yellow-700";case"accepted":return"bg-green-100 text-green-700";case"rejected":return"bg-orange-100 text-orange-700";default:return"bg-gray-100 text-gray-700"}},iVe=e=>{switch(Fi(e).toLowerCase()){case"draft":return"bg-gray-600 text-white";case"presented":return"bg-yellow-600 text-white";case"accepted":return"bg-green-600 text-white";case"rejected":return"bg-orange-600 text-white";default:return"bg-gray-600 text-white"}},sv=e=>e?new Date(e).toLocaleString("en-US",{month:"2-digit",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).replace(",",""):"",Bg=e=>e?new Date(e).toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"numeric"}):"",oVe=e=>{if(!e)return"";if(typeof e=="string"&&e.match(/^\d{4}-\d{2}-\d{2}$/))return e;try{const t=new Date(e);if(isNaN(t.getTime()))return"";const n=t.getFullYear(),s=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0");return`${n}-${s}-${r}`}catch{return""}},BT=(e,t)=>{if(!e||t==null||t==="")return"";const n=Number(t);if(Number.isNaN(n))return"";const s=new Date(e);return isNaN(s.getTime())?"":(s.setDate(s.getDate()+n),s.toISOString().slice(0,10))},mH=e=>{if(!e)return"";const t=String(e).split("-");return t.length===3?`${t[0]}-${t[2]}`:String(e)},rv=e=>{if(!e)return"";const t=String(e).split("-");return t.length===3?`${t[0]}-${t[2]}`:String(e)},lj=e=>{if(!e)return null;if(typeof e=="number")return e;if(typeof e=="string"&&e.trim()&&!Number.isNaN(Number(e)))return Number(e);if(typeof e=="object"){if(e.id&&!Number.isNaN(Number(e.id)))return Number(e.id);if(e.user?.id&&!Number.isNaN(Number(e.user.id)))return Number(e.user.id);if(e.data?.id&&!Number.isNaN(Number(e.data.id)))return Number(e.data.id);if(e.profile?.id&&!Number.isNaN(Number(e.profile.id)))return Number(e.profile.id)}return null},lVe=()=>{const e=["user","currentUser","userData","authUser","profile"];for(const s of e){const r=localStorage.getItem(s);if(r)try{const i=JSON.parse(r),o=lj(i);if(o)return o}catch{}}const t=localStorage.getItem("user_id"),n=lj(t);return n||null},cVe=e=>{if(!e)return"";const n=[e.account_id,e.accountId,e.account?.id,e.account?.account_id,e.account?.accountId].find(s=>s!=null&&String(s).trim()!=="");return n?String(n):""},dVe=e=>{if(!e)return"";const n=[e.contact_id,e.contactId,e.contact?.id,e.primary_contact_id,e.primaryContactId,e.primary_contact?.id,e.primaryContact?.id].find(s=>s!=null&&String(s).trim()!=="");return n?String(n):""},uVe=e=>{if(!e)return"";const n=[e.assigned_user?.id,e.assigned_to?.id,e.assigned_to,e.assigned_user_id].find(s=>s!=null&&String(s).trim()!=="");return n?String(n):""};function mVe(){const e=Et(),t=ta(),{user:n}=Gt(),s=n?.company?.currency||"";f.useEffect(()=>{document.title="Quotes | Sari-Sari CRM"},[]);const[r,i]=f.useState([]),[o,l]=f.useState(!1),[c,u]=f.useState([]),[d,h]=f.useState([]),[p,x]=f.useState([]),[b,j]=f.useState([]),[y,N]=f.useState(null),[w,S]=f.useState(null),[_,T]=f.useState(!1),[k,A]=f.useState(!1),[E,M]=f.useState(!1),[F,D]=f.useState(null),[P,B]=f.useState(!1),[G,$]=f.useState(!1),[W,Z]=f.useState(null),[Q,le]=f.useState(FT),[we,J]=f.useState(""),[se,ye]=f.useState("Filter by Status"),[Ce,ge]=f.useState(null),be=f.useCallback(async()=>{if(w)try{$(!0);const ee=(await ne.get("/company/invoice-info"))?.data;e(`/group-manager/quotes/${encodeURIComponent(w.id)}/print`,{state:{quote:w,companyInfo:ee}})}catch(L){const ee=L?.response?.data?.detail||L?.message||"Failed to open print page.";V.error(ee)}finally{$(!1)}},[w,e]),[me,Ae]=f.useState(1),[pe,Ie]=f.useState(10),[xe,he]=f.useState("Overview"),[Re,Ee]=f.useState("Draft"),[He,Ke]=f.useState([]),[st,it]=f.useState(null),ot=f.useMemo(()=>uVe(w),[w]),{comments:rt,addComment:at,refresh:Je}=kn({relatedType:"quote",relatedId:w?.id});f.useEffect(()=>{w?.id&&Je()},[w?.id,Je]),f.useEffect(()=>{const ee=t.state?.quoteID;if(ee){it(ee),e(t.pathname,{replace:!0,state:{}});return}},[t,e]),f.useEffect(()=>{if(st&&r.length>0&&!o){const L=r.find(ee=>ee.id===st);L?S(L):V.error("Quote not found."),it(null)}},[st,r,o]),f.useEffect(()=>{let L=!0;return(async()=>{const ke=lVe();if(ke&&L){N(ke);return}try{const $e=await ne.get("/auth/me"),We=lj($e?.data);if(We&&L){N(We);return}}catch{}try{const $e=await ne.get("/users/me"),We=lj($e?.data);if(We&&L){N(We);return}}catch{}L&&N(null)})(),()=>{L=!1}},[]);const Fe=f.useCallback(L=>L&&d.find(ke=>String(ke.id)===String(L))?.name||"",[d]),Ue=f.useCallback(L=>{if(!L)return"";const ee=p.find(ke=>String(ke.id)===String(L));return ee?`${ee.first_name} ${ee.last_name}`.trim():""},[p]),Ne=f.useCallback(L=>{if(!L)return"--";const ee=c.find(ke=>String(ke.id)===String(L));return ee?.deal_name||ee?.name||`Deal #${mH(L)}`},[c]),ze=f.useCallback(L=>{const ee=c.find(We=>String(We.id)===String(L)),ke=cVe(ee);let $e=dVe(ee);if(!$e&&ke){const We=p.filter(mt=>String(mt.account_id||"")===String(ke));if(We.length>0){const mt=[...We].sort((Tt,kt)=>{const Yt=`${Tt.first_name||""} ${Tt.last_name||""}`.trim().toLowerCase(),En=`${kt.first_name||""} ${kt.last_name||""}`.trim().toLowerCase();return Yt.localeCompare(En)});$e=String(mt[0].id)}}if(ke&&$e){const We=p.find(mt=>String(mt.id)===String($e));We?.account_id&&String(We.account_id)!==String(ke)&&($e="")}return{accountId:ke||"",contactId:$e||""}},[c,p]),je=f.useCallback(L=>{if(!L)return"--";if(L.deal?.deal_name)return L.deal.deal_name;if(L.deal?.name)return L.deal.name;const ee=L.deal_id||L.deal?.id;return ee?Ne(ee):"--"},[Ne]),ve=f.useCallback(L=>{if(!L)return"--";if(L.account?.name)return L.account.name;let ee=L.account_id||L.account?.id;if(!ee){const ke=L.deal_id||L.deal?.id;ke&&(ee=ze(ke).accountId)}return ee?Fe(ee)||`Account #${ee}`:"--"},[ze,Fe]),z=f.useCallback(L=>{if(!L)return"--";if(L.contact?.first_name||L.contact?.last_name)return`${L.contact?.first_name||""} ${L.contact?.last_name||""}`.trim()||"--";let ee=L.contact_id||L.contact?.id;if(!ee){const $e=L.deal_id||L.deal?.id;$e&&(ee=ze($e).contactId)}return(ee?Ue(ee):"")||(ee?`Contact #${ee}`:"--")},[ze,Ue]),K=f.useCallback(async(L=null)=>{l(!0);try{const ee=await ne.get("/quotes/admin/fetch-all"),$e=[...Array.isArray(ee.data)?ee.data:[]].sort((We,mt)=>{const Tt=We?.created_at||We?.updated_at||0,kt=mt?.created_at||mt?.updated_at||0;return new Date(kt)-new Date(Tt)});if(i($e),L){const We=$e.find(mt=>mt.id===L);S(We||null)}}catch(ee){console.error(ee),i([]),ee.response?.status===403?V.error("Permission denied. Only CEO, Admin, or Group Manager can access this page."):V.error("Failed to fetch quotes. Please try again later.")}finally{l(!1)}},[]),ue=f.useCallback(async()=>{try{const L=await ne.get("/deals/admin/fetch-all");u(Array.isArray(L.data)?L.data:[])}catch(L){console.error(L),L.response?.status===403&&V.warn("Unable to load deals (permission denied).")}},[]),re=f.useCallback(async()=>{try{const L=await ne.get("/accounts/admin/fetch-all");h(Array.isArray(L.data)?L.data:[])}catch(L){console.error(L),L.response?.status===403&&V.warn("Unable to load accounts (permission denied).")}},[]),Le=f.useCallback(async()=>{try{const L=await ne.get("/contacts/admin/fetch-all");x(Array.isArray(L.data)?L.data:[])}catch(L){console.error(L),L.response?.status===403&&V.warn("Unable to load contacts (permission denied).")}},[]),De=f.useCallback(async()=>{try{const L=await ne.get("/users/all");j(Array.isArray(L.data)?L.data:[])}catch(L){console.error(L),L.response?.status===403&&V.warn("Unable to load users (permission denied).")}},[]);f.useEffect(()=>{K(),ue(),re(),Le(),De()},[K,ue,re,Le,De]);const Qe=f.useMemo(()=>{const L=we.trim().toLowerCase(),ee=se.trim();return r.filter(ke=>{const $e=je(ke),We=ve(ke),mt=z(ke),Tt=BT(ke.presented_date,ke.validity_days),kt=[ke.quote_id,rv(ke.quote_id),ke.id?.toString(),$e,We,mt,ke.total_amount?.toString(),ke.validity_days?.toString(),ke.presented_date?Bg(ke.presented_date):"",Tt?Bg(Tt):"",ke.assigned_user?.first_name,ke.assigned_user?.last_name,ke.creator?.first_name,ke.creator?.last_name,ke.status,ke.notes,sv(ke.created_at),sv(ke.updated_at)],Yt=L===""||kt.some(Qr=>Qr==null?!1:Qr.toString().toLowerCase().includes(L)),En=ee==="Filter by Status"||Fi(ke.status)===ee;return Yt&&En})},[r,we,se,je,ve,z]),tt=Math.max(1,Math.ceil(Qe.length/pe)||1);f.useEffect(()=>Ae(1),[we,se]),f.useEffect(()=>{Ae(L=>{const ee=Math.max(1,Math.ceil(Qe.length/pe)||1);return L>ee?ee:L})},[Qe.length,pe]);const Me=f.useMemo(()=>{const L=(me-1)*pe;return Qe.slice(L,L+pe)},[Qe,me,pe]),et=()=>Ae(L=>Math.max(L-1,1)),yt=()=>Ae(L=>Math.min(L+1,tt)),_t=L=>{S(L),he("Overview"),Ee(Fi(L?.status)||"Draft")},Ct=()=>{S(null),he("Overview")},jt=L=>{L.target.id==="quoteModalBackdrop"&&!P&&Ct()},At=f.useCallback(()=>{T(!1),A(!1),Z(null),le(FT),M(!1)},[]),Ge=L=>{L.target.id==="modalBackdrop"&&!E&&!P&&At()},Be=L=>{const{name:ee,value:ke}=L.target;if(ee==="deal_id"){const{accountId:$e,contactId:We}=ze(ke);le(mt=>({...mt,deal_id:ke,account_id:$e,contact_id:We}));return}le($e=>({...$e,[ee]:ke}))},ce=()=>{le(FT),A(!1),Z(null),T(!0)},fe=L=>{if(!L)return;S(null);const ee=L.deal?.id?String(L.deal.id):L.deal_id?String(L.deal_id):"",ke=ee?ze(ee):{accountId:"",contactId:""},$e=L.account?.id?String(L.account.id):L.account_id?String(L.account_id):ke.accountId,We=L.contact?.id?String(L.contact.id):L.contact_id?String(L.contact_id):ke.contactId,mt=L.assigned_user?.id?String(L.assigned_user.id):L.assigned_to?String(L.assigned_to):"";le({deal_id:ee,account_id:$e||"",contact_id:We||"",total_amount:L.total_amount?.toString()||"",presented_date:oVe(L.presented_date),validity_days:L.validity_days!==null&&L.validity_days!==void 0?String(L.validity_days):"",status:Fi(L.status)||"Draft",assigned_to:mt,notes:L.notes||"",subtotal:parseFloat(L.subtotal)||0,tax_rate:parseFloat(L.tax_rate)||0,tax_amount:parseFloat(L.tax_amount)||0,discount_type:L.discount_type||"",discount_value:parseFloat(L.discount_value)||0,discount_amount:parseFloat(L.discount_amount)||0,currency:L.currency||"PHP",items:Array.isArray(L.items)?L.items.map(Tt=>({id:Tt.id,item_type:Tt.item_type||"Product",name:Tt.name||"",description:Tt.description||"",sku:Tt.sku||"",variant:Tt.variant||"",unit:Tt.unit||"pcs",quantity:parseFloat(Tt.quantity)||1,unit_price:parseFloat(Tt.unit_price)||0,discount_percent:parseFloat(Tt.discount_percent)||0,discount_amount:parseFloat(Tt.discount_amount)||0,line_total:parseFloat(Tt.line_total)||0,sort_order:Tt.sort_order||0})):[]}),A(!0),Z(L.id),T(!0)},H=L=>{if(L.target.checked){const ee=Me.filter(ke=>ke.created_by===y).map(ke=>ke.id);Ke(ee)}else Ke([])},te=L=>{Ke(ee=>ee.includes(L)?ee.filter(ke=>ke!==L):[...ee,L])},q=Me.filter(L=>L.created_by===y),Y=L=>{if(!L)return;const ee=L.quote_id||"this quote";D({title:"Archive Quote",message:a.jsxs("span",{children:["Are you sure you want to archive"," ",a.jsx("span",{className:"font-semibold",children:ee}),"? This action cannot be undone."]}),confirmLabel:"Archive Quote",cancelLabel:"Cancel",variant:"danger",action:{type:"delete",targetId:L.id,name:ee}})},U=async()=>{He.length!==0&&D({title:"Archive Quotes",message:a.jsxs("span",{children:["Are you sure you want to archive"," ",a.jsx("span",{className:"font-semibold",children:He.length})," selected quotes? This action cannot be undone."]}),confirmLabel:`Archive ${He.length} Quote(s)`,cancelLabel:"Cancel",variant:"danger",action:{type:"bulk-delete",quote_ids:He}})},[de,Te]=f.useState(!1),ie=L=>{if(L.preventDefault(),Te(!0),!y){V.error("Unable to determine current user. Please log in again.");return}if(!Q.deal_id){V.error("Deal is required.");return}if(!Q.assigned_to){V.error("Assigned To is required.");return}const ke=ze(Q.deal_id),$e=Q.items.map((Yt,En)=>({item_type:Yt.item_type||"Product",name:Yt.name,description:Yt.description||null,sku:Yt.sku||null,variant:Yt.variant||null,unit:Yt.unit||null,quantity:parseFloat(Yt.quantity)||1,unit_price:parseFloat(Yt.unit_price)||0,discount_percent:parseFloat(Yt.discount_percent)||0,sort_order:Yt.sort_order??En})),We={deal_id:Number(Q.deal_id),account_id:ke.accountId?Number(ke.accountId):null,contact_id:ke.contactId?Number(ke.contactId):null,subtotal:parseFloat(Q.subtotal)||0,tax_rate:parseFloat(Q.tax_rate)||0,tax_amount:parseFloat(Q.tax_amount)||0,discount_type:Q.discount_type||null,discount_value:parseFloat(Q.discount_value)||0,discount_amount:parseFloat(Q.discount_amount)||0,total_amount:parseFloat(Q.total_amount)||0,currency:Q.currency||"PHP",presented_date:Q.presented_date||null,validity_days:Q.validity_days===""?null:Number(Q.validity_days),status:Q.status||"Draft",assigned_to:Q.assigned_to?Number(Q.assigned_to):null,notes:Q.notes?.trim()||null,items:$e},mt=k&&W?"update":"create",Tt=Ne(Q.deal_id),kt=mt==="create"?{...We,created_by_id:Number(y)}:We;D({title:mt==="create"?"Confirm New Quote":"Confirm Update",message:mt==="create"?a.jsxs("span",{children:["Are you sure you want to create a quote for"," ",a.jsx("span",{className:"font-semibold",children:Tt}),"?"]}):a.jsxs("span",{children:["Save changes to"," ",a.jsx("span",{className:"font-semibold",children:Tt}),"?"]}),confirmLabel:mt==="create"?"Create Quote":"Update Quote",cancelLabel:"Cancel",variant:"primary",action:{type:mt,payload:kt,targetId:W||null,name:Tt}})},Oe=async()=>{if(!F?.action){D(null);return}const{action:L}=F,{type:ee,payload:ke,targetId:$e,name:We}=L;B(!0);try{if(ee==="create")M(!0),await ne.post("/quotes/admin",ke),V.success("Quote created successfully."),At(),await K();else if(ee==="update"){if(!$e)throw new Error("Missing quote identifier for update.");M(!0),await ne.put(`/quotes/admin/${$e}`,ke),V.success("Quote updated successfully."),At(),await K(),w?.id===$e&&S(null)}else if(ee==="delete"){if(!$e)throw new Error("Missing quote identifier for deletion.");const mt=w?.id;ge($e),await ne.delete(`/quotes/admin/${$e}`),V.success(`Quote "${We}" archived successfully.`),await K(mt&&mt!==$e?mt:null),mt===$e&&S(null)}else ee==="bulk-delete"&&(await ne.post("/quotes/admin/bulk-delete",{quote_ids:He}),V.success(`Successfully archived ${He.length} quotes`),Ke([]),await K())}catch(mt){console.error(mt);const Tt=ee==="create"?"Failed to create quote. Please review the details and try again.":ee==="update"?"Failed to update quote. Please review the details and try again.":"Failed to delete quote. Please try again.";V.error(Tt),(ee==="create"||ee==="update")&&M(!1),ee==="delete"&&ge(null)}finally{(ee==="create"||ee==="update")&&M(!1),ee==="delete"&&ge(null),B(!1),D(null)}},X=()=>{P||D(null)},oe=f.useCallback((L,ee)=>{const ke=L?.deal_id??L?.deal?.id??"",$e=ke?Number(ke):null,We=$e?ze(String($e)):{accountId:"",contactId:""},mt=L?.account_id??L?.account?.id??We.accountId??null,Tt=L?.contact_id??L?.contact?.id??We.contactId??null,kt=L?.total_amount??0,Yt=L?.assigned_to??L?.assigned_user?.id??null;return{deal_id:$e,account_id:mt!=null&&String(mt).trim()!==""?Number(mt):null,contact_id:Tt!=null&&String(Tt).trim()!==""?Number(Tt):null,total_amount:Number(kt),presented_date:L?.presented_date||null,validity_days:L?.validity_days===""||L?.validity_days===void 0||L?.validity_days===null?null:Number(L.validity_days),status:ee,assigned_to:Yt!=null&&String(Yt).trim()!==""?Number(Yt):null,notes:L?.notes?.trim()||null}},[ze]),Pe=f.useCallback(async()=>{if(!w?.id)return;const L=Fi(Re),ee=[L,L.toLowerCase()],ke=async $e=>ne.patch(`/quotes/admin/${w.id}/status`,{status:$e},{headers:{"Content-Type":"application/json"}});try{let $e=!1;for(const We of ee)try{await ke(We),$e=!0;break}catch(mt){if(mt?.response?.status===422)continue;throw mt}if(!$e){const We=oe(w,L);if(!We.deal_id){V.error("Cannot update status: missing deal_id on selected quote.");return}if(!We.total_amount||We.total_amount<=0){V.error("Cannot update status: missing/invalid total_amount on selected quote.");return}await ne.put(`/quotes/admin/${w.id}`,We)}V.success(`Quote status updated to ${L}`),S(null),he("Overview"),await K()}catch($e){console.error($e);const We=$e?.response?.data?.message||($e?.response?.data?.errors?Object.values($e.response.data.errors).flat().join(" "):null)||"Failed to update quote status. Please try again.";V.error(We)}},[w,Re,K,oe]),Ve=[{label:"Filter by Status",value:"Filter by Status"},...zT.map(L=>({label:L.label,value:L.value}))],ft=F?.action?.type==="delete"?F.action.targetId:null,St=w&&(Ce===w.id||ft===w.id),Ht=w&&Ce===w.id,da=w?a.jsx("div",{id:"quoteModalBackdrop",onClick:jt,className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-6xl max-h-[92vh] overflow-y-auto hide-scrollbar animate-scale-in font-inter relative",onClick:L=>L.stopPropagation(),children:[a.jsx("div",{className:"w-full flex flex-col items-center justify-center rounded-t-xl",children:a.jsxs("div",{className:"bg-tertiary w-full flex items-center justify-between p-3 lg:p-3 rounded-t-xl",children:[a.jsx("h1",{className:"lg:text-3xl text-xl text-white font-semibold text-center w-full",children:"Quotes"}),a.jsx("button",{onClick:Ct,className:"text-gray-500 hover:text-white transition cursor-pointer",children:a.jsx(Za,{size:25})})]})}),a.jsxs("div",{className:"p-6 lg:p-4",children:[a.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between lg:flex-row lg:items-center lg:justify-between mt-3 gap-2 px-2 md:items-center lg:gap-4 md:mx-7 lg:mx-7",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[a.jsx("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-800",children:je(w)}),a.jsx("span",{className:`text-xs sm:text-sm font-medium px-2 sm:px-3 py-1 rounded-full whitespace-nowrap ${iVe(w.status)}`,children:UT(w.status)})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsxs("button",{className:"inline-flex items-center justify-center w-full sm:w-auto bg-white text-gray-700 px-4 py-2 rounded-md border border-gray-300 hover:bg-gray-50 disabled:opacity-70 transition text-sm focus:outline-none focus:ring-2 focus:ring-gray-300",onClick:be,disabled:G||E||P,children:[a.jsx(ia,{className:"mr-2"}),G?"Preparing...":"Print Quotation"]}),y===w.created_by&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{className:"inline-flex items-center justify-center w-full sm:w-auto bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 disabled:opacity-70 transition text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",onClick:()=>fe(w),disabled:P||F?.action?.type==="update"&&F.action.targetId===w.id,children:[a.jsx(gn,{className:"mr-2"}),"Edit"]}),a.jsx("button",{className:"inline-flex items-center justify-center w-full sm:w-auto px-4 py-2 rounded-md text-sm bg-orange-500 text-white hover:bg-orange-600 transition focus:outline-none focus:ring-2 focus:ring-orange-400",onClick:()=>Y(w),disabled:!!St,children:Ht?"Archiving...":a.jsxs(a.Fragment,{children:[a.jsx(Zt,{className:"mr-2"}),"Archive"]})})]})]})]}),a.jsx("div",{className:"border-b border-gray-200 my-5"}),a.jsxs("div",{className:"p-1 lg:p-4",children:[a.jsx("div",{className:"flex w-full bg-[#6A727D] text-white mt-1 overflow-x-auto mb-6",children:["Overview","Notes"].map(L=>a.jsx("button",{onClick:()=>he(L),className:`flex-1 min-w-[90px] px-4 py-2.5 text-xs sm:text-sm font-medium text-center transition-all duration-200 border-b-2
                    ${xe===L?"bg-paper-white text-[#6A727D] border-white":"text-white hover:bg-[#5c636d]"}`,children:L},L))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 items-start",children:[a.jsxs("div",{className:"lg:col-span-3",children:[xe==="Overview"&&a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 md:p-8 border border-gray-200",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4 sm:gap-6 text-sm text-gray-700",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Quote ID:"}),a.jsx("p",{children:rv(w.quote_id)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Deal:"}),a.jsx("p",{children:je(w)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Account:"}),a.jsx("p",{children:ve(w)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Contact:"}),a.jsx("p",{children:z(w)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Total Amount:"}),a.jsx("p",{children:w.total_amount?`${s}${Number(w.total_amount).toLocaleString()}`:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Presented Date:"}),a.jsx("p",{children:Bg(w.presented_date)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Validity Days:"}),a.jsx("p",{children:w.validity_days!==null&&w.validity_days!==void 0?w.validity_days:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Expiry Date:"}),a.jsx("p",{children:Bg(BT(w.presented_date,w.validity_days))||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Status:"}),a.jsx("p",{children:UT(w.status)})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Assigned To:"}),a.jsx("p",{children:w.assigned_user?`${w.assigned_user.first_name} ${w.assigned_user.last_name}`:"Unassigned"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created By:"}),a.jsx("p",{children:w.creator?`${w.creator.first_name} ${w.creator.last_name}`:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created At:"}),a.jsx("p",{children:sv(w.created_at)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Last Updated:"}),a.jsx("p",{children:sv(w.updated_at)||"N/A"})]})]}),w.items&&w.items.length>0&&a.jsx("div",{className:"mt-6",children:a.jsx(wd,{items:w.items,onChange:()=>{},currencySymbol:s,readOnly:!0,taxRate:parseFloat(w.tax_rate)||0,discountType:w.discount_type,discountValue:parseFloat(w.discount_value)||0})})]}),xe==="Notes"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"bg-white p-4 sm:p-6 rounded-xl border border-gray-200 shadow-sm",children:[a.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Notes:"}),a.jsx("p",{className:"text-sm text-gray-700 leading-relaxed whitespace-pre-wrap",children:w.notes||"No notes available."})]}),a.jsx(Tn,{comments:rt,onAddComment:at})]})]}),a.jsxs("div",{className:"flex flex-col gap-4",children:[a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Quick Actions"}),a.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[a.jsxs("button",{onClick:()=>e("/group-manager/calls",{state:{openCallModal:!0,initialCallData:{subject:`Call regarding Quote ${rv(w.quote_id)}`,assigned_to:ot,direction:"Outgoing",status:"Planned"}}}),className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(It,{className:"text-gray-600 w-4 h-4"}),"Schedule Call"]}),a.jsxs("button",{className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",onClick:()=>e("/group-manager/meetings",{state:{openMeetingModal:!0,initialMeetingData:{subject:`Meeting with ${w.quote_id}`,assignedTo:ot,status:"Planned"}}}),children:[a.jsx(Pt,{className:"text-gray-600 w-4 h-4"}),"Book Meeting"]}),a.jsxs("button",{onClick:()=>e("/group-manager/tasks",{state:{openTaskModal:!0,initialTaskData:{subject:`Follow up with ${w.quote_id}`,assignedTo:ot,priority:"NORMAL",status:"Not Started"}}}),className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(Qt,{className:"text-gray-600 w-4 h-4"}),"Tasks"]})]})]}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm w-full",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Status"}),a.jsx("select",{className:"border border-gray-200 rounded-md px-2 sm:px-3 py-1.5 w-full text-sm mb-2 focus:ring-2 focus:ring-indigo-500 outline-none",value:Re||Fi(w.status)||"Draft",onChange:L=>Ee(L.target.value),children:zT.map(L=>a.jsx("option",{value:L.value,children:L.label},L.value))}),a.jsx("button",{onClick:Pe,disabled:Fi(Re)===Fi(w.status),className:`w-full py-1.5 rounded-md text-sm transition focus:outline-none focus:ring-2 ${Fi(Re)===Fi(w.status)?"bg-gray-400 cursor-not-allowed text-white":"bg-gray-900 text-white hover:bg-gray-800 focus:ring-gray-400"}`,children:"Update"})]})]})]})]})]})]})}):null,qe=a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[o&&a.jsx(qt,{message:"Loading quotes..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h2",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(ia,{className:"mr-2 text-blue-600"})," Quotes"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto gap-2",children:a.jsxs("button",{onClick:()=>{ce(),Te(!1)},className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 rounded-md hover:bg-gray-800 text-sm sm:text-base mx-auto sm:ml-auto cursor-pointer",children:[a.jsx(aa,{className:"mr-2"})," Add Quote"]})})]}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search quotes",value:we,onChange:L=>J(L.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsx("div",{className:"w-full lg:w-1/4",children:a.jsx("select",{value:se,onChange:L=>ye(L.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:Ve.map(L=>a.jsx("option",{value:L.value,children:L.label},L.value))})})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[900px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 text-sm tracking-wide font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 w-12",children:a.jsx("input",{type:"checkbox",checked:q.length>0&&He.length===q.length,onChange:H,className:"cursor-pointer"})}),a.jsx("th",{className:"py-3 px-4",children:"Quote ID"}),a.jsx("th",{className:"py-3 px-4",children:"Deal"}),a.jsx("th",{className:"py-3 px-4",children:"Account"}),a.jsx("th",{className:"py-3 px-4",children:"Contact"}),a.jsx("th",{className:"py-3 px-4",children:"Total Amount"}),a.jsx("th",{className:"py-3 px-4",children:"Status"}),a.jsx("th",{className:"py-3 px-4",children:"Assigned To"}),a.jsx("th",{className:"py-3 px-4",children:"Expiry Date"}),a.jsx("th",{className:"py-3 px-4 text-center w-24",children:He.length>0?a.jsx("button",{onClick:U,className:"text-orange-600 hover:text-orange-800 transition p-1 rounded-full hover:bg-orange-50",title:`Archive ${He.length} selected items`,children:a.jsx(Zt,{size:18})}):""})]})}),a.jsx("tbody",{children:o?a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:10,children:"Loading quotes..."})}):Qe.length>0?Me.map(L=>{const ee=BT(L.presented_date,L.validity_days);return a.jsxs("tr",{className:"hover:bg-gray-50 text-sm cursor-pointer transition",onClick:()=>_t(L),children:[a.jsx("td",{className:"py-3 px-4 align-top w-12",onClick:ke=>ke.stopPropagation(),children:L.created_by===y&&a.jsx("input",{type:"checkbox",checked:He.includes(L.id),onChange:()=>te(L.id),className:"cursor-pointer"})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("div",{className:"font-medium text-blue-600 hover:underline whitespace-nowrap",children:rv(L.quote_id)||"--"})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("div",{className:"break-words",children:je(L)||"--"})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("div",{className:"text-sm text-gray-700 break-words",children:ve(L)||"--"})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("div",{className:"break-words",children:z(L)||"--"})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("div",{className:"text-gray-700",children:L.total_amount?`${s}${Number(L.total_amount).toLocaleString()}`:"--"})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-medium ${rVe(L.status)}`,children:UT(L.status)})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("div",{children:L.assigned_user?`${L.assigned_user.first_name} ${L.assigned_user.last_name}`:"Unassigned"})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("div",{className:"text-gray-500 text-xs",children:Bg(ee)||"--"})}),a.jsx("td",{className:"py-3 px-4 align-top text-center w-24"})]},L.id)}):a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:10,children:"No quotes found."})})})]})}),a.jsx(ca,{className:"mt-4",totalItems:Qe.length,pageSize:pe,currentPage:me,onPrev:et,onNext:yt,onPageSizeChange:L=>{Ie(L),Ae(1)},pageSizeOptions:[10,20,30,40,50],label:"quotes"})]}),_e=_?a.jsx("div",{id:"modalBackdrop",onClick:Ge,className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-full sm:max-w-3xl rounded-2xl shadow-lg p-4 sm:p-6 md:p-8 relative border border-gray-200 overflow-y-auto max-h-[90vh] hide-scrollbar",onClick:L=>L.stopPropagation(),children:[a.jsx("button",{onClick:()=>{At(),Te(!1)},className:"absolute top-4 right-4 text-gray-500 hover:text-black transition disabled:opacity-60",disabled:E||P,children:a.jsx(ea,{size:22})}),a.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800 mb-4 sm:mb-6 flex items-center justify-center",children:k?"Edit Quote":"Add New Quote"}),a.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",onSubmit:ie,children:[a.jsx(gH,{label:"Deal",name:"deal_id",value:Q.deal_id,onChange:L=>{const{accountId:ee,contactId:ke}=ze(L);le($e=>({...$e,deal_id:L,account_id:ee,contact_id:ke}))},items:Array.isArray(c)?c:[],getLabel:L=>`${mH(L?.deal_id??"")} ${L?.name??""}`.trim(),placeholder:"Search deal...",required:!0,isSubmitted:de,disabled:E||c.length===0,className:"md:col-span-2"}),a.jsx(hH,{label:"Account",value:Fe(Q.account_id)||(Q.account_id?`Account #${Q.account_id}`:""),disabled:!0}),a.jsx(hH,{label:"Contact",value:Ue(Q.contact_id)||(Q.contact_id?`Contact #${Q.contact_id}`:""),disabled:!0}),a.jsx("div",{className:"md:col-span-2 mt-2",children:a.jsx(wd,{items:Q.items,onChange:L=>le(ee=>({...ee,items:L})),currencySymbol:s,readOnly:E,taxRate:Q.tax_rate,discountType:Q.discount_type,discountValue:Q.discount_value,onTotalsChange:L=>{le(ee=>({...ee,subtotal:L.subtotal,discount_amount:L.discount_amount,tax_amount:L.tax_amount,total_amount:L.total_amount}))}})}),a.jsxs("div",{className:"md:col-span-2 mt-2 p-4 bg-gray-50 rounded-lg",children:[a.jsx("h4",{className:"font-medium text-gray-700 mb-3",children:"Pricing Settings"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-600 text-xs mb-1",children:"Discount Type"}),a.jsxs("select",{value:Q.discount_type||"",onChange:L=>le(ee=>({...ee,discount_type:L.target.value})),className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm",disabled:E,children:[a.jsx("option",{value:"",children:"No Discount"}),a.jsx("option",{value:"percentage",children:"Percentage (%)"}),a.jsx("option",{value:"fixed",children:"Fixed Amount"})]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-gray-600 text-xs mb-1",children:["Discount"," ",Q.discount_type==="percentage"?"%":"Amount"]}),a.jsx("input",{type:"number",value:Q.discount_value||"",onChange:L=>le(ee=>({...ee,discount_value:L.target.value})),className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm",placeholder:"0",min:"0",max:Q.discount_type==="percentage"?"100":void 0,step:"0.01",disabled:E||!Q.discount_type})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-600 text-xs mb-1",children:"Tax Rate (%)"}),a.jsx("input",{type:"number",value:Q.tax_rate||"",onChange:L=>le(ee=>({...ee,tax_rate:L.target.value})),className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm",placeholder:"0",min:"0",max:"100",step:"0.01",disabled:E})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-600 text-xs mb-1",children:"Total Amount"}),a.jsxs("div",{className:"w-full bg-gray-100 border border-gray-300 rounded-md px-2 py-1.5 text-sm font-medium",children:[s,parseFloat(Q.total_amount||0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]})]}),a.jsx(fH,{label:"Presented Date",name:"presented_date",type:"date",value:Q.presented_date,onChange:Be,disabled:E}),a.jsx(fH,{label:"Validity Days",name:"validity_days",type:"number",value:Q.validity_days,onChange:Be,placeholder:"30",disabled:E}),a.jsx(gH,{label:"Assigned To",value:Q.assigned_to||"",onChange:L=>le(ee=>({...ee,assigned_to:L})),items:Array.isArray(b)?b:[],getLabel:L=>{const ee=`${L?.first_name??""} ${L?.last_name??""}`.trim();return ee?L?.role?`${ee} (${L.role})`:ee:L?.email||""},placeholder:"Search assignee...",required:!0,isSubmitted:de,disabled:E}),a.jsx(fVe,{label:"Status",name:"status",value:Q.status,onChange:Be,options:zT,required:!0,disabled:E}),a.jsx(gVe,{label:"Notes",name:"notes",value:Q.notes,onChange:Be,placeholder:"Additional details...",rows:3,disabled:E,className:"md:col-span-2"}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-2 md:col-span-2 mt-4",children:[a.jsx("button",{type:"button",onClick:()=>{At(),Te(!1)},className:"w-full sm:w-auto px-4 py-2 text-white bg-red-400 border border-red-300 rounded hover:bg-red-500 transition disabled:opacity-70",disabled:E||P,children:"Cancel"}),a.jsx("button",{type:"submit",className:"w-full sm:w-auto px-4 py-2 text-white border border-tertiary bg-tertiary rounded hover:bg-secondary transition disabled:opacity-70",disabled:E||P,children:E?"Saving...":k?"Update Quote":"Save Quote"})]})]})]})}):null,I=F?a.jsx(pVe,{open:!0,title:F.title,message:F.message,confirmLabel:F.confirmLabel,cancelLabel:F.cancelLabel,variant:F.variant,onConfirm:Oe,onCancel:X,loading:P}):null;return a.jsxs(a.Fragment,{children:[w?da:qe,_e,I]})}function fH({label:e,name:t,value:n,onChange:s,placeholder:r,type:i="text",required:o=!1,disabled:l=!1,className:c="",isSubmitted:u=!1}){const d=u&&!n?.trim();return a.jsxs("div",{className:c,children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",o&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:i,name:t,value:n??"",onChange:s,placeholder:r,required:o,disabled:l,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border focus:ring-2
          ${d?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}
          ${c}
        `})]})}function hH({label:e,value:t,className:n="",disabled:s=!0}){return a.jsxs("div",{className:n,children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsx("input",{type:"text",value:t??"",disabled:s,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm outline-none disabled:bg-gray-100"})]})}function fVe({label:e,name:t,value:n,onChange:s,options:r,required:i=!1,disabled:o=!1,className:l=""}){const c=n!=null?String(n):"",d=r.some(h=>String(h.value)===c)?c:"";return a.jsxs("div",{className:l,children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsx("select",{name:t,value:d,onChange:s,required:i,disabled:o,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100",children:r.map(h=>a.jsx("option",{value:String(h.value??""),children:h.label},h.value??h.label))})]})}function gH({label:e,items:t=[],value:n="",onChange:s,getLabel:r,placeholder:i="Search...",disabled:o=!1,className:l="",required:c=!1,isSubmitted:u=!1}){const d=u&&c&&!n;return a.jsxs("div",{className:l,children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",c&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx(hVe,{items:t,value:n??"",onChange:s,getLabel:r,placeholder:i,disabled:o,hasError:d})]})}function hVe({items:e=[],value:t="",onChange:n,getLabel:s,placeholder:r="Search...",disabled:i=!1,maxRender:o=200,hasError:l=!1}){const[c,u]=f.useState(!1),[d,h]=f.useState(""),p=f.useRef(null),x=e.find(y=>String(y.id)===String(t)),b=x?s(x):"",j=f.useMemo(()=>{const y=d.trim().toLowerCase();return(y?e.filter(w=>(s(w)||"").toLowerCase().includes(y)):e).slice(0,o)},[e,d,s,o]);return f.useEffect(()=>{const y=N=>{p.current&&!p.current.contains(N.target)&&u(!1)};return document.addEventListener("mousedown",y),()=>document.removeEventListener("mousedown",y)},[]),f.useEffect(()=>{c||h("")},[c]),a.jsxs("div",{ref:p,className:"relative w-full",children:[a.jsx("input",{disabled:i,value:c?d:b,placeholder:r,onFocus:()=>!i&&u(!0),onChange:y=>{h(y.target.value),c||u(!0)},className:`w-full border rounded-md px-2 py-1.5 text-sm outline-none focus:ring-2
          ${l?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}`}),c&&!i&&a.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg overflow-hidden",children:[a.jsx("div",{className:"max-h-56 overflow-y-auto hide-scrollbar",children:j.length>0?j.map(y=>{const N=String(y.id),w=s(y),S=String(t)===N;return a.jsx("button",{type:"button",onClick:()=>{n(N),u(!1)},className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-50 ${S?"bg-blue-50":""}`,children:w||"--"},N)}):a.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No results"})}),e.length>o&&a.jsxs("div",{className:"px-3 py-2 text-[11px] text-gray-400 border-t",children:["Showing first ",o," results  keep typing to narrow."]})]})]})}function gVe({label:e,name:t,value:n,onChange:s,placeholder:r,rows:i=3,disabled:o=!1,className:l=""}){return a.jsxs("div",{className:l,children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsx("textarea",{name:t,value:n??"",onChange:s,placeholder:r,rows:i,disabled:o,className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100 resize-none"})]})}function pVe({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o=!1,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-orange-500 hover:bg-orange-600 border border-orange-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsx("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${u}`,disabled:o,children:o?"Processing...":s})]})]})})}function xVe(){const{userRole:e}=Ks();return a.jsx(N1,{currentUserRole:e,currentUserId:null})}const pH=["Not started","In progress","Deferred","Completed"],xH={NOT_STARTED:"Not started","NOT STARTED":"Not started","TO DO":"Not started",IN_PROGRESS:"In progress","IN PROGRESS":"In progress",COMPLETED:"Completed",DEFERRED:"Deferred","Not started":"Not started","In progress":"In progress",Completed:"Completed",Deferred:"Deferred","In Progress":"In progress","To Do":"Not started",Review:"Deferred"},Iee=e=>e&&(xH[e]||xH[String(e).toUpperCase()])||"Not started",yVe=e=>{if(!e)return"";const t=new Date(e);if(Number.isNaN(t.getTime()))return"";const n=t.getTimezoneOffset();return new Date(t.getTime()-n*60*1e3).toISOString().slice(0,16)},HT=e=>{if(!e)return"";const t=new Date(e);return Number.isNaN(t.getTime())?"":t.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},bVe=e=>{const t=e.subject?.trim()??"",n=e.description?.trim()??"",s=e.notes?.trim()??"";e.priority&&String(e.priority).toUpperCase(),Iee(e.status);let r=null,i=null,o=null,l=null,c=null;e.relatedType1==="Lead"&&e.relatedTo1?r=Number(e.relatedTo1):e.relatedType1==="Account"&&e.relatedTo1&&(i=Number(e.relatedTo1)),e.relatedType1==="Account"&&(e.relatedType2==="Contact"&&e.relatedTo2?o=Number(e.relatedTo2):e.relatedType2==="Deal"&&e.relatedTo2?l=Number(e.relatedTo2):e.relatedType2==="Quote"&&e.relatedTo2&&(c=Number(e.relatedTo2)));const u=e.assignedTo?Number(e.assignedTo):null,d=o||l||i||r,h=o?"Contact":l?"Deal":i?"Account":r?"Lead":c?"Quote":null;return{title:t,description:n,priority:e.priority||"Normal",status:e.status||"Not started",due_date:e.dueDate?e.dueDate:null,assigned_to:u,notes:s,is_personal:!1,lead_id:r,account_id:i,contact_id:o,deal_id:l,quote_id:c,related_to_1:e.relatedTo1?Number(e.relatedTo1):null,related_type_1:e.relatedType1,related_to_2:e.relatedTo2?Number(e.relatedTo2):null,related_type_2:e.relatedType2,related_to:d,related_type:h}},vVe=e=>{const t=e.task_assign_to?`${e.task_assign_to.first_name} ${e.task_assign_to.last_name}`:e.assigned_to?String(e.assigned_to):"Unassigned",n=e.task_creator?`${e.task_creator.first_name} ${e.task_creator.last_name}`:e.created_by?String(e.created_by):"System",s=e.due_date||e.dueDate||null,r=e.date_assigned||e.created_at||null,i=e.contact?`${e.contact.first_name} ${e.contact.last_name}`:e.assigned_to?String(e.assigned_to.id):"Unassigned",o=G=>{if(!G)return"";const $=String(G).split("-");return $.length===3?`${$[0]}-${$[2]}`:String(G)},l=()=>e.lead?.id||e.lead_id,c=()=>e.account?.id||e.account_id,u=()=>e.contact?.id||e.contact_id,d=()=>e.deal?.id||e.deal_id,h=()=>e.quote?.id||e.quote_id,p=()=>e.task_assign_to?.id||e.assigned_to,x=()=>e.lead?.title||e.lead_id,b=()=>e.account?.name||e.account_id,j=()=>i||e.contact_id,y=()=>e.deal?.name||e.deal_id,N=()=>o(e.quote?.quote_id)||e.id;let w="Lead",S="",_="",T="",k="Lead",A="",E="",M="";const F=c(),D=b(),P=l(),B=x();if(F){w="Account",k="Account",A=D,S=String(F);const G=u(),$=d(),W=j(),Z=y(),Q=h(),le=N();G?(_="Contact",E="Contact",M=W,T=String(G)):$?(E="Deal",_="Deal",M=Z,T=String($)):Q&&(E="Quote",_="Quote",M=le,T=String(Q))}else P?(k="Lead",A=B,w="Lead",S=String(P)):e.related_type==="Account"&&(w="Account",S=String(e.related_to));return{id:e.id,title:e.title,description:e.description,priority:e.priority||"Normal",status:Iee(e.status),dueDate:s,dateAssigned:r,assignedToId:p()||null,assignedToName:t,createdAt:e.created_at||null,createdById:e.created_by?.id||e.created_by||null,createdBy:n,notes:e.notes||"",isPersonal:!!e.is_personal,relatedType1Text:k,relatedTo1Text:A,relatedType2Text:E,relatedTo2Text:M,subject:e.title,relatedType1:w,relatedTo1:S,relatedType2:_,relatedTo2:T}};function wVe(){f.useEffect(()=>{document.title="Tasks | Sari-Sari CRM"},[]);const{user:e,loading:t}=Gt(),[n,s]=f.useState("board"),[r,i]=f.useState(!1),[o,l]=f.useState(null),[c,u]=f.useState(!1),[d,h]=f.useState([]),[p,x]=f.useState(!0),[b,j]=f.useState(""),[y,N]=f.useState("Filter by Status"),[w,S]=f.useState("Filter by Priority"),[_,T]=f.useState([]),[k,A]=f.useState(1),[E,M]=f.useState(10),[F,D]=f.useState(null),[P,B]=f.useState(!1),[G,$]=f.useState([]),[W,Z]=f.useState(null),Q=Et(),le=ta(),[we,J]=f.useState({id:"",subject:"",description:"",priority:"",status:"",dueDate:"",assignedTo:"",notes:"",relatedType1:"Lead",relatedType2:"Contact",relatedTo1:"",relatedTo2:""}),[se,ye]=f.useState(null),Ce=qx(qf(dm,{activationConstraint:{distance:8}})),ge=z=>{const{active:K}=z,ue=d.find(re=>re.id===K.id);Z(ue)},be=async z=>{const{active:K,over:ue}=z;if(Z(null),!ue)return;const re=K.id,Le=ue.id,De=d.find(Qe=>Qe.id===re);if(!(!De||De.status===Le)){h(Qe=>Qe.map(tt=>tt.id===re?{...tt,status:Le}:tt));try{const Qe={title:De.title,description:De.description||"",priority:De.priority||"Normal",status:Le,due_date:De.dueDate||null,assigned_to:De.assignedToId||null,related_type_1:De.relatedType1||null,related_to_1:De.relatedTo1?parseInt(De.relatedTo1,10):null,related_type_2:De.relatedType2||null,related_to_2:De.relatedTo2?parseInt(De.relatedTo2,10):null};(!Qe.related_to_1||isNaN(Qe.related_to_1))&&(Qe.related_to_1=null),(!Qe.related_to_2||isNaN(Qe.related_to_2))&&(Qe.related_to_2=null),await ne.put(`/tasks/${re}`,Qe),V.success(`Task moved to "${Le}"`)}catch(Qe){console.error("Failed to update task status:",Qe),V.error("Failed to update task status"),h(tt=>tt.map(Me=>Me.id===re?{...Me,status:De.status}:Me))}}},me=()=>{Z(null)};f.useEffect(()=>{const z=le.state?.openTaskModal,K=le.state?.initialTaskData,ue=le.state?.taskID;z?(i(!0),K&&J(re=>({...re,...K})),Q(le.pathname,{replace:!0,state:{}})):ue&&(ye(ue),Q(le.pathname,{replace:!0,state:{}}))},[le,Q]),f.useEffect(()=>{if(se&&d.length>0&&!p){const z=d.find(K=>K.id===se);z?xe(z,!0):V.error("Task not found."),ye(null)}},[se,d,p]);const Ae=async()=>{try{const z=await ne.get("/users/all");T(Array.isArray(z.data)?z.data:[])}catch(z){console.error("Failed to fetch users:",z),V.error("Failed to fetch users.")}},pe=async()=>{try{x(!0);const z=await ne.get("/tasks/all"),K=Array.isArray(z.data)?z.data:[];console.log("Raw tasks from API:",K.slice(0,3).map(re=>({id:re.id,title:re.title,created_by:re.created_by,task_creator:re.task_creator})));const ue=K.map(vVe);console.log("Formatted tasks:",ue.map(re=>({id:re.id,title:re.title,createdById:re.createdById}))),console.log("Current user ID:",e?.id),ue.sort((re,Le)=>{const De=re.createdAt?new Date(re.createdAt):0;return(Le.createdAt?new Date(Le.createdAt):0)-De}),h(ue),n==="list"&&A(1)}catch(z){console.error("Failed to load tasks:",z),V.error("Failed to load tasks.")}finally{x(!1)}};f.useEffect(()=>{!t&&e&&(Ae(),pe())},[t,e]);const Ie=()=>{l(null),J({id:"",subject:"",description:"",priority:"Normal",status:"Not started",dueDate:"",assignedTo:"",notes:"",relatedType1:"Lead",relatedType2:"Contact",relatedTo1:"",relatedTo2:""})},xe=(z=null,K=!1)=>{l(z),u(K),z?J({id:z.id,subject:z.title||"",description:z.description||"",priority:z.priority||"Normal",status:z.status||"Not started",dueDate:yVe(z.dueDate),assignedTo:z.assignedToId?String(z.assignedToId):"",assignedToName:z.assignedToName||"",createdBy:z.createdBy||"",createdById:z.createdById||null,notes:z.notes||"",relatedType1Text:z.relatedType1Text||"",relatedTo1Text:z.relatedTo1Text||"",relatedType2Text:z.relatedType2Text||"",relatedTo2Text:z.relatedTo2Text||"",relatedType1:z.relatedType1||"",relatedTo1:z.relatedTo1||"",relatedType2:z.relatedType2||"",relatedTo2:z.relatedTo2||""}):Ie(),i(!0)},he=()=>{i(!1),l(null),u(!1),Ie()},Re=async z=>{const K=bVe(z);try{o&&!c?(await ne.put(`/tasks/${o.id}`,K),V.success("Task updated successfully.")):(await ne.post("/tasks/create",K),V.success("Task created successfully.")),i(!1),await pe()}catch(ue){console.error("Failed to save task:",ue);const re=ue.response?.data?.detail||"Failed to save task.";V.error(re)}},Ee=z=>{if(!z)return;const K=/group.manager/i.test(e?.role);D({title:K?"Archive Task":"Delete Task",message:a.jsxs(a.Fragment,{children:["Are you sure you want to ",K?"archive":"delete"," ",a.jsx("span",{className:"font-semibold",children:z.title}),"?",K?a.jsx("span",{children:" This action will mark the task as inactive."}):a.jsx("span",{children:" This action cannot be undone."})]}),confirmLabel:K?"Archive Task":"Delete Task",cancelLabel:"Cancel",variant:K?"warning":"danger",action:{type:"delete",targetId:z.id}})},He=()=>{if(Fe.every(z=>G.includes(z.id)))$(G.filter(z=>!Fe.map(K=>K.id).includes(z)));else{const z=Fe.map(K=>K.id);$([...new Set([...G,...z])])}},Ke=z=>{Je(at.find(K=>K.id===z))&&$(K=>K.includes(z)?K.filter(ue=>ue!==z):[...K,z])},st=async()=>{if(G.length===0)return;const z=/group.manager/i.test(e?.role);D({title:z?"Archive Tasks":"Delete Tasks",message:a.jsxs("span",{children:["Are you sure you want to ",z?"archive":"delete"," ",a.jsx("span",{className:"font-semibold",children:G.length})," selected tasks? ",z?"This action will mark the tasks as inactive.":"This action cannot be undone."]}),confirmLabel:z?`Archive ${G.length} Task(s)`:`Delete ${G.length} Task(s)`,cancelLabel:"Cancel",variant:z?"warning":"danger",action:{type:"bulk-delete",task_ids:G}})},it=async()=>{if(!F?.action){D(null);return}const{action:z}=F;B(!0);const K=/group.manager/i.test(e?.role);try{z.type==="delete"?(await ne.delete(`/tasks/${z.targetId}`),V.success(K?"Task archived successfully.":"Task deleted successfully."),await pe()):z.type==="bulk-delete"&&(K?(await ne.post("/tasks/bulk-archive",{task_ids:z.task_ids}),V.success(`Successfully archived ${z.task_ids.length} tasks`)):(await ne.delete("/tasks/admin/bulk-delete",{data:{task_ids:z.task_ids}}),V.success(`Successfully deleted ${z.task_ids.length} tasks`)),$([]),await pe())}catch(ue){console.error("Task action failed:",ue),V.error(K?"Failed to archive task.":"Failed to delete task.")}finally{B(!1),D(null)}},ot=()=>{P||D(null)},rt=f.useMemo(()=>{const z=b.trim().toLowerCase();return[...d].sort((ue,re)=>{const Le=ue.createdAt?new Date(ue.createdAt):0;return(re.createdAt?new Date(re.createdAt):0)-Le}).filter(ue=>{const re=z===""||ue.title?.toLowerCase().includes(z)||ue.description?.toLowerCase().includes(z)||ue.assignedToName?.toLowerCase().includes(z)||ue.createdBy?.toLowerCase().includes(z),Le=y==="Filter by Status"||ue.status===y,De=w==="Filter by Priority"||ue.priority===w;return re&&Le&&De})},[d,b,y,w]);f.useEffect(()=>{A(1)},[b,y,w,n,E]),f.useEffect(()=>{if(n==="list"){const z=rt.length===0?1:Math.ceil(rt.length/E);k>z&&A(z)}},[rt.length,k,n,E]);const at=f.useMemo(()=>{if(n==="board")return rt;const z=(k-1)*E;return rt.slice(z,z+E)},[rt,k,n,E]),Je=z=>/group.manager/i.test(e?.role)?String(z?.createdById)===String(e?.id):!0,Fe=f.useMemo(()=>at.filter(Je),[at,e?.role,e?.id]),Ue=f.useMemo(()=>{const z=new Date;return[{title:"To Do",value:d.filter(K=>K.status==="Not started").length,icon:Vn,color:"text-blue-600",bgColor:"bg-blue-100"},{title:"In Progress",value:d.filter(K=>K.status==="In progress").length,icon:Yi,color:"text-purple-600",bgColor:"bg-purple-100"},{title:"Completed",value:d.filter(K=>K.status==="Completed").length,icon:La,color:"text-green-600",bgColor:"bg-green-100"},{title:"Overdue",value:d.filter(K=>K.dueDate&&new Date(K.dueDate)<z&&K.status!=="Completed").length,icon:Fl,color:"text-red-600",bgColor:"bg-red-100"},{title:"High Priority",value:d.filter(K=>K.priority==="High").length,icon:ec,color:"text-orange-600",bgColor:"bg-orange-100"}]},[d]),Ne=z=>z.dueDate&&new Date(z.dueDate)<new Date&&z.status!=="Completed",ze=z=>{switch(z.status){case"Not started":return"bg-blue-50 hover:bg-blue-100 border-blue-200";case"In progress":return"bg-purple-50 hover:bg-purple-100 border-purple-200";case"Deferred":return"bg-orange-50 hover:bg-orange-100 border-orange-200";case"Completed":return"bg-green-50 hover:bg-green-100 border-green-200";default:return"bg-gray-50 hover:bg-gray-100 border-gray-100"}},je=z=>{switch(z){case"Not started":return"bg-blue-100 text-blue-700";case"In progress":return"bg-purple-100 text-purple-700";case"Deferred":return"bg-orange-100 text-orange-700";case"Completed":return"bg-green-100 text-green-700";default:return"bg-gray-100 text-gray-700"}},ve=z=>{switch(z){case"High":return"bg-red-100 text-red-700";case"Normal":return"bg-yellow-100 text-yellow-700";default:return"bg-gray-100 text-gray-700"}};return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 min-h-screen font-inter relative",children:[(p||t)&&a.jsx(qt,{message:"Loading tasks..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 space-y-2 sm:space-y-0",children:[a.jsxs("h1",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[a.jsx(Yi,{className:"text-blue-600"})," Tasks Board"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{type:"button",onClick:()=>xe(),className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 rounded-md hover:bg-gray-800 text-sm sm:text-base self-end sm:self-auto mt-2 lg:mt-0 cursor-pointer",children:[a.jsx(aa,{})," Create Task"]})})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 xl:grid-cols-5 gap-4 mb-6 w-full break-words overflow-hidden lg:overflow-visible",children:Ue.map(z=>a.jsx(jVe,{...z},z.title))}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mt-6 mb-4 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search tasks",value:b,onChange:z=>j(z.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row w-full lg:w-1/2 gap-2",children:[a.jsxs("select",{value:y,onChange:z=>N(z.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{children:"Filter by Status"}),pH.map(z=>a.jsx("option",{children:z},z))]}),a.jsxs("select",{value:w,onChange:z=>S(z.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{children:"Filter by Priority"}),a.jsx("option",{children:"High"}),a.jsx("option",{children:"Normal"}),a.jsx("option",{children:"Low"})]})]})]}),a.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[a.jsx("button",{type:"button",onClick:()=>s("board"),className:`px-4 py-2 rounded-full text-sm ${n==="board"?"bg-gray-800 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Board View"}),a.jsx("button",{type:"button",onClick:()=>s("list"),className:`px-4 py-2 rounded-full text-sm ${n==="list"?"bg-gray-800 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"List View"})]}),!p&&!t&&n==="board"&&(rt.length>0?a.jsxs(Vx,{sensors:Ce,collisionDetection:Gx,onDragStart:ge,onDragEnd:be,onDragCancel:me,children:[a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4 rounded-md",children:pH.map(z=>{const K=at.filter(ue=>ue.status===z);return a.jsx(CVe,{column:z,columnTasks:K,getTaskCardColor:ze,isTaskOverdue:Ne,formatDateDisplay:HT,handleOpenModal:xe,handleDeleteTask:Ee,currentUser:e},z)})}),a.jsx(MN,{children:W?a.jsx(_Ve,{task:W,getTaskCardColor:ze,isTaskOverdue:Ne,formatDateDisplay:HT}):null})]}):a.jsx("div",{className:"col-span-4 text-center py-10 text-gray-500 border border-dashed rounded-xl",children:"No tasks found."})),!p&&!t&&n==="list"&&a.jsx("div",{className:"bg-white rounded-md shadow-sm overflow-hidden",children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-gray-600 text-left",children:a.jsxs("tr",{children:[/group.manager/i.test(e?.role)?a.jsx("th",{className:"py-3 px-4 w-10",children:a.jsx("input",{type:"checkbox",className:"w-4 h-4 accent-blue-600",checked:Fe.length>0&&Fe.every(z=>G.includes(z.id)),onChange:He})}):a.jsx("th",{className:"py-3 px-4 w-10"}),a.jsx("th",{className:"py-3 px-4 font-medium",children:"Task"}),a.jsx("th",{className:"py-3 px-4 font-medium",children:"Status"}),a.jsx("th",{className:"py-3 px-4 font-medium",children:"Priority"}),a.jsx("th",{className:"py-3 px-4 font-medium",children:"Assigned To"}),a.jsx("th",{className:"py-3 px-4 font-medium",children:"Date Assigned"}),a.jsx("th",{className:"py-3 px-4 font-medium text-center w-24",children:G.length>0?a.jsx("button",{onClick:st,className:`transition p-1 rounded-full ${/group.manager/i.test(e?.role)?"text-orange-600 hover:text-orange-800 hover:bg-orange-50":"text-red-600 hover:text-red-800 hover:bg-red-50"}`,title:`${/group.manager/i.test(e?.role)?"Archive":"Delete"} ${G.length} selected tasks`,children:/group.manager/i.test(e?.role)?a.jsx(Zt,{size:18}):a.jsx(_a,{size:18})}):""})]})}),a.jsx("tbody",{children:at.length>0?at.map(z=>a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors text-sm cursor-pointer",children:[/group.manager/i.test(e?.role)?a.jsx("td",{className:"py-3 px-4",onClick:K=>K.stopPropagation(),children:Je(z)&&a.jsx("input",{type:"checkbox",className:"w-4 h-4 accent-blue-600",checked:G.includes(z.id),onChange:()=>Ke(z.id)})}):a.jsx("td",{className:"py-3 px-4"}),a.jsx("td",{className:"py-3 px-4 text-gray-700 whitespace-nowrap font-medium",onClick:()=>xe(z,!0),children:z.title}),a.jsx("td",{className:"py-3 px-4 whitespace-nowrap",onClick:()=>xe(z,!0),children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium whitespace-nowrap ${je(z.status||"Not started")}`,children:z.status||"Not started"})}),a.jsx("td",{className:"py-3 px-4 whitespace-nowrap",onClick:()=>xe(z,!0),children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium whitespace-nowrap ${ve(z.priority||"Low")}`,children:z.priority||"Low"})}),a.jsx("td",{className:"py-3 px-4 text-gray-700 whitespace-nowrap",onClick:()=>xe(z,!0),children:z.assignedToName||"Unassigned"}),a.jsx("td",{className:`py-3 px-4 text-gray-700 whitespace-nowrap ${Ne(z)?"text-red-600 font-medium":""}`,onClick:()=>xe(z,!0),children:z.dueDate?HT(z.dueDate):""}),a.jsx("td",{})]},z.id)):a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"text-center py-4 text-gray-500",children:"No tasks found."})})})]})})}),!p&&!t&&n==="list"&&a.jsx(ca,{className:"mt-6",totalItems:rt.length,pageSize:E,currentPage:rt.length===0?0:k,onPrev:()=>A(z=>Math.max(z-1,1)),onNext:()=>A(z=>Math.min(z+1,Math.max(1,Math.ceil(rt.length/E)||1))),onPageSizeChange:z=>{M(z),A(1)},pageSizeOptions:[10,20,30,40,50],label:"tasks"}),a.jsx(N0,{isOpen:r,onClose:he,onSave:Re,onEdit:()=>u(!1),setFormData:J,formData:we,isEditing:!c&&!!o,viewMode:c,users:_,currentUser:e,onDelete:Ee}),F&&a.jsx(NVe,{open:!0,title:F.title,message:F.message,confirmLabel:F.confirmLabel,cancelLabel:F.cancelLabel,variant:F.variant,onConfirm:it,onCancel:ot,loading:P})]})}function jVe({icon:e,title:t,value:n,color:s,bgColor:r,onClick:i}){return a.jsxs("div",{className:"flex items-center p-4 bg-white rounded-xl shadow-md border border-gray-200 transition-all duration-300 cursor-default",onClick:i,children:[a.jsx("div",{className:`flex-shrink-0 p-3 rounded-full ${r} ${s} mr-4`,children:e?a.jsx(e,{size:22}):null}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:t}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:n})]})]})}function NVe({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r,variant:i,loading:o,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":i==="warning"?"bg-orange-500 hover:bg-orange-600 border border-orange-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsx("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${u}`,disabled:o,children:o?"Processing...":s})]})]})})}function CVe({column:e,columnTasks:t,getTaskCardColor:n,isTaskOverdue:s,formatDateDisplay:r,handleOpenModal:i,handleDeleteTask:o,currentUser:l}){const{isOver:c,setNodeRef:u}=Qx({id:e});return a.jsxs("div",{ref:u,className:`bg-white p-4 shadow border flex flex-col relative rounded-md transition-all duration-200 min-h-[200px] ${c?"border-blue-400 bg-blue-50 ring-2 ring-blue-300":"border-gray-200"}`,children:[a.jsx("div",{className:"absolute top-0 left-0 w-full h-5 bg-secondary rounded-t-md"}),a.jsxs("div",{className:"flex items-center justify-between mb-3 pt-7",children:[a.jsx("h3",{className:"font-medium text-gray-900",children:e}),a.jsx("span",{className:"text-xs bg-gray-100 px-2 py-1 rounded-full text-gray-500",children:t.length})]}),a.jsx("div",{className:`space-y-3 flex-1 ${t.length>3?"overflow-y-auto max-h-[480px] hide-scrollbar":""}`,children:t.length>0?t.map(d=>a.jsx(SVe,{task:d,getTaskCardColor:n,isTaskOverdue:s,formatDateDisplay:r,handleOpenModal:i,handleDeleteTask:o,currentUser:l},d.id)):a.jsx("div",{className:`text-center py-10 text-gray-500 border-2 border-dashed rounded-lg ${c?"border-blue-300 bg-blue-50":"border-gray-200"}`,children:c?"Drop here":"No tasks"})})]})}function SVe({task:e,getTaskCardColor:t,isTaskOverdue:n,formatDateDisplay:s,handleOpenModal:r,handleDeleteTask:i,currentUser:o}){const{attributes:l,listeners:c,setNodeRef:u,transform:d,isDragging:h}=Yx({id:e.id}),p=!(/group.manager/i.test(o?.role)&&String(e?.createdById)!==String(o?.id)),x=d?{transform:`translate3d(${d.x}px, ${d.y}px, 0)`}:void 0;return a.jsxs("div",{ref:u,style:x,className:`border rounded-lg p-3 transition flex justify-between items-start cursor-grab active:cursor-grabbing ${t(e)} ${h?"opacity-50 shadow-lg ring-2 ring-blue-400":""}`,...c,...l,children:[a.jsxs("div",{className:"text-left flex-1",onClick:b=>{b.stopPropagation(),r(e,!0)},children:[a.jsx("p",{className:"font-medium text-gray-800 text-sm",children:e.title}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Priority: ",e.priority]}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Assigned To: ",e.assignedToName]}),a.jsxs("p",{className:"text-xs mt-1 text-gray-500",children:["Date: ",a.jsx("span",{className:n(e)?"text-red-600":"text-gray-600",children:e.dueDate?s(e.dueDate):""})]})]}),p&&a.jsxs("div",{className:"flex items-center gap-2 ml-3",onClick:b=>b.stopPropagation(),children:[a.jsx("button",{type:"button",onClick:b=>{b.stopPropagation(),r(e)},className:"text-blue-500 hover:text-blue-700",children:a.jsx(hn,{})}),a.jsx("button",{type:"button",onClick:b=>{b.stopPropagation(),i(e)},className:`${/group.manager/i.test(o?.role)?"text-orange-500 hover:text-orange-700":"text-red-500 hover:text-red-700"}`,children:/group.manager/i.test(o?.role)?a.jsx(Zt,{}):a.jsx(_a,{})})]})]})}function _Ve({task:e,getTaskCardColor:t,isTaskOverdue:n,formatDateDisplay:s}){return a.jsx("div",{className:`border rounded-lg p-3 shadow-xl ring-2 ring-blue-400 ${t(e)}`,style:{width:"280px"},children:a.jsxs("div",{className:"text-left flex-1",children:[a.jsx("p",{className:"font-medium text-gray-800 text-sm",children:e.title}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Priority: ",e.priority]}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Assigned To: ",e.assignedToName]}),a.jsxs("p",{className:"text-xs mt-1 text-gray-500",children:["Date: ",a.jsx("span",{className:n(e)?"text-red-600":"text-gray-600",children:e.dueDate?s(e.dueDate):""})]})]})})}const $ee=e=>e?e.toUpperCase():"",au=e=>{const t=$ee(e);return t==="PLANNED"||t==="IN PROGRESS"?"PLANNED":t==="HELD"||t==="DONE"?"HELD":t==="NOT_HELD"||t==="NOT HELD"?"NOT_HELD":"PLANNED"},AVe=e=>{if(!e)return"";const t=String(e).split("-");return t.length===3?`${t[0]}-${t[2]}`:String(e)},TVe=e=>{if(!e)return"--";try{return new Date(e).toLocaleString()}catch{return"--"}},kVe=e=>{const t=$ee(e);switch(t==="PLANNED"?"PENDING":t==="HELD"?"COMPLETED":t==="NOT_HELD"?"CANCELLED":t){case"PENDING":return"bg-indigo-100 text-indigo-700";case"COMPLETED":case"DONE":return"bg-green-100 text-green-700";case"CANCELLED":return"bg-gray-200 text-gray-700";case"IN PROGRESS":return"bg-blue-100 text-blue-700";default:return"bg-gray-100 text-gray-700"}},qT={subject:"",startTime:"",endTime:"",location:"",status:"PLANNED",notes:"",assignedTo:"",relatedType1:"Lead",relatedTo1:"",relatedType2:null,relatedTo2:""},EVe=()=>{const e=Et(),t=ta(),[n]=Bs(),s=n.get("id"),r=t.pathname==="/admin/meetings/info";f.useEffect(()=>{document.title="Meetings | Sari-Sari CRM"},[]);const[i,o]=f.useState([]),[l,c]=f.useState(!1),[u,d]=f.useState([]),[h,p]=f.useState(""),[x,b]=f.useState("Filter by Status"),[j,y]=f.useState(!1),[N,w]=f.useState(null),[S,_]=f.useState(1),[T,k]=f.useState(10),[A,E]=f.useState(qT),[M,F]=f.useState(!1),[D,P]=f.useState(null),[B,G]=f.useState(!1),[$,W]=f.useState(null),[Z,Q]=f.useState(!1),[le,we]=f.useState(null),[J,se]=f.useState(new Set),[ye,Ce]=f.useState(!1),{user:ge}=Gt();f.useEffect(()=>{const K=t.state?.openMeetingModal,ue=t.state?.initialMeetingData?.relatedTo||n.get("id"),re=t.state?.meetingID;K||ue?(y(!0),t.state?.initialMeetingData&&E(Le=>({...Le,...t.state.initialMeetingData})),e(t.pathname,{replace:!0,state:{}})):re&&(we(re),e(t.pathname,{replace:!0,state:{}}))},[t,n,e]),f.useEffect(()=>{if(le&&i.length>0&&!l){const K=i.find(ue=>ue.id===le);K?w(K):V.error("Meeting not found."),we(null)}},[le,i,l]);const be=async()=>{if(s&&r){const K=sessionStorage.getItem("meetingDetailData");if(K)try{const ue=JSON.parse(K);if(ue.id===parseInt(s)){w(ue),sessionStorage.removeItem("meetingDetailData");return}}catch(ue){console.error(ue)}}c(!0);try{const K=await ne.get("/meetings/admin/fetch-all"),re=[...Array.isArray(K.data)?K.data:[]].sort((Le,De)=>{const Qe=Le?.created_at?new Date(Le.created_at).getTime():0;return(De?.created_at?new Date(De.created_at).getTime():0)-Qe});if(o(re),s&&!N){const Le=re.find(De=>De.id===parseInt(s));Le&&w(Le)}}catch{V.error("Failed to load meetings.")}finally{c(!1)}},me=async()=>{try{const K=await ne.get("/users/all");d(Array.isArray(K.data)?K.data:[])}catch(K){console.error(K)}};f.useEffect(()=>{be(),me()},[]);const Ae=K=>p(K.target.value),pe=f.useMemo(()=>{if(!ge?.id)return[];const K=ge?.role?.toUpperCase();return K==="GROUP MANAGER"||K==="CEO"||K==="ADMIN"?i:i.filter(ue=>ue.created_by===ge.id||ue.meet_assign_to?.id===ge.id)},[i,ge?.id,ge?.role]),he=["GROUP MANAGER","MANAGER","SALES"].includes(ge?.role?.toUpperCase())?pe.filter(K=>!(K.status?.toUpperCase()==="INACTIVE")):pe,Re=f.useMemo(()=>{const K=h.trim().toLowerCase(),ue=x.trim().toUpperCase();return he.filter(re=>{const Le=[re?.subject,re?.location,re?.notes,re?.lead?.title,re?.account?.name,re?.contact?.first_name,re?.contact?.last_name,re?.deal?.name,re?.quote?.quote_id,re?.meet_assign_to?.first_name,re?.meet_assign_to?.last_name].filter(Boolean).join(" ").toLowerCase(),De=K===""||Le.includes(K),Qe=ue==="FILTER BY STATUS"||au(re.status||"PENDING")===ue;return De&&Qe})},[he,h,x]),Ee=he.length,He=he.filter(K=>au(K.status)==="PLANNED").length,Ke=he.filter(K=>au(K.status)==="HELD").length,st=he.filter(K=>au(K.status)==="NOT_HELD").length,it=[{title:"Total",value:Ee,icon:Pt,color:"text-slate-600",bgColor:"bg-slate-100"},{title:"Planned",value:He,icon:Vn,color:"text-indigo-600",bgColor:"bg-indigo-100"},{title:"Held",value:Ke,icon:La,color:"text-green-600",bgColor:"bg-green-100"},{title:"Not Held",value:st,icon:Yn,color:"text-gray-600",bgColor:"bg-gray-100"}],ot=f.useMemo(()=>{const K=(S-1)*T;return Re.slice(K,K+T)},[Re,S,T]),rt=()=>{y(!1),E(qT),F(!1),P(null),G(!1)},at=()=>{E(qT),F(!1),P(null),y(!0)},Je=K=>{let ue="";if(K.meet_assign_to?.id)ue=String(K.meet_assign_to.id);else if(K.assignedTo){const _t=u.find(Ct=>`${Ct.first_name} ${Ct.last_name}`===K.assignedTo);ue=_t?String(_t.id):""}const re=_t=>{if(!_t)return"";try{const Ct=new Date(_t),jt=Ct.getTimezoneOffset()*6e4;return new Date(Ct.getTime()-jt).toISOString().slice(0,16)}catch{return""}};let Le="Lead",De="",Qe="Contact",tt="";if(K.lead)Le="Lead",De=String(K.lead.id);else if(K.account)Le="Account",De=String(K.account.id),K.contact?(Qe="Contact",tt=String(K.contact.id)):K.deal?(Qe="Deal",tt=String(K.deal.id)):K.quote&&(Qe="Quote",tt=String(K.quote.id));else if(K.relatedType||K.related_type){const _t=K.relatedType||K.related_type,Ct=K.related_to||K.relatedToId;_t==="Lead"?(Le="Lead",De=String(Ct)):(Le="Account",De=K.account_id?String(K.account_id):"")}const Me={PLANNED:"Planned",HELD:"Held",NOT_HELD:"Not held"},et=au(K.status),yt=Me[et]||"Planned";E({subject:K.subject||K.activity||"",location:K.location||"",startTime:re(K.start_time||K.startTime),endTime:re(K.end_time||K.endTime),status:yt,notes:K.description||K.notes||"",assignedTo:ue,relatedType1:Le,relatedTo1:De,relatedType2:Qe,relatedTo2:tt}),F(!0),P(K.id),w(null),y(!0)},Fe=K=>{if(!K.subject?.trim())return V.error("Subject is required.");if(!K.startTime)return V.error("Start time is required.");if(K.endTime&&!(new Date(K.endTime)-new Date(K.startTime)>0))return V.error("End time must be after start time.");K.relatedType1,K.relatedTo1,K.relatedType1==="Account"&&K.relatedType2&&K.relatedTo2&&(K.relatedType2,K.relatedTo2);const ue={...K,assignedTo:parseInt(K.assignedTo),relatedTo1:parseInt(K.relatedTo1),relatedTo2:parseInt(K.relatedTo2)},re=M&&D?"update":"create";W({title:re==="create"?"Confirm New Meeting":"Confirm Update",message:`Are you sure you want to ${re} "${ue.subject}"?`,confirmLabel:re==="create"?"Create Meeting":"Update Meeting",variant:"primary",action:{type:re,payload:ue,targetId:D,name:ue.subject}})},Ue=async()=>{if(!$?.action)return;const{type:K,payload:ue,targetId:re,name:Le,targetIds:De,count:Qe}=$.action;Q(!0);try{if(K==="create")G(!0),await ne.post("/meetings/create",ue),V.success(`Meeting "${Le}" created.`),rt(),await be();else if(K==="update")G(!0),await ne.put(`/meetings/${re}`,ue),V.success(`Meeting "${Le}" updated.`),rt(),await be();else if(K==="delete")await ne.put("/meetings/bulk-archive",{meeting_ids:[re]}),V.success(`Meeting "${Le}" archived successfully.`),N?.id===re&&w(null),await be();else if(K==="bulk-delete"){if(!De||De.length===0)throw new Error("Missing meeting identifiers for bulk archiving.");Ce(!0),await ne.put("/meetings/bulk-archive",{meeting_ids:De}),V.success(`${Qe} meeting${Qe!==1?"s":""} archived successfully.`),se(new Set),await be(),N&&J.has(N.id)&&w(null)}}catch(tt){const Me=K==="create"?"Failed to create meeting. Please review the details and try again.":K==="update"?"Failed to update meeting. Please review the details and try again.":K==="bulk-delete"?"Failed to archive meetings. Please try again.":"Failed to archive meeting. Please try again.",et=tt?.response?.data?.detail||Me;V.error(et),console.error(tt)}finally{(K==="create"||K==="update")&&G(!1),K==="bulk-delete"&&Ce(!1),Q(!1),W(null)}},Ne=K=>{W({title:"Archive Meeting",message:`Are you sure you want to archive "${K.subject||K.activity}"? You can restore it later if needed.`,confirmLabel:"Archive",variant:"archive",action:{type:"delete",targetId:K.id,name:K.subject||K.activity}})},ze=K=>{const ue=ot.find(re=>re.id===K);ue&&ue.created_by===ge?.id&&se(re=>{const Le=new Set(re);return Le.has(K)?Le.delete(K):Le.add(K),Le})},je=()=>{const K=ot.filter(ue=>ue.created_by===ge?.id);J.size===K.length?se(new Set):se(new Set(K.map(ue=>ue.id)))},ve=()=>{if(J.size===0)return;const K=J.size;W({title:"Archive Meetings",message:a.jsxs("span",{children:["Are you sure you want to archive"," ",a.jsx("span",{className:"font-semibold",children:K})," meeting",K!==1?"s":"","? You can restore them later if needed."]}),confirmLabel:`Archive ${K} Meeting${K!==1?"s":""}`,cancelLabel:"Cancel",variant:"archive",action:{type:"bulk-delete",targetIds:Array.from(J),count:K}})},z=async(K,ue)=>{try{await ne.put(`/meetings/${K}`,{status:ue}),V.success("Status updated"),be(),w(null)}catch{V.error("Failed to update status")}};return r&&s?N?a.jsx(jd,{meeting:N,onClose:()=>{w(null),e("/admin/dashboard")},onEdit:Je,onDelete:Ne,onStatusUpdate:z,currentUser:ge,isSalesView:!0}):a.jsx(qt,{message:"Loading meeting..."}):a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[l&&a.jsx(qt,{message:"Loading meetings..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h1",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800 mb-4 lg:mb-0",children:[a.jsx(Pt,{className:"mr-2 text-blue-600"})," Meetings"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{onClick:at,className:"bg-black text-white px-4 py-2 rounded-md flex items-center hover:bg-gray-800",children:[a.jsx(aa,{className:"mr-2"})," Add Meeting"]})})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-4 mb-6 w-full break-words overflow-hidden lg:overflow-visible",children:it.map(K=>a.jsx(DVe,{...K},K.title))}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full sm:w-auto lg:w-4/4 md:w-3/4",children:[a.jsx(Kt,{className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search meetings",value:h,onChange:Ae,className:"w-full outline-none"})]}),a.jsxs("select",{value:x,onChange:K=>b(K.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm bg-white w-full sm:w-auto",children:[a.jsx("option",{children:"Filter by Status"}),a.jsx("option",{value:"PLANNED",children:"PLANNED"}),a.jsx("option",{value:"HELD",children:"HELD"}),a.jsx("option",{value:"NOT_HELD",children:"NOT HELD"})]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[500px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm mb-4",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 w-12",children:a.jsx("input",{type:"checkbox",checked:J.size===ot.filter(K=>K.created_by===ge?.id).length&&ot.filter(K=>K.created_by===ge?.id).length>0,onChange:je,className:"w-4 h-4 cursor-pointer rounded border-gray-300"})}),a.jsx("th",{className:"py-3 px-4",children:"Subject"}),a.jsx("th",{className:"py-3 px-4",children:"Related To"}),a.jsx("th",{className:"py-3 px-4",children:"Start Time"}),a.jsx("th",{className:"py-3 px-4",children:"Assigned"}),a.jsx("th",{className:"py-3 px-4",children:"Status"}),a.jsx("th",{className:"py-3 px-4 w-12",children:J.size>0&&a.jsx("button",{onClick:ve,className:"text-orange-500 hover:text-orange-700 transition",title:"Archive selected meetings",disabled:ye,children:a.jsx(Zt,{size:18})})})]})}),a.jsx("tbody",{children:ot.length>0?ot.map(K=>a.jsxs("tr",{onClick:()=>w(K),className:"hover:bg-gray-50 cursor-pointer border-b border-gray-100",children:[a.jsx("td",{className:"py-3 px-4",onClick:ue=>ue.stopPropagation(),children:ge?.id===K.created_by&&a.jsx("input",{type:"checkbox",checked:J.has(K.id),onChange:ue=>{ue.stopPropagation(),ze(K.id)},className:"w-4 h-4 cursor-pointer rounded border-gray-300"})}),a.jsx("td",{className:"py-3 px-4 font-medium text-blue-600",children:K.subject}),a.jsxs("td",{className:"py-3 px-4",children:[K.lead&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:K.lead.title}),K.account&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:K.account.name}),K.contact&&a.jsxs("p",{className:"font-medium text-blue-500 text-xs",children:[K.contact.first_name," ",K.contact.last_name]}),K.deal&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:K.deal.name}),K.quote&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:AVe(K.quote.quote_id)})]}),a.jsx("td",{className:"py-3 px-4",children:TVe(K.start_time)}),a.jsxs("td",{className:"py-3 px-4",children:[K.meet_assign_to.first_name," ",K.meet_assign_to.last_name]}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${kVe(au(K.status))}`,children:au(K.status).replace("_"," ")})})]},K.id)):a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"text-center py-4 text-gray-500",children:"No meetings found."})})})]})}),a.jsx(ca,{totalItems:Re.length,pageSize:T,currentPage:S,onPrev:()=>_(K=>Math.max(1,K-1)),onNext:()=>_(K=>K+1),onPageSizeChange:k,label:"meetings"}),j&&a.jsx(O1,{onClose:rt,formData:A,setFormData:E,isEditing:M,onSubmit:Fe,isSubmitting:B||Z,users:u}),N&&a.jsx(jd,{meeting:N,onClose:()=>w(null),onEdit:Je,onDelete:Ne,onStatusUpdate:z,currentUser:ge,isSalesView:!0}),$&&a.jsx(LVe,{open:!0,title:$.title,message:$.message,confirmLabel:$.confirmLabel,variant:$.variant,onConfirm:Ue,onCancel:()=>W(null),loading:Z})]})};function LVe({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":i==="archive"?"bg-orange-500 hover:bg-orange-600 border border-orange-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{onClick:c,disabled:o,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",children:"Cancel"}),a.jsx("button",{onClick:l,disabled:o,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70
                       ${u}`,children:o?"...":s})]})]})})}function DVe({icon:e,title:t,value:n,color:s,bgColor:r}){return a.jsxs("div",{className:"flex items-center p-4 bg-white rounded-xl shadow-md border border-gray-200",children:[a.jsx("div",{className:`p-3 rounded-full ${r} ${s} mr-4`,children:a.jsx(e,{size:22})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:t}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:n})]})]})}const PVe=[{value:"PLANNED",label:"PLANNED"},{value:"HELD",label:"HELD"},{value:"NOT_HELD",label:"NOT HELD"}],OVe=e=>e?String(e).toUpperCase():"",pu=e=>{const t=OVe(e);return t==="PLANNED"||t==="PENDING"?"PLANNED":t==="HELD"||t==="COMPLETED"?"HELD":t==="NOT HELD"||t==="NOT_HELD"||t==="CANCELLED"?"NOT_HELD":"PLANNED"},GT=e=>{const t=pu(e);return t==="PLANNED"?"PLANNED":t==="HELD"?"HELD":t==="NOT_HELD"?"NOT HELD":"--"},yH=e=>{switch(pu(e)){case"PLANNED":return"bg-indigo-100 text-indigo-700";case"HELD":return"bg-green-100 text-green-700";case"NOT_HELD":return"bg-gray-200 text-gray-700";default:return"bg-gray-100 text-gray-700"}},bH=e=>e?new Date(e).toLocaleString("en-US",{month:"2-digit",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}):"--";function MVe(){const[e,t]=f.useState(!1),[n,s]=f.useState(null),[r,i]=f.useState(null),[o,l]=f.useState(null),[c,u]=f.useState(null),[d,h]=f.useState([]),[p,x]=f.useState(null),[b,j]=f.useState(!1),[y,N]=f.useState(null),[w,S]=f.useState(!1),[_,T]=f.useState(!1),[k,A]=f.useState("PLANNED"),[E,M]=f.useState(!1),[F,D]=f.useState(!1),[P,B]=f.useState(null),[G,$]=f.useState(new Set),[W,Z]=f.useState(!1),{user:Q}=Gt(),{comments:le,addComment:we,refresh:J}=kn({relatedType:"call",relatedId:n?.id});f.useEffect(()=>{n?.id&&J()},[n?.id,J]),Bs();const se=Et(),ye=ta(),Ce=q=>{if(!q)return"";const Y=String(q).split("-");return Y.length===3?`${Y[0]}-${Y[2]}`:String(q)},be={subject:"",call_time:(()=>{const q=new Date,Y=q.getFullYear(),U=String(q.getMonth()+1).padStart(2,"0"),de=String(q.getDate()).padStart(2,"0");return`${Y}-${U}-${de}T08:00`})(),duration_minutes:"",direction:"Outgoing",status:"Planned",notes:"",relatedType1:"Lead",relatedType2:null,relatedTo1:null,relatedTo2:null,assigned_to:null},[me,Ae]=f.useState(be);f.useEffect(()=>{const q=ye.state,Y=q?.callID;if(Y&&!q?.openCallModal){B(Y),se(ye.pathname,{replace:!0,state:{}});return}!q?.openCallModal||!q?.initialCallData||q.initialCallData.relatedType1==="Lead"&&Array.isArray(o)&&o.length===0||q.initialCallData.relatedType1==="Account"&&(!Array.isArray(o)||o.length===0)||(t(!0),Ae(U=>({...U,...q.initialCallData,relatedTo1:q.initialCallData.relatedTo1?String(q.initialCallData.relatedTo1):"",relatedTo2:q.initialCallData.relatedTo2?String(q.initialCallData.relatedTo2):""})),se(ye.pathname,{replace:!0,state:{}}))},[ye.state,o]),f.useEffect(()=>{if(P&&d.length>0&&!F){const q=d.find(Y=>Y.id===P);q?s(q):V.error("Call not found."),B(null)}},[P,d,F]);const pe=async()=>{try{D(!0);const q=await ne.get("/calls/admin/fetch-all"),U=[...Array.isArray(q.data)?q.data:[]].sort((de,Te)=>{const ie=de?.created_at?new Date(de.created_at):0;return(Te?.created_at?new Date(Te.created_at):0)-ie});h(U)}catch(q){console.error("Error fetching calls:",q),V.error("Failed to load calls")}finally{D(!1)}},Ie=async()=>{try{const q=await ne.get("/users/all");x(q.data)}catch(q){console.error("Error fetching users: ",q)}};f.useEffect(()=>{Ie(),pe()},[]);const[xe,he]=f.useState(""),[Re,Ee]=f.useState("Filter by Status"),[He,Ke]=f.useState("Filter by Users"),[st,it]=f.useState(1),[ot,rt]=f.useState(10),at=Array.isArray(p)?p.map(q=>({id:q.id,name:`${q.first_name} ${q.last_name}`})):[],Fe=["GROUP MANAGER","MANAGER","SALES"].includes(Q?.role?.toUpperCase())?d.filter(q=>q.status!=="INACTIVE"):d,Ue=f.useMemo(()=>Fe.filter(q=>{const Y=!xe||[q.subject,q.notes,q.lead?.title,q.account?.name,q.contact?.first_name,q.contact?.last_name,q.deal?.name].some(ie=>ie&&String(ie).toLowerCase().includes(xe.toLowerCase())),U=Re==="Filter by Status"||pu(q.status)===Re,de=q.call_assign_to?`${q.call_assign_to.first_name} ${q.call_assign_to.last_name}`:"";return Y&&U&&(He==="Filter by Users"||de===He)}),[Fe,xe,Re,He]),Ne=Math.max(1,Math.ceil(Ue.length/ot)||1);f.useEffect(()=>{it(1)},[xe,Re,He,ot]),f.useEffect(()=>{it(q=>{const Y=Math.max(1,Math.ceil(Ue.length/ot)||1);return q>Y?Y:q})},[Ue.length,ot]);const ze=f.useMemo(()=>{const q=(st-1)*ot;return Ue.slice(q,q+ot)},[Ue,st,ot]),je=()=>it(q=>Math.max(q-1,1)),ve=()=>it(q=>Math.min(q+1,Ne)),z=Fe.length,K=Fe.filter(q=>pu(q.status)==="PLANNED").length,ue=Fe.filter(q=>pu(q.status)==="HELD").length,re=Fe.filter(q=>pu(q.status)==="NOT_HELD").length,Le=[{title:"Total",value:z,icon:Us,color:"text-slate-600",bgColor:"bg-slate-100"},{title:"Planned",value:K,icon:Vn,color:"text-indigo-600",bgColor:"bg-indigo-100"},{title:"Held",value:ue,icon:La,color:"text-green-600",bgColor:"bg-green-100"},{title:"Not Held",value:re,icon:Yn,color:"text-gray-600",bgColor:"bg-gray-100"}],[De,Qe]=f.useState("Overview"),tt=q=>{const{name:Y,value:U}=q.target;Ae(de=>{const Te={...de,[Y]:U};return Y==="relatedType1"&&(Te.relatedTo1="",U==="Lead"?(Te.relatedType2=null,Te.relatedTo2=null,u([])):U==="Account"&&(Te.relatedType2="Contact")),Y==="relatedType2"&&(Te.relatedTo2=""),Te})};f.useEffect(()=>{const q=async()=>{try{l([]);let Y;me.relatedType1==="Lead"?Y=await ne.get("/leads/admin/getLeads"):me.relatedType1==="Account"&&(Y=await ne.get("/accounts/admin/fetch-all"));let U=[];if(Y&&Array.isArray(Y.data)?U=Y.data:U=[],b&&me.relatedTo1)try{let de;me.relatedType1==="Lead"?de=await ne.get(`/leads/get/${me.relatedTo1}`):me.relatedType1==="Account"&&(de=await ne.get(`/accounts/get/${me.relatedTo1}`)),de&&de.data&&(U.some(ie=>String(ie.id)===String(me.relatedTo1))||(U=[de.data,...U]))}catch(de){console.error("Error fetching specific related item:",de)}l(U)}catch(Y){console.error("Error fetching data:",Y),l([])}};me.relatedType1&&q()},[me.relatedType1,b,me.relatedTo1]),f.useEffect(()=>{const q=async()=>{try{u([]);let Y;if(me.relatedType1==="Account"&&me.relatedTo1)me.relatedType2==="Contact"?Y=await ne.get(`/contacts/from-acc/${me.relatedTo1}`):me.relatedType2==="Deal"?Y=await ne.get(`/deals/from-acc/${me.relatedTo1}`):me.relatedType2==="Quote"&&(Y=await ne.get(`/quotes/from-acc/${me.relatedTo1}`));else{u([]);return}let U=[];if(Y&&Array.isArray(Y.data)?U=Y.data:U=[],b&&me.relatedTo2)try{let de;me.relatedType2==="Contact"?de=await ne.get(`/contacts/get/${me.relatedTo2}`):me.relatedType2==="Deal"?de=await ne.get(`/deals/get/${me.relatedTo2}`):me.relatedType2==="Quote"&&(de=await ne.get(`/quotes/get/${me.relatedTo2}`)),de&&de.data&&(U.some(ie=>String(ie.id)===String(me.relatedTo2))||(U=[de.data,...U]))}catch(de){console.error("Error fetching specific related item:",de)}u(U)}catch(Y){console.error("Error fetching data:",Y),u([])}};me.relatedType2&&q()},[me.relatedType2,me.relatedTo1,me.relatedType1,b,me.relatedTo2]);const[Me,et]=f.useState(!1),yt=q=>{q.preventDefault(),et(!0);const Y=me.subject;if(!Y||Y.trim()===""){V.error("Subject is required.");return}if(!me.relatedTo1){V.error(`Please select a ${me.relatedType1||"Lead/Account"}.`);return}if(!me.assigned_to){V.error("Subject is required.");return}const de={...me,duration_minutes:me.duration_minutes?parseInt(me.duration_minutes,10):null,relatedTo1:me.relatedTo1?parseInt(me.relatedTo1,10):null,relatedTo2:me.relatedType1==="Lead"?null:me.relatedTo2?parseInt(me.relatedTo2,10):null,relatedType2:me.relatedType1==="Lead"?null:me.relatedType2,assigned_to:me.assigned_to?parseInt(me.assigned_to,10):null},Te=b&&y?"update":"create",ie=(me.subject||"").trim()||"Untitled Call";i({title:Te==="create"?"Confirm New Call":"Confirm Update",message:Te==="create"?`Create "${ie}"?`:`Save changes to "${ie}"?`,confirmLabel:Te==="create"?"Create Call":"Update Call",cancelLabel:"Cancel",variant:"primary",action:{type:Te,payload:de,targetId:y||null,name:ie}})},_t=q=>s(q),Ct=()=>{t(!1),j(!1),N(null)},jt=async()=>{if(!r?.action){i(null);return}const{action:q}=r,{type:Y,payload:U,targetId:de,name:Te}=q;T(!0);try{if(Y==="create")S(!0),await ne.post("/calls/create",U),V.success(`Call "${Te}" created successfully.`),t(!1),Ae(be),j(!1),N(null),await pe();else if(Y==="update"){if(!de)throw new Error("Missing call identifier for update.");S(!0),await ne.put(`/calls/${de}`,U),V.success(`Call "${Te}" updated successfully.`),t(!1),Ae(be),j(!1),N(null),await pe()}else if(Y==="delete"){if(!de)throw new Error("Missing call identifier for archiving.");await ne.put(`/calls/${de}`,{status:"INACTIVE"}),V.success(`Call "${Te}" archived successfully.`),n?.id===de&&s(null),await pe()}else if(Y==="bulk-delete"){const{targetIds:ie,count:Oe}=q;if(!ie||ie.length===0)throw new Error("Missing call identifiers for bulk archiving.");Z(!0),await ne.put("/calls/bulk-archive",{call_ids:ie}),V.success(`${Oe} call${Oe!==1?"s":""} archived successfully.`),$(new Set),await pe(),n&&G.has(n.id)&&s(null)}}catch(ie){const Oe=Y==="create"?"Failed to create call. Please review the details and try again.":Y==="update"?"Failed to update call. Please review the details and try again.":Y==="bulk-delete"?"Failed to archive calls. Please try again.":"Failed to archive call. Please try again.",X=ie?.response?.data?.detail||Oe;V.error(X)}finally{(Y==="create"||Y==="update")&&S(!1),Y==="bulk-delete"&&Z(!1),T(!1),i(null)}},At=()=>{_||i(null)},Ge=q=>{const Y=ze.find(U=>U.id===q);Y&&Y.call_creator?.id===Q?.id&&$(U=>{const de=new Set(U);return de.has(q)?de.delete(q):de.add(q),de})},Be=()=>{const q=ze.filter(Y=>Y.call_creator?.id===Q?.id);G.size===q.length?$(new Set):$(new Set(q.map(Y=>Y.id)))},ce=()=>{if(G.size===0)return;const q=G.size;i({title:"Archive Calls",message:a.jsxs("span",{children:["Are you sure you want to archive"," ",a.jsx("span",{className:"font-semibold",children:q})," call",q!==1?"s":"","? You can restore them later if needed."]}),confirmLabel:`Archive ${q} Call${q!==1?"s":""}`,cancelLabel:"Cancel",variant:"archive",action:{type:"bulk-delete",targetIds:Array.from(G),count:q}})},fe=async()=>{if(n?.id)try{M(!0),await ne.put(`/calls/${n.id}`,{status:k}),V.success(`Status updated to ${GT(k)}`),h(q=>Array.isArray(q)?q.map(Y=>Y.id===n.id?{...Y,status:k}:Y):q),s(null)}catch(q){const Y=q.response?.data?.detail||"Failed to update status.";V.error(Y)}finally{M(!1)}};f.useEffect(()=>{n&&A(pu(n.status))},[n]);const H=n?a.jsxs("div",{id:"callModalBackdrop",onClick:q=>q.target.id==="callModalBackdrop"&&s(null),className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center p-4",children:[F&&a.jsx(qt,{message:"Loading call details..."}),a.jsxs("div",{className:"bg-white rounded-xl shadow-lg w-full max-w-full lg:max-w-4xl max-h-[95vh] overflow-y-auto hide-scrollbar relative box-border",children:[a.jsxs("div",{className:"bg-tertiary w-full rounded-t-xl p-3 lg:p-3 relative",children:[a.jsx("h1",{className:"lg:text-3xl text-xl text-white font-semibold text-center w-full",children:"Calls"}),a.jsx("button",{onClick:()=>s(null),className:"text-gray-500 hover:text-white transition cursor-pointer absolute top-3 right-3",children:a.jsx(Za,{size:25})})]}),a.jsx("div",{className:"mt-4 gap-2 px-2 lg:gap-4 lg:mx-7",children:a.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between lg:flex-row lg:items-center lg:justify-between mt-3 gap-2 px-2 md:items-center lg:gap-4 md:mx-7 lg:mx-7",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[a.jsx("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-800",children:n.subject}),a.jsx("span",{className:`text-xs sm:text-sm font-medium px-2 sm:px-3 py-1 rounded-full ${yH(n.status)}`,children:GT(n.status)})]}),a.jsx("div",{className:"flex flex-col sm:flex-row sm:space-x-3 space-y-2 sm:space-y-0",children:Q?.id===n.call_creator?.id&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{className:"inline-flex items-center justify-center w-full sm:w-auto bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 transition text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",onClick:()=>{const q=ie=>{if(!ie)return"";const Oe=new Date(ie),X=Oe.getFullYear(),oe=String(Oe.getMonth()+1).padStart(2,"0"),Pe=String(Oe.getDate()).padStart(2,"0"),Ve=String(Oe.getHours()).padStart(2,"0"),ft=String(Oe.getMinutes()).padStart(2,"0");return`${X}-${oe}-${Pe}T${Ve}:${ft}`},Y=n.lead?"Lead":n.account?"Account":"Lead",U=n.lead?n.lead.id:n.account?n.account.id:null,de=Y==="Lead"?null:n.contact?"Contact":n.deal?"Deal":n.quote?"Quote":"Contact",Te=Y==="Lead"?null:n.contact?n.contact.id:n.deal?n.deal.id:n.quote?n.quote.id:null;Ae({subject:n.subject||"",call_time:q(n.call_time),duration_minutes:n.duration_minutes?String(n.duration_minutes):"",direction:n.direction||"Outgoing",status:n.status||"Planned",notes:n.notes||"",relatedType1:Y,relatedType2:de,relatedTo1:U?String(U):"",relatedTo2:Te?String(Te):"",assigned_to:n.call_assign_to?.id?String(n.call_assign_to.id):""}),j(!0),N(n.id),s(null),t(!0)},children:[a.jsx(gn,{className:"mr-2"}),"Edit"]}),a.jsxs("button",{className:"inline-flex items-center justify-center w-full sm:w-auto px-4 py-2 rounded-md text-sm bg-orange-500 text-white hover:bg-orange-600 transition focus:outline-none focus:ring-2 focus:ring-orange-400",onClick:()=>{const q=n.subject||"this call";i({title:"Archive Call",message:`Are you sure you want to archive "${q}"? You can restore it later if needed.`,confirmLabel:"Archive Call",cancelLabel:"Cancel",variant:"archive",action:{type:"delete",targetId:n.id,name:q}})},children:[a.jsx(Zt,{className:"mr-2"}),"Archive"]})]})})]})}),a.jsx("div",{className:"border-b border-gray-200 my-5"}),a.jsxs("div",{className:"p-6 lg:p-4",children:[a.jsx("div",{className:"flex w-full bg-[#6A727D] text-white mt-1 overflow-x-auto mb-6",children:["Overview","Notes"].map(q=>a.jsx("button",{onClick:()=>Qe(q),className:`flex-1 min-w-[90px] px-4 py-2.5 text-xs sm:text-sm font-medium border-b-2 ${De===q?"bg-paper-white text-[#6A727D] border-white":"text-white hover:bg-[#5c636d]"}`,children:q},q))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 items-start",children:[a.jsxs("div",{className:"lg:col-span-3",children:[De==="Overview"&&a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 md:p-8 border border-gray-200",children:a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4 sm:gap-6 text-sm text-gray-700",children:[a.jsx(wo,{label:"Call Time",value:bH(n.call_time)}),a.jsx(wo,{label:"Duration",value:n.duration_minutes?`${n.duration_minutes} min`:null}),a.jsx(wo,{label:"Direction",value:n.direction||"--"}),a.jsx(wo,{label:"Assigned To",value:`${n.call_assign_to.first_name} ${n.call_assign_to.last_name}`}),n.lead&&a.jsx(wo,{label:"Lead",value:n.lead.title}),n.account&&a.jsx(wo,{label:"Account",value:n.account.name}),n.contact&&a.jsx(wo,{label:"Contact",value:`${n.contact.first_name} ${n.contact.last_name}`}),n.deal&&a.jsx(wo,{label:"Deal",value:n.deal.name}),n.quote&&a.jsx(wo,{label:"Quote",value:Ce(n.quote.quote_id)}),a.jsx(wo,{label:"Created At",value:bH(n.created_at)})]})}),De==="Notes"&&a.jsxs("div",{className:"mt-4 w-full",children:[a.jsx("div",{className:"flex flex-wrap items-center justify-between mb-4 gap-2",children:a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words",children:"Call Note"})}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 shadow-sm break-words",children:[a.jsx("div",{className:"flex items-start justify-between",children:a.jsx("div",{children:a.jsx("p",{className:"text-sm font-medium text-gray-800 break-words",children:"Note"})})}),a.jsx("div",{className:"mt-3 text-sm text-gray-700 whitespace-pre-wrap break-words",children:n.notes||"No notes available."})]}),a.jsx(Tn,{comments:le,onAddComment:we})]})]}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm w-full",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Status"}),a.jsxs("select",{className:"border border-gray-200 rounded-md px-2 py-1.5 w-full text-sm mb-2",value:k,onChange:q=>A(q.target.value),children:[a.jsx("option",{value:"PLANNED",children:"PLANNED"}),a.jsx("option",{value:"HELD",children:"HELD"}),a.jsx("option",{value:"NOT_HELD",children:"NOT HELD"})]}),a.jsx("button",{onClick:fe,disabled:E,className:"w-full py-1.5 rounded-md text-sm bg-gray-900 text-white hover:bg-gray-800 disabled:opacity-50",children:E?"Updating...":"Update"})]})]})]})]})]}):null,te=e?a.jsx("div",{id:"modalBackdrop",onClick:q=>q.target.id==="modalBackdrop"&&Ct(),className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-xl rounded-2xl shadow-lg p-4 sm:p-6 md:p-8 relative border border-gray-200 overflow-y-auto max-h-[90vh] hide-scrollbar",children:[a.jsx("button",{onClick:()=>{Ct(),et(!1)},className:"absolute top-4 right-4 text-gray-500 hover:text-black transition",children:a.jsx(ea,{size:22})}),a.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800 mb-4 sm:mb-6 flex items-center justify-center",children:b?"Edit Call":"Add New Call"}),a.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 w-full gap-4 text-sm",onSubmit:yt,noValidate:!0,children:[a.jsx($Ve,{label:"Subject",className:"md:col-span-2",name:"subject",value:me.subject,onChange:tt,isSubmitted:Me,required:!0}),a.jsxs("div",{className:"w-full flex flex-col",children:[a.jsxs("div",{className:"relative w-25",children:[a.jsxs("select",{name:"relatedType1",onChange:tt,value:me.relatedType1,className:"outline-none cursor-pointer mb-1 w-22 text-gray-700 disabled:text-gray-400 disabled:cursor-not-allowed",disabled:w,children:[a.jsx("option",{value:"Lead",children:"Lead"}),a.jsx("option",{value:"Account",children:"Account"})]}),a.jsx("span",{className:"absolute left-10 md:pl-6 pl-6 top-1/2 -translate-y-1/2 text-red-500 pointer-events-none",children:"*"})]}),a.jsx(WT,{items:Array.isArray(o)?o:[],value:me.relatedTo1??"",placeholder:`Search ${me.relatedType1||"here"}...`,getLabel:q=>me.relatedType1==="Lead"?q.title:q.name??"",onChange:q=>Ae(Y=>({...Y,relatedTo1:q})),required:!0,isSubmitted:Me,disabled:w})]}),a.jsxs("div",{className:"w-full flex flex-col",children:[a.jsxs("select",{name:"relatedType2",onChange:tt,value:me.relatedType2??"Contact",className:"text-gray-700 outline-none cursor-pointer mb-1 w-22 disabled:text-gray-400 disabled:cursor-not-allowed",disabled:me.relatedType1==="Lead"||w,children:[a.jsx("option",{value:"Contact",children:"Contact"}),a.jsx("option",{value:"Deal",children:"Deal"}),a.jsx("option",{value:"Quote",children:"Quote"})]}),a.jsx(WT,{disabled:me.relatedType1==="Lead"||w,items:Array.isArray(c)?c:[],value:me.relatedTo2??"",placeholder:me.relatedType1==="Lead"?"":Array.isArray(c)&&c.length>0?`Search ${me.relatedType2||"Contact"}...`:`No ${me.relatedType2||""} data found`,getLabel:q=>me.relatedType2==="Contact"?`${q.first_name??""} ${q.last_name??""}`.trim():me.relatedType2==="Quote"?Ce(q.quote_id)??"":q.name??"",onChange:q=>Ae(Y=>({...Y,relatedTo2:q}))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Call Time"}),a.jsx("input",{type:"datetime-local",value:me.call_time,onChange:tt,name:"call_time",className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100"})]}),a.jsxs("div",{className:"w-full",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Duration"}),a.jsxs("div",{className:"w-full rounded-md text-sm flex flex-row items-center justify-start",children:[a.jsx("input",{type:"tel",value:me.duration_minutes,onChange:tt,name:"duration_minutes",className:"border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100 w-44 mr-3"}),a.jsx("p",{children:"minutes"})]})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:["Assign To ",a.jsx("span",{className:"text-red-600 font-semibold",children:"*"})]}),a.jsx(WT,{items:Array.isArray(p)?p:[],value:me.assigned_to??"",placeholder:"Search an account...",getLabel:q=>`${q.first_name} ${q.last_name}`,onChange:q=>Ae(Y=>({...Y,assigned_to:q})),required:!0,isSubmitted:Me})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Direction"}),a.jsxs("select",{name:"direction",onChange:tt,value:me.direction,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100",children:[a.jsx("option",{value:"Incoming",children:"Incoming"}),a.jsx("option",{value:"Outgoing",children:"Outgoing"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Status"}),a.jsxs("select",{name:"status",onChange:tt,value:me.status,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100",children:[a.jsx("option",{value:"Planned",children:"Planned"}),a.jsx("option",{value:"Held",children:"Held"}),a.jsx("option",{value:"Not held",children:"Not held"})]})]}),a.jsx(RVe,{className:"col-span-2",label:"Notes",value:me.notes,onChange:tt,name:"notes"}),a.jsxs("div",{className:"flex flex-col md:flex-row justify-end col-span-2 mt-4 gap-2 w-full",children:[a.jsx("button",{type:"button",onClick:()=>{Ct(),et(!1)},className:"w-full sm:w-auto px-4 py-2 text-white bg-red-400 border border-red-300 rounded hover:bg-red-500 transition",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:w,className:"w-full sm:w-auto px-4 py-2 text-white bg-tertiary border border-tertiary rounded hover:bg-secondary transition",children:w?"Saving...":b?"Update Call":"Save Call"})]})]})]})}):null;return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h1",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(Us,{className:"mr-2 text-blue-600"})," Calls"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{onClick:()=>{Ae(be),j(!1),N(null),t(!0),et(!1)},className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 my-1 lg:my-0 rounded-md hover:bg-gray-800 text-sm sm:text-base mx-auto sm:ml-auto cursor-pointer",children:[a.jsx(aa,{className:"mr-2"})," Add Call"]})})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-4 mb-6 w-full break-words overflow-hidden lg:overflow-visible",children:Le.map(q=>a.jsx(IVe,{...q},q.title))}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center gap-3",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search calls",className:"focus:outline-none text-base w-full",value:xe,onChange:q=>he(q.target.value)})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row w-full lg:w-1/2 gap-2",children:[a.jsxs("select",{value:Re,onChange:q=>Ee(q.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm bg-white w-full",children:[a.jsx("option",{value:"Filter by Status",children:"Filter by Status"}),PVe.map(q=>a.jsx("option",{value:q.value,children:q.label},q.value))]}),a.jsxs("select",{value:He,onChange:q=>Ke(q.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm bg-white w-full",children:[a.jsx("option",{value:"Filter by Users",children:"Filter by Users"}),at.map(q=>a.jsx("option",{value:q.name,children:q.name},q.id))]})]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[500px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm mb-4",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 w-12",children:a.jsx("input",{type:"checkbox",checked:G.size===ze.filter(q=>q.call_creator?.id===Q?.id).length&&ze.filter(q=>q.call_creator?.id===Q?.id).length>0,onChange:Be,className:"w-4 h-4 cursor-pointer rounded border-gray-300"})}),a.jsx("th",{className:"py-3 px-4",children:"Subject"}),a.jsx("th",{className:"py-3 px-4",children:"Related To"}),a.jsx("th",{className:"py-3 px-4",children:"Call Time"}),a.jsx("th",{className:"py-3 px-4",children:"Assigned To"}),a.jsx("th",{className:"py-3 px-4",children:"Status"}),a.jsx("th",{className:"py-3 px-4 w-12",children:G.size>0&&a.jsx("button",{onClick:ce,className:"text-orange-500 hover:text-orange-700 transition",title:"Archive selected calls",disabled:W,children:a.jsx(Zt,{size:18})})})]})}),a.jsx("tbody",{children:F?a.jsx("tr",{children:a.jsx("td",{colSpan:6,className:"py-10",children:a.jsx(qt,{message:"Loading calls..."})})}):ze.length>0?ze.map(q=>a.jsxs("tr",{onClick:()=>_t(q),className:"hover:bg-gray-50 cursor-pointer border-b border-gray-100",children:[a.jsx("td",{className:"py-3 px-4",onClick:Y=>Y.stopPropagation(),children:Q?.id===q.call_creator?.id&&a.jsx("input",{type:"checkbox",checked:G.has(q.id),onChange:Y=>{Y.stopPropagation(),Ge(q.id)},className:"w-4 h-4 cursor-pointer rounded border-gray-300"})}),a.jsx("td",{className:"py-3 px-4 text-blue-600 font-medium",children:q.subject||"--"}),a.jsxs("td",{className:"py-3 px-4",children:[q.lead&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:q.lead.title}),q.account&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:q.account.name}),q.contact&&a.jsxs("p",{className:"font-medium text-blue-500 text-xs",children:[q.contact.first_name," ",q.contact.last_name]}),q.deal&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:q.deal.name}),q.quote&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:Ce(q.quote.quote_id)})]}),a.jsx("td",{className:"py-3 px-4 text-gray-800",children:q.call_time?new Date(q.call_time).toLocaleString():"--"}),a.jsx("td",{className:"py-3 px-4 text-gray-800",children:q?.call_assign_to?`${q.call_assign_to.first_name} ${q.call_assign_to.last_name}`:"--"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${yH(q.status)}`,children:GT(q.status)})})]},q.id)):a.jsx("tr",{children:a.jsx("td",{colSpan:6,className:"text-center py-4 text-gray-500",children:"No calls found."})})})]})}),a.jsx(ca,{totalItems:Ue.length,pageSize:ot,currentPage:st,onPrev:je,onNext:ve,onPageSizeChange:rt,label:"calls"})]}),H,te,r&&a.jsx(zVe,{open:!0,title:r.title,message:r.message,confirmLabel:r.confirmLabel,cancelLabel:r.cancelLabel,variant:r.variant,onConfirm:jt,onCancel:At,loading:_})]})}function IVe({icon:e,title:t,value:n,color:s,bgColor:r}){return a.jsxs("div",{className:"flex items-center p-4 bg-white rounded-xl shadow-md border border-gray-200 transition-all duration-300",children:[a.jsx("div",{className:`p-3 rounded-full ${r} ${s} mr-4`,children:a.jsx(e,{size:22})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:t}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:n})]})]})}function $Ve({label:e,name:t,value:n,onChange:s,placeholder:r="",type:i="text",required:o=!1,disabled:l=!1,isSubmitted:c=!1,className:u=""}){const d=c&&o&&!n;return a.jsxs("div",{className:u,children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",o&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:i,name:t,value:n??"",onChange:s,placeholder:r,disabled:l,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border focus:ring-2 disabled:bg-gray-100
          ${d?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}
        `})]})}function RVe(e){return a.jsxs("div",{className:e.className,children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e.label}),a.jsx("textarea",{...e,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100 resize-none"})]})}function wo({label:e,value:t}){return a.jsxs("p",{children:[a.jsxs("span",{className:"font-semibold",children:[e,":"]})," ",a.jsx("br",{}),a.jsx("span",{className:"break-words",children:t||"--"})]})}function zVe({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o=!1,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":i==="archive"?"bg-orange-500 hover:bg-orange-600 border border-orange-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsx("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${u}`,disabled:o,children:o?"Processing...":s})]})]})})}function WT({items:e=[],value:t="",onChange:n,getLabel:s,placeholder:r="Search...",disabled:i=!1,maxRender:o=200,required:l=!1,isSubmitted:c=!1}){const[u,d]=f.useState(!1),[h,p]=f.useState(""),x=f.useRef(null),b=e.find(w=>String(w.id)===String(t)),j=b?s(b):"",y=l&&c&&!t,N=f.useMemo(()=>{const w=h.trim().toLowerCase();return(w?e.filter(_=>(s(_)||"").toLowerCase().includes(w)):e).slice(0,o)},[e,h,s,o]);return f.useEffect(()=>{const w=S=>{x.current&&!x.current.contains(S.target)&&d(!1)};return document.addEventListener("mousedown",w),()=>document.removeEventListener("mousedown",w)},[]),f.useEffect(()=>{u||p("")},[u]),a.jsxs("div",{ref:x,className:"relative w-full",children:[a.jsx("input",{disabled:i,value:u?h:j,placeholder:r,onFocus:()=>!i&&d(!0),onChange:w=>{p(w.target.value),u||d(!0)},className:`w-full border rounded-md px-2 py-1.5 text-sm outline-none focus:ring-2 disabled:bg-gray-100
          ${y?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}`}),u&&!i&&a.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg overflow-hidden",children:[a.jsx("div",{className:"max-h-56 overflow-y-auto",children:N.length>0?N.map(w=>{const S=String(w.id),_=s(w),T=String(t)===S;return a.jsx("button",{type:"button",onClick:()=>{n(S),d(!1)},className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-50 ${T?"bg-blue-50":""}`,children:_||"--"},S)}):a.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No results"})}),e.length>o&&a.jsxs("div",{className:"px-3 py-2 text-[11px] text-gray-400 border-t",children:["Showing first ",o," results  keep typing to narrow."]})]})]})}function FVe(){f.useEffect(()=>{document.title="Audit | Sari-Sari CRM"},[]);const[e,t]=f.useState(null),[n,s]=f.useState(""),[r,i]=f.useState("Filter by Actions"),[o,l]=f.useState(1),[c,u]=f.useState(10),d=async()=>{try{const w=await ne.get("/logs/read-all");t(w.data)}catch(w){console.error("Error fetching audit logs:",w)}};f.useEffect(()=>{d()},[]);const h=f.useMemo(()=>{if(!Array.isArray(e))return[];const w=n.trim().toLowerCase(),S=r?.toUpperCase?.()||"ALL";return e.filter(T=>{const k=T.timestamp?new Date(T.timestamp).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}):"",A=`${T.entity_type||""} ${T.entity_name||T.entity_details?.name||T.entity_details?.title||T.entity_id||""}`,E=`${T.logger?.first_name||""} ${T.logger?.last_name||""}`,M=[k,E,T.action,T.entity_type,A,T.description],F=w===""||M.some(P=>P==null?!1:P.toString().toLowerCase().includes(w)),D=S==="FILTER BY ACTIONS"||(T.action||"").toUpperCase()===S;return F&&D}).sort((T,k)=>{const A=T.timestamp?new Date(T.timestamp).getTime():0;return(k.timestamp?new Date(k.timestamp).getTime():0)-A})},[e,n,r]),p=Math.max(1,Math.ceil(h.length/c)||1);f.useEffect(()=>{l(1)},[n,c]),f.useEffect(()=>{l(w=>{const S=Math.max(1,Math.ceil(h.length/c)||1);return w>S?S:w})},[h.length,c]);const x=f.useMemo(()=>{const w=(o-1)*c;return h.slice(w,w+c)},[h,o,c]);h.length===0||(o-1)*c+1,Math.min(o*c,h.length);const b=()=>l(w=>Math.max(w-1,1)),j=()=>l(w=>Math.min(w+1,p)),y=()=>{if(!h.length){Jx.error("No logs to export!");return}const w=["Timestamp","User","Action","Resource","Details"],S=h.map(E=>[new Date(E.timestamp).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}),`${E.logger?.first_name||""} ${E.logger?.last_name||""}`.trim(),E.action,`${E.entity_type}: ${E.entity_id}`,E.description||""]),_=[w.join(","),...S.map(E=>E.map(M=>`"${String(M).replace(/"/g,'""')}"`).join(","))].join(`
`),T=new Blob([_],{type:"text/csv;charset=utf-8;"}),k=URL.createObjectURL(T),A=document.createElement("a");A.href=k,A.download=`AuditLogs_${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(A),A.click(),document.body.removeChild(A),URL.revokeObjectURL(k)},N=w=>{switch((w||"").toUpperCase()){case"CREATE":return"bg-green-100 text-green-700";case"UPDATE":case"EDIT":return"bg-blue-100 text-blue-700";case"DELETE":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-700"}};return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[e===null&&a.jsx(qt,{message:"Loading audit logs..."}),a.jsx(Zx,{toastOptions:{duration:1e3}}),a.jsxs("div",{className:"bg-blue-50 border-l-4 border-blue-400 p-4 mb-6 rounded-r-md flex items-center",children:[a.jsx(Pt,{className:"text-blue-600 mr-3 flex-shrink-0",size:20}),a.jsxs("p",{className:"text-sm text-blue-700",children:[a.jsx("span",{className:"font-semibold",children:"Data Retention Policy:"})," Audit logs are automatically purged after 6 months to optimize system performance."]})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-5 space-y-3 sm:space-y-0",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Ls,{className:"text-blue-600",size:20}),a.jsx("h2",{className:"text-2xl sm:text-xl font-semibold text-gray-700",children:"Audit Logs"})]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 rounded-md hover:bg-gray-800 text-sm sm:text-base self-end sm:self-auto cursor-pointer",onClick:y,children:[a.jsx(Vo,{className:"mr-2"}),"Export Logs"]})})]}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition bg-white",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search audit logs",value:n,onChange:w=>s(w.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsx("div",{className:"w-full lg:w-1/4",children:a.jsxs("select",{value:r,onChange:w=>i(w.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{value:"Filter by Actions",children:"Filter by Actions"}),a.jsx("option",{value:"CREATE",children:"CREATE"}),a.jsx("option",{value:"DELETE",children:"DELETE"}),a.jsx("option",{value:"UPDATE",children:"UPDATE"})]})})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[600px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 text-sm tracking-wide font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4",children:"Timestamp"}),a.jsx("th",{className:"py-3 px-4",children:"User"}),a.jsx("th",{className:"py-3 px-4",children:"Action"}),a.jsx("th",{className:"py-3 px-4",children:"Resource"}),a.jsx("th",{className:"py-3 px-4",children:"Details"})]})}),a.jsx("tbody",{children:Array.isArray(h)&&h.length>0?x.map((w,S)=>a.jsxs("tr",{className:"hover:bg-gray-50 text-sm",children:[a.jsx("td",{className:"py-3 px-4 text-gray-700 whitespace-nowrap",children:new Date(w.timestamp).toLocaleString("en-US",{month:"numeric",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}).replace(",","")}),a.jsx("td",{className:"py-3 px-4 text-gray-700",children:w.name}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium whitespace-nowrap ${N(w.action)}`,children:w.action})}),a.jsxs("td",{className:"py-3 px-4 text-gray-700",children:[w.entity_type,": ",w.entity_id]}),a.jsx("td",{className:"py-3 px-4 text-gray-700",children:w.description})]},S)):a.jsx("tr",{children:a.jsx("td",{className:"py-3 px-4 text-sm text-gray-500 text-center",colSpan:5,children:"No activities to show."})})})]})}),a.jsx(ca,{className:"mt-4",totalItems:h.length,pageSize:c,currentPage:o,onPrev:b,onNext:j,onPageSizeChange:u,label:"logs"})]})}const B1=[{value:"Manager",label:"Manager"},{value:"Sales",label:"Sales"}],Hg={firstName:"",lastName:"",email:"",password:"",role:""},UVe={CEO:"bg-purple-100 text-purple-700",ADMIN:"bg-purple-100 text-purple-700",GROUP_MANAGER:"bg-indigo-100 text-indigo-700",MANAGER:"bg-blue-100 text-blue-700",MARKETING:"bg-yellow-100 text-yellow-700",SALES:"bg-green-100 text-green-700"},Lo=e=>e?e.toString().trim().replace(/([a-z0-9])([A-Z])/g,"$1_$2").replace(/\s+/g,"_").toUpperCase():"",BVe=e=>{const t=Lo(e),n=B1.find(s=>Lo(s.value)===t);return n?n.value:e||""},pL=e=>{const t=Lo(e),n=B1.find(s=>Lo(s.value)===t);return n?n.label:typeof e=="string"?e.toLowerCase().replace(/\b\w/g,s=>s.toUpperCase()):"--"},vH=e=>{if(!e)return"--";const t=new Date(e);return Number.isNaN(t.getTime())?"--":t.toLocaleString("en-US",{month:"2-digit",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).replace(",","")},VT=(e,{size:t="sm"}={})=>{const n=Lo(e),s=UVe[n]||"bg-gray-100 text-gray-700",r=t==="lg"?"px-3 py-1 text-sm":t==="md"?"px-2.5 py-1 text-sm":"px-2 py-1 text-xs";return a.jsx("span",{className:`${r} font-semibold rounded-md inline-flex items-center justify-center ${s}`,children:pL(e)})},HVe=(e,t)=>{const n=e?.trim()?.[0]??"",s=t?.trim()?.[0]??"";return`${n}${s}`.toUpperCase()||"U"},wH=e=>[...e].sort((t,n)=>{const s=t.created_at?new Date(t.created_at).getTime():0;return(n.created_at?new Date(n.created_at).getTime():0)-s});function qVe(){const{user:e,loading:t}=Gt(),[n,s]=f.useState([]),[r,i]=f.useState(!1),[o,l]=f.useState(""),[c,u]=f.useState(""),[d,h]=f.useState(null),[p,x]=f.useState(!1),[b,j]=f.useState(!1),[y,N]=f.useState(null),[w,S]=f.useState(Hg),[_,T]=f.useState(!1),[k,A]=f.useState(null),[E,M]=f.useState(!1),[F,D]=f.useState(1),[P,B]=f.useState(10),[G,$]=f.useState("Overview"),[W,Z]=f.useState(""),[Q,le]=f.useState(!1),we=Lo(e?.role);console.log("meow",e);const J=["ADMIN","CEO","GROUP_MANAGER"].includes(we),se=!t&&J,ye=f.useMemo(()=>{const Ne=B1.filter(ze=>Lo(ze.value)!=="CEO");return[{label:"Filter by Roles",value:""},{label:"CEO",value:"CEO"},...Ne]},[]),Ce=f.useCallback(Ne=>{Ne&&(s(ze=>ze.map(je=>je.id===Ne?{...je,highlight:!0}:je)),setTimeout(()=>{s(ze=>ze.map(je=>je.id===Ne?{...je,highlight:!1}:je))},2e3))},[]),ge=f.useCallback(async()=>{i(!0);try{const Ne=await ne.get("/users/all"),ze=Array.isArray(Ne.data)?Ne.data:[],je=wH(ze);s(je),h(ve=>ve&&(je.find(K=>K.id===ve.id)||null)),console.log(Ne.data)}catch(Ne){console.error("Error fetching users:",Ne);const ze=Ne.response?.data?.detail||"Failed to load users. Please try again later.";V.error(ze)}finally{i(!1)}},[]);f.useEffect(()=>{!t&&!J&&e&&V.error("You are not authorized to access User Management.")},[J,t,e]),f.useEffect(()=>{t||!J||ge()},[t,J,ge]),f.useEffect(()=>{document.title="Users | Sari-Sari CRM"},[]);const be=f.useMemo(()=>{const Ne=o.trim().toLowerCase(),ze=Lo(c);return wH(n.filter(je=>{if(!je)return!1;const ve=Ne===""||[je.first_name,je.last_name,`${je.first_name||""} ${je.last_name||""}`,je.email,pL(je.role)].filter(Boolean).some(K=>K.toString().toLowerCase().includes(Ne)),z=ze===""||ze==="CEO"&&["CEO","ADMIN"].includes(Lo(je.role))||Lo(je.role)===ze;return ve&&z}))},[n,o,c]),me=Math.max(1,Math.ceil(be.length/P)||1);f.useEffect(()=>{D(1)},[o,c,P]),f.useEffect(()=>{D(Ne=>{const ze=Math.max(1,Math.ceil(be.length/P)||1);return Ne>ze?ze:Ne})},[be.length,P]);const Ae=f.useMemo(()=>{const Ne=(F-1)*P;return be.slice(Ne,Ne+P)},[be,F,P]);be.length===0||(F-1)*P+1,Math.min(F*P,be.length);const pe=()=>D(Ne=>Math.max(Ne-1,1)),Ie=()=>D(Ne=>Math.min(Ne+1,me)),xe=()=>{S(Hg),j(!1),N(null),x(!0)},he=Ne=>{h(Ne),$("Overview"),Z(Ne?.is_active?"Active":"Inactive")},Re=Ne=>{Ne.target.id==="userModalBackdrop"&&!E&&Ee()},Ee=()=>{h(null)},He=(Ne,ze)=>{S(je=>({...je,[Ne]:ze}))},Ke=()=>{const Ne="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*";let ze="";for(let je=0;je<10;je+=1)ze+=Ne.charAt(Math.floor(Math.random()*Ne.length));He("password",ze)},st=()=>{_||E||(x(!1),S(Hg),N(null),j(!1))},it=Ne=>{S({firstName:Ne.first_name||"",lastName:Ne.last_name||"",email:Ne.email||"",password:"",role:BVe(Ne.role)}),j(!0),N(Ne.id),x(!0),h(null)},ot=Ne=>{Ne.preventDefault();const ze=w.firstName.trim(),je=w.lastName.trim(),ve=w.email.trim(),z=w.password.trim(),K=w.role,ue=!(b&&y);if(!ze||!ve||!K){V.warn("Please fill in all required fields.");return}if(ue&&!z){V.warn("Please fill in all required fields.");return}if(z&&z.length<8){V.warn("Password should be at least 8 characters long.");return}const re={first_name:ze,last_name:je,email:ve,role:K};(ue||z)&&(re.password=z);const Le=`${ze} ${je}`.trim(),De=ue?"create":"update";A({title:De==="create"?"Confirm New User":"Confirm User Update",message:De==="create"?a.jsxs("span",{children:["Create user ",a.jsx("span",{className:"font-semibold",children:Le})," with role"," ",a.jsx("span",{className:"font-semibold",children:pL(K)}),"?"]}):a.jsxs("span",{children:["Save changes for"," ",a.jsx("span",{className:"font-semibold",children:Le||ve}),"?"]}),confirmLabel:De==="create"?"Create User":"Update User",cancelLabel:"Cancel",variant:"primary",action:{type:De,payload:re,targetId:y,name:Le||ve}})},rt=async()=>{if(!k?.action){A(null);return}const{action:Ne}=k,{type:ze,payload:je,targetId:ve,name:z}=Ne;M(!0),(ze==="create"||ze==="update")&&T(!0);try{if(ze==="create"){const ue=(await ne.post("/users/createuser",je)).data;await ge(),Ce(ue.id),V.success(`User "${z}" created successfully.`),x(!1),S(Hg),N(null),j(!1)}else if(ze==="update"){if(!ve)throw new Error("Missing user identifier for update.");const ue=(await ne.put(`/users/updateuser/${ve}`,je)).data;await ge(),h(null),Ce(ue.id),V.success(`User "${z}" updated successfully.`),x(!1),S(Hg),N(null),j(!1)}else if(ze==="delete"){if(!ve)throw new Error("Missing user identifier for deletion.");await ne.delete(`/users/deleteuser/${ve}`),s(K=>K.map(ue=>ue.id===ve?{...ue,is_active:!1}:ue)),d&&d.id===ve&&(h(null),Z("")),V.success(`User "${z}" deactivated successfully.`)}}catch(K){console.error("User management error:",K);const ue=ze==="create"?"Failed to create user. Please review the details and try again.":ze==="update"?"Failed to update user. Please review the details and try again.":"Failed to delete user. Please try again.",re=K.response?.data?.detail||ue;V.error(re)}finally{(ze==="create"||ze==="update")&&T(!1),M(!1),A(null)}},at=()=>{E||A(null)},Je=async()=>{if(!d||!W)return;const Ne=d.is_active?"Active":"Inactive";if(W===Ne)return;const ze=W==="Active";le(!0);try{const ve=(await ne.put(`/users/updateuser/${d.id}`,{is_active:ze})).data;s(z=>z.map(K=>K.id===ve.id?ve:K)),h(null),Z(""),V.success(`User status updated to ${W}`)}catch(je){console.error("Failed to update user status:",je);const ve=je.response?.data?.detail||"Failed to update user status. Please try again.";V.error(ve)}finally{le(!1)}},Fe=a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[(r||t||!se)&&a.jsx(qt,{}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h1",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(jj,{className:"mr-2 text-blue-600"}),"User Management"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{type:"button",onClick:xe,className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 rounded-md hover:bg-gray-800 text-sm sm:text-base self-end sm:self-auto cursor-pointer",children:[a.jsx(rn,{className:"mr-2"})," Add User"]})})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search users",value:o,onChange:Ne=>l(Ne.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsx("div",{className:"w-full lg:w-1/4",children:a.jsx("select",{value:c,onChange:Ne=>u(Ne.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:ye.map(Ne=>a.jsx("option",{value:Ne.value,children:Ne.label},Ne.value))})})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[600px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 text-sm tracking-wide font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4",children:"Fullname"}),a.jsx("th",{className:"py-3 px-4",children:"Email"}),a.jsx("th",{className:"py-3 px-4",children:"Role"}),a.jsx("th",{className:"py-3 px-4",children:"Status"})]})}),a.jsx("tbody",{children:r?a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:3,children:"Loading users..."})}):be.length===0?a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-400",colSpan:4,children:"No users found."})}):Ae.map(Ne=>a.jsxs("tr",{className:`hover:bg-gray-50 transition-colors ${Ne.highlight?"bg-green-50":""} ${Ne.is_active?"":"opacity-60 bg-gray-50"}`,children:[a.jsx("td",{className:"py-3 px-4 cursor-pointer",onClick:()=>he(Ne),children:a.jsxs("div",{className:"font-medium text-blue-600 hover:underline text-sm",children:[Ne.first_name," ",Ne.last_name]})}),a.jsx("td",{className:"py-3 px-4 cursor-pointer text-sm",onClick:()=>he(Ne),children:Ne.email}),a.jsx("td",{className:"py-3 px-4 cursor-pointer",onClick:()=>he(Ne),children:VT(Ne.role)}),a.jsx("td",{className:"py-3 px-4 cursor-pointer",onClick:()=>he(Ne),children:a.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-md ${Ne.is_active?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:Ne.is_active?"Active":"Inactive"})})]},Ne.id))})]})}),a.jsx(ca,{className:"mt-4",totalItems:be.length,pageSize:P,currentPage:F,onPrev:pe,onNext:Ie,onPageSizeChange:B,label:"users"})]}),Ue=d?a.jsx("div",{id:"userModalBackdrop",onClick:Re,className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-6xl max-h-[92vh] overflow-y-auto hide-scrollbar animate-scale-in p-4 sm:p-6 md:p-8 font-inter relative",children:[a.jsx("div",{className:"flex justify-end w-full",children:a.jsx("button",{onClick:Ee,className:"text-gray-500 hover:text-gray-700 transition mb-5 cursor-pointer",children:a.jsx(Za,{size:30})})}),a.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between lg:flex-row lg:items-center lg:justify-between mt-3 gap-2 px-2 md:items-center lg:gap-4 md:mx-7 lg:mx-7 mb-4 lg:mb-6 md:mb-4",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[d.profile_picture?a.jsx("img",{src:d.profile_picture,alt:`${d.first_name} ${d.last_name}`,className:"w-12 h-12 sm:w-16 sm:h-16 rounded-full object-cover border border-gray-200 shadow-sm"}):a.jsx("div",{className:"w-12 h-12 sm:w-16 sm:h-16 rounded-full bg-gray-200 text-gray-700 flex items-center justify-center text-lg sm:text-xl font-semibold border border-gray-200 shadow-sm",children:HVe(d.first_name,d.last_name)}),a.jsxs("div",{children:[a.jsxs("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-800",children:[d.first_name," ",d.last_name]}),a.jsx("p",{className:"text-sm text-gray-500 break-all",children:d.email})]})]}),VT(d.role,{size:"md"})]}),!["CEO","ADMIN","GROUP MANAGER","GROUP_MANAGER"].includes(d.role.toUpperCase())&&a.jsx("div",{className:"flex flex-col sm:flex-row sm:space-x-3 space-y-2 sm:space-y-0",children:a.jsxs("button",{type:"button",className:"inline-flex items-center justify-center w-full sm:w-auto bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 disabled:opacity-70 transition text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",onClick:()=>it(d),disabled:E,children:[a.jsx(hn,{className:"mr-2"}),"Edit"]})})]}),a.jsx("div",{className:"border-b border-gray-200 mb-6"}),a.jsx("div",{className:"flex w-full bg-[#6A727D] text-white mt-1 overflow-x-auto mb-6",children:["Overview"].map(Ne=>a.jsx("button",{onClick:()=>$(Ne),className:`flex-1 min-w-[90px] px-4 py-2.5 text-xs sm:text-sm font-medium text-center transition-all duration-200 border-b-2
        ${G===Ne?"bg-[#5c636d] text-white border-white":"text-white hover:bg-[#5c636d]"}`,children:Ne},Ne))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 items-start",children:[a.jsx("div",{className:"lg:col-span-3",children:G==="Overview"&&a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 md:p-8 border border-gray-200",children:a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4 sm:gap-6 text-sm text-gray-700",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Email:"}),a.jsx("p",{children:d.email||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Role:"}),a.jsx("p",{children:VT(d.role,{size:"sm"})})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Status:"}),a.jsx("p",{children:d.is_active?"Active":"Inactive"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Auth Provider:"}),a.jsx("p",{children:d.auth_provider?d.auth_provider.toString().replace(/\b\w/g,Ne=>Ne.toUpperCase()):"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Phone Number:"}),a.jsx("p",{children:d.phone_number||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Company:"}),a.jsx("p",{children:d.company?.company_name||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Company Number:"}),a.jsx("p",{children:d.company?.company_number||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Related to CEO:"}),a.jsx("p",{children:d.manager?`${d.manager.first_name} ${d.manager.last_name}`:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created At:"}),a.jsx("p",{children:vH(d.created_at)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Last Login:"}),a.jsx("p",{children:d.last_login?vH(d.last_login):"Never"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Profile Picture:"}),a.jsx("p",{children:d.profile_picture?a.jsx("a",{href:d.profile_picture,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline break-all",children:"View image"}):"N/A"})]})]})})}),a.jsxs("div",{className:"flex flex-col gap-4",children:[a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Quick Actions"}),a.jsx("div",{className:"flex flex-col gap-2 w-full",children:a.jsxs("button",{type:"button",onClick:()=>{if(!d.email){alert("No email address available");return}const Ne=encodeURIComponent(d.email),ze=encodeURIComponent(""),je=encodeURIComponent(""),ve=`https://mail.google.com/mail/?view=cm&fs=1&to=${Ne}&su=${ze}&body=${je}`;window.open(ve,"_blank")},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(sn,{className:"text-gray-600 w-4 h-4"}),"Send E-mail"]})})]}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm w-full",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Status"}),a.jsxs("select",{className:"border border-gray-200 rounded-md px-2 sm:px-3 py-1.5 w-full text-sm mb-2 focus:ring-2 focus:ring-indigo-500 outline-none",value:W||(d.is_active?"Active":"Inactive"),onChange:Ne=>Z(Ne.target.value),children:[a.jsx("option",{value:"Active",children:"Active"}),a.jsx("option",{value:"Inactive",children:"Inactive"})]}),a.jsx("button",{onClick:Je,disabled:Q||W===(d.is_active?"Active":"Inactive"),className:`w-full py-1.5 rounded-md text-sm transition focus:outline-none focus:ring-2 ${Q||W===(d.is_active?"Active":"Inactive")?"bg-gray-400 cursor-not-allowed text-white":"bg-gray-900 text-white hover:bg-gray-800 focus:ring-gray-400"}`,children:Q?"Updating...":"Update"})]})]})]})]})}):null;return a.jsxs(a.Fragment,{children:[Fe,Ue,a.jsx(GVe,{open:p,isEditing:b,isSubmitting:_,confirmProcessing:E,formData:w,onClose:st,onSubmit:ot,onChange:He,onGeneratePassword:Ke}),a.jsx(WVe,{open:!!k,title:k?.title,message:k?.message,confirmLabel:k?.confirmLabel,cancelLabel:k?.cancelLabel,variant:k?.variant,loading:E,onConfirm:rt,onCancel:at})]})}function GVe({open:e,isEditing:t,isSubmitting:n,confirmProcessing:s,formData:r,onClose:i,onSubmit:o,onChange:l,onGeneratePassword:c}){if(!e)return null;const u=n||s;return a.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-2xl rounded-2xl shadow-lg border border-gray-200 p-6 sm:p-8 relative overflow-y-auto max-h-[90vh]",children:[a.jsx("button",{onClick:i,className:"absolute top-4 right-4 text-gray-500 hover:text-black transition disabled:opacity-60",disabled:u,children:a.jsx(ea,{size:22})}),a.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800 mb-6 text-center",children:t?"Edit User":"Add New User"}),a.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",onSubmit:o,children:[a.jsx(iv,{label:"First Name",value:r.firstName,onChange:d=>l("firstName",d),placeholder:"John",required:!0,disabled:u}),a.jsx(iv,{label:"Last Name",value:r.lastName,onChange:d=>l("lastName",d),placeholder:"Doe",required:!0,disabled:u}),a.jsx(iv,{label:"Email",type:"email",value:r.email,onChange:d=>l("email",d),placeholder:"john.doe@company.com",required:!0,disabled:u||t}),a.jsx(iv,{label:"Role",type:"select",value:r.role,onChange:d=>l("role",d),options:[{value:"",label:"Select role"},...B1],required:!0,disabled:u}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Password"}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2",children:[a.jsx("input",{type:"text",value:r.password,onChange:d=>l("password",d.target.value),placeholder:t?"Leave blank to keep current password":"Enter or generate password",required:!t,disabled:u,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-indigo-500 outline-none disabled:bg-gray-100"}),a.jsx("button",{type:"button",onClick:c,className:"flex items-center justify-center px-4 py-2 bg-gray-900 text-white rounded-md hover:bg-gray-800 transition disabled:opacity-60",disabled:u,children:"Generate"})]}),t?a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Setting a password will reset the user's credentials; leave it blank to keep the current password."}):a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Password must be at least 8 characters long."})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-2 md:col-span-2 mt-4",children:[a.jsx("button",{type:"button",onClick:i,className:"w-full sm:w-auto px-4 py-2 text-white bg-red-400 border border-red-300 rounded hover:bg-red-500 transition disabled:opacity-70",disabled:u,children:"Cancel"}),a.jsx("button",{type:"submit",className:"w-full sm:w-auto px-4 py-2 text-white border border-tertiary bg-tertiary rounded hover:bg-secondary transition disabled:opacity-70",disabled:u,children:n?"Saving...":t?"Update User":"Save User"})]})]})]})})}function iv({label:e,type:t="text",value:n,onChange:s,placeholder:r,options:i=[],required:o=!1,disabled:l=!1}){return a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),t==="select"?a.jsx("select",{value:n??"",onChange:c=>s(c.target.value),required:o,disabled:l,className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-indigo-500 outline-none disabled:bg-gray-100",children:i.map(c=>a.jsx("option",{value:c.value,children:c.label},c.value))}):a.jsx("input",{type:t,value:n??"",onChange:c=>s(c.target.value),placeholder:r,required:o,disabled:l,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-indigo-500 outline-none disabled:bg-gray-100"})]})}function WVe({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o=!1,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":"bg-black hover:bg-gray-800 border border-black";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("div",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsx("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${u}`,disabled:o,children:o?"Processing...":s})]})]})})}function VVe(){const{user:e,loading:t}=Gt(),[n,s]=f.useState(!1),[r,i]=f.useState([]),[o,l]=f.useState([]),[c,u]=f.useState([]);f.useEffect(()=>{document.title="Calendar | Sari-Sari CRM"},[]);const d=f.useCallback(async()=>{try{s(!0);const[p,x,b]=await Promise.all([ne.get("/tasks/all"),ne.get("/meetings/admin/fetch-all"),ne.get("/calls/admin/fetch-all")]),j=Array.isArray(p.data)?p.data:[],y=Array.isArray(x.data)?x.data:[],N=Array.isArray(b.data)?b.data:[],w=e?.role?.toUpperCase(),_=w==="GROUP MANAGER"||w==="CEO"||w==="ADMIN"?y:y.filter(M=>M?.created_by===e?.id||M?.meet_assign_to?.id===e?.id),k=["GROUP MANAGER","MANAGER","SALES"].includes(w),A=k?_.filter(M=>M?.status?.toUpperCase()!=="INACTIVE"):_,E=k?N.filter(M=>M?.status!=="INACTIVE"):N;i(j),l(A),u(E)}catch(p){console.error(p),V.error("Failed to load calendar data.")}finally{s(!1)}},[e?.id,e?.role]);f.useEffect(()=>{!t&&e&&d()},[t,e,d]);const h=f.useMemo(()=>({tasks:r,meetings:o,calls:c}),[r,o,c]);return a.jsxs("div",{className:"min-h-screen",children:[(n||t)&&a.jsx(qt,{message:"Loading calendar..."}),a.jsx(M1,{basePath:"/group-manager",...h})]})}function YVe(){return a.jsxs(Sse,{children:[a.jsx(hre,{position:"top-right",autoClose:3e3,hideProgressBar:!1,newestOnTop:!0,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"colored",className:"z-[9999]"}),a.jsx(Wie,{children:a.jsxs(ese,{children:[a.jsx(bt,{path:"/",element:a.jsx(Coe,{})}),a.jsx(bt,{path:"/header",element:a.jsx(N9,{})}),a.jsx(bt,{path:"/signup",element:a.jsx(Nue,{})}),a.jsx(bt,{path:"/login",element:a.jsx(Sue,{})}),a.jsx(bt,{path:"/forgot-password",element:a.jsx(Tue,{})}),a.jsx(bt,{path:"/resources",element:a.jsx(Pue,{})}),a.jsx(bt,{path:"/legal",element:a.jsx(zue,{})}),a.jsx(bt,{path:"/admin/quotes/:quoteId/print",element:a.jsx(uo,{requiredRole:"ceo",children:a.jsx(ev,{})})}),a.jsx(bt,{path:"/sales/quotes/:quoteId/print",element:a.jsx(uo,{requiredRole:"sales",children:a.jsx(ev,{})})}),a.jsx(bt,{path:"/manager/quotes/:quoteId/print",element:a.jsx(uo,{requiredRole:"manager",children:a.jsx(ev,{})})}),a.jsx(bt,{path:"/group-manager/quotes/:quoteId/print",element:a.jsx(uo,{requiredRole:"group manager",children:a.jsx(ev,{})})}),a.jsxs(bt,{path:"/super-admin",element:a.jsx(uo,{requiredRole:"admin",children:a.jsx(iFe,{})}),children:[a.jsx(bt,{index:!0,element:a.jsx(ur,{to:"dashboard",replace:!0})}),a.jsx(bt,{path:"dashboard",element:a.jsx(oFe,{})})]}),a.jsxs(bt,{path:"/admin",element:a.jsx(uo,{requiredRole:"ceo",children:a.jsx(Uue,{})}),children:[a.jsx(bt,{index:!0,element:a.jsx(ur,{to:"dashboard",replace:!0})}),a.jsx(bt,{path:"dashboard",element:a.jsx(_Ce,{})}),a.jsx(bt,{path:"accounts",element:a.jsx(WCe,{})}),a.jsx(bt,{path:"contacts",element:a.jsx(KCe,{})}),a.jsx(bt,{path:"leads",element:a.jsx(nSe,{})}),a.jsx(bt,{path:"leads/:leadID",element:a.jsx(yY,{})}),a.jsx(bt,{path:"audit",element:a.jsx(YSe,{})}),a.jsx(bt,{path:"targets",element:a.jsx(K$e,{})}),a.jsx(bt,{path:"quotes",element:a.jsx(n6e,{})}),a.jsx(bt,{path:"users",element:a.jsx(u6e,{})}),a.jsx(bt,{path:"manage-account",element:a.jsx(g6e,{})}),a.jsx(bt,{path:"company-details",element:a.jsx(Jze,{})}),a.jsx(bt,{path:"deals",element:a.jsx(p6e,{})}),a.jsx(bt,{path:"deals/info",element:a.jsx(DZ,{})}),a.jsx(bt,{path:"deals/quickaction",element:a.jsx(LZ,{})}),a.jsx(bt,{path:"tasks",element:a.jsx(Tze,{})}),a.jsxs(bt,{path:"/admin/territory",children:[a.jsx(bt,{index:!0,element:a.jsx(Bc,{})}),a.jsx(bt,{path:":id",element:a.jsx(Bc,{})})]}),a.jsx(bt,{path:"calls",element:a.jsx(f8,{})}),a.jsx(bt,{path:"calls/info",element:a.jsx(f8,{})}),a.jsx(bt,{path:"meetings",element:a.jsx(h8,{})}),a.jsx(bt,{path:"meetings/info",element:a.jsx(h8,{})}),a.jsx(bt,{path:"calendar",element:a.jsx(rFe,{})}),a.jsx(bt,{path:"help",element:a.jsx(eFe,{})})]}),a.jsxs(bt,{path:"/sales",element:a.jsx(uo,{requiredRole:"sales",children:a.jsx(cFe,{})}),children:[a.jsx(bt,{index:!0,element:a.jsx(ur,{to:"overview",replace:!0})}),a.jsx(bt,{path:"overview",element:a.jsx(OFe,{})}),a.jsx(bt,{path:"accounts",element:a.jsx($Fe,{})}),a.jsx(bt,{path:"contacts",element:a.jsx(UFe,{})}),a.jsx(bt,{path:"leads",element:a.jsx(YFe,{})}),a.jsx(bt,{path:"leads/info",element:a.jsx(yJ,{})}),a.jsx(bt,{path:"leads/convert",element:a.jsx(tUe,{})}),a.jsx(bt,{path:"deals",element:a.jsx(aUe,{})}),a.jsx(bt,{path:"deals/info",element:a.jsx(vJ,{})}),a.jsx(bt,{path:"deals/quickaction",element:a.jsx(bJ,{})}),a.jsx(bt,{path:"quotes",element:a.jsx(hUe,{})}),a.jsx(bt,{path:"targets",element:a.jsx(bUe,{})}),a.jsx(bt,{path:"audit",element:a.jsx(vUe,{})}),a.jsx(bt,{path:"manage-account",element:a.jsx(Yy,{})}),a.jsxs(bt,{path:"/sales/territory",children:[a.jsx(bt,{index:!0,element:a.jsx(Bc,{})}),a.jsx(bt,{path:":id",element:a.jsx(Bc,{})})]}),a.jsx(bt,{path:"meetings",element:a.jsx(PUe,{})}),a.jsx(bt,{path:"calls",element:a.jsx(RUe,{})}),a.jsx(bt,{path:"tasks",element:a.jsx(CUe,{})}),a.jsx(bt,{path:"calendar",element:a.jsx(HUe,{})})]}),a.jsxs(bt,{path:"/manager",element:a.jsx(uo,{requiredRole:"manager",children:a.jsx(GUe,{})}),children:[a.jsx(bt,{index:!0,element:a.jsx(ur,{to:"dashboard",replace:!0})}),a.jsx(bt,{path:"dashboard",element:a.jsx(b7e,{})}),a.jsx(bt,{path:"accounts",element:a.jsx(j7e,{})}),a.jsx(bt,{path:"contacts",element:a.jsx(_7e,{})}),a.jsx(bt,{path:"leads",element:a.jsx(P7e,{})}),a.jsx(bt,{path:"leads/info",element:a.jsx(kJ,{})}),a.jsx(bt,{path:"leads/convert",element:a.jsx(F7e,{})}),a.jsx(bt,{path:"deals",element:a.jsx(U7e,{})}),a.jsx(bt,{path:"deals/info",element:a.jsx(LJ,{})}),a.jsx(bt,{path:"deals/quickaction",element:a.jsx(EJ,{})}),a.jsx(bt,{path:"quotes",element:a.jsx(J7e,{})}),a.jsx(bt,{path:"targets",element:a.jsx(s8e,{})}),a.jsx(bt,{path:"meetings",element:a.jsx(S8e,{})}),a.jsx(bt,{path:"audit",element:a.jsx(r8e,{})}),a.jsx(bt,{path:"calls",element:a.jsx(l8e,{})}),a.jsx(bt,{path:"tasks",element:a.jsx(p8e,{})}),a.jsx(bt,{path:"calendar",element:a.jsx(O8e,{})}),a.jsxs(bt,{path:"/manager/territory",children:[a.jsx(bt,{index:!0,element:a.jsx(Bc,{})}),a.jsx(bt,{path:":id",element:a.jsx(Bc,{})})]}),a.jsx(bt,{path:"users",element:a.jsx(L8e,{})}),a.jsx(bt,{path:"manage-account",element:a.jsx(Yy,{})})]}),a.jsx(bt,{children:a.jsxs(bt,{path:"/marketing",element:a.jsx(uo,{requiredRole:"marketing",children:a.jsx(I8e,{})}),children:[a.jsx(bt,{index:!0,element:a.jsx(ur,{to:"dashboard",replace:!0})}),a.jsx(bt,{path:"dashboard",element:a.jsx(OGe,{})}),a.jsx(bt,{path:"accounts",element:a.jsx(MGe,{})}),a.jsx(bt,{path:"contacts",element:a.jsx($Ge,{})}),a.jsx(bt,{path:"leads",element:a.jsx(HGe,{})}),a.jsx(bt,{path:"leads/info",element:a.jsx(_ee,{})}),a.jsx(bt,{path:"leads/convert",element:a.jsx(See,{})}),a.jsx(bt,{path:"tasks",element:a.jsx(VGe,{})}),a.jsx(bt,{path:"campaigns",element:a.jsx(KGe,{})}),a.jsx(bt,{path:"templates",element:a.jsx(ZGe,{})}),a.jsx(bt,{path:"manage-account",element:a.jsx(Yy,{})})]})}),a.jsxs(bt,{path:"/group-manager",element:a.jsx(uo,{requiredRole:"group manager",children:a.jsx(aWe,{})}),children:[a.jsx(bt,{index:!0,element:a.jsx(ur,{to:"dashboard",replace:!0})}),a.jsx(bt,{path:"dashboard",element:a.jsx(EWe,{})}),a.jsx(bt,{path:"accounts",element:a.jsx(PWe,{})}),a.jsx(bt,{path:"contacts",element:a.jsx($We,{})}),a.jsx(bt,{path:"leads",element:a.jsx(qWe,{})}),a.jsx(bt,{path:"leads/info",element:a.jsx(Pee,{})}),a.jsx(bt,{path:"leads/convert",element:a.jsx(XWe,{})}),a.jsx(bt,{path:"deals",element:a.jsx(JWe,{})}),a.jsx(bt,{path:"deals/info",element:a.jsx(Mee,{})}),a.jsx(bt,{path:"deals/quickaction",element:a.jsx(Oee,{})}),a.jsx(bt,{path:"quotes",element:a.jsx(mVe,{})}),a.jsx(bt,{path:"targets",element:a.jsx(xVe,{})}),a.jsx(bt,{path:"tasks",element:a.jsx(wVe,{})}),a.jsxs(bt,{path:"/group-manager/territory",children:[a.jsx(bt,{index:!0,element:a.jsx(Bc,{})}),a.jsx(bt,{path:":id",element:a.jsx(Bc,{})})]}),a.jsx(bt,{path:"meetings",element:a.jsx(EVe,{})}),a.jsx(bt,{path:"calls",element:a.jsx(MVe,{})}),a.jsx(bt,{path:"calendar",element:a.jsx(VVe,{})}),a.jsx(bt,{path:"audit",element:a.jsx(FVe,{})}),a.jsx(bt,{path:"users",element:a.jsx(qVe,{})}),a.jsx(bt,{path:"manage-account",element:a.jsx(Yy,{})})]})]})})]})}tne.createRoot(document.getElementById("root")).render(a.jsx(f.StrictMode,{children:a.jsx(YVe,{})}));
