function zae(e,t){for(var n=0;n<t.length;n++){const s=t[n];if(typeof s!="string"&&!Array.isArray(s)){for(const r in s)if(r!=="default"&&!(r in e)){const i=Object.getOwnPropertyDescriptor(s,r);i&&Object.defineProperty(e,r,i.get?i:{enumerable:!0,get:()=>s[r]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=n(r);fetch(r.href,i)}})();function ao(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var qS={exports:{}},ug={};var iI;function Fae(){if(iI)return ug;iI=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function n(s,r,i){var o=null;if(i!==void 0&&(o=""+i),r.key!==void 0&&(o=""+r.key),"key"in r){i={};for(var l in r)l!=="key"&&(i[l]=r[l])}else i=r;return r=i.ref,{$$typeof:e,type:s,key:o,ref:r!==void 0?r:null,props:i}}return ug.Fragment=t,ug.jsx=n,ug.jsxs=n,ug}var oI;function Uae(){return oI||(oI=1,qS.exports=Fae()),qS.exports}var a=Uae(),GS={exports:{}},na={};var lI;function Bae(){if(lI)return na;lI=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),h=Symbol.for("react.activity"),p=Symbol.iterator;function x(X){return X===null||typeof X!="object"?null:(X=p&&X[p]||X["@@iterator"],typeof X=="function"?X:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},j=Object.assign,y={};function N(X,se,ye){this.props=X,this.context=se,this.refs=y,this.updater=ye||v}N.prototype.isReactComponent={},N.prototype.setState=function(X,se){if(typeof X!="object"&&typeof X!="function"&&X!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,X,se,"setState")},N.prototype.forceUpdate=function(X){this.updater.enqueueForceUpdate(this,X,"forceUpdate")};function w(){}w.prototype=N.prototype;function S(X,se,ye){this.props=X,this.context=se,this.refs=y,this.updater=ye||v}var _=S.prototype=new w;_.constructor=S,j(_,N.prototype),_.isPureReactComponent=!0;var k=Array.isArray;function T(){}var A={H:null,A:null,T:null,S:null},E=Object.prototype.hasOwnProperty;function M(X,se,ye){var Ne=ye.ref;return{$$typeof:e,type:X,key:se,ref:Ne!==void 0?Ne:null,props:ye}}function z(X,se){return M(X.type,se,X.props)}function P(X){return typeof X=="object"&&X!==null&&X.$$typeof===e}function D(X){var se={"=":"=0",":":"=2"};return"$"+X.replace(/[=:]/g,function(ye){return se[ye]})}var U=/\/+/g;function B(X,se){return typeof X=="object"&&X!==null&&X.key!=null?D(""+X.key):se.toString(36)}function R(X){switch(X.status){case"fulfilled":return X.value;case"rejected":throw X.reason;default:switch(typeof X.status=="string"?X.then(T,T):(X.status="pending",X.then(function(se){X.status==="pending"&&(X.status="fulfilled",X.value=se)},function(se){X.status==="pending"&&(X.status="rejected",X.reason=se)})),X.status){case"fulfilled":return X.value;case"rejected":throw X.reason}}throw X}function q(X,se,ye,Ne,fe){var we=typeof X;(we==="undefined"||we==="boolean")&&(X=null);var de=!1;if(X===null)de=!0;else switch(we){case"bigint":case"string":case"number":de=!0;break;case"object":switch(X.$$typeof){case e:case t:de=!0;break;case d:return de=X._init,q(de(X._payload),se,ye,Ne,fe)}}if(de)return fe=fe(X),de=Ne===""?"."+B(X,0):Ne,k(fe)?(ye="",de!=null&&(ye=de.replace(U,"$&/")+"/"),q(fe,se,ye,"",function($e){return $e})):fe!=null&&(P(fe)&&(fe=z(fe,ye+(fe.key==null||X&&X.key===fe.key?"":(""+fe.key).replace(U,"$&/")+"/")+de)),se.push(fe)),1;de=0;var ke=Ne===""?".":Ne+":";if(k(X))for(var ge=0;ge<X.length;ge++)Ne=X[ge],we=ke+B(Ne,ge),de+=q(Ne,se,ye,we,fe);else if(ge=x(X),typeof ge=="function")for(X=ge.call(X),ge=0;!(Ne=X.next()).done;)Ne=Ne.value,we=ke+B(Ne,ge++),de+=q(Ne,se,ye,we,fe);else if(we==="object"){if(typeof X.then=="function")return q(R(X),se,ye,Ne,fe);throw se=String(X),Error("Objects are not valid as a React child (found: "+(se==="[object Object]"?"object with keys {"+Object.keys(X).join(", ")+"}":se)+"). If you meant to render a collection of children, use an array instead.")}return de}function Z(X,se,ye){if(X==null)return X;var Ne=[],fe=0;return q(X,Ne,"","",function(we){return se.call(ye,we,fe++)}),Ne}function V(X){if(X._status===-1){var se=X._result;se=se(),se.then(function(ye){(X._status===0||X._status===-1)&&(X._status=1,X._result=ye)},function(ye){(X._status===0||X._status===-1)&&(X._status=2,X._result=ye)}),X._status===-1&&(X._status=0,X._result=se)}if(X._status===1)return X._result.default;throw X._result}var oe=typeof reportError=="function"?reportError:function(X){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var se=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof X=="object"&&X!==null&&typeof X.message=="string"?String(X.message):String(X),error:X});if(!window.dispatchEvent(se))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",X);return}console.error(X)},je={map:Z,forEach:function(X,se,ye){Z(X,function(){se.apply(this,arguments)},ye)},count:function(X){var se=0;return Z(X,function(){se++}),se},toArray:function(X){return Z(X,function(se){return se})||[]},only:function(X){if(!P(X))throw Error("React.Children.only expected to receive a single React element child.");return X}};return na.Activity=h,na.Children=je,na.Component=N,na.Fragment=n,na.Profiler=r,na.PureComponent=S,na.StrictMode=s,na.Suspense=c,na.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=A,na.__COMPILER_RUNTIME={__proto__:null,c:function(X){return A.H.useMemoCache(X)}},na.cache=function(X){return function(){return X.apply(null,arguments)}},na.cacheSignal=function(){return null},na.cloneElement=function(X,se,ye){if(X==null)throw Error("The argument must be a React element, but you passed "+X+".");var Ne=j({},X.props),fe=X.key;if(se!=null)for(we in se.key!==void 0&&(fe=""+se.key),se)!E.call(se,we)||we==="key"||we==="__self"||we==="__source"||we==="ref"&&se.ref===void 0||(Ne[we]=se[we]);var we=arguments.length-2;if(we===1)Ne.children=ye;else if(1<we){for(var de=Array(we),ke=0;ke<we;ke++)de[ke]=arguments[ke+2];Ne.children=de}return M(X.type,fe,Ne)},na.createContext=function(X){return X={$$typeof:o,_currentValue:X,_currentValue2:X,_threadCount:0,Provider:null,Consumer:null},X.Provider=X,X.Consumer={$$typeof:i,_context:X},X},na.createElement=function(X,se,ye){var Ne,fe={},we=null;if(se!=null)for(Ne in se.key!==void 0&&(we=""+se.key),se)E.call(se,Ne)&&Ne!=="key"&&Ne!=="__self"&&Ne!=="__source"&&(fe[Ne]=se[Ne]);var de=arguments.length-2;if(de===1)fe.children=ye;else if(1<de){for(var ke=Array(de),ge=0;ge<de;ge++)ke[ge]=arguments[ge+2];fe.children=ke}if(X&&X.defaultProps)for(Ne in de=X.defaultProps,de)fe[Ne]===void 0&&(fe[Ne]=de[Ne]);return M(X,we,fe)},na.createRef=function(){return{current:null}},na.forwardRef=function(X){return{$$typeof:l,render:X}},na.isValidElement=P,na.lazy=function(X){return{$$typeof:d,_payload:{_status:-1,_result:X},_init:V}},na.memo=function(X,se){return{$$typeof:u,type:X,compare:se===void 0?null:se}},na.startTransition=function(X){var se=A.T,ye={};A.T=ye;try{var Ne=X(),fe=A.S;fe!==null&&fe(ye,Ne),typeof Ne=="object"&&Ne!==null&&typeof Ne.then=="function"&&Ne.then(T,oe)}catch(we){oe(we)}finally{se!==null&&ye.types!==null&&(se.types=ye.types),A.T=se}},na.unstable_useCacheRefresh=function(){return A.H.useCacheRefresh()},na.use=function(X){return A.H.use(X)},na.useActionState=function(X,se,ye){return A.H.useActionState(X,se,ye)},na.useCallback=function(X,se){return A.H.useCallback(X,se)},na.useContext=function(X){return A.H.useContext(X)},na.useDebugValue=function(){},na.useDeferredValue=function(X,se){return A.H.useDeferredValue(X,se)},na.useEffect=function(X,se){return A.H.useEffect(X,se)},na.useEffectEvent=function(X){return A.H.useEffectEvent(X)},na.useId=function(){return A.H.useId()},na.useImperativeHandle=function(X,se,ye){return A.H.useImperativeHandle(X,se,ye)},na.useInsertionEffect=function(X,se){return A.H.useInsertionEffect(X,se)},na.useLayoutEffect=function(X,se){return A.H.useLayoutEffect(X,se)},na.useMemo=function(X,se){return A.H.useMemo(X,se)},na.useOptimistic=function(X,se){return A.H.useOptimistic(X,se)},na.useReducer=function(X,se,ye){return A.H.useReducer(X,se,ye)},na.useRef=function(X){return A.H.useRef(X)},na.useState=function(X){return A.H.useState(X)},na.useSyncExternalStore=function(X,se,ye){return A.H.useSyncExternalStore(X,se,ye)},na.useTransition=function(){return A.H.useTransition()},na.version="19.2.0",na}var cI;function Vf(){return cI||(cI=1,GS.exports=Bae()),GS.exports}var f=Vf();const wt=ao(f),ku=zae({__proto__:null,default:wt},[f]);var WS={exports:{}},mg={},VS={exports:{}},YS={};var dI;function Hae(){return dI||(dI=1,(function(e){function t(q,Z){var V=q.length;q.push(Z);e:for(;0<V;){var oe=V-1>>>1,je=q[oe];if(0<r(je,Z))q[oe]=Z,q[V]=je,V=oe;else break e}}function n(q){return q.length===0?null:q[0]}function s(q){if(q.length===0)return null;var Z=q[0],V=q.pop();if(V!==Z){q[0]=V;e:for(var oe=0,je=q.length,X=je>>>1;oe<X;){var se=2*(oe+1)-1,ye=q[se],Ne=se+1,fe=q[Ne];if(0>r(ye,V))Ne<je&&0>r(fe,ye)?(q[oe]=fe,q[Ne]=V,oe=Ne):(q[oe]=ye,q[se]=V,oe=se);else if(Ne<je&&0>r(fe,V))q[oe]=fe,q[Ne]=V,oe=Ne;else break e}}return Z}function r(q,Z){var V=q.sortIndex-Z.sortIndex;return V!==0?V:q.id-Z.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,h=null,p=3,x=!1,v=!1,j=!1,y=!1,N=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;function _(q){for(var Z=n(u);Z!==null;){if(Z.callback===null)s(u);else if(Z.startTime<=q)s(u),Z.sortIndex=Z.expirationTime,t(c,Z);else break;Z=n(u)}}function k(q){if(j=!1,_(q),!v)if(n(c)!==null)v=!0,T||(T=!0,D());else{var Z=n(u);Z!==null&&R(k,Z.startTime-q)}}var T=!1,A=-1,E=5,M=-1;function z(){return y?!0:!(e.unstable_now()-M<E)}function P(){if(y=!1,T){var q=e.unstable_now();M=q;var Z=!0;try{e:{v=!1,j&&(j=!1,w(A),A=-1),x=!0;var V=p;try{t:{for(_(q),h=n(c);h!==null&&!(h.expirationTime>q&&z());){var oe=h.callback;if(typeof oe=="function"){h.callback=null,p=h.priorityLevel;var je=oe(h.expirationTime<=q);if(q=e.unstable_now(),typeof je=="function"){h.callback=je,_(q),Z=!0;break t}h===n(c)&&s(c),_(q)}else s(c);h=n(c)}if(h!==null)Z=!0;else{var X=n(u);X!==null&&R(k,X.startTime-q),Z=!1}}break e}finally{h=null,p=V,x=!1}Z=void 0}}finally{Z?D():T=!1}}}var D;if(typeof S=="function")D=function(){S(P)};else if(typeof MessageChannel<"u"){var U=new MessageChannel,B=U.port2;U.port1.onmessage=P,D=function(){B.postMessage(null)}}else D=function(){N(P,0)};function R(q,Z){A=N(function(){q(e.unstable_now())},Z)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(q){q.callback=null},e.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<q?Math.floor(1e3/q):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_next=function(q){switch(p){case 1:case 2:case 3:var Z=3;break;default:Z=p}var V=p;p=Z;try{return q()}finally{p=V}},e.unstable_requestPaint=function(){y=!0},e.unstable_runWithPriority=function(q,Z){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var V=p;p=q;try{return Z()}finally{p=V}},e.unstable_scheduleCallback=function(q,Z,V){var oe=e.unstable_now();switch(typeof V=="object"&&V!==null?(V=V.delay,V=typeof V=="number"&&0<V?oe+V:oe):V=oe,q){case 1:var je=-1;break;case 2:je=250;break;case 5:je=1073741823;break;case 4:je=1e4;break;default:je=5e3}return je=V+je,q={id:d++,callback:Z,priorityLevel:q,startTime:V,expirationTime:je,sortIndex:-1},V>oe?(q.sortIndex=V,t(u,q),n(c)===null&&q===n(u)&&(j?(w(A),A=-1):j=!0,R(k,V-oe))):(q.sortIndex=je,t(c,q),v||x||(v=!0,T||(T=!0,D()))),q},e.unstable_shouldYield=z,e.unstable_wrapCallback=function(q){var Z=p;return function(){var V=p;p=Z;try{return q.apply(this,arguments)}finally{p=V}}}})(YS)),YS}var uI;function qae(){return uI||(uI=1,VS.exports=Hae()),VS.exports}var QS={exports:{}},Es={};var mI;function Gae(){if(mI)return Es;mI=1;var e=Vf();function t(c){var u="https://react.dev/errors/"+c;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var d=2;d<arguments.length;d++)u+="&args[]="+encodeURIComponent(arguments[d])}return"Minified React error #"+c+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var s={d:{f:n,r:function(){throw Error(t(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},r=Symbol.for("react.portal");function i(c,u,d){var h=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:h==null?null:""+h,children:c,containerInfo:u,implementation:d}}var o=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function l(c,u){if(c==="font")return"";if(typeof u=="string")return u==="use-credentials"?u:""}return Es.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,Es.createPortal=function(c,u){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)throw Error(t(299));return i(c,u,null,d)},Es.flushSync=function(c){var u=o.T,d=s.p;try{if(o.T=null,s.p=2,c)return c()}finally{o.T=u,s.p=d,s.d.f()}},Es.preconnect=function(c,u){typeof c=="string"&&(u?(u=u.crossOrigin,u=typeof u=="string"?u==="use-credentials"?u:"":void 0):u=null,s.d.C(c,u))},Es.prefetchDNS=function(c){typeof c=="string"&&s.d.D(c)},Es.preinit=function(c,u){if(typeof c=="string"&&u&&typeof u.as=="string"){var d=u.as,h=l(d,u.crossOrigin),p=typeof u.integrity=="string"?u.integrity:void 0,x=typeof u.fetchPriority=="string"?u.fetchPriority:void 0;d==="style"?s.d.S(c,typeof u.precedence=="string"?u.precedence:void 0,{crossOrigin:h,integrity:p,fetchPriority:x}):d==="script"&&s.d.X(c,{crossOrigin:h,integrity:p,fetchPriority:x,nonce:typeof u.nonce=="string"?u.nonce:void 0})}},Es.preinitModule=function(c,u){if(typeof c=="string")if(typeof u=="object"&&u!==null){if(u.as==null||u.as==="script"){var d=l(u.as,u.crossOrigin);s.d.M(c,{crossOrigin:d,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0})}}else u==null&&s.d.M(c)},Es.preload=function(c,u){if(typeof c=="string"&&typeof u=="object"&&u!==null&&typeof u.as=="string"){var d=u.as,h=l(d,u.crossOrigin);s.d.L(c,d,{crossOrigin:h,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0,type:typeof u.type=="string"?u.type:void 0,fetchPriority:typeof u.fetchPriority=="string"?u.fetchPriority:void 0,referrerPolicy:typeof u.referrerPolicy=="string"?u.referrerPolicy:void 0,imageSrcSet:typeof u.imageSrcSet=="string"?u.imageSrcSet:void 0,imageSizes:typeof u.imageSizes=="string"?u.imageSizes:void 0,media:typeof u.media=="string"?u.media:void 0})}},Es.preloadModule=function(c,u){if(typeof c=="string")if(u){var d=l(u.as,u.crossOrigin);s.d.m(c,{as:typeof u.as=="string"&&u.as!=="script"?u.as:void 0,crossOrigin:d,integrity:typeof u.integrity=="string"?u.integrity:void 0})}else s.d.m(c)},Es.requestFormReset=function(c){s.d.r(c)},Es.unstable_batchedUpdates=function(c,u){return c(u)},Es.useFormState=function(c,u,d){return o.H.useFormState(c,u,d)},Es.useFormStatus=function(){return o.H.useHostTransitionStatus()},Es.version="19.2.0",Es}var fI;function pH(){if(fI)return QS.exports;fI=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),QS.exports=Gae(),QS.exports}var hI;function Wae(){if(hI)return mg;hI=1;var e=qae(),t=Vf(),n=pH();function s(m){var g="https://react.dev/errors/"+m;if(1<arguments.length){g+="?args[]="+encodeURIComponent(arguments[1]);for(var b=2;b<arguments.length;b++)g+="&args[]="+encodeURIComponent(arguments[b])}return"Minified React error #"+m+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(m){return!(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)}function i(m){var g=m,b=m;if(m.alternate)for(;g.return;)g=g.return;else{m=g;do g=m,(g.flags&4098)!==0&&(b=g.return),m=g.return;while(m)}return g.tag===3?b:null}function o(m){if(m.tag===13){var g=m.memoizedState;if(g===null&&(m=m.alternate,m!==null&&(g=m.memoizedState)),g!==null)return g.dehydrated}return null}function l(m){if(m.tag===31){var g=m.memoizedState;if(g===null&&(m=m.alternate,m!==null&&(g=m.memoizedState)),g!==null)return g.dehydrated}return null}function c(m){if(i(m)!==m)throw Error(s(188))}function u(m){var g=m.alternate;if(!g){if(g=i(m),g===null)throw Error(s(188));return g!==m?null:m}for(var b=m,C=g;;){var O=b.return;if(O===null)break;var $=O.alternate;if($===null){if(C=O.return,C!==null){b=C;continue}break}if(O.child===$.child){for($=O.child;$;){if($===b)return c(O),m;if($===C)return c(O),g;$=$.sibling}throw Error(s(188))}if(b.return!==C.return)b=O,C=$;else{for(var te=!1,Se=O.child;Se;){if(Se===b){te=!0,b=O,C=$;break}if(Se===C){te=!0,C=O,b=$;break}Se=Se.sibling}if(!te){for(Se=$.child;Se;){if(Se===b){te=!0,b=$,C=O;break}if(Se===C){te=!0,C=$,b=O;break}Se=Se.sibling}if(!te)throw Error(s(189))}}if(b.alternate!==C)throw Error(s(190))}if(b.tag!==3)throw Error(s(188));return b.stateNode.current===b?m:g}function d(m){var g=m.tag;if(g===5||g===26||g===27||g===6)return m;for(m=m.child;m!==null;){if(g=d(m),g!==null)return g;m=m.sibling}return null}var h=Object.assign,p=Symbol.for("react.element"),x=Symbol.for("react.transitional.element"),v=Symbol.for("react.portal"),j=Symbol.for("react.fragment"),y=Symbol.for("react.strict_mode"),N=Symbol.for("react.profiler"),w=Symbol.for("react.consumer"),S=Symbol.for("react.context"),_=Symbol.for("react.forward_ref"),k=Symbol.for("react.suspense"),T=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),E=Symbol.for("react.lazy"),M=Symbol.for("react.activity"),z=Symbol.for("react.memo_cache_sentinel"),P=Symbol.iterator;function D(m){return m===null||typeof m!="object"?null:(m=P&&m[P]||m["@@iterator"],typeof m=="function"?m:null)}var U=Symbol.for("react.client.reference");function B(m){if(m==null)return null;if(typeof m=="function")return m.$$typeof===U?null:m.displayName||m.name||null;if(typeof m=="string")return m;switch(m){case j:return"Fragment";case N:return"Profiler";case y:return"StrictMode";case k:return"Suspense";case T:return"SuspenseList";case M:return"Activity"}if(typeof m=="object")switch(m.$$typeof){case v:return"Portal";case S:return m.displayName||"Context";case w:return(m._context.displayName||"Context")+".Consumer";case _:var g=m.render;return m=m.displayName,m||(m=g.displayName||g.name||"",m=m!==""?"ForwardRef("+m+")":"ForwardRef"),m;case A:return g=m.displayName||null,g!==null?g:B(m.type)||"Memo";case E:g=m._payload,m=m._init;try{return B(m(g))}catch{}}return null}var R=Array.isArray,q=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Z=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,V={pending:!1,data:null,method:null,action:null},oe=[],je=-1;function X(m){return{current:m}}function se(m){0>je||(m.current=oe[je],oe[je]=null,je--)}function ye(m,g){je++,oe[je]=m.current,m.current=g}var Ne=X(null),fe=X(null),we=X(null),de=X(null);function ke(m,g){switch(ye(we,g),ye(fe,m),ye(Ne,null),g.nodeType){case 9:case 11:m=(m=g.documentElement)&&(m=m.namespaceURI)?kM(m):0;break;default:if(m=g.tagName,g=g.namespaceURI)g=kM(g),m=EM(g,m);else switch(m){case"svg":m=1;break;case"math":m=2;break;default:m=0}}se(Ne),ye(Ne,m)}function ge(){se(Ne),se(fe),se(we)}function $e(m){m.memoizedState!==null&&ye(de,m);var g=Ne.current,b=EM(g,m.type);g!==b&&(ye(fe,m),ye(Ne,b))}function be(m){fe.current===m&&(se(Ne),se(fe)),de.current===m&&(se(de),og._currentValue=V)}var me,Ue;function Ee(m){if(me===void 0)try{throw Error()}catch(b){var g=b.stack.trim().match(/\n( *(at )?)/);me=g&&g[1]||"",Ue=-1<b.stack.indexOf(`
    at`)?" (<anonymous>)":-1<b.stack.indexOf("@")?"@unknown:0:0":""}return`
`+me+m+Ue}var We=!1;function tt(m,g){if(!m||We)return"";We=!0;var b=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var C={DetermineComponentFrameRoot:function(){try{if(g){var jt=function(){throw Error()};if(Object.defineProperty(jt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(jt,[])}catch(pt){var mt=pt}Reflect.construct(m,[],jt)}else{try{jt.call()}catch(pt){mt=pt}m.call(jt.prototype)}}else{try{throw Error()}catch(pt){mt=pt}(jt=m())&&typeof jt.catch=="function"&&jt.catch(function(){})}}catch(pt){if(pt&&mt&&typeof pt.stack=="string")return[pt.stack,mt.stack]}return[null,null]}};C.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var O=Object.getOwnPropertyDescriptor(C.DetermineComponentFrameRoot,"name");O&&O.configurable&&Object.defineProperty(C.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var $=C.DetermineComponentFrameRoot(),te=$[0],Se=$[1];if(te&&Se){var Ye=te.split(`
`),dt=Se.split(`
`);for(O=C=0;C<Ye.length&&!Ye[C].includes("DetermineComponentFrameRoot");)C++;for(;O<dt.length&&!dt[O].includes("DetermineComponentFrameRoot");)O++;if(C===Ye.length||O===dt.length)for(C=Ye.length-1,O=dt.length-1;1<=C&&0<=O&&Ye[C]!==dt[O];)O--;for(;1<=C&&0<=O;C--,O--)if(Ye[C]!==dt[O]){if(C!==1||O!==1)do if(C--,O--,0>O||Ye[C]!==dt[O]){var xt=`
`+Ye[C].replace(" at new "," at ");return m.displayName&&xt.includes("<anonymous>")&&(xt=xt.replace("<anonymous>",m.displayName)),xt}while(1<=C&&0<=O);break}}}finally{We=!1,Error.prepareStackTrace=b}return(b=m?m.displayName||m.name:"")?Ee(b):""}function lt(m,g){switch(m.tag){case 26:case 27:case 5:return Ee(m.type);case 16:return Ee("Lazy");case 13:return m.child!==g&&g!==null?Ee("Suspense Fallback"):Ee("Suspense");case 19:return Ee("SuspenseList");case 0:case 15:return tt(m.type,!1);case 11:return tt(m.type.render,!1);case 1:return tt(m.type,!0);case 31:return Ee("Activity");default:return""}}function Fe(m){try{var g="",b=null;do g+=lt(m,b),b=m,m=m.return;while(m);return g}catch(C){return`
Error generating stack: `+C.message+`
`+C.stack}}var st=Object.prototype.hasOwnProperty,Xe=e.unstable_scheduleCallback,Ze=e.unstable_cancelCallback,Je=e.unstable_shouldYield,Be=e.unstable_requestPaint,_e=e.unstable_now,pe=e.unstable_getCurrentPriorityLevel,ce=e.unstable_ImmediatePriority,Q=e.unstable_UserBlockingPriority,ne=e.unstable_NormalPriority,ae=e.unstable_LowPriority,Pe=e.unstable_IdlePriority,Te=e.log,he=e.unstable_setDisableYieldValue,He=null,qe=null;function nt(m){if(typeof Te=="function"&&he(m),qe&&typeof qe.setStrictMode=="function")try{qe.setStrictMode(He,m)}catch{}}var ot=Math.clz32?Math.clz32:St,Re=Math.log,it=Math.LN2;function St(m){return m>>>=0,m===0?32:31-(Re(m)/it|0)|0}var Et=256,Tt=262144,Nt=4194304;function xe(m){var g=m&42;if(g!==0)return g;switch(m&-m){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return m&261888;case 262144:case 524288:case 1048576:case 2097152:return m&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return m&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return m}}function ve(m,g,b){var C=m.pendingLanes;if(C===0)return 0;var O=0,$=m.suspendedLanes,te=m.pingedLanes;m=m.warmLanes;var Se=C&134217727;return Se!==0?(C=Se&~$,C!==0?O=xe(C):(te&=Se,te!==0?O=xe(te):b||(b=Se&~m,b!==0&&(O=xe(b))))):(Se=C&~$,Se!==0?O=xe(Se):te!==0?O=xe(te):b||(b=C&~m,b!==0&&(O=xe(b)))),O===0?0:g!==0&&g!==O&&(g&$)===0&&($=O&-O,b=g&-g,$>=b||$===32&&(b&4194048)!==0)?g:O}function Oe(m,g){return(m.pendingLanes&~(m.suspendedLanes&~m.pingedLanes)&g)===0}function Ce(m,g){switch(m){case 1:case 2:case 4:case 8:case 64:return g+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return g+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Qe(){var m=Nt;return Nt<<=1,(Nt&62914560)===0&&(Nt=4194304),m}function G(m){for(var g=[],b=0;31>b;b++)g.push(m);return g}function W(m,g){m.pendingLanes|=g,g!==268435456&&(m.suspendedLanes=0,m.pingedLanes=0,m.warmLanes=0)}function J(m,g,b,C,O,$){var te=m.pendingLanes;m.pendingLanes=b,m.suspendedLanes=0,m.pingedLanes=0,m.warmLanes=0,m.expiredLanes&=b,m.entangledLanes&=b,m.errorRecoveryDisabledLanes&=b,m.shellSuspendCounter=0;var Se=m.entanglements,Ye=m.expirationTimes,dt=m.hiddenUpdates;for(b=te&~b;0<b;){var xt=31-ot(b),jt=1<<xt;Se[xt]=0,Ye[xt]=-1;var mt=dt[xt];if(mt!==null)for(dt[xt]=null,xt=0;xt<mt.length;xt++){var pt=mt[xt];pt!==null&&(pt.lane&=-536870913)}b&=~jt}C!==0&&Y(m,C,0),$!==0&&O===0&&m.tag!==0&&(m.suspendedLanes|=$&~(te&~g))}function Y(m,g,b){m.pendingLanes|=g,m.suspendedLanes&=~g;var C=31-ot(g);m.entangledLanes|=g,m.entanglements[C]=m.entanglements[C]|1073741824|b&261930}function F(m,g){var b=m.entangledLanes|=g;for(m=m.entanglements;b;){var C=31-ot(b),O=1<<C;O&g|m[C]&g&&(m[C]|=g),b&=~O}}function ue(m,g){var b=g&-g;return b=(b&42)!==0?1:De(b),(b&(m.suspendedLanes|g))!==0?0:b}function De(m){switch(m){case 2:m=1;break;case 8:m=4;break;case 32:m=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:m=128;break;case 268435456:m=134217728;break;default:m=0}return m}function le(m){return m&=-m,2<m?8<m?(m&134217727)!==0?32:268435456:8:2}function Ie(){var m=Z.p;return m!==0?m:(m=window.event,m===void 0?32:JM(m.type))}function K(m,g){var b=Z.p;try{return Z.p=m,g()}finally{Z.p=b}}var ie=Math.random().toString(36).slice(2),Me="__reactFiber$"+ie,Ke="__reactProps$"+ie,gt="__reactContainer$"+ie,Ct="__reactEvents$"+ie,Ht="__reactListeners$"+ie,da="__reactHandles$"+ie,Ge="__reactResources$"+ie,Ae="__reactMarker$"+ie;function I(m){delete m[Me],delete m[Ke],delete m[Ct],delete m[Ht],delete m[da]}function L(m){var g=m[Me];if(g)return g;for(var b=m.parentNode;b;){if(g=b[gt]||b[Me]){if(b=g.alternate,g.child!==null||b!==null&&b.child!==null)for(m=$M(m);m!==null;){if(b=m[Me])return b;m=$M(m)}return g}m=b,b=m.parentNode}return null}function ee(m){if(m=m[Me]||m[gt]){var g=m.tag;if(g===5||g===6||g===13||g===31||g===26||g===27||g===3)return m}return null}function Le(m){var g=m.tag;if(g===5||g===26||g===27||g===6)return m.stateNode;throw Error(s(33))}function ze(m){var g=m[Ge];return g||(g=m[Ge]={hoistableStyles:new Map,hoistableScripts:new Map}),g}function Ve(m){m[Ae]=!0}var ft=new Set,_t={};function At(m,g){Yt(m,g),Yt(m+"Capture",g)}function Yt(m,g){for(_t[m]=g,m=0;m<g.length;m++)ft.add(g[m])}var En=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Qr={},j0={};function Lee(m){return st.call(j0,m)?!0:st.call(Qr,m)?!1:En.test(m)?j0[m]=!0:(Qr[m]=!0,!1)}function N0(m,g,b){if(Lee(g))if(b===null)m.removeAttribute(g);else{switch(typeof b){case"undefined":case"function":case"symbol":m.removeAttribute(g);return;case"boolean":var C=g.toLowerCase().slice(0,5);if(C!=="data-"&&C!=="aria-"){m.removeAttribute(g);return}}m.setAttribute(g,""+b)}}function C0(m,g,b){if(b===null)m.removeAttribute(g);else{switch(typeof b){case"undefined":case"function":case"symbol":case"boolean":m.removeAttribute(g);return}m.setAttribute(g,""+b)}}function Zo(m,g,b,C){if(C===null)m.removeAttribute(b);else{switch(typeof C){case"undefined":case"function":case"symbol":case"boolean":m.removeAttribute(b);return}m.setAttributeNS(g,b,""+C)}}function Kr(m){switch(typeof m){case"bigint":case"boolean":case"number":case"string":case"undefined":return m;case"object":return m;default:return""}}function w3(m){var g=m.type;return(m=m.nodeName)&&m.toLowerCase()==="input"&&(g==="checkbox"||g==="radio")}function Pee(m,g,b){var C=Object.getOwnPropertyDescriptor(m.constructor.prototype,g);if(!m.hasOwnProperty(g)&&typeof C<"u"&&typeof C.get=="function"&&typeof C.set=="function"){var O=C.get,$=C.set;return Object.defineProperty(m,g,{configurable:!0,get:function(){return O.call(this)},set:function(te){b=""+te,$.call(this,te)}}),Object.defineProperty(m,g,{enumerable:C.enumerable}),{getValue:function(){return b},setValue:function(te){b=""+te},stopTracking:function(){m._valueTracker=null,delete m[g]}}}}function $1(m){if(!m._valueTracker){var g=w3(m)?"checked":"value";m._valueTracker=Pee(m,g,""+m[g])}}function j3(m){if(!m)return!1;var g=m._valueTracker;if(!g)return!0;var b=g.getValue(),C="";return m&&(C=w3(m)?m.checked?"true":"false":m.value),m=C,m!==b?(g.setValue(m),!0):!1}function S0(m){if(m=m||(typeof document<"u"?document:void 0),typeof m>"u")return null;try{return m.activeElement||m.body}catch{return m.body}}var Dee=/[\n"\\]/g;function Xr(m){return m.replace(Dee,function(g){return"\\"+g.charCodeAt(0).toString(16)+" "})}function R1(m,g,b,C,O,$,te,Se){m.name="",te!=null&&typeof te!="function"&&typeof te!="symbol"&&typeof te!="boolean"?m.type=te:m.removeAttribute("type"),g!=null?te==="number"?(g===0&&m.value===""||m.value!=g)&&(m.value=""+Kr(g)):m.value!==""+Kr(g)&&(m.value=""+Kr(g)):te!=="submit"&&te!=="reset"||m.removeAttribute("value"),g!=null?z1(m,te,Kr(g)):b!=null?z1(m,te,Kr(b)):C!=null&&m.removeAttribute("value"),O==null&&$!=null&&(m.defaultChecked=!!$),O!=null&&(m.checked=O&&typeof O!="function"&&typeof O!="symbol"),Se!=null&&typeof Se!="function"&&typeof Se!="symbol"&&typeof Se!="boolean"?m.name=""+Kr(Se):m.removeAttribute("name")}function N3(m,g,b,C,O,$,te,Se){if($!=null&&typeof $!="function"&&typeof $!="symbol"&&typeof $!="boolean"&&(m.type=$),g!=null||b!=null){if(!($!=="submit"&&$!=="reset"||g!=null)){$1(m);return}b=b!=null?""+Kr(b):"",g=g!=null?""+Kr(g):b,Se||g===m.value||(m.value=g),m.defaultValue=g}C=C??O,C=typeof C!="function"&&typeof C!="symbol"&&!!C,m.checked=Se?m.checked:!!C,m.defaultChecked=!!C,te!=null&&typeof te!="function"&&typeof te!="symbol"&&typeof te!="boolean"&&(m.name=te),$1(m)}function z1(m,g,b){g==="number"&&S0(m.ownerDocument)===m||m.defaultValue===""+b||(m.defaultValue=""+b)}function cm(m,g,b,C){if(m=m.options,g){g={};for(var O=0;O<b.length;O++)g["$"+b[O]]=!0;for(b=0;b<m.length;b++)O=g.hasOwnProperty("$"+m[b].value),m[b].selected!==O&&(m[b].selected=O),O&&C&&(m[b].defaultSelected=!0)}else{for(b=""+Kr(b),g=null,O=0;O<m.length;O++){if(m[O].value===b){m[O].selected=!0,C&&(m[O].defaultSelected=!0);return}g!==null||m[O].disabled||(g=m[O])}g!==null&&(g.selected=!0)}}function C3(m,g,b){if(g!=null&&(g=""+Kr(g),g!==m.value&&(m.value=g),b==null)){m.defaultValue!==g&&(m.defaultValue=g);return}m.defaultValue=b!=null?""+Kr(b):""}function S3(m,g,b,C){if(g==null){if(C!=null){if(b!=null)throw Error(s(92));if(R(C)){if(1<C.length)throw Error(s(93));C=C[0]}b=C}b==null&&(b=""),g=b}b=Kr(g),m.defaultValue=b,C=m.textContent,C===b&&C!==""&&C!==null&&(m.value=C),$1(m)}function dm(m,g){if(g){var b=m.firstChild;if(b&&b===m.lastChild&&b.nodeType===3){b.nodeValue=g;return}}m.textContent=g}var Oee=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function _3(m,g,b){var C=g.indexOf("--")===0;b==null||typeof b=="boolean"||b===""?C?m.setProperty(g,""):g==="float"?m.cssFloat="":m[g]="":C?m.setProperty(g,b):typeof b!="number"||b===0||Oee.has(g)?g==="float"?m.cssFloat=b:m[g]=(""+b).trim():m[g]=b+"px"}function A3(m,g,b){if(g!=null&&typeof g!="object")throw Error(s(62));if(m=m.style,b!=null){for(var C in b)!b.hasOwnProperty(C)||g!=null&&g.hasOwnProperty(C)||(C.indexOf("--")===0?m.setProperty(C,""):C==="float"?m.cssFloat="":m[C]="");for(var O in g)C=g[O],g.hasOwnProperty(O)&&b[O]!==C&&_3(m,O,C)}else for(var $ in g)g.hasOwnProperty($)&&_3(m,$,g[$])}function F1(m){if(m.indexOf("-")===-1)return!1;switch(m){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Mee=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Iee=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function _0(m){return Iee.test(""+m)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":m}function Jo(){}var U1=null;function B1(m){return m=m.target||m.srcElement||window,m.correspondingUseElement&&(m=m.correspondingUseElement),m.nodeType===3?m.parentNode:m}var um=null,mm=null;function T3(m){var g=ee(m);if(g&&(m=g.stateNode)){var b=m[Ke]||null;e:switch(m=g.stateNode,g.type){case"input":if(R1(m,b.value,b.defaultValue,b.defaultValue,b.checked,b.defaultChecked,b.type,b.name),g=b.name,b.type==="radio"&&g!=null){for(b=m;b.parentNode;)b=b.parentNode;for(b=b.querySelectorAll('input[name="'+Xr(""+g)+'"][type="radio"]'),g=0;g<b.length;g++){var C=b[g];if(C!==m&&C.form===m.form){var O=C[Ke]||null;if(!O)throw Error(s(90));R1(C,O.value,O.defaultValue,O.defaultValue,O.checked,O.defaultChecked,O.type,O.name)}}for(g=0;g<b.length;g++)C=b[g],C.form===m.form&&j3(C)}break e;case"textarea":C3(m,b.value,b.defaultValue);break e;case"select":g=b.value,g!=null&&cm(m,!!b.multiple,g,!1)}}}var H1=!1;function k3(m,g,b){if(H1)return m(g,b);H1=!0;try{var C=m(g);return C}finally{if(H1=!1,(um!==null||mm!==null)&&(fy(),um&&(g=um,m=mm,mm=um=null,T3(g),m)))for(g=0;g<m.length;g++)T3(m[g])}}function Ch(m,g){var b=m.stateNode;if(b===null)return null;var C=b[Ke]||null;if(C===null)return null;b=C[g];e:switch(g){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(C=!C.disabled)||(m=m.type,C=!(m==="button"||m==="input"||m==="select"||m==="textarea")),m=!C;break e;default:m=!1}if(m)return null;if(b&&typeof b!="function")throw Error(s(231,g,typeof b));return b}var el=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),q1=!1;if(el)try{var Sh={};Object.defineProperty(Sh,"passive",{get:function(){q1=!0}}),window.addEventListener("test",Sh,Sh),window.removeEventListener("test",Sh,Sh)}catch{q1=!1}var gc=null,G1=null,A0=null;function E3(){if(A0)return A0;var m,g=G1,b=g.length,C,O="value"in gc?gc.value:gc.textContent,$=O.length;for(m=0;m<b&&g[m]===O[m];m++);var te=b-m;for(C=1;C<=te&&g[b-C]===O[$-C];C++);return A0=O.slice(m,1<C?1-C:void 0)}function T0(m){var g=m.keyCode;return"charCode"in m?(m=m.charCode,m===0&&g===13&&(m=13)):m=g,m===10&&(m=13),32<=m||m===13?m:0}function k0(){return!0}function L3(){return!1}function er(m){function g(b,C,O,$,te){this._reactName=b,this._targetInst=O,this.type=C,this.nativeEvent=$,this.target=te,this.currentTarget=null;for(var Se in m)m.hasOwnProperty(Se)&&(b=m[Se],this[Se]=b?b($):$[Se]);return this.isDefaultPrevented=($.defaultPrevented!=null?$.defaultPrevented:$.returnValue===!1)?k0:L3,this.isPropagationStopped=L3,this}return h(g.prototype,{preventDefault:function(){this.defaultPrevented=!0;var b=this.nativeEvent;b&&(b.preventDefault?b.preventDefault():typeof b.returnValue!="unknown"&&(b.returnValue=!1),this.isDefaultPrevented=k0)},stopPropagation:function(){var b=this.nativeEvent;b&&(b.stopPropagation?b.stopPropagation():typeof b.cancelBubble!="unknown"&&(b.cancelBubble=!0),this.isPropagationStopped=k0)},persist:function(){},isPersistent:k0}),g}var Dd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(m){return m.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},E0=er(Dd),_h=h({},Dd,{view:0,detail:0}),$ee=er(_h),W1,V1,Ah,L0=h({},_h,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Q1,button:0,buttons:0,relatedTarget:function(m){return m.relatedTarget===void 0?m.fromElement===m.srcElement?m.toElement:m.fromElement:m.relatedTarget},movementX:function(m){return"movementX"in m?m.movementX:(m!==Ah&&(Ah&&m.type==="mousemove"?(W1=m.screenX-Ah.screenX,V1=m.screenY-Ah.screenY):V1=W1=0,Ah=m),W1)},movementY:function(m){return"movementY"in m?m.movementY:V1}}),P3=er(L0),Ree=h({},L0,{dataTransfer:0}),zee=er(Ree),Fee=h({},_h,{relatedTarget:0}),Y1=er(Fee),Uee=h({},Dd,{animationName:0,elapsedTime:0,pseudoElement:0}),Bee=er(Uee),Hee=h({},Dd,{clipboardData:function(m){return"clipboardData"in m?m.clipboardData:window.clipboardData}}),qee=er(Hee),Gee=h({},Dd,{data:0}),D3=er(Gee),Wee={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Vee={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Yee={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Qee(m){var g=this.nativeEvent;return g.getModifierState?g.getModifierState(m):(m=Yee[m])?!!g[m]:!1}function Q1(){return Qee}var Kee=h({},_h,{key:function(m){if(m.key){var g=Wee[m.key]||m.key;if(g!=="Unidentified")return g}return m.type==="keypress"?(m=T0(m),m===13?"Enter":String.fromCharCode(m)):m.type==="keydown"||m.type==="keyup"?Vee[m.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Q1,charCode:function(m){return m.type==="keypress"?T0(m):0},keyCode:function(m){return m.type==="keydown"||m.type==="keyup"?m.keyCode:0},which:function(m){return m.type==="keypress"?T0(m):m.type==="keydown"||m.type==="keyup"?m.keyCode:0}}),Xee=er(Kee),Zee=h({},L0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),O3=er(Zee),Jee=h({},_h,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Q1}),ete=er(Jee),tte=h({},Dd,{propertyName:0,elapsedTime:0,pseudoElement:0}),ate=er(tte),nte=h({},L0,{deltaX:function(m){return"deltaX"in m?m.deltaX:"wheelDeltaX"in m?-m.wheelDeltaX:0},deltaY:function(m){return"deltaY"in m?m.deltaY:"wheelDeltaY"in m?-m.wheelDeltaY:"wheelDelta"in m?-m.wheelDelta:0},deltaZ:0,deltaMode:0}),ste=er(nte),rte=h({},Dd,{newState:0,oldState:0}),ite=er(rte),ote=[9,13,27,32],K1=el&&"CompositionEvent"in window,Th=null;el&&"documentMode"in document&&(Th=document.documentMode);var lte=el&&"TextEvent"in window&&!Th,M3=el&&(!K1||Th&&8<Th&&11>=Th),I3=" ",$3=!1;function R3(m,g){switch(m){case"keyup":return ote.indexOf(g.keyCode)!==-1;case"keydown":return g.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function z3(m){return m=m.detail,typeof m=="object"&&"data"in m?m.data:null}var fm=!1;function cte(m,g){switch(m){case"compositionend":return z3(g);case"keypress":return g.which!==32?null:($3=!0,I3);case"textInput":return m=g.data,m===I3&&$3?null:m;default:return null}}function dte(m,g){if(fm)return m==="compositionend"||!K1&&R3(m,g)?(m=E3(),A0=G1=gc=null,fm=!1,m):null;switch(m){case"paste":return null;case"keypress":if(!(g.ctrlKey||g.altKey||g.metaKey)||g.ctrlKey&&g.altKey){if(g.char&&1<g.char.length)return g.char;if(g.which)return String.fromCharCode(g.which)}return null;case"compositionend":return M3&&g.locale!=="ko"?null:g.data;default:return null}}var ute={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function F3(m){var g=m&&m.nodeName&&m.nodeName.toLowerCase();return g==="input"?!!ute[m.type]:g==="textarea"}function U3(m,g,b,C){um?mm?mm.push(C):mm=[C]:um=C,g=vy(g,"onChange"),0<g.length&&(b=new E0("onChange","change",null,b,C),m.push({event:b,listeners:g}))}var kh=null,Eh=null;function mte(m){NM(m,0)}function P0(m){var g=Le(m);if(j3(g))return m}function B3(m,g){if(m==="change")return g}var H3=!1;if(el){var X1;if(el){var Z1="oninput"in document;if(!Z1){var q3=document.createElement("div");q3.setAttribute("oninput","return;"),Z1=typeof q3.oninput=="function"}X1=Z1}else X1=!1;H3=X1&&(!document.documentMode||9<document.documentMode)}function G3(){kh&&(kh.detachEvent("onpropertychange",W3),Eh=kh=null)}function W3(m){if(m.propertyName==="value"&&P0(Eh)){var g=[];U3(g,Eh,m,B1(m)),k3(mte,g)}}function fte(m,g,b){m==="focusin"?(G3(),kh=g,Eh=b,kh.attachEvent("onpropertychange",W3)):m==="focusout"&&G3()}function hte(m){if(m==="selectionchange"||m==="keyup"||m==="keydown")return P0(Eh)}function gte(m,g){if(m==="click")return P0(g)}function pte(m,g){if(m==="input"||m==="change")return P0(g)}function xte(m,g){return m===g&&(m!==0||1/m===1/g)||m!==m&&g!==g}var Ar=typeof Object.is=="function"?Object.is:xte;function Lh(m,g){if(Ar(m,g))return!0;if(typeof m!="object"||m===null||typeof g!="object"||g===null)return!1;var b=Object.keys(m),C=Object.keys(g);if(b.length!==C.length)return!1;for(C=0;C<b.length;C++){var O=b[C];if(!st.call(g,O)||!Ar(m[O],g[O]))return!1}return!0}function V3(m){for(;m&&m.firstChild;)m=m.firstChild;return m}function Y3(m,g){var b=V3(m);m=0;for(var C;b;){if(b.nodeType===3){if(C=m+b.textContent.length,m<=g&&C>=g)return{node:b,offset:g-m};m=C}e:{for(;b;){if(b.nextSibling){b=b.nextSibling;break e}b=b.parentNode}b=void 0}b=V3(b)}}function Q3(m,g){return m&&g?m===g?!0:m&&m.nodeType===3?!1:g&&g.nodeType===3?Q3(m,g.parentNode):"contains"in m?m.contains(g):m.compareDocumentPosition?!!(m.compareDocumentPosition(g)&16):!1:!1}function K3(m){m=m!=null&&m.ownerDocument!=null&&m.ownerDocument.defaultView!=null?m.ownerDocument.defaultView:window;for(var g=S0(m.document);g instanceof m.HTMLIFrameElement;){try{var b=typeof g.contentWindow.location.href=="string"}catch{b=!1}if(b)m=g.contentWindow;else break;g=S0(m.document)}return g}function J1(m){var g=m&&m.nodeName&&m.nodeName.toLowerCase();return g&&(g==="input"&&(m.type==="text"||m.type==="search"||m.type==="tel"||m.type==="url"||m.type==="password")||g==="textarea"||m.contentEditable==="true")}var yte=el&&"documentMode"in document&&11>=document.documentMode,hm=null,eC=null,Ph=null,tC=!1;function X3(m,g,b){var C=b.window===b?b.document:b.nodeType===9?b:b.ownerDocument;tC||hm==null||hm!==S0(C)||(C=hm,"selectionStart"in C&&J1(C)?C={start:C.selectionStart,end:C.selectionEnd}:(C=(C.ownerDocument&&C.ownerDocument.defaultView||window).getSelection(),C={anchorNode:C.anchorNode,anchorOffset:C.anchorOffset,focusNode:C.focusNode,focusOffset:C.focusOffset}),Ph&&Lh(Ph,C)||(Ph=C,C=vy(eC,"onSelect"),0<C.length&&(g=new E0("onSelect","select",null,g,b),m.push({event:g,listeners:C}),g.target=hm)))}function Od(m,g){var b={};return b[m.toLowerCase()]=g.toLowerCase(),b["Webkit"+m]="webkit"+g,b["Moz"+m]="moz"+g,b}var gm={animationend:Od("Animation","AnimationEnd"),animationiteration:Od("Animation","AnimationIteration"),animationstart:Od("Animation","AnimationStart"),transitionrun:Od("Transition","TransitionRun"),transitionstart:Od("Transition","TransitionStart"),transitioncancel:Od("Transition","TransitionCancel"),transitionend:Od("Transition","TransitionEnd")},aC={},Z3={};el&&(Z3=document.createElement("div").style,"AnimationEvent"in window||(delete gm.animationend.animation,delete gm.animationiteration.animation,delete gm.animationstart.animation),"TransitionEvent"in window||delete gm.transitionend.transition);function Md(m){if(aC[m])return aC[m];if(!gm[m])return m;var g=gm[m],b;for(b in g)if(g.hasOwnProperty(b)&&b in Z3)return aC[m]=g[b];return m}var J3=Md("animationend"),e5=Md("animationiteration"),t5=Md("animationstart"),bte=Md("transitionrun"),vte=Md("transitionstart"),wte=Md("transitioncancel"),a5=Md("transitionend"),n5=new Map,nC="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");nC.push("scrollEnd");function Pi(m,g){n5.set(m,g),At(g,[m])}var D0=typeof reportError=="function"?reportError:function(m){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var g=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof m=="object"&&m!==null&&typeof m.message=="string"?String(m.message):String(m),error:m});if(!window.dispatchEvent(g))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",m);return}console.error(m)},Zr=[],pm=0,sC=0;function O0(){for(var m=pm,g=sC=pm=0;g<m;){var b=Zr[g];Zr[g++]=null;var C=Zr[g];Zr[g++]=null;var O=Zr[g];Zr[g++]=null;var $=Zr[g];if(Zr[g++]=null,C!==null&&O!==null){var te=C.pending;te===null?O.next=O:(O.next=te.next,te.next=O),C.pending=O}$!==0&&s5(b,O,$)}}function M0(m,g,b,C){Zr[pm++]=m,Zr[pm++]=g,Zr[pm++]=b,Zr[pm++]=C,sC|=C,m.lanes|=C,m=m.alternate,m!==null&&(m.lanes|=C)}function rC(m,g,b,C){return M0(m,g,b,C),I0(m)}function Id(m,g){return M0(m,null,null,g),I0(m)}function s5(m,g,b){m.lanes|=b;var C=m.alternate;C!==null&&(C.lanes|=b);for(var O=!1,$=m.return;$!==null;)$.childLanes|=b,C=$.alternate,C!==null&&(C.childLanes|=b),$.tag===22&&(m=$.stateNode,m===null||m._visibility&1||(O=!0)),m=$,$=$.return;return m.tag===3?($=m.stateNode,O&&g!==null&&(O=31-ot(b),m=$.hiddenUpdates,C=m[O],C===null?m[O]=[g]:C.push(g),g.lane=b|536870912),$):null}function I0(m){if(50<eg)throw eg=0,hS=null,Error(s(185));for(var g=m.return;g!==null;)m=g,g=m.return;return m.tag===3?m.stateNode:null}var xm={};function jte(m,g,b,C){this.tag=m,this.key=b,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=g,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=C,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Tr(m,g,b,C){return new jte(m,g,b,C)}function iC(m){return m=m.prototype,!(!m||!m.isReactComponent)}function tl(m,g){var b=m.alternate;return b===null?(b=Tr(m.tag,g,m.key,m.mode),b.elementType=m.elementType,b.type=m.type,b.stateNode=m.stateNode,b.alternate=m,m.alternate=b):(b.pendingProps=g,b.type=m.type,b.flags=0,b.subtreeFlags=0,b.deletions=null),b.flags=m.flags&65011712,b.childLanes=m.childLanes,b.lanes=m.lanes,b.child=m.child,b.memoizedProps=m.memoizedProps,b.memoizedState=m.memoizedState,b.updateQueue=m.updateQueue,g=m.dependencies,b.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext},b.sibling=m.sibling,b.index=m.index,b.ref=m.ref,b.refCleanup=m.refCleanup,b}function r5(m,g){m.flags&=65011714;var b=m.alternate;return b===null?(m.childLanes=0,m.lanes=g,m.child=null,m.subtreeFlags=0,m.memoizedProps=null,m.memoizedState=null,m.updateQueue=null,m.dependencies=null,m.stateNode=null):(m.childLanes=b.childLanes,m.lanes=b.lanes,m.child=b.child,m.subtreeFlags=0,m.deletions=null,m.memoizedProps=b.memoizedProps,m.memoizedState=b.memoizedState,m.updateQueue=b.updateQueue,m.type=b.type,g=b.dependencies,m.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext}),m}function $0(m,g,b,C,O,$){var te=0;if(C=m,typeof m=="function")iC(m)&&(te=1);else if(typeof m=="string")te=Aae(m,b,Ne.current)?26:m==="html"||m==="head"||m==="body"?27:5;else e:switch(m){case M:return m=Tr(31,b,g,O),m.elementType=M,m.lanes=$,m;case j:return $d(b.children,O,$,g);case y:te=8,O|=24;break;case N:return m=Tr(12,b,g,O|2),m.elementType=N,m.lanes=$,m;case k:return m=Tr(13,b,g,O),m.elementType=k,m.lanes=$,m;case T:return m=Tr(19,b,g,O),m.elementType=T,m.lanes=$,m;default:if(typeof m=="object"&&m!==null)switch(m.$$typeof){case S:te=10;break e;case w:te=9;break e;case _:te=11;break e;case A:te=14;break e;case E:te=16,C=null;break e}te=29,b=Error(s(130,m===null?"null":typeof m,"")),C=null}return g=Tr(te,b,g,O),g.elementType=m,g.type=C,g.lanes=$,g}function $d(m,g,b,C){return m=Tr(7,m,C,g),m.lanes=b,m}function oC(m,g,b){return m=Tr(6,m,null,g),m.lanes=b,m}function i5(m){var g=Tr(18,null,null,0);return g.stateNode=m,g}function lC(m,g,b){return g=Tr(4,m.children!==null?m.children:[],m.key,g),g.lanes=b,g.stateNode={containerInfo:m.containerInfo,pendingChildren:null,implementation:m.implementation},g}var o5=new WeakMap;function Jr(m,g){if(typeof m=="object"&&m!==null){var b=o5.get(m);return b!==void 0?b:(g={value:m,source:g,stack:Fe(g)},o5.set(m,g),g)}return{value:m,source:g,stack:Fe(g)}}var ym=[],bm=0,R0=null,Dh=0,ei=[],ti=0,pc=null,ro=1,io="";function al(m,g){ym[bm++]=Dh,ym[bm++]=R0,R0=m,Dh=g}function l5(m,g,b){ei[ti++]=ro,ei[ti++]=io,ei[ti++]=pc,pc=m;var C=ro;m=io;var O=32-ot(C)-1;C&=~(1<<O),b+=1;var $=32-ot(g)+O;if(30<$){var te=O-O%5;$=(C&(1<<te)-1).toString(32),C>>=te,O-=te,ro=1<<32-ot(g)+O|b<<O|C,io=$+m}else ro=1<<$|b<<O|C,io=m}function cC(m){m.return!==null&&(al(m,1),l5(m,1,0))}function dC(m){for(;m===R0;)R0=ym[--bm],ym[bm]=null,Dh=ym[--bm],ym[bm]=null;for(;m===pc;)pc=ei[--ti],ei[ti]=null,io=ei[--ti],ei[ti]=null,ro=ei[--ti],ei[ti]=null}function c5(m,g){ei[ti++]=ro,ei[ti++]=io,ei[ti++]=pc,ro=g.id,io=g.overflow,pc=m}var ws=null,tn=null,ba=!1,xc=null,ai=!1,uC=Error(s(519));function yc(m){var g=Error(s(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Oh(Jr(g,m)),uC}function d5(m){var g=m.stateNode,b=m.type,C=m.memoizedProps;switch(g[Me]=m,g[Ke]=C,b){case"dialog":ga("cancel",g),ga("close",g);break;case"iframe":case"object":case"embed":ga("load",g);break;case"video":case"audio":for(b=0;b<ag.length;b++)ga(ag[b],g);break;case"source":ga("error",g);break;case"img":case"image":case"link":ga("error",g),ga("load",g);break;case"details":ga("toggle",g);break;case"input":ga("invalid",g),N3(g,C.value,C.defaultValue,C.checked,C.defaultChecked,C.type,C.name,!0);break;case"select":ga("invalid",g);break;case"textarea":ga("invalid",g),S3(g,C.value,C.defaultValue,C.children)}b=C.children,typeof b!="string"&&typeof b!="number"&&typeof b!="bigint"||g.textContent===""+b||C.suppressHydrationWarning===!0||AM(g.textContent,b)?(C.popover!=null&&(ga("beforetoggle",g),ga("toggle",g)),C.onScroll!=null&&ga("scroll",g),C.onScrollEnd!=null&&ga("scrollend",g),C.onClick!=null&&(g.onclick=Jo),g=!0):g=!1,g||yc(m,!0)}function u5(m){for(ws=m.return;ws;)switch(ws.tag){case 5:case 31:case 13:ai=!1;return;case 27:case 3:ai=!0;return;default:ws=ws.return}}function vm(m){if(m!==ws)return!1;if(!ba)return u5(m),ba=!0,!1;var g=m.tag,b;if((b=g!==3&&g!==27)&&((b=g===5)&&(b=m.type,b=!(b!=="form"&&b!=="button")||kS(m.type,m.memoizedProps)),b=!b),b&&tn&&yc(m),u5(m),g===13){if(m=m.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(s(317));tn=IM(m)}else if(g===31){if(m=m.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(s(317));tn=IM(m)}else g===27?(g=tn,Pc(m.type)?(m=OS,OS=null,tn=m):tn=g):tn=ws?si(m.stateNode.nextSibling):null;return!0}function Rd(){tn=ws=null,ba=!1}function mC(){var m=xc;return m!==null&&(sr===null?sr=m:sr.push.apply(sr,m),xc=null),m}function Oh(m){xc===null?xc=[m]:xc.push(m)}var fC=X(null),zd=null,nl=null;function bc(m,g,b){ye(fC,g._currentValue),g._currentValue=b}function sl(m){m._currentValue=fC.current,se(fC)}function hC(m,g,b){for(;m!==null;){var C=m.alternate;if((m.childLanes&g)!==g?(m.childLanes|=g,C!==null&&(C.childLanes|=g)):C!==null&&(C.childLanes&g)!==g&&(C.childLanes|=g),m===b)break;m=m.return}}function gC(m,g,b,C){var O=m.child;for(O!==null&&(O.return=m);O!==null;){var $=O.dependencies;if($!==null){var te=O.child;$=$.firstContext;e:for(;$!==null;){var Se=$;$=O;for(var Ye=0;Ye<g.length;Ye++)if(Se.context===g[Ye]){$.lanes|=b,Se=$.alternate,Se!==null&&(Se.lanes|=b),hC($.return,b,m),C||(te=null);break e}$=Se.next}}else if(O.tag===18){if(te=O.return,te===null)throw Error(s(341));te.lanes|=b,$=te.alternate,$!==null&&($.lanes|=b),hC(te,b,m),te=null}else te=O.child;if(te!==null)te.return=O;else for(te=O;te!==null;){if(te===m){te=null;break}if(O=te.sibling,O!==null){O.return=te.return,te=O;break}te=te.return}O=te}}function wm(m,g,b,C){m=null;for(var O=g,$=!1;O!==null;){if(!$){if((O.flags&524288)!==0)$=!0;else if((O.flags&262144)!==0)break}if(O.tag===10){var te=O.alternate;if(te===null)throw Error(s(387));if(te=te.memoizedProps,te!==null){var Se=O.type;Ar(O.pendingProps.value,te.value)||(m!==null?m.push(Se):m=[Se])}}else if(O===de.current){if(te=O.alternate,te===null)throw Error(s(387));te.memoizedState.memoizedState!==O.memoizedState.memoizedState&&(m!==null?m.push(og):m=[og])}O=O.return}m!==null&&gC(g,m,b,C),g.flags|=262144}function z0(m){for(m=m.firstContext;m!==null;){if(!Ar(m.context._currentValue,m.memoizedValue))return!0;m=m.next}return!1}function Fd(m){zd=m,nl=null,m=m.dependencies,m!==null&&(m.firstContext=null)}function js(m){return m5(zd,m)}function F0(m,g){return zd===null&&Fd(m),m5(m,g)}function m5(m,g){var b=g._currentValue;if(g={context:g,memoizedValue:b,next:null},nl===null){if(m===null)throw Error(s(308));nl=g,m.dependencies={lanes:0,firstContext:g},m.flags|=524288}else nl=nl.next=g;return b}var Nte=typeof AbortController<"u"?AbortController:function(){var m=[],g=this.signal={aborted:!1,addEventListener:function(b,C){m.push(C)}};this.abort=function(){g.aborted=!0,m.forEach(function(b){return b()})}},Cte=e.unstable_scheduleCallback,Ste=e.unstable_NormalPriority,Rn={$$typeof:S,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function pC(){return{controller:new Nte,data:new Map,refCount:0}}function Mh(m){m.refCount--,m.refCount===0&&Cte(Ste,function(){m.controller.abort()})}var Ih=null,xC=0,jm=0,Nm=null;function _te(m,g){if(Ih===null){var b=Ih=[];xC=0,jm=vS(),Nm={status:"pending",value:void 0,then:function(C){b.push(C)}}}return xC++,g.then(f5,f5),g}function f5(){if(--xC===0&&Ih!==null){Nm!==null&&(Nm.status="fulfilled");var m=Ih;Ih=null,jm=0,Nm=null;for(var g=0;g<m.length;g++)(0,m[g])()}}function Ate(m,g){var b=[],C={status:"pending",value:null,reason:null,then:function(O){b.push(O)}};return m.then(function(){C.status="fulfilled",C.value=g;for(var O=0;O<b.length;O++)(0,b[O])(g)},function(O){for(C.status="rejected",C.reason=O,O=0;O<b.length;O++)(0,b[O])(void 0)}),C}var h5=q.S;q.S=function(m,g){XO=_e(),typeof g=="object"&&g!==null&&typeof g.then=="function"&&_te(m,g),h5!==null&&h5(m,g)};var Ud=X(null);function yC(){var m=Ud.current;return m!==null?m:Ga.pooledCache}function U0(m,g){g===null?ye(Ud,Ud.current):ye(Ud,g.pool)}function g5(){var m=yC();return m===null?null:{parent:Rn._currentValue,pool:m}}var Cm=Error(s(460)),bC=Error(s(474)),B0=Error(s(542)),H0={then:function(){}};function p5(m){return m=m.status,m==="fulfilled"||m==="rejected"}function x5(m,g,b){switch(b=m[b],b===void 0?m.push(g):b!==g&&(g.then(Jo,Jo),g=b),g.status){case"fulfilled":return g.value;case"rejected":throw m=g.reason,b5(m),m;default:if(typeof g.status=="string")g.then(Jo,Jo);else{if(m=Ga,m!==null&&100<m.shellSuspendCounter)throw Error(s(482));m=g,m.status="pending",m.then(function(C){if(g.status==="pending"){var O=g;O.status="fulfilled",O.value=C}},function(C){if(g.status==="pending"){var O=g;O.status="rejected",O.reason=C}})}switch(g.status){case"fulfilled":return g.value;case"rejected":throw m=g.reason,b5(m),m}throw Hd=g,Cm}}function Bd(m){try{var g=m._init;return g(m._payload)}catch(b){throw b!==null&&typeof b=="object"&&typeof b.then=="function"?(Hd=b,Cm):b}}var Hd=null;function y5(){if(Hd===null)throw Error(s(459));var m=Hd;return Hd=null,m}function b5(m){if(m===Cm||m===B0)throw Error(s(483))}var Sm=null,$h=0;function q0(m){var g=$h;return $h+=1,Sm===null&&(Sm=[]),x5(Sm,m,g)}function Rh(m,g){g=g.props.ref,m.ref=g!==void 0?g:null}function G0(m,g){throw g.$$typeof===p?Error(s(525)):(m=Object.prototype.toString.call(g),Error(s(31,m==="[object Object]"?"object with keys {"+Object.keys(g).join(", ")+"}":m)))}function v5(m){function g(rt,et){if(m){var ct=rt.deletions;ct===null?(rt.deletions=[et],rt.flags|=16):ct.push(et)}}function b(rt,et){if(!m)return null;for(;et!==null;)g(rt,et),et=et.sibling;return null}function C(rt){for(var et=new Map;rt!==null;)rt.key!==null?et.set(rt.key,rt):et.set(rt.index,rt),rt=rt.sibling;return et}function O(rt,et){return rt=tl(rt,et),rt.index=0,rt.sibling=null,rt}function $(rt,et,ct){return rt.index=ct,m?(ct=rt.alternate,ct!==null?(ct=ct.index,ct<et?(rt.flags|=67108866,et):ct):(rt.flags|=67108866,et)):(rt.flags|=1048576,et)}function te(rt){return m&&rt.alternate===null&&(rt.flags|=67108866),rt}function Se(rt,et,ct,bt){return et===null||et.tag!==6?(et=oC(ct,rt.mode,bt),et.return=rt,et):(et=O(et,ct),et.return=rt,et)}function Ye(rt,et,ct,bt){var Xt=ct.type;return Xt===j?xt(rt,et,ct.props.children,bt,ct.key):et!==null&&(et.elementType===Xt||typeof Xt=="object"&&Xt!==null&&Xt.$$typeof===E&&Bd(Xt)===et.type)?(et=O(et,ct.props),Rh(et,ct),et.return=rt,et):(et=$0(ct.type,ct.key,ct.props,null,rt.mode,bt),Rh(et,ct),et.return=rt,et)}function dt(rt,et,ct,bt){return et===null||et.tag!==4||et.stateNode.containerInfo!==ct.containerInfo||et.stateNode.implementation!==ct.implementation?(et=lC(ct,rt.mode,bt),et.return=rt,et):(et=O(et,ct.children||[]),et.return=rt,et)}function xt(rt,et,ct,bt,Xt){return et===null||et.tag!==7?(et=$d(ct,rt.mode,bt,Xt),et.return=rt,et):(et=O(et,ct),et.return=rt,et)}function jt(rt,et,ct){if(typeof et=="string"&&et!==""||typeof et=="number"||typeof et=="bigint")return et=oC(""+et,rt.mode,ct),et.return=rt,et;if(typeof et=="object"&&et!==null){switch(et.$$typeof){case x:return ct=$0(et.type,et.key,et.props,null,rt.mode,ct),Rh(ct,et),ct.return=rt,ct;case v:return et=lC(et,rt.mode,ct),et.return=rt,et;case E:return et=Bd(et),jt(rt,et,ct)}if(R(et)||D(et))return et=$d(et,rt.mode,ct,null),et.return=rt,et;if(typeof et.then=="function")return jt(rt,q0(et),ct);if(et.$$typeof===S)return jt(rt,F0(rt,et),ct);G0(rt,et)}return null}function mt(rt,et,ct,bt){var Xt=et!==null?et.key:null;if(typeof ct=="string"&&ct!==""||typeof ct=="number"||typeof ct=="bigint")return Xt!==null?null:Se(rt,et,""+ct,bt);if(typeof ct=="object"&&ct!==null){switch(ct.$$typeof){case x:return ct.key===Xt?Ye(rt,et,ct,bt):null;case v:return ct.key===Xt?dt(rt,et,ct,bt):null;case E:return ct=Bd(ct),mt(rt,et,ct,bt)}if(R(ct)||D(ct))return Xt!==null?null:xt(rt,et,ct,bt,null);if(typeof ct.then=="function")return mt(rt,et,q0(ct),bt);if(ct.$$typeof===S)return mt(rt,et,F0(rt,ct),bt);G0(rt,ct)}return null}function pt(rt,et,ct,bt,Xt){if(typeof bt=="string"&&bt!==""||typeof bt=="number"||typeof bt=="bigint")return rt=rt.get(ct)||null,Se(et,rt,""+bt,Xt);if(typeof bt=="object"&&bt!==null){switch(bt.$$typeof){case x:return rt=rt.get(bt.key===null?ct:bt.key)||null,Ye(et,rt,bt,Xt);case v:return rt=rt.get(bt.key===null?ct:bt.key)||null,dt(et,rt,bt,Xt);case E:return bt=Bd(bt),pt(rt,et,ct,bt,Xt)}if(R(bt)||D(bt))return rt=rt.get(ct)||null,xt(et,rt,bt,Xt,null);if(typeof bt.then=="function")return pt(rt,et,ct,q0(bt),Xt);if(bt.$$typeof===S)return pt(rt,et,ct,F0(et,bt),Xt);G0(et,bt)}return null}function zt(rt,et,ct,bt){for(var Xt=null,Sa=null,qt=et,ua=et=0,xa=null;qt!==null&&ua<ct.length;ua++){qt.index>ua?(xa=qt,qt=null):xa=qt.sibling;var _a=mt(rt,qt,ct[ua],bt);if(_a===null){qt===null&&(qt=xa);break}m&&qt&&_a.alternate===null&&g(rt,qt),et=$(_a,et,ua),Sa===null?Xt=_a:Sa.sibling=_a,Sa=_a,qt=xa}if(ua===ct.length)return b(rt,qt),ba&&al(rt,ua),Xt;if(qt===null){for(;ua<ct.length;ua++)qt=jt(rt,ct[ua],bt),qt!==null&&(et=$(qt,et,ua),Sa===null?Xt=qt:Sa.sibling=qt,Sa=qt);return ba&&al(rt,ua),Xt}for(qt=C(qt);ua<ct.length;ua++)xa=pt(qt,rt,ua,ct[ua],bt),xa!==null&&(m&&xa.alternate!==null&&qt.delete(xa.key===null?ua:xa.key),et=$(xa,et,ua),Sa===null?Xt=xa:Sa.sibling=xa,Sa=xa);return m&&qt.forEach(function($c){return g(rt,$c)}),ba&&al(rt,ua),Xt}function Jt(rt,et,ct,bt){if(ct==null)throw Error(s(151));for(var Xt=null,Sa=null,qt=et,ua=et=0,xa=null,_a=ct.next();qt!==null&&!_a.done;ua++,_a=ct.next()){qt.index>ua?(xa=qt,qt=null):xa=qt.sibling;var $c=mt(rt,qt,_a.value,bt);if($c===null){qt===null&&(qt=xa);break}m&&qt&&$c.alternate===null&&g(rt,qt),et=$($c,et,ua),Sa===null?Xt=$c:Sa.sibling=$c,Sa=$c,qt=xa}if(_a.done)return b(rt,qt),ba&&al(rt,ua),Xt;if(qt===null){for(;!_a.done;ua++,_a=ct.next())_a=jt(rt,_a.value,bt),_a!==null&&(et=$(_a,et,ua),Sa===null?Xt=_a:Sa.sibling=_a,Sa=_a);return ba&&al(rt,ua),Xt}for(qt=C(qt);!_a.done;ua++,_a=ct.next())_a=pt(qt,rt,ua,_a.value,bt),_a!==null&&(m&&_a.alternate!==null&&qt.delete(_a.key===null?ua:_a.key),et=$(_a,et,ua),Sa===null?Xt=_a:Sa.sibling=_a,Sa=_a);return m&&qt.forEach(function(Rae){return g(rt,Rae)}),ba&&al(rt,ua),Xt}function Ba(rt,et,ct,bt){if(typeof ct=="object"&&ct!==null&&ct.type===j&&ct.key===null&&(ct=ct.props.children),typeof ct=="object"&&ct!==null){switch(ct.$$typeof){case x:e:{for(var Xt=ct.key;et!==null;){if(et.key===Xt){if(Xt=ct.type,Xt===j){if(et.tag===7){b(rt,et.sibling),bt=O(et,ct.props.children),bt.return=rt,rt=bt;break e}}else if(et.elementType===Xt||typeof Xt=="object"&&Xt!==null&&Xt.$$typeof===E&&Bd(Xt)===et.type){b(rt,et.sibling),bt=O(et,ct.props),Rh(bt,ct),bt.return=rt,rt=bt;break e}b(rt,et);break}else g(rt,et);et=et.sibling}ct.type===j?(bt=$d(ct.props.children,rt.mode,bt,ct.key),bt.return=rt,rt=bt):(bt=$0(ct.type,ct.key,ct.props,null,rt.mode,bt),Rh(bt,ct),bt.return=rt,rt=bt)}return te(rt);case v:e:{for(Xt=ct.key;et!==null;){if(et.key===Xt)if(et.tag===4&&et.stateNode.containerInfo===ct.containerInfo&&et.stateNode.implementation===ct.implementation){b(rt,et.sibling),bt=O(et,ct.children||[]),bt.return=rt,rt=bt;break e}else{b(rt,et);break}else g(rt,et);et=et.sibling}bt=lC(ct,rt.mode,bt),bt.return=rt,rt=bt}return te(rt);case E:return ct=Bd(ct),Ba(rt,et,ct,bt)}if(R(ct))return zt(rt,et,ct,bt);if(D(ct)){if(Xt=D(ct),typeof Xt!="function")throw Error(s(150));return ct=Xt.call(ct),Jt(rt,et,ct,bt)}if(typeof ct.then=="function")return Ba(rt,et,q0(ct),bt);if(ct.$$typeof===S)return Ba(rt,et,F0(rt,ct),bt);G0(rt,ct)}return typeof ct=="string"&&ct!==""||typeof ct=="number"||typeof ct=="bigint"?(ct=""+ct,et!==null&&et.tag===6?(b(rt,et.sibling),bt=O(et,ct),bt.return=rt,rt=bt):(b(rt,et),bt=oC(ct,rt.mode,bt),bt.return=rt,rt=bt),te(rt)):b(rt,et)}return function(rt,et,ct,bt){try{$h=0;var Xt=Ba(rt,et,ct,bt);return Sm=null,Xt}catch(qt){if(qt===Cm||qt===B0)throw qt;var Sa=Tr(29,qt,null,rt.mode);return Sa.lanes=bt,Sa.return=rt,Sa}}}var qd=v5(!0),w5=v5(!1),vc=!1;function vC(m){m.updateQueue={baseState:m.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function wC(m,g){m=m.updateQueue,g.updateQueue===m&&(g.updateQueue={baseState:m.baseState,firstBaseUpdate:m.firstBaseUpdate,lastBaseUpdate:m.lastBaseUpdate,shared:m.shared,callbacks:null})}function wc(m){return{lane:m,tag:0,payload:null,callback:null,next:null}}function jc(m,g,b){var C=m.updateQueue;if(C===null)return null;if(C=C.shared,(Ta&2)!==0){var O=C.pending;return O===null?g.next=g:(g.next=O.next,O.next=g),C.pending=g,g=I0(m),s5(m,null,b),g}return M0(m,C,g,b),I0(m)}function zh(m,g,b){if(g=g.updateQueue,g!==null&&(g=g.shared,(b&4194048)!==0)){var C=g.lanes;C&=m.pendingLanes,b|=C,g.lanes=b,F(m,b)}}function jC(m,g){var b=m.updateQueue,C=m.alternate;if(C!==null&&(C=C.updateQueue,b===C)){var O=null,$=null;if(b=b.firstBaseUpdate,b!==null){do{var te={lane:b.lane,tag:b.tag,payload:b.payload,callback:null,next:null};$===null?O=$=te:$=$.next=te,b=b.next}while(b!==null);$===null?O=$=g:$=$.next=g}else O=$=g;b={baseState:C.baseState,firstBaseUpdate:O,lastBaseUpdate:$,shared:C.shared,callbacks:C.callbacks},m.updateQueue=b;return}m=b.lastBaseUpdate,m===null?b.firstBaseUpdate=g:m.next=g,b.lastBaseUpdate=g}var NC=!1;function Fh(){if(NC){var m=Nm;if(m!==null)throw m}}function Uh(m,g,b,C){NC=!1;var O=m.updateQueue;vc=!1;var $=O.firstBaseUpdate,te=O.lastBaseUpdate,Se=O.shared.pending;if(Se!==null){O.shared.pending=null;var Ye=Se,dt=Ye.next;Ye.next=null,te===null?$=dt:te.next=dt,te=Ye;var xt=m.alternate;xt!==null&&(xt=xt.updateQueue,Se=xt.lastBaseUpdate,Se!==te&&(Se===null?xt.firstBaseUpdate=dt:Se.next=dt,xt.lastBaseUpdate=Ye))}if($!==null){var jt=O.baseState;te=0,xt=dt=Ye=null,Se=$;do{var mt=Se.lane&-536870913,pt=mt!==Se.lane;if(pt?(pa&mt)===mt:(C&mt)===mt){mt!==0&&mt===jm&&(NC=!0),xt!==null&&(xt=xt.next={lane:0,tag:Se.tag,payload:Se.payload,callback:null,next:null});e:{var zt=m,Jt=Se;mt=g;var Ba=b;switch(Jt.tag){case 1:if(zt=Jt.payload,typeof zt=="function"){jt=zt.call(Ba,jt,mt);break e}jt=zt;break e;case 3:zt.flags=zt.flags&-65537|128;case 0:if(zt=Jt.payload,mt=typeof zt=="function"?zt.call(Ba,jt,mt):zt,mt==null)break e;jt=h({},jt,mt);break e;case 2:vc=!0}}mt=Se.callback,mt!==null&&(m.flags|=64,pt&&(m.flags|=8192),pt=O.callbacks,pt===null?O.callbacks=[mt]:pt.push(mt))}else pt={lane:mt,tag:Se.tag,payload:Se.payload,callback:Se.callback,next:null},xt===null?(dt=xt=pt,Ye=jt):xt=xt.next=pt,te|=mt;if(Se=Se.next,Se===null){if(Se=O.shared.pending,Se===null)break;pt=Se,Se=pt.next,pt.next=null,O.lastBaseUpdate=pt,O.shared.pending=null}}while(!0);xt===null&&(Ye=jt),O.baseState=Ye,O.firstBaseUpdate=dt,O.lastBaseUpdate=xt,$===null&&(O.shared.lanes=0),Ac|=te,m.lanes=te,m.memoizedState=jt}}function j5(m,g){if(typeof m!="function")throw Error(s(191,m));m.call(g)}function N5(m,g){var b=m.callbacks;if(b!==null)for(m.callbacks=null,m=0;m<b.length;m++)j5(b[m],g)}var _m=X(null),W0=X(0);function C5(m,g){m=fl,ye(W0,m),ye(_m,g),fl=m|g.baseLanes}function CC(){ye(W0,fl),ye(_m,_m.current)}function SC(){fl=W0.current,se(_m),se(W0)}var kr=X(null),ni=null;function Nc(m){var g=m.alternate;ye(Ln,Ln.current&1),ye(kr,m),ni===null&&(g===null||_m.current!==null||g.memoizedState!==null)&&(ni=m)}function _C(m){ye(Ln,Ln.current),ye(kr,m),ni===null&&(ni=m)}function S5(m){m.tag===22?(ye(Ln,Ln.current),ye(kr,m),ni===null&&(ni=m)):Cc()}function Cc(){ye(Ln,Ln.current),ye(kr,kr.current)}function Er(m){se(kr),ni===m&&(ni=null),se(Ln)}var Ln=X(0);function V0(m){for(var g=m;g!==null;){if(g.tag===13){var b=g.memoizedState;if(b!==null&&(b=b.dehydrated,b===null||PS(b)||DS(b)))return g}else if(g.tag===19&&(g.memoizedProps.revealOrder==="forwards"||g.memoizedProps.revealOrder==="backwards"||g.memoizedProps.revealOrder==="unstable_legacy-backwards"||g.memoizedProps.revealOrder==="together")){if((g.flags&128)!==0)return g}else if(g.child!==null){g.child.return=g,g=g.child;continue}if(g===m)break;for(;g.sibling===null;){if(g.return===null||g.return===m)return null;g=g.return}g.sibling.return=g.return,g=g.sibling}return null}var rl=0,oa=null,Fa=null,zn=null,Y0=!1,Am=!1,Gd=!1,Q0=0,Bh=0,Tm=null,Tte=0;function vn(){throw Error(s(321))}function AC(m,g){if(g===null)return!1;for(var b=0;b<g.length&&b<m.length;b++)if(!Ar(m[b],g[b]))return!1;return!0}function TC(m,g,b,C,O,$){return rl=$,oa=g,g.memoizedState=null,g.updateQueue=null,g.lanes=0,q.H=m===null||m.memoizedState===null?lO:HC,Gd=!1,$=b(C,O),Gd=!1,Am&&($=A5(g,b,C,O)),_5(m),$}function _5(m){q.H=Gh;var g=Fa!==null&&Fa.next!==null;if(rl=0,zn=Fa=oa=null,Y0=!1,Bh=0,Tm=null,g)throw Error(s(300));m===null||Fn||(m=m.dependencies,m!==null&&z0(m)&&(Fn=!0))}function A5(m,g,b,C){oa=m;var O=0;do{if(Am&&(Tm=null),Bh=0,Am=!1,25<=O)throw Error(s(301));if(O+=1,zn=Fa=null,m.updateQueue!=null){var $=m.updateQueue;$.lastEffect=null,$.events=null,$.stores=null,$.memoCache!=null&&($.memoCache.index=0)}q.H=cO,$=g(b,C)}while(Am);return $}function kte(){var m=q.H,g=m.useState()[0];return g=typeof g.then=="function"?Hh(g):g,m=m.useState()[0],(Fa!==null?Fa.memoizedState:null)!==m&&(oa.flags|=1024),g}function kC(){var m=Q0!==0;return Q0=0,m}function EC(m,g,b){g.updateQueue=m.updateQueue,g.flags&=-2053,m.lanes&=~b}function LC(m){if(Y0){for(m=m.memoizedState;m!==null;){var g=m.queue;g!==null&&(g.pending=null),m=m.next}Y0=!1}rl=0,zn=Fa=oa=null,Am=!1,Bh=Q0=0,Tm=null}function qs(){var m={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return zn===null?oa.memoizedState=zn=m:zn=zn.next=m,zn}function Pn(){if(Fa===null){var m=oa.alternate;m=m!==null?m.memoizedState:null}else m=Fa.next;var g=zn===null?oa.memoizedState:zn.next;if(g!==null)zn=g,Fa=m;else{if(m===null)throw oa.alternate===null?Error(s(467)):Error(s(310));Fa=m,m={memoizedState:Fa.memoizedState,baseState:Fa.baseState,baseQueue:Fa.baseQueue,queue:Fa.queue,next:null},zn===null?oa.memoizedState=zn=m:zn=zn.next=m}return zn}function K0(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Hh(m){var g=Bh;return Bh+=1,Tm===null&&(Tm=[]),m=x5(Tm,m,g),g=oa,(zn===null?g.memoizedState:zn.next)===null&&(g=g.alternate,q.H=g===null||g.memoizedState===null?lO:HC),m}function X0(m){if(m!==null&&typeof m=="object"){if(typeof m.then=="function")return Hh(m);if(m.$$typeof===S)return js(m)}throw Error(s(438,String(m)))}function PC(m){var g=null,b=oa.updateQueue;if(b!==null&&(g=b.memoCache),g==null){var C=oa.alternate;C!==null&&(C=C.updateQueue,C!==null&&(C=C.memoCache,C!=null&&(g={data:C.data.map(function(O){return O.slice()}),index:0})))}if(g==null&&(g={data:[],index:0}),b===null&&(b=K0(),oa.updateQueue=b),b.memoCache=g,b=g.data[g.index],b===void 0)for(b=g.data[g.index]=Array(m),C=0;C<m;C++)b[C]=z;return g.index++,b}function il(m,g){return typeof g=="function"?g(m):g}function Z0(m){var g=Pn();return DC(g,Fa,m)}function DC(m,g,b){var C=m.queue;if(C===null)throw Error(s(311));C.lastRenderedReducer=b;var O=m.baseQueue,$=C.pending;if($!==null){if(O!==null){var te=O.next;O.next=$.next,$.next=te}g.baseQueue=O=$,C.pending=null}if($=m.baseState,O===null)m.memoizedState=$;else{g=O.next;var Se=te=null,Ye=null,dt=g,xt=!1;do{var jt=dt.lane&-536870913;if(jt!==dt.lane?(pa&jt)===jt:(rl&jt)===jt){var mt=dt.revertLane;if(mt===0)Ye!==null&&(Ye=Ye.next={lane:0,revertLane:0,gesture:null,action:dt.action,hasEagerState:dt.hasEagerState,eagerState:dt.eagerState,next:null}),jt===jm&&(xt=!0);else if((rl&mt)===mt){dt=dt.next,mt===jm&&(xt=!0);continue}else jt={lane:0,revertLane:dt.revertLane,gesture:null,action:dt.action,hasEagerState:dt.hasEagerState,eagerState:dt.eagerState,next:null},Ye===null?(Se=Ye=jt,te=$):Ye=Ye.next=jt,oa.lanes|=mt,Ac|=mt;jt=dt.action,Gd&&b($,jt),$=dt.hasEagerState?dt.eagerState:b($,jt)}else mt={lane:jt,revertLane:dt.revertLane,gesture:dt.gesture,action:dt.action,hasEagerState:dt.hasEagerState,eagerState:dt.eagerState,next:null},Ye===null?(Se=Ye=mt,te=$):Ye=Ye.next=mt,oa.lanes|=jt,Ac|=jt;dt=dt.next}while(dt!==null&&dt!==g);if(Ye===null?te=$:Ye.next=Se,!Ar($,m.memoizedState)&&(Fn=!0,xt&&(b=Nm,b!==null)))throw b;m.memoizedState=$,m.baseState=te,m.baseQueue=Ye,C.lastRenderedState=$}return O===null&&(C.lanes=0),[m.memoizedState,C.dispatch]}function OC(m){var g=Pn(),b=g.queue;if(b===null)throw Error(s(311));b.lastRenderedReducer=m;var C=b.dispatch,O=b.pending,$=g.memoizedState;if(O!==null){b.pending=null;var te=O=O.next;do $=m($,te.action),te=te.next;while(te!==O);Ar($,g.memoizedState)||(Fn=!0),g.memoizedState=$,g.baseQueue===null&&(g.baseState=$),b.lastRenderedState=$}return[$,C]}function T5(m,g,b){var C=oa,O=Pn(),$=ba;if($){if(b===void 0)throw Error(s(407));b=b()}else b=g();var te=!Ar((Fa||O).memoizedState,b);if(te&&(O.memoizedState=b,Fn=!0),O=O.queue,$C(L5.bind(null,C,O,m),[m]),O.getSnapshot!==g||te||zn!==null&&zn.memoizedState.tag&1){if(C.flags|=2048,km(9,{destroy:void 0},E5.bind(null,C,O,b,g),null),Ga===null)throw Error(s(349));$||(rl&127)!==0||k5(C,g,b)}return b}function k5(m,g,b){m.flags|=16384,m={getSnapshot:g,value:b},g=oa.updateQueue,g===null?(g=K0(),oa.updateQueue=g,g.stores=[m]):(b=g.stores,b===null?g.stores=[m]:b.push(m))}function E5(m,g,b,C){g.value=b,g.getSnapshot=C,P5(g)&&D5(m)}function L5(m,g,b){return b(function(){P5(g)&&D5(m)})}function P5(m){var g=m.getSnapshot;m=m.value;try{var b=g();return!Ar(m,b)}catch{return!0}}function D5(m){var g=Id(m,2);g!==null&&rr(g,m,2)}function MC(m){var g=qs();if(typeof m=="function"){var b=m;if(m=b(),Gd){nt(!0);try{b()}finally{nt(!1)}}}return g.memoizedState=g.baseState=m,g.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:il,lastRenderedState:m},g}function O5(m,g,b,C){return m.baseState=b,DC(m,Fa,typeof C=="function"?C:il)}function Ete(m,g,b,C,O){if(ty(m))throw Error(s(485));if(m=g.action,m!==null){var $={payload:O,action:m,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(te){$.listeners.push(te)}};q.T!==null?b(!0):$.isTransition=!1,C($),b=g.pending,b===null?($.next=g.pending=$,M5(g,$)):($.next=b.next,g.pending=b.next=$)}}function M5(m,g){var b=g.action,C=g.payload,O=m.state;if(g.isTransition){var $=q.T,te={};q.T=te;try{var Se=b(O,C),Ye=q.S;Ye!==null&&Ye(te,Se),I5(m,g,Se)}catch(dt){IC(m,g,dt)}finally{$!==null&&te.types!==null&&($.types=te.types),q.T=$}}else try{$=b(O,C),I5(m,g,$)}catch(dt){IC(m,g,dt)}}function I5(m,g,b){b!==null&&typeof b=="object"&&typeof b.then=="function"?b.then(function(C){$5(m,g,C)},function(C){return IC(m,g,C)}):$5(m,g,b)}function $5(m,g,b){g.status="fulfilled",g.value=b,R5(g),m.state=b,g=m.pending,g!==null&&(b=g.next,b===g?m.pending=null:(b=b.next,g.next=b,M5(m,b)))}function IC(m,g,b){var C=m.pending;if(m.pending=null,C!==null){C=C.next;do g.status="rejected",g.reason=b,R5(g),g=g.next;while(g!==C)}m.action=null}function R5(m){m=m.listeners;for(var g=0;g<m.length;g++)(0,m[g])()}function z5(m,g){return g}function F5(m,g){if(ba){var b=Ga.formState;if(b!==null){e:{var C=oa;if(ba){if(tn){t:{for(var O=tn,$=ai;O.nodeType!==8;){if(!$){O=null;break t}if(O=si(O.nextSibling),O===null){O=null;break t}}$=O.data,O=$==="F!"||$==="F"?O:null}if(O){tn=si(O.nextSibling),C=O.data==="F!";break e}}yc(C)}C=!1}C&&(g=b[0])}}return b=qs(),b.memoizedState=b.baseState=g,C={pending:null,lanes:0,dispatch:null,lastRenderedReducer:z5,lastRenderedState:g},b.queue=C,b=rO.bind(null,oa,C),C.dispatch=b,C=MC(!1),$=BC.bind(null,oa,!1,C.queue),C=qs(),O={state:g,dispatch:null,action:m,pending:null},C.queue=O,b=Ete.bind(null,oa,O,$,b),O.dispatch=b,C.memoizedState=m,[g,b,!1]}function U5(m){var g=Pn();return B5(g,Fa,m)}function B5(m,g,b){if(g=DC(m,g,z5)[0],m=Z0(il)[0],typeof g=="object"&&g!==null&&typeof g.then=="function")try{var C=Hh(g)}catch(te){throw te===Cm?B0:te}else C=g;g=Pn();var O=g.queue,$=O.dispatch;return b!==g.memoizedState&&(oa.flags|=2048,km(9,{destroy:void 0},Lte.bind(null,O,b),null)),[C,$,m]}function Lte(m,g){m.action=g}function H5(m){var g=Pn(),b=Fa;if(b!==null)return B5(g,b,m);Pn(),g=g.memoizedState,b=Pn();var C=b.queue.dispatch;return b.memoizedState=m,[g,C,!1]}function km(m,g,b,C){return m={tag:m,create:b,deps:C,inst:g,next:null},g=oa.updateQueue,g===null&&(g=K0(),oa.updateQueue=g),b=g.lastEffect,b===null?g.lastEffect=m.next=m:(C=b.next,b.next=m,m.next=C,g.lastEffect=m),m}function q5(){return Pn().memoizedState}function J0(m,g,b,C){var O=qs();oa.flags|=m,O.memoizedState=km(1|g,{destroy:void 0},b,C===void 0?null:C)}function ey(m,g,b,C){var O=Pn();C=C===void 0?null:C;var $=O.memoizedState.inst;Fa!==null&&C!==null&&AC(C,Fa.memoizedState.deps)?O.memoizedState=km(g,$,b,C):(oa.flags|=m,O.memoizedState=km(1|g,$,b,C))}function G5(m,g){J0(8390656,8,m,g)}function $C(m,g){ey(2048,8,m,g)}function Pte(m){oa.flags|=4;var g=oa.updateQueue;if(g===null)g=K0(),oa.updateQueue=g,g.events=[m];else{var b=g.events;b===null?g.events=[m]:b.push(m)}}function W5(m){var g=Pn().memoizedState;return Pte({ref:g,nextImpl:m}),function(){if((Ta&2)!==0)throw Error(s(440));return g.impl.apply(void 0,arguments)}}function V5(m,g){return ey(4,2,m,g)}function Y5(m,g){return ey(4,4,m,g)}function Q5(m,g){if(typeof g=="function"){m=m();var b=g(m);return function(){typeof b=="function"?b():g(null)}}if(g!=null)return m=m(),g.current=m,function(){g.current=null}}function K5(m,g,b){b=b!=null?b.concat([m]):null,ey(4,4,Q5.bind(null,g,m),b)}function RC(){}function X5(m,g){var b=Pn();g=g===void 0?null:g;var C=b.memoizedState;return g!==null&&AC(g,C[1])?C[0]:(b.memoizedState=[m,g],m)}function Z5(m,g){var b=Pn();g=g===void 0?null:g;var C=b.memoizedState;if(g!==null&&AC(g,C[1]))return C[0];if(C=m(),Gd){nt(!0);try{m()}finally{nt(!1)}}return b.memoizedState=[C,g],C}function zC(m,g,b){return b===void 0||(rl&1073741824)!==0&&(pa&261930)===0?m.memoizedState=g:(m.memoizedState=b,m=JO(),oa.lanes|=m,Ac|=m,b)}function J5(m,g,b,C){return Ar(b,g)?b:_m.current!==null?(m=zC(m,b,C),Ar(m,g)||(Fn=!0),m):(rl&42)===0||(rl&1073741824)!==0&&(pa&261930)===0?(Fn=!0,m.memoizedState=b):(m=JO(),oa.lanes|=m,Ac|=m,g)}function eO(m,g,b,C,O){var $=Z.p;Z.p=$!==0&&8>$?$:8;var te=q.T,Se={};q.T=Se,BC(m,!1,g,b);try{var Ye=O(),dt=q.S;if(dt!==null&&dt(Se,Ye),Ye!==null&&typeof Ye=="object"&&typeof Ye.then=="function"){var xt=Ate(Ye,C);qh(m,g,xt,Dr(m))}else qh(m,g,C,Dr(m))}catch(jt){qh(m,g,{then:function(){},status:"rejected",reason:jt},Dr())}finally{Z.p=$,te!==null&&Se.types!==null&&(te.types=Se.types),q.T=te}}function Dte(){}function FC(m,g,b,C){if(m.tag!==5)throw Error(s(476));var O=tO(m).queue;eO(m,O,g,V,b===null?Dte:function(){return aO(m),b(C)})}function tO(m){var g=m.memoizedState;if(g!==null)return g;g={memoizedState:V,baseState:V,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:il,lastRenderedState:V},next:null};var b={};return g.next={memoizedState:b,baseState:b,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:il,lastRenderedState:b},next:null},m.memoizedState=g,m=m.alternate,m!==null&&(m.memoizedState=g),g}function aO(m){var g=tO(m);g.next===null&&(g=m.alternate.memoizedState),qh(m,g.next.queue,{},Dr())}function UC(){return js(og)}function nO(){return Pn().memoizedState}function sO(){return Pn().memoizedState}function Ote(m){for(var g=m.return;g!==null;){switch(g.tag){case 24:case 3:var b=Dr();m=wc(b);var C=jc(g,m,b);C!==null&&(rr(C,g,b),zh(C,g,b)),g={cache:pC()},m.payload=g;return}g=g.return}}function Mte(m,g,b){var C=Dr();b={lane:C,revertLane:0,gesture:null,action:b,hasEagerState:!1,eagerState:null,next:null},ty(m)?iO(g,b):(b=rC(m,g,b,C),b!==null&&(rr(b,m,C),oO(b,g,C)))}function rO(m,g,b){var C=Dr();qh(m,g,b,C)}function qh(m,g,b,C){var O={lane:C,revertLane:0,gesture:null,action:b,hasEagerState:!1,eagerState:null,next:null};if(ty(m))iO(g,O);else{var $=m.alternate;if(m.lanes===0&&($===null||$.lanes===0)&&($=g.lastRenderedReducer,$!==null))try{var te=g.lastRenderedState,Se=$(te,b);if(O.hasEagerState=!0,O.eagerState=Se,Ar(Se,te))return M0(m,g,O,0),Ga===null&&O0(),!1}catch{}if(b=rC(m,g,O,C),b!==null)return rr(b,m,C),oO(b,g,C),!0}return!1}function BC(m,g,b,C){if(C={lane:2,revertLane:vS(),gesture:null,action:C,hasEagerState:!1,eagerState:null,next:null},ty(m)){if(g)throw Error(s(479))}else g=rC(m,b,C,2),g!==null&&rr(g,m,2)}function ty(m){var g=m.alternate;return m===oa||g!==null&&g===oa}function iO(m,g){Am=Y0=!0;var b=m.pending;b===null?g.next=g:(g.next=b.next,b.next=g),m.pending=g}function oO(m,g,b){if((b&4194048)!==0){var C=g.lanes;C&=m.pendingLanes,b|=C,g.lanes=b,F(m,b)}}var Gh={readContext:js,use:X0,useCallback:vn,useContext:vn,useEffect:vn,useImperativeHandle:vn,useLayoutEffect:vn,useInsertionEffect:vn,useMemo:vn,useReducer:vn,useRef:vn,useState:vn,useDebugValue:vn,useDeferredValue:vn,useTransition:vn,useSyncExternalStore:vn,useId:vn,useHostTransitionStatus:vn,useFormState:vn,useActionState:vn,useOptimistic:vn,useMemoCache:vn,useCacheRefresh:vn};Gh.useEffectEvent=vn;var lO={readContext:js,use:X0,useCallback:function(m,g){return qs().memoizedState=[m,g===void 0?null:g],m},useContext:js,useEffect:G5,useImperativeHandle:function(m,g,b){b=b!=null?b.concat([m]):null,J0(4194308,4,Q5.bind(null,g,m),b)},useLayoutEffect:function(m,g){return J0(4194308,4,m,g)},useInsertionEffect:function(m,g){J0(4,2,m,g)},useMemo:function(m,g){var b=qs();g=g===void 0?null:g;var C=m();if(Gd){nt(!0);try{m()}finally{nt(!1)}}return b.memoizedState=[C,g],C},useReducer:function(m,g,b){var C=qs();if(b!==void 0){var O=b(g);if(Gd){nt(!0);try{b(g)}finally{nt(!1)}}}else O=g;return C.memoizedState=C.baseState=O,m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:m,lastRenderedState:O},C.queue=m,m=m.dispatch=Mte.bind(null,oa,m),[C.memoizedState,m]},useRef:function(m){var g=qs();return m={current:m},g.memoizedState=m},useState:function(m){m=MC(m);var g=m.queue,b=rO.bind(null,oa,g);return g.dispatch=b,[m.memoizedState,b]},useDebugValue:RC,useDeferredValue:function(m,g){var b=qs();return zC(b,m,g)},useTransition:function(){var m=MC(!1);return m=eO.bind(null,oa,m.queue,!0,!1),qs().memoizedState=m,[!1,m]},useSyncExternalStore:function(m,g,b){var C=oa,O=qs();if(ba){if(b===void 0)throw Error(s(407));b=b()}else{if(b=g(),Ga===null)throw Error(s(349));(pa&127)!==0||k5(C,g,b)}O.memoizedState=b;var $={value:b,getSnapshot:g};return O.queue=$,G5(L5.bind(null,C,$,m),[m]),C.flags|=2048,km(9,{destroy:void 0},E5.bind(null,C,$,b,g),null),b},useId:function(){var m=qs(),g=Ga.identifierPrefix;if(ba){var b=io,C=ro;b=(C&~(1<<32-ot(C)-1)).toString(32)+b,g="_"+g+"R_"+b,b=Q0++,0<b&&(g+="H"+b.toString(32)),g+="_"}else b=Tte++,g="_"+g+"r_"+b.toString(32)+"_";return m.memoizedState=g},useHostTransitionStatus:UC,useFormState:F5,useActionState:F5,useOptimistic:function(m){var g=qs();g.memoizedState=g.baseState=m;var b={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return g.queue=b,g=BC.bind(null,oa,!0,b),b.dispatch=g,[m,g]},useMemoCache:PC,useCacheRefresh:function(){return qs().memoizedState=Ote.bind(null,oa)},useEffectEvent:function(m){var g=qs(),b={impl:m};return g.memoizedState=b,function(){if((Ta&2)!==0)throw Error(s(440));return b.impl.apply(void 0,arguments)}}},HC={readContext:js,use:X0,useCallback:X5,useContext:js,useEffect:$C,useImperativeHandle:K5,useInsertionEffect:V5,useLayoutEffect:Y5,useMemo:Z5,useReducer:Z0,useRef:q5,useState:function(){return Z0(il)},useDebugValue:RC,useDeferredValue:function(m,g){var b=Pn();return J5(b,Fa.memoizedState,m,g)},useTransition:function(){var m=Z0(il)[0],g=Pn().memoizedState;return[typeof m=="boolean"?m:Hh(m),g]},useSyncExternalStore:T5,useId:nO,useHostTransitionStatus:UC,useFormState:U5,useActionState:U5,useOptimistic:function(m,g){var b=Pn();return O5(b,Fa,m,g)},useMemoCache:PC,useCacheRefresh:sO};HC.useEffectEvent=W5;var cO={readContext:js,use:X0,useCallback:X5,useContext:js,useEffect:$C,useImperativeHandle:K5,useInsertionEffect:V5,useLayoutEffect:Y5,useMemo:Z5,useReducer:OC,useRef:q5,useState:function(){return OC(il)},useDebugValue:RC,useDeferredValue:function(m,g){var b=Pn();return Fa===null?zC(b,m,g):J5(b,Fa.memoizedState,m,g)},useTransition:function(){var m=OC(il)[0],g=Pn().memoizedState;return[typeof m=="boolean"?m:Hh(m),g]},useSyncExternalStore:T5,useId:nO,useHostTransitionStatus:UC,useFormState:H5,useActionState:H5,useOptimistic:function(m,g){var b=Pn();return Fa!==null?O5(b,Fa,m,g):(b.baseState=m,[m,b.queue.dispatch])},useMemoCache:PC,useCacheRefresh:sO};cO.useEffectEvent=W5;function qC(m,g,b,C){g=m.memoizedState,b=b(C,g),b=b==null?g:h({},g,b),m.memoizedState=b,m.lanes===0&&(m.updateQueue.baseState=b)}var GC={enqueueSetState:function(m,g,b){m=m._reactInternals;var C=Dr(),O=wc(C);O.payload=g,b!=null&&(O.callback=b),g=jc(m,O,C),g!==null&&(rr(g,m,C),zh(g,m,C))},enqueueReplaceState:function(m,g,b){m=m._reactInternals;var C=Dr(),O=wc(C);O.tag=1,O.payload=g,b!=null&&(O.callback=b),g=jc(m,O,C),g!==null&&(rr(g,m,C),zh(g,m,C))},enqueueForceUpdate:function(m,g){m=m._reactInternals;var b=Dr(),C=wc(b);C.tag=2,g!=null&&(C.callback=g),g=jc(m,C,b),g!==null&&(rr(g,m,b),zh(g,m,b))}};function dO(m,g,b,C,O,$,te){return m=m.stateNode,typeof m.shouldComponentUpdate=="function"?m.shouldComponentUpdate(C,$,te):g.prototype&&g.prototype.isPureReactComponent?!Lh(b,C)||!Lh(O,$):!0}function uO(m,g,b,C){m=g.state,typeof g.componentWillReceiveProps=="function"&&g.componentWillReceiveProps(b,C),typeof g.UNSAFE_componentWillReceiveProps=="function"&&g.UNSAFE_componentWillReceiveProps(b,C),g.state!==m&&GC.enqueueReplaceState(g,g.state,null)}function Wd(m,g){var b=g;if("ref"in g){b={};for(var C in g)C!=="ref"&&(b[C]=g[C])}if(m=m.defaultProps){b===g&&(b=h({},b));for(var O in m)b[O]===void 0&&(b[O]=m[O])}return b}function mO(m){D0(m)}function fO(m){console.error(m)}function hO(m){D0(m)}function ay(m,g){try{var b=m.onUncaughtError;b(g.value,{componentStack:g.stack})}catch(C){setTimeout(function(){throw C})}}function gO(m,g,b){try{var C=m.onCaughtError;C(b.value,{componentStack:b.stack,errorBoundary:g.tag===1?g.stateNode:null})}catch(O){setTimeout(function(){throw O})}}function WC(m,g,b){return b=wc(b),b.tag=3,b.payload={element:null},b.callback=function(){ay(m,g)},b}function pO(m){return m=wc(m),m.tag=3,m}function xO(m,g,b,C){var O=b.type.getDerivedStateFromError;if(typeof O=="function"){var $=C.value;m.payload=function(){return O($)},m.callback=function(){gO(g,b,C)}}var te=b.stateNode;te!==null&&typeof te.componentDidCatch=="function"&&(m.callback=function(){gO(g,b,C),typeof O!="function"&&(Tc===null?Tc=new Set([this]):Tc.add(this));var Se=C.stack;this.componentDidCatch(C.value,{componentStack:Se!==null?Se:""})})}function Ite(m,g,b,C,O){if(b.flags|=32768,C!==null&&typeof C=="object"&&typeof C.then=="function"){if(g=b.alternate,g!==null&&wm(g,b,O,!0),b=kr.current,b!==null){switch(b.tag){case 31:case 13:return ni===null?hy():b.alternate===null&&wn===0&&(wn=3),b.flags&=-257,b.flags|=65536,b.lanes=O,C===H0?b.flags|=16384:(g=b.updateQueue,g===null?b.updateQueue=new Set([C]):g.add(C),xS(m,C,O)),!1;case 22:return b.flags|=65536,C===H0?b.flags|=16384:(g=b.updateQueue,g===null?(g={transitions:null,markerInstances:null,retryQueue:new Set([C])},b.updateQueue=g):(b=g.retryQueue,b===null?g.retryQueue=new Set([C]):b.add(C)),xS(m,C,O)),!1}throw Error(s(435,b.tag))}return xS(m,C,O),hy(),!1}if(ba)return g=kr.current,g!==null?((g.flags&65536)===0&&(g.flags|=256),g.flags|=65536,g.lanes=O,C!==uC&&(m=Error(s(422),{cause:C}),Oh(Jr(m,b)))):(C!==uC&&(g=Error(s(423),{cause:C}),Oh(Jr(g,b))),m=m.current.alternate,m.flags|=65536,O&=-O,m.lanes|=O,C=Jr(C,b),O=WC(m.stateNode,C,O),jC(m,O),wn!==4&&(wn=2)),!1;var $=Error(s(520),{cause:C});if($=Jr($,b),Jh===null?Jh=[$]:Jh.push($),wn!==4&&(wn=2),g===null)return!0;C=Jr(C,b),b=g;do{switch(b.tag){case 3:return b.flags|=65536,m=O&-O,b.lanes|=m,m=WC(b.stateNode,C,m),jC(b,m),!1;case 1:if(g=b.type,$=b.stateNode,(b.flags&128)===0&&(typeof g.getDerivedStateFromError=="function"||$!==null&&typeof $.componentDidCatch=="function"&&(Tc===null||!Tc.has($))))return b.flags|=65536,O&=-O,b.lanes|=O,O=pO(O),xO(O,m,b,C),jC(b,O),!1}b=b.return}while(b!==null);return!1}var VC=Error(s(461)),Fn=!1;function Ns(m,g,b,C){g.child=m===null?w5(g,null,b,C):qd(g,m.child,b,C)}function yO(m,g,b,C,O){b=b.render;var $=g.ref;if("ref"in C){var te={};for(var Se in C)Se!=="ref"&&(te[Se]=C[Se])}else te=C;return Fd(g),C=TC(m,g,b,te,$,O),Se=kC(),m!==null&&!Fn?(EC(m,g,O),ol(m,g,O)):(ba&&Se&&cC(g),g.flags|=1,Ns(m,g,C,O),g.child)}function bO(m,g,b,C,O){if(m===null){var $=b.type;return typeof $=="function"&&!iC($)&&$.defaultProps===void 0&&b.compare===null?(g.tag=15,g.type=$,vO(m,g,$,C,O)):(m=$0(b.type,null,C,g,g.mode,O),m.ref=g.ref,m.return=g,g.child=m)}if($=m.child,!tS(m,O)){var te=$.memoizedProps;if(b=b.compare,b=b!==null?b:Lh,b(te,C)&&m.ref===g.ref)return ol(m,g,O)}return g.flags|=1,m=tl($,C),m.ref=g.ref,m.return=g,g.child=m}function vO(m,g,b,C,O){if(m!==null){var $=m.memoizedProps;if(Lh($,C)&&m.ref===g.ref)if(Fn=!1,g.pendingProps=C=$,tS(m,O))(m.flags&131072)!==0&&(Fn=!0);else return g.lanes=m.lanes,ol(m,g,O)}return YC(m,g,b,C,O)}function wO(m,g,b,C){var O=C.children,$=m!==null?m.memoizedState:null;if(m===null&&g.stateNode===null&&(g.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),C.mode==="hidden"){if((g.flags&128)!==0){if($=$!==null?$.baseLanes|b:b,m!==null){for(C=g.child=m.child,O=0;C!==null;)O=O|C.lanes|C.childLanes,C=C.sibling;C=O&~$}else C=0,g.child=null;return jO(m,g,$,b,C)}if((b&536870912)!==0)g.memoizedState={baseLanes:0,cachePool:null},m!==null&&U0(g,$!==null?$.cachePool:null),$!==null?C5(g,$):CC(),S5(g);else return C=g.lanes=536870912,jO(m,g,$!==null?$.baseLanes|b:b,b,C)}else $!==null?(U0(g,$.cachePool),C5(g,$),Cc(),g.memoizedState=null):(m!==null&&U0(g,null),CC(),Cc());return Ns(m,g,O,b),g.child}function Wh(m,g){return m!==null&&m.tag===22||g.stateNode!==null||(g.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),g.sibling}function jO(m,g,b,C,O){var $=yC();return $=$===null?null:{parent:Rn._currentValue,pool:$},g.memoizedState={baseLanes:b,cachePool:$},m!==null&&U0(g,null),CC(),S5(g),m!==null&&wm(m,g,C,!0),g.childLanes=O,null}function ny(m,g){return g=ry({mode:g.mode,children:g.children},m.mode),g.ref=m.ref,m.child=g,g.return=m,g}function NO(m,g,b){return qd(g,m.child,null,b),m=ny(g,g.pendingProps),m.flags|=2,Er(g),g.memoizedState=null,m}function $te(m,g,b){var C=g.pendingProps,O=(g.flags&128)!==0;if(g.flags&=-129,m===null){if(ba){if(C.mode==="hidden")return m=ny(g,C),g.lanes=536870912,Wh(null,m);if(_C(g),(m=tn)?(m=MM(m,ai),m=m!==null&&m.data==="&"?m:null,m!==null&&(g.memoizedState={dehydrated:m,treeContext:pc!==null?{id:ro,overflow:io}:null,retryLane:536870912,hydrationErrors:null},b=i5(m),b.return=g,g.child=b,ws=g,tn=null)):m=null,m===null)throw yc(g);return g.lanes=536870912,null}return ny(g,C)}var $=m.memoizedState;if($!==null){var te=$.dehydrated;if(_C(g),O)if(g.flags&256)g.flags&=-257,g=NO(m,g,b);else if(g.memoizedState!==null)g.child=m.child,g.flags|=128,g=null;else throw Error(s(558));else if(Fn||wm(m,g,b,!1),O=(b&m.childLanes)!==0,Fn||O){if(C=Ga,C!==null&&(te=ue(C,b),te!==0&&te!==$.retryLane))throw $.retryLane=te,Id(m,te),rr(C,m,te),VC;hy(),g=NO(m,g,b)}else m=$.treeContext,tn=si(te.nextSibling),ws=g,ba=!0,xc=null,ai=!1,m!==null&&c5(g,m),g=ny(g,C),g.flags|=4096;return g}return m=tl(m.child,{mode:C.mode,children:C.children}),m.ref=g.ref,g.child=m,m.return=g,m}function sy(m,g){var b=g.ref;if(b===null)m!==null&&m.ref!==null&&(g.flags|=4194816);else{if(typeof b!="function"&&typeof b!="object")throw Error(s(284));(m===null||m.ref!==b)&&(g.flags|=4194816)}}function YC(m,g,b,C,O){return Fd(g),b=TC(m,g,b,C,void 0,O),C=kC(),m!==null&&!Fn?(EC(m,g,O),ol(m,g,O)):(ba&&C&&cC(g),g.flags|=1,Ns(m,g,b,O),g.child)}function CO(m,g,b,C,O,$){return Fd(g),g.updateQueue=null,b=A5(g,C,b,O),_5(m),C=kC(),m!==null&&!Fn?(EC(m,g,$),ol(m,g,$)):(ba&&C&&cC(g),g.flags|=1,Ns(m,g,b,$),g.child)}function SO(m,g,b,C,O){if(Fd(g),g.stateNode===null){var $=xm,te=b.contextType;typeof te=="object"&&te!==null&&($=js(te)),$=new b(C,$),g.memoizedState=$.state!==null&&$.state!==void 0?$.state:null,$.updater=GC,g.stateNode=$,$._reactInternals=g,$=g.stateNode,$.props=C,$.state=g.memoizedState,$.refs={},vC(g),te=b.contextType,$.context=typeof te=="object"&&te!==null?js(te):xm,$.state=g.memoizedState,te=b.getDerivedStateFromProps,typeof te=="function"&&(qC(g,b,te,C),$.state=g.memoizedState),typeof b.getDerivedStateFromProps=="function"||typeof $.getSnapshotBeforeUpdate=="function"||typeof $.UNSAFE_componentWillMount!="function"&&typeof $.componentWillMount!="function"||(te=$.state,typeof $.componentWillMount=="function"&&$.componentWillMount(),typeof $.UNSAFE_componentWillMount=="function"&&$.UNSAFE_componentWillMount(),te!==$.state&&GC.enqueueReplaceState($,$.state,null),Uh(g,C,$,O),Fh(),$.state=g.memoizedState),typeof $.componentDidMount=="function"&&(g.flags|=4194308),C=!0}else if(m===null){$=g.stateNode;var Se=g.memoizedProps,Ye=Wd(b,Se);$.props=Ye;var dt=$.context,xt=b.contextType;te=xm,typeof xt=="object"&&xt!==null&&(te=js(xt));var jt=b.getDerivedStateFromProps;xt=typeof jt=="function"||typeof $.getSnapshotBeforeUpdate=="function",Se=g.pendingProps!==Se,xt||typeof $.UNSAFE_componentWillReceiveProps!="function"&&typeof $.componentWillReceiveProps!="function"||(Se||dt!==te)&&uO(g,$,C,te),vc=!1;var mt=g.memoizedState;$.state=mt,Uh(g,C,$,O),Fh(),dt=g.memoizedState,Se||mt!==dt||vc?(typeof jt=="function"&&(qC(g,b,jt,C),dt=g.memoizedState),(Ye=vc||dO(g,b,Ye,C,mt,dt,te))?(xt||typeof $.UNSAFE_componentWillMount!="function"&&typeof $.componentWillMount!="function"||(typeof $.componentWillMount=="function"&&$.componentWillMount(),typeof $.UNSAFE_componentWillMount=="function"&&$.UNSAFE_componentWillMount()),typeof $.componentDidMount=="function"&&(g.flags|=4194308)):(typeof $.componentDidMount=="function"&&(g.flags|=4194308),g.memoizedProps=C,g.memoizedState=dt),$.props=C,$.state=dt,$.context=te,C=Ye):(typeof $.componentDidMount=="function"&&(g.flags|=4194308),C=!1)}else{$=g.stateNode,wC(m,g),te=g.memoizedProps,xt=Wd(b,te),$.props=xt,jt=g.pendingProps,mt=$.context,dt=b.contextType,Ye=xm,typeof dt=="object"&&dt!==null&&(Ye=js(dt)),Se=b.getDerivedStateFromProps,(dt=typeof Se=="function"||typeof $.getSnapshotBeforeUpdate=="function")||typeof $.UNSAFE_componentWillReceiveProps!="function"&&typeof $.componentWillReceiveProps!="function"||(te!==jt||mt!==Ye)&&uO(g,$,C,Ye),vc=!1,mt=g.memoizedState,$.state=mt,Uh(g,C,$,O),Fh();var pt=g.memoizedState;te!==jt||mt!==pt||vc||m!==null&&m.dependencies!==null&&z0(m.dependencies)?(typeof Se=="function"&&(qC(g,b,Se,C),pt=g.memoizedState),(xt=vc||dO(g,b,xt,C,mt,pt,Ye)||m!==null&&m.dependencies!==null&&z0(m.dependencies))?(dt||typeof $.UNSAFE_componentWillUpdate!="function"&&typeof $.componentWillUpdate!="function"||(typeof $.componentWillUpdate=="function"&&$.componentWillUpdate(C,pt,Ye),typeof $.UNSAFE_componentWillUpdate=="function"&&$.UNSAFE_componentWillUpdate(C,pt,Ye)),typeof $.componentDidUpdate=="function"&&(g.flags|=4),typeof $.getSnapshotBeforeUpdate=="function"&&(g.flags|=1024)):(typeof $.componentDidUpdate!="function"||te===m.memoizedProps&&mt===m.memoizedState||(g.flags|=4),typeof $.getSnapshotBeforeUpdate!="function"||te===m.memoizedProps&&mt===m.memoizedState||(g.flags|=1024),g.memoizedProps=C,g.memoizedState=pt),$.props=C,$.state=pt,$.context=Ye,C=xt):(typeof $.componentDidUpdate!="function"||te===m.memoizedProps&&mt===m.memoizedState||(g.flags|=4),typeof $.getSnapshotBeforeUpdate!="function"||te===m.memoizedProps&&mt===m.memoizedState||(g.flags|=1024),C=!1)}return $=C,sy(m,g),C=(g.flags&128)!==0,$||C?($=g.stateNode,b=C&&typeof b.getDerivedStateFromError!="function"?null:$.render(),g.flags|=1,m!==null&&C?(g.child=qd(g,m.child,null,O),g.child=qd(g,null,b,O)):Ns(m,g,b,O),g.memoizedState=$.state,m=g.child):m=ol(m,g,O),m}function _O(m,g,b,C){return Rd(),g.flags|=256,Ns(m,g,b,C),g.child}var QC={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function KC(m){return{baseLanes:m,cachePool:g5()}}function XC(m,g,b){return m=m!==null?m.childLanes&~b:0,g&&(m|=Pr),m}function AO(m,g,b){var C=g.pendingProps,O=!1,$=(g.flags&128)!==0,te;if((te=$)||(te=m!==null&&m.memoizedState===null?!1:(Ln.current&2)!==0),te&&(O=!0,g.flags&=-129),te=(g.flags&32)!==0,g.flags&=-33,m===null){if(ba){if(O?Nc(g):Cc(),(m=tn)?(m=MM(m,ai),m=m!==null&&m.data!=="&"?m:null,m!==null&&(g.memoizedState={dehydrated:m,treeContext:pc!==null?{id:ro,overflow:io}:null,retryLane:536870912,hydrationErrors:null},b=i5(m),b.return=g,g.child=b,ws=g,tn=null)):m=null,m===null)throw yc(g);return DS(m)?g.lanes=32:g.lanes=536870912,null}var Se=C.children;return C=C.fallback,O?(Cc(),O=g.mode,Se=ry({mode:"hidden",children:Se},O),C=$d(C,O,b,null),Se.return=g,C.return=g,Se.sibling=C,g.child=Se,C=g.child,C.memoizedState=KC(b),C.childLanes=XC(m,te,b),g.memoizedState=QC,Wh(null,C)):(Nc(g),ZC(g,Se))}var Ye=m.memoizedState;if(Ye!==null&&(Se=Ye.dehydrated,Se!==null)){if($)g.flags&256?(Nc(g),g.flags&=-257,g=JC(m,g,b)):g.memoizedState!==null?(Cc(),g.child=m.child,g.flags|=128,g=null):(Cc(),Se=C.fallback,O=g.mode,C=ry({mode:"visible",children:C.children},O),Se=$d(Se,O,b,null),Se.flags|=2,C.return=g,Se.return=g,C.sibling=Se,g.child=C,qd(g,m.child,null,b),C=g.child,C.memoizedState=KC(b),C.childLanes=XC(m,te,b),g.memoizedState=QC,g=Wh(null,C));else if(Nc(g),DS(Se)){if(te=Se.nextSibling&&Se.nextSibling.dataset,te)var dt=te.dgst;te=dt,C=Error(s(419)),C.stack="",C.digest=te,Oh({value:C,source:null,stack:null}),g=JC(m,g,b)}else if(Fn||wm(m,g,b,!1),te=(b&m.childLanes)!==0,Fn||te){if(te=Ga,te!==null&&(C=ue(te,b),C!==0&&C!==Ye.retryLane))throw Ye.retryLane=C,Id(m,C),rr(te,m,C),VC;PS(Se)||hy(),g=JC(m,g,b)}else PS(Se)?(g.flags|=192,g.child=m.child,g=null):(m=Ye.treeContext,tn=si(Se.nextSibling),ws=g,ba=!0,xc=null,ai=!1,m!==null&&c5(g,m),g=ZC(g,C.children),g.flags|=4096);return g}return O?(Cc(),Se=C.fallback,O=g.mode,Ye=m.child,dt=Ye.sibling,C=tl(Ye,{mode:"hidden",children:C.children}),C.subtreeFlags=Ye.subtreeFlags&65011712,dt!==null?Se=tl(dt,Se):(Se=$d(Se,O,b,null),Se.flags|=2),Se.return=g,C.return=g,C.sibling=Se,g.child=C,Wh(null,C),C=g.child,Se=m.child.memoizedState,Se===null?Se=KC(b):(O=Se.cachePool,O!==null?(Ye=Rn._currentValue,O=O.parent!==Ye?{parent:Ye,pool:Ye}:O):O=g5(),Se={baseLanes:Se.baseLanes|b,cachePool:O}),C.memoizedState=Se,C.childLanes=XC(m,te,b),g.memoizedState=QC,Wh(m.child,C)):(Nc(g),b=m.child,m=b.sibling,b=tl(b,{mode:"visible",children:C.children}),b.return=g,b.sibling=null,m!==null&&(te=g.deletions,te===null?(g.deletions=[m],g.flags|=16):te.push(m)),g.child=b,g.memoizedState=null,b)}function ZC(m,g){return g=ry({mode:"visible",children:g},m.mode),g.return=m,m.child=g}function ry(m,g){return m=Tr(22,m,null,g),m.lanes=0,m}function JC(m,g,b){return qd(g,m.child,null,b),m=ZC(g,g.pendingProps.children),m.flags|=2,g.memoizedState=null,m}function TO(m,g,b){m.lanes|=g;var C=m.alternate;C!==null&&(C.lanes|=g),hC(m.return,g,b)}function eS(m,g,b,C,O,$){var te=m.memoizedState;te===null?m.memoizedState={isBackwards:g,rendering:null,renderingStartTime:0,last:C,tail:b,tailMode:O,treeForkCount:$}:(te.isBackwards=g,te.rendering=null,te.renderingStartTime=0,te.last=C,te.tail=b,te.tailMode=O,te.treeForkCount=$)}function kO(m,g,b){var C=g.pendingProps,O=C.revealOrder,$=C.tail;C=C.children;var te=Ln.current,Se=(te&2)!==0;if(Se?(te=te&1|2,g.flags|=128):te&=1,ye(Ln,te),Ns(m,g,C,b),C=ba?Dh:0,!Se&&m!==null&&(m.flags&128)!==0)e:for(m=g.child;m!==null;){if(m.tag===13)m.memoizedState!==null&&TO(m,b,g);else if(m.tag===19)TO(m,b,g);else if(m.child!==null){m.child.return=m,m=m.child;continue}if(m===g)break e;for(;m.sibling===null;){if(m.return===null||m.return===g)break e;m=m.return}m.sibling.return=m.return,m=m.sibling}switch(O){case"forwards":for(b=g.child,O=null;b!==null;)m=b.alternate,m!==null&&V0(m)===null&&(O=b),b=b.sibling;b=O,b===null?(O=g.child,g.child=null):(O=b.sibling,b.sibling=null),eS(g,!1,O,b,$,C);break;case"backwards":case"unstable_legacy-backwards":for(b=null,O=g.child,g.child=null;O!==null;){if(m=O.alternate,m!==null&&V0(m)===null){g.child=O;break}m=O.sibling,O.sibling=b,b=O,O=m}eS(g,!0,b,null,$,C);break;case"together":eS(g,!1,null,null,void 0,C);break;default:g.memoizedState=null}return g.child}function ol(m,g,b){if(m!==null&&(g.dependencies=m.dependencies),Ac|=g.lanes,(b&g.childLanes)===0)if(m!==null){if(wm(m,g,b,!1),(b&g.childLanes)===0)return null}else return null;if(m!==null&&g.child!==m.child)throw Error(s(153));if(g.child!==null){for(m=g.child,b=tl(m,m.pendingProps),g.child=b,b.return=g;m.sibling!==null;)m=m.sibling,b=b.sibling=tl(m,m.pendingProps),b.return=g;b.sibling=null}return g.child}function tS(m,g){return(m.lanes&g)!==0?!0:(m=m.dependencies,!!(m!==null&&z0(m)))}function Rte(m,g,b){switch(g.tag){case 3:ke(g,g.stateNode.containerInfo),bc(g,Rn,m.memoizedState.cache),Rd();break;case 27:case 5:$e(g);break;case 4:ke(g,g.stateNode.containerInfo);break;case 10:bc(g,g.type,g.memoizedProps.value);break;case 31:if(g.memoizedState!==null)return g.flags|=128,_C(g),null;break;case 13:var C=g.memoizedState;if(C!==null)return C.dehydrated!==null?(Nc(g),g.flags|=128,null):(b&g.child.childLanes)!==0?AO(m,g,b):(Nc(g),m=ol(m,g,b),m!==null?m.sibling:null);Nc(g);break;case 19:var O=(m.flags&128)!==0;if(C=(b&g.childLanes)!==0,C||(wm(m,g,b,!1),C=(b&g.childLanes)!==0),O){if(C)return kO(m,g,b);g.flags|=128}if(O=g.memoizedState,O!==null&&(O.rendering=null,O.tail=null,O.lastEffect=null),ye(Ln,Ln.current),C)break;return null;case 22:return g.lanes=0,wO(m,g,b,g.pendingProps);case 24:bc(g,Rn,m.memoizedState.cache)}return ol(m,g,b)}function EO(m,g,b){if(m!==null)if(m.memoizedProps!==g.pendingProps)Fn=!0;else{if(!tS(m,b)&&(g.flags&128)===0)return Fn=!1,Rte(m,g,b);Fn=(m.flags&131072)!==0}else Fn=!1,ba&&(g.flags&1048576)!==0&&l5(g,Dh,g.index);switch(g.lanes=0,g.tag){case 16:e:{var C=g.pendingProps;if(m=Bd(g.elementType),g.type=m,typeof m=="function")iC(m)?(C=Wd(m,C),g.tag=1,g=SO(null,g,m,C,b)):(g.tag=0,g=YC(null,g,m,C,b));else{if(m!=null){var O=m.$$typeof;if(O===_){g.tag=11,g=yO(null,g,m,C,b);break e}else if(O===A){g.tag=14,g=bO(null,g,m,C,b);break e}}throw g=B(m)||m,Error(s(306,g,""))}}return g;case 0:return YC(m,g,g.type,g.pendingProps,b);case 1:return C=g.type,O=Wd(C,g.pendingProps),SO(m,g,C,O,b);case 3:e:{if(ke(g,g.stateNode.containerInfo),m===null)throw Error(s(387));C=g.pendingProps;var $=g.memoizedState;O=$.element,wC(m,g),Uh(g,C,null,b);var te=g.memoizedState;if(C=te.cache,bc(g,Rn,C),C!==$.cache&&gC(g,[Rn],b,!0),Fh(),C=te.element,$.isDehydrated)if($={element:C,isDehydrated:!1,cache:te.cache},g.updateQueue.baseState=$,g.memoizedState=$,g.flags&256){g=_O(m,g,C,b);break e}else if(C!==O){O=Jr(Error(s(424)),g),Oh(O),g=_O(m,g,C,b);break e}else for(m=g.stateNode.containerInfo,m.nodeType===9?m=m.body:m=m.nodeName==="HTML"?m.ownerDocument.body:m,tn=si(m.firstChild),ws=g,ba=!0,xc=null,ai=!0,b=w5(g,null,C,b),g.child=b;b;)b.flags=b.flags&-3|4096,b=b.sibling;else{if(Rd(),C===O){g=ol(m,g,b);break e}Ns(m,g,C,b)}g=g.child}return g;case 26:return sy(m,g),m===null?(b=UM(g.type,null,g.pendingProps,null))?g.memoizedState=b:ba||(b=g.type,m=g.pendingProps,C=wy(we.current).createElement(b),C[Me]=g,C[Ke]=m,Cs(C,b,m),Ve(C),g.stateNode=C):g.memoizedState=UM(g.type,m.memoizedProps,g.pendingProps,m.memoizedState),null;case 27:return $e(g),m===null&&ba&&(C=g.stateNode=RM(g.type,g.pendingProps,we.current),ws=g,ai=!0,O=tn,Pc(g.type)?(OS=O,tn=si(C.firstChild)):tn=O),Ns(m,g,g.pendingProps.children,b),sy(m,g),m===null&&(g.flags|=4194304),g.child;case 5:return m===null&&ba&&((O=C=tn)&&(C=hae(C,g.type,g.pendingProps,ai),C!==null?(g.stateNode=C,ws=g,tn=si(C.firstChild),ai=!1,O=!0):O=!1),O||yc(g)),$e(g),O=g.type,$=g.pendingProps,te=m!==null?m.memoizedProps:null,C=$.children,kS(O,$)?C=null:te!==null&&kS(O,te)&&(g.flags|=32),g.memoizedState!==null&&(O=TC(m,g,kte,null,null,b),og._currentValue=O),sy(m,g),Ns(m,g,C,b),g.child;case 6:return m===null&&ba&&((m=b=tn)&&(b=gae(b,g.pendingProps,ai),b!==null?(g.stateNode=b,ws=g,tn=null,m=!0):m=!1),m||yc(g)),null;case 13:return AO(m,g,b);case 4:return ke(g,g.stateNode.containerInfo),C=g.pendingProps,m===null?g.child=qd(g,null,C,b):Ns(m,g,C,b),g.child;case 11:return yO(m,g,g.type,g.pendingProps,b);case 7:return Ns(m,g,g.pendingProps,b),g.child;case 8:return Ns(m,g,g.pendingProps.children,b),g.child;case 12:return Ns(m,g,g.pendingProps.children,b),g.child;case 10:return C=g.pendingProps,bc(g,g.type,C.value),Ns(m,g,C.children,b),g.child;case 9:return O=g.type._context,C=g.pendingProps.children,Fd(g),O=js(O),C=C(O),g.flags|=1,Ns(m,g,C,b),g.child;case 14:return bO(m,g,g.type,g.pendingProps,b);case 15:return vO(m,g,g.type,g.pendingProps,b);case 19:return kO(m,g,b);case 31:return $te(m,g,b);case 22:return wO(m,g,b,g.pendingProps);case 24:return Fd(g),C=js(Rn),m===null?(O=yC(),O===null&&(O=Ga,$=pC(),O.pooledCache=$,$.refCount++,$!==null&&(O.pooledCacheLanes|=b),O=$),g.memoizedState={parent:C,cache:O},vC(g),bc(g,Rn,O)):((m.lanes&b)!==0&&(wC(m,g),Uh(g,null,null,b),Fh()),O=m.memoizedState,$=g.memoizedState,O.parent!==C?(O={parent:C,cache:C},g.memoizedState=O,g.lanes===0&&(g.memoizedState=g.updateQueue.baseState=O),bc(g,Rn,C)):(C=$.cache,bc(g,Rn,C),C!==O.cache&&gC(g,[Rn],b,!0))),Ns(m,g,g.pendingProps.children,b),g.child;case 29:throw g.pendingProps}throw Error(s(156,g.tag))}function ll(m){m.flags|=4}function aS(m,g,b,C,O){if((g=(m.mode&32)!==0)&&(g=!1),g){if(m.flags|=16777216,(O&335544128)===O)if(m.stateNode.complete)m.flags|=8192;else if(nM())m.flags|=8192;else throw Hd=H0,bC}else m.flags&=-16777217}function LO(m,g){if(g.type!=="stylesheet"||(g.state.loading&4)!==0)m.flags&=-16777217;else if(m.flags|=16777216,!WM(g))if(nM())m.flags|=8192;else throw Hd=H0,bC}function iy(m,g){g!==null&&(m.flags|=4),m.flags&16384&&(g=m.tag!==22?Qe():536870912,m.lanes|=g,Dm|=g)}function Vh(m,g){if(!ba)switch(m.tailMode){case"hidden":g=m.tail;for(var b=null;g!==null;)g.alternate!==null&&(b=g),g=g.sibling;b===null?m.tail=null:b.sibling=null;break;case"collapsed":b=m.tail;for(var C=null;b!==null;)b.alternate!==null&&(C=b),b=b.sibling;C===null?g||m.tail===null?m.tail=null:m.tail.sibling=null:C.sibling=null}}function an(m){var g=m.alternate!==null&&m.alternate.child===m.child,b=0,C=0;if(g)for(var O=m.child;O!==null;)b|=O.lanes|O.childLanes,C|=O.subtreeFlags&65011712,C|=O.flags&65011712,O.return=m,O=O.sibling;else for(O=m.child;O!==null;)b|=O.lanes|O.childLanes,C|=O.subtreeFlags,C|=O.flags,O.return=m,O=O.sibling;return m.subtreeFlags|=C,m.childLanes=b,g}function zte(m,g,b){var C=g.pendingProps;switch(dC(g),g.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return an(g),null;case 1:return an(g),null;case 3:return b=g.stateNode,C=null,m!==null&&(C=m.memoizedState.cache),g.memoizedState.cache!==C&&(g.flags|=2048),sl(Rn),ge(),b.pendingContext&&(b.context=b.pendingContext,b.pendingContext=null),(m===null||m.child===null)&&(vm(g)?ll(g):m===null||m.memoizedState.isDehydrated&&(g.flags&256)===0||(g.flags|=1024,mC())),an(g),null;case 26:var O=g.type,$=g.memoizedState;return m===null?(ll(g),$!==null?(an(g),LO(g,$)):(an(g),aS(g,O,null,C,b))):$?$!==m.memoizedState?(ll(g),an(g),LO(g,$)):(an(g),g.flags&=-16777217):(m=m.memoizedProps,m!==C&&ll(g),an(g),aS(g,O,m,C,b)),null;case 27:if(be(g),b=we.current,O=g.type,m!==null&&g.stateNode!=null)m.memoizedProps!==C&&ll(g);else{if(!C){if(g.stateNode===null)throw Error(s(166));return an(g),null}m=Ne.current,vm(g)?d5(g):(m=RM(O,C,b),g.stateNode=m,ll(g))}return an(g),null;case 5:if(be(g),O=g.type,m!==null&&g.stateNode!=null)m.memoizedProps!==C&&ll(g);else{if(!C){if(g.stateNode===null)throw Error(s(166));return an(g),null}if($=Ne.current,vm(g))d5(g);else{var te=wy(we.current);switch($){case 1:$=te.createElementNS("http://www.w3.org/2000/svg",O);break;case 2:$=te.createElementNS("http://www.w3.org/1998/Math/MathML",O);break;default:switch(O){case"svg":$=te.createElementNS("http://www.w3.org/2000/svg",O);break;case"math":$=te.createElementNS("http://www.w3.org/1998/Math/MathML",O);break;case"script":$=te.createElement("div"),$.innerHTML="<script><\/script>",$=$.removeChild($.firstChild);break;case"select":$=typeof C.is=="string"?te.createElement("select",{is:C.is}):te.createElement("select"),C.multiple?$.multiple=!0:C.size&&($.size=C.size);break;default:$=typeof C.is=="string"?te.createElement(O,{is:C.is}):te.createElement(O)}}$[Me]=g,$[Ke]=C;e:for(te=g.child;te!==null;){if(te.tag===5||te.tag===6)$.appendChild(te.stateNode);else if(te.tag!==4&&te.tag!==27&&te.child!==null){te.child.return=te,te=te.child;continue}if(te===g)break e;for(;te.sibling===null;){if(te.return===null||te.return===g)break e;te=te.return}te.sibling.return=te.return,te=te.sibling}g.stateNode=$;e:switch(Cs($,O,C),O){case"button":case"input":case"select":case"textarea":C=!!C.autoFocus;break e;case"img":C=!0;break e;default:C=!1}C&&ll(g)}}return an(g),aS(g,g.type,m===null?null:m.memoizedProps,g.pendingProps,b),null;case 6:if(m&&g.stateNode!=null)m.memoizedProps!==C&&ll(g);else{if(typeof C!="string"&&g.stateNode===null)throw Error(s(166));if(m=we.current,vm(g)){if(m=g.stateNode,b=g.memoizedProps,C=null,O=ws,O!==null)switch(O.tag){case 27:case 5:C=O.memoizedProps}m[Me]=g,m=!!(m.nodeValue===b||C!==null&&C.suppressHydrationWarning===!0||AM(m.nodeValue,b)),m||yc(g,!0)}else m=wy(m).createTextNode(C),m[Me]=g,g.stateNode=m}return an(g),null;case 31:if(b=g.memoizedState,m===null||m.memoizedState!==null){if(C=vm(g),b!==null){if(m===null){if(!C)throw Error(s(318));if(m=g.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(s(557));m[Me]=g}else Rd(),(g.flags&128)===0&&(g.memoizedState=null),g.flags|=4;an(g),m=!1}else b=mC(),m!==null&&m.memoizedState!==null&&(m.memoizedState.hydrationErrors=b),m=!0;if(!m)return g.flags&256?(Er(g),g):(Er(g),null);if((g.flags&128)!==0)throw Error(s(558))}return an(g),null;case 13:if(C=g.memoizedState,m===null||m.memoizedState!==null&&m.memoizedState.dehydrated!==null){if(O=vm(g),C!==null&&C.dehydrated!==null){if(m===null){if(!O)throw Error(s(318));if(O=g.memoizedState,O=O!==null?O.dehydrated:null,!O)throw Error(s(317));O[Me]=g}else Rd(),(g.flags&128)===0&&(g.memoizedState=null),g.flags|=4;an(g),O=!1}else O=mC(),m!==null&&m.memoizedState!==null&&(m.memoizedState.hydrationErrors=O),O=!0;if(!O)return g.flags&256?(Er(g),g):(Er(g),null)}return Er(g),(g.flags&128)!==0?(g.lanes=b,g):(b=C!==null,m=m!==null&&m.memoizedState!==null,b&&(C=g.child,O=null,C.alternate!==null&&C.alternate.memoizedState!==null&&C.alternate.memoizedState.cachePool!==null&&(O=C.alternate.memoizedState.cachePool.pool),$=null,C.memoizedState!==null&&C.memoizedState.cachePool!==null&&($=C.memoizedState.cachePool.pool),$!==O&&(C.flags|=2048)),b!==m&&b&&(g.child.flags|=8192),iy(g,g.updateQueue),an(g),null);case 4:return ge(),m===null&&CS(g.stateNode.containerInfo),an(g),null;case 10:return sl(g.type),an(g),null;case 19:if(se(Ln),C=g.memoizedState,C===null)return an(g),null;if(O=(g.flags&128)!==0,$=C.rendering,$===null)if(O)Vh(C,!1);else{if(wn!==0||m!==null&&(m.flags&128)!==0)for(m=g.child;m!==null;){if($=V0(m),$!==null){for(g.flags|=128,Vh(C,!1),m=$.updateQueue,g.updateQueue=m,iy(g,m),g.subtreeFlags=0,m=b,b=g.child;b!==null;)r5(b,m),b=b.sibling;return ye(Ln,Ln.current&1|2),ba&&al(g,C.treeForkCount),g.child}m=m.sibling}C.tail!==null&&_e()>uy&&(g.flags|=128,O=!0,Vh(C,!1),g.lanes=4194304)}else{if(!O)if(m=V0($),m!==null){if(g.flags|=128,O=!0,m=m.updateQueue,g.updateQueue=m,iy(g,m),Vh(C,!0),C.tail===null&&C.tailMode==="hidden"&&!$.alternate&&!ba)return an(g),null}else 2*_e()-C.renderingStartTime>uy&&b!==536870912&&(g.flags|=128,O=!0,Vh(C,!1),g.lanes=4194304);C.isBackwards?($.sibling=g.child,g.child=$):(m=C.last,m!==null?m.sibling=$:g.child=$,C.last=$)}return C.tail!==null?(m=C.tail,C.rendering=m,C.tail=m.sibling,C.renderingStartTime=_e(),m.sibling=null,b=Ln.current,ye(Ln,O?b&1|2:b&1),ba&&al(g,C.treeForkCount),m):(an(g),null);case 22:case 23:return Er(g),SC(),C=g.memoizedState!==null,m!==null?m.memoizedState!==null!==C&&(g.flags|=8192):C&&(g.flags|=8192),C?(b&536870912)!==0&&(g.flags&128)===0&&(an(g),g.subtreeFlags&6&&(g.flags|=8192)):an(g),b=g.updateQueue,b!==null&&iy(g,b.retryQueue),b=null,m!==null&&m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(b=m.memoizedState.cachePool.pool),C=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(C=g.memoizedState.cachePool.pool),C!==b&&(g.flags|=2048),m!==null&&se(Ud),null;case 24:return b=null,m!==null&&(b=m.memoizedState.cache),g.memoizedState.cache!==b&&(g.flags|=2048),sl(Rn),an(g),null;case 25:return null;case 30:return null}throw Error(s(156,g.tag))}function Fte(m,g){switch(dC(g),g.tag){case 1:return m=g.flags,m&65536?(g.flags=m&-65537|128,g):null;case 3:return sl(Rn),ge(),m=g.flags,(m&65536)!==0&&(m&128)===0?(g.flags=m&-65537|128,g):null;case 26:case 27:case 5:return be(g),null;case 31:if(g.memoizedState!==null){if(Er(g),g.alternate===null)throw Error(s(340));Rd()}return m=g.flags,m&65536?(g.flags=m&-65537|128,g):null;case 13:if(Er(g),m=g.memoizedState,m!==null&&m.dehydrated!==null){if(g.alternate===null)throw Error(s(340));Rd()}return m=g.flags,m&65536?(g.flags=m&-65537|128,g):null;case 19:return se(Ln),null;case 4:return ge(),null;case 10:return sl(g.type),null;case 22:case 23:return Er(g),SC(),m!==null&&se(Ud),m=g.flags,m&65536?(g.flags=m&-65537|128,g):null;case 24:return sl(Rn),null;case 25:return null;default:return null}}function PO(m,g){switch(dC(g),g.tag){case 3:sl(Rn),ge();break;case 26:case 27:case 5:be(g);break;case 4:ge();break;case 31:g.memoizedState!==null&&Er(g);break;case 13:Er(g);break;case 19:se(Ln);break;case 10:sl(g.type);break;case 22:case 23:Er(g),SC(),m!==null&&se(Ud);break;case 24:sl(Rn)}}function Yh(m,g){try{var b=g.updateQueue,C=b!==null?b.lastEffect:null;if(C!==null){var O=C.next;b=O;do{if((b.tag&m)===m){C=void 0;var $=b.create,te=b.inst;C=$(),te.destroy=C}b=b.next}while(b!==O)}}catch(Se){Oa(g,g.return,Se)}}function Sc(m,g,b){try{var C=g.updateQueue,O=C!==null?C.lastEffect:null;if(O!==null){var $=O.next;C=$;do{if((C.tag&m)===m){var te=C.inst,Se=te.destroy;if(Se!==void 0){te.destroy=void 0,O=g;var Ye=b,dt=Se;try{dt()}catch(xt){Oa(O,Ye,xt)}}}C=C.next}while(C!==$)}}catch(xt){Oa(g,g.return,xt)}}function DO(m){var g=m.updateQueue;if(g!==null){var b=m.stateNode;try{N5(g,b)}catch(C){Oa(m,m.return,C)}}}function OO(m,g,b){b.props=Wd(m.type,m.memoizedProps),b.state=m.memoizedState;try{b.componentWillUnmount()}catch(C){Oa(m,g,C)}}function Qh(m,g){try{var b=m.ref;if(b!==null){switch(m.tag){case 26:case 27:case 5:var C=m.stateNode;break;case 30:C=m.stateNode;break;default:C=m.stateNode}typeof b=="function"?m.refCleanup=b(C):b.current=C}}catch(O){Oa(m,g,O)}}function oo(m,g){var b=m.ref,C=m.refCleanup;if(b!==null)if(typeof C=="function")try{C()}catch(O){Oa(m,g,O)}finally{m.refCleanup=null,m=m.alternate,m!=null&&(m.refCleanup=null)}else if(typeof b=="function")try{b(null)}catch(O){Oa(m,g,O)}else b.current=null}function MO(m){var g=m.type,b=m.memoizedProps,C=m.stateNode;try{e:switch(g){case"button":case"input":case"select":case"textarea":b.autoFocus&&C.focus();break e;case"img":b.src?C.src=b.src:b.srcSet&&(C.srcset=b.srcSet)}}catch(O){Oa(m,m.return,O)}}function nS(m,g,b){try{var C=m.stateNode;lae(C,m.type,b,g),C[Ke]=g}catch(O){Oa(m,m.return,O)}}function IO(m){return m.tag===5||m.tag===3||m.tag===26||m.tag===27&&Pc(m.type)||m.tag===4}function sS(m){e:for(;;){for(;m.sibling===null;){if(m.return===null||IO(m.return))return null;m=m.return}for(m.sibling.return=m.return,m=m.sibling;m.tag!==5&&m.tag!==6&&m.tag!==18;){if(m.tag===27&&Pc(m.type)||m.flags&2||m.child===null||m.tag===4)continue e;m.child.return=m,m=m.child}if(!(m.flags&2))return m.stateNode}}function rS(m,g,b){var C=m.tag;if(C===5||C===6)m=m.stateNode,g?(b.nodeType===9?b.body:b.nodeName==="HTML"?b.ownerDocument.body:b).insertBefore(m,g):(g=b.nodeType===9?b.body:b.nodeName==="HTML"?b.ownerDocument.body:b,g.appendChild(m),b=b._reactRootContainer,b!=null||g.onclick!==null||(g.onclick=Jo));else if(C!==4&&(C===27&&Pc(m.type)&&(b=m.stateNode,g=null),m=m.child,m!==null))for(rS(m,g,b),m=m.sibling;m!==null;)rS(m,g,b),m=m.sibling}function oy(m,g,b){var C=m.tag;if(C===5||C===6)m=m.stateNode,g?b.insertBefore(m,g):b.appendChild(m);else if(C!==4&&(C===27&&Pc(m.type)&&(b=m.stateNode),m=m.child,m!==null))for(oy(m,g,b),m=m.sibling;m!==null;)oy(m,g,b),m=m.sibling}function $O(m){var g=m.stateNode,b=m.memoizedProps;try{for(var C=m.type,O=g.attributes;O.length;)g.removeAttributeNode(O[0]);Cs(g,C,b),g[Me]=m,g[Ke]=b}catch($){Oa(m,m.return,$)}}var cl=!1,Un=!1,iS=!1,RO=typeof WeakSet=="function"?WeakSet:Set,us=null;function Ute(m,g){if(m=m.containerInfo,AS=Ty,m=K3(m),J1(m)){if("selectionStart"in m)var b={start:m.selectionStart,end:m.selectionEnd};else e:{b=(b=m.ownerDocument)&&b.defaultView||window;var C=b.getSelection&&b.getSelection();if(C&&C.rangeCount!==0){b=C.anchorNode;var O=C.anchorOffset,$=C.focusNode;C=C.focusOffset;try{b.nodeType,$.nodeType}catch{b=null;break e}var te=0,Se=-1,Ye=-1,dt=0,xt=0,jt=m,mt=null;t:for(;;){for(var pt;jt!==b||O!==0&&jt.nodeType!==3||(Se=te+O),jt!==$||C!==0&&jt.nodeType!==3||(Ye=te+C),jt.nodeType===3&&(te+=jt.nodeValue.length),(pt=jt.firstChild)!==null;)mt=jt,jt=pt;for(;;){if(jt===m)break t;if(mt===b&&++dt===O&&(Se=te),mt===$&&++xt===C&&(Ye=te),(pt=jt.nextSibling)!==null)break;jt=mt,mt=jt.parentNode}jt=pt}b=Se===-1||Ye===-1?null:{start:Se,end:Ye}}else b=null}b=b||{start:0,end:0}}else b=null;for(TS={focusedElem:m,selectionRange:b},Ty=!1,us=g;us!==null;)if(g=us,m=g.child,(g.subtreeFlags&1028)!==0&&m!==null)m.return=g,us=m;else for(;us!==null;){switch(g=us,$=g.alternate,m=g.flags,g.tag){case 0:if((m&4)!==0&&(m=g.updateQueue,m=m!==null?m.events:null,m!==null))for(b=0;b<m.length;b++)O=m[b],O.ref.impl=O.nextImpl;break;case 11:case 15:break;case 1:if((m&1024)!==0&&$!==null){m=void 0,b=g,O=$.memoizedProps,$=$.memoizedState,C=b.stateNode;try{var zt=Wd(b.type,O);m=C.getSnapshotBeforeUpdate(zt,$),C.__reactInternalSnapshotBeforeUpdate=m}catch(Jt){Oa(b,b.return,Jt)}}break;case 3:if((m&1024)!==0){if(m=g.stateNode.containerInfo,b=m.nodeType,b===9)LS(m);else if(b===1)switch(m.nodeName){case"HEAD":case"HTML":case"BODY":LS(m);break;default:m.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((m&1024)!==0)throw Error(s(163))}if(m=g.sibling,m!==null){m.return=g.return,us=m;break}us=g.return}}function zO(m,g,b){var C=b.flags;switch(b.tag){case 0:case 11:case 15:ul(m,b),C&4&&Yh(5,b);break;case 1:if(ul(m,b),C&4)if(m=b.stateNode,g===null)try{m.componentDidMount()}catch(te){Oa(b,b.return,te)}else{var O=Wd(b.type,g.memoizedProps);g=g.memoizedState;try{m.componentDidUpdate(O,g,m.__reactInternalSnapshotBeforeUpdate)}catch(te){Oa(b,b.return,te)}}C&64&&DO(b),C&512&&Qh(b,b.return);break;case 3:if(ul(m,b),C&64&&(m=b.updateQueue,m!==null)){if(g=null,b.child!==null)switch(b.child.tag){case 27:case 5:g=b.child.stateNode;break;case 1:g=b.child.stateNode}try{N5(m,g)}catch(te){Oa(b,b.return,te)}}break;case 27:g===null&&C&4&&$O(b);case 26:case 5:ul(m,b),g===null&&C&4&&MO(b),C&512&&Qh(b,b.return);break;case 12:ul(m,b);break;case 31:ul(m,b),C&4&&BO(m,b);break;case 13:ul(m,b),C&4&&HO(m,b),C&64&&(m=b.memoizedState,m!==null&&(m=m.dehydrated,m!==null&&(b=Kte.bind(null,b),pae(m,b))));break;case 22:if(C=b.memoizedState!==null||cl,!C){g=g!==null&&g.memoizedState!==null||Un,O=cl;var $=Un;cl=C,(Un=g)&&!$?ml(m,b,(b.subtreeFlags&8772)!==0):ul(m,b),cl=O,Un=$}break;case 30:break;default:ul(m,b)}}function FO(m){var g=m.alternate;g!==null&&(m.alternate=null,FO(g)),m.child=null,m.deletions=null,m.sibling=null,m.tag===5&&(g=m.stateNode,g!==null&&I(g)),m.stateNode=null,m.return=null,m.dependencies=null,m.memoizedProps=null,m.memoizedState=null,m.pendingProps=null,m.stateNode=null,m.updateQueue=null}var on=null,tr=!1;function dl(m,g,b){for(b=b.child;b!==null;)UO(m,g,b),b=b.sibling}function UO(m,g,b){if(qe&&typeof qe.onCommitFiberUnmount=="function")try{qe.onCommitFiberUnmount(He,b)}catch{}switch(b.tag){case 26:Un||oo(b,g),dl(m,g,b),b.memoizedState?b.memoizedState.count--:b.stateNode&&(b=b.stateNode,b.parentNode.removeChild(b));break;case 27:Un||oo(b,g);var C=on,O=tr;Pc(b.type)&&(on=b.stateNode,tr=!1),dl(m,g,b),sg(b.stateNode),on=C,tr=O;break;case 5:Un||oo(b,g);case 6:if(C=on,O=tr,on=null,dl(m,g,b),on=C,tr=O,on!==null)if(tr)try{(on.nodeType===9?on.body:on.nodeName==="HTML"?on.ownerDocument.body:on).removeChild(b.stateNode)}catch($){Oa(b,g,$)}else try{on.removeChild(b.stateNode)}catch($){Oa(b,g,$)}break;case 18:on!==null&&(tr?(m=on,DM(m.nodeType===9?m.body:m.nodeName==="HTML"?m.ownerDocument.body:m,b.stateNode),Um(m)):DM(on,b.stateNode));break;case 4:C=on,O=tr,on=b.stateNode.containerInfo,tr=!0,dl(m,g,b),on=C,tr=O;break;case 0:case 11:case 14:case 15:Sc(2,b,g),Un||Sc(4,b,g),dl(m,g,b);break;case 1:Un||(oo(b,g),C=b.stateNode,typeof C.componentWillUnmount=="function"&&OO(b,g,C)),dl(m,g,b);break;case 21:dl(m,g,b);break;case 22:Un=(C=Un)||b.memoizedState!==null,dl(m,g,b),Un=C;break;default:dl(m,g,b)}}function BO(m,g){if(g.memoizedState===null&&(m=g.alternate,m!==null&&(m=m.memoizedState,m!==null))){m=m.dehydrated;try{Um(m)}catch(b){Oa(g,g.return,b)}}}function HO(m,g){if(g.memoizedState===null&&(m=g.alternate,m!==null&&(m=m.memoizedState,m!==null&&(m=m.dehydrated,m!==null))))try{Um(m)}catch(b){Oa(g,g.return,b)}}function Bte(m){switch(m.tag){case 31:case 13:case 19:var g=m.stateNode;return g===null&&(g=m.stateNode=new RO),g;case 22:return m=m.stateNode,g=m._retryCache,g===null&&(g=m._retryCache=new RO),g;default:throw Error(s(435,m.tag))}}function ly(m,g){var b=Bte(m);g.forEach(function(C){if(!b.has(C)){b.add(C);var O=Xte.bind(null,m,C);C.then(O,O)}})}function ar(m,g){var b=g.deletions;if(b!==null)for(var C=0;C<b.length;C++){var O=b[C],$=m,te=g,Se=te;e:for(;Se!==null;){switch(Se.tag){case 27:if(Pc(Se.type)){on=Se.stateNode,tr=!1;break e}break;case 5:on=Se.stateNode,tr=!1;break e;case 3:case 4:on=Se.stateNode.containerInfo,tr=!0;break e}Se=Se.return}if(on===null)throw Error(s(160));UO($,te,O),on=null,tr=!1,$=O.alternate,$!==null&&($.return=null),O.return=null}if(g.subtreeFlags&13886)for(g=g.child;g!==null;)qO(g,m),g=g.sibling}var Di=null;function qO(m,g){var b=m.alternate,C=m.flags;switch(m.tag){case 0:case 11:case 14:case 15:ar(g,m),nr(m),C&4&&(Sc(3,m,m.return),Yh(3,m),Sc(5,m,m.return));break;case 1:ar(g,m),nr(m),C&512&&(Un||b===null||oo(b,b.return)),C&64&&cl&&(m=m.updateQueue,m!==null&&(C=m.callbacks,C!==null&&(b=m.shared.hiddenCallbacks,m.shared.hiddenCallbacks=b===null?C:b.concat(C))));break;case 26:var O=Di;if(ar(g,m),nr(m),C&512&&(Un||b===null||oo(b,b.return)),C&4){var $=b!==null?b.memoizedState:null;if(C=m.memoizedState,b===null)if(C===null)if(m.stateNode===null){e:{C=m.type,b=m.memoizedProps,O=O.ownerDocument||O;t:switch(C){case"title":$=O.getElementsByTagName("title")[0],(!$||$[Ae]||$[Me]||$.namespaceURI==="http://www.w3.org/2000/svg"||$.hasAttribute("itemprop"))&&($=O.createElement(C),O.head.insertBefore($,O.querySelector("head > title"))),Cs($,C,b),$[Me]=m,Ve($),C=$;break e;case"link":var te=qM("link","href",O).get(C+(b.href||""));if(te){for(var Se=0;Se<te.length;Se++)if($=te[Se],$.getAttribute("href")===(b.href==null||b.href===""?null:b.href)&&$.getAttribute("rel")===(b.rel==null?null:b.rel)&&$.getAttribute("title")===(b.title==null?null:b.title)&&$.getAttribute("crossorigin")===(b.crossOrigin==null?null:b.crossOrigin)){te.splice(Se,1);break t}}$=O.createElement(C),Cs($,C,b),O.head.appendChild($);break;case"meta":if(te=qM("meta","content",O).get(C+(b.content||""))){for(Se=0;Se<te.length;Se++)if($=te[Se],$.getAttribute("content")===(b.content==null?null:""+b.content)&&$.getAttribute("name")===(b.name==null?null:b.name)&&$.getAttribute("property")===(b.property==null?null:b.property)&&$.getAttribute("http-equiv")===(b.httpEquiv==null?null:b.httpEquiv)&&$.getAttribute("charset")===(b.charSet==null?null:b.charSet)){te.splice(Se,1);break t}}$=O.createElement(C),Cs($,C,b),O.head.appendChild($);break;default:throw Error(s(468,C))}$[Me]=m,Ve($),C=$}m.stateNode=C}else GM(O,m.type,m.stateNode);else m.stateNode=HM(O,C,m.memoizedProps);else $!==C?($===null?b.stateNode!==null&&(b=b.stateNode,b.parentNode.removeChild(b)):$.count--,C===null?GM(O,m.type,m.stateNode):HM(O,C,m.memoizedProps)):C===null&&m.stateNode!==null&&nS(m,m.memoizedProps,b.memoizedProps)}break;case 27:ar(g,m),nr(m),C&512&&(Un||b===null||oo(b,b.return)),b!==null&&C&4&&nS(m,m.memoizedProps,b.memoizedProps);break;case 5:if(ar(g,m),nr(m),C&512&&(Un||b===null||oo(b,b.return)),m.flags&32){O=m.stateNode;try{dm(O,"")}catch(zt){Oa(m,m.return,zt)}}C&4&&m.stateNode!=null&&(O=m.memoizedProps,nS(m,O,b!==null?b.memoizedProps:O)),C&1024&&(iS=!0);break;case 6:if(ar(g,m),nr(m),C&4){if(m.stateNode===null)throw Error(s(162));C=m.memoizedProps,b=m.stateNode;try{b.nodeValue=C}catch(zt){Oa(m,m.return,zt)}}break;case 3:if(Cy=null,O=Di,Di=jy(g.containerInfo),ar(g,m),Di=O,nr(m),C&4&&b!==null&&b.memoizedState.isDehydrated)try{Um(g.containerInfo)}catch(zt){Oa(m,m.return,zt)}iS&&(iS=!1,GO(m));break;case 4:C=Di,Di=jy(m.stateNode.containerInfo),ar(g,m),nr(m),Di=C;break;case 12:ar(g,m),nr(m);break;case 31:ar(g,m),nr(m),C&4&&(C=m.updateQueue,C!==null&&(m.updateQueue=null,ly(m,C)));break;case 13:ar(g,m),nr(m),m.child.flags&8192&&m.memoizedState!==null!=(b!==null&&b.memoizedState!==null)&&(dy=_e()),C&4&&(C=m.updateQueue,C!==null&&(m.updateQueue=null,ly(m,C)));break;case 22:O=m.memoizedState!==null;var Ye=b!==null&&b.memoizedState!==null,dt=cl,xt=Un;if(cl=dt||O,Un=xt||Ye,ar(g,m),Un=xt,cl=dt,nr(m),C&8192)e:for(g=m.stateNode,g._visibility=O?g._visibility&-2:g._visibility|1,O&&(b===null||Ye||cl||Un||Vd(m)),b=null,g=m;;){if(g.tag===5||g.tag===26){if(b===null){Ye=b=g;try{if($=Ye.stateNode,O)te=$.style,typeof te.setProperty=="function"?te.setProperty("display","none","important"):te.display="none";else{Se=Ye.stateNode;var jt=Ye.memoizedProps.style,mt=jt!=null&&jt.hasOwnProperty("display")?jt.display:null;Se.style.display=mt==null||typeof mt=="boolean"?"":(""+mt).trim()}}catch(zt){Oa(Ye,Ye.return,zt)}}}else if(g.tag===6){if(b===null){Ye=g;try{Ye.stateNode.nodeValue=O?"":Ye.memoizedProps}catch(zt){Oa(Ye,Ye.return,zt)}}}else if(g.tag===18){if(b===null){Ye=g;try{var pt=Ye.stateNode;O?OM(pt,!0):OM(Ye.stateNode,!1)}catch(zt){Oa(Ye,Ye.return,zt)}}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===m)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===m)break e;for(;g.sibling===null;){if(g.return===null||g.return===m)break e;b===g&&(b=null),g=g.return}b===g&&(b=null),g.sibling.return=g.return,g=g.sibling}C&4&&(C=m.updateQueue,C!==null&&(b=C.retryQueue,b!==null&&(C.retryQueue=null,ly(m,b))));break;case 19:ar(g,m),nr(m),C&4&&(C=m.updateQueue,C!==null&&(m.updateQueue=null,ly(m,C)));break;case 30:break;case 21:break;default:ar(g,m),nr(m)}}function nr(m){var g=m.flags;if(g&2){try{for(var b,C=m.return;C!==null;){if(IO(C)){b=C;break}C=C.return}if(b==null)throw Error(s(160));switch(b.tag){case 27:var O=b.stateNode,$=sS(m);oy(m,$,O);break;case 5:var te=b.stateNode;b.flags&32&&(dm(te,""),b.flags&=-33);var Se=sS(m);oy(m,Se,te);break;case 3:case 4:var Ye=b.stateNode.containerInfo,dt=sS(m);rS(m,dt,Ye);break;default:throw Error(s(161))}}catch(xt){Oa(m,m.return,xt)}m.flags&=-3}g&4096&&(m.flags&=-4097)}function GO(m){if(m.subtreeFlags&1024)for(m=m.child;m!==null;){var g=m;GO(g),g.tag===5&&g.flags&1024&&g.stateNode.reset(),m=m.sibling}}function ul(m,g){if(g.subtreeFlags&8772)for(g=g.child;g!==null;)zO(m,g.alternate,g),g=g.sibling}function Vd(m){for(m=m.child;m!==null;){var g=m;switch(g.tag){case 0:case 11:case 14:case 15:Sc(4,g,g.return),Vd(g);break;case 1:oo(g,g.return);var b=g.stateNode;typeof b.componentWillUnmount=="function"&&OO(g,g.return,b),Vd(g);break;case 27:sg(g.stateNode);case 26:case 5:oo(g,g.return),Vd(g);break;case 22:g.memoizedState===null&&Vd(g);break;case 30:Vd(g);break;default:Vd(g)}m=m.sibling}}function ml(m,g,b){for(b=b&&(g.subtreeFlags&8772)!==0,g=g.child;g!==null;){var C=g.alternate,O=m,$=g,te=$.flags;switch($.tag){case 0:case 11:case 15:ml(O,$,b),Yh(4,$);break;case 1:if(ml(O,$,b),C=$,O=C.stateNode,typeof O.componentDidMount=="function")try{O.componentDidMount()}catch(dt){Oa(C,C.return,dt)}if(C=$,O=C.updateQueue,O!==null){var Se=C.stateNode;try{var Ye=O.shared.hiddenCallbacks;if(Ye!==null)for(O.shared.hiddenCallbacks=null,O=0;O<Ye.length;O++)j5(Ye[O],Se)}catch(dt){Oa(C,C.return,dt)}}b&&te&64&&DO($),Qh($,$.return);break;case 27:$O($);case 26:case 5:ml(O,$,b),b&&C===null&&te&4&&MO($),Qh($,$.return);break;case 12:ml(O,$,b);break;case 31:ml(O,$,b),b&&te&4&&BO(O,$);break;case 13:ml(O,$,b),b&&te&4&&HO(O,$);break;case 22:$.memoizedState===null&&ml(O,$,b),Qh($,$.return);break;case 30:break;default:ml(O,$,b)}g=g.sibling}}function oS(m,g){var b=null;m!==null&&m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(b=m.memoizedState.cachePool.pool),m=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(m=g.memoizedState.cachePool.pool),m!==b&&(m!=null&&m.refCount++,b!=null&&Mh(b))}function lS(m,g){m=null,g.alternate!==null&&(m=g.alternate.memoizedState.cache),g=g.memoizedState.cache,g!==m&&(g.refCount++,m!=null&&Mh(m))}function Oi(m,g,b,C){if(g.subtreeFlags&10256)for(g=g.child;g!==null;)WO(m,g,b,C),g=g.sibling}function WO(m,g,b,C){var O=g.flags;switch(g.tag){case 0:case 11:case 15:Oi(m,g,b,C),O&2048&&Yh(9,g);break;case 1:Oi(m,g,b,C);break;case 3:Oi(m,g,b,C),O&2048&&(m=null,g.alternate!==null&&(m=g.alternate.memoizedState.cache),g=g.memoizedState.cache,g!==m&&(g.refCount++,m!=null&&Mh(m)));break;case 12:if(O&2048){Oi(m,g,b,C),m=g.stateNode;try{var $=g.memoizedProps,te=$.id,Se=$.onPostCommit;typeof Se=="function"&&Se(te,g.alternate===null?"mount":"update",m.passiveEffectDuration,-0)}catch(Ye){Oa(g,g.return,Ye)}}else Oi(m,g,b,C);break;case 31:Oi(m,g,b,C);break;case 13:Oi(m,g,b,C);break;case 23:break;case 22:$=g.stateNode,te=g.alternate,g.memoizedState!==null?$._visibility&2?Oi(m,g,b,C):Kh(m,g):$._visibility&2?Oi(m,g,b,C):($._visibility|=2,Em(m,g,b,C,(g.subtreeFlags&10256)!==0||!1)),O&2048&&oS(te,g);break;case 24:Oi(m,g,b,C),O&2048&&lS(g.alternate,g);break;default:Oi(m,g,b,C)}}function Em(m,g,b,C,O){for(O=O&&((g.subtreeFlags&10256)!==0||!1),g=g.child;g!==null;){var $=m,te=g,Se=b,Ye=C,dt=te.flags;switch(te.tag){case 0:case 11:case 15:Em($,te,Se,Ye,O),Yh(8,te);break;case 23:break;case 22:var xt=te.stateNode;te.memoizedState!==null?xt._visibility&2?Em($,te,Se,Ye,O):Kh($,te):(xt._visibility|=2,Em($,te,Se,Ye,O)),O&&dt&2048&&oS(te.alternate,te);break;case 24:Em($,te,Se,Ye,O),O&&dt&2048&&lS(te.alternate,te);break;default:Em($,te,Se,Ye,O)}g=g.sibling}}function Kh(m,g){if(g.subtreeFlags&10256)for(g=g.child;g!==null;){var b=m,C=g,O=C.flags;switch(C.tag){case 22:Kh(b,C),O&2048&&oS(C.alternate,C);break;case 24:Kh(b,C),O&2048&&lS(C.alternate,C);break;default:Kh(b,C)}g=g.sibling}}var Xh=8192;function Lm(m,g,b){if(m.subtreeFlags&Xh)for(m=m.child;m!==null;)VO(m,g,b),m=m.sibling}function VO(m,g,b){switch(m.tag){case 26:Lm(m,g,b),m.flags&Xh&&m.memoizedState!==null&&Tae(b,Di,m.memoizedState,m.memoizedProps);break;case 5:Lm(m,g,b);break;case 3:case 4:var C=Di;Di=jy(m.stateNode.containerInfo),Lm(m,g,b),Di=C;break;case 22:m.memoizedState===null&&(C=m.alternate,C!==null&&C.memoizedState!==null?(C=Xh,Xh=16777216,Lm(m,g,b),Xh=C):Lm(m,g,b));break;default:Lm(m,g,b)}}function YO(m){var g=m.alternate;if(g!==null&&(m=g.child,m!==null)){g.child=null;do g=m.sibling,m.sibling=null,m=g;while(m!==null)}}function Zh(m){var g=m.deletions;if((m.flags&16)!==0){if(g!==null)for(var b=0;b<g.length;b++){var C=g[b];us=C,KO(C,m)}YO(m)}if(m.subtreeFlags&10256)for(m=m.child;m!==null;)QO(m),m=m.sibling}function QO(m){switch(m.tag){case 0:case 11:case 15:Zh(m),m.flags&2048&&Sc(9,m,m.return);break;case 3:Zh(m);break;case 12:Zh(m);break;case 22:var g=m.stateNode;m.memoizedState!==null&&g._visibility&2&&(m.return===null||m.return.tag!==13)?(g._visibility&=-3,cy(m)):Zh(m);break;default:Zh(m)}}function cy(m){var g=m.deletions;if((m.flags&16)!==0){if(g!==null)for(var b=0;b<g.length;b++){var C=g[b];us=C,KO(C,m)}YO(m)}for(m=m.child;m!==null;){switch(g=m,g.tag){case 0:case 11:case 15:Sc(8,g,g.return),cy(g);break;case 22:b=g.stateNode,b._visibility&2&&(b._visibility&=-3,cy(g));break;default:cy(g)}m=m.sibling}}function KO(m,g){for(;us!==null;){var b=us;switch(b.tag){case 0:case 11:case 15:Sc(8,b,g);break;case 23:case 22:if(b.memoizedState!==null&&b.memoizedState.cachePool!==null){var C=b.memoizedState.cachePool.pool;C!=null&&C.refCount++}break;case 24:Mh(b.memoizedState.cache)}if(C=b.child,C!==null)C.return=b,us=C;else e:for(b=m;us!==null;){C=us;var O=C.sibling,$=C.return;if(FO(C),C===b){us=null;break e}if(O!==null){O.return=$,us=O;break e}us=$}}}var Hte={getCacheForType:function(m){var g=js(Rn),b=g.data.get(m);return b===void 0&&(b=m(),g.data.set(m,b)),b},cacheSignal:function(){return js(Rn).controller.signal}},qte=typeof WeakMap=="function"?WeakMap:Map,Ta=0,Ga=null,ha=null,pa=0,Da=0,Lr=null,_c=!1,Pm=!1,cS=!1,fl=0,wn=0,Ac=0,Yd=0,dS=0,Pr=0,Dm=0,Jh=null,sr=null,uS=!1,dy=0,XO=0,uy=1/0,my=null,Tc=null,Kn=0,kc=null,Om=null,hl=0,mS=0,fS=null,ZO=null,eg=0,hS=null;function Dr(){return(Ta&2)!==0&&pa!==0?pa&-pa:q.T!==null?vS():Ie()}function JO(){if(Pr===0)if((pa&536870912)===0||ba){var m=Tt;Tt<<=1,(Tt&3932160)===0&&(Tt=262144),Pr=m}else Pr=536870912;return m=kr.current,m!==null&&(m.flags|=32),Pr}function rr(m,g,b){(m===Ga&&(Da===2||Da===9)||m.cancelPendingCommit!==null)&&(Mm(m,0),Ec(m,pa,Pr,!1)),W(m,b),((Ta&2)===0||m!==Ga)&&(m===Ga&&((Ta&2)===0&&(Yd|=b),wn===4&&Ec(m,pa,Pr,!1)),lo(m))}function eM(m,g,b){if((Ta&6)!==0)throw Error(s(327));var C=!b&&(g&127)===0&&(g&m.expiredLanes)===0||Oe(m,g),O=C?Vte(m,g):pS(m,g,!0),$=C;do{if(O===0){Pm&&!C&&Ec(m,g,0,!1);break}else{if(b=m.current.alternate,$&&!Gte(b)){O=pS(m,g,!1),$=!1;continue}if(O===2){if($=g,m.errorRecoveryDisabledLanes&$)var te=0;else te=m.pendingLanes&-536870913,te=te!==0?te:te&536870912?536870912:0;if(te!==0){g=te;e:{var Se=m;O=Jh;var Ye=Se.current.memoizedState.isDehydrated;if(Ye&&(Mm(Se,te).flags|=256),te=pS(Se,te,!1),te!==2){if(cS&&!Ye){Se.errorRecoveryDisabledLanes|=$,Yd|=$,O=4;break e}$=sr,sr=O,$!==null&&(sr===null?sr=$:sr.push.apply(sr,$))}O=te}if($=!1,O!==2)continue}}if(O===1){Mm(m,0),Ec(m,g,0,!0);break}e:{switch(C=m,$=O,$){case 0:case 1:throw Error(s(345));case 4:if((g&4194048)!==g)break;case 6:Ec(C,g,Pr,!_c);break e;case 2:sr=null;break;case 3:case 5:break;default:throw Error(s(329))}if((g&62914560)===g&&(O=dy+300-_e(),10<O)){if(Ec(C,g,Pr,!_c),ve(C,0,!0)!==0)break e;hl=g,C.timeoutHandle=LM(tM.bind(null,C,b,sr,my,uS,g,Pr,Yd,Dm,_c,$,"Throttled",-0,0),O);break e}tM(C,b,sr,my,uS,g,Pr,Yd,Dm,_c,$,null,-0,0)}}break}while(!0);lo(m)}function tM(m,g,b,C,O,$,te,Se,Ye,dt,xt,jt,mt,pt){if(m.timeoutHandle=-1,jt=g.subtreeFlags,jt&8192||(jt&16785408)===16785408){jt={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Jo},VO(g,$,jt);var zt=($&62914560)===$?dy-_e():($&4194048)===$?XO-_e():0;if(zt=kae(jt,zt),zt!==null){hl=$,m.cancelPendingCommit=zt(cM.bind(null,m,g,$,b,C,O,te,Se,Ye,xt,jt,null,mt,pt)),Ec(m,$,te,!dt);return}}cM(m,g,$,b,C,O,te,Se,Ye)}function Gte(m){for(var g=m;;){var b=g.tag;if((b===0||b===11||b===15)&&g.flags&16384&&(b=g.updateQueue,b!==null&&(b=b.stores,b!==null)))for(var C=0;C<b.length;C++){var O=b[C],$=O.getSnapshot;O=O.value;try{if(!Ar($(),O))return!1}catch{return!1}}if(b=g.child,g.subtreeFlags&16384&&b!==null)b.return=g,g=b;else{if(g===m)break;for(;g.sibling===null;){if(g.return===null||g.return===m)return!0;g=g.return}g.sibling.return=g.return,g=g.sibling}}return!0}function Ec(m,g,b,C){g&=~dS,g&=~Yd,m.suspendedLanes|=g,m.pingedLanes&=~g,C&&(m.warmLanes|=g),C=m.expirationTimes;for(var O=g;0<O;){var $=31-ot(O),te=1<<$;C[$]=-1,O&=~te}b!==0&&Y(m,b,g)}function fy(){return(Ta&6)===0?(tg(0),!1):!0}function gS(){if(ha!==null){if(Da===0)var m=ha.return;else m=ha,nl=zd=null,LC(m),Sm=null,$h=0,m=ha;for(;m!==null;)PO(m.alternate,m),m=m.return;ha=null}}function Mm(m,g){var b=m.timeoutHandle;b!==-1&&(m.timeoutHandle=-1,uae(b)),b=m.cancelPendingCommit,b!==null&&(m.cancelPendingCommit=null,b()),hl=0,gS(),Ga=m,ha=b=tl(m.current,null),pa=g,Da=0,Lr=null,_c=!1,Pm=Oe(m,g),cS=!1,Dm=Pr=dS=Yd=Ac=wn=0,sr=Jh=null,uS=!1,(g&8)!==0&&(g|=g&32);var C=m.entangledLanes;if(C!==0)for(m=m.entanglements,C&=g;0<C;){var O=31-ot(C),$=1<<O;g|=m[O],C&=~$}return fl=g,O0(),b}function aM(m,g){oa=null,q.H=Gh,g===Cm||g===B0?(g=y5(),Da=3):g===bC?(g=y5(),Da=4):Da=g===VC?8:g!==null&&typeof g=="object"&&typeof g.then=="function"?6:1,Lr=g,ha===null&&(wn=1,ay(m,Jr(g,m.current)))}function nM(){var m=kr.current;return m===null?!0:(pa&4194048)===pa?ni===null:(pa&62914560)===pa||(pa&536870912)!==0?m===ni:!1}function sM(){var m=q.H;return q.H=Gh,m===null?Gh:m}function rM(){var m=q.A;return q.A=Hte,m}function hy(){wn=4,_c||(pa&4194048)!==pa&&kr.current!==null||(Pm=!0),(Ac&134217727)===0&&(Yd&134217727)===0||Ga===null||Ec(Ga,pa,Pr,!1)}function pS(m,g,b){var C=Ta;Ta|=2;var O=sM(),$=rM();(Ga!==m||pa!==g)&&(my=null,Mm(m,g)),g=!1;var te=wn;e:do try{if(Da!==0&&ha!==null){var Se=ha,Ye=Lr;switch(Da){case 8:gS(),te=6;break e;case 3:case 2:case 9:case 6:kr.current===null&&(g=!0);var dt=Da;if(Da=0,Lr=null,Im(m,Se,Ye,dt),b&&Pm){te=0;break e}break;default:dt=Da,Da=0,Lr=null,Im(m,Se,Ye,dt)}}Wte(),te=wn;break}catch(xt){aM(m,xt)}while(!0);return g&&m.shellSuspendCounter++,nl=zd=null,Ta=C,q.H=O,q.A=$,ha===null&&(Ga=null,pa=0,O0()),te}function Wte(){for(;ha!==null;)iM(ha)}function Vte(m,g){var b=Ta;Ta|=2;var C=sM(),O=rM();Ga!==m||pa!==g?(my=null,uy=_e()+500,Mm(m,g)):Pm=Oe(m,g);e:do try{if(Da!==0&&ha!==null){g=ha;var $=Lr;t:switch(Da){case 1:Da=0,Lr=null,Im(m,g,$,1);break;case 2:case 9:if(p5($)){Da=0,Lr=null,oM(g);break}g=function(){Da!==2&&Da!==9||Ga!==m||(Da=7),lo(m)},$.then(g,g);break e;case 3:Da=7;break e;case 4:Da=5;break e;case 7:p5($)?(Da=0,Lr=null,oM(g)):(Da=0,Lr=null,Im(m,g,$,7));break;case 5:var te=null;switch(ha.tag){case 26:te=ha.memoizedState;case 5:case 27:var Se=ha;if(te?WM(te):Se.stateNode.complete){Da=0,Lr=null;var Ye=Se.sibling;if(Ye!==null)ha=Ye;else{var dt=Se.return;dt!==null?(ha=dt,gy(dt)):ha=null}break t}}Da=0,Lr=null,Im(m,g,$,5);break;case 6:Da=0,Lr=null,Im(m,g,$,6);break;case 8:gS(),wn=6;break e;default:throw Error(s(462))}}Yte();break}catch(xt){aM(m,xt)}while(!0);return nl=zd=null,q.H=C,q.A=O,Ta=b,ha!==null?0:(Ga=null,pa=0,O0(),wn)}function Yte(){for(;ha!==null&&!Je();)iM(ha)}function iM(m){var g=EO(m.alternate,m,fl);m.memoizedProps=m.pendingProps,g===null?gy(m):ha=g}function oM(m){var g=m,b=g.alternate;switch(g.tag){case 15:case 0:g=CO(b,g,g.pendingProps,g.type,void 0,pa);break;case 11:g=CO(b,g,g.pendingProps,g.type.render,g.ref,pa);break;case 5:LC(g);default:PO(b,g),g=ha=r5(g,fl),g=EO(b,g,fl)}m.memoizedProps=m.pendingProps,g===null?gy(m):ha=g}function Im(m,g,b,C){nl=zd=null,LC(g),Sm=null,$h=0;var O=g.return;try{if(Ite(m,O,g,b,pa)){wn=1,ay(m,Jr(b,m.current)),ha=null;return}}catch($){if(O!==null)throw ha=O,$;wn=1,ay(m,Jr(b,m.current)),ha=null;return}g.flags&32768?(ba||C===1?m=!0:Pm||(pa&536870912)!==0?m=!1:(_c=m=!0,(C===2||C===9||C===3||C===6)&&(C=kr.current,C!==null&&C.tag===13&&(C.flags|=16384))),lM(g,m)):gy(g)}function gy(m){var g=m;do{if((g.flags&32768)!==0){lM(g,_c);return}m=g.return;var b=zte(g.alternate,g,fl);if(b!==null){ha=b;return}if(g=g.sibling,g!==null){ha=g;return}ha=g=m}while(g!==null);wn===0&&(wn=5)}function lM(m,g){do{var b=Fte(m.alternate,m);if(b!==null){b.flags&=32767,ha=b;return}if(b=m.return,b!==null&&(b.flags|=32768,b.subtreeFlags=0,b.deletions=null),!g&&(m=m.sibling,m!==null)){ha=m;return}ha=m=b}while(m!==null);wn=6,ha=null}function cM(m,g,b,C,O,$,te,Se,Ye){m.cancelPendingCommit=null;do py();while(Kn!==0);if((Ta&6)!==0)throw Error(s(327));if(g!==null){if(g===m.current)throw Error(s(177));if($=g.lanes|g.childLanes,$|=sC,J(m,b,$,te,Se,Ye),m===Ga&&(ha=Ga=null,pa=0),Om=g,kc=m,hl=b,mS=$,fS=O,ZO=C,(g.subtreeFlags&10256)!==0||(g.flags&10256)!==0?(m.callbackNode=null,m.callbackPriority=0,Zte(ne,function(){return hM(),null})):(m.callbackNode=null,m.callbackPriority=0),C=(g.flags&13878)!==0,(g.subtreeFlags&13878)!==0||C){C=q.T,q.T=null,O=Z.p,Z.p=2,te=Ta,Ta|=4;try{Ute(m,g,b)}finally{Ta=te,Z.p=O,q.T=C}}Kn=1,dM(),uM(),mM()}}function dM(){if(Kn===1){Kn=0;var m=kc,g=Om,b=(g.flags&13878)!==0;if((g.subtreeFlags&13878)!==0||b){b=q.T,q.T=null;var C=Z.p;Z.p=2;var O=Ta;Ta|=4;try{qO(g,m);var $=TS,te=K3(m.containerInfo),Se=$.focusedElem,Ye=$.selectionRange;if(te!==Se&&Se&&Se.ownerDocument&&Q3(Se.ownerDocument.documentElement,Se)){if(Ye!==null&&J1(Se)){var dt=Ye.start,xt=Ye.end;if(xt===void 0&&(xt=dt),"selectionStart"in Se)Se.selectionStart=dt,Se.selectionEnd=Math.min(xt,Se.value.length);else{var jt=Se.ownerDocument||document,mt=jt&&jt.defaultView||window;if(mt.getSelection){var pt=mt.getSelection(),zt=Se.textContent.length,Jt=Math.min(Ye.start,zt),Ba=Ye.end===void 0?Jt:Math.min(Ye.end,zt);!pt.extend&&Jt>Ba&&(te=Ba,Ba=Jt,Jt=te);var rt=Y3(Se,Jt),et=Y3(Se,Ba);if(rt&&et&&(pt.rangeCount!==1||pt.anchorNode!==rt.node||pt.anchorOffset!==rt.offset||pt.focusNode!==et.node||pt.focusOffset!==et.offset)){var ct=jt.createRange();ct.setStart(rt.node,rt.offset),pt.removeAllRanges(),Jt>Ba?(pt.addRange(ct),pt.extend(et.node,et.offset)):(ct.setEnd(et.node,et.offset),pt.addRange(ct))}}}}for(jt=[],pt=Se;pt=pt.parentNode;)pt.nodeType===1&&jt.push({element:pt,left:pt.scrollLeft,top:pt.scrollTop});for(typeof Se.focus=="function"&&Se.focus(),Se=0;Se<jt.length;Se++){var bt=jt[Se];bt.element.scrollLeft=bt.left,bt.element.scrollTop=bt.top}}Ty=!!AS,TS=AS=null}finally{Ta=O,Z.p=C,q.T=b}}m.current=g,Kn=2}}function uM(){if(Kn===2){Kn=0;var m=kc,g=Om,b=(g.flags&8772)!==0;if((g.subtreeFlags&8772)!==0||b){b=q.T,q.T=null;var C=Z.p;Z.p=2;var O=Ta;Ta|=4;try{zO(m,g.alternate,g)}finally{Ta=O,Z.p=C,q.T=b}}Kn=3}}function mM(){if(Kn===4||Kn===3){Kn=0,Be();var m=kc,g=Om,b=hl,C=ZO;(g.subtreeFlags&10256)!==0||(g.flags&10256)!==0?Kn=5:(Kn=0,Om=kc=null,fM(m,m.pendingLanes));var O=m.pendingLanes;if(O===0&&(Tc=null),le(b),g=g.stateNode,qe&&typeof qe.onCommitFiberRoot=="function")try{qe.onCommitFiberRoot(He,g,void 0,(g.current.flags&128)===128)}catch{}if(C!==null){g=q.T,O=Z.p,Z.p=2,q.T=null;try{for(var $=m.onRecoverableError,te=0;te<C.length;te++){var Se=C[te];$(Se.value,{componentStack:Se.stack})}}finally{q.T=g,Z.p=O}}(hl&3)!==0&&py(),lo(m),O=m.pendingLanes,(b&261930)!==0&&(O&42)!==0?m===hS?eg++:(eg=0,hS=m):eg=0,tg(0)}}function fM(m,g){(m.pooledCacheLanes&=g)===0&&(g=m.pooledCache,g!=null&&(m.pooledCache=null,Mh(g)))}function py(){return dM(),uM(),mM(),hM()}function hM(){if(Kn!==5)return!1;var m=kc,g=mS;mS=0;var b=le(hl),C=q.T,O=Z.p;try{Z.p=32>b?32:b,q.T=null,b=fS,fS=null;var $=kc,te=hl;if(Kn=0,Om=kc=null,hl=0,(Ta&6)!==0)throw Error(s(331));var Se=Ta;if(Ta|=4,QO($.current),WO($,$.current,te,b),Ta=Se,tg(0,!1),qe&&typeof qe.onPostCommitFiberRoot=="function")try{qe.onPostCommitFiberRoot(He,$)}catch{}return!0}finally{Z.p=O,q.T=C,fM(m,g)}}function gM(m,g,b){g=Jr(b,g),g=WC(m.stateNode,g,2),m=jc(m,g,2),m!==null&&(W(m,2),lo(m))}function Oa(m,g,b){if(m.tag===3)gM(m,m,b);else for(;g!==null;){if(g.tag===3){gM(g,m,b);break}else if(g.tag===1){var C=g.stateNode;if(typeof g.type.getDerivedStateFromError=="function"||typeof C.componentDidCatch=="function"&&(Tc===null||!Tc.has(C))){m=Jr(b,m),b=pO(2),C=jc(g,b,2),C!==null&&(xO(b,C,g,m),W(C,2),lo(C));break}}g=g.return}}function xS(m,g,b){var C=m.pingCache;if(C===null){C=m.pingCache=new qte;var O=new Set;C.set(g,O)}else O=C.get(g),O===void 0&&(O=new Set,C.set(g,O));O.has(b)||(cS=!0,O.add(b),m=Qte.bind(null,m,g,b),g.then(m,m))}function Qte(m,g,b){var C=m.pingCache;C!==null&&C.delete(g),m.pingedLanes|=m.suspendedLanes&b,m.warmLanes&=~b,Ga===m&&(pa&b)===b&&(wn===4||wn===3&&(pa&62914560)===pa&&300>_e()-dy?(Ta&2)===0&&Mm(m,0):dS|=b,Dm===pa&&(Dm=0)),lo(m)}function pM(m,g){g===0&&(g=Qe()),m=Id(m,g),m!==null&&(W(m,g),lo(m))}function Kte(m){var g=m.memoizedState,b=0;g!==null&&(b=g.retryLane),pM(m,b)}function Xte(m,g){var b=0;switch(m.tag){case 31:case 13:var C=m.stateNode,O=m.memoizedState;O!==null&&(b=O.retryLane);break;case 19:C=m.stateNode;break;case 22:C=m.stateNode._retryCache;break;default:throw Error(s(314))}C!==null&&C.delete(g),pM(m,b)}function Zte(m,g){return Xe(m,g)}var xy=null,$m=null,yS=!1,yy=!1,bS=!1,Lc=0;function lo(m){m!==$m&&m.next===null&&($m===null?xy=$m=m:$m=$m.next=m),yy=!0,yS||(yS=!0,eae())}function tg(m,g){if(!bS&&yy){bS=!0;do for(var b=!1,C=xy;C!==null;){if(m!==0){var O=C.pendingLanes;if(O===0)var $=0;else{var te=C.suspendedLanes,Se=C.pingedLanes;$=(1<<31-ot(42|m)+1)-1,$&=O&~(te&~Se),$=$&201326741?$&201326741|1:$?$|2:0}$!==0&&(b=!0,vM(C,$))}else $=pa,$=ve(C,C===Ga?$:0,C.cancelPendingCommit!==null||C.timeoutHandle!==-1),($&3)===0||Oe(C,$)||(b=!0,vM(C,$));C=C.next}while(b);bS=!1}}function Jte(){xM()}function xM(){yy=yS=!1;var m=0;Lc!==0&&dae()&&(m=Lc);for(var g=_e(),b=null,C=xy;C!==null;){var O=C.next,$=yM(C,g);$===0?(C.next=null,b===null?xy=O:b.next=O,O===null&&($m=b)):(b=C,(m!==0||($&3)!==0)&&(yy=!0)),C=O}Kn!==0&&Kn!==5||tg(m),Lc!==0&&(Lc=0)}function yM(m,g){for(var b=m.suspendedLanes,C=m.pingedLanes,O=m.expirationTimes,$=m.pendingLanes&-62914561;0<$;){var te=31-ot($),Se=1<<te,Ye=O[te];Ye===-1?((Se&b)===0||(Se&C)!==0)&&(O[te]=Ce(Se,g)):Ye<=g&&(m.expiredLanes|=Se),$&=~Se}if(g=Ga,b=pa,b=ve(m,m===g?b:0,m.cancelPendingCommit!==null||m.timeoutHandle!==-1),C=m.callbackNode,b===0||m===g&&(Da===2||Da===9)||m.cancelPendingCommit!==null)return C!==null&&C!==null&&Ze(C),m.callbackNode=null,m.callbackPriority=0;if((b&3)===0||Oe(m,b)){if(g=b&-b,g===m.callbackPriority)return g;switch(C!==null&&Ze(C),le(b)){case 2:case 8:b=Q;break;case 32:b=ne;break;case 268435456:b=Pe;break;default:b=ne}return C=bM.bind(null,m),b=Xe(b,C),m.callbackPriority=g,m.callbackNode=b,g}return C!==null&&C!==null&&Ze(C),m.callbackPriority=2,m.callbackNode=null,2}function bM(m,g){if(Kn!==0&&Kn!==5)return m.callbackNode=null,m.callbackPriority=0,null;var b=m.callbackNode;if(py()&&m.callbackNode!==b)return null;var C=pa;return C=ve(m,m===Ga?C:0,m.cancelPendingCommit!==null||m.timeoutHandle!==-1),C===0?null:(eM(m,C,g),yM(m,_e()),m.callbackNode!=null&&m.callbackNode===b?bM.bind(null,m):null)}function vM(m,g){if(py())return null;eM(m,g,!0)}function eae(){mae(function(){(Ta&6)!==0?Xe(ce,Jte):xM()})}function vS(){if(Lc===0){var m=jm;m===0&&(m=Et,Et<<=1,(Et&261888)===0&&(Et=256)),Lc=m}return Lc}function wM(m){return m==null||typeof m=="symbol"||typeof m=="boolean"?null:typeof m=="function"?m:_0(""+m)}function jM(m,g){var b=g.ownerDocument.createElement("input");return b.name=g.name,b.value=g.value,m.id&&b.setAttribute("form",m.id),g.parentNode.insertBefore(b,g),m=new FormData(m),b.parentNode.removeChild(b),m}function tae(m,g,b,C,O){if(g==="submit"&&b&&b.stateNode===O){var $=wM((O[Ke]||null).action),te=C.submitter;te&&(g=(g=te[Ke]||null)?wM(g.formAction):te.getAttribute("formAction"),g!==null&&($=g,te=null));var Se=new E0("action","action",null,C,O);m.push({event:Se,listeners:[{instance:null,listener:function(){if(C.defaultPrevented){if(Lc!==0){var Ye=te?jM(O,te):new FormData(O);FC(b,{pending:!0,data:Ye,method:O.method,action:$},null,Ye)}}else typeof $=="function"&&(Se.preventDefault(),Ye=te?jM(O,te):new FormData(O),FC(b,{pending:!0,data:Ye,method:O.method,action:$},$,Ye))},currentTarget:O}]})}}for(var wS=0;wS<nC.length;wS++){var jS=nC[wS],aae=jS.toLowerCase(),nae=jS[0].toUpperCase()+jS.slice(1);Pi(aae,"on"+nae)}Pi(J3,"onAnimationEnd"),Pi(e5,"onAnimationIteration"),Pi(t5,"onAnimationStart"),Pi("dblclick","onDoubleClick"),Pi("focusin","onFocus"),Pi("focusout","onBlur"),Pi(bte,"onTransitionRun"),Pi(vte,"onTransitionStart"),Pi(wte,"onTransitionCancel"),Pi(a5,"onTransitionEnd"),Yt("onMouseEnter",["mouseout","mouseover"]),Yt("onMouseLeave",["mouseout","mouseover"]),Yt("onPointerEnter",["pointerout","pointerover"]),Yt("onPointerLeave",["pointerout","pointerover"]),At("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),At("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),At("onBeforeInput",["compositionend","keypress","textInput","paste"]),At("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),At("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),At("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ag="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),sae=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(ag));function NM(m,g){g=(g&4)!==0;for(var b=0;b<m.length;b++){var C=m[b],O=C.event;C=C.listeners;e:{var $=void 0;if(g)for(var te=C.length-1;0<=te;te--){var Se=C[te],Ye=Se.instance,dt=Se.currentTarget;if(Se=Se.listener,Ye!==$&&O.isPropagationStopped())break e;$=Se,O.currentTarget=dt;try{$(O)}catch(xt){D0(xt)}O.currentTarget=null,$=Ye}else for(te=0;te<C.length;te++){if(Se=C[te],Ye=Se.instance,dt=Se.currentTarget,Se=Se.listener,Ye!==$&&O.isPropagationStopped())break e;$=Se,O.currentTarget=dt;try{$(O)}catch(xt){D0(xt)}O.currentTarget=null,$=Ye}}}}function ga(m,g){var b=g[Ct];b===void 0&&(b=g[Ct]=new Set);var C=m+"__bubble";b.has(C)||(CM(g,m,2,!1),b.add(C))}function NS(m,g,b){var C=0;g&&(C|=4),CM(b,m,C,g)}var by="_reactListening"+Math.random().toString(36).slice(2);function CS(m){if(!m[by]){m[by]=!0,ft.forEach(function(b){b!=="selectionchange"&&(sae.has(b)||NS(b,!1,m),NS(b,!0,m))});var g=m.nodeType===9?m:m.ownerDocument;g===null||g[by]||(g[by]=!0,NS("selectionchange",!1,g))}}function CM(m,g,b,C){switch(JM(g)){case 2:var O=Pae;break;case 8:O=Dae;break;default:O=zS}b=O.bind(null,g,b,m),O=void 0,!q1||g!=="touchstart"&&g!=="touchmove"&&g!=="wheel"||(O=!0),C?O!==void 0?m.addEventListener(g,b,{capture:!0,passive:O}):m.addEventListener(g,b,!0):O!==void 0?m.addEventListener(g,b,{passive:O}):m.addEventListener(g,b,!1)}function SS(m,g,b,C,O){var $=C;if((g&1)===0&&(g&2)===0&&C!==null)e:for(;;){if(C===null)return;var te=C.tag;if(te===3||te===4){var Se=C.stateNode.containerInfo;if(Se===O)break;if(te===4)for(te=C.return;te!==null;){var Ye=te.tag;if((Ye===3||Ye===4)&&te.stateNode.containerInfo===O)return;te=te.return}for(;Se!==null;){if(te=L(Se),te===null)return;if(Ye=te.tag,Ye===5||Ye===6||Ye===26||Ye===27){C=$=te;continue e}Se=Se.parentNode}}C=C.return}k3(function(){var dt=$,xt=B1(b),jt=[];e:{var mt=n5.get(m);if(mt!==void 0){var pt=E0,zt=m;switch(m){case"keypress":if(T0(b)===0)break e;case"keydown":case"keyup":pt=Xee;break;case"focusin":zt="focus",pt=Y1;break;case"focusout":zt="blur",pt=Y1;break;case"beforeblur":case"afterblur":pt=Y1;break;case"click":if(b.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":pt=P3;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":pt=zee;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":pt=ete;break;case J3:case e5:case t5:pt=Bee;break;case a5:pt=ate;break;case"scroll":case"scrollend":pt=$ee;break;case"wheel":pt=ste;break;case"copy":case"cut":case"paste":pt=qee;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":pt=O3;break;case"toggle":case"beforetoggle":pt=ite}var Jt=(g&4)!==0,Ba=!Jt&&(m==="scroll"||m==="scrollend"),rt=Jt?mt!==null?mt+"Capture":null:mt;Jt=[];for(var et=dt,ct;et!==null;){var bt=et;if(ct=bt.stateNode,bt=bt.tag,bt!==5&&bt!==26&&bt!==27||ct===null||rt===null||(bt=Ch(et,rt),bt!=null&&Jt.push(ng(et,bt,ct))),Ba)break;et=et.return}0<Jt.length&&(mt=new pt(mt,zt,null,b,xt),jt.push({event:mt,listeners:Jt}))}}if((g&7)===0){e:{if(mt=m==="mouseover"||m==="pointerover",pt=m==="mouseout"||m==="pointerout",mt&&b!==U1&&(zt=b.relatedTarget||b.fromElement)&&(L(zt)||zt[gt]))break e;if((pt||mt)&&(mt=xt.window===xt?xt:(mt=xt.ownerDocument)?mt.defaultView||mt.parentWindow:window,pt?(zt=b.relatedTarget||b.toElement,pt=dt,zt=zt?L(zt):null,zt!==null&&(Ba=i(zt),Jt=zt.tag,zt!==Ba||Jt!==5&&Jt!==27&&Jt!==6)&&(zt=null)):(pt=null,zt=dt),pt!==zt)){if(Jt=P3,bt="onMouseLeave",rt="onMouseEnter",et="mouse",(m==="pointerout"||m==="pointerover")&&(Jt=O3,bt="onPointerLeave",rt="onPointerEnter",et="pointer"),Ba=pt==null?mt:Le(pt),ct=zt==null?mt:Le(zt),mt=new Jt(bt,et+"leave",pt,b,xt),mt.target=Ba,mt.relatedTarget=ct,bt=null,L(xt)===dt&&(Jt=new Jt(rt,et+"enter",zt,b,xt),Jt.target=ct,Jt.relatedTarget=Ba,bt=Jt),Ba=bt,pt&&zt)t:{for(Jt=rae,rt=pt,et=zt,ct=0,bt=rt;bt;bt=Jt(bt))ct++;bt=0;for(var Xt=et;Xt;Xt=Jt(Xt))bt++;for(;0<ct-bt;)rt=Jt(rt),ct--;for(;0<bt-ct;)et=Jt(et),bt--;for(;ct--;){if(rt===et||et!==null&&rt===et.alternate){Jt=rt;break t}rt=Jt(rt),et=Jt(et)}Jt=null}else Jt=null;pt!==null&&SM(jt,mt,pt,Jt,!1),zt!==null&&Ba!==null&&SM(jt,Ba,zt,Jt,!0)}}e:{if(mt=dt?Le(dt):window,pt=mt.nodeName&&mt.nodeName.toLowerCase(),pt==="select"||pt==="input"&&mt.type==="file")var Sa=B3;else if(F3(mt))if(H3)Sa=pte;else{Sa=hte;var qt=fte}else pt=mt.nodeName,!pt||pt.toLowerCase()!=="input"||mt.type!=="checkbox"&&mt.type!=="radio"?dt&&F1(dt.elementType)&&(Sa=B3):Sa=gte;if(Sa&&(Sa=Sa(m,dt))){U3(jt,Sa,b,xt);break e}qt&&qt(m,mt,dt),m==="focusout"&&dt&&mt.type==="number"&&dt.memoizedProps.value!=null&&z1(mt,"number",mt.value)}switch(qt=dt?Le(dt):window,m){case"focusin":(F3(qt)||qt.contentEditable==="true")&&(hm=qt,eC=dt,Ph=null);break;case"focusout":Ph=eC=hm=null;break;case"mousedown":tC=!0;break;case"contextmenu":case"mouseup":case"dragend":tC=!1,X3(jt,b,xt);break;case"selectionchange":if(yte)break;case"keydown":case"keyup":X3(jt,b,xt)}var ua;if(K1)e:{switch(m){case"compositionstart":var xa="onCompositionStart";break e;case"compositionend":xa="onCompositionEnd";break e;case"compositionupdate":xa="onCompositionUpdate";break e}xa=void 0}else fm?R3(m,b)&&(xa="onCompositionEnd"):m==="keydown"&&b.keyCode===229&&(xa="onCompositionStart");xa&&(M3&&b.locale!=="ko"&&(fm||xa!=="onCompositionStart"?xa==="onCompositionEnd"&&fm&&(ua=E3()):(gc=xt,G1="value"in gc?gc.value:gc.textContent,fm=!0)),qt=vy(dt,xa),0<qt.length&&(xa=new D3(xa,m,null,b,xt),jt.push({event:xa,listeners:qt}),ua?xa.data=ua:(ua=z3(b),ua!==null&&(xa.data=ua)))),(ua=lte?cte(m,b):dte(m,b))&&(xa=vy(dt,"onBeforeInput"),0<xa.length&&(qt=new D3("onBeforeInput","beforeinput",null,b,xt),jt.push({event:qt,listeners:xa}),qt.data=ua)),tae(jt,m,dt,b,xt)}NM(jt,g)})}function ng(m,g,b){return{instance:m,listener:g,currentTarget:b}}function vy(m,g){for(var b=g+"Capture",C=[];m!==null;){var O=m,$=O.stateNode;if(O=O.tag,O!==5&&O!==26&&O!==27||$===null||(O=Ch(m,b),O!=null&&C.unshift(ng(m,O,$)),O=Ch(m,g),O!=null&&C.push(ng(m,O,$))),m.tag===3)return C;m=m.return}return[]}function rae(m){if(m===null)return null;do m=m.return;while(m&&m.tag!==5&&m.tag!==27);return m||null}function SM(m,g,b,C,O){for(var $=g._reactName,te=[];b!==null&&b!==C;){var Se=b,Ye=Se.alternate,dt=Se.stateNode;if(Se=Se.tag,Ye!==null&&Ye===C)break;Se!==5&&Se!==26&&Se!==27||dt===null||(Ye=dt,O?(dt=Ch(b,$),dt!=null&&te.unshift(ng(b,dt,Ye))):O||(dt=Ch(b,$),dt!=null&&te.push(ng(b,dt,Ye)))),b=b.return}te.length!==0&&m.push({event:g,listeners:te})}var iae=/\r\n?/g,oae=/\u0000|\uFFFD/g;function _M(m){return(typeof m=="string"?m:""+m).replace(iae,`
`).replace(oae,"")}function AM(m,g){return g=_M(g),_M(m)===g}function Ua(m,g,b,C,O,$){switch(b){case"children":typeof C=="string"?g==="body"||g==="textarea"&&C===""||dm(m,C):(typeof C=="number"||typeof C=="bigint")&&g!=="body"&&dm(m,""+C);break;case"className":C0(m,"class",C);break;case"tabIndex":C0(m,"tabindex",C);break;case"dir":case"role":case"viewBox":case"width":case"height":C0(m,b,C);break;case"style":A3(m,C,$);break;case"data":if(g!=="object"){C0(m,"data",C);break}case"src":case"href":if(C===""&&(g!=="a"||b!=="href")){m.removeAttribute(b);break}if(C==null||typeof C=="function"||typeof C=="symbol"||typeof C=="boolean"){m.removeAttribute(b);break}C=_0(""+C),m.setAttribute(b,C);break;case"action":case"formAction":if(typeof C=="function"){m.setAttribute(b,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof $=="function"&&(b==="formAction"?(g!=="input"&&Ua(m,g,"name",O.name,O,null),Ua(m,g,"formEncType",O.formEncType,O,null),Ua(m,g,"formMethod",O.formMethod,O,null),Ua(m,g,"formTarget",O.formTarget,O,null)):(Ua(m,g,"encType",O.encType,O,null),Ua(m,g,"method",O.method,O,null),Ua(m,g,"target",O.target,O,null)));if(C==null||typeof C=="symbol"||typeof C=="boolean"){m.removeAttribute(b);break}C=_0(""+C),m.setAttribute(b,C);break;case"onClick":C!=null&&(m.onclick=Jo);break;case"onScroll":C!=null&&ga("scroll",m);break;case"onScrollEnd":C!=null&&ga("scrollend",m);break;case"dangerouslySetInnerHTML":if(C!=null){if(typeof C!="object"||!("__html"in C))throw Error(s(61));if(b=C.__html,b!=null){if(O.children!=null)throw Error(s(60));m.innerHTML=b}}break;case"multiple":m.multiple=C&&typeof C!="function"&&typeof C!="symbol";break;case"muted":m.muted=C&&typeof C!="function"&&typeof C!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(C==null||typeof C=="function"||typeof C=="boolean"||typeof C=="symbol"){m.removeAttribute("xlink:href");break}b=_0(""+C),m.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",b);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":C!=null&&typeof C!="function"&&typeof C!="symbol"?m.setAttribute(b,""+C):m.removeAttribute(b);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":C&&typeof C!="function"&&typeof C!="symbol"?m.setAttribute(b,""):m.removeAttribute(b);break;case"capture":case"download":C===!0?m.setAttribute(b,""):C!==!1&&C!=null&&typeof C!="function"&&typeof C!="symbol"?m.setAttribute(b,C):m.removeAttribute(b);break;case"cols":case"rows":case"size":case"span":C!=null&&typeof C!="function"&&typeof C!="symbol"&&!isNaN(C)&&1<=C?m.setAttribute(b,C):m.removeAttribute(b);break;case"rowSpan":case"start":C==null||typeof C=="function"||typeof C=="symbol"||isNaN(C)?m.removeAttribute(b):m.setAttribute(b,C);break;case"popover":ga("beforetoggle",m),ga("toggle",m),N0(m,"popover",C);break;case"xlinkActuate":Zo(m,"http://www.w3.org/1999/xlink","xlink:actuate",C);break;case"xlinkArcrole":Zo(m,"http://www.w3.org/1999/xlink","xlink:arcrole",C);break;case"xlinkRole":Zo(m,"http://www.w3.org/1999/xlink","xlink:role",C);break;case"xlinkShow":Zo(m,"http://www.w3.org/1999/xlink","xlink:show",C);break;case"xlinkTitle":Zo(m,"http://www.w3.org/1999/xlink","xlink:title",C);break;case"xlinkType":Zo(m,"http://www.w3.org/1999/xlink","xlink:type",C);break;case"xmlBase":Zo(m,"http://www.w3.org/XML/1998/namespace","xml:base",C);break;case"xmlLang":Zo(m,"http://www.w3.org/XML/1998/namespace","xml:lang",C);break;case"xmlSpace":Zo(m,"http://www.w3.org/XML/1998/namespace","xml:space",C);break;case"is":N0(m,"is",C);break;case"innerText":case"textContent":break;default:(!(2<b.length)||b[0]!=="o"&&b[0]!=="O"||b[1]!=="n"&&b[1]!=="N")&&(b=Mee.get(b)||b,N0(m,b,C))}}function _S(m,g,b,C,O,$){switch(b){case"style":A3(m,C,$);break;case"dangerouslySetInnerHTML":if(C!=null){if(typeof C!="object"||!("__html"in C))throw Error(s(61));if(b=C.__html,b!=null){if(O.children!=null)throw Error(s(60));m.innerHTML=b}}break;case"children":typeof C=="string"?dm(m,C):(typeof C=="number"||typeof C=="bigint")&&dm(m,""+C);break;case"onScroll":C!=null&&ga("scroll",m);break;case"onScrollEnd":C!=null&&ga("scrollend",m);break;case"onClick":C!=null&&(m.onclick=Jo);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!_t.hasOwnProperty(b))e:{if(b[0]==="o"&&b[1]==="n"&&(O=b.endsWith("Capture"),g=b.slice(2,O?b.length-7:void 0),$=m[Ke]||null,$=$!=null?$[b]:null,typeof $=="function"&&m.removeEventListener(g,$,O),typeof C=="function")){typeof $!="function"&&$!==null&&(b in m?m[b]=null:m.hasAttribute(b)&&m.removeAttribute(b)),m.addEventListener(g,C,O);break e}b in m?m[b]=C:C===!0?m.setAttribute(b,""):N0(m,b,C)}}}function Cs(m,g,b){switch(g){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ga("error",m),ga("load",m);var C=!1,O=!1,$;for($ in b)if(b.hasOwnProperty($)){var te=b[$];if(te!=null)switch($){case"src":C=!0;break;case"srcSet":O=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,g));default:Ua(m,g,$,te,b,null)}}O&&Ua(m,g,"srcSet",b.srcSet,b,null),C&&Ua(m,g,"src",b.src,b,null);return;case"input":ga("invalid",m);var Se=$=te=O=null,Ye=null,dt=null;for(C in b)if(b.hasOwnProperty(C)){var xt=b[C];if(xt!=null)switch(C){case"name":O=xt;break;case"type":te=xt;break;case"checked":Ye=xt;break;case"defaultChecked":dt=xt;break;case"value":$=xt;break;case"defaultValue":Se=xt;break;case"children":case"dangerouslySetInnerHTML":if(xt!=null)throw Error(s(137,g));break;default:Ua(m,g,C,xt,b,null)}}N3(m,$,Se,Ye,dt,te,O,!1);return;case"select":ga("invalid",m),C=te=$=null;for(O in b)if(b.hasOwnProperty(O)&&(Se=b[O],Se!=null))switch(O){case"value":$=Se;break;case"defaultValue":te=Se;break;case"multiple":C=Se;default:Ua(m,g,O,Se,b,null)}g=$,b=te,m.multiple=!!C,g!=null?cm(m,!!C,g,!1):b!=null&&cm(m,!!C,b,!0);return;case"textarea":ga("invalid",m),$=O=C=null;for(te in b)if(b.hasOwnProperty(te)&&(Se=b[te],Se!=null))switch(te){case"value":C=Se;break;case"defaultValue":O=Se;break;case"children":$=Se;break;case"dangerouslySetInnerHTML":if(Se!=null)throw Error(s(91));break;default:Ua(m,g,te,Se,b,null)}S3(m,C,O,$);return;case"option":for(Ye in b)b.hasOwnProperty(Ye)&&(C=b[Ye],C!=null)&&(Ye==="selected"?m.selected=C&&typeof C!="function"&&typeof C!="symbol":Ua(m,g,Ye,C,b,null));return;case"dialog":ga("beforetoggle",m),ga("toggle",m),ga("cancel",m),ga("close",m);break;case"iframe":case"object":ga("load",m);break;case"video":case"audio":for(C=0;C<ag.length;C++)ga(ag[C],m);break;case"image":ga("error",m),ga("load",m);break;case"details":ga("toggle",m);break;case"embed":case"source":case"link":ga("error",m),ga("load",m);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(dt in b)if(b.hasOwnProperty(dt)&&(C=b[dt],C!=null))switch(dt){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,g));default:Ua(m,g,dt,C,b,null)}return;default:if(F1(g)){for(xt in b)b.hasOwnProperty(xt)&&(C=b[xt],C!==void 0&&_S(m,g,xt,C,b,void 0));return}}for(Se in b)b.hasOwnProperty(Se)&&(C=b[Se],C!=null&&Ua(m,g,Se,C,b,null))}function lae(m,g,b,C){switch(g){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var O=null,$=null,te=null,Se=null,Ye=null,dt=null,xt=null;for(pt in b){var jt=b[pt];if(b.hasOwnProperty(pt)&&jt!=null)switch(pt){case"checked":break;case"value":break;case"defaultValue":Ye=jt;default:C.hasOwnProperty(pt)||Ua(m,g,pt,null,C,jt)}}for(var mt in C){var pt=C[mt];if(jt=b[mt],C.hasOwnProperty(mt)&&(pt!=null||jt!=null))switch(mt){case"type":$=pt;break;case"name":O=pt;break;case"checked":dt=pt;break;case"defaultChecked":xt=pt;break;case"value":te=pt;break;case"defaultValue":Se=pt;break;case"children":case"dangerouslySetInnerHTML":if(pt!=null)throw Error(s(137,g));break;default:pt!==jt&&Ua(m,g,mt,pt,C,jt)}}R1(m,te,Se,Ye,dt,xt,$,O);return;case"select":pt=te=Se=mt=null;for($ in b)if(Ye=b[$],b.hasOwnProperty($)&&Ye!=null)switch($){case"value":break;case"multiple":pt=Ye;default:C.hasOwnProperty($)||Ua(m,g,$,null,C,Ye)}for(O in C)if($=C[O],Ye=b[O],C.hasOwnProperty(O)&&($!=null||Ye!=null))switch(O){case"value":mt=$;break;case"defaultValue":Se=$;break;case"multiple":te=$;default:$!==Ye&&Ua(m,g,O,$,C,Ye)}g=Se,b=te,C=pt,mt!=null?cm(m,!!b,mt,!1):!!C!=!!b&&(g!=null?cm(m,!!b,g,!0):cm(m,!!b,b?[]:"",!1));return;case"textarea":pt=mt=null;for(Se in b)if(O=b[Se],b.hasOwnProperty(Se)&&O!=null&&!C.hasOwnProperty(Se))switch(Se){case"value":break;case"children":break;default:Ua(m,g,Se,null,C,O)}for(te in C)if(O=C[te],$=b[te],C.hasOwnProperty(te)&&(O!=null||$!=null))switch(te){case"value":mt=O;break;case"defaultValue":pt=O;break;case"children":break;case"dangerouslySetInnerHTML":if(O!=null)throw Error(s(91));break;default:O!==$&&Ua(m,g,te,O,C,$)}C3(m,mt,pt);return;case"option":for(var zt in b)mt=b[zt],b.hasOwnProperty(zt)&&mt!=null&&!C.hasOwnProperty(zt)&&(zt==="selected"?m.selected=!1:Ua(m,g,zt,null,C,mt));for(Ye in C)mt=C[Ye],pt=b[Ye],C.hasOwnProperty(Ye)&&mt!==pt&&(mt!=null||pt!=null)&&(Ye==="selected"?m.selected=mt&&typeof mt!="function"&&typeof mt!="symbol":Ua(m,g,Ye,mt,C,pt));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Jt in b)mt=b[Jt],b.hasOwnProperty(Jt)&&mt!=null&&!C.hasOwnProperty(Jt)&&Ua(m,g,Jt,null,C,mt);for(dt in C)if(mt=C[dt],pt=b[dt],C.hasOwnProperty(dt)&&mt!==pt&&(mt!=null||pt!=null))switch(dt){case"children":case"dangerouslySetInnerHTML":if(mt!=null)throw Error(s(137,g));break;default:Ua(m,g,dt,mt,C,pt)}return;default:if(F1(g)){for(var Ba in b)mt=b[Ba],b.hasOwnProperty(Ba)&&mt!==void 0&&!C.hasOwnProperty(Ba)&&_S(m,g,Ba,void 0,C,mt);for(xt in C)mt=C[xt],pt=b[xt],!C.hasOwnProperty(xt)||mt===pt||mt===void 0&&pt===void 0||_S(m,g,xt,mt,C,pt);return}}for(var rt in b)mt=b[rt],b.hasOwnProperty(rt)&&mt!=null&&!C.hasOwnProperty(rt)&&Ua(m,g,rt,null,C,mt);for(jt in C)mt=C[jt],pt=b[jt],!C.hasOwnProperty(jt)||mt===pt||mt==null&&pt==null||Ua(m,g,jt,mt,C,pt)}function TM(m){switch(m){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function cae(){if(typeof performance.getEntriesByType=="function"){for(var m=0,g=0,b=performance.getEntriesByType("resource"),C=0;C<b.length;C++){var O=b[C],$=O.transferSize,te=O.initiatorType,Se=O.duration;if($&&Se&&TM(te)){for(te=0,Se=O.responseEnd,C+=1;C<b.length;C++){var Ye=b[C],dt=Ye.startTime;if(dt>Se)break;var xt=Ye.transferSize,jt=Ye.initiatorType;xt&&TM(jt)&&(Ye=Ye.responseEnd,te+=xt*(Ye<Se?1:(Se-dt)/(Ye-dt)))}if(--C,g+=8*($+te)/(O.duration/1e3),m++,10<m)break}}if(0<m)return g/m/1e6}return navigator.connection&&(m=navigator.connection.downlink,typeof m=="number")?m:5}var AS=null,TS=null;function wy(m){return m.nodeType===9?m:m.ownerDocument}function kM(m){switch(m){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function EM(m,g){if(m===0)switch(g){case"svg":return 1;case"math":return 2;default:return 0}return m===1&&g==="foreignObject"?0:m}function kS(m,g){return m==="textarea"||m==="noscript"||typeof g.children=="string"||typeof g.children=="number"||typeof g.children=="bigint"||typeof g.dangerouslySetInnerHTML=="object"&&g.dangerouslySetInnerHTML!==null&&g.dangerouslySetInnerHTML.__html!=null}var ES=null;function dae(){var m=window.event;return m&&m.type==="popstate"?m===ES?!1:(ES=m,!0):(ES=null,!1)}var LM=typeof setTimeout=="function"?setTimeout:void 0,uae=typeof clearTimeout=="function"?clearTimeout:void 0,PM=typeof Promise=="function"?Promise:void 0,mae=typeof queueMicrotask=="function"?queueMicrotask:typeof PM<"u"?function(m){return PM.resolve(null).then(m).catch(fae)}:LM;function fae(m){setTimeout(function(){throw m})}function Pc(m){return m==="head"}function DM(m,g){var b=g,C=0;do{var O=b.nextSibling;if(m.removeChild(b),O&&O.nodeType===8)if(b=O.data,b==="/$"||b==="/&"){if(C===0){m.removeChild(O),Um(g);return}C--}else if(b==="$"||b==="$?"||b==="$~"||b==="$!"||b==="&")C++;else if(b==="html")sg(m.ownerDocument.documentElement);else if(b==="head"){b=m.ownerDocument.head,sg(b);for(var $=b.firstChild;$;){var te=$.nextSibling,Se=$.nodeName;$[Ae]||Se==="SCRIPT"||Se==="STYLE"||Se==="LINK"&&$.rel.toLowerCase()==="stylesheet"||b.removeChild($),$=te}}else b==="body"&&sg(m.ownerDocument.body);b=O}while(b);Um(g)}function OM(m,g){var b=m;m=0;do{var C=b.nextSibling;if(b.nodeType===1?g?(b._stashedDisplay=b.style.display,b.style.display="none"):(b.style.display=b._stashedDisplay||"",b.getAttribute("style")===""&&b.removeAttribute("style")):b.nodeType===3&&(g?(b._stashedText=b.nodeValue,b.nodeValue=""):b.nodeValue=b._stashedText||""),C&&C.nodeType===8)if(b=C.data,b==="/$"){if(m===0)break;m--}else b!=="$"&&b!=="$?"&&b!=="$~"&&b!=="$!"||m++;b=C}while(b)}function LS(m){var g=m.firstChild;for(g&&g.nodeType===10&&(g=g.nextSibling);g;){var b=g;switch(g=g.nextSibling,b.nodeName){case"HTML":case"HEAD":case"BODY":LS(b),I(b);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(b.rel.toLowerCase()==="stylesheet")continue}m.removeChild(b)}}function hae(m,g,b,C){for(;m.nodeType===1;){var O=b;if(m.nodeName.toLowerCase()!==g.toLowerCase()){if(!C&&(m.nodeName!=="INPUT"||m.type!=="hidden"))break}else if(C){if(!m[Ae])switch(g){case"meta":if(!m.hasAttribute("itemprop"))break;return m;case"link":if($=m.getAttribute("rel"),$==="stylesheet"&&m.hasAttribute("data-precedence"))break;if($!==O.rel||m.getAttribute("href")!==(O.href==null||O.href===""?null:O.href)||m.getAttribute("crossorigin")!==(O.crossOrigin==null?null:O.crossOrigin)||m.getAttribute("title")!==(O.title==null?null:O.title))break;return m;case"style":if(m.hasAttribute("data-precedence"))break;return m;case"script":if($=m.getAttribute("src"),($!==(O.src==null?null:O.src)||m.getAttribute("type")!==(O.type==null?null:O.type)||m.getAttribute("crossorigin")!==(O.crossOrigin==null?null:O.crossOrigin))&&$&&m.hasAttribute("async")&&!m.hasAttribute("itemprop"))break;return m;default:return m}}else if(g==="input"&&m.type==="hidden"){var $=O.name==null?null:""+O.name;if(O.type==="hidden"&&m.getAttribute("name")===$)return m}else return m;if(m=si(m.nextSibling),m===null)break}return null}function gae(m,g,b){if(g==="")return null;for(;m.nodeType!==3;)if((m.nodeType!==1||m.nodeName!=="INPUT"||m.type!=="hidden")&&!b||(m=si(m.nextSibling),m===null))return null;return m}function MM(m,g){for(;m.nodeType!==8;)if((m.nodeType!==1||m.nodeName!=="INPUT"||m.type!=="hidden")&&!g||(m=si(m.nextSibling),m===null))return null;return m}function PS(m){return m.data==="$?"||m.data==="$~"}function DS(m){return m.data==="$!"||m.data==="$?"&&m.ownerDocument.readyState!=="loading"}function pae(m,g){var b=m.ownerDocument;if(m.data==="$~")m._reactRetry=g;else if(m.data!=="$?"||b.readyState!=="loading")g();else{var C=function(){g(),b.removeEventListener("DOMContentLoaded",C)};b.addEventListener("DOMContentLoaded",C),m._reactRetry=C}}function si(m){for(;m!=null;m=m.nextSibling){var g=m.nodeType;if(g===1||g===3)break;if(g===8){if(g=m.data,g==="$"||g==="$!"||g==="$?"||g==="$~"||g==="&"||g==="F!"||g==="F")break;if(g==="/$"||g==="/&")return null}}return m}var OS=null;function IM(m){m=m.nextSibling;for(var g=0;m;){if(m.nodeType===8){var b=m.data;if(b==="/$"||b==="/&"){if(g===0)return si(m.nextSibling);g--}else b!=="$"&&b!=="$!"&&b!=="$?"&&b!=="$~"&&b!=="&"||g++}m=m.nextSibling}return null}function $M(m){m=m.previousSibling;for(var g=0;m;){if(m.nodeType===8){var b=m.data;if(b==="$"||b==="$!"||b==="$?"||b==="$~"||b==="&"){if(g===0)return m;g--}else b!=="/$"&&b!=="/&"||g++}m=m.previousSibling}return null}function RM(m,g,b){switch(g=wy(b),m){case"html":if(m=g.documentElement,!m)throw Error(s(452));return m;case"head":if(m=g.head,!m)throw Error(s(453));return m;case"body":if(m=g.body,!m)throw Error(s(454));return m;default:throw Error(s(451))}}function sg(m){for(var g=m.attributes;g.length;)m.removeAttributeNode(g[0]);I(m)}var ri=new Map,zM=new Set;function jy(m){return typeof m.getRootNode=="function"?m.getRootNode():m.nodeType===9?m:m.ownerDocument}var gl=Z.d;Z.d={f:xae,r:yae,D:bae,C:vae,L:wae,m:jae,X:Cae,S:Nae,M:Sae};function xae(){var m=gl.f(),g=fy();return m||g}function yae(m){var g=ee(m);g!==null&&g.tag===5&&g.type==="form"?aO(g):gl.r(m)}var Rm=typeof document>"u"?null:document;function FM(m,g,b){var C=Rm;if(C&&typeof g=="string"&&g){var O=Xr(g);O='link[rel="'+m+'"][href="'+O+'"]',typeof b=="string"&&(O+='[crossorigin="'+b+'"]'),zM.has(O)||(zM.add(O),m={rel:m,crossOrigin:b,href:g},C.querySelector(O)===null&&(g=C.createElement("link"),Cs(g,"link",m),Ve(g),C.head.appendChild(g)))}}function bae(m){gl.D(m),FM("dns-prefetch",m,null)}function vae(m,g){gl.C(m,g),FM("preconnect",m,g)}function wae(m,g,b){gl.L(m,g,b);var C=Rm;if(C&&m&&g){var O='link[rel="preload"][as="'+Xr(g)+'"]';g==="image"&&b&&b.imageSrcSet?(O+='[imagesrcset="'+Xr(b.imageSrcSet)+'"]',typeof b.imageSizes=="string"&&(O+='[imagesizes="'+Xr(b.imageSizes)+'"]')):O+='[href="'+Xr(m)+'"]';var $=O;switch(g){case"style":$=zm(m);break;case"script":$=Fm(m)}ri.has($)||(m=h({rel:"preload",href:g==="image"&&b&&b.imageSrcSet?void 0:m,as:g},b),ri.set($,m),C.querySelector(O)!==null||g==="style"&&C.querySelector(rg($))||g==="script"&&C.querySelector(ig($))||(g=C.createElement("link"),Cs(g,"link",m),Ve(g),C.head.appendChild(g)))}}function jae(m,g){gl.m(m,g);var b=Rm;if(b&&m){var C=g&&typeof g.as=="string"?g.as:"script",O='link[rel="modulepreload"][as="'+Xr(C)+'"][href="'+Xr(m)+'"]',$=O;switch(C){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":$=Fm(m)}if(!ri.has($)&&(m=h({rel:"modulepreload",href:m},g),ri.set($,m),b.querySelector(O)===null)){switch(C){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(b.querySelector(ig($)))return}C=b.createElement("link"),Cs(C,"link",m),Ve(C),b.head.appendChild(C)}}}function Nae(m,g,b){gl.S(m,g,b);var C=Rm;if(C&&m){var O=ze(C).hoistableStyles,$=zm(m);g=g||"default";var te=O.get($);if(!te){var Se={loading:0,preload:null};if(te=C.querySelector(rg($)))Se.loading=5;else{m=h({rel:"stylesheet",href:m,"data-precedence":g},b),(b=ri.get($))&&MS(m,b);var Ye=te=C.createElement("link");Ve(Ye),Cs(Ye,"link",m),Ye._p=new Promise(function(dt,xt){Ye.onload=dt,Ye.onerror=xt}),Ye.addEventListener("load",function(){Se.loading|=1}),Ye.addEventListener("error",function(){Se.loading|=2}),Se.loading|=4,Ny(te,g,C)}te={type:"stylesheet",instance:te,count:1,state:Se},O.set($,te)}}}function Cae(m,g){gl.X(m,g);var b=Rm;if(b&&m){var C=ze(b).hoistableScripts,O=Fm(m),$=C.get(O);$||($=b.querySelector(ig(O)),$||(m=h({src:m,async:!0},g),(g=ri.get(O))&&IS(m,g),$=b.createElement("script"),Ve($),Cs($,"link",m),b.head.appendChild($)),$={type:"script",instance:$,count:1,state:null},C.set(O,$))}}function Sae(m,g){gl.M(m,g);var b=Rm;if(b&&m){var C=ze(b).hoistableScripts,O=Fm(m),$=C.get(O);$||($=b.querySelector(ig(O)),$||(m=h({src:m,async:!0,type:"module"},g),(g=ri.get(O))&&IS(m,g),$=b.createElement("script"),Ve($),Cs($,"link",m),b.head.appendChild($)),$={type:"script",instance:$,count:1,state:null},C.set(O,$))}}function UM(m,g,b,C){var O=(O=we.current)?jy(O):null;if(!O)throw Error(s(446));switch(m){case"meta":case"title":return null;case"style":return typeof b.precedence=="string"&&typeof b.href=="string"?(g=zm(b.href),b=ze(O).hoistableStyles,C=b.get(g),C||(C={type:"style",instance:null,count:0,state:null},b.set(g,C)),C):{type:"void",instance:null,count:0,state:null};case"link":if(b.rel==="stylesheet"&&typeof b.href=="string"&&typeof b.precedence=="string"){m=zm(b.href);var $=ze(O).hoistableStyles,te=$.get(m);if(te||(O=O.ownerDocument||O,te={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},$.set(m,te),($=O.querySelector(rg(m)))&&!$._p&&(te.instance=$,te.state.loading=5),ri.has(m)||(b={rel:"preload",as:"style",href:b.href,crossOrigin:b.crossOrigin,integrity:b.integrity,media:b.media,hrefLang:b.hrefLang,referrerPolicy:b.referrerPolicy},ri.set(m,b),$||_ae(O,m,b,te.state))),g&&C===null)throw Error(s(528,""));return te}if(g&&C!==null)throw Error(s(529,""));return null;case"script":return g=b.async,b=b.src,typeof b=="string"&&g&&typeof g!="function"&&typeof g!="symbol"?(g=Fm(b),b=ze(O).hoistableScripts,C=b.get(g),C||(C={type:"script",instance:null,count:0,state:null},b.set(g,C)),C):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,m))}}function zm(m){return'href="'+Xr(m)+'"'}function rg(m){return'link[rel="stylesheet"]['+m+"]"}function BM(m){return h({},m,{"data-precedence":m.precedence,precedence:null})}function _ae(m,g,b,C){m.querySelector('link[rel="preload"][as="style"]['+g+"]")?C.loading=1:(g=m.createElement("link"),C.preload=g,g.addEventListener("load",function(){return C.loading|=1}),g.addEventListener("error",function(){return C.loading|=2}),Cs(g,"link",b),Ve(g),m.head.appendChild(g))}function Fm(m){return'[src="'+Xr(m)+'"]'}function ig(m){return"script[async]"+m}function HM(m,g,b){if(g.count++,g.instance===null)switch(g.type){case"style":var C=m.querySelector('style[data-href~="'+Xr(b.href)+'"]');if(C)return g.instance=C,Ve(C),C;var O=h({},b,{"data-href":b.href,"data-precedence":b.precedence,href:null,precedence:null});return C=(m.ownerDocument||m).createElement("style"),Ve(C),Cs(C,"style",O),Ny(C,b.precedence,m),g.instance=C;case"stylesheet":O=zm(b.href);var $=m.querySelector(rg(O));if($)return g.state.loading|=4,g.instance=$,Ve($),$;C=BM(b),(O=ri.get(O))&&MS(C,O),$=(m.ownerDocument||m).createElement("link"),Ve($);var te=$;return te._p=new Promise(function(Se,Ye){te.onload=Se,te.onerror=Ye}),Cs($,"link",C),g.state.loading|=4,Ny($,b.precedence,m),g.instance=$;case"script":return $=Fm(b.src),(O=m.querySelector(ig($)))?(g.instance=O,Ve(O),O):(C=b,(O=ri.get($))&&(C=h({},b),IS(C,O)),m=m.ownerDocument||m,O=m.createElement("script"),Ve(O),Cs(O,"link",C),m.head.appendChild(O),g.instance=O);case"void":return null;default:throw Error(s(443,g.type))}else g.type==="stylesheet"&&(g.state.loading&4)===0&&(C=g.instance,g.state.loading|=4,Ny(C,b.precedence,m));return g.instance}function Ny(m,g,b){for(var C=b.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),O=C.length?C[C.length-1]:null,$=O,te=0;te<C.length;te++){var Se=C[te];if(Se.dataset.precedence===g)$=Se;else if($!==O)break}$?$.parentNode.insertBefore(m,$.nextSibling):(g=b.nodeType===9?b.head:b,g.insertBefore(m,g.firstChild))}function MS(m,g){m.crossOrigin==null&&(m.crossOrigin=g.crossOrigin),m.referrerPolicy==null&&(m.referrerPolicy=g.referrerPolicy),m.title==null&&(m.title=g.title)}function IS(m,g){m.crossOrigin==null&&(m.crossOrigin=g.crossOrigin),m.referrerPolicy==null&&(m.referrerPolicy=g.referrerPolicy),m.integrity==null&&(m.integrity=g.integrity)}var Cy=null;function qM(m,g,b){if(Cy===null){var C=new Map,O=Cy=new Map;O.set(b,C)}else O=Cy,C=O.get(b),C||(C=new Map,O.set(b,C));if(C.has(m))return C;for(C.set(m,null),b=b.getElementsByTagName(m),O=0;O<b.length;O++){var $=b[O];if(!($[Ae]||$[Me]||m==="link"&&$.getAttribute("rel")==="stylesheet")&&$.namespaceURI!=="http://www.w3.org/2000/svg"){var te=$.getAttribute(g)||"";te=m+te;var Se=C.get(te);Se?Se.push($):C.set(te,[$])}}return C}function GM(m,g,b){m=m.ownerDocument||m,m.head.insertBefore(b,g==="title"?m.querySelector("head > title"):null)}function Aae(m,g,b){if(b===1||g.itemProp!=null)return!1;switch(m){case"meta":case"title":return!0;case"style":if(typeof g.precedence!="string"||typeof g.href!="string"||g.href==="")break;return!0;case"link":if(typeof g.rel!="string"||typeof g.href!="string"||g.href===""||g.onLoad||g.onError)break;return g.rel==="stylesheet"?(m=g.disabled,typeof g.precedence=="string"&&m==null):!0;case"script":if(g.async&&typeof g.async!="function"&&typeof g.async!="symbol"&&!g.onLoad&&!g.onError&&g.src&&typeof g.src=="string")return!0}return!1}function WM(m){return!(m.type==="stylesheet"&&(m.state.loading&3)===0)}function Tae(m,g,b,C){if(b.type==="stylesheet"&&(typeof C.media!="string"||matchMedia(C.media).matches!==!1)&&(b.state.loading&4)===0){if(b.instance===null){var O=zm(C.href),$=g.querySelector(rg(O));if($){g=$._p,g!==null&&typeof g=="object"&&typeof g.then=="function"&&(m.count++,m=Sy.bind(m),g.then(m,m)),b.state.loading|=4,b.instance=$,Ve($);return}$=g.ownerDocument||g,C=BM(C),(O=ri.get(O))&&MS(C,O),$=$.createElement("link"),Ve($);var te=$;te._p=new Promise(function(Se,Ye){te.onload=Se,te.onerror=Ye}),Cs($,"link",C),b.instance=$}m.stylesheets===null&&(m.stylesheets=new Map),m.stylesheets.set(b,g),(g=b.state.preload)&&(b.state.loading&3)===0&&(m.count++,b=Sy.bind(m),g.addEventListener("load",b),g.addEventListener("error",b))}}var $S=0;function kae(m,g){return m.stylesheets&&m.count===0&&Ay(m,m.stylesheets),0<m.count||0<m.imgCount?function(b){var C=setTimeout(function(){if(m.stylesheets&&Ay(m,m.stylesheets),m.unsuspend){var $=m.unsuspend;m.unsuspend=null,$()}},6e4+g);0<m.imgBytes&&$S===0&&($S=62500*cae());var O=setTimeout(function(){if(m.waitingForImages=!1,m.count===0&&(m.stylesheets&&Ay(m,m.stylesheets),m.unsuspend)){var $=m.unsuspend;m.unsuspend=null,$()}},(m.imgBytes>$S?50:800)+g);return m.unsuspend=b,function(){m.unsuspend=null,clearTimeout(C),clearTimeout(O)}}:null}function Sy(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Ay(this,this.stylesheets);else if(this.unsuspend){var m=this.unsuspend;this.unsuspend=null,m()}}}var _y=null;function Ay(m,g){m.stylesheets=null,m.unsuspend!==null&&(m.count++,_y=new Map,g.forEach(Eae,m),_y=null,Sy.call(m))}function Eae(m,g){if(!(g.state.loading&4)){var b=_y.get(m);if(b)var C=b.get(null);else{b=new Map,_y.set(m,b);for(var O=m.querySelectorAll("link[data-precedence],style[data-precedence]"),$=0;$<O.length;$++){var te=O[$];(te.nodeName==="LINK"||te.getAttribute("media")!=="not all")&&(b.set(te.dataset.precedence,te),C=te)}C&&b.set(null,C)}O=g.instance,te=O.getAttribute("data-precedence"),$=b.get(te)||C,$===C&&b.set(null,O),b.set(te,O),this.count++,C=Sy.bind(this),O.addEventListener("load",C),O.addEventListener("error",C),$?$.parentNode.insertBefore(O,$.nextSibling):(m=m.nodeType===9?m.head:m,m.insertBefore(O,m.firstChild)),g.state.loading|=4}}var og={$$typeof:S,Provider:null,Consumer:null,_currentValue:V,_currentValue2:V,_threadCount:0};function Lae(m,g,b,C,O,$,te,Se,Ye){this.tag=1,this.containerInfo=m,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=G(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=G(0),this.hiddenUpdates=G(null),this.identifierPrefix=C,this.onUncaughtError=O,this.onCaughtError=$,this.onRecoverableError=te,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Ye,this.incompleteTransitions=new Map}function VM(m,g,b,C,O,$,te,Se,Ye,dt,xt,jt){return m=new Lae(m,g,b,te,Ye,dt,xt,jt,Se),g=1,$===!0&&(g|=24),$=Tr(3,null,null,g),m.current=$,$.stateNode=m,g=pC(),g.refCount++,m.pooledCache=g,g.refCount++,$.memoizedState={element:C,isDehydrated:b,cache:g},vC($),m}function YM(m){return m?(m=xm,m):xm}function QM(m,g,b,C,O,$){O=YM(O),C.context===null?C.context=O:C.pendingContext=O,C=wc(g),C.payload={element:b},$=$===void 0?null:$,$!==null&&(C.callback=$),b=jc(m,C,g),b!==null&&(rr(b,m,g),zh(b,m,g))}function KM(m,g){if(m=m.memoizedState,m!==null&&m.dehydrated!==null){var b=m.retryLane;m.retryLane=b!==0&&b<g?b:g}}function RS(m,g){KM(m,g),(m=m.alternate)&&KM(m,g)}function XM(m){if(m.tag===13||m.tag===31){var g=Id(m,67108864);g!==null&&rr(g,m,67108864),RS(m,67108864)}}function ZM(m){if(m.tag===13||m.tag===31){var g=Dr();g=De(g);var b=Id(m,g);b!==null&&rr(b,m,g),RS(m,g)}}var Ty=!0;function Pae(m,g,b,C){var O=q.T;q.T=null;var $=Z.p;try{Z.p=2,zS(m,g,b,C)}finally{Z.p=$,q.T=O}}function Dae(m,g,b,C){var O=q.T;q.T=null;var $=Z.p;try{Z.p=8,zS(m,g,b,C)}finally{Z.p=$,q.T=O}}function zS(m,g,b,C){if(Ty){var O=FS(C);if(O===null)SS(m,g,C,ky,b),eI(m,C);else if(Mae(O,m,g,b,C))C.stopPropagation();else if(eI(m,C),g&4&&-1<Oae.indexOf(m)){for(;O!==null;){var $=ee(O);if($!==null)switch($.tag){case 3:if($=$.stateNode,$.current.memoizedState.isDehydrated){var te=xe($.pendingLanes);if(te!==0){var Se=$;for(Se.pendingLanes|=2,Se.entangledLanes|=2;te;){var Ye=1<<31-ot(te);Se.entanglements[1]|=Ye,te&=~Ye}lo($),(Ta&6)===0&&(uy=_e()+500,tg(0))}}break;case 31:case 13:Se=Id($,2),Se!==null&&rr(Se,$,2),fy(),RS($,2)}if($=FS(C),$===null&&SS(m,g,C,ky,b),$===O)break;O=$}O!==null&&C.stopPropagation()}else SS(m,g,C,null,b)}}function FS(m){return m=B1(m),US(m)}var ky=null;function US(m){if(ky=null,m=L(m),m!==null){var g=i(m);if(g===null)m=null;else{var b=g.tag;if(b===13){if(m=o(g),m!==null)return m;m=null}else if(b===31){if(m=l(g),m!==null)return m;m=null}else if(b===3){if(g.stateNode.current.memoizedState.isDehydrated)return g.tag===3?g.stateNode.containerInfo:null;m=null}else g!==m&&(m=null)}}return ky=m,null}function JM(m){switch(m){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(pe()){case ce:return 2;case Q:return 8;case ne:case ae:return 32;case Pe:return 268435456;default:return 32}default:return 32}}var BS=!1,Dc=null,Oc=null,Mc=null,lg=new Map,cg=new Map,Ic=[],Oae="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function eI(m,g){switch(m){case"focusin":case"focusout":Dc=null;break;case"dragenter":case"dragleave":Oc=null;break;case"mouseover":case"mouseout":Mc=null;break;case"pointerover":case"pointerout":lg.delete(g.pointerId);break;case"gotpointercapture":case"lostpointercapture":cg.delete(g.pointerId)}}function dg(m,g,b,C,O,$){return m===null||m.nativeEvent!==$?(m={blockedOn:g,domEventName:b,eventSystemFlags:C,nativeEvent:$,targetContainers:[O]},g!==null&&(g=ee(g),g!==null&&XM(g)),m):(m.eventSystemFlags|=C,g=m.targetContainers,O!==null&&g.indexOf(O)===-1&&g.push(O),m)}function Mae(m,g,b,C,O){switch(g){case"focusin":return Dc=dg(Dc,m,g,b,C,O),!0;case"dragenter":return Oc=dg(Oc,m,g,b,C,O),!0;case"mouseover":return Mc=dg(Mc,m,g,b,C,O),!0;case"pointerover":var $=O.pointerId;return lg.set($,dg(lg.get($)||null,m,g,b,C,O)),!0;case"gotpointercapture":return $=O.pointerId,cg.set($,dg(cg.get($)||null,m,g,b,C,O)),!0}return!1}function tI(m){var g=L(m.target);if(g!==null){var b=i(g);if(b!==null){if(g=b.tag,g===13){if(g=o(b),g!==null){m.blockedOn=g,K(m.priority,function(){ZM(b)});return}}else if(g===31){if(g=l(b),g!==null){m.blockedOn=g,K(m.priority,function(){ZM(b)});return}}else if(g===3&&b.stateNode.current.memoizedState.isDehydrated){m.blockedOn=b.tag===3?b.stateNode.containerInfo:null;return}}}m.blockedOn=null}function Ey(m){if(m.blockedOn!==null)return!1;for(var g=m.targetContainers;0<g.length;){var b=FS(m.nativeEvent);if(b===null){b=m.nativeEvent;var C=new b.constructor(b.type,b);U1=C,b.target.dispatchEvent(C),U1=null}else return g=ee(b),g!==null&&XM(g),m.blockedOn=b,!1;g.shift()}return!0}function aI(m,g,b){Ey(m)&&b.delete(g)}function Iae(){BS=!1,Dc!==null&&Ey(Dc)&&(Dc=null),Oc!==null&&Ey(Oc)&&(Oc=null),Mc!==null&&Ey(Mc)&&(Mc=null),lg.forEach(aI),cg.forEach(aI)}function Ly(m,g){m.blockedOn===g&&(m.blockedOn=null,BS||(BS=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Iae)))}var Py=null;function nI(m){Py!==m&&(Py=m,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){Py===m&&(Py=null);for(var g=0;g<m.length;g+=3){var b=m[g],C=m[g+1],O=m[g+2];if(typeof C!="function"){if(US(C||b)===null)continue;break}var $=ee(b);$!==null&&(m.splice(g,3),g-=3,FC($,{pending:!0,data:O,method:b.method,action:C},C,O))}}))}function Um(m){function g(Ye){return Ly(Ye,m)}Dc!==null&&Ly(Dc,m),Oc!==null&&Ly(Oc,m),Mc!==null&&Ly(Mc,m),lg.forEach(g),cg.forEach(g);for(var b=0;b<Ic.length;b++){var C=Ic[b];C.blockedOn===m&&(C.blockedOn=null)}for(;0<Ic.length&&(b=Ic[0],b.blockedOn===null);)tI(b),b.blockedOn===null&&Ic.shift();if(b=(m.ownerDocument||m).$$reactFormReplay,b!=null)for(C=0;C<b.length;C+=3){var O=b[C],$=b[C+1],te=O[Ke]||null;if(typeof $=="function")te||nI(b);else if(te){var Se=null;if($&&$.hasAttribute("formAction")){if(O=$,te=$[Ke]||null)Se=te.formAction;else if(US(O)!==null)continue}else Se=te.action;typeof Se=="function"?b[C+1]=Se:(b.splice(C,3),C-=3),nI(b)}}}function sI(){function m($){$.canIntercept&&$.info==="react-transition"&&$.intercept({handler:function(){return new Promise(function(te){return O=te})},focusReset:"manual",scroll:"manual"})}function g(){O!==null&&(O(),O=null),C||setTimeout(b,20)}function b(){if(!C&&!navigation.transition){var $=navigation.currentEntry;$&&$.url!=null&&navigation.navigate($.url,{state:$.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var C=!1,O=null;return navigation.addEventListener("navigate",m),navigation.addEventListener("navigatesuccess",g),navigation.addEventListener("navigateerror",g),setTimeout(b,100),function(){C=!0,navigation.removeEventListener("navigate",m),navigation.removeEventListener("navigatesuccess",g),navigation.removeEventListener("navigateerror",g),O!==null&&(O(),O=null)}}}function HS(m){this._internalRoot=m}Dy.prototype.render=HS.prototype.render=function(m){var g=this._internalRoot;if(g===null)throw Error(s(409));var b=g.current,C=Dr();QM(b,C,m,g,null,null)},Dy.prototype.unmount=HS.prototype.unmount=function(){var m=this._internalRoot;if(m!==null){this._internalRoot=null;var g=m.containerInfo;QM(m.current,2,null,m,null,null),fy(),g[gt]=null}};function Dy(m){this._internalRoot=m}Dy.prototype.unstable_scheduleHydration=function(m){if(m){var g=Ie();m={blockedOn:null,target:m,priority:g};for(var b=0;b<Ic.length&&g!==0&&g<Ic[b].priority;b++);Ic.splice(b,0,m),b===0&&tI(m)}};var rI=t.version;if(rI!=="19.2.0")throw Error(s(527,rI,"19.2.0"));Z.findDOMNode=function(m){var g=m._reactInternals;if(g===void 0)throw typeof m.render=="function"?Error(s(188)):(m=Object.keys(m).join(","),Error(s(268,m)));return m=u(g),m=m!==null?d(m):null,m=m===null?null:m.stateNode,m};var $ae={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:q,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Oy=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Oy.isDisabled&&Oy.supportsFiber)try{He=Oy.inject($ae),qe=Oy}catch{}}return mg.createRoot=function(m,g){if(!r(m))throw Error(s(299));var b=!1,C="",O=mO,$=fO,te=hO;return g!=null&&(g.unstable_strictMode===!0&&(b=!0),g.identifierPrefix!==void 0&&(C=g.identifierPrefix),g.onUncaughtError!==void 0&&(O=g.onUncaughtError),g.onCaughtError!==void 0&&($=g.onCaughtError),g.onRecoverableError!==void 0&&(te=g.onRecoverableError)),g=VM(m,1,!1,null,null,b,C,null,O,$,te,sI),m[gt]=g.current,CS(m),new HS(g)},mg.hydrateRoot=function(m,g,b){if(!r(m))throw Error(s(299));var C=!1,O="",$=mO,te=fO,Se=hO,Ye=null;return b!=null&&(b.unstable_strictMode===!0&&(C=!0),b.identifierPrefix!==void 0&&(O=b.identifierPrefix),b.onUncaughtError!==void 0&&($=b.onUncaughtError),b.onCaughtError!==void 0&&(te=b.onCaughtError),b.onRecoverableError!==void 0&&(Se=b.onRecoverableError),b.formState!==void 0&&(Ye=b.formState)),g=VM(m,1,!0,g,b??null,C,O,Ye,$,te,Se,sI),g.context=YM(null),b=g.current,C=Dr(),C=De(C),O=wc(C),O.callback=null,jc(b,O,C),b=C,g.current.lanes=b,W(g,b),lo(g),m[gt]=g.current,CS(m),new Dy(g)},mg.version="19.2.0",mg}var gI;function Vae(){if(gI)return WS.exports;gI=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),WS.exports=Wae(),WS.exports}var Yae=Vae();var pI="popstate";function Qae(e={}){function t(s,r){let{pathname:i,search:o,hash:l}=s.location;return qT("",{pathname:i,search:o,hash:l},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function n(s,r){return typeof r=="string"?r:pp(r)}return Xae(t,n,null,e)}function mn(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function bi(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function Kae(){return Math.random().toString(36).substring(2,10)}function xI(e,t){return{usr:e.state,key:e.key,idx:t}}function qT(e,t,n=null,s){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?Yf(t):t,state:n,key:t&&t.key||s||Kae()}}function pp({pathname:e="/",search:t="",hash:n=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function Yf(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substring(n),e=e.substring(0,n));let s=e.indexOf("?");s>=0&&(t.search=e.substring(s),e=e.substring(0,s)),e&&(t.pathname=e)}return t}function Xae(e,t,n,s={}){let{window:r=document.defaultView,v5Compat:i=!1}=s,o=r.history,l="POP",c=null,u=d();u==null&&(u=0,o.replaceState({...o.state,idx:u},""));function d(){return(o.state||{idx:null}).idx}function h(){l="POP";let y=d(),N=y==null?null:y-u;u=y,c&&c({action:l,location:j.location,delta:N})}function p(y,N){l="PUSH";let w=qT(j.location,y,N);u=d()+1;let S=xI(w,u),_=j.createHref(w);try{o.pushState(S,"",_)}catch(k){if(k instanceof DOMException&&k.name==="DataCloneError")throw k;r.location.assign(_)}i&&c&&c({action:l,location:j.location,delta:1})}function x(y,N){l="REPLACE";let w=qT(j.location,y,N);u=d();let S=xI(w,u),_=j.createHref(w);o.replaceState(S,"",_),i&&c&&c({action:l,location:j.location,delta:0})}function v(y){return Zae(y)}let j={get action(){return l},get location(){return e(r,o)},listen(y){if(c)throw new Error("A history only accepts one active listener");return r.addEventListener(pI,h),c=y,()=>{r.removeEventListener(pI,h),c=null}},createHref(y){return t(r,y)},createURL:v,encodeLocation(y){let N=v(y);return{pathname:N.pathname,search:N.search,hash:N.hash}},push:p,replace:x,go(y){return o.go(y)}};return j}function Zae(e,t=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),mn(n,"No window.location.(origin|href) available to create URL");let s=typeof e=="string"?e:pp(e);return s=s.replace(/ $/,"%20"),!t&&s.startsWith("//")&&(s=n+s),new URL(s,n)}function xH(e,t,n="/"){return Jae(e,t,n,!1)}function Jae(e,t,n,s){let r=typeof t=="string"?Yf(t):t,i=Rl(r.pathname||"/",n);if(i==null)return null;let o=yH(e);ene(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let u=une(i);l=cne(o[c],u,s)}return l}function yH(e,t=[],n=[],s="",r=!1){let i=(o,l,c=r,u)=>{let d={relativePath:u===void 0?o.path||"":u,caseSensitive:o.caseSensitive===!0,childrenIndex:l,route:o};if(d.relativePath.startsWith("/")){if(!d.relativePath.startsWith(s)&&c)return;mn(d.relativePath.startsWith(s),`Absolute route path "${d.relativePath}" nested under path "${s}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),d.relativePath=d.relativePath.slice(s.length)}let h=Ol([s,d.relativePath]),p=n.concat(d);o.children&&o.children.length>0&&(mn(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${h}".`),yH(o.children,t,p,h,c)),!(o.path==null&&!o.index)&&t.push({path:h,score:one(h,o.index),routesMeta:p})};return e.forEach((o,l)=>{if(o.path===""||!o.path?.includes("?"))i(o,l);else for(let c of bH(o.path))i(o,l,!0,c)}),t}function bH(e){let t=e.split("/");if(t.length===0)return[];let[n,...s]=t,r=n.endsWith("?"),i=n.replace(/\?$/,"");if(s.length===0)return r?[i,""]:[i];let o=bH(s.join("/")),l=[];return l.push(...o.map(c=>c===""?i:[i,c].join("/"))),r&&l.push(...o),l.map(c=>e.startsWith("/")&&c===""?"/":c)}function ene(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:lne(t.routesMeta.map(s=>s.childrenIndex),n.routesMeta.map(s=>s.childrenIndex)))}var tne=/^:[\w-]+$/,ane=3,nne=2,sne=1,rne=10,ine=-2,yI=e=>e==="*";function one(e,t){let n=e.split("/"),s=n.length;return n.some(yI)&&(s+=ine),t&&(s+=nne),n.filter(r=>!yI(r)).reduce((r,i)=>r+(tne.test(i)?ane:i===""?sne:rne),s)}function lne(e,t){return e.length===t.length&&e.slice(0,-1).every((s,r)=>s===t[r])?e[e.length-1]-t[t.length-1]:0}function cne(e,t,n=!1){let{routesMeta:s}=e,r={},i="/",o=[];for(let l=0;l<s.length;++l){let c=s[l],u=l===s.length-1,d=i==="/"?t:t.slice(i.length)||"/",h=Sv({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),p=c.route;if(!h&&u&&n&&!s[s.length-1].route.index&&(h=Sv({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},d)),!h)return null;Object.assign(r,h.params),o.push({params:r,pathname:Ol([i,h.pathname]),pathnameBase:gne(Ol([i,h.pathnameBase])),route:p}),h.pathnameBase!=="/"&&(i=Ol([i,h.pathnameBase]))}return o}function Sv(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,s]=dne(e.path,e.caseSensitive,e.end),r=t.match(n);if(!r)return null;let i=r[0],o=i.replace(/(.)\/+$/,"$1"),l=r.slice(1);return{params:s.reduce((u,{paramName:d,isOptional:h},p)=>{if(d==="*"){let v=l[p]||"";o=i.slice(0,i.length-v.length).replace(/(.)\/+$/,"$1")}const x=l[p];return h&&!x?u[d]=void 0:u[d]=(x||"").replace(/%2F/g,"/"),u},{}),pathname:i,pathnameBase:o,pattern:e}}function dne(e,t=!1,n=!0){bi(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let s=[],r="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(s.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(s.push({paramName:"*"}),r+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":e!==""&&e!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,t?void 0:"i"),s]}function une(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return bi(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function Rl(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,s=e.charAt(n);return s&&s!=="/"?null:e.slice(n)||"/"}var mne=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function fne(e,t="/"){let{pathname:n,search:s="",hash:r=""}=typeof e=="string"?Yf(e):e,i;return n?(n=n.replace(/\/\/+/g,"/"),n.startsWith("/")?i=bI(n.substring(1),"/"):i=bI(n,t)):i=t,{pathname:i,search:pne(s),hash:xne(r)}}function bI(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(r=>{r===".."?n.length>1&&n.pop():r!=="."&&n.push(r)}),n.length>1?n.join("/"):"/"}function KS(e,t,n,s){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(s)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function hne(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function mL(e){let t=hne(e);return t.map((n,s)=>s===t.length-1?n.pathname:n.pathnameBase)}function fL(e,t,n,s=!1){let r;typeof e=="string"?r=Yf(e):(r={...e},mn(!r.pathname||!r.pathname.includes("?"),KS("?","pathname","search",r)),mn(!r.pathname||!r.pathname.includes("#"),KS("#","pathname","hash",r)),mn(!r.search||!r.search.includes("#"),KS("#","search","hash",r)));let i=e===""||r.pathname==="",o=i?"/":r.pathname,l;if(o==null)l=n;else{let h=t.length-1;if(!s&&o.startsWith("..")){let p=o.split("/");for(;p[0]==="..";)p.shift(),h-=1;r.pathname=p.join("/")}l=h>=0?t[h]:"/"}let c=fne(r,l),u=o&&o!=="/"&&o.endsWith("/"),d=(i||o===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}var Ol=e=>e.join("/").replace(/\/\/+/g,"/"),gne=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),pne=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,xne=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e,yne=class{constructor(e,t,n,s=!1){this.status=e,this.statusText=t||"",this.internal=s,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}};function bne(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}function vne(e){return e.map(t=>t.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var vH=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function wH(e,t){let n=e;if(typeof n!="string"||!mne.test(n))return{absoluteURL:void 0,isExternal:!1,to:n};let s=n,r=!1;if(vH)try{let i=new URL(window.location.href),o=n.startsWith("//")?new URL(i.protocol+n):new URL(n),l=Rl(o.pathname,t);o.origin===i.origin&&l!=null?n=l+o.search+o.hash:r=!0}catch{bi(!1,`<Link to="${n}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:s,isExternal:r,to:n}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var jH=["POST","PUT","PATCH","DELETE"];new Set(jH);var wne=["GET",...jH];new Set(wne);var Qf=f.createContext(null);Qf.displayName="DataRouter";var sj=f.createContext(null);sj.displayName="DataRouterState";var jne=f.createContext(!1),NH=f.createContext({isTransitioning:!1});NH.displayName="ViewTransition";var Nne=f.createContext(new Map);Nne.displayName="Fetchers";var Cne=f.createContext(null);Cne.displayName="Await";var Wr=f.createContext(null);Wr.displayName="Navigation";var nx=f.createContext(null);nx.displayName="Location";var _i=f.createContext({outlet:null,matches:[],isDataRoute:!1});_i.displayName="Route";var hL=f.createContext(null);hL.displayName="RouteError";var CH="REACT_ROUTER_ERROR",Sne="REDIRECT",_ne="ROUTE_ERROR_RESPONSE";function Ane(e){if(e.startsWith(`${CH}:${Sne}:{`))try{let t=JSON.parse(e.slice(28));if(typeof t=="object"&&t&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.location=="string"&&typeof t.reloadDocument=="boolean"&&typeof t.replace=="boolean")return t}catch{}}function Tne(e){if(e.startsWith(`${CH}:${_ne}:{`))try{let t=JSON.parse(e.slice(40));if(typeof t=="object"&&t&&typeof t.status=="number"&&typeof t.statusText=="string")return new yne(t.status,t.statusText,t.data)}catch{}}function kne(e,{relative:t}={}){mn(Kf(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:s}=f.useContext(Wr),{hash:r,pathname:i,search:o}=sx(e,{relative:t}),l=i;return n!=="/"&&(l=i==="/"?n:Ol([n,i])),s.createHref({pathname:l,search:o,hash:r})}function Kf(){return f.useContext(nx)!=null}function ta(){return mn(Kf(),"useLocation() may be used only in the context of a <Router> component."),f.useContext(nx).location}var SH="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function _H(e){f.useContext(Wr).static||f.useLayoutEffect(e)}function kt(){let{isDataRoute:e}=f.useContext(_i);return e?qne():Ene()}function Ene(){mn(Kf(),"useNavigate() may be used only in the context of a <Router> component.");let e=f.useContext(Qf),{basename:t,navigator:n}=f.useContext(Wr),{matches:s}=f.useContext(_i),{pathname:r}=ta(),i=JSON.stringify(mL(s)),o=f.useRef(!1);return _H(()=>{o.current=!0}),f.useCallback((c,u={})=>{if(bi(o.current,SH),!o.current)return;if(typeof c=="number"){n.go(c);return}let d=fL(c,JSON.parse(i),r,u.relative==="path");e==null&&t!=="/"&&(d.pathname=d.pathname==="/"?t:Ol([t,d.pathname])),(u.replace?n.replace:n.push)(d,u.state,u)},[t,n,i,r,e])}var Lne=f.createContext(null);function Pne(e){let t=f.useContext(_i).outlet;return f.useMemo(()=>t&&f.createElement(Lne.Provider,{value:e},t),[t,e])}function Wo(){let{matches:e}=f.useContext(_i),t=e[e.length-1];return t?t.params:{}}function sx(e,{relative:t}={}){let{matches:n}=f.useContext(_i),{pathname:s}=ta(),r=JSON.stringify(mL(n));return f.useMemo(()=>fL(e,JSON.parse(r),s,t==="path"),[e,r,s,t])}function Dne(e,t){return AH(e,t)}function AH(e,t,n,s,r){mn(Kf(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=f.useContext(Wr),{matches:o}=f.useContext(_i),l=o[o.length-1],c=l?l.params:{},u=l?l.pathname:"/",d=l?l.pathnameBase:"/",h=l&&l.route;{let w=h&&h.path||"";kH(u,!h||w.endsWith("*")||w.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${u}" (under <Route path="${w}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${w}"> to <Route path="${w==="/"?"*":`${w}/*`}">.`)}let p=ta(),x;if(t){let w=typeof t=="string"?Yf(t):t;mn(d==="/"||w.pathname?.startsWith(d),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${d}" but pathname "${w.pathname}" was given in the \`location\` prop.`),x=w}else x=p;let v=x.pathname||"/",j=v;if(d!=="/"){let w=d.replace(/^\//,"").split("/");j="/"+v.replace(/^\//,"").split("/").slice(w.length).join("/")}let y=xH(e,{pathname:j});bi(h||y!=null,`No routes matched location "${x.pathname}${x.search}${x.hash}" `),bi(y==null||y[y.length-1].route.element!==void 0||y[y.length-1].route.Component!==void 0||y[y.length-1].route.lazy!==void 0,`Matched leaf route at location "${x.pathname}${x.search}${x.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let N=Rne(y&&y.map(w=>Object.assign({},w,{params:Object.assign({},c,w.params),pathname:Ol([d,i.encodeLocation?i.encodeLocation(w.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?d:Ol([d,i.encodeLocation?i.encodeLocation(w.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:w.pathnameBase])})),o,n,s,r);return t&&N?f.createElement(nx.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...x},navigationType:"POP"}},N):N}function One(){let e=Hne(),t=bne(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,s="rgba(200,200,200, 0.5)",r={padding:"0.5rem",backgroundColor:s},i={padding:"2px 4px",backgroundColor:s},o=null;return console.error("Error handled by React Router default ErrorBoundary:",e),o=f.createElement(f.Fragment,null,f.createElement("p",null," Hey developer "),f.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",f.createElement("code",{style:i},"ErrorBoundary")," or"," ",f.createElement("code",{style:i},"errorElement")," prop on your route.")),f.createElement(f.Fragment,null,f.createElement("h2",null,"Unexpected Application Error!"),f.createElement("h3",{style:{fontStyle:"italic"}},t),n?f.createElement("pre",{style:r},n):null,o)}var Mne=f.createElement(One,null),TH=class extends f.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.onError?this.props.onError(e,t):console.error("React Router caught the following error during render",e)}render(){let e=this.state.error;if(this.context&&typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){const n=Tne(e.digest);n&&(e=n)}let t=e!==void 0?f.createElement(_i.Provider,{value:this.props.routeContext},f.createElement(hL.Provider,{value:e,children:this.props.component})):this.props.children;return this.context?f.createElement(Ine,{error:e},t):t}};TH.contextType=jne;var XS=new WeakMap;function Ine({children:e,error:t}){let{basename:n}=f.useContext(Wr);if(typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){let s=Ane(t.digest);if(s){let r=XS.get(t);if(r)throw r;let i=wH(s.location,n);if(vH&&!XS.get(t))if(i.isExternal||s.reloadDocument)window.location.href=i.absoluteURL||i.to;else{const o=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(i.to,{replace:s.replace}));throw XS.set(t,o),o}return f.createElement("meta",{httpEquiv:"refresh",content:`0;url=${i.absoluteURL||i.to}`})}}return e}function $ne({routeContext:e,match:t,children:n}){let s=f.useContext(Qf);return s&&s.static&&s.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=t.route.id),f.createElement(_i.Provider,{value:e},n)}function Rne(e,t=[],n=null,s=null,r=null){if(e==null){if(!n)return null;if(n.errors)e=n.matches;else if(t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let i=e,o=n?.errors;if(o!=null){let d=i.findIndex(h=>h.route.id&&o?.[h.route.id]!==void 0);mn(d>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),i=i.slice(0,Math.min(i.length,d+1))}let l=!1,c=-1;if(n)for(let d=0;d<i.length;d++){let h=i[d];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(c=d),h.route.id){let{loaderData:p,errors:x}=n,v=h.route.loader&&!p.hasOwnProperty(h.route.id)&&(!x||x[h.route.id]===void 0);if(h.route.lazy||v){l=!0,c>=0?i=i.slice(0,c+1):i=[i[0]];break}}}let u=n&&s?(d,h)=>{s(d,{location:n.location,params:n.matches?.[0]?.params??{},unstable_pattern:vne(n.matches),errorInfo:h})}:void 0;return i.reduceRight((d,h,p)=>{let x,v=!1,j=null,y=null;n&&(x=o&&h.route.id?o[h.route.id]:void 0,j=h.route.errorElement||Mne,l&&(c<0&&p===0?(kH("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),v=!0,y=null):c===p&&(v=!0,y=h.route.hydrateFallbackElement||null)));let N=t.concat(i.slice(0,p+1)),w=()=>{let S;return x?S=j:v?S=y:h.route.Component?S=f.createElement(h.route.Component,null):h.route.element?S=h.route.element:S=d,f.createElement($ne,{match:h,routeContext:{outlet:d,matches:N,isDataRoute:n!=null},children:S})};return n&&(h.route.ErrorBoundary||h.route.errorElement||p===0)?f.createElement(TH,{location:n.location,revalidation:n.revalidation,component:j,error:x,children:w(),routeContext:{outlet:null,matches:N,isDataRoute:!0},onError:u}):w()},null)}function gL(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function zne(e){let t=f.useContext(Qf);return mn(t,gL(e)),t}function Fne(e){let t=f.useContext(sj);return mn(t,gL(e)),t}function Une(e){let t=f.useContext(_i);return mn(t,gL(e)),t}function pL(e){let t=Une(e),n=t.matches[t.matches.length-1];return mn(n.route.id,`${e} can only be used on routes that contain a unique "id"`),n.route.id}function Bne(){return pL("useRouteId")}function Hne(){let e=f.useContext(hL),t=Fne("useRouteError"),n=pL("useRouteError");return e!==void 0?e:t.errors?.[n]}function qne(){let{router:e}=zne("useNavigate"),t=pL("useNavigate"),n=f.useRef(!1);return _H(()=>{n.current=!0}),f.useCallback(async(r,i={})=>{bi(n.current,SH),n.current&&(typeof r=="number"?await e.navigate(r):await e.navigate(r,{fromRouteId:t,...i}))},[e,t])}var vI={};function kH(e,t,n){!t&&!vI[e]&&(vI[e]=!0,bi(!1,n))}f.memo(Gne);function Gne({routes:e,future:t,state:n,onError:s}){return AH(e,void 0,n,s,t)}function ur({to:e,replace:t,state:n,relative:s}){mn(Kf(),"<Navigate> may be used only in the context of a <Router> component.");let{static:r}=f.useContext(Wr);bi(!r,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:i}=f.useContext(_i),{pathname:o}=ta(),l=kt(),c=fL(e,mL(i),o,s==="path"),u=JSON.stringify(c);return f.useEffect(()=>{l(JSON.parse(u),{replace:t,state:n,relative:s})},[l,u,s,t,n]),null}function Xf(e){return Pne(e.context)}function vt(e){mn(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Wne({basename:e="/",children:t=null,location:n,navigationType:s="POP",navigator:r,static:i=!1,unstable_useTransitions:o}){mn(!Kf(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=e.replace(/^\/*/,"/"),c=f.useMemo(()=>({basename:l,navigator:r,static:i,unstable_useTransitions:o,future:{}}),[l,r,i,o]);typeof n=="string"&&(n=Yf(n));let{pathname:u="/",search:d="",hash:h="",state:p=null,key:x="default"}=n,v=f.useMemo(()=>{let j=Rl(u,l);return j==null?null:{location:{pathname:j,search:d,hash:h,state:p,key:x},navigationType:s}},[l,u,d,h,p,x,s]);return bi(v!=null,`<Router basename="${l}"> is not able to match the URL "${u}${d}${h}" because it does not start with the basename, so the <Router> won't render anything.`),v==null?null:f.createElement(Wr.Provider,{value:c},f.createElement(nx.Provider,{children:t,value:v}))}function Vne({children:e,location:t}){return Dne(GT(e),t)}function GT(e,t=[]){let n=[];return f.Children.forEach(e,(s,r)=>{if(!f.isValidElement(s))return;let i=[...t,r];if(s.type===f.Fragment){n.push.apply(n,GT(s.props.children,i));return}mn(s.type===vt,`[${typeof s.type=="string"?s.type:s.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),mn(!s.props.index||!s.props.children,"An index route cannot have child routes.");let o={id:s.props.id||i.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,middleware:s.props.middleware,loader:s.props.loader,action:s.props.action,hydrateFallbackElement:s.props.hydrateFallbackElement,HydrateFallback:s.props.HydrateFallback,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.hasErrorBoundary===!0||s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(o.children=GT(s.props.children,i)),n.push(o)}),n}var nv="get",sv="application/x-www-form-urlencoded";function rj(e){return typeof HTMLElement<"u"&&e instanceof HTMLElement}function Yne(e){return rj(e)&&e.tagName.toLowerCase()==="button"}function Qne(e){return rj(e)&&e.tagName.toLowerCase()==="form"}function Kne(e){return rj(e)&&e.tagName.toLowerCase()==="input"}function Xne(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function Zne(e,t){return e.button===0&&(!t||t==="_self")&&!Xne(e)}function WT(e=""){return new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,n)=>{let s=e[n];return t.concat(Array.isArray(s)?s.map(r=>[n,r]):[[n,s]])},[]))}function Jne(e,t){let n=WT(e);return t&&t.forEach((s,r)=>{n.has(r)||t.getAll(r).forEach(i=>{n.append(r,i)})}),n}var My=null;function ese(){if(My===null)try{new FormData(document.createElement("form"),0),My=!1}catch{My=!0}return My}var tse=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function ZS(e){return e!=null&&!tse.has(e)?(bi(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${sv}"`),null):e}function ase(e,t){let n,s,r,i,o;if(Qne(e)){let l=e.getAttribute("action");s=l?Rl(l,t):null,n=e.getAttribute("method")||nv,r=ZS(e.getAttribute("enctype"))||sv,i=new FormData(e)}else if(Yne(e)||Kne(e)&&(e.type==="submit"||e.type==="image")){let l=e.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=e.getAttribute("formaction")||l.getAttribute("action");if(s=c?Rl(c,t):null,n=e.getAttribute("formmethod")||l.getAttribute("method")||nv,r=ZS(e.getAttribute("formenctype"))||ZS(l.getAttribute("enctype"))||sv,i=new FormData(l,e),!ese()){let{name:u,type:d,value:h}=e;if(d==="image"){let p=u?`${u}.`:"";i.append(`${p}x`,"0"),i.append(`${p}y`,"0")}else u&&i.append(u,h)}}else{if(rj(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=nv,s=null,r=sv,o=e}return i&&r==="text/plain"&&(o=i,i=void 0),{action:s,method:n.toLowerCase(),encType:r,formData:i,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function xL(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function nse(e,t,n,s){let r=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return n?r.pathname.endsWith("/")?r.pathname=`${r.pathname}_.${s}`:r.pathname=`${r.pathname}.${s}`:r.pathname==="/"?r.pathname=`_root.${s}`:t&&Rl(r.pathname,t)==="/"?r.pathname=`${t.replace(/\/$/,"")}/_root.${s}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${s}`,r}async function sse(e,t){if(e.id in t)return t[e.id];try{let n=await import(e.module);return t[e.id]=n,n}catch(n){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function rse(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function ise(e,t,n){let s=await Promise.all(e.map(async r=>{let i=t.routes[r.route.id];if(i){let o=await sse(i,n);return o.links?o.links():[]}return[]}));return dse(s.flat(1).filter(rse).filter(r=>r.rel==="stylesheet"||r.rel==="preload").map(r=>r.rel==="stylesheet"?{...r,rel:"prefetch",as:"style"}:{...r,rel:"prefetch"}))}function wI(e,t,n,s,r,i){let o=(c,u)=>n[u]?c.route.id!==n[u].route.id:!0,l=(c,u)=>n[u].pathname!==c.pathname||n[u].route.path?.endsWith("*")&&n[u].params["*"]!==c.params["*"];return i==="assets"?t.filter((c,u)=>o(c,u)||l(c,u)):i==="data"?t.filter((c,u)=>{let d=s.routes[c.route.id];if(!d||!d.hasLoader)return!1;if(o(c,u)||l(c,u))return!0;if(c.route.shouldRevalidate){let h=c.route.shouldRevalidate({currentUrl:new URL(r.pathname+r.search+r.hash,window.origin),currentParams:n[0]?.params||{},nextUrl:new URL(e,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof h=="boolean")return h}return!0}):[]}function ose(e,t,{includeHydrateFallback:n}={}){return lse(e.map(s=>{let r=t.routes[s.route.id];if(!r)return[];let i=[r.module];return r.clientActionModule&&(i=i.concat(r.clientActionModule)),r.clientLoaderModule&&(i=i.concat(r.clientLoaderModule)),n&&r.hydrateFallbackModule&&(i=i.concat(r.hydrateFallbackModule)),r.imports&&(i=i.concat(r.imports)),i}).flat(1))}function lse(e){return[...new Set(e)]}function cse(e){let t={},n=Object.keys(e).sort();for(let s of n)t[s]=e[s];return t}function dse(e,t){let n=new Set;return new Set(t),e.reduce((s,r)=>{let i=JSON.stringify(cse(r));return n.has(i)||(n.add(i),s.push({key:i,link:r})),s},[])}function EH(){let e=f.useContext(Qf);return xL(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function use(){let e=f.useContext(sj);return xL(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var yL=f.createContext(void 0);yL.displayName="FrameworkContext";function LH(){let e=f.useContext(yL);return xL(e,"You must render this element inside a <HydratedRouter> element"),e}function mse(e,t){let n=f.useContext(yL),[s,r]=f.useState(!1),[i,o]=f.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:u,onMouseLeave:d,onTouchStart:h}=t,p=f.useRef(null);f.useEffect(()=>{if(e==="render"&&o(!0),e==="viewport"){let j=N=>{N.forEach(w=>{o(w.isIntersecting)})},y=new IntersectionObserver(j,{threshold:.5});return p.current&&y.observe(p.current),()=>{y.disconnect()}}},[e]),f.useEffect(()=>{if(s){let j=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(j)}}},[s]);let x=()=>{r(!0)},v=()=>{r(!1),o(!1)};return n?e!=="intent"?[i,p,{}]:[i,p,{onFocus:fg(l,x),onBlur:fg(c,v),onMouseEnter:fg(u,x),onMouseLeave:fg(d,v),onTouchStart:fg(h,x)}]:[!1,p,{}]}function fg(e,t){return n=>{e&&e(n),n.defaultPrevented||t(n)}}function fse({page:e,...t}){let{router:n}=EH(),s=f.useMemo(()=>xH(n.routes,e,n.basename),[n.routes,e,n.basename]);return s?f.createElement(gse,{page:e,matches:s,...t}):null}function hse(e){let{manifest:t,routeModules:n}=LH(),[s,r]=f.useState([]);return f.useEffect(()=>{let i=!1;return ise(e,t,n).then(o=>{i||r(o)}),()=>{i=!0}},[e,t,n]),s}function gse({page:e,matches:t,...n}){let s=ta(),{future:r,manifest:i,routeModules:o}=LH(),{basename:l}=EH(),{loaderData:c,matches:u}=use(),d=f.useMemo(()=>wI(e,t,u,i,s,"data"),[e,t,u,i,s]),h=f.useMemo(()=>wI(e,t,u,i,s,"assets"),[e,t,u,i,s]),p=f.useMemo(()=>{if(e===s.pathname+s.search+s.hash)return[];let j=new Set,y=!1;if(t.forEach(w=>{let S=i.routes[w.route.id];!S||!S.hasLoader||(!d.some(_=>_.route.id===w.route.id)&&w.route.id in c&&o[w.route.id]?.shouldRevalidate||S.hasClientLoader?y=!0:j.add(w.route.id))}),j.size===0)return[];let N=nse(e,l,r.unstable_trailingSlashAwareDataRequests,"data");return y&&j.size>0&&N.searchParams.set("_routes",t.filter(w=>j.has(w.route.id)).map(w=>w.route.id).join(",")),[N.pathname+N.search]},[l,r.unstable_trailingSlashAwareDataRequests,c,s,i,d,t,e,o]),x=f.useMemo(()=>ose(h,i),[h,i]),v=hse(h);return f.createElement(f.Fragment,null,p.map(j=>f.createElement("link",{key:j,rel:"prefetch",as:"fetch",href:j,...n})),x.map(j=>f.createElement("link",{key:j,rel:"modulepreload",href:j,...n})),v.map(({key:j,link:y})=>f.createElement("link",{key:j,nonce:n.nonce,...y,crossOrigin:y.crossOrigin??n.crossOrigin})))}function pse(...e){return t=>{e.forEach(n=>{typeof n=="function"?n(t):n!=null&&(n.current=t)})}}var xse=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{xse&&(window.__reactRouterVersion="7.13.0")}catch{}function yse({basename:e,children:t,unstable_useTransitions:n,window:s}){let r=f.useRef();r.current==null&&(r.current=Qae({window:s,v5Compat:!0}));let i=r.current,[o,l]=f.useState({action:i.action,location:i.location}),c=f.useCallback(u=>{n===!1?l(u):f.startTransition(()=>l(u))},[n]);return f.useLayoutEffect(()=>i.listen(c),[i,c]),f.createElement(Wne,{basename:e,children:t,location:o.location,navigationType:o.action,navigator:i,unstable_useTransitions:n})}var PH=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ld=f.forwardRef(function({onClick:t,discover:n="render",prefetch:s="none",relative:r,reloadDocument:i,replace:o,state:l,target:c,to:u,preventScrollReset:d,viewTransition:h,unstable_defaultShouldRevalidate:p,...x},v){let{basename:j,unstable_useTransitions:y}=f.useContext(Wr),N=typeof u=="string"&&PH.test(u),w=wH(u,j);u=w.to;let S=kne(u,{relative:r}),[_,k,T]=mse(s,x),A=wse(u,{replace:o,state:l,target:c,preventScrollReset:d,relative:r,viewTransition:h,unstable_defaultShouldRevalidate:p,unstable_useTransitions:y});function E(z){t&&t(z),z.defaultPrevented||A(z)}let M=f.createElement("a",{...x,...T,href:w.absoluteURL||S,onClick:w.isExternal||i?t:E,ref:pse(v,k),target:c,"data-discover":!N&&n==="render"?"true":void 0});return _&&!N?f.createElement(f.Fragment,null,M,f.createElement(fse,{page:S})):M});ld.displayName="Link";var Ft=f.forwardRef(function({"aria-current":t="page",caseSensitive:n=!1,className:s="",end:r=!1,style:i,to:o,viewTransition:l,children:c,...u},d){let h=sx(o,{relative:u.relative}),p=ta(),x=f.useContext(sj),{navigator:v,basename:j}=f.useContext(Wr),y=x!=null&&_se(h)&&l===!0,N=v.encodeLocation?v.encodeLocation(h).pathname:h.pathname,w=p.pathname,S=x&&x.navigation&&x.navigation.location?x.navigation.location.pathname:null;n||(w=w.toLowerCase(),S=S?S.toLowerCase():null,N=N.toLowerCase()),S&&j&&(S=Rl(S,j)||S);const _=N!=="/"&&N.endsWith("/")?N.length-1:N.length;let k=w===N||!r&&w.startsWith(N)&&w.charAt(_)==="/",T=S!=null&&(S===N||!r&&S.startsWith(N)&&S.charAt(N.length)==="/"),A={isActive:k,isPending:T,isTransitioning:y},E=k?t:void 0,M;typeof s=="function"?M=s(A):M=[s,k?"active":null,T?"pending":null,y?"transitioning":null].filter(Boolean).join(" ");let z=typeof i=="function"?i(A):i;return f.createElement(ld,{...u,"aria-current":E,className:M,ref:d,style:z,to:o,viewTransition:l},typeof c=="function"?c(A):c)});Ft.displayName="NavLink";var bse=f.forwardRef(({discover:e="render",fetcherKey:t,navigate:n,reloadDocument:s,replace:r,state:i,method:o=nv,action:l,onSubmit:c,relative:u,preventScrollReset:d,viewTransition:h,unstable_defaultShouldRevalidate:p,...x},v)=>{let{unstable_useTransitions:j}=f.useContext(Wr),y=Cse(),N=Sse(l,{relative:u}),w=o.toLowerCase()==="get"?"get":"post",S=typeof l=="string"&&PH.test(l),_=k=>{if(c&&c(k),k.defaultPrevented)return;k.preventDefault();let T=k.nativeEvent.submitter,A=T?.getAttribute("formmethod")||o,E=()=>y(T||k.currentTarget,{fetcherKey:t,method:A,navigate:n,replace:r,state:i,relative:u,preventScrollReset:d,viewTransition:h,unstable_defaultShouldRevalidate:p});j&&n!==!1?f.startTransition(()=>E()):E()};return f.createElement("form",{ref:v,method:w,action:N,onSubmit:s?c:_,...x,"data-discover":!S&&e==="render"?"true":void 0})});bse.displayName="Form";function vse(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function DH(e){let t=f.useContext(Qf);return mn(t,vse(e)),t}function wse(e,{target:t,replace:n,state:s,preventScrollReset:r,relative:i,viewTransition:o,unstable_defaultShouldRevalidate:l,unstable_useTransitions:c}={}){let u=kt(),d=ta(),h=sx(e,{relative:i});return f.useCallback(p=>{if(Zne(p,t)){p.preventDefault();let x=n!==void 0?n:pp(d)===pp(h),v=()=>u(e,{replace:x,state:s,preventScrollReset:r,relative:i,viewTransition:o,unstable_defaultShouldRevalidate:l});c?f.startTransition(()=>v()):v()}},[d,u,h,n,s,t,e,r,i,o,l,c])}function Bs(e){bi(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let t=f.useRef(WT(e)),n=f.useRef(!1),s=ta(),r=f.useMemo(()=>Jne(s.search,n.current?null:t.current),[s.search]),i=kt(),o=f.useCallback((l,c)=>{const u=WT(typeof l=="function"?l(new URLSearchParams(r)):l);n.current=!0,i("?"+u,c)},[i,r]);return[r,o]}var jse=0,Nse=()=>`__${String(++jse)}__`;function Cse(){let{router:e}=DH("useSubmit"),{basename:t}=f.useContext(Wr),n=Bne(),s=e.fetch,r=e.navigate;return f.useCallback(async(i,o={})=>{let{action:l,method:c,encType:u,formData:d,body:h}=ase(i,t);if(o.navigate===!1){let p=o.fetcherKey||Nse();await s(p,n,o.action||l,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:d,body:h,formMethod:o.method||c,formEncType:o.encType||u,flushSync:o.flushSync})}else await r(o.action||l,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:d,body:h,formMethod:o.method||c,formEncType:o.encType||u,replace:o.replace,state:o.state,fromRouteId:n,flushSync:o.flushSync,viewTransition:o.viewTransition})},[s,r,t,n])}function Sse(e,{relative:t}={}){let{basename:n}=f.useContext(Wr),s=f.useContext(_i);mn(s,"useFormAction must be used inside a RouteContext");let[r]=s.matches.slice(-1),i={...sx(e||".",{relative:t})},o=ta();if(e==null){i.search=o.search;let l=new URLSearchParams(i.search),c=l.getAll("index");if(c.some(d=>d==="")){l.delete("index"),c.filter(h=>h).forEach(h=>l.append("index",h));let d=l.toString();i.search=d?`?${d}`:""}}return(!e||e===".")&&r.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(i.pathname=i.pathname==="/"?n:Ol([n,i.pathname])),pp(i)}function _se(e,{relative:t}={}){let n=f.useContext(NH);mn(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:s}=DH("useViewTransitionState"),r=sx(e,{relative:t});if(!n.isTransitioning)return!1;let i=Rl(n.currentLocation.pathname,s)||n.currentLocation.pathname,o=Rl(n.nextLocation.pathname,s)||n.nextLocation.pathname;return Sv(r.pathname,o)!=null||Sv(r.pathname,i)!=null}var Gi=pH();const Iy=ao(Gi);function OH(e){var t,n,s="";if(typeof e=="string"||typeof e=="number")s+=e;else if(typeof e=="object")if(Array.isArray(e)){var r=e.length;for(t=0;t<r;t++)e[t]&&(n=OH(e[t]))&&(s&&(s+=" "),s+=n)}else for(n in e)e[n]&&(s&&(s+=" "),s+=n);return s}function $t(){for(var e,t,n=0,s="",r=arguments.length;n<r;n++)(e=arguments[n])&&(t=OH(e))&&(s&&(s+=" "),s+=t);return s}function Ase(e){if(typeof document>"u")return;let t=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",t.firstChild?t.insertBefore(n,t.firstChild):t.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}Ase(`:root{--toastify-color-light: #fff;--toastify-color-dark: #121212;--toastify-color-info: #3498db;--toastify-color-success: #07bc0c;--toastify-color-warning: #f1c40f;--toastify-color-error: hsl(6, 78%, 57%);--toastify-color-transparent: rgba(255, 255, 255, .7);--toastify-icon-color-info: var(--toastify-color-info);--toastify-icon-color-success: var(--toastify-color-success);--toastify-icon-color-warning: var(--toastify-color-warning);--toastify-icon-color-error: var(--toastify-color-error);--toastify-container-width: fit-content;--toastify-toast-width: 320px;--toastify-toast-offset: 16px;--toastify-toast-top: max(var(--toastify-toast-offset), env(safe-area-inset-top));--toastify-toast-right: max(var(--toastify-toast-offset), env(safe-area-inset-right));--toastify-toast-left: max(var(--toastify-toast-offset), env(safe-area-inset-left));--toastify-toast-bottom: max(var(--toastify-toast-offset), env(safe-area-inset-bottom));--toastify-toast-background: #fff;--toastify-toast-padding: 14px;--toastify-toast-min-height: 64px;--toastify-toast-max-height: 800px;--toastify-toast-bd-radius: 6px;--toastify-toast-shadow: 0px 4px 12px rgba(0, 0, 0, .1);--toastify-font-family: sans-serif;--toastify-z-index: 9999;--toastify-text-color-light: #757575;--toastify-text-color-dark: #fff;--toastify-text-color-info: #fff;--toastify-text-color-success: #fff;--toastify-text-color-warning: #fff;--toastify-text-color-error: #fff;--toastify-spinner-color: #616161;--toastify-spinner-color-empty-area: #e0e0e0;--toastify-color-progress-light: linear-gradient(to right, #4cd964, #5ac8fa, #007aff, #34aadc, #5856d6, #ff2d55);--toastify-color-progress-dark: #bb86fc;--toastify-color-progress-info: var(--toastify-color-info);--toastify-color-progress-success: var(--toastify-color-success);--toastify-color-progress-warning: var(--toastify-color-warning);--toastify-color-progress-error: var(--toastify-color-error);--toastify-color-progress-bgo: .2}.Toastify__toast-container{z-index:var(--toastify-z-index);-webkit-transform:translate3d(0,0,var(--toastify-z-index));position:fixed;width:var(--toastify-container-width);box-sizing:border-box;color:#fff;display:flex;flex-direction:column}.Toastify__toast-container--top-left{top:var(--toastify-toast-top);left:var(--toastify-toast-left)}.Toastify__toast-container--top-center{top:var(--toastify-toast-top);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--top-right{top:var(--toastify-toast-top);right:var(--toastify-toast-right);align-items:end}.Toastify__toast-container--bottom-left{bottom:var(--toastify-toast-bottom);left:var(--toastify-toast-left)}.Toastify__toast-container--bottom-center{bottom:var(--toastify-toast-bottom);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--bottom-right{bottom:var(--toastify-toast-bottom);right:var(--toastify-toast-right);align-items:end}.Toastify__toast{--y: 0;position:relative;touch-action:none;width:var(--toastify-toast-width);min-height:var(--toastify-toast-min-height);box-sizing:border-box;margin-bottom:1rem;padding:var(--toastify-toast-padding);border-radius:var(--toastify-toast-bd-radius);box-shadow:var(--toastify-toast-shadow);max-height:var(--toastify-toast-max-height);font-family:var(--toastify-font-family);z-index:0;display:flex;flex:1 auto;align-items:center;word-break:break-word}@media only screen and (max-width: 480px){.Toastify__toast-container{width:100vw;left:env(safe-area-inset-left);margin:0}.Toastify__toast-container--top-left,.Toastify__toast-container--top-center,.Toastify__toast-container--top-right{top:env(safe-area-inset-top);transform:translate(0)}.Toastify__toast-container--bottom-left,.Toastify__toast-container--bottom-center,.Toastify__toast-container--bottom-right{bottom:env(safe-area-inset-bottom);transform:translate(0)}.Toastify__toast-container--rtl{right:env(safe-area-inset-right);left:initial}.Toastify__toast{--toastify-toast-width: 100%;margin-bottom:0;border-radius:0}}.Toastify__toast-container[data-stacked=true]{width:var(--toastify-toast-width)}.Toastify__toast--stacked{position:absolute;width:100%;transform:translate3d(0,var(--y),0) scale(var(--s));transition:transform .3s}.Toastify__toast--stacked[data-collapsed] .Toastify__toast-body,.Toastify__toast--stacked[data-collapsed] .Toastify__close-button{transition:opacity .1s}.Toastify__toast--stacked[data-collapsed=false]{overflow:visible}.Toastify__toast--stacked[data-collapsed=true]:not(:last-child)>*{opacity:0}.Toastify__toast--stacked:after{content:"";position:absolute;left:0;right:0;height:calc(var(--g) * 1px);bottom:100%}.Toastify__toast--stacked[data-pos=top]{top:0}.Toastify__toast--stacked[data-pos=bot]{bottom:0}.Toastify__toast--stacked[data-pos=bot].Toastify__toast--stacked:before{transform-origin:top}.Toastify__toast--stacked[data-pos=top].Toastify__toast--stacked:before{transform-origin:bottom}.Toastify__toast--stacked:before{content:"";position:absolute;left:0;right:0;bottom:0;height:100%;transform:scaleY(3);z-index:-1}.Toastify__toast--rtl{direction:rtl}.Toastify__toast--close-on-click{cursor:pointer}.Toastify__toast-icon{margin-inline-end:10px;width:22px;flex-shrink:0;display:flex}.Toastify--animate{animation-fill-mode:both;animation-duration:.5s}.Toastify--animate-icon{animation-fill-mode:both;animation-duration:.3s}.Toastify__toast-theme--dark{background:var(--toastify-color-dark);color:var(--toastify-text-color-dark)}.Toastify__toast-theme--light,.Toastify__toast-theme--colored.Toastify__toast--default{background:var(--toastify-color-light);color:var(--toastify-text-color-light)}.Toastify__toast-theme--colored.Toastify__toast--info{color:var(--toastify-text-color-info);background:var(--toastify-color-info)}.Toastify__toast-theme--colored.Toastify__toast--success{color:var(--toastify-text-color-success);background:var(--toastify-color-success)}.Toastify__toast-theme--colored.Toastify__toast--warning{color:var(--toastify-text-color-warning);background:var(--toastify-color-warning)}.Toastify__toast-theme--colored.Toastify__toast--error{color:var(--toastify-text-color-error);background:var(--toastify-color-error)}.Toastify__progress-bar-theme--light{background:var(--toastify-color-progress-light)}.Toastify__progress-bar-theme--dark{background:var(--toastify-color-progress-dark)}.Toastify__progress-bar--info{background:var(--toastify-color-progress-info)}.Toastify__progress-bar--success{background:var(--toastify-color-progress-success)}.Toastify__progress-bar--warning{background:var(--toastify-color-progress-warning)}.Toastify__progress-bar--error{background:var(--toastify-color-progress-error)}.Toastify__progress-bar-theme--colored.Toastify__progress-bar--info,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--success,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--warning,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--error{background:var(--toastify-color-transparent)}.Toastify__close-button{color:#fff;position:absolute;top:6px;right:6px;background:transparent;outline:none;border:none;padding:0;cursor:pointer;opacity:.7;transition:.3s ease;z-index:1}.Toastify__toast--rtl .Toastify__close-button{left:6px;right:unset}.Toastify__close-button--light{color:#000;opacity:.3}.Toastify__close-button>svg{fill:currentColor;height:16px;width:14px}.Toastify__close-button:hover,.Toastify__close-button:focus{opacity:1}@keyframes Toastify__trackProgress{0%{transform:scaleX(1)}to{transform:scaleX(0)}}.Toastify__progress-bar{position:absolute;bottom:0;left:0;width:100%;height:100%;z-index:1;opacity:.7;transform-origin:left}.Toastify__progress-bar--animated{animation:Toastify__trackProgress linear 1 forwards}.Toastify__progress-bar--controlled{transition:transform .2s}.Toastify__progress-bar--rtl{right:0;left:initial;transform-origin:right;border-bottom-left-radius:initial}.Toastify__progress-bar--wrp{position:absolute;overflow:hidden;bottom:0;left:0;width:100%;height:5px;border-bottom-left-radius:var(--toastify-toast-bd-radius);border-bottom-right-radius:var(--toastify-toast-bd-radius)}.Toastify__progress-bar--wrp[data-hidden=true]{opacity:0}.Toastify__progress-bar--bg{opacity:var(--toastify-color-progress-bgo);width:100%;height:100%}.Toastify__spinner{width:20px;height:20px;box-sizing:border-box;border:2px solid;border-radius:100%;border-color:var(--toastify-spinner-color-empty-area);border-right-color:var(--toastify-spinner-color);animation:Toastify__spin .65s linear infinite}@keyframes Toastify__bounceInRight{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(3000px,0,0)}60%{opacity:1;transform:translate3d(-25px,0,0)}75%{transform:translate3d(10px,0,0)}90%{transform:translate3d(-5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutRight{20%{opacity:1;transform:translate3d(-20px,var(--y),0)}to{opacity:0;transform:translate3d(2000px,var(--y),0)}}@keyframes Toastify__bounceInLeft{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(-3000px,0,0)}60%{opacity:1;transform:translate3d(25px,0,0)}75%{transform:translate3d(-10px,0,0)}90%{transform:translate3d(5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutLeft{20%{opacity:1;transform:translate3d(20px,var(--y),0)}to{opacity:0;transform:translate3d(-2000px,var(--y),0)}}@keyframes Toastify__bounceInUp{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,3000px,0)}60%{opacity:1;transform:translate3d(0,-20px,0)}75%{transform:translate3d(0,10px,0)}90%{transform:translate3d(0,-5px,0)}to{transform:translateZ(0)}}@keyframes Toastify__bounceOutUp{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,-2000px,0)}}@keyframes Toastify__bounceInDown{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,-3000px,0)}60%{opacity:1;transform:translate3d(0,25px,0)}75%{transform:translate3d(0,-10px,0)}90%{transform:translate3d(0,5px,0)}to{transform:none}}@keyframes Toastify__bounceOutDown{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,2000px,0)}}.Toastify__bounce-enter--top-left,.Toastify__bounce-enter--bottom-left{animation-name:Toastify__bounceInLeft}.Toastify__bounce-enter--top-right,.Toastify__bounce-enter--bottom-right{animation-name:Toastify__bounceInRight}.Toastify__bounce-enter--top-center{animation-name:Toastify__bounceInDown}.Toastify__bounce-enter--bottom-center{animation-name:Toastify__bounceInUp}.Toastify__bounce-exit--top-left,.Toastify__bounce-exit--bottom-left{animation-name:Toastify__bounceOutLeft}.Toastify__bounce-exit--top-right,.Toastify__bounce-exit--bottom-right{animation-name:Toastify__bounceOutRight}.Toastify__bounce-exit--top-center{animation-name:Toastify__bounceOutUp}.Toastify__bounce-exit--bottom-center{animation-name:Toastify__bounceOutDown}@keyframes Toastify__zoomIn{0%{opacity:0;transform:scale3d(.3,.3,.3)}50%{opacity:1}}@keyframes Toastify__zoomOut{0%{opacity:1}50%{opacity:0;transform:translate3d(0,var(--y),0) scale3d(.3,.3,.3)}to{opacity:0}}.Toastify__zoom-enter{animation-name:Toastify__zoomIn}.Toastify__zoom-exit{animation-name:Toastify__zoomOut}@keyframes Toastify__flipIn{0%{transform:perspective(400px) rotateX(90deg);animation-timing-function:ease-in;opacity:0}40%{transform:perspective(400px) rotateX(-20deg);animation-timing-function:ease-in}60%{transform:perspective(400px) rotateX(10deg);opacity:1}80%{transform:perspective(400px) rotateX(-5deg)}to{transform:perspective(400px)}}@keyframes Toastify__flipOut{0%{transform:translate3d(0,var(--y),0) perspective(400px)}30%{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(-20deg);opacity:1}to{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(90deg);opacity:0}}.Toastify__flip-enter{animation-name:Toastify__flipIn}.Toastify__flip-exit{animation-name:Toastify__flipOut}@keyframes Toastify__slideInRight{0%{transform:translate3d(110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInLeft{0%{transform:translate3d(-110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInUp{0%{transform:translate3d(0,110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInDown{0%{transform:translate3d(0,-110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideOutRight{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(110%,var(--y),0)}}@keyframes Toastify__slideOutLeft{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(-110%,var(--y),0)}}@keyframes Toastify__slideOutDown{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,500px,0)}}@keyframes Toastify__slideOutUp{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,-500px,0)}}.Toastify__slide-enter--top-left,.Toastify__slide-enter--bottom-left{animation-name:Toastify__slideInLeft}.Toastify__slide-enter--top-right,.Toastify__slide-enter--bottom-right{animation-name:Toastify__slideInRight}.Toastify__slide-enter--top-center{animation-name:Toastify__slideInDown}.Toastify__slide-enter--bottom-center{animation-name:Toastify__slideInUp}.Toastify__slide-exit--top-left,.Toastify__slide-exit--bottom-left{animation-name:Toastify__slideOutLeft;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-right,.Toastify__slide-exit--bottom-right{animation-name:Toastify__slideOutRight;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-center{animation-name:Toastify__slideOutUp;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--bottom-center{animation-name:Toastify__slideOutDown;animation-timing-function:ease-in;animation-duration:.3s}@keyframes Toastify__spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}
`);var rx=e=>typeof e=="number"&&!isNaN(e),Eu=e=>typeof e=="string",zl=e=>typeof e=="function",Tse=e=>Eu(e)||rx(e),VT=e=>Eu(e)||zl(e)?e:null,kse=(e,t)=>e===!1||rx(e)&&e>0?e:t,YT=e=>f.isValidElement(e)||Eu(e)||zl(e)||rx(e);function Ese(e,t,n=300){let{scrollHeight:s,style:r}=e;requestAnimationFrame(()=>{r.minHeight="initial",r.height=s+"px",r.transition=`all ${n}ms`,requestAnimationFrame(()=>{r.height="0",r.padding="0",r.margin="0",setTimeout(t,n)})})}function Lse({enter:e,exit:t,appendPosition:n=!1,collapse:s=!0,collapseDuration:r=300}){return function({children:i,position:o,preventExitTransition:l,done:c,nodeRef:u,isIn:d,playToast:h}){let p=n?`${e}--${o}`:e,x=n?`${t}--${o}`:t,v=f.useRef(0);return f.useLayoutEffect(()=>{let j=u.current,y=p.split(" "),N=w=>{w.target===u.current&&(h(),j.removeEventListener("animationend",N),j.removeEventListener("animationcancel",N),v.current===0&&w.type!=="animationcancel"&&j.classList.remove(...y))};j.classList.add(...y),j.addEventListener("animationend",N),j.addEventListener("animationcancel",N)},[]),f.useEffect(()=>{let j=u.current,y=()=>{j.removeEventListener("animationend",y),s?Ese(j,c,r):c()};d||(l?y():(v.current=1,j.className+=` ${x}`,j.addEventListener("animationend",y)))},[d]),wt.createElement(wt.Fragment,null,i)}}function jI(e,t){return{content:MH(e.content,e.props),containerId:e.props.containerId,id:e.props.toastId,theme:e.props.theme,type:e.props.type,data:e.props.data||{},isLoading:e.props.isLoading,icon:e.props.icon,reason:e.removalReason,status:t}}function MH(e,t,n=!1){return f.isValidElement(e)&&!Eu(e.type)?f.cloneElement(e,{closeToast:t.closeToast,toastProps:t,data:t.data,isPaused:n}):zl(e)?e({closeToast:t.closeToast,toastProps:t,data:t.data,isPaused:n}):e}function Pse({closeToast:e,theme:t,ariaLabel:n="close"}){return wt.createElement("button",{className:`Toastify__close-button Toastify__close-button--${t}`,type:"button",onClick:s=>{s.stopPropagation(),e(!0)},"aria-label":n},wt.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},wt.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}function Dse({delay:e,isRunning:t,closeToast:n,type:s="default",hide:r,className:i,controlledProgress:o,progress:l,rtl:c,isIn:u,theme:d}){let h=r||o&&l===0,p={animationDuration:`${e}ms`,animationPlayState:t?"running":"paused"};o&&(p.transform=`scaleX(${l})`);let x=$t("Toastify__progress-bar",o?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${d}`,`Toastify__progress-bar--${s}`,{"Toastify__progress-bar--rtl":c}),v=zl(i)?i({rtl:c,type:s,defaultClassName:x}):$t(x,i),j={[o&&l>=1?"onTransitionEnd":"onAnimationEnd"]:o&&l<1?null:()=>{u&&n()}};return wt.createElement("div",{className:"Toastify__progress-bar--wrp","data-hidden":h},wt.createElement("div",{className:`Toastify__progress-bar--bg Toastify__progress-bar-theme--${d} Toastify__progress-bar--${s}`}),wt.createElement("div",{role:"progressbar","aria-hidden":h?"true":"false","aria-label":"notification timer",className:v,style:p,...j}))}var Ose=1,IH=()=>`${Ose++}`;function Mse(e,t,n){let s=1,r=0,i=[],o=[],l=t,c=new Map,u=new Set,d=w=>(u.add(w),()=>u.delete(w)),h=()=>{o=Array.from(c.values()),u.forEach(w=>w())},p=({containerId:w,toastId:S,updateId:_})=>{let k=w?w!==e:e!==1,T=c.has(S)&&_==null;return k||T},x=(w,S)=>{c.forEach(_=>{var k;(S==null||S===_.props.toastId)&&((k=_.toggle)==null||k.call(_,w))})},v=w=>{var S,_;(_=(S=w.props)==null?void 0:S.onClose)==null||_.call(S,w.removalReason),w.isActive=!1},j=w=>{if(w==null)c.forEach(v);else{let S=c.get(w);S&&v(S)}h()},y=()=>{r-=i.length,i=[]},N=w=>{var S,_;let{toastId:k,updateId:T}=w.props,A=T==null;w.staleId&&c.delete(w.staleId),w.isActive=!0,c.set(k,w),h(),n(jI(w,A?"added":"updated")),A&&((_=(S=w.props).onOpen)==null||_.call(S))};return{id:e,props:l,observe:d,toggle:x,removeToast:j,toasts:c,clearQueue:y,buildToast:(w,S)=>{if(p(S))return;let{toastId:_,updateId:k,data:T,staleId:A,delay:E}=S,M=k==null;M&&r++;let z={...l,style:l.toastStyle,key:s++,...Object.fromEntries(Object.entries(S).filter(([D,U])=>U!=null)),toastId:_,updateId:k,data:T,isIn:!1,className:VT(S.className||l.toastClassName),progressClassName:VT(S.progressClassName||l.progressClassName),autoClose:S.isLoading?!1:kse(S.autoClose,l.autoClose),closeToast(D){c.get(_).removalReason=D,j(_)},deleteToast(){let D=c.get(_);if(D!=null){if(n(jI(D,"removed")),c.delete(_),r--,r<0&&(r=0),i.length>0){N(i.shift());return}h()}}};z.closeButton=l.closeButton,S.closeButton===!1||YT(S.closeButton)?z.closeButton=S.closeButton:S.closeButton===!0&&(z.closeButton=YT(l.closeButton)?l.closeButton:!0);let P={content:w,props:z,staleId:A};l.limit&&l.limit>0&&r>l.limit&&M?i.push(P):rx(E)?setTimeout(()=>{N(P)},E):N(P)},setProps(w){l=w},setToggle:(w,S)=>{let _=c.get(w);_&&(_.toggle=S)},isToastActive:w=>{var S;return(S=c.get(w))==null?void 0:S.isActive},getSnapshot:()=>o}}var Ws=new Map,xp=[],QT=new Set,Ise=e=>QT.forEach(t=>t(e)),$H=()=>Ws.size>0;function $se(){xp.forEach(e=>zH(e.content,e.options)),xp=[]}var Rse=(e,{containerId:t})=>{var n;return(n=Ws.get(t||1))==null?void 0:n.toasts.get(e)};function RH(e,t){var n;if(t)return!!((n=Ws.get(t))!=null&&n.isToastActive(e));let s=!1;return Ws.forEach(r=>{r.isToastActive(e)&&(s=!0)}),s}function zse(e){if(!$H()){xp=xp.filter(t=>e!=null&&t.options.toastId!==e);return}if(e==null||Tse(e))Ws.forEach(t=>{t.removeToast(e)});else if(e&&("containerId"in e||"id"in e)){let t=Ws.get(e.containerId);t?t.removeToast(e.id):Ws.forEach(n=>{n.removeToast(e.id)})}}var Fse=(e={})=>{Ws.forEach(t=>{t.props.limit&&(!e.containerId||t.id===e.containerId)&&t.clearQueue()})};function zH(e,t){YT(e)&&($H()||xp.push({content:e,options:t}),Ws.forEach(n=>{n.buildToast(e,t)}))}function Use(e){var t;(t=Ws.get(e.containerId||1))==null||t.setToggle(e.id,e.fn)}function FH(e,t){Ws.forEach(n=>{(t==null||!(t!=null&&t.containerId)||t?.containerId===n.id)&&n.toggle(e,t?.id)})}function Bse(e){let t=e.containerId||1;return{subscribe(n){let s=Mse(t,e,Ise);Ws.set(t,s);let r=s.observe(n);return $se(),()=>{r(),Ws.delete(t)}},setProps(n){var s;(s=Ws.get(t))==null||s.setProps(n)},getSnapshot(){var n;return(n=Ws.get(t))==null?void 0:n.getSnapshot()}}}function Hse(e){return QT.add(e),()=>{QT.delete(e)}}function qse(e){return e&&(Eu(e.toastId)||rx(e.toastId))?e.toastId:IH()}function ix(e,t){return zH(e,t),t.toastId}function ij(e,t){return{...t,type:t&&t.type||e,toastId:qse(t)}}function oj(e){return(t,n)=>ix(t,ij(e,n))}function H(e,t){return ix(e,ij("default",t))}H.loading=(e,t)=>ix(e,ij("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...t}));function Gse(e,{pending:t,error:n,success:s},r){let i;t&&(i=Eu(t)?H.loading(t,r):H.loading(t.render,{...r,...t}));let o={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},l=(u,d,h)=>{if(d==null){H.dismiss(i);return}let p={type:u,...o,...r,data:h},x=Eu(d)?{render:d}:d;return i?H.update(i,{...p,...x}):H(x.render,{...p,...x}),h},c=zl(e)?e():e;return c.then(u=>l("success",s,u)).catch(u=>l("error",n,u)),c}H.promise=Gse;H.success=oj("success");H.info=oj("info");H.error=oj("error");H.warning=oj("warning");H.warn=H.warning;H.dark=(e,t)=>ix(e,ij("default",{theme:"dark",...t}));function Wse(e){zse(e)}H.dismiss=Wse;H.clearWaitingQueue=Fse;H.isActive=RH;H.update=(e,t={})=>{let n=Rse(e,t);if(n){let{props:s,content:r}=n,i={delay:100,...s,...t,toastId:t.toastId||e,updateId:IH()};i.toastId!==e&&(i.staleId=e);let o=i.render||r;delete i.render,ix(o,i)}};H.done=e=>{H.update(e,{progress:1})};H.onChange=Hse;H.play=e=>FH(!0,e);H.pause=e=>FH(!1,e);function Vse(e){var t;let{subscribe:n,getSnapshot:s,setProps:r}=f.useRef(Bse(e)).current;r(e);let i=(t=f.useSyncExternalStore(n,s,s))==null?void 0:t.slice();function o(l){if(!i)return[];let c=new Map;return e.newestOnTop&&i.reverse(),i.forEach(u=>{let{position:d}=u.props;c.has(d)||c.set(d,[]),c.get(d).push(u)}),Array.from(c,u=>l(u[0],u[1]))}return{getToastToRender:o,isToastActive:RH,count:i?.length}}function Yse(e){let[t,n]=f.useState(!1),[s,r]=f.useState(!1),i=f.useRef(null),o=f.useRef({start:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,didMove:!1}).current,{autoClose:l,pauseOnHover:c,closeToast:u,onClick:d,closeOnClick:h}=e;Use({id:e.toastId,containerId:e.containerId,fn:n}),f.useEffect(()=>{if(e.pauseOnFocusLoss)return p(),()=>{x()}},[e.pauseOnFocusLoss]);function p(){document.hasFocus()||N(),window.addEventListener("focus",y),window.addEventListener("blur",N)}function x(){window.removeEventListener("focus",y),window.removeEventListener("blur",N)}function v(A){if(e.draggable===!0||e.draggable===A.pointerType){w();let E=i.current;o.canCloseOnClick=!0,o.canDrag=!0,E.style.transition="none",e.draggableDirection==="x"?(o.start=A.clientX,o.removalDistance=E.offsetWidth*(e.draggablePercent/100)):(o.start=A.clientY,o.removalDistance=E.offsetHeight*(e.draggablePercent===80?e.draggablePercent*1.5:e.draggablePercent)/100)}}function j(A){let{top:E,bottom:M,left:z,right:P}=i.current.getBoundingClientRect();A.nativeEvent.type!=="touchend"&&e.pauseOnHover&&A.clientX>=z&&A.clientX<=P&&A.clientY>=E&&A.clientY<=M?N():y()}function y(){n(!0)}function N(){n(!1)}function w(){o.didMove=!1,document.addEventListener("pointermove",_),document.addEventListener("pointerup",k)}function S(){document.removeEventListener("pointermove",_),document.removeEventListener("pointerup",k)}function _(A){let E=i.current;if(o.canDrag&&E){o.didMove=!0,t&&N(),e.draggableDirection==="x"?o.delta=A.clientX-o.start:o.delta=A.clientY-o.start,o.start!==A.clientX&&(o.canCloseOnClick=!1);let M=e.draggableDirection==="x"?`${o.delta}px, var(--y)`:`0, calc(${o.delta}px + var(--y))`;E.style.transform=`translate3d(${M},0)`,E.style.opacity=`${1-Math.abs(o.delta/o.removalDistance)}`}}function k(){S();let A=i.current;if(o.canDrag&&o.didMove&&A){if(o.canDrag=!1,Math.abs(o.delta)>o.removalDistance){r(!0),e.closeToast(!0),e.collapseAll();return}A.style.transition="transform 0.2s, opacity 0.2s",A.style.removeProperty("transform"),A.style.removeProperty("opacity")}}let T={onPointerDown:v,onPointerUp:j};return l&&c&&(T.onMouseEnter=N,e.stacked||(T.onMouseLeave=y)),h&&(T.onClick=A=>{d&&d(A),o.canCloseOnClick&&u(!0)}),{playToast:y,pauseToast:N,isRunning:t,preventExitTransition:s,toastRef:i,eventHandlers:T}}var Qse=typeof window<"u"?f.useLayoutEffect:f.useEffect,lj=({theme:e,type:t,isLoading:n,...s})=>wt.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:e==="colored"?"currentColor":`var(--toastify-icon-color-${t})`,...s});function Kse(e){return wt.createElement(lj,{...e},wt.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))}function Xse(e){return wt.createElement(lj,{...e},wt.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))}function Zse(e){return wt.createElement(lj,{...e},wt.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))}function Jse(e){return wt.createElement(lj,{...e},wt.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))}function ere(){return wt.createElement("div",{className:"Toastify__spinner"})}var KT={info:Xse,warning:Kse,success:Zse,error:Jse,spinner:ere},tre=e=>e in KT;function are({theme:e,type:t,isLoading:n,icon:s}){let r=null,i={theme:e,type:t};return s===!1||(zl(s)?r=s({...i,isLoading:n}):f.isValidElement(s)?r=f.cloneElement(s,i):n?r=KT.spinner():tre(t)&&(r=KT[t](i))),r}var nre=e=>{let{isRunning:t,preventExitTransition:n,toastRef:s,eventHandlers:r,playToast:i}=Yse(e),{closeButton:o,children:l,autoClose:c,onClick:u,type:d,hideProgressBar:h,closeToast:p,transition:x,position:v,className:j,style:y,progressClassName:N,updateId:w,role:S,progress:_,rtl:k,toastId:T,deleteToast:A,isIn:E,isLoading:M,closeOnClick:z,theme:P,ariaLabel:D}=e,U=$t("Toastify__toast",`Toastify__toast-theme--${P}`,`Toastify__toast--${d}`,{"Toastify__toast--rtl":k},{"Toastify__toast--close-on-click":z}),B=zl(j)?j({rtl:k,position:v,type:d,defaultClassName:U}):$t(U,j),R=are(e),q=!!_||!c,Z={closeToast:p,type:d,theme:P},V=null;return o===!1||(zl(o)?V=o(Z):f.isValidElement(o)?V=f.cloneElement(o,Z):V=Pse(Z)),wt.createElement(x,{isIn:E,done:A,position:v,preventExitTransition:n,nodeRef:s,playToast:i},wt.createElement("div",{id:T,tabIndex:0,onClick:u,"data-in":E,className:B,...r,style:y,ref:s,...E&&{role:S,"aria-label":D}},R!=null&&wt.createElement("div",{className:$t("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!M})},R),MH(l,e,!t),V,!e.customProgressBar&&wt.createElement(Dse,{...w&&!q?{key:`p-${w}`}:{},rtl:k,theme:P,delay:c,isRunning:t,isIn:E,closeToast:p,hide:h,type:d,className:N,controlledProgress:q,progress:_||0})))},sre=(e,t=!1)=>({enter:`Toastify--animate Toastify__${e}-enter`,exit:`Toastify--animate Toastify__${e}-exit`,appendPosition:t}),rre=Lse(sre("bounce",!0)),ire={position:"top-right",transition:rre,autoClose:5e3,closeButton:!0,pauseOnHover:!0,pauseOnFocusLoss:!0,draggable:"touch",draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light","aria-label":"Notifications Alt+T",hotKeys:e=>e.altKey&&e.code==="KeyT"};function ore(e){let t={...ire,...e},n=e.stacked,[s,r]=f.useState(!0),i=f.useRef(null),{getToastToRender:o,isToastActive:l,count:c}=Vse(t),{className:u,style:d,rtl:h,containerId:p,hotKeys:x}=t;function v(y){let N=$t("Toastify__toast-container",`Toastify__toast-container--${y}`,{"Toastify__toast-container--rtl":h});return zl(u)?u({position:y,rtl:h,defaultClassName:N}):$t(N,VT(u))}function j(){n&&(r(!0),H.play())}return Qse(()=>{var y;if(n){let N=i.current.querySelectorAll('[data-in="true"]'),w=12,S=(y=t.position)==null?void 0:y.includes("top"),_=0,k=0;Array.from(N).reverse().forEach((T,A)=>{let E=T;E.classList.add("Toastify__toast--stacked"),A>0&&(E.dataset.collapsed=`${s}`),E.dataset.pos||(E.dataset.pos=S?"top":"bot");let M=_*(s?.2:1)+(s?0:w*A);E.style.setProperty("--y",`${S?M:M*-1}px`),E.style.setProperty("--g",`${w}`),E.style.setProperty("--s",`${1-(s?k:0)}`),_+=E.offsetHeight,k+=.025})}},[s,c,n]),f.useEffect(()=>{function y(N){var w;let S=i.current;x(N)&&((w=S.querySelector('[tabIndex="0"]'))==null||w.focus(),r(!1),H.pause()),N.key==="Escape"&&(document.activeElement===S||S!=null&&S.contains(document.activeElement))&&(r(!0),H.play())}return document.addEventListener("keydown",y),()=>{document.removeEventListener("keydown",y)}},[x]),wt.createElement("section",{ref:i,className:"Toastify",id:p,onMouseEnter:()=>{n&&(r(!1),H.pause())},onMouseLeave:j,"aria-live":"polite","aria-atomic":"false","aria-relevant":"additions text","aria-label":t["aria-label"]},o((y,N)=>{let w=N.length?{...d}:{...d,pointerEvents:"none"};return wt.createElement("div",{tabIndex:-1,className:v(y),"data-stacked":n,style:w,key:`c-${y}`},N.map(({content:S,props:_})=>wt.createElement(nre,{..._,stacked:n,collapseAll:j,isIn:l(_.toastId,_.containerId),key:`t-${_.key}`},S)))}))}function UH(e,t){return function(){return e.apply(t,arguments)}}const{toString:lre}=Object.prototype,{getPrototypeOf:bL}=Object,{iterator:cj,toStringTag:BH}=Symbol,dj=(e=>t=>{const n=lre.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),no=e=>(e=e.toLowerCase(),t=>dj(t)===e),uj=e=>t=>typeof t===e,{isArray:Zf}=Array,_f=uj("undefined");function ox(e){return e!==null&&!_f(e)&&e.constructor!==null&&!_f(e.constructor)&&gr(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const HH=no("ArrayBuffer");function cre(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&HH(e.buffer),t}const dre=uj("string"),gr=uj("function"),qH=uj("number"),lx=e=>e!==null&&typeof e=="object",ure=e=>e===!0||e===!1,rv=e=>{if(dj(e)!=="object")return!1;const t=bL(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(BH in e)&&!(cj in e)},mre=e=>{if(!lx(e)||ox(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},fre=no("Date"),hre=no("File"),gre=no("Blob"),pre=no("FileList"),xre=e=>lx(e)&&gr(e.pipe),yre=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||gr(e.append)&&((t=dj(e))==="formdata"||t==="object"&&gr(e.toString)&&e.toString()==="[object FormData]"))},bre=no("URLSearchParams"),[vre,wre,jre,Nre]=["ReadableStream","Request","Response","Headers"].map(no),Cre=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function cx(e,t,{allOwnKeys:n=!1}={}){if(e===null||typeof e>"u")return;let s,r;if(typeof e!="object"&&(e=[e]),Zf(e))for(s=0,r=e.length;s<r;s++)t.call(null,e[s],s,e);else{if(ox(e))return;const i=n?Object.getOwnPropertyNames(e):Object.keys(e),o=i.length;let l;for(s=0;s<o;s++)l=i[s],t.call(null,e[l],l,e)}}function GH(e,t){if(ox(e))return null;t=t.toLowerCase();const n=Object.keys(e);let s=n.length,r;for(;s-- >0;)if(r=n[s],t===r.toLowerCase())return r;return null}const uu=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,WH=e=>!_f(e)&&e!==uu;function XT(){const{caseless:e,skipUndefined:t}=WH(this)&&this||{},n={},s=(r,i)=>{const o=e&&GH(n,i)||i;rv(n[o])&&rv(r)?n[o]=XT(n[o],r):rv(r)?n[o]=XT({},r):Zf(r)?n[o]=r.slice():(!t||!_f(r))&&(n[o]=r)};for(let r=0,i=arguments.length;r<i;r++)arguments[r]&&cx(arguments[r],s);return n}const Sre=(e,t,n,{allOwnKeys:s}={})=>(cx(t,(r,i)=>{n&&gr(r)?e[i]=UH(r,n):e[i]=r},{allOwnKeys:s}),e),_re=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),Are=(e,t,n,s)=>{e.prototype=Object.create(t.prototype,s),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},Tre=(e,t,n,s)=>{let r,i,o;const l={};if(t=t||{},e==null)return t;do{for(r=Object.getOwnPropertyNames(e),i=r.length;i-- >0;)o=r[i],(!s||s(o,e,t))&&!l[o]&&(t[o]=e[o],l[o]=!0);e=n!==!1&&bL(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},kre=(e,t,n)=>{e=String(e),(n===void 0||n>e.length)&&(n=e.length),n-=t.length;const s=e.indexOf(t,n);return s!==-1&&s===n},Ere=e=>{if(!e)return null;if(Zf(e))return e;let t=e.length;if(!qH(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},Lre=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&bL(Uint8Array)),Pre=(e,t)=>{const s=(e&&e[cj]).call(e);let r;for(;(r=s.next())&&!r.done;){const i=r.value;t.call(e,i[0],i[1])}},Dre=(e,t)=>{let n;const s=[];for(;(n=e.exec(t))!==null;)s.push(n);return s},Ore=no("HTMLFormElement"),Mre=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,s,r){return s.toUpperCase()+r}),NI=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),Ire=no("RegExp"),VH=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),s={};cx(n,(r,i)=>{let o;(o=t(r,i,e))!==!1&&(s[i]=o||r)}),Object.defineProperties(e,s)},$re=e=>{VH(e,(t,n)=>{if(gr(e)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const s=e[n];if(gr(s)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},Rre=(e,t)=>{const n={},s=r=>{r.forEach(i=>{n[i]=!0})};return Zf(e)?s(e):s(String(e).split(t)),n},zre=()=>{},Fre=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function Ure(e){return!!(e&&gr(e.append)&&e[BH]==="FormData"&&e[cj])}const Bre=e=>{const t=new Array(10),n=(s,r)=>{if(lx(s)){if(t.indexOf(s)>=0)return;if(ox(s))return s;if(!("toJSON"in s)){t[r]=s;const i=Zf(s)?[]:{};return cx(s,(o,l)=>{const c=n(o,r+1);!_f(c)&&(i[l]=c)}),t[r]=void 0,i}}return s};return n(e,0)},Hre=no("AsyncFunction"),qre=e=>e&&(lx(e)||gr(e))&&gr(e.then)&&gr(e.catch),YH=((e,t)=>e?setImmediate:t?((n,s)=>(uu.addEventListener("message",({source:r,data:i})=>{r===uu&&i===n&&s.length&&s.shift()()},!1),r=>{s.push(r),uu.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",gr(uu.postMessage)),Gre=typeof queueMicrotask<"u"?queueMicrotask.bind(uu):typeof process<"u"&&process.nextTick||YH,Wre=e=>e!=null&&gr(e[cj]),ht={isArray:Zf,isArrayBuffer:HH,isBuffer:ox,isFormData:yre,isArrayBufferView:cre,isString:dre,isNumber:qH,isBoolean:ure,isObject:lx,isPlainObject:rv,isEmptyObject:mre,isReadableStream:vre,isRequest:wre,isResponse:jre,isHeaders:Nre,isUndefined:_f,isDate:fre,isFile:hre,isBlob:gre,isRegExp:Ire,isFunction:gr,isStream:xre,isURLSearchParams:bre,isTypedArray:Lre,isFileList:pre,forEach:cx,merge:XT,extend:Sre,trim:Cre,stripBOM:_re,inherits:Are,toFlatObject:Tre,kindOf:dj,kindOfTest:no,endsWith:kre,toArray:Ere,forEachEntry:Pre,matchAll:Dre,isHTMLForm:Ore,hasOwnProperty:NI,hasOwnProp:NI,reduceDescriptors:VH,freezeMethods:$re,toObjectSet:Rre,toCamelCase:Mre,noop:zre,toFiniteNumber:Fre,findKey:GH,global:uu,isContextDefined:WH,isSpecCompliantForm:Ure,toJSONObject:Bre,isAsyncFn:Hre,isThenable:qre,setImmediate:YH,asap:Gre,isIterable:Wre};function la(e,t,n,s,r){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),s&&(this.request=s),r&&(this.response=r,this.status=r.status?r.status:null)}ht.inherits(la,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ht.toJSONObject(this.config),code:this.code,status:this.status}}});const QH=la.prototype,KH={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{KH[e]={value:e}});Object.defineProperties(la,KH);Object.defineProperty(QH,"isAxiosError",{value:!0});la.from=(e,t,n,s,r,i)=>{const o=Object.create(QH);ht.toFlatObject(e,o,function(d){return d!==Error.prototype},u=>u!=="isAxiosError");const l=e&&e.message?e.message:"Error",c=t==null&&e?e.code:t;return la.call(o,l,c,n,s,r),e&&o.cause==null&&Object.defineProperty(o,"cause",{value:e,configurable:!0}),o.name=e&&e.name||"Error",i&&Object.assign(o,i),o};const Vre=null;function ZT(e){return ht.isPlainObject(e)||ht.isArray(e)}function XH(e){return ht.endsWith(e,"[]")?e.slice(0,-2):e}function CI(e,t,n){return e?e.concat(t).map(function(r,i){return r=XH(r),!n&&i?"["+r+"]":r}).join(n?".":""):t}function Yre(e){return ht.isArray(e)&&!e.some(ZT)}const Qre=ht.toFlatObject(ht,{},null,function(t){return/^is[A-Z]/.test(t)});function mj(e,t,n){if(!ht.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,n=ht.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(j,y){return!ht.isUndefined(y[j])});const s=n.metaTokens,r=n.visitor||d,i=n.dots,o=n.indexes,c=(n.Blob||typeof Blob<"u"&&Blob)&&ht.isSpecCompliantForm(t);if(!ht.isFunction(r))throw new TypeError("visitor must be a function");function u(v){if(v===null)return"";if(ht.isDate(v))return v.toISOString();if(ht.isBoolean(v))return v.toString();if(!c&&ht.isBlob(v))throw new la("Blob is not supported. Use a Buffer instead.");return ht.isArrayBuffer(v)||ht.isTypedArray(v)?c&&typeof Blob=="function"?new Blob([v]):Buffer.from(v):v}function d(v,j,y){let N=v;if(v&&!y&&typeof v=="object"){if(ht.endsWith(j,"{}"))j=s?j:j.slice(0,-2),v=JSON.stringify(v);else if(ht.isArray(v)&&Yre(v)||(ht.isFileList(v)||ht.endsWith(j,"[]"))&&(N=ht.toArray(v)))return j=XH(j),N.forEach(function(S,_){!(ht.isUndefined(S)||S===null)&&t.append(o===!0?CI([j],_,i):o===null?j:j+"[]",u(S))}),!1}return ZT(v)?!0:(t.append(CI(y,j,i),u(v)),!1)}const h=[],p=Object.assign(Qre,{defaultVisitor:d,convertValue:u,isVisitable:ZT});function x(v,j){if(!ht.isUndefined(v)){if(h.indexOf(v)!==-1)throw Error("Circular reference detected in "+j.join("."));h.push(v),ht.forEach(v,function(N,w){(!(ht.isUndefined(N)||N===null)&&r.call(t,N,ht.isString(w)?w.trim():w,j,p))===!0&&x(N,j?j.concat(w):[w])}),h.pop()}}if(!ht.isObject(e))throw new TypeError("data must be an object");return x(e),t}function SI(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(s){return t[s]})}function vL(e,t){this._pairs=[],e&&mj(e,this,t)}const ZH=vL.prototype;ZH.append=function(t,n){this._pairs.push([t,n])};ZH.toString=function(t){const n=t?function(s){return t.call(this,s,SI)}:SI;return this._pairs.map(function(r){return n(r[0])+"="+n(r[1])},"").join("&")};function Kre(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function JH(e,t,n){if(!t)return e;const s=n&&n.encode||Kre;ht.isFunction(n)&&(n={serialize:n});const r=n&&n.serialize;let i;if(r?i=r(t,n):i=ht.isURLSearchParams(t)?t.toString():new vL(t,n).toString(s),i){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+i}return e}class _I{constructor(){this.handlers=[]}use(t,n,s){return this.handlers.push({fulfilled:t,rejected:n,synchronous:s?s.synchronous:!1,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){ht.forEach(this.handlers,function(s){s!==null&&t(s)})}}const e9={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Xre=typeof URLSearchParams<"u"?URLSearchParams:vL,Zre=typeof FormData<"u"?FormData:null,Jre=typeof Blob<"u"?Blob:null,eie={isBrowser:!0,classes:{URLSearchParams:Xre,FormData:Zre,Blob:Jre},protocols:["http","https","file","blob","url","data"]},wL=typeof window<"u"&&typeof document<"u",JT=typeof navigator=="object"&&navigator||void 0,tie=wL&&(!JT||["ReactNative","NativeScript","NS"].indexOf(JT.product)<0),aie=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",nie=wL&&window.location.href||"http://localhost",sie=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:wL,hasStandardBrowserEnv:tie,hasStandardBrowserWebWorkerEnv:aie,navigator:JT,origin:nie},Symbol.toStringTag,{value:"Module"})),Ms={...sie,...eie};function rie(e,t){return mj(e,new Ms.classes.URLSearchParams,{visitor:function(n,s,r,i){return Ms.isNode&&ht.isBuffer(n)?(this.append(s,n.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...t})}function iie(e){return ht.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function oie(e){const t={},n=Object.keys(e);let s;const r=n.length;let i;for(s=0;s<r;s++)i=n[s],t[i]=e[i];return t}function t9(e){function t(n,s,r,i){let o=n[i++];if(o==="__proto__")return!0;const l=Number.isFinite(+o),c=i>=n.length;return o=!o&&ht.isArray(r)?r.length:o,c?(ht.hasOwnProp(r,o)?r[o]=[r[o],s]:r[o]=s,!l):((!r[o]||!ht.isObject(r[o]))&&(r[o]=[]),t(n,s,r[o],i)&&ht.isArray(r[o])&&(r[o]=oie(r[o])),!l)}if(ht.isFormData(e)&&ht.isFunction(e.entries)){const n={};return ht.forEachEntry(e,(s,r)=>{t(iie(s),r,n,0)}),n}return null}function lie(e,t,n){if(ht.isString(e))try{return(t||JSON.parse)(e),ht.trim(e)}catch(s){if(s.name!=="SyntaxError")throw s}return(n||JSON.stringify)(e)}const dx={transitional:e9,adapter:["xhr","http","fetch"],transformRequest:[function(t,n){const s=n.getContentType()||"",r=s.indexOf("application/json")>-1,i=ht.isObject(t);if(i&&ht.isHTMLForm(t)&&(t=new FormData(t)),ht.isFormData(t))return r?JSON.stringify(t9(t)):t;if(ht.isArrayBuffer(t)||ht.isBuffer(t)||ht.isStream(t)||ht.isFile(t)||ht.isBlob(t)||ht.isReadableStream(t))return t;if(ht.isArrayBufferView(t))return t.buffer;if(ht.isURLSearchParams(t))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let l;if(i){if(s.indexOf("application/x-www-form-urlencoded")>-1)return rie(t,this.formSerializer).toString();if((l=ht.isFileList(t))||s.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return mj(l?{"files[]":t}:t,c&&new c,this.formSerializer)}}return i||r?(n.setContentType("application/json",!1),lie(t)):t}],transformResponse:[function(t){const n=this.transitional||dx.transitional,s=n&&n.forcedJSONParsing,r=this.responseType==="json";if(ht.isResponse(t)||ht.isReadableStream(t))return t;if(t&&ht.isString(t)&&(s&&!this.responseType||r)){const o=!(n&&n.silentJSONParsing)&&r;try{return JSON.parse(t,this.parseReviver)}catch(l){if(o)throw l.name==="SyntaxError"?la.from(l,la.ERR_BAD_RESPONSE,this,null,this.response):l}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Ms.classes.FormData,Blob:Ms.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ht.forEach(["delete","get","head","post","put","patch"],e=>{dx.headers[e]={}});const cie=ht.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),die=e=>{const t={};let n,s,r;return e&&e.split(`
`).forEach(function(o){r=o.indexOf(":"),n=o.substring(0,r).trim().toLowerCase(),s=o.substring(r+1).trim(),!(!n||t[n]&&cie[n])&&(n==="set-cookie"?t[n]?t[n].push(s):t[n]=[s]:t[n]=t[n]?t[n]+", "+s:s)}),t},AI=Symbol("internals");function hg(e){return e&&String(e).trim().toLowerCase()}function iv(e){return e===!1||e==null?e:ht.isArray(e)?e.map(iv):String(e)}function uie(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let s;for(;s=n.exec(e);)t[s[1]]=s[2];return t}const mie=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function JS(e,t,n,s,r){if(ht.isFunction(s))return s.call(this,t,n);if(r&&(t=n),!!ht.isString(t)){if(ht.isString(s))return t.indexOf(s)!==-1;if(ht.isRegExp(s))return s.test(t)}}function fie(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,n,s)=>n.toUpperCase()+s)}function hie(e,t){const n=ht.toCamelCase(" "+t);["get","set","has"].forEach(s=>{Object.defineProperty(e,s+n,{value:function(r,i,o){return this[s].call(this,t,r,i,o)},configurable:!0})})}let pr=class{constructor(t){t&&this.set(t)}set(t,n,s){const r=this;function i(l,c,u){const d=hg(c);if(!d)throw new Error("header name must be a non-empty string");const h=ht.findKey(r,d);(!h||r[h]===void 0||u===!0||u===void 0&&r[h]!==!1)&&(r[h||c]=iv(l))}const o=(l,c)=>ht.forEach(l,(u,d)=>i(u,d,c));if(ht.isPlainObject(t)||t instanceof this.constructor)o(t,n);else if(ht.isString(t)&&(t=t.trim())&&!mie(t))o(die(t),n);else if(ht.isObject(t)&&ht.isIterable(t)){let l={},c,u;for(const d of t){if(!ht.isArray(d))throw TypeError("Object iterator must return a key-value pair");l[u=d[0]]=(c=l[u])?ht.isArray(c)?[...c,d[1]]:[c,d[1]]:d[1]}o(l,n)}else t!=null&&i(n,t,s);return this}get(t,n){if(t=hg(t),t){const s=ht.findKey(this,t);if(s){const r=this[s];if(!n)return r;if(n===!0)return uie(r);if(ht.isFunction(n))return n.call(this,r,s);if(ht.isRegExp(n))return n.exec(r);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,n){if(t=hg(t),t){const s=ht.findKey(this,t);return!!(s&&this[s]!==void 0&&(!n||JS(this,this[s],s,n)))}return!1}delete(t,n){const s=this;let r=!1;function i(o){if(o=hg(o),o){const l=ht.findKey(s,o);l&&(!n||JS(s,s[l],l,n))&&(delete s[l],r=!0)}}return ht.isArray(t)?t.forEach(i):i(t),r}clear(t){const n=Object.keys(this);let s=n.length,r=!1;for(;s--;){const i=n[s];(!t||JS(this,this[i],i,t,!0))&&(delete this[i],r=!0)}return r}normalize(t){const n=this,s={};return ht.forEach(this,(r,i)=>{const o=ht.findKey(s,i);if(o){n[o]=iv(r),delete n[i];return}const l=t?fie(i):String(i).trim();l!==i&&delete n[i],n[l]=iv(r),s[l]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const n=Object.create(null);return ht.forEach(this,(s,r)=>{s!=null&&s!==!1&&(n[r]=t&&ht.isArray(s)?s.join(", "):s)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,n])=>t+": "+n).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...n){const s=new this(t);return n.forEach(r=>s.set(r)),s}static accessor(t){const s=(this[AI]=this[AI]={accessors:{}}).accessors,r=this.prototype;function i(o){const l=hg(o);s[l]||(hie(r,o),s[l]=!0)}return ht.isArray(t)?t.forEach(i):i(t),this}};pr.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);ht.reduceDescriptors(pr.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(s){this[n]=s}}});ht.freezeMethods(pr);function e2(e,t){const n=this||dx,s=t||n,r=pr.from(s.headers);let i=s.data;return ht.forEach(e,function(l){i=l.call(n,i,r.normalize(),t?t.status:void 0)}),r.normalize(),i}function a9(e){return!!(e&&e.__CANCEL__)}function Jf(e,t,n){la.call(this,e??"canceled",la.ERR_CANCELED,t,n),this.name="CanceledError"}ht.inherits(Jf,la,{__CANCEL__:!0});function n9(e,t,n){const s=n.config.validateStatus;!n.status||!s||s(n.status)?e(n):t(new la("Request failed with status code "+n.status,[la.ERR_BAD_REQUEST,la.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function gie(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function pie(e,t){e=e||10;const n=new Array(e),s=new Array(e);let r=0,i=0,o;return t=t!==void 0?t:1e3,function(c){const u=Date.now(),d=s[i];o||(o=u),n[r]=c,s[r]=u;let h=i,p=0;for(;h!==r;)p+=n[h++],h=h%e;if(r=(r+1)%e,r===i&&(i=(i+1)%e),u-o<t)return;const x=d&&u-d;return x?Math.round(p*1e3/x):void 0}}function xie(e,t){let n=0,s=1e3/t,r,i;const o=(u,d=Date.now())=>{n=d,r=null,i&&(clearTimeout(i),i=null),e(...u)};return[(...u)=>{const d=Date.now(),h=d-n;h>=s?o(u,d):(r=u,i||(i=setTimeout(()=>{i=null,o(r)},s-h)))},()=>r&&o(r)]}const _v=(e,t,n=3)=>{let s=0;const r=pie(50,250);return xie(i=>{const o=i.loaded,l=i.lengthComputable?i.total:void 0,c=o-s,u=r(c),d=o<=l;s=o;const h={loaded:o,total:l,progress:l?o/l:void 0,bytes:c,rate:u||void 0,estimated:u&&l&&d?(l-o)/u:void 0,event:i,lengthComputable:l!=null,[t?"download":"upload"]:!0};e(h)},n)},TI=(e,t)=>{const n=e!=null;return[s=>t[0]({lengthComputable:n,total:e,loaded:s}),t[1]]},kI=e=>(...t)=>ht.asap(()=>e(...t)),yie=Ms.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,Ms.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(Ms.origin),Ms.navigator&&/(msie|trident)/i.test(Ms.navigator.userAgent)):()=>!0,bie=Ms.hasStandardBrowserEnv?{write(e,t,n,s,r,i){const o=[e+"="+encodeURIComponent(t)];ht.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),ht.isString(s)&&o.push("path="+s),ht.isString(r)&&o.push("domain="+r),i===!0&&o.push("secure"),document.cookie=o.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function vie(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function wie(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function s9(e,t,n){let s=!vie(t);return e&&(s||n==!1)?wie(e,t):t}const EI=e=>e instanceof pr?{...e}:e;function Lu(e,t){t=t||{};const n={};function s(u,d,h,p){return ht.isPlainObject(u)&&ht.isPlainObject(d)?ht.merge.call({caseless:p},u,d):ht.isPlainObject(d)?ht.merge({},d):ht.isArray(d)?d.slice():d}function r(u,d,h,p){if(ht.isUndefined(d)){if(!ht.isUndefined(u))return s(void 0,u,h,p)}else return s(u,d,h,p)}function i(u,d){if(!ht.isUndefined(d))return s(void 0,d)}function o(u,d){if(ht.isUndefined(d)){if(!ht.isUndefined(u))return s(void 0,u)}else return s(void 0,d)}function l(u,d,h){if(h in t)return s(u,d);if(h in e)return s(void 0,u)}const c={url:i,method:i,data:i,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:l,headers:(u,d,h)=>r(EI(u),EI(d),h,!0)};return ht.forEach(Object.keys({...e,...t}),function(d){const h=c[d]||r,p=h(e[d],t[d],d);ht.isUndefined(p)&&h!==l||(n[d]=p)}),n}const r9=e=>{const t=Lu({},e);let{data:n,withXSRFToken:s,xsrfHeaderName:r,xsrfCookieName:i,headers:o,auth:l}=t;if(t.headers=o=pr.from(o),t.url=JH(s9(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),l&&o.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),ht.isFormData(n)){if(Ms.hasStandardBrowserEnv||Ms.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(ht.isFunction(n.getHeaders)){const c=n.getHeaders(),u=["content-type","content-length"];Object.entries(c).forEach(([d,h])=>{u.includes(d.toLowerCase())&&o.set(d,h)})}}if(Ms.hasStandardBrowserEnv&&(s&&ht.isFunction(s)&&(s=s(t)),s||s!==!1&&yie(t.url))){const c=r&&i&&bie.read(i);c&&o.set(r,c)}return t},jie=typeof XMLHttpRequest<"u",Nie=jie&&function(e){return new Promise(function(n,s){const r=r9(e);let i=r.data;const o=pr.from(r.headers).normalize();let{responseType:l,onUploadProgress:c,onDownloadProgress:u}=r,d,h,p,x,v;function j(){x&&x(),v&&v(),r.cancelToken&&r.cancelToken.unsubscribe(d),r.signal&&r.signal.removeEventListener("abort",d)}let y=new XMLHttpRequest;y.open(r.method.toUpperCase(),r.url,!0),y.timeout=r.timeout;function N(){if(!y)return;const S=pr.from("getAllResponseHeaders"in y&&y.getAllResponseHeaders()),k={data:!l||l==="text"||l==="json"?y.responseText:y.response,status:y.status,statusText:y.statusText,headers:S,config:e,request:y};n9(function(A){n(A),j()},function(A){s(A),j()},k),y=null}"onloadend"in y?y.onloadend=N:y.onreadystatechange=function(){!y||y.readyState!==4||y.status===0&&!(y.responseURL&&y.responseURL.indexOf("file:")===0)||setTimeout(N)},y.onabort=function(){y&&(s(new la("Request aborted",la.ECONNABORTED,e,y)),y=null)},y.onerror=function(_){const k=_&&_.message?_.message:"Network Error",T=new la(k,la.ERR_NETWORK,e,y);T.event=_||null,s(T),y=null},y.ontimeout=function(){let _=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded";const k=r.transitional||e9;r.timeoutErrorMessage&&(_=r.timeoutErrorMessage),s(new la(_,k.clarifyTimeoutError?la.ETIMEDOUT:la.ECONNABORTED,e,y)),y=null},i===void 0&&o.setContentType(null),"setRequestHeader"in y&&ht.forEach(o.toJSON(),function(_,k){y.setRequestHeader(k,_)}),ht.isUndefined(r.withCredentials)||(y.withCredentials=!!r.withCredentials),l&&l!=="json"&&(y.responseType=r.responseType),u&&([p,v]=_v(u,!0),y.addEventListener("progress",p)),c&&y.upload&&([h,x]=_v(c),y.upload.addEventListener("progress",h),y.upload.addEventListener("loadend",x)),(r.cancelToken||r.signal)&&(d=S=>{y&&(s(!S||S.type?new Jf(null,e,y):S),y.abort(),y=null)},r.cancelToken&&r.cancelToken.subscribe(d),r.signal&&(r.signal.aborted?d():r.signal.addEventListener("abort",d)));const w=gie(r.url);if(w&&Ms.protocols.indexOf(w)===-1){s(new la("Unsupported protocol "+w+":",la.ERR_BAD_REQUEST,e));return}y.send(i||null)})},Cie=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let s=new AbortController,r;const i=function(u){if(!r){r=!0,l();const d=u instanceof Error?u:this.reason;s.abort(d instanceof la?d:new Jf(d instanceof Error?d.message:d))}};let o=t&&setTimeout(()=>{o=null,i(new la(`timeout ${t} of ms exceeded`,la.ETIMEDOUT))},t);const l=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(u=>{u.unsubscribe?u.unsubscribe(i):u.removeEventListener("abort",i)}),e=null)};e.forEach(u=>u.addEventListener("abort",i));const{signal:c}=s;return c.unsubscribe=()=>ht.asap(l),c}},Sie=function*(e,t){let n=e.byteLength;if(n<t){yield e;return}let s=0,r;for(;s<n;)r=s+t,yield e.slice(s,r),s=r},_ie=async function*(e,t){for await(const n of Aie(e))yield*Sie(n,t)},Aie=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:n,value:s}=await t.read();if(n)break;yield s}}finally{await t.cancel()}},LI=(e,t,n,s)=>{const r=_ie(e,t);let i=0,o,l=c=>{o||(o=!0,s&&s(c))};return new ReadableStream({async pull(c){try{const{done:u,value:d}=await r.next();if(u){l(),c.close();return}let h=d.byteLength;if(n){let p=i+=h;n(p)}c.enqueue(new Uint8Array(d))}catch(u){throw l(u),u}},cancel(c){return l(c),r.return()}},{highWaterMark:2})},PI=64*1024,{isFunction:$y}=ht,Tie=(({Request:e,Response:t})=>({Request:e,Response:t}))(ht.global),{ReadableStream:DI,TextEncoder:OI}=ht.global,MI=(e,...t)=>{try{return!!e(...t)}catch{return!1}},kie=e=>{e=ht.merge.call({skipUndefined:!0},Tie,e);const{fetch:t,Request:n,Response:s}=e,r=t?$y(t):typeof fetch=="function",i=$y(n),o=$y(s);if(!r)return!1;const l=r&&$y(DI),c=r&&(typeof OI=="function"?(v=>j=>v.encode(j))(new OI):async v=>new Uint8Array(await new n(v).arrayBuffer())),u=i&&l&&MI(()=>{let v=!1;const j=new n(Ms.origin,{body:new DI,method:"POST",get duplex(){return v=!0,"half"}}).headers.has("Content-Type");return v&&!j}),d=o&&l&&MI(()=>ht.isReadableStream(new s("").body)),h={stream:d&&(v=>v.body)};r&&["text","arrayBuffer","blob","formData","stream"].forEach(v=>{!h[v]&&(h[v]=(j,y)=>{let N=j&&j[v];if(N)return N.call(j);throw new la(`Response type '${v}' is not supported`,la.ERR_NOT_SUPPORT,y)})});const p=async v=>{if(v==null)return 0;if(ht.isBlob(v))return v.size;if(ht.isSpecCompliantForm(v))return(await new n(Ms.origin,{method:"POST",body:v}).arrayBuffer()).byteLength;if(ht.isArrayBufferView(v)||ht.isArrayBuffer(v))return v.byteLength;if(ht.isURLSearchParams(v)&&(v=v+""),ht.isString(v))return(await c(v)).byteLength},x=async(v,j)=>{const y=ht.toFiniteNumber(v.getContentLength());return y??p(j)};return async v=>{let{url:j,method:y,data:N,signal:w,cancelToken:S,timeout:_,onDownloadProgress:k,onUploadProgress:T,responseType:A,headers:E,withCredentials:M="same-origin",fetchOptions:z}=r9(v),P=t||fetch;A=A?(A+"").toLowerCase():"text";let D=Cie([w,S&&S.toAbortSignal()],_),U=null;const B=D&&D.unsubscribe&&(()=>{D.unsubscribe()});let R;try{if(T&&u&&y!=="get"&&y!=="head"&&(R=await x(E,N))!==0){let X=new n(j,{method:"POST",body:N,duplex:"half"}),se;if(ht.isFormData(N)&&(se=X.headers.get("content-type"))&&E.setContentType(se),X.body){const[ye,Ne]=TI(R,_v(kI(T)));N=LI(X.body,PI,ye,Ne)}}ht.isString(M)||(M=M?"include":"omit");const q=i&&"credentials"in n.prototype,Z={...z,signal:D,method:y.toUpperCase(),headers:E.normalize().toJSON(),body:N,duplex:"half",credentials:q?M:void 0};U=i&&new n(j,Z);let V=await(i?P(U,z):P(j,Z));const oe=d&&(A==="stream"||A==="response");if(d&&(k||oe&&B)){const X={};["status","statusText","headers"].forEach(fe=>{X[fe]=V[fe]});const se=ht.toFiniteNumber(V.headers.get("content-length")),[ye,Ne]=k&&TI(se,_v(kI(k),!0))||[];V=new s(LI(V.body,PI,ye,()=>{Ne&&Ne(),B&&B()}),X)}A=A||"text";let je=await h[ht.findKey(h,A)||"text"](V,v);return!oe&&B&&B(),await new Promise((X,se)=>{n9(X,se,{data:je,headers:pr.from(V.headers),status:V.status,statusText:V.statusText,config:v,request:U})})}catch(q){throw B&&B(),q&&q.name==="TypeError"&&/Load failed|fetch/i.test(q.message)?Object.assign(new la("Network Error",la.ERR_NETWORK,v,U),{cause:q.cause||q}):la.from(q,q&&q.code,v,U)}}},Eie=new Map,i9=e=>{let t=e?e.env:{};const{fetch:n,Request:s,Response:r}=t,i=[s,r,n];let o=i.length,l=o,c,u,d=Eie;for(;l--;)c=i[l],u=d.get(c),u===void 0&&d.set(c,u=l?new Map:kie(t)),d=u;return u};i9();const ek={http:Vre,xhr:Nie,fetch:{get:i9}};ht.forEach(ek,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const II=e=>`- ${e}`,Lie=e=>ht.isFunction(e)||e===null||e===!1,o9={getAdapter:(e,t)=>{e=ht.isArray(e)?e:[e];const{length:n}=e;let s,r;const i={};for(let o=0;o<n;o++){s=e[o];let l;if(r=s,!Lie(s)&&(r=ek[(l=String(s)).toLowerCase()],r===void 0))throw new la(`Unknown adapter '${l}'`);if(r&&(ht.isFunction(r)||(r=r.get(t))))break;i[l||"#"+o]=r}if(!r){const o=Object.entries(i).map(([c,u])=>`adapter ${c} `+(u===!1?"is not supported by the environment":"is not available in the build"));let l=n?o.length>1?`since :
`+o.map(II).join(`
`):" "+II(o[0]):"as no adapter specified";throw new la("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return r},adapters:ek};function t2(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Jf(null,e)}function $I(e){return t2(e),e.headers=pr.from(e.headers),e.data=e2.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),o9.getAdapter(e.adapter||dx.adapter,e)(e).then(function(s){return t2(e),s.data=e2.call(e,e.transformResponse,s),s.headers=pr.from(s.headers),s},function(s){return a9(s)||(t2(e),s&&s.response&&(s.response.data=e2.call(e,e.transformResponse,s.response),s.response.headers=pr.from(s.response.headers))),Promise.reject(s)})}const l9="1.12.2",fj={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{fj[e]=function(s){return typeof s===e||"a"+(t<1?"n ":" ")+e}});const RI={};fj.transitional=function(t,n,s){function r(i,o){return"[Axios v"+l9+"] Transitional option '"+i+"'"+o+(s?". "+s:"")}return(i,o,l)=>{if(t===!1)throw new la(r(o," has been removed"+(n?" in "+n:"")),la.ERR_DEPRECATED);return n&&!RI[o]&&(RI[o]=!0,console.warn(r(o," has been deprecated since v"+n+" and will be removed in the near future"))),t?t(i,o,l):!0}};fj.spelling=function(t){return(n,s)=>(console.warn(`${s} is likely a misspelling of ${t}`),!0)};function Pie(e,t,n){if(typeof e!="object")throw new la("options must be an object",la.ERR_BAD_OPTION_VALUE);const s=Object.keys(e);let r=s.length;for(;r-- >0;){const i=s[r],o=t[i];if(o){const l=e[i],c=l===void 0||o(l,i,e);if(c!==!0)throw new la("option "+i+" must be "+c,la.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new la("Unknown option "+i,la.ERR_BAD_OPTION)}}const ov={assertOptions:Pie,validators:fj},co=ov.validators;let vu=class{constructor(t){this.defaults=t||{},this.interceptors={request:new _I,response:new _I}}async request(t,n){try{return await this._request(t,n)}catch(s){if(s instanceof Error){let r={};Error.captureStackTrace?Error.captureStackTrace(r):r=new Error;const i=r.stack?r.stack.replace(/^.+\n/,""):"";try{s.stack?i&&!String(s.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(s.stack+=`
`+i):s.stack=i}catch{}}throw s}}_request(t,n){typeof t=="string"?(n=n||{},n.url=t):n=t||{},n=Lu(this.defaults,n);const{transitional:s,paramsSerializer:r,headers:i}=n;s!==void 0&&ov.assertOptions(s,{silentJSONParsing:co.transitional(co.boolean),forcedJSONParsing:co.transitional(co.boolean),clarifyTimeoutError:co.transitional(co.boolean)},!1),r!=null&&(ht.isFunction(r)?n.paramsSerializer={serialize:r}:ov.assertOptions(r,{encode:co.function,serialize:co.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),ov.assertOptions(n,{baseUrl:co.spelling("baseURL"),withXsrfToken:co.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let o=i&&ht.merge(i.common,i[n.method]);i&&ht.forEach(["delete","get","head","post","put","patch","common"],v=>{delete i[v]}),n.headers=pr.concat(o,i);const l=[];let c=!0;this.interceptors.request.forEach(function(j){typeof j.runWhen=="function"&&j.runWhen(n)===!1||(c=c&&j.synchronous,l.unshift(j.fulfilled,j.rejected))});const u=[];this.interceptors.response.forEach(function(j){u.push(j.fulfilled,j.rejected)});let d,h=0,p;if(!c){const v=[$I.bind(this),void 0];for(v.unshift(...l),v.push(...u),p=v.length,d=Promise.resolve(n);h<p;)d=d.then(v[h++],v[h++]);return d}p=l.length;let x=n;for(;h<p;){const v=l[h++],j=l[h++];try{x=v(x)}catch(y){j.call(this,y);break}}try{d=$I.call(this,x)}catch(v){return Promise.reject(v)}for(h=0,p=u.length;h<p;)d=d.then(u[h++],u[h++]);return d}getUri(t){t=Lu(this.defaults,t);const n=s9(t.baseURL,t.url,t.allowAbsoluteUrls);return JH(n,t.params,t.paramsSerializer)}};ht.forEach(["delete","get","head","options"],function(t){vu.prototype[t]=function(n,s){return this.request(Lu(s||{},{method:t,url:n,data:(s||{}).data}))}});ht.forEach(["post","put","patch"],function(t){function n(s){return function(i,o,l){return this.request(Lu(l||{},{method:t,headers:s?{"Content-Type":"multipart/form-data"}:{},url:i,data:o}))}}vu.prototype[t]=n(),vu.prototype[t+"Form"]=n(!0)});let Die=class c9{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(i){n=i});const s=this;this.promise.then(r=>{if(!s._listeners)return;let i=s._listeners.length;for(;i-- >0;)s._listeners[i](r);s._listeners=null}),this.promise.then=r=>{let i;const o=new Promise(l=>{s.subscribe(l),i=l}).then(r);return o.cancel=function(){s.unsubscribe(i)},o},t(function(i,o,l){s.reason||(s.reason=new Jf(i,o,l),n(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const n=this._listeners.indexOf(t);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const t=new AbortController,n=s=>{t.abort(s)};return this.subscribe(n),t.signal.unsubscribe=()=>this.unsubscribe(n),t.signal}static source(){let t;return{token:new c9(function(r){t=r}),cancel:t}}};function Oie(e){return function(n){return e.apply(null,n)}}function Mie(e){return ht.isObject(e)&&e.isAxiosError===!0}const tk={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(tk).forEach(([e,t])=>{tk[t]=e});function d9(e){const t=new vu(e),n=UH(vu.prototype.request,t);return ht.extend(n,vu.prototype,t,{allOwnKeys:!0}),ht.extend(n,t,null,{allOwnKeys:!0}),n.create=function(r){return d9(Lu(e,r))},n}const Mn=d9(dx);Mn.Axios=vu;Mn.CanceledError=Jf;Mn.CancelToken=Die;Mn.isCancel=a9;Mn.VERSION=l9;Mn.toFormData=mj;Mn.AxiosError=la;Mn.Cancel=Mn.CanceledError;Mn.all=function(t){return Promise.all(t)};Mn.spread=Oie;Mn.isAxiosError=Mie;Mn.mergeConfig=Lu;Mn.AxiosHeaders=pr;Mn.formToJSON=e=>t9(ht.isHTMLForm(e)?new FormData(e):e);Mn.getAdapter=o9.getAdapter;Mn.HttpStatusCode=tk;Mn.default=Mn;const{Axios:EVe,AxiosError:LVe,CanceledError:PVe,isCancel:DVe,CancelToken:OVe,VERSION:MVe,all:IVe,Cancel:$Ve,isAxiosError:RVe,spread:zVe,toFormData:FVe,AxiosHeaders:UVe,HttpStatusCode:BVe,formToJSON:HVe,getAdapter:qVe,mergeConfig:GVe}=Mn,Iie="https://crm.sari-sari.com",re=Mn.create({baseURL:`${Iie}/api`,withCredentials:!0,headers:{"Content-Type":"application/json"}});re.interceptors.request.use(e=>(console.log(` [${e.method?.toUpperCase()}] ${e.url}`),e),e=>Promise.reject(e));re.interceptors.response.use(e=>e,e=>(e.response?.status===401&&(console.warn(" Unauthorized  possible expired token or not logged in."),localStorage.clear(),window.location.href="/login"),Promise.reject(e)));const $ie="isLoggedIn",Ry="userRole",Ks=()=>{const[e,t]=f.useState(!!localStorage.getItem(Ry)),[n,s]=f.useState(localStorage.getItem(Ry)||""),r=kt();f.useEffect(()=>{const u=localStorage.getItem(Ry);u?(t(!0),s(u)):o()},[]);const i=u=>{localStorage.setItem(Ry,u.role),localStorage.setItem($ie,!0),t(!0),s(u.role)},o=()=>{localStorage.clear(),t(!1),s("")};return{isLoggedIn:e,logout:async()=>{try{await re.post("/auth/logout")}catch(u){console.log("Failed to logout from server:",u)}o(),r("/")},userRole:n,setUserRole:s,login:u=>{i(u),u.role==="Admin"?r("/super-admin/dashboard"):u.role==="CEO"?r("/admin/dashboard"):u.role==="Manager"?r("/manager/dashboard"):r("/")}}},uo=({children:e,requiredRole:t})=>{const{isLoggedIn:n,userRole:s}=Ks();if(!n)return a.jsx(ur,{to:"/",replace:!0});if(!t)return s.toUpperCase()==="ADMIN"?a.jsx(ur,{to:"/super-admin/dashboard",replace:!0}):s.toUpperCase()==="CEO"?a.jsx(ur,{to:"/admin/dashboard",replace:!0}):s==="GROUP MANAGER"?a.jsx(ur,{to:"/group-manager/dashboard",replace:!0}):s==="MANAGER"?a.jsx(ur,{to:"/manager/dashboard",replace:!0}):s==="SALES"?a.jsx(ur,{to:"/sales/dashboard",replace:!0}):a.jsx(ur,{to:"/",replace:!0});const r=s.toLowerCase(),i=t.toLowerCase();return r!==i?a.jsx(ur,{to:"/",replace:!0}):e};var u9={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},zI=wt.createContext&&wt.createContext(u9),Rie=["attr","size","title"];function zie(e,t){if(e==null)return{};var n=Fie(e,t),s,r;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)s=i[r],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function Fie(e,t){if(e==null)return{};var n={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;n[s]=e[s]}return n}function Av(){return Av=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Av.apply(this,arguments)}function FI(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function Tv(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?FI(Object(n),!0).forEach(function(s){Uie(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):FI(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function Uie(e,t,n){return t=Bie(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Bie(e){var t=Hie(e,"string");return typeof t=="symbol"?t:t+""}function Hie(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function m9(e){return e&&e.map((t,n)=>wt.createElement(t.tag,Tv({key:n},t.attr),m9(t.child)))}function Dt(e){return t=>wt.createElement(qie,Av({attr:Tv({},e.attr)},t),m9(e.child))}function qie(e){var t=n=>{var{attr:s,size:r,title:i}=e,o=zie(e,Rie),l=r||n.size||"1em",c;return n.className&&(c=n.className),e.className&&(c=(c?c+" ":"")+e.className),wt.createElement("svg",Av({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,s,o,{className:c,style:Tv(Tv({color:e.color||n.color},n.style),e.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),i&&wt.createElement("title",null,i),e.children)};return zI!==void 0?wt.createElement(zI.Consumer,null,n=>t(n)):t(u9)}function Yi(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"22 12 18 12 15 21 9 3 6 12 2 12"},child:[]}]})(e)}function Fl(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"line",attr:{x1:"12",y1:"8",x2:"12",y2:"12"},child:[]},{tag:"line",attr:{x1:"12",y1:"16",x2:"12.01",y2:"16"},child:[]}]})(e)}function Zt(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"21 8 21 21 3 21 3 8"},child:[]},{tag:"rect",attr:{x:"1",y:"3",width:"22",height:"5"},child:[]},{tag:"line",attr:{x1:"10",y1:"12",x2:"14",y2:"12"},child:[]}]})(e)}function hj(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"7",y1:"7",x2:"17",y2:"17"},child:[]},{tag:"polyline",attr:{points:"17 7 17 17 7 17"},child:[]}]})(e)}function ak(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"12",y1:"5",x2:"12",y2:"19"},child:[]},{tag:"polyline",attr:{points:"19 12 12 19 5 12"},child:[]}]})(e)}function Gie(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"19",y1:"12",x2:"5",y2:"12"},child:[]},{tag:"polyline",attr:{points:"12 19 5 12 12 5"},child:[]}]})(e)}function gj(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"5",y1:"12",x2:"19",y2:"12"},child:[]},{tag:"polyline",attr:{points:"12 5 19 12 12 19"},child:[]}]})(e)}function ux(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"7",y1:"17",x2:"17",y2:"7"},child:[]},{tag:"polyline",attr:{points:"7 7 17 7 17 17"},child:[]}]})(e)}function Wie(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"12",y1:"19",x2:"12",y2:"5"},child:[]},{tag:"polyline",attr:{points:"5 12 12 5 19 12"},child:[]}]})(e)}function a2(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"8",r:"7"},child:[]},{tag:"polyline",attr:{points:"8.21 13.89 7 23 12 20 17 23 15.79 13.88"},child:[]}]})(e)}function Vie(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"18",y1:"20",x2:"18",y2:"10"},child:[]},{tag:"line",attr:{x1:"12",y1:"20",x2:"12",y2:"4"},child:[]},{tag:"line",attr:{x1:"6",y1:"20",x2:"6",y2:"14"},child:[]}]})(e)}function mx(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"},child:[]},{tag:"path",attr:{d:"M13.73 21a2 2 0 0 1-3.46 0"},child:[]}]})(e)}function Yie(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"},child:[]},{tag:"path",attr:{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"},child:[]}]})(e)}function pj(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"},child:[]}]})(e)}function sa(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"2",y:"7",width:"20",height:"14",rx:"2",ry:"2"},child:[]},{tag:"path",attr:{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"},child:[]}]})(e)}function Ot(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"},child:[]},{tag:"line",attr:{x1:"16",y1:"2",x2:"16",y2:"6"},child:[]},{tag:"line",attr:{x1:"8",y1:"2",x2:"8",y2:"6"},child:[]},{tag:"line",attr:{x1:"3",y1:"10",x2:"21",y2:"10"},child:[]}]})(e)}function f9(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"},child:[]},{tag:"circle",attr:{cx:"12",cy:"13",r:"4"},child:[]}]})(e)}function Qa(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"},child:[]},{tag:"polyline",attr:{points:"22 4 12 14.01 9 11.01"},child:[]}]})(e)}function Qt(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"9 11 12 14 22 4"},child:[]},{tag:"path",attr:{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"},child:[]}]})(e)}function jL(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"20 6 9 17 4 12"},child:[]}]})(e)}function Pt(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"6 9 12 15 18 9"},child:[]}]})(e)}function Qie(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"15 18 9 12 15 6"},child:[]}]})(e)}function Mt(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"9 18 15 12 9 6"},child:[]}]})(e)}function Kie(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"18 15 12 9 6 15"},child:[]}]})(e)}function ks(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"},child:[]},{tag:"rect",attr:{x:"8",y:"2",width:"8",height:"4",rx:"1",ry:"1"},child:[]}]})(e)}function zs(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"polyline",attr:{points:"12 6 12 12 16 14"},child:[]}]})(e)}function h9(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"12",y1:"1",x2:"12",y2:"23"},child:[]},{tag:"path",attr:{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"},child:[]}]})(e)}function Vo(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"},child:[]},{tag:"polyline",attr:{points:"7 10 12 15 17 10"},child:[]},{tag:"line",attr:{x1:"12",y1:"15",x2:"12",y2:"3"},child:[]}]})(e)}function hn(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"},child:[]}]})(e)}function gn(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"},child:[]},{tag:"path",attr:{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"},child:[]}]})(e)}function Pu(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"},child:[]},{tag:"line",attr:{x1:"1",y1:"1",x2:"23",y2:"23"},child:[]}]})(e)}function md(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"},child:[]},{tag:"circle",attr:{cx:"12",cy:"12",r:"3"},child:[]}]})(e)}function ia(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"},child:[]},{tag:"polyline",attr:{points:"14 2 14 8 20 8"},child:[]},{tag:"line",attr:{x1:"16",y1:"13",x2:"8",y2:"13"},child:[]},{tag:"line",attr:{x1:"16",y1:"17",x2:"8",y2:"17"},child:[]},{tag:"polyline",attr:{points:"10 9 9 9 8 9"},child:[]}]})(e)}function Xie(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"},child:[]}]})(e)}function zy(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M3 18v-6a9 9 0 0 1 18 0v6"},child:[]},{tag:"path",attr:{d:"M21 19a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3zM3 19a2 2 0 0 0 2 2h1a2 2 0 0 0 2-2v-3a2 2 0 0 0-2-2H3z"},child:[]}]})(e)}function Zie(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"path",attr:{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"},child:[]},{tag:"line",attr:{x1:"12",y1:"17",x2:"12.01",y2:"17"},child:[]}]})(e)}function eh(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"},child:[]},{tag:"polyline",attr:{points:"9 22 9 12 15 12 15 22"},child:[]}]})(e)}function UI(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"},child:[]},{tag:"circle",attr:{cx:"8.5",cy:"8.5",r:"1.5"},child:[]},{tag:"polyline",attr:{points:"21 15 16 10 5 21"},child:[]}]})(e)}function g9(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"line",attr:{x1:"12",y1:"16",x2:"12",y2:"12"},child:[]},{tag:"line",attr:{x1:"12",y1:"8",x2:"12.01",y2:"8"},child:[]}]})(e)}function NL(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"},child:[]},{tag:"line",attr:{x1:"3",y1:"9",x2:"21",y2:"9"},child:[]},{tag:"line",attr:{x1:"9",y1:"21",x2:"9",y2:"9"},child:[]}]})(e)}function Po(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"},child:[]},{tag:"path",attr:{d:"M7 11V7a5 5 0 0 1 10 0v4"},child:[]}]})(e)}function Jie(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"},child:[]},{tag:"polyline",attr:{points:"16 17 21 12 16 7"},child:[]},{tag:"line",attr:{x1:"21",y1:"12",x2:"9",y2:"12"},child:[]}]})(e)}function rn(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"},child:[]},{tag:"polyline",attr:{points:"22,6 12,13 2,6"},child:[]}]})(e)}function eoe(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"},child:[]},{tag:"circle",attr:{cx:"12",cy:"10",r:"3"},child:[]}]})(e)}function th(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"3",y1:"12",x2:"21",y2:"12"},child:[]},{tag:"line",attr:{x1:"3",y1:"6",x2:"21",y2:"6"},child:[]},{tag:"line",attr:{x1:"3",y1:"18",x2:"21",y2:"18"},child:[]}]})(e)}function BI(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"},child:[]}]})(e)}function toe(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"5 9 2 12 5 15"},child:[]},{tag:"polyline",attr:{points:"9 5 12 2 15 5"},child:[]},{tag:"polyline",attr:{points:"15 19 12 22 9 19"},child:[]},{tag:"polyline",attr:{points:"19 9 22 12 19 15"},child:[]},{tag:"line",attr:{x1:"2",y1:"12",x2:"22",y2:"12"},child:[]},{tag:"line",attr:{x1:"12",y1:"2",x2:"12",y2:"22"},child:[]}]})(e)}function aoe(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"19",y1:"5",x2:"5",y2:"19"},child:[]},{tag:"circle",attr:{cx:"6.5",cy:"6.5",r:"2.5"},child:[]},{tag:"circle",attr:{cx:"17.5",cy:"17.5",r:"2.5"},child:[]}]})(e)}function Fs(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M15.05 5A5 5 0 0 1 19 8.95M15.05 1A9 9 0 0 1 23 8.94m-1 7.98v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"},child:[]}]})(e)}function It(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"},child:[]}]})(e)}function HI(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21.21 15.89A10 10 0 1 1 8 2.83"},child:[]},{tag:"path",attr:{d:"M22 12A10 10 0 0 0 12 2v10z"},child:[]}]})(e)}function aa(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"12",y1:"5",x2:"12",y2:"19"},child:[]},{tag:"line",attr:{x1:"5",y1:"12",x2:"19",y2:"12"},child:[]}]})(e)}function Br(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"23 4 23 10 17 10"},child:[]},{tag:"polyline",attr:{points:"1 20 1 14 7 14"},child:[]},{tag:"path",attr:{d:"M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"},child:[]}]})(e)}function CL(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"},child:[]},{tag:"polyline",attr:{points:"17 21 17 13 7 13 7 21"},child:[]},{tag:"polyline",attr:{points:"7 3 7 8 15 8"},child:[]}]})(e)}function Kt(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"11",cy:"11",r:"8"},child:[]},{tag:"line",attr:{x1:"21",y1:"21",x2:"16.65",y2:"16.65"},child:[]}]})(e)}function nk(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"22",y1:"2",x2:"11",y2:"13"},child:[]},{tag:"polygon",attr:{points:"22 2 15 22 11 13 2 9 22 2"},child:[]}]})(e)}function SL(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"3"},child:[]},{tag:"path",attr:{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"},child:[]}]})(e)}function xj(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"},child:[]}]})(e)}function fd(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"5",y:"2",width:"14",height:"20",rx:"2",ry:"2"},child:[]},{tag:"line",attr:{x1:"12",y1:"18",x2:"12.01",y2:"18"},child:[]}]})(e)}function ec(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"},child:[]}]})(e)}function fr(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"circle",attr:{cx:"12",cy:"12",r:"6"},child:[]},{tag:"circle",attr:{cx:"12",cy:"12",r:"2"},child:[]}]})(e)}function noe(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"1",y:"5",width:"22",height:"14",rx:"7",ry:"7"},child:[]},{tag:"circle",attr:{cx:"8",cy:"12",r:"3"},child:[]}]})(e)}function soe(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"1",y:"5",width:"22",height:"14",rx:"7",ry:"7"},child:[]},{tag:"circle",attr:{cx:"16",cy:"12",r:"3"},child:[]}]})(e)}function wa(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"3 6 5 6 21 6"},child:[]},{tag:"path",attr:{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"},child:[]},{tag:"line",attr:{x1:"10",y1:"11",x2:"10",y2:"17"},child:[]},{tag:"line",attr:{x1:"14",y1:"11",x2:"14",y2:"17"},child:[]}]})(e)}function n2(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"23 18 13.5 8.5 8.5 13.5 1 6"},child:[]},{tag:"polyline",attr:{points:"17 18 23 18 23 12"},child:[]}]})(e)}function cd(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"23 6 13.5 15.5 8.5 10.5 1 18"},child:[]},{tag:"polyline",attr:{points:"17 6 23 6 23 12"},child:[]}]})(e)}function roe(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"},child:[]},{tag:"polyline",attr:{points:"17 8 12 3 7 8"},child:[]},{tag:"line",attr:{x1:"12",y1:"3",x2:"12",y2:"15"},child:[]}]})(e)}function Qi(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"},child:[]},{tag:"circle",attr:{cx:"8.5",cy:"7",r:"4"},child:[]},{tag:"polyline",attr:{points:"17 11 19 13 23 9"},child:[]}]})(e)}function Xa(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"},child:[]},{tag:"circle",attr:{cx:"8.5",cy:"7",r:"4"},child:[]},{tag:"line",attr:{x1:"20",y1:"8",x2:"20",y2:"14"},child:[]},{tag:"line",attr:{x1:"23",y1:"11",x2:"17",y2:"11"},child:[]}]})(e)}function Ki(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"},child:[]},{tag:"circle",attr:{cx:"8.5",cy:"7",r:"4"},child:[]},{tag:"line",attr:{x1:"18",y1:"8",x2:"23",y2:"13"},child:[]},{tag:"line",attr:{x1:"23",y1:"8",x2:"18",y2:"13"},child:[]}]})(e)}function ra(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"},child:[]},{tag:"circle",attr:{cx:"12",cy:"7",r:"4"},child:[]}]})(e)}function Za(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"},child:[]},{tag:"circle",attr:{cx:"9",cy:"7",r:"4"},child:[]},{tag:"path",attr:{d:"M23 21v-2a4 4 0 0 0-3-3.87"},child:[]},{tag:"path",attr:{d:"M16 3.13a4 4 0 0 1 0 7.75"},child:[]}]})(e)}function Us(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"line",attr:{x1:"15",y1:"9",x2:"9",y2:"15"},child:[]},{tag:"line",attr:{x1:"9",y1:"9",x2:"15",y2:"15"},child:[]}]})(e)}function ea(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"18",y1:"6",x2:"6",y2:"18"},child:[]},{tag:"line",attr:{x1:"6",y1:"6",x2:"18",y2:"18"},child:[]}]})(e)}const p9=()=>{const[e,t]=f.useState(!1),n=f.useRef(null);return f.useEffect(()=>{const s=r=>{n.current&&!n.current.contains(r.target)&&t(!1)};return document.addEventListener("mousedown",s),()=>{document.removeEventListener("mousedown",s)}},[]),f.useEffect(()=>{const s=()=>{e&&t(!1)};return window.addEventListener("scroll",s),()=>{window.removeEventListener("scroll",s)}},[e]),a.jsx("header",{className:"sticky top-0 z-50 bg-tertiary shadow-xl border-b border-tertiary",children:a.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"flex items-center justify-between h-16",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsxs("span",{className:"text-2xl font-black text-white",children:["Sari-Sari ",a.jsx("span",{className:"text-accent",children:" CRM"})]})}),a.jsxs("nav",{className:"hidden md:flex space-x-8 text-white font-medium",children:[a.jsx("a",{href:"#platform",className:"hover:text-accent transition duration-150",children:"Platform"}),a.jsx("a",{href:"#pricing",className:"hover:text-accent transition duration-150",children:"Pricing"})]}),a.jsxs("div",{className:"hidden sm:flex items-center space-x-4",children:[a.jsx("a",{href:"/login",className:"text-sm font-medium text-white hover:text-accent transition duration-500",children:"Log In"}),a.jsx("a",{href:"/signup",className:"inline-flex items-center justify-center px-4 py-2 text-sm font-semibold rounded-full shadow-lg border border-secondary text-white bg-secondary hover:bg-accent hover:text-secondary hover:border-accent transition-all duration-500",children:"Start for Free"})]}),a.jsxs("div",{className:"flex sm:hidden items-center relative",ref:n,children:[a.jsx("button",{onClick:()=>t(!e),children:e?a.jsx(ea,{className:"w-6 h-6 text-white"}):a.jsx(th,{className:"w-6 h-6 text-white"})}),e&&a.jsx("div",{className:"absolute top-11 right-0 mt-2 w-48 border border-tertiary rounded-lg shadow-lg z-50 bg-primary",children:a.jsxs("nav",{className:"flex flex-col",children:[a.jsx("a",{href:"/login",className:"block px-4 py-2 text-center text-tertiary bg-white hover:bg-accent hover:text-secondary transition rounded-t-lg",children:"Log In"}),a.jsx("a",{href:"/signup",className:"block px-4 py-2 text-center text-tertiary bg-white hover:bg-secondary hover:text-white transition rounded-b-lg",children:"Start for Free"})]})})]})]})})})};function ioe(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"m12 14 4-4"},child:[]},{tag:"path",attr:{d:"M3.34 19a10 10 0 1 1 17.32 0"},child:[]}]})(e)}function tc(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0"},child:[]},{tag:"circle",attr:{cx:"12",cy:"10",r:"3"},child:[]}]})(e)}function ooe(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z"},child:[]}]})(e)}function yj(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"10",cy:"7",r:"4"},child:[]},{tag:"path",attr:{d:"M10.3 15H7a4 4 0 0 0-4 4v2"},child:[]},{tag:"circle",attr:{cx:"17",cy:"17",r:"3"},child:[]},{tag:"path",attr:{d:"m21 21-1.9-1.9"},child:[]}]})(e)}function loe(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"},child:[]},{tag:"circle",attr:{cx:"9",cy:"7",r:"4"},child:[]},{tag:"path",attr:{d:"M22 21v-2a4 4 0 0 0-3-3.87"},child:[]},{tag:"path",attr:{d:"M16 3.13a4 4 0 0 1 0 7.75"},child:[]}]})(e)}function coe(e){return Dt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z"},child:[]}]})(e)}const doe=()=>{const e=["/image/crm1.png","/image/crm2.png","/image/crm3.png","/image/crm4.png","/image/crm5.png","/image/crm7.png","/image/crm6.png"],[t,n]=f.useState(0),[s,r]=f.useState(!1),i=f.useRef(null),[o,l]=f.useState(0),[c,u]=f.useState(0);f.useEffect(()=>(s||(i.current=setInterval(()=>{n(x=>(x+1)%e.length)},4e3)),()=>clearInterval(i.current)),[s,e.length]);const d=x=>l(x.targetTouches[0].clientX),h=x=>u(x.targetTouches[0].clientX),p=()=>{o-c>75&&n(x=>(x+1)%e.length),c-o>75&&n(x=>(x-1+e.length)%e.length)};return a.jsx("section",{className:"bg-paper-white text-white py-15 lg:py-32",children:a.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 grid grid-cols-1 lg:grid-cols-2 gap-12 items-center",children:[a.jsxs("div",{className:"lg:text-left text-center",children:[a.jsxs("h1",{className:"text-5xl sm:text-6xl lg:text-7xl font-lg text-secondary mb-6 leading-tight",children:["Sari-Sari"," ",a.jsx("span",{className:"text-accent font-extrabold",children:"CRM"})]}),a.jsx("p",{className:"max-w-xl mx-auto lg:mx-0 text-lg sm:text-xl text-secondary mb-10 italic",children:"The CRM that keeps your customers organized and your sales growing."}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-center lg:justify-start space-y-4 sm:space-y-0 sm:space-x-4",children:[a.jsx("a",{href:"#",className:"px-10 py-3 rounded-lg border border-secondary text-white bg-secondary font-semibold hover:bg-accent hover:text-secondary hover:border-accent transition-all duration-500",children:"Get Started Now"}),a.jsx("a",{href:"#",className:"px-10 py-3 rounded-lg border border-secondary text-white bg-secondary hover:bg-accent hover:text-secondary hover:border-accent transition-all duration-500",children:"Watch Demo (2 min)"})]})]}),a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"hidden lg:block absolute inset-0 -top-10 -bottom-10 right-4 bg-accent rounded-3xl transform rotate-3 z-0"}),a.jsxs("div",{className:"relative z-10 overflow-hidden rounded-xl shadow-2xl border-4 border-gray-800 h-[400px] bg-gray-900 flex items-center justify-center",onMouseEnter:()=>r(!0),onMouseLeave:()=>r(!1),onTouchStart:d,onTouchMove:h,onTouchEnd:p,children:[e.map((x,v)=>a.jsx("img",{src:x,alt:`Slide ${v+1}`,className:`absolute inset-0 w-full h-full object-contain bg-gray-50 transition-opacity duration-1000 ease-in-out ${v===t?"opacity-100":"opacity-0"}`},v)),a.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 flex space-x-2",children:e.map((x,v)=>a.jsx("button",{onClick:()=>n(v),className:`w-3 h-3 rounded-full transition-all ${v===t?"bg-accent":"bg-gray-400 opacity-50"}`},v))})]})]})]})})},uoe=({Icon:e,title:t,description:n})=>a.jsxs("div",{className:"bg-gray-800 p-8 rounded-2xl border border-gray-700 hover:border-accent transition transform hover:-translate-y-1",children:[a.jsx("div",{className:"w-14 h-14 flex items-center justify-center rounded-full text-accent mb-6",children:a.jsx(e,{className:"w-8 h-8"})}),a.jsx("h3",{className:"text-xl font-semibold text-white mb-3",children:t}),a.jsx("p",{className:"text-gray-400",children:n})]}),moe=()=>{const e=[{Icon:coe,title:"Automated Workflows",description:"Automate tasks and focus on engagement."},{Icon:ioe,title:"Predictive Analytics",description:"Harness AI to forecast sales and risks."},{Icon:loe,title:"Unified Customer View",description:"360-degree profile for every customer."},{Icon:ooe,title:"Multi-Channel Support",description:"Engage across email, chat, and more."}];return a.jsx("section",{id:"platform",className:"py-20 bg-gray-900 border-t border-gray-800",children:a.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[a.jsx("h2",{className:"text-4xl sm:text-5xl font-bold text-white mb-4",children:"Engineered for Enterprise Scale"}),a.jsx("p",{className:"text-xl text-gray-400 mb-16",children:"Pillows is the neural network powering your customer relationships."}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8",children:e.map((t,n)=>a.jsx(uoe,{...t},n))})]})})},foe=()=>a.jsxs("section",{id:"pricing",className:"py-20 bg-paper-white border-t border-gray-800 text-center",children:[a.jsx("h2",{className:"text-4xl sm:text-5xl font-bold text-secondary mb-4",children:"Start Building Your Future, Today."}),a.jsx("p",{className:"text-xl text-gray-400 mb-10",children:"Join thousands leveraging Sari-Sari CRM's intelligent platform."}),a.jsx("a",{href:"/signup",className:"px-12 py-4 text-lg font-bold rounded-xl shadow-2xl bg-accent border border-secondary text-white bg-secondary hover:bg-accent hover:text-secondary hover:border-accent transition-all duration-400",children:"Start 15-Day Free Trial"})]}),hoe=()=>a.jsx("footer",{className:"bg-secondary text-white border-t py-10",children:a.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-5 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-8",children:[a.jsxs("div",{children:[a.jsxs("span",{className:"text-xl font-white",children:["Sari-Sari ",a.jsx("span",{className:"text-accent",children:"CRM"})]}),a.jsx("p",{className:"text-sm text-white mt-4",children:" 2026 Sari-Sari CRM"})]}),[{title:"Resources",links:["Security","Support"],href:"/resources"},{title:"Legal",links:["Terms","Privacy","SLA","Compliance"],href:"/legal"}].map((e,t)=>a.jsxs("div",{children:[a.jsx("h5",{className:"text-md font-semibold mb-4 text-accent",children:e.title}),a.jsx("ul",{className:"space-y-2 text-sm text-white",children:e.links.map((n,s)=>a.jsx("li",{children:a.jsx("a",{href:e.href,target:"_blank",rel:"noopener noreferrer",className:"hover:text-accent",children:n})},s))})]},t))]})}),goe=()=>(f.useEffect(()=>{document.title="Sari-Sari CRM"},[]),a.jsxs("main",{className:"font-inter",children:[a.jsx(p9,{}),a.jsx(doe,{}),a.jsx(moe,{}),a.jsx(foe,{}),a.jsx(hoe,{})]}));function Ku(e){return Dt({attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z",clipRule:"evenodd"},child:[]}]})(e)}function Ja(e){return Dt({attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"},child:[]}]})(e)}function ac(e){return Dt({attr:{fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"},child:[]}]})(e)}class Ug extends Error{}Ug.prototype.name="InvalidTokenError";function poe(e){return decodeURIComponent(atob(e).replace(/(.)/g,(t,n)=>{let s=n.charCodeAt(0).toString(16).toUpperCase();return s.length<2&&(s="0"+s),"%"+s}))}function xoe(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return poe(t)}catch{return atob(t)}}function x9(e,t){if(typeof e!="string")throw new Ug("Invalid token specified: must be a string");t||(t={});const n=t.header===!0?0:1,s=e.split(".")[n];if(typeof s!="string")throw new Ug(`Invalid token specified: missing part #${n+1}`);let r;try{r=xoe(s)}catch(i){throw new Ug(`Invalid token specified: invalid base64 for part #${n+1} (${i.message})`)}try{return JSON.parse(r)}catch(i){throw new Ug(`Invalid token specified: invalid json for part #${n+1} (${i.message})`)}}function Vn(e,t,n=void 0){const s={};for(const r in e){const i=e[r];let o="",l=!0;for(let c=0;c<i.length;c+=1){const u=i[c];u&&(o+=(l===!0?"":" ")+t(u),l=!1,n&&n[u]&&(o+=" "+n[u]))}s[r]=o}return s}function Du(e,...t){const n=new URL(`https://mui.com/production-error/?code=${e}`);return t.forEach(s=>n.searchParams.append("args[]",s)),`Minified MUI error #${e}; visit ${n} for the full message.`}function Wa(e){if(typeof e!="string")throw new Error(Du(7));return e.charAt(0).toUpperCase()+e.slice(1)}var s2={exports:{}},Ha={};var qI;function yoe(){if(qI)return Ha;qI=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),u=Symbol.for("react.suspense_list"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.for("react.view_transition"),x=Symbol.for("react.client.reference");function v(j){if(typeof j=="object"&&j!==null){var y=j.$$typeof;switch(y){case e:switch(j=j.type,j){case n:case r:case s:case c:case u:case p:return j;default:switch(j=j&&j.$$typeof,j){case o:case l:case h:case d:return j;case i:return j;default:return y}}case t:return y}}}return Ha.ContextConsumer=i,Ha.ContextProvider=o,Ha.Element=e,Ha.ForwardRef=l,Ha.Fragment=n,Ha.Lazy=h,Ha.Memo=d,Ha.Portal=t,Ha.Profiler=r,Ha.StrictMode=s,Ha.Suspense=c,Ha.SuspenseList=u,Ha.isContextConsumer=function(j){return v(j)===i},Ha.isContextProvider=function(j){return v(j)===o},Ha.isElement=function(j){return typeof j=="object"&&j!==null&&j.$$typeof===e},Ha.isForwardRef=function(j){return v(j)===l},Ha.isFragment=function(j){return v(j)===n},Ha.isLazy=function(j){return v(j)===h},Ha.isMemo=function(j){return v(j)===d},Ha.isPortal=function(j){return v(j)===t},Ha.isProfiler=function(j){return v(j)===r},Ha.isStrictMode=function(j){return v(j)===s},Ha.isSuspense=function(j){return v(j)===c},Ha.isSuspenseList=function(j){return v(j)===u},Ha.isValidElementType=function(j){return typeof j=="string"||typeof j=="function"||j===n||j===r||j===s||j===c||j===u||typeof j=="object"&&j!==null&&(j.$$typeof===h||j.$$typeof===d||j.$$typeof===o||j.$$typeof===i||j.$$typeof===l||j.$$typeof===x||j.getModuleId!==void 0)},Ha.typeOf=v,Ha}var GI;function boe(){return GI||(GI=1,s2.exports=yoe()),s2.exports}var _L=boe();function To(e){if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function y9(e){if(f.isValidElement(e)||_L.isValidElementType(e)||!To(e))return e;const t={};return Object.keys(e).forEach(n=>{t[n]=y9(e[n])}),t}function zr(e,t,n={clone:!0}){const s=n.clone?{...e}:e;return To(e)&&To(t)&&Object.keys(t).forEach(r=>{f.isValidElement(t[r])||_L.isValidElementType(t[r])?s[r]=t[r]:To(t[r])&&Object.prototype.hasOwnProperty.call(e,r)&&To(e[r])?s[r]=zr(e[r],t[r],n):n.clone?s[r]=To(t[r])?y9(t[r]):t[r]:s[r]=t[r]}),s}function ap(e,t){return t?zr(e,t,{clone:!1}):e}function WI(e,t){if(!e.containerQueries)return t;const n=Object.keys(t).filter(s=>s.startsWith("@container")).sort((s,r)=>{const i=/min-width:\s*([0-9.]+)/;return+(s.match(i)?.[1]||0)-+(r.match(i)?.[1]||0)});return n.length?n.reduce((s,r)=>{const i=t[r];return delete s[r],s[r]=i,s},{...t}):t}function voe(e,t){return t==="@"||t.startsWith("@")&&(e.some(n=>t.startsWith(`@${n}`))||!!t.match(/^@\d/))}function woe(e,t){const n=t.match(/^@([^/]+)?\/?(.+)?$/);if(!n)return null;const[,s,r]=n,i=Number.isNaN(+s)?s||0:+s;return e.containerQueries(r).up(i)}function joe(e){const t=(i,o)=>i.replace("@media",o?`@container ${o}`:"@container");function n(i,o){i.up=(...l)=>t(e.breakpoints.up(...l),o),i.down=(...l)=>t(e.breakpoints.down(...l),o),i.between=(...l)=>t(e.breakpoints.between(...l),o),i.only=(...l)=>t(e.breakpoints.only(...l),o),i.not=(...l)=>{const c=t(e.breakpoints.not(...l),o);return c.includes("not all and")?c.replace("not all and ","").replace("min-width:","width<").replace("max-width:","width>").replace("and","or"):c}}const s={},r=i=>(n(s,i),s);return n(r),{...e,containerQueries:r}}const bj={xs:0,sm:600,md:900,lg:1200,xl:1536},VI={keys:["xs","sm","md","lg","xl"],up:e=>`@media (min-width:${bj[e]}px)`},Noe={containerQueries:e=>({up:t=>{let n=typeof t=="number"?t:bj[t]||t;return typeof n=="number"&&(n=`${n}px`),e?`@container ${e} (min-width:${n})`:`@container (min-width:${n})`}})};function Ul(e,t,n){const s=e.theme||{};if(Array.isArray(t)){const i=s.breakpoints||VI;return t.reduce((o,l,c)=>(o[i.up(i.keys[c])]=n(t[c]),o),{})}if(typeof t=="object"){const i=s.breakpoints||VI;return Object.keys(t).reduce((o,l)=>{if(voe(i.keys,l)){const c=woe(s.containerQueries?s:Noe,l);c&&(o[c]=n(t[l],l))}else if(Object.keys(i.values||bj).includes(l)){const c=i.up(l);o[c]=n(t[l],l)}else{const c=l;o[c]=t[c]}return o},{})}return n(t)}function Coe(e={}){return e.keys?.reduce((n,s)=>{const r=e.up(s);return n[r]={},n},{})||{}}function YI(e,t){return e.reduce((n,s)=>{const r=n[s];return(!r||Object.keys(r).length===0)&&delete n[s],n},t)}function vj(e,t,n=!0){if(!t||typeof t!="string")return null;if(e&&e.vars&&n){const s=`vars.${t}`.split(".").reduce((r,i)=>r&&r[i]?r[i]:null,e);if(s!=null)return s}return t.split(".").reduce((s,r)=>s&&s[r]!=null?s[r]:null,e)}function kv(e,t,n,s=n){let r;return typeof e=="function"?r=e(n):Array.isArray(e)?r=e[n]||s:r=vj(e,n)||s,t&&(r=t(r,s,e)),r}function In(e){const{prop:t,cssProperty:n=e.prop,themeKey:s,transform:r}=e,i=o=>{if(o[t]==null)return null;const l=o[t],c=o.theme,u=vj(c,s)||{};return Ul(o,l,h=>{let p=kv(u,r,h);return h===p&&typeof h=="string"&&(p=kv(u,r,`${t}${h==="default"?"":Wa(h)}`,h)),n===!1?p:{[n]:p}})};return i.propTypes={},i.filterProps=[t],i}function Soe(e){const t={};return n=>(t[n]===void 0&&(t[n]=e(n)),t[n])}const _oe={m:"margin",p:"padding"},Aoe={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},QI={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},Toe=Soe(e=>{if(e.length>2)if(QI[e])e=QI[e];else return[e];const[t,n]=e.split(""),s=_oe[t],r=Aoe[n]||"";return Array.isArray(r)?r.map(i=>s+i):[s+r]}),AL=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],TL=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...AL,...TL];function fx(e,t,n,s){const r=vj(e,t,!0)??n;return typeof r=="number"||typeof r=="string"?i=>typeof i=="string"?i:typeof r=="string"?r.startsWith("var(")&&i===0?0:r.startsWith("var(")&&i===1?r:`calc(${i} * ${r})`:r*i:Array.isArray(r)?i=>{if(typeof i=="string")return i;const o=Math.abs(i),l=r[o];return i>=0?l:typeof l=="number"?-l:typeof l=="string"&&l.startsWith("var(")?`calc(-1 * ${l})`:`-${l}`}:typeof r=="function"?r:()=>{}}function kL(e){return fx(e,"spacing",8)}function hx(e,t){return typeof t=="string"||t==null?t:e(t)}function koe(e,t){return n=>e.reduce((s,r)=>(s[r]=hx(t,n),s),{})}function Eoe(e,t,n,s){if(!t.includes(n))return null;const r=Toe(n),i=koe(r,s),o=e[n];return Ul(e,o,i)}function b9(e,t){const n=kL(e.theme);return Object.keys(e).map(s=>Eoe(e,t,s,n)).reduce(ap,{})}function jn(e){return b9(e,AL)}jn.propTypes={};jn.filterProps=AL;function Nn(e){return b9(e,TL)}Nn.propTypes={};Nn.filterProps=TL;function wj(...e){const t=e.reduce((s,r)=>(r.filterProps.forEach(i=>{s[i]=r}),s),{}),n=s=>Object.keys(s).reduce((r,i)=>t[i]?ap(r,t[i](s)):r,{});return n.propTypes={},n.filterProps=e.reduce((s,r)=>s.concat(r.filterProps),[]),n}function hi(e){return typeof e!="number"?e:`${e}px solid`}function Ai(e,t){return In({prop:e,themeKey:"borders",transform:t})}const Loe=Ai("border",hi),Poe=Ai("borderTop",hi),Doe=Ai("borderRight",hi),Ooe=Ai("borderBottom",hi),Moe=Ai("borderLeft",hi),Ioe=Ai("borderColor"),$oe=Ai("borderTopColor"),Roe=Ai("borderRightColor"),zoe=Ai("borderBottomColor"),Foe=Ai("borderLeftColor"),Uoe=Ai("outline",hi),Boe=Ai("outlineColor"),jj=e=>{if(e.borderRadius!==void 0&&e.borderRadius!==null){const t=fx(e.theme,"shape.borderRadius",4),n=s=>({borderRadius:hx(t,s)});return Ul(e,e.borderRadius,n)}return null};jj.propTypes={};jj.filterProps=["borderRadius"];wj(Loe,Poe,Doe,Ooe,Moe,Ioe,$oe,Roe,zoe,Foe,jj,Uoe,Boe);const Nj=e=>{if(e.gap!==void 0&&e.gap!==null){const t=fx(e.theme,"spacing",8),n=s=>({gap:hx(t,s)});return Ul(e,e.gap,n)}return null};Nj.propTypes={};Nj.filterProps=["gap"];const Cj=e=>{if(e.columnGap!==void 0&&e.columnGap!==null){const t=fx(e.theme,"spacing",8),n=s=>({columnGap:hx(t,s)});return Ul(e,e.columnGap,n)}return null};Cj.propTypes={};Cj.filterProps=["columnGap"];const Sj=e=>{if(e.rowGap!==void 0&&e.rowGap!==null){const t=fx(e.theme,"spacing",8),n=s=>({rowGap:hx(t,s)});return Ul(e,e.rowGap,n)}return null};Sj.propTypes={};Sj.filterProps=["rowGap"];const Hoe=In({prop:"gridColumn"}),qoe=In({prop:"gridRow"}),Goe=In({prop:"gridAutoFlow"}),Woe=In({prop:"gridAutoColumns"}),Voe=In({prop:"gridAutoRows"}),Yoe=In({prop:"gridTemplateColumns"}),Qoe=In({prop:"gridTemplateRows"}),Koe=In({prop:"gridTemplateAreas"}),Xoe=In({prop:"gridArea"});wj(Nj,Cj,Sj,Hoe,qoe,Goe,Woe,Voe,Yoe,Qoe,Koe,Xoe);function xf(e,t){return t==="grey"?t:e}const Zoe=In({prop:"color",themeKey:"palette",transform:xf}),Joe=In({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:xf}),ele=In({prop:"backgroundColor",themeKey:"palette",transform:xf});wj(Zoe,Joe,ele);function Ir(e){return e<=1&&e!==0?`${e*100}%`:e}const tle=In({prop:"width",transform:Ir}),EL=e=>{if(e.maxWidth!==void 0&&e.maxWidth!==null){const t=n=>{const s=e.theme?.breakpoints?.values?.[n]||bj[n];return s?e.theme?.breakpoints?.unit!=="px"?{maxWidth:`${s}${e.theme.breakpoints.unit}`}:{maxWidth:s}:{maxWidth:Ir(n)}};return Ul(e,e.maxWidth,t)}return null};EL.filterProps=["maxWidth"];const ale=In({prop:"minWidth",transform:Ir}),nle=In({prop:"height",transform:Ir}),sle=In({prop:"maxHeight",transform:Ir}),rle=In({prop:"minHeight",transform:Ir});In({prop:"size",cssProperty:"width",transform:Ir});In({prop:"size",cssProperty:"height",transform:Ir});const ile=In({prop:"boxSizing"});wj(tle,EL,ale,nle,sle,rle,ile);const gx={border:{themeKey:"borders",transform:hi},borderTop:{themeKey:"borders",transform:hi},borderRight:{themeKey:"borders",transform:hi},borderBottom:{themeKey:"borders",transform:hi},borderLeft:{themeKey:"borders",transform:hi},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:hi},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:jj},color:{themeKey:"palette",transform:xf},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:xf},backgroundColor:{themeKey:"palette",transform:xf},p:{style:Nn},pt:{style:Nn},pr:{style:Nn},pb:{style:Nn},pl:{style:Nn},px:{style:Nn},py:{style:Nn},padding:{style:Nn},paddingTop:{style:Nn},paddingRight:{style:Nn},paddingBottom:{style:Nn},paddingLeft:{style:Nn},paddingX:{style:Nn},paddingY:{style:Nn},paddingInline:{style:Nn},paddingInlineStart:{style:Nn},paddingInlineEnd:{style:Nn},paddingBlock:{style:Nn},paddingBlockStart:{style:Nn},paddingBlockEnd:{style:Nn},m:{style:jn},mt:{style:jn},mr:{style:jn},mb:{style:jn},ml:{style:jn},mx:{style:jn},my:{style:jn},margin:{style:jn},marginTop:{style:jn},marginRight:{style:jn},marginBottom:{style:jn},marginLeft:{style:jn},marginX:{style:jn},marginY:{style:jn},marginInline:{style:jn},marginInlineStart:{style:jn},marginInlineEnd:{style:jn},marginBlock:{style:jn},marginBlockStart:{style:jn},marginBlockEnd:{style:jn},displayPrint:{cssProperty:!1,transform:e=>({"@media print":{display:e}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:Nj},rowGap:{style:Sj},columnGap:{style:Cj},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:Ir},maxWidth:{style:EL},minWidth:{transform:Ir},height:{transform:Ir},maxHeight:{transform:Ir},minHeight:{transform:Ir},boxSizing:{},font:{themeKey:"font"},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}};function ole(...e){const t=e.reduce((s,r)=>s.concat(Object.keys(r)),[]),n=new Set(t);return e.every(s=>n.size===Object.keys(s).length)}function lle(e,t){return typeof e=="function"?e(t):e}function cle(){function e(n,s,r,i){const o={[n]:s,theme:r},l=i[n];if(!l)return{[n]:s};const{cssProperty:c=n,themeKey:u,transform:d,style:h}=l;if(s==null)return null;if(u==="typography"&&s==="inherit")return{[n]:s};const p=vj(r,u)||{};return h?h(o):Ul(o,s,v=>{let j=kv(p,d,v);return v===j&&typeof v=="string"&&(j=kv(p,d,`${n}${v==="default"?"":Wa(v)}`,v)),c===!1?j:{[c]:j}})}function t(n){const{sx:s,theme:r={},nested:i}=n||{};if(!s)return null;const o=r.unstable_sxConfig??gx;function l(c){let u=c;if(typeof c=="function")u=c(r);else if(typeof c!="object")return c;if(!u)return null;const d=Coe(r.breakpoints),h=Object.keys(d);let p=d;return Object.keys(u).forEach(x=>{const v=lle(u[x],r);if(v!=null)if(typeof v=="object")if(o[x])p=ap(p,e(x,v,r,o));else{const j=Ul({theme:r},v,y=>({[x]:y}));ole(j,v)?p[x]=t({sx:v,theme:r,nested:!0}):p=ap(p,j)}else p=ap(p,e(x,v,r,o))}),!i&&r.modularCssLayers?{"@layer sx":WI(r,YI(h,p))}:WI(r,YI(h,p))}return Array.isArray(s)?s.map(l):l(s)}return t}const Af=cle();Af.filterProps=["sx"];const dle=e=>{const t={systemProps:{},otherProps:{}},n=e?.theme?.unstable_sxConfig??gx;return Object.keys(e).forEach(s=>{n[s]?t.systemProps[s]=e[s]:t.otherProps[s]=e[s]}),t};function ule(e){const{sx:t,...n}=e,{systemProps:s,otherProps:r}=dle(n);let i;return Array.isArray(t)?i=[s,...t]:typeof t=="function"?i=(...o)=>{const l=t(...o);return To(l)?{...s,...l}:s}:i={...s,...t},{...r,sx:i}}function at(){return at=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},at.apply(null,arguments)}function mle(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}function fle(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),e.nonce!==void 0&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}var hle=(function(){function e(n){var s=this;this._insertTag=function(r){var i;s.tags.length===0?s.insertionPoint?i=s.insertionPoint.nextSibling:s.prepend?i=s.container.firstChild:i=s.before:i=s.tags[s.tags.length-1].nextSibling,s.container.insertBefore(r,i),s.tags.push(r)},this.isSpeedy=n.speedy===void 0?!0:n.speedy,this.tags=[],this.ctr=0,this.nonce=n.nonce,this.key=n.key,this.container=n.container,this.prepend=n.prepend,this.insertionPoint=n.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(s){s.forEach(this._insertTag)},t.insert=function(s){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(fle(this));var r=this.tags[this.tags.length-1];if(this.isSpeedy){var i=mle(r);try{i.insertRule(s,i.cssRules.length)}catch{}}else r.appendChild(document.createTextNode(s));this.ctr++},t.flush=function(){this.tags.forEach(function(s){var r;return(r=s.parentNode)==null?void 0:r.removeChild(s)}),this.tags=[],this.ctr=0},e})(),Ls="-ms-",Ev="-moz-",ka="-webkit-",v9="comm",LL="rule",PL="decl",gle="@import",w9="@keyframes",ple="@layer",xle=Math.abs,_j=String.fromCharCode,yle=Object.assign;function ble(e,t){return Ts(e,0)^45?(((t<<2^Ts(e,0))<<2^Ts(e,1))<<2^Ts(e,2))<<2^Ts(e,3):0}function j9(e){return e.trim()}function vle(e,t){return(e=t.exec(e))?e[0]:e}function Ea(e,t,n){return e.replace(t,n)}function sk(e,t){return e.indexOf(t)}function Ts(e,t){return e.charCodeAt(t)|0}function yp(e,t,n){return e.slice(t,n)}function So(e){return e.length}function DL(e){return e.length}function Fy(e,t){return t.push(e),e}function wle(e,t){return e.map(t).join("")}var Aj=1,Tf=1,N9=0,vr=0,Hn=0,ah="";function Tj(e,t,n,s,r,i,o){return{value:e,root:t,parent:n,type:s,props:r,children:i,line:Aj,column:Tf,length:o,return:""}}function gg(e,t){return yle(Tj("",null,null,"",null,null,0),e,{length:-e.length},t)}function jle(){return Hn}function Nle(){return Hn=vr>0?Ts(ah,--vr):0,Tf--,Hn===10&&(Tf=1,Aj--),Hn}function Fr(){return Hn=vr<N9?Ts(ah,vr++):0,Tf++,Hn===10&&(Tf=1,Aj++),Hn}function Mo(){return Ts(ah,vr)}function lv(){return vr}function px(e,t){return yp(ah,e,t)}function bp(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function C9(e){return Aj=Tf=1,N9=So(ah=e),vr=0,[]}function S9(e){return ah="",e}function cv(e){return j9(px(vr-1,rk(e===91?e+2:e===40?e+1:e)))}function Cle(e){for(;(Hn=Mo())&&Hn<33;)Fr();return bp(e)>2||bp(Hn)>3?"":" "}function Sle(e,t){for(;--t&&Fr()&&!(Hn<48||Hn>102||Hn>57&&Hn<65||Hn>70&&Hn<97););return px(e,lv()+(t<6&&Mo()==32&&Fr()==32))}function rk(e){for(;Fr();)switch(Hn){case e:return vr;case 34:case 39:e!==34&&e!==39&&rk(Hn);break;case 40:e===41&&rk(e);break;case 92:Fr();break}return vr}function _le(e,t){for(;Fr()&&e+Hn!==57;)if(e+Hn===84&&Mo()===47)break;return"/*"+px(t,vr-1)+"*"+_j(e===47?e:Fr())}function Ale(e){for(;!bp(Mo());)Fr();return px(e,vr)}function Tle(e){return S9(dv("",null,null,null,[""],e=C9(e),0,[0],e))}function dv(e,t,n,s,r,i,o,l,c){for(var u=0,d=0,h=o,p=0,x=0,v=0,j=1,y=1,N=1,w=0,S="",_=r,k=i,T=s,A=S;y;)switch(v=w,w=Fr()){case 40:if(v!=108&&Ts(A,h-1)==58){sk(A+=Ea(cv(w),"&","&\f"),"&\f")!=-1&&(N=-1);break}case 34:case 39:case 91:A+=cv(w);break;case 9:case 10:case 13:case 32:A+=Cle(v);break;case 92:A+=Sle(lv()-1,7);continue;case 47:switch(Mo()){case 42:case 47:Fy(kle(_le(Fr(),lv()),t,n),c);break;default:A+="/"}break;case 123*j:l[u++]=So(A)*N;case 125*j:case 59:case 0:switch(w){case 0:case 125:y=0;case 59+d:N==-1&&(A=Ea(A,/\f/g,"")),x>0&&So(A)-h&&Fy(x>32?XI(A+";",s,n,h-1):XI(Ea(A," ","")+";",s,n,h-2),c);break;case 59:A+=";";default:if(Fy(T=KI(A,t,n,u,d,r,l,S,_=[],k=[],h),i),w===123)if(d===0)dv(A,t,T,T,_,i,h,l,k);else switch(p===99&&Ts(A,3)===110?100:p){case 100:case 108:case 109:case 115:dv(e,T,T,s&&Fy(KI(e,T,T,0,0,r,l,S,r,_=[],h),k),r,k,h,l,s?_:k);break;default:dv(A,T,T,T,[""],k,0,l,k)}}u=d=x=0,j=N=1,S=A="",h=o;break;case 58:h=1+So(A),x=v;default:if(j<1){if(w==123)--j;else if(w==125&&j++==0&&Nle()==125)continue}switch(A+=_j(w),w*j){case 38:N=d>0?1:(A+="\f",-1);break;case 44:l[u++]=(So(A)-1)*N,N=1;break;case 64:Mo()===45&&(A+=cv(Fr())),p=Mo(),d=h=So(S=A+=Ale(lv())),w++;break;case 45:v===45&&So(A)==2&&(j=0)}}return i}function KI(e,t,n,s,r,i,o,l,c,u,d){for(var h=r-1,p=r===0?i:[""],x=DL(p),v=0,j=0,y=0;v<s;++v)for(var N=0,w=yp(e,h+1,h=xle(j=o[v])),S=e;N<x;++N)(S=j9(j>0?p[N]+" "+w:Ea(w,/&\f/g,p[N])))&&(c[y++]=S);return Tj(e,t,n,r===0?LL:l,c,u,d)}function kle(e,t,n){return Tj(e,t,n,v9,_j(jle()),yp(e,2,-2),0)}function XI(e,t,n,s){return Tj(e,t,n,PL,yp(e,0,s),yp(e,s+1,-1),s)}function yf(e,t){for(var n="",s=DL(e),r=0;r<s;r++)n+=t(e[r],r,e,t)||"";return n}function Ele(e,t,n,s){switch(e.type){case ple:if(e.children.length)break;case gle:case PL:return e.return=e.return||e.value;case v9:return"";case w9:return e.return=e.value+"{"+yf(e.children,s)+"}";case LL:e.value=e.props.join(",")}return So(n=yf(e.children,s))?e.return=e.value+"{"+n+"}":""}function Lle(e){var t=DL(e);return function(n,s,r,i){for(var o="",l=0;l<t;l++)o+=e[l](n,s,r,i)||"";return o}}function Ple(e){return function(t){t.root||(t=t.return)&&e(t)}}function _9(e){var t=Object.create(null);return function(n){return t[n]===void 0&&(t[n]=e(n)),t[n]}}var Dle=function(t,n,s){for(var r=0,i=0;r=i,i=Mo(),r===38&&i===12&&(n[s]=1),!bp(i);)Fr();return px(t,vr)},Ole=function(t,n){var s=-1,r=44;do switch(bp(r)){case 0:r===38&&Mo()===12&&(n[s]=1),t[s]+=Dle(vr-1,n,s);break;case 2:t[s]+=cv(r);break;case 4:if(r===44){t[++s]=Mo()===58?"&\f":"",n[s]=t[s].length;break}default:t[s]+=_j(r)}while(r=Fr());return t},Mle=function(t,n){return S9(Ole(C9(t),n))},ZI=new WeakMap,Ile=function(t){if(!(t.type!=="rule"||!t.parent||t.length<1)){for(var n=t.value,s=t.parent,r=t.column===s.column&&t.line===s.line;s.type!=="rule";)if(s=s.parent,!s)return;if(!(t.props.length===1&&n.charCodeAt(0)!==58&&!ZI.get(s))&&!r){ZI.set(t,!0);for(var i=[],o=Mle(n,i),l=s.props,c=0,u=0;c<o.length;c++)for(var d=0;d<l.length;d++,u++)t.props[u]=i[c]?o[c].replace(/&\f/g,l[d]):l[d]+" "+o[c]}}},$le=function(t){if(t.type==="decl"){var n=t.value;n.charCodeAt(0)===108&&n.charCodeAt(2)===98&&(t.return="",t.value="")}};function A9(e,t){switch(ble(e,t)){case 5103:return ka+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return ka+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return ka+e+Ev+e+Ls+e+e;case 6828:case 4268:return ka+e+Ls+e+e;case 6165:return ka+e+Ls+"flex-"+e+e;case 5187:return ka+e+Ea(e,/(\w+).+(:[^]+)/,ka+"box-$1$2"+Ls+"flex-$1$2")+e;case 5443:return ka+e+Ls+"flex-item-"+Ea(e,/flex-|-self/,"")+e;case 4675:return ka+e+Ls+"flex-line-pack"+Ea(e,/align-content|flex-|-self/,"")+e;case 5548:return ka+e+Ls+Ea(e,"shrink","negative")+e;case 5292:return ka+e+Ls+Ea(e,"basis","preferred-size")+e;case 6060:return ka+"box-"+Ea(e,"-grow","")+ka+e+Ls+Ea(e,"grow","positive")+e;case 4554:return ka+Ea(e,/([^-])(transform)/g,"$1"+ka+"$2")+e;case 6187:return Ea(Ea(Ea(e,/(zoom-|grab)/,ka+"$1"),/(image-set)/,ka+"$1"),e,"")+e;case 5495:case 3959:return Ea(e,/(image-set\([^]*)/,ka+"$1$`$1");case 4968:return Ea(Ea(e,/(.+:)(flex-)?(.*)/,ka+"box-pack:$3"+Ls+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+ka+e+e;case 4095:case 3583:case 4068:case 2532:return Ea(e,/(.+)-inline(.+)/,ka+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(So(e)-1-t>6)switch(Ts(e,t+1)){case 109:if(Ts(e,t+4)!==45)break;case 102:return Ea(e,/(.+:)(.+)-([^]+)/,"$1"+ka+"$2-$3$1"+Ev+(Ts(e,t+3)==108?"$3":"$2-$3"))+e;case 115:return~sk(e,"stretch")?A9(Ea(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(Ts(e,t+1)!==115)break;case 6444:switch(Ts(e,So(e)-3-(~sk(e,"!important")&&10))){case 107:return Ea(e,":",":"+ka)+e;case 101:return Ea(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+ka+(Ts(e,14)===45?"inline-":"")+"box$3$1"+ka+"$2$3$1"+Ls+"$2box$3")+e}break;case 5936:switch(Ts(e,t+11)){case 114:return ka+e+Ls+Ea(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return ka+e+Ls+Ea(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return ka+e+Ls+Ea(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return ka+e+Ls+e+e}return e}var Rle=function(t,n,s,r){if(t.length>-1&&!t.return)switch(t.type){case PL:t.return=A9(t.value,t.length);break;case w9:return yf([gg(t,{value:Ea(t.value,"@","@"+ka)})],r);case LL:if(t.length)return wle(t.props,function(i){switch(vle(i,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return yf([gg(t,{props:[Ea(i,/:(read-\w+)/,":"+Ev+"$1")]})],r);case"::placeholder":return yf([gg(t,{props:[Ea(i,/:(plac\w+)/,":"+ka+"input-$1")]}),gg(t,{props:[Ea(i,/:(plac\w+)/,":"+Ev+"$1")]}),gg(t,{props:[Ea(i,/:(plac\w+)/,Ls+"input-$1")]})],r)}return""})}},zle=[Rle],Fle=function(t){var n=t.key;if(n==="css"){var s=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(s,function(j){var y=j.getAttribute("data-emotion");y.indexOf(" ")!==-1&&(document.head.appendChild(j),j.setAttribute("data-s",""))})}var r=t.stylisPlugins||zle,i={},o,l=[];o=t.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+n+' "]'),function(j){for(var y=j.getAttribute("data-emotion").split(" "),N=1;N<y.length;N++)i[y[N]]=!0;l.push(j)});var c,u=[Ile,$le];{var d,h=[Ele,Ple(function(j){d.insert(j)})],p=Lle(u.concat(r,h)),x=function(y){return yf(Tle(y),p)};c=function(y,N,w,S){d=w,x(y?y+"{"+N.styles+"}":N.styles),S&&(v.inserted[N.name]=!0)}}var v={key:n,sheet:new hle({key:n,container:o,nonce:t.nonce,speedy:t.speedy,prepend:t.prepend,insertionPoint:t.insertionPoint}),nonce:t.nonce,inserted:i,registered:{},insert:c};return v.sheet.hydrate(l),v},r2={exports:{}},La={};var JI;function Ule(){if(JI)return La;JI=1;var e=typeof Symbol=="function"&&Symbol.for,t=e?Symbol.for("react.element"):60103,n=e?Symbol.for("react.portal"):60106,s=e?Symbol.for("react.fragment"):60107,r=e?Symbol.for("react.strict_mode"):60108,i=e?Symbol.for("react.profiler"):60114,o=e?Symbol.for("react.provider"):60109,l=e?Symbol.for("react.context"):60110,c=e?Symbol.for("react.async_mode"):60111,u=e?Symbol.for("react.concurrent_mode"):60111,d=e?Symbol.for("react.forward_ref"):60112,h=e?Symbol.for("react.suspense"):60113,p=e?Symbol.for("react.suspense_list"):60120,x=e?Symbol.for("react.memo"):60115,v=e?Symbol.for("react.lazy"):60116,j=e?Symbol.for("react.block"):60121,y=e?Symbol.for("react.fundamental"):60117,N=e?Symbol.for("react.responder"):60118,w=e?Symbol.for("react.scope"):60119;function S(k){if(typeof k=="object"&&k!==null){var T=k.$$typeof;switch(T){case t:switch(k=k.type,k){case c:case u:case s:case i:case r:case h:return k;default:switch(k=k&&k.$$typeof,k){case l:case d:case v:case x:case o:return k;default:return T}}case n:return T}}}function _(k){return S(k)===u}return La.AsyncMode=c,La.ConcurrentMode=u,La.ContextConsumer=l,La.ContextProvider=o,La.Element=t,La.ForwardRef=d,La.Fragment=s,La.Lazy=v,La.Memo=x,La.Portal=n,La.Profiler=i,La.StrictMode=r,La.Suspense=h,La.isAsyncMode=function(k){return _(k)||S(k)===c},La.isConcurrentMode=_,La.isContextConsumer=function(k){return S(k)===l},La.isContextProvider=function(k){return S(k)===o},La.isElement=function(k){return typeof k=="object"&&k!==null&&k.$$typeof===t},La.isForwardRef=function(k){return S(k)===d},La.isFragment=function(k){return S(k)===s},La.isLazy=function(k){return S(k)===v},La.isMemo=function(k){return S(k)===x},La.isPortal=function(k){return S(k)===n},La.isProfiler=function(k){return S(k)===i},La.isStrictMode=function(k){return S(k)===r},La.isSuspense=function(k){return S(k)===h},La.isValidElementType=function(k){return typeof k=="string"||typeof k=="function"||k===s||k===u||k===i||k===r||k===h||k===p||typeof k=="object"&&k!==null&&(k.$$typeof===v||k.$$typeof===x||k.$$typeof===o||k.$$typeof===l||k.$$typeof===d||k.$$typeof===y||k.$$typeof===N||k.$$typeof===w||k.$$typeof===j)},La.typeOf=S,La}var e$;function Ble(){return e$||(e$=1,r2.exports=Ule()),r2.exports}var i2,t$;function Hle(){if(t$)return i2;t$=1;var e=Ble(),t={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},n={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},s={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},r={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},i={};i[e.ForwardRef]=s,i[e.Memo]=r;function o(v){return e.isMemo(v)?r:i[v.$$typeof]||t}var l=Object.defineProperty,c=Object.getOwnPropertyNames,u=Object.getOwnPropertySymbols,d=Object.getOwnPropertyDescriptor,h=Object.getPrototypeOf,p=Object.prototype;function x(v,j,y){if(typeof j!="string"){if(p){var N=h(j);N&&N!==p&&x(v,N,y)}var w=c(j);u&&(w=w.concat(u(j)));for(var S=o(v),_=o(j),k=0;k<w.length;++k){var T=w[k];if(!n[T]&&!(y&&y[T])&&!(_&&_[T])&&!(S&&S[T])){var A=d(j,T);try{l(v,T,A)}catch{}}}}return v}return i2=x,i2}Hle();var qle=!0;function T9(e,t,n){var s="";return n.split(" ").forEach(function(r){e[r]!==void 0?t.push(e[r]+";"):r&&(s+=r+" ")}),s}var OL=function(t,n,s){var r=t.key+"-"+n.name;(s===!1||qle===!1)&&t.registered[r]===void 0&&(t.registered[r]=n.styles)},k9=function(t,n,s){OL(t,n,s);var r=t.key+"-"+n.name;if(t.inserted[n.name]===void 0){var i=n;do t.insert(n===i?"."+r:"",i,t.sheet,!0),i=i.next;while(i!==void 0)}};function Gle(e){for(var t=0,n,s=0,r=e.length;r>=4;++s,r-=4)n=e.charCodeAt(s)&255|(e.charCodeAt(++s)&255)<<8|(e.charCodeAt(++s)&255)<<16|(e.charCodeAt(++s)&255)<<24,n=(n&65535)*1540483477+((n>>>16)*59797<<16),n^=n>>>24,t=(n&65535)*1540483477+((n>>>16)*59797<<16)^(t&65535)*1540483477+((t>>>16)*59797<<16);switch(r){case 3:t^=(e.charCodeAt(s+2)&255)<<16;case 2:t^=(e.charCodeAt(s+1)&255)<<8;case 1:t^=e.charCodeAt(s)&255,t=(t&65535)*1540483477+((t>>>16)*59797<<16)}return t^=t>>>13,t=(t&65535)*1540483477+((t>>>16)*59797<<16),((t^t>>>15)>>>0).toString(36)}var Wle={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},Vle=/[A-Z]|^ms/g,Yle=/_EMO_([^_]+?)_([^]*?)_EMO_/g,E9=function(t){return t.charCodeAt(1)===45},a$=function(t){return t!=null&&typeof t!="boolean"},o2=_9(function(e){return E9(e)?e:e.replace(Vle,"-$&").toLowerCase()}),n$=function(t,n){switch(t){case"animation":case"animationName":if(typeof n=="string")return n.replace(Yle,function(s,r,i){return _o={name:r,styles:i,next:_o},r})}return Wle[t]!==1&&!E9(t)&&typeof n=="number"&&n!==0?n+"px":n};function vp(e,t,n){if(n==null)return"";var s=n;if(s.__emotion_styles!==void 0)return s;switch(typeof n){case"boolean":return"";case"object":{var r=n;if(r.anim===1)return _o={name:r.name,styles:r.styles,next:_o},r.name;var i=n;if(i.styles!==void 0){var o=i.next;if(o!==void 0)for(;o!==void 0;)_o={name:o.name,styles:o.styles,next:_o},o=o.next;var l=i.styles+";";return l}return Qle(e,t,n)}case"function":{if(e!==void 0){var c=_o,u=n(e);return _o=c,vp(e,t,u)}break}}var d=n;if(t==null)return d;var h=t[d];return h!==void 0?h:d}function Qle(e,t,n){var s="";if(Array.isArray(n))for(var r=0;r<n.length;r++)s+=vp(e,t,n[r])+";";else for(var i in n){var o=n[i];if(typeof o!="object"){var l=o;t!=null&&t[l]!==void 0?s+=i+"{"+t[l]+"}":a$(l)&&(s+=o2(i)+":"+n$(i,l)+";")}else if(Array.isArray(o)&&typeof o[0]=="string"&&(t==null||t[o[0]]===void 0))for(var c=0;c<o.length;c++)a$(o[c])&&(s+=o2(i)+":"+n$(i,o[c])+";");else{var u=vp(e,t,o);switch(i){case"animation":case"animationName":{s+=o2(i)+":"+u+";";break}default:s+=i+"{"+u+"}"}}}return s}var s$=/label:\s*([^\s;{]+)\s*(;|$)/g,_o;function kj(e,t,n){if(e.length===1&&typeof e[0]=="object"&&e[0]!==null&&e[0].styles!==void 0)return e[0];var s=!0,r="";_o=void 0;var i=e[0];if(i==null||i.raw===void 0)s=!1,r+=vp(n,t,i);else{var o=i;r+=o[0]}for(var l=1;l<e.length;l++)if(r+=vp(n,t,e[l]),s){var c=i;r+=c[l]}s$.lastIndex=0;for(var u="",d;(d=s$.exec(r))!==null;)u+="-"+d[1];var h=Gle(r)+u;return{name:h,styles:r,next:_o}}var Kle=function(t){return t()},Xle=ku.useInsertionEffect?ku.useInsertionEffect:!1,L9=Xle||Kle,P9=f.createContext(typeof HTMLElement<"u"?Fle({key:"css"}):null);P9.Provider;var D9=function(t){return f.forwardRef(function(n,s){var r=f.useContext(P9);return t(n,r,s)})},ML=f.createContext({}),IL={}.hasOwnProperty,ik="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",Zle=function(t,n){var s={};for(var r in n)IL.call(n,r)&&(s[r]=n[r]);return s[ik]=t,s},Jle=function(t){var n=t.cache,s=t.serialized,r=t.isStringTag;return OL(n,s,r),L9(function(){return k9(n,s,r)}),null},ece=D9(function(e,t,n){var s=e.css;typeof s=="string"&&t.registered[s]!==void 0&&(s=t.registered[s]);var r=e[ik],i=[s],o="";typeof e.className=="string"?o=T9(t.registered,i,e.className):e.className!=null&&(o=e.className+" ");var l=kj(i,void 0,f.useContext(ML));o+=t.key+"-"+l.name;var c={};for(var u in e)IL.call(e,u)&&u!=="css"&&u!==ik&&(c[u]=e[u]);return c.className=o,n&&(c.ref=n),f.createElement(f.Fragment,null,f.createElement(Jle,{cache:t,serialized:l,isStringTag:typeof r=="string"}),f.createElement(r,c))}),tce=ece,r$=function(t,n){var s=arguments;if(n==null||!IL.call(n,"css"))return f.createElement.apply(void 0,s);var r=s.length,i=new Array(r);i[0]=tce,i[1]=Zle(t,n);for(var o=2;o<r;o++)i[o]=s[o];return f.createElement.apply(null,i)};(function(e){var t;t||(t=e.JSX||(e.JSX={}))})(r$||(r$={}));function $L(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return kj(t)}function xx(){var e=$L.apply(void 0,arguments),t="animation-"+e.name;return{name:t,styles:"@keyframes "+t+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}var ace=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|popover|popoverTarget|popoverTargetAction|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,nce=_9(function(e){return ace.test(e)||e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)<91}),sce=nce,rce=function(t){return t!=="theme"},i$=function(t){return typeof t=="string"&&t.charCodeAt(0)>96?sce:rce},o$=function(t,n,s){var r;if(n){var i=n.shouldForwardProp;r=t.__emotion_forwardProp&&i?function(o){return t.__emotion_forwardProp(o)&&i(o)}:i}return typeof r!="function"&&s&&(r=t.__emotion_forwardProp),r},ice=function(t){var n=t.cache,s=t.serialized,r=t.isStringTag;return OL(n,s,r),L9(function(){return k9(n,s,r)}),null},oce=function e(t,n){var s=t.__emotion_real===t,r=s&&t.__emotion_base||t,i,o;n!==void 0&&(i=n.label,o=n.target);var l=o$(t,n,s),c=l||i$(r),u=!c("as");return function(){var d=arguments,h=s&&t.__emotion_styles!==void 0?t.__emotion_styles.slice(0):[];if(i!==void 0&&h.push("label:"+i+";"),d[0]==null||d[0].raw===void 0)h.push.apply(h,d);else{var p=d[0];h.push(p[0]);for(var x=d.length,v=1;v<x;v++)h.push(d[v],p[v])}var j=D9(function(y,N,w){var S=u&&y.as||r,_="",k=[],T=y;if(y.theme==null){T={};for(var A in y)T[A]=y[A];T.theme=f.useContext(ML)}typeof y.className=="string"?_=T9(N.registered,k,y.className):y.className!=null&&(_=y.className+" ");var E=kj(h.concat(k),N.registered,T);_+=N.key+"-"+E.name,o!==void 0&&(_+=" "+o);var M=u&&l===void 0?i$(S):c,z={};for(var P in y)u&&P==="as"||M(P)&&(z[P]=y[P]);return z.className=_,w&&(z.ref=w),f.createElement(f.Fragment,null,f.createElement(ice,{cache:N,serialized:E,isStringTag:typeof S=="string"}),f.createElement(S,z))});return j.displayName=i!==void 0?i:"Styled("+(typeof r=="string"?r:r.displayName||r.name||"Component")+")",j.defaultProps=t.defaultProps,j.__emotion_real=j,j.__emotion_base=r,j.__emotion_styles=h,j.__emotion_forwardProp=l,Object.defineProperty(j,"toString",{value:function(){return"."+o}}),j.withComponent=function(y,N){var w=e(y,at({},n,N,{shouldForwardProp:o$(j,N,!0)}));return w.apply(void 0,h)},j}},lce=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],ok=oce.bind(null);lce.forEach(function(e){ok[e]=ok(e)});function cce(e,t){return ok(e,t)}function dce(e,t){Array.isArray(e.__emotion_styles)&&(e.__emotion_styles=t(e.__emotion_styles))}const l$=[];function wu(e){return l$[0]=e,kj(l$)}const uce=e=>{const t=Object.keys(e).map(n=>({key:n,val:e[n]}))||[];return t.sort((n,s)=>n.val-s.val),t.reduce((n,s)=>({...n,[s.key]:s.val}),{})};function mce(e){const{values:t={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:n="px",step:s=5,...r}=e,i=uce(t),o=Object.keys(i);function l(p){return`@media (min-width:${typeof t[p]=="number"?t[p]:p}${n})`}function c(p){return`@media (max-width:${(typeof t[p]=="number"?t[p]:p)-s/100}${n})`}function u(p,x){const v=o.indexOf(x);return`@media (min-width:${typeof t[p]=="number"?t[p]:p}${n}) and (max-width:${(v!==-1&&typeof t[o[v]]=="number"?t[o[v]]:x)-s/100}${n})`}function d(p){return o.indexOf(p)+1<o.length?u(p,o[o.indexOf(p)+1]):l(p)}function h(p){const x=o.indexOf(p);return x===0?l(o[1]):x===o.length-1?c(o[x]):u(p,o[o.indexOf(p)+1]).replace("@media","@media not all and")}return{keys:o,values:i,up:l,down:c,between:u,only:d,not:h,unit:n,...r}}const fce={borderRadius:4};function O9(e=8,t=kL({spacing:e})){if(e.mui)return e;const n=(...s)=>(s.length===0?[1]:s).map(i=>{const o=t(i);return typeof o=="number"?`${o}px`:o}).join(" ");return n.mui=!0,n}function hce(e,t){const n=this;if(n.vars){if(!n.colorSchemes?.[e]||typeof n.getColorSchemeSelector!="function")return{};let s=n.getColorSchemeSelector(e);return s==="&"?t:((s.includes("data-")||s.includes("."))&&(s=`*:where(${s.replace(/\s*&$/,"")}) &`),{[s]:t})}return n.palette.mode===e?t:{}}function RL(e={},...t){const{breakpoints:n={},palette:s={},spacing:r,shape:i={},...o}=e,l=mce(n),c=O9(r);let u=zr({breakpoints:l,direction:"ltr",components:{},palette:{mode:"light",...s},spacing:c,shape:{...fce,...i}},o);return u=joe(u),u.applyStyles=hce,u=t.reduce((d,h)=>zr(d,h),u),u.unstable_sxConfig={...gx,...o?.unstable_sxConfig},u.unstable_sx=function(h){return Af({sx:h,theme:this})},u}function gce(e){return Object.keys(e).length===0}function M9(e=null){const t=f.useContext(ML);return!t||gce(t)?e:t}const pce=RL();function I9(e=pce){return M9(e)}const c$=e=>e,xce=()=>{let e=c$;return{configure(t){e=t},generate(t){return e(t)},reset(){e=c$}}},yce=xce(),bce={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function Yn(e,t,n="Mui"){const s=bce[t];return s?`${n}-${s}`:`${yce.generate(e)}-${t}`}function An(e,t,n="Mui"){const s={};return t.forEach(r=>{s[r]=Yn(e,r,n)}),s}function $9(e){const{variants:t,...n}=e,s={variants:t,style:wu(n),isProcessed:!0};return s.style===n||t&&t.forEach(r=>{typeof r.style!="function"&&(r.style=wu(r.style))}),s}const vce=RL();function uv(e){return e!=="ownerState"&&e!=="theme"&&e!=="sx"&&e!=="as"}function mu(e,t){return t&&e&&typeof e=="object"&&e.styles&&!e.styles.startsWith("@layer")&&(e.styles=`@layer ${t}{${String(e.styles)}}`),e}function wce(e){return e?(t,n)=>n[e]:null}function jce(e,t,n){e.theme=Sce(e.theme)?n:e.theme[t]||e.theme}function mv(e,t,n){const s=typeof t=="function"?t(e):t;if(Array.isArray(s))return s.flatMap(r=>mv(e,r,n));if(Array.isArray(s?.variants)){let r;if(s.isProcessed)r=n?mu(s.style,n):s.style;else{const{variants:i,...o}=s;r=n?mu(wu(o),n):o}return R9(e,s.variants,[r],n)}return s?.isProcessed?n?mu(wu(s.style),n):s.style:n?mu(wu(s),n):s}function R9(e,t,n=[],s=void 0){let r;e:for(let i=0;i<t.length;i+=1){const o=t[i];if(typeof o.props=="function"){if(r??={...e,...e.ownerState,ownerState:e.ownerState},!o.props(r))continue}else for(const l in o.props)if(e[l]!==o.props[l]&&e.ownerState?.[l]!==o.props[l])continue e;typeof o.style=="function"?(r??={...e,...e.ownerState,ownerState:e.ownerState},n.push(s?mu(wu(o.style(r)),s):o.style(r))):n.push(s?mu(wu(o.style),s):o.style)}return n}function Nce(e={}){const{themeId:t,defaultTheme:n=vce,rootShouldForwardProp:s=uv,slotShouldForwardProp:r=uv}=e;function i(l){jce(l,t,n)}return(l,c={})=>{dce(l,T=>T.filter(A=>A!==Af));const{name:u,slot:d,skipVariantsResolver:h,skipSx:p,overridesResolver:x=wce(Ace(d)),...v}=c,j=u&&u.startsWith("Mui")||d?"components":"custom",y=h!==void 0?h:d&&d!=="Root"&&d!=="root"||!1,N=p||!1;let w=uv;d==="Root"||d==="root"?w=s:d?w=r:_ce(l)&&(w=void 0);const S=cce(l,{shouldForwardProp:w,label:Cce(),...v}),_=T=>{if(T.__emotion_real===T)return T;if(typeof T=="function")return function(E){return mv(E,T,E.theme.modularCssLayers?j:void 0)};if(To(T)){const A=$9(T);return function(M){return A.variants?mv(M,A,M.theme.modularCssLayers?j:void 0):M.theme.modularCssLayers?mu(A.style,j):A.style}}return T},k=(...T)=>{const A=[],E=T.map(_),M=[];if(A.push(i),u&&x&&M.push(function(U){const R=U.theme.components?.[u]?.styleOverrides;if(!R)return null;const q={};for(const Z in R)q[Z]=mv(U,R[Z],U.theme.modularCssLayers?"theme":void 0);return x(U,q)}),u&&!y&&M.push(function(U){const R=U.theme?.components?.[u]?.variants;return R?R9(U,R,[],U.theme.modularCssLayers?"theme":void 0):null}),N||M.push(Af),Array.isArray(E[0])){const D=E.shift(),U=new Array(A.length).fill(""),B=new Array(M.length).fill("");let R;R=[...U,...D,...B],R.raw=[...U,...D.raw,...B],A.unshift(R)}const z=[...A,...E,...M],P=S(...z);return l.muiName&&(P.muiName=l.muiName),P};return S.withConfig&&(k.withConfig=S.withConfig),k}}function Cce(e,t){return void 0}function Sce(e){for(const t in e)return!1;return!0}function _ce(e){return typeof e=="string"&&e.charCodeAt(0)>96}function Ace(e){return e&&e.charAt(0).toLowerCase()+e.slice(1)}function Ou(e,t,n=!1){const s={...t};for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)){const i=r;if(i==="components"||i==="slots")s[i]={...e[i],...s[i]};else if(i==="componentsProps"||i==="slotProps"){const o=e[i],l=t[i];if(!l)s[i]=o||{};else if(!o)s[i]=l;else{s[i]={...l};for(const c in o)if(Object.prototype.hasOwnProperty.call(o,c)){const u=c;s[i][u]=Ou(o[u],l[u],n)}}}else i==="className"&&n&&t.className?s.className=$t(e?.className,t?.className):i==="style"&&n&&t.style?s.style={...e?.style,...t?.style}:s[i]===void 0&&(s[i]=e[i])}return s}function z9(e){const{theme:t,name:n,props:s}=e;return!t||!t.components||!t.components[n]||!t.components[n].defaultProps?s:Ou(t.components[n].defaultProps,s)}function Tce({props:e,name:t,defaultTheme:n,themeId:s}){let r=I9(n);return r=r[s]||r,z9({theme:r,name:t,props:e})}const is=typeof window<"u"?f.useLayoutEffect:f.useEffect;function kce(e,t,n,s,r){const[i,o]=f.useState(()=>r&&n?n(e).matches:s?s(e).matches:t);return is(()=>{if(!n)return;const l=n(e),c=()=>{o(l.matches)};return c(),l.addEventListener("change",c),()=>{l.removeEventListener("change",c)}},[e,n]),i}const Ece={...ku},F9=Ece.useSyncExternalStore;function Lce(e,t,n,s,r){const i=f.useCallback(()=>t,[t]),o=f.useMemo(()=>{if(r&&n)return()=>n(e).matches;if(s!==null){const{matches:d}=s(e);return()=>d}return i},[i,e,s,r,n]),[l,c]=f.useMemo(()=>{if(n===null)return[i,()=>()=>{}];const d=n(e);return[()=>d.matches,h=>(d.addEventListener("change",h),()=>{d.removeEventListener("change",h)})]},[i,n,e]);return F9(c,l,o)}function U9(e={}){const{themeId:t}=e;return function(s,r={}){let i=M9();i&&t&&(i=i[t]||i);const o=typeof window<"u"&&typeof window.matchMedia<"u",{defaultMatches:l=!1,matchMedia:c=o?window.matchMedia:null,ssrMatchMedia:u=null,noSsr:d=!1}=z9({name:"MuiUseMediaQuery",props:r,theme:i});let h=typeof s=="function"?s(i):s;return h=h.replace(/^@media( ?)/m,""),h.includes("print")&&console.warn(["MUI: You have provided a `print` query to the `useMediaQuery` hook.","Using the print media query to modify print styles can lead to unexpected results.","Consider using the `displayPrint` field in the `sx` prop instead.","More information about `displayPrint` on our docs: https://mui.com/system/display/#display-in-print."].join(`
`)),(F9!==void 0?Lce:kce)(h,l,c,u,d)}}U9();function Pce(e,t=Number.MIN_SAFE_INTEGER,n=Number.MAX_SAFE_INTEGER){return Math.max(t,Math.min(e,n))}function zL(e,t=0,n=1){return Pce(e,t,n)}function Dce(e){e=e.slice(1);const t=new RegExp(`.{1,${e.length>=6?2:1}}`,"g");let n=e.match(t);return n&&n[0].length===1&&(n=n.map(s=>s+s)),n?`rgb${n.length===4?"a":""}(${n.map((s,r)=>r<3?parseInt(s,16):Math.round(parseInt(s,16)/255*1e3)/1e3).join(", ")})`:""}function hd(e){if(e.type)return e;if(e.charAt(0)==="#")return hd(Dce(e));const t=e.indexOf("("),n=e.substring(0,t);if(!["rgb","rgba","hsl","hsla","color"].includes(n))throw new Error(Du(9,e));let s=e.substring(t+1,e.length-1),r;if(n==="color"){if(s=s.split(" "),r=s.shift(),s.length===4&&s[3].charAt(0)==="/"&&(s[3]=s[3].slice(1)),!["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].includes(r))throw new Error(Du(10,r))}else s=s.split(",");return s=s.map(i=>parseFloat(i)),{type:n,values:s,colorSpace:r}}const Oce=e=>{const t=hd(e);return t.values.slice(0,3).map((n,s)=>t.type.includes("hsl")&&s!==0?`${n}%`:n).join(" ")},Bg=(e,t)=>{try{return Oce(e)}catch{return e}};function Ej(e){const{type:t,colorSpace:n}=e;let{values:s}=e;return t.includes("rgb")?s=s.map((r,i)=>i<3?parseInt(r,10):r):t.includes("hsl")&&(s[1]=`${s[1]}%`,s[2]=`${s[2]}%`),t.includes("color")?s=`${n} ${s.join(" ")}`:s=`${s.join(", ")}`,`${t}(${s})`}function B9(e){e=hd(e);const{values:t}=e,n=t[0],s=t[1]/100,r=t[2]/100,i=s*Math.min(r,1-r),o=(u,d=(u+n/30)%12)=>r-i*Math.max(Math.min(d-3,9-d,1),-1);let l="rgb";const c=[Math.round(o(0)*255),Math.round(o(8)*255),Math.round(o(4)*255)];return e.type==="hsla"&&(l+="a",c.push(t[3])),Ej({type:l,values:c})}function lk(e){e=hd(e);let t=e.type==="hsl"||e.type==="hsla"?hd(B9(e)).values:e.values;return t=t.map(n=>(e.type!=="color"&&(n/=255),n<=.03928?n/12.92:((n+.055)/1.055)**2.4)),Number((.2126*t[0]+.7152*t[1]+.0722*t[2]).toFixed(3))}function Mce(e,t){const n=lk(e),s=lk(t);return(Math.max(n,s)+.05)/(Math.min(n,s)+.05)}function H9(e,t){return e=hd(e),t=zL(t),(e.type==="rgb"||e.type==="hsl")&&(e.type+="a"),e.type==="color"?e.values[3]=`/${t}`:e.values[3]=t,Ej(e)}function Qd(e,t,n){try{return H9(e,t)}catch{return e}}function Lj(e,t){if(e=hd(e),t=zL(t),e.type.includes("hsl"))e.values[2]*=1-t;else if(e.type.includes("rgb")||e.type.includes("color"))for(let n=0;n<3;n+=1)e.values[n]*=1-t;return Ej(e)}function Ma(e,t,n){try{return Lj(e,t)}catch{return e}}function Pj(e,t){if(e=hd(e),t=zL(t),e.type.includes("hsl"))e.values[2]+=(100-e.values[2])*t;else if(e.type.includes("rgb"))for(let n=0;n<3;n+=1)e.values[n]+=(255-e.values[n])*t;else if(e.type.includes("color"))for(let n=0;n<3;n+=1)e.values[n]+=(1-e.values[n])*t;return Ej(e)}function Ia(e,t,n){try{return Pj(e,t)}catch{return e}}function Ice(e,t=.15){return lk(e)>.5?Lj(e,t):Pj(e,t)}function Uy(e,t,n){try{return Ice(e,t)}catch{return e}}const $ce=f.createContext(),yx=()=>f.useContext($ce)??!1,Rce=f.createContext(void 0);function zce(e){const{theme:t,name:n,props:s}=e;if(!t||!t.components||!t.components[n])return s;const r=t.components[n];return r.defaultProps?Ou(r.defaultProps,s,t.components.mergeClassNameAndStyle):!r.styleOverrides&&!r.variants?Ou(r,s,t.components.mergeClassNameAndStyle):s}function Fce({props:e,name:t}){const n=f.useContext(Rce);return zce({props:e,name:t,theme:{components:n}})}let d$=0;function Uce(e){const[t,n]=f.useState(e),s=e||t;return f.useEffect(()=>{t==null&&(d$+=1,n(`mui-${d$}`))},[t]),s}const Bce={...ku},u$=Bce.useId;function Dj(e){if(u$!==void 0){const t=u$();return e??t}return Uce(e)}const m$={theme:void 0};function Hce(e){let t,n;return function(r){let i=t;return(i===void 0||r.theme!==n)&&(m$.theme=r.theme,i=$9(e(m$)),t=i,n=r.theme),i}}function qce(e=""){function t(...s){if(!s.length)return"";const r=s[0];return typeof r=="string"&&!r.match(/(#|\(|\)|(-?(\d*\.)?\d+)(px|em|%|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc))|^(-?(\d*\.)?\d+)$|(\d+ \d+ \d+)/)?`, var(--${e?`${e}-`:""}${r}${t(...s.slice(1))})`:`, ${r}`}return(s,...r)=>`var(--${e?`${e}-`:""}${s}${t(...r)})`}const f$=(e,t,n,s=[])=>{let r=e;t.forEach((i,o)=>{o===t.length-1?Array.isArray(r)?r[Number(i)]=n:r&&typeof r=="object"&&(r[i]=n):r&&typeof r=="object"&&(r[i]||(r[i]=s.includes(i)?[]:{}),r=r[i])})},Gce=(e,t,n)=>{function s(r,i=[],o=[]){Object.entries(r).forEach(([l,c])=>{(!n||n&&!n([...i,l]))&&c!=null&&(typeof c=="object"&&Object.keys(c).length>0?s(c,[...i,l],Array.isArray(c)?[...o,l]:o):t([...i,l],c,o))})}s(e)},Wce=(e,t)=>typeof t=="number"?["lineHeight","fontWeight","opacity","zIndex"].some(s=>e.includes(s))||e[e.length-1].toLowerCase().includes("opacity")?t:`${t}px`:t;function l2(e,t){const{prefix:n,shouldSkipGeneratingVar:s}=t||{},r={},i={},o={};return Gce(e,(l,c,u)=>{if((typeof c=="string"||typeof c=="number")&&(!s||!s(l,c))){const d=`--${n?`${n}-`:""}${l.join("-")}`,h=Wce(l,c);Object.assign(r,{[d]:h}),f$(i,l,`var(${d})`,u),f$(o,l,`var(${d}, ${h})`,u)}},l=>l[0]==="vars"),{css:r,vars:i,varsWithDefaults:o}}function Vce(e,t={}){const{getSelector:n=N,disableCssColorScheme:s,colorSchemeSelector:r,enableContrastVars:i}=t,{colorSchemes:o={},components:l,defaultColorScheme:c="light",...u}=e,{vars:d,css:h,varsWithDefaults:p}=l2(u,t);let x=p;const v={},{[c]:j,...y}=o;if(Object.entries(y||{}).forEach(([_,k])=>{const{vars:T,css:A,varsWithDefaults:E}=l2(k,t);x=zr(x,E),v[_]={css:A,vars:T}}),j){const{css:_,vars:k,varsWithDefaults:T}=l2(j,t);x=zr(x,T),v[c]={css:_,vars:k}}function N(_,k){let T=r;if(r==="class"&&(T=".%s"),r==="data"&&(T="[data-%s]"),r?.startsWith("data-")&&!r.includes("%s")&&(T=`[${r}="%s"]`),_){if(T==="media")return e.defaultColorScheme===_?":root":{[`@media (prefers-color-scheme: ${o[_]?.palette?.mode||_})`]:{":root":k}};if(T)return e.defaultColorScheme===_?`:root, ${T.replace("%s",String(_))}`:T.replace("%s",String(_))}return":root"}return{vars:x,generateThemeVars:()=>{let _={...d};return Object.entries(v).forEach(([,{vars:k}])=>{_=zr(_,k)}),_},generateStyleSheets:()=>{const _=[],k=e.defaultColorScheme||"light";function T(M,z){Object.keys(z).length&&_.push(typeof M=="string"?{[M]:{...z}}:M)}T(n(void 0,{...h}),h);const{[k]:A,...E}=v;if(A){const{css:M}=A,z=o[k]?.palette?.mode,P=!s&&z?{colorScheme:z,...M}:{...M};T(n(k,{...P}),P)}return Object.entries(E).forEach(([M,{css:z}])=>{const P=o[M]?.palette?.mode,D=!s&&P?{colorScheme:P,...z}:{...z};T(n(M,{...D}),D)}),i&&_.push({":root":{"--__l-threshold":"0.7","--__l":"clamp(0, (l / var(--__l-threshold) - 1) * -infinity, 1)","--__a":"clamp(0.87, (l / var(--__l-threshold) - 1) * -infinity, 1)"}}),_}}}function Yce(e){return function(n){return e==="media"?`@media (prefers-color-scheme: ${n})`:e?e.startsWith("data-")&&!e.includes("%s")?`[${e}="${n}"] &`:e==="class"?`.${n} &`:e==="data"?`[data-${n}] &`:`${e.replace("%s",n)} &`:"&"}}const wp={black:"#000",white:"#fff"},Qce={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},Bm={50:"#f3e5f5",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",700:"#7b1fa2"},Hm={300:"#e57373",400:"#ef5350",500:"#f44336",700:"#d32f2f",800:"#c62828"},pg={300:"#ffb74d",400:"#ffa726",500:"#ff9800",700:"#f57c00",900:"#e65100"},qm={50:"#e3f2fd",200:"#90caf9",400:"#42a5f5",700:"#1976d2",800:"#1565c0"},Gm={300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",700:"#0288d1",900:"#01579b"},Wm={300:"#81c784",400:"#66bb6a",500:"#4caf50",700:"#388e3c",800:"#2e7d32",900:"#1b5e20"};function q9(){return{text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:wp.white,default:wp.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}}}const G9=q9();function W9(){return{text:{primary:wp.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:wp.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}}}const ck=W9();function h$(e,t,n,s){const r=s.light||s,i=s.dark||s*1.5;e[t]||(e.hasOwnProperty(n)?e[t]=e[n]:t==="light"?e.light=Pj(e.main,r):t==="dark"&&(e.dark=Lj(e.main,i)))}function g$(e,t,n,s,r){const i=r.light||r,o=r.dark||r*1.5;t[n]||(t.hasOwnProperty(s)?t[n]=t[s]:n==="light"?t.light=`color-mix(in ${e}, ${t.main}, #fff ${(i*100).toFixed(0)}%)`:n==="dark"&&(t.dark=`color-mix(in ${e}, ${t.main}, #000 ${(o*100).toFixed(0)}%)`))}function Kce(e="light"){return e==="dark"?{main:qm[200],light:qm[50],dark:qm[400]}:{main:qm[700],light:qm[400],dark:qm[800]}}function Xce(e="light"){return e==="dark"?{main:Bm[200],light:Bm[50],dark:Bm[400]}:{main:Bm[500],light:Bm[300],dark:Bm[700]}}function Zce(e="light"){return e==="dark"?{main:Hm[500],light:Hm[300],dark:Hm[700]}:{main:Hm[700],light:Hm[400],dark:Hm[800]}}function Jce(e="light"){return e==="dark"?{main:Gm[400],light:Gm[300],dark:Gm[700]}:{main:Gm[700],light:Gm[500],dark:Gm[900]}}function ede(e="light"){return e==="dark"?{main:Wm[400],light:Wm[300],dark:Wm[700]}:{main:Wm[800],light:Wm[500],dark:Wm[900]}}function tde(e="light"){return e==="dark"?{main:pg[400],light:pg[300],dark:pg[700]}:{main:"#ed6c02",light:pg[500],dark:pg[900]}}function ade(e){return`oklch(from ${e} var(--__l) 0 h / var(--__a))`}function FL(e){const{mode:t="light",contrastThreshold:n=3,tonalOffset:s=.2,colorSpace:r,...i}=e,o=e.primary||Kce(t),l=e.secondary||Xce(t),c=e.error||Zce(t),u=e.info||Jce(t),d=e.success||ede(t),h=e.warning||tde(t);function p(y){return r?ade(y):Mce(y,ck.text.primary)>=n?ck.text.primary:G9.text.primary}const x=({color:y,name:N,mainShade:w=500,lightShade:S=300,darkShade:_=700})=>{if(y={...y},!y.main&&y[w]&&(y.main=y[w]),!y.hasOwnProperty("main"))throw new Error(Du(11,N?` (${N})`:"",w));if(typeof y.main!="string")throw new Error(Du(12,N?` (${N})`:"",JSON.stringify(y.main)));return r?(g$(r,y,"light",S,s),g$(r,y,"dark",_,s)):(h$(y,"light",S,s),h$(y,"dark",_,s)),y.contrastText||(y.contrastText=p(y.main)),y};let v;return t==="light"?v=q9():t==="dark"&&(v=W9()),zr({common:{...wp},mode:t,primary:x({color:o,name:"primary"}),secondary:x({color:l,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:x({color:c,name:"error"}),warning:x({color:h,name:"warning"}),info:x({color:u,name:"info"}),success:x({color:d,name:"success"}),grey:Qce,contrastThreshold:n,getContrastText:p,augmentColor:x,tonalOffset:s,...v},i)}function nde(e){const t={};return Object.entries(e).forEach(s=>{const[r,i]=s;typeof i=="object"&&(t[r]=`${i.fontStyle?`${i.fontStyle} `:""}${i.fontVariant?`${i.fontVariant} `:""}${i.fontWeight?`${i.fontWeight} `:""}${i.fontStretch?`${i.fontStretch} `:""}${i.fontSize||""}${i.lineHeight?`/${i.lineHeight} `:""}${i.fontFamily||""}`)}),t}function sde(e,t){return{toolbar:{minHeight:56,[e.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[e.up("sm")]:{minHeight:64}},...t}}function rde(e){return Math.round(e*1e5)/1e5}const p$={textTransform:"uppercase"},x$='"Roboto", "Helvetica", "Arial", sans-serif';function ide(e,t){const{fontFamily:n=x$,fontSize:s=14,fontWeightLight:r=300,fontWeightRegular:i=400,fontWeightMedium:o=500,fontWeightBold:l=700,htmlFontSize:c=16,allVariants:u,pxToRem:d,...h}=typeof t=="function"?t(e):t,p=s/14,x=d||(y=>`${y/c*p}rem`),v=(y,N,w,S,_)=>({fontFamily:n,fontWeight:y,fontSize:x(N),lineHeight:w,...n===x$?{letterSpacing:`${rde(S/N)}em`}:{},..._,...u}),j={h1:v(r,96,1.167,-1.5),h2:v(r,60,1.2,-.5),h3:v(i,48,1.167,0),h4:v(i,34,1.235,.25),h5:v(i,24,1.334,0),h6:v(o,20,1.6,.15),subtitle1:v(i,16,1.75,.15),subtitle2:v(o,14,1.57,.1),body1:v(i,16,1.5,.15),body2:v(i,14,1.43,.15),button:v(o,14,1.75,.4,p$),caption:v(i,12,1.66,.4),overline:v(i,12,2.66,1,p$),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return zr({htmlFontSize:c,pxToRem:x,fontFamily:n,fontSize:s,fontWeightLight:r,fontWeightRegular:i,fontWeightMedium:o,fontWeightBold:l,...j},h,{clone:!1})}const ode=.2,lde=.14,cde=.12;function ln(...e){return[`${e[0]}px ${e[1]}px ${e[2]}px ${e[3]}px rgba(0,0,0,${ode})`,`${e[4]}px ${e[5]}px ${e[6]}px ${e[7]}px rgba(0,0,0,${lde})`,`${e[8]}px ${e[9]}px ${e[10]}px ${e[11]}px rgba(0,0,0,${cde})`].join(",")}const dde=["none",ln(0,2,1,-1,0,1,1,0,0,1,3,0),ln(0,3,1,-2,0,2,2,0,0,1,5,0),ln(0,3,3,-2,0,3,4,0,0,1,8,0),ln(0,2,4,-1,0,4,5,0,0,1,10,0),ln(0,3,5,-1,0,5,8,0,0,1,14,0),ln(0,3,5,-1,0,6,10,0,0,1,18,0),ln(0,4,5,-2,0,7,10,1,0,2,16,1),ln(0,5,5,-3,0,8,10,1,0,3,14,2),ln(0,5,6,-3,0,9,12,1,0,3,16,2),ln(0,6,6,-3,0,10,14,1,0,4,18,3),ln(0,6,7,-4,0,11,15,1,0,4,20,3),ln(0,7,8,-4,0,12,17,2,0,5,22,4),ln(0,7,8,-4,0,13,19,2,0,5,24,4),ln(0,7,9,-4,0,14,21,2,0,5,26,4),ln(0,8,9,-5,0,15,22,2,0,6,28,5),ln(0,8,10,-5,0,16,24,2,0,6,30,5),ln(0,8,11,-5,0,17,26,2,0,6,32,5),ln(0,9,11,-5,0,18,28,2,0,7,34,6),ln(0,9,12,-6,0,19,29,2,0,7,36,6),ln(0,10,13,-6,0,20,31,3,0,8,38,7),ln(0,10,13,-6,0,21,33,3,0,8,40,7),ln(0,10,14,-6,0,22,35,3,0,8,42,7),ln(0,11,14,-7,0,23,36,3,0,9,44,8),ln(0,11,15,-7,0,24,38,3,0,9,46,8)],ude={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},mde={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function y$(e){return`${Math.round(e)}ms`}function fde(e){if(!e)return 0;const t=e/36;return Math.min(Math.round((4+15*t**.25+t/5)*10),3e3)}function hde(e){const t={...ude,...e.easing},n={...mde,...e.duration};return{getAutoHeightDuration:fde,create:(r=["all"],i={})=>{const{duration:o=n.standard,easing:l=t.easeInOut,delay:c=0,...u}=i;return(Array.isArray(r)?r:[r]).map(d=>`${d} ${typeof o=="string"?o:y$(o)} ${l} ${typeof c=="string"?c:y$(c)}`).join(",")},...e,easing:t,duration:n}}const gde={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500};function pde(e){return To(e)||typeof e>"u"||typeof e=="string"||typeof e=="boolean"||typeof e=="number"||Array.isArray(e)}function V9(e={}){const t={...e};function n(s){const r=Object.entries(s);for(let i=0;i<r.length;i++){const[o,l]=r[i];!pde(l)||o.startsWith("unstable_")?delete s[o]:To(l)&&(s[o]={...l},n(s[o]))}}return n(t),`import { unstable_createBreakpoints as createBreakpoints, createTransitions } from '@mui/material/styles';

const theme = ${JSON.stringify(t,null,2)};

theme.breakpoints = createBreakpoints(theme.breakpoints || {});
theme.transitions = createTransitions(theme.transitions || {});

export default theme;`}function b$(e){return typeof e=="number"?`${(e*100).toFixed(0)}%`:`calc((${e}) * 100%)`}const xde=e=>{if(!Number.isNaN(+e))return+e;const t=e.match(/\d*\.?\d+/g);if(!t)return 0;let n=0;for(let s=0;s<t.length;s+=1)n+=+t[s];return n};function yde(e){Object.assign(e,{alpha(t,n){const s=this||e;return s.colorSpace?`oklch(from ${t} l c h / ${typeof n=="string"?`calc(${n})`:n})`:s.vars?`rgba(${t.replace(/var\(--([^,\s)]+)(?:,[^)]+)?\)+/g,"var(--$1Channel)")} / ${typeof n=="string"?`calc(${n})`:n})`:H9(t,xde(n))},lighten(t,n){const s=this||e;return s.colorSpace?`color-mix(in ${s.colorSpace}, ${t}, #fff ${b$(n)})`:Pj(t,n)},darken(t,n){const s=this||e;return s.colorSpace?`color-mix(in ${s.colorSpace}, ${t}, #000 ${b$(n)})`:Lj(t,n)}})}function dk(e={},...t){const{breakpoints:n,mixins:s={},spacing:r,palette:i={},transitions:o={},typography:l={},shape:c,colorSpace:u,...d}=e;if(e.vars&&e.generateThemeVars===void 0)throw new Error(Du(20));const h=FL({...i,colorSpace:u}),p=RL(e);let x=zr(p,{mixins:sde(p.breakpoints,s),palette:h,shadows:dde.slice(),typography:ide(h,l),transitions:hde(o),zIndex:{...gde}});return x=zr(x,d),x=t.reduce((v,j)=>zr(v,j),x),x.unstable_sxConfig={...gx,...d?.unstable_sxConfig},x.unstable_sx=function(j){return Af({sx:j,theme:this})},x.toRuntimeSource=V9,yde(x),x}function bde(e){let t;return e<1?t=5.11916*e**2:t=4.5*Math.log(e+1)+2,Math.round(t*10)/1e3}const vde=[...Array(25)].map((e,t)=>{if(t===0)return"none";const n=bde(t);return`linear-gradient(rgba(255 255 255 / ${n}), rgba(255 255 255 / ${n}))`});function Y9(e){return{inputPlaceholder:e==="dark"?.5:.42,inputUnderline:e==="dark"?.7:.42,switchTrackDisabled:e==="dark"?.2:.12,switchTrack:e==="dark"?.3:.38}}function Q9(e){return e==="dark"?vde:[]}function wde(e){const{palette:t={mode:"light"},opacity:n,overlays:s,colorSpace:r,...i}=e,o=FL({...t,colorSpace:r});return{palette:o,opacity:{...Y9(o.mode),...n},overlays:s||Q9(o.mode),...i}}function jde(e){return!!e[0].match(/(cssVarPrefix|colorSchemeSelector|modularCssLayers|rootSelector|typography|mixins|breakpoints|direction|transitions)/)||!!e[0].match(/sxConfig$/)||e[0]==="palette"&&!!e[1]?.match(/(mode|contrastThreshold|tonalOffset)/)}const Nde=e=>[...[...Array(25)].map((t,n)=>`--${e?`${e}-`:""}overlays-${n}`),`--${e?`${e}-`:""}palette-AppBar-darkBg`,`--${e?`${e}-`:""}palette-AppBar-darkColor`],Cde=e=>(t,n)=>{const s=e.rootSelector||":root",r=e.colorSchemeSelector;let i=r;if(r==="class"&&(i=".%s"),r==="data"&&(i="[data-%s]"),r?.startsWith("data-")&&!r.includes("%s")&&(i=`[${r}="%s"]`),e.defaultColorScheme===t){if(t==="dark"){const o={};return Nde(e.cssVarPrefix).forEach(l=>{o[l]=n[l],delete n[l]}),i==="media"?{[s]:n,"@media (prefers-color-scheme: dark)":{[s]:o}}:i?{[i.replace("%s",t)]:o,[`${s}, ${i.replace("%s",t)}`]:n}:{[s]:{...n,...o}}}if(i&&i!=="media")return`${s}, ${i.replace("%s",String(t))}`}else if(t){if(i==="media")return{[`@media (prefers-color-scheme: ${String(t)})`]:{[s]:n}};if(i)return i.replace("%s",String(t))}return s};function Sde(e,t){t.forEach(n=>{e[n]||(e[n]={})})}function yt(e,t,n){!e[t]&&n&&(e[t]=n)}function Hg(e){return typeof e!="string"||!e.startsWith("hsl")?e:B9(e)}function pl(e,t){`${t}Channel`in e||(e[`${t}Channel`]=Bg(Hg(e[t])))}function _de(e){return typeof e=="number"?`${e}px`:typeof e=="string"||typeof e=="function"||Array.isArray(e)?e:"8px"}const mo=e=>{try{return e()}catch{}},Ade=(e="mui")=>qce(e);function c2(e,t,n,s,r){if(!n)return;n=n===!0?{}:n;const i=r==="dark"?"dark":"light";if(!s){t[r]=wde({...n,palette:{mode:i,...n?.palette},colorSpace:e});return}const{palette:o,...l}=dk({...s,palette:{mode:i,...n?.palette},colorSpace:e});return t[r]={...n,palette:o,opacity:{...Y9(i),...n?.opacity},overlays:n?.overlays||Q9(i)},l}function Tde(e={},...t){const{colorSchemes:n={light:!0},defaultColorScheme:s,disableCssColorScheme:r=!1,cssVarPrefix:i="mui",nativeColor:o=!1,shouldSkipGeneratingVar:l=jde,colorSchemeSelector:c=n.light&&n.dark?"media":void 0,rootSelector:u=":root",...d}=e,h=Object.keys(n)[0],p=s||(n.light&&h!=="light"?"light":h),x=Ade(i),{[p]:v,light:j,dark:y,...N}=n,w={...N};let S=v;if((p==="dark"&&!("dark"in n)||p==="light"&&!("light"in n))&&(S=!0),!S)throw new Error(Du(21,p));let _;o&&(_="oklch");const k=c2(_,w,S,d,p);j&&!w.light&&c2(_,w,j,void 0,"light"),y&&!w.dark&&c2(_,w,y,void 0,"dark");let T={defaultColorScheme:p,...k,cssVarPrefix:i,colorSchemeSelector:c,rootSelector:u,getCssVar:x,colorSchemes:w,font:{...nde(k.typography),...k.font},spacing:_de(d.spacing)};Object.keys(T.colorSchemes).forEach(P=>{const D=T.colorSchemes[P].palette,U=R=>{const q=R.split("-"),Z=q[1],V=q[2];return x(R,D[Z][V])};D.mode==="light"&&(yt(D.common,"background","#fff"),yt(D.common,"onBackground","#000")),D.mode==="dark"&&(yt(D.common,"background","#000"),yt(D.common,"onBackground","#fff"));function B(R,q,Z){if(_){let V;return R===Qd&&(V=`transparent ${((1-Z)*100).toFixed(0)}%`),R===Ma&&(V=`#000 ${(Z*100).toFixed(0)}%`),R===Ia&&(V=`#fff ${(Z*100).toFixed(0)}%`),`color-mix(in ${_}, ${q}, ${V})`}return R(q,Z)}if(Sde(D,["Alert","AppBar","Avatar","Button","Chip","FilledInput","LinearProgress","Skeleton","Slider","SnackbarContent","SpeedDialAction","StepConnector","StepContent","Switch","TableCell","Tooltip"]),D.mode==="light"){yt(D.Alert,"errorColor",B(Ma,D.error.light,.6)),yt(D.Alert,"infoColor",B(Ma,D.info.light,.6)),yt(D.Alert,"successColor",B(Ma,D.success.light,.6)),yt(D.Alert,"warningColor",B(Ma,D.warning.light,.6)),yt(D.Alert,"errorFilledBg",U("palette-error-main")),yt(D.Alert,"infoFilledBg",U("palette-info-main")),yt(D.Alert,"successFilledBg",U("palette-success-main")),yt(D.Alert,"warningFilledBg",U("palette-warning-main")),yt(D.Alert,"errorFilledColor",mo(()=>D.getContrastText(D.error.main))),yt(D.Alert,"infoFilledColor",mo(()=>D.getContrastText(D.info.main))),yt(D.Alert,"successFilledColor",mo(()=>D.getContrastText(D.success.main))),yt(D.Alert,"warningFilledColor",mo(()=>D.getContrastText(D.warning.main))),yt(D.Alert,"errorStandardBg",B(Ia,D.error.light,.9)),yt(D.Alert,"infoStandardBg",B(Ia,D.info.light,.9)),yt(D.Alert,"successStandardBg",B(Ia,D.success.light,.9)),yt(D.Alert,"warningStandardBg",B(Ia,D.warning.light,.9)),yt(D.Alert,"errorIconColor",U("palette-error-main")),yt(D.Alert,"infoIconColor",U("palette-info-main")),yt(D.Alert,"successIconColor",U("palette-success-main")),yt(D.Alert,"warningIconColor",U("palette-warning-main")),yt(D.AppBar,"defaultBg",U("palette-grey-100")),yt(D.Avatar,"defaultBg",U("palette-grey-400")),yt(D.Button,"inheritContainedBg",U("palette-grey-300")),yt(D.Button,"inheritContainedHoverBg",U("palette-grey-A100")),yt(D.Chip,"defaultBorder",U("palette-grey-400")),yt(D.Chip,"defaultAvatarColor",U("palette-grey-700")),yt(D.Chip,"defaultIconColor",U("palette-grey-700")),yt(D.FilledInput,"bg","rgba(0, 0, 0, 0.06)"),yt(D.FilledInput,"hoverBg","rgba(0, 0, 0, 0.09)"),yt(D.FilledInput,"disabledBg","rgba(0, 0, 0, 0.12)"),yt(D.LinearProgress,"primaryBg",B(Ia,D.primary.main,.62)),yt(D.LinearProgress,"secondaryBg",B(Ia,D.secondary.main,.62)),yt(D.LinearProgress,"errorBg",B(Ia,D.error.main,.62)),yt(D.LinearProgress,"infoBg",B(Ia,D.info.main,.62)),yt(D.LinearProgress,"successBg",B(Ia,D.success.main,.62)),yt(D.LinearProgress,"warningBg",B(Ia,D.warning.main,.62)),yt(D.Skeleton,"bg",_?B(Qd,D.text.primary,.11):`rgba(${U("palette-text-primaryChannel")} / 0.11)`),yt(D.Slider,"primaryTrack",B(Ia,D.primary.main,.62)),yt(D.Slider,"secondaryTrack",B(Ia,D.secondary.main,.62)),yt(D.Slider,"errorTrack",B(Ia,D.error.main,.62)),yt(D.Slider,"infoTrack",B(Ia,D.info.main,.62)),yt(D.Slider,"successTrack",B(Ia,D.success.main,.62)),yt(D.Slider,"warningTrack",B(Ia,D.warning.main,.62));const R=_?B(Ma,D.background.default,.6825):Uy(D.background.default,.8);yt(D.SnackbarContent,"bg",R),yt(D.SnackbarContent,"color",mo(()=>_?ck.text.primary:D.getContrastText(R))),yt(D.SpeedDialAction,"fabHoverBg",Uy(D.background.paper,.15)),yt(D.StepConnector,"border",U("palette-grey-400")),yt(D.StepContent,"border",U("palette-grey-400")),yt(D.Switch,"defaultColor",U("palette-common-white")),yt(D.Switch,"defaultDisabledColor",U("palette-grey-100")),yt(D.Switch,"primaryDisabledColor",B(Ia,D.primary.main,.62)),yt(D.Switch,"secondaryDisabledColor",B(Ia,D.secondary.main,.62)),yt(D.Switch,"errorDisabledColor",B(Ia,D.error.main,.62)),yt(D.Switch,"infoDisabledColor",B(Ia,D.info.main,.62)),yt(D.Switch,"successDisabledColor",B(Ia,D.success.main,.62)),yt(D.Switch,"warningDisabledColor",B(Ia,D.warning.main,.62)),yt(D.TableCell,"border",B(Ia,B(Qd,D.divider,1),.88)),yt(D.Tooltip,"bg",B(Qd,D.grey[700],.92))}if(D.mode==="dark"){yt(D.Alert,"errorColor",B(Ia,D.error.light,.6)),yt(D.Alert,"infoColor",B(Ia,D.info.light,.6)),yt(D.Alert,"successColor",B(Ia,D.success.light,.6)),yt(D.Alert,"warningColor",B(Ia,D.warning.light,.6)),yt(D.Alert,"errorFilledBg",U("palette-error-dark")),yt(D.Alert,"infoFilledBg",U("palette-info-dark")),yt(D.Alert,"successFilledBg",U("palette-success-dark")),yt(D.Alert,"warningFilledBg",U("palette-warning-dark")),yt(D.Alert,"errorFilledColor",mo(()=>D.getContrastText(D.error.dark))),yt(D.Alert,"infoFilledColor",mo(()=>D.getContrastText(D.info.dark))),yt(D.Alert,"successFilledColor",mo(()=>D.getContrastText(D.success.dark))),yt(D.Alert,"warningFilledColor",mo(()=>D.getContrastText(D.warning.dark))),yt(D.Alert,"errorStandardBg",B(Ma,D.error.light,.9)),yt(D.Alert,"infoStandardBg",B(Ma,D.info.light,.9)),yt(D.Alert,"successStandardBg",B(Ma,D.success.light,.9)),yt(D.Alert,"warningStandardBg",B(Ma,D.warning.light,.9)),yt(D.Alert,"errorIconColor",U("palette-error-main")),yt(D.Alert,"infoIconColor",U("palette-info-main")),yt(D.Alert,"successIconColor",U("palette-success-main")),yt(D.Alert,"warningIconColor",U("palette-warning-main")),yt(D.AppBar,"defaultBg",U("palette-grey-900")),yt(D.AppBar,"darkBg",U("palette-background-paper")),yt(D.AppBar,"darkColor",U("palette-text-primary")),yt(D.Avatar,"defaultBg",U("palette-grey-600")),yt(D.Button,"inheritContainedBg",U("palette-grey-800")),yt(D.Button,"inheritContainedHoverBg",U("palette-grey-700")),yt(D.Chip,"defaultBorder",U("palette-grey-700")),yt(D.Chip,"defaultAvatarColor",U("palette-grey-300")),yt(D.Chip,"defaultIconColor",U("palette-grey-300")),yt(D.FilledInput,"bg","rgba(255, 255, 255, 0.09)"),yt(D.FilledInput,"hoverBg","rgba(255, 255, 255, 0.13)"),yt(D.FilledInput,"disabledBg","rgba(255, 255, 255, 0.12)"),yt(D.LinearProgress,"primaryBg",B(Ma,D.primary.main,.5)),yt(D.LinearProgress,"secondaryBg",B(Ma,D.secondary.main,.5)),yt(D.LinearProgress,"errorBg",B(Ma,D.error.main,.5)),yt(D.LinearProgress,"infoBg",B(Ma,D.info.main,.5)),yt(D.LinearProgress,"successBg",B(Ma,D.success.main,.5)),yt(D.LinearProgress,"warningBg",B(Ma,D.warning.main,.5)),yt(D.Skeleton,"bg",_?B(Qd,D.text.primary,.13):`rgba(${U("palette-text-primaryChannel")} / 0.13)`),yt(D.Slider,"primaryTrack",B(Ma,D.primary.main,.5)),yt(D.Slider,"secondaryTrack",B(Ma,D.secondary.main,.5)),yt(D.Slider,"errorTrack",B(Ma,D.error.main,.5)),yt(D.Slider,"infoTrack",B(Ma,D.info.main,.5)),yt(D.Slider,"successTrack",B(Ma,D.success.main,.5)),yt(D.Slider,"warningTrack",B(Ma,D.warning.main,.5));const R=_?B(Ia,D.background.default,.985):Uy(D.background.default,.98);yt(D.SnackbarContent,"bg",R),yt(D.SnackbarContent,"color",mo(()=>_?G9.text.primary:D.getContrastText(R))),yt(D.SpeedDialAction,"fabHoverBg",Uy(D.background.paper,.15)),yt(D.StepConnector,"border",U("palette-grey-600")),yt(D.StepContent,"border",U("palette-grey-600")),yt(D.Switch,"defaultColor",U("palette-grey-300")),yt(D.Switch,"defaultDisabledColor",U("palette-grey-600")),yt(D.Switch,"primaryDisabledColor",B(Ma,D.primary.main,.55)),yt(D.Switch,"secondaryDisabledColor",B(Ma,D.secondary.main,.55)),yt(D.Switch,"errorDisabledColor",B(Ma,D.error.main,.55)),yt(D.Switch,"infoDisabledColor",B(Ma,D.info.main,.55)),yt(D.Switch,"successDisabledColor",B(Ma,D.success.main,.55)),yt(D.Switch,"warningDisabledColor",B(Ma,D.warning.main,.55)),yt(D.TableCell,"border",B(Ma,B(Qd,D.divider,1),.68)),yt(D.Tooltip,"bg",B(Qd,D.grey[700],.92))}pl(D.background,"default"),pl(D.background,"paper"),pl(D.common,"background"),pl(D.common,"onBackground"),pl(D,"divider"),Object.keys(D).forEach(R=>{const q=D[R];R!=="tonalOffset"&&q&&typeof q=="object"&&(q.main&&yt(D[R],"mainChannel",Bg(Hg(q.main))),q.light&&yt(D[R],"lightChannel",Bg(Hg(q.light))),q.dark&&yt(D[R],"darkChannel",Bg(Hg(q.dark))),q.contrastText&&yt(D[R],"contrastTextChannel",Bg(Hg(q.contrastText))),R==="text"&&(pl(D[R],"primary"),pl(D[R],"secondary")),R==="action"&&(q.active&&pl(D[R],"active"),q.selected&&pl(D[R],"selected")))})}),T=t.reduce((P,D)=>zr(P,D),T);const A={prefix:i,disableCssColorScheme:r,shouldSkipGeneratingVar:l,getSelector:Cde(T),enableContrastVars:o},{vars:E,generateThemeVars:M,generateStyleSheets:z}=Vce(T,A);return T.vars=E,Object.entries(T.colorSchemes[T.defaultColorScheme]).forEach(([P,D])=>{T[P]=D}),T.generateThemeVars=M,T.generateStyleSheets=z,T.generateSpacing=function(){return O9(d.spacing,kL(this))},T.getColorSchemeSelector=Yce(c),T.spacing=T.generateSpacing(),T.shouldSkipGeneratingVar=l,T.unstable_sxConfig={...gx,...d?.unstable_sxConfig},T.unstable_sx=function(D){return Af({sx:D,theme:this})},T.toRuntimeSource=V9,T}function v$(e,t,n){e.colorSchemes&&n&&(e.colorSchemes[t]={...n!==!0&&n,palette:FL({...n===!0?{}:n.palette,mode:t})})}function kde(e={},...t){const{palette:n,cssVariables:s=!1,colorSchemes:r=n?void 0:{light:!0},defaultColorScheme:i=n?.mode,...o}=e,l=i||"light",c=r?.[l],u={...r,...n?{[l]:{...typeof c!="boolean"&&c,palette:n}}:void 0};if(s===!1){if(!("colorSchemes"in e))return dk(e,...t);let d=n;"palette"in e||u[l]&&(u[l]!==!0?d=u[l].palette:l==="dark"&&(d={mode:"dark"}));const h=dk({...e,palette:d},...t);return h.defaultColorScheme=l,h.colorSchemes=u,h.palette.mode==="light"&&(h.colorSchemes.light={...u.light!==!0&&u.light,palette:h.palette},v$(h,"dark",u.dark)),h.palette.mode==="dark"&&(h.colorSchemes.dark={...u.dark!==!0&&u.dark,palette:h.palette},v$(h,"light",u.light)),h}return!n&&!("light"in u)&&l==="light"&&(u.light=!0),Tde({...o,colorSchemes:u,defaultColorScheme:l,...typeof s!="boolean"&&s},...t)}const UL=kde(),Oj="$$material";function Yo(){const e=I9(UL);return e[Oj]||e}function Ede(e){return e!=="ownerState"&&e!=="theme"&&e!=="sx"&&e!=="as"}const K9=e=>Ede(e)&&e!=="classes",fa=Nce({themeId:Oj,defaultTheme:UL,rootShouldForwardProp:K9});function Lde(){return ule}function Sd(e){return Fce(e)}function Uo(...e){const t=f.useRef(void 0),n=f.useCallback(s=>{const r=e.map(i=>{if(i==null)return null;if(typeof i=="function"){const o=i,l=o(s);return typeof l=="function"?l:()=>{o(null)}}return i.current=s,()=>{i.current=null}});return()=>{r.forEach(i=>i?.())}},e);return f.useMemo(()=>e.every(s=>s==null)?null:s=>{t.current&&(t.current(),t.current=void 0),s!=null&&(t.current=n(s))},e)}function Pde(e){return typeof e=="string"}function X9(e,t,n){return e===void 0||Pde(e)?t:{...t,ownerState:{...t.ownerState,...n}}}function Z9(e,t,n){return typeof e=="function"?e(t,n):e}function Dde(e,t=[]){if(e===void 0)return{};const n={};return Object.keys(e).filter(s=>s.match(/^on[A-Z]/)&&typeof e[s]=="function"&&!t.includes(s)).forEach(s=>{n[s]=e[s]}),n}function w$(e){if(e===void 0)return{};const t={};return Object.keys(e).filter(n=>!(n.match(/^on[A-Z]/)&&typeof e[n]=="function")).forEach(n=>{t[n]=e[n]}),t}function J9(e){const{getSlotProps:t,additionalProps:n,externalSlotProps:s,externalForwardedProps:r,className:i}=e;if(!t){const x=$t(n?.className,i,r?.className,s?.className),v={...n?.style,...r?.style,...s?.style},j={...n,...r,...s};return x.length>0&&(j.className=x),Object.keys(v).length>0&&(j.style=v),{props:j,internalRef:void 0}}const o=Dde({...r,...s}),l=w$(s),c=w$(r),u=t(o),d=$t(u?.className,n?.className,i,r?.className,s?.className),h={...u?.style,...n?.style,...r?.style,...s?.style},p={...u,...n,...c,...l};return d.length>0&&(p.className=d),Object.keys(h).length>0&&(p.style=h),{props:p,internalRef:u.ref}}function j$(e,t){const{className:n,elementType:s,ownerState:r,externalForwardedProps:i,internalForwardedProps:o,shouldForwardComponentProp:l=!1,...c}=t,{component:u,slots:d={[e]:void 0},slotProps:h={[e]:void 0},...p}=i,x=d[e]||s,v=Z9(h[e],r),{props:{component:j,...y},internalRef:N}=J9({className:n,...c,externalForwardedProps:e==="root"?p:void 0,externalSlotProps:v}),w=Uo(N,v?.ref,t.ref),S=e==="root"?j||u:j,_=X9(x,{...e==="root"&&!u&&!d[e]&&o,...e!=="root"&&!d[e]&&o,...y,...S&&!l&&{as:S},...S&&l&&{component:S},ref:w},r);return[x,_]}function ya(e,t){if(e==null)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;n[s]=e[s]}return n}function uk(e,t){return uk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},uk(e,t)}function eq(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,uk(e,t)}const N$={disabled:!1},Lv=wt.createContext(null);var Ode=function(t){return t.scrollTop},qg="unmounted",eu="exited",tu="entering",lf="entered",mk="exiting",nc=(function(e){eq(t,e);function t(s,r){var i;i=e.call(this,s,r)||this;var o=r,l=o&&!o.isMounting?s.enter:s.appear,c;return i.appearStatus=null,s.in?l?(c=eu,i.appearStatus=tu):c=lf:s.unmountOnExit||s.mountOnEnter?c=qg:c=eu,i.state={status:c},i.nextCallback=null,i}t.getDerivedStateFromProps=function(r,i){var o=r.in;return o&&i.status===qg?{status:eu}:null};var n=t.prototype;return n.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},n.componentDidUpdate=function(r){var i=null;if(r!==this.props){var o=this.state.status;this.props.in?o!==tu&&o!==lf&&(i=tu):(o===tu||o===lf)&&(i=mk)}this.updateStatus(!1,i)},n.componentWillUnmount=function(){this.cancelNextCallback()},n.getTimeouts=function(){var r=this.props.timeout,i,o,l;return i=o=l=r,r!=null&&typeof r!="number"&&(i=r.exit,o=r.enter,l=r.appear!==void 0?r.appear:o),{exit:i,enter:o,appear:l}},n.updateStatus=function(r,i){if(r===void 0&&(r=!1),i!==null)if(this.cancelNextCallback(),i===tu){if(this.props.unmountOnExit||this.props.mountOnEnter){var o=this.props.nodeRef?this.props.nodeRef.current:Iy.findDOMNode(this);o&&Ode(o)}this.performEnter(r)}else this.performExit();else this.props.unmountOnExit&&this.state.status===eu&&this.setState({status:qg})},n.performEnter=function(r){var i=this,o=this.props.enter,l=this.context?this.context.isMounting:r,c=this.props.nodeRef?[l]:[Iy.findDOMNode(this),l],u=c[0],d=c[1],h=this.getTimeouts(),p=l?h.appear:h.enter;if(!r&&!o||N$.disabled){this.safeSetState({status:lf},function(){i.props.onEntered(u)});return}this.props.onEnter(u,d),this.safeSetState({status:tu},function(){i.props.onEntering(u,d),i.onTransitionEnd(p,function(){i.safeSetState({status:lf},function(){i.props.onEntered(u,d)})})})},n.performExit=function(){var r=this,i=this.props.exit,o=this.getTimeouts(),l=this.props.nodeRef?void 0:Iy.findDOMNode(this);if(!i||N$.disabled){this.safeSetState({status:eu},function(){r.props.onExited(l)});return}this.props.onExit(l),this.safeSetState({status:mk},function(){r.props.onExiting(l),r.onTransitionEnd(o.exit,function(){r.safeSetState({status:eu},function(){r.props.onExited(l)})})})},n.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},n.safeSetState=function(r,i){i=this.setNextCallback(i),this.setState(r,i)},n.setNextCallback=function(r){var i=this,o=!0;return this.nextCallback=function(l){o&&(o=!1,i.nextCallback=null,r(l))},this.nextCallback.cancel=function(){o=!1},this.nextCallback},n.onTransitionEnd=function(r,i){this.setNextCallback(i);var o=this.props.nodeRef?this.props.nodeRef.current:Iy.findDOMNode(this),l=r==null&&!this.props.addEndListener;if(!o||l){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var c=this.props.nodeRef?[this.nextCallback]:[o,this.nextCallback],u=c[0],d=c[1];this.props.addEndListener(u,d)}r!=null&&setTimeout(this.nextCallback,r)},n.render=function(){var r=this.state.status;if(r===qg)return null;var i=this.props,o=i.children;i.in,i.mountOnEnter,i.unmountOnExit,i.appear,i.enter,i.exit,i.timeout,i.addEndListener,i.onEnter,i.onEntering,i.onEntered,i.onExit,i.onExiting,i.onExited,i.nodeRef;var l=ya(i,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return wt.createElement(Lv.Provider,{value:null},typeof o=="function"?o(r,l):wt.cloneElement(wt.Children.only(o),l))},t})(wt.Component);nc.contextType=Lv;nc.propTypes={};function Vm(){}nc.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:Vm,onEntering:Vm,onEntered:Vm,onExit:Vm,onExiting:Vm,onExited:Vm};nc.UNMOUNTED=qg;nc.EXITED=eu;nc.ENTERING=tu;nc.ENTERED=lf;nc.EXITING=mk;function Mde(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function BL(e,t){var n=function(i){return t&&f.isValidElement(i)?t(i):i},s=Object.create(null);return e&&f.Children.map(e,function(r){return r}).forEach(function(r){s[r.key]=n(r)}),s}function Ide(e,t){e=e||{},t=t||{};function n(d){return d in t?t[d]:e[d]}var s=Object.create(null),r=[];for(var i in e)i in t?r.length&&(s[i]=r,r=[]):r.push(i);var o,l={};for(var c in t){if(s[c])for(o=0;o<s[c].length;o++){var u=s[c][o];l[s[c][o]]=n(u)}l[c]=n(c)}for(o=0;o<r.length;o++)l[r[o]]=n(r[o]);return l}function fu(e,t,n){return n[t]!=null?n[t]:e.props[t]}function $de(e,t){return BL(e.children,function(n){return f.cloneElement(n,{onExited:t.bind(null,n),in:!0,appear:fu(n,"appear",e),enter:fu(n,"enter",e),exit:fu(n,"exit",e)})})}function Rde(e,t,n){var s=BL(e.children),r=Ide(t,s);return Object.keys(r).forEach(function(i){var o=r[i];if(f.isValidElement(o)){var l=i in t,c=i in s,u=t[i],d=f.isValidElement(u)&&!u.props.in;c&&(!l||d)?r[i]=f.cloneElement(o,{onExited:n.bind(null,o),in:!0,exit:fu(o,"exit",e),enter:fu(o,"enter",e)}):!c&&l&&!d?r[i]=f.cloneElement(o,{in:!1}):c&&l&&f.isValidElement(u)&&(r[i]=f.cloneElement(o,{onExited:n.bind(null,o),in:u.props.in,exit:fu(o,"exit",e),enter:fu(o,"enter",e)}))}}),r}var zde=Object.values||function(e){return Object.keys(e).map(function(t){return e[t]})},Fde={component:"div",childFactory:function(t){return t}},HL=(function(e){eq(t,e);function t(s,r){var i;i=e.call(this,s,r)||this;var o=i.handleExited.bind(Mde(i));return i.state={contextValue:{isMounting:!0},handleExited:o,firstRender:!0},i}var n=t.prototype;return n.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},n.componentWillUnmount=function(){this.mounted=!1},t.getDerivedStateFromProps=function(r,i){var o=i.children,l=i.handleExited,c=i.firstRender;return{children:c?$de(r,l):Rde(r,o,l),firstRender:!1}},n.handleExited=function(r,i){var o=BL(this.props.children);r.key in o||(r.props.onExited&&r.props.onExited(i),this.mounted&&this.setState(function(l){var c=at({},l.children);return delete c[r.key],{children:c}}))},n.render=function(){var r=this.props,i=r.component,o=r.childFactory,l=ya(r,["component","childFactory"]),c=this.state.contextValue,u=zde(this.state.children).map(o);return delete l.appear,delete l.enter,delete l.exit,i===null?wt.createElement(Lv.Provider,{value:c},u):wt.createElement(Lv.Provider,{value:c},wt.createElement(i,l,u))},t})(wt.Component);HL.propTypes={};HL.defaultProps=Fde;function tq(e){return parseInt(f.version,10)>=19?e?.props?.ref||null:e?.ref||null}const Ude=e=>e.scrollTop;function C$(e,t){const{timeout:n,easing:s,style:r={}}=e;return{duration:r.transitionDuration??(typeof n=="number"?n:n[t.mode]||0),easing:r.transitionTimingFunction??(typeof s=="object"?s[t.mode]:s),delay:r.transitionDelay}}const Bde={entering:{opacity:1},entered:{opacity:1}},Hde=f.forwardRef(function(t,n){const s=Yo(),r={enter:s.transitions.duration.enteringScreen,exit:s.transitions.duration.leavingScreen},{addEndListener:i,appear:o=!0,children:l,easing:c,in:u,onEnter:d,onEntered:h,onEntering:p,onExit:x,onExited:v,onExiting:j,style:y,timeout:N=r,TransitionComponent:w=nc,...S}=t,_=f.useRef(null),k=Uo(_,tq(l),n),T=B=>R=>{if(B){const q=_.current;R===void 0?B(q):B(q,R)}},A=T(p),E=T((B,R)=>{Ude(B);const q=C$({style:y,timeout:N,easing:c},{mode:"enter"});B.style.webkitTransition=s.transitions.create("opacity",q),B.style.transition=s.transitions.create("opacity",q),d&&d(B,R)}),M=T(h),z=T(j),P=T(B=>{const R=C$({style:y,timeout:N,easing:c},{mode:"exit"});B.style.webkitTransition=s.transitions.create("opacity",R),B.style.transition=s.transitions.create("opacity",R),x&&x(B)}),D=T(v),U=B=>{i&&i(_.current,B)};return a.jsx(w,{appear:o,in:u,nodeRef:_,onEnter:E,onEntered:M,onEntering:A,onExit:P,onExited:D,onExiting:z,addEndListener:U,timeout:N,...S,children:(B,{ownerState:R,...q})=>f.cloneElement(l,{style:{opacity:0,visibility:B==="exited"&&!u?"hidden":void 0,...Bde[B],...y,...l.props.style},ref:k,...q})})});function qde(e){return Yn("MuiBackdrop",e)}An("MuiBackdrop",["root","invisible"]);const Gde=e=>{const{classes:t,invisible:n}=e;return Vn({root:["root",n&&"invisible"]},qde,t)},Wde=fa("div",{name:"MuiBackdrop",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.invisible&&t.invisible]}})({position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent",variants:[{props:{invisible:!0},style:{backgroundColor:"transparent"}}]}),Vde=f.forwardRef(function(t,n){const s=Sd({props:t,name:"MuiBackdrop"}),{children:r,className:i,component:o="div",invisible:l=!1,open:c,components:u={},componentsProps:d={},slotProps:h={},slots:p={},TransitionComponent:x,transitionDuration:v,...j}=s,y={...s,component:o,invisible:l},N=Gde(y),w={transition:x,root:u.Root,...p},S={...d,...h},_={component:o,slots:w,slotProps:S},[k,T]=j$("root",{elementType:Wde,externalForwardedProps:_,className:$t(N.root,i),ownerState:y}),[A,E]=j$("transition",{elementType:Hde,externalForwardedProps:_,ownerState:y});return a.jsx(A,{in:c,timeout:v,...j,...E,children:a.jsx(k,{"aria-hidden":!0,...T,classes:N,ref:n,children:r})})}),Mu=Hce;function Yde(e){return typeof e.main=="string"}function Qde(e,t=[]){if(!Yde(e))return!1;for(const n of t)if(!e.hasOwnProperty(n)||typeof e[n]!="string")return!1;return!0}function jp(e=[]){return([,t])=>t&&Qde(t,e)}function Kde(e){return Yn("MuiCircularProgress",e)}An("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","track","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);const Mi=44,fk=xx`
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
`,hk=xx`
  0% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: 0;
  }

  50% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -15px;
  }

  100% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: -126px;
  }
`,Xde=typeof fk!="string"?$L`
        animation: ${fk} 1.4s linear infinite;
      `:null,Zde=typeof hk!="string"?$L`
        animation: ${hk} 1.4s ease-in-out infinite;
      `:null,Jde=e=>{const{classes:t,variant:n,color:s,disableShrink:r}=e,i={root:["root",n,`color${Wa(s)}`],svg:["svg"],track:["track"],circle:["circle",`circle${Wa(n)}`,r&&"circleDisableShrink"]};return Vn(i,Kde,t)},eue=fa("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[n.variant],t[`color${Wa(n.color)}`]]}})(Mu(({theme:e})=>({display:"inline-block",variants:[{props:{variant:"determinate"},style:{transition:e.transitions.create("transform")}},{props:{variant:"indeterminate"},style:Xde||{animation:`${fk} 1.4s linear infinite`}},...Object.entries(e.palette).filter(jp()).map(([t])=>({props:{color:t},style:{color:(e.vars||e).palette[t].main}}))]}))),tue=fa("svg",{name:"MuiCircularProgress",slot:"Svg"})({display:"block"}),aue=fa("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.circle,t[`circle${Wa(n.variant)}`],n.disableShrink&&t.circleDisableShrink]}})(Mu(({theme:e})=>({stroke:"currentColor",variants:[{props:{variant:"determinate"},style:{transition:e.transitions.create("stroke-dashoffset")}},{props:{variant:"indeterminate"},style:{strokeDasharray:"80px, 200px",strokeDashoffset:0}},{props:({ownerState:t})=>t.variant==="indeterminate"&&!t.disableShrink,style:Zde||{animation:`${hk} 1.4s ease-in-out infinite`}}]}))),nue=fa("circle",{name:"MuiCircularProgress",slot:"Track"})(Mu(({theme:e})=>({stroke:"currentColor",opacity:(e.vars||e).palette.action.activatedOpacity}))),qL=f.forwardRef(function(t,n){const s=Sd({props:t,name:"MuiCircularProgress"}),{className:r,color:i="primary",disableShrink:o=!1,enableTrackSlot:l=!1,size:c=40,style:u,thickness:d=3.6,value:h=0,variant:p="indeterminate",...x}=s,v={...s,color:i,disableShrink:o,size:c,thickness:d,value:h,variant:p,enableTrackSlot:l},j=Jde(v),y={},N={},w={};if(p==="determinate"){const S=2*Math.PI*((Mi-d)/2);y.strokeDasharray=S.toFixed(3),w["aria-valuenow"]=Math.round(h),y.strokeDashoffset=`${((100-h)/100*S).toFixed(3)}px`,N.transform="rotate(-90deg)"}return a.jsx(eue,{className:$t(j.root,r),style:{width:c,height:c,...N,...u},ownerState:v,ref:n,role:"progressbar",...w,...x,children:a.jsxs(tue,{className:j.svg,ownerState:v,viewBox:`${Mi/2} ${Mi/2} ${Mi} ${Mi}`,children:[l?a.jsx(nue,{className:j.track,ownerState:v,cx:Mi,cy:Mi,r:(Mi-d)/2,fill:"none",strokeWidth:d,"aria-hidden":"true"}):null,a.jsx(aue,{className:j.circle,style:y,ownerState:v,cx:Mi,cy:Mi,r:(Mi-d)/2,fill:"none",strokeWidth:d})]})})});function aq(e){return a.jsx(Vde,{sx:t=>({color:"#fff",zIndex:t.zIndex.drawer+1}),open:e,children:a.jsx(qL,{color:"inherit"})})}var Ss={},By={},S$;function sue(){if(S$)return By;S$=1,Object.defineProperty(By,"__esModule",{value:!0});function e(t,n){return t.reduce((s,r)=>{const i=String(r[n]);return s[i]||(s[i]=[]),s[i].push(r),s},{})}return By.default=e,By}var Hy={},_$;function rue(){if(_$)return Hy;_$=1,Object.defineProperty(Hy,"__esModule",{value:!0});function e(t,n){return t.replace(/{([^{}]*)}/g,(s,r)=>{const i=n[r];return typeof i=="string"||typeof i=="number"?i.toString():s})}return Hy.default=e,Hy}var qy={},A$;function iue(){if(A$)return qy;A$=1,Object.defineProperty(qy,"__esModule",{value:!0});const e=[{countryNameEn:"Andorra",countryNameLocal:"Andorra",countryCode:"AD",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"",tinName:"",officialLanguageCode:"ca",officialLanguageNameEn:"Catalan, Valencian",officialLanguageNameLocal:"Catal, Valenci",countryCallingCode:"376",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Afghanistan",countryNameLocal:"     ,   ",countryCode:"AF",currencyCode:"AFN",currencyNameEn:"Afghan afghani",tinType:"",tinName:"",officialLanguageCode:"fa",officialLanguageNameEn:"Persian",officialLanguageNameLocal:"",countryCallingCode:"93",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Antigua and Barbuda",countryNameLocal:"Antigua and Barbuda",countryCode:"AG",currencyCode:"XCD",currencyNameEn:"East Caribbean dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"1268",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Anguilla",countryNameLocal:"Anguilla",countryCode:"AI",currencyCode:"XCD",currencyNameEn:"East Caribbean dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"1264",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Albania",countryNameLocal:"Shqipria",countryCode:"AL",currencyCode:"ALL",currencyNameEn:"Albanian lek",tinType:"NIPT",tinName:"Numri i Identifikimit pr Personin e Tatueshm",officialLanguageCode:"sq",officialLanguageNameEn:"Albanian",officialLanguageNameLocal:"Shqip",countryCallingCode:"355",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Armenia",countryNameLocal:"",countryCode:"AM",currencyCode:"AMD",currencyNameEn:"Armenian dram",tinType:"",tinName:"",officialLanguageCode:"hy",officialLanguageNameEn:"Armenian",officialLanguageNameLocal:"",countryCallingCode:"374",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Angola",countryNameLocal:"Angola",countryCode:"AO",currencyCode:"AOA",currencyNameEn:"Angolan kwanza",tinType:"",tinName:"",officialLanguageCode:"pt",officialLanguageNameEn:"Portuguese",officialLanguageNameLocal:"Portugus",countryCallingCode:"244",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Antarctica",countryNameLocal:"Antarctica, Antrtico, Antarctique, ",countryCode:"AQ",currencyCode:"",currencyNameEn:"",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"672",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Argentina",countryNameLocal:"Argentina",countryCode:"AR",currencyCode:"ARS",currencyNameEn:"Argentine peso",tinType:"CUIT",tinName:"Cdigo nico de Identificacin Tributaria",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espaol",countryCallingCode:"54",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"American Samoa",countryNameLocal:"American Samoa",countryCode:"AS",currencyCode:"USD",currencyNameEn:"United States dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"1684",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Austria",countryNameLocal:"sterreich",countryCode:"AT",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"UID",tinName:"Umsatzsteuer-Identifikationsnummer",officialLanguageCode:"de",officialLanguageNameEn:"German",officialLanguageNameLocal:"Deutsch",countryCallingCode:"43",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Australia",countryNameLocal:"Australia",countryCode:"AU",currencyCode:"AUD",currencyNameEn:"Australian dollar",tinType:"ABN",tinName:"Australian Business Number",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"61",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Aruba",countryNameLocal:"Aruba",countryCode:"AW",currencyCode:"AWG",currencyNameEn:"Aruban florin",tinType:"",tinName:"",officialLanguageCode:"nl",officialLanguageNameEn:"Dutch, Flemish",officialLanguageNameLocal:"Nederlands, Vlaams",countryCallingCode:"297",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"land Islands",countryNameLocal:"land",countryCode:"AX",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"",tinName:"",officialLanguageCode:"sv",officialLanguageNameEn:"Swedish",officialLanguageNameLocal:"Svenska",countryCallingCode:"358",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Azerbaijan",countryNameLocal:"Azrbaycan",countryCode:"AZ",currencyCode:"AZN",currencyNameEn:"Azerbaijani manat",tinType:"",tinName:"",officialLanguageCode:"az",officialLanguageNameEn:"Azerbaijani",officialLanguageNameLocal:"azrbaycan dili",countryCallingCode:"994",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Bosnia and Herzegovina",countryNameLocal:"Bosna i Hercegovina",countryCode:"BA",currencyCode:"BAM",currencyNameEn:"Bosnia and Herzegovina convertible mark",tinType:"",tinName:"",officialLanguageCode:"bs",officialLanguageNameEn:"Bosnian",officialLanguageNameLocal:"bosanski jezik",countryCallingCode:"387",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Barbados",countryNameLocal:"Barbados",countryCode:"BB",currencyCode:"BBD",currencyNameEn:"Barbados dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"1246",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Bangladesh",countryNameLocal:" ",countryCode:"BD",currencyCode:"BDT",currencyNameEn:"Bangladeshi taka",tinType:"",tinName:"",officialLanguageCode:"bn",officialLanguageNameEn:"Bengali",officialLanguageNameLocal:"",countryCallingCode:"880",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Belgium",countryNameLocal:"Belgi, Belgique, Belgien",countryCode:"BE",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"n TVABTW-nr Mwst-nr",tinName:"BTW identificatienummer / Numro de TVA",officialLanguageCode:"nl",officialLanguageNameEn:"Dutch, Flemish",officialLanguageNameLocal:"Nederlands, Vlaams",countryCallingCode:"32",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Burkina Faso",countryNameLocal:"Burkina Faso",countryCode:"BF",currencyCode:"XOF",currencyNameEn:"CFA franc BCEAO",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"226",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Bulgaria",countryNameLocal:"",countryCode:"BG",currencyCode:"BGN",currencyNameEn:"Bulgarian lev",tinType:" ",tinName:"   ",officialLanguageCode:"bg",officialLanguageNameEn:"Bulgarian",officialLanguageNameLocal:" ",countryCallingCode:"359",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Bahrain",countryNameLocal:"",countryCode:"BH",currencyCode:"BHD",currencyNameEn:"Bahraini dinar",tinType:"",tinName:"",officialLanguageCode:"ar",officialLanguageNameEn:"Arabic",officialLanguageNameLocal:"",countryCallingCode:"973",areaCodes:[],region:"Arab States",flag:""},{countryNameEn:"Burundi",countryNameLocal:"Burundi",countryCode:"BI",currencyCode:"BIF",currencyNameEn:"Burundian franc",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"257",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Benin",countryNameLocal:"Bnin",countryCode:"BJ",currencyCode:"XOF",currencyNameEn:"CFA franc BCEAO",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"229",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Saint Barthlemy",countryNameLocal:"Saint-Barthlemy",countryCode:"BL",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"590",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Bermuda",countryNameLocal:"Bermuda",countryCode:"BM",currencyCode:"BMD",currencyNameEn:"Bermudian dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"1441",areaCodes:[],region:"North America",flag:""},{countryNameEn:"Brunei Darussalam",countryNameLocal:"Brunei Darussalam",countryCode:"BN",currencyCode:"BND",currencyNameEn:"Brunei dollar",tinType:"",tinName:"",officialLanguageCode:"ms",officialLanguageNameEn:"Malay",officialLanguageNameLocal:"Bahasa Melayu,  ",countryCallingCode:"673",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Bolivia (Plurinational State of)",countryNameLocal:"Bolivia, Bulibiya, Volvia, Wuliwya",countryCode:"BO",currencyCode:"BOP",currencyNameEn:"",tinType:"NIT",tinName:"Nmero de Identificacin Tributaria",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espaol",countryCallingCode:"591",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Bonaire, Sint Eustatius and Saba",countryNameLocal:"Caribisch Nederland",countryCode:"BQ",currencyCode:"USD",currencyNameEn:"United States dollar",tinType:"",tinName:"",officialLanguageCode:"nl",officialLanguageNameEn:"Dutch, Flemish",officialLanguageNameLocal:"Nederlands, Vlaams",countryCallingCode:"5997",areaCodes:[],region:"Unknown",flag:""},{countryNameEn:"Brazil",countryNameLocal:"Brasil",countryCode:"BR",currencyCode:"BRL",currencyNameEn:"Brazilian real",tinType:"CNPJ",tinName:"Cadastro Nacional de Pessoa Jurdica",officialLanguageCode:"pt",officialLanguageNameEn:"Portuguese",officialLanguageNameLocal:"Portugus",countryCallingCode:"55",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Bhutan",countryNameLocal:"",countryCode:"BT",currencyCode:"BTN",currencyNameEn:"Bhutanese ngultrum",tinType:"",tinName:"",officialLanguageCode:"dz",officialLanguageNameEn:"Dzongkha",officialLanguageNameLocal:"",countryCallingCode:"975",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Bouvet Island",countryNameLocal:"Bouvetya",countryCode:"BV",currencyCode:"NOK",currencyNameEn:"Norwegian krone",tinType:"",tinName:"",officialLanguageCode:"no",officialLanguageNameEn:"Norwegian",officialLanguageNameLocal:"Norsk",countryCallingCode:"47",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Botswana",countryNameLocal:"Botswana",countryCode:"BW",currencyCode:"BWP",currencyNameEn:"Botswana pula",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"267",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Belarus",countryNameLocal:"",countryCode:"BY",currencyCode:"BYR",currencyNameEn:"",tinType:" (UNP)",tinName:"  ",officialLanguageCode:"be",officialLanguageNameEn:"Belarusian",officialLanguageNameLocal:" ",countryCallingCode:"375",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Belize",countryNameLocal:"Belize",countryCode:"BZ",currencyCode:"BZD",currencyNameEn:"Belize dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"501",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Canada",countryNameLocal:"Canada",countryCode:"CA",currencyCode:"CAD",currencyNameEn:"Canadian dollar",tinType:"BN / NE",tinName:"Business Number",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"1",areaCodes:["403","587","780","825","236","250","604","672","778","204","431","506","709","782","902","226","249","289","343","365","416","437","519","548","613","647","705","807","905","367","418","438","450","514","579","581","819","873","306","639","867"],region:"North America",flag:""},{countryNameEn:"Switzerland",countryNameLocal:"Schweiz, Suisse, Svizzera, Svizra",countryCode:"CH",currencyCode:"CHF",currencyNameEn:"Swiss franc",tinType:"MWST/TVA/IVA",tinName:"Mehrwertsteuernummer",officialLanguageCode:"de",officialLanguageNameEn:"German",officialLanguageNameLocal:"Deutsch",countryCallingCode:"41",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Cte d'Ivoire",countryNameLocal:"Cte d'Ivoire",countryCode:"CI",currencyCode:"XOF",currencyNameEn:"CFA franc BCEAO",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"225",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Chile",countryNameLocal:"Chile",countryCode:"CL",currencyCode:"CLP",currencyNameEn:"Chilean peso",tinType:"RUT",tinName:"Rol nico Tributario",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espaol",countryCallingCode:"56",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Cameroon",countryNameLocal:"Cameroun, Cameroon",countryCode:"CM",currencyCode:"XAF",currencyNameEn:"CFA franc BEAC",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"237",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"China",countryNameLocal:"",countryCode:"CN",currencyCode:"CNY",currencyNameEn:"Renminbi (Chinese) yuan",tinType:"",tinName:"",officialLanguageCode:"zh-hans",officialLanguageNameEn:"",officialLanguageNameLocal:"",countryCallingCode:"86",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Colombia",countryNameLocal:"Colombia",countryCode:"CO",currencyCode:"COP",currencyNameEn:"Colombian peso",tinType:"NIT",tinName:"Nmero De Identificacin Tributaria",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espaol",countryCallingCode:"57",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Costa Rica",countryNameLocal:"Costa Rica",countryCode:"CR",currencyCode:"CRC",currencyNameEn:"Costa Rican colon",tinType:"",tinName:"Cdula Jurdica",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espaol",countryCallingCode:"506",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Cuba",countryNameLocal:"Cuba",countryCode:"CU",currencyCode:"CUC",currencyNameEn:"Cuban convertible peso",tinType:"",tinName:"",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espaol",countryCallingCode:"53",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Cabo Verde",countryNameLocal:"Cabo Verde",countryCode:"CV",currencyCode:"CVE",currencyNameEn:"Cape Verdean escudo",tinType:"",tinName:"",officialLanguageCode:"pt",officialLanguageNameEn:"Portuguese",officialLanguageNameLocal:"Portugus",countryCallingCode:"238",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Curaao",countryNameLocal:"Curaao",countryCode:"CW",currencyCode:"ANG",currencyNameEn:"Netherlands Antillean guilder",tinType:"",tinName:"",officialLanguageCode:"nl",officialLanguageNameEn:"Dutch, Flemish",officialLanguageNameLocal:"Nederlands, Vlaams",countryCallingCode:"599",areaCodes:[],region:"Unknown",flag:""},{countryNameEn:"Christmas Island",countryNameLocal:"Christmas Island",countryCode:"CX",currencyCode:"AUD",currencyNameEn:"Australian dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"61",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Cyprus",countryNameLocal:", Kibris",countryCode:"CY",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"",tinName:"  ...",officialLanguageCode:"el",officialLanguageNameEn:"Greek, Modern (1453-)",officialLanguageNameLocal:"",countryCallingCode:"357",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Germany",countryNameLocal:"Deutschland",countryCode:"DE",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"USt-IdNr.",tinName:"Umsatzsteuer-Identifikationsnummer",officialLanguageCode:"de",officialLanguageNameEn:"German",officialLanguageNameLocal:"Deutsch",countryCallingCode:"49",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Djibouti",countryNameLocal:"Djibouti, , Jabuuti, Gabuutih",countryCode:"DJ",currencyCode:"DJF",currencyNameEn:"Djiboutian franc",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"253",areaCodes:[],region:"Arab States",flag:""},{countryNameEn:"Denmark",countryNameLocal:"Danmark",countryCode:"DK",currencyCode:"DKK",currencyNameEn:"Danish krone",tinType:"CVR",tinName:"Momsregistreringsnummer",officialLanguageCode:"da",officialLanguageNameEn:"Danish",officialLanguageNameLocal:"dansk",countryCallingCode:"45",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Dominica",countryNameLocal:"Dominica",countryCode:"DM",currencyCode:"XCD",currencyNameEn:"East Caribbean dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"767",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Algeria",countryNameLocal:"",countryCode:"DZ",currencyCode:"DZD",currencyNameEn:"Algerian dinar",tinType:"",tinName:"",officialLanguageCode:"ar",officialLanguageNameEn:"Arabic",officialLanguageNameLocal:"",countryCallingCode:"213",areaCodes:[],region:"Arab States",flag:""},{countryNameEn:"Ecuador",countryNameLocal:"Ecuador",countryCode:"EC",currencyCode:"USD",currencyNameEn:"United States dollar",tinType:"RUC",tinName:"Nmero de Registro Unico de Contribuyentes",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espaol",countryCallingCode:"593",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Estonia",countryNameLocal:"Eesti",countryCode:"EE",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"KMKR",tinName:"Kibemaksukohustuslase number",officialLanguageCode:"et",officialLanguageNameEn:"Estonian",officialLanguageNameLocal:"eesti, eesti keel",countryCallingCode:"372",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Egypt",countryNameLocal:"",countryCode:"EG",currencyCode:"EGP",currencyNameEn:"Egyptian pound",tinType:"",tinName:"",officialLanguageCode:"ar",officialLanguageNameEn:"Arabic",officialLanguageNameLocal:"",countryCallingCode:"20",areaCodes:[],region:"Arab States",flag:""},{countryNameEn:"Western Sahara",countryNameLocal:"Sahara Occidental",countryCode:"EH",currencyCode:"MAD",currencyNameEn:"Moroccan dirham",tinType:"",tinName:"",officialLanguageCode:"ar",officialLanguageNameEn:"Arabic",officialLanguageNameLocal:"",countryCallingCode:"212",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Eritrea",countryNameLocal:", , Eritrea",countryCode:"ER",currencyCode:"ERN",currencyNameEn:"Eritrean nakfa",tinType:"",tinName:"",officialLanguageCode:"ti",officialLanguageNameEn:"Tigrinya",officialLanguageNameLocal:"",countryCallingCode:"291",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Spain",countryNameLocal:"Espaa",countryCode:"ES",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"NIF (CIF)",tinName:"Nmero de Identificacin Fiscal (formerly named Cdigo de Identificacin Fiscal)",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espaol",countryCallingCode:"34",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Ethiopia",countryNameLocal:", Itoophiyaa",countryCode:"ET",currencyCode:"ETB",currencyNameEn:"Ethiopian birr",tinType:"",tinName:"",officialLanguageCode:"am",officialLanguageNameEn:"Amharic",officialLanguageNameLocal:"",countryCallingCode:"251",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Finland",countryNameLocal:"Suomi",countryCode:"FI",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"ALV nro",tinName:"Arvonlisveronumero",officialLanguageCode:"fi",officialLanguageNameEn:"Finnish",officialLanguageNameLocal:"suomi, suomen kieli",countryCallingCode:"358",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Fiji",countryNameLocal:"Fiji",countryCode:"FJ",currencyCode:"FJD",currencyNameEn:"Fiji dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"679",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Micronesia (Federated States of)",countryNameLocal:"Micronesia",countryCode:"FM",currencyCode:"USD",currencyNameEn:"United States dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"691",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"France",countryNameLocal:"France",countryCode:"FR",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"n TVA",tinName:"Numro d'identification  la taxe sur la valeur ajoute / Numro de TVA intracommunautaire",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"33",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Gabon",countryNameLocal:"Gabon",countryCode:"GA",currencyCode:"XAF",currencyNameEn:"CFA franc BEAC",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"241",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Grenada",countryNameLocal:"Grenada",countryCode:"GD",currencyCode:"XCD",currencyNameEn:"East Caribbean dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"1473",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Georgia",countryNameLocal:"",countryCode:"GE",currencyCode:"GEL",currencyNameEn:"Georgian lari",tinType:"",tinName:"",officialLanguageCode:"ka",officialLanguageNameEn:"Georgian",officialLanguageNameLocal:"",countryCallingCode:"995",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"French Guiana",countryNameLocal:"Guyane franaise",countryCode:"GF",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"594",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Guernsey",countryNameLocal:"Guernsey",countryCode:"GG",currencyCode:"GBP",currencyNameEn:"Pound sterling",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"44",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Ghana",countryNameLocal:"Ghana",countryCode:"GH",currencyCode:"GHS",currencyNameEn:"Ghanaian cedi",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"233",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Gibraltar",countryNameLocal:"Gibraltar",countryCode:"GI",currencyCode:"GIP",currencyNameEn:"Gibraltar pound",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"350",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Greenland",countryNameLocal:"Kalaallit Nunaat, Grnland",countryCode:"GL",currencyCode:"DKK",currencyNameEn:"Danish krone",tinType:"",tinName:"",officialLanguageCode:"kl",officialLanguageNameEn:"Kalaallisut, Greenlandic",officialLanguageNameLocal:"kalaallisut, kalaallit oqaasii",countryCallingCode:"299",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Guinea",countryNameLocal:"Guine",countryCode:"GN",currencyCode:"GNF",currencyNameEn:"Guinean franc",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"224",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Guadeloupe",countryNameLocal:"Guadeloupe",countryCode:"GP",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"590",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Equatorial Guinea",countryNameLocal:"Guiena ecuatorial, Guine quatoriale, Guin Equatorial",countryCode:"GQ",currencyCode:"XAF",currencyNameEn:"CFA franc BEAC",tinType:"",tinName:"",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espaol",countryCallingCode:"240",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Greece",countryNameLocal:"",countryCode:"GR",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"",tinName:"",officialLanguageCode:"el",officialLanguageNameEn:"Greek, Modern (1453-)",officialLanguageNameLocal:"",countryCallingCode:"30",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"South Georgia and the South Sandwich Islands",countryNameLocal:"South Georgia and the South Sandwich Islands",countryCode:"GS",currencyCode:"",currencyNameEn:"",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"500",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Guatemala",countryNameLocal:"Guatemala",countryCode:"GT",currencyCode:"GTQ",currencyNameEn:"Guatemalan quetzal",tinType:"NIT",tinName:"Nmero de Identificacin Tributaria",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espaol",countryCallingCode:"502",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Guam",countryNameLocal:"Guam, Guhn",countryCode:"GU",currencyCode:"USD",currencyNameEn:"United States dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"1",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Guinea-Bissau",countryNameLocal:"Guin-Bissau",countryCode:"GW",currencyCode:"XOF",currencyNameEn:"CFA franc BCEAO",tinType:"",tinName:"",officialLanguageCode:"pt",officialLanguageNameEn:"Portuguese",officialLanguageNameLocal:"Portugus",countryCallingCode:"245",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Guyana",countryNameLocal:"Guyana",countryCode:"GY",currencyCode:"GYD",currencyNameEn:"Guyanese dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"592",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Hong Kong",countryNameLocal:", Hong Kong",countryCode:"HK",currencyCode:"HKD",currencyNameEn:"Hong Kong dollar",tinType:"",tinName:"",officialLanguageCode:"zh-hant",officialLanguageNameEn:"",officialLanguageNameLocal:"",countryCallingCode:"852",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Honduras",countryNameLocal:"Honduras",countryCode:"HN",currencyCode:"HNL",currencyNameEn:"Honduran lempira",tinType:"RTN",tinName:"Registro Tributario Nacional",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espaol",countryCallingCode:"504",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Croatia",countryNameLocal:"Hrvatska",countryCode:"HR",currencyCode:"HRK",currencyNameEn:"Croatian kuna",tinType:"PDV-ID; OIB",tinName:"PDV Id. Broj OIB",officialLanguageCode:"hr",officialLanguageNameEn:"Croatian",officialLanguageNameLocal:"hrvatski jezik",countryCallingCode:"385",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Haiti",countryNameLocal:"Hati, Ayiti",countryCode:"HT",currencyCode:"HTG",currencyNameEn:"Haitian gourde",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"509",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Hungary",countryNameLocal:"Magyarorszg",countryCode:"HU",currencyCode:"HUF",currencyNameEn:"Hungarian forint",tinType:"ANUM",tinName:"Kzssgi adszm",officialLanguageCode:"hu",officialLanguageNameEn:"Hungarian",officialLanguageNameLocal:"magyar",countryCallingCode:"36",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Indonesia",countryNameLocal:"Indonesia",countryCode:"ID",currencyCode:"IDR",currencyNameEn:"Indonesian rupiah",tinType:"NPWP",tinName:"Nomor Pokok Wajib Pajak",officialLanguageCode:"id",officialLanguageNameEn:"Indonesian",officialLanguageNameLocal:"Bahasa Indonesia",countryCallingCode:"62",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Ireland",countryNameLocal:"Ireland, ire",countryCode:"IE",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"VAT or CBL",tinName:"Value added tax identification no.",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"353",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Israel",countryNameLocal:"",countryCode:"IL",currencyCode:"ILS",currencyNameEn:"Israeli new shekel",tinType:"",tinName:`'   / "`,officialLanguageCode:"he",officialLanguageNameEn:"Hebrew",officialLanguageNameLocal:"",countryCallingCode:"972",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Isle of Man",countryNameLocal:"Isle of Man",countryCode:"IM",currencyCode:"GBP",currencyNameEn:"Pound sterling",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"44",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"India",countryNameLocal:", India",countryCode:"IN",currencyCode:"INR",currencyNameEn:"Indian rupee",tinType:"VAT TIN / CST TIN",tinName:"Value Added Tax - Taxpayer Identification Number / Central Sales Tax - Taxpayer Identification Number (In most states)Not applicable",officialLanguageCode:"hi",officialLanguageNameEn:"Hindi",officialLanguageNameLocal:", ",countryCallingCode:"91",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"British Indian Ocean Territories",countryNameLocal:"British Indian Ocean Territories",countryCode:"IO",currencyCode:"USD",currencyNameEn:"United States dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"246",areaCodes:[],region:"Indian Ocean",flag:""},{countryNameEn:"Iraq",countryNameLocal:", Iraq",countryCode:"IQ",currencyCode:"IQD",currencyNameEn:"Iraqi dinar",tinType:"",tinName:"",officialLanguageCode:"ar",officialLanguageNameEn:"Arabic",officialLanguageNameLocal:"",countryCallingCode:"964",areaCodes:[],region:"Arab States",flag:""},{countryNameEn:"Iran (Islamic Republic of)",countryNameLocal:"",countryCode:"IR",currencyCode:"IRR",currencyNameEn:"Iranian rial",tinType:"",tinName:"",officialLanguageCode:"fa",officialLanguageNameEn:"Persian",officialLanguageNameLocal:"",countryCallingCode:"98",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Iceland",countryNameLocal:"sland",countryCode:"IS",currencyCode:"ISK",currencyNameEn:"Icelandic krna",tinType:"VSK / VASK",tinName:"Virisaukaskattsnmer",officialLanguageCode:"is",officialLanguageNameEn:"Icelandic",officialLanguageNameLocal:"slenska",countryCallingCode:"354",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Italy",countryNameLocal:"Italia",countryCode:"IT",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"P.IVA",tinName:"Partita IVA(IVA = Imposta sul Valore Aggiunto)",officialLanguageCode:"it",officialLanguageNameEn:"Italian",officialLanguageNameLocal:"Italiano",countryCallingCode:"39",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Jersey",countryNameLocal:"Jersey",countryCode:"JE",currencyCode:"GBP",currencyNameEn:"Pound sterling",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"44",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Jamaica",countryNameLocal:"Jamaica",countryCode:"JM",currencyCode:"JMD",currencyNameEn:"Jamaican dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"876",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Jordan",countryNameLocal:"",countryCode:"JO",currencyCode:"JOD",currencyNameEn:"Jordanian dinar",tinType:"",tinName:"",officialLanguageCode:"ar",officialLanguageNameEn:"Arabic",officialLanguageNameLocal:"",countryCallingCode:"962",areaCodes:[],region:"Arab States",flag:""},{countryNameEn:"Japan",countryNameLocal:"",countryCode:"JP",currencyCode:"JPY",currencyNameEn:"Japanese yen",tinType:"",tinName:"",officialLanguageCode:"ja",officialLanguageNameEn:"Japanese",officialLanguageNameLocal:" ()",countryCallingCode:"81",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Kenya",countryNameLocal:"Kenya",countryCode:"KE",currencyCode:"KES",currencyNameEn:"Kenyan shilling",tinType:"",tinName:"",officialLanguageCode:"sw",officialLanguageNameEn:"Swahili",officialLanguageNameLocal:"Kiswahili",countryCallingCode:"254",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Kyrgyzstan",countryNameLocal:", ",countryCode:"KG",currencyCode:"KGS",currencyNameEn:"Kyrgyzstani som",tinType:"",tinName:"",officialLanguageCode:"ky",officialLanguageNameEn:"Kirghiz, Kyrgyz",officialLanguageNameLocal:",  ",countryCallingCode:"996",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Cambodia",countryNameLocal:"",countryCode:"KH",currencyCode:"KHR",currencyNameEn:"Cambodian riel",tinType:"",tinName:"",officialLanguageCode:"km",officialLanguageNameEn:"Central Khmer",officialLanguageNameLocal:", , ",countryCallingCode:"855",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"North Korea",countryNameLocal:"",countryCode:"KP",currencyCode:"KPW",currencyNameEn:"North Korean won",tinType:"",tinName:"",officialLanguageCode:"ko",officialLanguageNameEn:"Korean",officialLanguageNameLocal:"",countryCallingCode:"850",areaCodes:[],region:"Asia",flag:""},{countryNameEn:"South Korea",countryNameLocal:"",countryCode:"KR",currencyCode:"KRW",currencyNameEn:"South Korean won",tinType:"",tinName:"",officialLanguageCode:"ko",officialLanguageNameEn:"Korean",officialLanguageNameLocal:"",countryCallingCode:"82",areaCodes:[],region:"Asia",flag:""},{countryNameEn:"Kiribati",countryNameLocal:"Kiribati",countryCode:"KI",currencyCode:"AUD",currencyNameEn:"Australian dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"686",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Saint Kitts and Nevis",countryNameLocal:"Saint Kitts and Nevis",countryCode:"KN",currencyCode:"XCD",currencyNameEn:"East Caribbean dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"1869",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Kuwait",countryNameLocal:"",countryCode:"KW",currencyCode:"KWD",currencyNameEn:"Kuwaiti dinar",tinType:"",tinName:"",officialLanguageCode:"ar",officialLanguageNameEn:"Arabic",officialLanguageNameLocal:"",countryCallingCode:"965",areaCodes:[],region:"Arab States",flag:""},{countryNameEn:"Kazakhstan",countryNameLocal:", ",countryCode:"KZ",currencyCode:"KZT",currencyNameEn:"Kazakhstani tenge",tinType:"",tinName:"",officialLanguageCode:"kk",officialLanguageNameEn:"Kazakh",officialLanguageNameLocal:" ",countryCallingCode:"7",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Lebanon",countryNameLocal:", Liban",countryCode:"LB",currencyCode:"LBP",currencyNameEn:"Lebanese pound",tinType:"",tinName:"",officialLanguageCode:"ar",officialLanguageNameEn:"Arabic",officialLanguageNameLocal:"",countryCallingCode:"961",areaCodes:[],region:"Arab States",flag:""},{countryNameEn:"Saint Lucia",countryNameLocal:"Saint Lucia",countryCode:"LC",currencyCode:"XCD",currencyNameEn:"East Caribbean dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"1758",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Liechtenstein",countryNameLocal:"Liechtenstein",countryCode:"LI",currencyCode:"CHF",currencyNameEn:"Swiss franc",tinType:"",tinName:"",officialLanguageCode:"de",officialLanguageNameEn:"German",officialLanguageNameLocal:"Deutsch",countryCallingCode:"423",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Sri Lanka",countryNameLocal:" , ",countryCode:"LK",currencyCode:"LKR",currencyNameEn:"Sri Lankan rupee",tinType:"",tinName:"",officialLanguageCode:"si",officialLanguageNameEn:"Sinhala, Sinhalese",officialLanguageNameLocal:"",countryCallingCode:"94",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Liberia",countryNameLocal:"Liberia",countryCode:"LR",currencyCode:"LRD",currencyNameEn:"Liberian dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"231",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Lesotho",countryNameLocal:"Lesotho",countryCode:"LS",currencyCode:"LSL",currencyNameEn:"Lesotho loti",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"266",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Lithuania",countryNameLocal:"Lietuva",countryCode:"LT",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"PVM kodas",tinName:"PVM (abbrev. Pridtins verts mokestis) moktojo kodas",officialLanguageCode:"lt",officialLanguageNameEn:"Lithuanian",officialLanguageNameLocal:"lietuvi kalba",countryCallingCode:"370",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Luxembourg",countryNameLocal:"Ltzebuerg, Luxembourg, Luxemburg",countryCode:"LU",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"No. TVA",tinName:"Numro d'identification  la taxe sur la valeur ajoute",officialLanguageCode:"lb",officialLanguageNameEn:"Luxembourgish, Letzeburgesch",officialLanguageNameLocal:"Ltzebuergesch",countryCallingCode:"352",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Latvia",countryNameLocal:"Latvija",countryCode:"LV",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"PVN",tinName:"Pievienots vrtbas nodoka (PVN) reistrcijas numurs",officialLanguageCode:"lv",officialLanguageNameEn:"Latvian",officialLanguageNameLocal:"latvieu valoda",countryCallingCode:"371",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Libya",countryNameLocal:"",countryCode:"LY",currencyCode:"LYD",currencyNameEn:"Libyan dinar",tinType:"",tinName:"",officialLanguageCode:"ar",officialLanguageNameEn:"Arabic",officialLanguageNameLocal:"",countryCallingCode:"218",areaCodes:[],region:"Arab States",flag:""},{countryNameEn:"Morocco",countryNameLocal:"Maroc, , ",countryCode:"MA",currencyCode:"MAD",currencyNameEn:"Moroccan dirham",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"212",areaCodes:[],region:"Arab States",flag:""},{countryNameEn:"Monaco",countryNameLocal:"Monaco",countryCode:"MC",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"377",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Montenegro",countryNameLocal:"Crna Gora,  ",countryCode:"ME",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"",tinName:"",officialLanguageCode:"srp",officialLanguageNameEn:" ",officialLanguageNameLocal:"",countryCallingCode:"382",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Saint Martin (French part)",countryNameLocal:"Saint-Martin",countryCode:"MF",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"590",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Madagascar",countryNameLocal:"Madagasikara, Madagascar",countryCode:"MG",currencyCode:"MGA",currencyNameEn:"Malagasy ariary",tinType:"",tinName:"",officialLanguageCode:"mg",officialLanguageNameEn:"Malagasy",officialLanguageNameLocal:"fiteny malagasy",countryCallingCode:"261",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Mali",countryNameLocal:"Mali",countryCode:"ML",currencyCode:"XOF",currencyNameEn:"CFA franc BCEAO",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"223",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Myanmar",countryNameLocal:"",countryCode:"MM",currencyCode:"MMK",currencyNameEn:"Myanmar kyat",tinType:"",tinName:"",officialLanguageCode:"my",officialLanguageNameEn:"Burmese",officialLanguageNameLocal:"",countryCallingCode:"95",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Mongolia",countryNameLocal:" ",countryCode:"MN",currencyCode:"MNT",currencyNameEn:"Mongolian tgrg",tinType:"",tinName:"",officialLanguageCode:"mn",officialLanguageNameEn:"Mongolian",officialLanguageNameLocal:" ",countryCallingCode:"976",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Macao",countryNameLocal:", Macau",countryCode:"MO",currencyCode:"MOP",currencyNameEn:"Macanese pataca",tinType:"",tinName:"",officialLanguageCode:"zh-hant",officialLanguageNameEn:"",officialLanguageNameLocal:"",countryCallingCode:"853",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Martinique",countryNameLocal:"Martinique",countryCode:"MQ",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"596",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Mauritania",countryNameLocal:", Mauritanie",countryCode:"MR",currencyCode:"MRU",currencyNameEn:"",tinType:"",tinName:"",officialLanguageCode:"ar",officialLanguageNameEn:"Arabic",officialLanguageNameLocal:"",countryCallingCode:"222",areaCodes:[],region:"Arab States",flag:""},{countryNameEn:"Montserrat",countryNameLocal:"Montserrat",countryCode:"MS",currencyCode:"XCD",currencyNameEn:"East Caribbean dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"1664",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Malta",countryNameLocal:"Malta",countryCode:"MT",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"Vat No.",tinName:"Vat reg. no.",officialLanguageCode:"mt",officialLanguageNameEn:"Maltese",officialLanguageNameLocal:"Malti",countryCallingCode:"356",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Mauritius",countryNameLocal:"Maurice, Mauritius",countryCode:"MU",currencyCode:"MUR",currencyNameEn:"Mauritian rupee",tinType:"",tinName:"",officialLanguageCode:"mfe",officialLanguageNameEn:"",officialLanguageNameLocal:"",countryCallingCode:"230",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Maldives",countryNameLocal:"",countryCode:"MV",currencyCode:"MVR",currencyNameEn:"Maldivian rufiyaa",tinType:"",tinName:"",officialLanguageCode:"dv",officialLanguageNameEn:"Divehi, Dhivehi, Maldivian",officialLanguageNameLocal:"",countryCallingCode:"960",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Malawi",countryNameLocal:"Malawi",countryCode:"MW",currencyCode:"MWK",currencyNameEn:"Malawian kwacha",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"265",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Mexico",countryNameLocal:"Mxico",countryCode:"MX",currencyCode:"MXN",currencyNameEn:"Mexican peso",tinType:"RFC",tinName:"Registro Federal de Contribuyentes",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espaol",countryCallingCode:"52",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Malaysia",countryNameLocal:"",countryCode:"MY",currencyCode:"MYR",currencyNameEn:"Malaysian ringgit",tinType:"",tinName:"",officialLanguageCode:"ms",officialLanguageNameEn:"Malay",officialLanguageNameLocal:"Bahasa Melayu,  ",countryCallingCode:"60",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Mozambique",countryNameLocal:"Mozambique",countryCode:"MZ",currencyCode:"MZN",currencyNameEn:"Mozambican metical",tinType:"",tinName:"",officialLanguageCode:"pt",officialLanguageNameEn:"Portuguese",officialLanguageNameLocal:"Portugus",countryCallingCode:"258",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Namibia",countryNameLocal:"Namibia",countryCode:"NA",currencyCode:"NAD",currencyNameEn:"Namibian dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"264",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"New Caledonia",countryNameLocal:"Nouvelle-Caldonie",countryCode:"NC",currencyCode:"XPF",currencyNameEn:"CFP franc (franc Pacifique)",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"687",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Norfolk Island",countryNameLocal:"Norfolk Island",countryCode:"NF",currencyCode:"AUD",currencyNameEn:"Australian dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"672",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Nigeria",countryNameLocal:"Nigeria",countryCode:"NG",currencyCode:"NGN",currencyNameEn:"Nigerian naira",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"234",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Nicaragua",countryNameLocal:"Nicaragua",countryCode:"NI",currencyCode:"NIO",currencyNameEn:"Nicaraguan crdoba",tinType:"RUC",tinName:"Registro Unico de Contribuyentes",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espaol",countryCallingCode:"505",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Norway",countryNameLocal:"Norge, Noreg",countryCode:"NO",currencyCode:"NOK",currencyNameEn:"Norwegian krone",tinType:"Orgnr",tinName:"Organisasjonsnummer",officialLanguageCode:"nb",officialLanguageNameEn:"Norwegian Bokml",officialLanguageNameLocal:"Norsk Bokml",countryCallingCode:"47",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Nepal",countryNameLocal:"",countryCode:"NP",currencyCode:"NPR",currencyNameEn:"Nepalese rupee",tinType:"",tinName:"",officialLanguageCode:"ne",officialLanguageNameEn:"Nepali",officialLanguageNameLocal:"",countryCallingCode:"977",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Nauru",countryNameLocal:"Nauru",countryCode:"NR",currencyCode:"AUD",currencyNameEn:"Australian dollar",tinType:"",tinName:"",officialLanguageCode:"na",officialLanguageNameEn:"Nauru",officialLanguageNameLocal:"Dorerin Naoero",countryCallingCode:"674",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Niue",countryNameLocal:"Niue",countryCode:"NU",currencyCode:"NZD",currencyNameEn:"New Zealand dollar",tinType:"",tinName:"",officialLanguageCode:"niu",officialLanguageNameEn:"",officialLanguageNameLocal:"",countryCallingCode:"683",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"New Zealand",countryNameLocal:"New Zealand",countryCode:"NZ",currencyCode:"NZD",currencyNameEn:"New Zealand dollar",tinType:"NZBN",tinName:"NZ Business Number",officialLanguageCode:"mi",officialLanguageNameEn:"Maori",officialLanguageNameLocal:"te reo Mori",countryCallingCode:"64",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Oman",countryNameLocal:" ",countryCode:"OM",currencyCode:"OMR",currencyNameEn:"Omani rial",tinType:"",tinName:"",officialLanguageCode:"ar",officialLanguageNameEn:"Arabic",officialLanguageNameLocal:"",countryCallingCode:"968",areaCodes:[],region:"Arab States",flag:""},{countryNameEn:"Panama",countryNameLocal:"Panama",countryCode:"PA",currencyCode:"PAB",currencyNameEn:"Panamanian balboa",tinType:"RUC",tinName:"Registro Unico de Contribuyentes",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espaol",countryCallingCode:"507",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Peru",countryNameLocal:"Per",countryCode:"PE",currencyCode:"PEN",currencyNameEn:"Peruvian sol",tinType:"RUC",tinName:"Registro Unico de Contribuyentes",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espaol",countryCallingCode:"51",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"French Polynesia",countryNameLocal:"Polynsie franaise",countryCode:"PF",currencyCode:"XPF",currencyNameEn:"CFP franc (franc Pacifique)",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"689",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Papua New Guinea",countryNameLocal:"Papua New Guinea",countryCode:"PG",currencyCode:"PGK",currencyNameEn:"Papua New Guinean kina",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"675",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Pakistan",countryNameLocal:"",countryCode:"PK",currencyCode:"PKR",currencyNameEn:"Pakistani rupee",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"92",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Poland",countryNameLocal:"Polska",countryCode:"PL",currencyCode:"PLN",currencyNameEn:"Polish zoty",tinType:"NIP",tinName:"numer identyfikacji podatkowej",officialLanguageCode:"pl",officialLanguageNameEn:"Polish",officialLanguageNameLocal:"jzyk polski, polszczyzna",countryCallingCode:"48",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Saint Pierre and Miquelon",countryNameLocal:"Saint-Pierre-et-Miquelon",countryCode:"PM",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"508",areaCodes:[],region:"North America",flag:""},{countryNameEn:"Pitcairn",countryNameLocal:"Pitcairn",countryCode:"PN",currencyCode:"NZD",currencyNameEn:"New Zealand dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"64",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Puerto Rico",countryNameLocal:"Puerto Rico",countryCode:"PR",currencyCode:"USD",currencyNameEn:"United States dollar",tinType:"",tinName:"",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espaol",countryCallingCode:"1",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Palestine, State of",countryNameLocal:"Palestinian Territory",countryCode:"PS",currencyCode:"",currencyNameEn:"",tinType:"",tinName:"",officialLanguageCode:"ar",officialLanguageNameEn:"Arabic",officialLanguageNameLocal:"",countryCallingCode:"970",areaCodes:[],region:"Arab States",flag:""},{countryNameEn:"Portugal",countryNameLocal:"Portugal",countryCode:"PT",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"NIPC",tinName:"Nmero de Identificao de Pessoa Coletiva (NIPC)",officialLanguageCode:"pt",officialLanguageNameEn:"Portuguese",officialLanguageNameLocal:"Portugus",countryCallingCode:"351",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Palau",countryNameLocal:"Palau",countryCode:"PW",currencyCode:"USD",currencyNameEn:"United States dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"680",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Paraguay",countryNameLocal:"Paraguay",countryCode:"PY",currencyCode:"PYG",currencyNameEn:"Paraguayan guaran",tinType:"RUC",tinName:"Registro Unico de Contribuyentes",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espaol",countryCallingCode:"595",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Qatar",countryNameLocal:"",countryCode:"QA",currencyCode:"QAR",currencyNameEn:"Qatari riyal",tinType:"",tinName:"",officialLanguageCode:"ar",officialLanguageNameEn:"Arabic",officialLanguageNameLocal:"",countryCallingCode:"974",areaCodes:[],region:"Arab States",flag:""},{countryNameEn:"Runion",countryNameLocal:"La Runion",countryCode:"RE",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"262",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Romania",countryNameLocal:"Romnia",countryCode:"RO",currencyCode:"RON",currencyNameEn:"Romanian leu",tinType:"CIF",tinName:"Codul de identificare fiscal",officialLanguageCode:"ro",officialLanguageNameEn:"Romanian, Moldavian, Moldovan",officialLanguageNameLocal:"Romn",countryCallingCode:"40",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Serbia",countryNameLocal:"",countryCode:"RS",currencyCode:"RSD",currencyNameEn:"Serbian dinar",tinType:"PIB",tinName:"Poreski identifikacioni broj",officialLanguageCode:"sr",officialLanguageNameEn:"Serbian",officialLanguageNameLocal:" ",countryCallingCode:"381",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Russia",countryNameLocal:"",countryCode:"RU",currencyCode:"RUB",currencyNameEn:"Russian ruble",tinType:"",tinName:"  ",officialLanguageCode:"ru",officialLanguageNameEn:"Russian",officialLanguageNameLocal:"",countryCallingCode:"7",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Rwanda",countryNameLocal:"Rwanda",countryCode:"RW",currencyCode:"RWF",currencyNameEn:"Rwandan franc",tinType:"",tinName:"",officialLanguageCode:"rw",officialLanguageNameEn:"Kinyarwanda",officialLanguageNameLocal:"Ikinyarwanda",countryCallingCode:"250",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Saudi Arabia",countryNameLocal:"",countryCode:"SA",currencyCode:"SAR",currencyNameEn:"Saudi riyal",tinType:"",tinName:"",officialLanguageCode:"ar",officialLanguageNameEn:"Arabic",officialLanguageNameLocal:"",countryCallingCode:"966",areaCodes:[],region:"Arab States",flag:""},{countryNameEn:"Solomon Islands",countryNameLocal:"Solomon Islands",countryCode:"SB",currencyCode:"SBD",currencyNameEn:"Solomon Islands dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"677",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Seychelles",countryNameLocal:"Seychelles",countryCode:"SC",currencyCode:"SCR",currencyNameEn:"Seychelles rupee",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"248",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Sweden",countryNameLocal:"Sverige",countryCode:"SE",currencyCode:"SEK",currencyNameEn:"Swedish krona/kronor",tinType:"Momsnr.",tinName:"VAT-nummer",officialLanguageCode:"sv",officialLanguageNameEn:"Swedish",officialLanguageNameLocal:"Svenska",countryCallingCode:"46",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Singapore",countryNameLocal:"Singapore",countryCode:"SG",currencyCode:"SGD",currencyNameEn:"Singapore dollar",tinType:"",tinName:"",officialLanguageCode:"zh-hans",officialLanguageNameEn:"",officialLanguageNameLocal:"",countryCallingCode:"65",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Saint Helena, Ascension and Tristan da Cunha",countryNameLocal:"Saint Helena",countryCode:"SH",currencyCode:"SHP",currencyNameEn:"Saint Helena pound",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"290",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Slovenia",countryNameLocal:"Slovenija",countryCode:"SI",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"ID za DDV",tinName:"Davna tevilka",officialLanguageCode:"sl",officialLanguageNameEn:"Slovenian",officialLanguageNameLocal:"Slovenski Jezik, Slovenina",countryCallingCode:"386",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Svalbard and Jan Mayen",countryNameLocal:"Svalbard and Jan Mayen",countryCode:"SJ",currencyCode:"NOK",currencyNameEn:"Norwegian krone",tinType:"",tinName:"",officialLanguageCode:"no",officialLanguageNameEn:"Norwegian",officialLanguageNameLocal:"Norsk",countryCallingCode:"4779",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Slovakia",countryNameLocal:"Slovensko",countryCode:"SK",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"I DPH",tinName:"Identifikan slo pre da z pridanej hodnoty",officialLanguageCode:"sk",officialLanguageNameEn:"Slovak",officialLanguageNameLocal:"Slovenina, Slovensk Jazyk",countryCallingCode:"421",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Sierra Leone",countryNameLocal:"Sierra Leone",countryCode:"SL",currencyCode:"SLL",currencyNameEn:"Sierra Leonean leone",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"232",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Republic of San Marino",countryNameLocal:"Repubblica di San Marino",countryCode:"SM",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"C.O.E.",tinName:"Codice operatore economico",officialLanguageCode:"it",officialLanguageNameEn:"Italian",officialLanguageNameLocal:"Italiano",countryCallingCode:"378",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Senegal",countryNameLocal:"Sngal",countryCode:"SN",currencyCode:"XOF",currencyNameEn:"CFA franc BCEAO",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"221",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Somalia",countryNameLocal:"Somalia, ",countryCode:"SO",currencyCode:"SOS",currencyNameEn:"Somali shilling",tinType:"",tinName:"",officialLanguageCode:"so",officialLanguageNameEn:"Somali",officialLanguageNameLocal:"Soomaaliga, af Soomaali",countryCallingCode:"252",areaCodes:[],region:"Arab States",flag:""},{countryNameEn:"Suriname",countryNameLocal:"Suriname",countryCode:"SR",currencyCode:"SRD",currencyNameEn:"Surinamese dollar",tinType:"",tinName:"",officialLanguageCode:"nl",officialLanguageNameEn:"Dutch, Flemish",officialLanguageNameLocal:"Nederlands, Vlaams",countryCallingCode:"597",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"South Sudan",countryNameLocal:"South Sudan",countryCode:"SS",currencyCode:"SSP",currencyNameEn:"South Sudanese pound",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"211",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Sao Tome and Principe",countryNameLocal:"So Tom e Prncipe",countryCode:"ST",currencyCode:"STN",currencyNameEn:"",tinType:"",tinName:"",officialLanguageCode:"pt",officialLanguageNameEn:"Portuguese",officialLanguageNameLocal:"Portugus",countryCallingCode:"239",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"El Salvador",countryNameLocal:"El Salvador",countryCode:"SV",currencyCode:"SVC",currencyNameEn:"Salvadoran coln",tinType:"NIT",tinName:"Nmero de Identificacin Tributaria",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espaol",countryCallingCode:"503",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Sint Maarten (Dutch part)",countryNameLocal:"Sint Maarten",countryCode:"SX",currencyCode:"ANG",currencyNameEn:"Netherlands Antillean guilder",tinType:"",tinName:"",officialLanguageCode:"nl",officialLanguageNameEn:"Dutch, Flemish",officialLanguageNameLocal:"Nederlands, Vlaams",countryCallingCode:"1721",areaCodes:[],region:"Unknown",flag:""},{countryNameEn:"Syrian Arab Republic",countryNameLocal:", Sriyya",countryCode:"SY",currencyCode:"SYP",currencyNameEn:"Syrian pound",tinType:"",tinName:"",officialLanguageCode:"ar",officialLanguageNameEn:"Arabic",officialLanguageNameLocal:"",countryCallingCode:"963",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Chad",countryNameLocal:"Tchad, ",countryCode:"TD",currencyCode:"XAF",currencyNameEn:"CFA franc BEAC",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"235",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Togo",countryNameLocal:"Togo",countryCode:"TG",currencyCode:"XOF",currencyNameEn:"CFA franc BCEAO",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"228",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Thailand",countryNameLocal:"",countryCode:"TH",currencyCode:"THB",currencyNameEn:"Thai baht",tinType:"",tinName:"",officialLanguageCode:"th",officialLanguageNameEn:"Thai",officialLanguageNameLocal:"",countryCallingCode:"66",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Tajikistan",countryNameLocal:",",countryCode:"TJ",currencyCode:"TJS",currencyNameEn:"Tajikistani somoni",tinType:"",tinName:"",officialLanguageCode:"tg",officialLanguageNameEn:"Tajik",officialLanguageNameLocal:", toik, ",countryCallingCode:"992",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Tokelau",countryNameLocal:"Tokelau",countryCode:"TK",currencyCode:"NZD",currencyNameEn:"New Zealand dollar",tinType:"",tinName:"",officialLanguageCode:"tkl",officialLanguageNameEn:"",officialLanguageNameLocal:"",countryCallingCode:"690",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Timor-Leste",countryNameLocal:"Timor-Leste, Timor Lorosa'e",countryCode:"TL",currencyCode:"USD",currencyNameEn:"United States dollar",tinType:"",tinName:"",officialLanguageCode:"pt",officialLanguageNameEn:"Portuguese",officialLanguageNameLocal:"Portugus",countryCallingCode:"670",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Turkmenistan",countryNameLocal:"Trkmenistan",countryCode:"TM",currencyCode:"TMT",currencyNameEn:"Turkmenistan manat",tinType:"",tinName:"",officialLanguageCode:"tk",officialLanguageNameEn:"Turkmen",officialLanguageNameLocal:"Trkmen, ",countryCallingCode:"993",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Tunisia",countryNameLocal:", Tunisie",countryCode:"TN",currencyCode:"TND",currencyNameEn:"Tunisian dinar",tinType:"",tinName:"",officialLanguageCode:"ar",officialLanguageNameEn:"Arabic",officialLanguageNameLocal:"",countryCallingCode:"216",areaCodes:[],region:"Arab States",flag:""},{countryNameEn:"Tonga",countryNameLocal:"Tonga",countryCode:"TO",currencyCode:"TOP",currencyNameEn:"Tongan paanga",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"676",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Turkey",countryNameLocal:"Trkiye",countryCode:"TR",currencyCode:"TRY",currencyNameEn:"Turkish lira",tinType:"KDV",tinName:"Vergi Kimlik Numaras",officialLanguageCode:"tr",officialLanguageNameEn:"Turkish",officialLanguageNameLocal:"Trke",countryCallingCode:"90",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Trinidad and Tobago",countryNameLocal:"Trinidad and Tobago",countryCode:"TT",currencyCode:"TTD",currencyNameEn:"Trinidad and Tobago dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"868",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Tuvalu",countryNameLocal:"Tuvalu",countryCode:"TV",currencyCode:"AUD",currencyNameEn:"Australian dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"688",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"United Republic of Tanzania",countryNameLocal:"Tanzania",countryCode:"TZ",currencyCode:"TZS",currencyNameEn:"Tanzanian shilling",tinType:"",tinName:"",officialLanguageCode:"sw",officialLanguageNameEn:"Swahili",officialLanguageNameLocal:"Kiswahili",countryCallingCode:"255",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Ukraine",countryNameLocal:"",countryCode:"UA",currencyCode:"UAH",currencyNameEn:"Ukrainian hryvnia",tinType:"",tinName:"   ",officialLanguageCode:"uk",officialLanguageNameEn:"Ukrainian",officialLanguageNameLocal:"",countryCallingCode:"380",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Uganda",countryNameLocal:"Uganda",countryCode:"UG",currencyCode:"UGX",currencyNameEn:"Ugandan shilling",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"256",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"United States of America",countryNameLocal:"United States of America",countryCode:"US",currencyCode:"USD",currencyNameEn:"United States dollar",tinType:"EIN",tinName:"Tax Identification Number",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"1",areaCodes:[],region:"North America",flag:""},{countryNameEn:"Uruguay",countryNameLocal:"Uruguay",countryCode:"UY",currencyCode:"UYU",currencyNameEn:"Uruguayan peso",tinType:"RUT",tinName:"Registro nico Tributario",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espaol",countryCallingCode:"598",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Uzbekistan",countryNameLocal:"",countryCode:"UZ",currencyCode:"UZS",currencyNameEn:"Uzbekistan som",tinType:"",tinName:"   ",officialLanguageCode:"uz",officialLanguageNameEn:"Uzbek",officialLanguageNameLocal:"Ozbek, , ",countryCallingCode:"998",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Saint Vincent and the Grenadines",countryNameLocal:"Saint Vincent and the Grenadines",countryCode:"VC",currencyCode:"XCD",currencyNameEn:"East Caribbean dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"1784",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Venezuela (Bolivarian Republic of)",countryNameLocal:"Venezuela",countryCode:"VE",currencyCode:"VES",currencyNameEn:"",tinType:"RIF",tinName:"Registro de Informacion Fiscal",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espaol",countryCallingCode:"58",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Virgin Islands (British)",countryNameLocal:"British Virgin Islands",countryCode:"VG",currencyCode:"USD",currencyNameEn:"United States dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"1284",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Virgin Islands (U.S.)",countryNameLocal:"United States Virgin Islands",countryCode:"VI",currencyCode:"USD",currencyNameEn:"United States dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"1340",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Vietnam",countryNameLocal:"Vit Nam",countryCode:"VN",currencyCode:"VND",currencyNameEn:"Vietnamese ng",tinType:"",tinName:"",officialLanguageCode:"vi",officialLanguageNameEn:"Vietnamese",officialLanguageNameLocal:"Ting Vit",countryCallingCode:"84",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Vanuatu",countryNameLocal:"Vanuatu",countryCode:"VU",currencyCode:"VUV",currencyNameEn:"Vanuatu vatu",tinType:"",tinName:"",officialLanguageCode:"bi",officialLanguageNameEn:"Bislama",officialLanguageNameLocal:"Bislama",countryCallingCode:"678",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Wallis and Futuna",countryNameLocal:"Wallis-et-Futuna",countryCode:"WF",currencyCode:"XPF",currencyNameEn:"CFP franc (franc Pacifique)",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"681",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Samoa",countryNameLocal:"Samoa",countryCode:"WS",currencyCode:"WST",currencyNameEn:"Samoan tala",tinType:"",tinName:"",officialLanguageCode:"sm",officialLanguageNameEn:"Samoan",officialLanguageNameLocal:"gagana fa'a Samoa",countryCallingCode:"685",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Yemen",countryNameLocal:"",countryCode:"YE",currencyCode:"YER",currencyNameEn:"Yemeni rial",tinType:"",tinName:"",officialLanguageCode:"ar",officialLanguageNameEn:"Arabic",officialLanguageNameLocal:"",countryCallingCode:"967",areaCodes:[],region:"Arab States",flag:""},{countryNameEn:"Mayotte",countryNameLocal:"Mayotte",countryCode:"YT",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"262",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"South Africa",countryNameLocal:"South Africa",countryCode:"ZA",currencyCode:"ZAR",currencyNameEn:"South African rand",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"27",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Zambia",countryNameLocal:"Zambia",countryCode:"ZM",currencyCode:"ZMW",currencyNameEn:"Zambian kwacha",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"260",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Zimbabwe",countryNameLocal:"Zimbabwe",countryCode:"ZW",currencyCode:"ZWL",currencyNameEn:"Zimbabwean dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"263",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Eswatini",countryNameLocal:"Swaziland",countryCode:"SZ",currencyCode:"SZL",currencyNameEn:"Swazi lilangeni",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"268",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"North Macedonia",countryNameLocal:"",countryCode:"MK",currencyCode:"MKD",currencyNameEn:"Macedonian denar",tinType:"",tinName:"",officialLanguageCode:"mk",officialLanguageNameEn:"Macedonian",officialLanguageNameLocal:" ",countryCallingCode:"389",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Philippines",countryNameLocal:"Philippines",countryCode:"PH",currencyCode:"PHP",currencyNameEn:"Philippine peso",tinType:"TIN",tinName:"Tax Identification Number",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"63",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Netherlands",countryNameLocal:"Nederland",countryCode:"NL",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"Btw-nr.",tinName:"Btw-nummer",officialLanguageCode:"nl",officialLanguageNameEn:"Dutch, Flemish",officialLanguageNameLocal:"Nederlands, Vlaams",countryCallingCode:"31",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"United Arab Emirates",countryNameLocal:"   ",countryCode:"AE",currencyCode:"AED",currencyNameEn:"United Arab Emirates dirham",tinType:"",tinName:"",officialLanguageCode:"ar",officialLanguageNameEn:"Arabic",officialLanguageNameLocal:"",countryCallingCode:"971",areaCodes:[],region:"Arab States",flag:""},{countryNameEn:"Republic of Moldova",countryNameLocal:"Moldova, ",countryCode:"MD",currencyCode:"MDL",currencyNameEn:"Moldovan leu",tinType:"",tinName:"",officialLanguageCode:"ro",officialLanguageNameEn:"Romanian, Moldavian, Moldovan",officialLanguageNameLocal:"Romn",countryCallingCode:"373",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Gambia",countryNameLocal:"The Gambia",countryCode:"GM",currencyCode:"GMD",currencyNameEn:"Gambian dalasi",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"220",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Dominican Republic",countryNameLocal:"Repblica Dominicana",countryCode:"DO",currencyCode:"DOP",currencyNameEn:"Dominican peso",tinType:"RNC",tinName:"Registro Nacional del Contribuyente",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espaol",countryCallingCode:"1",areaCodes:[],region:"South/Latin America",flag:""},{countryNameEn:"Sudan",countryNameLocal:"",countryCode:"SD",currencyCode:"SDG",currencyNameEn:"Sudanese pound",tinType:"",tinName:"",officialLanguageCode:"ar",officialLanguageNameEn:"Arabic",officialLanguageNameLocal:"",countryCallingCode:"249",areaCodes:[],region:"Arab States",flag:""},{countryNameEn:"Lao People's Democratic Republic",countryNameLocal:"",countryCode:"LA",currencyCode:"LAK",currencyNameEn:"Lao kip",tinType:"",tinName:"",officialLanguageCode:"lo",officialLanguageNameEn:"Lao",officialLanguageNameLocal:"",countryCallingCode:"856",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Taiwan, Province of China",countryNameLocal:"Taiwan",countryCode:"TW",currencyCode:"TWD",currencyNameEn:"New Taiwan dollar",tinType:"",tinName:"",officialLanguageCode:"zh-hant",officialLanguageNameEn:"",officialLanguageNameLocal:"",countryCallingCode:"886",areaCodes:[],region:"Asia & Pacific",flag:""},{countryNameEn:"Republic of the Congo",countryNameLocal:"Rpublique du Congo",countryCode:"CG",currencyCode:"XAF",currencyNameEn:"CFA franc BEAC",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"242",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Czechia",countryNameLocal:"esk republika",countryCode:"CZ",currencyCode:"CZK",currencyNameEn:"Czech koruna",tinType:"DI",tinName:"Daov identifikan slo",officialLanguageCode:"cs",officialLanguageNameEn:"Czech",officialLanguageNameLocal:"etina",countryCallingCode:"420",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"United Kingdom",countryNameLocal:"Great Britain",countryCode:"GB",currencyCode:"GBP",currencyNameEn:"Pound sterling",tinType:"VAT Reg No",tinName:"Value added tax registration number",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"44",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Niger",countryNameLocal:"Niger",countryCode:"NE",currencyCode:"XOF",currencyNameEn:"CFA franc BCEAO",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"227",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Democratic Republic of the Congo",countryNameLocal:"Democratic Republic of the Congo",countryCode:"CD",currencyCode:"CDF",currencyNameEn:"Congolese franc",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"243",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Commonwealth of The Bahamas",countryNameLocal:"Commonwealth of The Bahamas",countryCode:"BS",currencyCode:"BSD",currencyNameEn:"Bahamian dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"1 242",areaCodes:[],region:"Caribbean",flag:""},{countryNameEn:"Cocos (Keeling) Islands",countryNameLocal:"Pulu Kokos (Keeling)",countryCode:"CC",currencyCode:"AUD",currencyNameEn:"Australian dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"61 891",areaCodes:[],region:"Australia",flag:""},{countryNameEn:"Central African Republic",countryNameLocal:"Rpublique centrafricaine",countryCode:"CF",currencyCode:"XAF",currencyNameEn:"Central African CFA",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"236",areaCodes:[],region:"Africa",flag:""},{countryNameEn:"Cook Islands",countryNameLocal:"Kki 'irani",countryCode:"CK",currencyCode:"NZD",currencyNameEn:"New Zealand dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"682",areaCodes:[],region:"South Pacific Ocean",flag:""},{countryNameEn:"Falkland Islands",countryNameLocal:"Falkland Islands",countryCode:"FK",currencyCode:"FKP",currencyNameEn:"Falklands pound",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"500",areaCodes:[],region:"South Atlantic Ocean",flag:""},{countryNameEn:"Faroe Islands",countryNameLocal:"Frerne",countryCode:"FO",currencyCode:"DKK",currencyNameEn:"Faroese krna",tinType:"",tinName:"",officialLanguageCode:"da",officialLanguageNameEn:"Danish",officialLanguageNameLocal:"dansk",countryCallingCode:"298",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Territory of Heard Island and McDonald Islands",countryNameLocal:"Territory of Heard Island and McDonald Islands",countryCode:"HM",currencyCode:"AUD",currencyNameEn:"Australian dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"672",areaCodes:[],region:"Indian Ocean",flag:""},{countryNameEn:"British Indian Ocean Territory",countryNameLocal:"British Indian Ocean Territory",countryCode:"IO",currencyCode:"USD",currencyNameEn:"United States Dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"246",areaCodes:[],region:"Indian Ocean",flag:""},{countryNameEn:"Comoros",countryNameLocal:"Umoja wa Komori",countryCode:"KM",currencyCode:"KMF",currencyNameEn:"Comorian franc",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"269",areaCodes:[],region:"Indian Ocean",flag:""},{countryNameEn:"Cayman Islands",countryNameLocal:"Cayman Islands",countryCode:"KY",currencyCode:"KYD",currencyNameEn:"Cayman Islands dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"1 345",areaCodes:[],region:"Caribbean Sea",flag:""},{countryNameEn:"Republic of the Marshall Islands",countryNameLocal:"Aolepn Aorkin aje",countryCode:"MH",currencyCode:"USD",currencyNameEn:"United States dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"692",areaCodes:[],region:"Pacific Ocean",flag:""},{countryNameEn:"Commonwealth of the Northern Mariana Islands",countryNameLocal:"Sankattan Siha Na Islas Marinas",countryCode:"MP",currencyCode:"USD",currencyNameEn:"United States dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"1 670",areaCodes:[],region:"Pacific Ocean",flag:""},{countryNameEn:"Turks and Caicos Islands",countryNameLocal:"Turks and Caicos Islands",countryCode:"TC",currencyCode:"USD",currencyNameEn:"United States dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"1 649",areaCodes:[],region:"Atlantic Ocean",flag:""},{countryNameEn:"French Southern and Antarctic Lands",countryNameLocal:"Terres australes et antarctiques franaises",countryCode:"TF",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Franais",countryCallingCode:"672",areaCodes:[],region:"Indian Ocean",flag:""},{countryNameEn:"United States Minor Outlying Islands",countryNameLocal:"United States Minor Outlying Islands",countryCode:"UM",currencyCode:"USD",currencyNameEn:"United States dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"1",areaCodes:[],region:"Pacific Ocean",flag:""},{countryNameEn:"Holy See",countryNameLocal:"Sancta Sedes",countryCode:"VA",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"",tinName:"",officialLanguageCode:"la",officialLanguageNameEn:"Latin",officialLanguageNameLocal:"lingua latna",countryCallingCode:"39",areaCodes:[],region:"Europe",flag:""},{countryNameEn:"Republic of Kosovo",countryNameLocal:"Republika e Kosovs",countryCode:"XK",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"",tinName:"",officialLanguageCode:"sq",officialLanguageNameEn:"Albanian",officialLanguageNameLocal:"Shqip",countryCallingCode:"383",region:"Europe",flag:""},{countryNameEn:"Netherlands Antilles",countryNameLocal:"Nederlandse Antillen",countryCode:"AN",currencyCode:"ANG",currencyNameEn:"Netherlands Antillean guilder",tinType:"",tinName:"",officialLanguageCode:"nl",officialLanguageNameEn:"Dutch, Flemish",officialLanguageNameLocal:"Nederlands, Vlaams",countryCallingCode:"599",region:"Europe",flag:""}];return qy.default=e,qy}var T$;function oue(){if(T$)return Ss;T$=1;var e=Ss&&Ss.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(Ss,"__esModule",{value:!0}),Ss.customList=Ss.customArray=Ss.findOne=Ss.filter=Ss.all=Ss.utils=void 0;const t=e(sue()),n=e(rue()),s=e(iue());Ss.utils={groupBy:t.default};function r(){return s.default}Ss.all=r;function i(u,d){return s.default.filter(h=>h[u]===d)}Ss.filter=i;function o(u,d){return s.default.find(h=>h[u]===d)}Ss.findOne=o;function l(u={name:"{countryNameEn} ({countryCode})",value:"{countryCode}"},{sortBy:d,sortDataBy:h,filter:p}={}){const x=[];let v=s.default;if(typeof p=="function"&&(v=v.filter(p)),h){const j=new Intl.Collator([],{sensitivity:"accent"});v.sort((y,N)=>j.compare(y[h],N[h]))}if(v.forEach(j=>{const y={};for(const N in u)y[N]=(0,n.default)(u[N],j);x.push(y)}),d&&u[d]){const j=new Intl.Collator([],{sensitivity:"accent"});x.sort((y,N)=>j.compare(y[d],N[d]))}return x}Ss.customArray=l;function c(u="countryCode",d="{countryNameEn} ({countryCode})",{filter:h}={}){const p={};let x=s.default;return typeof h=="function"&&(x=x.filter(h)),x.forEach(v=>{const j=(0,n.default)(d,v);p[String(v[u])]=j}),p}return Ss.customList=c,Ss}var nh=oue();const gk=(...e)=>e.flat().filter(Boolean).join(" "),lue=nh.all(),nq=lue.map(e=>({code:`+${e.countryCallingCode}`,name:e.countryCode})),pk=[{id:1,title:"Your Account",subtitle:"Personal & Login Details"},{id:2,title:"Company Setup",subtitle:"Business Information"}],cue=()=>{const e=kt();return a.jsxs("button",{onClick:()=>e("/"),className:"inline-flex items-center text-sm text-gray-500 hover:text-gray-700 transition cursor-pointer",children:[a.jsx(Ku,{className:"size-4 mr-1"})," Back to Home"]})},due=f.memo(({label:e,id:t,placeholder:n,type:s="text",value:r,onChange:i,isVisible:o,onTogglePass:l,error:c,isSelect:u,options:d})=>{const h=t.toLowerCase().includes("password"),p=gk("w-full bg-gray-50 border px-4 py-2.5 rounded-lg text-gray-800 transition shadow-inner placeholder-gray-400 focus:outline-none cursor-pointer",h?"pr-10":"",c?"border-red-500 focus:border-red-500 focus:ring-2 focus:ring-red-500/50":"border-gray-200 focus:border-amber-500 focus:ring-2 focus:ring-amber-500/50");return a.jsxs("div",{className:"flex flex-col space-y-2",children:[a.jsx("label",{htmlFor:t,className:"text-sm font-medium text-gray-700 cursor-pointer",children:e}),a.jsxs("div",{className:"relative",children:[u?a.jsx("select",{id:t,value:r,onChange:i,required:!0,className:p,children:d.map(x=>a.jsx("option",{value:x,children:x},x))}):a.jsx("input",{id:t,type:h?"text":s,style:h&&!o?{WebkitTextSecurity:"disc"}:void 0,placeholder:n,value:r,onChange:i,required:!0,className:p}),h&&a.jsx("button",{type:"button",onClick:()=>l(t),className:"absolute inset-y-0 right-0 flex items-center pr-3 text-gray-700 hover:text-gray-900 focus:outline-none z-10 transition-colors cursor-pointer","aria-label":o?"Hide password":"Show password",children:o?a.jsx(Pu,{className:"size-5"}):a.jsx(md,{className:"size-5"})})]}),c&&a.jsx("p",{className:"mt-1 text-sm text-red-600 font-semibold",children:c})]})}),lu=due,uue=f.memo(({currentStep:e,totalSteps:t})=>a.jsx("div",{className:"flex justify-between items-center mb-10 w-full max-w-xs mx-auto",children:pk.map(n=>a.jsxs(f.Fragment,{children:[a.jsxs("div",{className:"flex flex-col items-center cursor-pointer",children:[a.jsx("div",{className:gk("size-10 flex items-center justify-center rounded-full font-bold transition-all duration-300",n.id===e?"bg-amber-500 text-white shadow-lg":n.id<e?"bg-green-500 text-white":"bg-gray-100 text-gray-500 border-2 border-gray-300"),children:n.id<e?a.jsx(jL,{className:"size-5"}):n.id}),a.jsx("span",{className:gk("mt-2 text-xs font-medium hidden sm:block",n.id===e?"text-amber-600":"text-gray-500"),children:n.title})]}),n.id<t&&a.jsx("div",{className:"flex-1 h-0.5 mx-1 transition-colors duration-300 bg-gray-300"})]},n.id))})),mue=f.memo(({formData:e,handleChange:t,handleCodeChange:n,handleTogglePass:s,isPassVisible:r,formError:i,signupError:o,termsAccepted:l,handleTerms:c,isButtonDisabled:u,handleSubmit:d,handleGoogleLogin:h})=>a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center my-6",children:[a.jsx("div",{className:"flex-grow border-t border-gray-300"}),a.jsx("span",{className:"flex-shrink mx-4 text-sm text-gray-500",children:"OR"}),a.jsx("div",{className:"flex-grow border-t border-gray-300"})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"md:flex md:space-x-4 space-y-6 md:space-y-0",children:[a.jsx("div",{className:"md:w-1/2",children:a.jsx(lu,{label:"First Name",id:"first_name",placeholder:"John",value:e.first_name,onChange:t})}),a.jsx("div",{className:"md:w-1/2",children:a.jsx(lu,{label:"Last Name",id:"last_name",placeholder:"Doe",value:e.last_name,onChange:t})})]}),a.jsxs("div",{className:"flex flex-col space-y-2",children:[a.jsx("label",{htmlFor:"phoneNumber",className:"text-sm font-medium text-gray-700 cursor-pointer",children:"Contact Number"}),a.jsxs("div",{className:"flex space-x-2",children:[a.jsx("select",{id:"countryCode",value:e.countryCode,onChange:n,className:"flex-shrink-0 bg-gray-50 border border-gray-200 px-3 py-2.5 rounded-lg text-gray-800 transition shadow-inner focus:border-amber-500 focus:ring-2 focus:ring-amber-500/50 focus:outline-none cursor-pointer",children:nq.map(p=>a.jsxs("option",{value:p.code,children:[p.name," ",p.code]},p.code))}),a.jsx("input",{id:"phone_number",type:"tel",placeholder:"0000000000",maxLength:10,value:e.phone_number,onChange:t,className:"w-full bg-gray-50 border border-gray-200 px-4 py-2.5 rounded-lg text-gray-800 transition shadow-inner placeholder-gray-400 focus:border-amber-500 focus:ring-2 focus:ring-amber-500/50 focus:outline-none cursor-pointer"})]})]}),a.jsx(lu,{label:"Email Address",id:"email",type:"email",placeholder:"you@company.com",value:e.email,onChange:t}),a.jsx(lu,{label:"Password",id:"password",placeholder:"Min 8 characters",value:e.password,onChange:t,isVisible:r.password,onTogglePass:s}),a.jsx(lu,{label:"Confirm Password",id:"confirmPassword",placeholder:"Confirm your password",value:e.confirmPassword,onChange:t,isVisible:r.confirmPassword,onTogglePass:s,error:i}),o&&a.jsx("div",{className:"bg-red-100 border border-red-300 py-2 px-3 text-red-600",children:o}),a.jsxs("div",{className:"flex items-start pt-2",children:[a.jsx("input",{id:"terms",type:"checkbox",checked:l,onChange:c,className:"size-4 mt-1 rounded text-amber-500 border-gray-300 focus:ring-amber-500 cursor-pointer"}),a.jsxs("label",{htmlFor:"terms",className:"ml-3 text-sm font-medium text-gray-700 cursor-pointer",children:["I accept the ",a.jsx("a",{href:"#",className:"text-amber-600 hover:text-amber-700 font-semibold",children:"Terms"})," and ",a.jsx("a",{href:"#",className:"text-amber-600 hover:text-amber-700 font-semibold",children:"Policy"}),"."]})]})]}),i&&a.jsx("div",{className:"mt-4 p-3 text-sm rounded-lg bg-red-100 text-red-700 border border-red-300 font-medium animate-pulse",children:i}),a.jsx("button",{type:"submit",onClick:d,disabled:u,className:"w-full mt-8 inline-flex items-center justify-center rounded-lg h-12 px-6 text-white font-bold tracking-wide transition-all duration-300 bg-secondary hover:bg-tertiary shadow-lg shadow-tertiary disabled:shadow-none focus-visible:outline-none cursor-pointer",children:"Continue to Company Details"})]})),fue=f.memo(({companyData:e,handleCodeChange1:t,handleSubmit:n,handleCompanyChange:s,formError:r,isSubmitted:i,isButtonDisabled:o,setStep:l,setIsSubmitted:c,setFormError:u})=>a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"space-y-6",children:[a.jsx(lu,{label:"Company Name",id:"company_name",placeholder:"Acme Corp",value:e.company_name,onChange:s}),a.jsxs("div",{className:"flex flex-col space-y-2",children:[a.jsx("label",{htmlFor:"phoneNumber",className:"text-sm font-medium text-gray-700 cursor-pointer",children:"Company Number"}),a.jsxs("div",{className:"flex space-x-2",children:[a.jsx("select",{id:"countryCode",value:e.countryCode,onChange:t,className:"flex-shrink-0 bg-gray-50 border border-gray-200 px-3 py-2.5 rounded-lg text-gray-800 transition shadow-inner focus:border-amber-500 focus:ring-2 focus:ring-amber-500/50 focus:outline-none cursor-pointer",children:nq.map(d=>a.jsxs("option",{value:d.code,children:[d.name," ",d.code]},d.code))}),a.jsx("input",{id:"company_number",type:"tel",placeholder:"0000000000",maxLength:10,value:e.company_number,onChange:s,className:"w-full bg-gray-50 border border-gray-200 px-4 py-2.5 rounded-lg text-gray-800 transition shadow-inner placeholder-gray-400 focus:border-amber-500 focus:ring-2 focus:ring-amber-500/50 focus:outline-none cursor-pointer"})]})]}),a.jsx(lu,{label:"Company Website",id:"company_website",type:"url",placeholder:"https://www.acme.com",value:e.company_website,onChange:s})]}),r&&a.jsx("div",{className:"p-3 text-sm rounded-lg bg-red-100 text-red-700 border border-red-300 font-medium my-6",children:r}),i&&a.jsx("div",{className:"p-3 text-sm rounded-lg bg-green-100 text-green-700 border border-green-300 font-medium my-6",children:"Account and Company Setup simulated successfully! Welcome aboard."}),a.jsxs("div",{className:"flex space-x-4 mt-8",children:[a.jsxs("button",{type:"button",onClick:()=>{l(1),c(!1),u(null)},className:"flex-1 inline-flex items-center justify-center rounded-lg h-12 px-6 text-gray-700 font-bold tracking-wide border border-gray-300 bg-white hover:bg-tertiary hover:text-white transition-colors focus-visible:ring-2 focus-visible:ring-gray-300 focus-visible:outline-none cursor-pointer",children:[a.jsx(Gie,{className:"size-4 mr-2"})," Back"]}),a.jsx("button",{onClick:n,type:"submit",disabled:o,className:"flex-1 inline-flex items-center justify-center rounded-lg h-12 px-6 text-white font-bold tracking-wide transition-all duration-300 bg-tertiary hover:bg-accent hover:text-secondary shadow-xl shadow-amber-500/30 disabled:shadow-none focus-visible:ring-2 focus-visible:ring-amber-500/50 focus-visible:outline-none cursor-pointer",children:"Create Account"})]})]})),hue=()=>{const e=["first_name","email","password"],t=["company_name","company_number","company_website"],[n,s]=f.useState(1),[r,i]=f.useState({first_name:"",last_name:"",countryCode:"+63",phone_number:"",email:"",password:"",confirmPassword:"",role:"CEO"}),[o,l]=f.useState({company_name:"",company_number:"",company_website:"",countryCode:"+63"}),[c,u]=f.useState({}),[d,h]=f.useState(!1),[p,x]=f.useState(null),[v,j]=f.useState(!1),{login:y}=Ks(),[N,w]=f.useState({plan_name:"Free",price:0}),[S,_]=f.useState(!1),[k,T]=f.useState(null);f.useEffect(()=>{document.title="Sign Up | Sari-Sari CRM"},[]),f.useEffect(()=>{const V=()=>{window.google&&window.google.accounts?(window.google.accounts.id.initialize({client_id:"222789237297-r8mebl46fdacgpsnlnjca4eu0crn8hf6.apps.googleusercontent.com",callback:A}),window.google.accounts.id.renderButton(document.getElementById("googleSignupBtn"),{theme:"outline",size:"large",text:"signup_with"})):console.error("Google API not loaded properly.")};if(window.google&&window.google.accounts){V();return}const oe=document.createElement("script");oe.src="https://accounts.google.com/gsi/client",oe.async=!0,oe.defer=!0,oe.onload=V,document.body.appendChild(oe)},[]);const A=async V=>{_(!0);try{const oe=x9(V.credential);console.log("Google user:",oe);try{await re.post("/auth/email-check",{email:oe.email})}catch(je){const X=je.response?.data?.detail||"An error occurred.";T(X),_(!1);return}i(je=>({...je,email:oe.email,first_name:oe.given_name||"",last_name:oe.family_name||"",password:"",profilePicture:oe.picture||"",googleId:oe.sub,auth_provider:"google",id_token:V.credential})),s(2)}catch(oe){console.error("Google signup error:",oe),x("Failed to process Google account. Please try again.")}finally{T(null),x(null),_(!1)}},E=f.useCallback(V=>{const{id:oe,value:je}=V.target;l(X=>({...X,[oe]:je})),x(null)},[]),M=f.useCallback(V=>{const{id:oe,value:je}=V.target;j(!1),i(X=>{const se={...X,[oe]:je};if(n===1){let ye=null;if(oe==="password"&&je.length>0&&je.length<8)ye="Password must be at least 8 characters.";else if(oe==="password"||oe==="confirmPassword"){const Ne=oe==="password"?je:se.password,fe=oe==="confirmPassword"?je:se.confirmPassword;Ne&&fe&&Ne!==fe&&(ye="Passwords don't match.")}x(ye)}return se})},[n]),z=f.useCallback(V=>i(oe=>({...oe,countryCode:V.target.value})),[]),P=f.useCallback(V=>l(oe=>({...oe,countryCode:V.target.value})),[]),D=f.useCallback(V=>u(oe=>({...oe,[V]:!oe[V]})),[]),U=f.useCallback(V=>h(V.target.checked),[]),B=async V=>{if(V.preventDefault(),j(!1),x(null),n===1){if(!e.every(je=>r[je].trim()!=="")||!d){x("Please fill in all required fields and accept the terms.");return}if(r.password!==r.confirmPassword){x("The passwords you entered do not match. Please try again.");return}if(r.password.length<8){x("Password must be at least 8 characters long.");return}if(r.auth_provider==="google"){s(2);return}try{(await re.post("/auth/email-check",{email:r.email})).data.detail==="No existing email"&&(x(null),s(2))}catch(je){je.response&&je.response.data&&je.response.data.detail?x(je.response.data.detail):x("Something went wrong. Please try again.")}finally{_(!1)}}else if(n===2){if(!t.every(je=>(o[je]||"").trim()!=="")){x("Please fill in all required company details.");return}try{const{confirmPassword:je,...X}=r,se={...o,company_number:`${o.countryCode} ${o.company_number}`},Ne=(await re.post("/company/create",se)).data.id,fe={...X,company_id:Ne,phone_number:`${X.countryCode} ${X.phone_number}`};if(console.log(" Sending payload:",fe),X.auth_provider==="google"){const we=await re.post("/auth/google/signup",fe),de={...N,company_id:Ne,status:"Active"},ke=await re.post("/subscription/subscribe",de);x(null),j(!0),y(we.data)}else{const we=await re.post("/auth/signup",fe),de={...N,company_id:Ne,status:"Active"},ke=await re.post("/subscription/subscribe",de);x(null),j(!0),y(we.data)}}catch(je){if(je.response?.data?.detail){const X=je.response.data.detail;if(Array.isArray(X)){const se=X.map(ye=>ye.msg).join(", ");x(se)}else x(typeof X=="object"?X.msg||JSON.stringify(X):X)}else x("Something went wrong. Please try again.")}finally{_(!1)}}},R=f.useCallback(()=>{try{window.google.accounts.id.initialize({client_id:"222789237297-r8mebl46fdacgpsnlnjca4eu0crn8hf6.apps.googleusercontent.com",callback:V=>{const{credential:oe}=V;i(je=>({...je,first_name:oe.given_name||"",last_name:oe.family_name||"",email:oe.email||"",profile_picture:oe.picture||"",auth_provider:"google",id_token:oe})),s(2)}}),window.google.accounts.id.prompt()}catch(V){console.error("Google login error:",V),x("Google login failed. Please try again.")}},[i,x,s]),q=f.useMemo(()=>{if(n===1){const V=e.every(X=>(r[X]||"").trim()!==""),oe=r.password.length>=8,je=r.password===r.confirmPassword;return!d||!!p||!V||!oe||!je}return n===2?!t.every(oe=>(o[oe]||"").trim()!=="")||!!p:!1},[n,d,p,r,o]),Z=pk.find(V=>V.id===n);return a.jsxs("div",{className:"min-h-screen w-full bg-gray-100 font-sans text-gray-800 flex flex-col items-center",children:[a.jsx("div",{className:"w-full py-6 px-4 sm:px-12 lg:px-20 max-w-7xl",children:a.jsxs("div",{className:"flex items-center text-gray-800",children:[a.jsx(sa,{className:"size-6 text-amber-500 mr-2"}),a.jsx("span",{className:"text-xl font-extrabold tracking-wider",children:"CRM"})]})}),S&&a.jsx(aq,{isLoading:S}),a.jsx("div",{className:"w-full max-w-lg px-4 pt-6",children:a.jsx(cue,{})}),a.jsx("main",{className:"w-full max-w-lg font-inter mx-auto px-4 pt-3 pb-12",children:a.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl shadow-xl p-6 md:p-10",children:[a.jsxs("header",{className:"text-center mb-8",children:[a.jsx("h1",{className:"text-3xl font-extrabold text-gray-900 tracking-tight",children:Z.title}),a.jsx("p",{className:"text-sm text-gray-500 mt-2 max-w-sm mx-auto",children:Z.subtitle})]}),a.jsx(uue,{currentStep:n,totalSteps:pk.length}),n===1&&a.jsx("div",{id:"googleSignupBtn"}),a.jsxs("form",{className:"mt-8",children:[n===1&&a.jsx(mue,{formData:r,handleChange:M,handleCodeChange:z,handleTogglePass:D,isPassVisible:c,formError:p,signupError:k,termsAccepted:d,handleTerms:U,isButtonDisabled:q,handleSubmit:B,handleGoogleLogin:R}),n===2&&a.jsx(fue,{handleSubmit:B,companyData:o,handleCompanyChange:E,formError:p,isSubmitted:v,isButtonDisabled:q,setStep:s,setIsSubmitted:j,setFormError:x,handleCodeChange1:P}),n===1&&a.jsx("div",{className:"text-center mt-6",children:a.jsxs("p",{className:"text-sm text-gray-700",children:["Already have an account?",a.jsx("a",{href:"/login",className:"font-bold text-amber-600 hover:text-amber-700 ml-1 cursor-pointer",children:"Log in"})]})})]})]})})]})},gue=()=>{const e=kt();return a.jsxs("button",{onClick:()=>e("/"),className:"inline-flex items-center text-sm text-gray-500 hover:text-gray-700 transition mb-3 cursor-pointer",children:[a.jsx(Ku,{className:"size-4 mr-1"})," Back to Home"]})},k$=({label:e,id:t,placeholder:n,type:s="text",value:r,onChange:i,isPassVisible:o,onTogglePass:l})=>{const c=t.toLowerCase().includes("password");return a.jsxs("div",{className:"flex flex-col space-y-2",children:[a.jsx("label",{htmlFor:t,className:"text-sm font-medium text-gray-700",children:e}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{id:t,type:c?"text":s,style:c&&!o?{WebkitTextSecurity:"disc"}:void 0,placeholder:n,value:r,onChange:i,required:!0,className:"w-full bg-gray-50 border border-gray-200 px-4 py-2.5 rounded-lg text-gray-800 transition shadow-inner placeholder-gray-400 focus:border-amber-500 focus:ring-2 focus:ring-amber-500/50 focus:outline-none cursor-pointer"}),c&&a.jsx("button",{type:"button",onClick:l,className:"absolute inset-y-0 right-0 flex items-center pr-3 text-gray-700 hover:text-gray-900 focus:outline-none z-10 transition-colors cursor-pointer","aria-label":o?"Hide password":"Show password",children:o?a.jsx(Pu,{className:"size-5"}):a.jsx(md,{className:"size-5"})})]})]})},pue=()=>{const[e,t]=f.useState({email:"",password:""}),[n,s]=f.useState(!1),[r,i]=f.useState(null),[o,l]=f.useState(!1),{isLoggedIn:c,login:u,userRole:d}=Ks(),h=kt();f.useEffect(()=>{document.title="Login | Sari-Sari CRM"},[]),f.useEffect(()=>{c&&(d==="Admin"?h("/super-admin/dashboard"):d==="CEO"?h("/admin/dashboard"):d==="Group Manager"?h("/group-manager"):d==="Manager"?h("/manager"):d==="Marketing"?h("/marketing"):d==="Sales"&&h("/sales"))},[c,h,d]);const p=j=>{const{id:y,value:N}=j.target;t(w=>({...w,[y]:N}))},x=async j=>{j.preventDefault(),i(null);try{const y=await re.post("/auth/login",e);u(y.data),i(null)}catch(y){y.response&&y.response.data&&y.response.data.detail?i(y.response.data.detail):i("Something went wrong. Please try again.")}};f.useEffect(()=>{const j=document.createElement("script");return j.src="https://accounts.google.com/gsi/client",j.async=!0,j.defer=!0,j.onload=()=>{window.google&&(window.google.accounts.id.initialize({client_id:"222789237297-r8mebl46fdacgpsnlnjca4eu0crn8hf6.apps.googleusercontent.com",callback:v}),window.google.accounts.id.renderButton(document.getElementById("googleLoginBtn"),{theme:"outline",size:"large",text:"signin_with"}))},document.body.appendChild(j),()=>{document.body.contains(j)&&document.body.removeChild(j)}},[]);const v=async j=>{l(!0);try{const y=x9(j.credential),N=await re.post("/auth/google/login",{id_token:j.credential});u(N.data)}catch(y){console.error("Google login failed:",y);const N=y.response?.data?.detail||"Google login failed. Please try again.";i(N)}finally{l(!1)}};return a.jsxs("div",{className:"min-h-screen w-full bg-gray-100 font-sans text-gray-800 flex flex-col items-center",children:[a.jsx("div",{className:"w-full py-6 px-4 sm:px-12 lg:px-20 max-w-7xl",children:a.jsx("div",{className:"flex items-center text-gray-800",children:a.jsx("span",{className:"text-xl font-extrabold tracking-wider",children:"CRM"})})}),o&&a.jsx(aq,{isLoading:o}),a.jsxs("main",{className:"w-full max-w-lg font-inter mx-auto px-4 pt-6 pb-12",children:[a.jsx(gue,{}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl shadow-xl p-6 md:p-10",children:[a.jsxs("header",{className:"text-center mb-6",children:[a.jsx("h1",{className:"text-3xl font-extrabold text-gray-900 tracking-tight",children:"Login"}),a.jsx("p",{className:"text-sm text-gray-500 mt-2 max-w-sm mx-auto",children:"Sign in to access your dashboard."})]}),a.jsx("div",{id:"googleLoginBtn"}),a.jsxs("div",{className:"flex items-center my-6",children:[a.jsx("div",{className:"flex-grow border-t border-gray-300"}),a.jsx("span",{className:"flex-shrink mx-4 text-sm text-gray-500",children:"OR"}),a.jsx("div",{className:"flex-grow border-t border-gray-300"})]}),a.jsxs("form",{onSubmit:x,className:"space-y-6 cursor-pointer",children:[a.jsx(k$,{label:"Email",id:"email",type:"email",placeholder:"you@example.com",value:e.email,onChange:p}),a.jsx(k$,{label:"Password",id:"password",type:"password",placeholder:"Enter your password",value:e.password,onChange:p,isPassVisible:n,onTogglePass:()=>s(j=>!j)}),r&&a.jsx("div",{className:"bg-red-100 border border-red-300 py-2 px-3 text-red-600",children:r}),a.jsx("button",{type:"submit",className:"w-full mt-2 inline-flex items-center justify-center rounded-lg h-12 px-6 text-white font-bold tracking-wide transition-all disabled:opacity-50 bg-secondary text-gray-900 hover:bg-tertiary shadow-xl focus-visible:ring-2 focus-visible:ring-amber-500/50 cursor-pointer",children:"Log In"}),a.jsx("div",{className:"text-center mt-1",children:a.jsx("a",{href:"/forgot-password",className:"text-sm font-medium text-amber-600 hover:text-amber-700 cursor-pointer",children:"Forgot Password?"})})]}),a.jsx("div",{className:"text-center mt-6",children:a.jsxs("p",{className:"text-sm text-gray-700",children:["Don't have an account?",a.jsx("a",{href:"/signup",className:"font-bold text-amber-600 hover:text-amber-700 ml-1 cursor-pointer",children:"Sign Up"})]})})]})]})]})},xue=({onClick:e})=>a.jsxs("button",{onClick:e,className:"inline-flex items-center text-sm text-gray-500 hover:text-gray-700 transition mb-3 cursor-pointer",children:[a.jsx(Ku,{className:"size-4 mr-1"})," Back"]}),d2=({label:e,id:t,placeholder:n,type:s="text",value:r,onChange:i,icon:o})=>{const[l,c]=f.useState(!1),u=s==="password";return a.jsxs("div",{className:"flex flex-col space-y-2",children:[a.jsx("label",{htmlFor:t,className:"text-sm font-medium text-gray-700",children:e}),a.jsxs("div",{className:"relative flex items-center",children:[o&&a.jsx(o,{className:"absolute left-3 text-gray-500 size-5"}),a.jsx("input",{id:t,type:u?"text":s,style:u&&!l?{WebkitTextSecurity:"disc"}:void 0,placeholder:n,value:r,onChange:i,required:!0,className:"w-full bg-gray-50 border border-gray-200 pl-10 pr-10 py-2.5 rounded-lg text-gray-800 transition shadow-inner placeholder-gray-400 focus:border-amber-500 focus:ring-2 focus:ring-amber-500/50 focus:outline-none cursor-pointer"}),u&&a.jsx("button",{type:"button",onClick:()=>c(d=>!d),className:"absolute right-3 text-gray-500",children:l?a.jsx(Pu,{className:"size-5"}):a.jsx(md,{className:"size-5"})})]})]})},yue=({otp:e,setOtp:t})=>a.jsx("div",{className:"flex justify-between gap-2",children:[...Array(6)].map((n,s)=>a.jsx("input",{type:"text",maxLength:"1",className:"w-12 h-12 text-center text-lg font-bold border border-gray-300 rounded-lg focus:border-amber-500 focus:ring-2 focus:ring-amber-500/50",value:e[s]||"",onChange:r=>{const i=r.target.value;if(/\d/.test(i)||i===""){const o=[...e];o[s]=i,t(o)}}},s))}),bue=()=>{const e=kt(),[t,n]=f.useState(1),[s,r]=f.useState(""),[i,o]=f.useState(["","","","","",""]),[l,c]=f.useState(""),[u,d]=f.useState(""),h=j=>{j.preventDefault(),n(2)},p=j=>{j.preventDefault(),n(3)},x=j=>{if(j.preventDefault(),l!==u){alert("Passwords do not match!");return}alert("Password reset successfully!")},v=()=>{t>1?n(t-1):e("/login")};return a.jsxs("div",{className:"min-h-screen w-full bg-gray-100 font-sans text-gray-800 flex flex-col items-center",children:[a.jsx("div",{className:"w-full py-6 px-4 sm:px-12 lg:px-20 max-w-7xl",children:a.jsx("div",{className:"flex items-center text-gray-800",children:a.jsx("span",{className:"text-xl font-extrabold tracking-wider",children:"CRM"})})}),a.jsxs("main",{className:"w-full max-w-lg font-inter mx-auto px-4 pt-6 pb-12",children:[a.jsx(xue,{onClick:v}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl shadow-xl p-6 md:p-10",children:[t===1&&a.jsxs(a.Fragment,{children:[a.jsxs("header",{className:"text-center mb-6",children:[a.jsx("h1",{className:"text-3xl font-extrabold text-gray-900 tracking-tight",children:"Forgot Password"}),a.jsx("p",{className:"text-sm text-gray-500 mt-2 max-w-sm mx-auto",children:"Enter your email and we'll send you a verification code."})]}),a.jsxs("form",{onSubmit:h,className:"space-y-6 cursor-pointer",children:[a.jsx(d2,{label:"Email Address",id:"email",type:"email",placeholder:"you@example.com",value:s,onChange:j=>r(j.target.value),icon:rn}),a.jsx("button",{className:"w-full mt-3 inline-flex items-center justify-center rounded-lg h-12 px-6 text-white font-bold tracking-wide transition-all bg-secondary text-gray-900 hover:bg-tertiary shadow-xl",children:"Send OTP"})]})]}),t===2&&a.jsxs(a.Fragment,{children:[a.jsxs("header",{className:"text-center mb-6",children:[a.jsx("h1",{className:"text-3xl font-extrabold text-gray-900 tracking-tight",children:"Enter Verification Code"}),a.jsxs("p",{className:"text-sm text-gray-500 mt-2 max-w-sm mx-auto",children:["We've sent a 6-digit code to ",a.jsx("strong",{children:s}),"."]})]}),a.jsxs("form",{onSubmit:p,className:"space-y-6",children:[a.jsx(yue,{otp:i,setOtp:o}),a.jsx("button",{className:"w-full mt-3 inline-flex items-center justify-center rounded-lg h-12 px-6 text-white font-bold tracking-wide transition-all bg-secondary text-gray-900 hover:bg-tertiary shadow-xl",children:"Verify Code"})]})]}),t===3&&a.jsxs(a.Fragment,{children:[a.jsxs("header",{className:"text-center mb-6",children:[a.jsx("h1",{className:"text-3xl font-extrabold text-gray-900 tracking-tight",children:"Reset Password"}),a.jsx("p",{className:"text-sm text-gray-500 mt-2 max-w-sm mx-auto",children:"Enter your new password below."})]}),a.jsxs("form",{onSubmit:x,className:"space-y-6",children:[a.jsx(d2,{label:"New Password",id:"password",type:"password",placeholder:"Enter new password",value:l,onChange:j=>c(j.target.value),icon:Po}),a.jsx(d2,{label:"Confirm Password",id:"confirm-password",type:"password",placeholder:"Confirm new password",value:u,onChange:j=>d(j.target.value),icon:Po}),a.jsx("button",{className:"w-full mt-3 inline-flex items-center justify-center rounded-lg h-12 px-6 text-white font-bold tracking-wide transition-all bg-secondary text-gray-900 hover:bg-tertiary shadow-xl",children:"Reset Password"})]})]})]})]})]})},Vt=()=>{const[e,t]=f.useState(null),[n,s]=f.useState(!1),[r,i]=f.useState(!0),o=kt(),l=async()=>{try{const u=await re.get("/auth/me");t(u.data),s(!0)}catch(u){t(null),s(!1),console.warn("Unauthorized  possible expired token or not logged in.",u)}finally{i(!1)}};return f.useEffect(()=>{l()},[]),{user:e,isLoggedIn:n,loading:r,fetchUser:l,logout:async()=>{try{await re.post("/auth/logout")}catch{}t(null),s(!1),o("/login")}}};function Wt({message:e="Loading..."}){return a.jsx("div",{className:"absolute inset-0 bg-primary/90 flex items-center justify-center z-40 lg:flex hidden",children:a.jsxs("div",{className:"flex items-center justify-center gap-1.5",children:[a.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-bounce",style:{animationDelay:"0ms",animationDuration:"0.6s"}}),a.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-bounce",style:{animationDelay:"150ms",animationDuration:"0.6s"}}),a.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-bounce",style:{animationDelay:"300ms",animationDuration:"0.6s"}})]})})}const vue=(e,t)=>{const n=e?.trim()?.[0]??"",s=t?.trim()?.[0]??"";return`${n}${s}`.toUpperCase()||"U"};function Gy(){const{user:e,loading:t,fetchUser:n}=Vt(),[s,r]=f.useState(!1),[i,o]=f.useState(!1),[l,c]=f.useState(!1),[u,d]=f.useState(!1),[h,p]=f.useState(!1),[x,v]=f.useState(!1),[j,y]=f.useState(!1),[N,w]=f.useState(!1),[S,_]=f.useState(null),[k,T]=f.useState(null),A=f.useRef(null),[E,M]=f.useState({firstName:"",lastName:"",email:"",phoneNumber:""}),[z,P]=f.useState({currentPassword:"",newPassword:"",confirmPassword:""});f.useEffect(()=>{e&&(M({firstName:e.first_name||"",lastName:e.last_name||"",email:e.email||"",phoneNumber:e.phone_number||""}),T(e.profile_picture||null))},[e]),f.useEffect(()=>{document.title="Manage Account | Sari-Sari CRM"},[]);const D=(Z,V)=>{M(oe=>({...oe,[Z]:V}))},U=(Z,V)=>{P(oe=>({...oe,[Z]:V}))},B=Z=>{const V=Z.target.files?.[0];if(!V)return;if(!V.type.startsWith("image/")){H.error("Please select an image file");return}if(V.size>5*1024*1024){H.error("Image size should be less than 5MB");return}const oe=new FileReader;oe.onloadend=()=>{_(oe.result),T(oe.result)},oe.readAsDataURL(V)},R=async Z=>{if(Z.preventDefault(),!E.firstName.trim()||!E.lastName.trim()){H.warn("Please fill in all required fields.");return}o(!0);try{const V={first_name:E.firstName.trim(),last_name:E.lastName.trim(),phone_number:E.phoneNumber.trim()||null};S!==null&&(V.profile_picture=S),await re.put("/users/me",V),await n(),c(!1),_(null),window.dispatchEvent(new CustomEvent("userProfileUpdated")),H.success("Account information updated successfully!")}catch(V){console.error("Error updating account:",V);const oe=V.response?.data?.detail||"Failed to update account information. Please try again.";H.error(oe)}finally{o(!1)}},q=async Z=>{if(Z.preventDefault(),!z.newPassword||!z.confirmPassword){H.warn("Please fill in all password fields.");return}if(z.newPassword.length<8){H.warn("Password must be at least 8 characters long.");return}if(z.newPassword!==z.confirmPassword){H.warn("New password and confirm password do not match.");return}w(!0);try{const V={password:z.newPassword};await re.put("/users/me",V),await n(),P({currentPassword:"",newPassword:"",confirmPassword:""}),window.dispatchEvent(new CustomEvent("userProfileUpdated")),w(!1),H.success("Password changed successfully!")}catch(V){console.error("Error changing password:",V);const oe=V.response?.data?.detail||"Failed to change password. Please try again.";H.error(oe)}finally{w(!1)}};return a.jsxs("div",{className:"p-2 lg:p-8 font-inter relative",children:[(t||!e)&&a.jsx(Wt,{}),e&&a.jsxs("div",{children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("h1",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 mb-2",children:"Manage Your Profile"}),a.jsx("p",{className:"text-gray-600 text-sm sm:text-base",children:"Update your account information and change your password"})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm p-6 mb-6",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h2",{className:"text-xl font-semibold text-gray-800 flex items-center gap-2",children:[a.jsx(ra,{className:"text-blue-600"}),"Profile Information"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:!l&&a.jsxs("button",{onClick:()=>c(!0),className:"flex items-center gap-2 px-4 py-2 bg-gray-900 text-white rounded-md hover:bg-gray-800 transition text-sm",children:[a.jsx(hn,{}),"Edit Profile"]})})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-4 mb-6 pb-6 border-b border-gray-200",children:[a.jsxs("div",{className:"flex-shrink-0 relative group",children:[k?a.jsx("div",{className:"relative",children:a.jsx("img",{src:k,alt:`${e.first_name} ${e.last_name}`,className:"w-20 h-20 sm:w-24 sm:h-24 rounded-full object-cover border-2 border-gray-200 shadow-sm"})}):a.jsx("div",{className:"w-20 h-20 sm:w-24 sm:h-24 rounded-full bg-gradient-to-br from-blue-500 to-indigo-600 text-white flex items-center justify-center text-2xl sm:text-3xl font-semibold border-2 border-gray-200 shadow-sm",children:vue(e.first_name,e.last_name)}),l&&a.jsxs("div",{className:"absolute bottom-0 right-0",children:[a.jsx("input",{type:"file",ref:A,accept:"image/*",onChange:B,className:"hidden",id:"profile-picture-upload"}),a.jsx("label",{htmlFor:"profile-picture-upload",className:"cursor-pointer bg-gray-900 text-white p-1.5 rounded-full shadow-lg hover:bg-gray-800 transition flex items-center justify-center border-2 border-white",title:"Change profile picture",children:a.jsx(f9,{size:14})})]})]}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-800",children:[e.first_name," ",e.last_name]}),a.jsx("p",{className:"text-gray-600 text-sm",children:e.email}),a.jsx("span",{className:"inline-block mt-2 px-3 py-1 bg-blue-100 text-blue-700 text-xs font-semibold rounded-md",children:e.role})]})]}),l?a.jsxs("form",{onSubmit:R,className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-2 text-sm",children:["First Name ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("div",{className:"relative",children:[a.jsx(ra,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),a.jsx("input",{type:"text",value:E.firstName,onChange:Z=>D("firstName",Z.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none",required:!0})]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-2 text-sm",children:["Last Name ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("div",{className:"relative",children:[a.jsx(ra,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),a.jsx("input",{type:"text",value:E.lastName,onChange:Z=>D("lastName",Z.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none",required:!0})]})]}),a.jsxs("div",{className:"sm:col-span-2",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-2 text-sm",children:"Email"}),a.jsxs("div",{className:"relative",children:[a.jsx(rn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),a.jsx("input",{type:"email",value:E.email,disabled:!0,className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md bg-gray-100 text-gray-600 cursor-not-allowed outline-none",readOnly:!0})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Email cannot be changed"})]}),a.jsxs("div",{className:"sm:col-span-2",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-2 text-sm",children:"Phone Number"}),a.jsxs("div",{className:"relative",children:[a.jsx(It,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),a.jsx("input",{type:"tel",value:E.phoneNumber,onChange:Z=>D("phoneNumber",Z.target.value),placeholder:"+1 (555) 123-4567",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none"})]})]})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-3 pt-4 border-t border-gray-200",children:[a.jsx("button",{type:"button",onClick:()=>{c(!1),M({firstName:e.first_name||"",lastName:e.last_name||"",email:e.email||"",phoneNumber:e.phone_number||""}),_(null),T(e.profile_picture||null),A.current&&(A.current.value="")},className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition",disabled:i,children:"Cancel"}),a.jsxs("button",{type:"submit",className:"flex items-center justify-center gap-2 px-4 py-2 bg-gray-900 text-white rounded-md hover:bg-gray-800 transition disabled:opacity-70",disabled:i,children:[a.jsx(CL,{}),i?"Saving...":"Save Changes"]})]})]}):a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"First Name"}),a.jsx("p",{className:"text-gray-800 font-medium",children:e.first_name||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Last Name"}),a.jsx("p",{className:"text-gray-800 font-medium",children:e.last_name||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Email"}),a.jsx("p",{className:"text-gray-800 font-medium",children:e.email||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Phone Number"}),a.jsx("p",{className:"text-gray-800 font-medium",children:e.phone_number||"N/A"})]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm p-6",children:[a.jsxs("h2",{className:"text-xl font-semibold text-gray-800 flex items-center gap-2 mb-6 justify-center lg:justify-start",children:[a.jsx(Po,{className:"text-blue-600"}),"Change Password"]}),a.jsxs("form",{onSubmit:q,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-2 text-sm",children:["New Password ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("div",{className:"relative",children:[a.jsx(Po,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),a.jsx("input",{type:"text",style:x?void 0:{WebkitTextSecurity:"disc"},value:z.newPassword,onChange:Z=>U("newPassword",Z.target.value),placeholder:"Enter new password (min. 8 characters)",className:"w-full pl-10 pr-10 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none",required:!0,minLength:8}),a.jsx("button",{type:"button",onClick:()=>v(Z=>!Z),className:"absolute inset-y-0 right-0 flex items-center pr-3 text-gray-700 hover:text-gray-900 focus:outline-none z-10 transition-colors cursor-pointer","aria-label":x?"Hide password":"Show password",children:x?a.jsx(Pu,{className:"size-5"}):a.jsx(md,{className:"size-5"})})]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-2 text-sm",children:["Confirm New Password ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("div",{className:"relative",children:[a.jsx(Po,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),a.jsx("input",{type:"text",style:j?void 0:{WebkitTextSecurity:"disc"},value:z.confirmPassword,onChange:Z=>U("confirmPassword",Z.target.value),placeholder:"Confirm new password",className:"w-full pl-10 pr-10 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none",required:!0,minLength:8}),a.jsx("button",{type:"button",onClick:()=>y(Z=>!Z),className:"absolute inset-y-0 right-0 flex items-center pr-3 text-gray-700 hover:text-gray-900 focus:outline-none z-10 transition-colors cursor-pointer","aria-label":j?"Hide password":"Show password",children:j?a.jsx(Pu,{className:"size-5"}):a.jsx(md,{className:"size-5"})})]})]}),a.jsx("div",{className:"pt-4 border-t border-gray-200 flex justify-center lg:justify-start",children:a.jsxs("button",{type:"submit",className:"flex items-center justify-center gap-2 px-4 py-2 bg-gray-900 text-white rounded-md hover:bg-gray-800 transition disabled:opacity-70",disabled:N,children:[a.jsx(Po,{}),N?"Changing Password...":"Change Password"]})})]})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm p-6 mt-6",children:[a.jsxs("h2",{className:"text-xl font-semibold text-gray-800 flex items-center gap-2 mb-6 justify-center lg:justify-start",children:[a.jsx(g9,{className:"text-blue-600"}),"Account Information"]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Role"}),a.jsx("span",{className:"inline-block px-3 py-1 bg-blue-100 text-blue-700 text-sm font-semibold rounded-md",children:e.role})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Status"}),a.jsx("span",{className:`inline-block px-3 py-1 text-sm font-semibold rounded-md ${e.is_active?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:e.is_active?"Active":"Inactive"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Company"}),a.jsx("p",{className:"text-gray-800 font-medium",children:e.company?.company_name||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Auth Provider"}),a.jsx("p",{className:"text-gray-800 font-medium",children:e.auth_provider?e.auth_provider.charAt(0).toUpperCase()+e.auth_provider.slice(1):"N/A"})]}),e.created_at&&a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Account Created"}),a.jsx("p",{className:"text-gray-800 font-medium",children:new Date(e.created_at).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]}),e.last_login&&a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Last Login"}),a.jsx("p",{className:"text-gray-800 font-medium",children:new Date(e.last_login).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"})})]})]})]})]})]})}const wue=({isOpen:e,onClose:t})=>{if(!e)return null;const n=[{number:"1",title:"Enterprise Security Commitment",content:["Sari-Sari CRM maintains a security-first architecture designed to protect business data, preserve system integrity, and support continuous operational reliability. Security controls are implemented across administrative, technical, and operational layers to reduce risk and safeguard organizational information."]},{number:"2",title:"Access Governance",content:["The platform enforces strict role-based access controls to ensure that only authorized organizational users can access CRM records, including leads, contacts, accounts, deals, quotes, and scheduling information. Permission boundaries are applied according to user roles and operational responsibilities.","Internal and developer access is tightly restricted, monitored, and permitted only for essential system maintenance under controlled conditions."]},{number:"3",title:"Data Protection Controls",content:["Security measures are designed to:",` Protect confidentiality of business records
 Prevent unauthorized access or disclosure
 Preserve data integrity
 Maintain availability of services`,"Safeguards are reviewed periodically and updated to address evolving threats and operational needs."]},{number:"4",title:"Operational Security",content:["We maintain structured incident management, monitoring, and maintenance processes to support secure system performance. Security events are prioritized and addressed using defined response procedures."]},{number:"5",title:"Shared Responsibility",content:["Organizations are responsible for maintaining secure credential practices, enforcing internal access policies, and promptly reporting suspected security concerns."]},{number:"6",title:"Technical Security Framework",content:["Sari-Sari CRM employs layered security controls aligned with industry best practices to protect data and platform operations."]},{number:"7",title:"Access & Authentication",content:[` Role-based authorization controls
 Credential protection mechanisms
 Session management safeguards`]},{number:"8",title:"Data Protection",content:[` Controlled access to stored business records
 Logical isolation of organizational data
 Integrity protections to prevent unauthorized modification`,"Developer access to production environments is restricted, logged, and limited to operational necessity."]},{number:"9",title:"System Security Measures",content:[` Monitoring for abnormal system behavior
 Controlled maintenance workflows
 Incident response procedures
 Secure update and deployment processes`]},{number:"10",title:"Security Lifecycle",content:["Security practices are continuously evaluated and refined to maintain resilience against emerging risks."]}];return a.jsx("div",{className:"fixed inset-0 bg-black/40 bg-opacity-40 z-50 flex items-center justify-center p-4",onClick:t,children:a.jsxs("div",{className:"bg-white rounded-lg max-w-5xl w-full max-h-[90vh] overflow-hidden",onClick:s=>s.stopPropagation(),children:[a.jsxs("div",{className:"sticky top-0 bg-secondary text-white px-8 py-6 flex items-center justify-between border-b border-accent",children:[a.jsx("div",{children:a.jsx("h2",{className:"text-3xl font-bold",children:"Security Guidelines"})}),a.jsx("button",{onClick:t,className:"text-white hover:text-accent transition-colors text-4xl leading-none",children:""})]}),a.jsxs("div",{className:"overflow-y-auto max-h-[calc(90vh-120px)] px-8 py-6 scrollbar-hide",children:[a.jsx("p",{className:"text-gray-700 mb-6 leading-relaxed",children:"This document outlines the enterprise and technical security measures implemented to protect your business data and ensure the integrity, confidentiality, and availability of the Sari-Sari CRM platform."}),a.jsx("div",{className:"space-y-6",children:n.map((s,r)=>a.jsxs("div",{className:"border-l-4 border-accent pl-6 py-2",children:[a.jsxs("h3",{className:"text-xl font-semibold text-secondary mb-2",children:[s.number,". ",s.title]}),s.content.map((i,o)=>a.jsx("p",{className:"text-gray-700 mb-2 leading-relaxed whitespace-pre-line text-sm",children:i},o))]},r))}),a.jsx("div",{className:"mt-8 pt-6 mb-10 border-t border-gray-200",children:a.jsx("p",{className:"text-gray-600 text-xs leading-relaxed text-center",children:"Security is a shared responsibility. We are committed to maintaining robust protections while working with our customers to ensure secure and responsible use of the platform."})})]}),a.jsx("div",{className:"sticky bottom-0 bg-gray-50 px-8 py-4 border-t border-gray-200",children:a.jsx("button",{onClick:t,className:"w-full bg-accent text-white px-6 py-3 rounded-lg font-semibold hover:bg-secondary transition-colors",children:"Close"})})]})})},jue=({isOpen:e,onClose:t})=>{if(!e)return null;const n=[{number:"1",title:"Support Commitment",content:["Sari-Sari CRM provides operational support to help organizations maintain smooth and reliable use of the platform. Our goal is to resolve issues efficiently and minimize disruption to your business workflows."]},{number:"2",title:"Support Coverage",content:["Support services include assistance with:",` System or feature malfunctions
 Performance concerns
 General platform inquiries`,"Support does not include custom development, third-party integrations outside our platform, or user-side hardware/network issues."]},{number:"3",title:"User Responsibilities",content:["Organizations and users help maintain efficient support by:",` Reporting issues promptly
 Providing accurate information
 Following role permissions
 Maintaining secure account access`]},{number:"4",title:"Continuous Improvement",content:["Support feedback is used to improve system performance, reliability, and user experience."]},{number:"5",title:"Support & Reporting",content:["Users should submit support requests through designated communication channels, including:",a.jsx("strong",{children:"Sari-Sari CRM Administration"},"dept"),a.jsx("a",{href:"https://www.sari-sari.com/",className:"font-bold text-accent hover:underline",target:"_blank",rel:"noopener noreferrer",children:"sari-sari.com"},"email"),"Providing clear details helps accelerate resolution."]}];return a.jsx("div",{className:"fixed inset-0 bg-black/40 bg-opacity-40 z-50 flex items-center justify-center p-4",onClick:t,children:a.jsxs("div",{className:"bg-white rounded-lg max-w-5xl w-full max-h-[90vh] overflow-hidden",onClick:s=>s.stopPropagation(),children:[a.jsxs("div",{className:"sticky top-0 bg-secondary text-white px-8 py-6 flex items-center justify-between border-b border-accent",children:[a.jsx("div",{children:a.jsx("h2",{className:"text-3xl font-bold",children:"Support"})}),a.jsx("button",{onClick:t,className:"text-white hover:text-accent transition-colors text-4xl leading-none",children:""})]}),a.jsxs("div",{className:"overflow-y-auto max-h-[calc(90vh-120px)] px-8 py-6 scrollbar-hide",children:[a.jsx("p",{className:"text-gray-700 mb-6 leading-relaxed",children:"Sari-Sari CRM is committed to providing responsive and effective support to help your organization succeed. Our support team is here to assist with platform access, features, performance, and general questions."}),a.jsx("div",{className:"space-y-6",children:n.map((s,r)=>a.jsxs("div",{className:"border-l-4 border-accent pl-6 py-2",children:[a.jsxs("h3",{className:"text-xl font-semibold text-secondary mb-2",children:[s.number,". ",s.title]}),s.content.map((i,o)=>a.jsx("p",{className:"text-gray-700 mb-2 leading-relaxed whitespace-pre-line text-sm",children:i},o))]},r))}),a.jsx("div",{className:"mt-8 pt-6 mb-10 border-t border-gray-200",children:a.jsx("p",{className:"text-gray-600 text-xs leading-relaxed text-center",children:"We value your feedback and continuously improve our support services based on your experience. Thank you for using Sari-Sari CRM."})})]}),a.jsx("div",{className:"sticky bottom-0 bg-gray-50 px-8 py-4 border-t border-gray-200",children:a.jsx("button",{onClick:t,className:"w-full bg-accent text-white px-6 py-3 rounded-lg font-semibold hover:bg-secondary transition-colors",children:"Close"})})]})})},Nue=()=>a.jsx("header",{className:"bg-secondary text-white py-4 border-b border-accent",children:a.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"flex items-center justify-between py-3",children:[a.jsxs(ld,{to:"/",className:"text-2xl font-bold",children:["Sari-Sari ",a.jsx("span",{className:"text-accent",children:"CRM"})]}),a.jsxs("nav",{className:"flex space-x-8",children:[a.jsx(ld,{to:"/resources",className:"hover:text-accent transition-colors",children:"Resources"}),a.jsx(ld,{to:"/legal",className:"hover:text-accent transition-colors",children:"Legal"})]})]})})}),Cue=()=>{const[e,t]=f.useState(!1),[n,s]=f.useState(!1);f.useEffect(()=>{document.title="Resources - Sari-Sari CRM"},[]);const r=[{title:"Security",description:"Understand our security practices.",action:()=>t(!0)},{title:"Support",description:"Get help from our support team and knowledge base.",action:()=>s(!0)}];return a.jsxs("div",{className:"font-manrope",children:[a.jsx(Nue,{}),a.jsx(wue,{isOpen:e,onClose:()=>t(!1)}),a.jsx(jue,{isOpen:n,onClose:()=>s(!1)}),a.jsx("main",{className:"bg-paper-white min-h-screen py-16",children:a.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:[a.jsx("h1",{className:"text-5xl font-bold text-secondary mb-4",children:"Resources"}),a.jsx("p",{className:"text-lg text-secondary mb-12",children:"Everything you need to succeed with Sari-Sari CRM"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:r.map((i,o)=>a.jsxs("div",{className:"p-6 bg-white border border-gray-200 rounded-lg shadow-md hover:shadow-lg transition-shadow",children:[a.jsx("h3",{className:"text-2xl font-semibold text-secondary mb-2",children:i.title}),a.jsx("p",{className:"text-gray-600 mb-4",children:i.description}),i.action?a.jsx("button",{onClick:i.action,className:"text-accent font-semibold hover:text-secondary transition-colors",children:"Learn More "}):a.jsx("a",{href:i.link,className:"text-accent font-semibold hover:text-secondary transition-colors",children:"Learn More "})]},o))})]})})]})},Sue=({isOpen:e,onClose:t})=>{if(!e)return null;const n=[{number:"1",title:"Authorized Use",content:["Sari-Sari CRM  is an internal company platform intended to manage leads, deals, accounts, contacts, scheduling, and task workflows.","Access is granted according to employment role and operational responsibilities. Users are required to safeguard their credentials and operate strictly within assigned permissions. Unauthorized access, credential sharing, or misuse of the System is prohibited and may result administrative action."]},{number:"2",title:"System Purpose",content:["The System supports company sales operations, including:",` Lead and deal pipeline management
 Account and contact records
 Scheduling of calls and meetings
 Task tracking and follow-ups
 Activity logging and reporting`]},{number:"3",title:"Role-Based Responsibilities",content:["Users are assigned permissions based on their role:","Administrator  Full configuration, oversight, and system governance.","Group Manager  Team supervision, reporting, and workflow monitoring.","Manager  Operational coordination and performance oversight.","Sales Users  Execution of sales activities and record maintenance.","Users must operate strictly within assigned permissions."]},{number:"4",title:"Data Integrity & Confidentiality",content:["All information stored in the System is confidential company data.",`Users must:
 Maintain accurate records
 Protect customer and sales information
 Avoid unauthorized disclosure or manipulation`,"Intentional misuse may lead to disciplinary action."]},{number:"5",title:"Activity Logging & Monitoring",content:["System actions may be recorded for accountability, performance review, and security purposes. Continued use indicates consent to such monitoring."]},{number:"6",title:"Acceptable Conduct",content:[`Users must not:
 Enter false or misleading information
 Delete or alter records without authorization
 Attempt to bypass security measures
 Use the System for personal or unrelated activities`,"Professional conduct is required at all times."]},{number:"7",title:"Scheduling & Task Accountability",content:["Users are responsible for maintaining accurate scheduling records and completing assigned tasks in good faith to support operational efficiency."]},{number:"8",title:"Security Responsibilities",content:["Users must safeguard login credentials and immediately report suspicious activity. Account sharing is prohibited."]},{number:"9",title:"Intellectual Property",content:["The System, including its interface, workflows, and software components, is proprietary company property and may not be copied or redistributed without authorization."]},{number:"10",title:"System Availability",content:["The company will maintain reasonable uptime but does not guarantee uninterrupted access due to maintenance or unforeseen technical issues."]},{number:"11",title:"Violations",content:[`Misuse of the System may result in:
 Access restriction or suspension
 Internal disciplinary action
 Further administrative review`,"depending on severity."]},{number:"12",title:"Support & Reporting",content:["Questions or concerns regarding System use should be directed to:",a.jsx("strong",{children:"Sari-Sari CRM Administration"},"dept"),a.jsx("a",{href:"https://www.sari-sari.com/",className:"font-bold text-accent hover:underline",target:"_blank",rel:"noopener noreferrer",children:"sari-sari.com"},"email")]}];return a.jsx("div",{className:"fixed inset-0 bg-black/40 bg-opacity-40 z-50 flex items-center justify-center p-4",onClick:t,children:a.jsxs("div",{className:"bg-white rounded-lg max-w-5xl w-full max-h-[90vh] overflow-hidden",onClick:s=>s.stopPropagation(),children:[a.jsxs("div",{className:"sticky top-0 bg-secondary text-white px-8 py-6 flex items-center justify-between border-b border-accent",children:[a.jsx("div",{children:a.jsx("h2",{className:"text-3xl font-bold",children:"Terms of Use"})}),a.jsx("button",{onClick:t,className:"text-white hover:text-accent transition-colors text-4xl leading-none",children:""})]}),a.jsxs("div",{className:"overflow-y-auto max-h-[calc(90vh-120px)] px-8 py-6 scrollbar-hide",children:[a.jsx("p",{className:"text-gray-700 mb-6 leading-relaxed",children:"These Terms of Use govern your access to and use of the Sari-Sari CRM system. By accessing or using the System, you acknowledge that you have read, understood, and agree to be bound by these terms."}),a.jsx("div",{className:"space-y-6",children:n.map((s,r)=>a.jsxs("div",{className:"border-l-4 border-accent pl-6 py-2",children:[a.jsxs("h3",{className:"text-xl font-semibold text-secondary mb-2",children:[s.number,". ",s.title]}),s.content.map((i,o)=>a.jsx("p",{className:"text-gray-700 mb-2 leading-relaxed whitespace-pre-line text-sm",children:i},o))]},r))}),a.jsx("div",{className:"mt-8 pt-6 mb-10 border-t border-gray-200",children:a.jsx("p",{className:"text-gray-600 text-xs leading-relaxed text-center",children:"By continuing to use Sari-Sari CRM, you acknowledge that you have read and agree to these Terms of Use. If you do not agree with any part of these terms, you must discontinue use of the System immediately."})})]}),a.jsx("div",{className:"sticky bottom-0 bg-gray-50 px-8 py-4 border-t border-gray-200",children:a.jsx("button",{onClick:t,className:"w-full bg-accent text-white px-6 py-3 rounded-lg font-semibold hover:bg-secondary transition-colors",children:"Close"})})]})})},_ue=({isOpen:e,onClose:t})=>{if(!e)return null;const n=[{number:"1",title:"Users and Roles",content:["The system supports multiple roles with distinct access permissions:",`Admin  full system access and management.
Group Manager  oversees multiple teams and manages metrics.
Manager  manages teams and monitors pipeline progress.
Sales  accesses leads, contacts, accounts, deals, quotes, target and schedules.`,"Access to business data is strictly limited to authorized users in your organization based on role."]},{number:"2",title:"Data We Collect",content:["We may collect the following types of data:",`Account Information: Names, email addresses, phone numbers, company details, and login credentials.
Business Data: Leads, contacts, accounts, deals, quotes, notes, and pipeline information entered by your organization.
Scheduling Data: Tasks, meetings, and calls associated with your account or team.
Usage Data: IP addresses, device information, login activity, and feature usage for system analytics.
Cookies & Tracking: Cookies or similar technologies for authentication, and performance monitoring.`]},{number:"3",title:"Purpose of Data Processing",content:["Your data is processed only to:",` Provide, operate, and maintain the CRM platform.
 Manage user roles, permissions, and workflow operations.
 Facilitate collaboration and sales processes within your organization. 
 Comply with legal obligations and protect the security of the platform.`]},{number:"4",title:"Developer Access and Confidentiality",content:["We respect your business privacy. Our developers and internal staff cannot access business transaction information.","Developer access is limited to technical maintenance, bug fixing, system monitoring, and improvements. Access is strictly controlled, logged, and does not include the ability to view or extract business-specific information."]},{number:"5",title:"Data Sharing",content:["We do not sell or trade your data. Data may be shared only with:",`Service Providers: Vendors who help host, operate, or maintain the CRM. They are bound by confidentiality agreements.
Legal Requirements: Where disclosure is required by law, regulation, or legal process.`]},{number:"6",title:"Data Security",content:["We implement reasonable technical, administrative, and organizational measures to protect your data from unauthorized access, disclosure, alteration, or destruction. Users must also maintain secure login credentials and account access."]},{number:"7",title:"Data Retention",content:["We retain data only as long as necessary to provide services and comply with legal obligations. Your organization's Admins may request deletion of user accounts and associated business data."]},{number:"8",title:"Consent",content:["By using our CRM, your organization consents to the collection, processing, and storage of data as described in this Privacy Policy. Admins are responsible for ensuring that all users within their organization are aware of this policy and that proper consent has been obtained where required."]},{number:"9",title:"Third-Party Integrations",content:["Our CRM may integrate with third-party tools (e.g., email, calendar, analytics). We are not responsible for the privacy practices of these third parties."]},{number:"10",title:"Data Processing Agreement",content:["By using Sari-Sari CRM, your organization acknowledges and agrees that:",` Your organization is the Data Controller of all business and personal data entered into the CRM. 
 We implement technical and organizational measures to ensure data confidentiality, integrity, and security.
 Developer access to business transaction data is strictly restricted and logged, and we will not use or disclose your organization's business data for any purpose other than providing and maintaining the CRM services.`]}];return a.jsx("div",{className:"fixed inset-0 bg-black/40 bg-opacity-40 z-50 flex items-center justify-center p-4",onClick:t,children:a.jsxs("div",{className:"bg-white rounded-lg max-w-5xl w-full max-h-[90vh] overflow-hidden",onClick:s=>s.stopPropagation(),children:[a.jsxs("div",{className:"sticky top-0 bg-secondary text-white px-8 py-6 flex items-center justify-between border-b border-accent",children:[a.jsx("div",{children:a.jsx("h2",{className:"text-3xl font-bold",children:"Privacy Policy"})}),a.jsx("button",{onClick:t,className:"text-white hover:text-accent transition-colors text-4xl leading-none",children:""})]}),a.jsxs("div",{className:"overflow-y-auto max-h-[calc(90vh-120px)] px-8 py-6 scrollbar-hide",children:[a.jsx("p",{className:"text-gray-700 mb-6 leading-relaxed",children:"Sari-Sari CRM provides a B2B CRM platform designed to help manage businesses. Protecting your business and personal data is a top priority. This Privacy Policy explains how we collect, process, store, and protect data in compliance with applicable."}),a.jsx("div",{className:"space-y-6",children:n.map((s,r)=>a.jsxs("div",{className:"border-l-4 border-accent pl-6 py-2",children:[a.jsxs("h3",{className:"text-xl font-semibold text-secondary mb-2",children:[s.number,". ",s.title]}),s.content.map((i,o)=>a.jsx("p",{className:"text-gray-700 mb-2 leading-relaxed whitespace-pre-line text-sm",children:i},o))]},r))}),a.jsx("div",{className:"mt-8 pt-6 mb-10 border-t border-gray-200",children:a.jsx("p",{className:"text-gray-600 text-xs leading-relaxed text-center",children:"Your privacy and data security are important to us. If you have any questions about this Privacy Policy, please contact our CRM Administration team."})})]}),a.jsx("div",{className:"sticky bottom-0 bg-gray-50 px-8 py-4 border-t border-gray-200",children:a.jsx("button",{onClick:t,className:"w-full bg-accent text-white px-6 py-3 rounded-lg font-semibold hover:bg-secondary transition-colors",children:"Close"})})]})})},Aue=({isOpen:e,onClose:t})=>{if(!e)return null;const n=[{number:"1",title:"Purpose",content:['This Service Level Agreement ("SLA") defines the service standards, availability commitments, support expectations, and responsibilities associated with the use of Sari-Sari CRM, a business-to-business customer relationship management platform.']},{number:"2",title:"Service Availability",content:["We work to keep the CRM available 99.5% of the time each month so your team can manage work without interruption.","Planned maintenance is announced in advance whenever possible. Emergency maintenance may happen if needed to keep the system secure and stable.","Downtime caused by scheduled maintenance, internet or third-party issues, user device problems, or events outside our control is not included in availability targets."]},{number:"3",title:"Performance Standards",content:["The CRM platform is designed to:",` Provide consistent access to business records and sales workflows
 Support role-based system operations`,"Performance may vary depending on user device, internet connection, and data volume."]},{number:"4",title:"Data Protection & Confidentiality",content:["We prioritize business data security:",` Access to CRM data is restricted to authorized organizational users
 Developers and internal staff do not access business transaction data
 Security safeguards are implemented to protect confidentiality and integrity`]},{number:"5",title:"Incident Management",content:["If a service disruption occurs:",` Issues are logged and prioritized based on severity
 Mitigation steps are started as quickly as possible
 Users are informed of significant incidents when appropriate`]},{number:"6",title:"Customer Responsibilities",content:["Organizations using the CRM agree to:",` Maintain secure login credentials
 Use the system in accordance with assigned roles
 Report issues promptly
 Ensure stable internet and device compatibility`]},{number:"7",title:"Maintenance & Updates",content:["We may perform:",` Routine maintenance
 Security updates
 Feature improvements`,"Maintenance may temporarily affect availability."]},{number:"8",title:"Limitations",content:["Service commitments do not apply to disruptions caused by:",` User misuse or unauthorized modifications
 Third-party service failures
 Network or infrastructure outside our control`]},{number:"9",title:"Review & Modification",content:["This SLA may be updated to reflect service improvements or operational changes. Continued use of the CRM indicates acceptance of updates."]}];return a.jsx("div",{className:"fixed inset-0 bg-black/40 bg-opacity-40 z-50 flex items-center justify-center p-4",onClick:t,children:a.jsxs("div",{className:"bg-white rounded-lg max-w-5xl w-full max-h-[90vh] overflow-hidden",onClick:s=>s.stopPropagation(),children:[a.jsxs("div",{className:"sticky top-0 bg-secondary text-white px-8 py-6 flex items-center justify-between border-b border-accent",children:[a.jsx("div",{children:a.jsx("h2",{className:"text-3xl font-bold",children:"Service Level Agreement"})}),a.jsx("button",{onClick:t,className:"text-white hover:text-accent transition-colors text-4xl leading-none",children:""})]}),a.jsxs("div",{className:"overflow-y-auto max-h-[calc(90vh-120px)] px-8 py-6 scrollbar-hide",children:[a.jsx("p",{className:"text-gray-700 mb-6 leading-relaxed",children:"This Service Level Agreement defines the service standards, availability commitments, support expectations, and responsibilities associated with the use of Sari-Sari CRM."}),a.jsx("div",{className:"space-y-6",children:n.map((s,r)=>a.jsxs("div",{className:"border-l-4 border-accent pl-6 py-2",children:[a.jsxs("h3",{className:"text-xl font-semibold text-secondary mb-2",children:[s.number,". ",s.title]}),s.content.map((i,o)=>a.jsx("p",{className:"text-gray-700 mb-2 leading-relaxed whitespace-pre-line text-sm",children:i},o))]},r))}),a.jsx("div",{className:"mt-8 pt-6 mb-10 border-t border-gray-200",children:a.jsx("p",{className:"text-gray-600 text-xs leading-relaxed text-center",children:"This SLA may be updated to reflect service improvements or operational changes. Continued use of the CRM indicates acceptance of updates."})})]}),a.jsx("div",{className:"sticky bottom-0 bg-gray-50 px-8 py-4 border-t border-gray-200",children:a.jsx("button",{onClick:t,className:"w-full bg-accent text-white px-6 py-3 rounded-lg font-semibold hover:bg-secondary transition-colors",children:"Close"})})]})})},Tue=({isOpen:e,onClose:t})=>{if(!e)return null;const n=[{number:"1",title:"Data Privacy Compliance",content:["Our platform is built to align with applicable data protection regulations, including:",` Philippine Data Privacy Act (RA 10173)
 Applicable international privacy standards where required`,"We support lawful collection, processing, and storage of business and personal information handled within the CRM."]},{number:"2",title:"Access & Confidentiality Controls",content:["We enforce role-based access controls to ensure that only authorized users within an organization can view or manage business data such as leads, contacts, accounts, deals, and quotes.","Developer and internal access is restricted to system maintenance and operational support under controlled conditions."]},{number:"3",title:"Security Practices",content:["We implement reasonable administrative, technical, and organizational safeguards designed to:",` Protect data confidentiality
 Prevent unauthorized access
 Maintain system integrity
 Support operational reliability`,"Security measures are reviewed and improved as part of ongoing system maintenance."]},{number:"4",title:"Operational Compliance",content:["The CRM follows structured operational processes to support:",` System availability and maintenance standards
 Incident management and issue resolution
 Data handling accountability
 Responsible service delivery`]},{number:"5",title:"Continuous Improvement",content:["Compliance and security practices are regularly evaluated to adapt to evolving regulatory expectations and technology standards."]}];return a.jsx("div",{className:"fixed inset-0 bg-black/40 bg-opacity-40 z-50 flex items-center justify-center p-4",onClick:t,children:a.jsxs("div",{className:"bg-white rounded-lg max-w-5xl w-full max-h-[90vh] overflow-hidden",onClick:s=>s.stopPropagation(),children:[a.jsxs("div",{className:"sticky top-0 bg-secondary text-white px-8 py-6 flex items-center justify-between border-b border-accent",children:[a.jsx("div",{children:a.jsx("h2",{className:"text-3xl font-bold",children:"Compliance Standards & Commitments"})}),a.jsx("button",{onClick:t,className:"text-white hover:text-accent transition-colors text-4xl leading-none",children:""})]}),a.jsxs("div",{className:"overflow-y-auto max-h-[calc(90vh-120px)] px-8 py-6 scrollbar-hide",children:[a.jsx("p",{className:"text-gray-700 mb-6 leading-relaxed",children:"Sari-Sari CRM is designed to support responsible business data management while aligning with recognized privacy, security, and operational best practices. We are committed to maintaining safeguards that protect customer and organizational information."}),a.jsx("div",{className:"space-y-6",children:n.map((s,r)=>a.jsxs("div",{className:"border-l-4 border-accent pl-6 py-2",children:[a.jsxs("h3",{className:"text-xl font-semibold text-secondary mb-2",children:[s.number,". ",s.title]}),s.content.map((i,o)=>a.jsx("p",{className:"text-gray-700 mb-2 leading-relaxed whitespace-pre-line text-sm",children:i},o))]},r))}),a.jsx("div",{className:"mt-8 pt-6 mb-10 border-t border-gray-200",children:a.jsx("p",{className:"text-gray-600 text-xs leading-relaxed text-center",children:"Compliance and security practices are regularly evaluated to adapt to evolving regulatory expectations and technology standards."})})]}),a.jsx("div",{className:"sticky bottom-0 bg-gray-50 px-8 py-4 border-t border-gray-200",children:a.jsx("button",{onClick:t,className:"w-full bg-accent text-white px-6 py-3 rounded-lg font-semibold hover:bg-secondary transition-colors",children:"Close"})})]})})},kue=()=>a.jsx("header",{className:"bg-secondary text-white py-4 border-b border-accent",children:a.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"flex items-center justify-between py-3",children:[a.jsxs(ld,{to:"/",className:"text-2xl font-bold",children:["Sari-Sari ",a.jsx("span",{className:"text-accent",children:"CRM"})]}),a.jsxs("nav",{className:"flex space-x-8",children:[a.jsx(ld,{to:"/resources",className:"hover:text-accent transition-colors",children:"Resources"}),a.jsx(ld,{to:"/legal",className:"hover:text-accent transition-colors",children:"Legal"})]})]})})}),Eue=()=>{const[e,t]=f.useState(!1),[n,s]=f.useState(!1),[r,i]=f.useState(!1),[o,l]=f.useState(!1);f.useEffect(()=>{document.title="Legal - Sari-Sari CRM"},[]);const c=[{title:"Terms",description:"Our terms of service and conditions of use.",action:()=>t(!0)},{title:"Privacy",description:"How we protect and handle your personal data.",action:()=>s(!0)},{title:"Service Level Agreement (SLA)",description:"Service level agreements and guarantees.",action:()=>i(!0)},{title:"Compliance",description:"Our compliance standards.",action:()=>l(!0)}];return a.jsxs("div",{className:"font-manrope",children:[a.jsx(kue,{}),a.jsx(Sue,{isOpen:e,onClose:()=>t(!1)}),a.jsx(_ue,{isOpen:n,onClose:()=>s(!1)}),a.jsx(Aue,{isOpen:r,onClose:()=>i(!1)}),a.jsx(Tue,{isOpen:o,onClose:()=>l(!1)}),a.jsx("main",{className:"bg-paper-white min-h-screen py-16",children:a.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:[a.jsx("h1",{className:"text-5xl font-bold text-secondary mb-4",children:"Legal"}),a.jsx("p",{className:"text-lg text-secondary mb-12",children:"Important legal information and policies"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:c.map((u,d)=>a.jsxs("div",{className:"p-6 bg-white border border-gray-200 rounded-lg shadow-md hover:shadow-lg transition-shadow",children:[a.jsx("h3",{className:"text-2xl font-semibold text-secondary mb-2",children:u.title}),a.jsx("p",{className:"text-gray-600 mb-4",children:u.description}),u.action?a.jsx("button",{onClick:u.action,className:"text-accent font-semibold hover:text-secondary transition-colors",children:"Read More "}):a.jsx("a",{href:u.link,className:"text-accent font-semibold hover:text-secondary transition-colors",children:"Read More "})]},d))})]})})]})},Mj=e=>{const t="https://crm.sari-sari.com";try{const n=new URL(t),s=n.protocol==="https:"?"wss":"ws",r=n.hostname,i=n.port||(n.protocol==="https:"?443:80),o=`${s}://${r}:${i}/ws/notifications?user_id=${e}`;return console.log(" WebSocket URL:",o),o}catch(n){return console.error("Error parsing API URL:",n),`ws://localhost:8000/ws/notifications?user_id=${e}`}};function Lue({toggleSidebar:e}){const[t,n]=f.useState(!1),[s,r]=f.useState(!1),[i,o]=f.useState([]),[l,c]=f.useState(0),u=f.useRef(null),d=f.useRef(null),h=ta(),p=kt(),{logout:x}=Ks(),{user:v,fetchUser:j}=Vt(),N={"/admin/dashboard":"Dashboard","/admin/accounts":"Accounts","/admin/contacts":"Contacts","/reports":"Reports","/leads":"Leads","/admin/Audit":"Audit","/admin/targets":"Targets","/admin/leads":"Leads","/admin/quotes":"Quotes","/admin/users":"Users","/admin/deals":"Deals"}[h.pathname]||"Admin Panel";return f.useEffect(()=>{const w=()=>{j()};return window.addEventListener("userProfileUpdated",w),()=>{window.removeEventListener("userProfileUpdated",w)}},[j]),f.useEffect(()=>{if(!v?.id)return;const w=Mj(v.id);console.log(" Connecting to WebSocket:",w);const S=new WebSocket(w);let _;const k=()=>{_=setTimeout(()=>{console.log(" Attempting WebSocket reconnection...")},3e3)};return S.onopen=()=>{console.log(" Admin WS Connected"),clearTimeout(_)},S.onmessage=T=>{try{const A=JSON.parse(T.data);console.log(" Notification received:",A),o(E=>[A,...E]),c(E=>E+1)}catch(A){console.error("Error parsing notification:",A)}},S.onerror=T=>{console.error(" Admin WS Error:",T)},S.onclose=()=>{console.log(" Admin WS Disconnected"),k()},()=>{clearTimeout(_),S&&S.readyState===WebSocket.OPEN&&S.close()}},[v?.id]),f.useEffect(()=>{function w(S){u.current&&!u.current.contains(S.target)&&n(!1),d.current&&!d.current.contains(S.target)&&r(!1)}return document.addEventListener("mousedown",w),()=>document.removeEventListener("mousedown",w)},[]),a.jsxs("header",{className:"flex justify-between items-center bg-white shadow px-4 sm:px-6 py-3 border-b relative",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("button",{onClick:e,className:"lg:hidden text-gray-700 hover:text-gray-900",children:a.jsx(th,{className:"text-2xl"})}),v?.company?.company_logo&&a.jsx("img",{src:v.company.company_logo,alt:"Company Logo",className:"w-20 h-10 object-contain rounded"}),a.jsx("h1",{className:"text-lg font-semibold text-gray-800",children:N})]}),a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs("div",{className:"relative",ref:d,children:[a.jsxs("button",{onClick:()=>r(!s),className:"relative text-gray-600 hover:text-gray-800 transition",children:[a.jsx(mx,{className:"text-xl"}),l>0&&a.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-[10px] w-4 h-4 flex items-center justify-center rounded-full font-semibold",children:l})]}),s&&a.jsxs("div",{className:"absolute right-0 mt-3 w-80 bg-white rounded-xl shadow-lg border z-50 overflow-hidden animate-fade-in",children:[a.jsxs("div",{className:"p-3 border-b bg-gray-50 flex justify-between items-center",children:[a.jsx("h3",{className:"font-semibold text-gray-800 text-sm",children:"Notifications"}),a.jsx("button",{onClick:()=>{o([]),c(0)},className:"text-xs text-blue-600 hover:underline",children:"Clear"})]}),a.jsx("div",{className:"max-h-60 overflow-y-auto",children:i.length>0?i.map((w,S)=>a.jsx("div",{className:"p-3 border-b text-sm hover:bg-gray-50 cursor-pointer",children:w.title||w.message||"New Update"},S)):a.jsx("div",{className:"p-4 text-center text-gray-500 text-xs",children:"No notifications"})})]})]}),a.jsxs("div",{className:"relative",ref:u,children:[a.jsxs("button",{onClick:()=>n(!t),className:"flex items-center gap-2 cursor-pointer hover:bg-gray-100 px-2 py-1 rounded",children:[a.jsx("img",{src:v?.profile_picture||"https://via.placeholder.com/40",alt:"Profile",className:"w-8 aspect-square object-cover rounded-full"}),a.jsxs("span",{className:"hidden lg:inline text-sm font-medium text-gray-700",children:[v?.first_name," ",v?.last_name]})]}),t&&a.jsxs("div",{className:"absolute right-0 mt-2 w-64 bg-white shadow-xl rounded-xl border border-gray-200 z-50 p-4",children:[a.jsxs("div",{className:"flex flex-col items-center text-center space-y-3",children:[a.jsx("img",{src:v?.profile_picture||"https://via.placeholder.com/80",alt:"Profile",className:"w-16 h-16 rounded-full object-cover"}),a.jsxs("div",{children:[a.jsxs("h2",{className:"text-gray-800 font-semibold text-sm",children:[v?.first_name," ",v?.middle_name," ",v?.last_name]}),a.jsx("p",{className:"text-[11px] text-gray-600 font-light w-full truncate",children:"Admin"})]})]}),a.jsxs("div",{className:"mt-6 space-y-1 px-4 text-left",children:[a.jsx("button",{onClick:()=>{p("/admin/users"),n(!1)},className:"block w-full text-sm text-gray-700 hover:bg-gray-50 py-1 rounded text-left",children:"Invite Your Team"}),a.jsx("button",{onClick:()=>{p("/admin/manage-account"),n(!1)},className:"block w-full text-sm text-gray-700 hover:bg-gray-50 py-1 rounded text-left",children:"Manage Your Account"}),a.jsx("button",{onClick:()=>{p("/admin/help"),n(!1)},className:"block w-full text-sm text-gray-700 hover:bg-gray-50 py-1 rounded text-left",children:"Help"}),a.jsx("div",{className:"border-t border-gray-200 my-2"}),a.jsx("button",{onClick:x,className:"block w-full text-sm text-red-600 hover:text-red-700 hover:bg-gray-50 py-2 rounded text-left",children:"Logout"})]})]})]})]})]})}function Pue(){const[e,t]=f.useState(!1),[n,s]=f.useState(!1),[r,i]=f.useState(!1),[o,l]=f.useState(!1),c=ta(),{user:u}=Vt();f.useEffect(()=>{u&&console.log("Fetched user:",u)},[u]),f.useEffect(()=>{document.title="Admin Panel | Sari-Sari CRM"},[]);const h=["/admin/accounts","/admin/contacts","/admin/leads","/admin/deals","/admin/quotes","/admin/targets"].includes(c.pathname);f.useEffect(()=>{h&&t(!0)},[c.pathname]);const p="flex items-center gap-3 px-3 py-2 rounded-lg bg-white text-[#1e293b] font-semibold shadow-sm",x="flex items-center gap-3 px-3 py-2 rounded-lg text-gray-300 hover:bg-[#334155] hover:text-white transition";return a.jsxs("div",{className:"flex h-screen bg-gray-100 overflow-hidden",children:[a.jsxs("div",{className:`fixed top-0 left-0 h-screen w-64 bg-[#1e293b] text-white flex flex-col shadow-lg transform transition-transform duration-300 z-50
          ${o?"translate-x-0":"-translate-x-full"} lg:translate-x-0`,children:[a.jsxs("div",{className:"px-4 py-3 bg-[#fbbf24] leading-none",children:[a.jsxs("p",{className:"text-gray-900 font-bold text-lg m-0 p-0",children:[" Sari-Sari.CRM"," ",a.jsx("span",{className:"text-[12px] text-gray-700 font-medium align-bottom",children:"v2"})]}),u&&u.company&&a.jsx("p",{className:"text-[12px] text-gray-600 font-medium w-full truncate",children:u.company.company_name})]}),a.jsxs("nav",{className:"flex-1 overflow-y-auto p-4 space-y-2 hide-scrollbar",children:[a.jsxs(Ft,{to:"/admin/dashboard",className:({isActive:v})=>v?p:x,children:[a.jsx(eh,{className:"text-lg"}),a.jsx("span",{children:"Dashboard"})]}),a.jsxs("div",{children:[a.jsxs("button",{className:"w-full px-3 py-2 flex justify-between items-center text-sm font-medium text-gray-300 hover:bg-[#334155] rounded-lg transition",onClick:()=>t(!e),children:[a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx(sa,{className:"text-lg"}),"Sales"]}),a.jsx(Pt,{className:`transition-transform ${e?"rotate-180":""}`})]}),e&&a.jsxs("div",{className:"ml-6 mt-2 space-y-1",children:[a.jsxs(Ft,{to:"/admin/accounts",className:({isActive:v})=>v?p:x,children:[a.jsx(ac,{})," Accounts"]}),a.jsxs(Ft,{to:"/admin/contacts",className:({isActive:v})=>v?p:x,children:[a.jsx(ra,{})," Contacts"]}),a.jsxs(Ft,{to:"/admin/leads",className:({isActive:v})=>v?p:x,children:[a.jsx(Xa,{})," Leads"]}),a.jsxs(Ft,{to:"/admin/deals",className:({isActive:v})=>v?p:x,children:[a.jsx(sa,{})," Deals"]}),a.jsxs(Ft,{to:"/admin/quotes",className:({isActive:v})=>v?p:x,children:[a.jsx(ia,{})," Quotes"]}),a.jsxs(Ft,{to:"/admin/targets",className:({isActive:v})=>v?p:x,children:[a.jsx(fr,{})," Targets"]})]})]}),a.jsxs("div",{children:[a.jsxs("button",{className:"w-full px-3 py-2 flex justify-between items-center text-sm font-medium text-gray-300 hover:bg-[#334155] rounded-lg transition",onClick:()=>s(!n),children:[a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx(ks,{className:"text-lg"}),"Activity"]}),a.jsx(Pt,{className:`transition-transform ${n?"rotate-180":""}`})]}),n&&a.jsxs("div",{className:"ml-6 mt-2 space-y-1",children:[a.jsxs(Ft,{to:"/admin/tasks",className:({isActive:v})=>v?p:x,children:[a.jsx(Qt,{})," Tasks"]}),a.jsxs(Ft,{to:"/admin/meetings",className:({isActive:v})=>v?p:x,children:[a.jsx(Ot,{})," Meetings"]}),a.jsxs(Ft,{to:"/admin/calls",className:({isActive:v})=>v?p:x,children:[a.jsx(Fs,{})," Calls"]}),a.jsxs(Ft,{to:"/admin/audit",className:({isActive:v})=>v?p:x,children:[a.jsx(ks,{})," Audit"]})]})]}),a.jsx("div",{children:a.jsx(Ft,{to:"/admin/territory",className:({isActive:v})=>v?p:x,children:a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx(tc,{className:"text-lg"}),"Territory"]})})}),a.jsxs("div",{children:[a.jsxs("button",{className:"w-full px-3 py-2 flex justify-between items-center text-sm font-medium text-gray-300 hover:bg-[#334155] rounded-lg transition",onClick:()=>i(!r),children:[a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx(SL,{className:"text-lg"}),"Settings"]}),a.jsx(Pt,{className:`transition-transform ${r?"rotate-180":""}`})]}),r&&a.jsxs("div",{className:"ml-6 mt-2 space-y-1",children:[a.jsxs(Ft,{to:"/admin/users",className:({isActive:v})=>v?p:x,children:[a.jsx(Za,{})," Users"]}),a.jsxs(Ft,{to:"/admin/manage-account",className:({isActive:v})=>v?p:x,children:[a.jsx(ra,{}),"Your Profile"]}),a.jsxs(Ft,{to:"/admin/company-details",className:({isActive:v})=>v?p:x,children:[a.jsx(xj,{}),"Organization"]})]})]})]}),a.jsxs("div",{className:"px-4 py-3 text-xs text-gray-400 border-t border-gray-700",children:[" ",new Date().getFullYear()," Sari-Sari CRM"]})]}),o&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 lg:hidden",onClick:()=>l(!1)}),a.jsxs("div",{className:"flex-1 flex flex-col lg:ml-64 overflow-hidden",children:[a.jsx(Lue,{toggleSidebar:()=>l(!o)}),a.jsx("main",{className:"flex-1 p-6 overflow-auto hide-scrollbar",style:{backgroundColor:"#fffeee"},children:a.jsx(Xf,{})})]})]})}function Due(e){return Dt({attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M160 0c17.7 0 32 14.3 32 32l0 35.7c1.6 .2 3.1 .4 4.7 .7c.4 .1 .7 .1 1.1 .2l48 8.8c17.4 3.2 28.9 19.9 25.7 37.2s-19.9 28.9-37.2 25.7l-47.5-8.7c-31.3-4.6-58.9-1.5-78.3 6.2s-27.2 18.3-29 28.1c-2 10.7-.5 16.7 1.2 20.4c1.8 3.9 5.5 8.3 12.8 13.2c16.3 10.7 41.3 17.7 73.7 26.3l2.9 .8c28.6 7.6 63.6 16.8 89.6 33.8c14.2 9.3 27.6 21.9 35.9 39.5c8.5 17.9 10.3 37.9 6.4 59.2c-6.9 38-33.1 63.4-65.6 76.7c-13.7 5.6-28.6 9.2-44.4 11l0 33.4c0 17.7-14.3 32-32 32s-32-14.3-32-32l0-34.9c-.4-.1-.9-.1-1.3-.2l-.2 0s0 0 0 0c-24.4-3.8-64.5-14.3-91.5-26.3c-16.1-7.2-23.4-26.1-16.2-42.2s26.1-23.4 42.2-16.2c20.9 9.3 55.3 18.5 75.2 21.6c31.9 4.7 58.2 2 76-5.3c16.9-6.9 24.6-16.9 26.8-28.9c1.9-10.6 .4-16.7-1.3-20.4c-1.9-4-5.6-8.4-13-13.3c-16.4-10.7-41.5-17.7-74-26.3l-2.8-.7s0 0 0 0C119.4 279.3 84.4 270 58.4 253c-14.2-9.3-27.5-22-35.8-39.6c-8.4-17.9-10.1-37.9-6.1-59.2C23.7 116 52.3 91.2 84.8 78.3c13.3-5.3 27.9-8.9 43.2-11L128 32c0-17.7 14.3-32 32-32z"},child:[]}]})(e)}function Oue(e){return Dt({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M544 248l0 3.3 69.7-69.7c21.9-21.9 21.9-57.3 0-79.2L535.6 24.4c-21.9-21.9-57.3-21.9-79.2 0L416.3 64.5c-2.7-.3-5.5-.5-8.3-.5L296 64c-37.1 0-67.6 28-71.6 64l-.4 0 0 120c0 22.1 17.9 40 40 40s40-17.9 40-40l0-72c0 0 0-.1 0-.1l0-15.9 16 0 136 0c0 0 0 0 .1 0l7.9 0c44.2 0 80 35.8 80 80l0 8zM336 192l0 56c0 39.8-32.2 72-72 72s-72-32.2-72-72l0-118.6c-35.9 6.2-65.8 32.3-76 68.2L99.5 255.2 26.3 328.4c-21.9 21.9-21.9 57.3 0 79.2l78.1 78.1c21.9 21.9 57.3 21.9 79.2 0l37.7-37.7c.9 0 1.8 .1 2.7 .1l160 0c26.5 0 48-21.5 48-48c0-5.6-1-11-2.7-16l2.7 0c26.5 0 48-21.5 48-48c0-12.8-5-24.4-13.2-33c25.7-5 45.1-27.6 45.2-54.8l0-.4c-.1-30.8-25.1-55.8-56-55.8c0 0 0 0 0 0l-120 0z"},child:[]}]})(e)}function Mue(e){return Dt({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M64 32C46.3 32 32 46.3 32 64l0 64c-17.7 0-32 14.3-32 32s14.3 32 32 32l0 32c-17.7 0-32 14.3-32 32s14.3 32 32 32l0 64 0 96c0 17.7 14.3 32 32 32s32-14.3 32-32l0-64 80 0c68.4 0 127.7-39 156.8-96l19.2 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-.7 0c.5-5.3 .7-10.6 .7-16s-.2-10.7-.7-16l.7 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-19.2 0C303.7 71 244.4 32 176 32L64 32zm190.4 96L96 128l0-32 80 0c30.5 0 58.2 12.2 78.4 32zM96 192l190.9 0c.7 5.2 1.1 10.6 1.1 16s-.4 10.8-1.1 16L96 224l0-32zm158.4 96c-20.2 19.8-47.9 32-78.4 32l-80 0 0-32 158.4 0z"},child:[]}]})(e)}function Ti({props:e,name:t}){return Tce({props:e,name:t,defaultTheme:UL,themeId:Oj})}function Bl(e){const{elementType:t,externalSlotProps:n,ownerState:s,skipResolvingSlotProps:r=!1,...i}=e,o=r?{}:Z9(n,s),{props:l,internalRef:c}=J9({...i,externalSlotProps:o}),u=Uo(c,o?.ref,e.additionalProps?.ref);return X9(t,{...l,ref:u},s)}function ps(e){const t=f.useRef(e);return is(()=>{t.current=e}),f.useRef((...n)=>(0,t.current)(...n)).current}var Pv=Symbol("NOT_FOUND");function Iue(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function $ue(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function Rue(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(n=>typeof n=="function")){const n=e.map(s=>typeof s=="function"?`function ${s.name||"unnamed"}()`:typeof s).join(", ");throw new TypeError(`${t}[${n}]`)}}var E$=e=>Array.isArray(e)?e:[e];function zue(e){const t=Array.isArray(e[0])?e[0]:e;return Rue(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function Fue(e,t){const n=[],{length:s}=e;for(let r=0;r<s;r++)n.push(e[r].apply(null,t));return n}function Uue(e){let t;return{get(n){return t&&e(t.key,n)?t.value:Pv},put(n,s){t={key:n,value:s}},getEntries(){return t?[t]:[]},clear(){t=void 0}}}function Bue(e,t){let n=[];function s(l){const c=n.findIndex(u=>t(l,u.key));if(c>-1){const u=n[c];return c>0&&(n.splice(c,1),n.unshift(u)),u.value}return Pv}function r(l,c){s(l)===Pv&&(n.unshift({key:l,value:c}),n.length>e&&n.pop())}function i(){return n}function o(){n=[]}return{get:s,put:r,getEntries:i,clear:o}}var Hue=(e,t)=>e===t;function que(e){return function(n,s){if(n===null||s===null||n.length!==s.length)return!1;const{length:r}=n;for(let i=0;i<r;i++)if(!e(n[i],s[i]))return!1;return!0}}function Gue(e,t){const n=typeof t=="object"?t:{equalityCheck:t},{equalityCheck:s=Hue,maxSize:r=1,resultEqualityCheck:i}=n,o=que(s);let l=0;const c=r<=1?Uue(o):Bue(r,o);function u(){let d=c.get(arguments);if(d===Pv){if(d=e.apply(null,arguments),l++,i){const p=c.getEntries().find(x=>i(x.value,d));p&&(d=p.value,l!==0&&l--)}c.put(arguments,d)}return d}return u.clearCache=()=>{c.clear(),u.resetResultsCount()},u.resultsCount=()=>l,u.resetResultsCount=()=>{l=0},u}var Wue=class{constructor(e){this.value=e}deref(){return this.value}},Vue=typeof WeakRef<"u"?WeakRef:Wue,Yue=0,L$=1;function Wy(){return{s:Yue,v:void 0,o:null,p:null}}function sq(e,t={}){let n=Wy();const{resultEqualityCheck:s}=t;let r,i=0;function o(){let l=n;const{length:c}=arguments;for(let h=0,p=c;h<p;h++){const x=arguments[h];if(typeof x=="function"||typeof x=="object"&&x!==null){let v=l.o;v===null&&(l.o=v=new WeakMap);const j=v.get(x);j===void 0?(l=Wy(),v.set(x,l)):l=j}else{let v=l.p;v===null&&(l.p=v=new Map);const j=v.get(x);j===void 0?(l=Wy(),v.set(x,l)):l=j}}const u=l;let d;if(l.s===L$)d=l.v;else if(d=e.apply(null,arguments),i++,s){const h=r?.deref?.()??r;h!=null&&s(h,d)&&(d=h,i!==0&&i--),r=typeof d=="object"&&d!==null||typeof d=="function"?new Vue(d):d}return u.s=L$,u.v=d,d}return o.clearCache=()=>{n=Wy(),o.resetResultsCount()},o.resultsCount=()=>i,o.resetResultsCount=()=>{i=0},o}function rq(e,...t){const n=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,s=(...r)=>{let i=0,o=0,l,c={},u=r.pop();typeof u=="object"&&(c=u,u=r.pop()),Iue(u,`createSelector expects an output function after the inputs, but received: [${typeof u}]`);const d={...n,...c},{memoize:h,memoizeOptions:p=[],argsMemoize:x=sq,argsMemoizeOptions:v=[]}=d,j=E$(p),y=E$(v),N=zue(r),w=h(function(){return i++,u.apply(null,arguments)},...j),S=x(function(){o++;const k=Fue(N,arguments);return l=w.apply(null,k),l},...y);return Object.assign(S,{resultFunc:u,memoizedResultFunc:w,dependencies:N,dependencyRecomputations:()=>o,resetDependencyRecomputations:()=>{o=0},lastResult:()=>l,recomputations:()=>i,resetRecomputations:()=>{i=0},memoize:h,argsMemoize:x})};return Object.assign(s,{withTypes:()=>s}),s}var ut=rq(sq),Que=Object.assign((e,t=ut)=>{$ue(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const n=Object.keys(e),s=n.map(i=>e[i]);return t(s,(...i)=>i.reduce((o,l,c)=>(o[n[c]]=l,o),{}))},{withTypes:()=>Que});const Kue=rq({memoize:Gue,memoizeOptions:{maxSize:1,equalityCheck:Object.is}}),Lt=(e,t,n,s,r,i,o,l,...c)=>{if(c.length>0)throw new Error("Unsupported number of selectors");let u;if(e&&t&&n&&s&&r&&i&&o&&l)u=(d,h,p,x)=>{const v=e(d,h,p,x),j=t(d,h,p,x),y=n(d,h,p,x),N=s(d,h,p,x),w=r(d,h,p,x),S=i(d,h,p,x),_=o(d,h,p,x);return l(v,j,y,N,w,S,_,h,p,x)};else if(e&&t&&n&&s&&r&&i&&o)u=(d,h,p,x)=>{const v=e(d,h,p,x),j=t(d,h,p,x),y=n(d,h,p,x),N=s(d,h,p,x),w=r(d,h,p,x),S=i(d,h,p,x);return o(v,j,y,N,w,S,h,p,x)};else if(e&&t&&n&&s&&r&&i)u=(d,h,p,x)=>{const v=e(d,h,p,x),j=t(d,h,p,x),y=n(d,h,p,x),N=s(d,h,p,x),w=r(d,h,p,x);return i(v,j,y,N,w,h,p,x)};else if(e&&t&&n&&s&&r)u=(d,h,p,x)=>{const v=e(d,h,p,x),j=t(d,h,p,x),y=n(d,h,p,x),N=s(d,h,p,x);return r(v,j,y,N,h,p,x)};else if(e&&t&&n&&s)u=(d,h,p,x)=>{const v=e(d,h,p,x),j=t(d,h,p,x),y=n(d,h,p,x);return s(v,j,y,h,p,x)};else if(e&&t&&n)u=(d,h,p,x)=>{const v=e(d,h,p,x),j=t(d,h,p,x);return n(v,j,h,p,x)};else if(e&&t)u=(d,h,p,x)=>{const v=e(d,h,p,x);return t(v,h,p,x)};else if(e)u=e;else throw new Error("Missing arguments");return u},Ij=e=>(...t)=>{const n=new WeakMap;let s=1;const r=t[t.length-1],i=t.length-1||1,o=Math.max(r.length-i,0);if(o>3)throw new Error("Unsupported number of arguments");return(c,u,d,h)=>{let p=c.__cacheKey__;p||(p={id:s},c.__cacheKey__=p,s+=1);let x=n.get(p);if(!x){const v=t.length===1?[N=>N,r]:t;let j=t;const y=[void 0,void 0,void 0];switch(o){case 0:break;case 1:{j=[...v.slice(0,-1),()=>y[0],r];break}case 2:{j=[...v.slice(0,-1),()=>y[0],()=>y[1],r];break}case 3:{j=[...v.slice(0,-1),()=>y[0],()=>y[1],()=>y[2],r];break}default:throw new Error("Unsupported number of arguments")}e&&(j=[...j,e]),x=Kue(...j),x.selectorArgs=y,n.set(p,x)}switch(o){case 3:x.selectorArgs[2]=h;case 2:x.selectorArgs[1]=d;case 1:x.selectorArgs[0]=u}switch(o){case 0:return x(c);case 1:return x(c,u);case 2:return x(c,u,d);case 3:return x(c,u,d,h);default:throw new Error("unreachable")}}},$n=Ij();var u2={exports:{}},m2={},f2={exports:{}},h2={};var P$;function Xue(){if(P$)return h2;P$=1;var e=Vf();function t(h,p){return h===p&&(h!==0||1/h===1/p)||h!==h&&p!==p}var n=typeof Object.is=="function"?Object.is:t,s=e.useState,r=e.useEffect,i=e.useLayoutEffect,o=e.useDebugValue;function l(h,p){var x=p(),v=s({inst:{value:x,getSnapshot:p}}),j=v[0].inst,y=v[1];return i(function(){j.value=x,j.getSnapshot=p,c(j)&&y({inst:j})},[h,x,p]),r(function(){return c(j)&&y({inst:j}),h(function(){c(j)&&y({inst:j})})},[h]),o(x),x}function c(h){var p=h.getSnapshot;h=h.value;try{var x=p();return!n(h,x)}catch{return!0}}function u(h,p){return p()}var d=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?u:l;return h2.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:d,h2}var D$;function Zue(){return D$||(D$=1,f2.exports=Xue()),f2.exports}var O$;function Jue(){if(O$)return m2;O$=1;var e=Vf(),t=Zue();function n(u,d){return u===d&&(u!==0||1/u===1/d)||u!==u&&d!==d}var s=typeof Object.is=="function"?Object.is:n,r=t.useSyncExternalStore,i=e.useRef,o=e.useEffect,l=e.useMemo,c=e.useDebugValue;return m2.useSyncExternalStoreWithSelector=function(u,d,h,p,x){var v=i(null);if(v.current===null){var j={hasValue:!1,value:null};v.current=j}else j=v.current;v=l(function(){function N(T){if(!w){if(w=!0,S=T,T=p(T),x!==void 0&&j.hasValue){var A=j.value;if(x(A,T))return _=A}return _=T}if(A=_,s(S,T))return A;var E=p(T);return x!==void 0&&x(A,E)?(S=T,A):(S=T,_=E)}var w=!1,S,_,k=h===void 0?null:h;return[function(){return N(d())},k===null?void 0:function(){return N(k())}]},[d,h,p,x]);var y=r(u,v[0],v[1]);return o(function(){j.hasValue=!0,j.value=y},[y]),c(y),y},m2}var M$;function eme(){return M$||(M$=1,u2.exports=Jue()),u2.exports}var iq=eme();function tme(e,t,n,s,r){const i=o=>t(o,n,s,r);return iq.useSyncExternalStoreWithSelector(e.subscribe,e.getSnapshot,e.getSnapshot,i)}const I$={};function $j(e,t){const n=f.useRef(I$);return n.current===I$&&(n.current=e(t)),n}const ame=[];function oq(e){f.useEffect(e,ame)}const nme=()=>{};function sme(e,t,n){const s=$j(rme,{store:e,selector:t}).current;s.effect=n,oq(s.onMount)}function rme(e){const{store:t,selector:n}=e;let s=n(t.state);const r={effect:nme,dispose:null,subscribe:()=>{r.dispose??=t.subscribe(i=>{const o=n(i);if(!Object.is(s,o)){const l=s;s=o,r.effect(l,o)}})},onMount:()=>(r.subscribe(),()=>{r.dispose?.(),r.dispose=null})};return r.subscribe(),r}class GL{static create(t){return new GL(t)}constructor(t){this.state=t,this.listeners=new Set,this.updateTick=0}subscribe=t=>(this.listeners.add(t),()=>{this.listeners.delete(t)});getSnapshot=()=>this.state;setState(t){this.state=t,this.updateTick+=1;const n=this.updateTick,s=this.listeners.values();let r;for(;r=s.next(),!r.done;){if(n!==this.updateTick)return;const i=r.value;i(t)}}update(t){for(const n in t)if(!Object.is(this.state[n],t[n])){this.setState(at({},this.state,t));return}}set(t,n){Object.is(this.state[t],n)||this.setState(at({},this.state,{[t]:n}))}}const Rj=({params:e,store:t})=>{f.useEffect(()=>{t.set("animation",at({},t.state.animation,{skip:e.skipAnimation}))},[t,e.skipAnimation]);const n=f.useCallback(()=>{let s=!1;return t.set("animation",at({},t.state.animation,{skipAnimationRequests:t.state.animation.skipAnimationRequests+1})),()=>{s||(s=!0,t.set("animation",at({},t.state.animation,{skipAnimationRequests:t.state.animation.skipAnimationRequests-1})))}},[t]);return is(()=>{if(typeof window>"u"||!window?.matchMedia)return;let r;const i=l=>{l.matches?r=n():r?.()},o=window.matchMedia("(prefers-reduced-motion)");return i(o),o.addEventListener("change",i),()=>{o.removeEventListener("change",i)}},[n,t]),{instance:{disableAnimation:n}}};Rj.params={skipAnimation:!0};Rj.getDefaultizedParams=({params:e})=>at({},e,{skipAnimation:e.skipAnimation??!1});Rj.getInitialState=({skipAnimation:e})=>({animation:{skip:e,skipAnimationRequests:0}});const ime=e=>e.animation,ome=Lt(ime,e=>e.skip||e.skipAnimationRequests>0);function lme(e,t){const n=f.useRef(!0);f.useEffect(()=>{if(n.current){n.current=!1;return}return e()},t)}function xk(e){return e&&e.ownerDocument||document}function cme(e){return xk(e).defaultView||window}const Gt=tme,zj="DEFAULT_X_AXIS_KEY",dme="DEFAULT_Y_AXIS_KEY",ume={top:20,bottom:20,left:20,right:20},mme=45,fme=25,lq=20,Qo=e=>e.cartesianAxis?.x,sc=e=>e.cartesianAxis?.y,hme=Lt(sc,function(t){return(t??[]).reduce((n,s)=>s.position==="left"?n+(s.width||0)+(s.zoom?.slider.enabled?s.zoom.slider.size:0):n,0)}),gme=Lt(sc,function(t){return(t??[]).reduce((n,s)=>s.position==="right"?n+(s.width||0)+(s.zoom?.slider.enabled?s.zoom.slider.size:0):n,0)}),pme=Lt(Qo,function(t){return(t??[]).reduce((n,s)=>s.position==="top"?n+(s.height||0)+(s.zoom?.slider.enabled?s.zoom.slider.size:0):n,0)}),xme=Lt(Qo,function(t){return(t??[]).reduce((n,s)=>s.position==="bottom"?n+(s.height||0)+(s.zoom?.slider.enabled?s.zoom.slider.size:0):n,0)}),yme=$n(hme,gme,pme,xme,function(t,n,s,r){return{left:t,right:n,top:s,bottom:r}}),bx=e=>e.dimensions,bme=e=>e.dimensions.margin,wr=$n(bx,bme,yme,function({width:t,height:n},{top:s,right:r,bottom:i,left:o},{left:l,right:c,top:u,bottom:d}){return{width:t-o-r-l-c,left:o+l,right:r+c,height:n-s-i-u-d,top:s+u,bottom:i+d}}),vme=Lt(bx,e=>e.width),wme=Lt(bx,e=>e.height),cq=Lt(bx,e=>e.propsWidth),dq=Lt(bx,e=>e.propsHeight);function jme(e,t){return typeof e=="number"?{top:e,bottom:e,left:e,right:e}:t?at({},t,e):e}const Nme=10,Fj=({params:e,store:t,svgRef:n})=>{const s=e.width!==void 0&&e.height!==void 0,r=f.useRef({displayError:!1,initialCompute:!0,computeRun:0}),[i,o]=f.useState(0),[l,c]=f.useState(0),u=f.useCallback(()=>{const v=n?.current;if(!v)return{};const y=cme(v).getComputedStyle(v),N=Math.floor(parseFloat(y.height))||0,w=Math.floor(parseFloat(y.width))||0;return(t.state.dimensions.width!==w||t.state.dimensions.height!==N)&&t.set("dimensions",{margin:{top:e.margin.top,right:e.margin.right,bottom:e.margin.bottom,left:e.margin.left},width:e.width??w,height:e.height??N,propsWidth:e.width,propsHeight:e.height}),{height:N,width:w}},[t,n,e.height,e.width,e.margin.left,e.margin.right,e.margin.top,e.margin.bottom]);lme(()=>{const v=e.width??t.state.dimensions.width,j=e.height??t.state.dimensions.height;t.set("dimensions",{margin:{top:e.margin.top,right:e.margin.right,bottom:e.margin.bottom,left:e.margin.left},width:v,height:j,propsHeight:e.height,propsWidth:e.width})},[t,e.height,e.width,e.margin.left,e.margin.right,e.margin.top,e.margin.bottom]),f.useEffect(()=>{r.current.displayError=!0},[]),is(()=>{if(s||!r.current.initialCompute||r.current.computeRun>Nme)return;const v=u();v.width!==i||v.height!==l?(r.current.computeRun+=1,v.width!==void 0&&o(v.width),v.height!==void 0&&c(v.height)):r.current.initialCompute&&(r.current.initialCompute=!1)},[l,i,u,s]),is(()=>{if(s)return()=>{};u();const v=n.current;if(typeof ResizeObserver>"u")return()=>{};let j;const y=new ResizeObserver(()=>{j=requestAnimationFrame(()=>{u()})});return v&&y.observe(v),()=>{j&&cancelAnimationFrame(j),v&&y.unobserve(v)}},[u,s,n]);const d=Gt(t,wr),h=f.useCallback(v=>v>=d.left-1&&v<=d.left+d.width,[d.left,d.width]),p=f.useCallback(v=>v>=d.top-1&&v<=d.top+d.height,[d.height,d.top]);return{instance:{isPointInside:f.useCallback((v,j,y)=>y&&"closest"in y&&y.closest("[data-drawing-container]")?!0:h(v)&&p(j),[h,p]),isXInside:h,isYInside:p}}};Fj.params={width:!0,height:!0,margin:!0};Fj.getDefaultizedParams=({params:e})=>at({},e,{margin:jme(e.margin,ume)});Fj.getInitialState=({width:e,height:t,margin:n})=>({dimensions:{margin:n,width:e??0,height:t??0,propsWidth:e,propsHeight:t}});const WL=({params:e,store:t})=>(is(()=>{t.set("experimentalFeatures",e.experimentalFeatures)},[t,e.experimentalFeatures]),{});WL.params={experimentalFeatures:!0};WL.getInitialState=({experimentalFeatures:e})=>({experimentalFeatures:e});const Cme=e=>e.experimentalFeatures,Uj=Lt(Cme,e=>!!e?.preferStrictDomainInLineCharts);let $$=0;const Sme=()=>($$+=1,`mui-chart-${$$}`),VL=({params:e,store:t})=>(f.useEffect(()=>{e.id===void 0||e.id===t.state.id.providedChartId&&t.state.id.chartId!==void 0||t.set("id",at({},t.state.id,{chartId:e.id??Sme()}))},[t,e.id]),{});VL.params={id:!0};VL.getInitialState=({id:e})=>({id:{chartId:e,providedChartId:e}});const _me=e=>e.id,Ame=Lt(_me,e=>e.chartId),Tme=["#4254FB","#FFB422","#FA4F58","#0DBEFF","#22BF75","#FA83B4","#FF7511"],kme=["#495AFB","#FFC758","#F35865","#30C8FF","#44CE8D","#F286B3","#FF8C39"],uq=e=>e==="dark"?kme:Tme,mq=({series:e,colors:t,seriesConfig:n})=>{const s={};return e.forEach((r,i)=>{const o=n[r.type].getSeriesWithDefaultValues(r,i,t),l=o.id;if(s[r.type]===void 0&&(s[r.type]={series:{},seriesOrder:[]}),s[r.type]?.series[l]!==void 0)throw new Error(`MUI X Charts: series' id "${l}" is not unique.`);s[r.type].series[l]=o,s[r.type].seriesOrder.push(l)}),s},Eme=(e,t,n)=>{const s={};return Object.keys(t).forEach(r=>{const i=e[r];i!==void 0&&(s[r]=t[r]?.seriesProcessor?.(i,n)??i)}),s},Bj=({params:e,store:t,seriesConfig:n})=>{const{series:s,dataset:r,theme:i,colors:o}=e,l=f.useRef(!0);return f.useEffect(()=>{if(l.current){l.current=!1;return}t.set("series",at({},t.state.series,{defaultizedSeries:mq({series:s,colors:typeof o=="function"?o(i):o,seriesConfig:n}),dataset:r}))},[o,r,s,i,n,t]),{}};Bj.params={dataset:!0,series:!0,colors:!0,theme:!0};const Lme=[];Bj.getDefaultizedParams=({params:e})=>at({},e,{series:e.series?.length?e.series:Lme,colors:e.colors??uq,theme:e.theme??"light"});Bj.getInitialState=({series:e=[],colors:t,theme:n,dataset:s},r,i)=>({series:{seriesConfig:i,defaultizedSeries:mq({series:e,colors:typeof t=="function"?t(n):t,seriesConfig:i}),dataset:s}});const YL=e=>e.series,Pme=Lt(YL,e=>e.defaultizedSeries),Vr=Lt(YL,e=>e.seriesConfig),Dme=Lt(YL,e=>e.dataset),yn=$n(Pme,Vr,Dme,function(t,n,s){return Eme(t,n,s)}),Ome={abort:!0,animationcancel:!0,animationend:!0,animationiteration:!0,animationstart:!0,auxclick:!0,beforeinput:!0,beforetoggle:!0,blur:!0,cancel:!0,canplay:!0,canplaythrough:!0,change:!0,click:!0,close:!0,compositionend:!0,compositionstart:!0,compositionupdate:!0,contextlost:!0,contextmenu:!0,contextrestored:!0,copy:!0,cuechange:!0,cut:!0,dblclick:!0,drag:!0,dragend:!0,dragenter:!0,dragleave:!0,dragover:!0,dragstart:!0,drop:!0,durationchange:!0,emptied:!0,ended:!0,error:!0,focus:!0,focusin:!0,focusout:!0,formdata:!0,gotpointercapture:!0,input:!0,invalid:!0,keydown:!0,keypress:!0,keyup:!0,load:!0,loadeddata:!0,loadedmetadata:!0,loadstart:!0,lostpointercapture:!0,mousedown:!0,mouseenter:!0,mouseleave:!0,mousemove:!0,mouseout:!0,mouseover:!0,mouseup:!0,paste:!0,pause:!0,play:!0,playing:!0,pointercancel:!0,pointerdown:!0,pointerenter:!0,pointerleave:!0,pointermove:!0,pointerout:!0,pointerover:!0,pointerup:!0,progress:!0,ratechange:!0,reset:!0,resize:!0,scroll:!0,scrollend:!0,securitypolicyviolation:!0,seeked:!0,seeking:!0,select:!0,selectionchange:!0,selectstart:!0,slotchange:!0,stalled:!0,submit:!0,suspend:!0,timeupdate:!0,toggle:!0,touchcancel:!0,touchend:!0,touchmove:!0,touchstart:!0,transitioncancel:!0,transitionend:!0,transitionrun:!0,transitionstart:!0,volumechange:!0,waiting:!0,webkitanimationend:!0,webkitanimationiteration:!0,webkitanimationstart:!0,webkittransitionend:!0,wheel:!0,beforematch:!0,pointerrawupdate:!0};class fq{customData={};constructor(t){if(!t||!t.name)throw new Error("Gesture must be initialized with a valid name.");if(t.name in Ome)throw new Error(`Gesture can't be created with a native event name. Tried to use "${t.name}". Please use a custom name instead.`);this.name=t.name,this.preventDefault=t.preventDefault??!1,this.stopPropagation=t.stopPropagation??!1,this.preventIf=t.preventIf??[],this.requiredKeys=t.requiredKeys??[],this.pointerMode=t.pointerMode??[],this.pointerOptions=t.pointerOptions??{}}init(t,n,s,r){this.element=t,this.pointerManager=n,this.gesturesRegistry=s,this.keyboardManager=r;const i=`${this.name}ChangeOptions`;this.element.addEventListener(i,this.handleOptionsChange);const o=`${this.name}ChangeState`;this.element.addEventListener(o,this.handleStateChange)}handleOptionsChange=t=>{t&&t.detail&&this.updateOptions(t.detail)};updateOptions(t){this.preventDefault=t.preventDefault??this.preventDefault,this.stopPropagation=t.stopPropagation??this.stopPropagation,this.preventIf=t.preventIf??this.preventIf,this.requiredKeys=t.requiredKeys??this.requiredKeys,this.pointerMode=t.pointerMode??this.pointerMode,this.pointerOptions=t.pointerOptions??this.pointerOptions}getBaseConfig(){return{requiredKeys:this.requiredKeys}}getEffectiveConfig(t,n){if(t!=="mouse"&&t!=="touch"&&t!=="pen")return n;const s=this.pointerOptions[t];return s?at({},n,s):n}handleStateChange=t=>{t&&t.detail&&this.updateState(t.detail)};updateState(t){Object.assign(this.state,t)}getTargetElement(t){return this.isActive||this.element===t.target||"contains"in this.element&&this.element.contains(t.target)||"getRootNode"in this.element&&this.element.getRootNode()instanceof ShadowRoot&&t.composedPath().includes(this.element)?this.element:null}set isActive(t){t?this.gesturesRegistry.registerActiveGesture(this.element,this):this.gesturesRegistry.unregisterActiveGesture(this.element,this)}get isActive(){return this.gesturesRegistry.isGestureActive(this.element,this)??!1}shouldPreventGesture(t,n){const s=this.getEffectiveConfig(n,this.getBaseConfig());if(!this.keyboardManager.areKeysPressed(s.requiredKeys))return!0;if(this.preventIf.length===0)return!1;const r=this.gesturesRegistry.getActiveGestures(t);return this.preventIf.some(i=>r[i])}isPointerTypeAllowed(t){return!this.pointerMode||this.pointerMode.length===0?!0:this.pointerMode.includes(t)}destroy(){const t=`${this.name}ChangeOptions`;this.element.removeEventListener(t,this.handleOptionsChange);const n=`${this.name}ChangeState`;this.element.removeEventListener(n,this.handleStateChange)}}class Mme{activeGestures=new Map;registerActiveGesture(t,n){this.activeGestures.has(t)||this.activeGestures.set(t,new Set);const s=this.activeGestures.get(t),r={gesture:n,element:t};s.add(r)}unregisterActiveGesture(t,n){const s=this.activeGestures.get(t);s&&(s.forEach(r=>{r.gesture===n&&s.delete(r)}),s.size===0&&this.activeGestures.delete(t))}getActiveGestures(t){const n=this.activeGestures.get(t);return n?Array.from(n).reduce((s,r)=>(s[r.gesture.name]=!0,s),{}):{}}isGestureActive(t,n){const s=this.activeGestures.get(t);return s?Array.from(s).some(r=>r.gesture===n):!1}destroy(){this.activeGestures.clear()}unregisterElement(t){this.activeGestures.delete(t)}}class Ime{pressedKeys=new Set;constructor(){this.initialize()}initialize(){typeof window>"u"||(window.addEventListener("keydown",this.handleKeyDown),window.addEventListener("keyup",this.handleKeyUp),window.addEventListener("blur",this.clearKeys))}handleKeyDown=t=>{this.pressedKeys.add(t.key)};handleKeyUp=t=>{this.pressedKeys.delete(t.key)};clearKeys=()=>{this.pressedKeys.clear()};areKeysPressed(t){return!t||t.length===0?!0:t.every(n=>n==="ControlOrMeta"?navigator.platform.includes("Mac")?this.pressedKeys.has("Meta"):this.pressedKeys.has("Control"):this.pressedKeys.has(n))}destroy(){typeof window<"u"&&(window.removeEventListener("keydown",this.handleKeyDown),window.removeEventListener("keyup",this.handleKeyUp),window.removeEventListener("blur",this.clearKeys)),this.clearKeys()}}class $me{preventEventInterruption=!0;pointers=new Map;gestureHandlers=new Set;constructor(t){this.root=t.root??document.getRootNode({composed:!0})??document.body,this.touchAction=t.touchAction||"auto",this.passive=t.passive??!1,this.preventEventInterruption=t.preventEventInterruption??!0,this.setupEventListeners()}registerGestureHandler(t){return this.gestureHandlers.add(t),()=>{this.gestureHandlers.delete(t)}}getPointers(){return new Map(this.pointers)}setupEventListeners(){this.touchAction!=="auto"&&(this.root.style.touchAction=this.touchAction),this.root.addEventListener("pointerdown",this.handlePointerEvent,{passive:this.passive}),this.root.addEventListener("pointermove",this.handlePointerEvent,{passive:this.passive}),this.root.addEventListener("pointerup",this.handlePointerEvent,{passive:this.passive}),this.root.addEventListener("pointercancel",this.handlePointerEvent,{passive:this.passive}),this.root.addEventListener("forceCancel",this.handlePointerEvent,{passive:this.passive}),this.root.addEventListener("blur",this.handleInterruptEvents),this.root.addEventListener("contextmenu",this.handleInterruptEvents)}handleInterruptEvents=t=>{if(this.preventEventInterruption&&"pointerType"in t&&t.pointerType==="touch"){t.preventDefault();return}const n=new PointerEvent("forceCancel",{bubbles:!1,cancelable:!1}),s=this.pointers.values().next().value;if(this.pointers.size>0&&s){Object.defineProperties(n,{clientX:{value:s.clientX},clientY:{value:s.clientY},pointerId:{value:s.pointerId},pointerType:{value:s.pointerType}});for(const[r,i]of this.pointers.entries()){const o=at({},i,{type:"forceCancel"});this.pointers.set(r,o)}}this.notifyHandlers(n),this.pointers.clear()};handlePointerEvent=t=>{const{type:n,pointerId:s}=t;if(n==="pointerdown"||n==="pointermove")this.pointers.set(s,this.createPointerData(t));else if(n==="pointerup"||n==="pointercancel"||n==="forceCancel"){this.pointers.set(s,this.createPointerData(t)),this.notifyHandlers(t),this.pointers.delete(s);return}this.notifyHandlers(t)};notifyHandlers(t){this.gestureHandlers.forEach(n=>n(this.pointers,t))}createPointerData(t){return{pointerId:t.pointerId,clientX:t.clientX,clientY:t.clientY,pageX:t.pageX,pageY:t.pageY,target:t.target,timeStamp:t.timeStamp,type:t.type,isPrimary:t.isPrimary,pressure:t.pressure,width:t.width,height:t.height,pointerType:t.pointerType,srcEvent:t}}destroy(){this.root.removeEventListener("pointerdown",this.handlePointerEvent),this.root.removeEventListener("pointermove",this.handlePointerEvent),this.root.removeEventListener("pointerup",this.handlePointerEvent),this.root.removeEventListener("pointercancel",this.handlePointerEvent),this.root.removeEventListener("forceCancel",this.handlePointerEvent),this.root.removeEventListener("blur",this.handleInterruptEvents),this.root.removeEventListener("contextmenu",this.handleInterruptEvents),this.pointers.clear(),this.gestureHandlers.clear()}}class Rme{gestureTemplates=new Map;elementGestureMap=new Map;activeGesturesRegistry=new Mme;keyboardManager=new Ime;constructor(t){this.pointerManager=new $me({root:t.root,touchAction:t.touchAction,passive:t.passive}),t.gestures&&t.gestures.length>0&&t.gestures.forEach(n=>{this.addGestureTemplate(n)})}addGestureTemplate(t){this.gestureTemplates.has(t.name)&&console.warn(`Gesture template with name "${t.name}" already exists. It will be overwritten.`),this.gestureTemplates.set(t.name,t)}setGestureOptions(t,n,s){const r=this.elementGestureMap.get(n);if(!r||!r.has(t)){console.error(`Gesture "${t}" not found on the provided element.`);return}const i=new CustomEvent(`${t}ChangeOptions`,{detail:s,bubbles:!1,cancelable:!1,composed:!1});n.dispatchEvent(i)}setGestureState(t,n,s){const r=this.elementGestureMap.get(n);if(!r||!r.has(t)){console.error(`Gesture "${t}" not found on the provided element.`);return}const i=new CustomEvent(`${t}ChangeState`,{detail:s,bubbles:!1,cancelable:!1,composed:!1});n.dispatchEvent(i)}registerElement(t,n,s){return Array.isArray(t)||(t=[t]),t.forEach(r=>{const i=s?.[r];this.registerSingleGesture(r,n,i)}),n}registerSingleGesture(t,n,s){const r=this.gestureTemplates.get(t);if(!r)return console.error(`Gesture template "${t}" not found.`),!1;this.elementGestureMap.has(n)||this.elementGestureMap.set(n,new Map);const i=this.elementGestureMap.get(n);i.has(t)&&(console.warn(`Element already has gesture "${t}" registered. It will be replaced.`),this.unregisterElement(t,n));const o=r.clone(s);return o.init(n,this.pointerManager,this.activeGesturesRegistry,this.keyboardManager),i.set(t,o),!0}unregisterElement(t,n){const s=this.elementGestureMap.get(n);return!s||!s.has(t)?!1:(s.get(t).destroy(),s.delete(t),this.activeGesturesRegistry.unregisterElement(n),s.size===0&&this.elementGestureMap.delete(n),!0)}unregisterAllGestures(t){const n=this.elementGestureMap.get(t);if(n){for(const[,s]of n)s.destroy(),this.activeGesturesRegistry.unregisterElement(t);this.elementGestureMap.delete(t)}}destroy(){for(const[t]of this.elementGestureMap)this.unregisterAllGestures(t);this.gestureTemplates.clear(),this.elementGestureMap.clear(),this.activeGesturesRegistry.destroy(),this.keyboardManager.destroy(),this.pointerManager.destroy()}}class Xu extends fq{unregisterHandler=null;originalTarget=null;constructor(t){super(t),this.minPointers=t.minPointers??1,this.maxPointers=t.maxPointers??1/0}init(t,n,s,r){super.init(t,n,s,r),this.unregisterHandler=this.pointerManager.registerGestureHandler(this.handlePointerEvent)}updateOptions(t){super.updateOptions(t),this.minPointers=t.minPointers??this.minPointers,this.maxPointers=t.maxPointers??this.maxPointers}getBaseConfig(){return{requiredKeys:this.requiredKeys,minPointers:this.minPointers,maxPointers:this.maxPointers}}isWithinPointerCount(t,n){const s=this.getEffectiveConfig(n,this.getBaseConfig());return t.length>=s.minPointers&&t.length<=s.maxPointers}getRelevantPointers(t,n){return t.filter(s=>this.isPointerTypeAllowed(s.pointerType)&&(n===s.target||s.target===this.originalTarget||n===this.originalTarget||"contains"in n&&n.contains(s.target))||"getRootNode"in n&&n.getRootNode()instanceof ShadowRoot&&s.srcEvent.composedPath().includes(n))}destroy(){this.unregisterHandler&&(this.unregisterHandler(),this.unregisterHandler=null),super.destroy()}}function zme(e,t){const n=t.x-e.x,s=t.y-e.y;return Math.sqrt(n*n+s*s)}function g2(e){if(e.length<2)return 0;let t=0,n=0;for(let s=0;s<e.length;s+=1)for(let r=s+1;r<e.length;r+=1)t+=zme({x:e[s].clientX,y:e[s].clientY},{x:e[r].clientX,y:e[r].clientY}),n+=1;return n>0?t/n:0}function Hl(e){if(e.length===0)return{x:0,y:0};const t=e.reduce((n,s)=>(n.x+=s.clientX,n.y+=s.clientY,n),{x:0,y:0});return{x:t.x/e.length,y:t.y/e.length}}function xi(e,t){return`${e}${t==="ongoing"?"":t.charAt(0).toUpperCase()+t.slice(1)}`}const Vy=1e-5,Rc=1e-5,R$=.15;function Fme(e,t){const n=t.x-e.x,s=t.y-e.y,r={vertical:null,horizontal:null,mainAxis:null},i=Ume(t,e),o=Math.abs(n)>Math.abs(s)?"horizontal":"vertical",l=i||o==="horizontal"?Vy:R$,c=i?Vy:o==="horizontal"?R$:Vy;return Math.abs(n)>l&&(r.horizontal=n>0?"right":"left"),Math.abs(s)>c&&(r.vertical=s>0?"down":"up"),r.mainAxis=i?"diagonal":o,r}function Ume(e,t){const n=t.x-e.x,s=t.y-e.y,r=Math.atan2(s,n)*180/Math.PI;return r>=-45+Rc&&r<=-22.5+Rc||r>=22.5+Rc&&r<=45+Rc||r>=135+Rc&&r<=157.5+Rc||r>=-157.5+Rc&&r<=-135+Rc}function Bme(e,t){if(!e.vertical&&!e.horizontal)return!1;if(t.length===0)return!0;const n=e.vertical===null||t.includes(e.vertical),s=e.horizontal===null||t.includes(e.horizontal);return n&&s}const z$=0,Hme=e=>e>z$?1:e<-z$?-1:0,Wc=e=>{e.cancelable&&e.preventDefault()};class QL extends Xu{state={lastPosition:null};constructor(t){super(t),this.threshold=t.threshold||0}clone(t){return new QL(at({name:this.name,preventDefault:this.preventDefault,stopPropagation:this.stopPropagation,threshold:this.threshold,minPointers:this.minPointers,maxPointers:this.maxPointers,requiredKeys:[...this.requiredKeys],pointerMode:[...this.pointerMode],preventIf:[...this.preventIf],pointerOptions:structuredClone(this.pointerOptions)},t))}init(t,n,s,r){super.init(t,n,s,r),this.element.addEventListener("pointerenter",this.handleElementEnter),this.element.addEventListener("pointerleave",this.handleElementLeave)}destroy(){this.element.removeEventListener("pointerenter",this.handleElementEnter),this.element.removeEventListener("pointerleave",this.handleElementLeave),this.resetState(),super.destroy()}updateOptions(t){super.updateOptions(t)}resetState(){this.isActive=!1,this.state={lastPosition:null}}handleElementEnter=t=>{if(t.pointerType!=="mouse"&&t.pointerType!=="pen")return;const n=this.pointerManager.getPointers()||new Map,s=Array.from(n.values());if(this.isWithinPointerCount(s,t.pointerType)){this.isActive=!0;const r={x:t.clientX,y:t.clientY};this.state.lastPosition=r,this.emitMoveEvent(this.element,"start",s,t),this.emitMoveEvent(this.element,"ongoing",s,t)}};handleElementLeave=t=>{if(t.pointerType!=="mouse"&&t.pointerType!=="pen"||!this.isActive)return;const n=this.pointerManager.getPointers()||new Map,s=Array.from(n.values());this.emitMoveEvent(this.element,"end",s,t),this.resetState()};handlePointerEvent=(t,n)=>{if(n.type!=="pointermove"||n.pointerType!=="mouse"&&n.pointerType!=="pen")return;this.preventDefault&&n.preventDefault(),this.stopPropagation&&n.stopPropagation();const s=Array.from(t.values()),r=this.getTargetElement(n);if(!r||!this.isWithinPointerCount(s,n.pointerType))return;if(this.shouldPreventGesture(r,n.pointerType)){if(!this.isActive)return;this.resetState(),this.emitMoveEvent(r,"end",s,n);return}const i={x:n.clientX,y:n.clientY};this.state.lastPosition=i,this.isActive||(this.isActive=!0,this.emitMoveEvent(r,"start",s,n)),this.emitMoveEvent(r,"ongoing",s,n)};emitMoveEvent(t,n,s,r){const i=this.state.lastPosition||Hl(s),o=this.gesturesRegistry.getActiveGestures(t),l={gestureName:this.name,centroid:i,target:r.target,srcEvent:r,phase:n,pointers:s,timeStamp:r.timeStamp,activeGestures:o,customData:this.customData},c=xi(this.name,n),u=new CustomEvent(c,{bubbles:!0,cancelable:!0,composed:!0,detail:l});t.dispatchEvent(u)}}class ju extends Xu{state={startPointers:new Map,startCentroid:null,lastCentroid:null,movementThresholdReached:!1,totalDeltaX:0,totalDeltaY:0,activeDeltaX:0,activeDeltaY:0,lastDirection:{vertical:null,horizontal:null,mainAxis:null},lastDeltas:null};constructor(t){super(t),this.direction=t.direction||["up","down","left","right"],this.threshold=t.threshold||0}clone(t){return new ju(at({name:this.name,preventDefault:this.preventDefault,stopPropagation:this.stopPropagation,threshold:this.threshold,minPointers:this.minPointers,maxPointers:this.maxPointers,direction:[...this.direction],requiredKeys:[...this.requiredKeys],pointerMode:[...this.pointerMode],preventIf:[...this.preventIf],pointerOptions:structuredClone(this.pointerOptions)},t))}destroy(){this.resetState(),super.destroy()}updateOptions(t){super.updateOptions(t),this.direction=t.direction||this.direction,this.threshold=t.threshold??this.threshold}resetState(){this.isActive=!1,this.state=at({},this.state,{startPointers:new Map,startCentroid:null,lastCentroid:null,lastDeltas:null,activeDeltaX:0,activeDeltaY:0,movementThresholdReached:!1,lastDirection:{vertical:null,horizontal:null,mainAxis:null}})}handlePointerEvent=(t,n)=>{const s=Array.from(t.values());if(n.type==="forceCancel"){this.cancel(n.target,s,n);return}const r=this.getTargetElement(n);if(!r)return;if(this.shouldPreventGesture(r,n.pointerType)){this.cancel(r,s,n);return}const i=this.getRelevantPointers(s,r);if(!this.isWithinPointerCount(i,n.pointerType)){this.cancel(r,i,n);return}switch(n.type){case"pointerdown":!this.isActive&&!this.state.startCentroid&&(i.forEach(o=>{this.state.startPointers.set(o.pointerId,o)}),this.originalTarget=r,this.state.startCentroid=Hl(i),this.state.lastCentroid=at({},this.state.startCentroid));break;case"pointermove":if(this.state.startCentroid&&this.isWithinPointerCount(s,n.pointerType)){const o=Hl(i),l=o.x-this.state.startCentroid.x,c=o.y-this.state.startCentroid.y,u=Math.sqrt(l*l+c*c),d=Fme(this.state.lastCentroid??this.state.startCentroid,o),h=this.state.lastCentroid?o.x-this.state.lastCentroid.x:0,p=this.state.lastCentroid?o.y-this.state.lastCentroid.y:0;!this.state.movementThresholdReached&&u>=this.threshold&&Bme(d,this.direction)?(this.state.movementThresholdReached=!0,this.isActive=!0,this.state.lastDeltas={x:h,y:p},this.state.totalDeltaX+=h,this.state.totalDeltaY+=p,this.state.activeDeltaX+=h,this.state.activeDeltaY+=p,this.emitPanEvent(r,"start",i,n,o),this.emitPanEvent(r,"ongoing",i,n,o)):this.state.movementThresholdReached&&this.isActive&&(this.state.lastDeltas={x:h,y:p},this.state.totalDeltaX+=h,this.state.totalDeltaY+=p,this.state.activeDeltaX+=h,this.state.activeDeltaY+=p,this.emitPanEvent(r,"ongoing",i,n,o)),this.state.lastCentroid=o,this.state.lastDirection=d}break;case"pointerup":case"pointercancel":case"forceCancel":if(this.isActive&&this.state.movementThresholdReached){const o=i.filter(l=>l.type!=="pointerup"&&l.type!=="pointercancel");if(!this.isWithinPointerCount(o,n.pointerType)){const l=this.state.lastCentroid||this.state.startCentroid;n.type==="pointercancel"&&this.emitPanEvent(r,"cancel",i,n,l),this.emitPanEvent(r,"end",i,n,l),this.resetState()}}else this.resetState();break}};emitPanEvent(t,n,s,r,i){if(!this.state.startCentroid)return;const o=this.state.lastDeltas?.x??0,l=this.state.lastDeltas?.y??0,c=this.state.startPointers.values().next().value,u=c?(r.timeStamp-c.timeStamp)/1e3:0,d=u>0?o/u:0,h=u>0?l/u:0,p=Math.sqrt(d*d+h*h),x=this.gesturesRegistry.getActiveGestures(t),v={gestureName:this.name,initialCentroid:this.state.startCentroid,centroid:i,target:r.target,srcEvent:r,phase:n,pointers:s,timeStamp:r.timeStamp,deltaX:o,deltaY:l,direction:this.state.lastDirection,velocityX:d,velocityY:h,velocity:p,totalDeltaX:this.state.totalDeltaX,totalDeltaY:this.state.totalDeltaY,activeDeltaX:this.state.activeDeltaX,activeDeltaY:this.state.activeDeltaY,activeGestures:x,customData:this.customData},j=xi(this.name,n),y=new CustomEvent(j,{bubbles:!0,cancelable:!0,composed:!0,detail:v});t.dispatchEvent(y),this.preventDefault&&r.preventDefault(),this.stopPropagation&&r.stopPropagation()}cancel(t,n,s){if(this.isActive){const r=t??this.element;this.emitPanEvent(r,"cancel",n,s,this.state.lastCentroid),this.emitPanEvent(r,"end",n,s,this.state.lastCentroid)}this.resetState()}}class KL extends Xu{state={startDistance:0,lastDistance:0,lastScale:1,lastTime:0,velocity:0,totalScale:1,deltaScale:0};constructor(t){super(at({},t,{minPointers:t.minPointers??2})),this.threshold=t.threshold??0}clone(t){return new KL(at({name:this.name,preventDefault:this.preventDefault,stopPropagation:this.stopPropagation,threshold:this.threshold,minPointers:this.minPointers,maxPointers:this.maxPointers,requiredKeys:[...this.requiredKeys],pointerMode:[...this.pointerMode],preventIf:[...this.preventIf],pointerOptions:structuredClone(this.pointerOptions)},t))}destroy(){this.resetState(),super.destroy()}updateOptions(t){super.updateOptions(t)}resetState(){this.isActive=!1,this.state=at({},this.state,{startDistance:0,lastDistance:0,lastScale:1,lastTime:0,velocity:0,deltaScale:0})}handlePointerEvent=(t,n)=>{const s=Array.from(t.values()),r=this.getTargetElement(n);if(!r)return;if(this.shouldPreventGesture(r,n.pointerType)){this.isActive&&(this.emitPinchEvent(r,"cancel",s,n),this.resetState());return}const i=this.getRelevantPointers(s,r);switch(n.type){case"pointerdown":if(i.length>=2&&!this.isActive){const o=g2(i);this.state.startDistance=o,this.state.lastDistance=o,this.state.lastTime=n.timeStamp,this.originalTarget=r}break;case"pointermove":if(this.state.startDistance&&this.isWithinPointerCount(i,n.pointerType)){const o=g2(i),l=Math.abs(o-this.state.lastDistance);if(l!==0&&l>=this.threshold){const c=this.state.startDistance?o/this.state.startDistance:1,u=c/this.state.lastScale;this.state.totalScale*=u;const d=(n.timeStamp-this.state.lastTime)/1e3;if(this.state.lastDistance){const p=(o-this.state.lastDistance)/d;this.state.velocity=Number.isNaN(p)?0:p}this.state.lastDistance=o,this.state.deltaScale=c-this.state.lastScale,this.state.lastScale=c,this.state.lastTime=n.timeStamp,this.isActive?this.emitPinchEvent(r,"ongoing",i,n):(this.isActive=!0,this.emitPinchEvent(r,"start",i,n),this.emitPinchEvent(r,"ongoing",i,n))}}break;case"pointerup":case"pointercancel":case"forceCancel":if(this.isActive){const o=i.filter(l=>l.type!=="pointerup"&&l.type!=="pointercancel");if(!this.isWithinPointerCount(o,n.pointerType))n.type==="pointercancel"&&this.emitPinchEvent(r,"cancel",i,n),this.emitPinchEvent(r,"end",i,n),this.resetState();else if(o.length>=2){const l=g2(o);this.state.startDistance=l/this.state.lastScale}}break}};emitPinchEvent(t,n,s,r){const i=Hl(s),o=this.state.lastDistance,l=this.state.lastScale,c=this.gesturesRegistry.getActiveGestures(t),u={gestureName:this.name,centroid:i,target:r.target,srcEvent:r,phase:n,pointers:s,timeStamp:r.timeStamp,scale:l,deltaScale:this.state.deltaScale,totalScale:this.state.totalScale,distance:o,velocity:this.state.velocity,activeGestures:c,direction:Hme(this.state.velocity),customData:this.customData};this.preventDefault&&r.preventDefault(),this.stopPropagation&&r.stopPropagation();const d=xi(this.name,n),h=new CustomEvent(d,{bubbles:!0,cancelable:!0,composed:!0,detail:u});t.dispatchEvent(h)}}class Hj extends Xu{state={startCentroid:null,lastPosition:null,timerId:null,startTime:0,pressThresholdReached:!1};constructor(t){super(t),this.duration=t.duration??500,this.maxDistance=t.maxDistance??10}clone(t){return new Hj(at({name:this.name,preventDefault:this.preventDefault,stopPropagation:this.stopPropagation,minPointers:this.minPointers,maxPointers:this.maxPointers,duration:this.duration,maxDistance:this.maxDistance,requiredKeys:[...this.requiredKeys],pointerMode:[...this.pointerMode],preventIf:[...this.preventIf],pointerOptions:structuredClone(this.pointerOptions)},t))}destroy(){this.clearPressTimer(),this.resetState(),super.destroy()}updateOptions(t){super.updateOptions(t),this.duration=t.duration??this.duration,this.maxDistance=t.maxDistance??this.maxDistance}resetState(){this.clearPressTimer(),this.isActive=!1,this.state=at({},this.state,{startCentroid:null,lastPosition:null,timerId:null,startTime:0,pressThresholdReached:!1})}clearPressTimer(){this.state.timerId!==null&&(clearTimeout(this.state.timerId),this.state.timerId=null)}handlePointerEvent=(t,n)=>{const s=Array.from(t.values());if(n.type==="forceCancel"){this.cancelPress(n.target,s,n);return}const r=this.getTargetElement(n);if(!r)return;if(this.shouldPreventGesture(r,n.pointerType)){this.isActive&&this.cancelPress(r,s,n);return}const i=this.getRelevantPointers(s,r);if(!this.isWithinPointerCount(i,n.pointerType)){this.isActive&&this.cancelPress(r,i,n);return}switch(n.type){case"pointerdown":!this.isActive&&!this.state.startCentroid&&(this.state.startCentroid=Hl(i),this.state.lastPosition=at({},this.state.startCentroid),this.state.startTime=n.timeStamp,this.isActive=!0,this.originalTarget=r,this.clearPressTimer(),this.state.timerId=setTimeout(()=>{if(this.isActive&&this.state.startCentroid){this.state.pressThresholdReached=!0;const o=this.state.lastPosition;this.emitPressEvent(r,"start",i,n,o),this.emitPressEvent(r,"ongoing",i,n,o)}},this.duration));break;case"pointermove":if(this.isActive&&this.state.startCentroid){const o=Hl(i);this.state.lastPosition=o;const l=o.x-this.state.startCentroid.x,c=o.y-this.state.startCentroid.y;Math.sqrt(l*l+c*c)>this.maxDistance&&this.cancelPress(r,i,n)}break;case"pointerup":if(this.isActive){if(this.state.pressThresholdReached){const o=this.state.lastPosition||this.state.startCentroid;this.emitPressEvent(r,"end",i,n,o)}this.resetState()}break;case"pointercancel":case"forceCancel":this.cancelPress(r,i,n);break}};emitPressEvent(t,n,s,r,i){const o=this.gesturesRegistry.getActiveGestures(t),l=r.timeStamp-this.state.startTime,c={gestureName:this.name,centroid:i,target:r.target,srcEvent:r,phase:n,pointers:s,timeStamp:r.timeStamp,x:i.x,y:i.y,duration:l,activeGestures:o,customData:this.customData},u=xi(this.name,n),d=new CustomEvent(u,{bubbles:!0,cancelable:!0,composed:!0,detail:c});t.dispatchEvent(d),this.preventDefault&&r.preventDefault(),this.stopPropagation&&r.stopPropagation()}cancelPress(t,n,s){if(this.isActive&&this.state.pressThresholdReached){const r=this.state.lastPosition||this.state.startCentroid;this.emitPressEvent(t??this.element,"cancel",n,s,r),this.emitPressEvent(t??this.element,"end",n,s,r)}this.resetState()}}class XL extends Xu{state={phase:"waitingForPress",dragTimeoutId:null};constructor(t){super(t),this.pressDuration=t.pressDuration??500,this.pressMaxDistance=t.pressMaxDistance??10,this.dragTimeout=t.dragTimeout??1e3,this.dragThreshold=t.dragThreshold??0,this.dragDirection=t.dragDirection||["up","down","left","right"],this.pressGesture=new Hj({name:`${this.name}-press`,duration:this.pressDuration,maxDistance:this.pressMaxDistance,maxPointers:this.maxPointers,pointerMode:this.pointerMode,requiredKeys:this.requiredKeys,preventIf:this.preventIf,pointerOptions:structuredClone(this.pointerOptions)}),this.panGesture=new ju({name:`${this.name}-pan`,minPointers:this.minPointers,maxPointers:this.maxPointers,threshold:this.dragThreshold,direction:this.dragDirection,pointerMode:this.pointerMode,requiredKeys:this.requiredKeys,preventIf:this.preventIf,pointerOptions:structuredClone(this.pointerOptions)})}clone(t){return new XL(at({name:this.name,preventDefault:this.preventDefault,stopPropagation:this.stopPropagation,minPointers:this.minPointers,maxPointers:this.maxPointers,pressDuration:this.pressDuration,pressMaxDistance:this.pressMaxDistance,dragTimeout:this.dragTimeout,dragThreshold:this.dragThreshold,dragDirection:[...this.dragDirection],requiredKeys:[...this.requiredKeys],pointerMode:[...this.pointerMode],preventIf:[...this.preventIf],pointerOptions:structuredClone(this.pointerOptions)},t))}init(t,n,s,r){super.init(t,n,s,r),this.pressGesture.init(t,n,s,r),this.panGesture.init(t,n,s,r),this.element.addEventListener(this.pressGesture.name,this.pressHandler),this.element.addEventListener(`${this.panGesture.name}Start`,this.dragStartHandler),this.element.addEventListener(this.panGesture.name,this.dragMoveHandler),this.element.addEventListener(`${this.panGesture.name}End`,this.dragEndHandler),this.element.addEventListener(`${this.panGesture.name}Cancel`,this.dragEndHandler)}destroy(){this.resetState(),this.pressGesture.destroy(),this.panGesture.destroy(),this.element.removeEventListener(this.pressGesture.name,this.pressHandler),this.element.removeEventListener(`${this.panGesture.name}Start`,this.dragStartHandler),this.element.removeEventListener(this.panGesture.name,this.dragMoveHandler),this.element.removeEventListener(`${this.panGesture.name}End`,this.dragEndHandler),this.element.removeEventListener(`${this.panGesture.name}Cancel`,this.dragEndHandler),super.destroy()}updateOptions(t){super.updateOptions(t),this.pressDuration=t.pressDuration??this.pressDuration,this.pressMaxDistance=t.pressMaxDistance??this.pressMaxDistance,this.dragTimeout=t.dragTimeout??this.dragTimeout,this.dragThreshold=t.dragThreshold??this.dragThreshold,this.dragDirection=t.dragDirection||this.dragDirection,this.element.dispatchEvent(new CustomEvent(`${this.panGesture.name}ChangeOptions`,{detail:{minPointers:this.minPointers,maxPointers:this.maxPointers,threshold:this.dragThreshold,direction:this.dragDirection,pointerMode:this.pointerMode,requiredKeys:this.requiredKeys,preventIf:this.preventIf,pointerOptions:structuredClone(this.pointerOptions)}})),this.element.dispatchEvent(new CustomEvent(`${this.pressGesture.name}ChangeOptions`,{detail:{duration:this.pressDuration,maxDistance:this.pressMaxDistance,maxPointers:this.maxPointers,pointerMode:this.pointerMode,requiredKeys:this.requiredKeys,preventIf:this.preventIf,pointerOptions:structuredClone(this.pointerOptions)}}))}resetState(){this.state.dragTimeoutId!==null&&clearTimeout(this.state.dragTimeoutId),this.restoreTouchAction(),this.isActive=!1,this.state={phase:"waitingForPress",dragTimeoutId:null}}handlePointerEvent(){}pressHandler=()=>{this.state.phase==="waitingForPress"&&(this.state.phase="pressDetected",this.setTouchAction(),this.state.dragTimeoutId=setTimeout(()=>{this.resetState()},this.dragTimeout))};dragStartHandler=t=>{this.state.phase==="pressDetected"&&(this.state.dragTimeoutId!==null&&(clearTimeout(this.state.dragTimeoutId),this.state.dragTimeoutId=null),this.restoreTouchAction(),this.state.phase="dragging",this.isActive=!0,this.element.dispatchEvent(new CustomEvent(xi(this.name,t.detail.phase),t)))};dragMoveHandler=t=>{this.state.phase==="dragging"&&this.element.dispatchEvent(new CustomEvent(xi(this.name,t.detail.phase),t))};dragEndHandler=t=>{this.state.phase==="dragging"&&(this.resetState(),this.element.dispatchEvent(new CustomEvent(xi(this.name,t.detail.phase),t)))};setTouchAction(){this.element.addEventListener("touchstart",Wc,{passive:!1}),this.element.addEventListener("touchmove",Wc,{passive:!1}),this.element.addEventListener("touchend",Wc,{passive:!1})}restoreTouchAction(){this.element.removeEventListener("touchstart",Wc),this.element.removeEventListener("touchmove",Wc),this.element.removeEventListener("touchend",Wc)}}class Np extends Xu{state={startCentroid:null,currentTapCount:0,lastTapTime:0,lastPosition:null};constructor(t){super(t),this.maxDistance=t.maxDistance??10,this.taps=t.taps??1}clone(t){return new Np(at({name:this.name,preventDefault:this.preventDefault,stopPropagation:this.stopPropagation,minPointers:this.minPointers,maxPointers:this.maxPointers,maxDistance:this.maxDistance,taps:this.taps,requiredKeys:[...this.requiredKeys],pointerMode:[...this.pointerMode],preventIf:[...this.preventIf],pointerOptions:structuredClone(this.pointerOptions)},t))}destroy(){this.resetState(),super.destroy()}updateOptions(t){super.updateOptions(t),this.maxDistance=t.maxDistance??this.maxDistance,this.taps=t.taps??this.taps}resetState(){this.isActive=!1,this.state={startCentroid:null,currentTapCount:0,lastTapTime:0,lastPosition:null}}handlePointerEvent=(t,n)=>{const s=Array.from(t.values()),r=this.getTargetElement(n);if(!r)return;const i=this.getRelevantPointers(s,r);if(this.shouldPreventGesture(r,n.pointerType)||!this.isWithinPointerCount(i,n.pointerType)){this.isActive&&this.cancelTap(r,i,n);return}switch(n.type){case"pointerdown":this.isActive||(this.state.startCentroid=Hl(i),this.state.lastPosition=at({},this.state.startCentroid),this.isActive=!0,this.originalTarget=r);break;case"pointermove":if(this.isActive&&this.state.startCentroid){const o=Hl(i);this.state.lastPosition=o;const l=o.x-this.state.startCentroid.x,c=o.y-this.state.startCentroid.y;Math.sqrt(l*l+c*c)>this.maxDistance&&this.cancelTap(r,i,n)}break;case"pointerup":if(this.isActive){this.state.currentTapCount+=1;const o=this.state.lastPosition||this.state.startCentroid;if(!o){this.cancelTap(r,i,n);return}this.state.currentTapCount>=this.taps?(this.fireTapEvent(r,i,n,o),this.resetState()):(this.state.lastTapTime=n.timeStamp,this.isActive=!1,this.state.startCentroid=null,setTimeout(()=>{this.state&&this.state.currentTapCount>0&&this.state.currentTapCount<this.taps&&(this.state.currentTapCount=0)},300))}break;case"pointercancel":case"forceCancel":this.cancelTap(r,i,n);break}};fireTapEvent(t,n,s,r){const i=this.gesturesRegistry.getActiveGestures(t),o={gestureName:this.name,centroid:r,target:s.target,srcEvent:s,phase:"end",pointers:n,timeStamp:s.timeStamp,x:r.x,y:r.y,tapCount:this.state.currentTapCount,activeGestures:i,customData:this.customData},l=new CustomEvent(this.name,{bubbles:!0,cancelable:!0,composed:!0,detail:o});t.dispatchEvent(l),this.preventDefault&&s.preventDefault(),this.stopPropagation&&s.stopPropagation()}cancelTap(t,n,s){if(this.state.startCentroid||this.state.lastPosition){const r=this.state.lastPosition||this.state.startCentroid,i=this.gesturesRegistry.getActiveGestures(t),o={gestureName:this.name,centroid:r,target:s.target,srcEvent:s,phase:"cancel",pointers:n,timeStamp:s.timeStamp,x:r.x,y:r.y,tapCount:this.state.currentTapCount,activeGestures:i,customData:this.customData},l=xi(this.name,"cancel"),c=new CustomEvent(l,{bubbles:!0,cancelable:!0,composed:!0,detail:o});t.dispatchEvent(c)}this.resetState()}}class ZL extends Xu{state={phase:"waitingForTap",dragTimeoutId:null};constructor(t){super(t),this.tapMaxDistance=t.tapMaxDistance??10,this.dragTimeout=t.dragTimeout??1e3,this.dragThreshold=t.dragThreshold??0,this.dragDirection=t.dragDirection||["up","down","left","right"],this.tapGesture=new Np({name:`${this.name}-tap`,maxDistance:this.tapMaxDistance,maxPointers:this.maxPointers,pointerMode:this.pointerMode,requiredKeys:this.requiredKeys,preventIf:this.preventIf,pointerOptions:structuredClone(this.pointerOptions)}),this.panGesture=new ju({name:`${this.name}-pan`,minPointers:this.minPointers,maxPointers:this.maxPointers,threshold:this.dragThreshold,direction:this.dragDirection,pointerMode:this.pointerMode,requiredKeys:this.requiredKeys,preventIf:this.preventIf,pointerOptions:structuredClone(this.pointerOptions)})}clone(t){return new ZL(at({name:this.name,preventDefault:this.preventDefault,stopPropagation:this.stopPropagation,minPointers:this.minPointers,maxPointers:this.maxPointers,tapMaxDistance:this.tapMaxDistance,dragTimeout:this.dragTimeout,dragThreshold:this.dragThreshold,dragDirection:[...this.dragDirection],requiredKeys:[...this.requiredKeys],pointerMode:[...this.pointerMode],preventIf:[...this.preventIf],pointerOptions:structuredClone(this.pointerOptions)},t))}init(t,n,s,r){super.init(t,n,s,r),this.tapGesture.init(t,n,s,r),this.panGesture.init(t,n,s,r),this.element.addEventListener(this.tapGesture.name,this.tapHandler),this.element.addEventListener(`${this.panGesture.name}Start`,this.dragStartHandler),this.element.addEventListener(this.panGesture.name,this.dragMoveHandler),this.element.addEventListener(`${this.panGesture.name}End`,this.dragEndHandler),this.element.addEventListener(`${this.panGesture.name}Cancel`,this.dragEndHandler)}destroy(){this.resetState(),this.tapGesture.destroy(),this.panGesture.destroy(),this.element.removeEventListener(this.tapGesture.name,this.tapHandler),this.element.removeEventListener(`${this.panGesture.name}Start`,this.dragStartHandler),this.element.removeEventListener(this.panGesture.name,this.dragMoveHandler),this.element.removeEventListener(`${this.panGesture.name}End`,this.dragEndHandler),this.element.removeEventListener(`${this.panGesture.name}Cancel`,this.dragEndHandler),super.destroy()}updateOptions(t){super.updateOptions(t),this.tapMaxDistance=t.tapMaxDistance??this.tapMaxDistance,this.dragTimeout=t.dragTimeout??this.dragTimeout,this.dragThreshold=t.dragThreshold??this.dragThreshold,this.dragDirection=t.dragDirection||this.dragDirection,this.element.dispatchEvent(new CustomEvent(`${this.panGesture.name}ChangeOptions`,{detail:{minPointers:this.minPointers,maxPointers:this.maxPointers,threshold:this.dragThreshold,direction:this.dragDirection,pointerMode:this.pointerMode,requiredKeys:this.requiredKeys,preventIf:this.preventIf,pointerOptions:structuredClone(this.pointerOptions)}})),this.element.dispatchEvent(new CustomEvent(`${this.tapGesture.name}ChangeOptions`,{detail:{maxDistance:this.tapMaxDistance,maxPointers:this.maxPointers,pointerMode:this.pointerMode,requiredKeys:this.requiredKeys,preventIf:this.preventIf,pointerOptions:structuredClone(this.pointerOptions)}}))}resetState(){this.state.dragTimeoutId!==null&&clearTimeout(this.state.dragTimeoutId),this.restoreTouchAction(),this.isActive=!1,this.state={phase:"waitingForTap",dragTimeoutId:null}}handlePointerEvent(){}tapHandler=()=>{this.state.phase==="waitingForTap"&&(this.state.phase="tapDetected",this.setTouchAction(),this.state.dragTimeoutId=setTimeout(()=>{this.resetState()},this.dragTimeout))};dragStartHandler=t=>{this.state.phase==="tapDetected"&&(this.state.dragTimeoutId!==null&&(clearTimeout(this.state.dragTimeoutId),this.state.dragTimeoutId=null),this.restoreTouchAction(),this.state.phase="dragging",this.isActive=!0,this.element.dispatchEvent(new CustomEvent(xi(this.name,t.detail.phase),t)))};dragMoveHandler=t=>{this.state.phase==="dragging"&&this.element.dispatchEvent(new CustomEvent(xi(this.name,t.detail.phase),t))};dragEndHandler=t=>{this.state.phase==="dragging"&&(this.resetState(),this.element.dispatchEvent(new CustomEvent(xi(this.name,t.detail.phase),t)))};setTouchAction(){this.element.addEventListener("touchstart",Wc,{passive:!1})}restoreTouchAction(){this.element.removeEventListener("touchstart",Wc)}}class Dv extends fq{state={totalDeltaX:0,totalDeltaY:0,totalDeltaZ:0};constructor(t){super(t),this.sensitivity=t.sensitivity??1,this.max=t.max??Number.MAX_SAFE_INTEGER,this.min=t.min??Number.MIN_SAFE_INTEGER,this.initialDelta=t.initialDelta??0,this.invert=t.invert??!1,this.state.totalDeltaX=this.initialDelta,this.state.totalDeltaY=this.initialDelta,this.state.totalDeltaZ=this.initialDelta}clone(t){return new Dv(at({name:this.name,preventDefault:this.preventDefault,stopPropagation:this.stopPropagation,sensitivity:this.sensitivity,max:this.max,min:this.min,initialDelta:this.initialDelta,invert:this.invert,requiredKeys:[...this.requiredKeys],preventIf:[...this.preventIf]},t))}init(t,n,s,r){super.init(t,n,s,r),this.element.addEventListener("wheel",this.handleWheelEvent)}destroy(){this.element.removeEventListener("wheel",this.handleWheelEvent),this.resetState(),super.destroy()}resetState(){this.isActive=!1,this.state={totalDeltaX:0,totalDeltaY:0,totalDeltaZ:0}}updateOptions(t){super.updateOptions(t),this.sensitivity=t.sensitivity??this.sensitivity,this.max=t.max??this.max,this.min=t.min??this.min,this.initialDelta=t.initialDelta??this.initialDelta,this.invert=t.invert??this.invert}handleWheelEvent=t=>{if(this.shouldPreventGesture(this.element,"mouse"))return;const n=this.pointerManager.getPointers()||new Map,s=Array.from(n.values());this.state.totalDeltaX+=t.deltaX*this.sensitivity*(this.invert?-1:1),this.state.totalDeltaY+=t.deltaY*this.sensitivity*(this.invert?-1:1),this.state.totalDeltaZ+=t.deltaZ*this.sensitivity*(this.invert?-1:1),["totalDeltaX","totalDeltaY","totalDeltaZ"].forEach(r=>{this.state[r]<this.min&&(this.state[r]=this.min),this.state[r]>this.max&&(this.state[r]=this.max)}),this.emitWheelEvent(s,t)};emitWheelEvent(t,n){const s=t.length>0?Hl(t):{x:n.clientX,y:n.clientY},r=this.gesturesRegistry.getActiveGestures(this.element),i={gestureName:this.name,centroid:s,target:n.target,srcEvent:n,phase:"ongoing",pointers:t,timeStamp:n.timeStamp,deltaX:n.deltaX*this.sensitivity*(this.invert?-1:1),deltaY:n.deltaY*this.sensitivity*(this.invert?-1:1),deltaZ:n.deltaZ*this.sensitivity*(this.invert?-1:1),deltaMode:n.deltaMode,totalDeltaX:this.state.totalDeltaX,totalDeltaY:this.state.totalDeltaY,totalDeltaZ:this.state.totalDeltaZ,activeGestures:r,customData:this.customData};this.preventDefault&&n.preventDefault(),this.stopPropagation&&n.stopPropagation();const o=xi(this.name,"ongoing"),l=new CustomEvent(o,{bubbles:!0,cancelable:!0,composed:!0,detail:i});this.element.dispatchEvent(l)}}const Ym=e=>e.preventDefault(),JL=({svgRef:e})=>{const t=f.useRef(null);f.useEffect(()=>{const r=e.current;t.current||(t.current=new Rme({gestures:[new ju({name:"pan",threshold:0,maxPointers:1}),new QL({name:"move",preventIf:["pan","zoomPinch","zoomPan"]}),new Np({name:"tap",preventIf:["pan","zoomPinch","zoomPan"]}),new Hj({name:"quickPress",duration:50}),new ju({name:"brush",threshold:0,maxPointers:1}),new ju({name:"zoomPan",threshold:0,preventIf:["zoomTapAndDrag","zoomPressAndDrag"]}),new KL({name:"zoomPinch",threshold:5}),new Dv({name:"zoomTurnWheel",sensitivity:.01,initialDelta:1}),new Dv({name:"panTurnWheel",sensitivity:.5}),new ZL({name:"zoomTapAndDrag",dragThreshold:10}),new XL({name:"zoomPressAndDrag",dragThreshold:10,preventIf:["zoomPinch"]}),new Np({name:"zoomDoubleTapReset",taps:2})]}));const i=t.current;if(!(!r||!i))return i.registerElement(["pan","move","zoomPinch","zoomPan","zoomTurnWheel","panTurnWheel","tap","quickPress","zoomTapAndDrag","zoomPressAndDrag","zoomDoubleTapReset","brush"],r),()=>{i.unregisterAllGestures(r)}},[e,t]);const n=f.useCallback((r,i,o)=>{const l=e.current;return l?.addEventListener(r,i,o),{cleanup:()=>l?.removeEventListener(r,i)}},[e]),s=f.useCallback((r,i)=>{const o=e.current,l=t.current;!l||!o||l.setGestureOptions(r,o,i??{})},[e,t]);return f.useEffect(()=>{const r=e.current;return r?.addEventListener("gesturestart",Ym),r?.addEventListener("gesturechange",Ym),r?.addEventListener("gestureend",Ym),()=>{r?.removeEventListener("gesturestart",Ym),r?.removeEventListener("gesturechange",Ym),r?.removeEventListener("gestureend",Ym)}},[e]),{instance:{addInteractionListener:n,updateZoomInteractionListeners:s}}};JL.params={};JL.getInitialState=()=>({});const qme=[VL,WL,Fj,Bj,JL,Rj],Gme=["apiRef"],Wme=e=>{let{plugins:t}=e,n=ya(e.props,Gme);const s={};t.forEach(o=>{Object.assign(s,o.params)});const r={};return Object.keys(n).forEach(o=>{const l=n[o];s[o]&&(r[o]=l)}),t.reduce((o,l)=>l.getDefaultizedParams?l.getDefaultizedParams({params:o}):o,r)};let F$=0;function Vme(e,t,n){const s=Dj(),r=f.useMemo(()=>[...qme,...e],[e]),i=Wme({plugins:r,props:t});i.id=i.id??s;const l=f.useRef({}).current,c=Qme(t.apiRef),u=f.useRef(null),d=f.useRef(null),h=f.useRef(null);if(h.current==null){F$+=1;const v={cacheKey:{id:F$}};r.forEach(j=>{j.getInitialState&&Object.assign(v,j.getInitialState(i,v,n))}),h.current=new GL(v)}const p=v=>{const j=v({instance:l,params:i,plugins:r,store:h.current,svgRef:d,chartRootRef:u,seriesConfig:n});j.publicAPI&&Object.assign(c.current,j.publicAPI),j.instance&&Object.assign(l,j.instance)};return r.forEach(p),{contextValue:f.useMemo(()=>({store:h.current,publicAPI:c.current,instance:l,svgRef:d,chartRootRef:u}),[l,c])}}function Yme(e){return e.current==null&&(e.current={}),e}function Qme(e){const t=f.useRef({});return e?Yme(e):t}const hq=f.createContext(null);const gq=()=>{},pq=4,xq=20+2*pq,Kme=40+2*pq,Xme="hover",Yy={minStart:0,maxEnd:100,step:5,minSpan:10,maxSpan:100,panning:!0,filterMode:"keep",reverse:!1,slider:{enabled:!1,preview:!1,size:xq,showTooltip:Xme}},e4=(e,t,n,s)=>{if(e)return e===!0?at({axisId:t,axisDirection:n},Yy,{reverse:s??!1}):at({axisId:t,axisDirection:n},Yy,{reverse:s??!1},e,{slider:at({},Yy.slider,{size:e.slider?.preview??Yy.slider.preview?Kme:xq},e.slider)})};function yq(e,t){const n={top:0,bottom:0,none:0};return(e&&e.length>0?e:[{id:zj,scaleType:"linear"}]).map((i,o)=>{const l=i.dataKey,c=o===0?"bottom":"none",u=i.position??c,d=fme+(i.label?lq:0),h=i.id??`defaultized-x-axis-${o}`,p=at({offset:n[u]},i,{id:h,position:u,height:i.height??d,zoom:e4(i.zoom,h,"x",i.reverse)});if(u!=="none"&&(n[u]+=p.height,p.zoom?.slider.enabled&&(n[u]+=p.zoom.slider.size)),l===void 0||i.data!==void 0)return p;if(t===void 0)throw new Error("MUI X Charts: x-axis uses `dataKey` but no `dataset` is provided.");return at({},p,{data:t.map(x=>x[l])})})}function bq(e,t){const n={right:0,left:0,none:0};return(e&&e.length>0?e:[{id:dme,scaleType:"linear"}]).map((i,o)=>{const l=i.dataKey,c=o===0?"left":"none",u=i.position??c,d=mme+(i.label?lq:0),h=i.id??`defaultized-y-axis-${o}`,p=at({offset:n[u]},i,{id:h,position:u,width:i.width??d,zoom:e4(i.zoom,h,"y",i.reverse)});if(u!=="none"&&(n[u]+=p.width,p.zoom?.slider.enabled&&(n[u]+=p.zoom.slider.size)),l===void 0||i.data!==void 0)return p;if(t===void 0)throw new Error("MUI X Charts: y-axis uses `dataKey` but no `dataset` is provided.");return at({},p,{data:t.map(x=>x[l])})})}function Zme(e,t){return function(s,r){if(r.location==="tick"){const i=r.scale.domain();return i[0]===i[1]?r.scale.tickFormat(1)(s):r.scale.tickFormat(e)(s)}return r.location==="zoom-slider-tooltip"?t.tickFormat(2)(s):`${s}`}}function Zu(e){return e.scaleType==="band"}function Ju(e){return e.scaleType==="point"}function Jme(e){return e.scaleType!=="point"&&e.scaleType!=="band"}function efe(e){return e.scaleType==="symlog"}function vx(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function t4(e){let t=e,n=e;e.length===1&&(t=(o,l)=>e(o)-l,n=tfe(e));function s(o,l,c,u){for(c==null&&(c=0),u==null&&(u=o.length);c<u;){const d=c+u>>>1;n(o[d],l)<0?c=d+1:u=d}return c}function r(o,l,c,u){for(c==null&&(c=0),u==null&&(u=o.length);c<u;){const d=c+u>>>1;n(o[d],l)>0?u=d:c=d+1}return c}function i(o,l,c,u){c==null&&(c=0),u==null&&(u=o.length);const d=s(o,l,c,u-1);return d>c&&t(o[d-1],l)>-t(o[d],l)?d-1:d}return{left:s,center:i,right:r}}function tfe(e){return(t,n)=>vx(e(t),n)}function vq(e){return e===null?NaN:+e}function*afe(e,t){for(let n of e)n!=null&&(n=+n)>=n&&(yield n)}const nfe=t4(vx),wx=nfe.right;t4(vq).center;class Ov extends Map{constructor(t,n=ife){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[s,r]of t)this.set(s,r)}get(t){return super.get(U$(this,t))}has(t){return super.has(U$(this,t))}set(t,n){return super.set(sfe(this,t),n)}delete(t){return super.delete(rfe(this,t))}}function U$({_intern:e,_key:t},n){const s=t(n);return e.has(s)?e.get(s):n}function sfe({_intern:e,_key:t},n){const s=t(n);return e.has(s)?e.get(s):(e.set(s,n),n)}function rfe({_intern:e,_key:t},n){const s=t(n);return e.has(s)&&(n=e.get(n),e.delete(s)),n}function ife(e){return e!==null&&typeof e=="object"?e.valueOf():e}var yk=Math.sqrt(50),bk=Math.sqrt(10),vk=Math.sqrt(2);function wk(e,t,n){var s,r=-1,i,o,l;if(t=+t,e=+e,n=+n,e===t&&n>0)return[e];if((s=t<e)&&(i=e,e=t,t=i),(l=wq(e,t,n))===0||!isFinite(l))return[];if(l>0){let c=Math.round(e/l),u=Math.round(t/l);for(c*l<e&&++c,u*l>t&&--u,o=new Array(i=u-c+1);++r<i;)o[r]=(c+r)*l}else{l=-l;let c=Math.round(e*l),u=Math.round(t*l);for(c/l<e&&++c,u/l>t&&--u,o=new Array(i=u-c+1);++r<i;)o[r]=(c+r)/l}return s&&o.reverse(),o}function wq(e,t,n){var s=(t-e)/Math.max(0,n),r=Math.floor(Math.log(s)/Math.LN10),i=s/Math.pow(10,r);return r>=0?(i>=yk?10:i>=bk?5:i>=vk?2:1)*Math.pow(10,r):-Math.pow(10,-r)/(i>=yk?10:i>=bk?5:i>=vk?2:1)}function jk(e,t,n){var s=Math.abs(t-e)/Math.max(0,n),r=Math.pow(10,Math.floor(Math.log(s)/Math.LN10)),i=s/r;return i>=yk?r*=10:i>=bk?r*=5:i>=vk&&(r*=2),t<e?-r:r}function B$(e,t){let n;for(const s of e)s!=null&&(n<s||n===void 0&&s>=s)&&(n=s);return n}function H$(e,t){let n;for(const s of e)s!=null&&(n>s||n===void 0&&s>=s)&&(n=s);return n}function jq(e,t,n=0,s=e.length-1,r=vx){for(;s>n;){if(s-n>600){const c=s-n+1,u=t-n+1,d=Math.log(c),h=.5*Math.exp(2*d/3),p=.5*Math.sqrt(d*h*(c-h)/c)*(u-c/2<0?-1:1),x=Math.max(n,Math.floor(t-u*h/c+p)),v=Math.min(s,Math.floor(t+(c-u)*h/c+p));jq(e,t,x,v,r)}const i=e[t];let o=n,l=s;for(xg(e,n,t),r(e[s],i)>0&&xg(e,n,s);o<l;){for(xg(e,o,l),++o,--l;r(e[o],i)<0;)++o;for(;r(e[l],i)>0;)--l}r(e[n],i)===0?xg(e,n,l):(++l,xg(e,l,s)),l<=t&&(n=l+1),t<=l&&(s=l-1)}return e}function xg(e,t,n){const s=e[t];e[t]=e[n],e[n]=s}function ofe(e,t,n){if(e=Float64Array.from(afe(e)),!!(s=e.length)){if((t=+t)<=0||s<2)return H$(e);if(t>=1)return B$(e);var s,r=(s-1)*t,i=Math.floor(r),o=B$(jq(e,i).subarray(0,i+1)),l=H$(e.subarray(i+1));return o+(l-o)*(r-i)}}function lfe(e,t,n=vq){if(s=e.length){if((t=+t)<=0||s<2)return+n(e[0],0,e);if(t>=1)return+n(e[s-1],s-1,e);var s,r=(s-1)*t,i=Math.floor(r),o=+n(e[i],i,e),l=+n(e[i+1],i+1,e);return o+(l-o)*(r-i)}}function Nq(e,t,n){e=+e,t=+t,n=(r=arguments.length)<2?(t=e,e=0,1):r<3?1:+n;for(var s=-1,r=Math.max(0,Math.ceil((t-e)/n))|0,i=new Array(r);++s<r;)i[s]=e+s*n;return i}function ki(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function rc(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const Nk=Symbol("implicit");function Cp(){var e=new Ov,t=[],n=[],s=Nk;function r(i){let o=e.get(i);if(o===void 0){if(s!==Nk)return s;e.set(i,o=t.push(i)-1)}return n[o%n.length]}return r.domain=function(i){if(!arguments.length)return t.slice();t=[],e=new Ov;for(const o of i)e.has(o)||e.set(o,t.push(o)-1);return r},r.range=function(i){return arguments.length?(n=Array.from(i),r):n.slice()},r.unknown=function(i){return arguments.length?(s=i,r):s},r.copy=function(){return Cp(t,n).unknown(s)},ki.apply(r,arguments),r}function a4(){var e=Cp().unknown(void 0),t=e.domain,n=e.range,s=0,r=1,i,o,l=!1,c=0,u=0,d=.5;delete e.unknown;function h(){var p=t().length,x=r<s,v=x?r:s,j=x?s:r;i=(j-v)/Math.max(1,p-c+u*2),l&&(i=Math.floor(i)),v+=(j-v-i*(p-c))*d,o=i*(1-c),l&&(v=Math.round(v),o=Math.round(o));var y=Nq(p).map(function(N){return v+i*N});return n(x?y.reverse():y)}return e.domain=function(p){return arguments.length?(t(p),h()):t()},e.range=function(p){return arguments.length?([s,r]=p,s=+s,r=+r,h()):[s,r]},e.rangeRound=function(p){return[s,r]=p,s=+s,r=+r,l=!0,h()},e.bandwidth=function(){return o},e.step=function(){return i},e.round=function(p){return arguments.length?(l=!!p,h()):l},e.padding=function(p){return arguments.length?(c=Math.min(1,u=+p),h()):c},e.paddingInner=function(p){return arguments.length?(c=Math.min(1,p),h()):c},e.paddingOuter=function(p){return arguments.length?(u=+p,h()):u},e.align=function(p){return arguments.length?(d=Math.max(0,Math.min(1,p)),h()):d},e.copy=function(){return a4(t(),[s,r]).round(l).paddingInner(c).paddingOuter(u).align(d)},ki.apply(h(),arguments)}function Cq(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return Cq(t())},e}function cfe(){return Cq(a4.apply(null,arguments).paddingInner(1))}function n4(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Sq(e,t){var n=Object.create(e.prototype);for(var s in t)n[s]=t[s];return n}function jx(){}var Sp=.7,Mv=1/Sp,bf="\\s*([+-]?\\d+)\\s*",_p="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Io="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",dfe=/^#([0-9a-f]{3,8})$/,ufe=new RegExp(`^rgb\\(${bf},${bf},${bf}\\)$`),mfe=new RegExp(`^rgb\\(${Io},${Io},${Io}\\)$`),ffe=new RegExp(`^rgba\\(${bf},${bf},${bf},${_p}\\)$`),hfe=new RegExp(`^rgba\\(${Io},${Io},${Io},${_p}\\)$`),gfe=new RegExp(`^hsl\\(${_p},${Io},${Io}\\)$`),pfe=new RegExp(`^hsla\\(${_p},${Io},${Io},${_p}\\)$`),q$={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};n4(jx,Ap,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:G$,formatHex:G$,formatHex8:xfe,formatHsl:yfe,formatRgb:W$,toString:W$});function G$(){return this.rgb().formatHex()}function xfe(){return this.rgb().formatHex8()}function yfe(){return _q(this).formatHsl()}function W$(){return this.rgb().formatRgb()}function Ap(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=dfe.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?V$(t):n===3?new hr(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Qy(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Qy(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=ufe.exec(e))?new hr(t[1],t[2],t[3],1):(t=mfe.exec(e))?new hr(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=ffe.exec(e))?Qy(t[1],t[2],t[3],t[4]):(t=hfe.exec(e))?Qy(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=gfe.exec(e))?K$(t[1],t[2]/100,t[3]/100,1):(t=pfe.exec(e))?K$(t[1],t[2]/100,t[3]/100,t[4]):q$.hasOwnProperty(e)?V$(q$[e]):e==="transparent"?new hr(NaN,NaN,NaN,0):null}function V$(e){return new hr(e>>16&255,e>>8&255,e&255,1)}function Qy(e,t,n,s){return s<=0&&(e=t=n=NaN),new hr(e,t,n,s)}function bfe(e){return e instanceof jx||(e=Ap(e)),e?(e=e.rgb(),new hr(e.r,e.g,e.b,e.opacity)):new hr}function Ck(e,t,n,s){return arguments.length===1?bfe(e):new hr(e,t,n,s??1)}function hr(e,t,n,s){this.r=+e,this.g=+t,this.b=+n,this.opacity=+s}n4(hr,Ck,Sq(jx,{brighter(e){return e=e==null?Mv:Math.pow(Mv,e),new hr(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Sp:Math.pow(Sp,e),new hr(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new hr(Nu(this.r),Nu(this.g),Nu(this.b),Iv(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Y$,formatHex:Y$,formatHex8:vfe,formatRgb:Q$,toString:Q$}));function Y$(){return`#${hu(this.r)}${hu(this.g)}${hu(this.b)}`}function vfe(){return`#${hu(this.r)}${hu(this.g)}${hu(this.b)}${hu((isNaN(this.opacity)?1:this.opacity)*255)}`}function Q$(){const e=Iv(this.opacity);return`${e===1?"rgb(":"rgba("}${Nu(this.r)}, ${Nu(this.g)}, ${Nu(this.b)}${e===1?")":`, ${e})`}`}function Iv(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Nu(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function hu(e){return e=Nu(e),(e<16?"0":"")+e.toString(16)}function K$(e,t,n,s){return s<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Bi(e,t,n,s)}function _q(e){if(e instanceof Bi)return new Bi(e.h,e.s,e.l,e.opacity);if(e instanceof jx||(e=Ap(e)),!e)return new Bi;if(e instanceof Bi)return e;e=e.rgb();var t=e.r/255,n=e.g/255,s=e.b/255,r=Math.min(t,n,s),i=Math.max(t,n,s),o=NaN,l=i-r,c=(i+r)/2;return l?(t===i?o=(n-s)/l+(n<s)*6:n===i?o=(s-t)/l+2:o=(t-n)/l+4,l/=c<.5?i+r:2-i-r,o*=60):l=c>0&&c<1?0:o,new Bi(o,l,c,e.opacity)}function wfe(e,t,n,s){return arguments.length===1?_q(e):new Bi(e,t,n,s??1)}function Bi(e,t,n,s){this.h=+e,this.s=+t,this.l=+n,this.opacity=+s}n4(Bi,wfe,Sq(jx,{brighter(e){return e=e==null?Mv:Math.pow(Mv,e),new Bi(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Sp:Math.pow(Sp,e),new Bi(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,s=n+(n<.5?n:1-n)*t,r=2*n-s;return new hr(p2(e>=240?e-240:e+120,r,s),p2(e,r,s),p2(e<120?e+240:e-120,r,s),this.opacity)},clamp(){return new Bi(X$(this.h),Ky(this.s),Ky(this.l),Iv(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Iv(this.opacity);return`${e===1?"hsl(":"hsla("}${X$(this.h)}, ${Ky(this.s)*100}%, ${Ky(this.l)*100}%${e===1?")":`, ${e})`}`}}));function X$(e){return e=(e||0)%360,e<0?e+360:e}function Ky(e){return Math.max(0,Math.min(1,e||0))}function p2(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const s4=e=>()=>e;function jfe(e,t){return function(n){return e+n*t}}function Nfe(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(s){return Math.pow(e+s*t,n)}}function Cfe(e){return(e=+e)==1?Aq:function(t,n){return n-t?Nfe(t,n,e):s4(isNaN(t)?n:t)}}function Aq(e,t){var n=t-e;return n?jfe(e,n):s4(isNaN(e)?t:e)}const Z$=(function e(t){var n=Cfe(t);function s(r,i){var o=n((r=Ck(r)).r,(i=Ck(i)).r),l=n(r.g,i.g),c=n(r.b,i.b),u=Aq(r.opacity,i.opacity);return function(d){return r.r=o(d),r.g=l(d),r.b=c(d),r.opacity=u(d),r+""}}return s.gamma=e,s})(1);function Sfe(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,s=t.slice(),r;return function(i){for(r=0;r<n;++r)s[r]=e[r]*(1-i)+t[r]*i;return s}}function _fe(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Afe(e,t){var n=t?t.length:0,s=e?Math.min(n,e.length):0,r=new Array(s),i=new Array(n),o;for(o=0;o<s;++o)r[o]=sh(e[o],t[o]);for(;o<n;++o)i[o]=t[o];return function(l){for(o=0;o<s;++o)i[o]=r[o](l);return i}}function r4(e,t){var n=new Date;return e=+e,t=+t,function(s){return n.setTime(e*(1-s)+t*s),n}}function kf(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function Tfe(e,t){var n={},s={},r;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(r in t)r in e?n[r]=sh(e[r],t[r]):s[r]=t[r];return function(i){for(r in n)s[r]=n[r](i);return s}}var Sk=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,x2=new RegExp(Sk.source,"g");function kfe(e){return function(){return e}}function Efe(e){return function(t){return e(t)+""}}function i4(e,t){var n=Sk.lastIndex=x2.lastIndex=0,s,r,i,o=-1,l=[],c=[];for(e=e+"",t=t+"";(s=Sk.exec(e))&&(r=x2.exec(t));)(i=r.index)>n&&(i=t.slice(n,i),l[o]?l[o]+=i:l[++o]=i),(s=s[0])===(r=r[0])?l[o]?l[o]+=r:l[++o]=r:(l[++o]=null,c.push({i:o,x:kf(s,r)})),n=x2.lastIndex;return n<t.length&&(i=t.slice(n),l[o]?l[o]+=i:l[++o]=i),l.length<2?c[0]?Efe(c[0].x):kfe(t):(t=c.length,function(u){for(var d=0,h;d<t;++d)l[(h=c[d]).i]=h.x(u);return l.join("")})}function sh(e,t){var n=typeof t,s;return t==null||n==="boolean"?s4(t):(n==="number"?kf:n==="string"?(s=Ap(t))?(t=s,Z$):i4:t instanceof Ap?Z$:t instanceof Date?r4:_fe(t)?Sfe:Array.isArray(t)?Afe:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?Tfe:kf)(e,t)}function o4(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function Lfe(e,t){t===void 0&&(t=e,e=sh);for(var n=0,s=t.length-1,r=t[0],i=new Array(s<0?0:s);n<s;)i[n]=e(r,r=t[++n]);return function(o){var l=Math.max(0,Math.min(s-1,Math.floor(o*=s)));return i[l](o-l)}}function Pfe(e){return function(){return e}}function $v(e){return+e}var J$=[0,1];function Vs(e){return e}function _k(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:Pfe(isNaN(t)?NaN:.5)}function Dfe(e,t){var n;return e>t&&(n=e,e=t,t=n),function(s){return Math.max(e,Math.min(t,s))}}function Ofe(e,t,n){var s=e[0],r=e[1],i=t[0],o=t[1];return r<s?(s=_k(r,s),i=n(o,i)):(s=_k(s,r),i=n(i,o)),function(l){return i(s(l))}}function Mfe(e,t,n){var s=Math.min(e.length,t.length)-1,r=new Array(s),i=new Array(s),o=-1;for(e[s]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<s;)r[o]=_k(e[o],e[o+1]),i[o]=n(t[o],t[o+1]);return function(l){var c=wx(e,l,1,s)-1;return i[c](r[c](l))}}function Nx(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function qj(){var e=J$,t=J$,n=sh,s,r,i,o=Vs,l,c,u;function d(){var p=Math.min(e.length,t.length);return o!==Vs&&(o=Dfe(e[0],e[p-1])),l=p>2?Mfe:Ofe,c=u=null,h}function h(p){return p==null||isNaN(p=+p)?i:(c||(c=l(e.map(s),t,n)))(s(o(p)))}return h.invert=function(p){return o(r((u||(u=l(t,e.map(s),kf)))(p)))},h.domain=function(p){return arguments.length?(e=Array.from(p,$v),d()):e.slice()},h.range=function(p){return arguments.length?(t=Array.from(p),d()):t.slice()},h.rangeRound=function(p){return t=Array.from(p),n=o4,d()},h.clamp=function(p){return arguments.length?(o=p?!0:Vs,d()):o!==Vs},h.interpolate=function(p){return arguments.length?(n=p,d()):n},h.unknown=function(p){return arguments.length?(i=p,h):i},function(p,x){return s=p,r=x,d()}}function l4(){return qj()(Vs,Vs)}function Ife(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Rv(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,s=e.slice(0,n);return[s.length>1?s[0]+s.slice(2):s,+e.slice(n+1)]}function Ef(e){return e=Rv(Math.abs(e)),e?e[1]:NaN}function $fe(e,t){return function(n,s){for(var r=n.length,i=[],o=0,l=e[0],c=0;r>0&&l>0&&(c+l+1>s&&(l=Math.max(1,s-c)),i.push(n.substring(r-=l,r+l)),!((c+=l+1)>s));)l=e[o=(o+1)%e.length];return i.reverse().join(t)}}function Rfe(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var zfe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Tp(e){if(!(t=zfe.exec(e)))throw new Error("invalid format: "+e);var t;return new c4({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Tp.prototype=c4.prototype;function c4(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}c4.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Ffe(e){e:for(var t=e.length,n=1,s=-1,r;n<t;++n)switch(e[n]){case".":s=r=n;break;case"0":s===0&&(s=n),r=n;break;default:if(!+e[n])break e;s>0&&(s=0);break}return s>0?e.slice(0,s)+e.slice(r+1):e}var Tq;function Ufe(e,t){var n=Rv(e,t);if(!n)return e+"";var s=n[0],r=n[1],i=r-(Tq=Math.max(-8,Math.min(8,Math.floor(r/3)))*3)+1,o=s.length;return i===o?s:i>o?s+new Array(i-o+1).join("0"):i>0?s.slice(0,i)+"."+s.slice(i):"0."+new Array(1-i).join("0")+Rv(e,Math.max(0,t+i-1))[0]}function e6(e,t){var n=Rv(e,t);if(!n)return e+"";var s=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+s:s.length>r+1?s.slice(0,r+1)+"."+s.slice(r+1):s+new Array(r-s.length+2).join("0")}const t6={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:Ife,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>e6(e*100,t),r:e6,s:Ufe,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function a6(e){return e}var n6=Array.prototype.map,s6=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function Bfe(e){var t=e.grouping===void 0||e.thousands===void 0?a6:$fe(n6.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",s=e.currency===void 0?"":e.currency[1]+"",r=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?a6:Rfe(n6.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",l=e.minus===void 0?"":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function u(h){h=Tp(h);var p=h.fill,x=h.align,v=h.sign,j=h.symbol,y=h.zero,N=h.width,w=h.comma,S=h.precision,_=h.trim,k=h.type;k==="n"?(w=!0,k="g"):t6[k]||(S===void 0&&(S=12),_=!0,k="g"),(y||p==="0"&&x==="=")&&(y=!0,p="0",x="=");var T=j==="$"?n:j==="#"&&/[boxX]/.test(k)?"0"+k.toLowerCase():"",A=j==="$"?s:/[%p]/.test(k)?o:"",E=t6[k],M=/[defgprs%]/.test(k);S=S===void 0?6:/[gprs]/.test(k)?Math.max(1,Math.min(21,S)):Math.max(0,Math.min(20,S));function z(P){var D=T,U=A,B,R,q;if(k==="c")U=E(P)+U,P="";else{P=+P;var Z=P<0||1/P<0;if(P=isNaN(P)?c:E(Math.abs(P),S),_&&(P=Ffe(P)),Z&&+P==0&&v!=="+"&&(Z=!1),D=(Z?v==="("?v:l:v==="-"||v==="("?"":v)+D,U=(k==="s"?s6[8+Tq/3]:"")+U+(Z&&v==="("?")":""),M){for(B=-1,R=P.length;++B<R;)if(q=P.charCodeAt(B),48>q||q>57){U=(q===46?r+P.slice(B+1):P.slice(B))+U,P=P.slice(0,B);break}}}w&&!y&&(P=t(P,1/0));var V=D.length+P.length+U.length,oe=V<N?new Array(N-V+1).join(p):"";switch(w&&y&&(P=t(oe+P,oe.length?N-U.length:1/0),oe=""),x){case"<":P=D+P+U+oe;break;case"=":P=D+oe+P+U;break;case"^":P=oe.slice(0,V=oe.length>>1)+D+P+U+oe.slice(V);break;default:P=oe+D+P+U;break}return i(P)}return z.toString=function(){return h+""},z}function d(h,p){var x=u((h=Tp(h),h.type="f",h)),v=Math.max(-8,Math.min(8,Math.floor(Ef(p)/3)))*3,j=Math.pow(10,-v),y=s6[8+v/3];return function(N){return x(j*N)+y}}return{format:u,formatPrefix:d}}var Xy,d4,kq;Hfe({thousands:",",grouping:[3],currency:["$",""]});function Hfe(e){return Xy=Bfe(e),d4=Xy.format,kq=Xy.formatPrefix,Xy}function qfe(e){return Math.max(0,-Ef(Math.abs(e)))}function Gfe(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Ef(t)/3)))*3-Ef(Math.abs(e)))}function Wfe(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Ef(t)-Ef(e))+1}function Eq(e,t,n,s){var r=jk(e,t,n),i;switch(s=Tp(s??",f"),s.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return s.precision==null&&!isNaN(i=Gfe(r,o))&&(s.precision=i),kq(s,o)}case"":case"e":case"g":case"p":case"r":{s.precision==null&&!isNaN(i=Wfe(r,Math.max(Math.abs(e),Math.abs(t))))&&(s.precision=i-(s.type==="e"));break}case"f":case"%":{s.precision==null&&!isNaN(i=qfe(r))&&(s.precision=i-(s.type==="%")*2);break}}return d4(s)}function _d(e){var t=e.domain;return e.ticks=function(n){var s=t();return wk(s[0],s[s.length-1],n??10)},e.tickFormat=function(n,s){var r=t();return Eq(r[0],r[r.length-1],n??10,s)},e.nice=function(n){n==null&&(n=10);var s=t(),r=0,i=s.length-1,o=s[r],l=s[i],c,u,d=10;for(l<o&&(u=o,o=l,l=u,u=r,r=i,i=u);d-- >0;){if(u=wq(o,l,n),u===c)return s[r]=o,s[i]=l,t(s);if(u>0)o=Math.floor(o/u)*u,l=Math.ceil(l/u)*u;else if(u<0)o=Math.ceil(o*u)/u,l=Math.floor(l*u)/u;else break;c=u}return e},e}function Gj(){var e=l4();return e.copy=function(){return Nx(e,Gj())},ki.apply(e,arguments),_d(e)}function Lq(e){var t;function n(s){return s==null||isNaN(s=+s)?t:s}return n.invert=n,n.domain=n.range=function(s){return arguments.length?(e=Array.from(s,$v),n):e.slice()},n.unknown=function(s){return arguments.length?(t=s,n):t},n.copy=function(){return Lq(e).unknown(t)},e=arguments.length?Array.from(e,$v):[0,1],_d(n)}function Pq(e,t){e=e.slice();var n=0,s=e.length-1,r=e[n],i=e[s],o;return i<r&&(o=n,n=s,s=o,o=r,r=i,i=o),e[n]=t.floor(r),e[s]=t.ceil(i),e}function r6(e){return Math.log(e)}function i6(e){return Math.exp(e)}function Vfe(e){return-Math.log(-e)}function Yfe(e){return-Math.exp(-e)}function Qfe(e){return isFinite(e)?+("1e"+e):e<0?0:e}function Kfe(e){return e===10?Qfe:e===Math.E?Math.exp:t=>Math.pow(e,t)}function Xfe(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function o6(e){return(t,n)=>-e(-t,n)}function u4(e){const t=e(r6,i6),n=t.domain;let s=10,r,i;function o(){return r=Xfe(s),i=Kfe(s),n()[0]<0?(r=o6(r),i=o6(i),e(Vfe,Yfe)):e(r6,i6),t}return t.base=function(l){return arguments.length?(s=+l,o()):s},t.domain=function(l){return arguments.length?(n(l),o()):n()},t.ticks=l=>{const c=n();let u=c[0],d=c[c.length-1];const h=d<u;h&&([u,d]=[d,u]);let p=r(u),x=r(d),v,j;const y=l==null?10:+l;let N=[];if(!(s%1)&&x-p<y){if(p=Math.floor(p),x=Math.ceil(x),u>0){for(;p<=x;++p)for(v=1;v<s;++v)if(j=p<0?v/i(-p):v*i(p),!(j<u)){if(j>d)break;N.push(j)}}else for(;p<=x;++p)for(v=s-1;v>=1;--v)if(j=p>0?v/i(-p):v*i(p),!(j<u)){if(j>d)break;N.push(j)}N.length*2<y&&(N=wk(u,d,y))}else N=wk(p,x,Math.min(x-p,y)).map(i);return h?N.reverse():N},t.tickFormat=(l,c)=>{if(l==null&&(l=10),c==null&&(c=s===10?"s":","),typeof c!="function"&&(!(s%1)&&(c=Tp(c)).precision==null&&(c.trim=!0),c=d4(c)),l===1/0)return c;const u=Math.max(1,s*l/t.ticks().length);return d=>{let h=d/i(Math.round(r(d)));return h*s<s-.5&&(h*=s),h<=u?c(d):""}},t.nice=()=>n(Pq(n(),{floor:l=>i(Math.floor(r(l))),ceil:l=>i(Math.ceil(r(l)))})),t}function kp(){const e=u4(qj()).domain([1,10]);return e.copy=()=>Nx(e,kp()).base(e.base()),ki.apply(e,arguments),e}function l6(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function c6(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function m4(e){var t=1,n=e(l6(t),c6(t));return n.constant=function(s){return arguments.length?e(l6(t=+s),c6(t)):t},_d(n)}function f4(){var e=m4(qj());return e.copy=function(){return Nx(e,f4()).constant(e.constant())},ki.apply(e,arguments)}function d6(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function Zfe(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function Jfe(e){return e<0?-e*e:e*e}function h4(e){var t=e(Vs,Vs),n=1;function s(){return n===1?e(Vs,Vs):n===.5?e(Zfe,Jfe):e(d6(n),d6(1/n))}return t.exponent=function(r){return arguments.length?(n=+r,s()):n},_d(t)}function Wj(){var e=h4(qj());return e.copy=function(){return Nx(e,Wj()).exponent(e.exponent())},ki.apply(e,arguments),e}function Dq(){return Wj.apply(null,arguments).exponent(.5)}function u6(e){return Math.sign(e)*e*e}function ehe(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function Oq(){var e=l4(),t=[0,1],n=!1,s;function r(i){var o=ehe(e(i));return isNaN(o)?s:n?Math.round(o):o}return r.invert=function(i){return e.invert(u6(i))},r.domain=function(i){return arguments.length?(e.domain(i),r):e.domain()},r.range=function(i){return arguments.length?(e.range((t=Array.from(i,$v)).map(u6)),r):t.slice()},r.rangeRound=function(i){return r.range(i).round(!0)},r.round=function(i){return arguments.length?(n=!!i,r):n},r.clamp=function(i){return arguments.length?(e.clamp(i),r):e.clamp()},r.unknown=function(i){return arguments.length?(s=i,r):s},r.copy=function(){return Oq(e.domain(),t).round(n).clamp(e.clamp()).unknown(s)},ki.apply(r,arguments),_d(r)}function Mq(){var e=[],t=[],n=[],s;function r(){var o=0,l=Math.max(1,t.length);for(n=new Array(l-1);++o<l;)n[o-1]=lfe(e,o/l);return i}function i(o){return o==null||isNaN(o=+o)?s:t[wx(n,o)]}return i.invertExtent=function(o){var l=t.indexOf(o);return l<0?[NaN,NaN]:[l>0?n[l-1]:e[0],l<n.length?n[l]:e[e.length-1]]},i.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let l of o)l!=null&&!isNaN(l=+l)&&e.push(l);return e.sort(vx),r()},i.range=function(o){return arguments.length?(t=Array.from(o),r()):t.slice()},i.unknown=function(o){return arguments.length?(s=o,i):s},i.quantiles=function(){return n.slice()},i.copy=function(){return Mq().domain(e).range(t).unknown(s)},ki.apply(i,arguments)}function Iq(){var e=0,t=1,n=1,s=[.5],r=[0,1],i;function o(c){return c!=null&&c<=c?r[wx(s,c,0,n)]:i}function l(){var c=-1;for(s=new Array(n);++c<n;)s[c]=((c+1)*t-(c-n)*e)/(n+1);return o}return o.domain=function(c){return arguments.length?([e,t]=c,e=+e,t=+t,l()):[e,t]},o.range=function(c){return arguments.length?(n=(r=Array.from(c)).length-1,l()):r.slice()},o.invertExtent=function(c){var u=r.indexOf(c);return u<0?[NaN,NaN]:u<1?[e,s[0]]:u>=n?[s[n-1],t]:[s[u-1],s[u]]},o.unknown=function(c){return arguments.length&&(i=c),o},o.thresholds=function(){return s.slice()},o.copy=function(){return Iq().domain([e,t]).range(r).unknown(i)},ki.apply(_d(o),arguments)}function g4(){var e=[.5],t=[0,1],n,s=1;function r(i){return i!=null&&i<=i?t[wx(e,i,0,s)]:n}return r.domain=function(i){return arguments.length?(e=Array.from(i),s=Math.min(e.length,t.length-1),r):e.slice()},r.range=function(i){return arguments.length?(t=Array.from(i),s=Math.min(e.length,t.length-1),r):t.slice()},r.invertExtent=function(i){var o=t.indexOf(i);return[e[o-1],e[o]]},r.unknown=function(i){return arguments.length?(n=i,r):n},r.copy=function(){return g4().domain(e).range(t).unknown(n)},ki.apply(r,arguments)}const y2=new Date,b2=new Date;function os(e,t,n,s){function r(i){return e(i=arguments.length===0?new Date:new Date(+i)),i}return r.floor=i=>(e(i=new Date(+i)),i),r.ceil=i=>(e(i=new Date(i-1)),t(i,1),e(i),i),r.round=i=>{const o=r(i),l=r.ceil(i);return i-o<l-i?o:l},r.offset=(i,o)=>(t(i=new Date(+i),o==null?1:Math.floor(o)),i),r.range=(i,o,l)=>{const c=[];if(i=r.ceil(i),l=l==null?1:Math.floor(l),!(i<o)||!(l>0))return c;let u;do c.push(u=new Date(+i)),t(i,l),e(i);while(u<i&&i<o);return c},r.filter=i=>os(o=>{if(o>=o)for(;e(o),!i(o);)o.setTime(o-1)},(o,l)=>{if(o>=o)if(l<0)for(;++l<=0;)for(;t(o,-1),!i(o););else for(;--l>=0;)for(;t(o,1),!i(o););}),n&&(r.count=(i,o)=>(y2.setTime(+i),b2.setTime(+o),e(y2),e(b2),Math.floor(n(y2,b2))),r.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?r.filter(s?o=>s(o)%i===0:o=>r.count(0,o)%i===0):r)),r}const zv=os(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);zv.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?os(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):zv);zv.range;const Ll=1e3,gi=Ll*60,Pl=gi*60,ql=Pl*24,p4=ql*7,m6=ql*30,v2=ql*365,gu=os(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Ll)},(e,t)=>(t-e)/Ll,e=>e.getUTCSeconds());gu.range;const x4=os(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Ll)},(e,t)=>{e.setTime(+e+t*gi)},(e,t)=>(t-e)/gi,e=>e.getMinutes());x4.range;const y4=os(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*gi)},(e,t)=>(t-e)/gi,e=>e.getUTCMinutes());y4.range;const b4=os(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Ll-e.getMinutes()*gi)},(e,t)=>{e.setTime(+e+t*Pl)},(e,t)=>(t-e)/Pl,e=>e.getHours());b4.range;const v4=os(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Pl)},(e,t)=>(t-e)/Pl,e=>e.getUTCHours());v4.range;const Cx=os(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*gi)/ql,e=>e.getDate()-1);Cx.range;const Vj=os(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/ql,e=>e.getUTCDate()-1);Vj.range;const $q=os(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/ql,e=>Math.floor(e/ql));$q.range;function em(e){return os(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*gi)/p4)}const Yj=em(0),Fv=em(1),the=em(2),ahe=em(3),Lf=em(4),nhe=em(5),she=em(6);Yj.range;Fv.range;the.range;ahe.range;Lf.range;nhe.range;she.range;function tm(e){return os(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/p4)}const Qj=tm(0),Uv=tm(1),rhe=tm(2),ihe=tm(3),Pf=tm(4),ohe=tm(5),lhe=tm(6);Qj.range;Uv.range;rhe.range;ihe.range;Pf.range;ohe.range;lhe.range;const w4=os(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());w4.range;const j4=os(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());j4.range;const Gl=os(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Gl.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:os(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});Gl.range;const Wl=os(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Wl.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:os(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});Wl.range;function Rq(e,t,n,s,r,i){const o=[[gu,1,Ll],[gu,5,5*Ll],[gu,15,15*Ll],[gu,30,30*Ll],[i,1,gi],[i,5,5*gi],[i,15,15*gi],[i,30,30*gi],[r,1,Pl],[r,3,3*Pl],[r,6,6*Pl],[r,12,12*Pl],[s,1,ql],[s,2,2*ql],[n,1,p4],[t,1,m6],[t,3,3*m6],[e,1,v2]];function l(u,d,h){const p=d<u;p&&([u,d]=[d,u]);const x=h&&typeof h.range=="function"?h:c(u,d,h),v=x?x.range(u,+d+1):[];return p?v.reverse():v}function c(u,d,h){const p=Math.abs(d-u)/h,x=t4(([,,y])=>y).right(o,p);if(x===o.length)return e.every(jk(u/v2,d/v2,h));if(x===0)return zv.every(Math.max(jk(u,d,h),1));const[v,j]=o[p/o[x-1][2]<o[x][2]/p?x-1:x];return v.every(j)}return[l,c]}const[che,dhe]=Rq(Wl,j4,Qj,$q,v4,y4),[uhe,mhe]=Rq(Gl,w4,Yj,Cx,b4,x4);function w2(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function j2(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function yg(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function fhe(e){var t=e.dateTime,n=e.date,s=e.time,r=e.periods,i=e.days,o=e.shortDays,l=e.months,c=e.shortMonths,u=bg(r),d=vg(r),h=bg(i),p=vg(i),x=bg(o),v=vg(o),j=bg(l),y=vg(l),N=bg(c),w=vg(c),S={a:Z,A:V,b:oe,B:je,c:null,d:y6,e:y6,f:Ihe,g:Whe,G:Yhe,H:Dhe,I:Ohe,j:Mhe,L:zq,m:$he,M:Rhe,p:X,q:se,Q:w6,s:j6,S:zhe,u:Fhe,U:Uhe,V:Bhe,w:Hhe,W:qhe,x:null,X:null,y:Ghe,Y:Vhe,Z:Qhe,"%":v6},_={a:ye,A:Ne,b:fe,B:we,c:null,d:b6,e:b6,f:Jhe,g:cge,G:uge,H:Khe,I:Xhe,j:Zhe,L:Uq,m:ege,M:tge,p:de,q:ke,Q:w6,s:j6,S:age,u:nge,U:sge,V:rge,w:ige,W:oge,x:null,X:null,y:lge,Y:dge,Z:mge,"%":v6},k={a:z,A:P,b:D,B:U,c:B,d:p6,e:p6,f:khe,g:g6,G:h6,H:x6,I:x6,j:She,L:The,m:Che,M:_he,p:M,q:Nhe,Q:Lhe,s:Phe,S:Ahe,u:yhe,U:bhe,V:vhe,w:xhe,W:whe,x:R,X:q,y:g6,Y:h6,Z:jhe,"%":Ehe};S.x=T(n,S),S.X=T(s,S),S.c=T(t,S),_.x=T(n,_),_.X=T(s,_),_.c=T(t,_);function T(ge,$e){return function(be){var me=[],Ue=-1,Ee=0,We=ge.length,tt,lt,Fe;for(be instanceof Date||(be=new Date(+be));++Ue<We;)ge.charCodeAt(Ue)===37&&(me.push(ge.slice(Ee,Ue)),(lt=f6[tt=ge.charAt(++Ue)])!=null?tt=ge.charAt(++Ue):lt=tt==="e"?" ":"0",(Fe=$e[tt])&&(tt=Fe(be,lt)),me.push(tt),Ee=Ue+1);return me.push(ge.slice(Ee,Ue)),me.join("")}}function A(ge,$e){return function(be){var me=yg(1900,void 0,1),Ue=E(me,ge,be+="",0),Ee,We;if(Ue!=be.length)return null;if("Q"in me)return new Date(me.Q);if("s"in me)return new Date(me.s*1e3+("L"in me?me.L:0));if($e&&!("Z"in me)&&(me.Z=0),"p"in me&&(me.H=me.H%12+me.p*12),me.m===void 0&&(me.m="q"in me?me.q:0),"V"in me){if(me.V<1||me.V>53)return null;"w"in me||(me.w=1),"Z"in me?(Ee=j2(yg(me.y,0,1)),We=Ee.getUTCDay(),Ee=We>4||We===0?Uv.ceil(Ee):Uv(Ee),Ee=Vj.offset(Ee,(me.V-1)*7),me.y=Ee.getUTCFullYear(),me.m=Ee.getUTCMonth(),me.d=Ee.getUTCDate()+(me.w+6)%7):(Ee=w2(yg(me.y,0,1)),We=Ee.getDay(),Ee=We>4||We===0?Fv.ceil(Ee):Fv(Ee),Ee=Cx.offset(Ee,(me.V-1)*7),me.y=Ee.getFullYear(),me.m=Ee.getMonth(),me.d=Ee.getDate()+(me.w+6)%7)}else("W"in me||"U"in me)&&("w"in me||(me.w="u"in me?me.u%7:"W"in me?1:0),We="Z"in me?j2(yg(me.y,0,1)).getUTCDay():w2(yg(me.y,0,1)).getDay(),me.m=0,me.d="W"in me?(me.w+6)%7+me.W*7-(We+5)%7:me.w+me.U*7-(We+6)%7);return"Z"in me?(me.H+=me.Z/100|0,me.M+=me.Z%100,j2(me)):w2(me)}}function E(ge,$e,be,me){for(var Ue=0,Ee=$e.length,We=be.length,tt,lt;Ue<Ee;){if(me>=We)return-1;if(tt=$e.charCodeAt(Ue++),tt===37){if(tt=$e.charAt(Ue++),lt=k[tt in f6?$e.charAt(Ue++):tt],!lt||(me=lt(ge,be,me))<0)return-1}else if(tt!=be.charCodeAt(me++))return-1}return me}function M(ge,$e,be){var me=u.exec($e.slice(be));return me?(ge.p=d.get(me[0].toLowerCase()),be+me[0].length):-1}function z(ge,$e,be){var me=x.exec($e.slice(be));return me?(ge.w=v.get(me[0].toLowerCase()),be+me[0].length):-1}function P(ge,$e,be){var me=h.exec($e.slice(be));return me?(ge.w=p.get(me[0].toLowerCase()),be+me[0].length):-1}function D(ge,$e,be){var me=N.exec($e.slice(be));return me?(ge.m=w.get(me[0].toLowerCase()),be+me[0].length):-1}function U(ge,$e,be){var me=j.exec($e.slice(be));return me?(ge.m=y.get(me[0].toLowerCase()),be+me[0].length):-1}function B(ge,$e,be){return E(ge,t,$e,be)}function R(ge,$e,be){return E(ge,n,$e,be)}function q(ge,$e,be){return E(ge,s,$e,be)}function Z(ge){return o[ge.getDay()]}function V(ge){return i[ge.getDay()]}function oe(ge){return c[ge.getMonth()]}function je(ge){return l[ge.getMonth()]}function X(ge){return r[+(ge.getHours()>=12)]}function se(ge){return 1+~~(ge.getMonth()/3)}function ye(ge){return o[ge.getUTCDay()]}function Ne(ge){return i[ge.getUTCDay()]}function fe(ge){return c[ge.getUTCMonth()]}function we(ge){return l[ge.getUTCMonth()]}function de(ge){return r[+(ge.getUTCHours()>=12)]}function ke(ge){return 1+~~(ge.getUTCMonth()/3)}return{format:function(ge){var $e=T(ge+="",S);return $e.toString=function(){return ge},$e},parse:function(ge){var $e=A(ge+="",!1);return $e.toString=function(){return ge},$e},utcFormat:function(ge){var $e=T(ge+="",_);return $e.toString=function(){return ge},$e},utcParse:function(ge){var $e=A(ge+="",!0);return $e.toString=function(){return ge},$e}}}var f6={"-":"",_:" ",0:"0"},bs=/^\s*\d+/,hhe=/^%/,ghe=/[\\^$*+?|[\]().{}]/g;function Aa(e,t,n){var s=e<0?"-":"",r=(s?-e:e)+"",i=r.length;return s+(i<n?new Array(n-i+1).join(t)+r:r)}function phe(e){return e.replace(ghe,"\\$&")}function bg(e){return new RegExp("^(?:"+e.map(phe).join("|")+")","i")}function vg(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function xhe(e,t,n){var s=bs.exec(t.slice(n,n+1));return s?(e.w=+s[0],n+s[0].length):-1}function yhe(e,t,n){var s=bs.exec(t.slice(n,n+1));return s?(e.u=+s[0],n+s[0].length):-1}function bhe(e,t,n){var s=bs.exec(t.slice(n,n+2));return s?(e.U=+s[0],n+s[0].length):-1}function vhe(e,t,n){var s=bs.exec(t.slice(n,n+2));return s?(e.V=+s[0],n+s[0].length):-1}function whe(e,t,n){var s=bs.exec(t.slice(n,n+2));return s?(e.W=+s[0],n+s[0].length):-1}function h6(e,t,n){var s=bs.exec(t.slice(n,n+4));return s?(e.y=+s[0],n+s[0].length):-1}function g6(e,t,n){var s=bs.exec(t.slice(n,n+2));return s?(e.y=+s[0]+(+s[0]>68?1900:2e3),n+s[0].length):-1}function jhe(e,t,n){var s=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return s?(e.Z=s[1]?0:-(s[2]+(s[3]||"00")),n+s[0].length):-1}function Nhe(e,t,n){var s=bs.exec(t.slice(n,n+1));return s?(e.q=s[0]*3-3,n+s[0].length):-1}function Che(e,t,n){var s=bs.exec(t.slice(n,n+2));return s?(e.m=s[0]-1,n+s[0].length):-1}function p6(e,t,n){var s=bs.exec(t.slice(n,n+2));return s?(e.d=+s[0],n+s[0].length):-1}function She(e,t,n){var s=bs.exec(t.slice(n,n+3));return s?(e.m=0,e.d=+s[0],n+s[0].length):-1}function x6(e,t,n){var s=bs.exec(t.slice(n,n+2));return s?(e.H=+s[0],n+s[0].length):-1}function _he(e,t,n){var s=bs.exec(t.slice(n,n+2));return s?(e.M=+s[0],n+s[0].length):-1}function Ahe(e,t,n){var s=bs.exec(t.slice(n,n+2));return s?(e.S=+s[0],n+s[0].length):-1}function The(e,t,n){var s=bs.exec(t.slice(n,n+3));return s?(e.L=+s[0],n+s[0].length):-1}function khe(e,t,n){var s=bs.exec(t.slice(n,n+6));return s?(e.L=Math.floor(s[0]/1e3),n+s[0].length):-1}function Ehe(e,t,n){var s=hhe.exec(t.slice(n,n+1));return s?n+s[0].length:-1}function Lhe(e,t,n){var s=bs.exec(t.slice(n));return s?(e.Q=+s[0],n+s[0].length):-1}function Phe(e,t,n){var s=bs.exec(t.slice(n));return s?(e.s=+s[0],n+s[0].length):-1}function y6(e,t){return Aa(e.getDate(),t,2)}function Dhe(e,t){return Aa(e.getHours(),t,2)}function Ohe(e,t){return Aa(e.getHours()%12||12,t,2)}function Mhe(e,t){return Aa(1+Cx.count(Gl(e),e),t,3)}function zq(e,t){return Aa(e.getMilliseconds(),t,3)}function Ihe(e,t){return zq(e,t)+"000"}function $he(e,t){return Aa(e.getMonth()+1,t,2)}function Rhe(e,t){return Aa(e.getMinutes(),t,2)}function zhe(e,t){return Aa(e.getSeconds(),t,2)}function Fhe(e){var t=e.getDay();return t===0?7:t}function Uhe(e,t){return Aa(Yj.count(Gl(e)-1,e),t,2)}function Fq(e){var t=e.getDay();return t>=4||t===0?Lf(e):Lf.ceil(e)}function Bhe(e,t){return e=Fq(e),Aa(Lf.count(Gl(e),e)+(Gl(e).getDay()===4),t,2)}function Hhe(e){return e.getDay()}function qhe(e,t){return Aa(Fv.count(Gl(e)-1,e),t,2)}function Ghe(e,t){return Aa(e.getFullYear()%100,t,2)}function Whe(e,t){return e=Fq(e),Aa(e.getFullYear()%100,t,2)}function Vhe(e,t){return Aa(e.getFullYear()%1e4,t,4)}function Yhe(e,t){var n=e.getDay();return e=n>=4||n===0?Lf(e):Lf.ceil(e),Aa(e.getFullYear()%1e4,t,4)}function Qhe(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Aa(t/60|0,"0",2)+Aa(t%60,"0",2)}function b6(e,t){return Aa(e.getUTCDate(),t,2)}function Khe(e,t){return Aa(e.getUTCHours(),t,2)}function Xhe(e,t){return Aa(e.getUTCHours()%12||12,t,2)}function Zhe(e,t){return Aa(1+Vj.count(Wl(e),e),t,3)}function Uq(e,t){return Aa(e.getUTCMilliseconds(),t,3)}function Jhe(e,t){return Uq(e,t)+"000"}function ege(e,t){return Aa(e.getUTCMonth()+1,t,2)}function tge(e,t){return Aa(e.getUTCMinutes(),t,2)}function age(e,t){return Aa(e.getUTCSeconds(),t,2)}function nge(e){var t=e.getUTCDay();return t===0?7:t}function sge(e,t){return Aa(Qj.count(Wl(e)-1,e),t,2)}function Bq(e){var t=e.getUTCDay();return t>=4||t===0?Pf(e):Pf.ceil(e)}function rge(e,t){return e=Bq(e),Aa(Pf.count(Wl(e),e)+(Wl(e).getUTCDay()===4),t,2)}function ige(e){return e.getUTCDay()}function oge(e,t){return Aa(Uv.count(Wl(e)-1,e),t,2)}function lge(e,t){return Aa(e.getUTCFullYear()%100,t,2)}function cge(e,t){return e=Bq(e),Aa(e.getUTCFullYear()%100,t,2)}function dge(e,t){return Aa(e.getUTCFullYear()%1e4,t,4)}function uge(e,t){var n=e.getUTCDay();return e=n>=4||n===0?Pf(e):Pf.ceil(e),Aa(e.getUTCFullYear()%1e4,t,4)}function mge(){return"+0000"}function v6(){return"%"}function w6(e){return+e}function j6(e){return Math.floor(+e/1e3)}var Qm,Hq,qq;fge({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function fge(e){return Qm=fhe(e),Hq=Qm.format,Qm.parse,qq=Qm.utcFormat,Qm.utcParse,Qm}function hge(e){return new Date(e)}function gge(e){return e instanceof Date?+e:+new Date(+e)}function N4(e,t,n,s,r,i,o,l,c,u){var d=l4(),h=d.invert,p=d.domain,x=u(".%L"),v=u(":%S"),j=u("%I:%M"),y=u("%I %p"),N=u("%a %d"),w=u("%b %d"),S=u("%B"),_=u("%Y");function k(T){return(c(T)<T?x:l(T)<T?v:o(T)<T?j:i(T)<T?y:s(T)<T?r(T)<T?N:w:n(T)<T?S:_)(T)}return d.invert=function(T){return new Date(h(T))},d.domain=function(T){return arguments.length?p(Array.from(T,gge)):p().map(hge)},d.ticks=function(T){var A=p();return e(A[0],A[A.length-1],T??10)},d.tickFormat=function(T,A){return A==null?k:u(A)},d.nice=function(T){var A=p();return(!T||typeof T.range!="function")&&(T=t(A[0],A[A.length-1],T??10)),T?p(Pq(A,T)):d},d.copy=function(){return Nx(d,N4(e,t,n,s,r,i,o,l,c,u))},d}function C4(){return ki.apply(N4(uhe,mhe,Gl,w4,Yj,Cx,b4,x4,gu,Hq).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Gq(){return ki.apply(N4(che,dhe,Wl,j4,Qj,Vj,v4,y4,gu,qq).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Kj(){var e=0,t=1,n,s,r,i,o=Vs,l=!1,c;function u(h){return h==null||isNaN(h=+h)?c:o(r===0?.5:(h=(i(h)-n)*r,l?Math.max(0,Math.min(1,h)):h))}u.domain=function(h){return arguments.length?([e,t]=h,n=i(e=+e),s=i(t=+t),r=n===s?0:1/(s-n),u):[e,t]},u.clamp=function(h){return arguments.length?(l=!!h,u):l},u.interpolator=function(h){return arguments.length?(o=h,u):o};function d(h){return function(p){var x,v;return arguments.length?([x,v]=p,o=h(x,v),u):[o(0),o(1)]}}return u.range=d(sh),u.rangeRound=d(o4),u.unknown=function(h){return arguments.length?(c=h,u):c},function(h){return i=h,n=h(e),s=h(t),r=n===s?0:1/(s-n),u}}function Ad(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function S4(){var e=_d(Kj()(Vs));return e.copy=function(){return Ad(e,S4())},rc.apply(e,arguments)}function Wq(){var e=u4(Kj()).domain([1,10]);return e.copy=function(){return Ad(e,Wq()).base(e.base())},rc.apply(e,arguments)}function Vq(){var e=m4(Kj());return e.copy=function(){return Ad(e,Vq()).constant(e.constant())},rc.apply(e,arguments)}function _4(){var e=h4(Kj());return e.copy=function(){return Ad(e,_4()).exponent(e.exponent())},rc.apply(e,arguments)}function pge(){return _4.apply(null,arguments).exponent(.5)}function Yq(){var e=[],t=Vs;function n(s){if(s!=null&&!isNaN(s=+s))return t((wx(e,s,1)-1)/(e.length-1))}return n.domain=function(s){if(!arguments.length)return e.slice();e=[];for(let r of s)r!=null&&!isNaN(r=+r)&&e.push(r);return e.sort(vx),n},n.interpolator=function(s){return arguments.length?(t=s,n):t},n.range=function(){return e.map((s,r)=>t(r/(e.length-1)))},n.quantiles=function(s){return Array.from({length:s+1},(r,i)=>ofe(e,i/s))},n.copy=function(){return Yq(t).domain(e)},rc.apply(n,arguments)}function Xj(){var e=0,t=.5,n=1,s=1,r,i,o,l,c,u=Vs,d,h=!1,p;function x(j){return isNaN(j=+j)?p:(j=.5+((j=+d(j))-i)*(s*j<s*i?l:c),u(h?Math.max(0,Math.min(1,j)):j))}x.domain=function(j){return arguments.length?([e,t,n]=j,r=d(e=+e),i=d(t=+t),o=d(n=+n),l=r===i?0:.5/(i-r),c=i===o?0:.5/(o-i),s=i<r?-1:1,x):[e,t,n]},x.clamp=function(j){return arguments.length?(h=!!j,x):h},x.interpolator=function(j){return arguments.length?(u=j,x):u};function v(j){return function(y){var N,w,S;return arguments.length?([N,w,S]=y,u=Lfe(j,[N,w,S]),x):[u(0),u(.5),u(1)]}}return x.range=v(sh),x.rangeRound=v(o4),x.unknown=function(j){return arguments.length?(p=j,x):p},function(j){return d=j,r=j(e),i=j(t),o=j(n),l=r===i?0:.5/(i-r),c=i===o?0:.5/(o-i),s=i<r?-1:1,x}}function Qq(){var e=_d(Xj()(Vs));return e.copy=function(){return Ad(e,Qq())},rc.apply(e,arguments)}function Kq(){var e=u4(Xj()).domain([.1,1,10]);return e.copy=function(){return Ad(e,Kq()).base(e.base())},rc.apply(e,arguments)}function Xq(){var e=m4(Xj());return e.copy=function(){return Ad(e,Xq()).constant(e.constant())},rc.apply(e,arguments)}function A4(){var e=h4(Xj());return e.copy=function(){return Ad(e,A4()).exponent(e.exponent())},rc.apply(e,arguments)}function xge(){return A4.apply(null,arguments).exponent(.5)}function Zq(e){return e.type==="piecewise"?g4(e.thresholds,e.colors):S4([e.min??0,e.max??100],e.color)}function Df(e){return e.values?Cp(e.values,e.colors).unknown(e.unknownColor??null):Cp(e.colors.map((t,n)=>n),e.colors).unknown(e.unknownColor??null)}function vf(e){return e.type==="ordinal"?Df(e):Zq(e)}function Jq(e,t,n){const{tickMaxStep:s,tickMinStep:r,tickNumber:i}=e,o=r===void 0?999:Math.floor(Math.abs(t[1]-t[0])/r),l=s===void 0?2:Math.ceil(Math.abs(t[1]-t[0])/s);return Math.min(o,Math.max(l,i??n))}function eG(e,t){return t[1]-t[0]===0?1:e/((t[1]-t[0])/100)}function T4(e){return Math.floor(Math.abs(e)/50)}function N6(e){return Array.isArray(e)?JSON.stringify(e):typeof e=="object"&&e!==null?e.valueOf():e}function Zj(...e){let t=new Ov(void 0,N6),n=[],s=[],r=0,i=1,o,l,c=!1,u=0,d=0,h=.5;const p=y=>{const N=t.get(y);if(N!==void 0)return s[N%s.length]},x=()=>{const y=n.length,N=i<r,w=N?i:r,S=N?r:i;o=(S-w)/Math.max(1,y-u+d*2),c&&(o=Math.floor(o));const _=w+(S-w-o*(y-u))*h;l=o*(1-u);const k=c?Math.round(_):_;l=c?Math.round(l):l;const A=Nq(y).map(E=>k+o*E);return s=N?A.reverse():A,p};p.domain=function(y){if(!arguments.length)return n.slice();n=[],t=new Ov(void 0,N6);for(const N of y)t.has(N)||t.set(N,n.push(N)-1);return x()},p.range=function(y){if(!arguments.length)return[r,i];const[N,w]=y;return r=+N,i=+w,x()},p.rangeRound=function(y){const[N,w]=y;return r=+N,i=+w,c=!0,x()},p.bandwidth=function(){return l},p.step=function(){return o},p.round=function(y){return arguments.length?(c=!!y,x()):c},p.padding=function(y){return arguments.length?(u=Math.min(1,d=+y),x()):u},p.paddingInner=function(y){return arguments.length?(u=Math.min(1,y),x()):u},p.paddingOuter=function(y){return arguments.length?(d=+y,x()):d},p.align=function(y){return arguments.length?(h=Math.max(0,Math.min(1,y)),x()):h},p.copy=()=>Zj(n,[r,i]).round(c).paddingInner(u).paddingOuter(d).align(h);const[v,j]=e;return e.length>1?(p.domain(v),p.range(j)):v?p.range(v):x(),p}function tG(...e){const t=Zj(...e).paddingInner(1),n=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=()=>{const s=n();return s.padding=s.paddingOuter,delete s.paddingInner,delete s.paddingOuter,s.copy=t.copy,s},t}function aG(...e){const t=f4(...e),n=t.ticks,{negativeScale:s,linearScale:r,positiveScale:i}=yge(t);return t.ticks=o=>{const l=n(o),c=t.constant();let u=0,d=0,h=0;l.forEach(x=>{x>-c&&x<c&&(d+=1),x<=-c&&(u+=1),x>=c&&(h+=1)});const p=[];if(u>0&&p.push(...s.ticks(u)),d>0){const x=r.ticks(d);p.at(-1)===x[0]?p.push(...x.slice(1)):p.push(...x)}if(h>0){const x=i.ticks(h);p.at(-1)===x[0]?p.push(...x.slice(1)):p.push(...x)}return p},t.tickFormat=(o=10,l)=>{const c=t.constant(),[u,d]=t.domain(),h=d-u,p=s.domain(),x=p[1]-p[0],j=(h===0?0:x/h)*o,y=r.domain(),N=y[1]-y[0],S=(h===0?0:N/h)*o,_=i.domain(),k=_[1]-_[0],A=(h===0?0:k/h)*o,E=s.tickFormat(j,l),M=r.tickFormat(S,l),z=i.tickFormat(A,l);return P=>(P.valueOf()<=-c?E:P.valueOf()>=c?z:M)(P)},t.copy=()=>aG(t.domain(),t.range()).constant(t.constant()),t}function yge(e){const t=e.constant(),n=e.domain(),s=[n[0],Math.min(n[1],-t)],r=kp(s,e.range()),i=[Math.max(n[0],-t),Math.min(n[1],t)],o=Gj(i,e.range()),l=[Math.max(n[0],t),n[1]],c=kp(l,e.range());return{negativeScale:r,linearScale:o,positiveScale:c}}function Jj(e,t,n){switch(e){case"log":return kp(t,n);case"pow":return Wj(t,n);case"sqrt":return Dq(t,n);case"time":return C4(t,n);case"utc":return Gq(t,n);case"symlog":return aG(t,n);default:return Gj(t,n)}}const Ak=e=>e?.[0]instanceof Date;function Tk(e,t,n){const s=C4(e,t);return(r,{location:i})=>i==="tick"?s.tickFormat(n)(r):`${r.toLocaleString()}`}let C6,S6;class bge{types=new Set;constructor(){if(C6)throw new Error("You can only create one instance!");C6=this.types}addType(t){this.types.add(t)}getTypes(){return this.types}}class vge{types=new Set;constructor(){if(S6)throw new Error("You can only create one instance!");S6=this.types}addType(t){this.types.add(t)}getTypes(){return this.types}}const eN=new bge;eN.addType("bar");eN.addType("line");eN.addType("scatter");const nG=new vge;nG.addType("radar");function tN(e){return eN.getTypes().has(e)}function Bv(e){return tN(e.type)}const wge=(e,t,n,s)=>{const r=new Set;return Object.keys(t).filter(tN).forEach(o=>{const l=n[o]?.series??{},c=t[o].axisTooltipGetter?.(l);c!==void 0&&c.forEach(({axisId:u,direction:d})=>{d===e&&r.add(u??s)})}),r};function vs(e){return e.bandwidth!==void 0}function jge(e){return vs(e)&&e.paddingOuter!==void 0}function Nge(e,t,n){const s=t==="x"?[e.left,e.left+e.width]:[e.top+e.height,e.top];return n?[s[1],s[0]]:s}const Cge=.2,Sge=.1;function sG({scales:e,drawingArea:t,formattedSeries:n,axis:s,seriesConfig:r,axisDirection:i,zoomMap:o,domains:l}){if(s===void 0)return{axis:{},axisIds:[]};const c=wge(i,r,n,s[0].id),u={};return s.forEach(d=>{const h=d,p=e[h.id],x=o?.get(h.id),v=x?[x.start,x.end]:[0,100],j=Nge(t,i,h.reverse??!1),y=!h.ignoreTooltip&&c.has(h.id),N=h.data??[];if(vs(p)){const T=i==="y"?[j[1],j[0]]:j;if(jge(p)&&Zu(h)){const A=h.categoryGapRatio??Cge,E=h.barGapRatio??Sge;u[h.id]=at({offset:0,height:0,categoryGapRatio:A,barGapRatio:E,triggerTooltip:y},h,{data:N,scale:p,tickNumber:h.data.length,colorScale:h.colorMap&&(h.colorMap.type==="ordinal"?Df(at({values:h.data},h.colorMap)):vf(h.colorMap))})}if(Ju(h)&&(u[h.id]=at({offset:0,height:0,triggerTooltip:y},h,{data:N,scale:p,tickNumber:h.data.length,colorScale:h.colorMap&&(h.colorMap.type==="ordinal"?Df(at({values:h.data},h.colorMap)):vf(h.colorMap))})),Ak(h.data)){const A=Tk(h.data,T,h.tickNumber);u[h.id].valueFormatter=h.valueFormatter??A}return}if(h.scaleType==="band"||h.scaleType==="point")return;const w=l[h.id].tickNumber,S=h,_=S.scaleType??"linear",k=eG(w,v);u[h.id]=at({offset:0,height:0,triggerTooltip:y},S,{data:N,scaleType:_,scale:p,tickNumber:k,colorScale:S.colorMap&&Zq(S.colorMap),valueFormatter:h.valueFormatter??Zme(k,Jj(_,j.map(T=>p.invert(T)),j))})}),{axis:u,axisIds:s.map(({id:d})=>d)}}function _ge(e){return e!=null}function Age(e,t,n,s){const r=e?.length??0,i=Math.floor(t*r/100),o=Math.ceil(n*r/100);return function(c,u){return(c[s]??e?.[u])==null?!0:u>=i&&u<o}}function Tge(e,t,n,s,r){const i=e[0].valueOf(),o=e[1].valueOf(),l=i+t*(o-i)/100,c=i+n*(o-i)/100;return function(d,h){const p=d[s]??r?.[h];return p==null?!0:p>=l&&p<=c}}const kge=e=>({currentAxisId:t,seriesXAxisId:n,seriesYAxisId:s,isDefaultAxis:r})=>(i,o)=>!(t===n?s:n)||r?Object.values(e??{})[0]?.(i,o)??!0:[s,n].filter(u=>u!==t).map(u=>e[u??""]).filter(_ge).every(u=>u(i,o)),_6=e=>(t=[])=>t.reduce((n,s)=>{const{zoom:r,id:i,reverse:o}=s,l=e4(r,i,e,o);return l&&(n[i]=l),n},{}),Ege=.2;function rG(e,t,n){const s=t==="x"?[e.left,e.left+e.width]:[e.top+e.height,e.top];return n.reverse?[s[1],s[0]]:s}function iG(e,t){const n=[0,1];if(Zu(e)){const i=e.categoryGapRatio??Ege;return Zj(t,n).paddingInner(i).paddingOuter(i/2)}if(Ju(e))return tG(t,n);const s=e.scaleType??"linear",r=Jj(s,t,n);return efe(e)&&e.constant!=null&&r.constant(e.constant),r}const oG=(e,t)=>{const n=e[1]-e[0],s=t[1]-t[0],r=e[0]-t[0]*n/s,i=e[1]+(100-t[1])*n/s;return[r,i]},Lge=(e,t,n,s,r,i,o)=>{const l=n==="x"?s[e].xExtremumGetter:s[e].yExtremumGetter,c=i[e]?.series??{};return l?.({series:c,axis:t,axisIndex:r,isDefaultAxis:r===0,getFilters:o})??[1/0,-1/0]};function aN(e,t,n,s,r,i){const o=Object.keys(n).filter(tN);let l=[1/0,-1/0];for(const c of o){const[u,d]=Lge(c,e,t,n,s,r,i);l=[Math.min(l[0],u),Math.max(l[1],d)]}return Number.isNaN(l[0])||Number.isNaN(l[1])?[1/0,-1/0]:l}const Pge=(e,t,n,s)=>{if(e.domainLimit!==void 0)return e.domainLimit;if(t==="x")for(const r of s.line?.seriesOrder??[]){const i=s.line.series[r];if(i.xAxisId===e.id||i.xAxisId===void 0&&n===0)return"strict"}return"nice"};function lG(e,t,n){return Jj(e??"linear",t,[0,1]).nice(n).domain()}function cG(e,t,n,s,[r,i],o,l){const c=uG(e,t,n,s,l);let u=mG(e,r,i);if(typeof c=="function"){const{min:h,max:p}=c(r.valueOf(),i.valueOf());u[0]=h,u[1]=p}const d=Jq(e,u,o);return c==="nice"&&(u=lG(e.scaleType,u,d)),u=["min"in e?e.min??u[0]:u[0],"max"in e?e.max??u[1]:u[1]],{domain:u,tickNumber:d}}function dG(e,t,n,s,[r,i],o,l){const c=uG(e,t,n,s,l);let u=mG(e,r,i);if(typeof c=="function"){const{min:d,max:h}=c(r.valueOf(),i.valueOf());u[0]=d,u[1]=h}return c==="nice"&&(u=lG(e.scaleType,u,o)),[e.min??u[0],e.max??u[1]]}function uG(e,t,n,s,r){return r?Pge(e,t,n,s):e.domainLimit??"nice"}function mG(e,t,n){let s=t,r=n;return"max"in e&&e.max!=null&&e.max<t&&(s=e.max),"min"in e&&e.min!=null&&e.min>t&&(r=e.min),!("min"in e)&&!("max"in e)?[s,r]:[e.min??s,e.max??r]}class Dge{constructor(){this.ids=[],this.values=[],this.length=0}clear(){this.length=0}push(t,n){let s=this.length++;for(;s>0;){const r=s-1>>1,i=this.values[r];if(n>=i)break;this.ids[s]=this.ids[r],this.values[s]=i,s=r}this.ids[s]=t,this.values[s]=n}pop(){if(this.length===0)return;const t=this.ids,n=this.values,s=t[0],r=--this.length;if(r>0){const i=t[r],o=n[r];let l=0;const c=r>>1;for(;l<c;){const u=(l<<1)+1,d=u+1,h=u+(+(d<r)&+(n[d]<n[u]));if(n[h]>=o)break;t[l]=t[h],n[l]=n[h],l=h}t[l]=i,n[l]=o}return s}peek(){return this.length>0?this.ids[0]:void 0}peekValue(){return this.length>0?this.values[0]:void 0}shrink(){this.ids.length=this.values.length=this.length}}const A6=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],N2=3;class k4{static from(t,n=0){if(n%8!==0)throw new Error("byteOffset must be 8-byte aligned.");if(!t||t.byteLength===void 0||t.buffer)throw new Error("Data must be an instance of ArrayBuffer or SharedArrayBuffer.");const[s,r]=new Uint8Array(t,n+0,2);if(s!==251)throw new Error("Data does not appear to be in a Flatbush format.");const i=r>>4;if(i!==N2)throw new Error(`Got v${i} data when expected v${N2}.`);const o=A6[r&15];if(!o)throw new Error("Unrecognized array type.");const[l]=new Uint16Array(t,n+2,1),[c]=new Uint32Array(t,n+4,1);return new k4(c,l,o,void 0,t,n)}constructor(t,n=16,s=Float64Array,r=ArrayBuffer,i,o=0){if(t===void 0)throw new Error("Missing required argument: numItems.");if(isNaN(t)||t<=0)throw new Error(`Unexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+n,2),65535),this.byteOffset=o;let l=t,c=l;this._levelBounds=[l*4];do l=Math.ceil(l/this.nodeSize),c+=l,this._levelBounds.push(c*4);while(l!==1);this.ArrayType=s,this.IndexArrayType=c<16384?Uint16Array:Uint32Array;const u=A6.indexOf(s),d=c*4*s.BYTES_PER_ELEMENT;if(u<0)throw new Error(`Unexpected typed array class: ${s}.`);if(i)this.data=i,this._boxes=new s(i,o+8,c*4),this._indices=new this.IndexArrayType(i,o+8+d,c),this._pos=c*4,this.minX=this._boxes[this._pos-4],this.minY=this._boxes[this._pos-3],this.maxX=this._boxes[this._pos-2],this.maxY=this._boxes[this._pos-1];else{const h=this.data=new r(8+d+c*this.IndexArrayType.BYTES_PER_ELEMENT);this._boxes=new s(h,8,c*4),this._indices=new this.IndexArrayType(h,8+d,c),this._pos=0,this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,new Uint8Array(h,0,2).set([251,(N2<<4)+u]),new Uint16Array(h,2,1)[0]=n,new Uint32Array(h,4,1)[0]=t}this._queue=new Dge}add(t,n,s=t,r=n){const i=this._pos>>2,o=this._boxes;return this._indices[i]=i,o[this._pos++]=t,o[this._pos++]=n,o[this._pos++]=s,o[this._pos++]=r,t<this.minX&&(this.minX=t),n<this.minY&&(this.minY=n),s>this.maxX&&(this.maxX=s),r>this.maxY&&(this.maxY=r),i}finish(){if(this._pos>>2!==this.numItems)throw new Error(`Added ${this._pos>>2} items when expected ${this.numItems}.`);const t=this._boxes;if(this.numItems<=this.nodeSize){t[this._pos++]=this.minX,t[this._pos++]=this.minY,t[this._pos++]=this.maxX,t[this._pos++]=this.maxY;return}const n=this.maxX-this.minX||1,s=this.maxY-this.minY||1,r=new Uint32Array(this.numItems),i=65535;for(let o=0,l=0;o<this.numItems;o++){const c=t[l++],u=t[l++],d=t[l++],h=t[l++],p=Math.floor(i*((c+d)/2-this.minX)/n),x=Math.floor(i*((u+h)/2-this.minY)/s);r[o]=Ige(p,x)}kk(r,t,this._indices,0,this.numItems-1,this.nodeSize);for(let o=0,l=0;o<this._levelBounds.length-1;o++){const c=this._levelBounds[o];for(;l<c;){const u=l;let d=t[l++],h=t[l++],p=t[l++],x=t[l++];for(let v=1;v<this.nodeSize&&l<c;v++)d=Math.min(d,t[l++]),h=Math.min(h,t[l++]),p=Math.max(p,t[l++]),x=Math.max(x,t[l++]);this._indices[this._pos>>2]=u,t[this._pos++]=d,t[this._pos++]=h,t[this._pos++]=p,t[this._pos++]=x}}}search(t,n,s,r,i){if(this._pos!==this._boxes.length)throw new Error("Data not yet indexed - call index.finish().");let o=this._boxes.length-4;const l=[],c=[];for(;o!==void 0;){const u=Math.min(o+this.nodeSize*4,T6(o,this._levelBounds));for(let d=o;d<u;d+=4){if(s<this._boxes[d]||r<this._boxes[d+1]||t>this._boxes[d+2]||n>this._boxes[d+3])continue;const h=this._indices[d>>2]|0;o>=this.numItems*4?l.push(h):(i===void 0||i(h))&&(c.push(h),c.push(this._boxes[d]),c.push(this._boxes[d+1]))}o=l.pop()}return c}neighbors(t,n,s=1/0,r=1/0,i,o=Oge){if(this._pos!==this._boxes.length)throw new Error("Data not yet indexed - call index.finish().");let l=this._boxes.length-4;const c=this._queue,u=[];e:for(;l!==void 0;){const d=Math.min(l+this.nodeSize*4,T6(l,this._levelBounds));for(let h=l;h<d;h+=4){const p=this._indices[h>>2]|0,x=this._boxes[h],v=this._boxes[h+1],j=this._boxes[h+2],y=this._boxes[h+3],N=t<x?x-t:t>j?t-j:0,w=n<v?v-n:n>y?n-y:0,S=o(N,w);S>r||(l>=this.numItems*4?c.push(p<<1,S):(i===void 0||i(p))&&c.push((p<<1)+1,S))}for(;c.length&&c.peek()&1;)if(c.peekValue()>r||(u.push(c.pop()>>1),u.length===s))break e;l=c.length?c.pop()>>1:void 0}return c.clear(),u}}function Oge(e,t){return e*e+t*t}function T6(e,t){let n=0,s=t.length-1;for(;n<s;){const r=n+s>>1;t[r]>e?s=r:n=r+1}return t[n]}function kk(e,t,n,s,r,i){if(Math.floor(s/i)>=Math.floor(r/i))return;const o=e[s],l=e[s+r>>1],c=e[r];let u=c;const d=Math.max(o,l);c>d?u=d:d===o?u=Math.max(l,c):d===l&&(u=Math.max(o,c));let h=s-1,p=r+1;for(;;){do h++;while(e[h]<u);do p--;while(e[p]>u);if(h>=p)break;Mge(e,t,n,h,p)}kk(e,t,n,s,p,i),kk(e,t,n,p+1,r,i)}function Mge(e,t,n,s,r){const i=e[s];e[s]=e[r],e[r]=i;const o=4*s,l=4*r,c=t[o],u=t[o+1],d=t[o+2],h=t[o+3];t[o]=t[l],t[o+1]=t[l+1],t[o+2]=t[l+2],t[o+3]=t[l+3],t[l]=c,t[l+1]=u,t[l+2]=d,t[l+3]=h;const p=n[s];n[s]=n[r],n[r]=p}function Ige(e,t){let n=e^t,s=65535^n,r=65535^(e|t),i=e&(t^65535),o=n|s>>1,l=n>>1^n,c=r>>1^s&i>>1^r,u=n&r>>1^i>>1^i;n=o,s=l,r=c,i=u,o=n&n>>2^s&s>>2,l=n&s>>2^s&(n^s)>>2,c^=n&r>>2^s&i>>2,u^=s&r>>2^(n^s)&i>>2,n=o,s=l,r=c,i=u,o=n&n>>4^s&s>>4,l=n&s>>4^s&(n^s)>>4,c^=n&r>>4^s&i>>4,u^=s&r>>4^(n^s)&i>>4,n=o,s=l,r=c,i=u,c^=n&r>>8^s&i>>8,u^=s&r>>8^(n^s)&i>>8,n=c^c>>1,s=u^u>>1;let d=e^t,h=s|65535^(d|n);return d=(d|d<<8)&16711935,d=(d|d<<4)&252645135,d=(d|d<<2)&858993459,d=(d|d<<1)&1431655765,h=(h|h<<8)&16711935,h=(h|h<<4)&252645135,h=(h|h<<2)&858993459,h=(h|h<<1)&1431655765,(h<<1|d)>>>0}const $ge=e=>{const t=new Map;return e.forEach(n=>{t.set(n.axisId,n)}),t},fG=e=>e.zoom,Rge=Lt(Qo,sc,(e,t)=>e?.some(n=>!!n.zoom)||t?.some(n=>!!n.zoom)||!1),hG=Lt(fG,e=>e?.isInteracting),Td=$n(fG,function(t){return t?.zoomData&&$ge(t?.zoomData)}),k6=Lt(Td,(e,t)=>e?.get(t)),Sx=$n(Qo,sc,function(t,n){return at({},_6("x")(t),_6("y")(n))});Lt(Sx,(e,t)=>e[t]);const zge=Lt(wr,function(t){return T4(t.width)}),Fge=Lt(wr,function(t){return T4(t.height)}),E4=$n(Qo,yn,Vr,Uj,zge,function(t,n,s,r,i){const l={};return t?.forEach((c,u)=>{const d=c;if(Zu(d)||Ju(d)){l[d.id]={domain:d.data};return}const h=aN(d,"x",s,u,n);l[d.id]=cG(d,"x",u,n,h,i,r)}),{axes:t,domains:l}}),L4=$n(sc,yn,Vr,Uj,Fge,function(t,n,s,r,i){const l={};return t?.forEach((c,u)=>{const d=c;if(Zu(d)||Ju(d)){l[d.id]={domain:d.data};return}const h=aN(d,"y",s,u,n);l[d.id]=cG(d,"y",u,n,h,i,r)}),{axes:t,domains:l}}),gG=$n(Td,Sx,E4,L4,function(t,n,{axes:s,domains:r},{axes:i,domains:o}){if(!t||!n)return;let l=!1;const c={},u=[...s??[],...i??[]];for(let d=0;d<u.length;d+=1){const h=u[d];if(!n[h.id]||n[h.id].filterMode!=="discard")continue;const p=t.get(h.id);if(p===void 0||p.start<=0&&p.end>=100)continue;const x=d<(s?.length??0)?"x":"y";if(h.scaleType==="band"||h.scaleType==="point")c[h.id]=Age(h.data,p.start,p.end,x);else{const{domain:v}=x==="x"?r[h.id]:o[h.id];c[h.id]=Tge(v,p.start,p.end,x,h.data)}l=!0}if(l)return kge(c)}),Uge=$n(yn,Vr,Td,Sx,gG,Uj,E4,function(t,n,s,r,i,o,{axes:l,domains:c}){const u={};return l?.forEach((d,h)=>{const p=c[d.id].domain;if(Zu(d)||Ju(d)){u[d.id]=p;return}const x=s?.get(d.id),v=r?.[d.id],j=x===void 0&&!v?i:void 0;if(!j){u[d.id]=p;return}const y=c[d.id].tickNumber,N=aN(d,"x",n,h,t,j);u[d.id]=dG(d,"x",h,t,N,y,o)}),u}),Bge=$n(yn,Vr,Td,Sx,gG,Uj,L4,function(t,n,s,r,i,o,{axes:l,domains:c}){const u={};return l?.forEach((d,h)=>{const p=c[d.id].domain;if(Zu(d)||Ju(d)){u[d.id]=p;return}const x=s?.get(d.id),v=r?.[d.id],j=x===void 0&&!v?i:void 0;if(!j){u[d.id]=p;return}const y=c[d.id].tickNumber,N=aN(d,"y",n,h,t,j);u[d.id]=dG(d,"y",h,t,N,y,o)}),u}),pG=$n(Qo,Uge,function(t,n){const s={};return t?.forEach(r=>{const i=r,o=n[i.id];s[i.id]=iG(i,o)}),s}),xG=$n(sc,Bge,function(t,n){const s={};return t?.forEach(r=>{const i=r,o=n[i.id];s[i.id]=iG(i,o)}),s}),Hge=$n(Qo,pG,wr,Td,function(t,n,s,r){const i={};return t?.forEach(o=>{const l=o,c=r?.get(l.id),u=c?[c.start,c.end]:[0,100],d=rG(s,"x",l),h=n[l.id].copy(),p=oG(d,u);h.range(p),i[l.id]=h}),i}),qge=$n(sc,xG,wr,Td,function(t,n,s,r){const i={};return t?.forEach(o=>{const l=o,c=r?.get(l.id),u=c?[c.start,c.end]:[0,100],d=rG(s,"y",l),h=n[l.id].copy(),p=vs(h)?d.reverse():d,x=oG(p,u);h.range(x),i[l.id]=h}),i}),Xs=$n(wr,yn,Vr,Td,E4,Hge,function(t,n,s,r,{axes:i,domains:o},l){return sG({scales:l,drawingArea:t,formattedSeries:n,axis:i,seriesConfig:s,axisDirection:"x",zoomMap:r,domains:o})}),Zs=$n(wr,yn,Vr,Td,L4,qge,function(t,n,s,r,{axes:i,domains:o},l){return sG({scales:l,drawingArea:t,formattedSeries:n,axis:i,seriesConfig:s,axisDirection:"y",zoomMap:r,domains:o})});Lt(Xs,Zs,(e,t,n)=>e?.axis[n]??t?.axis[n]);Lt(Qo,sc,(e,t,n)=>{const s=e?.find(r=>r.id===n)??t?.find(r=>r.id===n)??null;if(s)return s});const Gge=Lt(Qo,e=>e[0].id),Wge=Lt(sc,e=>e[0].id),Vge=new Map,Yge=()=>Vge,Qge=$n(yn,pG,xG,Gge,Wge,function(t,n,s,r,i){const o=t.scatter,l=new Map;return o&&o.seriesOrder.forEach(c=>{const{data:u,xAxisId:d=r,yAxisId:h=i}=o.series[c],p=new k4(u.length),x=n[d],v=s[h];for(const j of u)p.add(x(j.x),v(j.y));p.finish(),l.set(c,p)}),l});function Km(e){return e instanceof Date?e.getTime():e}function Of(e,t){const{scale:n,data:s,reverse:r}=e;if(!vs(n)){const o=n.invert(t);if(s===void 0)return-1;const l=Km(o);return s?.findIndex((u,d)=>{const h=Km(u);return h>l&&(d===0||Math.abs(l-h)<=Math.abs(l-Km(s[d-1])))||h<=l&&(d===s.length-1||Math.abs(Km(o)-h)<Math.abs(Km(o)-Km(s[d+1])))})}const i=n.bandwidth()===0?Math.floor((t-Math.min(...n.range())+n.step()/2)/n.step()):Math.floor((t-Math.min(...n.range()))/n.step());return i<0||i>=s.length?-1:r?s.length-1-i:i}function E6(e,t,n,s){if(!vs(e)){if(s===null){const r=e.invert(n);return Number.isNaN(r)?null:r}return t[s]}return s===null||s<0||s>=t.length?null:t[s]}function Ep(e,t){const n=e.createSVGPoint();return n.x=t.clientX,n.y=t.clientY,n.matrixTransform(e.getScreenCTM().inverse())}const Kge=Object.is;function yG(e,t){if(e===t)return!0;if(!(e instanceof Object)||!(t instanceof Object))return!1;let n=0,s=0;for(const r in e)if(n+=1,!Kge(e[r],t[r])||!(r in t))return!1;for(const r in t)s+=1;return n===s}const _x=({store:e})=>{const t=ps(function(){e.set("interaction",at({},e.state.interaction,{pointer:null,item:null}))}),n=ps(function(o){const l=e.state.interaction.item;if(!o){l!==null&&e.set("interaction",at({},e.state.interaction,{item:null}));return}l===null||Object.keys(o).some(c=>o[c]!==l[c])||e.set("interaction",at({},e.state.interaction,{item:null}))}),s=ps(function(o,l){yG(e.state.interaction.item,o)||e.set("interaction",at({},e.state.interaction,{lastUpdate:l.interaction,item:o}))}),r=ps(function(o){e.set("interaction",at({},e.state.interaction,{pointer:o,lastUpdate:o!==null?"pointer":e.state.interaction.lastUpdate}))});return{instance:{cleanInteraction:t,setItemInteraction:s,removeItemInteraction:n,setPointerCoordinate:r}}};_x.getInitialState=()=>({interaction:{item:null,pointer:null,lastUpdate:"pointer"}});_x.params={};const nN=e=>e.interaction,Xge=Lt(nN,e=>e!==void 0),bG=Lt(nN,e=>e?.item??null),vG=Lt(nN,e=>e?.pointer??null),Ax=Lt(vG,e=>e&&e.x),Tx=Lt(vG,e=>e&&e.y),Zge=Lt(bG,e=>e!==null),kx=Lt(nN,e=>e?.lastUpdate),Jge=new Set(["bar","line","scatter","pie"]);function wG(e){return Jge.has(e)}function jG(e,t,n){const s=Object.keys(e),r=t!==void 0&&e[t]?s.indexOf(t):0,i=t!==void 0&&n!==void 0&&e[t]&&e[t].series[n]?e[t].seriesOrder.indexOf(n):-1,o=s.filter(wG);for(let d=0;d<o.length;d+=1){const h=(r+d)%o.length,p=e[o[h]],x=d===0?i+1:0;for(let v=x;v<p.seriesOrder.length;v+=1)if(p.series[p.seriesOrder[v]].data.length>0)return{type:o[h],seriesId:p.seriesOrder[v]}}const l=r,c=e[o[l]],u=i;for(let d=0;d<u;d+=1)if(c.series[c.seriesOrder[d]].data.length>0)return{type:o[l],seriesId:c.seriesOrder[d]};return null}function NG(e,t,n){const s=Object.keys(e),r=t!==void 0&&e[t]?s.indexOf(t):0,i=t!==void 0&&n!==void 0&&e[t]&&e[t].series[n]?e[t].seriesOrder.indexOf(n):1,o=s.filter(wG);for(let d=0;d<o.length;d+=1){const h=(o.length+r-d)%o.length,p=e[o[h]],x=d===0?i+1:p.seriesOrder.length;for(let v=1;v<x;v+=1){const j=(p.seriesOrder.length+i-v)%p.seriesOrder.length;if(p.series[p.seriesOrder[j]].data.length>0)return{type:o[h],seriesId:p.seriesOrder[j]}}}const l=r,c=e[o[l]],u=c.seriesOrder;for(let d=u.length-1;d>i;d-=1)if(c.series[c.seriesOrder[d]].data.length>0)return{type:o[l],seriesId:c.seriesOrder[d]};return null}function CG(e,t,n){if(t==="sankey")return!1;const s=e[t]?.series[n]?.data;return s&&s.length>0}function epe(e){const t=yn(e);let{type:n,seriesId:s}=e.keyboardNavigation.item??{};if(n===void 0||n==="sankey"||s===void 0||!CG(t,n,s)){const i=jG(t,n,s);if(i===null)return null;n=i.type,s=i.seriesId}const r=t[n].series[s].data.length;return{type:n,seriesId:s,dataIndex:((e.keyboardNavigation.item?.dataIndex??-1)+1)%r}}function tpe(e){const t=yn(e);let{type:n,seriesId:s}=e.keyboardNavigation.item??{};if(n===void 0||n==="sankey"||s===void 0||!CG(t,n,s)){const i=NG(t,n,s);if(i===null)return null;n=i.type,s=i.seriesId}const r=t[n].series[s].data.length;return{type:n,seriesId:s,dataIndex:(r+(e.keyboardNavigation.item?.dataIndex??1)-1)%r}}function ape(e){const t=yn(e);let{type:n,seriesId:s}=e.keyboardNavigation.item??{};const r=jG(t,n,s);if(r===null)return null;n=r.type,s=r.seriesId;const i=t[n].series[s].data.length;return{type:n,seriesId:s,dataIndex:Math.min(i-1,e.keyboardNavigation.item?.dataIndex??0)}}function npe(e){const t=yn(e);let{type:n,seriesId:s}=e.keyboardNavigation.item??{};const r=NG(t,n,s);if(r===null)return null;n=r.type,s=r.seriesId;const i=t[n].series[s].data.length;return{type:n,seriesId:s,dataIndex:Math.min(i-1,e.keyboardNavigation.item?.dataIndex??0)}}const sN=({params:e,store:t,svgRef:n})=>{const s=ps(function(){t.state.keyboardNavigation.item!==null&&t.set("keyboardNavigation",at({},t.state.keyboardNavigation,{item:null}))});return f.useEffect(()=>{const r=n.current;if(!r||!e.enableKeyboardNavigation)return;function i(o){let l=t.state.keyboardNavigation.item;switch(o.key){case"ArrowRight":l=epe(t.state);break;case"ArrowLeft":l=tpe(t.state);break;case"ArrowDown":{l=npe(t.state);break}case"ArrowUp":{l=ape(t.state);break}}l!==t.state.keyboardNavigation.item&&(o.preventDefault(),t.update(at({},t.state.highlight&&{highlight:at({},t.state.highlight,{lastUpdate:"keyboard"})},t.state.interaction&&{interaction:at({},t.state.interaction,{lastUpdate:"keyboard"})},{keyboardNavigation:at({},t.state.keyboardNavigation,{item:l})})))}return r.addEventListener("keydown",i),r.addEventListener("blur",s),()=>{r.removeEventListener("keydown",i),r.removeEventListener("blur",s)}},[n,s,e.enableKeyboardNavigation,t]),is(()=>{t.state.keyboardNavigation.enableKeyboardNavigation!==e.enableKeyboardNavigation&&t.set("keyboardNavigation",at({},t.state.keyboardNavigation,{enableKeyboardNavigation:!!e.enableKeyboardNavigation}))},[t,e.enableKeyboardNavigation]),{}};sN.getInitialState=e=>({keyboardNavigation:{item:null,enableKeyboardNavigation:!!e.enableKeyboardNavigation}});sN.params={enableKeyboardNavigation:!0};const am=e=>e.keyboardNavigation;Lt(am,(e,t)=>e?.item!=null&&e.item.type===t.seriesType&&e.item.seriesId===t.seriesId&&e.item.dataIndex===t.dataIndex);const spe=Lt(am,e=>e?.item!=null),rN=Lt(am,e=>e?.item?.type),iN=Lt(am,e=>e?.item?.seriesId),oN=Lt(am,e=>e?.item?.dataIndex),rpe=Lt(am,e=>!!e?.enableKeyboardNavigation),SG=e=>(t,n,s,r,i)=>{if(t===void 0||n===void 0||s===void 0)return;const o=i[t]?.series[n];if(!o)return;let l=e==="x"?"xAxisId"in o&&o.xAxisId:"yAxisId"in o&&o.yAxisId;return(l===void 0||l===!1)&&(l=r.axisIds[0]),{axisId:l,dataIndex:s}},ipe=Lt(rN,iN,oN,Xs,yn,SG("x")),ope=Lt(rN,iN,oN,Zs,yn,SG("y")),_G=Lt(am,function(t){if(t?.item==null)return null;const{type:n,seriesId:s}=t.item;return n===void 0||s===void 0?null:t.item}),lpe=Lt(rN,iN,oN,function(t,n,s){return n!==void 0&&s!==void 0}),AG=Lt(kx,bG,_G,(e,t,n)=>e==="keyboard"?n:t??null),cpe=Lt(kx,Zge,lpe,(e,t,n)=>e==="keyboard"?n:t),dpe=Lt(AG,wr,Vr,Xs,Zs,yn,function(t,n,s,{axis:r,axisIds:i},{axis:o,axisIds:l},c,u="top"){if(!t)return null;const d=c[t.type]?.series[t.seriesId];if(d){const h={},p=Bv(d)?d.xAxisId??i[0]:void 0,x=Bv(d)?d.yAxisId??l[0]:void 0;return p!==void 0&&(h.x=r[p]),x!==void 0&&(h.y=o[x]),s[d.type].tooltipItemPositionGetter?.({series:c,drawingArea:n,axesConfig:h,identifier:t,placement:u})??null}return null});function wf(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;if(Array.isArray(e)){const r=e.length;if(r!==t.length)return!1;for(let i=0;i<r;i+=1)if(!wf(e[i],t[i]))return!1;return!0}if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;const r=Array.from(e.entries());for(let i=0;i<r.length;i+=1)if(!t.has(r[i][0]))return!1;for(let i=0;i<r.length;i+=1){const o=r[i];if(!wf(o[1],t.get(o[0])))return!1}return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;const r=Array.from(e.entries());for(let i=0;i<r.length;i+=1)if(!t.has(r[i][0]))return!1;return!0}if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){const r=e.length;if(r!==t.length)return!1;for(let i=0;i<r;i+=1)if(e[i]!==t[i])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();const n=Object.keys(e),s=n.length;if(s!==Object.keys(t).length)return!1;for(let r=0;r<s;r+=1)if(!Object.prototype.hasOwnProperty.call(t,n[r]))return!1;for(let r=0;r<s;r+=1){const i=n[r];if(!wf(e[i],t[i]))return!1}return!0}return e!==e&&t!==t}function Ek(e,t,n=t.axisIds[0]){return Array.isArray(n)?n.map(s=>Of(t.axis[s],e)):Of(t.axis[n],e)}const TG=(e,t,n)=>{if(e===null)return null;const s=Ek(e,t,n);return s===-1?null:s},P4=Lt(Ax,Xs,TG),D4=Lt(Tx,Zs,TG),upe=Lt(Ax,Tx,Xs,Zs,(e,t,n,s)=>[...e===null?[]:n.axisIds.map(r=>({axisId:r,dataIndex:Ek(e,n,r)})),...t===null?[]:s.axisIds.map(r=>({axisId:r,dataIndex:Ek(t,s,r)}))].filter(r=>r.dataIndex!==null&&r.dataIndex>=0));function kG(e,t,n,s=t.axisIds[0]){return Array.isArray(s)?s.map((r,i)=>{const o=t.axis[r];return E6(o.scale,o.data,e,n[i])}):E6(t.axis[s].scale,t.axis[s].data,e,n)}const mpe=Lt(Ax,Xs,P4,(e,t,n,s)=>e===null||t.axisIds.length===0?null:kG(e,t,n,s)),fpe=Lt(Tx,Zs,D4,(e,t,n,s)=>e===null||t.axisIds.length===0?null:kG(e,t,n,s)),EG=[],LG=Ij({memoizeOptions:{resultEqualityCheck:wf}})(Ax,Xs,(e,t)=>e===null?EG:t.axisIds.filter(n=>t.axis[n].triggerTooltip).map(n=>({axisId:n,dataIndex:Of(t.axis[n],e)})).filter(({dataIndex:n})=>n>=0)),PG=Ij({memoizeOptions:{resultEqualityCheck:wf}})(Tx,Zs,(e,t)=>e===null?EG:t.axisIds.filter(n=>t.axis[n].triggerTooltip).map(n=>({axisId:n,dataIndex:Of(t.axis[n],e)})).filter(({dataIndex:n})=>n>=0)),hpe=Lt(LG,PG,(e,t)=>e.length>0||t.length>0);function gpe(e){return e.setPointerCoordinate!==void 0}const rh=({params:e,store:t,seriesConfig:n,svgRef:s,instance:r})=>{const{xAxis:i,yAxis:o,dataset:l,onHighlightedAxisChange:c}=e,u=Gt(t,wr),d=Gt(t,yn),h=Gt(t,Xge),{axis:p,axisIds:x}=Gt(t,Xs),{axis:v,axisIds:j}=Gt(t,Zs);gq({controlled:e.highlightedAxis}),is(()=>{e.highlightedAxis!==void 0&&t.set("controlledCartesianAxisHighlight",e.highlightedAxis)},[t,e.highlightedAxis]);const y=f.useRef(!0);f.useEffect(()=>{if(y.current){y.current=!1;return}t.set("cartesianAxis",{x:yq(i,l),y:bq(o,l)})},[n,u,i,o,l,t]);const N=x[0],w=j[0];sme(t,upe,(_,k)=>{if(c&&!Object.is(_,k)){if(_.length!==k.length){c(k);return}_?.some(({axisId:T,dataIndex:A},E)=>k[E].axisId!==T||k[E].dataIndex!==A)&&c(k)}});const S=gpe(r);return f.useEffect(()=>{const _=s.current;if(!h||!S||!_||e.disableAxisListener)return()=>{};const k=r.addInteractionListener("moveEnd",D=>{D.detail.activeGestures.pan||r.cleanInteraction()}),T=r.addInteractionListener("panEnd",D=>{D.detail.activeGestures.move||r.cleanInteraction()}),A=r.addInteractionListener("quickPressEnd",D=>{!D.detail.activeGestures.move&&!D.detail.activeGestures.pan&&r.cleanInteraction()}),E=D=>{const U=D.detail.srcEvent,B=D.detail.target,R=Ep(_,U);if(D.detail.srcEvent.buttons>=1&&B?.hasPointerCapture(D.detail.srcEvent.pointerId)&&!B?.closest("[data-charts-zoom-slider]")&&B?.releasePointerCapture(D.detail.srcEvent.pointerId),!r.isPointInside(R.x,R.y,B)){r.cleanInteraction?.();return}r.setPointerCoordinate(R)},M=r.addInteractionListener("move",E),z=r.addInteractionListener("pan",E),P=r.addInteractionListener("quickPress",E);return()=>{M.cleanup(),k.cleanup(),z.cleanup(),T.cleanup(),P.cleanup(),A.cleanup()}},[s,t,p,N,v,w,r,e.disableAxisListener,h,S]),f.useEffect(()=>{const _=s.current,k=e.onAxisClick;if(_===null||!k)return()=>{};const T=r.addInteractionListener("tap",A=>{let E=null,M=!1;const z=Ep(_,A.detail.srcEvent),P=Of(p[N],z.x);M=P!==-1,E=M?P:Of(v[w],z.y);const D=M?x[0]:j[0];if(E==null||E===-1)return;const U=(M?p:v)[D].data[E],B={};Object.keys(d).filter(R=>["bar","line"].includes(R)).forEach(R=>{d[R]?.seriesOrder.forEach(q=>{const Z=d[R].series[q],V=Z.xAxisId,oe=Z.yAxisId,je=M?V:oe;(je===void 0||je===D)&&(B[q]=Z.data[E])})}),k(A.detail.srcEvent,{dataIndex:E,axisValue:U,seriesValues:B})});return()=>{T.cleanup()}},[e.onAxisClick,d,s,p,x,v,j,N,w,r]),{}};rh.params={xAxis:!0,yAxis:!0,dataset:!0,onAxisClick:!0,disableAxisListener:!0,onHighlightedAxisChange:!0,highlightedAxis:!0};rh.getDefaultizedParams=({params:e})=>at({},e,{colors:e.colors??uq,theme:e.theme??"light",defaultizedXAxis:yq(e.xAxis,e.dataset),defaultizedYAxis:bq(e.yAxis,e.dataset)});rh.getInitialState=e=>at({cartesianAxis:{x:e.defaultizedXAxis,y:e.defaultizedYAxis}},e.highlightedAxis===void 0?{}:{controlledCartesianAxisHighlight:e.highlightedAxis});const Ko=e=>e.brush;Lt(Ko,e=>e?.start);Lt(Ko,e=>e?.current);const ppe=Lt(Ko,e=>e?.start?.x??null),xpe=Lt(Ko,e=>e?.start?.y??null),ype=Lt(Ko,e=>e?.current?.x??null),bpe=Lt(Ko,e=>e?.current?.y??null);Lt(ppe,xpe,ype,bpe,(e,t,n,s)=>e===null||t===null||n===null||s===null?null:{start:{x:e,y:t},current:{x:n,y:s}});const vpe=Lt(yn,e=>{let t=!1,n=!1;return e&&Object.entries(e).forEach(([s,r])=>{Object.values(r.series).some(i=>i.layout==="horizontal")&&(t=!0),s==="scatter"&&r.seriesOrder.length>0&&(n=!0)}),n?"xy":t?"y":"x"}),wpe=Lt(Sx,function(t){let n=!1,s=!1;return Object.values(t).forEach(r=>{r.axisDirection==="y"&&(s=!0),r.axisDirection==="x"&&(n=!0)}),n&&s?"xy":s?"y":n?"x":null});Lt(vpe,wpe,(e,t)=>t??e);const DG=Lt(Ko,e=>e?.enabled||e?.isZoomBrushEnabled),OG=Lt(DG,Ko,(e,t)=>e&&t?.start!==null&&t?.current!==null),lN=Lt(Ko,OG,(e,t)=>t&&e?.preventHighlight),jpe=Lt(Ko,OG,(e,t)=>t&&e?.preventTooltip),Ex=({store:e,svgRef:t,instance:n,params:s})=>{const r=Gt(e,DG);is(()=>{e.set("brush",at({},e.state.brush,{enabled:s.brushConfig.enabled,preventTooltip:s.brushConfig.preventTooltip,preventHighlight:s.brushConfig.preventHighlight}))},[e,s.brushConfig.enabled,s.brushConfig.preventTooltip,s.brushConfig.preventHighlight]);const i=ps(function(u){e.set("brush",at({},e.state.brush,{start:e.state.brush.start??u,current:u}))}),o=ps(function(){e.set("brush",at({},e.state.brush,{start:null,current:null}))}),l=ps(function(u){e.state.brush.isZoomBrushEnabled!==u&&e.set("brush",at({},e.state.brush,{isZoomBrushEnabled:u}))});return f.useEffect(()=>{const c=t.current;if(c===null||!r)return()=>{};const u=j=>{if(j.detail.target?.closest("[data-charts-zoom-slider]"))return;const y=Ep(c,{clientX:j.detail.initialCentroid.x,clientY:j.detail.initialCentroid.y});i(y)},d=j=>{const y=Ep(c,{clientX:j.detail.centroid.x,clientY:j.detail.centroid.y});i(y)},h=n.addInteractionListener("brushStart",u),p=n.addInteractionListener("brush",d),x=n.addInteractionListener("brushCancel",o),v=n.addInteractionListener("brushEnd",o);return()=>{h.cleanup(),p.cleanup(),v.cleanup(),x.cleanup()}},[t,n,e,o,i,r]),{instance:{setBrushCoordinates:i,clearBrush:o,setZoomBrushEnabled:l}}};Ex.params={brushConfig:!0};Ex.getDefaultizedParams=({params:e})=>at({},e,{brushConfig:{enabled:e?.brushConfig?.enabled??!1,preventTooltip:e?.brushConfig?.preventTooltip??!0,preventHighlight:e?.brushConfig?.preventHighlight??!0}});Ex.getInitialState=e=>({brush:{enabled:e.brushConfig.enabled,isZoomBrushEnabled:!1,preventTooltip:e.brushConfig.preventTooltip,preventHighlight:e.brushConfig.preventHighlight,start:null,current:null}});const ih=e=>e.controlledCartesianAxisHighlight,MG=(e,t,n,s)=>s?[]:n!==void 0?n.filter(r=>t.axis[r.axisId]!==void 0).map(r=>r):e===null?[]:[{axisId:t.axisIds[0],dataIndex:e}],IG=$n(P4,Xs,ih,lN,MG);$n(D4,Zs,ih,lN,MG);const $G=(e,t,n,s,r,i,o)=>{if(o)return[];if(s!==void 0)return s.map(d=>at({},d,{value:n.axis[d.axisId]?.data?.[d.dataIndex]})).filter(({value:d})=>d!==void 0);const l=t!==null&&{axisId:n.axisIds[0],dataIndex:e,value:t},c=r&&n.axis[r.axisId]?.data?.[r.dataIndex],u=r&&c!=null&&at({},r,{value:c});if(i==="pointer"){if(l)return[l];if(u)return[u]}if(i==="keyboard"){if(u)return[u];if(l)return[l]}return[]},Npe=Lt(P4,mpe,Xs,ih,ipe,kx,lN,$G),Cpe=Lt(D4,fpe,Zs,ih,ope,kx,lN,$G),RG=(e,t)=>e===void 0?[t.axis[t.axisIds[0]]]:e.map(s=>t.axis[s.axisId]??null).filter(s=>s!==null);Lt(ih,Xs,RG);Lt(ih,Zs,RG);function L6(e,t){return e.id!==void 0?e:at({id:t},e)}function P6(e){return e.colorMap?at({},e,{colorScale:e.colorMap.type==="ordinal"&&e.data?Df(at({values:e.data},e.colorMap)):vf(e.colorMap.type==="continuous"?at({min:e.min,max:e.max},e.colorMap):e.colorMap)}):e}function zG(e,t){if(!e||e.length===0)return{axis:{},axisIds:[]};const n={},s=[];return e.forEach((r,i)=>{const o=r.dataKey,l=r.id??`defaultized-z-axis-${i}`;if(o===void 0||r.data!==void 0){n[l]=P6(L6(r,l)),s.push(l);return}if(t===void 0)throw new Error("MUI X Charts: z-axis uses `dataKey` but no `dataset` is provided.");n[l]=P6(L6(at({},r,{data:t.map(c=>c[o])}),l)),s.push(l)}),{axis:n,axisIds:s}}const Lx=({params:e,store:t})=>{const{zAxis:n,dataset:s}=e,r=f.useRef(!0);return f.useEffect(()=>{if(r.current){r.current=!1;return}t.set("zAxis",zG(n,s))},[n,s,t]),{}};Lx.params={zAxis:!0,dataset:!0};Lx.getInitialState=e=>({zAxis:zG(e.zAxis,e.dataset)});const Spe=e=>e,_pe=Lt(Spe,e=>e.zAxis),Px=({store:e,params:t})=>{gq({controlled:t.highlightedItem}),is(()=>{e.state.highlight.item!==t.highlightedItem&&e.set("highlight",at({},e.state.highlight,{item:t.highlightedItem}))},[e,t.highlightedItem]);const n=ps(()=>{t.onHighlightChange?.(null);const r=e.getSnapshot().highlight;r.item===null||r.isControlled||e.set("highlight",{item:null,lastUpdate:"pointer",isControlled:!1})}),s=ps(r=>{const i=e.getSnapshot().highlight;i.isControlled||yG(i.item,r)||(t.onHighlightChange?.(r),e.set("highlight",{item:r,lastUpdate:"pointer",isControlled:!1}))});return{instance:{clearHighlight:n,setHighlight:s}}};Px.getInitialState=e=>({highlight:{item:e.highlightedItem,lastUpdate:"pointer",isControlled:e.highlightedItem!==void 0}});Px.params={highlightedItem:!0,onHighlightChange:!0};function Hv(e){let t=1/0,n=-1/0;for(const s of e??[])s<t&&(t=s),s>n&&(n=s);return[t,n]}const D6=(e,t)=>t==="x"?{x:e,y:null}:{x:null,y:e},FG=e=>{const{axis:t,getFilters:n,isDefaultAxis:s}=e,r=n?.({currentAxisId:t.id,isDefaultAxis:s}),i=r?t.data?.filter((o,l)=>r({x:null,y:null},l)):t.data;return Hv(i??[])},UG=e=>t=>{const{series:n,axis:s,getFilters:r,isDefaultAxis:i}=t;return Object.keys(n).filter(o=>{const l=e==="x"?n[o].xAxisId:n[o].yAxisId;return l===s.id||i&&l===void 0}).reduce((o,l)=>{const{stackedData:c}=n[l],u=r?.({currentAxisId:s.id,isDefaultAxis:i,seriesXAxisId:n[l].xAxisId,seriesYAxisId:n[l].yAxisId}),[d,h]=c?.reduce((p,x,v)=>u&&(!u(D6(x[0],e),v)||!u(D6(x[1],e),v))?p:[Math.min(...x,p[0]),Math.max(...x,p[1])],[1/0,-1/0])??[1/0,-1/0];return[Math.min(d,o[0]),Math.max(h,o[1])]},[1/0,-1/0])},Ape=e=>Object.keys(e.series).some(n=>e.series[n].layout==="horizontal")?UG("x")(e):FG(e),Tpe=e=>Object.keys(e.series).some(n=>e.series[n].layout==="horizontal")?FG(e):UG("y")(e);function Na(e){return function(){return e}}const BG=Math.cos,qv=Math.sin,so=Math.sqrt,O6=1e-12,Gv=Math.PI,Cu=2*Gv,Lk=Math.PI,Pk=2*Lk,au=1e-6,kpe=Pk-au;function HG(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function Epe(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return HG;const n=10**t;return function(s){this._+=s[0];for(let r=1,i=s.length;r<i;++r)this._+=Math.round(arguments[r]*n)/n+s[r]}}class Lpe{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?HG:Epe(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,s,r){this._append`Q${+t},${+n},${this._x1=+s},${this._y1=+r}`}bezierCurveTo(t,n,s,r,i,o){this._append`C${+t},${+n},${+s},${+r},${this._x1=+i},${this._y1=+o}`}arcTo(t,n,s,r,i){if(t=+t,n=+n,s=+s,r=+r,i=+i,i<0)throw new Error(`negative radius: ${i}`);let o=this._x1,l=this._y1,c=s-t,u=r-n,d=o-t,h=l-n,p=d*d+h*h;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(p>au)if(!(Math.abs(h*c-u*d)>au)||!i)this._append`L${this._x1=t},${this._y1=n}`;else{let x=s-o,v=r-l,j=c*c+u*u,y=x*x+v*v,N=Math.sqrt(j),w=Math.sqrt(p),S=i*Math.tan((Lk-Math.acos((j+p-y)/(2*N*w)))/2),_=S/w,k=S/N;Math.abs(_-1)>au&&this._append`L${t+_*d},${n+_*h}`,this._append`A${i},${i},0,0,${+(h*x>d*v)},${this._x1=t+k*c},${this._y1=n+k*u}`}}arc(t,n,s,r,i,o){if(t=+t,n=+n,s=+s,o=!!o,s<0)throw new Error(`negative radius: ${s}`);let l=s*Math.cos(r),c=s*Math.sin(r),u=t+l,d=n+c,h=1^o,p=o?r-i:i-r;this._x1===null?this._append`M${u},${d}`:(Math.abs(this._x1-u)>au||Math.abs(this._y1-d)>au)&&this._append`L${u},${d}`,s&&(p<0&&(p=p%Pk+Pk),p>kpe?this._append`A${s},${s},0,1,${h},${t-l},${n-c}A${s},${s},0,1,${h},${this._x1=u},${this._y1=d}`:p>au&&this._append`A${s},${s},0,${+(p>=Lk)},${h},${this._x1=t+s*Math.cos(i)},${this._y1=n+s*Math.sin(i)}`)}rect(t,n,s,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${s=+s}v${+r}h${-s}Z`}toString(){return this._}}function O4(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const s=Math.floor(n);if(!(s>=0))throw new RangeError(`invalid digits: ${n}`);t=s}return e},()=>new Lpe(t)}function cN(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function qG(e){this._context=e}qG.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Dx(e){return new qG(e)}function GG(e){return e[0]}function WG(e){return e[1]}function M4(e,t){var n=Na(!0),s=null,r=Dx,i=null,o=O4(l);e=typeof e=="function"?e:e===void 0?GG:Na(e),t=typeof t=="function"?t:t===void 0?WG:Na(t);function l(c){var u,d=(c=cN(c)).length,h,p=!1,x;for(s==null&&(i=r(x=o())),u=0;u<=d;++u)!(u<d&&n(h=c[u],u,c))===p&&((p=!p)?i.lineStart():i.lineEnd()),p&&i.point(+e(h,u,c),+t(h,u,c));if(x)return i=null,x+""||null}return l.x=function(c){return arguments.length?(e=typeof c=="function"?c:Na(+c),l):e},l.y=function(c){return arguments.length?(t=typeof c=="function"?c:Na(+c),l):t},l.defined=function(c){return arguments.length?(n=typeof c=="function"?c:Na(!!c),l):n},l.curve=function(c){return arguments.length?(r=c,s!=null&&(i=r(s)),l):r},l.context=function(c){return arguments.length?(c==null?s=i=null:i=r(s=c),l):s},l}function Gg(e,t,n){var s=null,r=Na(!0),i=null,o=Dx,l=null,c=O4(u);e=typeof e=="function"?e:e===void 0?GG:Na(+e),t=typeof t=="function"?t:Na(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?WG:Na(+n);function u(h){var p,x,v,j=(h=cN(h)).length,y,N=!1,w,S=new Array(j),_=new Array(j);for(i==null&&(l=o(w=c())),p=0;p<=j;++p){if(!(p<j&&r(y=h[p],p,h))===N)if(N=!N)x=p,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),v=p-1;v>=x;--v)l.point(S[v],_[v]);l.lineEnd(),l.areaEnd()}N&&(S[p]=+e(y,p,h),_[p]=+t(y,p,h),l.point(s?+s(y,p,h):S[p],n?+n(y,p,h):_[p]))}if(w)return l=null,w+""||null}function d(){return M4().defined(r).curve(o).context(i)}return u.x=function(h){return arguments.length?(e=typeof h=="function"?h:Na(+h),s=null,u):e},u.x0=function(h){return arguments.length?(e=typeof h=="function"?h:Na(+h),u):e},u.x1=function(h){return arguments.length?(s=h==null?null:typeof h=="function"?h:Na(+h),u):s},u.y=function(h){return arguments.length?(t=typeof h=="function"?h:Na(+h),n=null,u):t},u.y0=function(h){return arguments.length?(t=typeof h=="function"?h:Na(+h),u):t},u.y1=function(h){return arguments.length?(n=h==null?null:typeof h=="function"?h:Na(+h),u):n},u.lineX0=u.lineY0=function(){return d().x(e).y(t)},u.lineY1=function(){return d().x(e).y(n)},u.lineX1=function(){return d().x(s).y(t)},u.defined=function(h){return arguments.length?(r=typeof h=="function"?h:Na(!!h),u):r},u.curve=function(h){return arguments.length?(o=h,i!=null&&(l=o(i)),u):o},u.context=function(h){return arguments.length?(h==null?i=l=null:l=o(i=h),u):i},u}function Ppe(e,t){return t<e?-1:t>e?1:t>=e?0:NaN}function Dpe(e){return e}function Ope(){var e=Dpe,t=Ppe,n=null,s=Na(0),r=Na(Cu),i=Na(0);function o(l){var c,u=(l=cN(l)).length,d,h,p=0,x=new Array(u),v=new Array(u),j=+s.apply(this,arguments),y=Math.min(Cu,Math.max(-Cu,r.apply(this,arguments)-j)),N,w=Math.min(Math.abs(y)/u,i.apply(this,arguments)),S=w*(y<0?-1:1),_;for(c=0;c<u;++c)(_=v[x[c]=c]=+e(l[c],c,l))>0&&(p+=_);for(t!=null?x.sort(function(k,T){return t(v[k],v[T])}):n!=null&&x.sort(function(k,T){return n(l[k],l[T])}),c=0,h=p?(y-u*S)/p:0;c<u;++c,j=N)d=x[c],_=v[d],N=j+(_>0?_*h:0)+S,v[d]={data:l[d],index:c,value:_,startAngle:j,endAngle:N,padAngle:w};return v}return o.value=function(l){return arguments.length?(e=typeof l=="function"?l:Na(+l),o):e},o.sortValues=function(l){return arguments.length?(t=l,n=null,o):t},o.sort=function(l){return arguments.length?(n=l,t=null,o):n},o.startAngle=function(l){return arguments.length?(s=typeof l=="function"?l:Na(+l),o):s},o.endAngle=function(l){return arguments.length?(r=typeof l=="function"?l:Na(+l),o):r},o.padAngle=function(l){return arguments.length?(i=typeof l=="function"?l:Na(+l),o):i},o}class VG{constructor(t,n){this._context=t,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,n){switch(t=+t,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,n,t,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,t,this._y0,t,n);break}}this._x0=t,this._y0=n}}function YG(e){return new VG(e,!0)}function QG(e){return new VG(e,!1)}const dN={draw(e,t){const n=so(t/Gv);e.moveTo(n,0),e.arc(0,0,n,0,Cu)}},KG={draw(e,t){const n=so(t/5)/2;e.moveTo(-3*n,-n),e.lineTo(-n,-n),e.lineTo(-n,-3*n),e.lineTo(n,-3*n),e.lineTo(n,-n),e.lineTo(3*n,-n),e.lineTo(3*n,n),e.lineTo(n,n),e.lineTo(n,3*n),e.lineTo(-n,3*n),e.lineTo(-n,n),e.lineTo(-3*n,n),e.closePath()}},XG=so(1/3),Mpe=XG*2,ZG={draw(e,t){const n=so(t/Mpe),s=n*XG;e.moveTo(0,-n),e.lineTo(s,0),e.lineTo(0,n),e.lineTo(-s,0),e.closePath()}},JG={draw(e,t){const n=so(t),s=-n/2;e.rect(s,s,n,n)}},Ipe=.8908130915292852,eW=qv(Gv/10)/qv(7*Gv/10),$pe=qv(Cu/10)*eW,Rpe=-BG(Cu/10)*eW,tW={draw(e,t){const n=so(t*Ipe),s=$pe*n,r=Rpe*n;e.moveTo(0,-n),e.lineTo(s,r);for(let i=1;i<5;++i){const o=Cu*i/5,l=BG(o),c=qv(o);e.lineTo(c*n,-l*n),e.lineTo(l*s-c*r,c*s+l*r)}e.closePath()}},C2=so(3),aW={draw(e,t){const n=-so(t/(C2*3));e.moveTo(0,n*2),e.lineTo(-C2*n,-n),e.lineTo(C2*n,-n),e.closePath()}},ii=-.5,oi=so(3)/2,Dk=1/so(12),zpe=(Dk/2+1)*3,nW={draw(e,t){const n=so(t/zpe),s=n/2,r=n*Dk,i=s,o=n*Dk+n,l=-i,c=o;e.moveTo(s,r),e.lineTo(i,o),e.lineTo(l,c),e.lineTo(ii*s-oi*r,oi*s+ii*r),e.lineTo(ii*i-oi*o,oi*i+ii*o),e.lineTo(ii*l-oi*c,oi*l+ii*c),e.lineTo(ii*s+oi*r,ii*r-oi*s),e.lineTo(ii*i+oi*o,ii*o-oi*i),e.lineTo(ii*l+oi*c,ii*c-oi*l),e.closePath()}},sW=[dN,KG,ZG,JG,tW,aW,nW];function I4(e,t){let n=null,s=O4(r);e=typeof e=="function"?e:Na(e||dN),t=typeof t=="function"?t:Na(t===void 0?64:+t);function r(){let i;if(n||(n=i=s()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),i)return n=null,i+""||null}return r.type=function(i){return arguments.length?(e=typeof i=="function"?i:Na(i),r):e},r.size=function(i){return arguments.length?(t=typeof i=="function"?i:Na(+i),r):t},r.context=function(i){return arguments.length?(n=i??null,r):n},r}function Wv(){}function Vv(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function rW(e){this._context=e}rW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Vv(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Vv(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Fpe(e){return new rW(e)}function iW(e){this._context=e}iW.prototype={areaStart:Wv,areaEnd:Wv,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Vv(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Upe(e){return new iW(e)}function oW(e){this._context=e}oW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,s=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,s):this._context.moveTo(n,s);break;case 3:this._point=4;default:Vv(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Bpe(e){return new oW(e)}function M6(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function $4(e,t){this._context=e,this._k=(1-t)/6}$4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:M6(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:M6(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};(function e(t){function n(s){return new $4(s,t)}return n.tension=function(s){return e(+s)},n})(0);function Hpe(e,t,n){var s=e._x1,r=e._y1,i=e._x2,o=e._y2;if(e._l01_a>O6){var l=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,c=3*e._l01_a*(e._l01_a+e._l12_a);s=(s*l-e._x0*e._l12_2a+e._x2*e._l01_2a)/c,r=(r*l-e._y0*e._l12_2a+e._y2*e._l01_2a)/c}if(e._l23_a>O6){var u=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,d=3*e._l23_a*(e._l23_a+e._l12_a);i=(i*u+e._x1*e._l23_2a-t*e._l12_2a)/d,o=(o*u+e._y1*e._l23_2a-n*e._l12_2a)/d}e._context.bezierCurveTo(s,r,i,o,e._x2,e._y2)}function lW(e,t){this._context=e,this._alpha=t}lW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,s=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+s*s,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:Hpe(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const qpe=(function e(t){function n(s){return t?new lW(s,t):new $4(s,0)}return n.alpha=function(s){return e(+s)},n})(.5);function cW(e){this._context=e}cW.prototype={areaStart:Wv,areaEnd:Wv,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function Gpe(e){return new cW(e)}function I6(e){return e<0?-1:1}function $6(e,t,n){var s=e._x1-e._x0,r=t-e._x1,i=(e._y1-e._y0)/(s||r<0&&-0),o=(n-e._y1)/(r||s<0&&-0),l=(i*r+o*s)/(s+r);return(I6(i)+I6(o))*Math.min(Math.abs(i),Math.abs(o),.5*Math.abs(l))||0}function R6(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function S2(e,t,n){var s=e._x0,r=e._y0,i=e._x1,o=e._y1,l=(i-s)/3;e._context.bezierCurveTo(s+l,r+l*t,i-l,o-l*n,i,o)}function Yv(e){this._context=e}Yv.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:S2(this,this._t0,R6(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,S2(this,R6(this,n=$6(this,e,t)),n);break;default:S2(this,this._t0,n=$6(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function dW(e){this._context=new uW(e)}(dW.prototype=Object.create(Yv.prototype)).point=function(e,t){Yv.prototype.point.call(this,t,e)};function uW(e){this._context=e}uW.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,s,r,i){this._context.bezierCurveTo(t,e,s,n,i,r)}};function Ok(e){return new Yv(e)}function mW(e){return new dW(e)}function fW(e){this._context=e}fW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var s=z6(e),r=z6(t),i=0,o=1;o<n;++i,++o)this._context.bezierCurveTo(s[0][i],r[0][i],s[1][i],r[1][i],e[o],t[o]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function z6(e){var t,n=e.length-1,s,r=new Array(n),i=new Array(n),o=new Array(n);for(r[0]=0,i[0]=2,o[0]=e[0]+2*e[1],t=1;t<n-1;++t)r[t]=1,i[t]=4,o[t]=4*e[t]+2*e[t+1];for(r[n-1]=2,i[n-1]=7,o[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)s=r[t]/i[t-1],i[t]-=s,o[t]-=s*o[t-1];for(r[n-1]=o[n-1]/i[n-1],t=n-2;t>=0;--t)r[t]=(o[t]-r[t+1])/i[t];for(i[n-1]=(e[n]+r[n-1])/2,t=0;t<n-1;++t)i[t]=2*e[t+1]-r[t+1];return[r,i]}function hW(e){return new fW(e)}function uN(e,t){this._context=e,this._t=t}uN.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function gW(e){return new uN(e,.5)}function pW(e){return new uN(e,0)}function xW(e){return new uN(e,1)}function gd(e,t){if((o=e.length)>1)for(var n=1,s,r,i=e[t[0]],o,l=i.length;n<o;++n)for(r=i,i=e[t[n]],s=0;s<l;++s)i[s][1]+=i[s][0]=isNaN(r[s][1])?r[s][0]:r[s][1]}function Iu(e){for(var t=e.length,n=new Array(t);--t>=0;)n[t]=t;return n}function Wpe(e,t){return e[t]}function Vpe(e){const t=[];return t.key=e,t}function R4(){var e=Na([]),t=Iu,n=gd,s=Wpe;function r(i){var o=Array.from(e.apply(this,arguments),Vpe),l,c=o.length,u=-1,d;for(const h of i)for(l=0,++u;l<c;++l)(o[l][u]=[0,+s(h,o[l].key,u,i)]).data=h;for(l=0,d=cN(t(o));l<c;++l)o[d[l]].index=l;return n(o,d),o}return r.keys=function(i){return arguments.length?(e=typeof i=="function"?i:Na(Array.from(i)),r):e},r.value=function(i){return arguments.length?(s=typeof i=="function"?i:Na(+i),r):s},r.order=function(i){return arguments.length?(t=i==null?Iu:typeof i=="function"?i:Na(Array.from(i)),r):t},r.offset=function(i){return arguments.length?(n=i??gd,r):n},r}function yW(e,t){if((s=e.length)>0){for(var n,s,r=0,i=e[0].length,o;r<i;++r){for(o=n=0;n<s;++n)o+=e[n][r][1]||0;if(o)for(n=0;n<s;++n)e[n][r][1]/=o}gd(e,t)}}function Ype(e,t){if((c=e.length)>0)for(var n,s=0,r,i,o,l,c,u=e[t[0]].length;s<u;++s)for(o=l=0,n=0;n<c;++n)(i=(r=e[t[n]][s])[1]-r[0])>0?(r[0]=o,r[1]=o+=i):i<0?(r[1]=l,r[0]=l+=i):(r[0]=0,r[1]=i)}function bW(e,t){if((r=e.length)>0){for(var n=0,s=e[t[0]],r,i=s.length;n<i;++n){for(var o=0,l=0;o<r;++o)l+=e[o][n][1]||0;s[n][1]+=s[n][0]=-l/2}gd(e,t)}}function vW(e,t){if(!(!((o=e.length)>0)||!((i=(r=e[t[0]]).length)>0))){for(var n=0,s=1,r,i,o;s<i;++s){for(var l=0,c=0,u=0;l<o;++l){for(var d=e[t[l]],h=d[s][1]||0,p=d[s-1][1]||0,x=(h-p)/2,v=0;v<l;++v){var j=e[t[v]],y=j[s][1]||0,N=j[s-1][1]||0;x+=y-N}c+=h,u+=x*h}r[s-1][1]+=r[s-1][0]=n,c&&(n-=u/c)}r[s-1][1]+=r[s-1][0]=n,gd(e,t)}}function wW(e){var t=e.map(Qpe);return Iu(e).sort(function(n,s){return t[n]-t[s]})}function Qpe(e){for(var t=-1,n=0,s=e.length,r,i=-1/0;++t<s;)(r=+e[t][1])>i&&(i=r,n=t);return n}function jW(e){var t=e.map(NW);return Iu(e).sort(function(n,s){return t[n]-t[s]})}function NW(e){for(var t=0,n=-1,s=e.length,r;++n<s;)(r=+e[n][1])&&(t+=r);return t}function Kpe(e){return jW(e).reverse()}function Xpe(e){var t=e.length,n,s,r=e.map(NW),i=wW(e),o=0,l=0,c=[],u=[];for(n=0;n<t;++n)s=i[n],o<l?(o+=r[s],c.push(s)):(l+=r[s],u.push(s));return u.reverse().concat(c)}function Zpe(e){return Iu(e).reverse()}const _2={appearance:wW,ascending:jW,descending:Kpe,insideOut:Xpe,none:Iu,reverse:Zpe},A2={expand:yW,diverging:Ype,none:gd,silhouette:bW,wiggle:vW},CW=e=>{const{series:t,seriesOrder:n,defaultStrategy:s}=e,r=[],i={};return n.forEach(o=>{const{stack:l,stackOrder:c,stackOffset:u}=t[o];l===void 0?r.push({ids:[o],stackingOrder:_2.none,stackingOffset:A2.none}):i[l]===void 0?(i[l]=r.length,r.push({ids:[o],stackingOrder:_2[c??s?.stackOrder??"none"],stackingOffset:A2[u??s?.stackOffset??"diverging"]})):(r[i[l]].ids.push(o),c!==void 0&&(r[i[l]].stackingOrder=_2[c]),u!==void 0&&(r[i[l]].stackingOffset=A2[u]))}),r},Jpe=e=>e==null?"":e.toLocaleString(),exe=(e,t)=>{const{seriesOrder:n,series:s}=e,r=CW(e),i=t??[];n.forEach(l=>{const c=s[l].data;if(c!==void 0)c.forEach((u,d)=>{i.length<=d?i.push({[l]:u}):i[d][l]=u});else if(t===void 0)throw new Error([`MUI X Charts: bar series with id='${l}' has no data.`,"Either provide a data property to the series or use the dataset prop."].join(`
`))});const o={};return r.forEach(l=>{const{ids:c,stackingOffset:u,stackingOrder:d}=l,h=R4().keys(c.map(p=>{const x=s[p].dataKey;return s[p].data===void 0&&x!==void 0?x:p})).value((p,x)=>p[x]??0).order(d).offset(u)(i);c.forEach((p,x)=>{const v=s[p].dataKey;o[p]=at({layout:"vertical",labelMarkType:"square",minBarSize:0,valueFormatter:s[p].valueFormatter??Jpe},s[p],{data:v?t.map(j=>{const y=j[v];return typeof y=="number"?y:null}):s[p].data,stackedData:h[x].map(([j,y])=>[j,y])})})}),{seriesOrder:n,stackingGroups:r,series:o}};function Xi(e,t){return typeof e=="function"?e(t):e}const txe=e=>{const{seriesOrder:t,series:n}=e;return t.reduce((s,r)=>{const i=Xi(n[r].label,"legend");return i===void 0||s.push({markType:n[r].labelMarkType,id:r,seriesId:r,color:n[r].color,label:i}),s},[])};function z4(e){return e.colorGetter?e.colorGetter:()=>e.color}const axe=(e,t,n)=>{const s=e.layout==="vertical",r=s?t?.colorScale:n?.colorScale,i=s?n?.colorScale:t?.colorScale,o=s?t?.data:n?.data,l=z4(e);return i?c=>{if(c===void 0)return e.color;const u=e.data[c],d=u===null?l({value:u,dataIndex:c}):i(u);return d===null?l({value:u,dataIndex:c}):d}:r&&o?c=>{if(c===void 0)return e.color;const u=o[c],d=u===null?l({value:u,dataIndex:c}):r(u);return d===null?l({value:u,dataIndex:c}):d}:c=>{if(c===void 0)return e.color;const u=e.data[c];return l({value:u,dataIndex:c})}},nxe=e=>{const{series:t,getColor:n,identifier:s}=e;if(!s||s.dataIndex===void 0)return null;const r=Xi(t.label,"tooltip"),i=t.data[s.dataIndex];if(i==null)return null;const o=t.valueFormatter(i,{dataIndex:s.dataIndex});return{identifier:s,color:n(s.dataIndex),label:r,value:i,formattedValue:o,markType:t.labelMarkType}},sxe=e=>Object.values(e).map(t=>t.layout==="horizontal"?{direction:"y",axisId:t.yAxisId}:{direction:"x",axisId:t.xAxisId});function Ka(){const e=Yr();if(!e)throw new Error(["MUI X Charts: Could not find the charts context.","It looks like you rendered your component outside of a ChartContainer parent component."].join(`
`));return e.store}function Ei(){const e=Ka();return Gt(e,wr)}function mN(){const e=Ka();return Gt(e,Ame)}function F4(e){return nG.getTypes().has(e)}const rxe=(e,t,n,s,r,i,o)=>{const l=s==="rotation"?r[t].rotationExtremumGetter:r[t].radiusExtremumGetter,c=o[t]?.series??{},[u,d]=l?.({series:c,axis:n,axisIndex:i,isDefaultAxis:i===0})??[1/0,-1/0],[h,p]=e;return[Math.min(u,h),Math.max(d,p)]},ixe=(e,t,n,s,r)=>{const o=Object.keys(n).filter(F4).reduce((l,c)=>rxe(l,c,e,t,n,s,r),[1/0,-1/0]);return Number.isNaN(o[0])||Number.isNaN(o[1])?[1/0,-1/0]:o},Jc=(e,t)=>e===void 0?t:Math.PI*e/180,oxe=(e,t,n,s)=>{const r=new Set;return Object.keys(t).filter(F4).forEach(o=>{const l=n[o]?.series??{},c=t[o].axisTooltipGetter?.(l);c!==void 0&&c.forEach(({axisId:u,direction:d})=>{d===e&&r.add(u??s)})}),r};function lxe(e,t,n){if(t==="rotation"){if(n.scaleType==="point"){const s=[Jc(n.startAngle,0),Jc(n.endAngle,2*Math.PI)],r=s[1]-s[0];return r>Math.PI*2-.1&&(s[1]-=r/n.data.length),s}return[Jc(n.startAngle,0),Jc(n.endAngle,2*Math.PI)]}return[0,Math.min(e.height,e.width)/2]}const cxe=.2,dxe=.1;function SW({drawingArea:e,formattedSeries:t,axis:n,seriesConfig:s,axisDirection:r}){if(n===void 0)return{axis:{},axisIds:[]};const i=oxe(r,s,t,n[0].id),o={};return n.forEach((l,c)=>{const u=l,d=lxe(e,r,u),[h,p]=ixe(u,r,s,c,t),x=!u.ignoreTooltip&&i.has(u.id),v=u.data??[];if(Zu(u)){const M=u.categoryGapRatio??cxe,z=u.barGapRatio??dxe;if(o[u.id]=at({offset:0,categoryGapRatio:M,barGapRatio:z,triggerTooltip:x},u,{data:v,scale:Zj(u.data,d).paddingInner(M).paddingOuter(M/2),tickNumber:u.data.length,colorScale:u.colorMap&&(u.colorMap.type==="ordinal"?Df(at({values:u.data},u.colorMap)):vf(u.colorMap))}),Ak(u.data)){const P=Tk(u.data,d,u.tickNumber);o[u.id].valueFormatter=u.valueFormatter??P}}if(Ju(u)&&(o[u.id]=at({offset:0,triggerTooltip:x},u,{data:v,scale:tG(u.data,d),tickNumber:u.data.length,colorScale:u.colorMap&&(u.colorMap.type==="ordinal"?Df(at({values:u.data},u.colorMap)):vf(u.colorMap))}),Ak(u.data))){const M=Tk(u.data,d,u.tickNumber);o[u.id].valueFormatter=u.valueFormatter??M}if(!Jme(u))return;const j=u.scaleType??"linear",y=u.domainLimit??"nice",N=[u.min??h,u.max??p];if(typeof y=="function"){const{min:M,max:z}=y(h,p);N[0]=M,N[1]=z}const w=Jq(u,N,T4(Math.abs(d[1]-d[0]))),S=eG(w,d),_=Jj(j,N,d),k=y==="nice"?_.nice(w):_,[T,A]=k.domain(),E=[u.min??T,u.max??A];o[u.id]=at({offset:0,triggerTooltip:x},u,{data:v,scaleType:j,scale:k.domain(E),tickNumber:S,colorScale:u.colorMap&&vf(u.colorMap)})}),{axis:o,axisIds:n.map(({id:l})=>l)}}const _W=e=>e.polarAxis,AW=Lt(_W,e=>e?.rotation),uxe=Lt(_W,e=>e?.radius),nm=Lt(AW,wr,yn,Vr,(e,t,n,s)=>SW({drawingArea:t,formattedSeries:n,axis:e,seriesConfig:s,axisDirection:"rotation"}));Lt(uxe,wr,yn,Vr,(e,t,n,s)=>SW({drawingArea:t,formattedSeries:n,axis:e,seriesConfig:s,axisDirection:"radius"}));const mxe=Lt(wr,e=>({cx:e.left+e.width/2,cy:e.top+e.height/2})),fxe=e=>(t,n)=>Math.atan2(t-e.cx,e.cy-n);function fN(e){return(e%360+360)%360}const T2=2*Math.PI;function hxe(e){return(e%T2+T2)%T2}function F6(e,t){const{scale:n,data:s,reverse:r}=e;if(!vs(n))throw new Error("MUI X Charts: getAxisValue is not implemented for polare continuous axes.");if(!s)return-1;const i=hxe(t-Math.min(...n.range())),o=n.bandwidth()===0?Math.floor((i+n.step()/2)/n.step())%s.length:Math.floor(i/n.step());return o<0||o>=s.length?-1:r?s.length-1-o:o}function jr(){const e=Ka(),{axis:t,axisIds:n}=Gt(e,Xs);return{xAxis:t,xAxisIds:n}}function Nr(){const e=Ka(),{axis:t,axisIds:n}=Gt(e,Zs);return{yAxis:t,yAxisIds:n}}function gxe(e){const t=Ka(),{axis:n,axisIds:s}=Gt(t,Xs),r=s[0];return n[r]}function pxe(e){const t=Ka(),{axis:n,axisIds:s}=Gt(t,Zs),r=s[0];return n[r]}function TW(){const e=Ka(),{axis:t,axisIds:n}=Gt(e,nm);return{rotationAxis:t,rotationAxisIds:n}}function xxe(e){const t=Ka(),{axis:n,axisIds:s}=Gt(t,nm),r=s[0];return n[r]}function oh(e){if(vs(e))return n=>(e(n)??0)+e.bandwidth()/2;const t=e.domain();return t[0]===t[1]?n=>n===t[0]?e(n):NaN:n=>e(n)}function U4(){const e=Ka(),{axis:t,axisIds:n}=Gt(e,_pe)??{axis:{},axisIds:[]};return{zAxis:t,zAxisIds:n}}function B4(){const e=Yr();if(!e)throw new Error(["MUI X Charts: Could not find the svg ref context.","It looks like you rendered your component outside of a ChartContainer parent component."].join(`
`));return e.svgRef}function hN(){const e=Ka();return Gt(e,yn)}const yxe=Lt(yn,(e,t)=>e[t]);$n(yn,(e,t,n)=>{if(!n||Array.isArray(n)&&n.length===0)return e[t]?.seriesOrder?.map(r=>e[t]?.series[r])??[];if(!Array.isArray(n))return e[t]?.series?.[n];const s=[];for(const r of n){const i=e[t]?.series?.[r];i&&s.push(i)}return s});const bxe=e=>{const t=Ka();return Gt(t,yxe,e)};function Ox(){return bxe("line")}function vxe(){return!1}function kW(e,t){return!e||!t?vxe:function(s){return s?e.highlight==="series"?s.seriesId===t.seriesId:e.highlight==="item"?s.dataIndex===t.dataIndex&&s.seriesId===t.seriesId:!1:!1}}function wxe(){return!1}function EW(e,t){return!e||!t?wxe:function(s){return s?e.fade==="series"?s.seriesId===t.seriesId&&s.dataIndex!==t.dataIndex:e.fade==="global"?s.seriesId!==t.seriesId||s.dataIndex!==t.dataIndex:!1:!1}}function H4(e,t,n){return e?.highlight==="series"&&t?.seriesId===n}function jxe(e,t,n){return H4(e,t,n)?!1:e?.fade==="global"&&t!=null||e?.fade==="series"&&t?.seriesId===n}function LW(e,t,n){return e?.highlight==="item"&&t?.seriesId===n?t.dataIndex:null}function Nxe(e,t,n){return H4(e,t,n)||LW(e,t,n)===t?.dataIndex?null:(e?.fade==="series"||e?.fade==="global")&&t?.seriesId===n?t.dataIndex:null}const Cxe=e=>e.highlight,Sxe=Lt(yn,e=>{const t=new Map;return Object.keys(e).forEach(n=>{const s=e[n];s?.seriesOrder?.forEach(r=>{const i=s?.series[r];t.set(r,i?.highlightScope)})}),t}),ic=$n(Cxe,_G,function(t,n){return t.isControlled||t.lastUpdate==="pointer"?t.item:n}),kd=Lt(Sxe,ic,function(t,n){if(!n)return null;const s=t.get(n.seriesId);return s===void 0?null:s}),_xe=Lt(kd,ic,kW),Axe=Lt(kd,ic,EW),Txe=Lt(kd,ic,function(t,n,s){return kW(t,n)(s)});Lt(kd,ic,H4);Lt(kd,ic,jxe);Lt(kd,ic,Nxe);Lt(kd,ic,LW);const kxe=Lt(kd,ic,function(t,n,s){return EW(t,n)(s)});function PW(e){const t=Ka(),n=Gt(t,Txe,e),s=Gt(t,kxe,e);return{isHighlighted:n,isFaded:!n&&s}}function Exe(){const e=Ka(),t=Gt(e,_xe),n=Gt(e,Axe);return{isHighlighted:t,isFaded:n}}function Lxe(e,t){return Object.keys(e).flatMap(n=>{const s=t[n].legendGetter;return s===void 0?[]:s(e[n])})}function Pxe(){const e=hN(),t=Ka(),n=Gt(t,Vr);return{items:Lxe(e,n)}}function q4(){const e=mN();return f.useCallback(t=>`${e}-gradient-${t}`,[e])}function Dxe(){const e=mN();return f.useCallback(t=>`${e}-gradient-${t}-object-bound`,[e])}var k2,U6;function Oxe(){if(U6)return k2;U6=1;var e=4,t=.001,n=1e-7,s=10,r=11,i=1/(r-1),o=typeof Float32Array=="function";function l(j,y){return 1-3*y+3*j}function c(j,y){return 3*y-6*j}function u(j){return 3*j}function d(j,y,N){return((l(y,N)*j+c(y,N))*j+u(y))*j}function h(j,y,N){return 3*l(y,N)*j*j+2*c(y,N)*j+u(y)}function p(j,y,N,w,S){var _,k,T=0;do k=y+(N-y)/2,_=d(k,w,S)-j,_>0?N=k:y=k;while(Math.abs(_)>n&&++T<s);return k}function x(j,y,N,w){for(var S=0;S<e;++S){var _=h(y,N,w);if(_===0)return y;var k=d(y,N,w)-j;y-=k/_}return y}function v(j){return j}return k2=function(y,N,w,S){if(!(0<=y&&y<=1&&0<=w&&w<=1))throw new Error("bezier x values must be in [0, 1] range");if(y===N&&w===S)return v;for(var _=o?new Float32Array(r):new Array(r),k=0;k<r;++k)_[k]=d(k*i,y,w);function T(A){for(var E=0,M=1,z=r-1;M!==z&&_[M]<=A;++M)E+=i;--M;var P=(A-_[M])/(_[M+1]-_[M]),D=E+P*i,U=h(D,y,w);return U>=t?x(A,D,y,w):U===0?D:p(A,E,E+i,y,w)}return function(E){return E===0?0:E===1?1:d(T(E),N,S)}},k2}var Mxe=Oxe();const Ixe=ao(Mxe),gN=300,G4="cubic-bezier(0.66, 0, 0.34, 1)",$xe=Ixe(.66,0,.34,1);var Mf=0,Wg=0,wg=0,DW=1e3,Qv,Vg,Kv=0,$u=0,pN=0,Lp=typeof performance=="object"&&performance.now?performance:Date,OW=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function W4(){return $u||(OW(Rxe),$u=Lp.now()+pN)}function Rxe(){$u=0}function Xv(){this._call=this._time=this._next=null}Xv.prototype=MW.prototype={constructor:Xv,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?W4():+n)+(t==null?0:+t),!this._next&&Vg!==this&&(Vg?Vg._next=this:Qv=this,Vg=this),this._call=e,this._time=n,Mk()},stop:function(){this._call&&(this._call=null,this._time=1/0,Mk())}};function MW(e,t,n){var s=new Xv;return s.restart(e,t,n),s}function zxe(){W4(),++Mf;for(var e=Qv,t;e;)(t=$u-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Mf}function B6(){$u=(Kv=Lp.now())+pN,Mf=Wg=0;try{zxe()}finally{Mf=0,Uxe(),$u=0}}function Fxe(){var e=Lp.now(),t=e-Kv;t>DW&&(pN-=t,Kv=e)}function Uxe(){for(var e,t=Qv,n,s=1/0;t;)t._call?(s>t._time&&(s=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Qv=n);Vg=e,Mk(s)}function Mk(e){if(!Mf){Wg&&(Wg=clearTimeout(Wg));var t=e-$u;t>24?(e<1/0&&(Wg=setTimeout(B6,e-Lp.now()-pN)),wg&&(wg=clearInterval(wg))):(wg||(Kv=Lp.now(),wg=setInterval(Fxe,DW)),Mf=1,OW(B6))}}function Bxe(e,t,n){var s=new Xv;return t=t==null?0:+t,s.restart(r=>{s.stop(),e(r+t)},t,n),s}class Hxe{elapsed=0;timer=null;constructor(t,n,s){this.duration=t,this.easingFn=n,this.onTickCallback=s,this.resume()}get running(){return this.timer!==null}timerCallback(t){this.elapsed=Math.min(t,this.duration);const n=this.duration===0?1:this.elapsed/this.duration,s=this.easingFn(n);this.onTickCallback(s),this.elapsed>=this.duration&&this.stop()}resume(){if(this.running||this.elapsed>=this.duration)return this;const t=W4()-this.elapsed;return this.timer=MW(n=>this.timerCallback(n),0,t),this}stop(){return this.running?(this.timer&&(this.timer.stop(),this.timer=null),this):this}finish(){return this.stop(),Bxe(()=>this.timerCallback(this.duration)),this}}function qxe(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;const n=Object.keys(e),s=Object.keys(t);if(n.length!==s.length)return!1;for(let r=0;r<n.length;r+=1){const i=n[r];if(!Object.prototype.hasOwnProperty.call(t,i)||!Object.is(e[i],t[i]))return!1}return!0}function Gxe(e,{createInterpolator:t,applyProps:n,skip:s,initialProps:r=e}){const i=f.useRef(r),o=f.useRef(null),l=f.useRef(null),c=f.useRef(e);is(()=>{c.current=e},[e]),is(()=>{s&&(o.current?.finish(),o.current=null,l.current=null,i.current=e)},[e,s]);const u=f.useCallback(h=>{const p=i.current,x=t(p,e);o.current=new Hxe(gN,$xe,v=>{const j=x(v);i.current=j,n(h,j)})},[n,t,e]);return[f.useCallback(h=>{if(h===null){o.current?.stop();return}const p=l.current;if(p===h){if(qxe(c.current,e)){o.current?.resume();return}o.current?.stop()}p&&o.current?.stop(),l.current=h,(o.current||!s)&&u(h)},[u,e,s]),i.current]}function IW(e,{createInterpolator:t,transformProps:n,applyProps:s,skip:r,initialProps:i=e,ref:o}){const l=n??(h=>h),[c,u]=Gxe(e,{initialProps:i,createInterpolator:t,applyProps:(h,p)=>s(h,l(p)),skip:r}),d=n(r?e:u);return at({},d,{ref:Uo(c,o)})}function Wxe(e){return IW({d:e.d},{createInterpolator:(t,n)=>{const s=i4(t.d,n.d);return r=>({d:s(r)})},applyProps:(t,{d:n})=>t.setAttribute("d",n),transformProps:t=>t,skip:e.skipAnimation,ref:e.ref})}function Vxe(e){return IW({d:e.d},{createInterpolator:(t,n)=>{const s=i4(t.d,n.d);return r=>({d:s(r)})},applyProps:(t,{d:n})=>t.setAttribute("d",n),skip:e.skipAnimation,transformProps:t=>t,ref:e.ref})}function Yxe(){return Yr().chartRootRef}const Qxe={"image/png":"PNG","image/jpeg":"JPEG","image/webp":"WebP"},Kxe=e=>({components:{MuiChartsLocalizationProvider:{defaultProps:{localeText:at({},e)}}}}),$W={loading:"Loading data",noData:"No data to display",zoomIn:"Zoom in",zoomOut:"Zoom out",toolbarExport:"Export",toolbarExportPrint:"Print",toolbarExportImage:e=>`Export as ${Qxe[e]??e}`,chartTypeBar:"Bar",chartTypeColumn:"Column",chartTypeLine:"Line",chartTypeArea:"Area",chartTypePie:"Pie",chartPaletteLabel:"Color palette",chartPaletteNameRainbowSurge:"Rainbow Surge",chartPaletteNameBlueberryTwilight:"Blueberry Twilight",chartPaletteNameMangoFusion:"Mango Fusion",chartPaletteNameCheerfulFiesta:"Cheerful Fiesta",chartPaletteNameStrawberrySky:"Strawberry Sky",chartPaletteNameBlue:"Blue",chartPaletteNameGreen:"Green",chartPaletteNamePurple:"Purple",chartPaletteNameRed:"Red",chartPaletteNameOrange:"Orange",chartPaletteNameYellow:"Yellow",chartPaletteNameCyan:"Cyan",chartPaletteNamePink:"Pink",chartConfigurationSectionChart:"Chart",chartConfigurationSectionColumns:"Columns",chartConfigurationSectionBars:"Bars",chartConfigurationSectionAxes:"Axes",chartConfigurationGrid:"Grid",chartConfigurationBorderRadius:"Border radius",chartConfigurationCategoryGapRatio:"Category gap ratio",chartConfigurationBarGapRatio:"Series gap ratio",chartConfigurationStacked:"Stacked",chartConfigurationShowToolbar:"Show toolbar",chartConfigurationSkipAnimation:"Skip animation",chartConfigurationInnerRadius:"Inner radius",chartConfigurationOuterRadius:"Outer radius",chartConfigurationColors:"Colors",chartConfigurationHideLegend:"Hide legend",chartConfigurationShowMark:"Show mark",chartConfigurationHeight:"Height",chartConfigurationWidth:"Width",chartConfigurationSeriesGap:"Series gap",chartConfigurationTickPlacement:"Tick placement",chartConfigurationTickLabelPlacement:"Tick label placement",chartConfigurationCategoriesAxisLabel:"Categories axis label",chartConfigurationSeriesAxisLabel:"Series axis label",chartConfigurationXAxisPosition:"X-axis position",chartConfigurationYAxisPosition:"Y-axis position",chartConfigurationSeriesAxisReverse:"Reverse series axis",chartConfigurationTooltipPlacement:"Placement",chartConfigurationTooltipTrigger:"Trigger",chartConfigurationLegendPosition:"Position",chartConfigurationLegendDirection:"Direction",chartConfigurationBarLabels:"Bar labels",chartConfigurationColumnLabels:"Column labels",chartConfigurationInterpolation:"Interpolation",chartConfigurationSectionTooltip:"Tooltip",chartConfigurationSectionLegend:"Legend",chartConfigurationSectionLines:"Lines",chartConfigurationSectionAreas:"Areas",chartConfigurationSectionArcs:"Arcs",chartConfigurationPaddingAngle:"Padding angle",chartConfigurationCornerRadius:"Corner radius",chartConfigurationArcLabels:"Arc labels",chartConfigurationStartAngle:"Start angle",chartConfigurationEndAngle:"End angle",chartConfigurationPieTooltipTrigger:"Trigger",chartConfigurationPieLegendPosition:"Position",chartConfigurationPieLegendDirection:"Direction",chartConfigurationOptionNone:"None",chartConfigurationOptionValue:"Value",chartConfigurationOptionAuto:"Auto",chartConfigurationOptionTop:"Top",chartConfigurationOptionTopLeft:"Top Left",chartConfigurationOptionTopRight:"Top Right",chartConfigurationOptionBottom:"Bottom",chartConfigurationOptionBottomLeft:"Bottom Left",chartConfigurationOptionBottomRight:"Bottom Right",chartConfigurationOptionLeft:"Left",chartConfigurationOptionRight:"Right",chartConfigurationOptionAxis:"Axis",chartConfigurationOptionItem:"Item",chartConfigurationOptionHorizontal:"Horizontal",chartConfigurationOptionVertical:"Vertical",chartConfigurationOptionBoth:"Both",chartConfigurationOptionStart:"Start",chartConfigurationOptionMiddle:"Middle",chartConfigurationOptionEnd:"End",chartConfigurationOptionExtremities:"Extremities",chartConfigurationOptionTick:"Tick",chartConfigurationOptionMonotoneX:"Monotone X",chartConfigurationOptionMonotoneY:"Monotone Y",chartConfigurationOptionCatmullRom:"Catmull-Rom",chartConfigurationOptionLinear:"Linear",chartConfigurationOptionNatural:"Natural",chartConfigurationOptionStep:"Step",chartConfigurationOptionStepBefore:"Step Before",chartConfigurationOptionStepAfter:"Step After",chartConfigurationOptionBumpX:"Bump X",chartConfigurationOptionBumpY:"Bump Y"},Xxe=$W;Kxe($W);const Zxe=["localeText"],Ik=f.createContext(null);function Jxe(e){const{localeText:t}=e,n=ya(e,Zxe),{localeText:s}=f.useContext(Ik)??{localeText:void 0},r=Ti({props:n,name:"MuiChartsLocalizationProvider"}),{children:i,localeText:o}=r,l=f.useMemo(()=>at({},Xxe,o,s,t),[o,s,t]),c=f.useMemo(()=>({localeText:l}),[l]);return a.jsx(Ik.Provider,{value:c,children:i})}const RW=()=>{const e=f.useContext(Ik);if(e===null)throw new Error(["MUI X Charts: Can not find the charts localization context.","It looks like you forgot to wrap your component in ChartsLocalizationProvider.","This can also happen if you are bundling multiple versions of the `@mui/x-charts` package"].join(`
`));return e};function e0e({bandWidth:e,numberOfGroups:t,gapRatio:n}){if(n===0)return{barWidth:e/t,offset:0};const s=e/(t+(t-1)*n),r=n*s;return{barWidth:s,offset:r}}function t0e(e,t,n){const s=e&&t>0,r=!e&&t<0,i=s||r;return n?!i:i}function a0e(e){const{verticalLayout:t,xAxisConfig:n,yAxisConfig:s,series:r,dataIndex:i,numberOfGroups:o,groupIndex:l}=e,c=t?n:s,u=(t?s.reverse:n.reverse)??!1,{barWidth:d,offset:h}=e0e({bandWidth:c.scale.bandwidth(),numberOfGroups:o,gapRatio:c.barGapRatio}),p=l*(d+h),x=n.scale,v=s.scale,j=c.data[i],y=r.data[i];if(y==null)return null;const w=r.stackedData[i].map(A=>t?v(A):x(A)),S=Math.round(Math.min(...w)),_=Math.round(Math.max(...w)),k=y===0?0:Math.max(r.minBarSize,_-S),T=t0e(t,y,u)?_-k:S;return{x:t?x(j)+p:T,y:t?T:v(j)+p,height:t?k:d,width:t?d:k}}const n0e=e=>{const{series:t,identifier:n,axesConfig:s,placement:r}=e;if(!n||n.dataIndex===void 0)return null;const i=t.bar?.series[n.seriesId];if(t.bar==null||i==null||s.x===void 0||s.y===void 0)return null;const o=a0e({verticalLayout:i.layout==="vertical",xAxisConfig:s.x,yAxisConfig:s.y,series:i,dataIndex:n.dataIndex,numberOfGroups:t.bar.stackingGroups.length,groupIndex:t.bar.stackingGroups.findIndex(h=>h.ids.includes(i.id))});if(o==null)return null;const{x:l,y:c,width:u,height:d}=o;switch(r){case"right":return{x:l+u,y:c+d/2};case"bottom":return{x:l+u/2,y:c+d};case"left":return{x:l,y:c+d/2};default:return{x:l+u/2,y:c}}},s0e=(e,t,n)=>at({},e,{id:e.id??`auto-generated-id-${t}`,color:e.color??n[t%n.length]}),r0e={seriesProcessor:exe,colorProcessor:axe,legendGetter:txe,tooltipGetter:nxe,tooltipItemPositionGetter:n0e,axisTooltipGetter:sxe,xExtremumGetter:Ape,yExtremumGetter:Tpe,getSeriesWithDefaultValues:s0e},i0e=e=>{const{series:t,axis:n,isDefaultAxis:s,getFilters:r}=e;let i=1/0,o=-1/0;for(const l in t){if(!Object.hasOwn(t,l))continue;const c=t[l].xAxisId;if(!(c===n.id||c===void 0&&s))continue;const u=r?.({currentAxisId:n.id,isDefaultAxis:s,seriesXAxisId:t[l].xAxisId,seriesYAxisId:t[l].yAxisId}),d=t[l].data??[];for(let h=0;h<d.length;h+=1){const p=d[h];u&&!u(p,h)||p.x!==null&&(p.x<i&&(i=p.x),p.x>o&&(o=p.x))}}return[i,o]},o0e=e=>{const{series:t,axis:n,isDefaultAxis:s,getFilters:r}=e;let i=1/0,o=-1/0;for(const l in t){if(!Object.hasOwn(t,l))continue;const c=t[l].yAxisId;if(!(c===n.id||c===void 0&&s))continue;const u=r?.({currentAxisId:n.id,isDefaultAxis:s,seriesXAxisId:t[l].xAxisId,seriesYAxisId:t[l].yAxisId}),d=t[l].data??[];for(let h=0;h<d.length;h+=1){const p=d[h];u&&!u(p,h)||p.y!==null&&(p.y<i&&(i=p.y),p.y>o&&(o=p.y))}}return[i,o]},l0e=({series:e,seriesOrder:t},n)=>({series:Object.fromEntries(Object.entries(e).map(([r,i])=>{const o=i?.datasetKeys,l=["x","y"].filter(u=>typeof o?.[u]!="string");if(i?.datasetKeys&&l.length>0)throw new Error([`MUI X Charts: scatter series with id='${r}' has incomplete datasetKeys.`,`Properties ${l.map(u=>`"${u}"`).join(", ")} are missing.`].join(`
`));const c=o?n?.map(u=>({x:u[o.x]??null,y:u[o.y]??null,z:o.z&&u[o.z],id:o.id&&u[o.id]}))??[]:i.data??[];return[r,at({labelMarkType:"circle",markerSize:4},i,{preview:at({markerSize:1},i?.preview),data:c,valueFormatter:i.valueFormatter??(u=>u&&`(${u.x}, ${u.y})`)})]})),seriesOrder:t}),c0e=(e,t,n,s)=>{const r=s?.colorScale,i=n?.colorScale,o=t?.colorScale,l=z4(e);return r?c=>{if(c===void 0)return e.color;if(s?.data?.[c]!==void 0){const h=r(s?.data?.[c]);if(h!==null)return h}const u=e.data[c],d=u===null?l({value:u,dataIndex:c}):r(u.z);return d===null?l({value:u,dataIndex:c}):d}:i?c=>{if(c===void 0)return e.color;const u=e.data[c],d=u===null?l({value:u,dataIndex:c}):i(u.y);return d===null?l({value:u,dataIndex:c}):d}:o?c=>{if(c===void 0)return e.color;const u=e.data[c],d=u===null?l({value:u,dataIndex:c}):o(u.x);return d===null?l({value:u,dataIndex:c}):d}:c=>{if(c===void 0)return e.color;const u=e.data[c];return l({value:u,dataIndex:c})}},d0e=e=>{const{seriesOrder:t,series:n}=e;return t.reduce((s,r)=>{const i=Xi(n[r].label,"legend");return i===void 0||s.push({markType:n[r].labelMarkType,id:r,seriesId:r,color:n[r].color,label:i}),s},[])},u0e=e=>{const{series:t,getColor:n,identifier:s}=e;if(!s||s.dataIndex===void 0)return null;const r=Xi(t.label,"tooltip"),i=t.data[s.dataIndex],o=t.valueFormatter(i,{dataIndex:s.dataIndex});return{identifier:s,color:n(s.dataIndex),label:r,value:i,formattedValue:o,markType:t.labelMarkType}},m0e=(e,t,n)=>at({},e,{id:e.id??`auto-generated-id-${t}`,color:e.color??n[t%n.length]}),f0e=e=>{const{series:t,identifier:n,axesConfig:s}=e;if(!n||n.dataIndex===void 0)return null;const r=t.scatter?.series[n.seriesId];if(r==null||s.x===void 0||s.y===void 0)return null;const i=r.data?.[n.dataIndex].x,o=r.data?.[n.dataIndex].y;return i==null||o==null?null:{x:s.x.scale(i),y:s.y.scale(o)}},h0e={seriesProcessor:l0e,colorProcessor:c0e,legendGetter:d0e,tooltipGetter:u0e,tooltipItemPositionGetter:f0e,xExtremumGetter:i0e,yExtremumGetter:o0e,getSeriesWithDefaultValues:m0e},g0e=e=>{const{axis:t}=e;return Hv(t.data??[])};function p0e(e,t,n,s){return n.reduce((r,i,o)=>{if(t[o]===null)return r;const[l,c]=e(i);return s&&(!s({y:l,x:null},o)||!s({y:c,x:null},o))?r:[Math.min(l,c,r[0]),Math.max(l,c,r[1])]},[1/0,-1/0])}const x0e=e=>{const{series:t,axis:n,isDefaultAxis:s,getFilters:r}=e;return Object.keys(t).filter(i=>{const o=t[i].yAxisId;return o===n.id||s&&o===void 0}).reduce((i,o)=>{const{area:l,stackedData:c,data:u}=t[o],d=l!==void 0,h=r?.({currentAxisId:n.id,isDefaultAxis:s,seriesXAxisId:t[o].xAxisId,seriesYAxisId:t[o].yAxisId}),p=d&&n.scaleType!=="log"&&typeof t[o].baseline!="string"?y=>y:y=>[y[1],y[1]],x=p0e(p,u,c,h),[v,j]=x;return[Math.min(v,i[0]),Math.max(j,i[1])]},[1/0,-1/0])};function y0e(e,t){const n={};return Object.keys(e).forEach(s=>{n[s]=at({},e[s],{valueFormatter:e[s].valueFormatter??t})}),n}const b0e=(e,t)=>{const{seriesOrder:n,series:s}=e,r=CW(at({},e,{defaultStrategy:{stackOffset:"none"}})),i=t??[];n.forEach(l=>{const c=s[l].data;c!==void 0&&c.forEach((u,d)=>{i.length<=d?i.push({[l]:u}):i[d][l]=u})});const o={};return r.forEach(l=>{const{ids:c,stackingOrder:u,stackingOffset:d}=l,h=R4().keys(c.map(p=>{const x=s[p].dataKey;return s[p].data===void 0&&x!==void 0?x:p})).value((p,x)=>p[x]??0).order(u).offset(d)(i);c.forEach((p,x)=>{const v=s[p].dataKey;o[p]=at({labelMarkType:"line"},s[p],{data:v?t.map(j=>{const y=j[v];return typeof y=="number"?y:null}):s[p].data,stackedData:h[x].map(([j,y])=>[j,y])})})}),{seriesOrder:n,stackingGroups:r,series:y0e(o,l=>l==null?"":l.toLocaleString())}},V4=(e,t,n)=>{const s=n?.colorScale,r=t?.colorScale,i=z4(e);return s?o=>{if(o===void 0)return e.color;const l=e.data[o],c=l===null?i({value:l,dataIndex:o}):s(l);return c===null?i({value:l,dataIndex:o}):c}:r?o=>{if(o===void 0)return e.color;const l=t.data?.[o],c=l===null?i({value:l,dataIndex:o}):r(l);return c===null?i({value:l,dataIndex:o}):c}:o=>{if(o===void 0)return e.color;const l=e.data[o];return i({value:l,dataIndex:o})}},v0e=e=>{const{seriesOrder:t,series:n}=e;return t.reduce((s,r)=>{const i=Xi(n[r].label,"legend");return i===void 0||s.push({markType:n[r].labelMarkType,id:r,seriesId:r,color:n[r].color,label:i}),s},[])},w0e=e=>{const{series:t,getColor:n,identifier:s}=e;if(!s||s.dataIndex===void 0)return null;const r=Xi(t.label,"tooltip"),i=t.data[s.dataIndex],o=t.valueFormatter(i,{dataIndex:s.dataIndex});return{identifier:s,color:n(s.dataIndex),label:r,value:i,formattedValue:o,markType:t.labelMarkType}},j0e=e=>Object.values(e).map(t=>({direction:"x",axisId:t.xAxisId})),N0e=(e,t,n)=>at({},e,{id:e.id??`auto-generated-id-${t}`,color:e.color??n[t%n.length]}),C0e=e=>{const{series:t,identifier:n,axesConfig:s}=e;if(!n||n.dataIndex===void 0)return null;const r=t.line?.series[n.seriesId];if(r==null||s.x===void 0||s.y===void 0)return null;const i=s.x.data?.[n.dataIndex],o=r.data[n.dataIndex];return i==null||o==null?null:{x:s.x.scale(i),y:s.y.scale(o)}},S0e={colorProcessor:V4,seriesProcessor:b0e,legendGetter:v0e,tooltipGetter:w0e,tooltipItemPositionGetter:C0e,axisTooltipGetter:j0e,xExtremumGetter:g0e,yExtremumGetter:x0e,getSeriesWithDefaultValues:N0e},_0e=(e="none")=>{if(typeof e=="function")return e;switch(e){case"none":return null;case"desc":return(t,n)=>n-t;case"asc":return(t,n)=>t-n;default:return null}},A0e=e=>{const{seriesOrder:t,series:n}=e,s={};return t.forEach(r=>{const i=Ope().startAngle(Jc(n[r].startAngle??0)).endAngle(Jc(n[r].endAngle??360)).padAngle(Jc(n[r].paddingAngle??0)).sortValues(_0e(n[r].sortingValues??"none"))(n[r].data.map(o=>o.value));s[r]=at({labelMarkType:"circle",valueFormatter:o=>o.value.toLocaleString()},n[r],{data:n[r].data.map((o,l)=>at({},o,{id:o.id??`auto-generated-pie-id-${r}-${l}`},i[l])).map((o,l)=>at({labelMarkType:"circle"},o,{formattedValue:n[r].valueFormatter?.(at({},o,{label:Xi(o.label,"arc")}),{dataIndex:l})??o.value.toLocaleString()}))})}),{seriesOrder:t,series:s}},T0e=e=>t=>e.data[t].color,k0e=e=>{const{seriesOrder:t,series:n}=e;return t.reduce((s,r)=>(n[r].data.forEach((i,o)=>{const l=Xi(i.label,"legend");l!==void 0&&s.push({markType:i.labelMarkType??n[r].labelMarkType,id:i.id??o,seriesId:r,color:i.color,label:l,itemId:i.id??o})}),s),[])},E0e=e=>{const{series:t,getColor:n,identifier:s}=e;if(!s||s.dataIndex===void 0)return null;const r=t.data[s.dataIndex];if(r==null)return null;const i=Xi(r.label,"tooltip"),o=at({},r,{label:i}),l=t.valueFormatter(o,{dataIndex:s.dataIndex});return{identifier:s,color:n(s.dataIndex),label:i,value:o,formattedValue:l,markType:r.labelMarkType??t.labelMarkType}},L0e=(e,t,n)=>at({},e,{id:e.id??`auto-generated-id-${t}`,data:e.data.map((s,r)=>at({},s,{color:s.color??n[r%n.length]}))});function Zv(e,t){if(typeof e=="number")return e;if(e==="100%")return t;if(e.endsWith("%")){const n=Number.parseFloat(e.slice(0,e.length-1));if(!Number.isNaN(n))return n*t/100}if(e.endsWith("px")){const n=Number.parseFloat(e.slice(0,e.length-2));if(!Number.isNaN(n))return n}throw new Error(`MUI X Charts: Received an unknown value "${e}". It should be a number, or a string with a percentage value.`)}function P0e(e,t){const{height:n,width:s}=t,{cx:r,cy:i}=e,o=Math.min(s,n)/2,l=Zv(r??"50%",s),c=Zv(i??"50%",n);return{cx:l,cy:c,availableRadius:o}}const D0e=e=>{const{series:t,drawingArea:n,identifier:s,placement:r}=e;if(!s||s.dataIndex===void 0)return null;const i=t.pie?.series[s.seriesId];if(i==null)return null;const{cx:o,cy:l,availableRadius:c}=P0e({cx:i.cx,cy:i.cy},n),{data:u,innerRadius:d=0,outerRadius:h}=i,p=Math.max(0,Zv(d??0,c)),x=Math.max(0,Zv(h??c,c)),v=u[s.dataIndex];if(!v)return null;const j=[[p,v.startAngle],[p,v.endAngle],[x,v.startAngle],[x,v.endAngle]].map(([_,k])=>({x:o+_*Math.sin(k),y:l-_*Math.cos(k)})),[y,N]=Hv(j.map(_=>_.x)),[w,S]=Hv(j.map(_=>_.y));switch(r){case"bottom":return{x:(N+y)/2,y:S};case"left":return{x:y,y:(S+w)/2};case"right":return{x:N,y:(S+w)/2};default:return{x:(N+y)/2,y:w}}},O0e={colorProcessor:T0e,seriesProcessor:A0e,legendGetter:k0e,tooltipGetter:E0e,tooltipItemPositionGetter:D0e,getSeriesWithDefaultValues:L0e},M0e={bar:r0e,scatter:h0e,line:S0e,pie:O0e},I0e=[Lx,_x,rh,Px];function $0e(e){const{children:t,plugins:n=I0e,pluginParams:s={},seriesConfig:r=M0e}=e,{contextValue:i}=Vme(n,s,r);return a.jsx(hq.Provider,{value:i,children:t})}const Yr=()=>{const e=f.useContext(hq);if(e==null)throw new Error(["MUI X Charts: Could not find the Chart context.","It looks like you rendered your component outside of a ChartDataProvider.","This can also happen if you are bundling multiple versions of the library."].join(`
`));return e};function R0e(e){"hasPointerCapture"in e.currentTarget&&e.currentTarget.hasPointerCapture(e.pointerId)&&e.currentTarget.releasePointerCapture(e.pointerId)}const xN=(e,t)=>{const{instance:n}=Yr(),s=f.useRef(!1),r=ps(()=>{s.current=!0,n.setItemInteraction(e,{interaction:"pointer"}),n.setHighlight(e)}),i=ps(()=>{s.current=!1,n.removeItemInteraction(e),n.clearHighlight()});return f.useEffect(()=>()=>{s.current&&i()},[i]),f.useMemo(()=>({onPointerEnter:r,onPointerLeave:i,onPointerDown:R0e}),[t,r,i])};function zW(e){return e.replace(" ","_")}const FW=An("MuiAppearingMask",["animate"]),z0e=fa("rect")({animationName:"animate-width",animationTimingFunction:G4,animationDuration:"0s",[`&.${FW.animate}`]:{animationDuration:`${gN}ms`},"@keyframes animate-width":{from:{width:0}}});function UW(e){const t=Ei(),n=mN(),s=zW(`${n}-${e.id}`);return a.jsxs(f.Fragment,{children:[a.jsx("clipPath",{id:s,children:a.jsx(z0e,{className:e.skipAnimation?"":FW.animate,x:0,y:0,width:t.left+t.width+t.right,height:t.top+t.height+t.bottom})}),a.jsx("g",{clipPath:`url(#${s})`,children:e.children})]})}const F0e=["skipAnimation","ownerState"];function U0e(e){const{skipAnimation:t,ownerState:n}=e,s=ya(e,F0e),r=Wxe(e);return a.jsx(UW,{skipAnimation:t,id:`${n.id}-area-clip`,children:a.jsx("path",at({fill:n.gradientId?`url(#${n.gradientId})`:n.color,filter:n.isHighlighted?"brightness(140%)":n.gradientId?void 0:"brightness(120%)",opacity:n.isFaded?.3:1,stroke:"none","data-series":n.id,"data-highlighted":n.isHighlighted||void 0,"data-faded":n.isFaded||void 0},s,r))})}const B0e=["id","classes","color","gradientId","slots","slotProps","onClick"];function H0e(e){return Yn("MuiAreaElement",e)}const q0e=An("MuiAreaElement",["root","highlighted","faded","series"]),G0e=e=>{const{classes:t,id:n,isFaded:s,isHighlighted:r}=e,i={root:["root",`series-${n}`,r&&"highlighted",s&&"faded"]};return Vn(i,H0e,t)};function W0e(e){const{id:t,classes:n,color:s,gradientId:r,slots:i,slotProps:o,onClick:l}=e,c=ya(e,B0e),u=xN({type:"line",seriesId:t}),{isFaded:d,isHighlighted:h}=PW({seriesId:t}),p={id:t,classes:n,color:s,gradientId:r,isFaded:d,isHighlighted:h},x=G0e(p),v=i?.area??U0e,j=Bl({elementType:v,externalSlotProps:o?.area,additionalProps:at({},u,{onClick:l,cursor:l?"pointer":"unset"}),className:x.root,ownerState:p});return a.jsx(v,at({},c,j))}function Y4(e){const t=Ka(),n=Gt(t,ome);return e||n}function Q4(){const e=Ka();return Gt(e,hG)}function BW(e){switch(e){case"catmullRom":return qpe.alpha(.5);case"linear":return Dx;case"monotoneX":return Ok;case"monotoneY":return mW;case"natural":return hW;case"step":return gW;case"stepBefore":return pW;case"stepAfter":return xW;case"bumpY":return QG;case"bumpX":return YG;default:return Ok}}function V0e(e,t){const n=Ox(),s=jr().xAxisIds[0],r=Nr().yAxisIds[0],i=q4();return f.useMemo(()=>{if(n===void 0)return[];const{series:l,stackingGroups:c}=n,u=[];for(const d of c){const h=d.ids;for(let p=h.length-1;p>=0;p-=1){const x=h[p],{xAxisId:v=s,yAxisId:j=r,stackedData:y,data:N,connectNulls:w,baseline:S,curve:_,strictStepCurve:k,area:T}=l[x];if(!T||!(v in e)||!(j in t))continue;const A=e[v].scale,E=oh(A),M=t[j].scale,z=e[v].data,P=t[j].colorScale&&i(j)||e[v].colorScale&&i(v)||void 0,D=_?.includes("step")&&!k&&vs(A),U=z?.flatMap((Z,V)=>{const oe=N[V]==null;if(D){const je=[{x:Z,y:y[V],nullData:oe,isExtension:!1}];return!oe&&(V===0||N[V-1]==null)&&je.unshift({x:(A(Z)??0)-(A.step()-A.bandwidth())/2,y:y[V],nullData:oe,isExtension:!0}),!oe&&(V===N.length-1||N[V+1]==null)&&je.push({x:(A(Z)??0)+(A.step()+A.bandwidth())/2,y:y[V],nullData:oe,isExtension:!0}),je}return{x:Z,y:y[V],nullData:oe}})??[],B=w?U.filter(Z=>!Z.nullData):U,q=Gg().x(Z=>Z.isExtension?Z.x:E(Z.x)).defined(Z=>w||!Z.nullData||!!Z.isExtension).y0(Z=>{if(typeof S=="number")return M(S);if(S==="max")return M.range()[1];if(S==="min")return M.range()[0];const V=Z.y&&M(Z.y[0]);return Number.isNaN(V)?M.range()[0]:V}).y1(Z=>Z.y&&M(Z.y[1])).curve(BW(_))(B)||"";u.push({area:l[x].area,color:l[x].color,gradientId:P,d:q,seriesId:x})}}return u},[n,s,r,e,t,i])}const Y0e=["slots","slotProps","onItemClick","skipAnimation"],Q0e=fa("g",{name:"MuiAreaPlot",slot:"Root"})({[`& .${q0e.root}`]:{transition:"opacity 0.2s ease-in, fill 0.2s ease-in"}}),K0e=()=>{const{xAxis:e}=jr(),{yAxis:t}=Nr();return V0e(e,t)};function X0e(e){const{slots:t,slotProps:n,onItemClick:s,skipAnimation:r}=e,i=ya(e,Y0e),o=Q4(),l=Y4(o||r),c=K0e();return a.jsx(Q0e,at({},i,{children:c.map(({d:u,seriesId:d,color:h,area:p,gradientId:x})=>!!p&&a.jsx(W0e,{id:d,d:u,color:h,gradientId:x,slots:t,slotProps:n,onClick:s&&(v=>s(v,{type:"line",seriesId:d})),skipAnimation:l},d))}))}const Z0e=["skipAnimation","ownerState"],J0e=f.forwardRef(function(t,n){const{skipAnimation:s,ownerState:r}=t,i=ya(t,Z0e),o=Vxe(at({},t,{ref:n}));return a.jsx(UW,{skipAnimation:s,id:`${r.id}-line-clip`,children:a.jsx("path",at({stroke:r.gradientId?`url(#${r.gradientId})`:r.color,strokeWidth:2,strokeLinejoin:"round",fill:"none",filter:r.isHighlighted?"brightness(120%)":void 0,opacity:r.isFaded?.3:1,"data-series":r.id,"data-highlighted":r.isHighlighted||void 0,"data-faded":r.isFaded||void 0},i,o))})}),eye=["id","classes","color","gradientId","slots","slotProps","onClick"];function tye(e){return Yn("MuiLineElement",e)}const aye=An("MuiLineElement",["root","highlighted","faded","series"]),nye=e=>{const{classes:t,id:n,isFaded:s,isHighlighted:r}=e,i={root:["root",`series-${n}`,r&&"highlighted",s&&"faded"]};return Vn(i,tye,t)};function sye(e){const{id:t,classes:n,color:s,gradientId:r,slots:i,slotProps:o,onClick:l}=e,c=ya(e,eye),u=xN({type:"line",seriesId:t}),{isFaded:d,isHighlighted:h}=PW({seriesId:t}),p={id:t,classes:n,color:s,gradientId:r,isFaded:d,isHighlighted:h},x=nye(p),v=i?.line??J0e,j=Bl({elementType:v,externalSlotProps:o?.line,additionalProps:at({},u,{onClick:l,cursor:l?"pointer":"unset"}),className:x.root,ownerState:p});return a.jsx(v,at({},c,j))}function rye(e,t){const n=Ox(),s=jr().xAxisIds[0],r=Nr().yAxisIds[0],i=q4();return f.useMemo(()=>{if(n===void 0)return[];const{series:l,stackingGroups:c}=n,u=[];for(const d of c){const h=d.ids;for(const p of h){const{xAxisId:x=s,yAxisId:v=r,stackedData:j,data:y,connectNulls:N,curve:w,strictStepCurve:S}=l[p];if(!(x in e)||!(v in t))continue;const _=e[x].scale,k=oh(_),T=t[v].scale,A=e[x].data,E=t[v].colorScale&&i(v)||e[x].colorScale&&i(x)||void 0,M=w?.includes("step")&&!S&&vs(_),z=A?.flatMap((B,R)=>{const q=y[R]==null;if(M){const Z=[{x:B,y:j[R],nullData:q,isExtension:!1}];return!q&&(R===0||y[R-1]==null)&&Z.unshift({x:(_(B)??0)-(_.step()-_.bandwidth())/2,y:j[R],nullData:q,isExtension:!0}),!q&&(R===y.length-1||y[R+1]==null)&&Z.push({x:(_(B)??0)+(_.step()+_.bandwidth())/2,y:j[R],nullData:q,isExtension:!0}),Z}return{x:B,y:j[R],nullData:q}})??[],P=N?z.filter(B=>!B.nullData):z,U=M4().x(B=>B.isExtension?B.x:k(B.x)).defined(B=>N||!B.nullData||!!B.isExtension).y(B=>T(B.y[1])).curve(BW(w))(P)||"";u.push({color:l[p].color,gradientId:E,d:U,seriesId:p})}}return u},[n,s,r,e,t,i])}const iye=["slots","slotProps","skipAnimation","onItemClick"],oye=fa("g",{name:"MuiAreaPlot",slot:"Root"})({[`& .${aye.root}`]:{transition:"opacity 0.2s ease-in, fill 0.2s ease-in"}}),lye=()=>{const{xAxis:e}=jr(),{yAxis:t}=Nr();return rye(e,t)};function cye(e){const{slots:t,slotProps:n,skipAnimation:s,onItemClick:r}=e,i=ya(e,iye),o=Q4(),l=Y4(o||s),c=lye();return a.jsx(oye,at({},i,{children:c.map(({d:u,seriesId:d,color:h,gradientId:p})=>a.jsx(sye,{id:d,d:u,color:h,gradientId:p,skipAnimation:l,slots:t,slotProps:n,onClick:r&&(x=>r(x,{type:"line",seriesId:d}))},d))}))}function dye(e){return Yn("MuiMarkElement",e)}const HW=An("MuiMarkElement",["root","highlighted","faded","animate","series"]),qW=e=>{const{classes:t,id:n,isFaded:s,isHighlighted:r,skipAnimation:i}=e,o={root:["root",`series-${n}`,r&&"highlighted",s&&"faded",i?void 0:"animate"]};return Vn(o,dye,t)},uye=["x","y","id","classes","color","dataIndex","onClick","skipAnimation","isFaded","isHighlighted"],mye=fa("circle")({[`&.${HW.animate}`]:{transitionDuration:`${gN}ms`,transitionProperty:"cx, cy",transitionTimingFunction:G4}});function fye(e){const{x:t,y:n,id:s,classes:r,color:i,dataIndex:o,onClick:l,skipAnimation:c,isFaded:u=!1,isHighlighted:d=!1}=e,h=ya(e,uye),p=Yo(),x=xN({type:"line",seriesId:s,dataIndex:o}),j=qW({id:s,classes:r,isHighlighted:d,isFaded:u,skipAnimation:c});return a.jsx(mye,at({},h,{cx:t,cy:n,r:5,fill:(p.vars||p).palette.background.paper,stroke:i,strokeWidth:2,className:j.root,onClick:l,cursor:l?"pointer":"unset"},x,{"data-highlighted":d||void 0,"data-faded":u||void 0}))}function GW(e){switch(e){case"circle":return 0;case"cross":return 1;case"diamond":return 2;case"square":return 3;case"star":return 4;case"triangle":return 5;case"wye":return 6;default:return 0}}const hye=["x","y","id","classes","color","shape","dataIndex","onClick","skipAnimation","isFaded","isHighlighted"],gye=fa("path",{name:"MuiMarkElement",slot:"Root"})(({ownerState:e,theme:t})=>({fill:(t.vars||t).palette.background.paper,stroke:e.color,strokeWidth:2,[`&.${HW.animate}`]:{transitionDuration:`${gN}ms`,transitionProperty:"transform, transform-origin",transitionTimingFunction:G4}}));function pye(e){const{x:t,y:n,id:s,classes:r,color:i,shape:o,dataIndex:l,onClick:c,skipAnimation:u,isFaded:d=!1,isHighlighted:h=!1}=e,p=ya(e,hye),x=xN({type:"line",seriesId:s,dataIndex:l}),v={id:s,classes:r,isHighlighted:h,isFaded:d,color:i,skipAnimation:u},j=qW(v);return a.jsx(gye,at({},p,{style:{transform:`translate(${t}px, ${n}px)`,transformOrigin:`${t}px ${n}px`},ownerState:v,className:j.root,d:I4(sW[GW(o)])(),onClick:c,cursor:c?"pointer":"unset"},x,{"data-highlighted":h||void 0,"data-faded":d||void 0}))}const xye=["slots","slotProps","skipAnimation","onItemClick"];function yye(e){const{slots:t,slotProps:n,skipAnimation:s,onItemClick:r}=e,i=ya(e,xye),o=Q4(),l=Y4(o||s),c=Ox(),{xAxis:u,xAxisIds:d}=jr(),{yAxis:h,yAxisIds:p}=Nr(),x=mN(),{instance:v,store:j}=Yr(),{isFaded:y,isHighlighted:N}=Exe(),w=Gt(j,IG),S=f.useMemo(()=>{const E={};for(const{dataIndex:M,axisId:z}of w)E[z]===void 0?E[z]=new Set([M]):E[z].add(M);return E},[w]);if(c===void 0)return null;const{series:_,stackingGroups:k}=c,T=d[0],A=p[0];return a.jsx("g",at({},i,{children:k.flatMap(({ids:E})=>E.map(M=>{const{xAxisId:z=T,yAxisId:P=A,stackedData:D,data:U,showMark:B=!0,shape:R="circle"}=_[M];if(B===!1)return null;const q=oh(u[z].scale),Z=h[P].scale,V=u[z].data;if(V===void 0)throw new Error(`MUI X Charts: ${z===zj?"The first `xAxis`":`The x-axis with id "${z}"`} should have data property to be able to display a line plot.`);const oe=zW(`${x}-${M}-line-clip`),je=V4(_[M],u[z],h[P]),X=t?.mark??(R==="circle"?fye:pye),se=N({seriesId:M}),ye=!se&&y({seriesId:M});return a.jsx("g",{clipPath:`url(#${oe})`,"data-series":M,children:V?.map((Ne,fe)=>{const we=U[fe]==null?null:D[fe][1];return{x:q(Ne),y:we===null?null:Z(we),position:Ne,value:we,index:fe}}).filter(({x:Ne,y:fe,index:we,position:de,value:ke})=>ke===null||fe===null||!v.isPointInside(Ne,fe)?!1:B===!0?!0:B({x:Ne,y:fe,index:we,position:de,value:ke})).map(({x:Ne,y:fe,index:we})=>a.jsx(X,at({id:M,dataIndex:we,shape:R,color:je(we),x:Ne,y:fe,skipAnimation:l,onClick:r&&(de=>r(de,{type:"line",seriesId:M,dataIndex:we})),isHighlighted:S[z]?.has(we)||se,isFaded:ye},n?.mark),`${M}-${we}`))},M)}))}))}function yN(){const[e,t]=f.useState(typeof window<"u"||!1);return f.useEffect(()=>{t(!0)},[]),e}function K4(e){return typeof e=="number"&&!Number.isFinite(e)}const $k={start:0,extremities:0,end:1,middle:.5};function E2(e,t,n){return e(t)-(e.step()-e.bandwidth())/2+$k[n]*e.step()}function bye(e){const{scale:t,tickNumber:n,valueFormatter:s,tickInterval:r,tickPlacement:i="extremities",tickLabelPlacement:o,isInside:l}=e;if(vs(t)){const p=t.domain(),x=o??"middle";if(t.bandwidth()>0){const j=typeof r=="function"&&p.filter(r)||typeof r=="object"&&r||p,y=t.range()[0]>t.range()[1],N=j.findIndex(S=>l(E2(t,S,y?"start":"end"))),w=j.findLastIndex(S=>l(E2(t,S,y?"end":"start")));return[...j.slice(N,w+1).map(S=>{const _=`${S}`;return{value:S,formattedValue:s?.(S,{location:"tick",scale:t,tickNumber:n,defaultTickLabel:_})??_,offset:E2(t,S,i),labelOffset:x==="tick"?0:t.step()*($k[x]-$k[i])}}),...i==="extremities"&&w===p.length-1&&l(t.range()[1])?[{formattedValue:void 0,offset:t.range()[1],labelOffset:0}]:[]]}return(typeof r=="function"&&p.filter(r)||typeof r=="object"&&r||p).map(j=>{const y=`${j}`;return{value:j,formattedValue:s?.(j,{location:"tick",scale:t,tickNumber:n,defaultTickLabel:y})??y,offset:t(j),labelOffset:0}})}if(t.domain().some(K4))return[];const u=o,d=typeof r=="object"?r:vye(t,n),h=[];for(let p=0;p<d.length;p+=1){const x=d[p],v=t(x);if(l(v)){const j=t.tickFormat(n)(x);h.push({value:x,formattedValue:s?.(x,{location:"tick",scale:t,tickNumber:n,defaultTickLabel:j})??j,offset:v,labelOffset:u==="middle"?t(d[p-1]??0)-(v+t(d[p-1]??0))/2:0})}}return h}function vye(e,t){const n=e.domain();return n[0]===n[1]?[n[0]]:e.ticks(t)}function bN(e){const{scale:t,tickNumber:n,valueFormatter:s,tickInterval:r,tickPlacement:i="extremities",tickLabelPlacement:o,direction:l}=e,{instance:c}=Yr(),u=l==="x"?c.isXInside:c.isYInside;return f.useMemo(()=>bye({scale:t,tickNumber:n,tickPlacement:i,tickInterval:r,tickLabelPlacement:o,valueFormatter:s,isInside:u}),[t,n,i,r,o,s,u])}function wye(e=!1){const[t,n]=f.useState(!1);return is(()=>{e||n(!0)},[e]),f.useEffect(()=>{e&&n(!0)},[e]),t}const WW=typeof window<"u"&&"Intl"in window&&"Segmenter"in Intl?new Intl.Segmenter(void 0,{granularity:"grapheme"}):null;function jye(e){return e.length}function Nye(e){const t=WW.segment(e);let n=0;for(const s of t)n+=1;return n}const Cye=WW?Nye:jye;function Sye(e){return e*(Math.PI/180)}const VW=typeof window<"u"&&"Intl"in window&&"Segmenter"in Intl?new Intl.Segmenter(void 0,{granularity:"grapheme"}):null;function _ye(e,t){return e.slice(0,t)}function Aye(e,t){const n=VW.segment(e);let s="",r=0;for(const i of n)if(s+=i.segment,r+=1,r>=t)break;return s}const Tye=VW?Aye:_ye,H6="";function YW(e,t){const{width:n,height:s,measureText:r}=t,i=Sye(t.angle),o=r(e),l=Math.abs(o.width*Math.cos(i))+Math.abs(o.height*Math.sin(i)),c=Math.abs(o.width*Math.sin(i))+Math.abs(o.height*Math.cos(i));return l<=n&&c<=s}function QW(e,t){if(t(e))return e;let n=e,s=1,r=1/2;const i=Cye(e);let o=i,l=i,c=null;do{if(l=o,o=Math.floor(i*r),o===0)break;n=Tye(e,o).trim();const u=t(n+H6);s+=1,u?(c=n,r+=1/2**s):r-=1/2**s}while(Math.abs(o-l)!==1);return c?c+H6:""}function KW(){return typeof window>"u"}const ed=new Map,XW=2e3,kye=new Set(["minWidth","maxWidth","width","minHeight","maxHeight","height","top","left","fontSize","padding","margin","paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom"]);function X4(e,t){return kye.has(e)&&t===+t?`${t}px`:t}const Eye=/([A-Z])/g;function Z4(e){return String(e).replace(Eye,t=>`-${t.toLowerCase()}`)}function ZW(e){let t="";for(const n in e)if(Object.hasOwn(e,n)){const s=n,r=e[s];if(r===void 0)continue;t+=`${Z4(s)}:${X4(s,r)};`}return t}const Mx=(e,t={})=>{if(e==null||KW())return{width:0,height:0};const n=String(e),s=ZW(t),r=`${n}-${s}`,i=ed.get(r);if(i)return i;try{const o=eV(),l=document.createElementNS("http://www.w3.org/2000/svg","text");Object.keys(t).map(u=>(l.style[Z4(u)]=X4(u,t[u]),u)),l.textContent=n,o.replaceChildren(l);const c=JW(l);return ed.set(r,c),ed.size+1>XW&&ed.clear(),c}catch{return{width:0,height:0}}};function Lye(e,t={}){if(KW())return new Map(Array.from(e).map(c=>[c,{width:0,height:0}]));const n=new Map,s=[],r=ZW(t);for(const c of e){const u=`${c}-${r}`,d=ed.get(u);d?n.set(c,d):s.push(c)}const i=eV(),o=at({},t);Object.keys(o).map(c=>(i.style[Z4(c)]=X4(c,o[c]),c));const l=[];for(const c of s){const u=document.createElementNS("http://www.w3.org/2000/svg","text");u.textContent=`${c}`,l.push(u)}i.replaceChildren(...l);for(let c=0;c<s.length;c+=1){const u=s[c],d=i.children[c],h=JW(d),p=`${u}-${r}`;ed.set(p,h),n.set(u,h)}return ed.size+1>XW&&ed.clear(),n}function JW(e){try{const t=e.getBBox();return{width:t.width,height:t.height}}catch{const t=e.getBoundingClientRect();return{width:t.width,height:t.height}}}let ir=null;function eV(){return ir===null&&(ir=document.createElementNS("http://www.w3.org/2000/svg","svg"),ir.setAttribute("aria-hidden","true"),ir.style.position="absolute",ir.style.top="-20000px",ir.style.left="0",ir.style.padding="0",ir.style.margin="0",ir.style.border="none",ir.style.pointerEvents="none",ir.style.visibility="hidden",ir.style.contain="strict",document.body.appendChild(ir)),ir}function Pye(e,t,n,s,r){const i=new Map,o=fN(r?.angle??0);let l=1,c=1;r?.textAnchor==="start"?(l=1/0,c=1):r?.textAnchor==="end"?(l=1,c=1/0):(l=2,c=2),o>90&&o<270&&([l,c]=[c,l]),s&&([l,c]=[c,l]);for(const u of e)if(u.formattedValue){const d=Math.min((u.offset+u.labelOffset)*l,(t.left+t.width+t.right-u.offset-u.labelOffset)*c),h=p=>YW(p,{width:d,height:n,angle:o,measureText:x=>Mx(x,r)});i.set(u,QW(u.formattedValue.toString(),h))}return i}const q6=5;function Dye(e,t,n=0){const s=Math.min(Math.abs(n)%180,Math.abs(Math.abs(n)%180-180)%180);if(s<q6)return e;if(s>90-q6)return t;const r=Jc(s),i=Math.atan2(t,e);return r<i?e/Math.cos(r):t/Math.sin(r)}function Oye(e,{tickLabelStyle:t,tickLabelInterval:n,tickLabelMinGap:s,reverse:r,isMounted:i,isXInside:o}){if(typeof n=="function")return new Set(e.filter((h,p)=>n(h.value,p)));let l=0;const c=r?-1:1,u=e.filter(h=>{const{offset:p,labelOffset:x,formattedValue:v}=h;if(v==="")return!1;const j=p+x;return o(j)}),d=Iye(u,t);return new Set(u.filter((h,p)=>{const{offset:x,labelOffset:v}=h,j=x+v;if(p>0&&c*j<c*(l+s))return!1;const{width:y,height:N}=i?Mye(d,h):{width:0,height:0},w=Dye(y,N,t?.angle),S=j-c*w/2;return p>0&&c*S<c*(l+s)?!1:(l=j+c*w/2,!0)}))}function Mye(e,t){if(t.formattedValue===void 0)return{width:0,height:0};let n=0,s=0;for(const r of t.formattedValue.split(`
`)){const i=e.get(r);i&&(n=Math.max(n,i.width),s+=i.height)}return{width:n,height:s}}function Iye(e,t){const n=new Set;for(const s of e)s.formattedValue&&s.formattedValue.split(`
`).forEach(r=>n.add(r));return Lye(n,t)}function tV(e){return Yn("MuiChartsAxis",e)}const Zy=An("MuiChartsAxis",["root","line","tickContainer","tick","tickLabel","label","directionX","directionY","top","bottom","left","right","id"]),aV=e=>{const{classes:t,position:n,id:s}=e,r={root:["root","directionX",n,`id-${s}`],line:["line"],tickContainer:["tickContainer"],tick:["tick"],tickLabel:["tickLabel"],label:["label"]};return Vn(r,tV,t)},Rk=3,$ye=4,nV={disableLine:!1,disableTicks:!1,tickSize:6,tickLabelMinGap:4};function Rye({style:e,needsComputation:t,text:n}){return n.split(`
`).map(s=>at({text:s},t?Mx(s,e):{width:0,height:0}))}const zye=["x","y","style","text","ownerState"],Fye=["angle","textAnchor","dominantBaseline"];function vN(e){const{x:t,y:n,style:s,text:r}=e,i=ya(e,zye),o=s??{},{angle:l,textAnchor:c,dominantBaseline:u}=o,d=ya(o,Fye),h=yN(),p=f.useMemo(()=>Rye({style:d,needsComputation:h&&r.includes(`
`),text:r}),[d,r,h]);let x;switch(u){case"hanging":case"text-before-edge":x=0;break;case"central":x=(p.length-1)/2*-p[0].height;break;default:x=(p.length-1)*-p[0].height;break}return a.jsx("text",at({},i,{transform:l?`rotate(${l}, ${t}, ${n})`:void 0,x:t,y:n,textAnchor:c,dominantBaseline:u,style:d,children:p.map((v,j)=>a.jsx("tspan",{x:t,dy:`${j===0?x:p[0].height}px`,dominantBaseline:u,children:v.text},j))}))}function sV(e){const t=fN(e);return t<=30||t>=330||t<=210&&t>=150?"middle":t<=180?"end":"start"}function rV(e){const t=fN(e);return t<=30||t>=330?"hanging":t<=210&&t>=150?"auto":"central"}function iV(e){switch(e){case"start":return"end";case"end":return"start";default:return e}}const Uye=["scale","tickNumber","reverse"];function oV(e){const{xAxis:t,xAxisIds:n}=jr(),s=t[e.axisId??n[0]],{scale:r,tickNumber:i,reverse:o}=s,l=ya(s,Uye),c=Ti({props:at({},l,e),name:"MuiChartsXAxis"}),u=at({},nV,c),{position:d,tickLabelStyle:h,slots:p,slotProps:x}=u,v=Yo(),j=yx(),y=aV(u),N=d==="bottom"?1:-1,w=p?.axisTick??"line",S=p?.axisTickLabel??vN,_=sV((d==="bottom"?0:180)-(h?.angle??0)),k=rV((d==="bottom"?0:180)-(h?.angle??0)),T=Bl({elementType:S,externalSlotProps:x?.axisTickLabel,additionalProps:{style:at({},v.typography.caption,{fontSize:12,lineHeight:1.25,textAnchor:j?iV(_):_,dominantBaseline:k},h)},className:y.tickLabel,ownerState:{}});return{xScale:r,defaultizedProps:u,tickNumber:i,positionSign:N,classes:y,Tick:w,TickLabel:S,axisTickLabelProps:T,reverse:o}}function Bye(e){const{axisLabelHeight:t}=e,{xScale:n,defaultizedProps:s,tickNumber:r,positionSign:i,classes:o,Tick:l,TickLabel:c,axisTickLabelProps:u,reverse:d}=oV(e),h=yx(),p=wye(),{disableTicks:x,tickSize:v,valueFormatter:j,slotProps:y,tickInterval:N,tickLabelInterval:w,tickPlacement:S,tickLabelPlacement:_,tickLabelMinGap:k,height:T}=s,A=Ei(),{instance:E}=Yr(),M=yN(),z=x?4:v,P=bN({scale:n,tickNumber:r,valueFormatter:j,tickInterval:N,tickPlacement:S,tickLabelPlacement:_,direction:"x"}),D=Oye(P,{tickLabelStyle:u.style,tickLabelInterval:w,tickLabelMinGap:k,reverse:d,isMounted:p,isXInside:E.isXInside}),U=Math.max(0,T-(t>0?t+$ye:0)-z-Rk),B=M?Pye(D,A,U,h,u.style):new Map(Array.from(D).map(R=>[R,R.formattedValue]));return a.jsx(f.Fragment,{children:P.map((R,q)=>{const{offset:Z,labelOffset:V}=R,oe=V??0,je=i*(z+Rk),X=E.isXInside(Z),se=B.get(R),ye=D.has(R);return a.jsxs("g",{transform:`translate(${Z}, 0)`,className:o.tickContainer,children:[!x&&X&&a.jsx(l,at({y2:i*z,className:o.tick},y?.axisTick)),se!==void 0&&ye&&a.jsx(c,at({x:oe,y:je},u,{text:se}))]},q)})})}const jg={start:0,extremities:0,end:1,middle:.5,tick:0};function lV(e){const{scale:t,tickInterval:n,tickLabelPlacement:s="middle",tickPlacement:r="extremities",groups:i}=e;return f.useMemo(()=>{const o=t.domain(),l=typeof n=="function"&&o.filter(n)||typeof n=="object"&&n||o;if(t.bandwidth()>0){const c=G6(l,i,r,s,t);return c[0]&&(c[0].ignoreTick=!0),[{formattedValue:void 0,offset:t.range()[0],labelOffset:0,groupIndex:i.length-1},...c,{formattedValue:void 0,offset:t.range()[1],labelOffset:0,groupIndex:i.length-1}]}return G6(l,i,r,s,t)},[t,n,i,r,s])}function G6(e,t,n,s,r){const i=[],o=new Map;let l=0;for(let c=0;c<t.length;c+=1)for(let u=0;u<e.length;u+=1){const d=e[u],h=t[c].getValue(d,u),p=i[i.length-1];if(p?.value!==h||p?.groupIndex!==c){l=1;const v=vs(r)?r(d)-(r.step()-r.bandwidth())/2+jg[n]*r.step():r(d),j=r.step()*l*(jg[s]-jg[n]);i.push({value:h,formattedValue:`${h}`,offset:v,groupIndex:c,dataIndex:u,ignoreTick:!1,labelOffset:j}),o.has(u)||o.set(u,new Set);const y=o.get(u);for(const N of y.values())i[N].ignoreTick=!0;y.add(i.length-1)}else{l+=1;const v=r.step()*l*(jg[s]-jg[n]);p.labelOffset=v}}return i}const W6={tickSize:6},Hye=(e,t,n)=>{const s=e[t]??{},r=n??W6.tickSize,i=r*t*2+r;return at({},W6,s,{tickSize:s.tickSize??i})};function qye(e){const{xScale:t,defaultizedProps:n,positionSign:s,classes:r,Tick:i,TickLabel:o,axisTickLabelProps:l}=oV(e);if(!vs(t))throw new Error("MUI X Charts: ChartsGroupedXAxis only supports the `band` and `point` scale types.");const{disableTicks:c,tickSize:u,valueFormatter:d,slotProps:h,tickInterval:p,tickPlacement:x,tickLabelPlacement:v}=n,j=n.groups,{instance:y}=Yr(),N=lV({scale:t,tickInterval:p,tickPlacement:x,tickLabelPlacement:v,groups:j});return a.jsx(f.Fragment,{children:N.map((w,S)=>{const{offset:_,labelOffset:k}=w,T=k??0,A=y.isXInside(_),E=w.formattedValue,M=w.ignoreTick??!1,z=w.groupIndex??0,P=Hye(j,z,u),D=s*P.tickSize,U=s*(P.tickSize+Rk);return a.jsxs("g",{transform:`translate(${_}, 0)`,className:r.tickContainer,"data-group-index":z,children:[!c&&!M&&A&&a.jsx(i,at({y2:D,className:r.tick},h?.axisTick)),E!==void 0&&a.jsx(o,at({x:T,y:U},l,{style:at({},l.style,P.tickLabelStyle),text:E}))]},S)})})}const cV=fa("g",{name:"MuiChartsAxis",slot:"Root"})(({theme:e})=>({[`& .${Zy.tickLabel}`]:at({},e.typography.caption,{fill:(e.vars||e).palette.text.primary}),[`& .${Zy.label}`]:{fill:(e.vars||e).palette.text.primary},[`& .${Zy.line}`]:{stroke:(e.vars||e).palette.text.primary,shapeRendering:"crispEdges",strokeWidth:1},[`& .${Zy.tick}`]:{stroke:(e.vars||e).palette.text.primary,shapeRendering:"crispEdges"}})),Gye=["axis"],Wye=["scale","tickNumber","reverse"],Vye=fa(cV,{name:"MuiChartsXAxis",slot:"Root"})({});function Yye(e){let{axis:t}=e,n=ya(e,Gye);const{scale:s}=t,r=ya(t,Wye),i=Ti({props:at({},r,n),name:"MuiChartsXAxis"}),o=at({},nV,i),{position:l,labelStyle:c,offset:u,slots:d,slotProps:h,sx:p,disableLine:x,label:v,height:j}=o,y=Yo(),N=aV(o),{left:w,top:S,width:_,height:k}=Ei(),T=l==="bottom"?1:-1,A=d?.axisLine??"line",E=d?.axisLabel??vN,M=Bl({elementType:E,externalSlotProps:h?.axisLabel,additionalProps:{style:at({},y.typography.body1,{lineHeight:1,fontSize:14,textAnchor:"middle",dominantBaseline:l==="bottom"?"text-after-edge":"text-before-edge"},c)},ownerState:{}});if(l==="none")return null;const z=v?Mx(v,M.style).height:0,P=s.domain(),U=vs(s)?P.length===0:P.some(K4);let B=null;U||(B="groups"in t&&Array.isArray(t.groups)?a.jsx(qye,at({},n)):a.jsx(Bye,at({},n,{axisLabelHeight:z})));const R={x:w+_/2,y:T*j};return a.jsxs(Vye,{transform:`translate(0, ${l==="bottom"?S+k+u:S-u})`,className:N.root,sx:p,children:[!x&&a.jsx(A,at({x1:w,x2:w+_,className:N.line},h?.axisLine)),B,v&&a.jsx("g",{className:N.label,children:a.jsx(E,at({},R,M,{text:v}))})]})}function Qye(e){const{xAxis:t,xAxisIds:n}=jr(),s=t[e.axisId??n[0]];return s?a.jsx(Yye,at({},e,{axis:s})):(`${e.axisId}`,null)}function Kye(e,t,n,s,r){const i=new Map,o=fN(r?.angle??0);let l=1,c=1;r?.textAnchor==="start"?(l=1/0,c=1):r?.textAnchor==="end"?(l=1,c=1/0):(l=2,c=2),o>180&&([l,c]=[c,l]),s&&([l,c]=[c,l]);for(const u of e)if(u.formattedValue){const d=Math.min((u.offset+u.labelOffset)*l,(t.top+t.height+t.bottom-u.offset-u.labelOffset)*c),h=p=>YW(p,{width:n,height:d,angle:o,measureText:x=>Mx(x,r)});i.set(u,QW(u.formattedValue.toString(),h))}return i}const dV=e=>{const{classes:t,position:n,id:s}=e,r={root:["root","directionY",n,`id-${s}`],line:["line"],tickContainer:["tickContainer"],tick:["tick"],tickLabel:["tickLabel"],label:["label"]};return Vn(r,tV,t)},zk=2,Xye=2,uV={disableLine:!1,disableTicks:!1,tickSize:6},Zye=["scale","tickNumber","reverse"];function mV(e){const{yAxis:t,yAxisIds:n}=Nr(),s=t[e.axisId??n[0]],{scale:r,tickNumber:i}=s,o=ya(s,Zye),l=Ti({props:at({},o,e),name:"MuiChartsYAxis"}),c=at({},uV,l),{position:u,tickLabelStyle:d,slots:h,slotProps:p}=c,x=Yo(),v=yx(),j=dV(c),y=u==="right"?1:-1,N=typeof d?.fontSize=="number"?d.fontSize:12,w=h?.axisTick??"line",S=h?.axisTickLabel??vN,_=sV((u==="right"?-90:90)-(d?.angle??0)),k=rV((u==="right"?-90:90)-(d?.angle??0)),T=Bl({elementType:S,externalSlotProps:p?.axisTickLabel,additionalProps:{style:at({},x.typography.caption,{fontSize:N,textAnchor:v?iV(_):_,dominantBaseline:k},d)},className:j.tickLabel,ownerState:{}});return{yScale:r,defaultizedProps:c,tickNumber:i,positionSign:y,classes:j,Tick:w,TickLabel:S,axisTickLabelProps:T}}function Jye(e){const{axisLabelHeight:t}=e,{yScale:n,defaultizedProps:s,tickNumber:r,positionSign:i,classes:o,Tick:l,TickLabel:c,axisTickLabelProps:u}=mV(e),d=yx(),{disableTicks:h,tickSize:p,valueFormatter:x,slotProps:v,tickPlacement:j,tickLabelPlacement:y,tickInterval:N,tickLabelInterval:w,width:S}=s,_=Ei(),{instance:k}=Yr(),T=yN(),A=h?4:p,E=bN({scale:n,tickNumber:r,valueFormatter:x,tickPlacement:j,tickLabelPlacement:y,tickInterval:N,direction:"y"}),M=Math.max(0,S-(t>0?t+Xye:0)-A-zk),z=T?Kye(E,_,M,d,u.style):new Map(Array.from(E).map(P=>[P,P.formattedValue]));return a.jsx(f.Fragment,{children:E.map((P,D)=>{const{offset:U,labelOffset:B,value:R}=P,q=i*(A+zk),Z=B,V=typeof w=="function"&&!w?.(R,D),oe=k.isYInside(U),je=z.get(P);return oe?a.jsxs("g",{transform:`translate(0, ${U})`,className:o.tickContainer,children:[!h&&a.jsx(l,at({x2:i*A,className:o.tick},v?.axisTick)),je!==void 0&&!V&&a.jsx(c,at({x:q,y:Z,text:je},u))]},D):null})})}const V6={tickSize:6},ebe=(e,t,n)=>{const s=e[t]??{},r=n??V6.tickSize,i=r*t*2+r;return at({},V6,s,{tickSize:s.tickSize??i})};function tbe(e){const{yScale:t,defaultizedProps:n,positionSign:s,classes:r,Tick:i,TickLabel:o,axisTickLabelProps:l}=mV(e);if(!vs(t))throw new Error("MUI X Charts: ChartsGroupedYAxis only supports the `band` and `point` scale types.");const{disableTicks:c,tickSize:u,valueFormatter:d,slotProps:h,tickInterval:p,tickPlacement:x,tickLabelPlacement:v}=n,j=n.groups,{instance:y}=Yr(),N=lV({scale:t,tickInterval:p,tickPlacement:x,tickLabelPlacement:v,groups:j});return a.jsx(f.Fragment,{children:N.map((w,S)=>{const{offset:_,labelOffset:k}=w,T=k??0,A=y.isYInside(_),E=w.formattedValue,M=w.ignoreTick??!1,z=w.groupIndex??0,P=ebe(j,z,u),D=s*P.tickSize,U=s*(P.tickSize+zk);return a.jsxs("g",{transform:`translate(0, ${_})`,className:r.tickContainer,"data-group-index":z,children:[!c&&!M&&A&&a.jsx(i,at({x2:D,className:r.tick},h?.axisTick)),E!==void 0&&a.jsx(o,at({x:U,y:T},l,{style:at({},l.style,P.tickLabelStyle),text:E}))]},S)})})}const abe=["axis"],nbe=["scale","tickNumber","reverse"],sbe=fa(cV,{name:"MuiChartsYAxis",slot:"Root"})({});function rbe(e){let{axis:t}=e,n=ya(e,abe);const{scale:s}=t,r=ya(t,nbe),i=yN(),o=Ti({props:at({},r,n),name:"MuiChartsYAxis"}),l=at({},uV,o),{position:c,disableLine:u,label:d,labelStyle:h,offset:p,width:x,sx:v,slots:j,slotProps:y}=l,N=Yo(),w=dV(l),{left:S,top:_,width:k,height:T}=Ei(),A=c==="right"?1:-1,E=j?.axisLine??"line",M=j?.axisLabel??vN,z=Bl({elementType:E,externalSlotProps:y?.axisLine,additionalProps:{strokeLinecap:"square"},ownerState:{}}),P=Bl({elementType:M,externalSlotProps:y?.axisLabel,additionalProps:{style:at({},N.typography.body1,{lineHeight:1,fontSize:14,angle:A*90,textAnchor:"middle",dominantBaseline:"text-before-edge"},h)},ownerState:{}});if(c==="none")return null;const D={x:A*x,y:_+T/2},U=d==null?0:Mx(d,P.style).height,B=s.domain(),q=vs(s)?B.length===0:B.some(K4);let Z=null;return q||(Z="groups"in t&&Array.isArray(t.groups)?a.jsx(tbe,at({},n)):a.jsx(Jye,at({},n,{axisLabelHeight:U}))),a.jsxs(sbe,{transform:`translate(${c==="right"?S+k+p:S-p}, 0)`,className:w.root,sx:v,children:[!u&&a.jsx(E,at({y1:_,y2:_+T,className:w.line},z)),Z,d&&i&&a.jsx("g",{className:w.label,children:a.jsx(M,at({},D,P,{text:d}))})]})}function ibe(e){const{yAxis:t,yAxisIds:n}=Nr(),s=t[e.axisId??n[0]];return s?a.jsx(rbe,at({},e,{axis:s})):(`${e.axisId}`,null)}function obe(e){const{slots:t,slotProps:n}=e,{xAxisIds:s,xAxis:r}=jr(),{yAxisIds:i,yAxis:o}=Nr();return a.jsxs(f.Fragment,{children:[s.map(l=>!r[l].position||r[l].position==="none"?null:a.jsx(Qye,{slots:t,slotProps:n,axisId:l},l)),i.map(l=>!o[l].position||o[l].position==="none"?null:a.jsx(ibe,{slots:t,slotProps:n,axisId:l},l))]})}function lbe(e){return Yn("MuiTypography",e)}An("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]);const cbe={primary:!0,secondary:!0,error:!0,info:!0,success:!0,warning:!0,textPrimary:!0,textSecondary:!0,textDisabled:!0},dbe=Lde(),ube=e=>{const{align:t,gutterBottom:n,noWrap:s,paragraph:r,variant:i,classes:o}=e,l={root:["root",i,e.align!=="inherit"&&`align${Wa(t)}`,n&&"gutterBottom",s&&"noWrap",r&&"paragraph"]};return Vn(l,lbe,o)},mbe=fa("span",{name:"MuiTypography",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.variant&&t[n.variant],n.align!=="inherit"&&t[`align${Wa(n.align)}`],n.noWrap&&t.noWrap,n.gutterBottom&&t.gutterBottom,n.paragraph&&t.paragraph]}})(Mu(({theme:e})=>({margin:0,variants:[{props:{variant:"inherit"},style:{font:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}},...Object.entries(e.typography).filter(([t,n])=>t!=="inherit"&&n&&typeof n=="object").map(([t,n])=>({props:{variant:t},style:n})),...Object.entries(e.palette).filter(jp()).map(([t])=>({props:{color:t},style:{color:(e.vars||e).palette[t].main}})),...Object.entries(e.palette?.text||{}).filter(([,t])=>typeof t=="string").map(([t])=>({props:{color:`text${Wa(t)}`},style:{color:(e.vars||e).palette.text[t]}})),{props:({ownerState:t})=>t.align!=="inherit",style:{textAlign:"var(--Typography-textAlign)"}},{props:({ownerState:t})=>t.noWrap,style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},{props:({ownerState:t})=>t.gutterBottom,style:{marginBottom:"0.35em"}},{props:({ownerState:t})=>t.paragraph,style:{marginBottom:16}}]}))),Y6={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},J4=f.forwardRef(function(t,n){const{color:s,...r}=Sd({props:t,name:"MuiTypography"}),i=!cbe[s],o=dbe({...r,...i&&{color:s}}),{align:l="inherit",className:c,component:u,gutterBottom:d=!1,noWrap:h=!1,paragraph:p=!1,variant:x="body1",variantMapping:v=Y6,...j}=o,y={...o,align:l,color:s,className:c,component:u,gutterBottom:d,noWrap:h,paragraph:p,variant:x,variantMapping:v},N=u||(p?"p":v[x]||Y6[x])||"span",w=ube(y);return a.jsx(mbe,{as:N,ref:n,className:$t(w.root,c),...j,ownerState:y,style:{...l!=="inherit"&&{"--Typography-textAlign":l},...j.style}})});function fbe(e){return Yn("MuiChartsTooltip",e)}const cf=An("MuiChartsTooltip",["root","paper","table","row","cell","mark","markContainer","labelCell","valueCell","axisValueCell"]),wN=e=>Vn({root:["root"],paper:["paper"],table:["table"],row:["row"],cell:["cell"],mark:["mark"],markContainer:["markContainer"],labelCell:["labelCell"],valueCell:["valueCell"],axisValueCell:["axisValueCell"]},fbe,e);function hbe(){const e=Ka(),t=Gt(e,AG),n=Gt(e,Vr),s=hN(),{xAxis:r,xAxisIds:i}=jr(),{yAxis:o,yAxisIds:l}=Nr(),{zAxis:c,zAxisIds:u}=U4(),{rotationAxis:d,rotationAxisIds:h}=TW();if(!t)return null;const p=s[t.type]?.series[t.seriesId];if(!p)return null;const x=Bv(p)?p.xAxisId??i[0]:void 0,v=Bv(p)?p.yAxisId??l[0]:void 0,j="zAxisId"in p?p.zAxisId??u[0]:u[0],y=h[0],N=n[p.type].colorProcessor?.(p,x!==void 0?r[x]:void 0,v!==void 0?o[v]:void 0,j!==void 0?c[j]:void 0)??(()=>""),w={};return x!==void 0&&(w.x=r[x]),v!==void 0&&(w.y=o[v]),y!==void 0&&(w.rotation=d[y]),n[p.type].tooltipGetter({series:p,axesConfig:w,getColor:N,identifier:t})}const Fk=fa("div",{name:"MuiChartsTooltip",slot:"Container",overridesResolver:(e,t)=>t.paper})(({theme:e})=>({backgroundColor:(e.vars||e).palette.background.paper,color:(e.vars||e).palette.text.primary,borderRadius:(e.vars||e).shape?.borderRadius,border:`solid ${(e.vars||e).palette.divider} 1px`})),Uk=fa("table",{name:"MuiChartsTooltip",slot:"Table"})(({theme:e})=>({borderSpacing:0,[`& .${cf.markContainer}`]:{display:"inline-block",width:`calc(20px + ${e.spacing(1.5)})`,verticalAlign:"middle"},"& caption":{borderBottom:`solid ${(e.vars||e).palette.divider} 1px`,padding:e.spacing(.5,1.5),textAlign:"start",whiteSpace:"nowrap","& span":{marginRight:e.spacing(1.5)}}})),Bk=fa("tr",{name:"MuiChartsTooltip",slot:"Row"})(({theme:e})=>({"tr:first-of-type& td":{paddingTop:e.spacing(.5)},"tr:last-of-type& td":{paddingBottom:e.spacing(.5)}})),uf=fa(J4,{name:"MuiChartsTooltip",slot:"Cell"})(({theme:e})=>({verticalAlign:"middle",color:(e.vars||e).palette.text.secondary,textAlign:"start",[`&.${cf.cell}`]:{paddingLeft:e.spacing(1),paddingRight:e.spacing(1)},[`&.${cf.labelCell}`]:{whiteSpace:"nowrap",fontWeight:e.typography.fontWeightRegular},[`&.${cf.valueCell}, &.${cf.axisValueCell}`]:{color:(e.vars||e).palette.text.primary,fontWeight:e.typography.fontWeightMedium},[`&.${cf.valueCell}`]:{paddingLeft:e.spacing(1.5),paddingRight:e.spacing(1.5)},"td:first-of-type&, th:first-of-type&":{paddingLeft:e.spacing(1.5)},"td:last-of-type&, th:last-of-type&":{paddingRight:e.spacing(1.5)}}));function gbe(e){return Yn("MuiChartsLabelMark",e)}const Xm=An("MuiChartsLabelMark",["root","line","square","circle","mask","fill"]),pbe=e=>{const{type:t}=e;return Vn({root:typeof t=="function"?["root"]:["root",t],mask:["mask"],fill:["fill"]},gbe,e.classes)},fV=(e,t,n)=>f.forwardRef(function(r,i){const o=Ti({props:r,name:e}),l=typeof t.defaultProps=="function"?t.defaultProps(o):t.defaultProps??{},c=Ou(l,o),u=Yo(),d=t.classesResolver?.(c,u),h=f.forwardRef(n);return a.jsx(h,at({},c,{classes:d,ref:i}))}),xbe=["type","color","className","classes"],ybe=fa("div",{name:"MuiChartsLabelMark",slot:"Root"})(()=>({display:"flex",width:14,height:14,[`&.${Xm.line}`]:{width:16,height:"unset",alignItems:"center",[`.${Xm.mask}`]:{height:4,width:"100%",borderRadius:1,overflow:"hidden"}},[`&.${Xm.square}`]:{height:13,width:13,borderRadius:2,overflow:"hidden"},[`&.${Xm.circle}`]:{height:15,width:15},svg:{display:"block"},[`& .${Xm.mask} > *`]:{height:"100%",width:"100%"},[`& .${Xm.mask}`]:{height:"100%",width:"100%"}})),Jv=fV("MuiChartsLabelMark",{defaultProps:{type:"square"},classesResolver:pbe},function(t,n){const{type:s,color:r,className:i,classes:o}=t,l=ya(t,xbe),c=s;return a.jsx(ybe,at({className:$t(o?.root,i),ownerState:t,"aria-hidden":"true",ref:n},l,{children:a.jsx("div",{className:o?.mask,children:typeof c=="function"?a.jsx(c,{className:o?.fill,color:r}):a.jsx("svg",{viewBox:"0 0 24 24",preserveAspectRatio:s==="line"?"none":void 0,children:s==="circle"?a.jsx("circle",{className:o?.fill,r:"12",cx:"12",cy:"12",fill:r}):a.jsx("rect",{className:o?.fill,width:"24",height:"24",fill:r})})})}))});function bbe(e){const{classes:t,sx:n}=e,s=hbe(),r=wN(t);if(!s)return null;if("values"in s){const{label:u,color:d,markType:h}=s;return a.jsx(Fk,{sx:n,className:r.paper,children:a.jsxs(Uk,{className:r.table,children:[a.jsxs(J4,{component:"caption",children:[a.jsx("div",{className:r.markContainer,children:a.jsx(Jv,{type:h,color:d,className:r.mark})}),u]}),a.jsx("tbody",{children:s.values.map(({formattedValue:p,label:x})=>a.jsxs(Bk,{className:r.row,children:[a.jsx(uf,{className:$t(r.labelCell,r.cell),component:"th",children:x}),a.jsx(uf,{className:$t(r.valueCell,r.cell),component:"td",children:p})]},x))})]})})}const{color:i,label:o,formattedValue:l,markType:c}=s;return a.jsx(Fk,{sx:n,className:r.paper,children:a.jsx(Uk,{className:r.table,children:a.jsx("tbody",{children:a.jsxs(Bk,{className:r.row,children:[a.jsxs(uf,{className:$t(r.labelCell,r.cell),component:"th",children:[a.jsx("div",{className:r.markContainer,children:a.jsx(Jv,{type:c,color:i,className:r.mark})}),o]}),a.jsx(uf,{className:$t(r.valueCell,r.cell),component:"td",children:l})]})})})})}function vbe(e){const t=Ka(),n=Gt(t,Vr);return f.useMemo(()=>{const r={};return Object.keys(n).forEach(i=>{r[i]=n[i].colorProcessor}),r},[n])}const wbe=U9({themeId:Oj});function jbe(){const e=B4(),[t,n]=f.useState(null);return f.useEffect(()=>{const s=e.current;if(s===null)return()=>{};const r=o=>{o.pointerType!=="mouse"&&n(null)},i=o=>{n({pointerType:o.pointerType})};return s.addEventListener("pointerenter",i),s.addEventListener("pointerup",r),()=>{s.removeEventListener("pointerenter",i),s.removeEventListener("pointerup",r)}},[e]),t}function Nbe(e){return e instanceof Date?e.toUTCString():e.toLocaleString()}const Cbe="@media (pointer: fine)",Sbe=()=>wbe(Cbe,{defaultMatches:!0}),hV=(e,t)=>t,gV=(e,t)=>t;function pV(e,t,n){return Array.isArray(n)?n.map(s=>F6(t.axis[s],e)):F6(t.axis[n],e)}const xV=Lt(Ax,Tx,mxe,(e,t,n)=>e===null||t===null?null:fxe(n)(e,t)),_be=Lt(xV,nm,hV,(e,t,n=t.axisIds[0])=>e===null?null:pV(e,t,n)),yV=Lt(xV,nm,gV,(e,t,n=t.axisIds)=>e===null?null:pV(e,t,n));Lt(nm,_be,hV,(e,t,n=e.axisIds[0])=>{if(t===null||t===-1||e.axisIds.length===0)return null;const s=e.axis[n]?.data;return s?s[t]:null});Lt(nm,yV,gV,(e,t,n=e.axisIds)=>t===null?null:n.map((s,r)=>{const i=t[r];return i===-1?null:e.axis[s].data?.[i]}));const bV=Ij({memoizeOptions:{resultEqualityCheck:wf}})(yV,nm,(e,t)=>e===null?[]:t.axisIds.map((n,s)=>({axisId:n,dataIndex:e[s]})).filter(({axisId:n,dataIndex:s})=>t.axis[n].triggerTooltip&&s>=0)),Abe=Lt(bV,e=>e.length>0);function L2(e,t,n){const s=e.data?.[t]??null,i=(e.valueFormatter??(o=>e.scaleType==="utc"?Nbe(o):o.toLocaleString()))(s,{location:"tooltip",scale:e.scale});return{axisDirection:n,axisId:e.id,mainAxis:e,dataIndex:t,axisValue:s,axisFormattedValue:i,seriesItems:[]}}function Tbe(e={}){const{multipleAxes:t,directions:n}=e,s=gxe(),r=pxe(),i=xxe(),o=Ka(),l=Gt(o,LG),c=Gt(o,PG),u=Gt(o,bV),d=hN(),{xAxis:h}=jr(),{yAxis:p}=Nr(),{zAxis:x,zAxisIds:v}=U4(),{rotationAxis:j}=TW(),y=vbe();if(l.length===0&&c.length===0&&u.length===0)return null;const N=[];return(n===void 0||n.includes("x"))&&l.forEach(({axisId:w,dataIndex:S})=>{!t&&N.length>1||N.push(L2(h[w],S,"x"))}),(n===void 0||n.includes("y"))&&c.forEach(({axisId:w,dataIndex:S})=>{!t&&N.length>1||N.push(L2(p[w],S,"y"))}),(n===void 0||n.includes("rotation"))&&u.forEach(({axisId:w,dataIndex:S})=>{!t&&N.length>1||N.push(L2(j[w],S,"rotation"))}),Object.keys(d).filter(tN).forEach(w=>{const S=d[w];return S?S.seriesOrder.forEach(_=>{const k=S.series[_],T=k.xAxisId??s.id,A=k.yAxisId??r.id,E=N.findIndex(({axisDirection:M,axisId:z})=>M==="x"&&z===T||M==="y"&&z===A);if(E>=0){const M="zAxisId"in k?k.zAxisId:v[0],{dataIndex:z}=N[E],P=y[w]?.(k,h[T],p[A],M?x[M]:void 0)(z)??"",D=k.data[z]??null,U=k.valueFormatter(D,{dataIndex:z}),B=Xi(k.label,"tooltip")??null;N[E].seriesItems.push({seriesId:_,color:P,value:D,formattedValue:U,formattedLabel:B,markType:k.labelMarkType})}}):[]}),Object.keys(d).filter(F4).forEach(w=>{const S=d[w];return S?S.seriesOrder.forEach(_=>{const k=S.series[_],T=k.rotationAxisId??i?.id,A=N.findIndex(({axisDirection:E,axisId:M})=>E==="rotation"&&M===T);if(A>=0){const{dataIndex:E}=N[A],M=y[w]?.(k)(E)??"",z=k.data[E]??null,P=k.valueFormatter(z,{dataIndex:E}),D=Xi(k.label,"tooltip")??null;N[A].seriesItems.push({seriesId:_,color:M,value:z,formattedValue:P,formattedLabel:D,markType:k.labelMarkType})}}):[]}),t?N:N.length===0?N[0]:null}function kbe(e){return Tbe(at({},e,{multipleAxes:!0}))}function Ebe(e){const t=wN(e.classes),n=kbe();return n===null?null:a.jsx(Fk,{sx:e.sx,className:t.paper,children:n.map(({axisId:s,mainAxis:r,axisValue:i,axisFormattedValue:o,seriesItems:l})=>a.jsxs(Uk,{className:t.table,children:[i!=null&&!r.hideTooltip&&a.jsx(J4,{component:"caption",children:o}),a.jsx("tbody",{children:l.map(({seriesId:c,color:u,formattedValue:d,formattedLabel:h,markType:p})=>d==null?null:a.jsxs(Bk,{className:t.row,children:[a.jsxs(uf,{className:$t(t.labelCell,t.cell),component:"th",children:[a.jsx("div",{className:t.markContainer,children:a.jsx(Jv,{type:p,color:u,className:t.mark})}),h||null]}),a.jsx(uf,{className:$t(t.valueCell,t.cell),component:"td",children:d})]},c))})]},s))})}var xr="top",vi="bottom",wi="right",yr="left",eP="auto",Ix=[xr,vi,wi,yr],If="start",Pp="end",Lbe="clippingParents",vV="viewport",Ng="popper",Pbe="reference",Q6=Ix.reduce(function(e,t){return e.concat([t+"-"+If,t+"-"+Pp])},[]),wV=[].concat(Ix,[eP]).reduce(function(e,t){return e.concat([t,t+"-"+If,t+"-"+Pp])},[]),Dbe="beforeRead",Obe="read",Mbe="afterRead",Ibe="beforeMain",$be="main",Rbe="afterMain",zbe="beforeWrite",Fbe="write",Ube="afterWrite",Bbe=[Dbe,Obe,Mbe,Ibe,$be,Rbe,zbe,Fbe,Ube];function Bo(e){return e?(e.nodeName||"").toLowerCase():null}function Hr(e){if(e==null)return window;if(e.toString()!=="[object Window]"){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function Ru(e){var t=Hr(e).Element;return e instanceof t||e instanceof Element}function yi(e){var t=Hr(e).HTMLElement;return e instanceof t||e instanceof HTMLElement}function tP(e){if(typeof ShadowRoot>"u")return!1;var t=Hr(e).ShadowRoot;return e instanceof t||e instanceof ShadowRoot}function Hbe(e){var t=e.state;Object.keys(t.elements).forEach(function(n){var s=t.styles[n]||{},r=t.attributes[n]||{},i=t.elements[n];!yi(i)||!Bo(i)||(Object.assign(i.style,s),Object.keys(r).forEach(function(o){var l=r[o];l===!1?i.removeAttribute(o):i.setAttribute(o,l===!0?"":l)}))})}function qbe(e){var t=e.state,n={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,n.popper),t.styles=n,t.elements.arrow&&Object.assign(t.elements.arrow.style,n.arrow),function(){Object.keys(t.elements).forEach(function(s){var r=t.elements[s],i=t.attributes[s]||{},o=Object.keys(t.styles.hasOwnProperty(s)?t.styles[s]:n[s]),l=o.reduce(function(c,u){return c[u]="",c},{});!yi(r)||!Bo(r)||(Object.assign(r.style,l),Object.keys(i).forEach(function(c){r.removeAttribute(c)}))})}}const Gbe={name:"applyStyles",enabled:!0,phase:"write",fn:Hbe,effect:qbe,requires:["computeStyles"]};function $o(e){return e.split("-")[0]}var Su=Math.max,ew=Math.min,$f=Math.round;function Hk(){var e=navigator.userAgentData;return e!=null&&e.brands&&Array.isArray(e.brands)?e.brands.map(function(t){return t.brand+"/"+t.version}).join(" "):navigator.userAgent}function jV(){return!/^((?!chrome|android).)*safari/i.test(Hk())}function Rf(e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!1);var s=e.getBoundingClientRect(),r=1,i=1;t&&yi(e)&&(r=e.offsetWidth>0&&$f(s.width)/e.offsetWidth||1,i=e.offsetHeight>0&&$f(s.height)/e.offsetHeight||1);var o=Ru(e)?Hr(e):window,l=o.visualViewport,c=!jV()&&n,u=(s.left+(c&&l?l.offsetLeft:0))/r,d=(s.top+(c&&l?l.offsetTop:0))/i,h=s.width/r,p=s.height/i;return{width:h,height:p,top:d,right:u+h,bottom:d+p,left:u,x:u,y:d}}function aP(e){var t=Rf(e),n=e.offsetWidth,s=e.offsetHeight;return Math.abs(t.width-n)<=1&&(n=t.width),Math.abs(t.height-s)<=1&&(s=t.height),{x:e.offsetLeft,y:e.offsetTop,width:n,height:s}}function NV(e,t){var n=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(n&&tP(n)){var s=t;do{if(s&&e.isSameNode(s))return!0;s=s.parentNode||s.host}while(s)}return!1}function Vl(e){return Hr(e).getComputedStyle(e)}function Wbe(e){return["table","td","th"].indexOf(Bo(e))>=0}function Ed(e){return((Ru(e)?e.ownerDocument:e.document)||window.document).documentElement}function jN(e){return Bo(e)==="html"?e:e.assignedSlot||e.parentNode||(tP(e)?e.host:null)||Ed(e)}function K6(e){return!yi(e)||Vl(e).position==="fixed"?null:e.offsetParent}function Vbe(e){var t=/firefox/i.test(Hk()),n=/Trident/i.test(Hk());if(n&&yi(e)){var s=Vl(e);if(s.position==="fixed")return null}var r=jN(e);for(tP(r)&&(r=r.host);yi(r)&&["html","body"].indexOf(Bo(r))<0;){var i=Vl(r);if(i.transform!=="none"||i.perspective!=="none"||i.contain==="paint"||["transform","perspective"].indexOf(i.willChange)!==-1||t&&i.willChange==="filter"||t&&i.filter&&i.filter!=="none")return r;r=r.parentNode}return null}function $x(e){for(var t=Hr(e),n=K6(e);n&&Wbe(n)&&Vl(n).position==="static";)n=K6(n);return n&&(Bo(n)==="html"||Bo(n)==="body"&&Vl(n).position==="static")?t:n||Vbe(e)||t}function nP(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function np(e,t,n){return Su(e,ew(t,n))}function Ybe(e,t,n){var s=np(e,t,n);return s>n?n:s}function CV(){return{top:0,right:0,bottom:0,left:0}}function SV(e){return Object.assign({},CV(),e)}function _V(e,t){return t.reduce(function(n,s){return n[s]=e,n},{})}var Qbe=function(t,n){return t=typeof t=="function"?t(Object.assign({},n.rects,{placement:n.placement})):t,SV(typeof t!="number"?t:_V(t,Ix))};function Kbe(e){var t,n=e.state,s=e.name,r=e.options,i=n.elements.arrow,o=n.modifiersData.popperOffsets,l=$o(n.placement),c=nP(l),u=[yr,wi].indexOf(l)>=0,d=u?"height":"width";if(!(!i||!o)){var h=Qbe(r.padding,n),p=aP(i),x=c==="y"?xr:yr,v=c==="y"?vi:wi,j=n.rects.reference[d]+n.rects.reference[c]-o[c]-n.rects.popper[d],y=o[c]-n.rects.reference[c],N=$x(i),w=N?c==="y"?N.clientHeight||0:N.clientWidth||0:0,S=j/2-y/2,_=h[x],k=w-p[d]-h[v],T=w/2-p[d]/2+S,A=np(_,T,k),E=c;n.modifiersData[s]=(t={},t[E]=A,t.centerOffset=A-T,t)}}function Xbe(e){var t=e.state,n=e.options,s=n.element,r=s===void 0?"[data-popper-arrow]":s;r!=null&&(typeof r=="string"&&(r=t.elements.popper.querySelector(r),!r)||NV(t.elements.popper,r)&&(t.elements.arrow=r))}const Zbe={name:"arrow",enabled:!0,phase:"main",fn:Kbe,effect:Xbe,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function zf(e){return e.split("-")[1]}var Jbe={top:"auto",right:"auto",bottom:"auto",left:"auto"};function eve(e,t){var n=e.x,s=e.y,r=t.devicePixelRatio||1;return{x:$f(n*r)/r||0,y:$f(s*r)/r||0}}function X6(e){var t,n=e.popper,s=e.popperRect,r=e.placement,i=e.variation,o=e.offsets,l=e.position,c=e.gpuAcceleration,u=e.adaptive,d=e.roundOffsets,h=e.isFixed,p=o.x,x=p===void 0?0:p,v=o.y,j=v===void 0?0:v,y=typeof d=="function"?d({x,y:j}):{x,y:j};x=y.x,j=y.y;var N=o.hasOwnProperty("x"),w=o.hasOwnProperty("y"),S=yr,_=xr,k=window;if(u){var T=$x(n),A="clientHeight",E="clientWidth";if(T===Hr(n)&&(T=Ed(n),Vl(T).position!=="static"&&l==="absolute"&&(A="scrollHeight",E="scrollWidth")),T=T,r===xr||(r===yr||r===wi)&&i===Pp){_=vi;var M=h&&T===k&&k.visualViewport?k.visualViewport.height:T[A];j-=M-s.height,j*=c?1:-1}if(r===yr||(r===xr||r===vi)&&i===Pp){S=wi;var z=h&&T===k&&k.visualViewport?k.visualViewport.width:T[E];x-=z-s.width,x*=c?1:-1}}var P=Object.assign({position:l},u&&Jbe),D=d===!0?eve({x,y:j},Hr(n)):{x,y:j};if(x=D.x,j=D.y,c){var U;return Object.assign({},P,(U={},U[_]=w?"0":"",U[S]=N?"0":"",U.transform=(k.devicePixelRatio||1)<=1?"translate("+x+"px, "+j+"px)":"translate3d("+x+"px, "+j+"px, 0)",U))}return Object.assign({},P,(t={},t[_]=w?j+"px":"",t[S]=N?x+"px":"",t.transform="",t))}function tve(e){var t=e.state,n=e.options,s=n.gpuAcceleration,r=s===void 0?!0:s,i=n.adaptive,o=i===void 0?!0:i,l=n.roundOffsets,c=l===void 0?!0:l,u={placement:$o(t.placement),variation:zf(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:r,isFixed:t.options.strategy==="fixed"};t.modifiersData.popperOffsets!=null&&(t.styles.popper=Object.assign({},t.styles.popper,X6(Object.assign({},u,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:o,roundOffsets:c})))),t.modifiersData.arrow!=null&&(t.styles.arrow=Object.assign({},t.styles.arrow,X6(Object.assign({},u,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:c})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})}const ave={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:tve,data:{}};var Jy={passive:!0};function nve(e){var t=e.state,n=e.instance,s=e.options,r=s.scroll,i=r===void 0?!0:r,o=s.resize,l=o===void 0?!0:o,c=Hr(t.elements.popper),u=[].concat(t.scrollParents.reference,t.scrollParents.popper);return i&&u.forEach(function(d){d.addEventListener("scroll",n.update,Jy)}),l&&c.addEventListener("resize",n.update,Jy),function(){i&&u.forEach(function(d){d.removeEventListener("scroll",n.update,Jy)}),l&&c.removeEventListener("resize",n.update,Jy)}}const sve={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:nve,data:{}};var rve={left:"right",right:"left",bottom:"top",top:"bottom"};function fv(e){return e.replace(/left|right|bottom|top/g,function(t){return rve[t]})}var ive={start:"end",end:"start"};function Z6(e){return e.replace(/start|end/g,function(t){return ive[t]})}function sP(e){var t=Hr(e),n=t.pageXOffset,s=t.pageYOffset;return{scrollLeft:n,scrollTop:s}}function rP(e){return Rf(Ed(e)).left+sP(e).scrollLeft}function ove(e,t){var n=Hr(e),s=Ed(e),r=n.visualViewport,i=s.clientWidth,o=s.clientHeight,l=0,c=0;if(r){i=r.width,o=r.height;var u=jV();(u||!u&&t==="fixed")&&(l=r.offsetLeft,c=r.offsetTop)}return{width:i,height:o,x:l+rP(e),y:c}}function lve(e){var t,n=Ed(e),s=sP(e),r=(t=e.ownerDocument)==null?void 0:t.body,i=Su(n.scrollWidth,n.clientWidth,r?r.scrollWidth:0,r?r.clientWidth:0),o=Su(n.scrollHeight,n.clientHeight,r?r.scrollHeight:0,r?r.clientHeight:0),l=-s.scrollLeft+rP(e),c=-s.scrollTop;return Vl(r||n).direction==="rtl"&&(l+=Su(n.clientWidth,r?r.clientWidth:0)-i),{width:i,height:o,x:l,y:c}}function iP(e){var t=Vl(e),n=t.overflow,s=t.overflowX,r=t.overflowY;return/auto|scroll|overlay|hidden/.test(n+r+s)}function AV(e){return["html","body","#document"].indexOf(Bo(e))>=0?e.ownerDocument.body:yi(e)&&iP(e)?e:AV(jN(e))}function sp(e,t){var n;t===void 0&&(t=[]);var s=AV(e),r=s===((n=e.ownerDocument)==null?void 0:n.body),i=Hr(s),o=r?[i].concat(i.visualViewport||[],iP(s)?s:[]):s,l=t.concat(o);return r?l:l.concat(sp(jN(o)))}function qk(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function cve(e,t){var n=Rf(e,!1,t==="fixed");return n.top=n.top+e.clientTop,n.left=n.left+e.clientLeft,n.bottom=n.top+e.clientHeight,n.right=n.left+e.clientWidth,n.width=e.clientWidth,n.height=e.clientHeight,n.x=n.left,n.y=n.top,n}function J6(e,t,n){return t===vV?qk(ove(e,n)):Ru(t)?cve(t,n):qk(lve(Ed(e)))}function dve(e){var t=sp(jN(e)),n=["absolute","fixed"].indexOf(Vl(e).position)>=0,s=n&&yi(e)?$x(e):e;return Ru(s)?t.filter(function(r){return Ru(r)&&NV(r,s)&&Bo(r)!=="body"}):[]}function uve(e,t,n,s){var r=t==="clippingParents"?dve(e):[].concat(t),i=[].concat(r,[n]),o=i[0],l=i.reduce(function(c,u){var d=J6(e,u,s);return c.top=Su(d.top,c.top),c.right=ew(d.right,c.right),c.bottom=ew(d.bottom,c.bottom),c.left=Su(d.left,c.left),c},J6(e,o,s));return l.width=l.right-l.left,l.height=l.bottom-l.top,l.x=l.left,l.y=l.top,l}function TV(e){var t=e.reference,n=e.element,s=e.placement,r=s?$o(s):null,i=s?zf(s):null,o=t.x+t.width/2-n.width/2,l=t.y+t.height/2-n.height/2,c;switch(r){case xr:c={x:o,y:t.y-n.height};break;case vi:c={x:o,y:t.y+t.height};break;case wi:c={x:t.x+t.width,y:l};break;case yr:c={x:t.x-n.width,y:l};break;default:c={x:t.x,y:t.y}}var u=r?nP(r):null;if(u!=null){var d=u==="y"?"height":"width";switch(i){case If:c[u]=c[u]-(t[d]/2-n[d]/2);break;case Pp:c[u]=c[u]+(t[d]/2-n[d]/2);break}}return c}function Dp(e,t){t===void 0&&(t={});var n=t,s=n.placement,r=s===void 0?e.placement:s,i=n.strategy,o=i===void 0?e.strategy:i,l=n.boundary,c=l===void 0?Lbe:l,u=n.rootBoundary,d=u===void 0?vV:u,h=n.elementContext,p=h===void 0?Ng:h,x=n.altBoundary,v=x===void 0?!1:x,j=n.padding,y=j===void 0?0:j,N=SV(typeof y!="number"?y:_V(y,Ix)),w=p===Ng?Pbe:Ng,S=e.rects.popper,_=e.elements[v?w:p],k=uve(Ru(_)?_:_.contextElement||Ed(e.elements.popper),c,d,o),T=Rf(e.elements.reference),A=TV({reference:T,element:S,placement:r}),E=qk(Object.assign({},S,A)),M=p===Ng?E:T,z={top:k.top-M.top+N.top,bottom:M.bottom-k.bottom+N.bottom,left:k.left-M.left+N.left,right:M.right-k.right+N.right},P=e.modifiersData.offset;if(p===Ng&&P){var D=P[r];Object.keys(z).forEach(function(U){var B=[wi,vi].indexOf(U)>=0?1:-1,R=[xr,vi].indexOf(U)>=0?"y":"x";z[U]+=D[R]*B})}return z}function mve(e,t){t===void 0&&(t={});var n=t,s=n.placement,r=n.boundary,i=n.rootBoundary,o=n.padding,l=n.flipVariations,c=n.allowedAutoPlacements,u=c===void 0?wV:c,d=zf(s),h=d?l?Q6:Q6.filter(function(v){return zf(v)===d}):Ix,p=h.filter(function(v){return u.indexOf(v)>=0});p.length===0&&(p=h);var x=p.reduce(function(v,j){return v[j]=Dp(e,{placement:j,boundary:r,rootBoundary:i,padding:o})[$o(j)],v},{});return Object.keys(x).sort(function(v,j){return x[v]-x[j]})}function fve(e){if($o(e)===eP)return[];var t=fv(e);return[Z6(e),t,Z6(t)]}function hve(e){var t=e.state,n=e.options,s=e.name;if(!t.modifiersData[s]._skip){for(var r=n.mainAxis,i=r===void 0?!0:r,o=n.altAxis,l=o===void 0?!0:o,c=n.fallbackPlacements,u=n.padding,d=n.boundary,h=n.rootBoundary,p=n.altBoundary,x=n.flipVariations,v=x===void 0?!0:x,j=n.allowedAutoPlacements,y=t.options.placement,N=$o(y),w=N===y,S=c||(w||!v?[fv(y)]:fve(y)),_=[y].concat(S).reduce(function(Ne,fe){return Ne.concat($o(fe)===eP?mve(t,{placement:fe,boundary:d,rootBoundary:h,padding:u,flipVariations:v,allowedAutoPlacements:j}):fe)},[]),k=t.rects.reference,T=t.rects.popper,A=new Map,E=!0,M=_[0],z=0;z<_.length;z++){var P=_[z],D=$o(P),U=zf(P)===If,B=[xr,vi].indexOf(D)>=0,R=B?"width":"height",q=Dp(t,{placement:P,boundary:d,rootBoundary:h,altBoundary:p,padding:u}),Z=B?U?wi:yr:U?vi:xr;k[R]>T[R]&&(Z=fv(Z));var V=fv(Z),oe=[];if(i&&oe.push(q[D]<=0),l&&oe.push(q[Z]<=0,q[V]<=0),oe.every(function(Ne){return Ne})){M=P,E=!1;break}A.set(P,oe)}if(E)for(var je=v?3:1,X=function(fe){var we=_.find(function(de){var ke=A.get(de);if(ke)return ke.slice(0,fe).every(function(ge){return ge})});if(we)return M=we,"break"},se=je;se>0;se--){var ye=X(se);if(ye==="break")break}t.placement!==M&&(t.modifiersData[s]._skip=!0,t.placement=M,t.reset=!0)}}const gve={name:"flip",enabled:!0,phase:"main",fn:hve,requiresIfExists:["offset"],data:{_skip:!1}};function eR(e,t,n){return n===void 0&&(n={x:0,y:0}),{top:e.top-t.height-n.y,right:e.right-t.width+n.x,bottom:e.bottom-t.height+n.y,left:e.left-t.width-n.x}}function tR(e){return[xr,wi,vi,yr].some(function(t){return e[t]>=0})}function pve(e){var t=e.state,n=e.name,s=t.rects.reference,r=t.rects.popper,i=t.modifiersData.preventOverflow,o=Dp(t,{elementContext:"reference"}),l=Dp(t,{altBoundary:!0}),c=eR(o,s),u=eR(l,r,i),d=tR(c),h=tR(u);t.modifiersData[n]={referenceClippingOffsets:c,popperEscapeOffsets:u,isReferenceHidden:d,hasPopperEscaped:h},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":d,"data-popper-escaped":h})}const xve={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:pve};function yve(e,t,n){var s=$o(e),r=[yr,xr].indexOf(s)>=0?-1:1,i=typeof n=="function"?n(Object.assign({},t,{placement:e})):n,o=i[0],l=i[1];return o=o||0,l=(l||0)*r,[yr,wi].indexOf(s)>=0?{x:l,y:o}:{x:o,y:l}}function bve(e){var t=e.state,n=e.options,s=e.name,r=n.offset,i=r===void 0?[0,0]:r,o=wV.reduce(function(d,h){return d[h]=yve(h,t.rects,i),d},{}),l=o[t.placement],c=l.x,u=l.y;t.modifiersData.popperOffsets!=null&&(t.modifiersData.popperOffsets.x+=c,t.modifiersData.popperOffsets.y+=u),t.modifiersData[s]=o}const vve={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:bve};function wve(e){var t=e.state,n=e.name;t.modifiersData[n]=TV({reference:t.rects.reference,element:t.rects.popper,placement:t.placement})}const jve={name:"popperOffsets",enabled:!0,phase:"read",fn:wve,data:{}};function Nve(e){return e==="x"?"y":"x"}function Cve(e){var t=e.state,n=e.options,s=e.name,r=n.mainAxis,i=r===void 0?!0:r,o=n.altAxis,l=o===void 0?!1:o,c=n.boundary,u=n.rootBoundary,d=n.altBoundary,h=n.padding,p=n.tether,x=p===void 0?!0:p,v=n.tetherOffset,j=v===void 0?0:v,y=Dp(t,{boundary:c,rootBoundary:u,padding:h,altBoundary:d}),N=$o(t.placement),w=zf(t.placement),S=!w,_=nP(N),k=Nve(_),T=t.modifiersData.popperOffsets,A=t.rects.reference,E=t.rects.popper,M=typeof j=="function"?j(Object.assign({},t.rects,{placement:t.placement})):j,z=typeof M=="number"?{mainAxis:M,altAxis:M}:Object.assign({mainAxis:0,altAxis:0},M),P=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,D={x:0,y:0};if(T){if(i){var U,B=_==="y"?xr:yr,R=_==="y"?vi:wi,q=_==="y"?"height":"width",Z=T[_],V=Z+y[B],oe=Z-y[R],je=x?-E[q]/2:0,X=w===If?A[q]:E[q],se=w===If?-E[q]:-A[q],ye=t.elements.arrow,Ne=x&&ye?aP(ye):{width:0,height:0},fe=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:CV(),we=fe[B],de=fe[R],ke=np(0,A[q],Ne[q]),ge=S?A[q]/2-je-ke-we-z.mainAxis:X-ke-we-z.mainAxis,$e=S?-A[q]/2+je+ke+de+z.mainAxis:se+ke+de+z.mainAxis,be=t.elements.arrow&&$x(t.elements.arrow),me=be?_==="y"?be.clientTop||0:be.clientLeft||0:0,Ue=(U=P?.[_])!=null?U:0,Ee=Z+ge-Ue-me,We=Z+$e-Ue,tt=np(x?ew(V,Ee):V,Z,x?Su(oe,We):oe);T[_]=tt,D[_]=tt-Z}if(l){var lt,Fe=_==="x"?xr:yr,st=_==="x"?vi:wi,Xe=T[k],Ze=k==="y"?"height":"width",Je=Xe+y[Fe],Be=Xe-y[st],_e=[xr,yr].indexOf(N)!==-1,pe=(lt=P?.[k])!=null?lt:0,ce=_e?Je:Xe-A[Ze]-E[Ze]-pe+z.altAxis,Q=_e?Xe+A[Ze]+E[Ze]-pe-z.altAxis:Be,ne=x&&_e?Ybe(ce,Xe,Q):np(x?ce:Je,Xe,x?Q:Be);T[k]=ne,D[k]=ne-Xe}t.modifiersData[s]=D}}const Sve={name:"preventOverflow",enabled:!0,phase:"main",fn:Cve,requiresIfExists:["offset"]};function _ve(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}function Ave(e){return e===Hr(e)||!yi(e)?sP(e):_ve(e)}function Tve(e){var t=e.getBoundingClientRect(),n=$f(t.width)/e.offsetWidth||1,s=$f(t.height)/e.offsetHeight||1;return n!==1||s!==1}function kve(e,t,n){n===void 0&&(n=!1);var s=yi(t),r=yi(t)&&Tve(t),i=Ed(t),o=Rf(e,r,n),l={scrollLeft:0,scrollTop:0},c={x:0,y:0};return(s||!s&&!n)&&((Bo(t)!=="body"||iP(i))&&(l=Ave(t)),yi(t)?(c=Rf(t,!0),c.x+=t.clientLeft,c.y+=t.clientTop):i&&(c.x=rP(i))),{x:o.left+l.scrollLeft-c.x,y:o.top+l.scrollTop-c.y,width:o.width,height:o.height}}function Eve(e){var t=new Map,n=new Set,s=[];e.forEach(function(i){t.set(i.name,i)});function r(i){n.add(i.name);var o=[].concat(i.requires||[],i.requiresIfExists||[]);o.forEach(function(l){if(!n.has(l)){var c=t.get(l);c&&r(c)}}),s.push(i)}return e.forEach(function(i){n.has(i.name)||r(i)}),s}function Lve(e){var t=Eve(e);return Bbe.reduce(function(n,s){return n.concat(t.filter(function(r){return r.phase===s}))},[])}function Pve(e){var t;return function(){return t||(t=new Promise(function(n){Promise.resolve().then(function(){t=void 0,n(e())})})),t}}function Dve(e){var t=e.reduce(function(n,s){var r=n[s.name];return n[s.name]=r?Object.assign({},r,s,{options:Object.assign({},r.options,s.options),data:Object.assign({},r.data,s.data)}):s,n},{});return Object.keys(t).map(function(n){return t[n]})}var aR={placement:"bottom",modifiers:[],strategy:"absolute"};function nR(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return!t.some(function(s){return!(s&&typeof s.getBoundingClientRect=="function")})}function Ove(e){e===void 0&&(e={});var t=e,n=t.defaultModifiers,s=n===void 0?[]:n,r=t.defaultOptions,i=r===void 0?aR:r;return function(l,c,u){u===void 0&&(u=i);var d={placement:"bottom",orderedModifiers:[],options:Object.assign({},aR,i),modifiersData:{},elements:{reference:l,popper:c},attributes:{},styles:{}},h=[],p=!1,x={state:d,setOptions:function(N){var w=typeof N=="function"?N(d.options):N;j(),d.options=Object.assign({},i,d.options,w),d.scrollParents={reference:Ru(l)?sp(l):l.contextElement?sp(l.contextElement):[],popper:sp(c)};var S=Lve(Dve([].concat(s,d.options.modifiers)));return d.orderedModifiers=S.filter(function(_){return _.enabled}),v(),x.update()},forceUpdate:function(){if(!p){var N=d.elements,w=N.reference,S=N.popper;if(nR(w,S)){d.rects={reference:kve(w,$x(S),d.options.strategy==="fixed"),popper:aP(S)},d.reset=!1,d.placement=d.options.placement,d.orderedModifiers.forEach(function(z){return d.modifiersData[z.name]=Object.assign({},z.data)});for(var _=0;_<d.orderedModifiers.length;_++){if(d.reset===!0){d.reset=!1,_=-1;continue}var k=d.orderedModifiers[_],T=k.fn,A=k.options,E=A===void 0?{}:A,M=k.name;typeof T=="function"&&(d=T({state:d,options:E,name:M,instance:x})||d)}}}},update:Pve(function(){return new Promise(function(y){x.forceUpdate(),y(d)})}),destroy:function(){j(),p=!0}};if(!nR(l,c))return x;x.setOptions(u).then(function(y){!p&&u.onFirstUpdate&&u.onFirstUpdate(y)});function v(){d.orderedModifiers.forEach(function(y){var N=y.name,w=y.options,S=w===void 0?{}:w,_=y.effect;if(typeof _=="function"){var k=_({state:d,name:N,instance:x,options:S}),T=function(){};h.push(k||T)}})}function j(){h.forEach(function(y){return y()}),h=[]}return x}}var Mve=[sve,jve,ave,Gbe,vve,gve,Sve,Zbe,xve],Ive=Ove({defaultModifiers:Mve});function sR(e,t){typeof e=="function"?e(t):e&&(e.current=t)}function $ve(e){return typeof e=="function"?e():e}const Rve=f.forwardRef(function(t,n){const{children:s,container:r,disablePortal:i=!1}=t,[o,l]=f.useState(null),c=Uo(f.isValidElement(s)?tq(s):null,n);if(is(()=>{i||l($ve(r)||document.body)},[r,i]),is(()=>{if(o&&!i)return sR(n,o),()=>{sR(n,null)}},[n,o,i]),i){if(f.isValidElement(s)){const u={ref:c};return f.cloneElement(s,u)}return s}return o&&Gi.createPortal(s,o)});function zve(e){return Yn("MuiPopper",e)}An("MuiPopper",["root"]);function Fve(e,t){if(t==="ltr")return e;switch(e){case"bottom-end":return"bottom-start";case"bottom-start":return"bottom-end";case"top-end":return"top-start";case"top-start":return"top-end";default:return e}}function Gk(e){return typeof e=="function"?e():e}function Uve(e){return e.nodeType!==void 0}const Bve=e=>{const{classes:t}=e;return Vn({root:["root"]},zve,t)},Hve={},qve=f.forwardRef(function(t,n){const{anchorEl:s,children:r,direction:i,disablePortal:o,modifiers:l,open:c,placement:u,popperOptions:d,popperRef:h,slotProps:p={},slots:x={},TransitionProps:v,ownerState:j,...y}=t,N=f.useRef(null),w=Uo(N,n),S=f.useRef(null),_=Uo(S,h),k=f.useRef(_);is(()=>{k.current=_},[_]),f.useImperativeHandle(h,()=>S.current,[]);const T=Fve(u,i),[A,E]=f.useState(T),[M,z]=f.useState(Gk(s));f.useEffect(()=>{S.current&&S.current.forceUpdate()}),f.useEffect(()=>{s&&z(Gk(s))},[s]),is(()=>{if(!M||!c)return;const R=V=>{E(V.placement)};let q=[{name:"preventOverflow",options:{altBoundary:o}},{name:"flip",options:{altBoundary:o}},{name:"onUpdate",enabled:!0,phase:"afterWrite",fn:({state:V})=>{R(V)}}];l!=null&&(q=q.concat(l)),d&&d.modifiers!=null&&(q=q.concat(d.modifiers));const Z=Ive(M,N.current,{placement:T,...d,modifiers:q});return k.current(Z),()=>{Z.destroy(),k.current(null)}},[M,o,l,c,d,T]);const P={placement:A};v!==null&&(P.TransitionProps=v);const D=Bve(t),U=x.root??"div",B=Bl({elementType:U,externalSlotProps:p.root,externalForwardedProps:y,additionalProps:{role:"tooltip",ref:w},ownerState:t,className:D.root});return a.jsx(U,{...B,children:typeof r=="function"?r(P):r})}),Gve=f.forwardRef(function(t,n){const{anchorEl:s,children:r,container:i,direction:o="ltr",disablePortal:l=!1,keepMounted:c=!1,modifiers:u,open:d,placement:h="bottom",popperOptions:p=Hve,popperRef:x,style:v,transition:j=!1,slotProps:y={},slots:N={},...w}=t,[S,_]=f.useState(!0),k=()=>{_(!1)},T=()=>{_(!0)};if(!c&&!d&&(!j||S))return null;let A;if(i)A=i;else if(s){const z=Gk(s);A=z&&Uve(z)?xk(z).body:xk(null).body}const E=!d&&c&&(!j||S)?"none":void 0,M=j?{in:d,onEnter:k,onExited:T}:void 0;return a.jsx(Rve,{disablePortal:l,container:A,children:a.jsx(qve,{anchorEl:s,direction:o,disablePortal:l,modifiers:u,ref:n,open:j?!S:d,placement:h,popperOptions:p,popperRef:x,slotProps:y,slots:N,...w,style:{position:"fixed",top:0,left:0,display:E,...v},TransitionProps:M,children:r})})}),Wve=fa(Gve,{name:"MuiPopper",slot:"Root"})({}),Vve=f.forwardRef(function(t,n){const s=yx(),r=Sd({props:t,name:"MuiPopper"}),{anchorEl:i,component:o,components:l,componentsProps:c,container:u,disablePortal:d,keepMounted:h,modifiers:p,open:x,placement:v,popperOptions:j,popperRef:y,transition:N,slots:w,slotProps:S,..._}=r,k=w?.root??l?.Root,T={anchorEl:i,container:u,disablePortal:d,keepMounted:h,modifiers:p,open:x,placement:v,popperOptions:j,popperRef:y,transition:N,..._};return a.jsx(Wve,{as:o,direction:s?"rtl":"ltr",slots:{root:k},slotProps:S??c,...T,ref:n})});function Yve(e){const{children:t,defer:n=!1,fallback:s=null}=e,[r,i]=f.useState(!1);return is(()=>{n||i(!0)},[n]),f.useEffect(()=>{n&&i(!0)},[n]),r?t:s}function rR(e){let t,n;const s=()=>{n=null,e(...t)};function r(...i){t=i,n||(n=requestAnimationFrame(s))}return r.clear=()=>{n&&(cancelAnimationFrame(n),n=null)},r}function Qve(){const e=Ka(),t=Gt(e,AW),n=Gt(e,Qo);return t!==void 0?"polar":n!==void 0?"cartesian":"none"}const Kve=["trigger","position","anchor","classes","children"],iR=()=>!1;function Xve(e,t,n){return n?iR:e==="item"?cpe:t==="polar"?Abe:t==="cartesian"?hpe:iR}const Zve=fa(Vve,{name:"MuiChartsTooltip",slot:"Root"})(({theme:e})=>({pointerEvents:"none",zIndex:e.zIndex.modal}));function Jve(e){const t=Ti({props:e,name:"MuiChartsTooltipContainer"}),{trigger:n="axis",position:s,anchor:r="pointer",classes:i,children:o}=t,l=ya(t,Kve),c=B4(),u=wN(i),d=jbe(),h=Sbe(),p=f.useRef(null),x=$j(()=>({x:0,y:0})),v=Qve(),j=Ka(),y=Gt(j,jpe),N=Gt(j,Xve(n,v,y)),S=Gt(j,kx)==="keyboard"?"node":r,_=Gt(j,n==="item"&&S==="node"?dpe:()=>null,s);f.useEffect(()=>{const M=c.current;if(M===null)return()=>{};if(_!==null){const D=rR(()=>{x.current={x:M.getBoundingClientRect().left+(_?.x??0),y:M.getBoundingClientRect().top+(_?.y??0)},p.current?.update()});return D(),()=>D.clear()}const z=rR((D,U)=>{x.current={x:D,y:U},p.current?.update()}),P=D=>{z(D.clientX,D.clientY)};return M.addEventListener("pointerdown",P),M.addEventListener("pointermove",P),M.addEventListener("pointerenter",P),()=>{M.removeEventListener("pointerdown",P),M.removeEventListener("pointermove",P),M.removeEventListener("pointerenter",P),z.clear()}},[c,x,_]);const k=f.useMemo(()=>({getBoundingClientRect:()=>({x:x.current.x,y:x.current.y,top:x.current.y,left:x.current.x,right:x.current.x,bottom:x.current.y,width:0,height:0,toJSON:()=>""})}),[x]),T=d?.pointerType==="mouse"||h,A=d?.pointerType==="touch"||!h,E=f.useMemo(()=>[{name:"offset",options:{offset:()=>A?[0,64]:[0,8]}},...T?[]:[{name:"flip",options:{fallbackPlacements:["top-end","top-start","bottom-end","bottom"]}}],{name:"preventOverflow",options:{altAxis:!0}}],[T,A]);return n==="none"?null:a.jsx(Yve,{children:N&&a.jsx(Zve,at({},l,{className:u?.root,open:N,placement:l.placement??s??(T?"right-start":"top"),popperRef:p,anchorEl:k,modifiers:E,children:o}))})}function ewe(e){const{classes:t,trigger:n="axis"}=e,s=wN(t);return a.jsx(Jve,at({},e,{classes:t,children:n==="axis"?a.jsx(Ebe,{classes:s}):a.jsx(bbe,{classes:s})}))}const twe=e=>({type:"series",color:e.color,label:e.label,seriesId:e.seriesId,itemId:e.itemId});function awe(e){return Yn("MuiChartsLegend",e)}const nwe=e=>{const{classes:t,direction:n}=e;return Vn({root:["root",n],item:["item"],mark:["mark"],label:["label"],series:["series"]},awe,t)},oR=An("MuiChartsLegend",["root","item","series","mark","label","vertical","horizontal"]),swe=["slots","slotProps"],rwe=["ownerState"],iwe=(e,t,n,s)=>{function r(i,o){const l=Ti({props:i,name:e}),c=typeof n.defaultProps=="function"?n.defaultProps(l):n.defaultProps??{},u=Ou(c,l),d=u,{slots:h,slotProps:p}=d,x=ya(d,swe),v=Yo(),j=n.classesResolver?.(u,v),y=h?.[t]??s,N=n.propagateSlots&&!h?.[t],w=Bl({elementType:y,externalSlotProps:p?.[t],additionalProps:at({},x,{classes:j},N&&{slots:h,slotProps:p}),ownerState:{}}),S=ya(w,rwe),_=at({},S);for(const k of n.omitProps??[])delete _[k];return a.jsx(y,at({},_,{ref:o}))}return f.forwardRef(r)};function owe(e){return Yn("MuiChartsLabel",e)}An("MuiChartsLabel",["root"]);const lwe=e=>Vn({root:["root"]},owe,e.classes),cwe=["children","className","classes"],dwe=fV("MuiChartsLabel",{classesResolver:lwe},function(t,n){const{children:s,className:r,classes:i}=t,o=ya(t,cwe);return a.jsx("span",at({className:$t(i?.root,r),ref:n},o,{children:s}))}),uwe=["direction","onItemClick","className","classes"],mwe=fa("ul",{name:"MuiChartsLegend",slot:"Root"})(({ownerState:e,theme:t})=>at({},t.typography.caption,{color:(t.vars||t).palette.text.primary,lineHeight:"100%",display:"flex",flexDirection:e.direction==="vertical"?"column":"row",alignItems:e.direction==="vertical"?void 0:"center",flexShrink:0,gap:t.spacing(2),listStyleType:"none",paddingInlineStart:0,marginBlock:t.spacing(1),marginInline:t.spacing(1),flexWrap:"wrap",li:{display:e.direction==="horizontal"?"inline-flex":void 0},[`button.${oR.series}`]:{background:"none",border:"none",padding:0,fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",letterSpacing:"inherit",color:"inherit"},[`& .${oR.series}`]:{display:e.direction==="vertical"?"flex":"inline-flex",alignItems:"center",gap:t.spacing(1)},gridArea:"legend"})),fwe=iwe("MuiChartsLegend","legend",{defaultProps:{direction:"horizontal"},omitProps:["position"],classesResolver:nwe},f.forwardRef(function(t,n){const s=Pxe(),{onItemClick:r,className:i,classes:o}=t,l=ya(t,uwe);if(s.items.length===0)return null;const c=r?"button":"div";return a.jsx(mwe,at({className:$t(o?.root,i),ref:n},l,{ownerState:t,children:s.items.map((u,d)=>a.jsx("li",{className:o?.item,"data-series":u.id,children:a.jsxs(c,{className:o?.series,role:r?"button":void 0,type:r?"button":void 0,onClick:r?(h=>r(h,twe(u),d)):void 0,children:[a.jsx(Jv,{className:o?.mark,color:u.color,type:u.markType}),a.jsx(dwe,{className:o?.label,children:u.label})]})},u.id))}))}));function hwe(e){return Yn("MuiChartsAxisHighlight",e)}An("MuiChartsAxisHighlight",["root"]);const tw=fa("path",{name:"MuiChartsAxisHighlight",slot:"Root"})(({theme:e})=>({pointerEvents:"none",variants:[{props:{axisHighlight:"band"},style:at({fill:"white",fillOpacity:.1},e.applyStyles("light",{fill:"gray"}))},{props:{axisHighlight:"line"},style:at({strokeDasharray:"5 2",stroke:"#ffffff"},e.applyStyles("light",{stroke:"#000000"}))}]}));function gwe(e){const{type:t,classes:n}=e,{left:s,width:r}=Ei(),i=Ka(),o=Gt(i,Cpe),l=Gt(i,Zs);return o.length===0?null:o.map(({axisId:c,value:u})=>{const h=l.axis[c].scale,p=oh(h),x=t==="band"&&u!==null&&vs(h);return a.jsxs(f.Fragment,{children:[x&&h(u)!==void 0&&a.jsx(tw,{d:`M ${s} ${h(u)-(h.step()-h.bandwidth())/2} l 0 ${h.step()} l ${r} 0 l 0 ${-h.step()} Z`,className:n.root,ownerState:{axisHighlight:"band"}}),t==="line"&&u!==null&&a.jsx(tw,{d:`M ${s} ${p(u)} L ${s+r} ${p(u)}`,className:n.root,ownerState:{axisHighlight:"line"}})]},`${c}-${u}`)})}function pwe(e){const{type:t,classes:n}=e,{top:s,height:r}=Ei(),i=Ka(),o=Gt(i,Npe),l=Gt(i,Xs);return o.length===0?null:o.map(({axisId:c,value:u})=>{const h=l.axis[c].scale,p=oh(h),x=t==="band"&&u!==null&&vs(h);return a.jsxs(f.Fragment,{children:[x&&h(u)!==void 0&&a.jsx(tw,{d:`M ${h(u)-(h.step()-h.bandwidth())/2} ${s} l ${h.step()} 0 l 0 ${r} l ${-h.step()} 0 Z`,className:n.root,ownerState:{axisHighlight:"band"}}),t==="line"&&u!==null&&a.jsx(tw,{d:`M ${p(u)} ${s} L ${p(u)} ${s+r}`,className:n.root,ownerState:{axisHighlight:"line"}})]},`${c}-${u}`)})}const xwe=()=>Vn({root:["root"]},hwe);function ywe(e){const{x:t,y:n}=e,s=xwe();return a.jsxs(f.Fragment,{children:[t&&t!=="none"&&a.jsx(pwe,{type:t,classes:s}),n&&n!=="none"&&a.jsx(gwe,{type:n,classes:s})]})}function bwe(e){const{id:t,offset:n}=e,{left:s,top:r,width:i,height:o}=Ei(),l=at({top:0,right:0,bottom:0,left:0},n);return a.jsx("clipPath",{id:t,children:a.jsx("rect",{x:s-l.left,y:r-l.top,width:i+l.left+l.right,height:o+l.top+l.bottom})})}const vwe=parseInt(f.version,10),wwe=["x","y","id","classes","color","shape"];function jwe(e){return Yn("MuiHighlightElement",e)}An("MuiHighlightElement",["root"]);const Nwe=e=>{const{classes:t,id:n}=e,s={root:["root",`series-${n}`]};return Vn(s,jwe,t)};function Cwe(e){const{x:t,y:n,color:s,shape:r}=e,i=ya(e,wwe),o=Nwe(e),l=r==="circle"?"circle":"path",c=r==="circle"?{cx:0,cy:0,r:i.r===void 0?5:i.r}:{d:I4(sW[GW(r)])()},u=vwe>18?{transformOrigin:`${t} ${n}`}:{"transform-origin":`${t} ${n}`};return a.jsx(l,at({pointerEvents:"none",className:o.root,transform:`translate(${t} ${n})`,fill:s},u,c,i))}const Swe=["slots","slotProps"];function _we(e){const{slots:t,slotProps:n}=e,s=ya(e,Swe),r=Ox(),{xAxis:i,xAxisIds:o}=jr(),{yAxis:l,yAxisIds:c}=Nr(),{instance:u}=Yr(),d=Ka(),h=Gt(d,IG);if(h.length===0||r===void 0)return null;const{series:p,stackingGroups:x}=r,v=o[0],j=c[0],y=t?.lineHighlight??Cwe;return a.jsx("g",at({},s,{children:h.flatMap(({dataIndex:N,axisId:w})=>x.flatMap(({ids:S})=>S.flatMap(_=>{const{xAxisId:k=v,yAxisId:T=j,stackedData:A,data:E,disableHighlight:M,shape:z="circle"}=p[_];if(M||E[N]==null||w!==k)return null;const P=oh(i[k].scale),D=l[T].scale,U=i[k].data;if(U===void 0)throw new Error(`MUI X Charts: ${k===zj?"The first `xAxis`":`The x-axis with id "${k}"`} should have data property to be able to display a line plot.`);const B=P(U[N]),R=D(A[N][1]);if(!u.isPointInside(B,R))return null;const q=V4(p[_],i[k],l[T]);return a.jsx(y,at({id:_,color:q(N),x:B,y:R,shape:z},n?.lineHighlight),`${_}`)})))}))}function Awe(e){return Yn("MuiChartsGrid",e)}const lR=An("MuiChartsGrid",["root","line","horizontalLine","verticalLine"]),Twe=fa("g",{name:"MuiChartsGrid",slot:"Root",overridesResolver:(e,t)=>[{[`&.${lR.verticalLine}`]:t.verticalLine},{[`&.${lR.horizontalLine}`]:t.horizontalLine},t.root]})({}),kV=fa("line",{name:"MuiChartsGrid",slot:"Line"})(({theme:e})=>({stroke:(e.vars||e).palette.divider,shapeRendering:"crispEdges",strokeWidth:1}));function kwe(e){const{instance:t}=Yr(),{axis:n,start:s,end:r,classes:i}=e,{scale:o,tickNumber:l,tickInterval:c}=n,u=bN({scale:o,tickNumber:l,tickInterval:c,direction:"x"});return a.jsx(f.Fragment,{children:u.map(({value:d,offset:h})=>t.isXInside(h)?a.jsx(kV,{y1:s,y2:r,x1:h,x2:h,className:i.verticalLine},`vertical-${d?.getTime?.()??d}`):null)})}function Ewe(e){const{instance:t}=Yr(),{axis:n,start:s,end:r,classes:i}=e,{scale:o,tickNumber:l,tickInterval:c}=n,u=bN({scale:o,tickNumber:l,tickInterval:c,direction:"y"});return a.jsx(f.Fragment,{children:u.map(({value:d,offset:h})=>t.isYInside(h)?a.jsx(kV,{y1:h,y2:h,x1:s,x2:r,className:i.horizontalLine},`horizontal-${d?.getTime?.()??d}`):null)})}const Lwe=["vertical","horizontal"],Pwe=({classes:e})=>Vn({root:["root"],verticalLine:["line","verticalLine"],horizontalLine:["line","horizontalLine"]},Awe,e);function Dwe(e){const t=Ti({props:e,name:"MuiChartsGrid"}),n=Ei(),{vertical:s,horizontal:r}=t,i=ya(t,Lwe),{xAxis:o,xAxisIds:l}=jr(),{yAxis:c,yAxisIds:u}=Nr(),d=Pwe(t),h=c[u[0]],p=o[l[0]];return a.jsxs(Twe,at({},i,{className:d.root,children:[s&&a.jsx(kwe,{axis:p,start:n.top,end:n.height+n.top,classes:d}),r&&a.jsx(Ewe,{axis:h,start:n.left,end:n.width+n.left,classes:d})]}))}const Owe=["message"],Mwe=fa("text")(({theme:e})=>at({},e.typography.body2,{stroke:"none",fill:(e.vars||e).palette.text.primary,shapeRendering:"crispEdges",textAnchor:"middle",dominantBaseline:"middle"}));function Iwe(e){const{message:t}=e,n=ya(e,Owe),{top:s,left:r,height:i,width:o}=Ei(),{localeText:l}=RW();return a.jsx(Mwe,at({x:r+o/2,y:s+i/2},n,{children:t??l.loading}))}const $we=["message"],Rwe=fa("text")(({theme:e})=>at({},e.typography.body2,{stroke:"none",fill:(e.vars||e).palette.text.primary,shapeRendering:"crispEdges",textAnchor:"middle",dominantBaseline:"middle"}));function zwe(e){const{message:t}=e,n=ya(e,$we),{top:s,left:r,height:i,width:o}=Ei(),{localeText:l}=RW();return a.jsx(Rwe,at({x:r+o/2,y:s+i/2},n,{children:t??l.noData}))}function Fwe(){const e=hN();return Object.values(e).every(t=>{if(!t)return!0;const{series:n,seriesOrder:s}=t;return s.every(r=>{const i=n[r];return i.type==="sankey"?i.data.links.length===0:i.data.length===0})})}function Uwe(e){const t=Fwe();if(e.loading){const n=e.slots?.loadingOverlay??Iwe;return a.jsx(n,at({},e.slotProps?.loadingOverlay))}if(t){const n=e.slots?.noDataOverlay??zwe;return a.jsx(n,at({},e.slotProps?.noDataOverlay))}return null}const Bwe=[Lx,Ex,_x,rh,Px,sN],Hwe=["xAxis","yAxis","series","width","height","margin","colors","dataset","sx","onAreaClick","onLineClick","onMarkClick","axisHighlight","disableLineItemHighlight","hideLegend","grid","children","slots","slotProps","skipAnimation","loading","highlightedItem","onHighlightChange","className","showToolbar","brushConfig"],qwe=e=>{const{xAxis:t,yAxis:n,series:s,width:r,height:i,margin:o,colors:l,dataset:c,sx:u,onAreaClick:d,onLineClick:h,onMarkClick:p,axisHighlight:x,disableLineItemHighlight:v,grid:j,children:y,slots:N,slotProps:w,skipAnimation:S,loading:_,highlightedItem:k,onHighlightChange:T,className:A,brushConfig:E}=e,M=ya(e,Hwe),P=`${Dj()}-clip-path`,D=f.useMemo(()=>s.map(we=>at({disableHighlight:!!v,type:"line"},we)),[v,s]),U=at({},M,{series:D,width:r,height:i,margin:o,colors:l,dataset:c,xAxis:t??[{id:zj,scaleType:"point",data:Array.from({length:Math.max(...s.map(we=>(we.data??c??[]).length))},(we,de)=>de)}],yAxis:n,highlightedItem:k,onHighlightChange:T,disableAxisListener:w?.tooltip?.trigger!=="axis"&&x?.x==="none"&&x?.y==="none",className:A,skipAnimation:S,brushConfig:E,plugins:Bwe}),B={vertical:j?.vertical,horizontal:j?.horizontal},R={clipPath:`url(#${P})`},q={id:P},Z={slots:N,slotProps:w,onItemClick:d},V={slots:N,slotProps:w,onItemClick:h},oe={slots:N,slotProps:w,onItemClick:p,skipAnimation:S},je={slots:N,slotProps:w,loading:_},X={slots:N,slotProps:w},se=at({x:"line"},x),ye={slots:N,slotProps:w},Ne={slots:N,slotProps:w};return{chartsWrapperProps:{sx:u,legendPosition:e.slotProps?.legend?.position,legendDirection:e.slotProps?.legend?.direction,hideLegend:e.hideLegend??!1},chartContainerProps:U,gridProps:B,clipPathProps:q,clipPathGroupProps:R,areaPlotProps:Z,linePlotProps:V,markPlotProps:oe,overlayProps:je,chartsAxisProps:X,axisHighlightProps:se,lineHighlightPlotProps:ye,legendProps:Ne,children:y}};function Gwe(e,t,n,s,r,i,o,l,c,u,d,h=1/0,p=1){const x=s.copy(),v=r.copy();x.range([0,1]),v.range([0,1]);const j=function(E){const M=x(n[E].x),z=v(n[E].y);return M>=i&&M<=o&&z>=l&&z<=c},y=s.range()[1]-s.range()[0],N=r.range()[1]-r.range()[0],w=y*y,S=N*N;function _(A,E){return w*A*A+S*E*E}const k=x(cR(s,u,A=>n[A]?.x)),T=v(cR(r,d,A=>n[A]?.y));return e.neighbors(k,T,p,h!=null?h*h:1/0,j,_)}function cR(e,t,n){if(vs(e)){const s=e.bandwidth()===0?Math.floor((t-Math.min(...e.range())+e.step()/2)/e.step()):Math.floor((t-Math.min(...e.range()))/e.step());return n(s)}return e.invert(t)}const NN=({svgRef:e,params:t,store:n,instance:s})=>{const{disableVoronoi:r,voronoiMaxRadius:i,onItemClick:o}=t,l=Gt(n,wr),{axis:c,axisIds:u}=Gt(n,Xs),{axis:d,axisIds:h}=Gt(n,Zs),p=Gt(n,hG),{series:x,seriesOrder:v}=Gt(n,yn)?.scatter??{},j=Gt(n,p?Yge:Qge),y=u[0],N=h[0];is(()=>{n.set("voronoi",{isVoronoiEnabled:!r})},[n,r]),f.useEffect(()=>{if(e.current===null||r)return;const _=e.current;function k(B){const R=Ep(_,B);if(!s.isPointInside(R.x,R.y))return"outside-chart";let q;for(const Z of v??[]){const V=(x??{})[Z],oe=j.get(Z);if(!oe)continue;const je=V.xAxisId??y,X=V.yAxisId??N,se=k6(n.getSnapshot(),je),ye=k6(n.getSnapshot(),X),Ne=i==="item"?V.markerSize:i,fe=(se?.start??0)/100,we=(se?.end??100)/100,de=(ye?.start??0)/100,ke=(ye?.end??100)/100,ge=c[je].scale,$e=d[X].scale,be=Gwe(oe,l,V.data,ge,$e,fe,we,de,ke,R.x,R.y,Ne)[0];if(be===void 0)continue;const me=V.data[be],Ue=ge(me.x),Ee=$e(me.y),We=(Ue-R.x)**2+(Ee-R.y)**2;(q===void 0||We<q.distanceSq)&&(q={dataIndex:be,seriesId:Z,distanceSq:We})}return q===void 0?"no-point-found":{seriesId:q.seriesId,dataIndex:q.dataIndex}}const T=s.addInteractionListener("moveEnd",B=>{B.detail.activeGestures.pan||(s.cleanInteraction?.(),s.clearHighlight?.())}),A=s.addInteractionListener("panEnd",B=>{B.detail.activeGestures.move||(s.cleanInteraction?.(),s.clearHighlight?.())}),E=s.addInteractionListener("quickPressEnd",B=>{!B.detail.activeGestures.move&&!B.detail.activeGestures.pan&&(s.cleanInteraction?.(),s.clearHighlight?.())}),M=B=>{const R=k(B.detail.srcEvent);if(R==="outside-chart"){s.cleanInteraction?.(),s.clearHighlight?.();return}if(R==="outside-voronoi-max-radius"||R==="no-point-found"){s.removeItemInteraction?.(),s.clearHighlight?.();return}const{seriesId:q,dataIndex:Z}=R;s.setItemInteraction?.({type:"scatter",seriesId:q,dataIndex:Z},{interaction:"pointer"}),s.setHighlight?.({seriesId:q,dataIndex:Z})},z=s.addInteractionListener("tap",B=>{const R=k(B.detail.srcEvent);if(typeof R!="string"&&o){const{seriesId:q,dataIndex:Z}=R;o(B.detail.srcEvent,{type:"scatter",seriesId:q,dataIndex:Z})}}),P=s.addInteractionListener("move",M),D=s.addInteractionListener("pan",M),U=s.addInteractionListener("quickPress",M);return()=>{z.cleanup(),P.cleanup(),T.cleanup(),D.cleanup(),A.cleanup(),U.cleanup(),E.cleanup()}},[e,d,c,i,o,r,l,s,v,x,j,y,N,n]);const w=ps(()=>{n.set("voronoi",{isVoronoiEnabled:!0})}),S=ps(()=>{n.set("voronoi",{isVoronoiEnabled:!1})});return{instance:{enableVoronoi:w,disableVoronoi:S}}};NN.getDefaultizedParams=({params:e})=>at({},e,{disableVoronoi:e.disableVoronoi??!e.series.some(t=>t.type==="scatter")});NN.getInitialState=e=>({voronoi:{isVoronoiEnabled:!e.disableVoronoi}});NN.params={disableVoronoi:!0,voronoiMaxRadius:!0,onItemClick:!0};const EV=[Lx,Ex,_x,rh,Px,NN,sN],Wwe=["width","height","margin","children","series","colors","dataset","desc","onAxisClick","highlightedAxis","onHighlightedAxisChange","disableVoronoi","voronoiMaxRadius","onItemClick","disableAxisListener","highlightedItem","onHighlightChange","sx","title","xAxis","yAxis","zAxis","rotationAxis","radiusAxis","skipAnimation","seriesConfig","plugins","localeText","slots","slotProps","experimentalFeatures","enableKeyboardNavigation","brushConfig"],Vwe=(e,t)=>{const n=e,{width:s,height:r,margin:i,children:o,series:l,colors:c,dataset:u,desc:d,onAxisClick:h,highlightedAxis:p,onHighlightedAxisChange:x,disableVoronoi:v,voronoiMaxRadius:j,onItemClick:y,disableAxisListener:N,highlightedItem:w,onHighlightChange:S,sx:_,title:k,xAxis:T,yAxis:A,zAxis:E,rotationAxis:M,radiusAxis:z,skipAnimation:P,seriesConfig:D,plugins:U,localeText:B,slots:R,slotProps:q,experimentalFeatures:Z,enableKeyboardNavigation:V,brushConfig:oe}=n,je=ya(n,Wwe),X=at({title:k,desc:d,sx:_,ref:t},je);return{chartDataProviderProps:{margin:i,series:l,colors:c,dataset:u,disableAxisListener:N,highlightedItem:w,onHighlightChange:S,onAxisClick:h,highlightedAxis:p,onHighlightedAxisChange:x,disableVoronoi:v,voronoiMaxRadius:j,onItemClick:y,xAxis:T,yAxis:A,zAxis:E,rotationAxis:M,radiusAxis:z,skipAnimation:P,width:s,height:r,localeText:B,seriesConfig:D,experimentalFeatures:Z,enableKeyboardNavigation:V,brushConfig:oe,plugins:U??EV,slots:R,slotProps:q},chartsSurfaceProps:X,children:o}};function dR(e){try{return e.matches(":focus-visible")}catch{}return!1}class aw{static create(){return new aw}static use(){const t=$j(aw.create).current,[n,s]=f.useState(!1);return t.shouldMount=n,t.setShouldMount=s,f.useEffect(t.mountEffect,[n]),t}constructor(){this.ref={current:null},this.mounted=null,this.didMount=!1,this.shouldMount=!1,this.setShouldMount=null}mount(){return this.mounted||(this.mounted=Qwe(),this.shouldMount=!0,this.setShouldMount(this.shouldMount)),this.mounted}mountEffect=()=>{this.shouldMount&&!this.didMount&&this.ref.current!==null&&(this.didMount=!0,this.mounted.resolve())};start(...t){this.mount().then(()=>this.ref.current?.start(...t))}stop(...t){this.mount().then(()=>this.ref.current?.stop(...t))}pulsate(...t){this.mount().then(()=>this.ref.current?.pulsate(...t))}}function Ywe(){return aw.use()}function Qwe(){let e,t;const n=new Promise((s,r)=>{e=s,t=r});return n.resolve=e,n.reject=t,n}class oP{static create(){return new oP}currentId=null;start(t,n){this.clear(),this.currentId=setTimeout(()=>{this.currentId=null,n()},t)}clear=()=>{this.currentId!==null&&(clearTimeout(this.currentId),this.currentId=null)};disposeEffect=()=>this.clear}function Kwe(){const e=$j(oP.create).current;return oq(e.disposeEffect),e}function Xwe(e){const{className:t,classes:n,pulsate:s=!1,rippleX:r,rippleY:i,rippleSize:o,in:l,onExited:c,timeout:u}=e,[d,h]=f.useState(!1),p=$t(t,n.ripple,n.rippleVisible,s&&n.ripplePulsate),x={width:o,height:o,top:-(o/2)+i,left:-(o/2)+r},v=$t(n.child,d&&n.childLeaving,s&&n.childPulsate);return!l&&!d&&h(!0),f.useEffect(()=>{if(!l&&c!=null){const j=setTimeout(c,u);return()=>{clearTimeout(j)}}},[c,l,u]),a.jsx("span",{className:p,style:x,children:a.jsx("span",{className:v})})}const mi=An("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),Wk=550,Zwe=80,Jwe=xx`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`,eje=xx`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`,tje=xx`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`,aje=fa("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),nje=fa(Xwe,{name:"MuiTouchRipple",slot:"Ripple"})`
  opacity: 0;
  position: absolute;

  &.${mi.rippleVisible} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${Jwe};
    animation-duration: ${Wk}ms;
    animation-timing-function: ${({theme:e})=>e.transitions.easing.easeInOut};
  }

  &.${mi.ripplePulsate} {
    animation-duration: ${({theme:e})=>e.transitions.duration.shorter}ms;
  }

  & .${mi.child} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${mi.childLeaving} {
    opacity: 0;
    animation-name: ${eje};
    animation-duration: ${Wk}ms;
    animation-timing-function: ${({theme:e})=>e.transitions.easing.easeInOut};
  }

  & .${mi.childPulsate} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${tje};
    animation-duration: 2500ms;
    animation-timing-function: ${({theme:e})=>e.transitions.easing.easeInOut};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`,sje=f.forwardRef(function(t,n){const s=Sd({props:t,name:"MuiTouchRipple"}),{center:r=!1,classes:i={},className:o,...l}=s,[c,u]=f.useState([]),d=f.useRef(0),h=f.useRef(null);f.useEffect(()=>{h.current&&(h.current(),h.current=null)},[c]);const p=f.useRef(!1),x=Kwe(),v=f.useRef(null),j=f.useRef(null),y=f.useCallback(_=>{const{pulsate:k,rippleX:T,rippleY:A,rippleSize:E,cb:M}=_;u(z=>[...z,a.jsx(nje,{classes:{ripple:$t(i.ripple,mi.ripple),rippleVisible:$t(i.rippleVisible,mi.rippleVisible),ripplePulsate:$t(i.ripplePulsate,mi.ripplePulsate),child:$t(i.child,mi.child),childLeaving:$t(i.childLeaving,mi.childLeaving),childPulsate:$t(i.childPulsate,mi.childPulsate)},timeout:Wk,pulsate:k,rippleX:T,rippleY:A,rippleSize:E},d.current)]),d.current+=1,h.current=M},[i]),N=f.useCallback((_={},k={},T=()=>{})=>{const{pulsate:A=!1,center:E=r||k.pulsate,fakeElement:M=!1}=k;if(_?.type==="mousedown"&&p.current){p.current=!1;return}_?.type==="touchstart"&&(p.current=!0);const z=M?null:j.current,P=z?z.getBoundingClientRect():{width:0,height:0,left:0,top:0};let D,U,B;if(E||_===void 0||_.clientX===0&&_.clientY===0||!_.clientX&&!_.touches)D=Math.round(P.width/2),U=Math.round(P.height/2);else{const{clientX:R,clientY:q}=_.touches&&_.touches.length>0?_.touches[0]:_;D=Math.round(R-P.left),U=Math.round(q-P.top)}if(E)B=Math.sqrt((2*P.width**2+P.height**2)/3),B%2===0&&(B+=1);else{const R=Math.max(Math.abs((z?z.clientWidth:0)-D),D)*2+2,q=Math.max(Math.abs((z?z.clientHeight:0)-U),U)*2+2;B=Math.sqrt(R**2+q**2)}_?.touches?v.current===null&&(v.current=()=>{y({pulsate:A,rippleX:D,rippleY:U,rippleSize:B,cb:T})},x.start(Zwe,()=>{v.current&&(v.current(),v.current=null)})):y({pulsate:A,rippleX:D,rippleY:U,rippleSize:B,cb:T})},[r,y,x]),w=f.useCallback(()=>{N({},{pulsate:!0})},[N]),S=f.useCallback((_,k)=>{if(x.clear(),_?.type==="touchend"&&v.current){v.current(),v.current=null,x.start(0,()=>{S(_,k)});return}v.current=null,u(T=>T.length>0?T.slice(1):T),h.current=k},[x]);return f.useImperativeHandle(n,()=>({pulsate:w,start:N,stop:S}),[w,N,S]),a.jsx(aje,{className:$t(mi.root,i.root,o),ref:j,...l,children:a.jsx(HL,{component:null,exit:!0,children:c})})});function rje(e){return Yn("MuiButtonBase",e)}const ije=An("MuiButtonBase",["root","disabled","focusVisible"]),oje=e=>{const{disabled:t,focusVisible:n,focusVisibleClassName:s,classes:r}=e,o=Vn({root:["root",t&&"disabled",n&&"focusVisible"]},rje,r);return n&&s&&(o.root+=` ${s}`),o},lje=fa("button",{name:"MuiButtonBase",slot:"Root"})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${ije.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),LV=f.forwardRef(function(t,n){const s=Sd({props:t,name:"MuiButtonBase"}),{action:r,centerRipple:i=!1,children:o,className:l,component:c="button",disabled:u=!1,disableRipple:d=!1,disableTouchRipple:h=!1,focusRipple:p=!1,focusVisibleClassName:x,LinkComponent:v="a",onBlur:j,onClick:y,onContextMenu:N,onDragLeave:w,onFocus:S,onFocusVisible:_,onKeyDown:k,onKeyUp:T,onMouseDown:A,onMouseLeave:E,onMouseUp:M,onTouchEnd:z,onTouchMove:P,onTouchStart:D,tabIndex:U=0,TouchRippleProps:B,touchRippleRef:R,type:q,...Z}=s,V=f.useRef(null),oe=Ywe(),je=Uo(oe.ref,R),[X,se]=f.useState(!1);u&&X&&se(!1),f.useImperativeHandle(r,()=>({focusVisible:()=>{se(!0),V.current.focus()}}),[]);const ye=oe.shouldMount&&!d&&!u;f.useEffect(()=>{X&&p&&!d&&oe.pulsate()},[d,p,X,oe]);const Ne=xl(oe,"start",A,h),fe=xl(oe,"stop",N,h),we=xl(oe,"stop",w,h),de=xl(oe,"stop",M,h),ke=xl(oe,"stop",Je=>{X&&Je.preventDefault(),E&&E(Je)},h),ge=xl(oe,"start",D,h),$e=xl(oe,"stop",z,h),be=xl(oe,"stop",P,h),me=xl(oe,"stop",Je=>{dR(Je.target)||se(!1),j&&j(Je)},!1),Ue=ps(Je=>{V.current||(V.current=Je.currentTarget),dR(Je.target)&&(se(!0),_&&_(Je)),S&&S(Je)}),Ee=()=>{const Je=V.current;return c&&c!=="button"&&!(Je.tagName==="A"&&Je.href)},We=ps(Je=>{p&&!Je.repeat&&X&&Je.key===" "&&oe.stop(Je,()=>{oe.start(Je)}),Je.target===Je.currentTarget&&Ee()&&Je.key===" "&&Je.preventDefault(),k&&k(Je),Je.target===Je.currentTarget&&Ee()&&Je.key==="Enter"&&!u&&(Je.preventDefault(),y&&y(Je))}),tt=ps(Je=>{p&&Je.key===" "&&X&&!Je.defaultPrevented&&oe.stop(Je,()=>{oe.pulsate(Je)}),T&&T(Je),y&&Je.target===Je.currentTarget&&Ee()&&Je.key===" "&&!Je.defaultPrevented&&y(Je)});let lt=c;lt==="button"&&(Z.href||Z.to)&&(lt=v);const Fe={};lt==="button"?(Fe.type=q===void 0?"button":q,Fe.disabled=u):(!Z.href&&!Z.to&&(Fe.role="button"),u&&(Fe["aria-disabled"]=u));const st=Uo(n,V),Xe={...s,centerRipple:i,component:c,disabled:u,disableRipple:d,disableTouchRipple:h,focusRipple:p,tabIndex:U,focusVisible:X},Ze=oje(Xe);return a.jsxs(lje,{as:lt,className:$t(Ze.root,l),ownerState:Xe,onBlur:me,onClick:y,onContextMenu:fe,onFocus:Ue,onKeyDown:We,onKeyUp:tt,onMouseDown:Ne,onMouseLeave:ke,onMouseUp:de,onDragLeave:we,onTouchEnd:$e,onTouchMove:be,onTouchStart:ge,ref:st,tabIndex:u?-1:U,type:q,...Fe,...Z,children:[o,ye?a.jsx(sje,{ref:je,center:i,...B}):null]})});function xl(e,t,n,s=!1){return ps(r=>(n&&n(r),s||e[t](r),!0))}function cje(e){return Yn("MuiIconButton",e)}const uR=An("MuiIconButton",["root","disabled","colorInherit","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","edgeStart","edgeEnd","sizeSmall","sizeMedium","sizeLarge","loading","loadingIndicator","loadingWrapper"]),dje=e=>{const{classes:t,disabled:n,color:s,edge:r,size:i,loading:o}=e,l={root:["root",o&&"loading",n&&"disabled",s!=="default"&&`color${Wa(s)}`,r&&`edge${Wa(r)}`,`size${Wa(i)}`],loadingIndicator:["loadingIndicator"],loadingWrapper:["loadingWrapper"]};return Vn(l,cje,t)},uje=fa(LV,{name:"MuiIconButton",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.loading&&t.loading,n.color!=="default"&&t[`color${Wa(n.color)}`],n.edge&&t[`edge${Wa(n.edge)}`],t[`size${Wa(n.size)}`]]}})(Mu(({theme:e})=>({textAlign:"center",flex:"0 0 auto",fontSize:e.typography.pxToRem(24),padding:8,borderRadius:"50%",color:(e.vars||e).palette.action.active,transition:e.transitions.create("background-color",{duration:e.transitions.duration.shortest}),variants:[{props:t=>!t.disableRipple,style:{"--IconButton-hoverBg":e.alpha((e.vars||e).palette.action.active,(e.vars||e).palette.action.hoverOpacity),"&:hover":{backgroundColor:"var(--IconButton-hoverBg)","@media (hover: none)":{backgroundColor:"transparent"}}}},{props:{edge:"start"},style:{marginLeft:-12}},{props:{edge:"start",size:"small"},style:{marginLeft:-3}},{props:{edge:"end"},style:{marginRight:-12}},{props:{edge:"end",size:"small"},style:{marginRight:-3}}]})),Mu(({theme:e})=>({variants:[{props:{color:"inherit"},style:{color:"inherit"}},...Object.entries(e.palette).filter(jp()).map(([t])=>({props:{color:t},style:{color:(e.vars||e).palette[t].main}})),...Object.entries(e.palette).filter(jp()).map(([t])=>({props:{color:t},style:{"--IconButton-hoverBg":e.alpha((e.vars||e).palette[t].main,(e.vars||e).palette.action.hoverOpacity)}})),{props:{size:"small"},style:{padding:5,fontSize:e.typography.pxToRem(18)}},{props:{size:"large"},style:{padding:12,fontSize:e.typography.pxToRem(28)}}],[`&.${uR.disabled}`]:{backgroundColor:"transparent",color:(e.vars||e).palette.action.disabled},[`&.${uR.loading}`]:{color:"transparent"}}))),mje=fa("span",{name:"MuiIconButton",slot:"LoadingIndicator"})(({theme:e})=>({display:"none",position:"absolute",visibility:"visible",top:"50%",left:"50%",transform:"translate(-50%, -50%)",color:(e.vars||e).palette.action.disabled,variants:[{props:{loading:!0},style:{display:"flex"}}]})),fje=f.forwardRef(function(t,n){const s=Sd({props:t,name:"MuiIconButton"}),{edge:r=!1,children:i,className:o,color:l="default",disabled:c=!1,disableFocusRipple:u=!1,size:d="medium",id:h,loading:p=null,loadingIndicator:x,...v}=s,j=Dj(h),y=x??a.jsx(qL,{"aria-labelledby":j,color:"inherit",size:16}),N={...s,edge:r,color:l,disabled:c,disableFocusRipple:u,loading:p,loadingIndicator:y,size:d},w=dje(N);return a.jsxs(uje,{id:p?j:h,className:$t(w.root,o),centerRipple:!0,focusRipple:!u,disabled:c||p,ref:n,...v,ownerState:N,children:[typeof p=="boolean"&&a.jsx("span",{className:w.loadingWrapper,style:{display:"contents"},children:a.jsx(mje,{className:w.loadingIndicator,ownerState:N,children:p&&y})}),i]})});function hje(e){return Yn("MuiButton",e)}const Kd=An("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","colorPrimary","colorSecondary","colorSuccess","colorError","colorInfo","colorWarning","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","icon","iconSizeSmall","iconSizeMedium","iconSizeLarge","loading","loadingWrapper","loadingIconPlaceholder","loadingIndicator","loadingPositionCenter","loadingPositionStart","loadingPositionEnd"]),gje=f.createContext({}),pje=f.createContext(void 0),xje=e=>{const{color:t,disableElevation:n,fullWidth:s,size:r,variant:i,loading:o,loadingPosition:l,classes:c}=e,u={root:["root",o&&"loading",i,`${i}${Wa(t)}`,`size${Wa(r)}`,`${i}Size${Wa(r)}`,`color${Wa(t)}`,n&&"disableElevation",s&&"fullWidth",o&&`loadingPosition${Wa(l)}`],startIcon:["icon","startIcon",`iconSize${Wa(r)}`],endIcon:["icon","endIcon",`iconSize${Wa(r)}`],loadingIndicator:["loadingIndicator"],loadingWrapper:["loadingWrapper"]},d=Vn(u,hje,c);return{...c,...d}},PV=[{props:{size:"small"},style:{"& > *:nth-of-type(1)":{fontSize:18}}},{props:{size:"medium"},style:{"& > *:nth-of-type(1)":{fontSize:20}}},{props:{size:"large"},style:{"& > *:nth-of-type(1)":{fontSize:22}}}],yje=fa(LV,{shouldForwardProp:e=>K9(e)||e==="classes",name:"MuiButton",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[n.variant],t[`${n.variant}${Wa(n.color)}`],t[`size${Wa(n.size)}`],t[`${n.variant}Size${Wa(n.size)}`],n.color==="inherit"&&t.colorInherit,n.disableElevation&&t.disableElevation,n.fullWidth&&t.fullWidth,n.loading&&t.loading]}})(Mu(({theme:e})=>{const t=e.palette.mode==="light"?e.palette.grey[300]:e.palette.grey[800],n=e.palette.mode==="light"?e.palette.grey.A100:e.palette.grey[700];return{...e.typography.button,minWidth:64,padding:"6px 16px",border:0,borderRadius:(e.vars||e).shape.borderRadius,transition:e.transitions.create(["background-color","box-shadow","border-color","color"],{duration:e.transitions.duration.short}),"&:hover":{textDecoration:"none"},[`&.${Kd.disabled}`]:{color:(e.vars||e).palette.action.disabled},variants:[{props:{variant:"contained"},style:{color:"var(--variant-containedColor)",backgroundColor:"var(--variant-containedBg)",boxShadow:(e.vars||e).shadows[2],"&:hover":{boxShadow:(e.vars||e).shadows[4],"@media (hover: none)":{boxShadow:(e.vars||e).shadows[2]}},"&:active":{boxShadow:(e.vars||e).shadows[8]},[`&.${Kd.focusVisible}`]:{boxShadow:(e.vars||e).shadows[6]},[`&.${Kd.disabled}`]:{color:(e.vars||e).palette.action.disabled,boxShadow:(e.vars||e).shadows[0],backgroundColor:(e.vars||e).palette.action.disabledBackground}}},{props:{variant:"outlined"},style:{padding:"5px 15px",border:"1px solid currentColor",borderColor:"var(--variant-outlinedBorder, currentColor)",backgroundColor:"var(--variant-outlinedBg)",color:"var(--variant-outlinedColor)",[`&.${Kd.disabled}`]:{border:`1px solid ${(e.vars||e).palette.action.disabledBackground}`}}},{props:{variant:"text"},style:{padding:"6px 8px",color:"var(--variant-textColor)",backgroundColor:"var(--variant-textBg)"}},...Object.entries(e.palette).filter(jp()).map(([s])=>({props:{color:s},style:{"--variant-textColor":(e.vars||e).palette[s].main,"--variant-outlinedColor":(e.vars||e).palette[s].main,"--variant-outlinedBorder":e.alpha((e.vars||e).palette[s].main,.5),"--variant-containedColor":(e.vars||e).palette[s].contrastText,"--variant-containedBg":(e.vars||e).palette[s].main,"@media (hover: hover)":{"&:hover":{"--variant-containedBg":(e.vars||e).palette[s].dark,"--variant-textBg":e.alpha((e.vars||e).palette[s].main,(e.vars||e).palette.action.hoverOpacity),"--variant-outlinedBorder":(e.vars||e).palette[s].main,"--variant-outlinedBg":e.alpha((e.vars||e).palette[s].main,(e.vars||e).palette.action.hoverOpacity)}}}})),{props:{color:"inherit"},style:{color:"inherit",borderColor:"currentColor","--variant-containedBg":e.vars?e.vars.palette.Button.inheritContainedBg:t,"@media (hover: hover)":{"&:hover":{"--variant-containedBg":e.vars?e.vars.palette.Button.inheritContainedHoverBg:n,"--variant-textBg":e.alpha((e.vars||e).palette.text.primary,(e.vars||e).palette.action.hoverOpacity),"--variant-outlinedBg":e.alpha((e.vars||e).palette.text.primary,(e.vars||e).palette.action.hoverOpacity)}}}},{props:{size:"small",variant:"text"},style:{padding:"4px 5px",fontSize:e.typography.pxToRem(13)}},{props:{size:"large",variant:"text"},style:{padding:"8px 11px",fontSize:e.typography.pxToRem(15)}},{props:{size:"small",variant:"outlined"},style:{padding:"3px 9px",fontSize:e.typography.pxToRem(13)}},{props:{size:"large",variant:"outlined"},style:{padding:"7px 21px",fontSize:e.typography.pxToRem(15)}},{props:{size:"small",variant:"contained"},style:{padding:"4px 10px",fontSize:e.typography.pxToRem(13)}},{props:{size:"large",variant:"contained"},style:{padding:"8px 22px",fontSize:e.typography.pxToRem(15)}},{props:{disableElevation:!0},style:{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${Kd.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${Kd.disabled}`]:{boxShadow:"none"}}},{props:{fullWidth:!0},style:{width:"100%"}},{props:{loadingPosition:"center"},style:{transition:e.transitions.create(["background-color","box-shadow","border-color"],{duration:e.transitions.duration.short}),[`&.${Kd.loading}`]:{color:"transparent"}}}]}})),bje=fa("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.startIcon,n.loading&&t.startIconLoadingStart,t[`iconSize${Wa(n.size)}`]]}})(({theme:e})=>({display:"inherit",marginRight:8,marginLeft:-4,variants:[{props:{size:"small"},style:{marginLeft:-2}},{props:{loadingPosition:"start",loading:!0},style:{transition:e.transitions.create(["opacity"],{duration:e.transitions.duration.short}),opacity:0}},{props:{loadingPosition:"start",loading:!0,fullWidth:!0},style:{marginRight:-8}},...PV]})),vje=fa("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.endIcon,n.loading&&t.endIconLoadingEnd,t[`iconSize${Wa(n.size)}`]]}})(({theme:e})=>({display:"inherit",marginRight:-4,marginLeft:8,variants:[{props:{size:"small"},style:{marginRight:-2}},{props:{loadingPosition:"end",loading:!0},style:{transition:e.transitions.create(["opacity"],{duration:e.transitions.duration.short}),opacity:0}},{props:{loadingPosition:"end",loading:!0,fullWidth:!0},style:{marginLeft:-8}},...PV]})),wje=fa("span",{name:"MuiButton",slot:"LoadingIndicator"})(({theme:e})=>({display:"none",position:"absolute",visibility:"visible",variants:[{props:{loading:!0},style:{display:"flex"}},{props:{loadingPosition:"start"},style:{left:14}},{props:{loadingPosition:"start",size:"small"},style:{left:10}},{props:{variant:"text",loadingPosition:"start"},style:{left:6}},{props:{loadingPosition:"center"},style:{left:"50%",transform:"translate(-50%)",color:(e.vars||e).palette.action.disabled}},{props:{loadingPosition:"end"},style:{right:14}},{props:{loadingPosition:"end",size:"small"},style:{right:10}},{props:{variant:"text",loadingPosition:"end"},style:{right:6}},{props:{loadingPosition:"start",fullWidth:!0},style:{position:"relative",left:-10}},{props:{loadingPosition:"end",fullWidth:!0},style:{position:"relative",right:-10}}]})),mR=fa("span",{name:"MuiButton",slot:"LoadingIconPlaceholder"})({display:"inline-block",width:"1em",height:"1em"}),jje=f.forwardRef(function(t,n){const s=f.useContext(gje),r=f.useContext(pje),i=Ou(s,t),o=Sd({props:i,name:"MuiButton"}),{children:l,color:c="primary",component:u="button",className:d,disabled:h=!1,disableElevation:p=!1,disableFocusRipple:x=!1,endIcon:v,focusVisibleClassName:j,fullWidth:y=!1,id:N,loading:w=null,loadingIndicator:S,loadingPosition:_="center",size:k="medium",startIcon:T,type:A,variant:E="text",...M}=o,z=Dj(N),P=S??a.jsx(qL,{"aria-labelledby":z,color:"inherit",size:16}),D={...o,color:c,component:u,disabled:h,disableElevation:p,disableFocusRipple:x,fullWidth:y,loading:w,loadingIndicator:P,loadingPosition:_,size:k,type:A,variant:E},U=xje(D),B=(T||w&&_==="start")&&a.jsx(bje,{className:U.startIcon,ownerState:D,children:T||a.jsx(mR,{className:U.loadingIconPlaceholder,ownerState:D})}),R=(v||w&&_==="end")&&a.jsx(vje,{className:U.endIcon,ownerState:D,children:v||a.jsx(mR,{className:U.loadingIconPlaceholder,ownerState:D})}),q=r||"",Z=typeof w=="boolean"?a.jsx("span",{className:U.loadingWrapper,style:{display:"contents"},children:w&&a.jsx(wje,{className:U.loadingIndicator,ownerState:D,children:P})}):null;return a.jsxs(yje,{ownerState:D,className:$t(s.className,U.root,d,q),component:u,disabled:h||w,focusRipple:!x,focusVisibleClassName:$t(U.focusVisible,j),ref:n,type:A,id:w?z:N,...M,classes:U,children:[B,_!=="end"&&Z,l,_==="end"&&Z,R]})}),Nje={baseButton:jje,baseIconButton:fje},Cje={},Sje=at({},Nje,Cje),_je=f.createContext(null);function Aje(e){const{slots:t,slotProps:n={},defaultSlots:s,children:r}=e,i=f.useMemo(()=>({slots:at({},s,t),slotProps:n}),[s,t,n]);return a.jsx(_je.Provider,{value:i,children:r})}const Tje=["children","localeText","plugins","seriesConfig","slots","slotProps"],kje=e=>{const t=Ti({props:e,name:"MuiChartDataProvider"}),{children:n,localeText:s,plugins:r=EV,seriesConfig:i,slots:o,slotProps:l}=t,c=ya(t,Tje),u=Yo(),d={plugins:r,seriesConfig:i,pluginParams:at({theme:u.palette.mode},c)};return{children:n,localeText:s,chartProviderProps:d,slots:o,slotProps:l}};function Eje(e){const{children:t,localeText:n,chartProviderProps:s,slots:r,slotProps:i}=kje(e);return a.jsx($0e,at({},s,{children:a.jsx(Jxe,{localeText:n,children:a.jsx(Aje,{slots:r,slotProps:i,defaultSlots:Sje,children:t})})}))}function fR(e){const{isReversed:t,gradientId:n,size:s,direction:r,scale:i,colorMap:o}=e;return s<=0?null:a.jsx("linearGradient",{id:n,x1:"0",x2:"0",y1:"0",y2:"0",[`${r}${t?1:2}`]:`${s}px`,gradientUnits:"userSpaceOnUse",children:o.thresholds.map((l,c)=>{const u=i(l);if(u===void 0)return null;const d=t?1-u/s:u/s;return Number.isNaN(d)?null:a.jsxs(f.Fragment,{children:[a.jsx("stop",{offset:d,stopColor:o.colors[c],stopOpacity:1}),a.jsx("stop",{offset:d,stopColor:o.colors[c+1],stopOpacity:1})]},l.toString()+c)})})}const Lje=10;function hR(e){const{gradientUnits:t,isReversed:n,gradientId:s,size:r,direction:i,scale:o,colorScale:l,colorMap:c}=e,u=[c.min??0,c.max??100],d=u.map(o).filter(v=>v!==void 0);if(d.length!==2)return null;const h=typeof u[0]=="number"?kf(u[0],u[1]):r4(u[0],u[1]),p=Math.round((Math.max(...d)-Math.min(...d))/Lje),x=`${u[0]}-${u[1]}-`;return a.jsx("linearGradient",{id:s,x1:"0",x2:"0",y1:"0",y2:"0",[`${i}${n?1:2}`]:t==="objectBoundingBox"?1:`${r}px`,gradientUnits:t??"userSpaceOnUse",children:Array.from({length:p+1},(v,j)=>{const y=h(j/p);if(y===void 0)return null;const N=o(y);if(N===void 0)return null;const w=n?1-N/r:N/r,S=l(y);return S===null?null:a.jsx("stop",{offset:w,stopColor:S,stopOpacity:1},x+j)})})}const Pje=10,Dje=e=>e?{x1:"1",x2:"0",y1:"0",y2:"0"}:{x1:"0",x2:"1",y1:"0",y2:"0"};function P2(e){const{isReversed:t,gradientId:n,colorScale:s,colorMap:r}=e,i=[r.min??0,r.max??100],o=typeof i[0]=="number"?kf(i[0],i[1]):r4(i[0],i[1]),l=Pje,c=`${i[0]}-${i[1]}-`;return a.jsx("linearGradient",at({id:n},Dje(t),{gradientUnits:"objectBoundingBox",children:Array.from({length:l+1},(u,d)=>{const h=d/l,p=o(h);if(p===void 0)return null;const x=s(p);return x===null?null:a.jsx("stop",{offset:h,stopColor:x,stopOpacity:1},c+d)})}))}function Oje(){const{top:e,height:t,bottom:n,left:s,width:r,right:i}=Ei(),o=e+t+n,l=s+r+i,c=q4(),u=Dxe(),{xAxis:d,xAxisIds:h}=jr(),{yAxis:p,yAxisIds:x}=Nr(),{zAxis:v,zAxisIds:j}=U4(),y=x.filter(S=>p[S].colorMap!==void 0),N=h.filter(S=>d[S].colorMap!==void 0),w=j.filter(S=>v[S].colorMap!==void 0);return y.length===0&&N.length===0&&w.length===0?null:a.jsxs("defs",{children:[y.map(S=>{const _=c(S),k=u(S),{colorMap:T,scale:A,colorScale:E,reverse:M}=p[S];return T?.type==="piecewise"?a.jsx(fR,{isReversed:!M,scale:A,colorMap:T,size:o,gradientId:_,direction:"y"},_):T?.type==="continuous"?a.jsxs(f.Fragment,{children:[a.jsx(hR,{isReversed:!M,scale:A,colorScale:E,colorMap:T,size:o,gradientId:_,direction:"y"}),a.jsx(P2,{isReversed:M,colorScale:E,colorMap:T,gradientId:k})]},_):null}),N.map(S=>{const _=c(S),k=u(S),{colorMap:T,scale:A,reverse:E,colorScale:M}=d[S];return T?.type==="piecewise"?a.jsx(fR,{isReversed:E,scale:A,colorMap:T,size:l,gradientId:_,direction:"x"},_):T?.type==="continuous"?a.jsxs(f.Fragment,{children:[a.jsx(hR,{isReversed:E,scale:A,colorScale:M,colorMap:T,size:l,gradientId:_,direction:"x"}),a.jsx(P2,{isReversed:E,colorScale:M,colorMap:T,gradientId:k})]},_):null}),w.map(S=>{const _=u(S),{colorMap:k,colorScale:T}=v[S];return k?.type==="continuous"?a.jsx(P2,{colorScale:T,colorMap:k,gradientId:_},_):null})]})}function Mje(e){return Yn("MuiChartsSurface",e)}const Ije=()=>Vn({root:["root"]},Mje);An("MuiChartsSurface",["root"]);const $je=["children","className","title","desc"],Rje=fa("svg",{name:"MuiChartsSurface",slot:"Root"})(({ownerState:e,theme:t})=>({width:e.width??"100%",height:e.height??"100%",display:"flex",position:"relative",flexDirection:"column",alignItems:"center",justifyContent:"center",overflow:"hidden",touchAction:e.hasZoom?"pan-y":void 0,userSelect:"none",gridArea:"chart","&:focus":{outline:"none"},"&:focus-visible":{outline:`${(t.vars??t).palette.text.primary} solid 2px`,"&[data-has-focused-item=true]":{outline:"none"}},"& [data-focused=true]":{outline:`${(t.vars??t).palette.text.primary} solid 2px`}})),zje=f.forwardRef(function(t,n){const s=Ka(),r=Gt(s,vme),i=Gt(s,wme),o=Gt(s,cq),l=Gt(s,dq),c=Gt(s,rpe),u=Gt(s,spe),d=Gt(s,Rge),h=B4(),p=Uo(h,n),x=Ti({props:t,name:"MuiChartsSurface"}),{children:v,className:j,title:y,desc:N}=x,w=ya(x,$je),S=Ije(),_=i>0&&r>0;return a.jsxs(Rje,at({ownerState:{width:o,height:l,hasZoom:d},viewBox:`0 0 ${r} ${i}`,className:$t(S.root,j),tabIndex:c?0:void 0,"data-has-focused-item":u||void 0},w,{ref:p,children:[y&&a.jsx("title",{children:y}),N&&a.jsx("desc",{children:N}),a.jsx(Oje,{}),_&&v]}))}),gR=An("MuiChartsToolbar",["root"]),Fje=e=>e?.horizontal==="start"?"start":e?.horizontal==="end"?"end":"center",Uje=e=>e?.vertical==="top"?"flex-start":e?.vertical==="bottom"?"flex-end":"center",Bje=(e,t,n)=>e?'"chart"':t==="vertical"?n?.horizontal==="start"?'"legend chart"':'"chart legend"':n?.vertical==="bottom"?`"chart"
            "legend"`:`"legend"
          "chart"`,Hje=(e=!1,t="horizontal",n="end",s=void 0)=>{const r=s?"auto":"1fr";return t==="horizontal"||e?r:n==="start"?`auto ${r}`:`${r} auto`},qje=(e=!1,t="horizontal",n="top")=>t==="vertical"||e?"1fr":n==="bottom"?"1fr auto":"auto 1fr",Gje=fa("div",{name:"MuiChartsWrapper",slot:"Root",shouldForwardProp:e=>uv(e)&&e!=="extendVertically"&&e!=="width"})(({ownerState:e,width:t})=>{const n=Hje(e.hideLegend,e.legendDirection,e.legendPosition?.horizontal,t),s=qje(e.hideLegend,e.legendDirection,e.legendPosition?.vertical),r=Bje(e.hideLegend,e.legendDirection,e.legendPosition);return{variants:[{props:{extendVertically:!0},style:{height:"100%",minHeight:0}}],flex:1,display:"grid",gridTemplateColumns:n,gridTemplateRows:s,gridTemplateAreas:r,[`&:has(.${gR.root})`]:{gridTemplateRows:`auto ${s}`,gridTemplateAreas:`"${n.split(" ").map(()=>"toolbar").join(" ")}"
        ${r}`},[`& .${gR.root}`]:{gridArea:"toolbar",justifySelf:"center"},justifyContent:"safe center",justifyItems:Fje(e.legendPosition),alignItems:Uje(e.legendPosition)}});function Wje(e){const{children:t,sx:n,extendVertically:s}=e,r=Yxe(),i=Ka(),o=Gt(i,cq),l=Gt(i,dq);return a.jsx(Gje,{ref:r,ownerState:e,sx:n,extendVertically:s??l===void 0,width:o,children:t})}function Vje(){const e=Ka(),t=Gt(e,rN),n=Gt(e,iN),s=Gt(e,oN);return f.useMemo(()=>t===void 0||n===void 0||s===void 0?null:{seriesType:t,seriesId:n,dataIndex:s},[t,n,s])}const eb=6;function Yje(){const e=Yo(),t=Vje(),n=Ox(),{xAxis:s,xAxisIds:r}=jr(),{yAxis:i,yAxisIds:o}=Nr();if(t===null||t.seriesType!=="line"||!n)return null;const l=n?.series[t.seriesId],c=l.xAxisId??r[0],u=l.yAxisId??o[0];return a.jsx("rect",{fill:"none",stroke:(e.vars??e).palette.text.primary,strokeWidth:2,x:s[c].scale(s[c].data[t.dataIndex])-eb,y:i[u].scale(l.stackedData[t.dataIndex][1])-eb,width:2*eb,height:2*eb,rx:3,ry:3})}const lh=f.forwardRef(function(t,n){const s=Ti({props:t,name:"MuiLineChart"}),{chartsWrapperProps:r,chartContainerProps:i,gridProps:o,clipPathProps:l,clipPathGroupProps:c,areaPlotProps:u,linePlotProps:d,markPlotProps:h,overlayProps:p,chartsAxisProps:x,axisHighlightProps:v,lineHighlightPlotProps:j,legendProps:y,children:N}=qwe(s),{chartDataProviderProps:w,chartsSurfaceProps:S}=Vwe(i,n),_=s.slots?.tooltip??ewe,k=s.slots?.toolbar;return a.jsx(Eje,at({},w,{children:a.jsxs(Wje,at({},r,{children:[s.showToolbar&&k?a.jsx(k,at({},s.slotProps?.toolbar)):null,!s.hideLegend&&a.jsx(fwe,at({},y)),a.jsxs(zje,at({},S,{children:[a.jsx(Dwe,at({},o)),a.jsxs("g",at({},c,{children:[a.jsx(X0e,at({},u)),a.jsx(cye,at({},d)),a.jsx(Uwe,at({},p)),a.jsx(ywe,at({},v))]})),a.jsx(Yje,{}),a.jsx(obe,at({},x)),a.jsx("g",{"data-drawing-container":!0,children:a.jsx(yye,at({},h))}),a.jsx(_we,at({},j)),a.jsx(bwe,at({},l)),N]})),!s.loading&&a.jsx(_,at({},s.slotProps?.tooltip))]}))}))});function Qje(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return f.useMemo(()=>s=>{t.forEach(r=>r(s))},t)}const CN=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function ch(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function lP(e){return"nodeType"in e}function Js(e){var t,n;return e?ch(e)?e:lP(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function cP(e){const{Document:t}=Js(e);return e instanceof t}function Rx(e){return ch(e)?!1:e instanceof Js(e).HTMLElement}function DV(e){return e instanceof Js(e).SVGElement}function dh(e){return e?ch(e)?e.document:lP(e)?cP(e)?e:Rx(e)||DV(e)?e.ownerDocument:document:document:document}const Zi=CN?f.useLayoutEffect:f.useEffect;function SN(e){const t=f.useRef(e);return Zi(()=>{t.current=e}),f.useCallback(function(){for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return t.current==null?void 0:t.current(...s)},[])}function Kje(){const e=f.useRef(null),t=f.useCallback((s,r)=>{e.current=setInterval(s,r)},[]),n=f.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function Op(e,t){t===void 0&&(t=[e]);const n=f.useRef(e);return Zi(()=>{n.current!==e&&(n.current=e)},t),n}function zx(e,t){const n=f.useRef();return f.useMemo(()=>{const s=e(n.current);return n.current=s,s},[...t])}function nw(e){const t=SN(e),n=f.useRef(null),s=f.useCallback(r=>{r!==n.current&&t?.(r,n.current),n.current=r},[]);return[n,s]}function sw(e){const t=f.useRef();return f.useEffect(()=>{t.current=e},[e]),t.current}let D2={};function Fx(e,t){return f.useMemo(()=>{if(t)return t;const n=D2[e]==null?0:D2[e]+1;return D2[e]=n,e+"-"+n},[e,t])}function OV(e){return function(t){for(var n=arguments.length,s=new Array(n>1?n-1:0),r=1;r<n;r++)s[r-1]=arguments[r];return s.reduce((i,o)=>{const l=Object.entries(o);for(const[c,u]of l){const d=i[c];d!=null&&(i[c]=d+e*u)}return i},{...t})}}const jf=OV(1),Mp=OV(-1);function Xje(e){return"clientX"in e&&"clientY"in e}function _N(e){if(!e)return!1;const{KeyboardEvent:t}=Js(e.target);return t&&e instanceof t}function Zje(e){if(!e)return!1;const{TouchEvent:t}=Js(e.target);return t&&e instanceof t}function rw(e){if(Zje(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return Xje(e)?{x:e.clientX,y:e.clientY}:null}const pd=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[pd.Translate.toString(e),pd.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:s}=e;return t+" "+n+"ms "+s}}}),pR="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function Jje(e){return e.matches(pR)?e:e.querySelector(pR)}const eNe={display:"none"};function tNe(e){let{id:t,value:n}=e;return wt.createElement("div",{id:t,style:eNe},n)}function aNe(e){let{id:t,announcement:n,ariaLiveType:s="assertive"}=e;const r={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return wt.createElement("div",{id:t,style:r,role:"status","aria-live":s,"aria-atomic":!0},n)}function nNe(){const[e,t]=f.useState("");return{announce:f.useCallback(s=>{s!=null&&t(s)},[]),announcement:e}}const MV=f.createContext(null);function sNe(e){const t=f.useContext(MV);f.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function rNe(){const[e]=f.useState(()=>new Set),t=f.useCallback(s=>(e.add(s),()=>e.delete(s)),[e]);return[f.useCallback(s=>{let{type:r,event:i}=s;e.forEach(o=>{var l;return(l=o[r])==null?void 0:l.call(o,i)})},[e]),t]}const iNe={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},oNe={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function lNe(e){let{announcements:t=oNe,container:n,hiddenTextDescribedById:s,screenReaderInstructions:r=iNe}=e;const{announce:i,announcement:o}=nNe(),l=Fx("DndLiveRegion"),[c,u]=f.useState(!1);if(f.useEffect(()=>{u(!0)},[]),sNe(f.useMemo(()=>({onDragStart(h){let{active:p}=h;i(t.onDragStart({active:p}))},onDragMove(h){let{active:p,over:x}=h;t.onDragMove&&i(t.onDragMove({active:p,over:x}))},onDragOver(h){let{active:p,over:x}=h;i(t.onDragOver({active:p,over:x}))},onDragEnd(h){let{active:p,over:x}=h;i(t.onDragEnd({active:p,over:x}))},onDragCancel(h){let{active:p,over:x}=h;i(t.onDragCancel({active:p,over:x}))}}),[i,t])),!c)return null;const d=wt.createElement(wt.Fragment,null,wt.createElement(tNe,{id:s,value:r.draggable}),wt.createElement(aNe,{id:l,announcement:o}));return n?Gi.createPortal(d,n):d}var as;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(as||(as={}));function iw(){}function Ff(e,t){return f.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function Ux(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return f.useMemo(()=>[...t].filter(s=>s!=null),[...t])}const Ji=Object.freeze({x:0,y:0});function IV(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function cNe(e,t){const n=rw(e);if(!n)return"0 0";const s={x:(n.x-t.left)/t.width*100,y:(n.y-t.top)/t.height*100};return s.x+"% "+s.y+"%"}function $V(e,t){let{data:{value:n}}=e,{data:{value:s}}=t;return n-s}function dNe(e,t){let{data:{value:n}}=e,{data:{value:s}}=t;return s-n}function xR(e){let{left:t,top:n,height:s,width:r}=e;return[{x:t,y:n},{x:t+r,y:n},{x:t,y:n+s},{x:t+r,y:n+s}]}function RV(e,t){if(!e||e.length===0)return null;const[n]=e;return n[t]}function yR(e,t,n){return t===void 0&&(t=e.left),n===void 0&&(n=e.top),{x:t+e.width*.5,y:n+e.height*.5}}const Bx=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:s}=e;const r=yR(t,t.left,t.top),i=[];for(const o of s){const{id:l}=o,c=n.get(l);if(c){const u=IV(yR(c),r);i.push({id:l,data:{droppableContainer:o,value:u}})}}return i.sort($V)},uNe=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:s}=e;const r=xR(t),i=[];for(const o of s){const{id:l}=o,c=n.get(l);if(c){const u=xR(c),d=r.reduce((p,x,v)=>p+IV(u[v],x),0),h=Number((d/4).toFixed(4));i.push({id:l,data:{droppableContainer:o,value:h}})}}return i.sort($V)};function mNe(e,t){const n=Math.max(t.top,e.top),s=Math.max(t.left,e.left),r=Math.min(t.left+t.width,e.left+e.width),i=Math.min(t.top+t.height,e.top+e.height),o=r-s,l=i-n;if(s<r&&n<i){const c=t.width*t.height,u=e.width*e.height,d=o*l,h=d/(c+u-d);return Number(h.toFixed(4))}return 0}const fNe=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:s}=e;const r=[];for(const i of s){const{id:o}=i,l=n.get(o);if(l){const c=mNe(l,t);c>0&&r.push({id:o,data:{droppableContainer:i,value:c}})}}return r.sort(dNe)};function hNe(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}function zV(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:Ji}function gNe(e){return function(n){for(var s=arguments.length,r=new Array(s>1?s-1:0),i=1;i<s;i++)r[i-1]=arguments[i];return r.reduce((o,l)=>({...o,top:o.top+e*l.y,bottom:o.bottom+e*l.y,left:o.left+e*l.x,right:o.right+e*l.x}),{...n})}}const pNe=gNe(1);function FV(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function xNe(e,t,n){const s=FV(t);if(!s)return e;const{scaleX:r,scaleY:i,x:o,y:l}=s,c=e.left-o-(1-r)*parseFloat(n),u=e.top-l-(1-i)*parseFloat(n.slice(n.indexOf(" ")+1)),d=r?e.width/r:e.width,h=i?e.height/i:e.height;return{width:d,height:h,top:u,right:c+d,bottom:u+h,left:c}}const yNe={ignoreTransform:!1};function uh(e,t){t===void 0&&(t=yNe);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:u,transformOrigin:d}=Js(e).getComputedStyle(e);u&&(n=xNe(n,u,d))}const{top:s,left:r,width:i,height:o,bottom:l,right:c}=n;return{top:s,left:r,width:i,height:o,bottom:l,right:c}}function bR(e){return uh(e,{ignoreTransform:!0})}function bNe(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function vNe(e,t){return t===void 0&&(t=Js(e).getComputedStyle(e)),t.position==="fixed"}function wNe(e,t){t===void 0&&(t=Js(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(r=>{const i=t[r];return typeof i=="string"?n.test(i):!1})}function AN(e,t){const n=[];function s(r){if(t!=null&&n.length>=t||!r)return n;if(cP(r)&&r.scrollingElement!=null&&!n.includes(r.scrollingElement))return n.push(r.scrollingElement),n;if(!Rx(r)||DV(r)||n.includes(r))return n;const i=Js(e).getComputedStyle(r);return r!==e&&wNe(r,i)&&n.push(r),vNe(r,i)?n:s(r.parentNode)}return e?s(e):n}function UV(e){const[t]=AN(e,1);return t??null}function O2(e){return!CN||!e?null:ch(e)?e:lP(e)?cP(e)||e===dh(e).scrollingElement?window:Rx(e)?e:null:null}function BV(e){return ch(e)?e.scrollX:e.scrollLeft}function HV(e){return ch(e)?e.scrollY:e.scrollTop}function Vk(e){return{x:BV(e),y:HV(e)}}var gs;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(gs||(gs={}));function qV(e){return!CN||!e?!1:e===document.scrollingElement}function GV(e){const t={x:0,y:0},n=qV(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},s={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},r=e.scrollTop<=t.y,i=e.scrollLeft<=t.x,o=e.scrollTop>=s.y,l=e.scrollLeft>=s.x;return{isTop:r,isLeft:i,isBottom:o,isRight:l,maxScroll:s,minScroll:t}}const jNe={x:.2,y:.2};function NNe(e,t,n,s,r){let{top:i,left:o,right:l,bottom:c}=n;s===void 0&&(s=10),r===void 0&&(r=jNe);const{isTop:u,isBottom:d,isLeft:h,isRight:p}=GV(e),x={x:0,y:0},v={x:0,y:0},j={height:t.height*r.y,width:t.width*r.x};return!u&&i<=t.top+j.height?(x.y=gs.Backward,v.y=s*Math.abs((t.top+j.height-i)/j.height)):!d&&c>=t.bottom-j.height&&(x.y=gs.Forward,v.y=s*Math.abs((t.bottom-j.height-c)/j.height)),!p&&l>=t.right-j.width?(x.x=gs.Forward,v.x=s*Math.abs((t.right-j.width-l)/j.width)):!h&&o<=t.left+j.width&&(x.x=gs.Backward,v.x=s*Math.abs((t.left+j.width-o)/j.width)),{direction:x,speed:v}}function CNe(e){if(e===document.scrollingElement){const{innerWidth:i,innerHeight:o}=window;return{top:0,left:0,right:i,bottom:o,width:i,height:o}}const{top:t,left:n,right:s,bottom:r}=e.getBoundingClientRect();return{top:t,left:n,right:s,bottom:r,width:e.clientWidth,height:e.clientHeight}}function WV(e){return e.reduce((t,n)=>jf(t,Vk(n)),Ji)}function SNe(e){return e.reduce((t,n)=>t+BV(n),0)}function _Ne(e){return e.reduce((t,n)=>t+HV(n),0)}function VV(e,t){if(t===void 0&&(t=uh),!e)return;const{top:n,left:s,bottom:r,right:i}=t(e);UV(e)&&(r<=0||i<=0||n>=window.innerHeight||s>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const ANe=[["x",["left","right"],SNe],["y",["top","bottom"],_Ne]];class dP{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const s=AN(n),r=WV(s);this.rect={...t},this.width=t.width,this.height=t.height;for(const[i,o,l]of ANe)for(const c of o)Object.defineProperty(this,c,{get:()=>{const u=l(s),d=r[i]-u;return this.rect[c]+d},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class rp{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var s;return(s=this.target)==null?void 0:s.removeEventListener(...n)})},this.target=t}add(t,n,s){var r;(r=this.target)==null||r.addEventListener(t,n,s),this.listeners.push([t,n,s])}}function TNe(e){const{EventTarget:t}=Js(e);return e instanceof t?e:dh(e)}function M2(e,t){const n=Math.abs(e.x),s=Math.abs(e.y);return typeof t=="number"?Math.sqrt(n**2+s**2)>t:"x"in t&&"y"in t?n>t.x&&s>t.y:"x"in t?n>t.x:"y"in t?s>t.y:!1}var fi;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(fi||(fi={}));function vR(e){e.preventDefault()}function kNe(e){e.stopPropagation()}var va;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(va||(va={}));const YV={start:[va.Space,va.Enter],cancel:[va.Esc],end:[va.Space,va.Enter,va.Tab]},ENe=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case va.Right:return{...n,x:n.x+25};case va.Left:return{...n,x:n.x-25};case va.Down:return{...n,y:n.y+25};case va.Up:return{...n,y:n.y-25}}};class uP{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new rp(dh(n)),this.windowListeners=new rp(Js(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(fi.Resize,this.handleCancel),this.windowListeners.add(fi.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(fi.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,s=t.node.current;s&&VV(s),n(Ji)}handleKeyDown(t){if(_N(t)){const{active:n,context:s,options:r}=this.props,{keyboardCodes:i=YV,coordinateGetter:o=ENe,scrollBehavior:l="smooth"}=r,{code:c}=t;if(i.end.includes(c)){this.handleEnd(t);return}if(i.cancel.includes(c)){this.handleCancel(t);return}const{collisionRect:u}=s.current,d=u?{x:u.left,y:u.top}:Ji;this.referenceCoordinates||(this.referenceCoordinates=d);const h=o(t,{active:n,context:s.current,currentCoordinates:d});if(h){const p=Mp(h,d),x={x:0,y:0},{scrollableAncestors:v}=s.current;for(const j of v){const y=t.code,{isTop:N,isRight:w,isLeft:S,isBottom:_,maxScroll:k,minScroll:T}=GV(j),A=CNe(j),E={x:Math.min(y===va.Right?A.right-A.width/2:A.right,Math.max(y===va.Right?A.left:A.left+A.width/2,h.x)),y:Math.min(y===va.Down?A.bottom-A.height/2:A.bottom,Math.max(y===va.Down?A.top:A.top+A.height/2,h.y))},M=y===va.Right&&!w||y===va.Left&&!S,z=y===va.Down&&!_||y===va.Up&&!N;if(M&&E.x!==h.x){const P=j.scrollLeft+p.x,D=y===va.Right&&P<=k.x||y===va.Left&&P>=T.x;if(D&&!p.y){j.scrollTo({left:P,behavior:l});return}D?x.x=j.scrollLeft-P:x.x=y===va.Right?j.scrollLeft-k.x:j.scrollLeft-T.x,x.x&&j.scrollBy({left:-x.x,behavior:l});break}else if(z&&E.y!==h.y){const P=j.scrollTop+p.y,D=y===va.Down&&P<=k.y||y===va.Up&&P>=T.y;if(D&&!p.x){j.scrollTo({top:P,behavior:l});return}D?x.y=j.scrollTop-P:x.y=y===va.Down?j.scrollTop-k.y:j.scrollTop-T.y,x.y&&j.scrollBy({top:-x.y,behavior:l});break}}this.handleMove(t,jf(Mp(h,this.referenceCoordinates),x))}}}handleMove(t,n){const{onMove:s}=this.props;t.preventDefault(),s(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}uP.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:s=YV,onActivation:r}=t,{active:i}=n;const{code:o}=e.nativeEvent;if(s.start.includes(o)){const l=i.activatorNode.current;return l&&e.target!==l?!1:(e.preventDefault(),r?.({event:e.nativeEvent}),!0)}return!1}}];function wR(e){return!!(e&&"distance"in e)}function jR(e){return!!(e&&"delay"in e)}class mP{constructor(t,n,s){var r;s===void 0&&(s=TNe(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:i}=t,{target:o}=i;this.props=t,this.events=n,this.document=dh(o),this.documentListeners=new rp(this.document),this.listeners=new rp(s),this.windowListeners=new rp(Js(o)),this.initialCoordinates=(r=rw(i))!=null?r:Ji,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n,bypassActivationConstraint:s}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(fi.Resize,this.handleCancel),this.windowListeners.add(fi.DragStart,vR),this.windowListeners.add(fi.VisibilityChange,this.handleCancel),this.windowListeners.add(fi.ContextMenu,vR),this.documentListeners.add(fi.Keydown,this.handleKeydown),n){if(s!=null&&s({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(jR(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(wR(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,n){const{active:s,onPending:r}=this.props;r(s,t,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(fi.Click,kNe,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(fi.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:s,initialCoordinates:r,props:i}=this,{onMove:o,options:{activationConstraint:l}}=i;if(!r)return;const c=(n=rw(t))!=null?n:Ji,u=Mp(r,c);if(!s&&l){if(wR(l)){if(l.tolerance!=null&&M2(u,l.tolerance))return this.handleCancel();if(M2(u,l.distance))return this.handleStart()}if(jR(l)&&M2(u,l.tolerance))return this.handleCancel();this.handlePending(l,u);return}t.cancelable&&t.preventDefault(),o(c)}handleEnd(){const{onAbort:t,onEnd:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleCancel(){const{onAbort:t,onCancel:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleKeydown(t){t.code===va.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const LNe={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class sm extends mP{constructor(t){const{event:n}=t,s=dh(n.target);super(t,LNe,s)}}sm.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:s}=t;return!n.isPrimary||n.button!==0?!1:(s?.({event:n}),!0)}}];const PNe={move:{name:"mousemove"},end:{name:"mouseup"}};var Yk;(function(e){e[e.RightClick=2]="RightClick"})(Yk||(Yk={}));class DNe extends mP{constructor(t){super(t,PNe,dh(t.event.target))}}DNe.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:s}=t;return n.button===Yk.RightClick?!1:(s?.({event:n}),!0)}}];const I2={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class ONe extends mP{constructor(t){super(t,I2)}static setup(){return window.addEventListener(I2.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(I2.move.name,t)};function t(){}}}ONe.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:s}=t;const{touches:r}=n;return r.length>1?!1:(s?.({event:n}),!0)}}];var ip;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(ip||(ip={}));var ow;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(ow||(ow={}));function MNe(e){let{acceleration:t,activator:n=ip.Pointer,canScroll:s,draggingRect:r,enabled:i,interval:o=5,order:l=ow.TreeOrder,pointerCoordinates:c,scrollableAncestors:u,scrollableAncestorRects:d,delta:h,threshold:p}=e;const x=$Ne({delta:h,disabled:!i}),[v,j]=Kje(),y=f.useRef({x:0,y:0}),N=f.useRef({x:0,y:0}),w=f.useMemo(()=>{switch(n){case ip.Pointer:return c?{top:c.y,bottom:c.y,left:c.x,right:c.x}:null;case ip.DraggableRect:return r}},[n,r,c]),S=f.useRef(null),_=f.useCallback(()=>{const T=S.current;if(!T)return;const A=y.current.x*N.current.x,E=y.current.y*N.current.y;T.scrollBy(A,E)},[]),k=f.useMemo(()=>l===ow.TreeOrder?[...u].reverse():u,[l,u]);f.useEffect(()=>{if(!i||!u.length||!w){j();return}for(const T of k){if(s?.(T)===!1)continue;const A=u.indexOf(T),E=d[A];if(!E)continue;const{direction:M,speed:z}=NNe(T,E,w,t,p);for(const P of["x","y"])x[P][M[P]]||(z[P]=0,M[P]=0);if(z.x>0||z.y>0){j(),S.current=T,v(_,o),y.current=z,N.current=M;return}}y.current={x:0,y:0},N.current={x:0,y:0},j()},[t,_,s,j,i,o,JSON.stringify(w),JSON.stringify(x),v,u,k,d,JSON.stringify(p)])}const INe={x:{[gs.Backward]:!1,[gs.Forward]:!1},y:{[gs.Backward]:!1,[gs.Forward]:!1}};function $Ne(e){let{delta:t,disabled:n}=e;const s=sw(t);return zx(r=>{if(n||!s||!r)return INe;const i={x:Math.sign(t.x-s.x),y:Math.sign(t.y-s.y)};return{x:{[gs.Backward]:r.x[gs.Backward]||i.x===-1,[gs.Forward]:r.x[gs.Forward]||i.x===1},y:{[gs.Backward]:r.y[gs.Backward]||i.y===-1,[gs.Forward]:r.y[gs.Forward]||i.y===1}}},[n,t,s])}function RNe(e,t){const n=t!=null?e.get(t):void 0,s=n?n.node.current:null;return zx(r=>{var i;return t==null?null:(i=s??r)!=null?i:null},[s,t])}function zNe(e,t){return f.useMemo(()=>e.reduce((n,s)=>{const{sensor:r}=s,i=r.activators.map(o=>({eventName:o.eventName,handler:t(o.handler,s)}));return[...n,...i]},[]),[e,t])}var Ip;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(Ip||(Ip={}));var Qk;(function(e){e.Optimized="optimized"})(Qk||(Qk={}));const NR=new Map;function FNe(e,t){let{dragging:n,dependencies:s,config:r}=t;const[i,o]=f.useState(null),{frequency:l,measure:c,strategy:u}=r,d=f.useRef(e),h=y(),p=Op(h),x=f.useCallback(function(N){N===void 0&&(N=[]),!p.current&&o(w=>w===null?N:w.concat(N.filter(S=>!w.includes(S))))},[p]),v=f.useRef(null),j=zx(N=>{if(h&&!n)return NR;if(!N||N===NR||d.current!==e||i!=null){const w=new Map;for(let S of e){if(!S)continue;if(i&&i.length>0&&!i.includes(S.id)&&S.rect.current){w.set(S.id,S.rect.current);continue}const _=S.node.current,k=_?new dP(c(_),_):null;S.rect.current=k,k&&w.set(S.id,k)}return w}return N},[e,i,n,h,c]);return f.useEffect(()=>{d.current=e},[e]),f.useEffect(()=>{h||x()},[n,h]),f.useEffect(()=>{i&&i.length>0&&o(null)},[JSON.stringify(i)]),f.useEffect(()=>{h||typeof l!="number"||v.current!==null||(v.current=setTimeout(()=>{x(),v.current=null},l))},[l,h,x,...s]),{droppableRects:j,measureDroppableContainers:x,measuringScheduled:i!=null};function y(){switch(u){case Ip.Always:return!1;case Ip.BeforeDragging:return n;default:return!n}}}function fP(e,t){return zx(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function UNe(e,t){return fP(e,t)}function BNe(e){let{callback:t,disabled:n}=e;const s=SN(t),r=f.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:i}=window;return new i(s)},[s,n]);return f.useEffect(()=>()=>r?.disconnect(),[r]),r}function TN(e){let{callback:t,disabled:n}=e;const s=SN(t),r=f.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:i}=window;return new i(s)},[n]);return f.useEffect(()=>()=>r?.disconnect(),[r]),r}function HNe(e){return new dP(uh(e),e)}function CR(e,t,n){t===void 0&&(t=HNe);const[s,r]=f.useState(null);function i(){r(c=>{if(!e)return null;if(e.isConnected===!1){var u;return(u=c??n)!=null?u:null}const d=t(e);return JSON.stringify(c)===JSON.stringify(d)?c:d})}const o=BNe({callback(c){if(e)for(const u of c){const{type:d,target:h}=u;if(d==="childList"&&h instanceof HTMLElement&&h.contains(e)){i();break}}}}),l=TN({callback:i});return Zi(()=>{i(),e?(l?.observe(e),o?.observe(document.body,{childList:!0,subtree:!0})):(l?.disconnect(),o?.disconnect())},[e]),s}function qNe(e){const t=fP(e);return zV(e,t)}const SR=[];function GNe(e){const t=f.useRef(e),n=zx(s=>e?s&&s!==SR&&e&&t.current&&e.parentNode===t.current.parentNode?s:AN(e):SR,[e]);return f.useEffect(()=>{t.current=e},[e]),n}function WNe(e){const[t,n]=f.useState(null),s=f.useRef(e),r=f.useCallback(i=>{const o=O2(i.target);o&&n(l=>l?(l.set(o,Vk(o)),new Map(l)):null)},[]);return f.useEffect(()=>{const i=s.current;if(e!==i){o(i);const l=e.map(c=>{const u=O2(c);return u?(u.addEventListener("scroll",r,{passive:!0}),[u,Vk(u)]):null}).filter(c=>c!=null);n(l.length?new Map(l):null),s.current=e}return()=>{o(e),o(i)};function o(l){l.forEach(c=>{const u=O2(c);u?.removeEventListener("scroll",r)})}},[r,e]),f.useMemo(()=>e.length?t?Array.from(t.values()).reduce((i,o)=>jf(i,o),Ji):WV(e):Ji,[e,t])}function _R(e,t){t===void 0&&(t=[]);const n=f.useRef(null);return f.useEffect(()=>{n.current=null},t),f.useEffect(()=>{const s=e!==Ji;s&&!n.current&&(n.current=e),!s&&n.current&&(n.current=null)},[e]),n.current?Mp(e,n.current):Ji}function VNe(e){f.useEffect(()=>{if(!CN)return;const t=e.map(n=>{let{sensor:s}=n;return s.setup==null?void 0:s.setup()});return()=>{for(const n of t)n?.()}},e.map(t=>{let{sensor:n}=t;return n}))}function YNe(e,t){return f.useMemo(()=>e.reduce((n,s)=>{let{eventName:r,handler:i}=s;return n[r]=o=>{i(o,t)},n},{}),[e,t])}function QV(e){return f.useMemo(()=>e?bNe(e):null,[e])}const AR=[];function QNe(e,t){t===void 0&&(t=uh);const[n]=e,s=QV(n?Js(n):null),[r,i]=f.useState(AR);function o(){i(()=>e.length?e.map(c=>qV(c)?s:new dP(t(c),c)):AR)}const l=TN({callback:o});return Zi(()=>{l?.disconnect(),o(),e.forEach(c=>l?.observe(c))},[e]),r}function KV(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return Rx(t)?t:e}function KNe(e){let{measure:t}=e;const[n,s]=f.useState(null),r=f.useCallback(u=>{for(const{target:d}of u)if(Rx(d)){s(h=>{const p=t(d);return h?{...h,width:p.width,height:p.height}:p});break}},[t]),i=TN({callback:r}),o=f.useCallback(u=>{const d=KV(u);i?.disconnect(),d&&i?.observe(d),s(d?t(d):null)},[t,i]),[l,c]=nw(o);return f.useMemo(()=>({nodeRef:l,rect:n,setRef:c}),[n,l,c])}const XNe=[{sensor:sm,options:{}},{sensor:uP,options:{}}],ZNe={current:{}},hv={draggable:{measure:bR},droppable:{measure:bR,strategy:Ip.WhileDragging,frequency:Qk.Optimized},dragOverlay:{measure:uh}};class op extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,s;return(n=(s=this.get(t))==null?void 0:s.node.current)!=null?n:void 0}}const JNe={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new op,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:iw},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:hv,measureDroppableContainers:iw,windowRect:null,measuringScheduled:!1},XV={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:iw,draggableNodes:new Map,over:null,measureDroppableContainers:iw},Hx=f.createContext(XV),ZV=f.createContext(JNe);function e1e(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new op}}}function t1e(e,t){switch(t.type){case as.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case as.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case as.DragEnd:case as.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case as.RegisterDroppable:{const{element:n}=t,{id:s}=n,r=new op(e.droppable.containers);return r.set(s,n),{...e,droppable:{...e.droppable,containers:r}}}case as.SetDroppableDisabled:{const{id:n,key:s,disabled:r}=t,i=e.droppable.containers.get(n);if(!i||s!==i.key)return e;const o=new op(e.droppable.containers);return o.set(n,{...i,disabled:r}),{...e,droppable:{...e.droppable,containers:o}}}case as.UnregisterDroppable:{const{id:n,key:s}=t,r=e.droppable.containers.get(n);if(!r||s!==r.key)return e;const i=new op(e.droppable.containers);return i.delete(n),{...e,droppable:{...e.droppable,containers:i}}}default:return e}}function a1e(e){let{disabled:t}=e;const{active:n,activatorEvent:s,draggableNodes:r}=f.useContext(Hx),i=sw(s),o=sw(n?.id);return f.useEffect(()=>{if(!t&&!s&&i&&o!=null){if(!_N(i)||document.activeElement===i.target)return;const l=r.get(o);if(!l)return;const{activatorNode:c,node:u}=l;if(!c.current&&!u.current)return;requestAnimationFrame(()=>{for(const d of[c.current,u.current]){if(!d)continue;const h=Jje(d);if(h){h.focus();break}}})}},[s,t,r,o,i]),null}function JV(e,t){let{transform:n,...s}=t;return e!=null&&e.length?e.reduce((r,i)=>i({transform:r,...s}),n):n}function n1e(e){return f.useMemo(()=>({draggable:{...hv.draggable,...e?.draggable},droppable:{...hv.droppable,...e?.droppable},dragOverlay:{...hv.dragOverlay,...e?.dragOverlay}}),[e?.draggable,e?.droppable,e?.dragOverlay])}function s1e(e){let{activeNode:t,measure:n,initialRect:s,config:r=!0}=e;const i=f.useRef(!1),{x:o,y:l}=typeof r=="boolean"?{x:r,y:r}:r;Zi(()=>{if(!o&&!l||!t){i.current=!1;return}if(i.current||!s)return;const u=t?.node.current;if(!u||u.isConnected===!1)return;const d=n(u),h=zV(d,s);if(o||(h.x=0),l||(h.y=0),i.current=!0,Math.abs(h.x)>0||Math.abs(h.y)>0){const p=UV(u);p&&p.scrollBy({top:h.y,left:h.x})}},[t,o,l,s,n])}const kN=f.createContext({...Ji,scaleX:1,scaleY:1});var Vc;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(Vc||(Vc={}));const qx=f.memo(function(t){var n,s,r,i;let{id:o,accessibility:l,autoScroll:c=!0,children:u,sensors:d=XNe,collisionDetection:h=fNe,measuring:p,modifiers:x,...v}=t;const j=f.useReducer(t1e,void 0,e1e),[y,N]=j,[w,S]=rNe(),[_,k]=f.useState(Vc.Uninitialized),T=_===Vc.Initialized,{draggable:{active:A,nodes:E,translate:M},droppable:{containers:z}}=y,P=A!=null?E.get(A):null,D=f.useRef({initial:null,translated:null}),U=f.useMemo(()=>{var Nt;return A!=null?{id:A,data:(Nt=P?.data)!=null?Nt:ZNe,rect:D}:null},[A,P]),B=f.useRef(null),[R,q]=f.useState(null),[Z,V]=f.useState(null),oe=Op(v,Object.values(v)),je=Fx("DndDescribedBy",o),X=f.useMemo(()=>z.getEnabled(),[z]),se=n1e(p),{droppableRects:ye,measureDroppableContainers:Ne,measuringScheduled:fe}=FNe(X,{dragging:T,dependencies:[M.x,M.y],config:se.droppable}),we=RNe(E,A),de=f.useMemo(()=>Z?rw(Z):null,[Z]),ke=Tt(),ge=UNe(we,se.draggable.measure);s1e({activeNode:A!=null?E.get(A):null,config:ke.layoutShiftCompensation,initialRect:ge,measure:se.draggable.measure});const $e=CR(we,se.draggable.measure,ge),be=CR(we?we.parentElement:null),me=f.useRef({activatorEvent:null,active:null,activeNode:we,collisionRect:null,collisions:null,droppableRects:ye,draggableNodes:E,draggingNode:null,draggingNodeRect:null,droppableContainers:z,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),Ue=z.getNodeFor((n=me.current.over)==null?void 0:n.id),Ee=KNe({measure:se.dragOverlay.measure}),We=(s=Ee.nodeRef.current)!=null?s:we,tt=T?(r=Ee.rect)!=null?r:$e:null,lt=!!(Ee.nodeRef.current&&Ee.rect),Fe=qNe(lt?null:$e),st=QV(We?Js(We):null),Xe=GNe(T?Ue??we:null),Ze=QNe(Xe),Je=JV(x,{transform:{x:M.x-Fe.x,y:M.y-Fe.y,scaleX:1,scaleY:1},activatorEvent:Z,active:U,activeNodeRect:$e,containerNodeRect:be,draggingNodeRect:tt,over:me.current.over,overlayNodeRect:Ee.rect,scrollableAncestors:Xe,scrollableAncestorRects:Ze,windowRect:st}),Be=de?jf(de,M):null,_e=WNe(Xe),pe=_R(_e),ce=_R(_e,[$e]),Q=jf(Je,pe),ne=tt?pNe(tt,Je):null,ae=U&&ne?h({active:U,collisionRect:ne,droppableRects:ye,droppableContainers:X,pointerCoordinates:Be}):null,Pe=RV(ae,"id"),[Te,he]=f.useState(null),He=lt?Je:jf(Je,ce),qe=hNe(He,(i=Te?.rect)!=null?i:null,$e),nt=f.useRef(null),ot=f.useCallback((Nt,xe)=>{let{sensor:ve,options:Oe}=xe;if(B.current==null)return;const Ce=E.get(B.current);if(!Ce)return;const Qe=Nt.nativeEvent,G=new ve({active:B.current,activeNode:Ce,event:Qe,options:Oe,context:me,onAbort(J){if(!E.get(J))return;const{onDragAbort:F}=oe.current,ue={id:J};F?.(ue),w({type:"onDragAbort",event:ue})},onPending(J,Y,F,ue){if(!E.get(J))return;const{onDragPending:le}=oe.current,Ie={id:J,constraint:Y,initialCoordinates:F,offset:ue};le?.(Ie),w({type:"onDragPending",event:Ie})},onStart(J){const Y=B.current;if(Y==null)return;const F=E.get(Y);if(!F)return;const{onDragStart:ue}=oe.current,De={activatorEvent:Qe,active:{id:Y,data:F.data,rect:D}};Gi.unstable_batchedUpdates(()=>{ue?.(De),k(Vc.Initializing),N({type:as.DragStart,initialCoordinates:J,active:Y}),w({type:"onDragStart",event:De}),q(nt.current),V(Qe)})},onMove(J){N({type:as.DragMove,coordinates:J})},onEnd:W(as.DragEnd),onCancel:W(as.DragCancel)});nt.current=G;function W(J){return async function(){const{active:F,collisions:ue,over:De,scrollAdjustedTranslate:le}=me.current;let Ie=null;if(F&&le){const{cancelDrop:K}=oe.current;Ie={activatorEvent:Qe,active:F,collisions:ue,delta:le,over:De},J===as.DragEnd&&typeof K=="function"&&await Promise.resolve(K(Ie))&&(J=as.DragCancel)}B.current=null,Gi.unstable_batchedUpdates(()=>{N({type:J}),k(Vc.Uninitialized),he(null),q(null),V(null),nt.current=null;const K=J===as.DragEnd?"onDragEnd":"onDragCancel";if(Ie){const ie=oe.current[K];ie?.(Ie),w({type:K,event:Ie})}})}}},[E]),Re=f.useCallback((Nt,xe)=>(ve,Oe)=>{const Ce=ve.nativeEvent,Qe=E.get(Oe);if(B.current!==null||!Qe||Ce.dndKit||Ce.defaultPrevented)return;const G={active:Qe};Nt(ve,xe.options,G)===!0&&(Ce.dndKit={capturedBy:xe.sensor},B.current=Oe,ot(ve,xe))},[E,ot]),it=zNe(d,Re);VNe(d),Zi(()=>{$e&&_===Vc.Initializing&&k(Vc.Initialized)},[$e,_]),f.useEffect(()=>{const{onDragMove:Nt}=oe.current,{active:xe,activatorEvent:ve,collisions:Oe,over:Ce}=me.current;if(!xe||!ve)return;const Qe={active:xe,activatorEvent:ve,collisions:Oe,delta:{x:Q.x,y:Q.y},over:Ce};Gi.unstable_batchedUpdates(()=>{Nt?.(Qe),w({type:"onDragMove",event:Qe})})},[Q.x,Q.y]),f.useEffect(()=>{const{active:Nt,activatorEvent:xe,collisions:ve,droppableContainers:Oe,scrollAdjustedTranslate:Ce}=me.current;if(!Nt||B.current==null||!xe||!Ce)return;const{onDragOver:Qe}=oe.current,G=Oe.get(Pe),W=G&&G.rect.current?{id:G.id,rect:G.rect.current,data:G.data,disabled:G.disabled}:null,J={active:Nt,activatorEvent:xe,collisions:ve,delta:{x:Ce.x,y:Ce.y},over:W};Gi.unstable_batchedUpdates(()=>{he(W),Qe?.(J),w({type:"onDragOver",event:J})})},[Pe]),Zi(()=>{me.current={activatorEvent:Z,active:U,activeNode:we,collisionRect:ne,collisions:ae,droppableRects:ye,draggableNodes:E,draggingNode:We,draggingNodeRect:tt,droppableContainers:z,over:Te,scrollableAncestors:Xe,scrollAdjustedTranslate:Q},D.current={initial:tt,translated:ne}},[U,we,ae,ne,E,We,tt,ye,z,Te,Xe,Q]),MNe({...ke,delta:M,draggingRect:ne,pointerCoordinates:Be,scrollableAncestors:Xe,scrollableAncestorRects:Ze});const St=f.useMemo(()=>({active:U,activeNode:we,activeNodeRect:$e,activatorEvent:Z,collisions:ae,containerNodeRect:be,dragOverlay:Ee,draggableNodes:E,droppableContainers:z,droppableRects:ye,over:Te,measureDroppableContainers:Ne,scrollableAncestors:Xe,scrollableAncestorRects:Ze,measuringConfiguration:se,measuringScheduled:fe,windowRect:st}),[U,we,$e,Z,ae,be,Ee,E,z,ye,Te,Ne,Xe,Ze,se,fe,st]),Et=f.useMemo(()=>({activatorEvent:Z,activators:it,active:U,activeNodeRect:$e,ariaDescribedById:{draggable:je},dispatch:N,draggableNodes:E,over:Te,measureDroppableContainers:Ne}),[Z,it,U,$e,N,je,E,Te,Ne]);return wt.createElement(MV.Provider,{value:S},wt.createElement(Hx.Provider,{value:Et},wt.createElement(ZV.Provider,{value:St},wt.createElement(kN.Provider,{value:qe},u)),wt.createElement(a1e,{disabled:l?.restoreFocus===!1})),wt.createElement(lNe,{...l,hiddenTextDescribedById:je}));function Tt(){const Nt=R?.autoScrollEnabled===!1,xe=typeof c=="object"?c.enabled===!1:c===!1,ve=T&&!Nt&&!xe;return typeof c=="object"?{...c,enabled:ve}:{enabled:ve}}}),r1e=f.createContext(null),TR="button",i1e="Draggable";function Gx(e){let{id:t,data:n,disabled:s=!1,attributes:r}=e;const i=Fx(i1e),{activators:o,activatorEvent:l,active:c,activeNodeRect:u,ariaDescribedById:d,draggableNodes:h,over:p}=f.useContext(Hx),{role:x=TR,roleDescription:v="draggable",tabIndex:j=0}=r??{},y=c?.id===t,N=f.useContext(y?kN:r1e),[w,S]=nw(),[_,k]=nw(),T=YNe(o,t),A=Op(n);Zi(()=>(h.set(t,{id:t,key:i,node:w,activatorNode:_,data:A}),()=>{const M=h.get(t);M&&M.key===i&&h.delete(t)}),[h,t]);const E=f.useMemo(()=>({role:x,tabIndex:j,"aria-disabled":s,"aria-pressed":y&&x===TR?!0:void 0,"aria-roledescription":v,"aria-describedby":d.draggable}),[s,x,j,y,v,d.draggable]);return{active:c,activatorEvent:l,activeNodeRect:u,attributes:E,isDragging:y,listeners:s?void 0:T,node:w,over:p,setNodeRef:S,setActivatorNodeRef:k,transform:N}}function eY(){return f.useContext(ZV)}const o1e="Droppable",l1e={timeout:25};function Wx(e){let{data:t,disabled:n=!1,id:s,resizeObserverConfig:r}=e;const i=Fx(o1e),{active:o,dispatch:l,over:c,measureDroppableContainers:u}=f.useContext(Hx),d=f.useRef({disabled:n}),h=f.useRef(!1),p=f.useRef(null),x=f.useRef(null),{disabled:v,updateMeasurementsFor:j,timeout:y}={...l1e,...r},N=Op(j??s),w=f.useCallback(()=>{if(!h.current){h.current=!0;return}x.current!=null&&clearTimeout(x.current),x.current=setTimeout(()=>{u(Array.isArray(N.current)?N.current:[N.current]),x.current=null},y)},[y]),S=TN({callback:w,disabled:v||!o}),_=f.useCallback((E,M)=>{S&&(M&&(S.unobserve(M),h.current=!1),E&&S.observe(E))},[S]),[k,T]=nw(_),A=Op(t);return f.useEffect(()=>{!S||!k.current||(S.disconnect(),h.current=!1,S.observe(k.current))},[k,S]),f.useEffect(()=>(l({type:as.RegisterDroppable,element:{id:s,key:i,disabled:n,node:k,rect:p,data:A}}),()=>l({type:as.UnregisterDroppable,key:i,id:s})),[s]),f.useEffect(()=>{n!==d.current.disabled&&(l({type:as.SetDroppableDisabled,id:s,key:i,disabled:n}),d.current.disabled=n)},[s,i,n,l]),{active:o,rect:p,isOver:c?.id===s,node:k,over:c,setNodeRef:T}}function c1e(e){let{animation:t,children:n}=e;const[s,r]=f.useState(null),[i,o]=f.useState(null),l=sw(n);return!n&&!s&&l&&r(l),Zi(()=>{if(!i)return;const c=s?.key,u=s?.props.id;if(c==null||u==null){r(null);return}Promise.resolve(t(u,i)).then(()=>{r(null)})},[t,s,i]),wt.createElement(wt.Fragment,null,n,s?f.cloneElement(s,{ref:o}):null)}const d1e={x:0,y:0,scaleX:1,scaleY:1};function u1e(e){let{children:t}=e;return wt.createElement(Hx.Provider,{value:XV},wt.createElement(kN.Provider,{value:d1e},t))}const m1e={position:"fixed",touchAction:"none"},f1e=e=>_N(e)?"transform 250ms ease":void 0,h1e=f.forwardRef((e,t)=>{let{as:n,activatorEvent:s,adjustScale:r,children:i,className:o,rect:l,style:c,transform:u,transition:d=f1e}=e;if(!l)return null;const h=r?u:{...u,scaleX:1,scaleY:1},p={...m1e,width:l.width,height:l.height,top:l.top,left:l.left,transform:pd.Transform.toString(h),transformOrigin:r&&s?cNe(s,l):void 0,transition:typeof d=="function"?d(s):d,...c};return wt.createElement(n,{className:o,style:p,ref:t},i)}),g1e=e=>t=>{let{active:n,dragOverlay:s}=t;const r={},{styles:i,className:o}=e;if(i!=null&&i.active)for(const[l,c]of Object.entries(i.active))c!==void 0&&(r[l]=n.node.style.getPropertyValue(l),n.node.style.setProperty(l,c));if(i!=null&&i.dragOverlay)for(const[l,c]of Object.entries(i.dragOverlay))c!==void 0&&s.node.style.setProperty(l,c);return o!=null&&o.active&&n.node.classList.add(o.active),o!=null&&o.dragOverlay&&s.node.classList.add(o.dragOverlay),function(){for(const[c,u]of Object.entries(r))n.node.style.setProperty(c,u);o!=null&&o.active&&n.node.classList.remove(o.active)}},p1e=e=>{let{transform:{initial:t,final:n}}=e;return[{transform:pd.Transform.toString(t)},{transform:pd.Transform.toString(n)}]},x1e={duration:250,easing:"ease",keyframes:p1e,sideEffects:g1e({styles:{active:{opacity:"0"}}})};function y1e(e){let{config:t,draggableNodes:n,droppableContainers:s,measuringConfiguration:r}=e;return SN((i,o)=>{if(t===null)return;const l=n.get(i);if(!l)return;const c=l.node.current;if(!c)return;const u=KV(o);if(!u)return;const{transform:d}=Js(o).getComputedStyle(o),h=FV(d);if(!h)return;const p=typeof t=="function"?t:b1e(t);return VV(c,r.draggable.measure),p({active:{id:i,data:l.data,node:c,rect:r.draggable.measure(c)},draggableNodes:n,dragOverlay:{node:o,rect:r.dragOverlay.measure(u)},droppableContainers:s,measuringConfiguration:r,transform:h})})}function b1e(e){const{duration:t,easing:n,sideEffects:s,keyframes:r}={...x1e,...e};return i=>{let{active:o,dragOverlay:l,transform:c,...u}=i;if(!t)return;const d={x:l.rect.left-o.rect.left,y:l.rect.top-o.rect.top},h={scaleX:c.scaleX!==1?o.rect.width*c.scaleX/l.rect.width:1,scaleY:c.scaleY!==1?o.rect.height*c.scaleY/l.rect.height:1},p={x:c.x-d.x,y:c.y-d.y,...h},x=r({...u,active:o,dragOverlay:l,transform:{initial:c,final:p}}),[v]=x,j=x[x.length-1];if(JSON.stringify(v)===JSON.stringify(j))return;const y=s?.({active:o,dragOverlay:l,...u}),N=l.node.animate(x,{duration:t,easing:n,fill:"forwards"});return new Promise(w=>{N.onfinish=()=>{y?.(),w()}})}}let kR=0;function v1e(e){return f.useMemo(()=>{if(e!=null)return kR++,kR},[e])}const EN=wt.memo(e=>{let{adjustScale:t=!1,children:n,dropAnimation:s,style:r,transition:i,modifiers:o,wrapperElement:l="div",className:c,zIndex:u=999}=e;const{activatorEvent:d,active:h,activeNodeRect:p,containerNodeRect:x,draggableNodes:v,droppableContainers:j,dragOverlay:y,over:N,measuringConfiguration:w,scrollableAncestors:S,scrollableAncestorRects:_,windowRect:k}=eY(),T=f.useContext(kN),A=v1e(h?.id),E=JV(o,{activatorEvent:d,active:h,activeNodeRect:p,containerNodeRect:x,draggingNodeRect:y.rect,over:N,overlayNodeRect:y.rect,scrollableAncestors:S,scrollableAncestorRects:_,transform:T,windowRect:k}),M=fP(p),z=y1e({config:s,draggableNodes:v,droppableContainers:j,measuringConfiguration:w}),P=M?y.setRef:void 0;return wt.createElement(u1e,null,wt.createElement(c1e,{animation:z},h&&A?wt.createElement(h1e,{key:A,id:h.id,ref:P,as:l,activatorEvent:d,adjustScale:t,className:c,transition:i,rect:M,style:{zIndex:u,...r},transform:E},n):null))});function hP(e,t,n){const s=e.slice();return s.splice(n<0?s.length+n:n,0,s.splice(t,1)[0]),s}function w1e(e,t){return e.reduce((n,s,r)=>{const i=t.get(s);return i&&(n[r]=i),n},Array(e.length))}function tb(e){return e!==null&&e>=0}function j1e(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function N1e(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const gP=e=>{let{rects:t,activeIndex:n,overIndex:s,index:r}=e;const i=hP(t,s,n),o=t[r],l=i[r];return!l||!o?null:{x:l.left-o.left,y:l.top-o.top,scaleX:l.width/o.width,scaleY:l.height/o.height}},tY="Sortable",aY=wt.createContext({activeIndex:-1,containerId:tY,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:gP,disabled:{draggable:!1,droppable:!1}});function C1e(e){let{children:t,id:n,items:s,strategy:r=gP,disabled:i=!1}=e;const{active:o,dragOverlay:l,droppableRects:c,over:u,measureDroppableContainers:d}=eY(),h=Fx(tY,n),p=l.rect!==null,x=f.useMemo(()=>s.map(T=>typeof T=="object"&&"id"in T?T.id:T),[s]),v=o!=null,j=o?x.indexOf(o.id):-1,y=u?x.indexOf(u.id):-1,N=f.useRef(x),w=!j1e(x,N.current),S=y!==-1&&j===-1||w,_=N1e(i);Zi(()=>{w&&v&&d(x)},[w,x,v,d]),f.useEffect(()=>{N.current=x},[x]);const k=f.useMemo(()=>({activeIndex:j,containerId:h,disabled:_,disableTransforms:S,items:x,overIndex:y,useDragOverlay:p,sortedRects:w1e(x,c),strategy:r}),[j,h,_.draggable,_.droppable,S,x,y,c,p,r]);return wt.createElement(aY.Provider,{value:k},t)}const S1e=e=>{let{id:t,items:n,activeIndex:s,overIndex:r}=e;return hP(n,s,r).indexOf(t)},_1e=e=>{let{containerId:t,isSorting:n,wasDragging:s,index:r,items:i,newIndex:o,previousItems:l,previousContainerId:c,transition:u}=e;return!u||!s||l!==i&&r===o?!1:n?!0:o!==r&&t===c},A1e={duration:200,easing:"ease"},nY="transform",T1e=pd.Transition.toString({property:nY,duration:0,easing:"linear"}),k1e={roleDescription:"sortable"};function E1e(e){let{disabled:t,index:n,node:s,rect:r}=e;const[i,o]=f.useState(null),l=f.useRef(n);return Zi(()=>{if(!t&&n!==l.current&&s.current){const c=r.current;if(c){const u=uh(s.current,{ignoreTransform:!0}),d={x:c.left-u.left,y:c.top-u.top,scaleX:c.width/u.width,scaleY:c.height/u.height};(d.x||d.y)&&o(d)}}n!==l.current&&(l.current=n)},[t,n,s,r]),f.useEffect(()=>{i&&o(null)},[i]),i}function L1e(e){let{animateLayoutChanges:t=_1e,attributes:n,disabled:s,data:r,getNewIndex:i=S1e,id:o,strategy:l,resizeObserverConfig:c,transition:u=A1e}=e;const{items:d,containerId:h,activeIndex:p,disabled:x,disableTransforms:v,sortedRects:j,overIndex:y,useDragOverlay:N,strategy:w}=f.useContext(aY),S=P1e(s,x),_=d.indexOf(o),k=f.useMemo(()=>({sortable:{containerId:h,index:_,items:d},...r}),[h,r,_,d]),T=f.useMemo(()=>d.slice(d.indexOf(o)),[d,o]),{rect:A,node:E,isOver:M,setNodeRef:z}=Wx({id:o,data:k,disabled:S.droppable,resizeObserverConfig:{updateMeasurementsFor:T,...c}}),{active:P,activatorEvent:D,activeNodeRect:U,attributes:B,setNodeRef:R,listeners:q,isDragging:Z,over:V,setActivatorNodeRef:oe,transform:je}=Gx({id:o,data:k,attributes:{...k1e,...n},disabled:S.draggable}),X=Qje(z,R),se=!!P,ye=se&&!v&&tb(p)&&tb(y),Ne=!N&&Z,fe=Ne&&ye?je:null,de=ye?fe??(l??w)({rects:j,activeNodeRect:U,activeIndex:p,overIndex:y,index:_}):null,ke=tb(p)&&tb(y)?i({id:o,items:d,activeIndex:p,overIndex:y}):_,ge=P?.id,$e=f.useRef({activeId:ge,items:d,newIndex:ke,containerId:h}),be=d!==$e.current.items,me=t({active:P,containerId:h,isDragging:Z,isSorting:se,id:o,index:_,items:d,newIndex:$e.current.newIndex,previousItems:$e.current.items,previousContainerId:$e.current.containerId,transition:u,wasDragging:$e.current.activeId!=null}),Ue=E1e({disabled:!me,index:_,node:E,rect:A});return f.useEffect(()=>{se&&$e.current.newIndex!==ke&&($e.current.newIndex=ke),h!==$e.current.containerId&&($e.current.containerId=h),d!==$e.current.items&&($e.current.items=d)},[se,ke,h,d]),f.useEffect(()=>{if(ge===$e.current.activeId)return;if(ge!=null&&$e.current.activeId==null){$e.current.activeId=ge;return}const We=setTimeout(()=>{$e.current.activeId=ge},50);return()=>clearTimeout(We)},[ge]),{active:P,activeIndex:p,attributes:B,data:k,rect:A,index:_,newIndex:ke,items:d,isOver:M,isSorting:se,isDragging:Z,listeners:q,node:E,overIndex:y,over:V,setNodeRef:X,setActivatorNodeRef:oe,setDroppableNodeRef:z,setDraggableNodeRef:R,transform:Ue??de,transition:Ee()};function Ee(){if(Ue||be&&$e.current.newIndex===_)return T1e;if(!(Ne&&!_N(D)||!u)&&(se||me))return pd.Transition.toString({...u,property:nY})}}function P1e(e,t){var n,s;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e?.draggable)!=null?n:t.draggable,droppable:(s=e?.droppable)!=null?s:t.droppable}}function lw(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&typeof t.sortable=="object"&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const D1e=[va.Down,va.Right,va.Up,va.Left],O1e=(e,t)=>{let{context:{active:n,collisionRect:s,droppableRects:r,droppableContainers:i,over:o,scrollableAncestors:l}}=t;if(D1e.includes(e.code)){if(e.preventDefault(),!n||!s)return;const c=[];i.getEnabled().forEach(h=>{if(!h||h!=null&&h.disabled)return;const p=r.get(h.id);if(p)switch(e.code){case va.Down:s.top<p.top&&c.push(h);break;case va.Up:s.top>p.top&&c.push(h);break;case va.Left:s.left>p.left&&c.push(h);break;case va.Right:s.left<p.left&&c.push(h);break}});const u=uNe({collisionRect:s,droppableRects:r,droppableContainers:c});let d=RV(u,"id");if(d===o?.id&&u.length>1&&(d=u[1].id),d!=null){const h=i.get(n.id),p=i.get(d),x=p?r.get(p.id):null,v=p?.node.current;if(v&&x&&h&&p){const y=AN(v).some((T,A)=>l[A]!==T),N=sY(h,p),w=M1e(h,p),S=y||!N?{x:0,y:0}:{x:w?s.width-x.width:0,y:w?s.height-x.height:0},_={x:x.left,y:x.top};return S.x&&S.y?_:Mp(_,S)}}}};function sY(e,t){return!lw(e)||!lw(t)?!1:e.data.current.sortable.containerId===t.data.current.sortable.containerId}function M1e(e,t){return!lw(e)||!lw(t)||!sY(e,t)?!1:e.data.current.sortable.index<t.data.current.sortable.index}const Ro=(e,t="")=>`${t} ${new Intl.NumberFormat("en-US",{minimumFractionDigits:0}).format(e||0)}`,Kk=e=>e?new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"",I1e=e=>{if(!e)return 0;const t=new Date-new Date(e);return Math.floor(t/(1e3*60*60*24))},$1e=(e,t)=>{if(!e||e.length===0)return;const n=e.map(c=>({ID:c.id,Name:c.name||`${c.first_name} ${c.last_name}`,Company:c.company_name||c.account?.name||"",Stage:c.stage||c.status,Amount:c.amount||0,Date:Kk(c.created_at)})),s=Object.keys(n[0]).join(","),r=n.map(c=>Object.values(c).map(u=>typeof u=="string"?`"${u.replace(/"/g,'""')}"`:u).join(",")),i="data:text/csv;charset=utf-8,"+[s,...r].join(`
`),o=encodeURI(i),l=document.createElement("a");l.setAttribute("href",o),l.setAttribute("download",`${t}.csv`),document.body.appendChild(l),l.click(),document.body.removeChild(l)},Xk=({label:e,count:t,value:n,width:s,color:r,onClick:i,isActive:o,isLead:l,weightedValue:c,currencySymbol:u,conversionRate:d,compact:h=!1})=>a.jsxs("div",{className:"flex flex-col items-center w-full",children:[d&&a.jsx("div",{className:`flex justify-center relative z-0 ${h?"-my-1":"-my-2 mb-1"}`,children:a.jsxs("div",{className:`bg-gray-100 text-gray-500 font-bold rounded-full border border-white shadow-sm flex items-center ${h?"text-[8px] px-1.5":"text-[10px] px-2 py-0.5"}`,children:[a.jsx(ak,{className:"mr-1"})," ",d,"%"]})}),a.jsxs("div",{onClick:i,className:`w-full relative group cursor-pointer transition-all duration-300 transform ${o?"scale-105 z-10":"hover:scale-102 hover:opacity-90"}`,children:[a.jsxs("div",{className:"flex justify-between items-end mb-1 px-1",children:[a.jsx("span",{className:`${h?"text-[10px]":"text-xs"} font-bold uppercase tracking-wider ${o?"text-blue-700":"text-gray-500"}`,children:e}),a.jsx("span",{className:`${h?"text-[10px]":"text-xs"} text-gray-400`,children:t})]}),a.jsxs("div",{className:`${h?"h-6":"h-10"} w-full bg-gray-100 rounded-r-lg overflow-hidden flex items-center relative shadow-sm`,children:[a.jsx("div",{className:`h-full ${r} transition-all duration-700 ease-out flex items-center px-2 text-white font-bold relative overflow-hidden`,style:{width:s},children:a.jsx("span",{className:`z-10 drop-shadow-md ${h?"text-xs":"text-sm"}`,children:l?t:Ro(n,u)})}),!l&&c>0&&a.jsx("div",{className:"absolute left-0 top-0 h-full bg-white opacity-20 z-20",style:{width:`${c/n*parseFloat(s)}%`}})]})]})]}),R1e=({id:e,children:t})=>{const{attributes:n,listeners:s,setNodeRef:r,transform:i,transition:o,isDragging:l}=L1e({id:e}),c={transform:pd.Transform.toString(i),transition:o,zIndex:l?50:"auto",opacity:l?.5:1,position:"relative"};return a.jsx("div",{ref:r,style:c,className:"h-full",children:wt.cloneElement(t,{dragHandleProps:{...n,...s}})})},z1e=({user:e,metrics:t,stages:n,currencySymbol:s,target:r,dragHandleProps:i})=>{const o=t.metrics.CLOSED_WON?.value||0,l=t.metrics.CLOSED_LOST?.value||0,c=t.metrics.CLOSED_WON.count+t.metrics.CLOSED_LOST.count,u=c>0?(t.metrics.CLOSED_WON.count/c*100).toFixed(0):0,d=r>0?o/r*100:0;return a.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-md border border-gray-100 flex flex-col h-full hover:shadow-lg transition-shadow relative group",children:[a.jsxs("div",{className:"flex flex-col mb-4 pb-4 border-b border-gray-100",children:[a.jsxs("div",{className:"flex items-start justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center text-blue-600 font-bold mr-3 flex-shrink-0",children:e.name.charAt(0)}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-bold text-gray-800 text-sm",children:e.name}),a.jsxs("div",{className:"flex gap-2 text-[10px] mt-1",children:[a.jsxs("span",{className:"text-green-600 bg-green-50 px-1.5 py-0.5 rounded border border-green-100",children:["Win: ",u,"%"]}),a.jsxs("span",{className:"text-red-600 bg-red-50 px-1.5 py-0.5 rounded border border-red-100",children:["Lost: ",Ro(l,s)]})]})]})]}),i&&a.jsx("button",{...i,className:"p-1.5 text-gray-300 hover:text-blue-500 hover:bg-blue-50 rounded-md cursor-grab active:cursor-grabbing transition-colors touch-none",title:"Drag to reorder",children:a.jsx(toe,{size:16})})]}),r>0?a.jsxs("div",{className:"w-full mt-2 bg-gray-50 p-2 rounded-lg border border-gray-100",children:[a.jsxs("div",{className:"flex justify-between items-center text-[10px] text-gray-500 mb-1",children:[a.jsx("span",{className:"font-semibold text-gray-600",children:"Target Achievement"}),a.jsxs("span",{className:d>=100?"text-green-600 font-bold":"text-blue-600 font-bold",children:[d.toFixed(0),"%"]})]}),a.jsx("div",{className:"w-full h-2 bg-gray-200 rounded-full overflow-hidden mb-1",children:a.jsx("div",{className:`h-full rounded-full transition-all duration-1000 ${d>=100?"bg-green-500":"bg-blue-500"}`,style:{width:`${Math.min(d,100)}%`}})}),a.jsxs("div",{className:"flex justify-between text-[9px] text-gray-400",children:[a.jsxs("span",{children:["Achieved: ",a.jsx("span",{className:"text-gray-700 font-medium",children:Ro(o,s)})]}),a.jsxs("span",{children:["Target: ",Ro(r,s)]})]})]}):a.jsx("div",{className:"text-[10px] text-gray-400 italic mt-1 text-center bg-gray-50 p-1 rounded",children:"No target assigned"})]}),a.jsx("div",{className:"flex-grow space-y-2",children:n.map((h,p)=>{const x=t.metrics[h.key];let v=null;if(p>0){const j=n[p-1].key,y=t.metrics[j].count;y>0&&(v=(x.count/y*100).toFixed(0))}return a.jsx(Xk,{label:h.label,count:x.count,value:x.value,width:x.width,color:x.color,isLead:!h.isDeal,weightedValue:x.weightedValue,currencySymbol:s,conversionRate:v,compact:!0,onClick:()=>{},isActive:!1},h.key)})})]})},F1e=({data:e,stageKey:t,currencySymbol:n,basePath:s="/admin"})=>{const r=kt(),[i,o]=f.useState({key:null,direction:"desc"}),l=t==="LEADS",c=t==="CLOSED_WON",u=t==="CLOSED_LOST",d=!l&&!c&&!u,h=f.useMemo(()=>i.key?[...e].sort((v,j)=>{let y=v[i.key],N=j[i.key];return(i.key==="amount"||i.key==="probability")&&(y=parseFloat(v[i.key]||0),N=parseFloat(j[i.key]||0)),y<N?i.direction==="asc"?-1:1:y>N?i.direction==="asc"?1:-1:0}):e,[e,i]),p=v=>{o({key:v,direction:i.key===v&&i.direction==="desc"?"asc":"desc"})},x=({columnKey:v})=>i.key!==v?a.jsx(ak,{className:"inline ml-1 opacity-0 group-hover:opacity-30"}):i.direction==="asc"?a.jsx(Wie,{className:"inline ml-1 text-blue-600"}):a.jsx(ak,{className:"inline ml-1 text-blue-600"});return!e||e.length===0?a.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-gray-400 bg-gray-50 rounded-xl border-2 border-dashed border-gray-200",children:[a.jsx(NL,{size:48,className:"mb-4 opacity-50"}),a.jsx("p",{className:"font-medium",children:"No records in this stage"})]}):a.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden flex flex-col h-full",children:a.jsx("div",{className:"overflow-x-auto flex-grow",children:a.jsxs("table",{className:"w-full text-left border-collapse",children:[a.jsx("thead",{className:"bg-gray-50 sticky top-0 z-10",children:a.jsxs("tr",{children:[a.jsxs("th",{className:"p-4 text-xs font-bold text-gray-500 uppercase tracking-wider cursor-pointer group",onClick:()=>p("name"),children:["Name ",a.jsx(x,{columnKey:"name"})]}),a.jsx("th",{className:"p-4 text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Company"}),l&&a.jsx("th",{className:"p-4 text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Contact Info"}),d&&a.jsxs(a.Fragment,{children:[a.jsxs("th",{className:"p-4 text-xs font-bold text-gray-500 uppercase tracking-wider text-right cursor-pointer group",onClick:()=>p("amount"),children:["Value ",a.jsx(x,{columnKey:"amount"})]}),a.jsxs("th",{className:"p-4 text-xs font-bold text-gray-500 uppercase tracking-wider text-center cursor-pointer group",onClick:()=>p("probability"),children:["Prob. ",a.jsx(x,{columnKey:"probability"})]}),a.jsx("th",{className:"p-4 text-xs font-bold text-gray-500 uppercase tracking-wider text-center",children:"Age"})]}),c&&a.jsxs("th",{className:"p-4 text-xs font-bold text-gray-500 uppercase tracking-wider text-right text-green-600 cursor-pointer group",onClick:()=>p("amount"),children:["Booked ",a.jsx(x,{columnKey:"amount"})]}),u&&a.jsxs(a.Fragment,{children:[a.jsxs("th",{className:"p-4 text-xs font-bold text-gray-500 uppercase tracking-wider text-right text-red-600 cursor-pointer group",onClick:()=>p("amount"),children:["Lost Value ",a.jsx(x,{columnKey:"amount"})]}),a.jsx("th",{className:"p-4 text-xs font-bold text-gray-500 uppercase tracking-wider text-center",children:"Lost Date"})]}),a.jsx("th",{className:"p-4 text-xs font-bold text-gray-500 uppercase tracking-wider text-right",children:"Owner"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-100",children:h.map(v=>{const j=l?0:I1e(v.stage_updated_at||v.created_at),y=j>30&&d;return a.jsxs("tr",{className:"hover:bg-blue-50 transition-colors cursor-pointer group",onClick:()=>r(l?`${s}/leads/${v.id}`:`${s}/deals/info?id=${v.id}`),children:[a.jsxs("td",{className:"p-4",children:[a.jsx("p",{className:"font-bold text-gray-800 text-sm group-hover:text-blue-600 transition-colors",children:l?`${v.first_name} ${v.last_name}`:v.name}),a.jsx("p",{className:"text-xs text-gray-400 mt-0.5",children:Kk(v.created_at)})]}),a.jsx("td",{className:"p-4 text-sm text-gray-600",children:l?v.company_name:v.account?.name}),l&&a.jsxs("td",{className:"p-4 text-xs text-gray-500",children:[v.email&&a.jsxs("div",{className:"flex items-center mb-1",children:[a.jsx(rn,{className:"mr-1"})," ",v.email]}),v.phone&&a.jsxs("div",{className:"flex items-center",children:[a.jsx(It,{className:"mr-1"})," ",v.phone]})]}),d&&a.jsxs(a.Fragment,{children:[a.jsx("td",{className:"p-4 text-right font-medium text-gray-700",children:Ro(v.amount,n)}),a.jsx("td",{className:"p-4 text-center",children:a.jsxs("span",{className:`inline-block px-2 py-1 rounded text-xs font-bold ${v.probability>=80?"bg-green-100 text-green-700":v.probability>=50?"bg-yellow-100 text-yellow-700":"bg-gray-100 text-gray-600"}`,children:[v.probability,"%"]})}),a.jsx("td",{className:"p-4 text-center",children:y?a.jsxs("div",{className:"flex items-center justify-center text-red-600 bg-red-50 px-2 py-1 rounded border border-red-100",title:"Stuck for >30 days",children:[a.jsx(Yi,{size:14,className:"mr-1"}),a.jsxs("span",{className:"text-xs font-bold",children:[j,"d"]})]}):a.jsxs("span",{className:"text-xs text-gray-400",children:[j,"d"]})})]}),c&&a.jsx("td",{className:"p-4 text-right font-bold text-green-700",children:Ro(v.amount,n)}),u&&a.jsxs(a.Fragment,{children:[a.jsx("td",{className:"p-4 text-right font-bold text-red-600 opacity-75",children:Ro(v.amount,n)}),a.jsx("td",{className:"p-4 text-center text-xs text-gray-500",children:Kk(v.stage_updated_at)})]}),a.jsx("td",{className:"p-4 text-right",children:a.jsxs("div",{className:"flex items-center justify-end text-gray-500 text-xs",children:[a.jsx(ra,{className:"mr-1"}),l?v.lead_owner?.first_name||v.owner?.first_name||v.assigned_to?.first_name||"Unassigned":v.assigned_deals?.first_name||v.deal_creator?.first_name||"Unassigned"]})})]},v.id)})})]})})})},LN=({leads:e,deals:t,currencySymbol:n,targets:s=[],basePath:r="/admin",currentUser:i=null})=>{const[o,l]=f.useState("ALL"),[c,u]=f.useState("ALL"),[d,h]=f.useState("ALL"),[p,x]=f.useState("AGGREGATE"),v=i?i.id.toString():d,j=!!i,[y,N]=f.useState([]),w=Ux(Ff(sm,{activationConstraint:{distance:5}}),Ff(uP,{coordinateGetter:O1e})),S=f.useMemo(()=>{const P=new Date;if(c==="THIS_MONTH")return{start:new Date(P.getFullYear(),P.getMonth(),1),end:new Date(P.getFullYear(),P.getMonth()+1,0)};if(c==="THIS_QUARTER"){const D=Math.floor(P.getMonth()/3)*3;return{start:new Date(P.getFullYear(),D,1),end:new Date(P.getFullYear(),D+3,0)}}return c==="THIS_YEAR"?{start:new Date(P.getFullYear(),0,1),end:new Date(P.getFullYear(),11,31)}:null},[c]),_=f.useMemo(()=>s.filter(P=>{if(d!=="ALL"){const D=P.user?.id||P.user_id||P.assigned_to;if(parseInt(D)!==parseInt(d))return!1}if(S){const D=new Date(P.start_date),U=new Date(P.end_date);return D<=S.end&&U>=S.start}return!0}),[s,d,S]),k=f.useMemo(()=>{const P=new Map,D=U=>{U&&U.id&&P.set(U.id,`${U.first_name} ${U.last_name}`)};return e.forEach(U=>D(U.lead_owner||U.owner||U.assigned_to)),t.forEach(U=>{D(U.assigned_deals),D(U.deal_creator)}),Array.from(P.entries()).map(([U,B])=>({id:U,name:B}))},[e,t]),T=f.useMemo(()=>{const P=new Date;let D=null;c==="THIS_MONTH"?D=new Date(P.getFullYear(),P.getMonth(),1):c==="THIS_QUARTER"?D=new Date(P.getFullYear(),Math.floor(P.getMonth()/3)*3,1):c==="THIS_YEAR"&&(D=new Date(P.getFullYear(),0,1));const U=je=>{const X=new Date(je.created_at);if(D&&X<D)return!1;if(v!=="ALL"){const se=parseInt(v);return!!(je.lead_owner&&(je.lead_owner.id||je.lead_owner)===se||je.assigned_to?.id===se||je.owner?.id===se||je.assigned_deals?.id===se||je.created_by===se)}return!0},B=e.filter(U),R=t.filter(U),q=[{key:"LEADS",label:"Top Leads",color:"bg-blue-400",isDeal:!1},{key:"PROSPECTING",label:"Prospecting",color:"bg-blue-600",isDeal:!0},{key:"QUALIFICATION",label:"Qualification",color:"bg-indigo-600",isDeal:!0},{key:"PROPOSAL",label:"Proposal",color:"bg-purple-600",isDeal:!0},{key:"NEGOTIATION",label:"Negotiation",color:"bg-pink-600",isDeal:!0},{key:"CLOSED_WON",label:"Closed Won",color:"bg-emerald-500",isDeal:!0},{key:"CLOSED_LOST",label:"Closed Lost",color:"bg-red-500",isDeal:!0}],Z=(je,X)=>{const se=q.reduce((Ne,fe)=>(Ne[fe.key]={...fe,count:0,value:0,weightedValue:0,items:[]},Ne),{});se.LEADS.count=je.length,se.LEADS.items=je,X.forEach(Ne=>{const fe=(Ne.stage||"").toUpperCase();if(se[fe]){se[fe].count++,se[fe].items.push(Ne);const we=parseFloat(Ne.amount||0);se[fe].value+=we,se[fe].weightedValue+=we*((Ne.probability||0)/100)}});const ye=Math.max(...Object.values(se).map(Ne=>Ne.count),1);return Object.keys(se).forEach(Ne=>{const fe=se[Ne];fe.width=fe.count===0?"0%":`${Math.max(fe.count/ye*100,15)}%`}),{metrics:se,filteredDeals:X,filteredLeads:je}},V=Z(B,R),oe=[];return p==="COMPARE"&&(v==="ALL"?k:k.filter(X=>X.id===parseInt(v))).forEach(X=>{const se=parseInt(X.id),ye=B.filter(de=>(de.lead_owner?.id||de.lead_owner||de.assigned_to?.id||de.owner?.id)===se),Ne=R.filter(de=>(de.assigned_deals?.id||de.created_by)===se),fe=_.find(de=>{const ke=de.user?.id||de.user_id||de.assigned_to;return parseInt(ke)===se}),we=parseFloat(fe?.amount||fe?.target_amount||fe?.value||0);(ye.length>0||Ne.length>0||we>0)&&oe.push({user:X,data:Z(ye,Ne),target:we})}),{stages:q,aggregate:V,userGroups:oe}},[t,e,c,v,p,k,_]),A=f.useMemo(()=>{if(!T.userGroups.length)return[];const P=[...T.userGroups];return y.length>0&&P.sort((D,U)=>{const B=y.indexOf(D.user.id),R=y.indexOf(U.user.id);return B!==-1&&R!==-1?B-R:B!==-1?-1:R!==-1?1:0}),P},[T.userGroups,y]),E=P=>{const{active:D,over:U}=P;D.id!==U.id&&N(()=>{const B=A.map(Z=>Z.user.id),R=B.indexOf(D.id),q=B.indexOf(U.id);return hP(B,R,q)})},M=f.useMemo(()=>{const P=_.reduce((se,ye)=>se+parseFloat(ye.amount||ye.target_amount||ye.value||0),0),D=T.aggregate.metrics,U=D.CLOSED_WON?.value||0,B=D.CLOSED_WON?.count||0,R=D.CLOSED_LOST?.value||0,q=D.CLOSED_LOST?.count||0,Z=D.LEADS?.count||0,V=P>0?U/P*100:0,oe=B+q,je=oe>0?B/oe*100:0,X=Z>0?B/Z*100:0;return{totalTarget:P,totalWon:U,totalLost:R,progress:V,winRate:je,conversionRate:X}},[_,T]),z=f.useMemo(()=>o==="ALL"?[]:T.aggregate.metrics[o]?.items||[],[o,T]);return a.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-100 p-6 flex flex-col h-full",children:[a.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mb-6",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-bold text-gray-800 flex items-center",children:[a.jsx(NL,{className:"mr-2"})," ",j?"My Pipeline":"Pipeline Intelligence"]}),a.jsx("p",{className:"text-sm text-gray-500",children:j?"Your personal pipeline performance and metrics.":"Analyze pipeline velocity and bottlenecks."})]}),a.jsxs("div",{className:"flex flex-wrap gap-2 mt-4 md:mt-0",children:[a.jsxs("select",{value:c,onChange:P=>u(P.target.value),className:"bg-gray-50 border border-gray-200 text-gray-700 text-xs rounded-lg p-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"ALL",children:"All Time"}),a.jsx("option",{value:"THIS_MONTH",children:"This Month"}),a.jsx("option",{value:"THIS_QUARTER",children:"This Quarter"}),a.jsx("option",{value:"THIS_YEAR",children:"This Year"})]}),!j&&a.jsxs(a.Fragment,{children:[a.jsxs("select",{value:d,onChange:P=>h(P.target.value),className:"bg-gray-50 border border-gray-200 text-gray-700 text-xs rounded-lg p-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"ALL",children:"All Users"}),k.map(P=>a.jsx("option",{value:P.id,children:P.name},P.id))]}),a.jsxs("div",{className:"flex bg-gray-100 p-0.5 rounded-lg",children:[a.jsx("button",{onClick:()=>x("AGGREGATE"),className:`px-2 py-1 rounded-md text-xs font-medium transition-all ${p==="AGGREGATE"?"bg-white text-blue-600 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:"Aggregate"}),a.jsx("button",{onClick:()=>x("COMPARE"),className:`px-2 py-1 rounded-md text-xs font-medium transition-all ${p==="COMPARE"?"bg-white text-blue-600 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:"Compare"})]})]})]})]}),p==="COMPARE"?a.jsx(qx,{sensors:w,collisionDetection:Bx,onDragEnd:E,children:a.jsx(C1e,{items:A.map(P=>P.user.id),strategy:gP,children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 overflow-x-auto pb-4",children:[A.map(P=>a.jsx(R1e,{id:P.user.id,children:a.jsx(z1e,{user:P.user,metrics:P.data,stages:T.stages.filter(D=>D.key!=="CLOSED_LOST"),currencySymbol:n,target:P.target})},P.user.id)),A.length===0&&a.jsx("div",{className:"col-span-full text-center py-10 text-gray-400",children:"No data for selected filters."})]})})}):a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-8",children:[a.jsxs("div",{className:"lg:col-span-4 flex flex-col space-y-2 relative",children:[a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"absolute left-6 top-4 bottom-4 w-0.5 bg-gray-100 -z-0"}),T.stages.filter(P=>P.key!=="CLOSED_LOST").map((P,D)=>{const U=T.aggregate.metrics[P.key];let B=null;if(D>0){const R=T.stages[D-1].key,q=T.aggregate.metrics[R].count;q>0&&(B=(U.count/q*100).toFixed(0))}return a.jsx(Xk,{label:P.label,count:U.count,value:U.value,width:U.width,color:U.color,isLead:!P.isDeal,weightedValue:U.weightedValue,currencySymbol:n,isActive:o===P.key,conversionRate:B,onClick:()=>l(P.key)},P.key)})]}),a.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-100",children:[a.jsx("div",{className:"mb-2 text-xs font-bold text-gray-400 uppercase",children:"Funnel Health"}),a.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center mb-4",children:[a.jsxs("div",{className:"bg-green-50 rounded p-2 border border-green-100",children:[a.jsx("p",{className:"text-[9px] text-green-600 uppercase font-bold",children:"Win Rate"}),a.jsxs("p",{className:"text-sm font-bold text-gray-800",children:[M.winRate.toFixed(0),"%"]})]}),a.jsxs("div",{className:"bg-blue-50 rounded p-2 border border-blue-100",children:[a.jsx("p",{className:"text-[9px] text-blue-600 uppercase font-bold",children:"Conversion"}),a.jsxs("p",{className:"text-sm font-bold text-gray-800",children:[M.conversionRate.toFixed(0),"%"]})]}),a.jsxs("div",{className:"bg-red-50 rounded p-2 border border-red-100",children:[a.jsx("p",{className:"text-[9px] text-red-600 uppercase font-bold",children:"Lost Value"}),a.jsx("p",{className:"text-sm font-bold text-gray-800",children:Ro(M.totalLost,n)})]})]}),a.jsx(Xk,{label:"Closed Lost",count:T.aggregate.metrics.CLOSED_LOST.count,value:T.aggregate.metrics.CLOSED_LOST.value,width:T.aggregate.metrics.CLOSED_LOST.width,color:"bg-red-500 opacity-90",isLead:!1,weightedValue:0,currencySymbol:n,isActive:o==="CLOSED_LOST",onClick:()=>l("CLOSED_LOST")},"CLOSED_LOST"),a.jsxs("div",{className:"bg-gray-50 p-2 rounded-lg border border-gray-100 mt-4",children:[a.jsxs("div",{className:"flex justify-between items-center text-[10px] mb-1",children:[a.jsxs("span",{className:"font-bold text-gray-600 flex items-center",children:[a.jsx(fr,{className:"mr-1"})," Total Target"]}),a.jsxs("span",{className:M.progress>=100?"text-green-600 font-bold":"text-blue-600 font-bold",children:[M.progress.toFixed(0),"%"]})]}),a.jsx("div",{className:"w-full h-2 bg-gray-200 rounded-full overflow-hidden mb-1",children:a.jsx("div",{className:`h-full rounded-full transition-all duration-1000 ${M.progress>=100?"bg-green-500":"bg-blue-500"}`,style:{width:`${Math.min(M.progress,100)}%`}})}),a.jsxs("div",{className:"flex justify-between text-[9px] text-gray-400",children:[a.jsxs("span",{children:["Achieved: ",a.jsx("span",{className:"text-gray-700 font-medium",children:Ro(M.totalWon,n)})]}),a.jsxs("span",{children:["Goal: ",Ro(M.totalTarget,n)]})]})]})]})]}),a.jsxs("div",{className:"lg:col-span-8 h-[600px] flex flex-col",children:[a.jsxs("div",{className:"bg-gray-50 p-3 rounded-t-xl border-b border-gray-200 flex justify-between items-center",children:[a.jsx("h3",{className:"text-sm font-bold text-gray-800 flex items-center",children:o==="ALL"?a.jsx("span",{children:"Select a stage to view details"}):a.jsxs(a.Fragment,{children:[a.jsx("span",{className:`w-2.5 h-2.5 rounded-full mr-2 ${T.aggregate.metrics[o]?.color}`}),T.stages.find(P=>P.key===o)?.label," Details",a.jsxs("span",{className:"ml-2 px-2 py-0.5 bg-white border border-gray-200 text-gray-600 text-[10px] rounded-full",children:[z.length," records"]})]})}),o!=="ALL"&&z.length>0&&a.jsxs("button",{onClick:()=>$1e(z,`Funnel_${o}`),className:"text-[10px] font-bold text-blue-600 hover:bg-blue-100 px-2 py-1 rounded transition-colors flex items-center",children:[a.jsx(Vo,{className:"mr-1"})," Export"]})]}),o==="ALL"?a.jsxs("div",{className:"bg-white flex-grow rounded-b-xl border border-gray-100 flex flex-col items-center justify-center p-12 text-center text-gray-400",children:[a.jsx(Xie,{size:48,className:"mb-4 text-blue-100"}),a.jsx("p",{children:"Click on any stage bar (including Lost Deals) to inspect records."})]}):a.jsx(F1e,{data:z,stageKey:o,currencySymbol:n,basePath:r})]})]})]})},U1e=(e,t="")=>`${t} ${new Intl.NumberFormat("en-US",{minimumFractionDigits:0}).format(e)}`,B1e=e=>{const t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())),n=t.getUTCDay()||7;t.setUTCDate(t.getUTCDate()+4-n);const s=new Date(Date.UTC(t.getUTCFullYear(),0,1));return Math.ceil(((t-s)/864e5+1)/7)},pP=({currencySymbol:e=""})=>{const[t,n]=f.useState("month"),[s,r]=f.useState([]),[i,o]=f.useState([]),[l,c]=f.useState([]),[u,d]=f.useState(!1),h=new Date,p=h.getFullYear(),x=h.getMonth()+1,v=B1e(h),j=f.useCallback(async()=>{d(!0);try{const S=new URLSearchParams;S.append("period_type","MONTHLY"),S.append("period_year",p),S.append("period_number",x);const _=await re.get(`/targets/leaderboard?${S.toString()}`).catch(()=>({data:{entries:[]}}));o(_.data?.entries||[]);const k=new URLSearchParams;k.append("period_type","ANNUAL"),k.append("period_year",p);const T=await re.get(`/targets/leaderboard?${k.toString()}`).catch(()=>({data:{entries:[]}}));c(T.data?.entries||[]);const A=new Date,E=new Date;E.setDate(E.getDate()-7);const M=new URLSearchParams;M.append("start_date",E.toISOString().split("T")[0]),M.append("end_date",A.toISOString().split("T")[0]);const z=await re.get(`/targets/leaderboard?${M.toString()}`).catch(()=>({data:{entries:[]}}));r(z.data?.entries||[])}catch(S){console.error("Error fetching leaderboard data:",S)}finally{d(!1)}},[p,x]);f.useEffect(()=>{j()},[j]);const y=f.useMemo(()=>{let S=[];switch(t){case"week":S=s;break;case"month":S=i;break;case"year":S=l;break;default:S=i}return Array.isArray(S)?S.slice(0,5):[]},[t,s,i,l]),N=[{id:"week",label:"Week"},{id:"month",label:"Month"},{id:"year",label:"Year"}],w=S=>{switch(S){case 0:return"bg-yellow-100 text-yellow-700 border-yellow-300";case 1:return"bg-gray-100 text-gray-600 border-gray-300";case 2:return"bg-orange-100 text-orange-700 border-orange-300";default:return"bg-gray-50 text-gray-500 border-gray-200"}};return a.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg border border-gray-100 flex flex-col h-full",children:[a.jsx("div",{className:"flex justify-between items-center mb-4",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(cd,{className:"text-blue-500",size:20}),a.jsx("h2",{className:"text-md font-semibold text-gray-800",children:"Top 5 Performers"})]})}),a.jsx("div",{className:"flex space-x-1 mb-4 bg-gray-100 rounded-lg p-1",children:N.map(S=>a.jsx("button",{onClick:()=>n(S.id),className:`flex-1 py-1.5 px-3 text-xs font-medium rounded-md transition-all duration-200 ${t===S.id?"bg-white text-blue-600 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:S.label},S.id))}),u?a.jsx("div",{className:"flex items-center justify-center py-8",children:a.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-500"})}):y.length>0?a.jsx("div",{className:"space-y-3 flex-1",children:y.map((S,_)=>a.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg hover:bg-gray-50 transition-colors",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-xs font-bold border ${w(_)}`,children:_+1}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-800 truncate max-w-[120px]",children:S.user_name||"Unknown Rep"}),a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx("div",{className:"w-16 h-1.5 bg-gray-200 rounded-full overflow-hidden",children:a.jsx("div",{className:`h-full rounded-full ${S.achievement_percentage>=100?"bg-green-500":S.achievement_percentage>=50?"bg-yellow-500":"bg-red-400"}`,style:{width:`${Math.min(S.achievement_percentage,100)}%`}})}),a.jsxs("span",{className:"text-[10px] text-gray-500",children:[S.achievement_percentage?.toFixed(1),"%"]})]})]})]}),a.jsx("p",{className:"text-sm font-bold text-gray-900",children:U1e(S.achieved_amount||0,e)})]},S.user_id||_))}):a.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-gray-400",children:[a.jsx(Ot,{size:32,className:"mb-2 opacity-50"}),a.jsx("p",{className:"text-sm",children:"No data for this period"})]}),a.jsx("div",{className:"mt-auto pt-3 border-t border-gray-100",children:a.jsxs("p",{className:"text-[10px] text-gray-400 text-center",children:[t==="week"&&`Week ${v}, ${p}`,t==="month"&&`${h.toLocaleString("default",{month:"long"})} ${p}`,t==="year"&&`Year ${p}`]})})]})},H1e=e=>a.jsx(Kt,{...e}),q1e=e=>a.jsx(ac,{...e}),xP=e=>a.jsx(zs,{...e}),G1e=e=>a.jsx(ux,{...e}),W1e=e=>a.jsx(hj,{...e}),V1e=e=>a.jsx(Ot,{...e}),Y1e=e=>a.jsx(It,{...e}),Q1e=e=>a.jsx(pj,{...e}),rY=e=>a.jsx(gj,{...e}),K1e=e=>a.jsx(Za,{...e}),iY=e=>a.jsx(ra,{...e}),X1e=e=>a.jsx(Xa,{...e}),oY=e=>a.jsx(sa,{...e}),Z1e=e=>a.jsx(ia,{...e}),lY=e=>a.jsx(fr,{...e}),J1e=e=>a.jsx(Qa,{...e}),eCe=e=>a.jsx(Ot,{...e}),tCe=e=>a.jsx(Fs,{...e}),aCe=e=>a.jsx(tc,{...e}),nCe=e=>a.jsx(ks,{...e}),cY=(e,t="")=>{const n=parseFloat(e)||0;return new Intl.NumberFormat("en-US",{notation:"compact",compactDisplay:"short",maximumFractionDigits:1}).format(n).replace(/^/,`${t} `)},sCe=e=>{if(!e)return 0;const t=new Date-new Date(e);return Math.floor(t/(1e3*60*60*24))},rCe=e=>{switch(e){case"Negotiation":return{text:"text-purple-700",bg:"bg-purple-100"};case"Proposal":return{text:"text-red-700",bg:"bg-red-100"};case"Qualification":return{text:"text-yellow-700",bg:"bg-yellow-100"};case"Prospecting":return{text:"text-blue-700",bg:"bg-blue-100"};case"Closed Won":return{text:"text-green-700",bg:"bg-green-100"};case"Closed Lost":return{text:"text-red-700",bg:"bg-red-100"};default:return{text:"text-gray-700",bg:"bg-gray-100"}}},iCe=e=>{switch(e){case"Website":return{text:"text-green-600",bg:"bg-green-100"};case"Referral":return{text:"text-purple-600",bg:"bg-purple-100"};case"Trade Show":return{text:"text-orange-600",bg:"bg-orange-100"};case"Cold Call":return{text:"text-red-600",bg:"bg-red-100"};default:return{text:"text-gray-600",bg:"bg-gray-100"}}},oCe=e=>{switch(e){case"call":return{Icon:Y1e,color:"text-red-500",bgColor:"bg-red-100"};case"qualification":return{Icon:Q1e,color:"text-green-600",bgColor:"bg-green-100"};default:return{Icon:V1e,color:"text-blue-500",bgColor:"bg-blue-100"}}},lCe=e=>{switch(e.toUpperCase()){case"HIGH":return{text:"text-red-700",bg:"bg-red-100"};case"LOW":return{text:"text-blue-700",bg:"bg-blue-100"};default:return{text:"text-gray-700",bg:"bg-gray-100"}}},cCe=({searchQuery:e,onSearchChange:t,searchResults:n,onSearchResultClick:s})=>{const r=kt(),[i,o]=f.useState(!1),l=f.useRef(null),c=[{icon:q1e,label:"Account"},{icon:iY,label:"Contact"},{icon:X1e,label:"Leads"},{icon:oY,label:"Deals"},{icon:Z1e,label:"Quotes"},{icon:lY,label:"Target"},{icon:J1e,label:"Task"},{icon:eCe,label:"Meeting"},{icon:tCe,label:"Call"},{icon:nCe,label:"Audit"},{icon:aCe,label:"Territory"}];f.useEffect(()=>{const h=p=>{l.current&&!l.current.contains(p.target)&&o(!1)};return document.addEventListener("mousedown",h),()=>document.removeEventListener("mousedown",h)},[]);const u=h=>{t(h.target.value),o(h.target.value.trim().length>0)},d=h=>{s&&s(h),o(!1)};return a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-3 sm:p-4 flex flex-col items-start space-y-4 w-full",children:[a.jsxs("div",{className:"w-full flex justify-center relative",ref:l,children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg lg:mt-3 px-4 py-2 w-full max-w-md md:max-w-2xl lg:max-w-2xl focus-within:ring-2 focus-within:ring-blue-500 transition duration-150",children:[a.jsx(H1e,{size:20,className:"text-gray-400 mr-3 flex-shrink-0"}),a.jsx("input",{type:"text",placeholder:"Search Leads, Deals, or Accounts...",className:"focus:outline-none text-base w-full",value:e,onChange:u,onFocus:()=>e.trim().length>0&&o(!0)})]}),i&&Array.isArray(n)&&n.length>0&&a.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 mt-2 w-full max-w-md md:max-w-lg lg:max-w-2xl bg-white rounded-lg shadow-xl border border-gray-200 z-50 max-h-96 overflow-y-auto",children:n.map((h,p)=>a.jsx("div",{className:"px-4 py-3 hover:bg-gray-50 cursor-pointer border-b border-gray-100 last:border-b-0 transition duration-150",onClick:()=>d(h),children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-semibold text-gray-800 text-sm",children:h.name}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:h.type}),h.details&&a.jsx("p",{className:"text-xs text-gray-400 mt-1",children:h.details})]}),a.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${h.type==="Lead"?"bg-blue-100 text-blue-600":h.type==="Deal"?"bg-yellow-100 text-yellow-600":"bg-green-100 text-green-600"}`,children:h.type})]})},p))})]}),a.jsx("div",{className:"w-full overflow-x-auto lg:overflow-x-hidden scroll-smooth flex justify-center",children:a.jsx("div",{className:"flex flex-nowrap space-x-3 lg:space-x-4 xl:space-x-3 px-2 sm:px-0",children:c.map((h,p)=>a.jsxs("div",{className:"relative flex-shrink-0 group",children:[a.jsx("button",{className:"p-3 text-gray-500 hover:text-gray-900 transition duration-150 rounded-full hover:bg-gray-100 focus:outline-none cursor-pointer","aria-label":h.label,title:h.label,onClick:()=>{const x={Account:"/admin/accounts",Contact:"/admin/contacts",Leads:"/admin/leads",Deals:"/admin/deals",Quotes:"/admin/quotes",Target:"/admin/targets",Task:"/admin/tasks",Meeting:"/admin/meetings",Call:"/admin/calls",Audit:"/admin/audit",Territory:"/admin/territory"};x[h.label]&&r(x[h.label])},children:a.jsx(h.icon,{size:24,className:"lg:scale-95"})}),a.jsxs("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 px-3 py-1.5 bg-gray-900 text-white text-xs font-semibold rounded-md whitespace-nowrap opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-75 ease-in-out z-50 shadow-lg",children:[h.label,a.jsx("div",{className:"absolute top-full left-1/2 -translate-x-1/2 -mt-1 border-4 border-transparent border-t-gray-900"})]})]},p))})})]})},dCe=({action:e,description:t,entity_type:n,entity_name:s,timestamp:r})=>{const i=kt(),o=d=>{if(!d)return"Unknown";const h=new Date(d),x=new Date-h,v=Math.floor(x/6e4),j=Math.floor(x/36e5),y=Math.floor(x/864e5);return v<1?"Just now":v<60?`${v} min ago`:j<24?`${j} hour${j>1?"s":""} ago`:y<7?`${y} day${y>1?"s":""} ago`:h.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},l=e||t||"Action",c=s||n||"System",u=o(r);return a.jsxs("li",{className:"flex justify-between items-center py-2 border-b border-gray-100 last:border-b-0 cursor-pointer hover:bg-gray-50 transition duration-150 px-2 -mx-2 rounded-md",onClick:()=>i("/admin/audit"),children:[a.jsxs("p",{className:"text-sm text-gray-800 flex-grow font-medium",children:[l," ",a.jsxs("span",{className:"text-gray-500 italic text-xs",children:["(",c,")"]})]}),a.jsx("span",{className:"text-xs text-gray-400 flex-shrink-0 ml-4",children:u})]})},uCe=({logs:e,loading:t})=>{const n=kt();return a.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg border border-gray-100 flex flex-col h-full",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h2",{className:"text-md font-semibold text-gray-800",children:"Recent Logs"}),a.jsxs("span",{className:"text-sm text-blue-500 cursor-pointer hover:underline flex items-center space-x-1 font-medium",onClick:()=>n("/admin/audit"),children:[a.jsx("span",{children:"See All"}),a.jsx(rY,{size:14,className:"transform -rotate-45"})]})]}),e&&e.length>0?a.jsx("ul",{className:"space-y-1",children:e.slice(0,3).map((s,r)=>a.jsx(dCe,{...s},r))}):a.jsx("div",{className:"text-sm text-gray-500 py-4",children:"No recent logs"})]})},mCe=({icon:e,title:t,value:n,color:s,bgColor:r,loading:i,onClick:o})=>a.jsxs("div",{className:"flex items-center p-4 bg-white rounded-xl shadow-md border border-gray-200 transition-all duration-300",onClick:o||(()=>console.log(`Clicked metric card: ${t}`)),children:[a.jsx("div",{className:`p-3 rounded-full ${r} ${s} mr-4`,children:a.jsx(e,{size:20})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-500 font-medium uppercase",children:t}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:n||0})]})]}),fCe=({revenueData:e,loading:t})=>{const n=kt(),s=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],r=f.useMemo(()=>{if(!e||e.length===0){const j=new Date().getMonth(),y=[],N=[];for(let w=0;w<=j;w++)y.push(s[w]),N.push(0);return{labels:y,revenues:N,maxRevenue:0}}const l={};e.forEach(v=>{const j=v.close_date||v.closeDate||null,y=v.stage||"",N=y.toUpperCase()==="CLOSED_WON"||y==="CLOSED_WON";let w=v.amount;w&&typeof w=="object"&&w.toString?w=parseFloat(w.toString()):w=parseFloat(w)||0;const S=w>0;if(j&&j!==null&&N&&S)try{let _=new Date(j);if(isNaN(_.getTime())){const k=String(j).split("T")[0];_=new Date(k+"T00:00:00")}if(!isNaN(_.getTime())){const k=_.getFullYear(),T=_.getMonth()+1,A=`${k}-${String(T).padStart(2,"0")}`;l[A]||(l[A]=0),l[A]+=w}}catch(_){console.error("Error parsing deal date:",j,_)}});const c=Object.keys(l).map(v=>parseInt(v.split("-")[0])),u=c.length>0?[...new Set(c)].sort():[],d=new Date().getFullYear(),h=[],p=[];for(let v=0;v<12;v++){const j=`${d}-${String(v+1).padStart(2,"0")}`;h.push(s[v]),p.push(l[j]||0)}if(u.length>0){const v=Math.max(...u);if(v>d)for(let j=d+1;j<=v;j++)for(let y=0;y<12;y++){const N=`${j}-${String(y+1).padStart(2,"0")}`,w=l[N]||0;h.push(`${s[y]} ${j}`),p.push(w)}}const x=Math.max(...p,1);return{labels:h,revenues:p,maxRevenue:x}},[e]),i=r.labels,o=r.revenues;return a.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg h-full flex flex-col",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Revenue Overview"}),a.jsxs("span",{className:"text-sm text-blue-500 cursor-pointer hover:underline flex items-center space-x-1 font-medium",onClick:()=>n("/admin/deals"),children:[a.jsx("span",{children:"See All"}),a.jsx(rY,{size:14,className:"transform -rotate-45"})]})]}),a.jsx("div",{className:"h-80 relative flex-1 flex items-center justify-center p-6",children:a.jsx("div",{className:"w-full h-full flex items-center justify-start lg:justify-center overflow-x-auto sm:overflow-x-hidden",children:i&&i.length>0&&o&&o.length>0?a.jsx(lh,{xAxis:[{data:i,scaleType:"point"}],yAxis:[{valueFormatter:l=>l>=1e3?`${(l/1e3).toFixed(0)}k`:l.toString()}],series:[{data:o,showMark:!0,area:!0}],height:320,width:void 0,grid:{vertical:!0,horizontal:!0},margin:{top:40,right:40,bottom:50,left:50},sx:{width:"100%",maxWidth:"100%",minWidth:{xs:600,lg:"100%"}}}):a.jsxs("div",{className:"text-center text-gray-500",children:[a.jsx("p",{className:"text-sm",children:"No revenue data available"}),a.jsx("p",{className:"text-xs mt-2",children:"Closed won deals with close dates will appear here"})]})})})]})},$2=({title:e,items:t,children:n,onSeeAll:s})=>{const r=kt(),i=()=>{if(s)s();else{const o={"Latest Leads":"/admin/leads","Latest Deals":"/admin/deals","Upcoming Activities":"/admin/tasks"};o[e]&&r(o[e])}};return a.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg flex flex-col h-full",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:e}),a.jsx("span",{className:"text-sm text-blue-500 cursor-pointer hover:underline",onClick:i,children:"See All"})]}),n]})},hCe=({first_name:e,last_name:t,company_name:n,source:s,created_at:r,id:i})=>{const o=kt(),{text:l,bg:c}=iCe(s||"Website"),u=x=>{if(!x)return"Unknown";const v=new Date(x),y=new Date-v,N=Math.floor(y/6e4),w=Math.floor(y/36e5),S=Math.floor(y/864e5);return N<60?`${N} min ago`:w<24?v.toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}):S<7?v.toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}):v.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})},d=`${e||""} ${t||""}`.trim()||"Unknown",h=n||"Unknown Company",p=u(r);return a.jsx("div",{className:"py-3 border-b border-gray-100 last:border-b-0 cursor-pointer hover:bg-gray-50 transition duration-150 px-2 -mx-2 rounded-md",onClick:()=>i&&o(`/admin/leads/${i}`),children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-gray-800",children:d}),a.jsx("p",{className:"text-xs text-gray-500",children:h})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"text-xs text-gray-400",children:p}),a.jsx("span",{className:`inline-block mt-1 text-xs font-medium ${l} ${c} px-2 py-0.5 rounded-full`,children:s||"Website"})]})]})})},gCe=({name:e,amount:t,account:n,stage:s,created_at:r,stage_updated_at:i,id:o,previousAmount:l,currencySymbol:c})=>{const u=kt(),h={PROSPECTING:"Prospecting",QUALIFICATION:"Qualification",PROPOSAL:"Proposal",NEGOTIATION:"Negotiation",CLOSED_WON:"Closed Won",CLOSED_LOST:"Closed Lost"}[s]||s||"Unknown",{text:p,bg:x}=rCe(h),v=sCe(i||r),j=v>30&&s!=="CLOSED_WON"&&s!=="CLOSED_LOST",y=parseFloat(t||0),N=l?y>=l?"up":"down":"up",w=N==="up"?G1e:W1e,S=N==="up"?"text-green-400":"text-red-400",_=n?.name||"Unknown Company";return a.jsx("div",{className:"py-3 border-b border-gray-100 last:border-b-0 cursor-pointer hover:bg-gray-50 transition duration-150 px-2 -mx-2 rounded-md",onClick:()=>o&&u(`/admin/deals/info?id=${o}`),children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{className:"flex-shrink",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("p",{className:"font-semibold text-sm text-gray-900",children:e||"Unnamed Deal"}),j&&a.jsxs("span",{className:"text-[10px] bg-red-100 text-red-600 px-1.5 py-0.5 rounded border border-red-200 font-bold flex items-center",children:[a.jsx(xP,{size:10,className:"mr-1"})," ",v," days stuck"]})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:_}),a.jsx("div",{className:"mt-1 flex items-center space-x-2",children:a.jsx("span",{className:`inline-block text-xs font-medium ${p} ${x} px-2 py-0.5 rounded-full`,children:h})})]}),a.jsxs("div",{className:"text-right flex flex-col items-end flex-shrink-0",children:[a.jsx("p",{className:"text-md font-bold text-gray-800",children:cY(y,c)}),a.jsx(w,{size:16,className:`${S} mt-1`})]})]})})},pCe=({type:e,title:t,assignedTo:n,dueDate:s,scheduledDate:r,priority:i,id:o,activityType:l,fullData:c})=>{const u=kt(),h=l||{Call:"call",Meeting:"meeting",Task:"qualification"}[e]||"meeting",{Icon:p,color:x,bgColor:v}=oCe(h),{text:j,bg:y}=lCe(i||"MEDIUM"),S=(T=>{if(!T)return"No date set";const A=new Date(T),M=A-new Date,z=Math.floor(M/864e5);return z===0?`Today, ${A.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}`:z===1?`Tomorrow, ${A.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}`:z===-1?`Yesterday, ${A.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}`:A.toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})})(s||r),_=n||"Unassigned",k=()=>{o&&(c?h==="call"?(sessionStorage.setItem("callDetailData",JSON.stringify(c)),u(`/admin/calls/info?id=${o}`)):h==="meeting"?(sessionStorage.setItem("meetingDetailData",JSON.stringify(c)),u(`/admin/meetings/info?id=${o}`)):u("/admin/tasks"):u(h==="call"?`/admin/calls/info?id=${o}`:h==="meeting"?`/admin/meetings/info?id=${o}`:"/admin/tasks"))};return a.jsxs("div",{className:"flex items-start py-3 border-b border-gray-100 last:border-b-0 cursor-pointer hover:bg-gray-50 transition duration-150 px-2 -mx-2 rounded-md",onClick:k,children:[a.jsx("div",{className:`p-2 rounded-lg ${v} mr-3 flex-shrink-0 mt-1`,children:a.jsx(p,{size:20,className:`${x}`})}),a.jsxs("div",{className:"flex-grow",children:[a.jsxs("p",{className:"font-medium text-gray-800 flex items-center mb-1",children:[a.jsx("span",{className:"text-xl leading-none mr-2",children:""}),t||"Untitled Activity"]}),a.jsxs("div",{className:"space-y-1 text-xs text-gray-500",children:[a.jsxs("p",{className:"flex items-center",children:[a.jsx(xP,{size:14,className:"mr-1.5 text-gray-400"}),S]}),a.jsxs("p",{className:"flex items-center",children:[a.jsx(iY,{size:14,className:"mr-1.5 text-gray-400"}),"Assigned to: ",_]})]})]}),a.jsx("span",{className:`inline-block text-xs font-medium ${j} ${y} px-2 py-0.5 rounded-full flex-shrink-0 self-center ml-4`,children:(i||"MEDIUM").toUpperCase()})]})},xCe=()=>{const e=kt(),{user:t}=Vt(),n=t?.company?.currency||"",[s,r]=f.useState([]),[i,o]=f.useState(0),[l,c]=f.useState({activeLeads:0,totalDeals:0,activeAccounts:0,overdueTasks:0}),[u,d]=f.useState([]),[h,p]=f.useState([]),[x,v]=f.useState([]),[j,y]=f.useState([]),[N,w]=f.useState([]),[S,_]=f.useState(!0),[k,T]=f.useState(null),[A,E]=f.useState(""),[M,z]=f.useState([]),[P,D]=f.useState([]),[U,B]=f.useState([]),[R,q]=f.useState(new Date),Z=f.useRef(null);f.useRef(null);const V=f.useMemo(()=>{try{if(!A.trim())return[];const se=A.toLowerCase().trim(),ye=[];return Array.isArray(M)&&M.forEach(Ne=>{const fe=`${Ne.first_name||""} ${Ne.last_name||""}`.trim().toLowerCase(),we=(Ne.company_name||"").toLowerCase(),de=(Ne.email||"").toLowerCase(),ke=(Ne.phone||"").toLowerCase();(fe.includes(se)||we.includes(se)||de.includes(se)||ke.includes(se))&&ye.push({id:Ne.id,name:`${Ne.first_name||""} ${Ne.last_name||""}`.trim()||"Unnamed Lead",type:"Lead",details:Ne.company_name||"No company",route:`/admin/leads/${Ne.id}`})}),Array.isArray(P)&&P.forEach(Ne=>{const fe=(Ne.name||"").toLowerCase(),we=(Ne.account?.name||"").toLowerCase(),de=(Ne.description||"").toLowerCase();(fe.includes(se)||we.includes(se)||de.includes(se))&&ye.push({id:Ne.id,name:Ne.name||"Unnamed Deal",type:"Deal",details:Ne.account?.name||"No account",route:`/admin/deals/info?id=${Ne.id}`})}),Array.isArray(U)&&U.forEach(Ne=>{const fe=(Ne.name||"").toLowerCase(),we=(Ne.email||"").toLowerCase(),de=(Ne.phone||"").toLowerCase(),ke=(Ne.website||"").toLowerCase();(fe.includes(se)||we.includes(se)||de.includes(se)||ke.includes(se))&&ye.push({id:Ne.id,name:Ne.name||"Unnamed Account",type:"Account",details:Ne.email||Ne.phone||"No contact info",route:"/admin/accounts"})}),ye.slice(0,10)}catch(se){return console.error("Error in search:",se),[]}},[A,M,P,U]),oe=se=>{se.route&&(e(se.route),E(""))},je=f.useCallback(async()=>{_(!0),T(null);try{const[se,ye,Ne,fe,we,de,ke,ge]=await Promise.all([re.get("/leads/admin/getLeads").catch(pe=>(console.error("Error fetching leads:",pe),{data:[]})),re.get("/deals/admin/fetch-all").catch(pe=>(console.error("Error fetching deals:",pe),{data:[]})),re.get("/accounts/admin/fetch-all").catch(pe=>(console.error("Error fetching accounts:",pe),{data:[]})),re.get("/tasks/all").catch(pe=>(console.error("Error fetching tasks:",pe),{data:[]})),re.get("/meetings/admin/fetch-all").catch(pe=>(console.error("Error fetching meetings:",pe),{data:[]})),re.get("/calls/admin/fetch-all").catch(pe=>(console.error("Error fetching calls:",pe),{data:[]})),re.get("/logs/read-all").catch(pe=>(console.error("Error fetching logs:",pe),{data:[]})),re.get("/targets/admin/fetch-all").catch(pe=>(console.error("Error fetching targets:",pe),{data:[]}))]),$e=Array.isArray(se.data)?se.data:[],be=Array.isArray(ye.data)?ye.data:[],me=Array.isArray(Ne.data)?Ne.data:[],Ue=Array.isArray(fe.data)?fe.data:[],Ee=Array.isArray(we.data)?we.data:[],We=Array.isArray(de.data)?de.data:[],tt=Array.isArray(ke.data)?ke.data:[],lt=Array.isArray(ge.data)?ge.data:[];z($e),D(be),B(me),r(lt);const Fe=lt.reduce((pe,ce)=>{const Q=ce.amount||ce.value||ce.target_amount||0,ne=parseFloat(typeof Q=="string"?Q.replace(/[^\d.-]/g,""):Q);return pe+(isNaN(ne)?0:ne)},0);o(Fe),c({activeLeads:$e.filter(pe=>pe.status&&!["Lost","Converted"].includes(pe.status)).length,totalDeals:be.length,activeAccounts:me.length,overdueTasks:Ue.filter(pe=>!pe.dueDate||pe.status==="Completed"?!1:new Date(pe.dueDate)<new Date).length});const st=[...$e].sort((pe,ce)=>new Date(ce.created_at||0)-new Date(pe.created_at||0)).slice(0,5);d(st);const Xe=[...be].sort((pe,ce)=>new Date(ce.created_at||0)-new Date(pe.created_at||0)).slice(0,5);p(Xe);const Ze=[];We.forEach(pe=>{const ce=pe.due_date||pe.call_time,Q=(pe.status||"").toUpperCase();ce&&!["COMPLETED","MISSED","NOT_HELD","HELD"].includes(Q)&&Ze.push({type:"Call",title:pe.subject||"Untitled Call",assignedTo:pe.assigned_to||(pe.call_assign_to?`${pe.call_assign_to.first_name||""} ${pe.call_assign_to.last_name||""}`.trim():"Unassigned"),scheduledDate:ce,priority:(pe.priority||"MEDIUM").toUpperCase(),id:pe.id,activityType:"call",fullData:pe})}),Ee.forEach(pe=>{const ce=pe.dueDate||pe.start_time,Q=(pe.status||"").toUpperCase();ce&&!["COMPLETED","CANCELLED","DONE"].includes(Q)&&Ze.push({type:"Meeting",title:pe.subject||pe.activity||"Untitled Meeting",assignedTo:pe.assignedTo||(pe.meet_assign_to?`${pe.meet_assign_to.first_name||""} ${pe.meet_assign_to.last_name||""}`.trim():"Unassigned"),scheduledDate:ce,priority:(pe.priority||"MEDIUM").toUpperCase(),id:pe.id,activityType:"meeting",fullData:pe})});const Je={HIGH:1,MEDIUM:2,LOW:3},Be=Ze.sort((pe,ce)=>{const Q=Je[pe.priority]||3,ne=Je[ce.priority]||3;return Q!==ne?Q-ne:new Date(pe.scheduledDate||0)-new Date(ce.scheduledDate||0)}).slice(0,5);v(Be),w(be);const _e=[...tt].sort((pe,ce)=>new Date(ce.timestamp||0)-new Date(pe.timestamp||0));y(_e)}catch(se){console.error("Error fetching dashboard data:",se),T("Failed to load dashboard data. Please refresh the page.")}finally{_(!1)}},[]);f.useEffect(()=>(document.title="Dashboard | Sari-Sari CRM",je(),Z.current=setInterval(()=>{je(),q(new Date)},3e4),()=>{Z.current&&clearInterval(Z.current)}),[je]);const X=[{icon:K1e,title:"Active Leads",value:l.activeLeads,color:"text-blue-600",bgColor:"bg-blue-50",onClick:()=>e("/admin/leads")},{icon:lY,title:"Total Targets",value:cY(i,n),color:"text-purple-600",bgColor:"bg-purple-50",onClick:()=>e("/admin/targets")},{icon:oY,title:"Total Deals",value:l.totalDeals,color:"text-yellow-600",bgColor:"bg-yellow-50",onClick:()=>e("/admin/deals")},{icon:xP,title:"Overdue Tasks",value:l.overdueTasks,color:"text-red-600",bgColor:"bg-red-50",onClick:()=>e("/admin/tasks")}];return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative w-full",children:[S&&a.jsx(Wt,{}),a.jsxs("div",{className:"max-w-screen-2xl mx-auto",children:[k&&a.jsx("div",{className:"mb-6 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:a.jsx("p",{className:"font-medium",children:k})}),a.jsx("div",{className:"mb-8",children:a.jsx(cCe,{searchQuery:A,onSearchChange:E,searchResults:V,onSearchResultClick:oe})}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-4 mb-8",children:X.map(se=>a.jsx(mCe,{...se,loading:S},se.title))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[a.jsx(uCe,{logs:j,loading:S}),a.jsx(pP,{currencySymbol:n})]}),a.jsx("div",{className:"mb-8",children:a.jsx(LN,{leads:M,deals:P,targets:s,currencySymbol:n})}),a.jsx("div",{className:"grid grid-cols-1 mb-8",children:a.jsx(fCe,{revenueData:N,loading:S})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[a.jsx($2,{title:"Latest Leads",children:u.length>0?u.map((se,ye)=>a.jsx(hCe,{...se},se.id||ye)):a.jsx("div",{className:"text-sm text-gray-500 py-4 text-center",children:"No leads found"})}),a.jsx($2,{title:"Latest Deals",children:h.length>0?h.map((se,ye)=>a.jsx(gCe,{...se,stage_updated_at:se.stage_updated_at,currencySymbol:n},se.id||ye)):a.jsx("div",{className:"text-sm text-gray-500 py-4 text-center",children:"No deals found"})}),a.jsx($2,{title:"Upcoming Activities",children:x.length>0?x.map((se,ye)=>a.jsx(pCe,{...se},se.id||ye)):a.jsx("div",{className:"text-sm text-gray-500 py-4 text-center",children:"No upcoming activities"})})]})]})]})};function ca({totalItems:e=0,pageSize:t=10,currentPage:n=1,onPrev:s,onNext:r,onPageSizeChange:i,pageSizeOptions:o=[10,20,30,40,50],className:l="",label:c="records"}){const u=e===0?1:Math.ceil(e/t),d=e===0?0:(n-1)*t+1,h=Math.min(n*t,e),p=n<=1||e===0,x=n>=u||e===0,v="inline-flex items-center gap-1 px-3 sm:px-4 py-2 text-sm font-semibold rounded-lg transition focus:outline-none focus:ring-2 focus:ring-offset-1",j="bg-black text-white hover:bg-gray-900",y="bg-gray-200 text-gray-500 cursor-not-allowed focus:ring-transparent";return a.jsxs("div",{className:`flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 ${l}`,children:[a.jsxs("div",{className:"text-sm text-gray-600 font-medium text-center sm:text-left w-full sm:w-auto order-1",children:["Showing ",e===0?0:d,"-",h," of ",e," ",c]}),i&&a.jsxs("div",{className:"flex items-center justify-center gap-2 w-full sm:w-auto order-3 sm:order-2",children:[a.jsx("span",{className:"text-sm text-gray-600 font-medium",children:"Rows per page"}),a.jsx("select",{value:t,onChange:N=>i(Number(N.target.value)),className:"border border-gray-300 rounded-md text-sm py-1 pl-2 pr-6 focus:outline-none focus:ring-2 focus:ring-indigo-500",children:o.map(N=>a.jsx("option",{value:N,children:N},N))})]}),a.jsxs("div",{className:"flex items-center gap-3 justify-center sm:justify-end w-full sm:w-auto order-2 sm:order-3",children:[a.jsxs("button",{type:"button",onClick:s,disabled:p,className:`${v} ${p?y:j}`,children:[a.jsx(Qie,{className:"text-base"}),"Prev"]}),a.jsxs("div",{className:"text-sm font-semibold text-white bg-gray-900 border border-gray-900 shadow-sm px-3 py-1.5 rounded-full",children:["Page ",e===0?0:n," of"," ",e===0?0:u]}),a.jsxs("button",{type:"button",onClick:r,disabled:x,className:`${v} ${x?y:j}`,children:["Next",a.jsx(Mt,{className:"text-base"})]})]})]})}const yCe=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),bCe=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,n,s)=>s?s.toUpperCase():n.toLowerCase()),ER=e=>{const t=bCe(e);return t.charAt(0).toUpperCase()+t.slice(1)},dY=(...e)=>e.filter((t,n,s)=>!!t&&t.trim()!==""&&s.indexOf(t)===n).join(" ").trim(),vCe=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};var wCe={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const jCe=f.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:s,className:r="",children:i,iconNode:o,...l},c)=>f.createElement("svg",{ref:c,...wCe,width:t,height:t,stroke:e,strokeWidth:s?Number(n)*24/Number(t):n,className:dY("lucide",r),...!i&&!vCe(l)&&{"aria-hidden":"true"},...l},[...o.map(([u,d])=>f.createElement(u,d)),...Array.isArray(i)?i:[i]]));const mh=(e,t)=>{const n=f.forwardRef(({className:s,...r},i)=>f.createElement(jCe,{ref:i,iconNode:t,className:dY(`lucide-${yCe(ER(e))}`,`lucide-${e}`,s),...r}));return n.displayName=ER(e),n};const NCe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],CCe=mh("globe",NCe);const SCe=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],LR=mh("lock",SCe);const _Ce=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],ACe=mh("message-circle",_Ce);const TCe=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],kCe=mh("message-square",TCe);const ECe=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],LCe=mh("send",ECe);const PCe=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],PN=mh("x",PCe);function Tn({comments:e=[],onAddComment:t,currentUser:n}){const[s,r]=f.useState(""),[i,o]=f.useState(!1),[l,c]=f.useState(!1),u=async d=>{if(d.preventDefault(),!!s.trim()){c(!0);try{t&&await t({comment:s.trim(),is_private:i}),r("")}catch(h){console.error("Failed to add comment:",h)}finally{c(!1)}}};return a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 md:p-8 border border-gray-200 mt-5",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-800 break-words border-b border-gray-300 py-2 flex items-center gap-2",children:[a.jsx(kCe,{className:"w-5 h-5 text-gray-600"}),"Comments",e.length>0&&a.jsxs("span",{className:"text-sm font-normal text-gray-500",children:["(",e.length,")"]})]}),a.jsx("div",{className:"mt-4",children:e.length===0?a.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:a.jsx(ACe,{className:"w-8 h-8 text-gray-400"})}),a.jsx("h4",{className:"text-lg font-medium text-gray-700 mb-1",children:"No comments yet"}),a.jsx("p",{className:"text-sm text-gray-500 max-w-sm",children:"Be the first to share your thoughts. Start a conversation by adding a comment below."})]}):a.jsx("div",{className:"space-y-3",children:e.map(d=>a.jsxs("div",{className:"flex gap-3 p-3 bg-gray-100 rounded-lg border border-gray-100",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("div",{className:"w-9 h-9 bg-blue-500 rounded-full flex items-center justify-center text-white font-semibold text-sm",children:d.comment_creator?.profile_picture?a.jsx("img",{src:`${d.comment_creator.profile_picture}`,alt:`${d.comment_creator?.first_name||d.comment_creator?.email||"User"}'s profile`,className:"w-9 h-9 rounded-full object-cover"}):d.comment_creator?.first_name?.[0]||d.comment_creator?.email?.[0]?.toUpperCase()||"U"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[a.jsx("span",{className:"font-medium text-gray-800 text-sm",children:d.comment_creator?.first_name||d.comment_creator?.email||"Unknown User"}),a.jsx("span",{className:"text-xs text-gray-400",children:new Date(d.created_at).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"})}),d.is_private&&a.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-amber-100 text-amber-700 rounded-full text-xs font-medium",children:[a.jsx(LR,{className:"w-3 h-3"}),"Private"]})]}),a.jsx("p",{className:"mt-1 text-gray-600 whitespace-pre-wrap break-words text-xs",children:d.comment})]})]},d.id))})}),a.jsxs("form",{onSubmit:u,className:"mt-6 pt-4 border-t border-gray-200 text-sm",children:[a.jsx("div",{className:"relative",children:a.jsx("textarea",{value:s,onChange:d=>r(d.target.value),placeholder:"Write a comment...",rows:2,className:"w-full px-4 py-3 border border-gray-300 rounded-lg resize-none focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-700 placeholder-gray-400"})}),a.jsxs("div",{className:"flex items-center justify-between mt-3",children:[a.jsx("button",{type:"button",onClick:()=>o(!i),className:`cursor-pointer flex items-center gap-2 px-3 py-1.5 rounded-full text-sm font-medium transition-all duration-200 ${i?"bg-amber-100 text-amber-700 hover:bg-amber-200":"bg-green-100 text-green-700 hover:bg-green-200"}`,children:i?a.jsxs(a.Fragment,{children:[a.jsx(LR,{className:"w-4 h-4"}),"Private"]}):a.jsxs(a.Fragment,{children:[a.jsx(CCe,{className:"w-4 h-4"}),"Public"]})}),a.jsxs("button",{type:"submit",disabled:!s.trim()||l,className:"cursor-pointer flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200",children:[a.jsx(LCe,{className:"w-4 h-4"}),l?"Posting...":"Post Comment"]})]})]})]})}async function DCe({relatedType:e,relatedId:t}){const n=await re.get("/comments",{params:{related_type:e,related_id:t}});return Array.isArray(n.data)?n.data:[]}async function OCe({relatedType:e,relatedId:t,comment:n,isPrivate:s}){return(await re.post("/comments",{related_type:e,related_id:t,comment:n,is_private:!!s})).data}function kn({relatedType:e,relatedId:t}){const[n,s]=f.useState([]),[r,i]=f.useState(!1),o=f.useCallback(async()=>{if(!e||!t){s([]);return}i(!0);try{const c=await DCe({relatedType:e,relatedId:t});s(c)}finally{i(!1)}},[e,t]),l=f.useCallback(async({comment:c,is_private:u})=>{!e||!t||(await OCe({relatedType:e,relatedId:t,comment:c,isPrivate:u}),await o())},[e,t,o]);return f.useEffect(()=>{o()},[o]),{comments:n,loading:r,refresh:o,addComment:l}}const R2=[{value:"CUSTOMER",label:"Customer"},{value:"PROSPECT",label:"Prospect"},{value:"PARTNER",label:"Partner"},{value:"ACTIVE",label:"Vendor"},{value:"INACTIVE",label:"Inactive"},{value:"FORMER",label:"Delete"}],ab={name:"",website:"",phone_number:"",billing_address:"",shipping_address:"",industry:"",parent_company:"",status:"PROSPECT",territory_id:"",assigned_to:""},lr=e=>e?e.toUpperCase():"",z2=e=>e?e.toString().toLowerCase().replace(/\b\w/g,t=>t.toUpperCase()):"--",MCe=e=>{switch(lr(e)){case"CUSTOMER":return"bg-green-600 text-white";case"PROSPECT":return"bg-purple-600 text-white";case"PARTNER":return"bg-pink-600 text-white";case"ACTIVE":return"bg-blue-600 text-white";case"INACTIVE":return"bg-gray-600 text-white";case"FORMER":return"bg-orange-600 text-white";default:return"bg-gray-500 text-white"}},ICe=e=>{switch(lr(e)){case"CUSTOMER":return"bg-green-100 text-green-700";case"PROSPECT":return"bg-purple-100 text-purple-700";case"PARTNER":return"bg-pink-100 text-pink-700";case"ACTIVE":return"bg-blue-100 text-blue-700";case"INACTIVE":return"bg-gray-200 text-gray-700";case"FORMER":return"bg-orange-100 text-orange-700";default:return"bg-gray-100 text-gray-700"}};function $Ce(){const e=kt(),t=ta();f.useEffect(()=>{document.title="Accounts | Sari-Sari CRM"},[]);const[n,s]=f.useState(!1),[r,i]=f.useState(!1),[o,l]=f.useState(!1),[c,u]=f.useState(null),[d,h]=f.useState(null),[p,x]=f.useState(ab),[v,j]=f.useState(null),[y,N]=f.useState([]),[w,S]=f.useState(!1),[_,k]=f.useState([]),[T,A]=f.useState(null),[E,M]=f.useState([]),[z,P]=f.useState([]),[D,U]=f.useState("Filter by Status"),[B,R]=f.useState(""),[q,Z]=f.useState(null),[V,oe]=f.useState(!1),[je,X]=f.useState(1),[se,ye]=f.useState(10),[Ne,fe]=f.useState("Overview"),[we,de]=f.useState(""),[ke,ge]=f.useState(!1),[$e,be]=f.useState([]),[me,Ue]=f.useState({}),[Ee,We]=f.useState(null),{comments:tt,addComment:lt,refresh:Fe}=kn({relatedType:"account",relatedId:v?.id});f.useEffect(()=>{v?.id&&Fe()},[v?.id,Fe]);const st=f.useCallback(async(Ge=null)=>{S(!0);try{const Ae=await re.get("/accounts/admin/fetch-all"),L=[...Array.isArray(Ae.data)?Ae.data:[]].sort((ee,Le)=>{const ze=ee?.created_at||ee?.updated_at||0,Ve=Le?.created_at||Le?.updated_at||0;return new Date(Ve)-new Date(ze)});if(N(L),Ge){const ee=L.find(Le=>Le.id===Ge);j(ee||null)}}catch(Ae){console.error(Ae),N([]),Ae.response?.status===403?H.error("Permission denied. Only CEO, Admin, or Group Manager can access this page."):H.error("Failed to fetch accounts. Please try again later.")}finally{S(!1)}},[j]),Xe=f.useCallback(async()=>{try{const Ge=await re.get("/users/all");k(Array.isArray(Ge.data)?Ge.data:[])}catch(Ge){console.error(Ge),Ge.response?.status===403&&H.warn("Unable to load users for assignment (permission denied).")}},[]),Ze=f.useCallback(async()=>{try{const Ge=await re.get("/territories/fetch");M(Array.isArray(Ge.data)?Ge.data:[])}catch(Ge){console.error(Ge),Ge.response?.status===403&&H.warn("Unable to load territories (permission denied).")}},[]),Je=f.useCallback(async()=>{try{const Ge=await re.get("/accounts/admin/parent-companies");P(Array.isArray(Ge.data)?Ge.data:[])}catch(Ge){console.error(Ge),Ge.response?.status===403&&H.warn("Unable to load parent companies (permission denied).")}},[]),Be=f.useCallback(async Ge=>{try{const Ae=await re.get(`/activities/accounts/${Ge}`);Ue(Ae.data&&typeof Ae.data=="object"?Ae.data:{})}catch(Ae){console.error(Ae),Ae.response?.status===404&&(console.warn("No activities found for this account."),Ue({}))}},[]);f.useEffect(()=>{st(),Xe(),Ze(),Je()},[st,Xe,Ze,Je]),f.useEffect(()=>{X(1)},[B,D,se]);const _e=f.useMemo(()=>{const Ge=B.toLowerCase(),Ae=D;return y.filter(I=>{const L=I.name?.toLowerCase().includes(Ge)||I.website?.toLowerCase().includes(Ge)||I.phone_number?.toLowerCase().includes(Ge)||I.industry?.toLowerCase().includes(Ge)||I.parent_company?.toLowerCase().includes(Ge)||I.territory?.name?.toLowerCase().includes(Ge),ee=Ae==="Filter by Status"||lr(I.status)===lr(Ae);return L&&ee})},[y,B,D]),pe=Math.max(1,Math.ceil(_e.length/se)||1);f.useEffect(()=>{X(Ge=>{const Ae=Math.max(1,Math.ceil(_e.length/se)||1);return Ge>Ae?Ae:Ge})},[_e.length,se]);const ce=f.useMemo(()=>{const Ge=(je-1)*se;return _e.slice(Ge,Ge+se)},[_e,je,se]),Q=Ge=>{if(Ge.target.checked){const Ae=ce.map(I=>I.id);be(Ae)}else be([])},ne=Ge=>{be(Ae=>Ae.includes(Ge)?Ae.filter(I=>I!==Ge):[...Ae,Ge])},ae=async()=>{$e.length!==0&&Z({title:"Delete Accounts",message:a.jsxs("span",{children:["Are you sure you want to delete"," ",a.jsx("span",{className:"font-semibold",children:$e.length})," selected accounts? This action cannot be undone."]}),confirmLabel:`Delete ${$e.length} Account(s)`,cancelLabel:"Cancel",variant:"danger",action:{type:"bulk-delete",accountIds:$e}})};_e.length===0||(je-1)*se+1,Math.min(je*se,_e.length);const Pe=()=>X(Ge=>Math.max(Ge-1,1)),Te=()=>X(Ge=>Math.min(Ge+1,pe));f.useEffect(()=>{v&&de(lr(v.status)||"PROSPECT")},[v]);const he=y.length,He=f.useMemo(()=>y.filter(Ge=>Ge.status?.toLowerCase()==="customer").length,[y]),qe=f.useMemo(()=>y.filter(Ge=>Ge.status?.toLowerCase()==="prospect").length,[y]),nt=f.useMemo(()=>y.filter(Ge=>Ge.status?.toLowerCase()==="partner").length,[y]),ot=f.useMemo(()=>y.filter(Ge=>Ge.status?.toLowerCase()==="active").length,[y]),Re=f.useMemo(()=>y.filter(Ge=>Ge.status?.toLowerCase()==="inactive").length,[y]),it=f.useMemo(()=>y.filter(Ge=>Ge.status?.toLowerCase()==="former").length,[y]),St=f.useMemo(()=>[{title:"Total",value:he,icon:Za,color:"text-slate-600",bgColor:"bg-slate-100"},{title:"Customers",value:He,icon:Qi,color:"text-green-600",bgColor:"bg-green-100"},{title:"Prospects",value:qe,icon:Xa,color:"text-purple-600",bgColor:"bg-purple-100"},{title:"Partners",value:nt,icon:ra,color:"text-pink-600",bgColor:"bg-pink-100"},{title:"Active",value:ot,icon:Qi,color:"text-blue-600",bgColor:"bg-blue-100"},{title:"Inactive",value:Re,icon:Ki,color:"text-gray-600",bgColor:"bg-gray-100"},{title:"Former",value:it,icon:Ki,color:"text-orange-600",bgColor:"bg-orange-100"}],[he,He,qe,nt,ot,Re,it]),Et=Ge=>{j(Ge),fe("Overview"),de(lr(Ge?.status)||"PROSPECT")},Tt=()=>j(null),Nt=Ge=>{Ge.target.id==="accountModalBackdrop"&&!V&&Tt()},xe=()=>{s(!1),i(!1),h(null),x(ab),l(!1),A(null)},ve=Ge=>{Ge.target.id==="modalBackdrop"&&xe()},Oe=Ge=>Ge?new Date(Ge).toLocaleString("en-US",{month:"short",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).replace(",",""):"",Ce=Ge=>{const{name:Ae,value:I}=Ge.target;x(L=>({...L,[Ae]:I}))},Qe=()=>{x(ab),i(!1),h(null),s(!0)};f.useEffect(()=>{const Ge=new URLSearchParams(t.search||"");(t.state?.openAccountModal||Ge.get("openModal")==="1")&&(x(ab),i(!1),h(null),s(!0),De(!1),e(t.pathname,{replace:!0,state:{}}))},[t.state,t.pathname,t.search,e]);const G=Ge=>{j(null),Ge.assigned_accs?A(Ge.assigned_accs):A(null),x({name:Ge.name||"",website:Ge.website||"",phone_number:Ge.phone_number||"",billing_address:Ge.billing_address||"",shipping_address:Ge.shipping_address||"",parent_company:Ge.parent_company||"",industry:Ge.industry||"",status:lr(Ge.status)||"PROSPECT",territory_id:Ge.territory?.id?String(Ge.territory.id):"",assigned_to:Ge.assigned_accs?.id?String(Ge.assigned_accs.id):""}),i(!0),h(Ge.id),s(!0)},W=Ge=>{Ge&&Z({title:"Delete Account",message:a.jsxs("span",{children:["Are you sure you want to permanently delete the account"," ",a.jsx("span",{className:"font-semibold",children:Ge.name}),"? This action cannot be undone."]}),confirmLabel:"Delete Account",cancelLabel:"Cancel",variant:"danger",action:{type:"delete",targetId:Ge.id,name:Ge.name}})},J=async()=>{if(!q?.action){Z(null);return}const{action:Ge}=q,{type:Ae,payload:I,targetId:L,name:ee,accountIds:Le}=Ge;oe(!0);try{if(Ae==="create"){l(!0);const ze=await re.post("/accounts/admin",I);Je(),H.success(`Account "${ee}" created successfully.`);const Ve=v?.id||null;xe(),await st(Ve),!v&&ze.data?.id}else if(Ae==="update"){if(!L)throw new Error("Missing account identifier for update.");l(!0),await re.put(`/accounts/admin/${L}`,I),H.success(`Account "${ee}" updated successfully.`);const ze=v?.id&&v.id===L?L:null;xe(),await st(ze),v?.id===L&&j(null)}else if(Ae==="delete"){if(!L)throw new Error("Missing account identifier for deletion.");const ze=v?.id;u(L),await re.delete(`/accounts/admin/${L}`),H.success(`Account "${ee}" deleted successfully.`),await st(ze&&ze!==L?ze:null),ze===L&&j(null)}else Ae==="bulk-delete"&&(await re.delete("/accounts/admin/bulk-delete",{data:{account_ids:Le}}),H.success(`Successfully deleted ${Le.length} accounts`),be([]),await st())}catch(ze){console.error(ze);const Ve=Ae==="create"?"Failed to create account. Please review the details and try again.":Ae==="update"?"Failed to update account. Please review the details and try again.":Ae==="bulk-delete"?"Failed to delete selected accounts.":"Failed to delete account. Please try again.",ft=ze.response?.data?.detail||Ve;H.error(ft),(Ae==="create"||Ae==="update")&&l(!1),Ae==="delete"&&u(null)}finally{(Ae==="create"||Ae==="update")&&l(!1),Ae==="delete"&&u(null),oe(!1),Z(null)}},Y=()=>{V||Z(null)},F=async()=>{if(!v||!we)return;const Ge=lr(we),Ae=lr(v.status);if(Ge!==Ae){ge(!0);try{await re.put(`/accounts/admin/${v.id}`,{status:Ge}),H.success(`Account status updated to ${z2(Ge)}`),N(I=>I.map(L=>L.id===v.id?{...L,status:Ge}:L)),j(null)}catch(I){console.error(I);const L=I.response?.data?.detail||"Failed to update account status. Please try again.";H.error(L)}finally{ge(!1)}}},[ue,De]=f.useState(!1),le=Ge=>{Ge.preventDefault(),De(!0);const Ae=p.name.trim();if(!Ae){H.error("Account name is required.");return}if(!p.assigned_to){H.error("Assigned To is required.");return}const L={name:Ae,website:p.website?.trim()||null,phone_number:p.phone_number?.trim()||null,billing_address:p.billing_address?.trim()||null,shipping_address:p.shipping_address?.trim()||null,industry:p.industry?.trim()||null,parent_company:p.parent_company?.trim()||null,status:p.status||"PROSPECT",territory_id:p.territory_id?Number(p.territory_id):null,assigned_to:p.assigned_to?Number(p.assigned_to):null},ee=r&&d?"update":"create";Z({title:ee==="create"?"Confirm New Account":"Confirm Update",message:ee==="create"?a.jsxs("span",{children:["Are you sure you want to create the account"," ",a.jsx("span",{className:"font-semibold",children:Ae}),"?"]}):a.jsxs("span",{children:["Save changes to the account"," ",a.jsx("span",{className:"font-semibold",children:Ae}),"?"]}),confirmLabel:ee==="create"?"Create Account":"Update Account",cancelLabel:"Cancel",variant:"primary",action:{type:ee,payload:L,targetId:d||null,name:Ae}})},Ie=[{label:"Filter by Status",value:"Filter by Status"},...R2.map(Ge=>({label:Ge.label,value:Ge.value}))],K=q?.action?.type==="delete"?q.action.targetId:null,ie=v&&(c===v.id||K===v.id),Me=v&&c===v.id,Ke=v?MCe(v.status):"",gt=v?a.jsx("div",{id:"accountModalBackdrop",onClick:Nt,className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-6xl max-h-[92vh] overflow-y-auto hide-scrollbar animate-scale-in font-inter relative",onClick:Ge=>Ge.stopPropagation(),children:[a.jsxs("div",{className:"bg-tertiary w-full rounded-t-xl flex items-center justify-between p-3 lg:p-3",children:[a.jsx("h1",{className:"lg:text-3xl text-xl text-white font-semibold text-center w-full",children:"Account"}),a.jsx("button",{onClick:Tt,className:"text-gray-400 hover:text-white cursor-pointer",children:a.jsx(Ja,{size:25})})]}),a.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between lg:flex-row lg:items-center lg:justify-between mt-3 gap-2 px-2 md:items-center lg:gap-4 md:mx-7 lg:mx-7",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[a.jsx("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-800",children:v.name}),a.jsx("span",{className:`text-xs sm:text-sm font-medium px-2 sm:px-3 py-1 rounded-full whitespace-nowrap ${Ke}`,children:z2(v.status)})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsxs("button",{className:"inline-flex items-center justify-center w-full sm:w-auto bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 disabled:opacity-70 transition text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",onClick:()=>G(v),disabled:q?.action?.type==="update"&&q.action.targetId===v.id,children:[a.jsx(gn,{className:"mr-2"}),"Edit"]}),a.jsx("button",{className:"inline-flex items-center justify-center w-full sm:w-auto px-4 py-2 rounded-md text-sm bg-red-500 text-white hover:bg-red-600 transition focus:outline-none focus:ring-2 focus:ring-red-400",onClick:()=>W(v),disabled:!!ie,children:Me?"Deleting...":a.jsxs(a.Fragment,{children:[a.jsx(wa,{className:"mr-2"}),"Delete"]})})]})]}),a.jsx("div",{className:"border-b border-gray-200 my-5"}),a.jsxs("div",{className:"p-6 lg:p-4",children:[a.jsx("div",{className:"flex w-full bg-[#6A727D] text-white mt-1 overflow-x-auto mb-6",children:["Overview","Activities"].map(Ge=>a.jsx("button",{onClick:()=>fe(Ge),className:`flex-1 min-w-[90px] px-4 py-2.5 text-xs sm:text-sm font-medium text-center transition-all duration-200 border-b-2
        ${Ne===Ge?"bg-paper-white text-[#6A727D] border-white":"text-white hover:bg-[#5c636d]"}`,children:Ge},Ge))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 items-start",children:[a.jsxs("div",{className:"lg:col-span-3",children:[Ne==="Overview"&&a.jsxs("div",{className:"h-full max-h-100 md:max-h-70 overflow-y-auto hide-scrollbar",children:[a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 md:p-8 border border-gray-200",children:a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4 sm:gap-6 text-sm text-gray-700",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Website:"}),a.jsx("p",{children:v.website?a.jsx("a",{href:v.website,className:"text-blue-600 hover:underline break-all",target:"_blank",rel:"noopener noreferrer",children:v.website}):"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Industry:"}),a.jsx("p",{children:v.industry||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Parent Company:"}),a.jsx("p",{children:v.parent_company||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Territory:"}),a.jsx("p",{children:v.territory?.name||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Phone Number:"}),a.jsx("p",{children:v.phone_number||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Billing Address:"}),a.jsx("p",{children:v.billing_address||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Shipping Address:"}),a.jsx("p",{children:v.shipping_address||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Assigned To:"}),a.jsx("p",{children:v.assigned_accs?`${v.assigned_accs.first_name} ${v.assigned_accs.last_name}`:"Unassigned"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created By:"}),a.jsx("p",{children:v.acc_creator?`${v.acc_creator.first_name} ${v.acc_creator.last_name}`:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created At:"}),a.jsx("p",{children:Oe(v.created_at)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Last Updated:"}),a.jsx("p",{children:Oe(v.updated_at)||"N/A"})]})]})}),a.jsx(Tn,{comments:tt,onAddComment:lt})]}),Ne==="Notes"&&a.jsxs("div",{className:"mt-4 w-full",children:[a.jsx("div",{className:"flex flex-wrap items-center justify-between mb-4 gap-2",children:a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words",children:"Account Note"})}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 shadow-sm break-words",children:[a.jsx("div",{className:"flex items-start justify-between",children:a.jsx("div",{children:a.jsx("p",{className:"text-sm font-medium text-gray-800 break-words",children:"Note"})})}),a.jsx("div",{className:"mt-3 text-sm text-gray-700 whitespace-pre-wrap break-words",children:y.notes||"No notes available."})]})]}),Ne==="Activities"&&a.jsxs("div",{className:"space-y-2 w-full h-full max-h-[50dvh] overflow-y-auto bg-gray-50 p-2 hide-scrollbar rounded-lg border border-gray-200 shadow-sm",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words border-b border-gray-300 py-2",children:"Related Activities"}),a.jsxs("div",{className:"space-y-2 text-sm",children:[me.tasks&&me.tasks.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>We(Ee==="tasks"?null:"tasks"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Qt,{className:"text-blue-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Tasks (",me.tasks.length,")"]})]}),Ee==="tasks"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Ee==="tasks"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:me.tasks.map((Ge,Ae)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/admin/tasks",{state:{taskID:Ge.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-blue-600 mt-1",children:a.jsx(Qt,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:Ge.subject||Ge.title||"Task"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:Ge.description||"No description"}),Ge.assigned_to&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Assigned: ",Ge.assigned_to.first_name," ",Ge.assigned_to.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:Oe(Ge.due_date||Ge.created_at)})]},`task-${Ae}`))})]}),me.meetings&&me.meetings.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>We(Ee==="meetings"?null:"meetings"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ot,{className:"text-green-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Meetings (",me.meetings.length,")"]})]}),Ee==="meetings"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Ee==="meetings"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:me.meetings.map((Ge,Ae)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/admin/meetings",{state:{meetingID:Ge.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-green-600 mt-1",children:a.jsx(Ot,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:Ge.subject||Ge.title||"Meeting"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:Ge.description||Ge.location||"No description"}),Ge.host&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Host: ",Ge.host.first_name," ",Ge.host.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:Oe(Ge.start_time||Ge.created_at)})]},`meeting-${Ae}`))})]}),me.calls&&me.calls.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>We(Ee==="calls"?null:"calls"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(It,{className:"text-purple-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Calls (",me.calls.length,")"]})]}),Ee==="calls"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Ee==="calls"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:me.calls.map((Ge,Ae)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/admin/calls",{state:{callID:Ge.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-purple-600 mt-1",children:a.jsx(It,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:Ge.subject||Ge.title||"Call"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:Ge.direction||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:Oe(Ge.call_time||Ge.created_at)})]},`call-${Ae}`))})]}),me.contacts&&me.contacts.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>We(Ee==="contacts"?null:"contacts"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ra,{className:"text-teal-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Contacts (",me.contacts.length,")"]})]}),Ee==="contacts"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Ee==="contacts"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:me.contacts.map((Ge,Ae)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/admin/contacts",{state:{contactID:Ge.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-teal-600 mt-1",children:a.jsx(ra,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("h4",{className:"font-medium text-blue-600 break-words text-sm",children:[Ge.first_name?`${Ge.first_name} `:"",Ge.last_name]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:Ge.title||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:Oe(Ge.created_at)})]},`contact-${Ae}`))})]}),me.deals&&me.deals.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>We(Ee==="deals"?null:"deals"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(sa,{className:"text-indigo-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Deals (",me.deals.length,")"]})]}),Ee==="deals"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Ee==="deals"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:me.deals.map((Ge,Ae)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/admin/deals",{state:{dealID:Ge.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-indigo-600 mt-1",children:a.jsx(sa,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("h4",{className:"font-medium text-blue-600 break-words text-sm",children:[Ge.deal_id?Ge.deal_id.replace(/D(\d+)-\d+-/,"D$1-"):"--"," ",Ge.name||Ge.title||"Deal"]}),a.jsx("p",{className:"text-xs text-gray-500 break-words capitalize",children:Ge.stage||Ge.description||"No description"})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:Oe(Ge.close_date||Ge.created_at)})]},`deal-${Ae}`))})]}),me.quotes&&me.quotes.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>We(Ee==="quotes"?null:"quotes"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ia,{className:"text-orange-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Quotes (",me.quotes.length,")"]})]}),Ee==="quotes"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Ee==="quotes"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:me.quotes.map((Ge,Ae)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/admin/quotes",{state:{quoteID:Ge.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-orange-600 mt-1",children:a.jsx(ia,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:(Ge.quote_id?Ge.quote_id.replace(/Q(\d+)-\d+-/,"Q$1-"):"--")||"Quote"}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:Ge.status||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:Oe(Ge.presented_date)||""})]},`quote-${Ae}`))})]}),(!me||(!me.tasks||me.tasks.length===0)&&(!me.meetings||me.meetings.length===0)&&(!me.calls||me.calls.length===0)&&(!me.quotes||me.quotes.length===0)&&(!me.deals||me.deals.length===0)&&(!me.contacts||me.contacts.length===0))&&a.jsx("div",{className:"text-center py-8 text-gray-500",children:a.jsx("p",{children:"No related activities found for this account."})})]})]})]}),a.jsxs("div",{className:"flex flex-col gap-4",children:[a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Quick Actions"}),a.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[a.jsxs("button",{onClick:()=>e("/admin/calls",{state:{openCallModal:!0,initialCallData:{subject:`Call with ${v.name}`,relatedType1:"Account",relatedTo1:String(v.id),relatedType2:null,relatedTo2:null,assigned_to:v.assigned_accs?.id?String(v.assigned_accs.id):"",direction:"Outgoing",status:"Planned"}}}),className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(It,{className:"text-gray-600 w-4 h-4"}),"Schedule Call"]}),a.jsxs("button",{onClick:()=>e("/admin/meetings",{state:{openMeetingModal:!0,initialMeetingData:{subject:`Meeting with ${v.name}`,relatedType1:"Account",relatedTo1:String(v.id),relatedType2:null,relatedTo2:null,assignedTo:v.assigned_accs?.id?String(v.assigned_accs.id):"",status:"Planned"}}}),className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(Ot,{className:"text-gray-600 w-4 h-4"}),"Book Meeting"]}),a.jsxs("button",{onClick:()=>e("/admin/tasks",{state:{openTaskModal:!0,initialTaskData:{subject:`Follow up with ${v.name}`,relatedType1:"Account",relatedTo1:String(v.id),relatedType2:null,relatedTo2:null,assignedTo:v.assigned_accs?.id?String(v.assigned_accs.id):"",priority:"NORMAL",status:"Not Started"}}}),className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(Qt,{className:"text-gray-600 w-4 h-4"}),"Tasks"]})]})]}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm w-full",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Status"}),a.jsx("select",{className:"border border-gray-200 rounded-md px-2 sm:px-3 py-1.5 w-full text-sm mb-2 focus:ring-2 focus:ring-indigo-500 outline-none",value:we||lr(v?.status)||"PROSPECT",onChange:Ge=>de(Ge.target.value),children:R2.map(Ge=>a.jsx("option",{value:Ge.value,children:Ge.label},Ge.value))}),a.jsx("button",{onClick:F,disabled:ke||!we||lr(we)===lr(v?.status),className:`w-full py-1.5 rounded-md text-sm transition focus:outline-none focus:ring-2 ${ke||!we||lr(we)===lr(v?.status)?"bg-gray-400 cursor-not-allowed text-white":"bg-gray-900 text-white hover:bg-gray-800 focus:ring-gray-400"}`,children:ke?"Updating...":"Update"})]})]})]})]})]})}):null,Ct=a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[w&&a.jsx(Wt,{message:"Loading accounts..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h2",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(Za,{className:"mr-2 text-blue-600"}),"Accounts Management"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{onClick:()=>{Qe(),De(!1)},className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 my-1 lg:my-0 rounded-md hover:bg-gray-800 text-sm sm:text-base mx-auto sm:ml-auto cursor-pointer",children:[a.jsx(aa,{className:"mr-2"})," Add Account"]})})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4 mb-6 w-full break-words overflow-hidden lg:overflow-visible",children:St.map(Ge=>a.jsx(RCe,{...Ge},Ge.title))}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search accounts",value:B,onChange:Ge=>R(Ge.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsx("div",{className:"w-full lg:w-1/4",children:a.jsx("select",{value:D,onChange:Ge=>U(Ge.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:Ie.map(Ge=>a.jsx("option",{value:Ge.value,children:Ge.label},Ge.value))})})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[500px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 text-sm tracking-wide font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 text-center w-12",children:a.jsx("input",{type:"checkbox",checked:ce.length>0&&ce.every(Ge=>$e.includes(Ge.id)),onChange:Q,className:"form-checkbox h-4 w-4 text-blue-600 rounded focus:ring-blue-500 border-gray-300"})}),a.jsx("th",{className:"py-3 px-4 truncate",children:"Account"}),a.jsx("th",{className:"py-3 px-4",children:"Status"}),a.jsx("th",{className:"py-3 px-4",children:"Industry"}),a.jsx("th",{className:"py-3 px-4",children:"Territory"}),a.jsx("th",{className:"py-3 px-4",children:"Phone"}),a.jsx("th",{className:"py-3 px-4 text-center w-24",children:$e.length>0?a.jsx("button",{onClick:ae,className:"text-red-600 hover:text-red-800 transition p-1 rounded-full hover:bg-red-50",title:`Delete ${$e.length} selected items`,children:a.jsx(wa,{size:18})}):""})]})}),a.jsx("tbody",{children:w?a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:7,children:"Loading accounts..."})}):_e.length>0?ce.map(Ge=>a.jsxs("tr",{className:"hover:bg-gray-50 text-xs cursor-pointer",onClick:()=>{Et(Ge),Be(Ge.id)},children:[a.jsx("td",{className:"py-3 px-4 text-center",children:a.jsx("input",{type:"checkbox",checked:$e.includes(Ge.id),onChange:()=>ne(Ge.id),onClick:Ae=>Ae.stopPropagation(),className:"form-checkbox h-4 w-4 text-blue-600 rounded focus:ring-blue-500 border-gray-300"})}),a.jsx("td",{className:"py-3 px-4",children:a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-blue-600 hover:underline break-all text-sm",children:Ge.name}),a.jsx("div",{className:"text-gray-500 text-xs break-all",children:Ge.website||"--"})]})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${ICe(Ge.status)}`,children:z2(Ge.status)})}),a.jsx("td",{className:"py-3 px-4 text-sm",children:Ge.industry||"--"}),a.jsx("td",{className:"py-3 px-4 text-sm",children:Ge.territory?.name||"--"}),a.jsx("td",{className:"py-3 px-4",children:a.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[a.jsx(It,{className:"text-gray-500"}),a.jsx("span",{children:Ge.phone_number||"--"})]})}),a.jsx("td",{className:"py-3 px-4 text-center"})]},Ge.id)):a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:7,children:"No accounts found."})})})]})}),a.jsx(ca,{className:"mt-4",totalItems:_e.length,pageSize:se,currentPage:je,onPrev:Pe,onNext:Te,onPageSizeChange:Ge=>{ye(Ge),X(1)},pageSizeOptions:[10,20,30,40,50],label:"accounts"})]}),Ht=n?a.jsx("div",{id:"modalBackdrop",onClick:ve,className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-full sm:max-w-3xl rounded-2xl shadow-lg p-4 sm:p-6 md:p-8 relative border border-gray-200 overflow-y-auto hide-scrollbar max-h-[90vh]",onClick:Ge=>Ge.stopPropagation(),children:[a.jsx("button",{onClick:()=>{xe(),De(!1)},className:"absolute top-4 right-4 text-gray-500 hover:text-black transition",disabled:o||V,children:a.jsx(ea,{size:22})}),a.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800 mb-4 sm:mb-6 flex items-center justify-center",children:r?"Edit Account":"Add New Account"}),a.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",onSubmit:le,noValidate:!0,children:[a.jsx("div",{className:"md:col-span-2",children:a.jsx(Zm,{label:"Name",name:"name",value:p.name,onChange:Ce,placeholder:"Company name",required:!0,isSubmitted:ue})}),a.jsx(DR,{label:"Parent Company",value:p.parent_company,onChange:Ge=>{x(Ae=>({...Ae,parent_company:Ge}))},items:z.map(Ge=>({id:Ge,name:Ge})),getLabel:Ge=>Ge?.name||"",placeholder:"Select parent company...",disabled:o}),a.jsx(Zm,{label:"Website",name:"website",value:p.website,onChange:Ce,placeholder:"https://example.com",disabled:o}),a.jsx(Zm,{label:"Phone Number",name:"phone_number",value:p.phone_number,onChange:Ce,placeholder:"09xx xxx xxxx",type:"tel",disabled:o}),a.jsx(Zm,{label:"Industry",name:"industry",value:p.industry,onChange:Ce,placeholder:"Industry",disabled:o}),a.jsx(Zm,{label:"Billing Address",name:"billing_address",value:p.billing_address,onChange:Ce,placeholder:"Billing address",disabled:o}),a.jsx(Zm,{label:"Shipping Address",name:"shipping_address",value:p.shipping_address,onChange:Ce,placeholder:"Shipping address",disabled:o}),a.jsx(PR,{label:"Status",name:"status",value:p.status,onChange:Ce,options:[{value:"",label:"Select status"},...R2],required:!0,disabled:o}),a.jsx(DR,{label:"Assigned To",value:p.assigned_to,onChange:Ge=>{const Ae=_.find(L=>String(L.id)===String(Ge));A(Ae);let I=null;Ae&&Ae.assigned_territory&&Ae.assigned_territory.length===1&&(I=Ae.assigned_territory[0].id),x(L=>({...L,assigned_to:Ge,territory_id:I}))},items:_||[],getLabel:Ge=>`${Ge?.first_name??""} ${Ge?.last_name??""} (${Ge?.role?.toUpperCase()==="CEO"?"Admin":Ge?.role??""})`.trim(),placeholder:"Search assignee...",required:!0,isSubmitted:ue,disabled:o||_.length===0}),a.jsx("div",{className:"md:col-span-2",children:a.jsx(PR,{label:"Territory",name:"territory_id",value:p.territory_id||"",onChange:Ce,options:[{value:"",label:T?T.assigned_territory&&T.assigned_territory.length>0?"Select Territory":"No territories assigned to this user":"Select a user first"},...T&&T.assigned_territory&&T.assigned_territory.map(Ge=>({value:String(Ge.id),label:Ge.name}))||[]],disabled:o||!T||!T.assigned_territory||T.assigned_territory.length===0})}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-end sm:justify-end space-y-2 sm:space-y-0 sm:space-x-2 col-span-1 md:col-span-2 mt-4 w-full",children:[a.jsx("button",{type:"button",onClick:()=>{xe(),De(!1)},className:"w-full sm:w-auto px-4 py-2 text-white bg-red-400 border border-red-300 rounded hover:bg-red-500 transition disabled:opacity-70",disabled:o||V,children:"Cancel"}),a.jsx("button",{type:"submit",className:"w-full sm:w-auto px-4 py-2 text-white border border-tertiary bg-tertiary rounded hover:bg-secondary transition disabled:opacity-70",disabled:o||V,children:o?"Saving...":r?"Update Account":"Save Account"})]})]})]})}):null,da=q?a.jsx(FCe,{open:!0,title:q.title,message:q.message,confirmLabel:q.confirmLabel,cancelLabel:q.cancelLabel,variant:q.variant,onConfirm:J,onCancel:Y,loading:V}):null;return a.jsxs(a.Fragment,{children:[Ct,gt,Ht,da]})}function RCe({icon:e,title:t,value:n,color:s="text-blue-600",bgColor:r="bg-blue-100",onClick:i}){const o=()=>{typeof i=="function"?i():console.log(`Clicked: ${t}`)};return a.jsxs("div",{className:"flex items-center p-4 bg-white rounded-xl shadow-md border border-gray-200 transition-all duration-300",onClick:o,children:[a.jsx("div",{className:`flex-shrink-0 p-3 rounded-full ${r} ${s} mr-4`,children:e?a.jsx(e,{size:22}):null}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:t}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:n})]})]})}function Zm({label:e,name:t,value:n,onChange:s,placeholder:r,type:i="text",required:o=!1,disabled:l=!1,className:c="",isSubmitted:u=!1}){const d=u&&!n?.trim();return a.jsxs("div",{children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",o&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:i,name:t,value:n??"",onChange:s,placeholder:r,required:o,disabled:l,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border focus:ring-2
          ${d?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}
          ${c}
        `})]})}function PR({label:e,name:t,value:n,onChange:s,options:r,required:i=!1,disabled:o=!1}){return a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsx("select",{name:t,value:n??"",onChange:s,required:i,disabled:o,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100",children:r.map(l=>a.jsx("option",{value:l.value,children:l.label},l.value))})]})}function DR({label:e,items:t=[],value:n="",onChange:s,getLabel:r,placeholder:i="Search...",disabled:o=!1,className:l="",required:c=!1,isSubmitted:u=!1,allowFreeText:d=!1}){const h=u&&c&&!n;return a.jsxs("div",{className:l,children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",c&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx(zCe,{items:t,value:n??"",onChange:s,getLabel:r,placeholder:i,disabled:o,hasError:h,allowFreeText:d})]})}function zCe({items:e=[],value:t="",onChange:n,getLabel:s,placeholder:r="Search...",disabled:i=!1,maxRender:o=200,hasError:l=!1,allowFreeText:c=!1}){const[u,d]=f.useState(!1),[h,p]=f.useState(""),x=f.useRef(null),v=e.find(N=>String(N.id)===String(t)),j=v?s(v):t,y=f.useMemo(()=>{const N=h.trim().toLowerCase();return(N?e.filter(S=>(s(S)||"").toLowerCase().includes(N)):e).slice(0,o)},[e,h,s,o]);return f.useEffect(()=>{const N=w=>{x.current&&!x.current.contains(w.target)&&d(!1)};return document.addEventListener("mousedown",N),()=>document.removeEventListener("mousedown",N)},[]),f.useEffect(()=>{u||p("")},[u]),a.jsxs("div",{ref:x,className:"relative w-full",children:[a.jsx("input",{disabled:i,value:u?h:j,placeholder:r,onFocus:()=>!i&&d(!0),onChange:N=>{p(N.target.value),u||d(!0)},className:`w-full border rounded-md px-2 py-1.5 text-sm outline-none focus:ring-2
          ${l?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}`}),u&&!i&&a.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg overflow-hidden",children:[a.jsxs("div",{className:"max-h-56 overflow-y-auto hide-scrollbar",children:[c&&h.trim()&&!y.some(N=>s(N).toLowerCase()===h.trim().toLowerCase())&&a.jsxs("button",{type:"button",onClick:()=>{n(h.trim()),d(!1)},className:"w-full text-left px-3 py-2 text-sm hover:bg-green-50 bg-blue-50 font-medium text-blue-700",children:['+ Add "',h.trim(),'" as new parent company']}),y.length>0?y.map(N=>{const w=String(N.id),S=s(N),_=String(t)===w;return a.jsx("button",{type:"button",onClick:()=>{n(w),d(!1)},className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-50 ${_?"bg-blue-50":""}`,children:S||"--"},w)}):!c||!h.trim()?a.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No results"}):null]}),e.length>o&&a.jsxs("div",{className:"px-3 py-2 text-[11px] text-gray-400 border-t",children:["Showing first ",o," results  keep typing to narrow."]})]})]})}function FCe({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o=!1,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsx("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${u}`,disabled:o,children:o?"Processing...":s})]})]})})}function Vx(e){return Dt({attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M4 2.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zm3 0a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zm3.5-.5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5zM4 5.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zM7.5 5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5zm2.5.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zM4.5 8a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5zm2.5.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zm3.5-.5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5z"},child:[]},{tag:"path",attr:{d:"M2 1a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1zm11 0H3v14h3v-2.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5V15h3z"},child:[]}]})(e)}const nb={first_name:"",last_name:"",account_id:"",title:"",department:"",email:"",work_phone:"",mobile_phone_1:"",mobile_phone_2:"",notes:"",assigned_to:""},yl=e=>[e?.first_name,e?.last_name].filter(Boolean).join(" ").trim(),fo=e=>e?new Date(e).toLocaleString("en-US",{month:"short",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).replace(",",""):"";function UCe(){const e=kt(),t=ta();f.useEffect(()=>{document.title="Contacts | Sari-Sari CRM"},[]);const[n,s]=f.useState([]),[r,i]=f.useState(!1),[o,l]=f.useState([]),[c,u]=f.useState([]),[d,h]=f.useState(null),[p,x]=f.useState(!1),[v,j]=f.useState(!1),[y,N]=f.useState(!1),[w,S]=f.useState(null),[_,k]=f.useState(!1),[T,A]=f.useState(null),[E,M]=f.useState(nb),[z,P]=f.useState(""),[D,U]=f.useState("Filter by Accounts"),[B,R]=f.useState(null),[q,Z]=f.useState("Overview"),[V,oe]=f.useState(1),[je,X]=f.useState(10),[se,ye]=f.useState({}),[Ne,fe]=f.useState(null),[we,de]=f.useState([]),[ke,ge]=f.useState(null),{comments:$e,addComment:be,refresh:me}=kn({relatedType:"contact",relatedId:d?.id});f.useEffect(()=>{d?.id&&me()},[d?.id,me]),f.useEffect(()=>{const G=t.state?.contactID;G&&(ge(G),e(t.pathname,{replace:!0,state:{}}))},[t,e]),f.useEffect(()=>{if(ke&&n.length>0&&!r){const G=n.find(W=>W.id===ke);G?h(G):H.error("Contact not found."),ge(null)}},[ke,n,r]);const Ue=f.useCallback(async(G=null)=>{i(!0);try{const W=await re.get("/contacts/admin/fetch-all"),Y=[...Array.isArray(W.data)?W.data:[]].sort((F,ue)=>{const De=F?.created_at||F?.updated_at||0,le=ue?.created_at||ue?.updated_at||0;return new Date(le)-new Date(De)});if(s(Y),G){const F=Y.find(ue=>ue.id===G);h(F||null)}}catch(W){console.error(W),s([]),W.response?.status===403?H.error("Permission denied. Only CEO, Admin, or Group Manager can access this page."):H.error("Failed to fetch contacts. Please try again later.")}finally{i(!1)}},[h]),Ee=f.useCallback(async()=>{try{const G=await re.get("/accounts/admin/fetch-all"),J=[...Array.isArray(G.data)?G.data:[]].sort((Y,F)=>(Y?.name||"").localeCompare(F?.name||""));l(J)}catch(G){console.error(G),l([]),G.response?.status===403&&H.warn("Unable to load accounts (permission denied).")}},[]),We=f.useCallback(()=>{window.open("/admin/accounts?openModal=1","_blank","noopener,noreferrer")},[]),tt=f.useCallback(async()=>{try{const G=await re.get("/users/all"),J=[...Array.isArray(G.data)?G.data:[]].sort((Y,F)=>yl(Y).localeCompare(yl(F)));u(J)}catch(G){console.error(G),u([]),G.response?.status===403&&H.warn("Unable to load users for assignment (permission denied).")}},[]),lt=f.useCallback(async G=>{try{const W=await re.get(`/activities/contact/${G}`);ye(W.data&&typeof W.data=="object"?W.data:{})}catch(W){console.error(W),W.response?.status===404&&(console.warn("No activities found for this account."),ye({}))}},[]);f.useEffect(()=>{Ue(),Ee(),tt()},[Ue,Ee,tt]);const Fe=f.useMemo(()=>{const G=new Map;o.forEach(J=>{J?.id&&J?.name&&G.set(String(J.id),J.name)}),n.forEach(J=>{J?.account_id&&J?.account?.name&&G.set(String(J.account_id),J.account.name)});const W=Array.from(G.entries()).sort((J,Y)=>J[1].localeCompare(Y[1])).map(([J,Y])=>({value:J,label:Y}));return[{value:"Filter by Accounts",label:"Filter by Accounts"},...W]},[o,n]),st=f.useMemo(()=>{const G=z.trim().toLowerCase(),W=D.trim();return n.filter(J=>{const Y=[J?.first_name,J?.last_name,J?.email,J?.title,J?.department,J?.account?.name,J?.account?.status,J?.work_phone,J?.mobile_phone_1,J?.mobile_phone_2,J?.assigned_contact?.first_name,J?.assigned_contact?.last_name,J?.contact_creator?.first_name,J?.contact_creator?.last_name,J?.notes,fo(J?.created_at),fo(J?.updated_at)],F=G===""||Y.some(De=>De==null?!1:De.toString().toLowerCase().includes(G)),ue=W==="Filter by Accounts"||String(J.account_id)===W;return F&&ue})},[n,z,D]),Xe=Math.max(1,Math.ceil(st.length/je)||1);f.useEffect(()=>{oe(1)},[z,D,je]),f.useEffect(()=>{oe(G=>{const W=Math.max(1,Math.ceil(st.length/je)||1);return G>W?W:G})},[st.length,je]);const Ze=f.useMemo(()=>{const G=(V-1)*je;return st.slice(G,G+je)},[st,V,je]),Je=()=>oe(G=>Math.max(G-1,1)),Be=()=>oe(G=>Math.min(G+1,Xe)),_e=G=>{if(G.target.checked){const W=Ze.map(J=>J.id);de(W)}else de([])},pe=G=>{de(W=>W.includes(G)?W.filter(J=>J!==G):[...W,G])},ce=async()=>{we.length!==0&&S({title:"Delete Contacts",message:a.jsxs("span",{children:["Are you sure you want to delete"," ",a.jsx("span",{className:"font-semibold",children:we.length})," selected contacts? This action cannot be undone."]}),confirmLabel:`Delete ${we.length} Contact(s)`,cancelLabel:"Cancel",variant:"danger",action:{type:"bulk-delete",contact_ids:we}})},Q=f.useCallback(()=>{x(!1),j(!1),A(null),M(nb),N(!1),qe(!1)},[]),ne=G=>{G.target.id==="modalBackdrop"&&!y&&!_&&Q()},ae=G=>{const{name:W,value:J}=G.target;M(Y=>({...Y,[W]:J}))},Pe=()=>{M(nb),j(!1),A(null),x(!0)};f.useEffect(()=>{const G=new URLSearchParams(t.search||"");(t.state?.openContactModal||G.get("openModal")==="1")&&(M(nb),j(!1),A(null),x(!0),qe(!1),e(t.pathname,{replace:!0,state:{}}))},[t.state,t.pathname,t.search,e]);const Te=G=>{G&&(M({first_name:G.first_name||"",last_name:G.last_name||"",account_id:G.account_id?String(G.account_id):"",title:G.title||"",department:G.department||"",email:G.email||"",work_phone:G.work_phone||"",mobile_phone_1:G.mobile_phone_1||"",mobile_phone_2:G.mobile_phone_2||"",notes:G.notes||"",assigned_to:G.assigned_to?String(G.assigned_to):""}),j(!0),A(G.id),x(!0),h(null))},he=G=>{if(!G)return;const W=yl(G)||"this contact";S({title:"Delete Contact",message:a.jsxs("span",{children:["Are you sure you want to permanently delete"," ",a.jsx("span",{className:"font-semibold",children:W}),"? This action cannot be undone."]}),confirmLabel:"Delete Contact",cancelLabel:"Cancel",variant:"danger",action:{type:"delete",targetId:G.id,name:W}})},[He,qe]=f.useState(!1),nt=G=>{G.preventDefault(),qe(!0);const W=E.last_name.trim();if(!W){H.error("Last name is required.");return}if(!E.account_id){H.error("Account is required.");return}if(!E.assigned_to){H.error("Assigned To is required.");return}const Y=E.email?.trim();if(!Y){H.error("Email is required.");return}if(!Y.includes("@")){H.error("Email must contain '@'.");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(Y)){H.error("Please enter a valid email address.");return}const ue=E.first_name?.trim()||"",De={first_name:ue,last_name:W,account_id:Number(E.account_id),title:E.title?.trim()||null,department:E.department?.trim()||null,email:E.email?.trim().toLowerCase()||null,work_phone:E.work_phone?.trim()||null,mobile_phone_1:E.mobile_phone_1?.trim()||null,mobile_phone_2:E.mobile_phone_2?.trim()||null,notes:E.notes?.trim()||null,assigned_to:E.assigned_to?Number(E.assigned_to):null},le=v&&T?"update":"create",Ie=`${ue} ${W}`.trim();S({title:le==="create"?"Confirm New Contact":"Confirm Update",message:le==="create"?a.jsxs("span",{children:["Are you sure you want to add"," ",a.jsx("span",{className:"font-semibold",children:Ie})," to your contacts?"]}):a.jsxs("span",{children:["Save changes to ",a.jsx("span",{className:"font-semibold",children:Ie}),"?"]}),confirmLabel:le==="create"?"Create Contact":"Update Contact",cancelLabel:"Cancel",variant:"primary",action:{type:le,payload:De,targetId:T||null,name:Ie}})},ot=async()=>{if(!w?.action){S(null);return}const{action:G}=w,{type:W,payload:J,targetId:Y,name:F}=G;k(!0);try{if(W==="create"){N(!0),await re.post("/contacts/admin",J),H.success(`Contact "${F}" created successfully.`);const ue=d?.id||null;Q(),await Ue(ue)}else if(W==="update"){if(!Y)throw new Error("Missing contact identifier for update.");N(!0),await re.put(`/contacts/admin/${Y}`,J),H.success(`Contact "${F}" updated successfully.`);const ue=d?.id&&d.id===Y?Y:d?.id||null;Q(),await Ue(ue),d?.id===Y&&h(null)}else if(W==="delete"){if(!Y)throw new Error("Missing contact identifier for deletion.");const ue=d?.id;R(Y),await re.delete(`/contacts/admin/${Y}`),H.success(`Contact "${F}" deleted successfully.`),await Ue(ue&&ue!==Y?ue:null),ue===Y&&h(null)}else if(W==="bulk-delete"){const ue=G.contact_ids;await re.delete("/contacts/admin/bulk-delete",{data:{contact_ids:ue}}),H.success(`Successfully deleted ${ue.length} contacts`),de([]),await Ue()}}catch(ue){console.error(ue);const De=W==="create"?"Failed to create contact. Please review the details and try again.":W==="update"?"Failed to update contact. Please review the details and try again.":W==="bulk-delete"?"Failed to delete selected contacts.":"Failed to delete contact. Please try again.",le=ue.response?.data?.detail||De;H.error(le)}finally{(W==="create"||W==="update")&&N(!1),W==="delete"&&R(null),k(!1),S(null)}},Re=()=>{_||S(null)},it=G=>{h(G),Z("Overview")},St=()=>h(null),Et=G=>{G.target.id==="contactModalBackdrop"&&!_&&St()},Tt=w?.action?.type==="delete"?w.action.targetId:null,Nt=d&&(B===d.id||Tt===d.id),xe=d&&B===d.id,ve=d?a.jsx("div",{id:"contactModalBackdrop",onClick:Et,className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-6xl max-h-[92vh] overflow-y-auto hide-scrollbar animate-scale-in font-inter relative",onClick:G=>G.stopPropagation(),children:[a.jsxs("div",{className:"bg-tertiary w-full rounded-t-xl relative p-3 lg:p-3",children:[a.jsx("h1",{className:"lg:text-3xl text-xl text-white font-semibold text-center w-full",children:"Contact"}),a.jsx("button",{onClick:St,className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-white cursor-pointer",children:a.jsx(Ja,{size:25})})]}),a.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between lg:flex-row lg:items-center lg:justify-between mt-3 gap-2 px-2 md:items-center lg:gap-4 md:mx-7 lg:mx-7",children:[a.jsx("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:a.jsx("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-800",children:yl(d)||"Unnamed contact"})}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsxs("button",{className:"inline-flex items-center justify-center w-full sm:w-auto bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 disabled:opacity-70 transition text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",onClick:()=>Te(d),disabled:_||w?.action?.type==="update"&&w.action.targetId===d.id,children:[a.jsx(gn,{className:"mr-2"}),"Edit"]}),a.jsx("button",{className:"inline-flex items-center justify-center w-full sm:w-auto px-4 py-2 rounded-md text-sm bg-red-500 text-white hover:bg-red-600 transition focus:outline-none focus:ring-2 focus:ring-red-400",onClick:()=>he(d),disabled:!!Nt,children:xe?"Deleting...":a.jsxs(a.Fragment,{children:[a.jsx(wa,{className:"mr-2"}),"Delete"]})})]})]}),a.jsx("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-2 px-2 lg:gap-4 md:mx-7 lg:mx-7",children:a.jsx("p",{className:"text-sm text-gray-500",children:d.account?.name||"No associated account"})}),a.jsx("div",{className:"border-b border-gray-200 my-5"}),a.jsxs("div",{className:"p-6 lg:p-4",children:[a.jsx("div",{className:"flex w-full bg-[#6A727D] text-white mt-1 overflow-x-auto mb-6",children:["Overview","Notes","Activities"].map(G=>a.jsx("button",{onClick:()=>Z(G),className:`flex-1 min-w-[90px] px-4 py-2.5 text-xs sm:text-sm font-medium text-center transition-all duration-200 border-b-2
        ${q===G?"bg-paper-white text-[#6A727D] border-white":"text-white hover:bg-[#5c636d]"}`,children:G},G))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 items-start",children:[a.jsxs("div",{className:"lg:col-span-3",children:[q==="Overview"&&a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 md:p-8 border border-gray-200",children:a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4 sm:gap-6 text-sm text-gray-700",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Contact Name:"}),a.jsx("p",{children:yl(d)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Title:"}),a.jsx("p",{children:d.title||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Email:"}),a.jsx("p",{children:d.email?a.jsx("a",{href:`mailto:${d.email}`,className:"text-blue-600 hover:underline break-all",children:d.email}):"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Department:"}),a.jsx("p",{children:d.department||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Work Phone:"}),a.jsx("p",{children:d.work_phone||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Mobile Phone 1:"}),a.jsx("p",{children:d.mobile_phone_1||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Mobile Phone 2:"}),a.jsx("p",{children:d.mobile_phone_2||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Assigned To:"}),a.jsx("p",{children:d.assigned_contact?`${d.assigned_contact.first_name} ${d.assigned_contact.last_name}`:"Unassigned"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created By:"}),a.jsx("p",{children:d.contact_creator?`${d.contact_creator.first_name} ${d.contact_creator.last_name}`:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created At:"}),a.jsx("p",{children:fo(d.created_at)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Last Updated:"}),a.jsx("p",{children:fo(d.updated_at)||"N/A"})]})]})}),q==="Notes"&&a.jsxs("div",{className:"mt-4 w-full",children:[a.jsx("div",{className:"flex flex-wrap items-center justify-between mb-4 gap-2",children:a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words",children:"Contact Note"})}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 shadow-sm break-words",children:[a.jsx("div",{className:"flex items-start justify-between",children:a.jsx("div",{children:a.jsx("p",{className:"text-sm font-medium text-gray-800 break-words",children:"Note"})})}),a.jsx("div",{className:"mt-3 text-sm text-gray-700 whitespace-pre-wrap break-words",children:d.notes||"No notes available."})]}),a.jsx(Tn,{comments:$e,onAddComment:be})]}),q==="Activities"&&a.jsxs("div",{className:"space-y-2 w-full h-full max-h-[50dvh] overflow-y-auto bg-gray-50 p-2 hide-scrollbar rounded-lg border border-gray-200 shadow-sm",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words border-b border-gray-300 py-2",children:"Related Activities"}),a.jsxs("div",{className:"space-y-2 text-sm",children:[se.tasks&&se.tasks.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>fe(Ne==="tasks"?null:"tasks"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Qt,{className:"text-blue-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Tasks (",se.tasks.length,")"]})]}),Ne==="tasks"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Ne==="tasks"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:se.tasks.map((G,W)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/admin/tasks",{state:{taskID:G.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-blue-600 mt-1",children:a.jsx(Qt,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:G.subject||G.title||"Task"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:G.description||"No description"}),G.assigned_to&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Assigned: ",G.assigned_to.first_name," ",G.assigned_to.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:fo(G.due_date||G.created_at)})]},`task-${W}`))})]}),se.meetings&&se.meetings.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>fe(Ne==="meetings"?null:"meetings"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ot,{className:"text-green-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Meetings (",se.meetings.length,")"]})]}),Ne==="meetings"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Ne==="meetings"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:se.meetings.map((G,W)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/admin/meetings",{state:{meetingID:G.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-green-600 mt-1",children:a.jsx(Ot,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:G.subject||G.title||"Meeting"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:G.description||G.location||"No description"}),G.host&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Host: ",G.host.first_name," ",G.host.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:fo(G.start_time||G.created_at)})]},`meeting-${W}`))})]}),se.calls&&se.calls.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>fe(Ne==="calls"?null:"calls"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(It,{className:"text-purple-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Calls (",se.calls.length,")"]})]}),Ne==="calls"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Ne==="calls"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:se.calls.map((G,W)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/admin/calls",{state:{callID:G.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-purple-600 mt-1",children:a.jsx(It,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:G.subject||G.title||"Call"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:G.direction||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:fo(G.call_time||G.created_at)})]},`call-${W}`))})]}),se.deals&&se.deals.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>fe(Ne==="deals"?null:"deals"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(sa,{className:"text-indigo-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Deals (",se.deals.length,")"]})]}),Ne==="deals"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Ne==="deals"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:se.deals.map((G,W)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/admin/deals",{state:{dealID:G.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-indigo-600 mt-1",children:a.jsx(sa,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("h4",{className:"font-medium text-blue-600 break-words text-sm",children:[G.deal_id?G.deal_id.replace(/D(\d+)-\d+-/,"D$1-"):"--"," ",G.name||G.title||"Deal"]}),a.jsx("p",{className:"text-xs text-gray-500 break-words capitalize",children:G.stage||G.description||"No description"})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:fo(G.close_date||G.created_at)})]},`deal-${W}`))})]}),se.quotes&&se.quotes.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>fe(Ne==="quotes"?null:"quotes"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ia,{className:"text-orange-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Quotes (",se.quotes.length,")"]})]}),Ne==="quotes"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Ne==="quotes"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:se.quotes.map((G,W)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/admin/quotes",{state:{quoteID:G.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-orange-600 mt-1",children:a.jsx(ia,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:(G.quote_id?G.quote_id.replace(/Q(\d+)-\d+-/,"Q$1-"):"--")||"Quote"}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:G.status||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:fo(G.presented_date)||""})]},`quote-${W}`))})]}),(!se||(!se.tasks||se.tasks.length===0)&&(!se.meetings||se.meetings.length===0)&&(!se.calls||se.calls.length===0)&&(!se.quotes||se.quotes.length===0)&&(!se.deals||se.deals.length===0)&&(!se.contacts||se.contacts.length===0))&&a.jsx("div",{className:"text-center py-8 text-gray-500",children:a.jsx("p",{children:"No related activities found for this account."})})]})]})]}),a.jsx("div",{className:"flex flex-col gap-4",children:a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Quick Actions"}),a.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[a.jsxs("button",{onClick:()=>e("/admin/calls",{state:{openCallModal:!0,initialCallData:{subject:`Call with ${yl(d)||""}`.trim(),relatedType1:"Account",relatedTo1:d?.account_id?String(d.account_id):d?.account?.id?String(d.account.id):"",relatedType2:"Contact",relatedTo2:d?.id?String(d.id):"",assigned_to:d?.assigned_contact?.id?String(d.assigned_contact.id):"",direction:"Outgoing",status:"Planned"}}}),className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(It,{className:"text-gray-600 w-4 h-4"}),"Schedule Call"]}),a.jsxs("button",{type:"button",onClick:()=>{if(!d?.email){alert("No email address available");return}const G=encodeURIComponent(d.email),W=encodeURIComponent(""),J=encodeURIComponent(""),Y=`mailto:${G}?subject=${W}&body=${J}`;window.location.href=Y},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(rn,{className:"text-gray-600 w-4 h-4"}),"Send E-mail"]}),a.jsxs("button",{className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",onClick:()=>e("/admin/meetings",{state:{openMeetingModal:!0,initialMeetingData:{subject:`Meeting with ${yl(d)||""}`.trim(),relatedType1:"Account",relatedTo1:d?.account_id?String(d.account_id):d?.account?.id?String(d.account.id):"",relatedType2:"Contact",relatedTo2:d?.id?String(d.id):"",assignedTo:d?.assigned_contact?.id?String(d.assigned_contact.id):"",status:"Planned"}}}),children:[a.jsx(Ot,{className:"text-gray-600 w-4 h-4"}),"Book Meeting"]}),a.jsxs("button",{onClick:()=>e("/admin/tasks",{state:{openTaskModal:!0,initialTaskData:{subject:`Task for ${yl(d)||""}`.trim(),relatedType1:"Account",relatedTo1:d?.account_id?String(d.account_id):d?.account?.id?String(d.account.id):"",relatedType2:"Contact",relatedTo2:d?.id?String(d.id):"",assignedTo:d?.assigned_contact?.id?String(d.assigned_contact.id):"",priority:"NORMAL",status:"Not Started"}}}),className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(Qt,{className:"text-gray-600 w-4 h-4"}),"Tasks"]})]})]})})]})]})]})}):null,Oe=a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[r&&a.jsx(Wt,{message:"Loading contacts..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0 w-full",children:[a.jsxs("h2",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(Za,{className:"mr-2 text-blue-600"})," Contacts Management"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{onClick:()=>{Pe(),qe(!1)},className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 rounded-md hover:bg-gray-800 text-sm sm:text-base self-end sm:self-auto cursor-pointer",children:[a.jsx(aa,{className:"mr-2"})," Add Contact"]})})]}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search contacts",value:z,onChange:G=>P(G.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsx("div",{className:"w-full lg:w-1/4",children:a.jsx("select",{value:D,onChange:G=>U(G.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:Fe.map(G=>a.jsx("option",{value:G.value,children:G.label},G.value??G.label))})})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[600px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 text-sm tracking-wide font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 text-center w-12",children:a.jsx("input",{type:"checkbox",className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500 cursor-pointer",checked:Ze.length>0&&we.length===Ze.length,onChange:_e})}),a.jsx("th",{className:"py-3 px-4 truncate",children:"Contact"}),a.jsx("th",{className:"py-3 px-4",children:"Account"}),a.jsx("th",{className:"py-3 px-4 truncate",children:"Contact Info"}),a.jsx("th",{className:"py-3 px-4",children:"Department"}),a.jsx("th",{className:"py-3 px-4",children:"Assigned To"}),a.jsx("th",{className:"py-3 px-4",children:"Created"}),a.jsx("th",{className:"py-3 px-4",children:"Status"}),a.jsx("th",{className:"py-3 px-4 text-center w-24",children:we.length>0?a.jsx("button",{onClick:ce,className:"text-red-600 hover:text-red-800 transition p-1 rounded-full hover:bg-red-50",title:`Delete ${we.length} selected items`,children:a.jsx(wa,{size:18})}):""})]})}),a.jsx("tbody",{children:r?a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:9,children:"Loading contacts..."})}):st.length>0?Ze.map(G=>{const W=[{Icon:rn,value:G.email,key:"email"},{Icon:It,value:G.work_phone,key:"work_phone"},{Icon:fd,value:G.mobile_phone_1,key:"mobile_phone_1"},{Icon:fd,value:G.mobile_phone_2,key:"mobile_phone_2"}].filter(J=>!!J.value);return a.jsxs("tr",{className:"hover:bg-gray-50 text-sm cursor-pointer transition",onClick:J=>{J.target.closest('input[type="checkbox"]')||J.target.closest("button")||(it(G),lt(G.id))},children:[a.jsx("td",{className:"py-3 px-4 text-center align-top",children:a.jsx("input",{type:"checkbox",className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500 cursor-pointer",checked:we.includes(G.id),onChange:()=>pe(G.id)})}),a.jsxs("td",{className:"py-3 px-4 align-top",children:[a.jsx("div",{className:"font-medium text-blue-600 hover:underline break-all text-sm",children:yl(G)||"--"}),a.jsx("div",{className:"text-xs text-gray-500",children:G.title||"No title"})]}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-700",children:[a.jsx(Vx,{className:"text-gray-500 flex-shrink-0"}),a.jsx("span",{className:"break-words",children:G.account?.name||"--"})]})}),a.jsx("td",{className:"py-3 px-4 align-top",children:W.length>0?a.jsx("div",{className:"space-y-1 text-gray-700",children:W.map(({Icon:J,value:Y,key:F})=>{const ue=wt.createElement(J,{className:"text-gray-500 flex-shrink-0"});return a.jsxs("div",{className:"flex items-center space-x-2 break-all text-sm",children:[ue,a.jsx("span",{children:Y})]},F)})}):a.jsx("span",{className:"text-gray-400 text-sm",children:"--"})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsxs("div",{className:"flex items-center space-x-2 text-gray-700 text-sm",children:[a.jsx(sa,{className:"text-gray-500 flex-shrink-0"}),a.jsx("span",{children:G.department||"--"})]})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[a.jsx(ra,{className:"text-gray-500 flex-shrink-0"}),a.jsx("span",{children:G.assigned_contact?`${G.assigned_contact.first_name} ${G.assigned_contact.last_name}`:"Unassigned"})]})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsxs("div",{className:"flex items-center space-x-2 text-gray-500",children:[a.jsx(Ot,{className:"text-gray-500 flex-shrink-0"}),a.jsx("span",{className:"text-xs",children:fo(G.created_at)||"--"})]})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${G.status==="Inactive"?"bg-red-100 text-red-800":"bg-green-100 text-green-800"}`,children:G.status||"Active"})}),a.jsx("td",{className:"py-3 px-4 align-top"})]},G.id)}):a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:9,children:"No contacts found."})})})]})}),a.jsx(ca,{className:"mt-4",totalItems:st.length,pageSize:je,currentPage:V,onPrev:Je,onNext:Be,onPageSizeChange:G=>{X(G),oe(1)},pageSizeOptions:[10,20,30,40,50],label:"contacts"})]}),Ce=p?a.jsx("div",{id:"modalBackdrop",onClick:ne,className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-full sm:max-w-3xl rounded-2xl shadow-lg p-4 sm:p-6 md:p-8 relative border border-gray-200 overflow-y-auto max-h-[90vh] hide-scrollbar",onClick:G=>G.stopPropagation(),children:[a.jsx("button",{onClick:()=>{Q(),qe(!1)},className:"absolute top-4 right-4 text-gray-500 hover:text-black transition disabled:opacity-60",disabled:y||_,children:a.jsx(ea,{size:22})}),a.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800 mb-4 sm:mb-6 flex items-center justify-center",children:v?"Edit Contact":"Add New Contact"}),a.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",onSubmit:nt,noValidate:!0,children:[a.jsx(zc,{label:"First Name",name:"first_name",value:E.first_name,onChange:ae,placeholder:"First name",isSubmitted:He}),a.jsx(zc,{label:"Last Name",name:"last_name",value:E.last_name,onChange:ae,placeholder:"Last name",required:!0,isSubmitted:He}),a.jsx(OR,{label:"Account",value:E.account_id,onChange:G=>M(W=>({...W,account_id:G})),items:o||[],getLabel:G=>G?.name??"",placeholder:"Search account...",actions:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{type:"button",onClick:We,disabled:y,title:"Add account",className:"inline-flex items-center justify-center w-8 h-8 rounded-md border border-gray-300 text-gray-600 hover:bg-gray-50 transition disabled:opacity-60",children:a.jsx(aa,{size:16})}),a.jsx("button",{type:"button",onClick:Ee,disabled:y,title:"Refresh accounts",className:"inline-flex items-center justify-center w-8 h-8 rounded-md border border-gray-300 text-gray-600 hover:bg-gray-50 transition disabled:opacity-60",children:a.jsx(Br,{size:16})})]}),required:!0,isSubmitted:He,disabled:y||o.length===0}),a.jsx(OR,{label:"Assigned To",value:E.assigned_to,onChange:G=>M(W=>({...W,assigned_to:G})),items:c||[],getLabel:G=>`${G?.first_name??""} ${G?.last_name??""} (${G?.role?.toUpperCase()==="CEO"?"Admin":G?.role??""})`.trim(),placeholder:"Search assignee...",required:!0,isSubmitted:He,disabled:y||c.length===0}),a.jsx(zc,{label:"Title",name:"title",value:E.title,onChange:ae,placeholder:"Job title",disabled:y}),a.jsx(zc,{label:"Department",name:"department",value:E.department,onChange:ae,placeholder:"Department",disabled:y}),a.jsx(zc,{label:"Email",name:"email",type:"email",value:E.email,onChange:ae,placeholder:"example@email.com",required:!0,isSubmitted:He}),a.jsx(zc,{label:"Work Phone",name:"work_phone",value:E.work_phone,onChange:ae,placeholder:"09xx xxx xxxx",disabled:y}),a.jsx(zc,{label:"Mobile Phone 1",name:"mobile_phone_1",value:E.mobile_phone_1,onChange:ae,placeholder:"09xx xxx xxxx",disabled:y}),a.jsx(zc,{label:"Mobile Phone 2",name:"mobile_phone_2",value:E.mobile_phone_2,onChange:ae,placeholder:"09xx xxx xxxx",disabled:y}),a.jsx(HCe,{label:"Notes",name:"notes",value:E.notes,onChange:ae,placeholder:"Additional details...",rows:3,disabled:y,className:"md:col-span-2"}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-2 md:col-span-2 mt-4",children:[a.jsx("button",{type:"button",onClick:()=>{Q(),qe(!1)},className:"w-full sm:w-auto px-4 py-2 text-white bg-red-400 border border-red-300 rounded hover:bg-red-500 transition disabled:opacity-70",disabled:y||_,children:"Cancel"}),a.jsx("button",{type:"submit",className:"w-full sm:w-auto px-4 py-2 text-white border border-tertiary bg-tertiary rounded hover:bg-secondary transition disabled:opacity-70",disabled:y||_,children:y?"Saving...":v?"Update Contact":"Save Contact"})]})]})]})}):null,Qe=w?a.jsx(qCe,{open:!0,title:w.title,message:w.message,confirmLabel:w.confirmLabel,cancelLabel:w.cancelLabel,variant:w.variant,onConfirm:ot,onCancel:Re,loading:_}):null;return a.jsxs(a.Fragment,{children:[Oe,ve,Ce,Qe]})}function zc({label:e,name:t,value:n,onChange:s,placeholder:r,type:i="text",required:o=!1,disabled:l=!1,isSubmitted:c=!1,className:u=""}){const d=c&&!n?.trim();return a.jsxs("div",{children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",o&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:i,name:t,value:n??"",onChange:s,placeholder:r,required:o,disabled:l,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border focus:ring-2
          ${d?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}
          ${u}
        `})]})}function OR({label:e,items:t=[],value:n="",onChange:s,getLabel:r,placeholder:i="Search...",disabled:o=!1,className:l="",required:c=!1,isSubmitted:u=!1,actions:d=null}){const h=u&&c&&!n;return a.jsxs("div",{className:l,children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",c&&a.jsx("span",{className:"text-red-500",children:"*"})]}),d?a.jsx("div",{className:"flex items-center",children:d}):null]}),a.jsx(BCe,{items:t,value:n??"",onChange:s,getLabel:r,placeholder:i,disabled:o,hasError:h})]})}function BCe({items:e=[],value:t="",onChange:n,getLabel:s,placeholder:r="Search...",disabled:i=!1,maxRender:o=200,hasError:l=!1}){const[c,u]=f.useState(!1),[d,h]=f.useState(""),p=f.useRef(null),x=e.find(y=>String(y.id)===String(t)),v=x?s(x):"",j=f.useMemo(()=>{const y=d.trim().toLowerCase();return(y?e.filter(w=>(s(w)||"").toLowerCase().includes(y)):e).slice(0,o)},[e,d,s,o]);return f.useEffect(()=>{const y=N=>{p.current&&!p.current.contains(N.target)&&u(!1)};return document.addEventListener("mousedown",y),()=>document.removeEventListener("mousedown",y)},[]),f.useEffect(()=>{c||h("")},[c]),a.jsxs("div",{ref:p,className:"relative w-full",children:[a.jsx("input",{disabled:i,value:c?d:v,placeholder:r,onFocus:()=>!i&&u(!0),onChange:y=>{h(y.target.value),c||u(!0)},className:`w-full border rounded-md px-2 py-1.5 text-sm outline-none focus:ring-2
          ${l?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}`}),c&&!i&&a.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg overflow-hidden",children:[a.jsx("div",{className:"max-h-56 overflow-y-auto",children:j.length>0?j.map(y=>{const N=String(y.id),w=s(y),S=String(t)===N;return a.jsx("button",{type:"button",onClick:()=>{n(N),u(!1)},className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-50 ${S?"bg-blue-50":""}`,children:w||"--"},N)}):a.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No results"})}),e.length>o&&a.jsxs("div",{className:"px-3 py-2 text-[11px] text-gray-400 border-t",children:["Showing first ",o," results  keep typing to narrow."]})]})]})}function HCe({label:e,name:t,value:n,onChange:s,placeholder:r,rows:i=3,disabled:o=!1,className:l=""}){return a.jsxs("div",{className:l,children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsx("textarea",{name:t,value:n??"",onChange:s,placeholder:r,rows:i,disabled:o,className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100 resize-none"})]})}function qCe({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o=!1,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsx("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${u}`,disabled:o,children:o?"Processing...":s})]})]})})}const F2=e=>e?new Date(e).toLocaleString("en-US",{month:"short",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).replace(",",""):"";function uY({lead:e,onBack:t,fetchLeads:n,onEdit:s,onDelete:r,setSelectedLead:i,relatedActs:o}){const l=kt(),{leadID:c}=Wo(),[u,d]=f.useState(e||null),[h,p]=f.useState("Overview"),[x,v]=f.useState(""),j=u?.status?.toUpperCase()==="QUALIFIED",[y,N]=f.useState(null),[w,S]=f.useState({name:"",website:"",countryCode:"",phone_number:"",billing_address:"",shipping_address:"",industry:"",status:"Prospect",territory_id:null,assigned_to:null,created_by:null}),[_,k]=f.useState({last_name:"",first_name:"",account_id:null,title:"",department:"",email:"",work_phone:"",mobile_phone_1:"",mobile_phone_2:"",notes:"",assigned_to:null,created_by:null}),[T,A]=f.useState({name:"Converted from Lead",account_id:null,primary_contact_id:null,stage:"Prospecting",probability:10,amount:0,currency:"PHP",description:"Initial deal from lead conversion.",assigned_to:null,created_by:null}),E=async()=>{try{if(e){d(e),v(e.status||"New");return}if(!c)return;const U=await re.get(`/leads/get/${c}`);d(U.data),v(U.data.status||"New"),S({name:U.data.company_name||"",website:"",countryCode:"+63",phone_number:"",billing_address:"",shipping_address:"",industry:"",status:"Prospect",territory_id:U.data.territory?.id||null,assigned_to:U.data.assigned_to?.id||null,created_by:U.data.creator?.id||null}),k({last_name:U.data.last_name||"",first_name:U.data.first_name||"",account_id:null,title:U.data.title||"",department:U.data.department||"",email:U.data.email||"",work_phone:U.data.work_phone||"",mobile_phone_1:U.data.mobile_phone_1||"",mobile_phone_2:U.data.mobile_phone_2||"",notes:"",assigned_to:U.data.assigned_to?.id||null,created_by:U.data.creator?.id||null}),A({name:"Converted from Lead",account_id:null,primary_contact_id:null,stage:"Prospecting",probability:10,amount:0,currency:"PHP",description:"Initial deal from lead conversion.",assigned_to:U.data.assigned_to?.id||null,created_by:U.data.creator?.id||null})}catch(U){console.error(U)}};f.useEffect(()=>{e?(d(e),v(e.status||"New")):c&&E()},[c,e]);const M=async()=>{try{if(x==="Converted"&&u?.status?.toUpperCase()!=="QUALIFIED"){H.error("Lead must be Qualified before it can be converted.");return}const U=await re.put(`/leads/${u.id}/update/status`,{status:x});H.success("Lead status updated successfully");const B={...u,status:U.data.status};d(B),i&&i(B),n&&n(),t&&t()}catch(U){console.error(U),H.error("Failed to update lead status")}},z=async U=>{const B={...w,assigned_to:U.assigned_to?.id,billing_address:U.address,shipping_address:U.address,created_by:U.creator?.id,industry:null,name:U.company_name,phone_number:U.work_phone,status:"Prospect",territory_id:U.territory?.id,website:""};console.log("Account data: ",B),console.log("Contact data: ",_),console.log("Deal data: ",T),console.log("Lead data: ",U);try{const q=(await re.post("/accounts/convertedLead",B)).data.id,Z={..._,account_id:q,assigned_to:U.assigned_to?.id,created_by:U.creator?.id,department:U.department,email:U.email,first_name:U.first_name,last_name:U.last_name,mobile_phone_1:U.mobile_phone_1,mobile_phone_2:U.mobile_phone_2,notes:U.notes,title:U.title,work_phone:U.work_phone},oe=(await re.post("/contacts/convertedLead",Z)).data.id,je=()=>{switch(T.stage){case"PROSPECTING":return 10;case"QUALIFICATION":return 25;case"PROPOSAL":return 60;case"NEGOTIATION":return 80;case"CLOSED_WON":return 100;case"CLOSED_LOST":return 0;default:return 0}},X=T.amount&&T.amount!==""?parseFloat(T.amount):0,se={...T,account_id:q,assigned_to:U.assigned_to?.id,created_by:U.creator?.id,primary_contact_id:oe,probability:je(),stage:"Prospecting"},ye=await re.post("/deals/convertedLead",se),Ne=await re.put(`/leads/convert/${U.id}`);i&&i(null),n(),H.success("Lead converted successfully!"),t()}catch(R){console.error("Error during conversion:",R);const q=R.response?.data?.detail||R.message||"Failed to convert lead. Please try again.";H.error(q)}},P=U=>{switch((U||"").toUpperCase()){case"NEW":return"bg-indigo-100 text-indigo-700";case"CONTACTED":return"bg-blue-100 text-blue-700";case"QUALIFIED":return"bg-green-100 text-green-700";case"CONVERTED":return"bg-emerald-100 text-emerald-700";case"LOST":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-700"}},D=U=>U.toString().toLowerCase().replace(/\b\w/g,B=>B.toUpperCase());return u?a.jsx(a.Fragment,{children:a.jsx("div",{className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-lg w-full max-w-full sm:max-w-6xl max-h-[90vh] overflow-y-auto hide-scrollbar relative box-border",children:[a.jsx("div",{className:"bg-tertiary w-full rounded-t-xl p-3 lg:p-3",children:a.jsxs("div",{className:"flex items-start justify-between w-full",children:[a.jsx("h1",{className:"lg:text-3xl text-xl text-white font-semibold text-center w-full",children:"Lead"}),a.jsx("button",{onClick:()=>{t?t():l(-1)},className:"text-gray-400 hover:text-white mt-1 cursor-pointer",children:a.jsx(Ja,{size:25})})]})}),a.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between lg:flex-row lg:items-center lg:justify-between mt-3 gap-2 px-2 md:items-center lg:gap-4 md:mx-7 lg:mx-7",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[a.jsxs("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-800",children:[u.first_name," ",u.last_name]}),a.jsx("span",{className:`text-xs sm:text-sm font-medium px-2 sm:px-3 py-1 rounded-full whitespace-nowrap ${P(u.status)}`,children:D(u.status||"New")}),a.jsx("div",{className:"flex flex-col",children:a.jsx("button",{onClick:()=>z(u),disabled:!j,title:j?"Convert Lead":"Lead must be Qualified before converting",className:`px-3 sm:px-4 py-1.5 sm:py-2 rounded-md font-medium text-xs sm:text-sm transition focus:outline-none focus:ring-2
      ${j?"bg-green-600 hover:bg-green-700 text-white focus:ring-green-400":"bg-gray-200 text-gray-400 cursor-not-allowed"}
    `,children:"Convert"})})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsxs("button",{type:"button",onClick:()=>{s&&u&&s(u)},className:"inline-flex items-center justify-center w-full sm:w-auto bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 transition text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",children:[a.jsx(hn,{className:"mr-2"}),"Edit"]}),a.jsxs("button",{type:"button",onClick:()=>{r&&u&&r(u)},className:"inline-flex items-center justify-center w-full sm:w-auto px-4 py-2 rounded-md text-sm bg-red-500 text-white hover:bg-red-600 transition focus:outline-none focus:ring-2 focus:ring-red-400",children:[a.jsx(wa,{className:"mr-2"}),"Delete"]})]})]}),a.jsx("div",{className:"border-b border-gray-200 my-5"}),a.jsxs("div",{className:"p-4 lg:p-4",children:[a.jsx("div",{className:"flex w-full bg-[#6A727D] text-white mt-1 overflow-x-auto mb-6",children:["Overview","Notes","Activities"].map(U=>a.jsx("button",{onClick:()=>p(U),className:`flex-1 min-w-[90px] px-4 py-2.5 text-xs sm:text-sm font-medium text-center transition-all duration-200 border-b-2
        ${h===U?"bg-paper-white text-[#6A727D] border-white":"text-white hover:bg-[#5c636d]"}`,children:U},U))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 items-start",children:[a.jsxs("div",{className:"lg:col-span-3",children:[h==="Overview"&&a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 md:p-8 border border-gray-200",children:a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4 sm:gap-6 text-sm text-gray-700",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Name:"}),a.jsxs("p",{children:[u.first_name," ",u.last_name||"N/A"]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Company:"}),a.jsx("p",{children:u.company_name||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Job Title:"}),a.jsx("p",{children:u.title||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Department:"}),a.jsx("p",{children:u.department||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Email:"}),a.jsx("p",{children:u.email||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Territory:"}),a.jsx("p",{children:u.territory?.name||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Assigned To:"}),a.jsx("p",{children:u.assigned_to?`${u.assigned_to.first_name} ${u.assigned_to.last_name}`:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created By:"}),a.jsx("p",{children:u.creator?`${u.creator.first_name} ${u.creator.last_name}`:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Work Phone:"}),a.jsx("p",{children:u.work_phone||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Mobile Phone 1:"}),a.jsx("p",{children:u.mobile_phone_1||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Mobile Phone 2:"}),a.jsx("p",{children:u.mobile_phone_2||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Source:"}),a.jsx("p",{children:u.source||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Address:"}),a.jsx("p",{children:u.address||"N/A"})]})]})}),h==="Notes"&&a.jsxs("div",{className:"mt-4 w-full",children:[a.jsx("div",{className:"flex flex-wrap items-center justify-between mb-4 gap-2",children:a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words",children:"Lead Note"})}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 shadow-sm break-words",children:[a.jsx("div",{className:"flex items-start justify-between",children:a.jsx("div",{children:a.jsx("p",{className:"text-sm font-medium text-gray-800 break-words",children:"Note"})})}),a.jsx("div",{className:"mt-3 text-sm text-gray-700 whitespace-pre-wrap break-words",children:u.notes||"No notes available."})]})]}),h==="Activities"&&a.jsxs("div",{className:"space-y-2 w-full h-full max-h-[50dvh] overflow-y-auto bg-gray-50 p-2 hide-scrollbar rounded-lg border border-gray-200 shadow-sm",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words border-b border-gray-300 py-2",children:"Related Activities"}),a.jsxs("div",{className:"space-y-2 text-sm",children:[o.tasks&&o.tasks.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>N(y==="tasks"?null:"tasks"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Qt,{className:"text-blue-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Tasks (",o.tasks.length,")"]})]}),y==="tasks"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),y==="tasks"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:o.tasks.map((U,B)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>l("/admin/tasks",{state:{taskID:U.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-blue-600 mt-1",children:a.jsx(Qt,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:U.subject||U.title||"Task"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:U.description||"No description"}),U.assigned_to&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Assigned:"," ",U.assigned_to.first_name," ",U.assigned_to.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:F2(U.due_date||U.created_at)})]},`task-${B}`))})]}),o.meetings&&o.meetings.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>N(y==="meetings"?null:"meetings"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ot,{className:"text-green-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Meetings (",o.meetings.length,")"]})]}),y==="meetings"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),y==="meetings"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:o.meetings.map((U,B)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>l("/admin/meetings",{state:{meetingID:U.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-green-600 mt-1",children:a.jsx(Ot,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:U.subject||U.title||"Meeting"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:U.description||U.location||"No description"}),U.host&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Host: ",U.host.first_name," ",U.host.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:F2(U.start_time||U.created_at)})]},`meeting-${B}`))})]}),o.calls&&o.calls.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>N(y==="calls"?null:"calls"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(It,{className:"text-purple-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Calls (",o.calls.length,")"]})]}),y==="calls"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),y==="calls"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:o.calls.map((U,B)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>l("/admin/calls",{state:{callID:U.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-purple-600 mt-1",children:a.jsx(It,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:U.subject||U.title||"Call"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:U.direction||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:F2(U.call_time||U.created_at)})]},`call-${B}`))})]}),(!o||(!o.tasks||o.tasks.length===0)&&(!o.meetings||o.meetings.length===0)&&(!o.calls||o.calls.length===0)&&(!o.quotes||o.quotes.length===0)&&(!o.deals||o.deals.length===0)&&(!o.contacts||o.contacts.length===0))&&a.jsx("div",{className:"text-center py-8 text-gray-500",children:a.jsx("p",{children:"No related activities found for this account."})})]})]})]}),a.jsxs("div",{className:"flex flex-col gap-4",children:[a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Quick Actions"}),a.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[a.jsxs("button",{onClick:()=>{u&&l("/admin/calls",{state:{openCallModal:!0,initialCallData:{subject:u.title?`Call regarding ${u.title}`:`Call with ${u.first_name} ${u.last_name}`,relatedType1:"Lead",relatedTo1:String(u.id),relatedType2:null,relatedTo2:null,assigned_to:u.assigned_to?.id?String(u.assigned_to.id):"",direction:"Outgoing",status:"Planned"}}})},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(It,{className:"text-gray-600 w-4 h-4"}),"Schedule Call"]}),a.jsxs("button",{type:"button",onClick:()=>{if(!u?.email){alert("No email address available");return}const U=encodeURIComponent(u.email),B=encodeURIComponent(""),R=encodeURIComponent(""),q=`mailto:${U}?subject=${B}&body=${R}`;window.location.href=q},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(rn,{className:"text-gray-600 w-4 h-4"}),"Send E-mail"]}),a.jsxs("button",{className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",onClick:()=>{u&&l("/admin/meetings",{state:{openMeetingModal:!0,initialMeetingData:{subject:u.title?`Meeting regarding ${u.title}`:`Meeting with ${u.first_name||""} ${u.last_name||""}`.trim(),relatedType1:"Lead",relatedTo1:String(u.id),relatedType2:null,relatedTo2:null,assignedTo:u.assigned_to?.id?String(u.assigned_to.id):"",status:"Planned"}}})},children:[a.jsx(Ot,{className:"text-gray-600 w-4 h-4"}),"Book Meeting"]}),a.jsxs("button",{onClick:()=>{u&&l("/admin/tasks",{state:{openTaskModal:!0,initialTaskData:{subject:u.title?`Follow up on ${u.title}`:`Follow up with ${u.first_name||""} ${u.last_name||""}`.trim(),relatedType1:"Lead",relatedTo1:String(u.id),relatedType2:null,relatedTo2:null,assignedTo:u.assigned_to?.id?String(u.assigned_to.id):"",priority:"NORMAL",status:"Not Started"}}})},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(Qt,{className:"text-gray-600 w-4 h-4"}),"Tasks"]})]})]}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm w-full",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Status"}),a.jsxs("select",{className:"border border-gray-200 rounded-md px-2 sm:px-3 py-1.5 w-full text-sm mb-2 focus:ring-2 focus:ring-indigo-500 outline-none",value:x,onChange:U=>v(U.target.value),children:[a.jsx("option",{value:"New",children:"New"}),a.jsx("option",{value:"Contacted",children:"Contacted"}),a.jsx("option",{value:"Qualified",children:"Qualified"}),u?.status?.toUpperCase()==="QUALIFIED"&&a.jsx("option",{value:"Converted",children:"Converted"}),a.jsx("option",{value:"Lost",children:"Lost"})]}),a.jsx("button",{onClick:M,disabled:x===u.status,className:`w-full py-1.5 rounded-md text-sm transition focus:outline-none focus:ring-2 ${x===u.status?"bg-gray-400 cursor-not-allowed text-white":"bg-gray-900 text-white hover:bg-gray-800 focus:ring-gray-400"}`,children:"Update"})]})]})]})]})]})})}):null}const GCe=nh.all(),U2=GCe.map((e,t)=>({code:`+${e.countryCallingCode}`,name:e.countryCode,id:`${e.countryCallingCode}-${e.countryCode}-${t}`})),WCe=e=>e.toString().toLowerCase().replace(/\b\w/g,t=>t.toUpperCase()),VCe=e=>{switch(e.toUpperCase()){case"NEW":return"bg-indigo-100 text-indigo-700";case"CONTACTED":return"bg-blue-100 text-blue-700";case"QUALIFIED":return"bg-green-100 text-green-700";case"CONVERTED":return"bg-emerald-100 text-emerald-700";case"LOST":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-700"}},B2={first_name:"",last_name:"",company_name:"",title:"",department:"",email:"",work_ccode:"+63",work_phone:"",m1_ccode:"+63",mobile_phone_1:"",m2_ccode:"+63",mobile_phone_2:"",address:"",notes:"",source:"",territory_id:null,lead_owner:null,status:"New"};function YCe(){const e=kt(),{leadID:t}=Wo();Bs();const[n,s]=f.useState(null),[r,i]=f.useState(!1),[o,l]=f.useState(null),[c,u]=f.useState(null),[d,h]=f.useState([]),[p,x]=f.useState(!1),[v,j]=f.useState(""),[y,N]=f.useState("Filter by Status"),[w,S]=f.useState(""),[_,k]=f.useState(1),[T,A]=f.useState(10),[E,M]=f.useState(B2),[z,P]=f.useState(!1),[D,U]=f.useState(null),[B,R]=f.useState(!1),[q,Z]=f.useState(null),[V,oe]=f.useState(!1),[je,X]=f.useState([]),[se,ye]=f.useState({});f.useRef(null);const[Ne,fe]=f.useState(!1),[we,de]=f.useState(null),[ke,ge]=f.useState({name:"",website:"",countryCode:"+63",phone_number:"",combinedPhoneNumbers:"",billing_address:"",shipping_address:"",industry:"",status:"Prospect",territory_id:null,assigned_to:null,created_by:null}),[$e,be]=f.useState({last_name:"",first_name:"",account_id:null,title:"",department:"",email:"",work_phone:"",mobile_phone_1:"",mobile_phone_2:"",notes:"",assigned_to:null,created_by:null}),[me,Ue]=f.useState({name:"Converted from Lead",account_id:null,primary_contact_id:null,stage:"PROSPECTING",probability:10,amount:0,currency:"PHP",description:"Initial deal from lead conversion.",assigned_to:null,created_by:null});f.useEffect(()=>{document.title="Leads | Sari-Sari CRM"},[]);const Ee=async()=>{try{const Ce=await re.get("/leads/getUsers");l(Ce.data)}catch(Ce){console.error(`Error fetching users: ${Ce}`)}},We=async()=>{x(!0);try{const Ce=await re.get("/leads/admin/getLeads");h(Ce.data),console.log(Ce.data)}catch(Ce){console.error(`Error fetching leads: ${Ce}`)}finally{x(!1)}};f.useEffect(()=>{Ee(),We()},[]),f.useEffect(()=>{if(t&&d.length>0&&!r&&!z){const Ce=d.find(Qe=>Qe.id===Number(t));Ce&&s(Ce)}else!t&&!n&&s(null)},[t,d,r,z]),f.useEffect(()=>{if(we){const Qe=(J=>{if(!J)return{code:"+63",number:""};const Y=J.match(/^(\+\d+)\s(.+)$/);if(Y)return{code:Y[1],number:Y[2]};if(J.startsWith("+")){const F=J.match(/^(\+\d{1,3})/);if(F)return{code:F[1],number:J.substring(F[1].length).trim()}}return{code:"+63",number:J}})(we.work_phone),G=[];we.work_phone&&G.push(`Work: ${we.work_phone}`),we.mobile_phone_1&&G.push(`Mobile 1: ${we.mobile_phone_1}`),we.mobile_phone_2&&G.push(`Mobile 2: ${we.mobile_phone_2}`);const W=G.length>0?G.join(" | "):"";ge({name:we.company_name||"",website:"",countryCode:Qe.code,phone_number:Qe.number,combinedPhoneNumbers:W,billing_address:we.address||"",shipping_address:we.address||"",industry:"",status:"Prospect",territory_id:we.assigned_to?.territory?.id||null,assigned_to:we.assigned_to?.id||null,created_by:we.creator?.id||null}),be({last_name:we.last_name||"",first_name:we.first_name||"",account_id:null,title:we.title||"",department:we.department||"",email:we.email||"",work_phone:we.work_phone||"",mobile_phone_1:we.mobile_phone_1||"",mobile_phone_2:we.mobile_phone_2||"",notes:we.notes||"",assigned_to:we.assigned_to?.id||null,created_by:we.creator?.id||null}),Ue({name:"Converted from Lead",account_id:null,primary_contact_id:null,stage:"PROSPECTING",probability:10,amount:0,currency:"PHP",description:"Initial deal from lead conversion.",assigned_to:we.assigned_to?.id||null,created_by:we.creator?.id||null})}},[we]);const tt=Ce=>j(Ce.target.value),lt=f.useMemo(()=>{let Ce=[...d];const Qe=v.trim().toLowerCase();Qe&&(Ce=Ce.filter(W=>[W?.first_name,W?.last_name,W?.company_name,W?.title,W?.email,W?.work_phone,W?.assigned_to?`${W.assigned_to.first_name} ${W.assigned_to.last_name}`:""].some(Y=>Y&&Y.toString().toLowerCase().includes(Qe))));const G=y.trim().toUpperCase();return G&&G!=="FILTER BY STATUS"?Ce=Ce.filter(W=>(W.status?W.status.toUpperCase():"")===G):Ce=Ce.filter(W=>(W.status?W.status.toUpperCase():"")!=="CONVERTED"),w?Ce.sort((W,J)=>{const Y=`${W.first_name} ${W.last_name}`,F=`${J.first_name} ${J.last_name}`;return w==="asc"?Y.localeCompare(F):F.localeCompare(Y)}):Ce.sort((W,J)=>{const Y=new Date(W.created_at).getTime();return new Date(J.created_at).getTime()-Y}),Ce},[d,v,y,w]),Fe=Math.max(1,Math.ceil(lt.length/T)||1);f.useEffect(()=>{k(1)},[v,y]),f.useEffect(()=>{k(Ce=>{const Qe=Math.max(1,Math.ceil(lt.length/T)||1);return Ce>Qe?Qe:Ce})},[lt.length,T]);const st=f.useMemo(()=>{const Ce=(_-1)*T;return lt.slice(Ce,Ce+T)},[lt,_,T]),Xe=()=>k(Ce=>Math.max(Ce-1,1)),Ze=()=>k(Ce=>Math.min(Ce+1,Fe)),Je=Ce=>{A(Ce),k(1)},Be=f.useCallback(async Ce=>{try{const Qe=await re.get(`/activities/lead/${Ce}`);ye(Qe.data&&typeof Qe.data=="object"?Qe.data:{})}catch(Qe){console.error(Qe),Qe.response?.status===404&&(console.warn("No activities found for this account."),ye({}))}},[]),_e=Ce=>{s(Ce),Be(Ce.id)},pe=()=>{s(null),t&&e("/admin/leads",{replace:!0})},ce=()=>{i(!1),M(B2),P(!1),U(null),R(!1),u(null),sessionStorage.removeItem("editLeadData")},Q=Ce=>{Ce.target.id==="modalBackdrop"&&ce()},ne=()=>{M(B2),P(!1),U(null),u(null),i(!0)},ae=Ce=>{if(!Ce){console.error("handleEditClick: lead is null or undefined");return}console.log("handleEditClick called with lead:",Ce),console.log("Current state - leadID:",t,"selectedLead:",n,"showModal:",r);const Qe=F=>{if(!F)return{code:"+63",number:""};const ue=F.match(/^(\+\d+)\s(.+)$/);return ue?{code:ue[1],number:ue[2]}:{code:"+63",number:F}},G=Qe(Ce.work_phone),W=Qe(Ce.mobile_phone_1),J=Qe(Ce.mobile_phone_2);let Y="";if(Ce.assigned_to){Y=String(Ce.assigned_to.id);const F=o?.find(ue=>ue.id===Ce.assigned_to.id);u(F)}M({first_name:Ce.first_name||"",last_name:Ce.last_name||"",company_name:Ce.company_name||"",title:Ce.title||"",department:Ce.department||"",email:Ce.email||"",work_ccode:G.code,work_phone:G.number,m1_ccode:W.code,mobile_phone_1:W.number,m2_ccode:J.code,mobile_phone_2:J.number,address:Ce.address||"",notes:Ce.notes||"",source:Ce.source||"",territory_id:Ce.territory?.id||null,lead_owner:Y,status:Ce.status||"New"}),P(!0),U(Ce.id),n?(console.log("Coming from detail view - closing detail modal and showing edit form"),s(null),i(!0)):(console.log("Already in list view - showing modal"),i(!0))},Pe=Ce=>{if(!Ce){console.error("handleDelete: lead is null or undefined");return}console.log("handleDelete called with lead:",Ce);const Qe=`${Ce.first_name} ${Ce.last_name}`||"this lead";Z({title:"Delete Lead",message:a.jsxs("span",{children:["Are you sure you want to permanently delete"," ",a.jsx("span",{className:"font-semibold",children:Qe}),"? This action cannot be undone."]}),confirmLabel:"Delete Lead",cancelLabel:"Cancel",variant:"danger",action:{type:"delete",targetId:Ce.id,name:Qe}})},Te=Ce=>{const{name:Qe,value:G}=Ce.target;if(M(W=>({...W,[Qe]:G})),Qe==="lead_owner"){const W=o.find(J=>J.id===parseInt(G));u(W)}},[he,He]=f.useState(!1),qe=Ce=>{if(Ce.preventDefault(),He(!0),!E.last_name?.trim()){H.error("Last name is required.");return}if(!E.company_name?.trim()){H.error("Company is required.");return}if(!E.title?.trim()){H.error("Job title is required.");return}if(!E.email?.trim()){H.error("Email is required.");return}if(!E.email.includes("@")){H.error("Email must contain '@'.");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(E.email)){H.error("Please enter a valid email address with a dot in the domain.");return}if(!E.lead_owner){H.error("Please assign a lead owner.");return}const G={...E,territory_id:E.territory_id?parseInt(E.territory_id):null,lead_owner:parseInt(E.lead_owner),work_phone:`${E.work_ccode} ${E.work_phone}`,mobile_phone_1:`${E.m1_ccode} ${E.mobile_phone_1}`,mobile_phone_2:`${E.m2_ccode} ${E.mobile_phone_2}`},W=z&&D?"update":"create",J=`${E.first_name} ${E.last_name}`;Z({title:W==="create"?"Confirm New Lead":"Confirm Update",message:W==="create"?a.jsxs("span",{children:["Are you sure you want to create a new lead for"," ",a.jsx("span",{className:"font-semibold",children:J}),"?"]}):a.jsxs("span",{children:["Save changes to ",a.jsx("span",{className:"font-semibold",children:J}),"?"]}),confirmLabel:W==="create"?"Create Lead":"Update Lead",cancelLabel:"Cancel",variant:"primary",action:{type:W,payload:G,targetId:D||null,name:J}})},nt=Ce=>{if(Ce.target.checked){const Qe=st.map(G=>G.id);X(Qe)}else X([])},ot=Ce=>{X(Qe=>Qe.includes(Ce)?Qe.filter(G=>G!==Ce):[...Qe,Ce])},Re=async()=>{je.length!==0&&Z({title:"Delete Leads",message:a.jsxs("span",{children:["Are you sure you want to delete"," ",a.jsx("span",{className:"font-semibold",children:je.length})," selected leads? This action cannot be undone."]}),confirmLabel:`Delete ${je.length} Lead(s)`,cancelLabel:"Cancel",variant:"danger",action:{type:"bulk-delete",leadIds:je}})},it=async()=>{if(!q?.action){Z(null);return}const{action:Ce}=q,{type:Qe,payload:G,targetId:W,name:J,lead:Y,leadIds:F}=Ce;console.log(G),oe(!0);try{if(Qe==="create")R(!0),await re.post("/leads/create",G),H.success(`Lead "${J}" created successfully.`),ce(),await We();else if(Qe==="update"){if(!W)throw new Error("Missing lead identifier for update.");R(!0);const ue=await re.put(`/leads/${W}`,G);H.success(`Lead "${J}" updated successfully.`),n&&n.id===W&&s(null),ce(),await We()}else if(Qe==="delete"){if(!W)throw new Error("Missing lead identifier for deletion.");await re.delete(`/leads/${W}`),H.success(`Lead "${J}" deleted successfully.`),n?.id===W&&s(null),await We()}else Qe==="bulk-delete"&&(await re.delete("/leads/admin/bulk-delete",{data:{lead_ids:F}}),H.success(`Successfully deleted ${F.length} leads`),X([]),await We())}catch(ue){console.error(ue);const De=Qe==="create"?"Failed to create lead. Please review the details and try again.":Qe==="update"?"Failed to update lead. Please review the details and try again.":"Failed to delete lead. Please try again.",le=ue.response?.data?.detail||De;H.error(le)}finally{(Qe==="create"||Qe==="update")&&R(!1),Qe!=="edit"&&(oe(!1),Z(null))}},St=()=>{V||Z(null)},Et=d.filter(Ce=>Ce.status==="New").length,Tt=d.filter(Ce=>Ce.status==="Contacted").length,Nt=d.filter(Ce=>Ce.status==="Qualified").length,xe=d.filter(Ce=>Ce.status==="Converted").length,ve=d.filter(Ce=>Ce.status==="Lost").length,Oe=[{title:"New",value:Et,icon:Xa,color:"text-indigo-600",bgColor:"bg-indigo-100"},{title:"Contacted",value:Tt,icon:It,color:"text-blue-600",bgColor:"bg-blue-100"},{title:"Qualified",value:Nt,icon:Qa,color:"text-green-600",bgColor:"bg-green-100"},{title:"Converted",value:xe,icon:ec,color:"text-emerald-600",bgColor:"bg-emerald-100"},{title:"Lost",value:ve,icon:Us,color:"text-red-600",bgColor:"bg-red-100"}];return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[p&&a.jsx(Wt,{message:"Loading leads..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h1",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(Xa,{className:"mr-2 text-blue-600"}),"Leads"]}),a.jsxs("div",{className:"flex justify-center lg:justify-end gap-3 w-full sm:w-auto",children:[a.jsxs("button",{onClick:()=>{H.info("Download functionality coming soon")},className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 rounded-md hover:bg-gray-800 text-sm sm:text-base self-end sm:self-auto cursor-pointer",children:[a.jsx(Vo,{className:"mr-2"})," Download"]}),a.jsxs("button",{onClick:()=>{ne(),He(!1)},className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 rounded-md hover:bg-gray-800 text-sm sm:text-base self-end sm:self-auto cursor-pointer",children:[a.jsx(aa,{className:"mr-2"})," Add Lead"]})]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 xl:grid-cols-5 gap-4 mb-6 w-full break-words overflow-hidden lg:overflow-visible",children:Oe.map(Ce=>a.jsx(KCe,{...Ce},Ce.title))}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search leads",value:v,onChange:tt,className:"focus:outline-none text-base w-full"})]}),a.jsx("div",{className:"w-full lg:w-1/4",children:a.jsxs("select",{value:y,onChange:Ce=>N(Ce.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{value:"Filter by Status",children:"Filter by Status"}),a.jsx("option",{value:"New",children:"New"}),a.jsx("option",{value:"Contacted",children:"Contacted"}),a.jsx("option",{value:"Qualified",children:"Qualified"}),a.jsx("option",{value:"Converted",children:"Converted"}),a.jsx("option",{value:"Lost",children:"Lost"})]})}),a.jsx("div",{className:"w-full lg:w-1/4",children:a.jsxs("select",{value:w,onChange:Ce=>S(Ce.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{value:"",children:"Sort by Name"}),a.jsx("option",{value:"asc",children:"A-Z"}),a.jsx("option",{value:"desc",children:"Z-A"})]})})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[500px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 text-sm tracking-wide font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 w-10",children:a.jsx("input",{type:"checkbox",className:"w-4 h-4 accent-blue-600",checked:st.length>0&&st.every(Ce=>je.includes(Ce.id)),onChange:nt})}),a.jsx("th",{className:"py-3 px-4",children:"Name"}),a.jsx("th",{className:"py-3 px-4",children:"Company"}),a.jsx("th",{className:"py-3 px-4",children:"Job Title"}),a.jsx("th",{className:"py-3 px-4",children:"Email"}),a.jsx("th",{className:"py-3 px-4",children:"Assigned To"}),a.jsx("th",{className:"py-3 px-4",children:"Status"}),a.jsx("th",{className:"py-3 px-4 text-center w-24",children:je.length>0?a.jsx("button",{onClick:Re,className:"text-red-600 hover:text-red-800 transition p-1 rounded-full hover:bg-red-50",title:`Delete ${je.length} selected leads`,children:a.jsx(wa,{size:18})}):""})]})}),a.jsx("tbody",{children:lt.length>0?st.map(Ce=>a.jsxs("tr",{className:"hover:bg-gray-50 text-sm cursor-pointer",children:[a.jsx("td",{className:"py-3 px-4",onClick:Qe=>Qe.stopPropagation(),children:a.jsx("input",{type:"checkbox",className:"w-4 h-4 accent-blue-600",checked:je.includes(Ce.id),onChange:()=>ot(Ce.id)})}),a.jsx("td",{className:"py-3 px-4",onClick:()=>_e(Ce),children:a.jsxs("div",{className:"font-medium text-blue-600 hover:underline break-all text-sm",children:[Ce.first_name," ",Ce.last_name]})}),a.jsx("td",{className:"py-3 px-4",onClick:()=>_e(Ce),children:a.jsx("div",{className:"font-medium text-gray-800 text-sm leading-tight",children:Ce.company_name||"--"})}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",onClick:()=>_e(Ce),children:Ce.title||"--"}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",onClick:()=>_e(Ce),children:Ce.email||"--"}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",onClick:()=>_e(Ce),children:Ce.assigned_to?`${Ce.assigned_to.first_name} ${Ce.assigned_to.last_name}`:"--"}),a.jsx("td",{className:"py-3 px-4",onClick:()=>_e(Ce),children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium whitespace-nowrap ${VCe(Ce.status||"New")}`,children:WCe(Ce.status||"New")})}),a.jsx("td",{})]},Ce.id)):a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:8,children:"No leads found."})})})]})}),a.jsx(ca,{className:"mt-4",totalItems:lt.length,pageSize:T,currentPage:_,onPrev:Xe,onNext:Ze,onPageSizeChange:Je,label:"leads"}),r&&a.jsx("div",{id:"modalBackdrop",onClick:Q,className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-full sm:max-w-3xl rounded-2xl shadow-lg p-4 sm:p-6 md:p-8 relative border border-gray-200 overflow-y-auto max-h-[90vh] hide-scrollbar",onClick:Ce=>Ce.stopPropagation(),children:[a.jsx("button",{onClick:()=>{ce(),He(!1)},className:"absolute top-4 right-4 text-gray-500 hover:text-black transition",children:a.jsx(ea,{size:22})}),a.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800 mb-4 sm:mb-6 flex items-center justify-center",children:z?"Edit Lead":"Add New Lead"}),a.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 text-sm",children:[a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"First Name"}),a.jsx("input",{type:"text",name:"first_name",value:E.first_name,onChange:Te,placeholder:"Joe",className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:["Last Name ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",name:"last_name",placeholder:"Smith",value:E.last_name,onChange:Te,required:!0,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border
              ${he&&!E.last_name?.trim()?"border-red-400 focus:ring-red-400":"border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"}
          focus:ring-2`})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:["Company ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",placeholder:"ABC Company",name:"company_name",value:E.company_name,onChange:Te,required:!0,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border
                       ${he&&!E.company_name?.trim()?"border-red-400 focus:ring-red-400":"border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"}
                  focus:ring-2`})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:["Job Title",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",placeholder:"ABC Agenda",name:"title",value:E.title,onChange:Te,required:!0,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border
                       ${he&&!E.title?.trim()?"border-red-400 focus:ring-red-400":"border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"}
                      focus:ring-2`})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Department"}),a.jsx("input",{type:"text",placeholder:"Sales",name:"department",value:E.department,onChange:Te,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:["Email",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"email",placeholder:"abc@gmail.com",name:"email",value:E.email,onChange:Te,required:!0,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border
                       ${he&&!E.email?.trim()?"border-red-400 focus:ring-red-400":"border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"}
                      focus:ring-2`})]}),a.jsxs("div",{className:"flex flex-col col-span-1 md:col-span-2 lg:col-span-1",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Work Phone"}),a.jsxs("div",{className:"w-full border border-gray-300 rounded-md focus-within:ring-2 focus-within:ring-blue-400 outline-none flex flex-row gap-1",children:[a.jsx("select",{name:"work_ccode",value:E.work_ccode,onChange:Te,className:"outline-none cursor-pointer py-1.5 px-2 border-r border-gray-400 text-sm",children:U2.map(Ce=>a.jsx("option",{value:Ce.code,children:Ce.code},Ce.id))}),a.jsx("input",{type:"text",placeholder:"9----------",name:"work_phone",value:E.work_phone,onChange:Te,className:"w-full outline-none px-2 py-1.5 text-sm"})]})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Mobile Phone 1"}),a.jsxs("div",{className:"w-full border border-gray-300 rounded-md focus-within:ring-2 focus-within:ring-blue-400 outline-none flex flex-row gap-1",children:[a.jsx("select",{name:"m1_ccode",value:E.m1_ccode,onChange:Te,className:"outline-none cursor-pointer py-1.5 px-2 border-r border-gray-400 text-sm",children:U2.map(Ce=>a.jsx("option",{value:Ce.code,children:Ce.code},Ce.id))}),a.jsx("input",{type:"text",placeholder:"9----------",name:"mobile_phone_1",value:E.mobile_phone_1,onChange:Te,className:"w-full outline-none px-2 py-1.5 text-sm"})]})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Mobile Phone 2"}),a.jsxs("div",{className:"w-full border border-gray-300 rounded-md focus-within:ring-2 focus-within:ring-blue-400 outline-none flex flex-row gap-1",children:[a.jsx("select",{name:"m2_ccode",value:E.m2_ccode,onChange:Te,className:"outline-none cursor-pointer py-1.5 px-2 border-r border-gray-400 text-sm",children:U2.map(Ce=>a.jsx("option",{value:Ce.code,children:Ce.code},Ce.id))}),a.jsx("input",{type:"text",placeholder:"9----------",name:"mobile_phone_2",value:E.mobile_phone_2,onChange:Te,className:"w-full outline-none px-2 py-1.5 text-sm"})]})]}),a.jsxs("div",{className:"flex flex-col col-span-1 sm:col-span-2 lg:col-span-3",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Address"}),a.jsx("input",{type:"text",name:"address",value:E.address,onChange:Te,placeholder:"Street No., Street Name, City, State/Province, Postal Code",className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"})]}),a.jsxs("div",{className:"flex flex-col col-span-1 md:col-span-2 lg:col-span-1",children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:["Assign To ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("div",{className:`w-full rounded-lg ${he&&!E.lead_owner?"border border-red-400":"border border-gray-300"}`,children:a.jsx(XCe,{items:Array.isArray(o)?o:[],value:E.lead_owner??"",placeholder:"Search a user...",getLabel:Ce=>`${Ce.first_name} ${Ce.last_name}`,onChange:Ce=>{const Qe=o.find(W=>String(W.id)===String(Ce));u(Qe);let G=null;Qe&&Qe.assigned_territory&&Qe.assigned_territory.length===1&&(G=Qe.assigned_territory[0].id),M(W=>({...W,lead_owner:Ce,territory_id:G}))}})})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Territory"}),a.jsxs("select",{name:"territory_id",value:E.territory_id||"",onChange:Te,disabled:!c||!c.assigned_territory||c.assigned_territory.length===0,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm bg-white focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100 disabled:text-gray-500",children:[a.jsx("option",{value:"",disabled:!0,children:c?c.assigned_territory&&c.assigned_territory.length>0?"Select Territory":"No territories assigned to this user":"Select a user first"}),c&&c.assigned_territory&&c.assigned_territory.map(Ce=>a.jsx("option",{value:Ce.id,children:Ce.name},Ce.id))]})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Source"}),a.jsxs("select",{className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none",defaultValue:"",name:"source",value:E.source,onChange:Te,children:[a.jsx("option",{value:"",disabled:!0,children:"Select Source"}),a.jsx("option",{value:"Website",children:"Website"}),a.jsx("option",{value:"Referral",children:"Referral"}),a.jsx("option",{value:"Cold call",children:"Cold call"}),a.jsx("option",{value:"Event",children:"Event"}),a.jsx("option",{value:"Other",children:"Other"})]})]}),a.jsxs("div",{className:"flex flex-col col-span-1 sm:col-span-2 lg:col-span-3",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Notes"}),a.jsx("textarea",{placeholder:"Additional details...",name:"notes",value:E.notes,onChange:Te,rows:3,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none resize-none"})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-2 mt-4 col-span-1 sm:col-span-2 lg:col-span-3",children:[a.jsx("button",{type:"button",onClick:()=>{ce(),He(!1)},className:"w-full sm:w-auto px-4 py-2 text-white bg-red-400 border border-red-300 rounded hover:bg-red-500 transition disabled:opacity-70",disabled:B||V,children:"Cancel"}),a.jsx("button",{type:"submit",onClick:qe,className:"w-full sm:w-auto px-4 py-2 text-white border border-tertiary bg-tertiary rounded hover:bg-secondary transition disabled:opacity-70",disabled:B||V,children:B||V?"Processing...":z?"Update Lead":"Save Lead"})]})]})]})}),q&&a.jsx(QCe,{open:!0,title:q.title,message:q.message,confirmLabel:q.confirmLabel,cancelLabel:q.cancelLabel,variant:q.variant,onConfirm:it,onCancel:St,loading:V}),n&&!r&&!z&&a.jsx(uY,{relatedActs:se,lead:n,onBack:pe,fetchLeads:We,setSelectedLead:s,onEdit:ae,onDelete:Pe})]})}function QCe({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o=!1,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsx("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${u}`,disabled:o,children:o?"Processing...":s})]})]})})}function KCe({icon:e,title:t,value:n,color:s="text-blue-600",bgColor:r="bg-blue-100",onClick:i}){const o=()=>{typeof i=="function"?i():console.log(`Clicked: ${t}`)};return a.jsxs("div",{className:"flex items-center p-4 bg-white rounded-xl shadow-md border border-gray-200 transition-all duration-300",onClick:o,children:[a.jsx("div",{className:`flex-shrink-0 p-3 rounded-full ${r} ${s} mr-4`,children:e?a.jsx(e,{size:22}):null}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:t}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:n})]})]})}function XCe({items:e=[],value:t="",onChange:n,getLabel:s,placeholder:r="Search...",disabled:i=!1,maxRender:o=200}){const[l,c]=f.useState(!1),[u,d]=f.useState(""),h=f.useRef(null),p=e.find(j=>String(j.id)===String(t)),x=p?s(p):"",v=f.useMemo(()=>{const j=u.trim().toLowerCase();return(j?e.filter(N=>(s(N)||"").toLowerCase().includes(j)):e).slice(0,o)},[e,u,s,o]);return f.useEffect(()=>{const j=y=>{h.current&&!h.current.contains(y.target)&&c(!1)};return document.addEventListener("mousedown",j),()=>document.removeEventListener("mousedown",j)},[]),f.useEffect(()=>{l||d("")},[l]),a.jsxs("div",{ref:h,className:"relative w-full",children:[a.jsx("input",{disabled:i,value:l?u:x,placeholder:r,onFocus:()=>!i&&c(!0),onChange:j=>{d(j.target.value),l||c(!0)},className:"w-full rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100"}),l&&!i&&a.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg overflow-hidden",children:[a.jsx("div",{className:"max-h-56 overflow-y-auto",children:v.length>0?v.map(j=>{const y=String(j.id),N=s(j),w=String(t)===y;return a.jsx("button",{type:"button",onClick:()=>{n(y),c(!1)},className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-50 ${w?"bg-blue-50":""}`,children:N||"--"},y)}):a.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No results"})}),e.length>o&&a.jsxs("div",{className:"px-3 py-2 text-[11px] text-gray-400 border-t",children:["Showing first ",o," results  keep typing to narrow."]})]})]})}let ZCe={data:""},JCe=e=>{if(typeof window=="object"){let t=(e?e.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return t.nonce=window.__nonce__,t.parentNode||(e||document.head).appendChild(t),t.firstChild}return e||ZCe},eSe=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,tSe=/\/\*[^]*?\*\/|  +/g,MR=/\n+/g,Kc=(e,t)=>{let n="",s="",r="";for(let i in e){let o=e[i];i[0]=="@"?i[1]=="i"?n=i+" "+o+";":s+=i[1]=="f"?Kc(o,i):i+"{"+Kc(o,i[1]=="k"?"":t)+"}":typeof o=="object"?s+=Kc(o,t?t.replace(/([^,])+/g,l=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,c=>/&/.test(c)?c.replace(/&/g,l):l?l+" "+c:c)):i):o!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),r+=Kc.p?Kc.p(i,o):i+":"+o+";")}return n+(t&&r?t+"{"+r+"}":r)+s},bl={},mY=e=>{if(typeof e=="object"){let t="";for(let n in e)t+=n+mY(e[n]);return t}return e},aSe=(e,t,n,s,r)=>{let i=mY(e),o=bl[i]||(bl[i]=(c=>{let u=0,d=11;for(;u<c.length;)d=101*d+c.charCodeAt(u++)>>>0;return"go"+d})(i));if(!bl[o]){let c=i!==e?e:(u=>{let d,h,p=[{}];for(;d=eSe.exec(u.replace(tSe,""));)d[4]?p.shift():d[3]?(h=d[3].replace(MR," ").trim(),p.unshift(p[0][h]=p[0][h]||{})):p[0][d[1]]=d[2].replace(MR," ").trim();return p[0]})(e);bl[o]=Kc(r?{["@keyframes "+o]:c}:c,n?"":"."+o)}let l=n&&bl.g?bl.g:null;return n&&(bl.g=bl[o]),((c,u,d,h)=>{h?u.data=u.data.replace(h,c):u.data.indexOf(c)===-1&&(u.data=d?c+u.data:u.data+c)})(bl[o],t,s,l),o},nSe=(e,t,n)=>e.reduce((s,r,i)=>{let o=t[i];if(o&&o.call){let l=o(n),c=l&&l.props&&l.props.className||/^go/.test(l)&&l;o=c?"."+c:l&&typeof l=="object"?l.props?"":Kc(l,""):l===!1?"":l}return s+r+(o??"")},"");function DN(e){let t=this||{},n=e.call?e(t.p):e;return aSe(n.unshift?n.raw?nSe(n,[].slice.call(arguments,1),t.p):n.reduce((s,r)=>Object.assign(s,r&&r.call?r(t.p):r),{}):n,JCe(t.target),t.g,t.o,t.k)}let fY,Zk,Jk;DN.bind({g:1});let Yl=DN.bind({k:1});function sSe(e,t,n,s){Kc.p=t,fY=e,Zk=n,Jk=s}function Ld(e,t){let n=this||{};return function(){let s=arguments;function r(i,o){let l=Object.assign({},i),c=l.className||r.className;n.p=Object.assign({theme:Zk&&Zk()},l),n.o=/ *go\d+/.test(c),l.className=DN.apply(n,s)+(c?" "+c:"");let u=e;return e[0]&&(u=l.as||e,delete l.as),Jk&&u[0]&&Jk(l),fY(u,l)}return r}}var rSe=e=>typeof e=="function",cw=(e,t)=>rSe(e)?e(t):e,iSe=(()=>{let e=0;return()=>(++e).toString()})(),hY=(()=>{let e;return()=>{if(e===void 0&&typeof window<"u"){let t=matchMedia("(prefers-reduced-motion: reduce)");e=!t||t.matches}return e}})(),oSe=20,yP="default",gY=(e,t)=>{let{toastLimit:n}=e.settings;switch(t.type){case 0:return{...e,toasts:[t.toast,...e.toasts].slice(0,n)};case 1:return{...e,toasts:e.toasts.map(o=>o.id===t.toast.id?{...o,...t.toast}:o)};case 2:let{toast:s}=t;return gY(e,{type:e.toasts.find(o=>o.id===s.id)?1:0,toast:s});case 3:let{toastId:r}=t;return{...e,toasts:e.toasts.map(o=>o.id===r||r===void 0?{...o,dismissed:!0,visible:!1}:o)};case 4:return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(o=>o.id!==t.toastId)};case 5:return{...e,pausedAt:t.time};case 6:let i=t.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(o=>({...o,pauseDuration:o.pauseDuration+i}))}}},gv=[],pY={toasts:[],pausedAt:void 0,settings:{toastLimit:oSe}},Do={},xY=(e,t=yP)=>{Do[t]=gY(Do[t]||pY,e),gv.forEach(([n,s])=>{n===t&&s(Do[t])})},yY=e=>Object.keys(Do).forEach(t=>xY(e,t)),lSe=e=>Object.keys(Do).find(t=>Do[t].toasts.some(n=>n.id===e)),ON=(e=yP)=>t=>{xY(t,e)},cSe={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},dSe=(e={},t=yP)=>{let[n,s]=f.useState(Do[t]||pY),r=f.useRef(Do[t]);f.useEffect(()=>(r.current!==Do[t]&&s(Do[t]),gv.push([t,s]),()=>{let o=gv.findIndex(([l])=>l===t);o>-1&&gv.splice(o,1)}),[t]);let i=n.toasts.map(o=>{var l,c,u;return{...e,...e[o.type],...o,removeDelay:o.removeDelay||((l=e[o.type])==null?void 0:l.removeDelay)||e?.removeDelay,duration:o.duration||((c=e[o.type])==null?void 0:c.duration)||e?.duration||cSe[o.type],style:{...e.style,...(u=e[o.type])==null?void 0:u.style,...o.style}}});return{...n,toasts:i}},uSe=(e,t="blank",n)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:t,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...n,id:n?.id||iSe()}),Yx=e=>(t,n)=>{let s=uSe(t,e,n);return ON(s.toasterId||lSe(s.id))({type:2,toast:s}),s.id},ns=(e,t)=>Yx("blank")(e,t);ns.error=Yx("error");ns.success=Yx("success");ns.loading=Yx("loading");ns.custom=Yx("custom");ns.dismiss=(e,t)=>{let n={type:3,toastId:e};t?ON(t)(n):yY(n)};ns.dismissAll=e=>ns.dismiss(void 0,e);ns.remove=(e,t)=>{let n={type:4,toastId:e};t?ON(t)(n):yY(n)};ns.removeAll=e=>ns.remove(void 0,e);ns.promise=(e,t,n)=>{let s=ns.loading(t.loading,{...n,...n?.loading});return typeof e=="function"&&(e=e()),e.then(r=>{let i=t.success?cw(t.success,r):void 0;return i?ns.success(i,{id:s,...n,...n?.success}):ns.dismiss(s),r}).catch(r=>{let i=t.error?cw(t.error,r):void 0;i?ns.error(i,{id:s,...n,...n?.error}):ns.dismiss(s)}),e};var mSe=1e3,fSe=(e,t="default")=>{let{toasts:n,pausedAt:s}=dSe(e,t),r=f.useRef(new Map).current,i=f.useCallback((h,p=mSe)=>{if(r.has(h))return;let x=setTimeout(()=>{r.delete(h),o({type:4,toastId:h})},p);r.set(h,x)},[]);f.useEffect(()=>{if(s)return;let h=Date.now(),p=n.map(x=>{if(x.duration===1/0)return;let v=(x.duration||0)+x.pauseDuration-(h-x.createdAt);if(v<0){x.visible&&ns.dismiss(x.id);return}return setTimeout(()=>ns.dismiss(x.id,t),v)});return()=>{p.forEach(x=>x&&clearTimeout(x))}},[n,s,t]);let o=f.useCallback(ON(t),[t]),l=f.useCallback(()=>{o({type:5,time:Date.now()})},[o]),c=f.useCallback((h,p)=>{o({type:1,toast:{id:h,height:p}})},[o]),u=f.useCallback(()=>{s&&o({type:6,time:Date.now()})},[s,o]),d=f.useCallback((h,p)=>{let{reverseOrder:x=!1,gutter:v=8,defaultPosition:j}=p||{},y=n.filter(S=>(S.position||j)===(h.position||j)&&S.height),N=y.findIndex(S=>S.id===h.id),w=y.filter((S,_)=>_<N&&S.visible).length;return y.filter(S=>S.visible).slice(...x?[w+1]:[0,w]).reduce((S,_)=>S+(_.height||0)+v,0)},[n]);return f.useEffect(()=>{n.forEach(h=>{if(h.dismissed)i(h.id,h.removeDelay);else{let p=r.get(h.id);p&&(clearTimeout(p),r.delete(h.id))}})},[n,i]),{toasts:n,handlers:{updateHeight:c,startPause:l,endPause:u,calculateOffset:d}}},hSe=Yl`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,gSe=Yl`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,pSe=Yl`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,xSe=Ld("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${hSe} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${gSe} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${pSe} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,ySe=Yl`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,bSe=Ld("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${ySe} 1s linear infinite;
`,vSe=Yl`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,wSe=Yl`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,jSe=Ld("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${vSe} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${wSe} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,NSe=Ld("div")`
  position: absolute;
`,CSe=Ld("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,SSe=Yl`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,_Se=Ld("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${SSe} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,ASe=({toast:e})=>{let{icon:t,type:n,iconTheme:s}=e;return t!==void 0?typeof t=="string"?f.createElement(_Se,null,t):t:n==="blank"?null:f.createElement(CSe,null,f.createElement(bSe,{...s}),n!=="loading"&&f.createElement(NSe,null,n==="error"?f.createElement(xSe,{...s}):f.createElement(jSe,{...s})))},TSe=e=>`
0% {transform: translate3d(0,${e*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,kSe=e=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${e*-150}%,-1px) scale(.6); opacity:0;}
`,ESe="0%{opacity:0;} 100%{opacity:1;}",LSe="0%{opacity:1;} 100%{opacity:0;}",PSe=Ld("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,DSe=Ld("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,OSe=(e,t)=>{let n=e.includes("top")?1:-1,[s,r]=hY()?[ESe,LSe]:[TSe(n),kSe(n)];return{animation:t?`${Yl(s)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Yl(r)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},MSe=f.memo(({toast:e,position:t,style:n,children:s})=>{let r=e.height?OSe(e.position||t||"top-center",e.visible):{opacity:0},i=f.createElement(ASe,{toast:e}),o=f.createElement(DSe,{...e.ariaProps},cw(e.message,e));return f.createElement(PSe,{className:e.className,style:{...r,...n,...e.style}},typeof s=="function"?s({icon:i,message:o}):f.createElement(f.Fragment,null,i,o))});sSe(f.createElement);var ISe=({id:e,className:t,style:n,onHeightUpdate:s,children:r})=>{let i=f.useCallback(o=>{if(o){let l=()=>{let c=o.getBoundingClientRect().height;s(e,c)};l(),new MutationObserver(l).observe(o,{subtree:!0,childList:!0,characterData:!0})}},[e,s]);return f.createElement("div",{ref:i,className:t,style:n},r)},$Se=(e,t)=>{let n=e.includes("top"),s=n?{top:0}:{bottom:0},r=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:hY()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${t*(n?1:-1)}px)`,...s,...r}},RSe=DN`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,sb=16,Qx=({reverseOrder:e,position:t="top-center",toastOptions:n,gutter:s,children:r,toasterId:i,containerStyle:o,containerClassName:l})=>{let{toasts:c,handlers:u}=fSe(n,i);return f.createElement("div",{"data-rht-toaster":i||"",style:{position:"fixed",zIndex:9999,top:sb,left:sb,right:sb,bottom:sb,pointerEvents:"none",...o},className:l,onMouseEnter:u.startPause,onMouseLeave:u.endPause},c.map(d=>{let h=d.position||t,p=u.calculateOffset(d,{reverseOrder:e,gutter:s,defaultPosition:t}),x=$Se(h,p);return f.createElement(ISe,{id:d.id,key:d.id,onHeightUpdate:u.updateHeight,className:d.visible?RSe:"",style:x},d.type==="custom"?cw(d.message,d):r?r(d):f.createElement(MSe,{toast:d,position:h}))}))},Kx=ns;function zSe(){f.useEffect(()=>{document.title="Audit | Sari-Sari CRM"},[]);const[e,t]=f.useState(null),[n,s]=f.useState(""),[r,i]=f.useState("Filter by Actions"),[o,l]=f.useState(1),[c,u]=f.useState(10),d=async()=>{try{const w=await re.get("/logs/read-all");t(w.data)}catch(w){console.error("Error fetching audit logs:",w)}};f.useEffect(()=>{d()},[]);const h=f.useMemo(()=>{if(!Array.isArray(e))return[];const w=n.trim().toLowerCase(),S=r?.toUpperCase?.()||"ALL";return e.filter(k=>{const T=k.timestamp?new Date(k.timestamp).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}):"",A=`${k.entity_type||""} ${k.entity_name||k.entity_details?.name||k.entity_details?.title||k.entity_id||""}`,E=`${k.logger?.first_name||""} ${k.logger?.last_name||""}`,M=[T,E,k.action,k.entity_type,A,k.description],z=w===""||M.some(D=>D==null?!1:D.toString().toLowerCase().includes(w)),P=S==="FILTER BY ACTIONS"||(k.action||"").toUpperCase()===S;return z&&P}).sort((k,T)=>{const A=k.timestamp?new Date(k.timestamp).getTime():0;return(T.timestamp?new Date(T.timestamp).getTime():0)-A})},[e,n,r]),p=Math.max(1,Math.ceil(h.length/c)||1);f.useEffect(()=>{l(1)},[n,r]),f.useEffect(()=>{l(w=>{const S=Math.max(1,Math.ceil(h.length/c)||1);return w>S?S:w})},[h.length,c]);const x=f.useMemo(()=>{const w=(o-1)*c;return h.slice(w,w+c)},[h,o,c]);h.length===0||(o-1)*c+1,Math.min(o*c,h.length);const v=()=>l(w=>Math.max(w-1,1)),j=()=>l(w=>Math.min(w+1,p)),y=()=>{if(!h.length){Kx.error("No logs to export!");return}const w=["Timestamp","User","Action","Resource","Details"],S=h.map(E=>[new Date(E.timestamp).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}),`${E.logger?.first_name||""} ${E.logger?.last_name||""}`.trim(),E.action,`${E.entity_type}: ${E.entity_id}`,E.description||""]),_=[w.join(","),...S.map(E=>E.map(M=>`"${String(M).replace(/"/g,'""')}"`).join(","))].join(`
`),k=new Blob([_],{type:"text/csv;charset=utf-8;"}),T=URL.createObjectURL(k),A=document.createElement("a");A.href=T,A.download=`AuditLogs_${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(A),A.click(),document.body.removeChild(A),URL.revokeObjectURL(T)},N=w=>{switch((w||"").toUpperCase()){case"CREATE":return"bg-green-100 text-green-700";case"UPDATE":case"EDIT":return"bg-blue-100 text-blue-700";case"DELETE":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-700"}};return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[e===null&&a.jsx(Wt,{message:"Loading audit logs..."}),a.jsx(Qx,{toastOptions:{duration:1e3}}),a.jsxs("div",{className:"bg-blue-50 border-l-4 border-blue-400 p-4 mb-6 rounded-r-md flex items-center",children:[a.jsx(Ot,{className:"text-blue-600 mr-3 flex-shrink-0",size:20}),a.jsxs("p",{className:"text-sm text-blue-700",children:[a.jsx("span",{className:"font-semibold",children:"Data Retention Policy:"})," Audit logs are automatically purged after 6 months to optimize system performance."]})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-5 space-y-3 sm:space-y-0",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(ks,{className:"text-blue-600",size:20}),a.jsx("h2",{className:"text-2xl sm:text-xl font-semibold text-gray-700",children:"Audit Logs"})]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 rounded-md hover:bg-gray-800 text-sm sm:text-base self-end sm:self-auto cursor-pointer",onClick:y,children:[a.jsx(Vo,{className:"mr-2"}),"Export Logs"]})})]}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition bg-white",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search audit logs",value:n,onChange:w=>s(w.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsx("div",{className:"w-full lg:w-1/4",children:a.jsxs("select",{value:r,onChange:w=>i(w.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{value:"Filter by Actions",children:"Filter by Actions"}),a.jsx("option",{value:"CREATE",children:"CREATE"}),a.jsx("option",{value:"DELETE",children:"DELETE"}),a.jsx("option",{value:"UPDATE",children:"UPDATE"})]})})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[600px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 text-sm tracking-wide font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4",children:"Timestamp"}),a.jsx("th",{className:"py-3 px-4",children:"User"}),a.jsx("th",{className:"py-3 px-4",children:"Action"}),a.jsx("th",{className:"py-3 px-4",children:"Resource"}),a.jsx("th",{className:"py-3 px-4",children:"Details"})]})}),a.jsx("tbody",{children:Array.isArray(h)&&h.length>0?x.map((w,S)=>a.jsxs("tr",{className:"hover:bg-gray-50 text-sm",children:[a.jsx("td",{className:"py-3 px-4 text-gray-700 whitespace-nowrap",children:new Date(w.timestamp).toLocaleString("en-US",{month:"numeric",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}).replace(",","")}),a.jsx("td",{className:"py-3 px-4 text-gray-700",children:w.name}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium whitespace-nowrap ${N(w.action)}`,children:w.action})}),a.jsxs("td",{className:"py-3 px-4 text-gray-700",children:[w.entity_type,": ",w.entity_id]}),a.jsx("td",{className:"py-3 px-4 text-gray-700",children:w.description})]},S)):a.jsx("tr",{children:a.jsx("td",{className:"py-3 px-4 text-sm text-gray-500 text-center",colSpan:5,children:"No activities to show."})})})]})}),a.jsx(ca,{className:"mt-4",totalItems:h.length,pageSize:c,currentPage:o,onPrev:v,onNext:j,onPageSizeChange:w=>{u(w),l(1)},pageSizeOptions:[10,20,30,40,50],label:"logs"})]})}var FSe=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function bP(e){if(typeof e!="string")return!1;var t=FSe;return t.includes(e)}var USe=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],BSe=new Set(USe);function bY(e){return typeof e!="string"?!1:BSe.has(e)}function vY(e){return typeof e=="string"&&e.startsWith("data-")}function qr(e){if(typeof e!="object"||e===null)return{};var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(bY(n)||vY(n))&&(t[n]=e[n]);return t}function zu(e){if(e==null)return null;if(f.isValidElement(e)&&typeof e.props=="object"&&e.props!==null){var t=e.props;return qr(t)}return typeof e=="object"&&!Array.isArray(e)?qr(e):null}function Ys(e){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(bY(n)||vY(n)||bP(n))&&(t[n]=e[n]);return t}function HSe(e){return e==null?null:f.isValidElement(e)?Ys(e.props):typeof e=="object"&&!Array.isArray(e)?Ys(e):null}var qSe=["children","width","height","viewBox","className","style","title","desc"];function eE(){return eE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},eE.apply(null,arguments)}function GSe(e,t){if(e==null)return{};var n,s,r=WSe(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)n=i[s],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function WSe(e,t){if(e==null)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;n[s]=e[s]}return n}var vP=f.forwardRef((e,t)=>{var{children:n,width:s,height:r,viewBox:i,className:o,style:l,title:c,desc:u}=e,d=GSe(e,qSe),h=i||{width:s,height:r,x:0,y:0},p=$t("recharts-surface",o);return f.createElement("svg",eE({},Ys(d),{className:p,width:s,height:r,style:l,viewBox:"".concat(h.x," ").concat(h.y," ").concat(h.width," ").concat(h.height),ref:t}),f.createElement("title",null,c),f.createElement("desc",null,u),n)}),VSe=["children","className"];function tE(){return tE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},tE.apply(null,arguments)}function YSe(e,t){if(e==null)return{};var n,s,r=QSe(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)n=i[s],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function QSe(e,t){if(e==null)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;n[s]=e[s]}return n}var ys=f.forwardRef((e,t)=>{var{children:n,className:s}=e,r=YSe(e,VSe),i=$t("recharts-layer",s);return f.createElement("g",tE({className:i},Ys(r),{ref:t}),n)}),wY=f.createContext(null),KSe=()=>f.useContext(wY),H2={},q2={},IR;function XSe(){return IR||(IR=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return n==="__proto__"}e.isUnsafeProperty=t})(q2)),q2}var G2={},$R;function jY(){return $R||($R=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){switch(typeof n){case"number":case"symbol":return!1;case"string":return n.includes(".")||n.includes("[")||n.includes("]")}}e.isDeepKey=t})(G2)),G2}var W2={},RR;function wP(){return RR||(RR=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return typeof n=="string"||typeof n=="symbol"?n:Object.is(n?.valueOf?.(),-0)?"-0":String(n)}e.toKey=t})(W2)),W2}var V2={},Y2={},zR;function ZSe(){return zR||(zR=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){if(n==null)return"";if(typeof n=="string")return n;if(Array.isArray(n))return n.map(t).join(",");const s=String(n);return s==="0"&&Object.is(Number(n),-0)?"-0":s}e.toString=t})(Y2)),Y2}var FR;function jP(){return FR||(FR=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=ZSe(),n=wP();function s(r){if(Array.isArray(r))return r.map(n.toKey);if(typeof r=="symbol")return[r];r=t.toString(r);const i=[],o=r.length;if(o===0)return i;let l=0,c="",u="",d=!1;for(r.charCodeAt(0)===46&&(i.push(""),l++);l<o;){const h=r[l];u?h==="\\"&&l+1<o?(l++,c+=r[l]):h===u?u="":c+=h:d?h==='"'||h==="'"?u=h:h==="]"?(d=!1,i.push(c),c=""):c+=h:h==="["?(d=!0,c&&(i.push(c),c="")):h==="."?c&&(i.push(c),c=""):c+=h,l++}return c&&i.push(c),i}e.toPath=s})(V2)),V2}var UR;function NP(){return UR||(UR=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=XSe(),n=jY(),s=wP(),r=jP();function i(l,c,u){if(l==null)return u;switch(typeof c){case"string":{if(t.isUnsafeProperty(c))return u;const d=l[c];return d===void 0?n.isDeepKey(c)?i(l,r.toPath(c),u):u:d}case"number":case"symbol":{typeof c=="number"&&(c=s.toKey(c));const d=l[c];return d===void 0?u:d}default:{if(Array.isArray(c))return o(l,c,u);if(Object.is(c?.valueOf(),-0)?c="-0":c=String(c),t.isUnsafeProperty(c))return u;const d=l[c];return d===void 0?u:d}}}function o(l,c,u){if(c.length===0)return u;let d=l;for(let h=0;h<c.length;h++){if(d==null||t.isUnsafeProperty(c[h]))return u;d=d[c[h]]}return d===void 0?u:d}e.get=i})(H2)),H2}var Q2,BR;function JSe(){return BR||(BR=1,Q2=NP().get),Q2}var e2e=JSe();const Fu=ao(e2e);var t2e=4;function td(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t2e,n=10**t,s=Math.round(e*n)/n;return Object.is(s,-0)?0:s}function Cn(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];return e.reduce((r,i,o)=>{var l=n[o-1];return typeof l=="string"?r+l+i:l!==void 0?r+td(l)+i:r+i},"")}var xs=e=>e===0?0:e>0?1:-1,eo=e=>typeof e=="number"&&e!=+e,Ql=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,Ut=e=>(typeof e=="number"||e instanceof Number)&&!eo(e),Ho=e=>Ut(e)||typeof e=="string",a2e=0,$p=e=>{var t=++a2e;return"".concat(e||"").concat(t)},Rs=function(t,n){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Ut(t)&&typeof t!="string")return s;var i;if(Ql(t)){if(n==null)return s;var o=t.indexOf("%");i=n*parseFloat(t.slice(0,o))/100}else i=+t;return eo(i)&&(i=s),r&&n!=null&&i>n&&(i=n),i},NY=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,n={},s=0;s<t;s++)if(!n[String(e[s])])n[String(e[s])]=!0;else return!0;return!1};function dn(e,t,n){return Ut(e)&&Ut(t)?td(e+n*(t-e)):t}function CY(e,t,n){if(!(!e||!e.length))return e.find(s=>s&&(typeof t=="function"?t(s):Fu(s,t))===n)}var fn=e=>e===null||typeof e>"u",Xx=e=>fn(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1));function n2e(e){return e!=null}function Zx(){}var s2e=["type","size","sizeType"];function aE(){return aE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},aE.apply(null,arguments)}function HR(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function qR(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?HR(Object(n),!0).forEach(function(s){r2e(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):HR(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function r2e(e,t,n){return(t=i2e(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i2e(e){var t=o2e(e,"string");return typeof t=="symbol"?t:t+""}function o2e(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function l2e(e,t){if(e==null)return{};var n,s,r=c2e(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)n=i[s],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function c2e(e,t){if(e==null)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;n[s]=e[s]}return n}var SY={symbolCircle:dN,symbolCross:KG,symbolDiamond:ZG,symbolSquare:JG,symbolStar:tW,symbolTriangle:aW,symbolWye:nW},d2e=Math.PI/180,u2e=e=>{var t="symbol".concat(Xx(e));return SY[t]||dN},m2e=(e,t,n)=>{if(t==="area")return e;switch(n){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var s=18*d2e;return 1.25*e*e*(Math.tan(s)-Math.tan(s*2)*Math.tan(s)**2)}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},f2e=(e,t)=>{SY["symbol".concat(Xx(e))]=t},CP=e=>{var{type:t="circle",size:n=64,sizeType:s="area"}=e,r=l2e(e,s2e),i=qR(qR({},r),{},{type:t,size:n,sizeType:s}),o="circle";typeof t=="string"&&(o=t);var l=()=>{var p=u2e(o),x=I4().type(p).size(m2e(n,s,o)),v=x();if(v!==null)return v},{className:c,cx:u,cy:d}=i,h=Ys(i);return Ut(u)&&Ut(d)&&Ut(n)?f.createElement("path",aE({},h,{className:$t("recharts-symbols",c),transform:"translate(".concat(u,", ").concat(d,")"),d:l()})):null};CP.registerSymbol=f2e;var _Y=e=>"radius"in e&&"startAngle"in e&&"endAngle"in e,SP=(e,t)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var n=e;if(f.isValidElement(e)&&(n=e.props),typeof n!="object"&&typeof n!="function")return null;var s={};return Object.keys(n).forEach(r=>{bP(r)&&(s[r]=(i=>n[r](n,i)))}),s},h2e=(e,t,n)=>s=>(e(t,n,s),null),Jx=(e,t,n)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var s=null;return Object.keys(e).forEach(r=>{var i=e[r];bP(r)&&typeof i=="function"&&(s||(s={}),s[r]=h2e(i,t,n))}),s};function GR(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function g2e(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?GR(Object(n),!0).forEach(function(s){p2e(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):GR(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function p2e(e,t,n){return(t=x2e(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function x2e(e){var t=y2e(e,"string");return typeof t=="symbol"?t:t+""}function y2e(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Qn(e,t){var n=g2e({},e),s=t,r=Object.keys(t),i=r.reduce((o,l)=>(o[l]===void 0&&s[l]!==void 0&&(o[l]=s[l]),o),n);return i}function dw(){return dw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},dw.apply(null,arguments)}function WR(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function b2e(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?WR(Object(n),!0).forEach(function(s){v2e(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):WR(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function v2e(e,t,n){return(t=w2e(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function w2e(e){var t=j2e(e,"string");return typeof t=="symbol"?t:t+""}function j2e(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ui=32,N2e={align:"center",iconSize:14,inactiveColor:"#ccc",layout:"horizontal",verticalAlign:"middle"};function C2e(e){var{data:t,iconType:n,inactiveColor:s}=e,r=ui/2,i=ui/6,o=ui/3,l=t.inactive?s:t.color,c=n??t.type;if(c==="none")return null;if(c==="plainline"){var u;return f.createElement("line",{strokeWidth:4,fill:"none",stroke:l,strokeDasharray:(u=t.payload)===null||u===void 0?void 0:u.strokeDasharray,x1:0,y1:r,x2:ui,y2:r,className:"recharts-legend-icon"})}if(c==="line")return f.createElement("path",{strokeWidth:4,fill:"none",stroke:l,d:"M0,".concat(r,"h").concat(o,`
            A`).concat(i,",").concat(i,",0,1,1,").concat(2*o,",").concat(r,`
            H`).concat(ui,"M").concat(2*o,",").concat(r,`
            A`).concat(i,",").concat(i,",0,1,1,").concat(o,",").concat(r),className:"recharts-legend-icon"});if(c==="rect")return f.createElement("path",{stroke:"none",fill:l,d:"M0,".concat(ui/8,"h").concat(ui,"v").concat(ui*3/4,"h").concat(-ui,"z"),className:"recharts-legend-icon"});if(f.isValidElement(t.legendIcon)){var d=b2e({},t);return delete d.legendIcon,f.cloneElement(t.legendIcon,d)}return f.createElement(CP,{fill:l,cx:r,cy:r,size:ui,sizeType:"diameter",type:c})}function S2e(e){var{payload:t,iconSize:n,layout:s,formatter:r,inactiveColor:i,iconType:o}=e,l={x:0,y:0,width:ui,height:ui},c={display:s==="horizontal"?"inline-block":"block",marginRight:10},u={display:"inline-block",verticalAlign:"middle",marginRight:4};return t.map((d,h)=>{var p=d.formatter||r,x=$t({"recharts-legend-item":!0,["legend-item-".concat(h)]:!0,inactive:d.inactive});if(d.type==="none")return null;var v=d.inactive?i:d.color,j=p?p(d.value,d,h):d.value;return f.createElement("li",dw({className:x,style:c,key:"legend-item-".concat(h)},Jx(e,d,h)),f.createElement(vP,{width:n,height:n,viewBox:l,style:u,"aria-label":"".concat(j," legend icon")},f.createElement(C2e,{data:d,iconType:o,inactiveColor:i})),f.createElement("span",{className:"recharts-legend-item-text",style:{color:v}},j))})}var _2e=e=>{var t=Qn(e,N2e),{payload:n,layout:s,align:r}=t;if(!n||!n.length)return null;var i={padding:0,margin:0,textAlign:s==="horizontal"?r:"left"};return f.createElement("ul",{className:"recharts-default-legend",style:i},f.createElement(S2e,dw({},t,{payload:n})))},K2={},X2={},VR;function A2e(){return VR||(VR=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n,s){const r=new Map;for(let i=0;i<n.length;i++){const o=n[i],l=s(o);r.has(l)||r.set(l,o)}return Array.from(r.values())}e.uniqBy=t})(X2)),X2}var Z2={},YR;function AY(){return YR||(YR=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return n}e.identity=t})(Z2)),Z2}var J2={},e_={},t_={},QR;function T2e(){return QR||(QR=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return Number.isSafeInteger(n)&&n>=0}e.isLength=t})(t_)),t_}var KR;function _P(){return KR||(KR=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=T2e();function n(s){return s!=null&&typeof s!="function"&&t.isLength(s.length)}e.isArrayLike=n})(e_)),e_}var a_={},XR;function k2e(){return XR||(XR=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return typeof n=="object"&&n!==null}e.isObjectLike=t})(a_)),a_}var ZR;function E2e(){return ZR||(ZR=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=_P(),n=k2e();function s(r){return n.isObjectLike(r)&&t.isArrayLike(r)}e.isArrayLikeObject=s})(J2)),J2}var n_={},s_={},JR;function L2e(){return JR||(JR=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=NP();function n(s){return function(r){return t.get(r,s)}}e.property=n})(s_)),s_}var r_={},i_={},o_={},l_={},ez;function TY(){return ez||(ez=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return n!==null&&(typeof n=="object"||typeof n=="function")}e.isObject=t})(l_)),l_}var c_={},tz;function kY(){return tz||(tz=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return n==null||typeof n!="object"&&typeof n!="function"}e.isPrimitive=t})(c_)),c_}var d_={},az;function EY(){return az||(az=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n,s){return n===s||Number.isNaN(n)&&Number.isNaN(s)}e.eq=t})(d_)),d_}var nz;function P2e(){return nz||(nz=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=TY(),n=kY(),s=EY();function r(d,h,p){return typeof p!="function"?r(d,h,()=>{}):i(d,h,function x(v,j,y,N,w,S){const _=p(v,j,y,N,w,S);return _!==void 0?!!_:i(v,j,x,S)},new Map)}function i(d,h,p,x){if(h===d)return!0;switch(typeof h){case"object":return o(d,h,p,x);case"function":return Object.keys(h).length>0?i(d,{...h},p,x):s.eq(d,h);default:return t.isObject(d)?typeof h=="string"?h==="":!0:s.eq(d,h)}}function o(d,h,p,x){if(h==null)return!0;if(Array.isArray(h))return c(d,h,p,x);if(h instanceof Map)return l(d,h,p,x);if(h instanceof Set)return u(d,h,p,x);const v=Object.keys(h);if(d==null||n.isPrimitive(d))return v.length===0;if(v.length===0)return!0;if(x?.has(h))return x.get(h)===d;x?.set(h,d);try{for(let j=0;j<v.length;j++){const y=v[j];if(!n.isPrimitive(d)&&!(y in d)||h[y]===void 0&&d[y]!==void 0||h[y]===null&&d[y]!==null||!p(d[y],h[y],y,d,h,x))return!1}return!0}finally{x?.delete(h)}}function l(d,h,p,x){if(h.size===0)return!0;if(!(d instanceof Map))return!1;for(const[v,j]of h.entries()){const y=d.get(v);if(p(y,j,v,d,h,x)===!1)return!1}return!0}function c(d,h,p,x){if(h.length===0)return!0;if(!Array.isArray(d))return!1;const v=new Set;for(let j=0;j<h.length;j++){const y=h[j];let N=!1;for(let w=0;w<d.length;w++){if(v.has(w))continue;const S=d[w];let _=!1;if(p(S,y,j,d,h,x)&&(_=!0),_){v.add(w),N=!0;break}}if(!N)return!1}return!0}function u(d,h,p,x){return h.size===0?!0:d instanceof Set?c([...d],[...h],p,x):!1}e.isMatchWith=r,e.isSetMatch=u})(o_)),o_}var sz;function LY(){return sz||(sz=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=P2e();function n(s,r){return t.isMatchWith(s,r,()=>{})}e.isMatch=n})(i_)),i_}var u_={},m_={},f_={},rz;function D2e(){return rz||(rz=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return Object.getOwnPropertySymbols(n).filter(s=>Object.prototype.propertyIsEnumerable.call(n,s))}e.getSymbols=t})(f_)),f_}var h_={},iz;function PY(){return iz||(iz=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return n==null?n===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(n)}e.getTag=t})(h_)),h_}var g_={},oz;function DY(){return oz||(oz=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t="[object RegExp]",n="[object String]",s="[object Number]",r="[object Boolean]",i="[object Arguments]",o="[object Symbol]",l="[object Date]",c="[object Map]",u="[object Set]",d="[object Array]",h="[object Function]",p="[object ArrayBuffer]",x="[object Object]",v="[object Error]",j="[object DataView]",y="[object Uint8Array]",N="[object Uint8ClampedArray]",w="[object Uint16Array]",S="[object Uint32Array]",_="[object BigUint64Array]",k="[object Int8Array]",T="[object Int16Array]",A="[object Int32Array]",E="[object BigInt64Array]",M="[object Float32Array]",z="[object Float64Array]";e.argumentsTag=i,e.arrayBufferTag=p,e.arrayTag=d,e.bigInt64ArrayTag=E,e.bigUint64ArrayTag=_,e.booleanTag=r,e.dataViewTag=j,e.dateTag=l,e.errorTag=v,e.float32ArrayTag=M,e.float64ArrayTag=z,e.functionTag=h,e.int16ArrayTag=T,e.int32ArrayTag=A,e.int8ArrayTag=k,e.mapTag=c,e.numberTag=s,e.objectTag=x,e.regexpTag=t,e.setTag=u,e.stringTag=n,e.symbolTag=o,e.uint16ArrayTag=w,e.uint32ArrayTag=S,e.uint8ArrayTag=y,e.uint8ClampedArrayTag=N})(g_)),g_}var p_={},lz;function O2e(){return lz||(lz=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}e.isTypedArray=t})(p_)),p_}var cz;function OY(){return cz||(cz=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=D2e(),n=PY(),s=DY(),r=kY(),i=O2e();function o(d,h){return l(d,void 0,d,new Map,h)}function l(d,h,p,x=new Map,v=void 0){const j=v?.(d,h,p,x);if(j!==void 0)return j;if(r.isPrimitive(d))return d;if(x.has(d))return x.get(d);if(Array.isArray(d)){const y=new Array(d.length);x.set(d,y);for(let N=0;N<d.length;N++)y[N]=l(d[N],N,p,x,v);return Object.hasOwn(d,"index")&&(y.index=d.index),Object.hasOwn(d,"input")&&(y.input=d.input),y}if(d instanceof Date)return new Date(d.getTime());if(d instanceof RegExp){const y=new RegExp(d.source,d.flags);return y.lastIndex=d.lastIndex,y}if(d instanceof Map){const y=new Map;x.set(d,y);for(const[N,w]of d)y.set(N,l(w,N,p,x,v));return y}if(d instanceof Set){const y=new Set;x.set(d,y);for(const N of d)y.add(l(N,void 0,p,x,v));return y}if(typeof Buffer<"u"&&Buffer.isBuffer(d))return d.subarray();if(i.isTypedArray(d)){const y=new(Object.getPrototypeOf(d)).constructor(d.length);x.set(d,y);for(let N=0;N<d.length;N++)y[N]=l(d[N],N,p,x,v);return y}if(d instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&d instanceof SharedArrayBuffer)return d.slice(0);if(d instanceof DataView){const y=new DataView(d.buffer.slice(0),d.byteOffset,d.byteLength);return x.set(d,y),c(y,d,p,x,v),y}if(typeof File<"u"&&d instanceof File){const y=new File([d],d.name,{type:d.type});return x.set(d,y),c(y,d,p,x,v),y}if(typeof Blob<"u"&&d instanceof Blob){const y=new Blob([d],{type:d.type});return x.set(d,y),c(y,d,p,x,v),y}if(d instanceof Error){const y=new d.constructor;return x.set(d,y),y.message=d.message,y.name=d.name,y.stack=d.stack,y.cause=d.cause,c(y,d,p,x,v),y}if(d instanceof Boolean){const y=new Boolean(d.valueOf());return x.set(d,y),c(y,d,p,x,v),y}if(d instanceof Number){const y=new Number(d.valueOf());return x.set(d,y),c(y,d,p,x,v),y}if(d instanceof String){const y=new String(d.valueOf());return x.set(d,y),c(y,d,p,x,v),y}if(typeof d=="object"&&u(d)){const y=Object.create(Object.getPrototypeOf(d));return x.set(d,y),c(y,d,p,x,v),y}return d}function c(d,h,p=d,x,v){const j=[...Object.keys(h),...t.getSymbols(h)];for(let y=0;y<j.length;y++){const N=j[y],w=Object.getOwnPropertyDescriptor(d,N);(w==null||w.writable)&&(d[N]=l(h[N],N,p,x,v))}}function u(d){switch(n.getTag(d)){case s.argumentsTag:case s.arrayTag:case s.arrayBufferTag:case s.dataViewTag:case s.booleanTag:case s.dateTag:case s.float32ArrayTag:case s.float64ArrayTag:case s.int8ArrayTag:case s.int16ArrayTag:case s.int32ArrayTag:case s.mapTag:case s.numberTag:case s.objectTag:case s.regexpTag:case s.setTag:case s.stringTag:case s.symbolTag:case s.uint8ArrayTag:case s.uint8ClampedArrayTag:case s.uint16ArrayTag:case s.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=o,e.cloneDeepWithImpl=l,e.copyProperties=c})(m_)),m_}var dz;function M2e(){return dz||(dz=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=OY();function n(s){return t.cloneDeepWithImpl(s,void 0,s,new Map,void 0)}e.cloneDeep=n})(u_)),u_}var uz;function I2e(){return uz||(uz=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=LY(),n=M2e();function s(r){return r=n.cloneDeep(r),i=>t.isMatch(i,r)}e.matches=s})(r_)),r_}var x_={},y_={},b_={},mz;function $2e(){return mz||(mz=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=OY(),n=DY();function s(r,i){return t.cloneDeepWith(r,(o,l,c,u)=>{const d=i?.(o,l,c,u);if(d!==void 0)return d;if(typeof r=="object")switch(Object.prototype.toString.call(r)){case n.numberTag:case n.stringTag:case n.booleanTag:{const h=new r.constructor(r?.valueOf());return t.copyProperties(h,r),h}case n.argumentsTag:{const h={};return t.copyProperties(h,r),h.length=r.length,h[Symbol.iterator]=r[Symbol.iterator],h}default:return}})}e.cloneDeepWith=s})(b_)),b_}var fz;function R2e(){return fz||(fz=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=$2e();function n(s){return t.cloneDeepWith(s)}e.cloneDeep=n})(y_)),y_}var v_={},w_={},hz;function MY(){return hz||(hz=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=/^(?:0|[1-9]\d*)$/;function n(s,r=Number.MAX_SAFE_INTEGER){switch(typeof s){case"number":return Number.isInteger(s)&&s>=0&&s<r;case"symbol":return!1;case"string":return t.test(s)}}e.isIndex=n})(w_)),w_}var j_={},gz;function z2e(){return gz||(gz=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=PY();function n(s){return s!==null&&typeof s=="object"&&t.getTag(s)==="[object Arguments]"}e.isArguments=n})(j_)),j_}var pz;function F2e(){return pz||(pz=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=jY(),n=MY(),s=z2e(),r=jP();function i(o,l){let c;if(Array.isArray(l)?c=l:typeof l=="string"&&t.isDeepKey(l)&&o?.[l]==null?c=r.toPath(l):c=[l],c.length===0)return!1;let u=o;for(let d=0;d<c.length;d++){const h=c[d];if((u==null||!Object.hasOwn(u,h))&&!((Array.isArray(u)||s.isArguments(u))&&n.isIndex(h)&&h<u.length))return!1;u=u[h]}return!0}e.has=i})(v_)),v_}var xz;function U2e(){return xz||(xz=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=LY(),n=wP(),s=R2e(),r=NP(),i=F2e();function o(l,c){switch(typeof l){case"object":{Object.is(l?.valueOf(),-0)&&(l="-0");break}case"number":{l=n.toKey(l);break}}return c=s.cloneDeep(c),function(u){const d=r.get(u,l);return d===void 0?i.has(u,l):c===void 0?d===void 0:t.isMatch(d,c)}}e.matchesProperty=o})(x_)),x_}var yz;function B2e(){return yz||(yz=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=AY(),n=L2e(),s=I2e(),r=U2e();function i(o){if(o==null)return t.identity;switch(typeof o){case"function":return o;case"object":return Array.isArray(o)&&o.length===2?r.matchesProperty(o[0],o[1]):s.matches(o);case"string":case"symbol":case"number":return n.property(o)}}e.iteratee=i})(n_)),n_}var bz;function H2e(){return bz||(bz=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=A2e(),n=AY(),s=E2e(),r=B2e();function i(o,l=n.identity){return s.isArrayLikeObject(o)?t.uniqBy(Array.from(o),r.iteratee(l)):[]}e.uniqBy=i})(K2)),K2}var N_,vz;function q2e(){return vz||(vz=1,N_=H2e().uniqBy),N_}var G2e=q2e();const wz=ao(G2e);function IY(e,t,n){return t===!0?wz(e,n):typeof t=="function"?wz(e,t):e}var AP=f.createContext(null),W2e=e=>e,en=()=>{var e=f.useContext(AP);return e?e.store.dispatch:W2e},pv=()=>{},V2e=()=>pv,Y2e=(e,t)=>e===t;function Bt(e){var t=f.useContext(AP);return iq.useSyncExternalStoreWithSelector(t?t.subscription.addNestedSub:V2e,t?t.store.getState:pv,t?t.store.getState:pv,t?e:pv,Y2e)}var C_={},S_={},__={},jz;function Q2e(){return jz||(jz=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(s){return typeof s=="symbol"?1:s===null?2:s===void 0?3:s!==s?4:0}const n=(s,r,i)=>{if(s!==r){const o=t(s),l=t(r);if(o===l&&o===0){if(s<r)return i==="desc"?1:-1;if(s>r)return i==="desc"?-1:1}return i==="desc"?l-o:o-l}return 0};e.compareValues=n})(__)),__}var A_={},T_={},Nz;function $Y(){return Nz||(Nz=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return typeof n=="symbol"||n instanceof Symbol}e.isSymbol=t})(T_)),T_}var Cz;function K2e(){return Cz||(Cz=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=$Y(),n=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,s=/^\w*$/;function r(i,o){return Array.isArray(i)?!1:typeof i=="number"||typeof i=="boolean"||i==null||t.isSymbol(i)?!0:typeof i=="string"&&(s.test(i)||!n.test(i))||o!=null&&Object.hasOwn(o,i)}e.isKey=r})(A_)),A_}var Sz;function X2e(){return Sz||(Sz=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Q2e(),n=K2e(),s=jP();function r(i,o,l,c){if(i==null)return[];l=c?void 0:l,Array.isArray(i)||(i=Object.values(i)),Array.isArray(o)||(o=o==null?[null]:[o]),o.length===0&&(o=[null]),Array.isArray(l)||(l=l==null?[]:[l]),l=l.map(x=>String(x));const u=(x,v)=>{let j=x;for(let y=0;y<v.length&&j!=null;++y)j=j[v[y]];return j},d=(x,v)=>v==null||x==null?v:typeof x=="object"&&"key"in x?Object.hasOwn(v,x.key)?v[x.key]:u(v,x.path):typeof x=="function"?x(v):Array.isArray(x)?u(v,x):typeof v=="object"?v[x]:v,h=o.map(x=>(Array.isArray(x)&&x.length===1&&(x=x[0]),x==null||typeof x=="function"||Array.isArray(x)||n.isKey(x)?x:{key:x,path:s.toPath(x)}));return i.map(x=>({original:x,criteria:h.map(v=>d(v,x))})).slice().sort((x,v)=>{for(let j=0;j<h.length;j++){const y=t.compareValues(x.criteria[j],v.criteria[j],l[j]);if(y!==0)return y}return 0}).map(x=>x.original)}e.orderBy=r})(S_)),S_}var k_={},_z;function Z2e(){return _z||(_z=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n,s=1){const r=[],i=Math.floor(s),o=(l,c)=>{for(let u=0;u<l.length;u++){const d=l[u];Array.isArray(d)&&c<i?o(d,c+1):r.push(d)}};return o(n,0),r}e.flatten=t})(k_)),k_}var E_={},Az;function RY(){return Az||(Az=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=MY(),n=_P(),s=TY(),r=EY();function i(o,l,c){return s.isObject(c)&&(typeof l=="number"&&n.isArrayLike(c)&&t.isIndex(l)&&l<c.length||typeof l=="string"&&l in c)?r.eq(c[l],o):!1}e.isIterateeCall=i})(E_)),E_}var Tz;function J2e(){return Tz||(Tz=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=X2e(),n=Z2e(),s=RY();function r(i,...o){const l=o.length;return l>1&&s.isIterateeCall(i,o[0],o[1])?o=[]:l>2&&s.isIterateeCall(o[0],o[1],o[2])&&(o=[o[0]]),t.orderBy(i,n.flatten(o),["asc"])}e.sortBy=r})(C_)),C_}var L_,kz;function e_e(){return kz||(kz=1,L_=J2e().sortBy),L_}var t_e=e_e();const MN=ao(t_e);var zY=e=>e.legend.settings,a_e=e=>e.legend.size,n_e=e=>e.legend.payload,s_e=ut([n_e,zY],(e,t)=>{var{itemSorter:n}=t,s=e.flat(1);return n?MN(s,n):s});function r_e(){return Bt(s_e)}var rb=1;function FY(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[t,n]=f.useState({height:0,left:0,top:0,width:0}),s=f.useCallback(r=>{if(r!=null){var i=r.getBoundingClientRect(),o={height:i.height,left:i.left,top:i.top,width:i.width};(Math.abs(o.height-t.height)>rb||Math.abs(o.left-t.left)>rb||Math.abs(o.top-t.top)>rb||Math.abs(o.width-t.width)>rb)&&n({height:o.height,left:o.left,top:o.top,width:o.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,s]}function _s(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var i_e=typeof Symbol=="function"&&Symbol.observable||"@@observable",Ez=i_e,P_=()=>Math.random().toString(36).substring(7).split("").join("."),o_e={INIT:`@@redux/INIT${P_()}`,REPLACE:`@@redux/REPLACE${P_()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${P_()}`},uw=o_e;function TP(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function UY(e,t,n){if(typeof e!="function")throw new Error(_s(2));if(typeof t=="function"&&typeof n=="function"||typeof n=="function"&&typeof arguments[3]=="function")throw new Error(_s(0));if(typeof t=="function"&&typeof n>"u"&&(n=t,t=void 0),typeof n<"u"){if(typeof n!="function")throw new Error(_s(1));return n(UY)(e,t)}let s=e,r=t,i=new Map,o=i,l=0,c=!1;function u(){o===i&&(o=new Map,i.forEach((y,N)=>{o.set(N,y)}))}function d(){if(c)throw new Error(_s(3));return r}function h(y){if(typeof y!="function")throw new Error(_s(4));if(c)throw new Error(_s(5));let N=!0;u();const w=l++;return o.set(w,y),function(){if(N){if(c)throw new Error(_s(6));N=!1,u(),o.delete(w),i=null}}}function p(y){if(!TP(y))throw new Error(_s(7));if(typeof y.type>"u")throw new Error(_s(8));if(typeof y.type!="string")throw new Error(_s(17));if(c)throw new Error(_s(9));try{c=!0,r=s(r,y)}finally{c=!1}return(i=o).forEach(w=>{w()}),y}function x(y){if(typeof y!="function")throw new Error(_s(10));s=y,p({type:uw.REPLACE})}function v(){const y=h;return{subscribe(N){if(typeof N!="object"||N===null)throw new Error(_s(11));function w(){const _=N;_.next&&_.next(d())}return w(),{unsubscribe:y(w)}},[Ez](){return this}}}return p({type:uw.INIT}),{dispatch:p,subscribe:h,getState:d,replaceReducer:x,[Ez]:v}}function l_e(e){Object.keys(e).forEach(t=>{const n=e[t];if(typeof n(void 0,{type:uw.INIT})>"u")throw new Error(_s(12));if(typeof n(void 0,{type:uw.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(_s(13))})}function BY(e){const t=Object.keys(e),n={};for(let i=0;i<t.length;i++){const o=t[i];typeof e[o]=="function"&&(n[o]=e[o])}const s=Object.keys(n);let r;try{l_e(n)}catch(i){r=i}return function(o={},l){if(r)throw r;let c=!1;const u={};for(let d=0;d<s.length;d++){const h=s[d],p=n[h],x=o[h],v=p(x,l);if(typeof v>"u")throw l&&l.type,new Error(_s(14));u[h]=v,c=c||v!==x}return c=c||s.length!==Object.keys(o).length,c?u:o}}function mw(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,n)=>(...s)=>t(n(...s)))}function c_e(...e){return t=>(n,s)=>{const r=t(n,s);let i=()=>{throw new Error(_s(15))};const o={getState:r.getState,dispatch:(c,...u)=>i(c,...u)},l=e.map(c=>c(o));return i=mw(...l)(r.dispatch),{...r,dispatch:i}}}function HY(e){return TP(e)&&"type"in e&&typeof e.type=="string"}var qY=Symbol.for("immer-nothing"),Lz=Symbol.for("immer-draftable"),Qs=Symbol.for("immer-state");function Hi(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Rr=Object,Uf=Rr.getPrototypeOf,fw="constructor",IN="prototype",nE="configurable",hw="enumerable",xv="writable",Rp="value",Kl=e=>!!e&&!!e[Qs];function to(e){return e?GY(e)||$N(e)||!!e[Lz]||!!e[fw]?.[Lz]||RN(e)||zN(e):!1}var d_e=Rr[IN][fw].toString(),Pz=new WeakMap;function GY(e){if(!e||!kP(e))return!1;const t=Uf(e);if(t===null||t===Rr[IN])return!0;const n=Rr.hasOwnProperty.call(t,fw)&&t[fw];if(n===Object)return!0;if(!df(n))return!1;let s=Pz.get(n);return s===void 0&&(s=Function.toString.call(n),Pz.set(n,s)),s===d_e}function e0(e,t,n=!0){t0(e)===0?(n?Reflect.ownKeys(e):Rr.keys(e)).forEach(r=>{t(r,e[r],e)}):e.forEach((s,r)=>t(r,s,e))}function t0(e){const t=e[Qs];return t?t.type_:$N(e)?1:RN(e)?2:zN(e)?3:0}var Dz=(e,t,n=t0(e))=>n===2?e.has(t):Rr[IN].hasOwnProperty.call(e,t),sE=(e,t,n=t0(e))=>n===2?e.get(t):e[t],gw=(e,t,n,s=t0(e))=>{s===2?e.set(t,n):s===3?e.add(n):e[t]=n};function u_e(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}var $N=Array.isArray,RN=e=>e instanceof Map,zN=e=>e instanceof Set,kP=e=>typeof e=="object",df=e=>typeof e=="function",D_=e=>typeof e=="boolean";function m_e(e){const t=+e;return Number.isInteger(t)&&String(t)===e}var _l=e=>e.copy_||e.base_,EP=e=>e.modified_?e.copy_:e.base_;function rE(e,t){if(RN(e))return new Map(e);if(zN(e))return new Set(e);if($N(e))return Array[IN].slice.call(e);const n=GY(e);if(t===!0||t==="class_only"&&!n){const s=Rr.getOwnPropertyDescriptors(e);delete s[Qs];let r=Reflect.ownKeys(s);for(let i=0;i<r.length;i++){const o=r[i],l=s[o];l[xv]===!1&&(l[xv]=!0,l[nE]=!0),(l.get||l.set)&&(s[o]={[nE]:!0,[xv]:!0,[hw]:l[hw],[Rp]:e[o]})}return Rr.create(Uf(e),s)}else{const s=Uf(e);if(s!==null&&n)return{...e};const r=Rr.create(s);return Rr.assign(r,e)}}function LP(e,t=!1){return FN(e)||Kl(e)||!to(e)||(t0(e)>1&&Rr.defineProperties(e,{set:ib,add:ib,clear:ib,delete:ib}),Rr.freeze(e),t&&e0(e,(n,s)=>{LP(s,!0)},!1)),e}function f_e(){Hi(2)}var ib={[Rp]:f_e};function FN(e){return e===null||!kP(e)?!0:Rr.isFrozen(e)}var pw="MapSet",iE="Patches",Oz="ArrayMethods",WY={};function Uu(e){const t=WY[e];return t||Hi(0,e),t}var Mz=e=>!!WY[e],zp,VY=()=>zp,h_e=(e,t)=>({drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0,handledSet_:new Set,processedForPatches_:new Set,mapSetPlugin_:Mz(pw)?Uu(pw):void 0,arrayMethodsPlugin_:Mz(Oz)?Uu(Oz):void 0});function Iz(e,t){t&&(e.patchPlugin_=Uu(iE),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function oE(e){lE(e),e.drafts_.forEach(g_e),e.drafts_=null}function lE(e){e===zp&&(zp=e.parent_)}var $z=e=>zp=h_e(zp,e);function g_e(e){const t=e[Qs];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function Rz(e,t){t.unfinalizedDrafts_=t.drafts_.length;const n=t.drafts_[0];if(e!==void 0&&e!==n){n[Qs].modified_&&(oE(t),Hi(4)),to(e)&&(e=zz(t,e));const{patchPlugin_:r}=t;r&&r.generateReplacementPatches_(n[Qs].base_,e,t)}else e=zz(t,n);return p_e(t,e,!0),oE(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==qY?e:void 0}function zz(e,t){if(FN(t))return t;const n=t[Qs];if(!n)return PP(t,e.handledSet_,e);if(!UN(n,e))return t;if(!n.modified_)return n.base_;if(!n.finalized_){const{callbacks_:s}=n;if(s)for(;s.length>0;)s.pop()(e);KY(n,e)}return n.copy_}function p_e(e,t,n=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&LP(t,n)}function YY(e){e.finalized_=!0,e.scope_.unfinalizedDrafts_--}var UN=(e,t)=>e.scope_===t,x_e=[];function QY(e,t,n,s){const r=_l(e),i=e.type_;if(s!==void 0&&sE(r,s,i)===t){gw(r,s,n,i);return}if(!e.draftLocations_){const l=e.draftLocations_=new Map;e0(r,(c,u)=>{if(Kl(u)){const d=l.get(u)||[];d.push(c),l.set(u,d)}})}const o=e.draftLocations_.get(t)??x_e;for(const l of o)gw(r,l,n,i)}function y_e(e,t,n){e.callbacks_.push(function(r){const i=t;if(!i||!UN(i,r))return;r.mapSetPlugin_?.fixSetContents(i);const o=EP(i);QY(e,i.draft_??i,o,n),KY(i,r)})}function KY(e,t){if(e.modified_&&!e.finalized_&&(e.type_===3||e.type_===1&&e.allIndicesReassigned_||(e.assigned_?.size??0)>0)){const{patchPlugin_:s}=t;if(s){const r=s.getPath(e);r&&s.generatePatches_(e,r,t)}YY(e)}}function b_e(e,t,n){const{scope_:s}=e;if(Kl(n)){const r=n[Qs];UN(r,s)&&r.callbacks_.push(function(){yv(e);const o=EP(r);QY(e,n,o,t)})}else to(n)&&e.callbacks_.push(function(){const i=_l(e);sE(i,t,e.type_)===n&&s.drafts_.length>1&&(e.assigned_.get(t)??!1)===!0&&e.copy_&&PP(sE(e.copy_,t,e.type_),s.handledSet_,s)})}function PP(e,t,n){return!n.immer_.autoFreeze_&&n.unfinalizedDrafts_<1||Kl(e)||t.has(e)||!to(e)||FN(e)||(t.add(e),e0(e,(s,r)=>{if(Kl(r)){const i=r[Qs];if(UN(i,n)){const o=EP(i);gw(e,s,o,e.type_),YY(i)}}else to(r)&&PP(r,t,n)})),e}function v_e(e,t){const n=$N(e),s={type_:n?1:0,scope_:t?t.scope_:VY(),modified_:!1,finalized_:!1,assigned_:void 0,parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1,callbacks_:void 0};let r=s,i=DP;n&&(r=[s],i=Fp);const{revoke:o,proxy:l}=Proxy.revocable(r,i);return s.draft_=l,s.revoke_=o,[l,s]}var DP={get(e,t){if(t===Qs)return e;let n=e.scope_.arrayMethodsPlugin_;const s=e.type_===1&&typeof t=="string";if(s&&n?.isArrayOperationMethod(t))return n.createMethodInterceptor(e,t);const r=_l(e);if(!Dz(r,t,e.type_))return w_e(e,r,t);const i=r[t];if(e.finalized_||!to(i)||s&&e.operationMethod&&n?.isMutatingArrayMethod(e.operationMethod)&&m_e(t))return i;if(i===O_(e.base_,t)){yv(e);const o=e.type_===1?+t:t,l=dE(e.scope_,i,e,o);return e.copy_[o]=l}return i},has(e,t){return t in _l(e)},ownKeys(e){return Reflect.ownKeys(_l(e))},set(e,t,n){const s=XY(_l(e),t);if(s?.set)return s.set.call(e.draft_,n),!0;if(!e.modified_){const r=O_(_l(e),t),i=r?.[Qs];if(i&&i.base_===n)return e.copy_[t]=n,e.assigned_.set(t,!1),!0;if(u_e(n,r)&&(n!==void 0||Dz(e.base_,t,e.type_)))return!0;yv(e),cE(e)}return e.copy_[t]===n&&(n!==void 0||t in e.copy_)||Number.isNaN(n)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=n,e.assigned_.set(t,!0),b_e(e,t,n)),!0},deleteProperty(e,t){return yv(e),O_(e.base_,t)!==void 0||t in e.base_?(e.assigned_.set(t,!1),cE(e)):e.assigned_.delete(t),e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const n=_l(e),s=Reflect.getOwnPropertyDescriptor(n,t);return s&&{[xv]:!0,[nE]:e.type_!==1||t!=="length",[hw]:s[hw],[Rp]:n[t]}},defineProperty(){Hi(11)},getPrototypeOf(e){return Uf(e.base_)},setPrototypeOf(){Hi(12)}},Fp={};e0(DP,(e,t)=>{Fp[e]=function(){const n=arguments;return n[0]=n[0][0],t.apply(this,n)}});Fp.deleteProperty=function(e,t){return Fp.set.call(this,e,t,void 0)};Fp.set=function(e,t,n){return DP.set.call(this,e[0],t,n,e[0])};function O_(e,t){const n=e[Qs];return(n?_l(n):e)[t]}function w_e(e,t,n){const s=XY(t,n);return s?Rp in s?s[Rp]:s.get?.call(e.draft_):void 0}function XY(e,t){if(!(t in e))return;let n=Uf(e);for(;n;){const s=Object.getOwnPropertyDescriptor(n,t);if(s)return s;n=Uf(n)}}function cE(e){e.modified_||(e.modified_=!0,e.parent_&&cE(e.parent_))}function yv(e){e.copy_||(e.assigned_=new Map,e.copy_=rE(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var j_e=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!1,this.produce=(n,s,r)=>{if(df(n)&&!df(s)){const o=s;s=n;const l=this;return function(u=o,...d){return l.produce(u,h=>s.call(this,h,...d))}}df(s)||Hi(6),r!==void 0&&!df(r)&&Hi(7);let i;if(to(n)){const o=$z(this),l=dE(o,n,void 0);let c=!0;try{i=s(l),c=!1}finally{c?oE(o):lE(o)}return Iz(o,r),Rz(i,o)}else if(!n||!kP(n)){if(i=s(n),i===void 0&&(i=n),i===qY&&(i=void 0),this.autoFreeze_&&LP(i,!0),r){const o=[],l=[];Uu(iE).generateReplacementPatches_(n,i,{patches_:o,inversePatches_:l}),r(o,l)}return i}else Hi(1,n)},this.produceWithPatches=(n,s)=>{if(df(n))return(l,...c)=>this.produceWithPatches(l,u=>n(u,...c));let r,i;return[this.produce(n,s,(l,c)=>{r=l,i=c}),r,i]},D_(t?.autoFreeze)&&this.setAutoFreeze(t.autoFreeze),D_(t?.useStrictShallowCopy)&&this.setUseStrictShallowCopy(t.useStrictShallowCopy),D_(t?.useStrictIteration)&&this.setUseStrictIteration(t.useStrictIteration)}createDraft(t){to(t)||Hi(8),Kl(t)&&(t=Vi(t));const n=$z(this),s=dE(n,t,void 0);return s[Qs].isManual_=!0,lE(n),s}finishDraft(t,n){const s=t&&t[Qs];(!s||!s.isManual_)&&Hi(9);const{scope_:r}=s;return Iz(r,n),Rz(void 0,r)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}setUseStrictIteration(t){this.useStrictIteration_=t}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(t,n){let s;for(s=n.length-1;s>=0;s--){const i=n[s];if(i.path.length===0&&i.op==="replace"){t=i.value;break}}s>-1&&(n=n.slice(s+1));const r=Uu(iE).applyPatches_;return Kl(t)?r(t,n):this.produce(t,i=>r(i,n))}};function dE(e,t,n,s){const[r,i]=RN(t)?Uu(pw).proxyMap_(t,n):zN(t)?Uu(pw).proxySet_(t,n):v_e(t,n);return(n?.scope_??VY()).drafts_.push(r),i.callbacks_=n?.callbacks_??[],i.key_=s,n&&s!==void 0?y_e(n,i,s):i.callbacks_.push(function(c){c.mapSetPlugin_?.fixSetContents(i);const{patchPlugin_:u}=c;i.modified_&&u&&u.generatePatches_(i,[],c)}),r}function Vi(e){return Kl(e)||Hi(10,e),ZY(e)}function ZY(e){if(!to(e)||FN(e))return e;const t=e[Qs];let n,s=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,n=rE(e,t.scope_.immer_.useStrictShallowCopy_),s=t.scope_.immer_.shouldUseStrictIteration()}else n=rE(e,!0);return e0(n,(r,i)=>{gw(n,r,ZY(i))},s),t&&(t.finalized_=!1),n}var N_e=new j_e,JY=N_e.produce;function eQ(e){return({dispatch:n,getState:s})=>r=>i=>typeof i=="function"?i(n,s,e):r(i)}var C_e=eQ(),S_e=eQ,__e=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?mw:mw.apply(null,arguments)};function ji(e,t){function n(...s){if(t){let r=t(...s);if(!r)throw new Error(Ur(0));return{type:e,payload:r.payload,..."meta"in r&&{meta:r.meta},..."error"in r&&{error:r.error}}}return{type:e,payload:s[0]}}return n.toString=()=>`${e}`,n.type=e,n.match=s=>HY(s)&&s.type===e,n}var tQ=class Yg extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,Yg.prototype)}static get[Symbol.species](){return Yg}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new Yg(...t[0].concat(this)):new Yg(...t.concat(this))}};function Fz(e){return to(e)?JY(e,()=>{}):e}function ob(e,t,n){return e.has(t)?e.get(t):e.set(t,n(t)).get(t)}function A_e(e){return typeof e=="boolean"}var T_e=()=>function(t){const{thunk:n=!0,immutableCheck:s=!0,serializableCheck:r=!0,actionCreatorCheck:i=!0}=t??{};let o=new tQ;return n&&(A_e(n)?o.push(C_e):o.push(S_e(n.extraArgument))),o},aQ="RTK_autoBatch",cn=()=>e=>({payload:e,meta:{[aQ]:!0}}),Uz=e=>t=>{setTimeout(t,e)},nQ=(e={type:"raf"})=>t=>(...n)=>{const s=t(...n);let r=!0,i=!1,o=!1;const l=new Set,c=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:Uz(10):e.type==="callback"?e.queueNotification:Uz(e.timeout),u=()=>{o=!1,i&&(i=!1,l.forEach(d=>d()))};return Object.assign({},s,{subscribe(d){const h=()=>r&&d(),p=s.subscribe(h);return l.add(d),()=>{p(),l.delete(d)}},dispatch(d){try{return r=!d?.meta?.[aQ],i=!r,i&&(o||(o=!0,c(u))),s.dispatch(d)}finally{r=!0}}})},k_e=e=>function(n){const{autoBatch:s=!0}=n??{};let r=new tQ(e);return s&&r.push(nQ(typeof s=="object"?s:void 0)),r};function E_e(e){const t=T_e(),{reducer:n=void 0,middleware:s,devTools:r=!0,preloadedState:i=void 0,enhancers:o=void 0}=e||{};let l;if(typeof n=="function")l=n;else if(TP(n))l=BY(n);else throw new Error(Ur(1));let c;typeof s=="function"?c=s(t):c=t();let u=mw;r&&(u=__e({trace:!1,...typeof r=="object"&&r}));const d=c_e(...c),h=k_e(d);let p=typeof o=="function"?o(h):h();const x=u(...p);return UY(l,i,x)}function sQ(e){const t={},n=[];let s;const r={addCase(i,o){const l=typeof i=="string"?i:i.type;if(!l)throw new Error(Ur(28));if(l in t)throw new Error(Ur(29));return t[l]=o,r},addAsyncThunk(i,o){return o.pending&&(t[i.pending.type]=o.pending),o.rejected&&(t[i.rejected.type]=o.rejected),o.fulfilled&&(t[i.fulfilled.type]=o.fulfilled),o.settled&&n.push({matcher:i.settled,reducer:o.settled}),r},addMatcher(i,o){return n.push({matcher:i,reducer:o}),r},addDefaultCase(i){return s=i,r}};return e(r),[t,n,s]}function L_e(e){return typeof e=="function"}function P_e(e,t){let[n,s,r]=sQ(t),i;if(L_e(e))i=()=>Fz(e());else{const l=Fz(e);i=()=>l}function o(l=i(),c){let u=[n[c.type],...s.filter(({matcher:d})=>d(c)).map(({reducer:d})=>d)];return u.filter(d=>!!d).length===0&&(u=[r]),u.reduce((d,h)=>{if(h)if(Kl(d)){const x=h(d,c);return x===void 0?d:x}else{if(to(d))return JY(d,p=>h(p,c));{const p=h(d,c);if(p===void 0){if(d===null)return d;throw Error("A case reducer on a non-draftable value must not return undefined")}return p}}return d},l)}return o.getInitialState=i,o}var D_e="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",O_e=(e=21)=>{let t="",n=e;for(;n--;)t+=D_e[Math.random()*64|0];return t},M_e=Symbol.for("rtk-slice-createasyncthunk");function I_e(e,t){return`${e}/${t}`}function $_e({creators:e}={}){const t=e?.asyncThunk?.[M_e];return function(s){const{name:r,reducerPath:i=r}=s;if(!r)throw new Error(Ur(11));const o=(typeof s.reducers=="function"?s.reducers(z_e()):s.reducers)||{},l=Object.keys(o),c={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},u={addCase(S,_){const k=typeof S=="string"?S:S.type;if(!k)throw new Error(Ur(12));if(k in c.sliceCaseReducersByType)throw new Error(Ur(13));return c.sliceCaseReducersByType[k]=_,u},addMatcher(S,_){return c.sliceMatchers.push({matcher:S,reducer:_}),u},exposeAction(S,_){return c.actionCreators[S]=_,u},exposeCaseReducer(S,_){return c.sliceCaseReducersByName[S]=_,u}};l.forEach(S=>{const _=o[S],k={reducerName:S,type:I_e(r,S),createNotation:typeof s.reducers=="function"};U_e(_)?H_e(k,_,u,t):F_e(k,_,u)});function d(){const[S={},_=[],k=void 0]=typeof s.extraReducers=="function"?sQ(s.extraReducers):[s.extraReducers],T={...S,...c.sliceCaseReducersByType};return P_e(s.initialState,A=>{for(let E in T)A.addCase(E,T[E]);for(let E of c.sliceMatchers)A.addMatcher(E.matcher,E.reducer);for(let E of _)A.addMatcher(E.matcher,E.reducer);k&&A.addDefaultCase(k)})}const h=S=>S,p=new Map,x=new WeakMap;let v;function j(S,_){return v||(v=d()),v(S,_)}function y(){return v||(v=d()),v.getInitialState()}function N(S,_=!1){function k(A){let E=A[S];return typeof E>"u"&&_&&(E=ob(x,k,y)),E}function T(A=h){const E=ob(p,_,()=>new WeakMap);return ob(E,A,()=>{const M={};for(const[z,P]of Object.entries(s.selectors??{}))M[z]=R_e(P,A,()=>ob(x,A,y),_);return M})}return{reducerPath:S,getSelectors:T,get selectors(){return T(k)},selectSlice:k}}const w={name:r,reducer:j,actions:c.actionCreators,caseReducers:c.sliceCaseReducersByName,getInitialState:y,...N(i),injectInto(S,{reducerPath:_,...k}={}){const T=_??i;return S.inject({reducerPath:T,reducer:j},k),{...w,...N(T,!0)}}};return w}}function R_e(e,t,n,s){function r(i,...o){let l=t(i);return typeof l>"u"&&s&&(l=n()),e(l,...o)}return r.unwrapped=e,r}var Cr=$_e();function z_e(){function e(t,n){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...n}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...n){return t(...n)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,n){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:n}},asyncThunk:e}}function F_e({type:e,reducerName:t,createNotation:n},s,r){let i,o;if("reducer"in s){if(n&&!B_e(s))throw new Error(Ur(17));i=s.reducer,o=s.prepare}else i=s;r.addCase(e,i).exposeCaseReducer(t,i).exposeAction(t,o?ji(e,o):ji(e))}function U_e(e){return e._reducerDefinitionType==="asyncThunk"}function B_e(e){return e._reducerDefinitionType==="reducerWithPrepare"}function H_e({type:e,reducerName:t},n,s,r){if(!r)throw new Error(Ur(18));const{payloadCreator:i,fulfilled:o,pending:l,rejected:c,settled:u,options:d}=n,h=r(e,i,d);s.exposeAction(t,h),o&&s.addCase(h.fulfilled,o),l&&s.addCase(h.pending,l),c&&s.addCase(h.rejected,c),u&&s.addMatcher(h.settled,u),s.exposeCaseReducer(t,{fulfilled:o||lb,pending:l||lb,rejected:c||lb,settled:u||lb})}function lb(){}var q_e="task",rQ="listener",iQ="completed",OP="cancelled",G_e=`task-${OP}`,W_e=`task-${iQ}`,uE=`${rQ}-${OP}`,V_e=`${rQ}-${iQ}`,BN=class{constructor(e){this.code=e,this.message=`${q_e} ${OP} (reason: ${e})`}name="TaskAbortError";message},MP=(e,t)=>{if(typeof e!="function")throw new TypeError(Ur(32))},xw=()=>{},oQ=(e,t=xw)=>(e.catch(t),e),lQ=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),_u=e=>{if(e.aborted)throw new BN(e.reason)};function cQ(e,t){let n=xw;return new Promise((s,r)=>{const i=()=>r(new BN(e.reason));if(e.aborted){i();return}n=lQ(e,i),t.finally(()=>n()).then(s,r)}).finally(()=>{n=xw})}var Y_e=async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(n){return{status:n instanceof BN?"cancelled":"rejected",error:n}}finally{t?.()}},yw=e=>t=>oQ(cQ(e,t).then(n=>(_u(e),n))),dQ=e=>{const t=yw(e);return n=>t(new Promise(s=>setTimeout(s,n)))},{assign:Nf}=Object,Bz={},HN="listenerMiddleware",Q_e=(e,t)=>{const n=s=>lQ(e,()=>s.abort(e.reason));return(s,r)=>{MP(s);const i=new AbortController;n(i);const o=Y_e(async()=>{_u(e),_u(i.signal);const l=await s({pause:yw(i.signal),delay:dQ(i.signal),signal:i.signal});return _u(i.signal),l},()=>i.abort(W_e));return r?.autoJoin&&t.push(o.catch(xw)),{result:yw(e)(o),cancel(){i.abort(G_e)}}}},K_e=(e,t)=>{const n=async(s,r)=>{_u(t);let i=()=>{};const l=[new Promise((c,u)=>{let d=e({predicate:s,effect:(h,p)=>{p.unsubscribe(),c([h,p.getState(),p.getOriginalState()])}});i=()=>{d(),u()}})];r!=null&&l.push(new Promise(c=>setTimeout(c,r,null)));try{const c=await cQ(t,Promise.race(l));return _u(t),c}finally{i()}};return(s,r)=>oQ(n(s,r))},uQ=e=>{let{type:t,actionCreator:n,matcher:s,predicate:r,effect:i}=e;if(t)r=ji(t).match;else if(n)t=n.type,r=n.match;else if(s)r=s;else if(!r)throw new Error(Ur(21));return MP(i),{predicate:r,type:t,effect:i}},mQ=Nf(e=>{const{type:t,predicate:n,effect:s}=uQ(e);return{id:O_e(),effect:s,type:t,predicate:n,pending:new Set,unsubscribe:()=>{throw new Error(Ur(22))}}},{withTypes:()=>mQ}),Hz=(e,t)=>{const{type:n,effect:s,predicate:r}=uQ(t);return Array.from(e.values()).find(i=>(typeof n=="string"?i.type===n:i.predicate===r)&&i.effect===s)},mE=e=>{e.pending.forEach(t=>{t.abort(uE)})},X_e=(e,t)=>()=>{for(const n of t.keys())mE(n);e.clear()},qz=(e,t,n)=>{try{e(t,n)}catch(s){setTimeout(()=>{throw s},0)}},fQ=Nf(ji(`${HN}/add`),{withTypes:()=>fQ}),Z_e=ji(`${HN}/removeAll`),hQ=Nf(ji(`${HN}/remove`),{withTypes:()=>hQ}),J_e=(...e)=>{console.error(`${HN}/error`,...e)},a0=(e={})=>{const t=new Map,n=new Map,s=x=>{const v=n.get(x)??0;n.set(x,v+1)},r=x=>{const v=n.get(x)??1;v===1?n.delete(x):n.set(x,v-1)},{extra:i,onError:o=J_e}=e;MP(o);const l=x=>(x.unsubscribe=()=>t.delete(x.id),t.set(x.id,x),v=>{x.unsubscribe(),v?.cancelActive&&mE(x)}),c=x=>{const v=Hz(t,x)??mQ(x);return l(v)};Nf(c,{withTypes:()=>c});const u=x=>{const v=Hz(t,x);return v&&(v.unsubscribe(),x.cancelActive&&mE(v)),!!v};Nf(u,{withTypes:()=>u});const d=async(x,v,j,y)=>{const N=new AbortController,w=K_e(c,N.signal),S=[];try{x.pending.add(N),s(x),await Promise.resolve(x.effect(v,Nf({},j,{getOriginalState:y,condition:(_,k)=>w(_,k).then(Boolean),take:w,delay:dQ(N.signal),pause:yw(N.signal),extra:i,signal:N.signal,fork:Q_e(N.signal,S),unsubscribe:x.unsubscribe,subscribe:()=>{t.set(x.id,x)},cancelActiveListeners:()=>{x.pending.forEach((_,k,T)=>{_!==N&&(_.abort(uE),T.delete(_))})},cancel:()=>{N.abort(uE),x.pending.delete(N)},throwIfCancelled:()=>{_u(N.signal)}})))}catch(_){_ instanceof BN||qz(o,_,{raisedBy:"effect"})}finally{await Promise.all(S),N.abort(V_e),r(x),x.pending.delete(N)}},h=X_e(t,n);return{middleware:x=>v=>j=>{if(!HY(j))return v(j);if(fQ.match(j))return c(j.payload);if(Z_e.match(j)){h();return}if(hQ.match(j))return u(j.payload);let y=x.getState();const N=()=>{if(y===Bz)throw new Error(Ur(23));return y};let w;try{if(w=v(j),t.size>0){const S=x.getState(),_=Array.from(t.values());for(const k of _){let T=!1;try{T=k.predicate(j,S,y)}catch(A){T=!1,qz(o,A,{raisedBy:"predicate"})}T&&d(k,j,x,N)}}}finally{y=Bz}return w},startListening:c,stopListening:u,clearListeners:h}};function Ur(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var eAe={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},gQ=Cr({name:"chartLayout",initialState:eAe,reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){var n,s,r,i;e.margin.top=(n=t.payload.top)!==null&&n!==void 0?n:0,e.margin.right=(s=t.payload.right)!==null&&s!==void 0?s:0,e.margin.bottom=(r=t.payload.bottom)!==null&&r!==void 0?r:0,e.margin.left=(i=t.payload.left)!==null&&i!==void 0?i:0},setScale(e,t){e.scale=t.payload}}}),{setMargin:tAe,setLayout:aAe,setChartSize:nAe,setScale:sAe}=gQ.actions,rAe=gQ.reducer;function pQ(e,t,n){return Array.isArray(e)&&e&&t+n!==0?e.slice(t,n+1):e}function xn(e){return Number.isFinite(e)}function qo(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function Gz(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function mf(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Gz(Object(n),!0).forEach(function(s){iAe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Gz(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function iAe(e,t,n){return(t=oAe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function oAe(e){var t=lAe(e,"string");return typeof t=="symbol"?t:t+""}function lAe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qa(e,t,n){return fn(e)||fn(t)?n:Ho(t)?Fu(e,t,n):typeof t=="function"?t(e):n}var cAe=(e,t,n)=>{if(t&&n){var{width:s,height:r}=n,{align:i,verticalAlign:o,layout:l}=t;if((l==="vertical"||l==="horizontal"&&o==="middle")&&i!=="center"&&Ut(e[i]))return mf(mf({},e),{},{[i]:e[i]+(s||0)});if((l==="horizontal"||l==="vertical"&&i==="center")&&o!=="middle"&&Ut(e[o]))return mf(mf({},e),{},{[o]:e[o]+(r||0)})}return e},Pd=(e,t)=>e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis",xQ=(e,t,n,s)=>{if(s)return e.map(l=>l.coordinate);var r,i,o=e.map(l=>(l.coordinate===t&&(r=!0),l.coordinate===n&&(i=!0),l.coordinate));return r||o.push(t),i||o.push(n),o},yQ=(e,t,n)=>{if(!e)return null;var{duplicateDomain:s,type:r,range:i,scale:o,realScaleType:l,isCategorical:c,categoricalDomain:u,tickCount:d,ticks:h,niceTicks:p,axisType:x}=e;if(!o)return null;var v=l==="scaleBand"&&o.bandwidth?o.bandwidth()/2:2,j=r==="category"&&o.bandwidth?o.bandwidth()/v:0;if(j=x==="angleAxis"&&i&&i.length>=2?xs(i[0]-i[1])*2*j:j,h||p){var y=(h||p||[]).map((N,w)=>{var S=s?s.indexOf(N):N;return{coordinate:o(S)+j,value:N,offset:j,index:w}});return y.filter(N=>!eo(N.coordinate))}return c&&u?u.map((N,w)=>({coordinate:o(N)+j,value:N,index:w,offset:j})):o.ticks&&d!=null?o.ticks(d).map((N,w)=>({coordinate:o(N)+j,value:N,offset:j,index:w})):o.domain().map((N,w)=>({coordinate:o(N)+j,value:s?s[N]:N,index:w,offset:j}))},Wz=1e-4,dAe=e=>{var t=e.domain();if(!(!t||t.length<=2)){var n=t.length,s=e.range(),r=Math.min(s[0],s[1])-Wz,i=Math.max(s[0],s[1])+Wz,o=e(t[0]),l=e(t[n-1]);(o<r||o>i||l<r||l>i)&&e.domain([t[0],t[n-1]])}},uAe=(e,t)=>{if(!t||t.length!==2||!Ut(t[0])||!Ut(t[1]))return e;var n=Math.min(t[0],t[1]),s=Math.max(t[0],t[1]),r=[e[0],e[1]];return(!Ut(e[0])||e[0]<n)&&(r[0]=n),(!Ut(e[1])||e[1]>s)&&(r[1]=s),r[0]>s&&(r[0]=s),r[1]<n&&(r[1]=n),r},mAe=e=>{var t,n=e.length;if(!(n<=0)){var s=(t=e[0])===null||t===void 0?void 0:t.length;if(!(s==null||s<=0))for(var r=0;r<s;++r)for(var i=0,o=0,l=0;l<n;++l){var c=e[l],u=c?.[r];if(u!=null){var d=u[1],h=u[0],p=eo(d)?h:d;p>=0?(u[0]=i,u[1]=i+p,i=d):(u[0]=o,u[1]=o+p,o=d)}}}},fAe=e=>{var t,n=e.length;if(!(n<=0)){var s=(t=e[0])===null||t===void 0?void 0:t.length;if(!(s==null||s<=0))for(var r=0;r<s;++r)for(var i=0,o=0;o<n;++o){var l=e[o],c=l?.[r];if(c!=null){var u=eo(c[1])?c[0]:c[1];u>=0?(c[0]=i,c[1]=i+u,i=c[1]):(c[0]=0,c[1]=0)}}}},hAe={sign:mAe,expand:yW,none:gd,silhouette:bW,wiggle:vW,positive:fAe},gAe=(e,t,n)=>{var s,r=(s=hAe[n])!==null&&s!==void 0?s:gd,i=R4().keys(t).value((l,c)=>Number(qa(l,c,0))).order(Iu).offset(r),o=i(e);return o.forEach((l,c)=>{l.forEach((u,d)=>{var h=qa(e[d],t[c],0);Array.isArray(h)&&h.length===2&&Ut(h[0])&&Ut(h[1])&&(u[0]=h[0],u[1]=h[1])})}),o};function pAe(e){return e==null?void 0:String(e)}function Vz(e){var{axis:t,ticks:n,bandSize:s,entry:r,index:i,dataKey:o}=e;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!fn(r[t.dataKey])){var l=CY(n,"value",r[t.dataKey]);if(l)return l.coordinate+s/2}return n[i]?n[i].coordinate+s/2:null}var c=qa(r,fn(o)?t.dataKey:o);return fn(c)?null:t.scale(c)}var Yz=e=>{var{axis:t,ticks:n,offset:s,bandSize:r,entry:i,index:o}=e;if(t.type==="category")return n[o]?n[o].coordinate+s:null;var l=qa(i,t.dataKey,t.scale.domain()[o]);return fn(l)?null:t.scale(l)-r/2+s},xAe=e=>{var{numericAxis:t}=e,n=t.scale.domain();if(t.type==="number"){var s=Math.min(n[0],n[1]),r=Math.max(n[0],n[1]);return s<=0&&r>=0?0:r<0?r:s}return n[0]},yAe=e=>{var t=e.flat(2).filter(Ut);return[Math.min(...t),Math.max(...t)]},bAe=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],vAe=(e,t,n)=>{if(e!=null)return bAe(Object.keys(e).reduce((s,r)=>{var i=e[r];if(!i)return s;var{stackedData:o}=i,l=o.reduce((c,u)=>{var d=pQ(u,t,n),h=yAe(d);return!xn(h[0])||!xn(h[1])?c:[Math.min(c[0],h[0]),Math.max(c[1],h[1])]},[1/0,-1/0]);return[Math.min(l[0],s[0]),Math.max(l[1],s[1])]},[1/0,-1/0]))},Qz=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Kz=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Bf=(e,t,n)=>{if(e&&e.scale&&e.scale.bandwidth){var s=e.scale.bandwidth();if(!n||s>0)return s}if(e&&t&&t.length>=2){for(var r=MN(t,d=>d.coordinate),i=1/0,o=1,l=r.length;o<l;o++){var c=r[o],u=r[o-1];i=Math.min((c?.coordinate||0)-(u?.coordinate||0),i)}return i===1/0?0:i}return n?void 0:0};function Xz(e){var{tooltipEntrySettings:t,dataKey:n,payload:s,value:r,name:i}=e;return mf(mf({},t),{},{dataKey:n,payload:s,value:r,name:i})}function fh(e,t){if(e)return String(e);if(typeof t=="string")return t}var wAe=(e,t)=>{if(t==="horizontal")return e.chartX;if(t==="vertical")return e.chartY},jAe=(e,t)=>t==="centric"?e.angle:e.radius,oc=e=>e.layout.width,lc=e=>e.layout.height,NAe=e=>e.layout.scale,bQ=e=>e.layout.margin,qN=ut(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),GN=ut(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),vQ="data-recharts-item-index",wQ="data-recharts-item-id",n0=60;function Zz(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function cb(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Zz(Object(n),!0).forEach(function(s){CAe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Zz(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function CAe(e,t,n){return(t=SAe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function SAe(e){var t=_Ae(e,"string");return typeof t=="symbol"?t:t+""}function _Ae(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var AAe=e=>e.brush.height;function TAe(e){var t=GN(e);return t.reduce((n,s)=>{if(s.orientation==="left"&&!s.mirror&&!s.hide){var r=typeof s.width=="number"?s.width:n0;return n+r}return n},0)}function kAe(e){var t=GN(e);return t.reduce((n,s)=>{if(s.orientation==="right"&&!s.mirror&&!s.hide){var r=typeof s.width=="number"?s.width:n0;return n+r}return n},0)}function EAe(e){var t=qN(e);return t.reduce((n,s)=>s.orientation==="top"&&!s.mirror&&!s.hide?n+s.height:n,0)}function LAe(e){var t=qN(e);return t.reduce((n,s)=>s.orientation==="bottom"&&!s.mirror&&!s.hide?n+s.height:n,0)}var ls=ut([oc,lc,bQ,AAe,TAe,kAe,EAe,LAe,zY,a_e],(e,t,n,s,r,i,o,l,c,u)=>{var d={left:(n.left||0)+r,right:(n.right||0)+i},h={top:(n.top||0)+o,bottom:(n.bottom||0)+l},p=cb(cb({},h),d),x=p.bottom;p.bottom+=s,p=cAe(p,c,u);var v=e-p.left-p.right,j=t-p.top-p.bottom;return cb(cb({brushBottom:x},p),{},{width:Math.max(v,0),height:Math.max(j,0)})}),PAe=ut(ls,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),IP=ut(oc,lc,(e,t)=>({x:0,y:0,width:e,height:t})),DAe=f.createContext(null),Hs=()=>f.useContext(DAe)!=null,WN=e=>e.brush,VN=ut([WN,ls,bQ],(e,t,n)=>({height:e.height,x:Ut(e.x)?e.x:t.left,y:Ut(e.y)?e.y:t.top+t.height+t.brushBottom-(n?.bottom||0),width:Ut(e.width)?e.width:t.width})),M_={},I_={},$_={},Jz;function OAe(){return Jz||(Jz=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n,s,{signal:r,edges:i}={}){let o,l=null;const c=i!=null&&i.includes("leading"),u=i==null||i.includes("trailing"),d=()=>{l!==null&&(n.apply(o,l),o=void 0,l=null)},h=()=>{u&&d(),j()};let p=null;const x=()=>{p!=null&&clearTimeout(p),p=setTimeout(()=>{p=null,h()},s)},v=()=>{p!==null&&(clearTimeout(p),p=null)},j=()=>{v(),o=void 0,l=null},y=()=>{d()},N=function(...w){if(r?.aborted)return;o=this,l=w;const S=p==null;x(),c&&S&&d()};return N.schedule=x,N.cancel=j,N.flush=y,r?.addEventListener("abort",j,{once:!0}),N}e.debounce=t})($_)),$_}var eF;function MAe(){return eF||(eF=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=OAe();function n(s,r=0,i={}){typeof i!="object"&&(i={});const{leading:o=!1,trailing:l=!0,maxWait:c}=i,u=Array(2);o&&(u[0]="leading"),l&&(u[1]="trailing");let d,h=null;const p=t.debounce(function(...j){d=s.apply(this,j),h=null},r,{edges:u}),x=function(...j){return c!=null&&(h===null&&(h=Date.now()),Date.now()-h>=c)?(d=s.apply(this,j),h=Date.now(),p.cancel(),p.schedule(),d):(p.apply(this,j),d)},v=()=>(p.flush(),d);return x.cancel=p.cancel,x.flush=v,x}e.debounce=n})(I_)),I_}var tF;function IAe(){return tF||(tF=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=MAe();function n(s,r=0,i={}){const{leading:o=!0,trailing:l=!0}=i;return t.debounce(s,r,{leading:o,maxWait:r,trailing:l})}e.throttle=n})(M_)),M_}var R_,aF;function $Ae(){return aF||(aF=1,R_=IAe().throttle),R_}var RAe=$Ae();const zAe=ao(RAe);var bw=function(t,n){for(var s=arguments.length,r=new Array(s>2?s-2:0),i=2;i<s;i++)r[i-2]=arguments[i];if(typeof console<"u"&&console.warn&&(n===void 0&&console.warn("LogUtils requires an error message argument"),!t))if(n===void 0)console.warn("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var o=0;console.warn(n.replace(/%s/g,()=>r[o++]))}},jQ=(e,t,n)=>{var{width:s="100%",height:r="100%",aspect:i,maxHeight:o}=n,l=Ql(s)?e:Number(s),c=Ql(r)?t:Number(r);return i&&i>0&&(l?c=l/i:c&&(l=c*i),o&&c!=null&&c>o&&(c=o)),{calculatedWidth:l,calculatedHeight:c}},FAe={width:0,height:0,overflow:"visible"},UAe={width:0,overflowX:"visible"},BAe={height:0,overflowY:"visible"},HAe={},qAe=e=>{var{width:t,height:n}=e,s=Ql(t),r=Ql(n);return s&&r?FAe:s?UAe:r?BAe:HAe};function GAe(e){var{width:t,height:n,aspect:s}=e,r=t,i=n;return r===void 0&&i===void 0?(r="100%",i="100%"):r===void 0?r=s&&s>0?void 0:"100%":i===void 0&&(i=s&&s>0?void 0:"100%"),{width:r,height:i}}function fE(){return fE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},fE.apply(null,arguments)}function nF(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function sF(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?nF(Object(n),!0).forEach(function(s){WAe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nF(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function WAe(e,t,n){return(t=VAe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function VAe(e){var t=YAe(e,"string");return typeof t=="symbol"?t:t+""}function YAe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var NQ=f.createContext({width:-1,height:-1});function QAe(e){return qo(e.width)&&qo(e.height)}function CQ(e){var{children:t,width:n,height:s}=e,r=f.useMemo(()=>({width:n,height:s}),[n,s]);return QAe(r)?f.createElement(NQ.Provider,{value:r},t):null}var $P=()=>f.useContext(NQ),KAe=f.forwardRef((e,t)=>{var{aspect:n,initialDimension:s={width:-1,height:-1},width:r,height:i,minWidth:o=0,minHeight:l,maxHeight:c,children:u,debounce:d=0,id:h,className:p,onResize:x,style:v={}}=e,j=f.useRef(null),y=f.useRef();y.current=x,f.useImperativeHandle(t,()=>j.current);var[N,w]=f.useState({containerWidth:s.width,containerHeight:s.height}),S=f.useCallback((E,M)=>{w(z=>{var P=Math.round(E),D=Math.round(M);return z.containerWidth===P&&z.containerHeight===D?z:{containerWidth:P,containerHeight:D}})},[]);f.useEffect(()=>{if(j.current==null||typeof ResizeObserver>"u")return Zx;var E=D=>{var U,{width:B,height:R}=D[0].contentRect;S(B,R),(U=y.current)===null||U===void 0||U.call(y,B,R)};d>0&&(E=zAe(E,d,{trailing:!0,leading:!1}));var M=new ResizeObserver(E),{width:z,height:P}=j.current.getBoundingClientRect();return S(z,P),M.observe(j.current),()=>{M.disconnect()}},[S,d]);var{containerWidth:_,containerHeight:k}=N;bw(!n||n>0,"The aspect(%s) must be greater than zero.",n);var{calculatedWidth:T,calculatedHeight:A}=jQ(_,k,{width:r,height:i,aspect:n,maxHeight:c});return bw(T!=null&&T>0||A!=null&&A>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,T,A,r,i,o,l,n),f.createElement("div",{id:h?"".concat(h):void 0,className:$t("recharts-responsive-container",p),style:sF(sF({},v),{},{width:r,height:i,minWidth:o,minHeight:l,maxHeight:c}),ref:j},f.createElement("div",{style:qAe({width:r,height:i})},f.createElement(CQ,{width:T,height:A},u)))}),z_=f.forwardRef((e,t)=>{var n=$P();if(qo(n.width)&&qo(n.height))return e.children;var{width:s,height:r}=GAe({width:e.width,height:e.height,aspect:e.aspect}),{calculatedWidth:i,calculatedHeight:o}=jQ(void 0,void 0,{width:s,height:r,aspect:e.aspect,maxHeight:e.maxHeight});return Ut(i)&&Ut(o)?f.createElement(CQ,{width:i,height:o},e.children):f.createElement(KAe,fE({},e,{width:s,height:r,ref:t}))});function SQ(e){if(e)return{x:e.x,y:e.y,upperWidth:"upperWidth"in e?e.upperWidth:e.width,lowerWidth:"lowerWidth"in e?e.lowerWidth:e.width,width:e.width,height:e.height}}var YN=()=>{var e,t=Hs(),n=Bt(PAe),s=Bt(VN),r=(e=Bt(WN))===null||e===void 0?void 0:e.padding;return!t||!s||!r?n:{width:s.width-r.left-r.right,height:s.height-r.top-r.bottom,x:r.left,y:r.top}},XAe={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},_Q=()=>{var e;return(e=Bt(ls))!==null&&e!==void 0?e:XAe},RP=()=>Bt(oc),zP=()=>Bt(lc),ZAe=()=>Bt(e=>e.layout.margin),ja=e=>e.layout.layoutType,hh=()=>Bt(ja),JAe=()=>{var e=hh();return e!==void 0},QN=e=>{var t=en(),n=Hs(),{width:s,height:r}=e,i=$P(),o=s,l=r;return i&&(o=i.width>0?i.width:s,l=i.height>0?i.height:r),f.useEffect(()=>{!n&&qo(o)&&qo(l)&&t(nAe({width:o,height:l}))},[t,n,o,l]),null},AQ=Symbol.for("immer-nothing"),rF=Symbol.for("immer-draftable"),Gr=Symbol.for("immer-state");function qi(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Up=Object.getPrototypeOf;function Hf(e){return!!e&&!!e[Gr]}function Bu(e){return e?TQ(e)||Array.isArray(e)||!!e[rF]||!!e.constructor?.[rF]||s0(e)||XN(e):!1}var eTe=Object.prototype.constructor.toString(),iF=new WeakMap;function TQ(e){if(!e||typeof e!="object")return!1;const t=Object.getPrototypeOf(e);if(t===null||t===Object.prototype)return!0;const n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;if(n===Object)return!0;if(typeof n!="function")return!1;let s=iF.get(n);return s===void 0&&(s=Function.toString.call(n),iF.set(n,s)),s===eTe}function vw(e,t,n=!0){KN(e)===0?(n?Reflect.ownKeys(e):Object.keys(e)).forEach(r=>{t(r,e[r],e)}):e.forEach((s,r)=>t(r,s,e))}function KN(e){const t=e[Gr];return t?t.type_:Array.isArray(e)?1:s0(e)?2:XN(e)?3:0}function hE(e,t){return KN(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function kQ(e,t,n){const s=KN(e);s===2?e.set(t,n):s===3?e.add(n):e[t]=n}function tTe(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function s0(e){return e instanceof Map}function XN(e){return e instanceof Set}function nu(e){return e.copy_||e.base_}function gE(e,t){if(s0(e))return new Map(e);if(XN(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const n=TQ(e);if(t===!0||t==="class_only"&&!n){const s=Object.getOwnPropertyDescriptors(e);delete s[Gr];let r=Reflect.ownKeys(s);for(let i=0;i<r.length;i++){const o=r[i],l=s[o];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(s[o]={configurable:!0,writable:!0,enumerable:l.enumerable,value:e[o]})}return Object.create(Up(e),s)}else{const s=Up(e);if(s!==null&&n)return{...e};const r=Object.create(s);return Object.assign(r,e)}}function FP(e,t=!1){return ZN(e)||Hf(e)||!Bu(e)||(KN(e)>1&&Object.defineProperties(e,{set:db,add:db,clear:db,delete:db}),Object.freeze(e),t&&Object.values(e).forEach(n=>FP(n,!0))),e}function aTe(){qi(2)}var db={value:aTe};function ZN(e){return e===null||typeof e!="object"?!0:Object.isFrozen(e)}var nTe={};function Hu(e){const t=nTe[e];return t||qi(0,e),t}var Bp;function EQ(){return Bp}function sTe(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function oF(e,t){t&&(Hu("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function pE(e){xE(e),e.drafts_.forEach(rTe),e.drafts_=null}function xE(e){e===Bp&&(Bp=e.parent_)}function lF(e){return Bp=sTe(Bp,e)}function rTe(e){const t=e[Gr];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function cF(e,t){t.unfinalizedDrafts_=t.drafts_.length;const n=t.drafts_[0];return e!==void 0&&e!==n?(n[Gr].modified_&&(pE(t),qi(4)),Bu(e)&&(e=ww(t,e),t.parent_||jw(t,e)),t.patches_&&Hu("Patches").generateReplacementPatches_(n[Gr].base_,e,t.patches_,t.inversePatches_)):e=ww(t,n,[]),pE(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==AQ?e:void 0}function ww(e,t,n){if(ZN(t))return t;const s=e.immer_.shouldUseStrictIteration(),r=t[Gr];if(!r)return vw(t,(i,o)=>dF(e,r,t,i,o,n),s),t;if(r.scope_!==e)return t;if(!r.modified_)return jw(e,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const i=r.copy_;let o=i,l=!1;r.type_===3&&(o=new Set(i),i.clear(),l=!0),vw(o,(c,u)=>dF(e,r,i,c,u,n,l),s),jw(e,i,!1),n&&e.patches_&&Hu("Patches").generatePatches_(r,n,e.patches_,e.inversePatches_)}return r.copy_}function dF(e,t,n,s,r,i,o){if(r==null||typeof r!="object"&&!o)return;const l=ZN(r);if(!(l&&!o)){if(Hf(r)){const c=i&&t&&t.type_!==3&&!hE(t.assigned_,s)?i.concat(s):void 0,u=ww(e,r,c);if(kQ(n,s,u),Hf(u))e.canAutoFreeze_=!1;else return}else o&&n.add(r);if(Bu(r)&&!l){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1||t&&t.base_&&t.base_[s]===r&&l)return;ww(e,r),(!t||!t.scope_.parent_)&&typeof s!="symbol"&&(s0(n)?n.has(s):Object.prototype.propertyIsEnumerable.call(n,s))&&jw(e,r)}}}function jw(e,t,n=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&FP(t,n)}function iTe(e,t){const n=Array.isArray(e),s={type_:n?1:0,scope_:t?t.scope_:EQ(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let r=s,i=UP;n&&(r=[s],i=Hp);const{revoke:o,proxy:l}=Proxy.revocable(r,i);return s.draft_=l,s.revoke_=o,l}var UP={get(e,t){if(t===Gr)return e;const n=nu(e);if(!hE(n,t))return oTe(e,n,t);const s=n[t];return e.finalized_||!Bu(s)?s:s===F_(e.base_,t)?(U_(e),e.copy_[t]=bE(s,e)):s},has(e,t){return t in nu(e)},ownKeys(e){return Reflect.ownKeys(nu(e))},set(e,t,n){const s=LQ(nu(e),t);if(s?.set)return s.set.call(e.draft_,n),!0;if(!e.modified_){const r=F_(nu(e),t),i=r?.[Gr];if(i&&i.base_===n)return e.copy_[t]=n,e.assigned_[t]=!1,!0;if(tTe(n,r)&&(n!==void 0||hE(e.base_,t)))return!0;U_(e),yE(e)}return e.copy_[t]===n&&(n!==void 0||t in e.copy_)||Number.isNaN(n)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=n,e.assigned_[t]=!0),!0},deleteProperty(e,t){return F_(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,U_(e),yE(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const n=nu(e),s=Reflect.getOwnPropertyDescriptor(n,t);return s&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:s.enumerable,value:n[t]}},defineProperty(){qi(11)},getPrototypeOf(e){return Up(e.base_)},setPrototypeOf(){qi(12)}},Hp={};vw(UP,(e,t)=>{Hp[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});Hp.deleteProperty=function(e,t){return Hp.set.call(this,e,t,void 0)};Hp.set=function(e,t,n){return UP.set.call(this,e[0],t,n,e[0])};function F_(e,t){const n=e[Gr];return(n?nu(n):e)[t]}function oTe(e,t,n){const s=LQ(t,n);return s?"value"in s?s.value:s.get?.call(e.draft_):void 0}function LQ(e,t){if(!(t in e))return;let n=Up(e);for(;n;){const s=Object.getOwnPropertyDescriptor(n,t);if(s)return s;n=Up(n)}}function yE(e){e.modified_||(e.modified_=!0,e.parent_&&yE(e.parent_))}function U_(e){e.copy_||(e.copy_=gE(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var lTe=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(t,n,s)=>{if(typeof t=="function"&&typeof n!="function"){const i=n;n=t;const o=this;return function(c=i,...u){return o.produce(c,d=>n.call(this,d,...u))}}typeof n!="function"&&qi(6),s!==void 0&&typeof s!="function"&&qi(7);let r;if(Bu(t)){const i=lF(this),o=bE(t,void 0);let l=!0;try{r=n(o),l=!1}finally{l?pE(i):xE(i)}return oF(i,s),cF(r,i)}else if(!t||typeof t!="object"){if(r=n(t),r===void 0&&(r=t),r===AQ&&(r=void 0),this.autoFreeze_&&FP(r,!0),s){const i=[],o=[];Hu("Patches").generateReplacementPatches_(t,r,i,o),s(i,o)}return r}else qi(1,t)},this.produceWithPatches=(t,n)=>{if(typeof t=="function")return(o,...l)=>this.produceWithPatches(o,c=>t(c,...l));let s,r;return[this.produce(t,n,(o,l)=>{s=o,r=l}),s,r]},typeof e?.autoFreeze=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof e?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),typeof e?.useStrictIteration=="boolean"&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){Bu(e)||qi(8),Hf(e)&&(e=cTe(e));const t=lF(this),n=bE(e,void 0);return n[Gr].isManual_=!0,xE(t),n}finishDraft(e,t){const n=e&&e[Gr];(!n||!n.isManual_)&&qi(9);const{scope_:s}=n;return oF(s,t),cF(void 0,s)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,t){let n;for(n=t.length-1;n>=0;n--){const r=t[n];if(r.path.length===0&&r.op==="replace"){e=r.value;break}}n>-1&&(t=t.slice(n+1));const s=Hu("Patches").applyPatches_;return Hf(e)?s(e,t):this.produce(e,r=>s(r,t))}};function bE(e,t){const n=s0(e)?Hu("MapSet").proxyMap_(e,t):XN(e)?Hu("MapSet").proxySet_(e,t):iTe(e,t);return(t?t.scope_:EQ()).drafts_.push(n),n}function cTe(e){return Hf(e)||qi(10,e),PQ(e)}function PQ(e){if(!Bu(e)||ZN(e))return e;const t=e[Gr];let n,s=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,n=gE(e,t.scope_.immer_.useStrictShallowCopy_),s=t.scope_.immer_.shouldUseStrictIteration()}else n=gE(e,!0);return vw(n,(r,i)=>{kQ(n,r,PQ(i))},s),t&&(t.finalized_=!1),n}var dTe=new lTe;dTe.produce;var uTe={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},DQ=Cr({name:"legend",initialState:uTe,reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload:{reducer(e,t){e.payload.push(t.payload)},prepare:cn()},replaceLegendPayload:{reducer(e,t){var{prev:n,next:s}=t.payload,r=Vi(e).payload.indexOf(n);r>-1&&(e.payload[r]=s)},prepare:cn()},removeLegendPayload:{reducer(e,t){var n=Vi(e).payload.indexOf(t.payload);n>-1&&e.payload.splice(n,1)},prepare:cn()}}}),{setLegendSize:uF,setLegendSettings:mTe,addLegendPayload:OQ,replaceLegendPayload:MQ,removeLegendPayload:IQ}=DQ.actions,fTe=DQ.reducer,hTe=["contextPayload"];function vE(){return vE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},vE.apply(null,arguments)}function mF(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function qf(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?mF(Object(n),!0).forEach(function(s){gTe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mF(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function gTe(e,t,n){return(t=pTe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function pTe(e){var t=xTe(e,"string");return typeof t=="symbol"?t:t+""}function xTe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yTe(e,t){if(e==null)return{};var n,s,r=bTe(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)n=i[s],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function bTe(e,t){if(e==null)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;n[s]=e[s]}return n}function vTe(e){return e.value}function wTe(e){var{contextPayload:t}=e,n=yTe(e,hTe),s=IY(t,e.payloadUniqBy,vTe),r=qf(qf({},n),{},{payload:s});return f.isValidElement(e.content)?f.cloneElement(e.content,r):typeof e.content=="function"?f.createElement(e.content,r):f.createElement(_2e,r)}function jTe(e,t,n,s,r,i){var{layout:o,align:l,verticalAlign:c}=t,u,d;return(!e||(e.left===void 0||e.left===null)&&(e.right===void 0||e.right===null))&&(l==="center"&&o==="vertical"?u={left:((s||0)-i.width)/2}:u=l==="right"?{right:n&&n.right||0}:{left:n&&n.left||0}),(!e||(e.top===void 0||e.top===null)&&(e.bottom===void 0||e.bottom===null))&&(c==="middle"?d={top:((r||0)-i.height)/2}:d=c==="bottom"?{bottom:n&&n.bottom||0}:{top:n&&n.top||0}),qf(qf({},u),d)}function NTe(e){var t=en();return f.useEffect(()=>{t(mTe(e))},[t,e]),null}function CTe(e){var t=en();return f.useEffect(()=>(t(uF(e)),()=>{t(uF({width:0,height:0}))}),[t,e]),null}function STe(e,t,n,s){return e==="vertical"&&Ut(t)?{height:t}:e==="horizontal"?{width:n||s}:null}var _Te={align:"center",iconSize:14,itemSorter:"value",layout:"horizontal",verticalAlign:"bottom"};function $Q(e){var t=Qn(e,_Te),n=r_e(),s=KSe(),r=ZAe(),{width:i,height:o,wrapperStyle:l,portal:c}=t,[u,d]=FY([n]),h=RP(),p=zP();if(h==null||p==null)return null;var x=h-(r?.left||0)-(r?.right||0),v=STe(t.layout,o,i,x),j=c?l:qf(qf({position:"absolute",width:v?.width||i||"auto",height:v?.height||o||"auto"},jTe(l,t,r,h,p,u)),l),y=c??s;if(y==null||n==null)return null;var N=f.createElement("div",{className:"recharts-legend-wrapper",style:j,ref:d},f.createElement(NTe,{layout:t.layout,align:t.align,verticalAlign:t.verticalAlign,itemSorter:t.itemSorter}),!c&&f.createElement(CTe,{width:u.width,height:u.height}),f.createElement(wTe,vE({},t,v,{margin:r,chartWidth:h,chartHeight:p,contextPayload:n})));return Gi.createPortal(N,y)}$Q.displayName="Legend";function wE(){return wE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},wE.apply(null,arguments)}function fF(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function B_(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?fF(Object(n),!0).forEach(function(s){ATe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fF(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function ATe(e,t,n){return(t=TTe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function TTe(e){var t=kTe(e,"string");return typeof t=="symbol"?t:t+""}function kTe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ETe(e){return Array.isArray(e)&&Ho(e[0])&&Ho(e[1])?e.join(" ~ "):e}var LTe=e=>{var{separator:t=" : ",contentStyle:n={},itemStyle:s={},labelStyle:r={},payload:i,formatter:o,itemSorter:l,wrapperClassName:c,labelClassName:u,label:d,labelFormatter:h,accessibilityLayer:p=!1}=e,x=()=>{if(i&&i.length){var k={padding:0,margin:0},T=(l?MN(i,l):i).map((A,E)=>{if(A.type==="none")return null;var M=A.formatter||o||ETe,{value:z,name:P}=A,D=z,U=P;if(M){var B=M(z,P,A,E,i);if(Array.isArray(B))[D,U]=B;else if(B!=null)D=B;else return null}var R=B_({display:"block",paddingTop:4,paddingBottom:4,color:A.color||"#000"},s);return f.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(E),style:R},Ho(U)?f.createElement("span",{className:"recharts-tooltip-item-name"},U):null,Ho(U)?f.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,f.createElement("span",{className:"recharts-tooltip-item-value"},D),f.createElement("span",{className:"recharts-tooltip-item-unit"},A.unit||""))});return f.createElement("ul",{className:"recharts-tooltip-item-list",style:k},T)}return null},v=B_({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},n),j=B_({margin:0},r),y=!fn(d),N=y?d:"",w=$t("recharts-default-tooltip",c),S=$t("recharts-tooltip-label",u);y&&h&&i!==void 0&&i!==null&&(N=h(d,i));var _=p?{role:"status","aria-live":"assertive"}:{};return f.createElement("div",wE({className:w,style:v},_),f.createElement("p",{className:S,style:j},f.isValidElement(N)?N:"".concat(N)),x())},Cg="recharts-tooltip-wrapper",PTe={visibility:"hidden"};function DTe(e){var{coordinate:t,translateX:n,translateY:s}=e;return $t(Cg,{["".concat(Cg,"-right")]:Ut(n)&&t&&Ut(t.x)&&n>=t.x,["".concat(Cg,"-left")]:Ut(n)&&t&&Ut(t.x)&&n<t.x,["".concat(Cg,"-bottom")]:Ut(s)&&t&&Ut(t.y)&&s>=t.y,["".concat(Cg,"-top")]:Ut(s)&&t&&Ut(t.y)&&s<t.y})}function hF(e){var{allowEscapeViewBox:t,coordinate:n,key:s,offsetTopLeft:r,position:i,reverseDirection:o,tooltipDimension:l,viewBox:c,viewBoxDimension:u}=e;if(i&&Ut(i[s]))return i[s];var d=n[s]-l-(r>0?r:0),h=n[s]+r;if(t[s])return o[s]?d:h;var p=c[s];if(p==null)return 0;if(o[s]){var x=d,v=p;return x<v?Math.max(h,p):Math.max(d,p)}if(u==null)return 0;var j=h+l,y=p+u;return j>y?Math.max(d,p):Math.max(h,p)}function OTe(e){var{translateX:t,translateY:n,useTranslate3d:s}=e;return{transform:s?"translate3d(".concat(t,"px, ").concat(n,"px, 0)"):"translate(".concat(t,"px, ").concat(n,"px)")}}function MTe(e){var{allowEscapeViewBox:t,coordinate:n,offsetTopLeft:s,position:r,reverseDirection:i,tooltipBox:o,useTranslate3d:l,viewBox:c}=e,u,d,h;return o.height>0&&o.width>0&&n?(d=hF({allowEscapeViewBox:t,coordinate:n,key:"x",offsetTopLeft:s,position:r,reverseDirection:i,tooltipDimension:o.width,viewBox:c,viewBoxDimension:c.width}),h=hF({allowEscapeViewBox:t,coordinate:n,key:"y",offsetTopLeft:s,position:r,reverseDirection:i,tooltipDimension:o.height,viewBox:c,viewBoxDimension:c.height}),u=OTe({translateX:d,translateY:h,useTranslate3d:l})):u=PTe,{cssProperties:u,cssClasses:DTe({translateX:d,translateY:h,coordinate:n})}}function gF(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function ub(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?gF(Object(n),!0).forEach(function(s){jE(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gF(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function jE(e,t,n){return(t=ITe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ITe(e){var t=$Te(e,"string");return typeof t=="symbol"?t:t+""}function $Te(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class RTe extends f.PureComponent{constructor(){super(...arguments),jE(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),jE(this,"handleKeyDown",t=>{if(t.key==="Escape"){var n,s,r,i;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(n=(s=this.props.coordinate)===null||s===void 0?void 0:s.x)!==null&&n!==void 0?n:0,y:(r=(i=this.props.coordinate)===null||i===void 0?void 0:i.y)!==null&&r!==void 0?r:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var t,n;this.state.dismissed&&(((t=this.props.coordinate)===null||t===void 0?void 0:t.x)!==this.state.dismissedAtCoordinate.x||((n=this.props.coordinate)===null||n===void 0?void 0:n.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:t,allowEscapeViewBox:n,animationDuration:s,animationEasing:r,children:i,coordinate:o,hasPayload:l,isAnimationActive:c,offset:u,position:d,reverseDirection:h,useTranslate3d:p,viewBox:x,wrapperStyle:v,lastBoundingBox:j,innerRef:y,hasPortalFromProps:N}=this.props,{cssClasses:w,cssProperties:S}=MTe({allowEscapeViewBox:n,coordinate:o,offsetTopLeft:u,position:d,reverseDirection:h,tooltipBox:{height:j.height,width:j.width},useTranslate3d:p,viewBox:x}),_=N?{}:ub(ub({transition:c&&t?"transform ".concat(s,"ms ").concat(r):void 0},S),{},{pointerEvents:"none",visibility:!this.state.dismissed&&t&&l?"visible":"hidden",position:"absolute",top:0,left:0}),k=ub(ub({},_),{},{visibility:!this.state.dismissed&&t&&l?"visible":"hidden"},v);return f.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:w,style:k,ref:y},i)}}var RQ=()=>{var e;return(e=Bt(t=>t.rootProps.accessibilityLayer))!==null&&e!==void 0?e:!0};function NE(){return NE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},NE.apply(null,arguments)}function pF(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function xF(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?pF(Object(n),!0).forEach(function(s){zTe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pF(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function zTe(e,t,n){return(t=FTe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function FTe(e){var t=UTe(e,"string");return typeof t=="symbol"?t:t+""}function UTe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var yF={curveBasisClosed:Upe,curveBasisOpen:Bpe,curveBasis:Fpe,curveBumpX:YG,curveBumpY:QG,curveLinearClosed:Gpe,curveLinear:Dx,curveMonotoneX:Ok,curveMonotoneY:mW,curveNatural:hW,curveStep:gW,curveStepAfter:xW,curveStepBefore:pW},Nw=e=>xn(e.x)&&xn(e.y),bF=e=>e.base!=null&&Nw(e.base)&&Nw(e),Sg=e=>e.x,_g=e=>e.y,BTe=(e,t)=>{if(typeof e=="function")return e;var n="curve".concat(Xx(e));return(n==="curveMonotone"||n==="curveBump")&&t?yF["".concat(n).concat(t==="vertical"?"Y":"X")]:yF[n]||Dx},HTe=e=>{var{type:t="linear",points:n=[],baseLine:s,layout:r,connectNulls:i=!1}=e,o=BTe(t,r),l=i?n.filter(Nw):n,c;if(Array.isArray(s)){var u=n.map((x,v)=>xF(xF({},x),{},{base:s[v]}));r==="vertical"?c=Gg().y(_g).x1(Sg).x0(x=>x.base.x):c=Gg().x(Sg).y1(_g).y0(x=>x.base.y);var d=c.defined(bF).curve(o),h=i?u.filter(bF):u;return d(h)}r==="vertical"&&Ut(s)?c=Gg().y(_g).x1(Sg).x0(s):Ut(s)?c=Gg().x(Sg).y1(_g).y0(s):c=M4().x(Sg).y(_g);var p=c.defined(Nw).curve(o);return p(l)},BP=e=>{var{className:t,points:n,path:s,pathRef:r}=e,i=hh();if((!n||!n.length)&&!s)return null;var o={type:e.type,points:e.points,baseLine:e.baseLine,layout:e.layout||i,connectNulls:e.connectNulls},l=n&&n.length?HTe(o):s;return f.createElement("path",NE({},qr(e),SP(e),{className:$t("recharts-curve",t),d:l===null?void 0:l,ref:r}))},qTe=["x","y","top","left","width","height","className"];function CE(){return CE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},CE.apply(null,arguments)}function vF(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function GTe(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?vF(Object(n),!0).forEach(function(s){WTe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vF(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function WTe(e,t,n){return(t=VTe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function VTe(e){var t=YTe(e,"string");return typeof t=="symbol"?t:t+""}function YTe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function QTe(e,t){if(e==null)return{};var n,s,r=KTe(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)n=i[s],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function KTe(e,t){if(e==null)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;n[s]=e[s]}return n}var XTe=(e,t,n,s,r,i)=>"M".concat(e,",").concat(r,"v").concat(s,"M").concat(i,",").concat(t,"h").concat(n),ZTe=e=>{var{x:t=0,y:n=0,top:s=0,left:r=0,width:i=0,height:o=0,className:l}=e,c=QTe(e,qTe),u=GTe({x:t,y:n,top:s,left:r,width:i,height:o},c);return!Ut(t)||!Ut(n)||!Ut(i)||!Ut(o)||!Ut(s)||!Ut(r)?null:f.createElement("path",CE({},Ys(u),{className:$t("recharts-cross",l),d:XTe(t,n,i,o,s,r)}))};function JTe(e,t,n,s){var r=s/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-r:n.left+.5,y:e==="horizontal"?n.top+.5:t.y-r,width:e==="horizontal"?s:n.width-1,height:e==="horizontal"?n.height-1:s}}function wF(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function jF(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?wF(Object(n),!0).forEach(function(s){eke(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wF(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function eke(e,t,n){return(t=tke(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function tke(e){var t=ake(e,"string");return typeof t=="symbol"?t:t+""}function ake(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var nke=e=>e.replace(/([A-Z])/g,t=>"-".concat(t.toLowerCase())),zQ=(e,t,n)=>e.map(s=>"".concat(nke(s)," ").concat(t,"ms ").concat(n)).join(","),ske=(e,t)=>[Object.keys(e),Object.keys(t)].reduce((n,s)=>n.filter(r=>s.includes(r))),qp=(e,t)=>Object.keys(t).reduce((n,s)=>jF(jF({},n),{},{[s]:e(s,t[s])}),{});function NF(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function Xn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?NF(Object(n),!0).forEach(function(s){rke(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):NF(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function rke(e,t,n){return(t=ike(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ike(e){var t=oke(e,"string");return typeof t=="symbol"?t:t+""}function oke(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Cw=(e,t,n)=>e+(t-e)*n,SE=e=>{var{from:t,to:n}=e;return t!==n},FQ=(e,t,n)=>{var s=qp((r,i)=>{if(SE(i)){var[o,l]=e(i.from,i.to,i.velocity);return Xn(Xn({},i),{},{from:o,velocity:l})}return i},t);return n<1?qp((r,i)=>SE(i)&&s[r]!=null?Xn(Xn({},i),{},{velocity:Cw(i.velocity,s[r].velocity,n),from:Cw(i.from,s[r].from,n)}):i,t):FQ(e,s,n-1)};function lke(e,t,n,s,r,i){var o,l=s.reduce((p,x)=>Xn(Xn({},p),{},{[x]:{from:e[x],velocity:0,to:t[x]}}),{}),c=()=>qp((p,x)=>x.from,l),u=()=>!Object.values(l).filter(SE).length,d=null,h=p=>{o||(o=p);var x=p-o,v=x/n.dt;l=FQ(n,l,v),r(Xn(Xn(Xn({},e),t),c())),o=p,u()||(d=i.setTimeout(h))};return()=>(d=i.setTimeout(h),()=>{var p;(p=d)===null||p===void 0||p()})}function cke(e,t,n,s,r,i,o){var l=null,c=r.reduce((h,p)=>{var x=e[p],v=t[p];return x==null||v==null?h:Xn(Xn({},h),{},{[p]:[x,v]})},{}),u,d=h=>{u||(u=h);var p=(h-u)/s,x=qp((j,y)=>Cw(...y,n(p)),c);if(i(Xn(Xn(Xn({},e),t),x)),p<1)l=o.setTimeout(d);else{var v=qp((j,y)=>Cw(...y,n(1)),c);i(Xn(Xn(Xn({},e),t),v))}};return()=>(l=o.setTimeout(d),()=>{var h;(h=l)===null||h===void 0||h()})}const dke=(e,t,n,s,r,i)=>{var o=ske(e,t);return n==null?()=>(r(Xn(Xn({},e),t)),()=>{}):n.isStepper===!0?lke(e,t,n,o,r,i):cke(e,t,n,s,o,r,i)};var Sw=1e-4,UQ=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],BQ=(e,t)=>e.map((n,s)=>n*t**s).reduce((n,s)=>n+s),CF=(e,t)=>n=>{var s=UQ(e,t);return BQ(s,n)},uke=(e,t)=>n=>{var s=UQ(e,t),r=[...s.map((i,o)=>i*o).slice(1),0];return BQ(r,n)},mke=e=>{var t,n=e.split("(");if(n.length!==2||n[0]!=="cubic-bezier")return null;var s=(t=n[1])===null||t===void 0||(t=t.split(")")[0])===null||t===void 0?void 0:t.split(",");if(s==null||s.length!==4)return null;var r=s.map(i=>parseFloat(i));return[r[0],r[1],r[2],r[3]]},fke=function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];if(n.length===1)switch(n[0]){case"linear":return[0,0,1,1];case"ease":return[.25,.1,.25,1];case"ease-in":return[.42,0,1,1];case"ease-out":return[.42,0,.58,1];case"ease-in-out":return[0,0,.58,1];default:{var r=mke(n[0]);if(r)return r}}return n.length===4?n:[0,0,1,1]},hke=(e,t,n,s)=>{var r=CF(e,n),i=CF(t,s),o=uke(e,n),l=u=>u>1?1:u<0?0:u,c=u=>{for(var d=u>1?1:u,h=d,p=0;p<8;++p){var x=r(h)-d,v=o(h);if(Math.abs(x-d)<Sw||v<Sw)return i(h);h=l(h-x/v)}return i(h)};return c.isStepper=!1,c},SF=function(){return hke(...fke(...arguments))},gke=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:n=100,damping:s=8,dt:r=17}=t,i=(o,l,c)=>{var u=-(o-l)*n,d=c*s,h=c+(u-d)*r/1e3,p=c*r/1e3+o;return Math.abs(p-l)<Sw&&Math.abs(h)<Sw?[l,0]:[p,h]};return i.isStepper=!0,i.dt=r,i},pke=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return SF(e);case"spring":return gke();default:if(e.split("(")[0]==="cubic-bezier")return SF(e)}return typeof e=="function"?e:null};function xke(e){var t,n=()=>null,s=!1,r=null,i=o=>{if(!s){if(Array.isArray(o)){if(!o.length)return;var l=o,[c,...u]=l;if(typeof c=="number"){r=e.setTimeout(i.bind(null,u),c);return}i(c),r=e.setTimeout(i.bind(null,u));return}typeof o=="string"&&(t=o,n(t)),typeof o=="object"&&(t=o,n(t)),typeof o=="function"&&o()}};return{stop:()=>{s=!0},start:o=>{s=!1,r&&(r(),r=null),i(o)},subscribe:o=>(n=o,()=>{n=()=>null}),getTimeoutController:()=>e}}class yke{setTimeout(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=performance.now(),r=null,i=o=>{o-s>=n?t(o):typeof requestAnimationFrame=="function"&&(r=requestAnimationFrame(i))};return r=requestAnimationFrame(i),()=>{r!=null&&cancelAnimationFrame(r)}}}function bke(){return xke(new yke)}var vke=f.createContext(bke);function wke(e,t){var n=f.useContext(vke);return f.useMemo(()=>t??n(e),[e,t,n])}var jke=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),JN={isSsr:jke()},Nke={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},_F={t:0},H_={t:1};function r0(e){var t=Qn(e,Nke),{isActive:n,canBegin:s,duration:r,easing:i,begin:o,onAnimationEnd:l,onAnimationStart:c,children:u}=t,d=n==="auto"?!JN.isSsr:n,h=wke(t.animationId,t.animationManager),[p,x]=f.useState(d?_F:H_),v=f.useRef(null);return f.useEffect(()=>{d||x(H_)},[d]),f.useEffect(()=>{if(!d||!s)return Zx;var j=dke(_F,H_,pke(i),r,x,h.getTimeoutController()),y=()=>{v.current=j()};return h.start([c,o,y,r,l]),()=>{h.stop(),v.current&&v.current(),l()}},[d,s,r,i,o,c,l,h]),u(p.t)}function i0(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",n=f.useRef($p(t)),s=f.useRef(e);return s.current!==e&&(n.current=$p(t),s.current=e),n.current}var Cke=["radius"],Ske=["radius"],AF,TF,kF,EF,LF,PF,DF,OF,MF,IF;function $F(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function RF(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?$F(Object(n),!0).forEach(function(s){_ke(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$F(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function _ke(e,t,n){return(t=Ake(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ake(e){var t=Tke(e,"string");return typeof t=="symbol"?t:t+""}function Tke(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _w(){return _w=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},_w.apply(null,arguments)}function zF(e,t){if(e==null)return{};var n,s,r=kke(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)n=i[s],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function kke(e,t){if(e==null)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;n[s]=e[s]}return n}function ho(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var FF=(e,t,n,s,r)=>{var i=td(n),o=td(s),l=Math.min(Math.abs(i)/2,Math.abs(o)/2),c=o>=0?1:-1,u=i>=0?1:-1,d=o>=0&&i>=0||o<0&&i<0?1:0,h;if(l>0&&r instanceof Array){for(var p=[0,0,0,0],x=0,v=4;x<v;x++)p[x]=r[x]>l?l:r[x];h=Cn(AF||(AF=ho(["M",",",""])),e,t+c*p[0]),p[0]>0&&(h+=Cn(TF||(TF=ho(["A ",",",",0,0,",",",",",""])),p[0],p[0],d,e+u*p[0],t)),h+=Cn(kF||(kF=ho(["L ",",",""])),e+n-u*p[1],t),p[1]>0&&(h+=Cn(EF||(EF=ho(["A ",",",",0,0,",`,
        `,",",""])),p[1],p[1],d,e+n,t+c*p[1])),h+=Cn(LF||(LF=ho(["L ",",",""])),e+n,t+s-c*p[2]),p[2]>0&&(h+=Cn(PF||(PF=ho(["A ",",",",0,0,",`,
        `,",",""])),p[2],p[2],d,e+n-u*p[2],t+s)),h+=Cn(DF||(DF=ho(["L ",",",""])),e+u*p[3],t+s),p[3]>0&&(h+=Cn(OF||(OF=ho(["A ",",",",0,0,",`,
        `,",",""])),p[3],p[3],d,e,t+s-c*p[3])),h+="Z"}else if(l>0&&r===+r&&r>0){var j=Math.min(l,r);h=Cn(MF||(MF=ho(["M ",",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",","," Z"])),e,t+c*j,j,j,d,e+u*j,t,e+n-u*j,t,j,j,d,e+n,t+c*j,e+n,t+s-c*j,j,j,d,e+n-u*j,t+s,e+u*j,t+s,j,j,d,e,t+s-c*j)}else h=Cn(IF||(IF=ho(["M ",","," h "," v "," h "," Z"])),e,t,n,s,-n);return h},UF={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},HQ=e=>{var t=Qn(e,UF),n=f.useRef(null),[s,r]=f.useState(-1);f.useEffect(()=>{if(n.current&&n.current.getTotalLength)try{var Z=n.current.getTotalLength();Z&&r(Z)}catch{}},[]);var{x:i,y:o,width:l,height:c,radius:u,className:d}=t,{animationEasing:h,animationDuration:p,animationBegin:x,isAnimationActive:v,isUpdateAnimationActive:j}=t,y=f.useRef(l),N=f.useRef(c),w=f.useRef(i),S=f.useRef(o),_=f.useMemo(()=>({x:i,y:o,width:l,height:c,radius:u}),[i,o,l,c,u]),k=i0(_,"rectangle-");if(i!==+i||o!==+o||l!==+l||c!==+c||l===0||c===0)return null;var T=$t("recharts-rectangle",d);if(!j){var A=Ys(t),{radius:E}=A,M=zF(A,Cke);return f.createElement("path",_w({},M,{x:td(i),y:td(o),width:td(l),height:td(c),radius:typeof u=="number"?u:void 0,className:T,d:FF(i,o,l,c,u)}))}var z=y.current,P=N.current,D=w.current,U=S.current,B="0px ".concat(s===-1?1:s,"px"),R="".concat(s,"px 0px"),q=zQ(["strokeDasharray"],p,typeof h=="string"?h:UF.animationEasing);return f.createElement(r0,{animationId:k,key:k,canBegin:s>0,duration:p,easing:h,isActive:j,begin:x},Z=>{var V=dn(z,l,Z),oe=dn(P,c,Z),je=dn(D,i,Z),X=dn(U,o,Z);n.current&&(y.current=V,N.current=oe,w.current=je,S.current=X);var se;v?Z>0?se={transition:q,strokeDasharray:R}:se={strokeDasharray:B}:se={strokeDasharray:R};var ye=Ys(t),{radius:Ne}=ye,fe=zF(ye,Ske);return f.createElement("path",_w({},fe,{radius:typeof u=="number"?u:void 0,className:T,d:FF(je,X,V,oe,u),ref:n,style:RF(RF({},se),t.style)}))})};function BF(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function HF(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?BF(Object(n),!0).forEach(function(s){Eke(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):BF(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function Eke(e,t,n){return(t=Lke(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Lke(e){var t=Pke(e,"string");return typeof t=="symbol"?t:t+""}function Pke(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Aw=Math.PI/180,Dke=e=>e*180/Math.PI,qn=(e,t,n,s)=>({x:e+Math.cos(-Aw*s)*n,y:t+Math.sin(-Aw*s)*n}),qQ=function(t,n){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(s.left||0)-(s.right||0)),Math.abs(n-(s.top||0)-(s.bottom||0)))/2},Oke=(e,t)=>{var{x:n,y:s}=e,{x:r,y:i}=t;return Math.sqrt((n-r)**2+(s-i)**2)},Mke=(e,t)=>{var{x:n,y:s}=e,{cx:r,cy:i}=t,o=Oke({x:n,y:s},{x:r,y:i});if(o<=0)return{radius:o,angle:0};var l=(n-r)/o,c=Math.acos(l);return s>i&&(c=2*Math.PI-c),{radius:o,angle:Dke(c),angleInRadian:c}},Ike=e=>{var{startAngle:t,endAngle:n}=e,s=Math.floor(t/360),r=Math.floor(n/360),i=Math.min(s,r);return{startAngle:t-i*360,endAngle:n-i*360}},$ke=(e,t)=>{var{startAngle:n,endAngle:s}=t,r=Math.floor(n/360),i=Math.floor(s/360),o=Math.min(r,i);return e+o*360},Rke=(e,t)=>{var{chartX:n,chartY:s}=e,{radius:r,angle:i}=Mke({x:n,y:s},t),{innerRadius:o,outerRadius:l}=t;if(r<o||r>l||r===0)return null;var{startAngle:c,endAngle:u}=Ike(t),d=i,h;if(c<=u){for(;d>u;)d-=360;for(;d<c;)d+=360;h=d>=c&&d<=u}else{for(;d>c;)d-=360;for(;d<u;)d+=360;h=d>=u&&d<=c}return h?HF(HF({},t),{},{radius:r,angle:$ke(d,t)}):null};function GQ(e){var{cx:t,cy:n,radius:s,startAngle:r,endAngle:i}=e,o=qn(t,n,s,r),l=qn(t,n,s,i);return{points:[o,l],cx:t,cy:n,radius:s,startAngle:r,endAngle:i}}var qF,GF,WF,VF,YF,QF,KF;function _E(){return _E=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},_E.apply(null,arguments)}function pu(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var zke=(e,t)=>{var n=xs(t-e),s=Math.min(Math.abs(t-e),359.999);return n*s},mb=e=>{var{cx:t,cy:n,radius:s,angle:r,sign:i,isExternal:o,cornerRadius:l,cornerIsExternal:c}=e,u=l*(o?1:-1)+s,d=Math.asin(l/u)/Aw,h=c?r:r+i*d,p=qn(t,n,u,h),x=qn(t,n,s,h),v=c?r-i*d:r,j=qn(t,n,u*Math.cos(d*Aw),v);return{center:p,circleTangency:x,lineTangency:j,theta:d}},WQ=e=>{var{cx:t,cy:n,innerRadius:s,outerRadius:r,startAngle:i,endAngle:o}=e,l=zke(i,o),c=i+l,u=qn(t,n,r,i),d=qn(t,n,r,c),h=Cn(qF||(qF=pu(["M ",",",`
    A `,",",`,0,
    `,",",`,
    `,",",`
  `])),u.x,u.y,r,r,+(Math.abs(l)>180),+(i>c),d.x,d.y);if(s>0){var p=qn(t,n,s,i),x=qn(t,n,s,c);h+=Cn(GF||(GF=pu(["L ",",",`
            A `,",",`,0,
            `,",",`,
            `,","," Z"])),x.x,x.y,s,s,+(Math.abs(l)>180),+(i<=c),p.x,p.y)}else h+=Cn(WF||(WF=pu(["L ",","," Z"])),t,n);return h},Fke=e=>{var{cx:t,cy:n,innerRadius:s,outerRadius:r,cornerRadius:i,forceCornerRadius:o,cornerIsExternal:l,startAngle:c,endAngle:u}=e,d=xs(u-c),{circleTangency:h,lineTangency:p,theta:x}=mb({cx:t,cy:n,radius:r,angle:c,sign:d,cornerRadius:i,cornerIsExternal:l}),{circleTangency:v,lineTangency:j,theta:y}=mb({cx:t,cy:n,radius:r,angle:u,sign:-d,cornerRadius:i,cornerIsExternal:l}),N=l?Math.abs(c-u):Math.abs(c-u)-x-y;if(N<0)return o?Cn(VF||(VF=pu(["M ",",",`
        a`,",",",0,0,1,",`,0
        a`,",",",0,0,1,",`,0
      `])),p.x,p.y,i,i,i*2,i,i,-i*2):WQ({cx:t,cy:n,innerRadius:s,outerRadius:r,startAngle:c,endAngle:u});var w=Cn(YF||(YF=pu(["M ",",",`
    A`,",",",0,0,",",",",",`
    A`,",",",0,",",",",",",",`
    A`,",",",0,0,",",",",",`
  `])),p.x,p.y,i,i,+(d<0),h.x,h.y,r,r,+(N>180),+(d<0),v.x,v.y,i,i,+(d<0),j.x,j.y);if(s>0){var{circleTangency:S,lineTangency:_,theta:k}=mb({cx:t,cy:n,radius:s,angle:c,sign:d,isExternal:!0,cornerRadius:i,cornerIsExternal:l}),{circleTangency:T,lineTangency:A,theta:E}=mb({cx:t,cy:n,radius:s,angle:u,sign:-d,isExternal:!0,cornerRadius:i,cornerIsExternal:l}),M=l?Math.abs(c-u):Math.abs(c-u)-k-E;if(M<0&&i===0)return"".concat(w,"L").concat(t,",").concat(n,"Z");w+=Cn(QF||(QF=pu(["L",",",`
      A`,",",",0,0,",",",",",`
      A`,",",",0,",",",",",",",`
      A`,",",",0,0,",",",",","Z"])),A.x,A.y,i,i,+(d<0),T.x,T.y,s,s,+(M>180),+(d>0),S.x,S.y,i,i,+(d<0),_.x,_.y)}else w+=Cn(KF||(KF=pu(["L",",","Z"])),t,n);return w},Uke={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},VQ=e=>{var t=Qn(e,Uke),{cx:n,cy:s,innerRadius:r,outerRadius:i,cornerRadius:o,forceCornerRadius:l,cornerIsExternal:c,startAngle:u,endAngle:d,className:h}=t;if(i<r||u===d)return null;var p=$t("recharts-sector",h),x=i-r,v=Rs(o,x,0,!0),j;return v>0&&Math.abs(u-d)<360?j=Fke({cx:n,cy:s,innerRadius:r,outerRadius:i,cornerRadius:Math.min(v,x/2),forceCornerRadius:l,cornerIsExternal:c,startAngle:u,endAngle:d}):j=WQ({cx:n,cy:s,innerRadius:r,outerRadius:i,startAngle:u,endAngle:d}),f.createElement("path",_E({},Ys(t),{className:p,d:j}))};function Bke(e,t,n){if(e==="horizontal")return[{x:t.x,y:n.top},{x:t.x,y:n.top+n.height}];if(e==="vertical")return[{x:n.left,y:t.y},{x:n.left+n.width,y:t.y}];if(_Y(t)){if(e==="centric"){var{cx:s,cy:r,innerRadius:i,outerRadius:o,angle:l}=t,c=qn(s,r,i,l),u=qn(s,r,o,l);return[{x:c.x,y:c.y},{x:u.x,y:u.y}]}return GQ(t)}}var q_={},G_={},W_={},XF;function Hke(){return XF||(XF=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=$Y();function n(s){return t.isSymbol(s)?NaN:Number(s)}e.toNumber=n})(W_)),W_}var ZF;function qke(){return ZF||(ZF=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Hke();function n(s){return s?(s=t.toNumber(s),s===1/0||s===-1/0?(s<0?-1:1)*Number.MAX_VALUE:s===s?s:0):s===0?s:0}e.toFinite=n})(G_)),G_}var JF;function Gke(){return JF||(JF=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=RY(),n=qke();function s(r,i,o){o&&typeof o!="number"&&t.isIterateeCall(r,i,o)&&(i=o=void 0),r=n.toFinite(r),i===void 0?(i=r,r=0):i=n.toFinite(i),o=o===void 0?r<i?1:-1:n.toFinite(o);const l=Math.max(Math.ceil((i-r)/(o||1)),0),c=new Array(l);for(let u=0;u<l;u++)c[u]=r,r+=o;return c}e.range=s})(q_)),q_}var V_,eU;function Wke(){return eU||(eU=1,V_=Gke().range),V_}var Vke=Wke();const YQ=ao(Vke),Qg=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:a4,scaleDiverging:Qq,scaleDivergingLog:Kq,scaleDivergingPow:A4,scaleDivergingSqrt:xge,scaleDivergingSymlog:Xq,scaleIdentity:Lq,scaleImplicit:Nk,scaleLinear:Gj,scaleLog:kp,scaleOrdinal:Cp,scalePoint:cfe,scalePow:Wj,scaleQuantile:Mq,scaleQuantize:Iq,scaleRadial:Oq,scaleSequential:S4,scaleSequentialLog:Wq,scaleSequentialPow:_4,scaleSequentialQuantile:Yq,scaleSequentialSqrt:pge,scaleSequentialSymlog:Vq,scaleSqrt:Dq,scaleSymlog:f4,scaleThreshold:g4,scaleTime:C4,scaleUtc:Gq,tickFormat:Eq},Symbol.toStringTag,{value:"Module"}));var cc=e=>e.chartData,e1=ut([cc],e=>{var t=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),HP=(e,t,n,s)=>s?e1(e):cc(e),Yke=(e,t,n)=>n?e1(e):cc(e);function xd(e){if(Array.isArray(e)&&e.length===2){var[t,n]=e;if(xn(t)&&xn(n))return!0}return!1}function tU(e,t,n){return n?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function QQ(e,t){if(t&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[n,s]=e,r,i;if(xn(n))r=n;else if(typeof n=="function")return;if(xn(s))i=s;else if(typeof s=="function")return;var o=[r,i];if(xd(o))return o}}function Qke(e,t,n){if(!(!n&&t==null)){if(typeof e=="function"&&t!=null)try{var s=e(t,n);if(xd(s))return tU(s,t,n)}catch{}if(Array.isArray(e)&&e.length===2){var[r,i]=e,o,l;if(r==="auto")t!=null&&(o=Math.min(...t));else if(Ut(r))o=r;else if(typeof r=="function")try{t!=null&&(o=r(t?.[0]))}catch{}else if(typeof r=="string"&&Qz.test(r)){var c=Qz.exec(r);if(c==null||c[1]==null||t==null)o=void 0;else{var u=+c[1];o=t[0]-u}}else o=t?.[0];if(i==="auto")t!=null&&(l=Math.max(...t));else if(Ut(i))l=i;else if(typeof i=="function")try{t!=null&&(l=i(t?.[1]))}catch{}else if(typeof i=="string"&&Kz.test(i)){var d=Kz.exec(i);if(d==null||d[1]==null||t==null)l=void 0;else{var h=+d[1];l=t[1]+h}}else l=t?.[1];var p=[o,l];if(xd(p))return t==null?p:tU(p,t,n)}}}var gh=1e9,Kke={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},GP,un=!0,Ni="[DecimalError] ",Au=Ni+"Invalid argument: ",qP=Ni+"Exponent out of range: ",ph=Math.floor,su=Math.pow,Xke=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,$r,hs=1e7,sn=7,KQ=9007199254740991,Tw=ph(KQ/sn),Rt={};Rt.absoluteValue=Rt.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};Rt.comparedTo=Rt.cmp=function(e){var t,n,s,r,i=this;if(e=new i.constructor(e),i.s!==e.s)return i.s||-e.s;if(i.e!==e.e)return i.e>e.e^i.s<0?1:-1;for(s=i.d.length,r=e.d.length,t=0,n=s<r?s:r;t<n;++t)if(i.d[t]!==e.d[t])return i.d[t]>e.d[t]^i.s<0?1:-1;return s===r?0:s>r^i.s<0?1:-1};Rt.decimalPlaces=Rt.dp=function(){var e=this,t=e.d.length-1,n=(t-e.e)*sn;if(t=e.d[t],t)for(;t%10==0;t/=10)n--;return n<0?0:n};Rt.dividedBy=Rt.div=function(e){return Ml(this,new this.constructor(e))};Rt.dividedToIntegerBy=Rt.idiv=function(e){var t=this,n=t.constructor;return Va(Ml(t,new n(e),0,1),n.precision)};Rt.equals=Rt.eq=function(e){return!this.cmp(e)};Rt.exponent=function(){return Wn(this)};Rt.greaterThan=Rt.gt=function(e){return this.cmp(e)>0};Rt.greaterThanOrEqualTo=Rt.gte=function(e){return this.cmp(e)>=0};Rt.isInteger=Rt.isint=function(){return this.e>this.d.length-2};Rt.isNegative=Rt.isneg=function(){return this.s<0};Rt.isPositive=Rt.ispos=function(){return this.s>0};Rt.isZero=function(){return this.s===0};Rt.lessThan=Rt.lt=function(e){return this.cmp(e)<0};Rt.lessThanOrEqualTo=Rt.lte=function(e){return this.cmp(e)<1};Rt.logarithm=Rt.log=function(e){var t,n=this,s=n.constructor,r=s.precision,i=r+5;if(e===void 0)e=new s(10);else if(e=new s(e),e.s<1||e.eq($r))throw Error(Ni+"NaN");if(n.s<1)throw Error(Ni+(n.s?"NaN":"-Infinity"));return n.eq($r)?new s(0):(un=!1,t=Ml(Gp(n,i),Gp(e,i),i),un=!0,Va(t,r))};Rt.minus=Rt.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?JQ(t,e):XQ(t,(e.s=-e.s,e))};Rt.modulo=Rt.mod=function(e){var t,n=this,s=n.constructor,r=s.precision;if(e=new s(e),!e.s)throw Error(Ni+"NaN");return n.s?(un=!1,t=Ml(n,e,0,1).times(e),un=!0,n.minus(t)):Va(new s(n),r)};Rt.naturalExponential=Rt.exp=function(){return ZQ(this)};Rt.naturalLogarithm=Rt.ln=function(){return Gp(this)};Rt.negated=Rt.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};Rt.plus=Rt.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?XQ(t,e):JQ(t,(e.s=-e.s,e))};Rt.precision=Rt.sd=function(e){var t,n,s,r=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Au+e);if(t=Wn(r)+1,s=r.d.length-1,n=s*sn+1,s=r.d[s],s){for(;s%10==0;s/=10)n--;for(s=r.d[0];s>=10;s/=10)n++}return e&&t>n?t:n};Rt.squareRoot=Rt.sqrt=function(){var e,t,n,s,r,i,o,l=this,c=l.constructor;if(l.s<1){if(!l.s)return new c(0);throw Error(Ni+"NaN")}for(e=Wn(l),un=!1,r=Math.sqrt(+l),r==0||r==1/0?(t=Oo(l.d),(t.length+e)%2==0&&(t+="0"),r=Math.sqrt(t),e=ph((e+1)/2)-(e<0||e%2),r==1/0?t="5e"+e:(t=r.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),s=new c(t)):s=new c(r.toString()),n=c.precision,r=o=n+3;;)if(i=s,s=i.plus(Ml(l,i,o+2)).times(.5),Oo(i.d).slice(0,o)===(t=Oo(s.d)).slice(0,o)){if(t=t.slice(o-3,o+1),r==o&&t=="4999"){if(Va(i,n+1,0),i.times(i).eq(l)){s=i;break}}else if(t!="9999")break;o+=4}return un=!0,Va(s,n)};Rt.times=Rt.mul=function(e){var t,n,s,r,i,o,l,c,u,d=this,h=d.constructor,p=d.d,x=(e=new h(e)).d;if(!d.s||!e.s)return new h(0);for(e.s*=d.s,n=d.e+e.e,c=p.length,u=x.length,c<u&&(i=p,p=x,x=i,o=c,c=u,u=o),i=[],o=c+u,s=o;s--;)i.push(0);for(s=u;--s>=0;){for(t=0,r=c+s;r>s;)l=i[r]+x[s]*p[r-s-1]+t,i[r--]=l%hs|0,t=l/hs|0;i[r]=(i[r]+t)%hs|0}for(;!i[--o];)i.pop();return t?++n:i.shift(),e.d=i,e.e=n,un?Va(e,h.precision):e};Rt.toDecimalPlaces=Rt.todp=function(e,t){var n=this,s=n.constructor;return n=new s(n),e===void 0?n:(Go(e,0,gh),t===void 0?t=s.rounding:Go(t,0,8),Va(n,e+Wn(n)+1,t))};Rt.toExponential=function(e,t){var n,s=this,r=s.constructor;return e===void 0?n=qu(s,!0):(Go(e,0,gh),t===void 0?t=r.rounding:Go(t,0,8),s=Va(new r(s),e+1,t),n=qu(s,!0,e+1)),n};Rt.toFixed=function(e,t){var n,s,r=this,i=r.constructor;return e===void 0?qu(r):(Go(e,0,gh),t===void 0?t=i.rounding:Go(t,0,8),s=Va(new i(r),e+Wn(r)+1,t),n=qu(s.abs(),!1,e+Wn(s)+1),r.isneg()&&!r.isZero()?"-"+n:n)};Rt.toInteger=Rt.toint=function(){var e=this,t=e.constructor;return Va(new t(e),Wn(e)+1,t.rounding)};Rt.toNumber=function(){return+this};Rt.toPower=Rt.pow=function(e){var t,n,s,r,i,o,l=this,c=l.constructor,u=12,d=+(e=new c(e));if(!e.s)return new c($r);if(l=new c(l),!l.s){if(e.s<1)throw Error(Ni+"Infinity");return l}if(l.eq($r))return l;if(s=c.precision,e.eq($r))return Va(l,s);if(t=e.e,n=e.d.length-1,o=t>=n,i=l.s,o){if((n=d<0?-d:d)<=KQ){for(r=new c($r),t=Math.ceil(s/sn+4),un=!1;n%2&&(r=r.times(l),nU(r.d,t)),n=ph(n/2),n!==0;)l=l.times(l),nU(l.d,t);return un=!0,e.s<0?new c($r).div(r):Va(r,s)}}else if(i<0)throw Error(Ni+"NaN");return i=i<0&&e.d[Math.max(t,n)]&1?-1:1,l.s=1,un=!1,r=e.times(Gp(l,s+u)),un=!0,r=ZQ(r),r.s=i,r};Rt.toPrecision=function(e,t){var n,s,r=this,i=r.constructor;return e===void 0?(n=Wn(r),s=qu(r,n<=i.toExpNeg||n>=i.toExpPos)):(Go(e,1,gh),t===void 0?t=i.rounding:Go(t,0,8),r=Va(new i(r),e,t),n=Wn(r),s=qu(r,e<=n||n<=i.toExpNeg,e)),s};Rt.toSignificantDigits=Rt.tosd=function(e,t){var n=this,s=n.constructor;return e===void 0?(e=s.precision,t=s.rounding):(Go(e,1,gh),t===void 0?t=s.rounding:Go(t,0,8)),Va(new s(n),e,t)};Rt.toString=Rt.valueOf=Rt.val=Rt.toJSON=Rt[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Wn(e),n=e.constructor;return qu(e,t<=n.toExpNeg||t>=n.toExpPos)};function XQ(e,t){var n,s,r,i,o,l,c,u,d=e.constructor,h=d.precision;if(!e.s||!t.s)return t.s||(t=new d(e)),un?Va(t,h):t;if(c=e.d,u=t.d,o=e.e,r=t.e,c=c.slice(),i=o-r,i){for(i<0?(s=c,i=-i,l=u.length):(s=u,r=o,l=c.length),o=Math.ceil(h/sn),l=o>l?o+1:l+1,i>l&&(i=l,s.length=1),s.reverse();i--;)s.push(0);s.reverse()}for(l=c.length,i=u.length,l-i<0&&(i=l,s=u,u=c,c=s),n=0;i;)n=(c[--i]=c[i]+u[i]+n)/hs|0,c[i]%=hs;for(n&&(c.unshift(n),++r),l=c.length;c[--l]==0;)c.pop();return t.d=c,t.e=r,un?Va(t,h):t}function Go(e,t,n){if(e!==~~e||e<t||e>n)throw Error(Au+e)}function Oo(e){var t,n,s,r=e.length-1,i="",o=e[0];if(r>0){for(i+=o,t=1;t<r;t++)s=e[t]+"",n=sn-s.length,n&&(i+=Yc(n)),i+=s;o=e[t],s=o+"",n=sn-s.length,n&&(i+=Yc(n))}else if(o===0)return"0";for(;o%10===0;)o/=10;return i+o}var Ml=(function(){function e(s,r){var i,o=0,l=s.length;for(s=s.slice();l--;)i=s[l]*r+o,s[l]=i%hs|0,o=i/hs|0;return o&&s.unshift(o),s}function t(s,r,i,o){var l,c;if(i!=o)c=i>o?1:-1;else for(l=c=0;l<i;l++)if(s[l]!=r[l]){c=s[l]>r[l]?1:-1;break}return c}function n(s,r,i){for(var o=0;i--;)s[i]-=o,o=s[i]<r[i]?1:0,s[i]=o*hs+s[i]-r[i];for(;!s[0]&&s.length>1;)s.shift()}return function(s,r,i,o){var l,c,u,d,h,p,x,v,j,y,N,w,S,_,k,T,A,E,M=s.constructor,z=s.s==r.s?1:-1,P=s.d,D=r.d;if(!s.s)return new M(s);if(!r.s)throw Error(Ni+"Division by zero");for(c=s.e-r.e,A=D.length,k=P.length,x=new M(z),v=x.d=[],u=0;D[u]==(P[u]||0);)++u;if(D[u]>(P[u]||0)&&--c,i==null?w=i=M.precision:o?w=i+(Wn(s)-Wn(r))+1:w=i,w<0)return new M(0);if(w=w/sn+2|0,u=0,A==1)for(d=0,D=D[0],w++;(u<k||d)&&w--;u++)S=d*hs+(P[u]||0),v[u]=S/D|0,d=S%D|0;else{for(d=hs/(D[0]+1)|0,d>1&&(D=e(D,d),P=e(P,d),A=D.length,k=P.length),_=A,j=P.slice(0,A),y=j.length;y<A;)j[y++]=0;E=D.slice(),E.unshift(0),T=D[0],D[1]>=hs/2&&++T;do d=0,l=t(D,j,A,y),l<0?(N=j[0],A!=y&&(N=N*hs+(j[1]||0)),d=N/T|0,d>1?(d>=hs&&(d=hs-1),h=e(D,d),p=h.length,y=j.length,l=t(h,j,p,y),l==1&&(d--,n(h,A<p?E:D,p))):(d==0&&(l=d=1),h=D.slice()),p=h.length,p<y&&h.unshift(0),n(j,h,y),l==-1&&(y=j.length,l=t(D,j,A,y),l<1&&(d++,n(j,A<y?E:D,y))),y=j.length):l===0&&(d++,j=[0]),v[u++]=d,l&&j[0]?j[y++]=P[_]||0:(j=[P[_]],y=1);while((_++<k||j[0]!==void 0)&&w--)}return v[0]||v.shift(),x.e=c,Va(x,o?i+Wn(x)+1:i)}})();function ZQ(e,t){var n,s,r,i,o,l,c=0,u=0,d=e.constructor,h=d.precision;if(Wn(e)>16)throw Error(qP+Wn(e));if(!e.s)return new d($r);for(un=!1,l=h,o=new d(.03125);e.abs().gte(.1);)e=e.times(o),u+=5;for(s=Math.log(su(2,u))/Math.LN10*2+5|0,l+=s,n=r=i=new d($r),d.precision=l;;){if(r=Va(r.times(e),l),n=n.times(++c),o=i.plus(Ml(r,n,l)),Oo(o.d).slice(0,l)===Oo(i.d).slice(0,l)){for(;u--;)i=Va(i.times(i),l);return d.precision=h,t==null?(un=!0,Va(i,h)):i}i=o}}function Wn(e){for(var t=e.e*sn,n=e.d[0];n>=10;n/=10)t++;return t}function Y_(e,t,n){if(t>e.LN10.sd())throw un=!0,n&&(e.precision=n),Error(Ni+"LN10 precision limit exceeded");return Va(new e(e.LN10),t)}function Yc(e){for(var t="";e--;)t+="0";return t}function Gp(e,t){var n,s,r,i,o,l,c,u,d,h=1,p=10,x=e,v=x.d,j=x.constructor,y=j.precision;if(x.s<1)throw Error(Ni+(x.s?"NaN":"-Infinity"));if(x.eq($r))return new j(0);if(t==null?(un=!1,u=y):u=t,x.eq(10))return t==null&&(un=!0),Y_(j,u);if(u+=p,j.precision=u,n=Oo(v),s=n.charAt(0),i=Wn(x),Math.abs(i)<15e14){for(;s<7&&s!=1||s==1&&n.charAt(1)>3;)x=x.times(e),n=Oo(x.d),s=n.charAt(0),h++;i=Wn(x),s>1?(x=new j("0."+n),i++):x=new j(s+"."+n.slice(1))}else return c=Y_(j,u+2,y).times(i+""),x=Gp(new j(s+"."+n.slice(1)),u-p).plus(c),j.precision=y,t==null?(un=!0,Va(x,y)):x;for(l=o=x=Ml(x.minus($r),x.plus($r),u),d=Va(x.times(x),u),r=3;;){if(o=Va(o.times(d),u),c=l.plus(Ml(o,new j(r),u)),Oo(c.d).slice(0,u)===Oo(l.d).slice(0,u))return l=l.times(2),i!==0&&(l=l.plus(Y_(j,u+2,y).times(i+""))),l=Ml(l,new j(h),u),j.precision=y,t==null?(un=!0,Va(l,y)):l;l=c,r+=2}}function aU(e,t){var n,s,r;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(s=t.search(/e/i))>0?(n<0&&(n=s),n+=+t.slice(s+1),t=t.substring(0,s)):n<0&&(n=t.length),s=0;t.charCodeAt(s)===48;)++s;for(r=t.length;t.charCodeAt(r-1)===48;)--r;if(t=t.slice(s,r),t){if(r-=s,n=n-s-1,e.e=ph(n/sn),e.d=[],s=(n+1)%sn,n<0&&(s+=sn),s<r){for(s&&e.d.push(+t.slice(0,s)),r-=sn;s<r;)e.d.push(+t.slice(s,s+=sn));t=t.slice(s),s=sn-t.length}else s-=r;for(;s--;)t+="0";if(e.d.push(+t),un&&(e.e>Tw||e.e<-Tw))throw Error(qP+n)}else e.s=0,e.e=0,e.d=[0];return e}function Va(e,t,n){var s,r,i,o,l,c,u,d,h=e.d;for(o=1,i=h[0];i>=10;i/=10)o++;if(s=t-o,s<0)s+=sn,r=t,u=h[d=0];else{if(d=Math.ceil((s+1)/sn),i=h.length,d>=i)return e;for(u=i=h[d],o=1;i>=10;i/=10)o++;s%=sn,r=s-sn+o}if(n!==void 0&&(i=su(10,o-r-1),l=u/i%10|0,c=t<0||h[d+1]!==void 0||u%i,c=n<4?(l||c)&&(n==0||n==(e.s<0?3:2)):l>5||l==5&&(n==4||c||n==6&&(s>0?r>0?u/su(10,o-r):0:h[d-1])%10&1||n==(e.s<0?8:7))),t<1||!h[0])return c?(i=Wn(e),h.length=1,t=t-i-1,h[0]=su(10,(sn-t%sn)%sn),e.e=ph(-t/sn)||0):(h.length=1,h[0]=e.e=e.s=0),e;if(s==0?(h.length=d,i=1,d--):(h.length=d+1,i=su(10,sn-s),h[d]=r>0?(u/su(10,o-r)%su(10,r)|0)*i:0),c)for(;;)if(d==0){(h[0]+=i)==hs&&(h[0]=1,++e.e);break}else{if(h[d]+=i,h[d]!=hs)break;h[d--]=0,i=1}for(s=h.length;h[--s]===0;)h.pop();if(un&&(e.e>Tw||e.e<-Tw))throw Error(qP+Wn(e));return e}function JQ(e,t){var n,s,r,i,o,l,c,u,d,h,p=e.constructor,x=p.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new p(e),un?Va(t,x):t;if(c=e.d,h=t.d,s=t.e,u=e.e,c=c.slice(),o=u-s,o){for(d=o<0,d?(n=c,o=-o,l=h.length):(n=h,s=u,l=c.length),r=Math.max(Math.ceil(x/sn),l)+2,o>r&&(o=r,n.length=1),n.reverse(),r=o;r--;)n.push(0);n.reverse()}else{for(r=c.length,l=h.length,d=r<l,d&&(l=r),r=0;r<l;r++)if(c[r]!=h[r]){d=c[r]<h[r];break}o=0}for(d&&(n=c,c=h,h=n,t.s=-t.s),l=c.length,r=h.length-l;r>0;--r)c[l++]=0;for(r=h.length;r>o;){if(c[--r]<h[r]){for(i=r;i&&c[--i]===0;)c[i]=hs-1;--c[i],c[r]+=hs}c[r]-=h[r]}for(;c[--l]===0;)c.pop();for(;c[0]===0;c.shift())--s;return c[0]?(t.d=c,t.e=s,un?Va(t,x):t):new p(0)}function qu(e,t,n){var s,r=Wn(e),i=Oo(e.d),o=i.length;return t?(n&&(s=n-o)>0?i=i.charAt(0)+"."+i.slice(1)+Yc(s):o>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(r<0?"e":"e+")+r):r<0?(i="0."+Yc(-r-1)+i,n&&(s=n-o)>0&&(i+=Yc(s))):r>=o?(i+=Yc(r+1-o),n&&(s=n-r-1)>0&&(i=i+"."+Yc(s))):((s=r+1)<o&&(i=i.slice(0,s)+"."+i.slice(s)),n&&(s=n-o)>0&&(r+1===o&&(i+="."),i+=Yc(s))),e.s<0?"-"+i:i}function nU(e,t){if(e.length>t)return e.length=t,!0}function eK(e){var t,n,s;function r(i){var o=this;if(!(o instanceof r))return new r(i);if(o.constructor=r,i instanceof r){o.s=i.s,o.e=i.e,o.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(Au+i);if(i>0)o.s=1;else if(i<0)i=-i,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(i===~~i&&i<1e7){o.e=0,o.d=[i];return}return aU(o,i.toString())}else if(typeof i!="string")throw Error(Au+i);if(i.charCodeAt(0)===45?(i=i.slice(1),o.s=-1):o.s=1,Xke.test(i))aU(o,i);else throw Error(Au+i)}if(r.prototype=Rt,r.ROUND_UP=0,r.ROUND_DOWN=1,r.ROUND_CEIL=2,r.ROUND_FLOOR=3,r.ROUND_HALF_UP=4,r.ROUND_HALF_DOWN=5,r.ROUND_HALF_EVEN=6,r.ROUND_HALF_CEIL=7,r.ROUND_HALF_FLOOR=8,r.clone=eK,r.config=r.set=Zke,e===void 0&&(e={}),e)for(s=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<s.length;)e.hasOwnProperty(n=s[t++])||(e[n]=this[n]);return r.config(e),r}function Zke(e){if(!e||typeof e!="object")throw Error(Ni+"Object expected");var t,n,s,r=["precision",1,gh,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<r.length;t+=3)if((s=e[n=r[t]])!==void 0)if(ph(s)===s&&s>=r[t+1]&&s<=r[t+2])this[n]=s;else throw Error(Au+n+": "+s);if((s=e[n="LN10"])!==void 0)if(s==Math.LN10)this[n]=new this(s);else throw Error(Au+n+": "+s);return this}var GP=eK(Kke);$r=new GP(1);const Ra=GP;var Jke=e=>e,tK={},aK=e=>e===tK,sU=e=>function t(){return arguments.length===0||arguments.length===1&&aK(arguments.length<=0?void 0:arguments[0])?t:e(...arguments)},nK=(e,t)=>e===1?t:sU(function(){for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];var i=s.filter(o=>o!==tK).length;return i>=e?t(...s):nK(e-i,sU(function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];var u=s.map(d=>aK(d)?l.shift():d);return t(...u,...l)}))}),eEe=e=>nK(e.length,e),AE=(e,t)=>{for(var n=[],s=e;s<t;++s)n[s-e]=s;return n},tEe=eEe((e,t)=>Array.isArray(t)?t.map(e):Object.keys(t).map(n=>t[n]).map(e)),aEe=function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];if(!n.length)return Jke;var r=n.reverse(),i=r[0],o=r.slice(1);return function(){return o.reduce((l,c)=>c(l),i(...arguments))}};function sK(e){var t;return e===0?t=1:t=Math.floor(new Ra(e).abs().log(10).toNumber())+1,t}function rK(e,t,n){for(var s=new Ra(e),r=0,i=[];s.lt(t)&&r<1e5;)i.push(s.toNumber()),s=s.add(n),r++;return i}var iK=e=>{var[t,n]=e,[s,r]=[t,n];return t>n&&([s,r]=[n,t]),[s,r]},oK=(e,t,n)=>{if(e.lte(0))return new Ra(0);var s=sK(e.toNumber()),r=new Ra(10).pow(s),i=e.div(r),o=s!==1?.05:.1,l=new Ra(Math.ceil(i.div(o).toNumber())).add(n).mul(o),c=l.mul(r);return t?new Ra(c.toNumber()):new Ra(Math.ceil(c.toNumber()))},nEe=(e,t,n)=>{var s=new Ra(1),r=new Ra(e);if(!r.isint()&&n){var i=Math.abs(e);i<1?(s=new Ra(10).pow(sK(e)-1),r=new Ra(Math.floor(r.div(s).toNumber())).mul(s)):i>1&&(r=new Ra(Math.floor(e)))}else e===0?r=new Ra(Math.floor((t-1)/2)):n||(r=new Ra(Math.floor(e)));var o=Math.floor((t-1)/2),l=aEe(tEe(c=>r.add(new Ra(c-o).mul(s)).toNumber()),AE);return l(0,t)},lK=function(t,n,s,r){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((n-t)/(s-1)))return{step:new Ra(0),tickMin:new Ra(0),tickMax:new Ra(0)};var o=oK(new Ra(n).sub(t).div(s-1),r,i),l;t<=0&&n>=0?l=new Ra(0):(l=new Ra(t).add(n).div(2),l=l.sub(new Ra(l).mod(o)));var c=Math.ceil(l.sub(t).div(o).toNumber()),u=Math.ceil(new Ra(n).sub(l).div(o).toNumber()),d=c+u+1;return d>s?lK(t,n,s,r,i+1):(d<s&&(u=n>0?u+(s-d):u,c=n>0?c:c+(s-d)),{step:o,tickMin:l.sub(new Ra(c).mul(o)),tickMax:l.add(new Ra(u).mul(o))})},sEe=function(t){var[n,s]=t,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=Math.max(r,2),[l,c]=iK([n,s]);if(l===-1/0||c===1/0){var u=c===1/0?[l,...AE(0,r-1).map(()=>1/0)]:[...AE(0,r-1).map(()=>-1/0),c];return n>s?u.reverse():u}if(l===c)return nEe(l,r,i);var{step:d,tickMin:h,tickMax:p}=lK(l,c,o,i,0),x=rK(h,p.add(new Ra(.1).mul(d)),d);return n>s?x.reverse():x},rEe=function(t,n){var[s,r]=t,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[o,l]=iK([s,r]);if(o===-1/0||l===1/0)return[s,r];if(o===l)return[o];var c=Math.max(n,2),u=oK(new Ra(l).sub(o).div(c-1),i,0),d=[...rK(new Ra(o),new Ra(l),u),l];return i===!1&&(d=d.map(h=>Math.round(h))),s>r?d.reverse():d},cK=e=>e.rootProps.maxBarSize,iEe=e=>e.rootProps.barGap,dK=e=>e.rootProps.barCategoryGap,oEe=e=>e.rootProps.barSize,o0=e=>e.rootProps.stackOffset,uK=e=>e.rootProps.reverseStackOrder,WP=e=>e.options.chartName,VP=e=>e.rootProps.syncId,mK=e=>e.rootProps.syncMethod,YP=e=>e.options.eventEmitter,Gn={grid:-100,barBackground:-50,area:100,cursorRectangle:200,bar:300,line:400,axis:500,scatter:600,activeBar:1e3,cursorLine:1100,activeDot:1200,label:2e3},Tl={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},Mr={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},t1=(e,t)=>{if(!(!e||!t))return e!=null&&e.reversed?[t[1],t[0]]:t},lEe={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:Tl.angleAxisId,includeHidden:!1,name:void 0,reversed:Tl.reversed,scale:Tl.scale,tick:Tl.tick,tickCount:void 0,ticks:void 0,type:Tl.type,unit:void 0},cEe={allowDataOverflow:Mr.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:Mr.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Mr.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Mr.scale,tick:Mr.tick,tickCount:Mr.tickCount,ticks:void 0,type:Mr.type,unit:void 0},dEe={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:Tl.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Tl.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Tl.scale,tick:Tl.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},uEe={allowDataOverflow:Mr.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:Mr.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Mr.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Mr.scale,tick:Mr.tick,tickCount:Mr.tickCount,ticks:void 0,type:"category",unit:void 0},QP=(e,t)=>e.polarAxis.angleAxis[t]!=null?e.polarAxis.angleAxis[t]:e.layout.layoutType==="radial"?dEe:lEe,KP=(e,t)=>e.polarAxis.radiusAxis[t]!=null?e.polarAxis.radiusAxis[t]:e.layout.layoutType==="radial"?uEe:cEe,a1=e=>e.polarOptions,XP=ut([oc,lc,ls],qQ),fK=ut([a1,XP],(e,t)=>{if(e!=null)return Rs(e.innerRadius,t,0)}),hK=ut([a1,XP],(e,t)=>{if(e!=null)return Rs(e.outerRadius,t,t*.8)}),mEe=e=>{if(e==null)return[0,0];var{startAngle:t,endAngle:n}=e;return[t,n]},gK=ut([a1],mEe);ut([QP,gK],t1);var pK=ut([XP,fK,hK],(e,t,n)=>{if(!(e==null||t==null||n==null))return[t,n]});ut([KP,pK],t1);var xK=ut([ja,a1,fK,hK,oc,lc],(e,t,n,s,r,i)=>{if(!(e!=="centric"&&e!=="radial"||t==null||n==null||s==null)){var{cx:o,cy:l,startAngle:c,endAngle:u}=t;return{cx:Rs(o,r,r/2),cy:Rs(l,i,i/2),innerRadius:n,outerRadius:s,startAngle:c,endAngle:u,clockWise:!1}}}),pn=(e,t)=>t,l0=(e,t,n)=>n;function ZP(e){return e?.id}function yK(e,t,n){var{chartData:s=[]}=t,{allowDuplicatedCategory:r,dataKey:i}=n,o=new Map;return e.forEach(l=>{var c,u=(c=l.data)!==null&&c!==void 0?c:s;if(!(u==null||u.length===0)){var d=ZP(l);u.forEach((h,p)=>{var x=i==null||r?p:String(qa(h,i,null)),v=qa(h,l.dataKey,0),j;o.has(x)?j=o.get(x):j={},Object.assign(j,{[d]:v}),o.set(x,j)})}}),Array.from(o.values())}function n1(e){return"stackId"in e&&e.stackId!=null&&e.dataKey!=null}var s1=(e,t)=>e===t?!0:e==null||t==null?!1:e[0]===t[0]&&e[1]===t[1];function r1(e,t){return Array.isArray(e)&&Array.isArray(t)&&e.length===0&&t.length===0?!0:e===t}function fEe(e,t){if(e.length===t.length){for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}return!1}var cs=e=>{var t=ja(e);return t==="horizontal"?"xAxis":t==="vertical"?"yAxis":t==="centric"?"angleAxis":"radiusAxis"},xh=e=>e.tooltip.settings.axisId;function rU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function kw(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?rU(Object(n),!0).forEach(function(s){hEe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rU(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function hEe(e,t,n){return(t=gEe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function gEe(e){var t=pEe(e,"string");return typeof t=="symbol"?t:t+""}function pEe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var TE=[0,"auto"],ms={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},bK=(e,t)=>e.cartesianAxis.xAxis[t],dc=(e,t)=>{var n=bK(e,t);return n??ms},fs={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:TE,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:n0},vK=(e,t)=>e.cartesianAxis.yAxis[t],uc=(e,t)=>{var n=vK(e,t);return n??fs},xEe={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},JP=(e,t)=>{var n=e.cartesianAxis.zAxis[t];return n??xEe},bn=(e,t,n)=>{switch(t){case"xAxis":return dc(e,n);case"yAxis":return uc(e,n);case"zAxis":return JP(e,n);case"angleAxis":return QP(e,n);case"radiusAxis":return KP(e,n);default:throw new Error("Unexpected axis type: ".concat(t))}},yEe=(e,t,n)=>{switch(t){case"xAxis":return dc(e,n);case"yAxis":return uc(e,n);default:throw new Error("Unexpected axis type: ".concat(t))}},c0=(e,t,n)=>{switch(t){case"xAxis":return dc(e,n);case"yAxis":return uc(e,n);case"angleAxis":return QP(e,n);case"radiusAxis":return KP(e,n);default:throw new Error("Unexpected axis type: ".concat(t))}},wK=e=>e.graphicalItems.cartesianItems.some(t=>t.type==="bar")||e.graphicalItems.polarItems.some(t=>t.type==="radialBar");function eD(e,t){return n=>{switch(e){case"xAxis":return"xAxisId"in n&&n.xAxisId===t;case"yAxis":return"yAxisId"in n&&n.yAxisId===t;case"zAxis":return"zAxisId"in n&&n.zAxisId===t;case"angleAxis":return"angleAxisId"in n&&n.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in n&&n.radiusAxisId===t;default:return!1}}}var i1=e=>e.graphicalItems.cartesianItems,bEe=ut([pn,l0],eD),tD=(e,t,n)=>e.filter(n).filter(s=>t?.includeHidden===!0?!0:!s.hide),d0=ut([i1,bn,bEe],tD,{memoizeOptions:{resultEqualityCheck:r1}}),jK=ut([d0],e=>e.filter(t=>t.type==="area"||t.type==="bar").filter(n1)),NK=e=>e.filter(t=>!("stackId"in t)||t.stackId===void 0),vEe=ut([d0],NK),aD=e=>e.map(t=>t.data).filter(Boolean).flat(1),wEe=ut([d0],aD,{memoizeOptions:{resultEqualityCheck:r1}}),nD=(e,t)=>{var{chartData:n=[],dataStartIndex:s,dataEndIndex:r}=t;return e.length>0?e:n.slice(s,r+1)},sD=ut([wEe,HP],nD),rD=(e,t,n)=>t?.dataKey!=null?e.map(s=>({value:qa(s,t.dataKey)})):n.length>0?n.map(s=>s.dataKey).flatMap(s=>e.map(r=>({value:qa(r,s)}))):e.map(s=>({value:s})),o1=ut([sD,bn,d0],rD);function CK(e,t){switch(e){case"xAxis":return t.direction==="x";case"yAxis":return t.direction==="y";default:return!1}}function bv(e){if(Ho(e)||e instanceof Date){var t=Number(e);if(xn(t))return t}}function iU(e){if(Array.isArray(e)){var t=[bv(e[0]),bv(e[1])];return xd(t)?t:void 0}var n=bv(e);if(n!=null)return[n,n]}function Xl(e){return e.map(bv).filter(n2e)}function jEe(e,t,n){return!n||typeof t!="number"||eo(t)?[]:n.length?Xl(n.flatMap(s=>{var r=qa(e,s.dataKey),i,o;if(Array.isArray(r)?[i,o]=r:i=o=r,!(!xn(i)||!xn(o)))return[t-i,t+o]})):[]}var ds=e=>{var t=cs(e),n=xh(e);return c0(e,t,n)},u0=ut([ds],e=>e?.dataKey),NEe=ut([jK,HP,ds],yK),SK=(e,t,n,s)=>{var r={},i=t.reduce((o,l)=>{if(l.stackId==null)return o;var c=o[l.stackId];return c==null&&(c=[]),c.push(l),o[l.stackId]=c,o},r);return Object.fromEntries(Object.entries(i).map(o=>{var[l,c]=o,u=s?[...c].reverse():c,d=u.map(ZP);return[l,{stackedData:gAe(e,d,n),graphicalItems:u}]}))},kE=ut([NEe,jK,o0,uK],SK),_K=(e,t,n,s)=>{var{dataStartIndex:r,dataEndIndex:i}=t;if(s==null&&n!=="zAxis"){var o=vAe(e,r,i);if(!(o!=null&&o[0]===0&&o[1]===0))return o}},CEe=ut([bn],e=>e.allowDataOverflow),iD=e=>{var t;if(e==null||!("domain"in e))return TE;if(e.domain!=null)return e.domain;if("ticks"in e&&e.ticks!=null){if(e.type==="number"){var n=Xl(e.ticks);return[Math.min(...n),Math.max(...n)]}if(e.type==="category")return e.ticks.map(String)}return(t=e?.domain)!==null&&t!==void 0?t:TE},oD=ut([bn],iD),lD=ut([oD,CEe],QQ),SEe=ut([kE,cc,pn,lD],_K,{memoizeOptions:{resultEqualityCheck:s1}}),l1=e=>e.errorBars,_Ee=(e,t,n)=>e.flatMap(s=>t[s.id]).filter(Boolean).filter(s=>CK(n,s)),Ew=function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];var r=n.filter(Boolean);if(r.length!==0){var i=r.flat(),o=Math.min(...i),l=Math.max(...i);return[o,l]}},cD=(e,t,n,s,r)=>{var i,o;if(n.length>0&&e.forEach(l=>{n.forEach(c=>{var u,d,h=(u=s[c.id])===null||u===void 0?void 0:u.filter(N=>CK(r,N)),p=qa(l,(d=t.dataKey)!==null&&d!==void 0?d:c.dataKey),x=jEe(l,p,h);if(x.length>=2){var v=Math.min(...x),j=Math.max(...x);(i==null||v<i)&&(i=v),(o==null||j>o)&&(o=j)}var y=iU(p);y!=null&&(i=i==null?y[0]:Math.min(i,y[0]),o=o==null?y[1]:Math.max(o,y[1]))})}),t?.dataKey!=null&&e.forEach(l=>{var c=iU(qa(l,t.dataKey));c!=null&&(i=i==null?c[0]:Math.min(i,c[0]),o=o==null?c[1]:Math.max(o,c[1]))}),xn(i)&&xn(o))return[i,o]},AEe=ut([sD,bn,vEe,l1,pn],cD,{memoizeOptions:{resultEqualityCheck:s1}});function TEe(e){var{value:t}=e;if(Ho(t)||t instanceof Date)return t}var kEe=(e,t,n)=>{var s=e.map(TEe).filter(r=>r!=null);return n&&(t.dataKey==null||t.allowDuplicatedCategory&&NY(s))?YQ(0,e.length):t.allowDuplicatedCategory?s:Array.from(new Set(s))},AK=e=>e.referenceElements.dots,yh=(e,t,n)=>e.filter(s=>s.ifOverflow==="extendDomain").filter(s=>t==="xAxis"?s.xAxisId===n:s.yAxisId===n),EEe=ut([AK,pn,l0],yh),TK=e=>e.referenceElements.areas,LEe=ut([TK,pn,l0],yh),kK=e=>e.referenceElements.lines,PEe=ut([kK,pn,l0],yh),EK=(e,t)=>{if(e!=null){var n=Xl(e.map(s=>t==="xAxis"?s.x:s.y));if(n.length!==0)return[Math.min(...n),Math.max(...n)]}},DEe=ut(EEe,pn,EK),LK=(e,t)=>{if(e!=null){var n=Xl(e.flatMap(s=>[t==="xAxis"?s.x1:s.y1,t==="xAxis"?s.x2:s.y2]));if(n.length!==0)return[Math.min(...n),Math.max(...n)]}},OEe=ut([LEe,pn],LK);function MEe(e){var t;if(e.x!=null)return Xl([e.x]);var n=(t=e.segment)===null||t===void 0?void 0:t.map(s=>s.x);return n==null||n.length===0?[]:Xl(n)}function IEe(e){var t;if(e.y!=null)return Xl([e.y]);var n=(t=e.segment)===null||t===void 0?void 0:t.map(s=>s.y);return n==null||n.length===0?[]:Xl(n)}var PK=(e,t)=>{if(e!=null){var n=e.flatMap(s=>t==="xAxis"?MEe(s):IEe(s));if(n.length!==0)return[Math.min(...n),Math.max(...n)]}},$Ee=ut([PEe,pn],PK),REe=ut(DEe,$Ee,OEe,(e,t,n)=>Ew(e,n,t)),dD=(e,t,n,s,r,i,o,l)=>{if(n!=null)return n;var c=o==="vertical"&&l==="xAxis"||o==="horizontal"&&l==="yAxis",u=c?Ew(s,i,r):Ew(i,r);return Qke(t,u,e.allowDataOverflow)},zEe=ut([bn,oD,lD,SEe,AEe,REe,ja,pn],dD,{memoizeOptions:{resultEqualityCheck:s1}}),FEe=[0,1],uD=(e,t,n,s,r,i,o)=>{if(!((e==null||n==null||n.length===0)&&o===void 0)){var{dataKey:l,type:c}=e,u=Pd(t,i);if(u&&l==null){var d;return YQ(0,(d=n?.length)!==null&&d!==void 0?d:0)}return c==="category"?kEe(s,e,u):r==="expand"?FEe:o}},mD=ut([bn,ja,sD,o1,o0,pn,zEe],uD),DK=(e,t,n,s,r)=>{if(e!=null){var{scale:i,type:o}=e;if(i==="auto")return t==="radial"&&r==="radiusAxis"?"band":t==="radial"&&r==="angleAxis"?"linear":o==="category"&&s&&(s.indexOf("LineChart")>=0||s.indexOf("AreaChart")>=0||s.indexOf("ComposedChart")>=0&&!n)?"point":o==="category"?"band":"linear";if(typeof i=="string"){var l="scale".concat(Xx(i));return l in Qg?l:"point"}}},bh=ut([bn,ja,wK,WP,pn],DK);function UEe(e){if(e!=null){if(e in Qg)return Qg[e]();var t="scale".concat(Xx(e));if(t in Qg)return Qg[t]()}}function fD(e,t,n,s){if(!(n==null||s==null)){if(typeof e.scale=="function")return e.scale.copy().domain(n).range(s);var r=UEe(t);if(r!=null){var i=r.domain(n).range(s);return dAe(i),i}}}var hD=(e,t,n)=>{var s=iD(t);if(!(n!=="auto"&&n!=="linear")){if(t!=null&&t.tickCount&&Array.isArray(s)&&(s[0]==="auto"||s[1]==="auto")&&xd(e))return sEe(e,t.tickCount,t.allowDecimals);if(t!=null&&t.tickCount&&t.type==="number"&&xd(e))return rEe(e,t.tickCount,t.allowDecimals)}},gD=ut([mD,c0,bh],hD),pD=(e,t,n,s)=>{if(s!=="angleAxis"&&e?.type==="number"&&xd(t)&&Array.isArray(n)&&n.length>0){var r=t[0],i=n[0],o=t[1],l=n[n.length-1];return[Math.min(r,i),Math.max(o,l)]}return t},BEe=ut([bn,mD,gD,pn],pD),HEe=ut(o1,bn,(e,t)=>{if(!(!t||t.type!=="number")){var n=1/0,s=Array.from(Xl(e.map(h=>h.value))).sort((h,p)=>h-p),r=s[0],i=s[s.length-1];if(r==null||i==null)return 1/0;var o=i-r;if(o===0)return 1/0;for(var l=0;l<s.length-1;l++){var c=s[l],u=s[l+1];if(!(c==null||u==null)){var d=u-c;n=Math.min(n,d)}}return n/o}}),OK=ut(HEe,ja,dK,ls,(e,t,n,s,r)=>r,(e,t,n,s,r)=>{if(!xn(e))return 0;var i=t==="vertical"?s.height:s.width;if(r==="gap")return e*i/2;if(r==="no-gap"){var o=Rs(n,e*i),l=e*i/2;return l-o-(l-o)/i*o}return 0}),qEe=(e,t,n)=>{var s=dc(e,t);return s==null||typeof s.padding!="string"?0:OK(e,"xAxis",t,n,s.padding)},GEe=(e,t,n)=>{var s=uc(e,t);return s==null||typeof s.padding!="string"?0:OK(e,"yAxis",t,n,s.padding)},WEe=ut(dc,qEe,(e,t)=>{var n,s;if(e==null)return{left:0,right:0};var{padding:r}=e;return typeof r=="string"?{left:t,right:t}:{left:((n=r.left)!==null&&n!==void 0?n:0)+t,right:((s=r.right)!==null&&s!==void 0?s:0)+t}}),VEe=ut(uc,GEe,(e,t)=>{var n,s;if(e==null)return{top:0,bottom:0};var{padding:r}=e;return typeof r=="string"?{top:t,bottom:t}:{top:((n=r.top)!==null&&n!==void 0?n:0)+t,bottom:((s=r.bottom)!==null&&s!==void 0?s:0)+t}}),YEe=ut([ls,WEe,VN,WN,(e,t,n)=>n],(e,t,n,s,r)=>{var{padding:i}=s;return r?[i.left,n.width-i.right]:[e.left+t.left,e.left+e.width-t.right]}),QEe=ut([ls,ja,VEe,VN,WN,(e,t,n)=>n],(e,t,n,s,r,i)=>{var{padding:o}=r;return i?[s.height-o.bottom,o.top]:t==="horizontal"?[e.top+e.height-n.bottom,e.top+n.top]:[e.top+n.top,e.top+e.height-n.bottom]}),m0=(e,t,n,s)=>{var r;switch(t){case"xAxis":return YEe(e,n,s);case"yAxis":return QEe(e,n,s);case"zAxis":return(r=JP(e,n))===null||r===void 0?void 0:r.range;case"angleAxis":return gK(e);case"radiusAxis":return pK(e,n);default:return}},MK=ut([bn,m0],t1),c1=ut([bn,bh,BEe,MK],fD);ut([d0,l1,pn],_Ee);function IK(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var d1=(e,t)=>t,u1=(e,t,n)=>n,KEe=ut(qN,d1,u1,(e,t,n)=>e.filter(s=>s.orientation===t).filter(s=>s.mirror===n).sort(IK)),XEe=ut(GN,d1,u1,(e,t,n)=>e.filter(s=>s.orientation===t).filter(s=>s.mirror===n).sort(IK)),$K=(e,t)=>({width:e.width,height:t.height}),ZEe=(e,t)=>{var n=typeof t.width=="number"?t.width:n0;return{width:n,height:e.height}},RK=ut(ls,dc,$K),JEe=(e,t,n)=>{switch(t){case"top":return e.top;case"bottom":return n-e.bottom;default:return 0}},eLe=(e,t,n)=>{switch(t){case"left":return e.left;case"right":return n-e.right;default:return 0}},tLe=ut(lc,ls,KEe,d1,u1,(e,t,n,s,r)=>{var i={},o;return n.forEach(l=>{var c=$K(t,l);o==null&&(o=JEe(t,s,e));var u=s==="top"&&!r||s==="bottom"&&r;i[l.id]=o-Number(u)*c.height,o+=(u?-1:1)*c.height}),i}),aLe=ut(oc,ls,XEe,d1,u1,(e,t,n,s,r)=>{var i={},o;return n.forEach(l=>{var c=ZEe(t,l);o==null&&(o=eLe(t,s,e));var u=s==="left"&&!r||s==="right"&&r;i[l.id]=o-Number(u)*c.width,o+=(u?-1:1)*c.width}),i}),nLe=(e,t)=>{var n=dc(e,t);if(n!=null)return tLe(e,n.orientation,n.mirror)},sLe=ut([ls,dc,nLe,(e,t)=>t],(e,t,n,s)=>{if(t!=null){var r=n?.[s];return r==null?{x:e.left,y:0}:{x:e.left,y:r}}}),rLe=(e,t)=>{var n=uc(e,t);if(n!=null)return aLe(e,n.orientation,n.mirror)},iLe=ut([ls,uc,rLe,(e,t)=>t],(e,t,n,s)=>{if(t!=null){var r=n?.[s];return r==null?{x:0,y:e.top}:{x:r,y:e.top}}}),zK=ut(ls,uc,(e,t)=>{var n=typeof t.width=="number"?t.width:n0;return{width:n,height:e.height}}),oU=(e,t,n)=>{switch(t){case"xAxis":return RK(e,n).width;case"yAxis":return zK(e,n).height;default:return}},FK=(e,t,n,s)=>{if(n!=null){var{allowDuplicatedCategory:r,type:i,dataKey:o}=n,l=Pd(e,s),c=t.map(u=>u.value);if(o&&l&&i==="category"&&r&&NY(c))return c}},xD=ut([ja,o1,bn,pn],FK),UK=(e,t,n,s)=>{if(!(n==null||n.dataKey==null)){var{type:r,scale:i}=n,o=Pd(e,s);if(o&&(r==="number"||i!=="auto"))return t.map(l=>l.value)}},yD=ut([ja,o1,c0,pn],UK),lU=ut([ja,yEe,bh,c1,xD,yD,m0,gD,pn],(e,t,n,s,r,i,o,l,c)=>{if(t!=null){var u=Pd(e,c);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:c,categoricalDomain:i,duplicateDomain:r,isCategorical:u,niceTicks:l,range:o,realScaleType:n,scale:s}}}),oLe=(e,t,n,s,r,i,o,l,c)=>{if(!(t==null||s==null)){var u=Pd(e,c),{type:d,ticks:h,tickCount:p}=t,x=n==="scaleBand"&&typeof s.bandwidth=="function"?s.bandwidth()/2:2,v=d==="category"&&s.bandwidth?s.bandwidth()/x:0;v=c==="angleAxis"&&i!=null&&i.length>=2?xs(i[0]-i[1])*2*v:v;var j=h||r;if(j){var y=j.map((N,w)=>{var S=o?o.indexOf(N):N;return{index:w,coordinate:s(S)+v,value:N,offset:v}});return y.filter(N=>xn(N.coordinate))}return u&&l?l.map((N,w)=>({coordinate:s(N)+v,value:N,index:w,offset:v})).filter(N=>xn(N.coordinate)):s.ticks?s.ticks(p).map(N=>({coordinate:s(N)+v,value:N,offset:v})):s.domain().map((N,w)=>({coordinate:s(N)+v,value:o?o[N]:N,index:w,offset:v}))}},BK=ut([ja,c0,bh,c1,gD,m0,xD,yD,pn],oLe),lLe=(e,t,n,s,r,i,o)=>{if(!(t==null||n==null||s==null||s[0]===s[1])){var l=Pd(e,o),{tickCount:c}=t,u=0;return u=o==="angleAxis"&&s?.length>=2?xs(s[0]-s[1])*2*u:u,l&&i?i.map((d,h)=>({coordinate:n(d)+u,value:d,index:h,offset:u})):n.ticks?n.ticks(c).map(d=>({coordinate:n(d)+u,value:d,offset:u})):n.domain().map((d,h)=>({coordinate:n(d)+u,value:r?r[d]:d,index:h,offset:u}))}},yd=ut([ja,c0,c1,m0,xD,yD,pn],lLe),bd=ut(bn,c1,(e,t)=>{if(!(e==null||t==null))return kw(kw({},e),{},{scale:t})}),cLe=ut([bn,bh,mD,MK],fD);ut((e,t,n)=>JP(e,n),cLe,(e,t)=>{if(!(e==null||t==null))return kw(kw({},e),{},{scale:t})});var dLe=ut([ja,qN,GN],(e,t,n)=>{switch(e){case"horizontal":return t.some(s=>s.reversed)?"right-to-left":"left-to-right";case"vertical":return n.some(s=>s.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),HK=e=>e.options.defaultTooltipEventType,qK=e=>e.options.validateTooltipEventTypes;function GK(e,t,n){if(e==null)return t;var s=e?"axis":"item";return n==null?t:n.includes(s)?s:t}function bD(e,t){var n=HK(e),s=qK(e);return GK(t,n,s)}function uLe(e){return Bt(t=>bD(t,e))}var WK=(e,t)=>{var n,s=Number(t);if(!(eo(s)||t==null))return s>=0?e==null||(n=e[s])===null||n===void 0?void 0:n.value:void 0},mLe=e=>e.tooltip.settings,Xc={active:!1,index:null,dataKey:void 0,graphicalItemId:void 0,coordinate:void 0},fLe={itemInteraction:{click:Xc,hover:Xc},axisInteraction:{click:Xc,hover:Xc},keyboardInteraction:Xc,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0,sourceViewBox:void 0,graphicalItemId:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},VK=Cr({name:"tooltip",initialState:fLe,reducers:{addTooltipEntrySettings:{reducer(e,t){e.tooltipItemPayloads.push(t.payload)},prepare:cn()},replaceTooltipEntrySettings:{reducer(e,t){var{prev:n,next:s}=t.payload,r=Vi(e).tooltipItemPayloads.indexOf(n);r>-1&&(e.tooltipItemPayloads[r]=s)},prepare:cn()},removeTooltipEntrySettings:{reducer(e,t){var n=Vi(e).tooltipItemPayloads.indexOf(t.payload);n>-1&&e.tooltipItemPayloads.splice(n,1)},prepare:cn()},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.graphicalItemId=t.payload.activeGraphicalItemId,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.graphicalItemId=t.payload.activeGraphicalItemId,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate}}}),{addTooltipEntrySettings:hLe,replaceTooltipEntrySettings:gLe,removeTooltipEntrySettings:pLe,setTooltipSettingsState:xLe,setActiveMouseOverItemIndex:YK,mouseLeaveItem:yLe,mouseLeaveChart:QK,setActiveClickItemIndex:bLe,setMouseOverAxisIndex:KK,setMouseClickAxisIndex:vLe,setSyncInteraction:EE,setKeyboardInteraction:LE}=VK.actions,wLe=VK.reducer;function cU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function fb(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?cU(Object(n),!0).forEach(function(s){jLe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):cU(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function jLe(e,t,n){return(t=NLe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function NLe(e){var t=CLe(e,"string");return typeof t=="symbol"?t:t+""}function CLe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function SLe(e,t,n){return t==="axis"?n==="click"?e.axisInteraction.click:e.axisInteraction.hover:n==="click"?e.itemInteraction.click:e.itemInteraction.hover}function _Le(e){return e.index!=null}var XK=(e,t,n,s)=>{if(t==null)return Xc;var r=SLe(e,t,n);if(r==null)return Xc;if(r.active)return r;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var i=e.settings.active===!0;if(_Le(r)){if(i)return fb(fb({},r),{},{active:!0})}else if(s!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:s,graphicalItemId:void 0};return fb(fb({},Xc),{},{coordinate:r.coordinate})};function ALe(e){if(typeof e=="number")return Number.isFinite(e)?e:void 0;if(e instanceof Date){var t=e.valueOf();return Number.isFinite(t)?t:void 0}var n=Number(e);return Number.isFinite(n)?n:void 0}function TLe(e,t){var n=ALe(e),s=t[0],r=t[1];if(n===void 0)return!1;var i=Math.min(s,r),o=Math.max(s,r);return n>=i&&n<=o}function kLe(e,t,n){if(n==null||t==null)return!0;var s=qa(e,t);return s==null||!xd(n)?!0:TLe(s,n)}var vD=(e,t,n,s)=>{var r=e?.index;if(r==null)return null;var i=Number(r);if(!xn(i))return r;var o=0,l=1/0;t.length>0&&(l=t.length-1);var c=Math.max(o,Math.min(i,l)),u=t[c];return u==null||kLe(u,n,s)?String(c):null},ZK=(e,t,n,s,r,i,o,l)=>{if(!(i==null||l==null)){var c=o[0],u=c==null?void 0:l(c.positions,i);if(u!=null)return u;var d=r?.[Number(i)];if(d)return n==="horizontal"?{x:d.coordinate,y:(s.top+t)/2}:{x:(s.left+e)/2,y:d.coordinate}}},JK=(e,t,n,s)=>{if(t==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var r;if(n==="hover"?r=e.itemInteraction.hover.graphicalItemId:r=e.itemInteraction.click.graphicalItemId,r==null&&s!=null){var i=e.tooltipItemPayloads[0];return i!=null?[i]:[]}return e.tooltipItemPayloads.filter(o=>{var l;return((l=o.settings)===null||l===void 0?void 0:l.graphicalItemId)===r})},f0=e=>e.options.tooltipPayloadSearcher,vh=e=>e.tooltip;function dU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function uU(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?dU(Object(n),!0).forEach(function(s){ELe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dU(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function ELe(e,t,n){return(t=LLe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function LLe(e){var t=PLe(e,"string");return typeof t=="symbol"?t:t+""}function PLe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function DLe(e,t){return e??t}var eX=(e,t,n,s,r,i,o)=>{if(!(t==null||i==null)){var{chartData:l,computedData:c,dataStartIndex:u,dataEndIndex:d}=n,h=[];return e.reduce((p,x)=>{var v,{dataDefinedOnItem:j,settings:y}=x,N=DLe(j,l),w=Array.isArray(N)?pQ(N,u,d):N,S=(v=y?.dataKey)!==null&&v!==void 0?v:s,_=y?.nameKey,k;if(s&&Array.isArray(w)&&!Array.isArray(w[0])&&o==="axis"?k=CY(w,s,r):k=i(w,t,c,_),Array.isArray(k))k.forEach(A=>{var E=uU(uU({},y),{},{name:A.name,unit:A.unit,color:void 0,fill:void 0});p.push(Xz({tooltipEntrySettings:E,dataKey:A.dataKey,payload:A.payload,value:qa(A.payload,A.dataKey),name:A.name}))});else{var T;p.push(Xz({tooltipEntrySettings:y,dataKey:S,payload:k,value:qa(k,S),name:(T=qa(k,_))!==null&&T!==void 0?T:y?.name}))}return p},h)}},wD=ut([ds,ja,wK,WP,cs],DK),OLe=ut([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),MLe=ut([cs,xh],eD),wh=ut([OLe,ds,MLe],tD,{memoizeOptions:{resultEqualityCheck:r1}}),ILe=ut([wh],e=>e.filter(n1)),$Le=ut([wh],aD,{memoizeOptions:{resultEqualityCheck:r1}}),jh=ut([$Le,cc],nD),RLe=ut([ILe,cc,ds],yK),jD=ut([jh,ds,wh],rD),tX=ut([ds],iD),zLe=ut([ds],e=>e.allowDataOverflow),aX=ut([tX,zLe],QQ),FLe=ut([wh],e=>e.filter(n1)),ULe=ut([RLe,FLe,o0,uK],SK),BLe=ut([ULe,cc,cs,aX],_K),HLe=ut([wh],NK),qLe=ut([jh,ds,HLe,l1,cs],cD,{memoizeOptions:{resultEqualityCheck:s1}}),GLe=ut([AK,cs,xh],yh),WLe=ut([GLe,cs],EK),VLe=ut([TK,cs,xh],yh),YLe=ut([VLe,cs],LK),QLe=ut([kK,cs,xh],yh),KLe=ut([QLe,cs],PK),XLe=ut([WLe,KLe,YLe],Ew),ZLe=ut([ds,tX,aX,BLe,qLe,XLe,ja,cs],dD),h0=ut([ds,ja,jh,jD,o0,cs,ZLe],uD),JLe=ut([h0,ds,wD],hD),e4e=ut([ds,h0,JLe,cs],pD),nX=e=>{var t=cs(e),n=xh(e),s=!1;return m0(e,t,n,s)},sX=ut([ds,nX],t1),rX=ut([ds,wD,e4e,sX],fD),t4e=ut([ja,jD,ds,cs],FK),a4e=ut([ja,jD,ds,cs],UK),n4e=(e,t,n,s,r,i,o,l)=>{if(t){var{type:c}=t,u=Pd(e,l);if(s){var d=n==="scaleBand"&&s.bandwidth?s.bandwidth()/2:2,h=c==="category"&&s.bandwidth?s.bandwidth()/d:0;return h=l==="angleAxis"&&r!=null&&r?.length>=2?xs(r[0]-r[1])*2*h:h,u&&o?o.map((p,x)=>({coordinate:s(p)+h,value:p,index:x,offset:h})):s.domain().map((p,x)=>({coordinate:s(p)+h,value:i?i[p]:p,index:x,offset:h}))}}},mc=ut([ja,ds,wD,rX,nX,t4e,a4e,cs],n4e),ND=ut([HK,qK,mLe],(e,t,n)=>GK(n.shared,e,t)),iX=e=>e.tooltip.settings.trigger,CD=e=>e.tooltip.settings.defaultIndex,g0=ut([vh,ND,iX,CD],XK),vd=ut([g0,jh,u0,h0],vD),oX=ut([mc,vd],WK),SD=ut([g0],e=>{if(e)return e.dataKey}),s4e=ut([g0],e=>{if(e)return e.graphicalItemId}),lX=ut([vh,ND,iX,CD],JK),r4e=ut([oc,lc,ja,ls,mc,CD,lX,f0],ZK),i4e=ut([g0,r4e],(e,t)=>e!=null&&e.coordinate?e.coordinate:t),o4e=ut([g0],e=>{var t;return(t=e?.active)!==null&&t!==void 0?t:!1}),l4e=ut([lX,vd,cc,u0,oX,f0,ND],eX),c4e=ut([l4e],e=>{if(e!=null){var t=e.map(n=>n.payload).filter(n=>n!=null);return Array.from(new Set(t))}});function mU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function fU(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?mU(Object(n),!0).forEach(function(s){d4e(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mU(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function d4e(e,t,n){return(t=u4e(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u4e(e){var t=m4e(e,"string");return typeof t=="symbol"?t:t+""}function m4e(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var f4e=()=>Bt(ds),h4e=()=>{var e=f4e(),t=Bt(mc),n=Bt(rX);return Bf(!e||!n?void 0:fU(fU({},e),{},{scale:n}),t)};function hU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function Jm(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?hU(Object(n),!0).forEach(function(s){g4e(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hU(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function g4e(e,t,n){return(t=p4e(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p4e(e){var t=x4e(e,"string");return typeof t=="symbol"?t:t+""}function x4e(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var y4e=(e,t,n,s)=>{var r=t.find(i=>i&&i.index===n);if(r){if(e==="horizontal")return{x:r.coordinate,y:s.chartY};if(e==="vertical")return{x:s.chartX,y:r.coordinate}}return{x:0,y:0}},b4e=(e,t,n,s)=>{var r=t.find(u=>u&&u.index===n);if(r){if(e==="centric"){var i=r.coordinate,{radius:o}=s;return Jm(Jm(Jm({},s),qn(s.cx,s.cy,o,i)),{},{angle:i,radius:o})}var l=r.coordinate,{angle:c}=s;return Jm(Jm(Jm({},s),qn(s.cx,s.cy,l,c)),{},{angle:c,radius:l})}return{angle:0,clockWise:!1,cx:0,cy:0,endAngle:0,innerRadius:0,outerRadius:0,radius:0,startAngle:0,x:0,y:0}};function v4e(e,t){var{chartX:n,chartY:s}=e;return n>=t.left&&n<=t.left+t.width&&s>=t.top&&s<=t.top+t.height}var cX=(e,t,n,s,r)=>{var i,o=(i=t?.length)!==null&&i!==void 0?i:0;if(o<=1||e==null)return 0;if(s==="angleAxis"&&r!=null&&Math.abs(Math.abs(r[1]-r[0])-360)<=1e-6)for(var l=0;l<o;l++){var c,u,d,h,p,x=l>0?(c=n[l-1])===null||c===void 0?void 0:c.coordinate:(u=n[o-1])===null||u===void 0?void 0:u.coordinate,v=(d=n[l])===null||d===void 0?void 0:d.coordinate,j=l>=o-1?(h=n[0])===null||h===void 0?void 0:h.coordinate:(p=n[l+1])===null||p===void 0?void 0:p.coordinate,y=void 0;if(!(x==null||v==null||j==null))if(xs(v-x)!==xs(j-v)){var N=[];if(xs(j-v)===xs(r[1]-r[0])){y=j;var w=v+r[1]-r[0];N[0]=Math.min(w,(w+x)/2),N[1]=Math.max(w,(w+x)/2)}else{y=x;var S=j+r[1]-r[0];N[0]=Math.min(v,(S+v)/2),N[1]=Math.max(v,(S+v)/2)}var _=[Math.min(v,(y+v)/2),Math.max(v,(y+v)/2)];if(e>_[0]&&e<=_[1]||e>=N[0]&&e<=N[1]){var k;return(k=n[l])===null||k===void 0?void 0:k.index}}else{var T=Math.min(x,j),A=Math.max(x,j);if(e>(T+v)/2&&e<=(A+v)/2){var E;return(E=n[l])===null||E===void 0?void 0:E.index}}}else if(t)for(var M=0;M<o;M++){var z=t[M];if(z!=null){var P=t[M+1],D=t[M-1];if(M===0&&P!=null&&e<=(z.coordinate+P.coordinate)/2||M===o-1&&D!=null&&e>(z.coordinate+D.coordinate)/2||M>0&&M<o-1&&D!=null&&P!=null&&e>(z.coordinate+D.coordinate)/2&&e<=(z.coordinate+P.coordinate)/2)return z.index}}return-1},w4e=()=>Bt(WP),_D=(e,t)=>t,dX=(e,t,n)=>n,AD=(e,t,n,s)=>s,j4e=ut(mc,e=>MN(e,t=>t.coordinate)),TD=ut([vh,_D,dX,AD],XK),kD=ut([TD,jh,u0,h0],vD),N4e=(e,t,n)=>{if(t!=null){var s=vh(e);return t==="axis"?n==="hover"?s.axisInteraction.hover.dataKey:s.axisInteraction.click.dataKey:n==="hover"?s.itemInteraction.hover.dataKey:s.itemInteraction.click.dataKey}},uX=ut([vh,_D,dX,AD],JK),Lw=ut([oc,lc,ja,ls,mc,AD,uX,f0],ZK),C4e=ut([TD,Lw],(e,t)=>{var n;return(n=e.coordinate)!==null&&n!==void 0?n:t}),mX=ut([mc,kD],WK),S4e=ut([uX,kD,cc,u0,mX,f0,_D],eX),_4e=ut([TD,kD],(e,t)=>({isActive:e.active&&t!=null,activeIndex:t})),A4e=(e,t,n,s,r,i,o)=>{if(!(!e||!n||!s||!r)&&v4e(e,o)){var l=wAe(e,t),c=cX(l,i,r,n,s),u=y4e(t,r,c,e);return{activeIndex:String(c),activeCoordinate:u}}},T4e=(e,t,n,s,r,i,o)=>{if(!(!e||!s||!r||!i||!n)){var l=Rke(e,n);if(l){var c=jAe(l,t),u=cX(c,o,i,s,r),d=b4e(t,i,u,l);return{activeIndex:String(u),activeCoordinate:d}}}},k4e=(e,t,n,s,r,i,o,l)=>{if(!(!e||!t||!s||!r||!i))return t==="horizontal"||t==="vertical"?A4e(e,t,s,r,i,o,l):T4e(e,t,n,s,r,i,o)},E4e=ut(e=>e.zIndex.zIndexMap,(e,t)=>t,(e,t,n)=>n,(e,t,n)=>{if(t!=null){var s=e[t];if(s!=null)return n?s.panoramaElement:s.element}}),L4e=ut(e=>e.zIndex.zIndexMap,e=>{var t=Object.keys(e).map(s=>parseInt(s,10)).concat(Object.values(Gn)),n=Array.from(new Set(t));return n.sort((s,r)=>s-r)},{memoizeOptions:{resultEqualityCheck:fEe}});function gU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function pU(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?gU(Object(n),!0).forEach(function(s){P4e(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gU(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function P4e(e,t,n){return(t=D4e(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function D4e(e){var t=O4e(e,"string");return typeof t=="symbol"?t:t+""}function O4e(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var M4e={},I4e={zIndexMap:Object.values(Gn).reduce((e,t)=>pU(pU({},e),{},{[t]:{element:void 0,panoramaElement:void 0,consumers:0}}),M4e)},$4e=new Set(Object.values(Gn));function R4e(e){return $4e.has(e)}var fX=Cr({name:"zIndex",initialState:I4e,reducers:{registerZIndexPortal:{reducer:(e,t)=>{var{zIndex:n}=t.payload;e.zIndexMap[n]?e.zIndexMap[n].consumers+=1:e.zIndexMap[n]={consumers:1,element:void 0,panoramaElement:void 0}},prepare:cn()},unregisterZIndexPortal:{reducer:(e,t)=>{var{zIndex:n}=t.payload;e.zIndexMap[n]&&(e.zIndexMap[n].consumers-=1,e.zIndexMap[n].consumers<=0&&!R4e(n)&&delete e.zIndexMap[n])},prepare:cn()},registerZIndexPortalElement:{reducer:(e,t)=>{var{zIndex:n,element:s,isPanorama:r}=t.payload;e.zIndexMap[n]?r?e.zIndexMap[n].panoramaElement=s:e.zIndexMap[n].element=s:e.zIndexMap[n]={consumers:0,element:r?void 0:s,panoramaElement:r?s:void 0}},prepare:cn()},unregisterZIndexPortalElement:{reducer:(e,t)=>{var{zIndex:n}=t.payload;e.zIndexMap[n]&&(t.payload.isPanorama?e.zIndexMap[n].panoramaElement=void 0:e.zIndexMap[n].element=void 0)},prepare:cn()}}}),{registerZIndexPortal:z4e,unregisterZIndexPortal:F4e,registerZIndexPortalElement:U4e,unregisterZIndexPortalElement:B4e}=fX.actions,H4e=fX.reducer;function Sr(e){var{zIndex:t,children:n}=e,s=JAe(),r=s&&t!==void 0&&t!==0,i=Hs(),o=en();f.useLayoutEffect(()=>r?(o(z4e({zIndex:t})),()=>{o(F4e({zIndex:t}))}):Zx,[o,t,r]);var l=Bt(c=>E4e(c,t,i));return r?l?Gi.createPortal(n,l):null:n}function PE(){return PE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},PE.apply(null,arguments)}function xU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function hb(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?xU(Object(n),!0).forEach(function(s){q4e(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xU(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function q4e(e,t,n){return(t=G4e(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function G4e(e){var t=W4e(e,"string");return typeof t=="symbol"?t:t+""}function W4e(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function V4e(e){var{cursor:t,cursorComp:n,cursorProps:s}=e;return f.isValidElement(t)?f.cloneElement(t,s):f.createElement(n,s)}function Y4e(e){var t,{coordinate:n,payload:s,index:r,offset:i,tooltipAxisBandSize:o,layout:l,cursor:c,tooltipEventType:u,chartName:d}=e,h=n,p=s,x=r;if(!c||!h||d!=="ScatterChart"&&u!=="axis")return null;var v,j,y;if(d==="ScatterChart")v=h,j=ZTe,y=Gn.cursorLine;else if(d==="BarChart")v=JTe(l,h,i,o),j=HQ,y=Gn.cursorRectangle;else if(l==="radial"&&_Y(h)){var{cx:N,cy:w,radius:S,startAngle:_,endAngle:k}=GQ(h);v={cx:N,cy:w,startAngle:_,endAngle:k,innerRadius:S,outerRadius:S},j=VQ,y=Gn.cursorLine}else v={points:Bke(l,h,i)},j=BP,y=Gn.cursorLine;var T=typeof c=="object"&&"className"in c?c.className:void 0,A=hb(hb(hb(hb({stroke:"#ccc",pointerEvents:"none"},i),v),zu(c)),{},{payload:p,payloadIndex:x,className:$t("recharts-tooltip-cursor",T)});return f.createElement(Sr,{zIndex:(t=e.zIndex)!==null&&t!==void 0?t:y},f.createElement(V4e,{cursor:c,cursorComp:j,cursorProps:A}))}function Q4e(e){var t=h4e(),n=_Q(),s=hh(),r=w4e();return t==null||n==null||s==null||r==null?null:f.createElement(Y4e,PE({},e,{offset:n,layout:s,tooltipAxisBandSize:t,chartName:r}))}var hX=f.createContext(null),K4e=()=>f.useContext(hX),Q_={exports:{}},yU;function X4e(){return yU||(yU=1,(function(e){var t=Object.prototype.hasOwnProperty,n="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(n=!1));function r(c,u,d){this.fn=c,this.context=u,this.once=d||!1}function i(c,u,d,h,p){if(typeof d!="function")throw new TypeError("The listener must be a function");var x=new r(d,h||c,p),v=n?n+u:u;return c._events[v]?c._events[v].fn?c._events[v]=[c._events[v],x]:c._events[v].push(x):(c._events[v]=x,c._eventsCount++),c}function o(c,u){--c._eventsCount===0?c._events=new s:delete c._events[u]}function l(){this._events=new s,this._eventsCount=0}l.prototype.eventNames=function(){var u=[],d,h;if(this._eventsCount===0)return u;for(h in d=this._events)t.call(d,h)&&u.push(n?h.slice(1):h);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(d)):u},l.prototype.listeners=function(u){var d=n?n+u:u,h=this._events[d];if(!h)return[];if(h.fn)return[h.fn];for(var p=0,x=h.length,v=new Array(x);p<x;p++)v[p]=h[p].fn;return v},l.prototype.listenerCount=function(u){var d=n?n+u:u,h=this._events[d];return h?h.fn?1:h.length:0},l.prototype.emit=function(u,d,h,p,x,v){var j=n?n+u:u;if(!this._events[j])return!1;var y=this._events[j],N=arguments.length,w,S;if(y.fn){switch(y.once&&this.removeListener(u,y.fn,void 0,!0),N){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,d),!0;case 3:return y.fn.call(y.context,d,h),!0;case 4:return y.fn.call(y.context,d,h,p),!0;case 5:return y.fn.call(y.context,d,h,p,x),!0;case 6:return y.fn.call(y.context,d,h,p,x,v),!0}for(S=1,w=new Array(N-1);S<N;S++)w[S-1]=arguments[S];y.fn.apply(y.context,w)}else{var _=y.length,k;for(S=0;S<_;S++)switch(y[S].once&&this.removeListener(u,y[S].fn,void 0,!0),N){case 1:y[S].fn.call(y[S].context);break;case 2:y[S].fn.call(y[S].context,d);break;case 3:y[S].fn.call(y[S].context,d,h);break;case 4:y[S].fn.call(y[S].context,d,h,p);break;default:if(!w)for(k=1,w=new Array(N-1);k<N;k++)w[k-1]=arguments[k];y[S].fn.apply(y[S].context,w)}}return!0},l.prototype.on=function(u,d,h){return i(this,u,d,h,!1)},l.prototype.once=function(u,d,h){return i(this,u,d,h,!0)},l.prototype.removeListener=function(u,d,h,p){var x=n?n+u:u;if(!this._events[x])return this;if(!d)return o(this,x),this;var v=this._events[x];if(v.fn)v.fn===d&&(!p||v.once)&&(!h||v.context===h)&&o(this,x);else{for(var j=0,y=[],N=v.length;j<N;j++)(v[j].fn!==d||p&&!v[j].once||h&&v[j].context!==h)&&y.push(v[j]);y.length?this._events[x]=y.length===1?y[0]:y:o(this,x)}return this},l.prototype.removeAllListeners=function(u){var d;return u?(d=n?n+u:u,this._events[d]&&o(this,d)):(this._events=new s,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=n,l.EventEmitter=l,e.exports=l})(Q_)),Q_.exports}var Z4e=X4e();const J4e=ao(Z4e);var Wp=new J4e,DE="recharts.syncEvent.tooltip",bU="recharts.syncEvent.brush";function ED(e,t){if(t){var n=Number.parseInt(t,10);if(!eo(n))return e?.[n]}}var ePe={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},gX=Cr({name:"options",initialState:ePe,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),tPe=gX.reducer,{createEventEmitter:aPe}=gX.actions;function nPe(e){return e.tooltip.syncInteraction}var sPe={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},pX=Cr({name:"chartData",initialState:sPe,reducers:{setChartData(e,t){if(e.chartData=t.payload,t.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:n,endIndex:s}=t.payload;n!=null&&(e.dataStartIndex=n),s!=null&&(e.dataEndIndex=s)}}}),{setChartData:vU,setDataStartEndIndexes:rPe,setComputedData:VVe}=pX.actions,iPe=pX.reducer,oPe=["x","y"];function wU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function ef(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?wU(Object(n),!0).forEach(function(s){lPe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wU(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function lPe(e,t,n){return(t=cPe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function cPe(e){var t=dPe(e,"string");return typeof t=="symbol"?t:t+""}function dPe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function uPe(e,t){if(e==null)return{};var n,s,r=mPe(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)n=i[s],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function mPe(e,t){if(e==null)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;n[s]=e[s]}return n}function fPe(){var e=Bt(VP),t=Bt(YP),n=en(),s=Bt(mK),r=Bt(mc),i=hh(),o=YN(),l=Bt(c=>c.rootProps.className);f.useEffect(()=>{if(e==null)return Zx;var c=(u,d,h)=>{if(t!==h&&e===u){if(s==="index"){var p;if(o&&d!==null&&d!==void 0&&(p=d.payload)!==null&&p!==void 0&&p.coordinate&&d.payload.sourceViewBox){var x=d.payload.coordinate,{x:v,y:j}=x,y=uPe(x,oPe),{x:N,y:w,width:S,height:_}=d.payload.sourceViewBox,k=ef(ef({},y),{},{x:o.x+(S?(v-N)/S:0)*o.width,y:o.y+(_?(j-w)/_:0)*o.height});n(ef(ef({},d),{},{payload:ef(ef({},d.payload),{},{coordinate:k})}))}else n(d);return}if(r!=null){var T;if(typeof s=="function"){var A={activeTooltipIndex:d.payload.index==null?void 0:Number(d.payload.index),isTooltipActive:d.payload.active,activeIndex:d.payload.index==null?void 0:Number(d.payload.index),activeLabel:d.payload.label,activeDataKey:d.payload.dataKey,activeCoordinate:d.payload.coordinate},E=s(r,A);T=r[E]}else s==="value"&&(T=r.find(q=>String(q.value)===d.payload.label));var{coordinate:M}=d.payload;if(T==null||d.payload.active===!1||M==null||o==null){n(EE({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0,sourceViewBox:void 0,graphicalItemId:void 0}));return}var{x:z,y:P}=M,D=Math.min(z,o.x+o.width),U=Math.min(P,o.y+o.height),B={x:i==="horizontal"?T.coordinate:D,y:i==="horizontal"?U:T.coordinate},R=EE({active:d.payload.active,coordinate:B,dataKey:d.payload.dataKey,index:String(T.index),label:d.payload.label,sourceViewBox:d.payload.sourceViewBox,graphicalItemId:d.payload.graphicalItemId});n(R)}}};return Wp.on(DE,c),()=>{Wp.off(DE,c)}},[l,n,t,e,s,r,i,o])}function hPe(){var e=Bt(VP),t=Bt(YP),n=en();f.useEffect(()=>{if(e==null)return Zx;var s=(r,i,o)=>{t!==o&&e===r&&n(rPe(i))};return Wp.on(bU,s),()=>{Wp.off(bU,s)}},[n,t,e])}function gPe(){var e=en();f.useEffect(()=>{e(aPe())},[e]),fPe(),hPe()}function pPe(e,t,n,s,r,i){var o=Bt(x=>N4e(x,e,t)),l=Bt(YP),c=Bt(VP),u=Bt(mK),d=Bt(nPe),h=d?.active,p=YN();f.useEffect(()=>{if(!h&&c!=null&&l!=null){var x=EE({active:i,coordinate:n,dataKey:o,index:r,label:typeof s=="number"?String(s):s,sourceViewBox:p,graphicalItemId:void 0});Wp.emit(DE,c,x,l)}},[h,n,o,r,s,l,c,u,i,p])}function jU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function NU(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?jU(Object(n),!0).forEach(function(s){xPe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jU(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function xPe(e,t,n){return(t=yPe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function yPe(e){var t=bPe(e,"string");return typeof t=="symbol"?t:t+""}function bPe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vPe(e){return e.dataKey}function wPe(e,t){return f.isValidElement(e)?f.cloneElement(e,t):typeof e=="function"?f.createElement(e,t):f.createElement(LTe,t)}var CU=[],jPe={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,includeHidden:!1,isAnimationActive:"auto",itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function K_(e){var t,n,s=Qn(e,jPe),{active:r,allowEscapeViewBox:i,animationDuration:o,animationEasing:l,content:c,filterNull:u,isAnimationActive:d,offset:h,payloadUniqBy:p,position:x,reverseDirection:v,useTranslate3d:j,wrapperStyle:y,cursor:N,shared:w,trigger:S,defaultIndex:_,portal:k,axisId:T}=s,A=en(),E=typeof _=="number"?String(_):_;f.useEffect(()=>{A(xLe({shared:w,trigger:S,axisId:T,active:r,defaultIndex:E}))},[A,w,S,T,r,E]);var M=YN(),z=RQ(),P=uLe(w),{activeIndex:D,isActive:U}=(t=Bt(de=>_4e(de,P,S,E)))!==null&&t!==void 0?t:{},B=Bt(de=>S4e(de,P,S,E)),R=Bt(de=>mX(de,P,S,E)),q=Bt(de=>C4e(de,P,S,E)),Z=B,V=K4e(),oe=(n=r??U)!==null&&n!==void 0?n:!1,[je,X]=FY([Z,oe]),se=P==="axis"?R:void 0;pPe(P,S,q,se,D,oe);var ye=k??V;if(ye==null||M==null||P==null)return null;var Ne=Z??CU;oe||(Ne=CU),u&&Ne.length&&(Ne=IY(Ne.filter(de=>de.value!=null&&(de.hide!==!0||s.includeHidden)),p,vPe));var fe=Ne.length>0,we=f.createElement(RTe,{allowEscapeViewBox:i,animationDuration:o,animationEasing:l,isAnimationActive:d,active:oe,coordinate:q,hasPayload:fe,offset:h,position:x,reverseDirection:v,useTranslate3d:j,viewBox:M,wrapperStyle:y,lastBoundingBox:je,innerRef:X,hasPortalFromProps:!!k},wPe(c,NU(NU({},s),{},{payload:Ne,label:se,active:oe,activeIndex:D,coordinate:q,accessibilityLayer:z})));return f.createElement(f.Fragment,null,Gi.createPortal(we,ye),oe&&f.createElement(Q4e,{cursor:N,tooltipEventType:P,coordinate:q,payload:Ne,index:D}))}var m1=e=>null;m1.displayName="Cell";function NPe(e,t,n){return(t=CPe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function CPe(e){var t=SPe(e,"string");return typeof t=="symbol"?t:t+""}function SPe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class _Pe{constructor(t){NPe(this,"cache",new Map),this.maxSize=t}get(t){var n=this.cache.get(t);return n!==void 0&&(this.cache.delete(t),this.cache.set(t,n)),n}set(t,n){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxSize){var s=this.cache.keys().next().value;s!=null&&this.cache.delete(s)}this.cache.set(t,n)}clear(){this.cache.clear()}size(){return this.cache.size}}function SU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function APe(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?SU(Object(n),!0).forEach(function(s){TPe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):SU(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function TPe(e,t,n){return(t=kPe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function kPe(e){var t=EPe(e,"string");return typeof t=="symbol"?t:t+""}function EPe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var LPe={cacheSize:2e3,enableCache:!0},xX=APe({},LPe),_U=new _Pe(xX.cacheSize),PPe={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},AU="recharts_measurement_span";function DPe(e,t){var n=t.fontSize||"",s=t.fontFamily||"",r=t.fontWeight||"",i=t.fontStyle||"",o=t.letterSpacing||"",l=t.textTransform||"";return"".concat(e,"|").concat(n,"|").concat(s,"|").concat(r,"|").concat(i,"|").concat(o,"|").concat(l)}var TU=(e,t)=>{try{var n=document.getElementById(AU);n||(n=document.createElement("span"),n.setAttribute("id",AU),n.setAttribute("aria-hidden","true"),document.body.appendChild(n)),Object.assign(n.style,PPe,t),n.textContent="".concat(e);var s=n.getBoundingClientRect();return{width:s.width,height:s.height}}catch{return{width:0,height:0}}},lp=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||JN.isSsr)return{width:0,height:0};if(!xX.enableCache)return TU(t,n);var s=DPe(t,n),r=_U.get(s);if(r)return r;var i=TU(t,n);return _U.set(s,i),i},yX;function OPe(e,t,n){return(t=MPe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function MPe(e){var t=IPe(e,"string");return typeof t=="symbol"?t:t+""}function IPe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var kU=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,EU=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,$Pe=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,RPe=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,zPe={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},FPe=["cm","mm","pt","pc","in","Q","px"];function UPe(e){return FPe.includes(e)}var ff="NaN";function BPe(e,t){return e*zPe[t]}class As{static parse(t){var n,[,s,r]=(n=RPe.exec(t))!==null&&n!==void 0?n:[];return s==null?As.NaN:new As(parseFloat(s),r??"")}constructor(t,n){this.num=t,this.unit=n,this.num=t,this.unit=n,eo(t)&&(this.unit=""),n!==""&&!$Pe.test(n)&&(this.num=NaN,this.unit=""),UPe(n)&&(this.num=BPe(t,n),this.unit="px")}add(t){return this.unit!==t.unit?new As(NaN,""):new As(this.num+t.num,this.unit)}subtract(t){return this.unit!==t.unit?new As(NaN,""):new As(this.num-t.num,this.unit)}multiply(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new As(NaN,""):new As(this.num*t.num,this.unit||t.unit)}divide(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new As(NaN,""):new As(this.num/t.num,this.unit||t.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return eo(this.num)}}yX=As;OPe(As,"NaN",new yX(NaN,""));function bX(e){if(e==null||e.includes(ff))return ff;for(var t=e;t.includes("*")||t.includes("/");){var n,[,s,r,i]=(n=kU.exec(t))!==null&&n!==void 0?n:[],o=As.parse(s??""),l=As.parse(i??""),c=r==="*"?o.multiply(l):o.divide(l);if(c.isNaN())return ff;t=t.replace(kU,c.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var u,[,d,h,p]=(u=EU.exec(t))!==null&&u!==void 0?u:[],x=As.parse(d??""),v=As.parse(p??""),j=h==="+"?x.add(v):x.subtract(v);if(j.isNaN())return ff;t=t.replace(EU,j.toString())}return t}var LU=/\(([^()]*)\)/;function HPe(e){for(var t=e,n;(n=LU.exec(t))!=null;){var[,s]=n;t=t.replace(LU,bX(s))}return t}function qPe(e){var t=e.replace(/\s+/g,"");return t=HPe(t),t=bX(t),t}function GPe(e){try{return qPe(e)}catch{return ff}}function X_(e){var t=GPe(e.slice(5,-1));return t===ff?"":t}var WPe=["x","y","lineHeight","capHeight","fill","scaleToFit","textAnchor","verticalAnchor"],VPe=["dx","dy","angle","className","breakAll"];function OE(){return OE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},OE.apply(null,arguments)}function PU(e,t){if(e==null)return{};var n,s,r=YPe(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)n=i[s],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function YPe(e,t){if(e==null)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;n[s]=e[s]}return n}var vX=/[ \f\n\r\t\v\u2028\u2029]+/,wX=e=>{var{children:t,breakAll:n,style:s}=e;try{var r=[];fn(t)||(n?r=t.toString().split(""):r=t.toString().split(vX));var i=r.map(l=>({word:l,width:lp(l,s).width})),o=n?0:lp("",s).width;return{wordsWithComputedWidth:i,spaceWidth:o}}catch{return null}};function QPe(e){return e==="start"||e==="middle"||e==="end"||e==="inherit"}var jX=(e,t,n,s)=>e.reduce((r,i)=>{var{word:o,width:l}=i,c=r[r.length-1];if(c&&l!=null&&(t==null||s||c.width+l+n<Number(t)))c.words.push(o),c.width+=l+n;else{var u={words:[o],width:l};r.push(u)}return r},[]),NX=e=>e.reduce((t,n)=>t.width>n.width?t:n),KPe="",DU=(e,t,n,s,r,i,o,l)=>{var c=e.slice(0,t),u=wX({breakAll:n,style:s,children:c+KPe});if(!u)return[!1,[]];var d=jX(u.wordsWithComputedWidth,i,o,l),h=d.length>r||NX(d).width>Number(i);return[h,d]},XPe=(e,t,n,s,r)=>{var{maxLines:i,children:o,style:l,breakAll:c}=e,u=Ut(i),d=String(o),h=jX(t,s,n,r);if(!u||r)return h;var p=h.length>i||NX(h).width>Number(s);if(!p)return h;for(var x=0,v=d.length-1,j=0,y;x<=v&&j<=d.length-1;){var N=Math.floor((x+v)/2),w=N-1,[S,_]=DU(d,w,c,l,i,s,n,r),[k]=DU(d,N,c,l,i,s,n,r);if(!S&&!k&&(x=N+1),S&&k&&(v=N-1),!S&&k){y=_;break}j++}return y||h},OU=e=>{var t=fn(e)?[]:e.toString().split(vX);return[{words:t,width:void 0}]},ZPe=e=>{var{width:t,scaleToFit:n,children:s,style:r,breakAll:i,maxLines:o}=e;if((t||n)&&!JN.isSsr){var l,c,u=wX({breakAll:i,children:s,style:r});if(u){var{wordsWithComputedWidth:d,spaceWidth:h}=u;l=d,c=h}else return OU(s);return XPe({breakAll:i,children:s,maxLines:o,style:r},l,c,t,!!n)}return OU(s)},CX="#808080",JPe={angle:0,breakAll:!1,capHeight:"0.71em",fill:CX,lineHeight:"1em",scaleToFit:!1,textAnchor:"start",verticalAnchor:"end",x:0,y:0},f1=f.forwardRef((e,t)=>{var n=Qn(e,JPe),{x:s,y:r,lineHeight:i,capHeight:o,fill:l,scaleToFit:c,textAnchor:u,verticalAnchor:d}=n,h=PU(n,WPe),p=f.useMemo(()=>ZPe({breakAll:h.breakAll,children:h.children,maxLines:h.maxLines,scaleToFit:c,style:h.style,width:h.width}),[h.breakAll,h.children,h.maxLines,c,h.style,h.width]),{dx:x,dy:v,angle:j,className:y,breakAll:N}=h,w=PU(h,VPe);if(!Ho(s)||!Ho(r)||p.length===0)return null;var S=Number(s)+(Ut(x)?x:0),_=Number(r)+(Ut(v)?v:0);if(!xn(S)||!xn(_))return null;var k;switch(d){case"start":k=X_("calc(".concat(o,")"));break;case"middle":k=X_("calc(".concat((p.length-1)/2," * -").concat(i," + (").concat(o," / 2))"));break;default:k=X_("calc(".concat(p.length-1," * -").concat(i,")"));break}var T=[];if(c){var A=p[0].width,{width:E}=h;T.push("scale(".concat(Ut(E)&&Ut(A)?E/A:1,")"))}return j&&T.push("rotate(".concat(j,", ").concat(S,", ").concat(_,")")),T.length&&(w.transform=T.join(" ")),f.createElement("text",OE({},Ys(w),{ref:t,x:S,y:_,className:$t("recharts-text",y),textAnchor:u,fill:l.includes("url")?CX:l}),p.map((M,z)=>{var P=M.words.join(N?"":" ");return f.createElement("tspan",{x:S,dy:z===0?k:i,key:"".concat(P,"-").concat(z)},P)}))});f1.displayName="Text";var eDe=["labelRef"],tDe=["content"];function MU(e,t){if(e==null)return{};var n,s,r=aDe(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)n=i[s],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function aDe(e,t){if(e==null)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;n[s]=e[s]}return n}function IU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function Dn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?IU(Object(n),!0).forEach(function(s){nDe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):IU(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function nDe(e,t,n){return(t=sDe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function sDe(e){var t=rDe(e,"string");return typeof t=="symbol"?t:t+""}function rDe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kl(){return kl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},kl.apply(null,arguments)}var SX=f.createContext(null),iDe=e=>{var{x:t,y:n,upperWidth:s,lowerWidth:r,width:i,height:o,children:l}=e,c=f.useMemo(()=>({x:t,y:n,upperWidth:s,lowerWidth:r,width:i,height:o}),[t,n,s,r,i,o]);return f.createElement(SX.Provider,{value:c},l)},_X=()=>{var e=f.useContext(SX),t=YN();return e||SQ(t)},oDe=f.createContext(null),lDe=()=>{var e=f.useContext(oDe),t=Bt(xK);return e||t},cDe=e=>{var{value:t,formatter:n}=e,s=fn(e.children)?t:e.children;return typeof n=="function"?n(s):s},LD=e=>e!=null&&typeof e=="function",dDe=(e,t)=>{var n=xs(t-e),s=Math.min(Math.abs(t-e),360);return n*s},uDe=(e,t,n,s,r)=>{var{offset:i,className:o}=e,{cx:l,cy:c,innerRadius:u,outerRadius:d,startAngle:h,endAngle:p,clockWise:x}=r,v=(u+d)/2,j=dDe(h,p),y=j>=0?1:-1,N,w;switch(t){case"insideStart":N=h+y*i,w=x;break;case"insideEnd":N=p-y*i,w=!x;break;case"end":N=p+y*i,w=x;break;default:throw new Error("Unsupported position ".concat(t))}w=j<=0?w:!w;var S=qn(l,c,v,N),_=qn(l,c,v,N+(w?1:-1)*359),k="M".concat(S.x,",").concat(S.y,`
    A`).concat(v,",").concat(v,",0,1,").concat(w?0:1,`,
    `).concat(_.x,",").concat(_.y),T=fn(e.id)?$p("recharts-radial-line-"):e.id;return f.createElement("text",kl({},s,{dominantBaseline:"central",className:$t("recharts-radial-bar-label",o)}),f.createElement("defs",null,f.createElement("path",{id:T,d:k})),f.createElement("textPath",{xlinkHref:"#".concat(T)},n))},mDe=(e,t,n)=>{var{cx:s,cy:r,innerRadius:i,outerRadius:o,startAngle:l,endAngle:c}=e,u=(l+c)/2;if(n==="outside"){var{x:d,y:h}=qn(s,r,o+t,u);return{x:d,y:h,textAnchor:d>=s?"start":"end",verticalAnchor:"middle"}}if(n==="center")return{x:s,y:r,textAnchor:"middle",verticalAnchor:"middle"};if(n==="centerTop")return{x:s,y:r,textAnchor:"middle",verticalAnchor:"start"};if(n==="centerBottom")return{x:s,y:r,textAnchor:"middle",verticalAnchor:"end"};var p=(i+o)/2,{x,y:v}=qn(s,r,p,u);return{x,y:v,textAnchor:"middle",verticalAnchor:"middle"}},ME=e=>"cx"in e&&Ut(e.cx),fDe=(e,t)=>{var{parentViewBox:n,offset:s,position:r}=e,i;n!=null&&!ME(n)&&(i=n);var{x:o,y:l,upperWidth:c,lowerWidth:u,height:d}=t,h=o,p=o+(c-u)/2,x=(h+p)/2,v=(c+u)/2,j=h+c/2,y=d>=0?1:-1,N=y*s,w=y>0?"end":"start",S=y>0?"start":"end",_=c>=0?1:-1,k=_*s,T=_>0?"end":"start",A=_>0?"start":"end";if(r==="top"){var E={x:h+c/2,y:l-N,textAnchor:"middle",verticalAnchor:w};return Dn(Dn({},E),i?{height:Math.max(l-i.y,0),width:c}:{})}if(r==="bottom"){var M={x:p+u/2,y:l+d+N,textAnchor:"middle",verticalAnchor:S};return Dn(Dn({},M),i?{height:Math.max(i.y+i.height-(l+d),0),width:u}:{})}if(r==="left"){var z={x:x-k,y:l+d/2,textAnchor:T,verticalAnchor:"middle"};return Dn(Dn({},z),i?{width:Math.max(z.x-i.x,0),height:d}:{})}if(r==="right"){var P={x:x+v+k,y:l+d/2,textAnchor:A,verticalAnchor:"middle"};return Dn(Dn({},P),i?{width:Math.max(i.x+i.width-P.x,0),height:d}:{})}var D=i?{width:v,height:d}:{};return r==="insideLeft"?Dn({x:x+k,y:l+d/2,textAnchor:A,verticalAnchor:"middle"},D):r==="insideRight"?Dn({x:x+v-k,y:l+d/2,textAnchor:T,verticalAnchor:"middle"},D):r==="insideTop"?Dn({x:h+c/2,y:l+N,textAnchor:"middle",verticalAnchor:S},D):r==="insideBottom"?Dn({x:p+u/2,y:l+d-N,textAnchor:"middle",verticalAnchor:w},D):r==="insideTopLeft"?Dn({x:h+k,y:l+N,textAnchor:A,verticalAnchor:S},D):r==="insideTopRight"?Dn({x:h+c-k,y:l+N,textAnchor:T,verticalAnchor:S},D):r==="insideBottomLeft"?Dn({x:p+k,y:l+d-N,textAnchor:A,verticalAnchor:w},D):r==="insideBottomRight"?Dn({x:p+u-k,y:l+d-N,textAnchor:T,verticalAnchor:w},D):r&&typeof r=="object"&&(Ut(r.x)||Ql(r.x))&&(Ut(r.y)||Ql(r.y))?Dn({x:o+Rs(r.x,v),y:l+Rs(r.y,d),textAnchor:"end",verticalAnchor:"end"},D):Dn({x:j,y:l+d/2,textAnchor:"middle",verticalAnchor:"middle"},D)},hDe={angle:0,offset:5,zIndex:Gn.label,position:"middle",textBreakAll:!1};function Qc(e){var t=Qn(e,hDe),{viewBox:n,position:s,value:r,children:i,content:o,className:l="",textBreakAll:c,labelRef:u}=t,d=lDe(),h=_X(),p=s==="center"?h:d??h,x,v,j;if(n==null?x=p:ME(n)?x=n:x=SQ(n),!x||fn(r)&&fn(i)&&!f.isValidElement(o)&&typeof o!="function")return null;var y=Dn(Dn({},t),{},{viewBox:x});if(f.isValidElement(o)){var{labelRef:N}=y,w=MU(y,eDe);return f.cloneElement(o,w)}if(typeof o=="function"){var{content:S}=y,_=MU(y,tDe);if(v=f.createElement(o,_),f.isValidElement(v))return v}else v=cDe(t);var k=Ys(t);if(ME(x)){if(s==="insideStart"||s==="insideEnd"||s==="end")return uDe(t,s,v,k,x);j=mDe(x,t.offset,t.position)}else j=fDe(t,x);return f.createElement(Sr,{zIndex:t.zIndex},f.createElement(f1,kl({ref:u,className:$t("recharts-label",l)},k,j,{textAnchor:QPe(k.textAnchor)?k.textAnchor:j.textAnchor,breakAll:c}),v))}Qc.displayName="Label";var gDe=(e,t,n)=>{if(!e)return null;var s={viewBox:t,labelRef:n};return e===!0?f.createElement(Qc,kl({key:"label-implicit"},s)):Ho(e)?f.createElement(Qc,kl({key:"label-implicit",value:e},s)):f.isValidElement(e)?e.type===Qc?f.cloneElement(e,Dn({key:"label-implicit"},s)):f.createElement(Qc,kl({key:"label-implicit",content:e},s)):LD(e)?f.createElement(Qc,kl({key:"label-implicit",content:e},s)):e&&typeof e=="object"?f.createElement(Qc,kl({},e,{key:"label-implicit"},s)):null};function pDe(e){var{label:t,labelRef:n}=e,s=_X();return gDe(t,s,n)||null}var Z_={},J_={},$U;function xDe(){return $U||($U=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return n[n.length-1]}e.last=t})(J_)),J_}var eA={},RU;function yDe(){return RU||(RU=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return Array.isArray(n)?n:Array.from(n)}e.toArray=t})(eA)),eA}var zU;function bDe(){return zU||(zU=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=xDe(),n=yDe(),s=_P();function r(i){if(s.isArrayLike(i))return t.last(n.toArray(i))}e.last=r})(Z_)),Z_}var tA,FU;function vDe(){return FU||(FU=1,tA=bDe().last),tA}var wDe=vDe();const jDe=ao(wDe);var NDe=["valueAccessor"],CDe=["dataKey","clockWise","id","textBreakAll","zIndex"];function Pw(){return Pw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Pw.apply(null,arguments)}function UU(e,t){if(e==null)return{};var n,s,r=SDe(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)n=i[s],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function SDe(e,t){if(e==null)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;n[s]=e[s]}return n}var _De=e=>Array.isArray(e.value)?jDe(e.value):e.value,AX=f.createContext(void 0),TX=AX.Provider,kX=f.createContext(void 0),ADe=kX.Provider;function TDe(){return f.useContext(AX)}function kDe(){return f.useContext(kX)}function vv(e){var{valueAccessor:t=_De}=e,n=UU(e,NDe),{dataKey:s,clockWise:r,id:i,textBreakAll:o,zIndex:l}=n,c=UU(n,CDe),u=TDe(),d=kDe(),h=u||d;return!h||!h.length?null:f.createElement(Sr,{zIndex:l??Gn.label},f.createElement(ys,{className:"recharts-label-list"},h.map((p,x)=>{var v,j=fn(s)?t(p,x):qa(p&&p.payload,s),y=fn(i)?{}:{id:"".concat(i,"-").concat(x)};return f.createElement(Qc,Pw({key:"label-".concat(x)},Ys(p),c,y,{fill:(v=n.fill)!==null&&v!==void 0?v:p.fill,parentViewBox:p.parentViewBox,value:j,textBreakAll:o,viewBox:p.viewBox,index:x,zIndex:0}))})))}vv.displayName="LabelList";function PD(e){var{label:t}=e;return t?t===!0?f.createElement(vv,{key:"labelList-implicit"}):f.isValidElement(t)||LD(t)?f.createElement(vv,{key:"labelList-implicit",content:t}):typeof t=="object"?f.createElement(vv,Pw({key:"labelList-implicit"},t,{type:String(t.type)})):null:null}function IE(){return IE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},IE.apply(null,arguments)}var EX=e=>{var{cx:t,cy:n,r:s,className:r}=e,i=$t("recharts-dot",r);return Ut(t)&&Ut(n)&&Ut(s)?f.createElement("circle",IE({},qr(e),SP(e),{className:i,cx:t,cy:n,r:s})):null},LX=e=>e.graphicalItems.polarItems,EDe=ut([pn,l0],eD),h1=ut([LX,bn,EDe],tD),LDe=ut([h1],aD),g1=ut([LDe,e1],nD),PDe=ut([g1,bn,h1],rD);ut([g1,bn,h1],(e,t,n)=>n.length>0?e.flatMap(s=>n.flatMap(r=>{var i,o=qa(s,(i=t.dataKey)!==null&&i!==void 0?i:r.dataKey);return{value:o,errorDomain:[]}})).filter(Boolean):t?.dataKey!=null?e.map(s=>({value:qa(s,t.dataKey),errorDomain:[]})):e.map(s=>({value:s,errorDomain:[]})));var BU=()=>{},DDe=ut([g1,bn,h1,l1,pn],cD),ODe=ut([bn,oD,lD,BU,DDe,BU,ja,pn],dD),PX=ut([bn,ja,g1,PDe,o0,pn,ODe],uD),MDe=ut([PX,bn,bh],hD);ut([bn,PX,MDe,pn],pD);var IDe={radiusAxis:{},angleAxis:{}},DX=Cr({name:"polarAxis",initialState:IDe,reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis:YVe,removeRadiusAxis:QVe,addAngleAxis:KVe,removeAngleAxis:XVe}=DX.actions,$De=DX.reducer;function HU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function qU(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?HU(Object(n),!0).forEach(function(s){RDe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):HU(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function RDe(e,t,n){return(t=zDe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function zDe(e){var t=FDe(e,"string");return typeof t=="symbol"?t:t+""}function FDe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var UDe=(e,t)=>t,DD=ut([LX,UDe],(e,t)=>e.filter(n=>n.type==="pie").find(n=>n.id===t)),BDe=[],OD=(e,t,n)=>n?.length===0?BDe:n,OX=ut([e1,DD,OD],(e,t,n)=>{var{chartData:s}=e;if(t!=null){var r;if(t?.data!=null&&t.data.length>0?r=t.data:r=s,(!r||!r.length)&&n!=null&&(r=n.map(i=>qU(qU({},t.presentationProps),i.props))),r!=null)return r}}),HDe=ut([OX,DD,OD],(e,t,n)=>{if(!(e==null||t==null))return e.map((s,r)=>{var i,o=qa(s,t.nameKey,t.name),l;return n!=null&&(i=n[r])!==null&&i!==void 0&&(i=i.props)!==null&&i!==void 0&&i.fill?l=n[r].props.fill:typeof s=="object"&&s!=null&&"fill"in s?l=s.fill:l=t.fill,{value:fh(o,t.dataKey),color:l,payload:s,type:t.legendType}})}),qDe=ut([OX,DD,OD,ls],(e,t,n,s)=>{if(!(t==null||e==null))return H3e({offset:s,pieSettings:t,displayedData:e,cells:n})}),GU=e=>typeof e=="string"?e:e?e.displayName||e.name||"Component":"",WU=null,aA=null,MX=e=>{if(e===WU&&Array.isArray(aA))return aA;var t=[];return f.Children.forEach(e,n=>{fn(n)||(_L.isFragment(n)?t=t.concat(MX(n.props.children)):t.push(n))}),aA=t,WU=e,t};function MD(e,t){var n=[],s=[];return Array.isArray(t)?s=t.map(r=>GU(r)):s=[GU(t)],MX(e).forEach(r=>{var i=Fu(r,"type.displayName")||Fu(r,"type.name");i&&s.indexOf(i)!==-1&&n.push(r)}),n}var IX=e=>e&&typeof e=="object"&&"clipDot"in e?!!e.clipDot:!0,nA={},VU;function GDe(){return VU||(VU=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){if(typeof n!="object"||n==null)return!1;if(Object.getPrototypeOf(n)===null)return!0;if(Object.prototype.toString.call(n)!=="[object Object]"){const r=n[Symbol.toStringTag];return r==null||!Object.getOwnPropertyDescriptor(n,Symbol.toStringTag)?.writable?!1:n.toString()===`[object ${r}]`}let s=n;for(;Object.getPrototypeOf(s)!==null;)s=Object.getPrototypeOf(s);return Object.getPrototypeOf(n)===s}e.isPlainObject=t})(nA)),nA}var sA,YU;function WDe(){return YU||(YU=1,sA=GDe().isPlainObject),sA}var VDe=WDe();const YDe=ao(VDe);var QU,KU,XU,ZU,JU;function e7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function t7(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?e7(Object(n),!0).forEach(function(s){QDe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):e7(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function QDe(e,t,n){return(t=KDe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function KDe(e){var t=XDe(e,"string");return typeof t=="symbol"?t:t+""}function XDe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Dw(){return Dw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Dw.apply(null,arguments)}function Ag(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var a7=(e,t,n,s,r)=>{var i=n-s,o;return o=Cn(QU||(QU=Ag(["M ",",",""])),e,t),o+=Cn(KU||(KU=Ag(["L ",",",""])),e+n,t),o+=Cn(XU||(XU=Ag(["L ",",",""])),e+n-i/2,t+r),o+=Cn(ZU||(ZU=Ag(["L ",",",""])),e+n-i/2-s,t+r),o+=Cn(JU||(JU=Ag(["L ",","," Z"])),e,t),o},ZDe={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},JDe=e=>{var t=Qn(e,ZDe),{x:n,y:s,upperWidth:r,lowerWidth:i,height:o,className:l}=t,{animationEasing:c,animationDuration:u,animationBegin:d,isUpdateAnimationActive:h}=t,p=f.useRef(null),[x,v]=f.useState(-1),j=f.useRef(r),y=f.useRef(i),N=f.useRef(o),w=f.useRef(n),S=f.useRef(s),_=i0(e,"trapezoid-");if(f.useEffect(()=>{if(p.current&&p.current.getTotalLength)try{var B=p.current.getTotalLength();B&&v(B)}catch{}},[]),n!==+n||s!==+s||r!==+r||i!==+i||o!==+o||r===0&&i===0||o===0)return null;var k=$t("recharts-trapezoid",l);if(!h)return f.createElement("g",null,f.createElement("path",Dw({},Ys(t),{className:k,d:a7(n,s,r,i,o)})));var T=j.current,A=y.current,E=N.current,M=w.current,z=S.current,P="0px ".concat(x===-1?1:x,"px"),D="".concat(x,"px 0px"),U=zQ(["strokeDasharray"],u,c);return f.createElement(r0,{animationId:_,key:_,canBegin:x>0,duration:u,easing:c,isActive:h,begin:d},B=>{var R=dn(T,r,B),q=dn(A,i,B),Z=dn(E,o,B),V=dn(M,n,B),oe=dn(z,s,B);p.current&&(j.current=R,y.current=q,N.current=Z,w.current=V,S.current=oe);var je=B>0?{transition:U,strokeDasharray:D}:{strokeDasharray:P};return f.createElement("path",Dw({},Ys(t),{className:k,d:a7(V,oe,R,q,Z),ref:p,style:t7(t7({},je),t.style)}))})},e3e=["option","shapeType","activeClassName"];function t3e(e,t){if(e==null)return{};var n,s,r=a3e(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)n=i[s],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function a3e(e,t){if(e==null)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;n[s]=e[s]}return n}function n7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function Ow(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?n7(Object(n),!0).forEach(function(s){n3e(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):n7(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function n3e(e,t,n){return(t=s3e(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s3e(e){var t=r3e(e,"string");return typeof t=="symbol"?t:t+""}function r3e(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function i3e(e,t){return Ow(Ow({},t),e)}function o3e(e,t){return e==="symbols"}function s7(e){var{shapeType:t,elementProps:n}=e;switch(t){case"rectangle":return f.createElement(HQ,n);case"trapezoid":return f.createElement(JDe,n);case"sector":return f.createElement(VQ,n);case"symbols":if(o3e(t))return f.createElement(CP,n);break;case"curve":return f.createElement(BP,n);default:return null}}function l3e(e){return f.isValidElement(e)?e.props:e}function ID(e){var{option:t,shapeType:n,activeClassName:s="recharts-active-shape"}=e,r=t3e(e,e3e),i;if(f.isValidElement(t))i=f.cloneElement(t,Ow(Ow({},r),l3e(t)));else if(typeof t=="function")i=t(r,r.index);else if(YDe(t)&&typeof t!="boolean"){var o=i3e(t,r);i=f.createElement(s7,{shapeType:n,elementProps:o})}else{var l=r;i=f.createElement(s7,{shapeType:n,elementProps:l})}return r.isActive?f.createElement(ys,{className:s},i):i}var $D=(e,t,n)=>{var s=en();return(r,i)=>o=>{e?.(r,i,o),s(YK({activeIndex:String(i),activeDataKey:t,activeCoordinate:r.tooltipPosition,activeGraphicalItemId:n}))}},RD=e=>{var t=en();return(n,s)=>r=>{e?.(n,s,r),t(yLe())}},zD=(e,t,n)=>{var s=en();return(r,i)=>o=>{e?.(r,i,o),s(bLe({activeIndex:String(i),activeDataKey:t,activeCoordinate:r.tooltipPosition,activeGraphicalItemId:n}))}};function FD(e){var{tooltipEntrySettings:t}=e,n=en(),s=Hs(),r=f.useRef(null);return f.useLayoutEffect(()=>{s||(r.current===null?n(hLe(t)):r.current!==t&&n(gLe({prev:r.current,next:t})),r.current=t)},[t,n,s]),f.useLayoutEffect(()=>()=>{r.current&&(n(pLe(r.current)),r.current=null)},[n]),null}function $X(e){var{legendPayload:t}=e,n=en(),s=Hs(),r=f.useRef(null);return f.useLayoutEffect(()=>{s||(r.current===null?n(OQ(t)):r.current!==t&&n(MQ({prev:r.current,next:t})),r.current=t)},[n,s,t]),f.useLayoutEffect(()=>()=>{r.current&&(n(IQ(r.current)),r.current=null)},[n]),null}function c3e(e){var{legendPayload:t}=e,n=en(),s=Bt(ja),r=f.useRef(null);return f.useLayoutEffect(()=>{s!=="centric"&&s!=="radial"||(r.current===null?n(OQ(t)):r.current!==t&&n(MQ({prev:r.current,next:t})),r.current=t)},[n,s,t]),f.useLayoutEffect(()=>()=>{r.current&&(n(IQ(r.current)),r.current=null)},[n]),null}var rA,d3e=()=>{var[e]=f.useState(()=>$p("uid-"));return e},u3e=(rA=ku.useId)!==null&&rA!==void 0?rA:d3e;function m3e(e,t){var n=u3e();return t||(e?"".concat(e,"-").concat(n):n)}var f3e=f.createContext(void 0),UD=e=>{var{id:t,type:n,children:s}=e,r=m3e("recharts-".concat(n),t);return f.createElement(f3e.Provider,{value:r},s(r))},h3e={cartesianItems:[],polarItems:[]},RX=Cr({name:"graphicalItems",initialState:h3e,reducers:{addCartesianGraphicalItem:{reducer(e,t){e.cartesianItems.push(t.payload)},prepare:cn()},replaceCartesianGraphicalItem:{reducer(e,t){var{prev:n,next:s}=t.payload,r=Vi(e).cartesianItems.indexOf(n);r>-1&&(e.cartesianItems[r]=s)},prepare:cn()},removeCartesianGraphicalItem:{reducer(e,t){var n=Vi(e).cartesianItems.indexOf(t.payload);n>-1&&e.cartesianItems.splice(n,1)},prepare:cn()},addPolarGraphicalItem:{reducer(e,t){e.polarItems.push(t.payload)},prepare:cn()},removePolarGraphicalItem:{reducer(e,t){var n=Vi(e).polarItems.indexOf(t.payload);n>-1&&e.polarItems.splice(n,1)},prepare:cn()}}}),{addCartesianGraphicalItem:g3e,replaceCartesianGraphicalItem:p3e,removeCartesianGraphicalItem:x3e,addPolarGraphicalItem:y3e,removePolarGraphicalItem:b3e}=RX.actions,v3e=RX.reducer,w3e=e=>{var t=en(),n=f.useRef(null);return f.useLayoutEffect(()=>{n.current===null?t(g3e(e)):n.current!==e&&t(p3e({prev:n.current,next:e})),n.current=e},[t,e]),f.useLayoutEffect(()=>()=>{n.current&&(t(x3e(n.current)),n.current=null)},[t]),null},zX=f.memo(w3e);function j3e(e){var t=en();return f.useLayoutEffect(()=>(t(y3e(e)),()=>{t(b3e(e))}),[t,e]),null}var N3e=["key"],C3e=["onMouseEnter","onClick","onMouseLeave"],S3e=["id"],_3e=["id"];function r7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function Sn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?r7(Object(n),!0).forEach(function(s){A3e(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r7(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function A3e(e,t,n){return(t=T3e(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function T3e(e){var t=k3e(e,"string");return typeof t=="symbol"?t:t+""}function k3e(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wd(){return wd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},wd.apply(null,arguments)}function p1(e,t){if(e==null)return{};var n,s,r=E3e(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)n=i[s],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function E3e(e,t){if(e==null)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;n[s]=e[s]}return n}function L3e(e){var t=f.useMemo(()=>MD(e.children,m1),[e.children]),n=Bt(s=>HDe(s,e.id,t));return n==null?null:f.createElement(c3e,{legendPayload:n})}var P3e=f.memo(e=>{var{dataKey:t,nameKey:n,sectors:s,stroke:r,strokeWidth:i,fill:o,name:l,hide:c,tooltipType:u,id:d}=e,h={dataDefinedOnItem:s.map(p=>p.tooltipPayload),positions:s.map(p=>p.tooltipPosition),settings:{stroke:r,strokeWidth:i,fill:o,dataKey:t,nameKey:n,name:fh(l,t),hide:c,type:u,color:o,unit:"",graphicalItemId:d}};return f.createElement(FD,{tooltipEntrySettings:h})}),D3e=(e,t)=>e>t?"start":e<t?"end":"middle",O3e=(e,t,n)=>Rs(typeof t=="function"?t(e):t,n,n*.8),M3e=(e,t,n)=>{var{top:s,left:r,width:i,height:o}=t,l=qQ(i,o),c=r+Rs(e.cx,i,i/2),u=s+Rs(e.cy,o,o/2),d=Rs(e.innerRadius,l,0),h=O3e(n,e.outerRadius,l),p=e.maxRadius||Math.sqrt(i*i+o*o)/2;return{cx:c,cy:u,innerRadius:d,outerRadius:h,maxRadius:p}},I3e=(e,t)=>{var n=xs(t-e),s=Math.min(Math.abs(t-e),360);return n*s};function $3e(e){return e&&typeof e=="object"&&"className"in e&&typeof e.className=="string"?e.className:""}var R3e=(e,t)=>{if(f.isValidElement(e))return f.cloneElement(e,t);if(typeof e=="function")return e(t);var n=$t("recharts-pie-label-line",typeof e!="boolean"?e.className:""),{key:s}=t,r=p1(t,N3e);return f.createElement(BP,wd({},r,{type:"linear",className:n}))},z3e=(e,t,n)=>{if(f.isValidElement(e))return f.cloneElement(e,t);var s=n;if(typeof e=="function"&&(s=e(t),f.isValidElement(s)))return s;var r=$t("recharts-pie-label-text",$3e(e));return f.createElement(f1,wd({},t,{alignmentBaseline:"middle",className:r}),s)};function F3e(e){var{sectors:t,props:n,showLabels:s}=e,{label:r,labelLine:i,dataKey:o}=n;if(!s||!r||!t)return null;var l=qr(n),c=zu(r),u=zu(i),d=typeof r=="object"&&"offsetRadius"in r&&typeof r.offsetRadius=="number"&&r.offsetRadius||20,h=t.map((p,x)=>{var v=(p.startAngle+p.endAngle)/2,j=qn(p.cx,p.cy,p.outerRadius+d,v),y=Sn(Sn(Sn(Sn({},l),p),{},{stroke:"none"},c),{},{index:x,textAnchor:D3e(j.x,p.cx)},j),N=Sn(Sn(Sn(Sn({},l),p),{},{fill:"none",stroke:p.fill},u),{},{index:x,points:[qn(p.cx,p.cy,p.outerRadius,v),j],key:"line"});return f.createElement(Sr,{zIndex:Gn.label,key:"label-".concat(p.startAngle,"-").concat(p.endAngle,"-").concat(p.midAngle,"-").concat(x)},f.createElement(ys,null,i&&R3e(i,N),z3e(r,y,qa(p,o))))});return f.createElement(ys,{className:"recharts-pie-labels"},h)}function U3e(e){var{sectors:t,props:n,showLabels:s}=e,{label:r}=n;return typeof r=="object"&&r!=null&&"position"in r?f.createElement(PD,{label:r}):f.createElement(F3e,{sectors:t,props:n,showLabels:s})}function B3e(e){var{sectors:t,activeShape:n,inactiveShape:s,allOtherPieProps:r,shape:i,id:o}=e,l=Bt(vd),c=Bt(SD),u=Bt(s4e),{onMouseEnter:d,onClick:h,onMouseLeave:p}=r,x=p1(r,C3e),v=$D(d,r.dataKey,o),j=RD(p),y=zD(h,r.dataKey,o);return t==null||t.length===0?null:f.createElement(f.Fragment,null,t.map((N,w)=>{if(N?.startAngle===0&&N?.endAngle===0&&t.length!==1)return null;var S=u==null||u===o,_=String(w)===l&&(c==null||r.dataKey===c)&&S,k=l?s:null,T=n&&_?n:k,A=Sn(Sn({},N),{},{stroke:N.stroke,tabIndex:-1,[vQ]:w,[wQ]:o});return f.createElement(ys,wd({key:"sector-".concat(N?.startAngle,"-").concat(N?.endAngle,"-").concat(N.midAngle,"-").concat(w),tabIndex:-1,className:"recharts-pie-sector"},Jx(x,N,w),{onMouseEnter:v(N,w),onMouseLeave:j(N,w),onClick:y(N,w)}),f.createElement(ID,wd({option:i??T,index:w,shapeType:"sector",isActive:_},A)))}))}function H3e(e){var t,{pieSettings:n,displayedData:s,cells:r,offset:i}=e,{cornerRadius:o,startAngle:l,endAngle:c,dataKey:u,nameKey:d,tooltipType:h}=n,p=Math.abs(n.minAngle),x=I3e(l,c),v=Math.abs(x),j=s.length<=1?0:(t=n.paddingAngle)!==null&&t!==void 0?t:0,y=s.filter(T=>qa(T,u,0)!==0).length,N=(v>=360?y:y-1)*j,w=v-y*p-N,S=s.reduce((T,A)=>{var E=qa(A,u,0);return T+(Ut(E)?E:0)},0),_;if(S>0){var k;_=s.map((T,A)=>{var E=qa(T,u,0),M=qa(T,d,A),z=M3e(n,i,T),P=(Ut(E)?E:0)/S,D,U=Sn(Sn({},T),r&&r[A]&&r[A].props);A?D=k.endAngle+xs(x)*j*(E!==0?1:0):D=l;var B=D+xs(x)*((E!==0?p:0)+P*w),R=(D+B)/2,q=(z.innerRadius+z.outerRadius)/2,Z=[{name:M,value:E,payload:U,dataKey:u,type:h,graphicalItemId:n.id}],V=qn(z.cx,z.cy,q,R);return k=Sn(Sn(Sn(Sn({},n.presentationProps),{},{percent:P,cornerRadius:typeof o=="string"?parseFloat(o):o,name:M,tooltipPayload:Z,midAngle:R,middleRadius:q,tooltipPosition:V},U),z),{},{value:E,dataKey:u,startAngle:D,endAngle:B,payload:U,paddingAngle:xs(x)*j}),k})}return _}function q3e(e){var{showLabels:t,sectors:n,children:s}=e,r=f.useMemo(()=>!t||!n?[]:n.map(i=>({value:i.value,payload:i.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:i.cx,cy:i.cy,innerRadius:i.innerRadius,outerRadius:i.outerRadius,startAngle:i.startAngle,endAngle:i.endAngle,clockWise:!1},fill:i.fill})),[n,t]);return f.createElement(ADe,{value:t?r:void 0},s)}function G3e(e){var{props:t,previousSectorsRef:n,id:s}=e,{sectors:r,isAnimationActive:i,animationBegin:o,animationDuration:l,animationEasing:c,activeShape:u,inactiveShape:d,onAnimationStart:h,onAnimationEnd:p}=t,x=i0(t,"recharts-pie-"),v=n.current,[j,y]=f.useState(!1),N=f.useCallback(()=>{typeof p=="function"&&p(),y(!1)},[p]),w=f.useCallback(()=>{typeof h=="function"&&h(),y(!0)},[h]);return f.createElement(q3e,{showLabels:!j,sectors:r},f.createElement(r0,{animationId:x,begin:o,duration:l,isActive:i,easing:c,onAnimationStart:w,onAnimationEnd:N,key:x},S=>{var _=[],k=r&&r[0],T=k?.startAngle;return r?.forEach((A,E)=>{var M=v&&v[E],z=E>0?Fu(A,"paddingAngle",0):0;if(M){var P=dn(M.endAngle-M.startAngle,A.endAngle-A.startAngle,S),D=Sn(Sn({},A),{},{startAngle:T+z,endAngle:T+P+z});_.push(D),T=D.endAngle}else{var{endAngle:U,startAngle:B}=A,R=dn(0,U-B,S),q=Sn(Sn({},A),{},{startAngle:T+z,endAngle:T+R+z});_.push(q),T=q.endAngle}}),n.current=_,f.createElement(ys,null,f.createElement(B3e,{sectors:_,activeShape:u,inactiveShape:d,allOtherPieProps:t,shape:t.shape,id:s}))}),f.createElement(U3e,{showLabels:!j,sectors:r,props:t}),t.children)}var W3e={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:"auto",label:!1,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff",zIndex:Gn.area};function V3e(e){var{id:t}=e,n=p1(e,S3e),{hide:s,className:r,rootTabIndex:i}=e,o=f.useMemo(()=>MD(e.children,m1),[e.children]),l=Bt(d=>qDe(d,t,o)),c=f.useRef(null),u=$t("recharts-pie",r);return s||l==null?(c.current=null,f.createElement(ys,{tabIndex:i,className:u})):f.createElement(Sr,{zIndex:e.zIndex},f.createElement(P3e,{dataKey:e.dataKey,nameKey:e.nameKey,sectors:l,stroke:e.stroke,strokeWidth:e.strokeWidth,fill:e.fill,name:e.name,hide:e.hide,tooltipType:e.tooltipType,id:t}),f.createElement(ys,{tabIndex:i,className:u},f.createElement(G3e,{props:Sn(Sn({},n),{},{sectors:l}),previousSectorsRef:c,id:t})))}function FX(e){var t=Qn(e,W3e),{id:n}=t,s=p1(t,_3e),r=qr(s);return f.createElement(UD,{id:n,type:"pie"},i=>f.createElement(f.Fragment,null,f.createElement(j3e,{type:"pie",id:i,data:s.data,dataKey:s.dataKey,hide:s.hide,angleAxisId:0,radiusAxisId:0,name:s.name,nameKey:s.nameKey,tooltipType:s.tooltipType,legendType:s.legendType,fill:s.fill,cx:s.cx,cy:s.cy,startAngle:s.startAngle,endAngle:s.endAngle,paddingAngle:s.paddingAngle,minAngle:s.minAngle,innerRadius:s.innerRadius,outerRadius:s.outerRadius,cornerRadius:s.cornerRadius,presentationProps:r,maxRadius:t.maxRadius}),f.createElement(L3e,wd({},s,{id:i})),f.createElement(V3e,wd({},s,{id:i}))))}FX.displayName="Pie";var Y3e=["points"];function i7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function iA(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?i7(Object(n),!0).forEach(function(s){Q3e(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i7(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function Q3e(e,t,n){return(t=K3e(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function K3e(e){var t=X3e(e,"string");return typeof t=="symbol"?t:t+""}function X3e(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Mw(){return Mw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Mw.apply(null,arguments)}function Z3e(e,t){if(e==null)return{};var n,s,r=J3e(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)n=i[s],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function J3e(e,t){if(e==null)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;n[s]=e[s]}return n}function e5e(e){var{option:t,dotProps:n,className:s}=e;if(f.isValidElement(t))return f.cloneElement(t,n);if(typeof t=="function")return t(n);var r=$t(s,typeof t!="boolean"?t.className:""),i=n??{},{points:o}=i,l=Z3e(i,Y3e);return f.createElement(EX,Mw({},l,{className:r}))}function t5e(e,t){return e==null?!1:t?!0:e.length===1}function a5e(e){var{points:t,dot:n,className:s,dotClassName:r,dataKey:i,baseProps:o,needClip:l,clipPathId:c,zIndex:u=Gn.scatter}=e;if(!t5e(t,n))return null;var d=IX(n),h=HSe(n),p=t.map((v,j)=>{var y,N,w=iA(iA(iA({r:3},o),h),{},{index:j,cx:(y=v.x)!==null&&y!==void 0?y:void 0,cy:(N=v.y)!==null&&N!==void 0?N:void 0,dataKey:i,value:v.value,payload:v.payload,points:t});return f.createElement(e5e,{key:"dot-".concat(j),option:n,dotProps:w,className:r})}),x={};return l&&c!=null&&(x.clipPath="url(#clipPath-".concat(d?"":"dots-").concat(c,")")),f.createElement(Sr,{zIndex:u},f.createElement(ys,Mw({className:s},x),p))}function o7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function l7(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?o7(Object(n),!0).forEach(function(s){n5e(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o7(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function n5e(e,t,n){return(t=s5e(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s5e(e){var t=r5e(e,"string");return typeof t=="symbol"?t:t+""}function r5e(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var UX=0,i5e={xAxis:{},yAxis:{},zAxis:{}},BX=Cr({name:"cartesianAxis",initialState:i5e,reducers:{addXAxis:{reducer(e,t){e.xAxis[t.payload.id]=t.payload},prepare:cn()},replaceXAxis:{reducer(e,t){var{prev:n,next:s}=t.payload;e.xAxis[n.id]!==void 0&&(n.id!==s.id&&delete e.xAxis[n.id],e.xAxis[s.id]=s)},prepare:cn()},removeXAxis:{reducer(e,t){delete e.xAxis[t.payload.id]},prepare:cn()},addYAxis:{reducer(e,t){e.yAxis[t.payload.id]=t.payload},prepare:cn()},replaceYAxis:{reducer(e,t){var{prev:n,next:s}=t.payload;e.yAxis[n.id]!==void 0&&(n.id!==s.id&&delete e.yAxis[n.id],e.yAxis[s.id]=s)},prepare:cn()},removeYAxis:{reducer(e,t){delete e.yAxis[t.payload.id]},prepare:cn()},addZAxis:{reducer(e,t){e.zAxis[t.payload.id]=t.payload},prepare:cn()},replaceZAxis:{reducer(e,t){var{prev:n,next:s}=t.payload;e.zAxis[n.id]!==void 0&&(n.id!==s.id&&delete e.zAxis[n.id],e.zAxis[s.id]=s)},prepare:cn()},removeZAxis:{reducer(e,t){delete e.zAxis[t.payload.id]},prepare:cn()},updateYAxisWidth(e,t){var{id:n,width:s}=t.payload,r=e.yAxis[n];if(r){var i=r.widthHistory||[];if(i.length===3&&i[0]===i[2]&&s===i[1]&&s!==r.width&&Math.abs(s-i[0])<=1)return;var o=[...i,s].slice(-3);e.yAxis[n]=l7(l7({},e.yAxis[n]),{},{width:s,widthHistory:o})}}}}),{addXAxis:o5e,replaceXAxis:l5e,removeXAxis:c5e,addYAxis:d5e,replaceYAxis:u5e,removeYAxis:m5e,addZAxis:ZVe,replaceZAxis:JVe,removeZAxis:eYe,updateYAxisWidth:f5e}=BX.actions,h5e=BX.reducer,g5e=ut([ls],e=>({top:e.top,bottom:e.bottom,left:e.left,right:e.right})),p5e=ut([g5e,oc,lc],(e,t,n)=>{if(!(!e||t==null||n==null))return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,n-e.top-e.bottom)}}),BD=()=>Bt(p5e),x5e=()=>Bt(c4e);function c7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function oA(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?c7(Object(n),!0).forEach(function(s){y5e(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c7(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function y5e(e,t,n){return(t=b5e(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b5e(e){var t=v5e(e,"string");return typeof t=="symbol"?t:t+""}function v5e(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var w5e=e=>{var{point:t,childIndex:n,mainColor:s,activeDot:r,dataKey:i,clipPath:o}=e;if(r===!1||t.x==null||t.y==null)return null;var l={index:n,dataKey:i,cx:t.x,cy:t.y,r:4,fill:s??"none",strokeWidth:2,stroke:"#fff",payload:t.payload,value:t.value},c=oA(oA(oA({},l),zu(r)),SP(r)),u;return f.isValidElement(r)?u=f.cloneElement(r,c):typeof r=="function"?u=r(c):u=f.createElement(EX,c),f.createElement(ys,{className:"recharts-active-dot",clipPath:o},u)};function j5e(e){var{points:t,mainColor:n,activeDot:s,itemDataKey:r,clipPath:i,zIndex:o=Gn.activeDot}=e,l=Bt(vd),c=x5e();if(t==null||c==null)return null;var u=t.find(d=>c.includes(d.payload));return fn(u)?null:f.createElement(Sr,{zIndex:o},f.createElement(w5e,{point:u,childIndex:Number(l),mainColor:n,dataKey:r,activeDot:s,clipPath:i}))}var d7=(e,t,n)=>{var s=n??e;if(!fn(s))return Rs(s,t,0)},N5e=(e,t,n)=>{var s={},r=e.filter(n1),i=e.filter(u=>u.stackId==null),o=r.reduce((u,d)=>(u[d.stackId]||(u[d.stackId]=[]),u[d.stackId].push(d),u),s),l=Object.entries(o).map(u=>{var[d,h]=u,p=h.map(v=>v.dataKey),x=d7(t,n,h[0].barSize);return{stackId:d,dataKeys:p,barSize:x}}),c=i.map(u=>{var d=[u.dataKey].filter(p=>p!=null),h=d7(t,n,u.barSize);return{stackId:void 0,dataKeys:d,barSize:h}});return[...l,...c]};function u7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function gb(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?u7(Object(n),!0).forEach(function(s){C5e(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u7(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function C5e(e,t,n){return(t=S5e(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function S5e(e){var t=_5e(e,"string");return typeof t=="symbol"?t:t+""}function _5e(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function A5e(e,t,n,s,r){var i=s.length;if(!(i<1)){var o=Rs(e,n,0,!0),l,c=[];if(xn(s[0].barSize)){var u=!1,d=n/i,h=s.reduce((N,w)=>N+(w.barSize||0),0);h+=(i-1)*o,h>=n&&(h-=(i-1)*o,o=0),h>=n&&d>0&&(u=!0,d*=.9,h=i*d);var p=(n-h)/2>>0,x={offset:p-o,size:0};l=s.reduce((N,w)=>{var S,_={stackId:w.stackId,dataKeys:w.dataKeys,position:{offset:x.offset+x.size+o,size:u?d:(S=w.barSize)!==null&&S!==void 0?S:0}},k=[...N,_];return x=k[k.length-1].position,k},c)}else{var v=Rs(t,n,0,!0);n-2*v-(i-1)*o<=0&&(o=0);var j=(n-2*v-(i-1)*o)/i;j>1&&(j>>=0);var y=xn(r)?Math.min(j,r):j;l=s.reduce((N,w,S)=>[...N,{stackId:w.stackId,dataKeys:w.dataKeys,position:{offset:v+(j+o)*S+(j-y)/2,size:y}}],c)}return l}}var T5e=(e,t,n,s,r,i,o)=>{var l=fn(o)?t:o,c=A5e(n,s,r!==i?r:i,e,l);return r!==i&&c!=null&&(c=c.map(u=>gb(gb({},u),{},{position:gb(gb({},u.position),{},{offset:u.position.offset-r/2})}))),c},k5e=(e,t)=>{var n=ZP(t);if(!(!e||n==null||t==null)){var{stackId:s}=t;if(s!=null){var r=e[s];if(r){var{stackedData:i}=r;if(i)return i.find(o=>o.key===n)}}}};function E5e(e,t){return e&&typeof e=="object"&&"zIndex"in e&&typeof e.zIndex=="number"&&xn(e.zIndex)?e.zIndex:t}var HX=e=>{var{chartData:t}=e,n=en(),s=Hs();return f.useEffect(()=>s?()=>{}:(n(vU(t)),()=>{n(vU(void 0))}),[t,n,s]),null},m7={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},qX=Cr({name:"brush",initialState:m7,reducers:{setBrushSettings(e,t){return t.payload==null?m7:t.payload}}}),{setBrushSettings:tYe}=qX.actions,L5e=qX.reducer;function P5e(e,t,n){return(t=D5e(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function D5e(e){var t=O5e(e,"string");return typeof t=="symbol"?t:t+""}function O5e(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class HD{static create(t){return new HD(t)}constructor(t){this.scale=t}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(t){var{bandAware:n,position:s}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t!==void 0){if(s)switch(s){case"start":return this.scale(t);case"middle":{var r=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+r}case"end":{var i=this.bandwidth?this.bandwidth():0;return this.scale(t)+i}default:return this.scale(t)}if(n){var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+o}return this.scale(t)}}isInRange(t){var n=this.range(),s=n[0],r=n[n.length-1];return s<=r?t>=s&&t<=r:t>=r&&t<=s}}P5e(HD,"EPS",1e-4);function M5e(e){return(e%180+180)%180}var I5e=function(t){var{width:n,height:s}=t,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=M5e(r),o=i*Math.PI/180,l=Math.atan(s/n),c=o>l&&o<Math.PI-l?s/Math.sin(o):n/Math.cos(o);return Math.abs(c)},$5e={dots:[],areas:[],lines:[]},GX=Cr({name:"referenceElements",initialState:$5e,reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var n=Vi(e).dots.findIndex(s=>s===t.payload);n!==-1&&e.dots.splice(n,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var n=Vi(e).areas.findIndex(s=>s===t.payload);n!==-1&&e.areas.splice(n,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var n=Vi(e).lines.findIndex(s=>s===t.payload);n!==-1&&e.lines.splice(n,1)}}}),{addDot:aYe,removeDot:nYe,addArea:sYe,removeArea:rYe,addLine:iYe,removeLine:oYe}=GX.actions,R5e=GX.reducer,z5e=f.createContext(void 0),F5e=e=>{var{children:t}=e,[n]=f.useState("".concat($p("recharts"),"-clip")),s=BD();if(s==null)return null;var{x:r,y:i,width:o,height:l}=s;return f.createElement(z5e.Provider,{value:n},f.createElement("defs",null,f.createElement("clipPath",{id:n},f.createElement("rect",{x:r,y:i,height:l,width:o}))),t)};function WX(e,t){if(t<1)return[];if(t===1)return e;for(var n=[],s=0;s<e.length;s+=t){var r=e[s];r!==void 0&&n.push(r)}return n}function U5e(e,t,n){var s={width:e.width+t.width,height:e.height+t.height};return I5e(s,n)}function B5e(e,t,n){var s=n==="width",{x:r,y:i,width:o,height:l}=e;return t===1?{start:s?r:i,end:s?r+o:i+l}:{start:s?r+o:i+l,end:s?r:i}}function Vp(e,t,n,s,r){if(e*t<e*s||e*t>e*r)return!1;var i=n();return e*(t-e*i/2-s)>=0&&e*(t+e*i/2-r)<=0}function H5e(e,t){return WX(e,t+1)}function q5e(e,t,n,s,r){for(var i=(s||[]).slice(),{start:o,end:l}=t,c=0,u=1,d=o,h=function(){var v=s?.[c];if(v===void 0)return{v:WX(s,u)};var j=c,y,N=()=>(y===void 0&&(y=n(v,j)),y),w=v.coordinate,S=c===0||Vp(e,w,N,d,l);S||(c=0,d=o,u+=1),S&&(d=w+e*(N()/2+r),c+=u)},p;u<=i.length;)if(p=h(),p)return p.v;return[]}function G5e(e,t,n,s,r){var i=(s||[]).slice(),o=i.length;if(o===0)return[];for(var{start:l,end:c}=t,u=1;u<=o;u++){for(var d=(o-1)%u,h=l,p=!0,x=function(){var w=s[v],S=v,_,k=()=>(_===void 0&&(_=n(w,S)),_),T=w.coordinate,A=v===d||Vp(e,T,k,h,c);if(!A)return p=!1,1;A&&(h=T+e*(k()/2+r))},v=d;v<o&&!x();v+=u);if(p){for(var j=[],y=d;y<o;y+=u)j.push(s[y]);return j}}return[]}function f7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function Ds(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?f7(Object(n),!0).forEach(function(s){W5e(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f7(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function W5e(e,t,n){return(t=V5e(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function V5e(e){var t=Y5e(e,"string");return typeof t=="symbol"?t:t+""}function Y5e(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Q5e(e,t,n,s,r){for(var i=(s||[]).slice(),o=i.length,{start:l}=t,{end:c}=t,u=function(p){var x=i[p],v,j=()=>(v===void 0&&(v=n(x,p)),v);if(p===o-1){var y=e*(x.coordinate+e*j()/2-c);i[p]=x=Ds(Ds({},x),{},{tickCoord:y>0?x.coordinate-y*e:x.coordinate})}else i[p]=x=Ds(Ds({},x),{},{tickCoord:x.coordinate});if(x.tickCoord!=null){var N=Vp(e,x.tickCoord,j,l,c);N&&(c=x.tickCoord-e*(j()/2+r),i[p]=Ds(Ds({},x),{},{isShow:!0}))}},d=o-1;d>=0;d--)u(d);return i}function K5e(e,t,n,s,r,i){var o=(s||[]).slice(),l=o.length,{start:c,end:u}=t;if(i){var d=s[l-1],h=n(d,l-1),p=e*(d.coordinate+e*h/2-u);if(o[l-1]=d=Ds(Ds({},d),{},{tickCoord:p>0?d.coordinate-p*e:d.coordinate}),d.tickCoord!=null){var x=Vp(e,d.tickCoord,()=>h,c,u);x&&(u=d.tickCoord-e*(h/2+r),o[l-1]=Ds(Ds({},d),{},{isShow:!0}))}}for(var v=i?l-1:l,j=function(w){var S=o[w],_,k=()=>(_===void 0&&(_=n(S,w)),_);if(w===0){var T=e*(S.coordinate-e*k()/2-c);o[w]=S=Ds(Ds({},S),{},{tickCoord:T<0?S.coordinate-T*e:S.coordinate})}else o[w]=S=Ds(Ds({},S),{},{tickCoord:S.coordinate});if(S.tickCoord!=null){var A=Vp(e,S.tickCoord,k,c,u);A&&(c=S.tickCoord+e*(k()/2+r),o[w]=Ds(Ds({},S),{},{isShow:!0}))}},y=0;y<v;y++)j(y);return o}function qD(e,t,n){var{tick:s,ticks:r,viewBox:i,minTickGap:o,orientation:l,interval:c,tickFormatter:u,unit:d,angle:h}=e;if(!r||!r.length||!s)return[];if(Ut(c)||JN.isSsr){var p;return(p=H5e(r,Ut(c)?c:0))!==null&&p!==void 0?p:[]}var x=[],v=l==="top"||l==="bottom"?"width":"height",j=d&&v==="width"?lp(d,{fontSize:t,letterSpacing:n}):{width:0,height:0},y=(S,_)=>{var k=typeof u=="function"?u(S.value,_):S.value;return v==="width"?U5e(lp(k,{fontSize:t,letterSpacing:n}),j,h):lp(k,{fontSize:t,letterSpacing:n})[v]},N=r.length>=2?xs(r[1].coordinate-r[0].coordinate):1,w=B5e(i,N,v);return c==="equidistantPreserveStart"?q5e(N,w,y,r,o):c==="equidistantPreserveEnd"?G5e(N,w,y,r,o):(c==="preserveStart"||c==="preserveStartEnd"?x=K5e(N,w,y,r,o,c==="preserveStartEnd"):x=Q5e(N,w,y,r,o),x.filter(S=>S.isShow))}var X5e=e=>{var{ticks:t,label:n,labelGapWithTick:s=5,tickSize:r=0,tickMargin:i=0}=e,o=0;if(t){Array.from(t).forEach(d=>{if(d){var h=d.getBoundingClientRect();h.width>o&&(o=h.width)}});var l=n?n.getBoundingClientRect().width:0,c=r+i,u=o+c+l+(n?s:0);return Math.round(u)}return 0},Z5e=["axisLine","width","height","className","hide","ticks","axisType"];function J5e(e,t){if(e==null)return{};var n,s,r=eOe(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)n=i[s],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function eOe(e,t){if(e==null)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;n[s]=e[s]}return n}function Gu(){return Gu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Gu.apply(null,arguments)}function h7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function Bn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?h7(Object(n),!0).forEach(function(s){tOe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h7(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function tOe(e,t,n){return(t=aOe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function aOe(e){var t=nOe(e,"string");return typeof t=="symbol"?t:t+""}function nOe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Il={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd",zIndex:Gn.axis};function sOe(e){var{x:t,y:n,width:s,height:r,orientation:i,mirror:o,axisLine:l,otherSvgProps:c}=e;if(!l)return null;var u=Bn(Bn(Bn({},c),qr(l)),{},{fill:"none"});if(i==="top"||i==="bottom"){var d=+(i==="top"&&!o||i==="bottom"&&o);u=Bn(Bn({},u),{},{x1:t,y1:n+d*r,x2:t+s,y2:n+d*r})}else{var h=+(i==="left"&&!o||i==="right"&&o);u=Bn(Bn({},u),{},{x1:t+h*s,y1:n,x2:t+h*s,y2:n+r})}return f.createElement("line",Gu({},u,{className:$t("recharts-cartesian-axis-line",Fu(l,"className"))}))}function rOe(e,t,n,s,r,i,o,l,c){var u,d,h,p,x,v,j=l?-1:1,y=e.tickSize||o,N=Ut(e.tickCoord)?e.tickCoord:e.coordinate;switch(i){case"top":u=d=e.coordinate,p=n+ +!l*r,h=p-j*y,v=h-j*c,x=N;break;case"left":h=p=e.coordinate,d=t+ +!l*s,u=d-j*y,x=u-j*c,v=N;break;case"right":h=p=e.coordinate,d=t+ +l*s,u=d+j*y,x=u+j*c,v=N;break;default:u=d=e.coordinate,p=n+ +l*r,h=p+j*y,v=h+j*c,x=N;break}return{line:{x1:u,y1:h,x2:d,y2:p},tick:{x,y:v}}}function iOe(e,t){switch(e){case"left":return t?"start":"end";case"right":return t?"end":"start";default:return"middle"}}function oOe(e,t){switch(e){case"left":case"right":return"middle";case"top":return t?"start":"end";default:return t?"end":"start"}}function lOe(e){var{option:t,tickProps:n,value:s}=e,r,i=$t(n.className,"recharts-cartesian-axis-tick-value");if(f.isValidElement(t))r=f.cloneElement(t,Bn(Bn({},n),{},{className:i}));else if(typeof t=="function")r=t(Bn(Bn({},n),{},{className:i}));else{var o="recharts-cartesian-axis-tick-value";typeof t!="boolean"&&(o=$t(o,t?.className)),r=f.createElement(f1,Gu({},n,{className:o}),s)}return r}var cOe=f.forwardRef((e,t)=>{var{ticks:n=[],tick:s,tickLine:r,stroke:i,tickFormatter:o,unit:l,padding:c,tickTextProps:u,orientation:d,mirror:h,x:p,y:x,width:v,height:j,tickSize:y,tickMargin:N,fontSize:w,letterSpacing:S,getTicksConfig:_,events:k,axisType:T}=e,A=qD(Bn(Bn({},_),{},{ticks:n}),w,S),E=iOe(d,h),M=oOe(d,h),z=qr(_),P=zu(s),D={};typeof r=="object"&&(D=r);var U=Bn(Bn({},z),{},{fill:"none"},D),B=A.map(Z=>Bn({entry:Z},rOe(Z,p,x,v,j,d,y,h,N))),R=B.map(Z=>{var{entry:V,line:oe}=Z;return f.createElement(ys,{className:"recharts-cartesian-axis-tick",key:"tick-".concat(V.value,"-").concat(V.coordinate,"-").concat(V.tickCoord)},r&&f.createElement("line",Gu({},U,oe,{className:$t("recharts-cartesian-axis-tick-line",Fu(r,"className"))})))}),q=B.map((Z,V)=>{var{entry:oe,tick:je}=Z,X=Bn(Bn(Bn(Bn({textAnchor:E,verticalAnchor:M},z),{},{stroke:"none",fill:i},P),je),{},{index:V,payload:oe,visibleTicksCount:A.length,tickFormatter:o,padding:c},u);return f.createElement(ys,Gu({className:"recharts-cartesian-axis-tick-label",key:"tick-label-".concat(oe.value,"-").concat(oe.coordinate,"-").concat(oe.tickCoord)},Jx(k,oe,V)),s&&f.createElement(lOe,{option:s,tickProps:X,value:"".concat(typeof o=="function"?o(oe.value,V):oe.value).concat(l||"")}))});return f.createElement("g",{className:"recharts-cartesian-axis-ticks recharts-".concat(T,"-ticks")},q.length>0&&f.createElement(Sr,{zIndex:Gn.label},f.createElement("g",{className:"recharts-cartesian-axis-tick-labels recharts-".concat(T,"-tick-labels"),ref:t},q)),R.length>0&&f.createElement("g",{className:"recharts-cartesian-axis-tick-lines recharts-".concat(T,"-tick-lines")},R))}),dOe=f.forwardRef((e,t)=>{var{axisLine:n,width:s,height:r,className:i,hide:o,ticks:l,axisType:c}=e,u=J5e(e,Z5e),[d,h]=f.useState(""),[p,x]=f.useState(""),v=f.useRef(null);f.useImperativeHandle(t,()=>({getCalculatedWidth:()=>{var y;return X5e({ticks:v.current,label:(y=e.labelRef)===null||y===void 0?void 0:y.current,labelGapWithTick:5,tickSize:e.tickSize,tickMargin:e.tickMargin})}}));var j=f.useCallback(y=>{if(y){var N=y.getElementsByClassName("recharts-cartesian-axis-tick-value");v.current=N;var w=N[0];if(w){var S=window.getComputedStyle(w),_=S.fontSize,k=S.letterSpacing;(_!==d||k!==p)&&(h(_),x(k))}}},[d,p]);return o||s!=null&&s<=0||r!=null&&r<=0?null:f.createElement(Sr,{zIndex:e.zIndex},f.createElement(ys,{className:$t("recharts-cartesian-axis",i)},f.createElement(sOe,{x:e.x,y:e.y,width:s,height:r,orientation:e.orientation,mirror:e.mirror,axisLine:n,otherSvgProps:qr(e)}),f.createElement(cOe,{ref:j,axisType:c,events:u,fontSize:d,getTicksConfig:e,height:e.height,letterSpacing:p,mirror:e.mirror,orientation:e.orientation,padding:e.padding,stroke:e.stroke,tick:e.tick,tickFormatter:e.tickFormatter,tickLine:e.tickLine,tickMargin:e.tickMargin,tickSize:e.tickSize,tickTextProps:e.tickTextProps,ticks:l,unit:e.unit,width:e.width,x:e.x,y:e.y}),f.createElement(iDe,{x:e.x,y:e.y,width:e.width,height:e.height,lowerWidth:e.width,upperWidth:e.width},f.createElement(pDe,{label:e.label,labelRef:e.labelRef}),e.children)))}),GD=f.forwardRef((e,t)=>{var n=Qn(e,Il);return f.createElement(dOe,Gu({},n,{ref:t}))});GD.displayName="CartesianAxis";var uOe=["x1","y1","x2","y2","key"],mOe=["offset"],fOe=["xAxisId","yAxisId"],hOe=["xAxisId","yAxisId"];function g7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function Os(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?g7(Object(n),!0).forEach(function(s){gOe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g7(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function gOe(e,t,n){return(t=pOe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function pOe(e){var t=xOe(e,"string");return typeof t=="symbol"?t:t+""}function xOe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xu(){return xu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},xu.apply(null,arguments)}function Iw(e,t){if(e==null)return{};var n,s,r=yOe(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)n=i[s],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function yOe(e,t){if(e==null)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;n[s]=e[s]}return n}var bOe=e=>{var{fill:t}=e;if(!t||t==="none")return null;var{fillOpacity:n,x:s,y:r,width:i,height:o,ry:l}=e;return f.createElement("rect",{x:s,y:r,ry:l,width:i,height:o,stroke:"none",fill:t,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function VX(e){var{option:t,lineItemProps:n}=e,s;if(f.isValidElement(t))s=f.cloneElement(t,n);else if(typeof t=="function")s=t(n);else{var r,{x1:i,y1:o,x2:l,y2:c,key:u}=n,d=Iw(n,uOe),h=(r=qr(d))!==null&&r!==void 0?r:{},{offset:p}=h,x=Iw(h,mOe);s=f.createElement("line",xu({},x,{x1:i,y1:o,x2:l,y2:c,fill:"none",key:u}))}return s}function vOe(e){var{x:t,width:n,horizontal:s=!0,horizontalPoints:r}=e;if(!s||!r||!r.length)return null;var{xAxisId:i,yAxisId:o}=e,l=Iw(e,fOe),c=r.map((u,d)=>{var h=Os(Os({},l),{},{x1:t,y1:u,x2:t+n,y2:u,key:"line-".concat(d),index:d});return f.createElement(VX,{key:"line-".concat(d),option:s,lineItemProps:h})});return f.createElement("g",{className:"recharts-cartesian-grid-horizontal"},c)}function wOe(e){var{y:t,height:n,vertical:s=!0,verticalPoints:r}=e;if(!s||!r||!r.length)return null;var{xAxisId:i,yAxisId:o}=e,l=Iw(e,hOe),c=r.map((u,d)=>{var h=Os(Os({},l),{},{x1:u,y1:t,x2:u,y2:t+n,key:"line-".concat(d),index:d});return f.createElement(VX,{option:s,lineItemProps:h,key:"line-".concat(d)})});return f.createElement("g",{className:"recharts-cartesian-grid-vertical"},c)}function jOe(e){var{horizontalFill:t,fillOpacity:n,x:s,y:r,width:i,height:o,horizontalPoints:l,horizontal:c=!0}=e;if(!c||!t||!t.length||l==null)return null;var u=l.map(h=>Math.round(h+r-r)).sort((h,p)=>h-p);r!==u[0]&&u.unshift(0);var d=u.map((h,p)=>{var x=!u[p+1],v=x?r+o-h:u[p+1]-h;if(v<=0)return null;var j=p%t.length;return f.createElement("rect",{key:"react-".concat(p),y:h,x:s,height:v,width:i,stroke:"none",fill:t[j],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return f.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},d)}function NOe(e){var{vertical:t=!0,verticalFill:n,fillOpacity:s,x:r,y:i,width:o,height:l,verticalPoints:c}=e;if(!t||!n||!n.length)return null;var u=c.map(h=>Math.round(h+r-r)).sort((h,p)=>h-p);r!==u[0]&&u.unshift(0);var d=u.map((h,p)=>{var x=!u[p+1],v=x?r+o-h:u[p+1]-h;if(v<=0)return null;var j=p%n.length;return f.createElement("rect",{key:"react-".concat(p),x:h,y:i,width:v,height:l,stroke:"none",fill:n[j],fillOpacity:s,className:"recharts-cartesian-grid-bg"})});return f.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},d)}var COe=(e,t)=>{var{xAxis:n,width:s,height:r,offset:i}=e;return xQ(qD(Os(Os(Os({},Il),n),{},{ticks:yQ(n),viewBox:{x:0,y:0,width:s,height:r}})),i.left,i.left+i.width,t)},SOe=(e,t)=>{var{yAxis:n,width:s,height:r,offset:i}=e;return xQ(qD(Os(Os(Os({},Il),n),{},{ticks:yQ(n),viewBox:{x:0,y:0,width:s,height:r}})),i.top,i.top+i.height,t)},_Oe={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0,syncWithTicks:!1,zIndex:Gn.grid};function $E(e){var t=RP(),n=zP(),s=_Q(),r=Os(Os({},Qn(e,_Oe)),{},{x:Ut(e.x)?e.x:s.left,y:Ut(e.y)?e.y:s.top,width:Ut(e.width)?e.width:s.width,height:Ut(e.height)?e.height:s.height}),{xAxisId:i,yAxisId:o,x:l,y:c,width:u,height:d,syncWithTicks:h,horizontalValues:p,verticalValues:x}=r,v=Hs(),j=Bt(M=>lU(M,"xAxis",i,v)),y=Bt(M=>lU(M,"yAxis",o,v));if(!qo(u)||!qo(d)||!Ut(l)||!Ut(c))return null;var N=r.verticalCoordinatesGenerator||COe,w=r.horizontalCoordinatesGenerator||SOe,{horizontalPoints:S,verticalPoints:_}=r;if((!S||!S.length)&&typeof w=="function"){var k=p&&p.length,T=w({yAxis:y?Os(Os({},y),{},{ticks:k?p:y.ticks}):void 0,width:t??u,height:n??d,offset:s},k?!0:h);bw(Array.isArray(T),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof T,"]")),Array.isArray(T)&&(S=T)}if((!_||!_.length)&&typeof N=="function"){var A=x&&x.length,E=N({xAxis:j?Os(Os({},j),{},{ticks:A?x:j.ticks}):void 0,width:t??u,height:n??d,offset:s},A?!0:h);bw(Array.isArray(E),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof E,"]")),Array.isArray(E)&&(_=E)}return f.createElement(Sr,{zIndex:r.zIndex},f.createElement("g",{className:"recharts-cartesian-grid"},f.createElement(bOe,{fill:r.fill,fillOpacity:r.fillOpacity,x:r.x,y:r.y,width:r.width,height:r.height,ry:r.ry}),f.createElement(jOe,xu({},r,{horizontalPoints:S})),f.createElement(NOe,xu({},r,{verticalPoints:_})),f.createElement(vOe,xu({},r,{offset:s,horizontalPoints:S,xAxis:j,yAxis:y})),f.createElement(wOe,xu({},r,{offset:s,verticalPoints:_,xAxis:j,yAxis:y}))))}$E.displayName="CartesianGrid";var AOe={},YX=Cr({name:"errorBars",initialState:AOe,reducers:{addErrorBar:(e,t)=>{var{itemId:n,errorBar:s}=t.payload;e[n]||(e[n]=[]),e[n].push(s)},replaceErrorBar:(e,t)=>{var{itemId:n,prev:s,next:r}=t.payload;e[n]&&(e[n]=e[n].map(i=>i.dataKey===s.dataKey&&i.direction===s.direction?r:i))},removeErrorBar:(e,t)=>{var{itemId:n,errorBar:s}=t.payload;e[n]&&(e[n]=e[n].filter(r=>r.dataKey!==s.dataKey||r.direction!==s.direction))}}}),{addErrorBar:lYe,replaceErrorBar:cYe,removeErrorBar:dYe}=YX.actions,TOe=YX.reducer,kOe=["children"];function EOe(e,t){if(e==null)return{};var n,s,r=LOe(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)n=i[s],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function LOe(e,t){if(e==null)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;n[s]=e[s]}return n}var POe={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},DOe=f.createContext(POe);function QX(e){var{children:t}=e,n=EOe(e,kOe);return f.createElement(DOe.Provider,{value:n},t)}function WD(e,t){var n,s,r=Bt(u=>dc(u,e)),i=Bt(u=>uc(u,t)),o=(n=r?.allowDataOverflow)!==null&&n!==void 0?n:ms.allowDataOverflow,l=(s=i?.allowDataOverflow)!==null&&s!==void 0?s:fs.allowDataOverflow,c=o||l;return{needClip:c,needClipX:o,needClipY:l}}function KX(e){var{xAxisId:t,yAxisId:n,clipPathId:s}=e,r=BD(),{needClipX:i,needClipY:o,needClip:l}=WD(t,n);if(!l||!r)return null;var{x:c,y:u,width:d,height:h}=r;return f.createElement("clipPath",{id:"clipPath-".concat(s)},f.createElement("rect",{x:i?c:c-d/2,y:o?u:u-h/2,width:i?d:d*2,height:o?h:h*2}))}var XX=(e,t,n,s)=>bd(e,"xAxis",t,s),ZX=(e,t,n,s)=>yd(e,"xAxis",t,s),JX=(e,t,n,s)=>bd(e,"yAxis",n,s),eZ=(e,t,n,s)=>yd(e,"yAxis",n,s),OOe=ut([ja,XX,JX,ZX,eZ],(e,t,n,s,r)=>Pd(e,"xAxis")?Bf(t,s,!1):Bf(n,r,!1)),MOe=(e,t,n,s,r)=>r;function IOe(e){return e.type==="line"}var $Oe=ut([i1,MOe],(e,t)=>e.filter(IOe).find(n=>n.id===t)),ROe=ut([ja,XX,JX,ZX,eZ,$Oe,OOe,HP],(e,t,n,s,r,i,o,l)=>{var{chartData:c,dataStartIndex:u,dataEndIndex:d}=l;if(!(i==null||t==null||n==null||s==null||r==null||s.length===0||r.length===0||o==null||e!=="horizontal"&&e!=="vertical")){var{dataKey:h,data:p}=i,x;if(p!=null&&p.length>0?x=p:x=c?.slice(u,d+1),x!=null)return _Me({layout:e,xAxis:t,yAxis:n,xAxisTicks:s,yAxisTicks:r,dataKey:h,bandSize:o,displayedData:x})}});function zOe(e){var t=zu(e),n=3,s=2;if(t!=null){var{r,strokeWidth:i}=t,o=Number(r),l=Number(i);return(Number.isNaN(o)||o<0)&&(o=n),(Number.isNaN(l)||l<0)&&(l=s),{r:o,strokeWidth:l}}return{r:n,strokeWidth:s}}var lA={exports:{}},cA={};var p7;function FOe(){if(p7)return cA;p7=1;var e=Vf();function t(c,u){return c===u&&(c!==0||1/c===1/u)||c!==c&&u!==u}var n=typeof Object.is=="function"?Object.is:t,s=e.useSyncExternalStore,r=e.useRef,i=e.useEffect,o=e.useMemo,l=e.useDebugValue;return cA.useSyncExternalStoreWithSelector=function(c,u,d,h,p){var x=r(null);if(x.current===null){var v={hasValue:!1,value:null};x.current=v}else v=x.current;x=o(function(){function y(k){if(!N){if(N=!0,w=k,k=h(k),p!==void 0&&v.hasValue){var T=v.value;if(p(T,k))return S=T}return S=k}if(T=S,n(w,k))return T;var A=h(k);return p!==void 0&&p(T,A)?(w=k,T):(w=k,S=A)}var N=!1,w,S,_=d===void 0?null:d;return[function(){return y(u())},_===null?void 0:function(){return y(_())}]},[u,d,h,p]);var j=s(c,x[0],x[1]);return i(function(){v.hasValue=!0,v.value=j},[j]),l(j),j},cA}var x7;function UOe(){return x7||(x7=1,lA.exports=FOe()),lA.exports}var BOe=UOe();function HOe(e){e()}function qOe(){let e=null,t=null;return{clear(){e=null,t=null},notify(){HOe(()=>{let n=e;for(;n;)n.callback(),n=n.next})},get(){const n=[];let s=e;for(;s;)n.push(s),s=s.next;return n},subscribe(n){let s=!0;const r=t={callback:n,next:null,prev:t};return r.prev?r.prev.next=r:e=r,function(){!s||e===null||(s=!1,r.next?r.next.prev=r.prev:t=r.prev,r.prev?r.prev.next=r.next:e=r.next)}}}}var y7={notify(){},get:()=>[]};function GOe(e,t){let n,s=y7,r=0,i=!1;function o(j){d();const y=s.subscribe(j);let N=!1;return()=>{N||(N=!0,y(),h())}}function l(){s.notify()}function c(){v.onStateChange&&v.onStateChange()}function u(){return i}function d(){r++,n||(n=e.subscribe(c),s=qOe())}function h(){r--,n&&r===0&&(n(),n=void 0,s.clear(),s=y7)}function p(){i||(i=!0,d())}function x(){i&&(i=!1,h())}const v={addNestedSub:o,notifyNestedSubs:l,handleChangeWrapper:c,isSubscribed:u,trySubscribe:p,tryUnsubscribe:x,getListeners:()=>s};return v}var WOe=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",VOe=WOe(),YOe=()=>typeof navigator<"u"&&navigator.product==="ReactNative",QOe=YOe(),KOe=()=>VOe||QOe?f.useLayoutEffect:f.useEffect,XOe=KOe();function b7(e,t){return e===t?e!==0||t!==0||1/e===1/t:e!==e&&t!==t}function ZOe(e,t){if(b7(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;const n=Object.keys(e),s=Object.keys(t);if(n.length!==s.length)return!1;for(let r=0;r<n.length;r++)if(!Object.prototype.hasOwnProperty.call(t,n[r])||!b7(e[n[r]],t[n[r]]))return!1;return!0}var JOe=Symbol.for("react-redux-context"),eMe=typeof globalThis<"u"?globalThis:{};function tMe(){if(!f.createContext)return{};const e=eMe[JOe]??=new Map;let t=e.get(f.createContext);return t||(t=f.createContext(null),e.set(f.createContext,t)),t}var aMe=tMe();function nMe(e){const{children:t,context:n,serverState:s,store:r}=e,i=f.useMemo(()=>{const c=GOe(r);return{store:r,subscription:c,getServerState:s?()=>s:void 0}},[r,s]),o=f.useMemo(()=>r.getState(),[r]);XOe(()=>{const{subscription:c}=i;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),o!==r.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[i,o]);const l=n||aMe;return f.createElement(l.Provider,{value:i},t)}var sMe=nMe,rMe=new Set(["axisLine","tickLine","activeBar","activeDot","activeLabel","activeShape","allowEscapeViewBox","background","cursor","dot","label","line","margin","padding","position","shape","style","tick","wrapperStyle","radius"]);function iMe(e,t){return e==null&&t==null?!0:typeof e=="number"&&typeof t=="number"?e===t||e!==e&&t!==t:e===t}function x1(e,t){var n=new Set([...Object.keys(e),...Object.keys(t)]);for(var s of n)if(rMe.has(s)){if(e[s]==null&&t[s]==null)continue;if(!ZOe(e[s],t[s]))return!1}else if(!iMe(e[s],t[s]))return!1;return!0}var oMe=["id"],lMe=["type","layout","connectNulls","needClip","shape"],cMe=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId","id"];function Yp(){return Yp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Yp.apply(null,arguments)}function v7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function Ao(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?v7(Object(n),!0).forEach(function(s){dMe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v7(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function dMe(e,t,n){return(t=uMe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function uMe(e){var t=mMe(e,"string");return typeof t=="symbol"?t:t+""}function mMe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function VD(e,t){if(e==null)return{};var n,s,r=fMe(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)n=i[s],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function fMe(e,t){if(e==null)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;n[s]=e[s]}return n}var hMe=e=>{var{dataKey:t,name:n,stroke:s,legendType:r,hide:i}=e;return[{inactive:i,dataKey:t,type:r,color:s,value:fh(n,t),payload:e}]},gMe=f.memo(e=>{var{dataKey:t,data:n,stroke:s,strokeWidth:r,fill:i,name:o,hide:l,unit:c,tooltipType:u,id:d}=e,h={dataDefinedOnItem:n,positions:void 0,settings:{stroke:s,strokeWidth:r,fill:i,dataKey:t,nameKey:void 0,name:fh(o,t),hide:l,type:u,color:s,unit:c,graphicalItemId:d}};return f.createElement(FD,{tooltipEntrySettings:h})}),tZ=(e,t)=>"".concat(t,"px ").concat(e-t,"px");function pMe(e,t){for(var n=e.length%2!==0?[...e,0]:e,s=[],r=0;r<t;++r)s=[...s,...n];return s}var xMe=(e,t,n)=>{var s=n.reduce((h,p)=>h+p);if(!s)return tZ(t,e);for(var r=Math.floor(e/s),i=e%s,o=t-e,l=[],c=0,u=0;c<n.length;u+=n[c],++c)if(u+n[c]>i){l=[...n.slice(0,c),i-u];break}var d=l.length%2===0?[0,o]:[o];return[...pMe(n,r),...l,...d].map(h=>"".concat(h,"px")).join(", ")};function yMe(e){var{clipPathId:t,points:n,props:s}=e,{dot:r,dataKey:i,needClip:o}=s,{id:l}=s,c=VD(s,oMe),u=qr(c);return f.createElement(a5e,{points:n,dot:r,className:"recharts-line-dots",dotClassName:"recharts-line-dot",dataKey:i,baseProps:u,needClip:o,clipPathId:t})}function bMe(e){var{showLabels:t,children:n,points:s}=e,r=f.useMemo(()=>s?.map(i=>{var o,l,c={x:(o=i.x)!==null&&o!==void 0?o:0,y:(l=i.y)!==null&&l!==void 0?l:0,width:0,lowerWidth:0,upperWidth:0,height:0};return Ao(Ao({},c),{},{value:i.value,payload:i.payload,viewBox:c,parentViewBox:void 0,fill:void 0})}),[s]);return f.createElement(TX,{value:t?r:void 0},n)}function w7(e){var{clipPathId:t,pathRef:n,points:s,strokeDasharray:r,props:i}=e,{type:o,layout:l,connectNulls:c,needClip:u,shape:d}=i,h=VD(i,lMe),p=Ao(Ao({},Ys(h)),{},{fill:"none",className:"recharts-line-curve",clipPath:u?"url(#clipPath-".concat(t,")"):void 0,points:s,type:o,layout:l,connectNulls:c,strokeDasharray:r??i.strokeDasharray});return f.createElement(f.Fragment,null,s?.length>1&&f.createElement(ID,Yp({shapeType:"curve",option:d},p,{pathRef:n})),f.createElement(yMe,{points:s,clipPathId:t,props:i}))}function vMe(e){try{return e&&e.getTotalLength&&e.getTotalLength()||0}catch{return 0}}function wMe(e){var{clipPathId:t,props:n,pathRef:s,previousPointsRef:r,longestAnimatedLengthRef:i}=e,{points:o,strokeDasharray:l,isAnimationActive:c,animationBegin:u,animationDuration:d,animationEasing:h,animateNewValues:p,width:x,height:v,onAnimationEnd:j,onAnimationStart:y}=n,N=r.current,w=i0(o,"recharts-line-"),S=f.useRef(w),[_,k]=f.useState(!1),T=!_,A=f.useCallback(()=>{typeof j=="function"&&j(),k(!1)},[j]),E=f.useCallback(()=>{typeof y=="function"&&y(),k(!0)},[y]),M=vMe(s.current),z=f.useRef(0);S.current!==w&&(z.current=i.current,S.current=w);var P=z.current;return f.createElement(bMe,{points:o,showLabels:T},n.children,f.createElement(r0,{animationId:w,begin:u,duration:d,isActive:c,easing:h,onAnimationEnd:A,onAnimationStart:E,key:w},D=>{var U=dn(P,M+P,D),B=Math.min(U,M),R;if(c)if(l){var q="".concat(l).split(/[,\s]+/gim).map(oe=>parseFloat(oe));R=xMe(B,M,q)}else R=tZ(M,B);else R=l==null?void 0:String(l);if(D>0&&M>0&&(r.current=o,i.current=Math.max(i.current,B)),N){var Z=N.length/o.length,V=D===1?o:o.map((oe,je)=>{var X=Math.floor(je*Z);if(N[X]){var se=N[X];return Ao(Ao({},oe),{},{x:dn(se.x,oe.x,D),y:dn(se.y,oe.y,D)})}return p?Ao(Ao({},oe),{},{x:dn(x*2,oe.x,D),y:dn(v/2,oe.y,D)}):Ao(Ao({},oe),{},{x:oe.x,y:oe.y})});return r.current=V,f.createElement(w7,{props:n,points:V,clipPathId:t,pathRef:s,strokeDasharray:R})}return f.createElement(w7,{props:n,points:o,clipPathId:t,pathRef:s,strokeDasharray:R})}),f.createElement(PD,{label:n.label}))}function jMe(e){var{clipPathId:t,props:n}=e,s=f.useRef(null),r=f.useRef(0),i=f.useRef(null);return f.createElement(wMe,{props:n,clipPathId:t,previousPointsRef:s,longestAnimatedLengthRef:r,pathRef:i})}var NMe=(e,t)=>{var n,s;return{x:(n=e.x)!==null&&n!==void 0?n:void 0,y:(s=e.y)!==null&&s!==void 0?s:void 0,value:e.value,errorVal:qa(e.payload,t)}};class CMe extends f.Component{render(){var{hide:t,dot:n,points:s,className:r,xAxisId:i,yAxisId:o,top:l,left:c,width:u,height:d,id:h,needClip:p,zIndex:x}=this.props;if(t)return null;var v=$t("recharts-line",r),j=h,{r:y,strokeWidth:N}=zOe(n),w=IX(n),S=y*2+N,_=p?"url(#clipPath-".concat(w?"":"dots-").concat(j,")"):void 0;return f.createElement(Sr,{zIndex:x},f.createElement(ys,{className:v},p&&f.createElement("defs",null,f.createElement(KX,{clipPathId:j,xAxisId:i,yAxisId:o}),!w&&f.createElement("clipPath",{id:"clipPath-dots-".concat(j)},f.createElement("rect",{x:c-S/2,y:l-S/2,width:u+S,height:d+S}))),f.createElement(QX,{xAxisId:i,yAxisId:o,data:s,dataPointFormatter:NMe,errorBarOffset:0},f.createElement(jMe,{props:this.props,clipPathId:j}))),f.createElement(j5e,{activeDot:this.props.activeDot,points:s,mainColor:this.props.stroke,itemDataKey:this.props.dataKey,clipPath:_}))}}var aZ={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:"auto",label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0,zIndex:Gn.line,type:"linear"};function SMe(e){var t=Qn(e,aZ),{activeDot:n,animateNewValues:s,animationBegin:r,animationDuration:i,animationEasing:o,connectNulls:l,dot:c,hide:u,isAnimationActive:d,label:h,legendType:p,xAxisId:x,yAxisId:v,id:j}=t,y=VD(t,cMe),{needClip:N}=WD(x,v),w=BD(),S=hh(),_=Hs(),k=Bt(z=>ROe(z,x,v,_,j));if(S!=="horizontal"&&S!=="vertical"||k==null||w==null)return null;var{height:T,width:A,x:E,y:M}=w;return f.createElement(CMe,Yp({},y,{id:j,connectNulls:l,dot:c,activeDot:n,animateNewValues:s,animationBegin:r,animationDuration:i,animationEasing:o,isAnimationActive:d,hide:u,label:h,legendType:p,xAxisId:x,yAxisId:v,points:k,layout:S,height:T,width:A,left:E,top:M,needClip:N}))}function _Me(e){var{layout:t,xAxis:n,yAxis:s,xAxisTicks:r,yAxisTicks:i,dataKey:o,bandSize:l,displayedData:c}=e;return c.map((u,d)=>{var h=qa(u,o);if(t==="horizontal"){var p=Vz({axis:n,ticks:r,bandSize:l,entry:u,index:d}),x=fn(h)?null:s.scale(h);return{x:p,y:x,value:h,payload:u}}var v=fn(h)?null:n.scale(h),j=Vz({axis:s,ticks:i,bandSize:l,entry:u,index:d});return v==null||j==null?null:{x:v,y:j,value:h,payload:u}}).filter(Boolean)}function AMe(e){var t=Qn(e,aZ),n=Hs();return f.createElement(UD,{id:t.id,type:"line"},s=>f.createElement(f.Fragment,null,f.createElement($X,{legendPayload:hMe(t)}),f.createElement(gMe,{dataKey:t.dataKey,data:t.data,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill,name:t.name,hide:t.hide,unit:t.unit,tooltipType:t.tooltipType,id:s}),f.createElement(zX,{type:"line",id:s,data:t.data,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,hide:t.hide,isPanorama:n}),f.createElement(SMe,Yp({},t,{id:s}))))}var RE=f.memo(AMe,x1);RE.displayName="Line";function rm(e,t){var n,s;return(n=(s=e.graphicalItems.cartesianItems.find(r=>r.id===t))===null||s===void 0?void 0:s.xAxisId)!==null&&n!==void 0?n:UX}function im(e,t){var n,s;return(n=(s=e.graphicalItems.cartesianItems.find(r=>r.id===t))===null||s===void 0?void 0:s.yAxisId)!==null&&n!==void 0?n:UX}var TMe="Invariant failed";function kMe(e,t){throw new Error(TMe)}function zE(){return zE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},zE.apply(null,arguments)}function $w(e){return f.createElement(ID,zE({shapeType:"rectangle",activeClassName:"recharts-active-bar"},e))}var EMe=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(s,r)=>{if(Ut(t))return t;var i=Ut(s)||fn(s);return i?t(s,r):(i||kMe(),n)}},LMe=(e,t,n)=>n,PMe=(e,t)=>t,p0=ut([i1,PMe],(e,t)=>e.filter(n=>n.type==="bar").find(n=>n.id===t)),DMe=ut([p0],e=>e?.maxBarSize),OMe=(e,t,n,s)=>s,MMe=ut([ja,i1,rm,im,LMe],(e,t,n,s,r)=>t.filter(i=>e==="horizontal"?i.xAxisId===n:i.yAxisId===s).filter(i=>i.isPanorama===r).filter(i=>i.hide===!1).filter(i=>i.type==="bar")),IMe=(e,t,n)=>{var s=ja(e),r=rm(e,t),i=im(e,t);if(!(r==null||i==null))return s==="horizontal"?kE(e,"yAxis",i,n):kE(e,"xAxis",r,n)},$Me=(e,t)=>{var n=ja(e),s=rm(e,t),r=im(e,t);if(!(s==null||r==null))return n==="horizontal"?oU(e,"xAxis",s):oU(e,"yAxis",r)},RMe=ut([MMe,oEe,$Me],N5e),zMe=(e,t,n)=>{var s,r,i=p0(e,t);if(i!=null){var o=rm(e,t),l=im(e,t);if(!(o==null||l==null)){var c=ja(e),u=cK(e),{maxBarSize:d}=i,h=fn(d)?u:d,p,x;return c==="horizontal"?(p=bd(e,"xAxis",o,n),x=yd(e,"xAxis",o,n)):(p=bd(e,"yAxis",l,n),x=yd(e,"yAxis",l,n)),(s=(r=Bf(p,x,!0))!==null&&r!==void 0?r:h)!==null&&s!==void 0?s:0}}},nZ=(e,t,n)=>{var s=ja(e),r=rm(e,t),i=im(e,t);if(!(r==null||i==null)){var o,l;return s==="horizontal"?(o=bd(e,"xAxis",r,n),l=yd(e,"xAxis",r,n)):(o=bd(e,"yAxis",i,n),l=yd(e,"yAxis",i,n)),Bf(o,l)}},FMe=ut([RMe,cK,iEe,dK,zMe,nZ,DMe],T5e),UMe=(e,t,n)=>{var s=rm(e,t);if(s!=null)return bd(e,"xAxis",s,n)},BMe=(e,t,n)=>{var s=im(e,t);if(s!=null)return bd(e,"yAxis",s,n)},HMe=(e,t,n)=>{var s=rm(e,t);if(s!=null)return yd(e,"xAxis",s,n)},qMe=(e,t,n)=>{var s=im(e,t);if(s!=null)return yd(e,"yAxis",s,n)},GMe=ut([FMe,p0],(e,t)=>{if(!(e==null||t==null)){var n=e.find(s=>s.stackId===t.stackId&&t.dataKey!=null&&s.dataKeys.includes(t.dataKey));if(n!=null)return n.position}}),WMe=ut([IMe,p0],k5e),VMe=ut([ls,IP,UMe,BMe,HMe,qMe,GMe,ja,Yke,nZ,WMe,p0,OMe],(e,t,n,s,r,i,o,l,c,u,d,h,p)=>{var{chartData:x,dataStartIndex:v,dataEndIndex:j}=c;if(!(h==null||o==null||t==null||l!=="horizontal"&&l!=="vertical"||n==null||s==null||r==null||i==null||u==null)){var{data:y}=h,N;if(y!=null&&y.length>0?N=y:N=x?.slice(v,j+1),N!=null)return jIe({layout:l,barSettings:h,pos:o,parentViewBox:t,bandSize:u,xAxis:n,yAxis:s,xAxisTicks:r,yAxisTicks:i,stackedData:d,displayedData:N,offset:e,cells:p,dataStartIndex:v})}}),YMe=["index"];function FE(){return FE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},FE.apply(null,arguments)}function QMe(e,t){if(e==null)return{};var n,s,r=KMe(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)n=i[s],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function KMe(e,t){if(e==null)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;n[s]=e[s]}return n}var sZ=f.createContext(void 0),XMe=e=>{var t=f.useContext(sZ);if(t!=null)return t.stackId;if(e!=null)return pAe(e)},ZMe=(e,t)=>"recharts-bar-stack-clip-path-".concat(e,"-").concat(t),JMe=e=>{var t=f.useContext(sZ);if(t!=null){var{stackId:n}=t;return"url(#".concat(ZMe(n,e),")")}},eIe=e=>{var{index:t}=e,n=QMe(e,YMe),s=JMe(t);return f.createElement(ys,FE({className:"recharts-bar-stack-layer",clipPath:s},n))},tIe=["onMouseEnter","onMouseLeave","onClick"],aIe=["value","background","tooltipPosition"],nIe=["id"],sIe=["onMouseEnter","onClick","onMouseLeave"];function Zl(){return Zl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Zl.apply(null,arguments)}function j7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function Gs(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?j7(Object(n),!0).forEach(function(s){rIe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j7(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function rIe(e,t,n){return(t=iIe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function iIe(e){var t=oIe(e,"string");return typeof t=="symbol"?t:t+""}function oIe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Rw(e,t){if(e==null)return{};var n,s,r=lIe(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)n=i[s],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function lIe(e,t){if(e==null)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;n[s]=e[s]}return n}var cIe=e=>{var{dataKey:t,name:n,fill:s,legendType:r,hide:i}=e;return[{inactive:i,dataKey:t,type:r,color:s,value:fh(n,t),payload:e}]},dIe=f.memo(e=>{var{dataKey:t,stroke:n,strokeWidth:s,fill:r,name:i,hide:o,unit:l,tooltipType:c,id:u}=e,d={dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:n,strokeWidth:s,fill:r,dataKey:t,nameKey:void 0,name:fh(i,t),hide:o,type:c,color:r,unit:l,graphicalItemId:u}};return f.createElement(FD,{tooltipEntrySettings:d})});function uIe(e){var t=Bt(vd),{data:n,dataKey:s,background:r,allOtherBarProps:i}=e,{onMouseEnter:o,onMouseLeave:l,onClick:c}=i,u=Rw(i,tIe),d=$D(o,s,i.id),h=RD(l),p=zD(c,s,i.id);if(!r||n==null)return null;var x=zu(r);return f.createElement(Sr,{zIndex:E5e(r,Gn.barBackground)},n.map((v,j)=>{var{value:y,background:N,tooltipPosition:w}=v,S=Rw(v,aIe);if(!N)return null;var _=d(v,j),k=h(v,j),T=p(v,j),A=Gs(Gs(Gs(Gs(Gs({option:r,isActive:String(j)===t},S),{},{fill:"#eee"},N),x),Jx(u,v,j)),{},{onMouseEnter:_,onMouseLeave:k,onClick:T,dataKey:s,index:j,className:"recharts-bar-background-rectangle"});return f.createElement($w,Zl({key:"background-bar-".concat(j)},A))}))}function mIe(e){var{showLabels:t,children:n,rects:s}=e,r=s?.map(i=>{var o={x:i.x,y:i.y,width:i.width,lowerWidth:i.width,upperWidth:i.width,height:i.height};return Gs(Gs({},o),{},{value:i.value,payload:i.payload,parentViewBox:i.parentViewBox,viewBox:o,fill:i.fill})});return f.createElement(TX,{value:t?r:void 0},n)}function fIe(e){var{shape:t,activeBar:n,baseProps:s,entry:r,index:i,dataKey:o}=e,l=Bt(vd),c=Bt(SD),u=n&&String(i)===l&&(c==null||o===c),d=u?n:t;return u?f.createElement(Sr,{zIndex:Gn.activeBar},f.createElement($w,Zl({},s,{name:String(s.name)},r,{isActive:u,option:d,index:i,dataKey:o}))):f.createElement($w,Zl({},s,{name:String(s.name)},r,{isActive:u,option:d,index:i,dataKey:o}))}function hIe(e){var{shape:t,baseProps:n,entry:s,index:r,dataKey:i}=e;return f.createElement($w,Zl({},n,{name:String(n.name)},s,{isActive:!1,option:t,index:r,dataKey:i}))}function gIe(e){var t,{data:n,props:s}=e,r=(t=qr(s))!==null&&t!==void 0?t:{},{id:i}=r,o=Rw(r,nIe),{shape:l,dataKey:c,activeBar:u}=s,{onMouseEnter:d,onClick:h,onMouseLeave:p}=s,x=Rw(s,sIe),v=$D(d,c,i),j=RD(p),y=zD(h,c,i);return n?f.createElement(f.Fragment,null,n.map((N,w)=>f.createElement(eIe,Zl({index:w,key:"rectangle-".concat(N?.x,"-").concat(N?.y,"-").concat(N?.value,"-").concat(w),className:"recharts-bar-rectangle"},Jx(x,N,w),{onMouseEnter:v(N,w),onMouseLeave:j(N,w),onClick:y(N,w)}),u?f.createElement(fIe,{shape:l,activeBar:u,baseProps:o,entry:N,index:w,dataKey:c}):f.createElement(hIe,{shape:l,baseProps:o,entry:N,index:w,dataKey:c})))):null}function pIe(e){var{props:t,previousRectanglesRef:n}=e,{data:s,layout:r,isAnimationActive:i,animationBegin:o,animationDuration:l,animationEasing:c,onAnimationEnd:u,onAnimationStart:d}=t,h=n.current,p=i0(t,"recharts-bar-"),[x,v]=f.useState(!1),j=!x,y=f.useCallback(()=>{typeof u=="function"&&u(),v(!1)},[u]),N=f.useCallback(()=>{typeof d=="function"&&d(),v(!0)},[d]);return f.createElement(mIe,{showLabels:j,rects:s},f.createElement(r0,{animationId:p,begin:o,duration:l,isActive:i,easing:c,onAnimationEnd:y,onAnimationStart:N,key:p},w=>{var S=w===1?s:s?.map((_,k)=>{var T=h&&h[k];if(T)return Gs(Gs({},_),{},{x:dn(T.x,_.x,w),y:dn(T.y,_.y,w),width:dn(T.width,_.width,w),height:dn(T.height,_.height,w)});if(r==="horizontal"){var A=dn(0,_.height,w),E=dn(_.stackedBarStart,_.y,w);return Gs(Gs({},_),{},{y:E,height:A})}var M=dn(0,_.width,w),z=dn(_.stackedBarStart,_.x,w);return Gs(Gs({},_),{},{width:M,x:z})});return w>0&&(n.current=S??null),S==null?null:f.createElement(ys,null,f.createElement(gIe,{props:t,data:S}))}),f.createElement(PD,{label:t.label}),t.children)}function xIe(e){var t=f.useRef(null);return f.createElement(pIe,{previousRectanglesRef:t,props:e})}var rZ=0,yIe=(e,t)=>{var n=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:n,errorVal:qa(e,t)}};class bIe extends f.PureComponent{render(){var{hide:t,data:n,dataKey:s,className:r,xAxisId:i,yAxisId:o,needClip:l,background:c,id:u}=this.props;if(t||n==null)return null;var d=$t("recharts-bar",r),h=u;return f.createElement(ys,{className:d,id:u},l&&f.createElement("defs",null,f.createElement(KX,{clipPathId:h,xAxisId:i,yAxisId:o})),f.createElement(ys,{className:"recharts-bar-rectangles",clipPath:l?"url(#clipPath-".concat(h,")"):void 0},f.createElement(uIe,{data:n,dataKey:s,background:c,allOtherBarProps:this.props}),f.createElement(xIe,this.props)))}}var vIe={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",background:!1,hide:!1,isAnimationActive:"auto",label:!1,legendType:"rect",minPointSize:rZ,xAxisId:0,yAxisId:0,zIndex:Gn.bar};function wIe(e){var{xAxisId:t,yAxisId:n,hide:s,legendType:r,minPointSize:i,activeBar:o,animationBegin:l,animationDuration:c,animationEasing:u,isAnimationActive:d}=e,{needClip:h}=WD(t,n),p=hh(),x=Hs(),v=MD(e.children,m1),j=Bt(w=>VMe(w,e.id,x,v));if(p!=="vertical"&&p!=="horizontal")return null;var y,N=j?.[0];return N==null||N.height==null||N.width==null?y=0:y=p==="vertical"?N.height/2:N.width/2,f.createElement(QX,{xAxisId:t,yAxisId:n,data:j,dataPointFormatter:yIe,errorBarOffset:y},f.createElement(bIe,Zl({},e,{layout:p,needClip:h,data:j,xAxisId:t,yAxisId:n,hide:s,legendType:r,minPointSize:i,activeBar:o,animationBegin:l,animationDuration:c,animationEasing:u,isAnimationActive:d})))}function jIe(e){var{layout:t,barSettings:{dataKey:n,minPointSize:s},pos:r,bandSize:i,xAxis:o,yAxis:l,xAxisTicks:c,yAxisTicks:u,stackedData:d,displayedData:h,offset:p,cells:x,parentViewBox:v,dataStartIndex:j}=e,y=t==="horizontal"?l:o,N=d?y.scale.domain():null,w=xAe({numericAxis:y}),S=y.scale(w);return h.map((_,k)=>{var T,A,E,M,z,P;if(d){var D=d[k+j];if(D==null)return null;T=uAe(D,N)}else T=qa(_,n),Array.isArray(T)||(T=[w,T]);var U=EMe(s,rZ)(T[1],k);if(t==="horizontal"){var B,[R,q]=[l.scale(T[0]),l.scale(T[1])];A=Yz({axis:o,ticks:c,bandSize:i,offset:r.offset,entry:_,index:k}),E=(B=q??R)!==null&&B!==void 0?B:void 0,M=r.size;var Z=R-q;if(z=eo(Z)?0:Z,P={x:A,y:p.top,width:M,height:p.height},Math.abs(U)>0&&Math.abs(z)<Math.abs(U)){var V=xs(z||U)*(Math.abs(U)-Math.abs(z));E-=V,z+=V}}else{var[oe,je]=[o.scale(T[0]),o.scale(T[1])];if(A=oe,E=Yz({axis:l,ticks:u,bandSize:i,offset:r.offset,entry:_,index:k}),M=je-oe,z=r.size,P={x:p.left,y:E,width:p.width,height:z},Math.abs(U)>0&&Math.abs(M)<Math.abs(U)){var X=xs(M||U)*(Math.abs(U)-Math.abs(M));M+=X}}if(A==null||E==null||M==null||z==null)return null;var se=Gs(Gs({},_),{},{stackedBarStart:S,x:A,y:E,width:M,height:z,value:d?T:T[1],payload:_,background:P,tooltipPosition:{x:A+M/2,y:E+z/2},parentViewBox:v},x&&x[k]&&x[k].props);return se}).filter(Boolean)}function NIe(e){var t=Qn(e,vIe),n=XMe(t.stackId),s=Hs();return f.createElement(UD,{id:t.id,type:"bar"},r=>f.createElement(f.Fragment,null,f.createElement($X,{legendPayload:cIe(t)}),f.createElement(dIe,{dataKey:t.dataKey,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill,name:t.name,hide:t.hide,unit:t.unit,tooltipType:t.tooltipType,id:r}),f.createElement(zX,{type:"bar",id:r,data:void 0,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,stackId:n,hide:t.hide,barSize:t.barSize,minPointSize:t.minPointSize,maxBarSize:t.maxBarSize,isPanorama:s}),f.createElement(Sr,{zIndex:t.zIndex},f.createElement(wIe,Zl({},t,{id:r})))))}var UE=f.memo(NIe,x1);UE.displayName="Bar";var CIe=["domain","range"],SIe=["domain","range"];function N7(e,t){if(e==null)return{};var n,s,r=_Ie(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)n=i[s],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function _Ie(e,t){if(e==null)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;n[s]=e[s]}return n}function C7(e,t){return e===t?!0:Array.isArray(e)&&e.length===2&&Array.isArray(t)&&t.length===2?e[0]===t[0]&&e[1]===t[1]:!1}function iZ(e,t){if(e===t)return!0;var{domain:n,range:s}=e,r=N7(e,CIe),{domain:i,range:o}=t,l=N7(t,SIe);return!C7(n,i)||!C7(s,o)?!1:x1(r,l)}var AIe=["dangerouslySetInnerHTML","ticks","scale"],TIe=["id","scale"];function BE(){return BE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},BE.apply(null,arguments)}function S7(e,t){if(e==null)return{};var n,s,r=kIe(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)n=i[s],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function kIe(e,t){if(e==null)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;n[s]=e[s]}return n}function EIe(e){var t=en(),n=f.useRef(null);return f.useLayoutEffect(()=>{n.current===null?t(o5e(e)):n.current!==e&&t(l5e({prev:n.current,next:e})),n.current=e},[e,t]),f.useLayoutEffect(()=>()=>{n.current&&(t(c5e(n.current)),n.current=null)},[t]),null}var LIe=e=>{var{xAxisId:t,className:n}=e,s=Bt(IP),r=Hs(),i="xAxis",o=Bt(N=>BK(N,i,t,r)),l=Bt(N=>RK(N,t)),c=Bt(N=>sLe(N,t)),u=Bt(N=>bK(N,t));if(l==null||c==null||u==null)return null;var{dangerouslySetInnerHTML:d,ticks:h,scale:p}=e,x=S7(e,AIe),{id:v,scale:j}=u,y=S7(u,TIe);return f.createElement(GD,BE({},x,y,{x:c.x,y:c.y,width:l.width,height:l.height,className:$t("recharts-".concat(i," ").concat(i),n),viewBox:s,ticks:o,axisType:i}))},PIe={allowDataOverflow:ms.allowDataOverflow,allowDecimals:ms.allowDecimals,allowDuplicatedCategory:ms.allowDuplicatedCategory,angle:ms.angle,axisLine:Il.axisLine,height:ms.height,hide:!1,includeHidden:ms.includeHidden,interval:ms.interval,minTickGap:ms.minTickGap,mirror:ms.mirror,orientation:ms.orientation,padding:ms.padding,reversed:ms.reversed,scale:ms.scale,tick:ms.tick,tickCount:ms.tickCount,tickLine:Il.tickLine,tickSize:Il.tickSize,type:ms.type,xAxisId:0},DIe=e=>{var t=Qn(e,PIe);return f.createElement(f.Fragment,null,f.createElement(EIe,{allowDataOverflow:t.allowDataOverflow,allowDecimals:t.allowDecimals,allowDuplicatedCategory:t.allowDuplicatedCategory,angle:t.angle,dataKey:t.dataKey,domain:t.domain,height:t.height,hide:t.hide,id:t.xAxisId,includeHidden:t.includeHidden,interval:t.interval,minTickGap:t.minTickGap,mirror:t.mirror,name:t.name,orientation:t.orientation,padding:t.padding,reversed:t.reversed,scale:t.scale,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit}),f.createElement(LIe,t))},HE=f.memo(DIe,iZ);HE.displayName="XAxis";var OIe=["dangerouslySetInnerHTML","ticks","scale"],MIe=["id","scale"];function qE(){return qE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},qE.apply(null,arguments)}function _7(e,t){if(e==null)return{};var n,s,r=IIe(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)n=i[s],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function IIe(e,t){if(e==null)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;n[s]=e[s]}return n}function $Ie(e){var t=en(),n=f.useRef(null);return f.useLayoutEffect(()=>{n.current===null?t(d5e(e)):n.current!==e&&t(u5e({prev:n.current,next:e})),n.current=e},[e,t]),f.useLayoutEffect(()=>()=>{n.current&&(t(m5e(n.current)),n.current=null)},[t]),null}var RIe=e=>{var{yAxisId:t,className:n,width:s,label:r}=e,i=f.useRef(null),o=f.useRef(null),l=Bt(IP),c=Hs(),u=en(),d="yAxis",h=Bt(T=>zK(T,t)),p=Bt(T=>iLe(T,t)),x=Bt(T=>BK(T,d,t,c)),v=Bt(T=>vK(T,t));if(f.useLayoutEffect(()=>{if(!(s!=="auto"||!h||LD(r)||f.isValidElement(r)||v==null)){var T=i.current;if(T){var A=T.getCalculatedWidth();Math.round(h.width)!==Math.round(A)&&u(f5e({id:t,width:A}))}}},[x,h,u,r,t,s,v]),h==null||p==null||v==null)return null;var{dangerouslySetInnerHTML:j,ticks:y,scale:N}=e,w=_7(e,OIe),{id:S,scale:_}=v,k=_7(v,MIe);return f.createElement(GD,qE({},w,k,{ref:i,labelRef:o,x:p.x,y:p.y,tickTextProps:s==="auto"?{width:void 0}:{width:s},width:h.width,height:h.height,className:$t("recharts-".concat(d," ").concat(d),n),viewBox:l,ticks:x,axisType:d}))},zIe={allowDataOverflow:fs.allowDataOverflow,allowDecimals:fs.allowDecimals,allowDuplicatedCategory:fs.allowDuplicatedCategory,angle:fs.angle,axisLine:Il.axisLine,hide:!1,includeHidden:fs.includeHidden,interval:fs.interval,minTickGap:fs.minTickGap,mirror:fs.mirror,orientation:fs.orientation,padding:fs.padding,reversed:fs.reversed,scale:fs.scale,tick:fs.tick,tickCount:fs.tickCount,tickLine:Il.tickLine,tickSize:Il.tickSize,type:fs.type,width:fs.width,yAxisId:0},FIe=e=>{var t=Qn(e,zIe);return f.createElement(f.Fragment,null,f.createElement($Ie,{interval:t.interval,id:t.yAxisId,scale:t.scale,type:t.type,domain:t.domain,allowDataOverflow:t.allowDataOverflow,dataKey:t.dataKey,allowDuplicatedCategory:t.allowDuplicatedCategory,allowDecimals:t.allowDecimals,tickCount:t.tickCount,padding:t.padding,includeHidden:t.includeHidden,reversed:t.reversed,ticks:t.ticks,width:t.width,orientation:t.orientation,mirror:t.mirror,hide:t.hide,unit:t.unit,name:t.name,angle:t.angle,minTickGap:t.minTickGap,tick:t.tick,tickFormatter:t.tickFormatter}),f.createElement(RIe,t))},GE=f.memo(FIe,iZ);GE.displayName="YAxis";var UIe=(e,t)=>t,YD=ut([UIe,ja,xK,cs,sX,mc,j4e,ls],k4e),QD=e=>{var t=e.currentTarget.getBoundingClientRect(),n=t.width/e.currentTarget.offsetWidth,s=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/n),chartY:Math.round((e.clientY-t.top)/s)}},oZ=ji("mouseClick"),lZ=a0();lZ.startListening({actionCreator:oZ,effect:(e,t)=>{var n=e.payload,s=YD(t.getState(),QD(n));s?.activeIndex!=null&&t.dispatch(vLe({activeIndex:s.activeIndex,activeDataKey:void 0,activeCoordinate:s.activeCoordinate}))}});var WE=ji("mouseMove"),cZ=a0(),pb=null;cZ.startListening({actionCreator:WE,effect:(e,t)=>{var n=e.payload;pb!==null&&cancelAnimationFrame(pb);var s=QD(n);pb=requestAnimationFrame(()=>{var r=t.getState(),i=bD(r,r.tooltip.settings.shared);if(i==="axis"){var o=YD(r,s);o?.activeIndex!=null?t.dispatch(KK({activeIndex:o.activeIndex,activeDataKey:void 0,activeCoordinate:o.activeCoordinate})):t.dispatch(QK())}pb=null})}});function BIe(e,t){return t instanceof HTMLElement?"HTMLElement <".concat(t.tagName,' class="').concat(t.className,'">'):t===window?"global.window":e==="children"&&typeof t=="object"&&t!==null?"<<CHILDREN>>":t}var A7={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index",baseValue:void 0,reverseStackOrder:!1},dZ=Cr({name:"rootProps",initialState:A7,reducers:{updateOptions:(e,t)=>{var n;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=(n=t.payload.barGap)!==null&&n!==void 0?n:A7.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className,e.baseValue=t.payload.baseValue,e.reverseStackOrder=t.payload.reverseStackOrder}}}),HIe=dZ.reducer,{updateOptions:qIe}=dZ.actions,uZ=Cr({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(e,t)=>t.payload}}),{updatePolarOptions:GIe}=uZ.actions,WIe=uZ.reducer,mZ=ji("keyDown"),fZ=ji("focus"),KD=a0();KD.startListening({actionCreator:mZ,effect:(e,t)=>{var n=t.getState(),s=n.rootProps.accessibilityLayer!==!1;if(s){var{keyboardInteraction:r}=n.tooltip,i=e.payload;if(!(i!=="ArrowRight"&&i!=="ArrowLeft"&&i!=="Enter")){var o=vD(r,jh(n),u0(n),h0(n)),l=o==null?-1:Number(o);if(!(!Number.isFinite(l)||l<0)){var c=mc(n);if(i==="Enter"){var u=Lw(n,"axis","hover",String(r.index));t.dispatch(LE({active:!r.active,activeIndex:r.index,activeCoordinate:u}));return}var d=dLe(n),h=d==="left-to-right"?1:-1,p=i==="ArrowRight"?1:-1,x=l+p*h;if(!(c==null||x>=c.length||x<0)){var v=Lw(n,"axis","hover",String(x));t.dispatch(LE({active:!0,activeIndex:x.toString(),activeCoordinate:v}))}}}}}});KD.startListening({actionCreator:fZ,effect:(e,t)=>{var n=t.getState(),s=n.rootProps.accessibilityLayer!==!1;if(s){var{keyboardInteraction:r}=n.tooltip;if(!r.active&&r.index==null){var i="0",o=Lw(n,"axis","hover",String(i));t.dispatch(LE({active:!0,activeIndex:i,activeCoordinate:o}))}}}});var di=ji("externalEvent"),hZ=a0(),dA=new Map;hZ.startListening({actionCreator:di,effect:(e,t)=>{var{handler:n,reactEvent:s}=e.payload;if(n!=null){s.persist();var r=s.type,i=dA.get(r);i!==void 0&&cancelAnimationFrame(i);var o=requestAnimationFrame(()=>{try{var l=t.getState(),c={activeCoordinate:i4e(l),activeDataKey:SD(l),activeIndex:vd(l),activeLabel:oX(l),activeTooltipIndex:vd(l),isTooltipActive:o4e(l)};n(c,s)}finally{dA.delete(r)}});dA.set(r,o)}}});var VIe=ut([vh],e=>e.tooltipItemPayloads),YIe=ut([VIe,f0,(e,t)=>t,(e,t,n)=>n],(e,t,n,s)=>{var r=e.find(l=>l.settings.graphicalItemId===s);if(r!=null){var{positions:i}=r;if(i!=null){var o=t(i,n);return o}}}),gZ=ji("touchMove"),pZ=a0();pZ.startListening({actionCreator:gZ,effect:(e,t)=>{var n=e.payload;if(!(n.touches==null||n.touches.length===0)){var s=t.getState(),r=bD(s,s.tooltip.settings.shared);if(r==="axis"){var i=n.touches[0];if(i==null)return;var o=YD(s,QD({clientX:i.clientX,clientY:i.clientY,currentTarget:n.currentTarget}));o?.activeIndex!=null&&t.dispatch(KK({activeIndex:o.activeIndex,activeDataKey:void 0,activeCoordinate:o.activeCoordinate}))}else if(r==="item"){var l,c=n.touches[0];if(document.elementFromPoint==null||c==null)return;var u=document.elementFromPoint(c.clientX,c.clientY);if(!u||!u.getAttribute)return;var d=u.getAttribute(vQ),h=(l=u.getAttribute(wQ))!==null&&l!==void 0?l:void 0,p=wh(s).find(j=>j.id===h);if(d==null||p==null||h==null)return;var{dataKey:x}=p,v=YIe(s,d,h);t.dispatch(YK({activeDataKey:x,activeIndex:d,activeCoordinate:v,activeGraphicalItemId:h}))}}}});var QIe=BY({brush:L5e,cartesianAxis:h5e,chartData:iPe,errorBars:TOe,graphicalItems:v3e,layout:rAe,legend:fTe,options:tPe,polarAxis:$De,polarOptions:WIe,referenceElements:R5e,rootProps:HIe,tooltip:wLe,zIndex:H4e}),KIe=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Chart";return E_e({reducer:QIe,preloadedState:t,middleware:s=>{var r;return s({serializableCheck:!1,immutableCheck:!["commonjs","es6","production"].includes((r="es6")!==null&&r!==void 0?r:"")}).concat([lZ.middleware,cZ.middleware,KD.middleware,hZ.middleware,pZ.middleware])},enhancers:s=>{var r=s;return typeof s=="function"&&(r=s()),r.concat(nQ({type:"raf"}))},devTools:{serialize:{replacer:BIe},name:"recharts-".concat(n)}})};function xZ(e){var{preloadedState:t,children:n,reduxStoreName:s}=e,r=Hs(),i=f.useRef(null);if(r)return n;i.current==null&&(i.current=KIe(t,s));var o=AP;return f.createElement(sMe,{context:o,store:i.current},n)}function XIe(e){var{layout:t,margin:n}=e,s=en(),r=Hs();return f.useEffect(()=>{r||(s(aAe(t)),s(tAe(n)))},[s,r,t,n]),null}var yZ=f.memo(XIe,x1);function bZ(e){var t=en();return f.useEffect(()=>{t(qIe(e))},[t,e]),null}function T7(e){var{zIndex:t,isPanorama:n}=e,s=f.useRef(null),r=en();return f.useLayoutEffect(()=>(s.current&&r(U4e({zIndex:t,element:s.current,isPanorama:n})),()=>{r(B4e({zIndex:t,isPanorama:n}))}),[r,t,n]),f.createElement("g",{tabIndex:-1,ref:s})}function k7(e){var{children:t,isPanorama:n}=e,s=Bt(L4e);if(!s||s.length===0)return t;var r=s.filter(o=>o<0),i=s.filter(o=>o>0);return f.createElement(f.Fragment,null,r.map(o=>f.createElement(T7,{key:o,zIndex:o,isPanorama:n})),t,i.map(o=>f.createElement(T7,{key:o,zIndex:o,isPanorama:n})))}var ZIe=["children"];function JIe(e,t){if(e==null)return{};var n,s,r=e$e(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)n=i[s],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function e$e(e,t){if(e==null)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;n[s]=e[s]}return n}function zw(){return zw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},zw.apply(null,arguments)}var t$e={width:"100%",height:"100%",display:"block"},a$e=f.forwardRef((e,t)=>{var n=RP(),s=zP(),r=RQ();if(!qo(n)||!qo(s))return null;var{children:i,otherAttributes:o,title:l,desc:c}=e,u,d;return o!=null&&(typeof o.tabIndex=="number"?u=o.tabIndex:u=r?0:void 0,typeof o.role=="string"?d=o.role:d=r?"application":void 0),f.createElement(vP,zw({},o,{title:l,desc:c,role:d,tabIndex:u,width:n,height:s,style:t$e,ref:t}),i)}),n$e=e=>{var{children:t}=e,n=Bt(VN);if(!n)return null;var{width:s,height:r,y:i,x:o}=n;return f.createElement(vP,{width:s,height:r,x:o,y:i},t)},E7=f.forwardRef((e,t)=>{var{children:n}=e,s=JIe(e,ZIe),r=Hs();return r?f.createElement(n$e,null,f.createElement(k7,{isPanorama:!0},n)):f.createElement(a$e,zw({ref:t},s),f.createElement(k7,{isPanorama:!1},n))});function s$e(){var e=en(),[t,n]=f.useState(null),s=Bt(NAe);return f.useEffect(()=>{if(t!=null){var r=t.getBoundingClientRect(),i=r.width/t.offsetWidth;xn(i)&&i!==s&&e(sAe(i))}},[t,e,s]),n}function L7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function r$e(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?L7(Object(n),!0).forEach(function(s){i$e(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L7(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function i$e(e,t,n){return(t=o$e(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o$e(e){var t=l$e(e,"string");return typeof t=="symbol"?t:t+""}function l$e(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Wu(){return Wu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Wu.apply(null,arguments)}var c$e=()=>(gPe(),null);function Fw(e){if(typeof e=="number")return e;if(typeof e=="string"){var t=parseFloat(e);if(!Number.isNaN(t))return t}return 0}var d$e=f.forwardRef((e,t)=>{var n,s,r=f.useRef(null),[i,o]=f.useState({containerWidth:Fw((n=e.style)===null||n===void 0?void 0:n.width),containerHeight:Fw((s=e.style)===null||s===void 0?void 0:s.height)}),l=f.useCallback((u,d)=>{o(h=>{var p=Math.round(u),x=Math.round(d);return h.containerWidth===p&&h.containerHeight===x?h:{containerWidth:p,containerHeight:x}})},[]),c=f.useCallback(u=>{if(typeof t=="function"&&t(u),u!=null&&typeof ResizeObserver<"u"){var{width:d,height:h}=u.getBoundingClientRect();l(d,h);var p=v=>{var{width:j,height:y}=v[0].contentRect;l(j,y)},x=new ResizeObserver(p);x.observe(u),r.current=x}},[t,l]);return f.useEffect(()=>()=>{var u=r.current;u?.disconnect()},[l]),f.createElement(f.Fragment,null,f.createElement(QN,{width:i.containerWidth,height:i.containerHeight}),f.createElement("div",Wu({ref:c},e)))}),u$e=f.forwardRef((e,t)=>{var{width:n,height:s}=e,[r,i]=f.useState({containerWidth:Fw(n),containerHeight:Fw(s)}),o=f.useCallback((c,u)=>{i(d=>{var h=Math.round(c),p=Math.round(u);return d.containerWidth===h&&d.containerHeight===p?d:{containerWidth:h,containerHeight:p}})},[]),l=f.useCallback(c=>{if(typeof t=="function"&&t(c),c!=null){var{width:u,height:d}=c.getBoundingClientRect();o(u,d)}},[t,o]);return f.createElement(f.Fragment,null,f.createElement(QN,{width:r.containerWidth,height:r.containerHeight}),f.createElement("div",Wu({ref:l},e)))}),m$e=f.forwardRef((e,t)=>{var{width:n,height:s}=e;return f.createElement(f.Fragment,null,f.createElement(QN,{width:n,height:s}),f.createElement("div",Wu({ref:t},e)))}),f$e=f.forwardRef((e,t)=>{var{width:n,height:s}=e;return Ql(n)||Ql(s)?f.createElement(u$e,Wu({},e,{ref:t})):f.createElement(m$e,Wu({},e,{ref:t}))});function h$e(e){return e===!0?d$e:f$e}var g$e=f.forwardRef((e,t)=>{var{children:n,className:s,height:r,onClick:i,onContextMenu:o,onDoubleClick:l,onMouseDown:c,onMouseEnter:u,onMouseLeave:d,onMouseMove:h,onMouseUp:p,onTouchEnd:x,onTouchMove:v,onTouchStart:j,style:y,width:N,responsive:w,dispatchTouchEvents:S=!0}=e,_=f.useRef(null),k=en(),[T,A]=f.useState(null),[E,M]=f.useState(null),z=s$e(),P=$P(),D=P?.width>0?P.width:N,U=P?.height>0?P.height:r,B=f.useCallback(ge=>{z(ge),typeof t=="function"&&t(ge),A(ge),M(ge),ge!=null&&(_.current=ge)},[z,t,A,M]),R=f.useCallback(ge=>{k(oZ(ge)),k(di({handler:i,reactEvent:ge}))},[k,i]),q=f.useCallback(ge=>{k(WE(ge)),k(di({handler:u,reactEvent:ge}))},[k,u]),Z=f.useCallback(ge=>{k(QK()),k(di({handler:d,reactEvent:ge}))},[k,d]),V=f.useCallback(ge=>{k(WE(ge)),k(di({handler:h,reactEvent:ge}))},[k,h]),oe=f.useCallback(()=>{k(fZ())},[k]),je=f.useCallback(ge=>{k(mZ(ge.key))},[k]),X=f.useCallback(ge=>{k(di({handler:o,reactEvent:ge}))},[k,o]),se=f.useCallback(ge=>{k(di({handler:l,reactEvent:ge}))},[k,l]),ye=f.useCallback(ge=>{k(di({handler:c,reactEvent:ge}))},[k,c]),Ne=f.useCallback(ge=>{k(di({handler:p,reactEvent:ge}))},[k,p]),fe=f.useCallback(ge=>{k(di({handler:j,reactEvent:ge}))},[k,j]),we=f.useCallback(ge=>{S&&k(gZ(ge)),k(di({handler:v,reactEvent:ge}))},[k,S,v]),de=f.useCallback(ge=>{k(di({handler:x,reactEvent:ge}))},[k,x]),ke=h$e(w);return f.createElement(hX.Provider,{value:T},f.createElement(wY.Provider,{value:E},f.createElement(ke,{width:D??y?.width,height:U??y?.height,className:$t("recharts-wrapper",s),style:r$e({position:"relative",cursor:"default",width:D,height:U},y),onClick:R,onContextMenu:X,onDoubleClick:se,onFocus:oe,onKeyDown:je,onMouseDown:ye,onMouseEnter:q,onMouseLeave:Z,onMouseMove:V,onMouseUp:Ne,onTouchEnd:de,onTouchMove:we,onTouchStart:fe,ref:B},f.createElement(c$e,null),n)))}),p$e=["width","height","responsive","children","className","style","compact","title","desc"];function x$e(e,t){if(e==null)return{};var n,s,r=y$e(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)n=i[s],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function y$e(e,t){if(e==null)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;n[s]=e[s]}return n}var vZ=f.forwardRef((e,t)=>{var{width:n,height:s,responsive:r,children:i,className:o,style:l,compact:c,title:u,desc:d}=e,h=x$e(e,p$e),p=qr(h);return c?f.createElement(f.Fragment,null,f.createElement(QN,{width:n,height:s}),f.createElement(E7,{otherAttributes:p,title:u,desc:d},i)):f.createElement(g$e,{className:o,style:l,width:n,height:s,responsive:r??!1,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},f.createElement(E7,{otherAttributes:p,title:u,desc:d,ref:t},f.createElement(F5e,null,i)))});function VE(){return VE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},VE.apply(null,arguments)}var b$e={top:5,right:5,bottom:5,left:5},v$e={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,layout:"horizontal",margin:b$e,responsive:!1,reverseStackOrder:!1,stackOffset:"none",syncMethod:"index"},wZ=f.forwardRef(function(t,n){var s,r=Qn(t.categoricalChartProps,v$e),{chartName:i,defaultTooltipEventType:o,validateTooltipEventTypes:l,tooltipPayloadSearcher:c,categoricalChartProps:u}=t,d={chartName:i,defaultTooltipEventType:o,validateTooltipEventTypes:l,tooltipPayloadSearcher:c,eventEmitter:void 0};return f.createElement(xZ,{preloadedState:{options:d},reduxStoreName:(s=u.id)!==null&&s!==void 0?s:i},f.createElement(HX,{chartData:u.data}),f.createElement(yZ,{layout:r.layout,margin:r.margin}),f.createElement(bZ,{baseValue:r.baseValue,accessibilityLayer:r.accessibilityLayer,barCategoryGap:r.barCategoryGap,maxBarSize:r.maxBarSize,stackOffset:r.stackOffset,barGap:r.barGap,barSize:r.barSize,syncId:r.syncId,syncMethod:r.syncMethod,className:r.className,reverseStackOrder:r.reverseStackOrder}),f.createElement(vZ,VE({},r,{ref:n})))}),w$e=["axis"],j$e=f.forwardRef((e,t)=>f.createElement(wZ,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:w$e,tooltipPayloadSearcher:ED,categoricalChartProps:e,ref:t})),N$e=["axis","item"],C$e=f.forwardRef((e,t)=>f.createElement(wZ,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:N$e,tooltipPayloadSearcher:ED,categoricalChartProps:e,ref:t}));function S$e(e){var t=en();return f.useEffect(()=>{t(GIe(e))},[t,e]),null}var _$e=["layout"];function YE(){return YE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},YE.apply(null,arguments)}function A$e(e,t){if(e==null)return{};var n,s,r=T$e(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)n=i[s],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function T$e(e,t){if(e==null)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;n[s]=e[s]}return n}var k$e={top:5,right:5,bottom:5,left:5},jZ={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:k$e,reverseStackOrder:!1,syncMethod:"index",layout:"radial",responsive:!1,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},E$e=f.forwardRef(function(t,n){var s,r=Qn(t.categoricalChartProps,jZ),{layout:i}=r,o=A$e(r,_$e),{chartName:l,defaultTooltipEventType:c,validateTooltipEventTypes:u,tooltipPayloadSearcher:d}=t,h={chartName:l,defaultTooltipEventType:c,validateTooltipEventTypes:u,tooltipPayloadSearcher:d,eventEmitter:void 0};return f.createElement(xZ,{preloadedState:{options:h},reduxStoreName:(s=r.id)!==null&&s!==void 0?s:l},f.createElement(HX,{chartData:r.data}),f.createElement(yZ,{layout:i,margin:r.margin}),f.createElement(bZ,{baseValue:void 0,accessibilityLayer:r.accessibilityLayer,barCategoryGap:r.barCategoryGap,maxBarSize:r.maxBarSize,stackOffset:r.stackOffset,barGap:r.barGap,barSize:r.barSize,syncId:r.syncId,syncMethod:r.syncMethod,className:r.className,reverseStackOrder:r.reverseStackOrder}),f.createElement(S$e,{cx:r.cx,cy:r.cy,startAngle:r.startAngle,endAngle:r.endAngle,innerRadius:r.innerRadius,outerRadius:r.outerRadius}),f.createElement(vZ,YE({},o,{ref:n})))});function P7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function D7(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?P7(Object(n),!0).forEach(function(s){L$e(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P7(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function L$e(e,t,n){return(t=P$e(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function P$e(e){var t=D$e(e,"string");return typeof t=="symbol"?t:t+""}function D$e(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var O$e=["item"],M$e=D7(D7({},jZ),{},{layout:"centric",startAngle:0,endAngle:360}),I$e=f.forwardRef((e,t)=>{var n=Qn(e,M$e);return f.createElement(E$e,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:O$e,tooltipPayloadSearcher:ED,categoricalChartProps:n,ref:t})});const O7={user_id:"",start_date:"",end_date:"",target_amount:"",annual_amount:"",period_type:"",period_year:new Date().getFullYear(),period_number:1,prorate_first_period:!0,use_annual_mode:!0},NZ=[{value:"MONTHLY",label:"Monthly",divisor:12},{value:"QUARTERLY",label:"Quarterly",divisor:4},{value:"SEMIANNUAL",label:"Semi-Annual",divisor:2},{value:"ANNUAL",label:"Annual",divisor:1},{value:"CUSTOM",label:"Custom (Manual)",divisor:1}],M7=["#6366f1","#22c55e","#f97316","#0ea5e9","#a855f7","#f43f5e","#eab308","#8b5cf6","#10b981","#ec4899","#14b8a6","#f59e0b"];function $$e({name:e,items:t=[],value:n="",onChange:s,getLabel:r,placeholder:i="Search...",required:o=!1,isSubmitted:l=!1}){const[c,u]=f.useState(!1),[d,h]=f.useState(""),p=f.useRef(null),x=t.find(N=>String(N.id)===String(n)),v=x?r(x):"",j=o&&l&&!n,y=f.useMemo(()=>{const N=d.toLowerCase();return N?t.filter(w=>r(w).toLowerCase().includes(N)):t},[t,d,r]);return f.useEffect(()=>{const N=w=>{p.current&&!p.current.contains(w.target)&&u(!1)};return document.addEventListener("mousedown",N),()=>document.removeEventListener("mousedown",N)},[]),a.jsxs("div",{ref:p,className:"relative flex justify-center w-full",children:[a.jsx("input",{value:c?d:v,placeholder:i,onFocus:()=>u(!0),onChange:N=>{h(N.target.value),u(!0)},className:`w-full border rounded-lg p-1 text-gray-700 focus:outline-none focus:ring-1
          ${j?"border-red-500 focus:ring-red-400 focus:border-red-400":"border-gray-300 focus:ring-blue-400 focus:border-blue-400"}`}),c&&a.jsx("div",{className:"absolute top-full left-0 z-50 mt-1 w-full bg-white border border-gray-200 rounded-lg shadow-lg max-h-48 overflow-y-auto",children:y.length?y.map(N=>a.jsx("button",{type:"button",onClick:()=>{s({target:{name:e,value:String(N.id)}}),u(!1),h("")},className:"w-full text-left px-3 py-2 text-sm hover:bg-gray-50",children:r(N)},N.id)):a.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No results found"})})]})}function y1({currentUserRole:e,currentUserId:t}){const{user:n,mutate:s}=Vt(),r=n?.id,i=n?.company?.currency||"",o=i==="$"?Due:Mue;f.useEffect(()=>{s&&s()},[s]),f.useEffect(()=>{n?.company&&console.log("Dashboard detected Company Settings:",n.company)},[n]),f.useEffect(()=>{document.title="Targets | Sari-Sari CRM"},[]);const[l,c]=f.useState([]),[u,d]=f.useState([]),[h,p]=f.useState(!1),[x,v]=f.useState(""),[j,y]=f.useState(""),[N,w]=f.useState(1),[S,_]=f.useState(10),[k,T]=f.useState(!1),[A,E]=f.useState(!1),[M,z]=f.useState(!1),[P,D]=f.useState(null),[U,B]=f.useState(O7),[R,q]=f.useState(null),[Z,V]=f.useState(null),[oe,je]=f.useState(!1),[X,se]=f.useState([]),[ye,Ne]=f.useState(!1),[fe,we]=f.useState("annual"),[de,ke]=f.useState(1),[ge,$e]=f.useState("overview"),[be,me]=f.useState(null),[Ue,Ee]=f.useState(!1),[We,tt]=f.useState(null),[lt,Fe]=f.useState(!1),[st,Xe]=f.useState(""),[Ze,Je]=f.useState(null),[Be,_e]=f.useState(null),[pe,ce]=f.useState(new Date().getFullYear()),[Q,ne]=f.useState(""),[ae,Pe]=f.useState(1),Te=f.useMemo(()=>["CEO","ADMIN","GROUP MANAGER"].includes(e?.toUpperCase()),[e]),he=f.useMemo(()=>["CEO","ADMIN","GROUP MANAGER"].includes(e?.toUpperCase()),[e]),He=f.useCallback(async()=>{p(!0);try{const le=await re.get("/targets/admin/fetch-all");c(le.data)}catch(le){console.error(le),H.error("Failed to load targets.")}finally{p(!1)}},[]),qe=f.useCallback(async()=>{try{const le=await re.get("/targets/admin/get-users");d(le.data)}catch(le){console.error(le)}},[]),nt=f.useCallback(async()=>{try{const le=await re.get("/targets/fiscal-settings");_e(le.data)}catch(le){console.error("Failed to fetch fiscal settings:",le)}},[]),ot=f.useCallback(async()=>{Ee(!0);try{const le=new URLSearchParams;Q&&le.append("period_type",Q),pe&&le.append("period_year",pe),ae&&le.append("period_number",ae);const Ie=await re.get(`/targets/leaderboard?${le.toString()}`);me(Ie.data)}catch(le){console.error(le),H.error("Failed to load leaderboard.")}finally{Ee(!1)}},[Q,pe,ae]),Re=f.useCallback(async()=>{try{const le=new URLSearchParams;Q&&le.append("period_type",Q),pe&&le.append("period_year",pe),ae&&le.append("period_number",ae);const Ie=await re.get(`/targets/team-summary?${le.toString()}`);Je(Ie.data)}catch(le){console.error(le)}},[Q,pe,ae]),it=f.useCallback(async(le,Ie="")=>{Fe(!0);try{const K=Ie?`?period_type=${encodeURIComponent(Ie)}`:"",ie=await re.get(`/targets/history/${le}${K}`);tt(ie.data)}catch(K){console.error(K),H.error("Failed to load user history.")}finally{Fe(!1)}},[]);f.useEffect(()=>{He(),qe(),nt()},[He,qe,nt]),f.useEffect(()=>{ge==="leaderboard"&&(ot(),Re())},[ge,ot,Re]);const St=f.useMemo(()=>{const le=l.reduce((Me,Ke)=>Me+(Number(Ke.target_amount)||0),0),Ie=l.reduce((Me,Ke)=>Me+(Number(Ke.achieved_amount)||0),0),K=le>0?(Ie/le*100).toFixed(1):0,ie=Math.max(0,le-Ie);return{totalTarget:le,totalAchieved:Ie,achievement:K,remaining:ie,totalCount:l.length}},[l]),Et=f.useCallback(()=>(Ie=>fe==="annual"?Ie:Ie.filter(K=>{const ie=new Date(K.start_date),Me=new Date(K.end_date),Ke=ie.getMonth(),gt=Me.getMonth();let Ct=!1;if(fe==="semiannual")de===1?Ct=Ke<=5&&gt>=0:Ct=Ke<=11&&gt>=6;else if(fe==="trimester"){const da=[{start:0,end:3},{start:4,end:7},{start:8,end:11}][de-1];Ct=Ke<=da.end&&gt>=da.start}else if(fe==="quarterly"){const da=[{start:0,end:2},{start:3,end:5},{start:6,end:8},{start:9,end:11}][de-1];Ct=Ke<=da.end&&gt>=da.start}return Ct}))(l),[l,fe,de]),Tt=f.useMemo(()=>{const le=Et(),Ie={};le.forEach(Ke=>{const gt=Ke.user_id,Ct=Ke.user?`${Ke.user.first_name} ${Ke.user.last_name}`:"Unknown";Ie[gt]||(Ie[gt]={userId:gt,name:Ct,targetAmount:0,achievedAmount:0}),Ie[gt].targetAmount+=Number(Ke.target_amount)||0,Ie[gt].achievedAmount+=Number(Ke.achieved_amount)||0});const K=Object.values(Ie).map((Ke,gt)=>({...Ke,fill:M7[gt%M7.length]})),ie=K.reduce((Ke,gt)=>Ke+gt.targetAmount,0);return K.map(Ke=>({...Ke,percentage:ie>0?(Ke.targetAmount/ie*100).toFixed(1):0}))},[Et]),Nt=f.useMemo(()=>Tt.slice(0,8).map(le=>({name:le.name.split(" ")[0],achievement:Number(le.achievedAmount),target:Number(le.targetAmount)})),[Tt]),xe=f.useMemo(()=>{const le=Array.isArray(u)&&u.length?u:l.filter(ie=>ie.user&&ie.user.id).map(ie=>({id:ie.user.id,first_name:ie.user.first_name,last_name:ie.user.last_name})),Ie=new Set,K=[];for(const ie of le){const Me=String(ie.id);Ie.has(Me)||(Ie.add(Me),K.push(ie))}return K.sort((ie,Me)=>{const Ke=`${ie.first_name||""} ${ie.last_name||""}`.trim().toLowerCase(),gt=`${Me.first_name||""} ${Me.last_name||""}`.trim().toLowerCase();return Ke.localeCompare(gt)}),K},[u,l]),ve=f.useMemo(()=>{const le=x.toLowerCase();return l.filter(Ie=>{const K=!j||String(Ie.user?.id||"")===String(j),ie=Ie.user?`${Ie.user.first_name} ${Ie.user.last_name}`.toLowerCase():"";return K&&(ie.includes(le)||Ie.start_date?.includes(le)||Ie.end_date?.includes(le))})},[l,x,j]);f.useEffect(()=>{w(1)},[x,j]);const Oe=Math.max(1,Math.ceil(ve.length/S)),Ce=f.useMemo(()=>{const le=(N-1)*S;return ve.slice(le,le+S)},[ve,N,S]),Qe=le=>{const{name:Ie,value:K}=le.target;B(ie=>({...ie,[Ie]:K}))},G=()=>{B(O7),E(!1),D(null),Ne(!1),T(!0)},W=le=>{B({user_id:le.user?.id?String(le.user.id):"",start_date:le.start_date||"",end_date:le.end_date||"",target_amount:le.target_amount?.toString()||"",annual_amount:"",period_type:le.period_type||"CUSTOM",period_year:le.period_year||new Date().getFullYear(),period_number:le.period_number||1,prorate_first_period:!0,use_annual_mode:!1}),E(!0),D(le.id),Ne(!1),T(!0),q(null)},J=le=>{const Ie=le.user?`${le.user.first_name} ${le.user.last_name}`:"Unknown",K=e?.toUpperCase()==="GROUP MANAGER",ie=["CEO","ADMIN"].includes(e?.toUpperCase());if(K&&Number(le.created_by)!==Number(r)){H.error("You can only archive targets you created");return}V({title:ie?"Delete Target":"Archive Target",message:a.jsxs("span",{children:["Are you sure you want to ",ie?"delete":"archive"," the target for"," ",a.jsx("span",{className:"font-semibold",children:Ie}),"?"]}),confirmLabel:ie?"Delete":"Archive",cancelLabel:"Cancel",variant:ie?"danger":"archive",action:async()=>{await re.delete(`/targets/admin/${le.id}`),H.success(`Target ${ie?"deleted":"archived"} successfully.`),He(),q(null)}})},Y=()=>{const Ie=e?.toUpperCase()==="GROUP MANAGER"?Ce.filter(ie=>Number(ie.created_by)===Number(r)):Ce;if(Ie.length>0&&Ie.every(ie=>X.includes(ie.id))){const ie=Ie.map(Me=>Me.id);se(X.filter(Me=>!ie.includes(Me)))}else{const ie=Ie.map(Me=>Me.id);se([...new Set([...X,...ie])])}},F=le=>{const Ie=l.find(ie=>ie.id===le);e?.toUpperCase()==="GROUP MANAGER"&&Ie&&Number(Ie.created_by)!==Number(r)||se(ie=>ie.includes(le)?ie.filter(Me=>Me!==le):[...ie,le])},ue=async()=>{if(X.length===0)return;const le=e?.toUpperCase()==="GROUP MANAGER",Ie=["CEO","ADMIN"].includes(e?.toUpperCase());if(le&&!X.every(ie=>{const Me=l.find(Ke=>Ke.id===ie);return Me&&Number(Me.created_by)===Number(r)})){H.error("You can only archive targets you created");return}V({title:Ie?"Delete Targets":"Archive Targets",message:a.jsxs("span",{children:["Are you sure you want to ",Ie?"delete":"archive"," ",a.jsx("span",{className:"font-semibold",children:X.length})," selected targets?"]}),confirmLabel:`${Ie?"Delete":"Archive"} ${X.length} Target(s)`,cancelLabel:"Cancel",variant:Ie?"danger":"archive",action:async()=>{await re.post("/targets/admin/bulk-delete",{target_ids:X}),H.success(`Successfully ${Ie?"deleted":"archived"} ${X.length} targets`),se([]),He()}})},De=le=>{if(le.preventDefault(),Ne(!0),!U.user_id){H.error("Assign User is required.");return}if(!U.period_type){H.error("Period Type is required.");return}const Ie=U.use_annual_mode&&U.period_type!=="CUSTOM"&&!A;if(Ie){if(!U.annual_amount||Number(U.annual_amount)<=0){H.error("Annual target amount must be greater than 0.");return}}else if(!U.target_amount||Number(U.target_amount)<=0){H.error("Target amount must be greater than 0.");return}if(!Ie&&U.start_date&&U.end_date&&new Date(U.end_date)<new Date(U.start_date)){H.error("End date must be after start date.");return}const K=A?"Update Target":"Create Target(s)",ie=()=>{const gt=Number(U.period_number)||1;return U.period_type==="MONTHLY"?Math.max(1,12-gt+1):U.period_type==="QUARTERLY"?Math.max(1,4-gt+1):U.period_type==="SEMIANNUAL"?Math.max(1,2-gt+1):1},Me=()=>{const gt=Number(U.annual_amount)||0,Ct=NZ.find(Ht=>Ht.value===U.period_type);return Ct?(gt/Ct.divisor).toFixed(2):0},Ke=Ie?`This will create ${ie()} ${U.period_type?.toLowerCase()} target(s) for the selected user.

Annual Target: ${i}${Number(U.annual_amount).toLocaleString()}
Per Period: ${i}${Number(Me()).toLocaleString()}

The first period may be prorated if it starts mid-period.`:"Are you sure you want to proceed?";V({title:K,message:Ke,confirmLabel:K,cancelLabel:"Cancel",variant:"primary",action:async()=>{z(!0);try{if(A){const gt={user_id:Number(U.user_id),target_amount:Number(U.target_amount),start_date:U.start_date,end_date:U.end_date,period_type:U.period_type||"CUSTOM",period_year:U.period_year||new Date().getFullYear(),period_number:U.period_number||null};await re.put(`/targets/admin/${P}`,gt),H.success("Target updated successfully.")}else if(Ie){const gt=new Date().toISOString().split("T")[0],Ct={user_id:Number(U.user_id),annual_amount:Number(U.annual_amount),period_type:U.period_type,generation_date:U.start_date||gt,period_year:Number(U.period_year)||new Date().getFullYear(),period_number:Number(U.period_number)||1,prorate_first_period:U.prorate_first_period!==!1},Ht=await re.post("/targets/admin/create-annual-targets",Ct);He(),H.success(Ht.data.message||"Targets created successfully.")}else{const gt={user_id:Number(U.user_id),target_amount:Number(U.target_amount),start_date:U.start_date,end_date:U.end_date,period_type:U.period_type||"CUSTOM",period_year:U.period_year||new Date().getFullYear(),period_number:U.period_number||null};await re.post("/targets/admin/create",gt),He(),H.success("Target created successfully.")}T(!1),He()}catch(gt){console.error(gt);const Ct=gt.response?.data?.detail||gt.message||"Operation failed.";H.error(Ct)}finally{z(!1)}}})};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[h&&a.jsx(Wt,{message:"Loading targets..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h1",{className:"flex items-center text-xl sm:text-2xl font-semibold",children:[a.jsx(fr,{className:"mr-2 text-blue-600"})," Targets"]}),Te&&a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{onClick:G,className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 my-1 lg:my-0 rounded-md hover:bg-gray-800 text-sm sm:text-base mx-auto sm:ml-auto cursor-pointer",children:[a.jsx(aa,{className:"mr-2"})," Add Target"]})})]}),e?.toUpperCase()!=="SALES"&&a.jsxs("div",{className:"flex border-b border-gray-200 mb-6",children:[a.jsxs("button",{onClick:()=>$e("overview"),className:`px-4 py-3 text-sm font-medium border-b-2 transition ${ge==="overview"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[a.jsx(HI,{className:"inline mr-2"}),"Overview"]}),a.jsxs("button",{onClick:()=>$e("leaderboard"),className:`px-4 py-3 text-sm font-medium border-b-2 transition ${ge==="leaderboard"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[a.jsx(a2,{className:"inline mr-2"}),"Leaderboard"]}),a.jsxs("button",{onClick:()=>$e("history"),className:`px-4 py-3 text-sm font-medium border-b-2 transition ${ge==="history"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[a.jsx(zs,{className:"inline mr-2"}),"History"]})]}),ge==="overview"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[a.jsx(Fc,{title:"Total Targets",value:St.totalCount,icon:a.jsx(fr,{size:22}),color:"blue"}),a.jsx(Fc,{title:"Target Amount",value:`${i}${St.totalTarget.toLocaleString("en-US",{maximumFractionDigits:0})}`,icon:a.jsx(o,{size:22}),color:"green"}),a.jsx(Fc,{title:"Achieved Amount",value:`${i}${St.totalAchieved.toLocaleString("en-US",{maximumFractionDigits:0})}`,icon:a.jsx(cd,{size:22}),color:"purple"}),a.jsx(Fc,{title:"Achievement Rate",value:`${St.achievement}%`,icon:a.jsx(fr,{size:22}),color:"orange"})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[a.jsxs("div",{className:"bg-white rounded-xl shadow p-4 md:h-[420px] h-[350px] flex flex-col",children:[a.jsxs("div",{className:"mb-4 text-center",children:[a.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Sales Achievement"}),a.jsx("div",{className:"h-[38px] w-full invisible"})]}),Nt.length>0?a.jsx("div",{className:"flex-1 min-h-0 w-full",children:a.jsx(z_,{width:"100%",height:"100%",children:a.jsxs(C$e,{data:Nt,children:[a.jsx($E,{strokeDasharray:"3 3",vertical:!1}),a.jsx(HE,{dataKey:"name",tickLine:!1,axisLine:!1,tick:{fontSize:12,fill:"#6b7280"}}),a.jsx(GE,{tickLine:!1,axisLine:!1,label:{value:"Amount",angle:-90,position:"insideLeft",offset:3},domain:[0,le=>Math.ceil(le/50)*50],tick:{fontSize:12,fill:"#6b7280"}}),a.jsx(K_,{cursor:{fill:"rgba(0, 0, 0, 0.15)"},wrapperStyle:{outline:"none",zIndex:9999,pointerEvents:"auto"},contentStyle:{backgroundColor:"#ffffff",border:"2px solid #1f2937",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.2)",zIndex:9999,pointerEvents:"auto"},labelFormatter:le=>`Sales: ${le}`,formatter:(le,Ie,K)=>{if(!K||!K.payload)return[le,Ie];const ie=K.payload,Me=Number(ie.achievement)||0,Ke=Number(ie.target)||0,gt=Math.max(0,Ke-Me),Ct=Ke>0?(Me/Ke*100).toFixed(1):0;return Ie==="Achieved"?[`${i}${Me.toLocaleString()} (${Ct}%)`,"Achieved"]:Ie==="Remaining"?[`${i}${gt.toLocaleString()}`,"Remaining"]:[le,Ie]}}),a.jsx(UE,{dataKey:"achievement",stackId:"a",fill:"#10b981",name:"Achieved",label:({x:le,y:Ie,width:K,value:ie,payload:Me})=>{if(!Me||Me.target===void 0)return null;const Ke=(ie/Me.target*100).toFixed(0),gt=Ie-10<0?10:Ie-10;return a.jsxs("text",{x:le+K/2,y:gt,textAnchor:"middle",fill:"#111827",fontSize:10,fontWeight:500,children:[Ke,"%"]})}}),a.jsx(UE,{dataKey:le=>Math.max(0,le.target-le.achievement),stackId:"a",fill:"#e5e7eb",name:"Remaining",radius:[0,4,4,0]})]})})}):a.jsxs("div",{className:"flex flex-col items-center justify-center flex-1 text-gray-400",children:[a.jsx(Vie,{size:48,className:"mb-2 opacity-20"}),a.jsx("p",{className:"text-gray-500 font-medium text-center",children:"No sales data available"})]})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow p-4 md:h-[420px] h-[350px] flex flex-col",children:[a.jsxs("div",{className:"text-center mb-4",children:[a.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Target Distribution by Sales"}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 justify-center items-center flex-wrap",children:[a.jsxs("select",{value:fe,onChange:le=>{we(le.target.value),ke(1)},className:"border border-gray-300 rounded px-3 py-2 text-sm text-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"annual",children:"Annual"}),a.jsx("option",{value:"semiannual",children:"Every 6 Months"}),a.jsx("option",{value:"trimester",children:"Every 4 Months"}),a.jsx("option",{value:"quarterly",children:"Quarterly"})]}),fe!=="annual"&&a.jsxs("select",{value:de,onChange:le=>ke(parseInt(le.target.value)),className:"border border-gray-300 rounded px-3 py-2 text-sm text-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[fe==="semiannual"&&a.jsxs(a.Fragment,{children:[a.jsx("option",{value:1,children:"Jan - Jun"}),a.jsx("option",{value:2,children:"Jul - Dec"})]}),fe==="trimester"&&a.jsxs(a.Fragment,{children:[a.jsx("option",{value:1,children:"Jan - Apr"}),a.jsx("option",{value:2,children:"May - Aug"}),a.jsx("option",{value:3,children:"Sep - Dec"})]}),fe==="quarterly"&&a.jsxs(a.Fragment,{children:[a.jsx("option",{value:1,children:"Q1 (Jan - Mar)"}),a.jsx("option",{value:2,children:"Q2 (Apr - Jun)"}),a.jsx("option",{value:3,children:"Q3 (Jul - Sep)"}),a.jsx("option",{value:4,children:"Q4 (Oct - Dec)"})]})]})]})]}),Tt.length>0?a.jsx("div",{className:"flex-1 min-h-0 w-full",children:a.jsx(z_,{width:"100%",height:"100%",children:a.jsxs(I$e,{children:[a.jsx(K_,{contentStyle:{backgroundColor:"#fff",border:"1px solid #333",borderRadius:"6px",padding:"10px",boxShadow:"0 2px 8px rgba(0,0,0,0.15)",outline:"none"},content:({active:le,payload:Ie})=>{if(le&&Ie&&Ie.length>0){const K=Ie[0].payload;return a.jsxs("div",{className:"bg-white p-3 border border-gray-300 rounded shadow-lg",children:[a.jsx("p",{className:"text-sm font-semibold text-gray-800",children:K.name}),a.jsxs("p",{className:"text-xs text-blue-600 mt-1",children:[a.jsx("span",{className:"font-semibold",children:"Target Amount:"})," ",i,Number(K.targetAmount||0).toLocaleString("en-US",{maximumFractionDigits:0})]}),a.jsxs("p",{className:"text-xs text-purple-600 font-semibold mt-2",children:["Distribution: ",K.percentage,"%"]})]})}return null}}),a.jsx(FX,{data:Tt,dataKey:"targetAmount",nameKey:"name",cx:"50%",cy:"50%",outerRadius:80,label:({name:le,percentage:Ie,fill:K})=>a.jsxs("text",{fill:K,fontSize:12,fontWeight:600,children:[le.split(" ")[0],": ",Ie,"%"]}),labelLine:!1,isAnimationActive:!0,animationDuration:800})]})})}):a.jsxs("div",{className:"flex flex-col items-center justify-center flex-1 text-gray-400",children:[a.jsx(HI,{size:48,className:"mb-2 opacity-20"}),a.jsx("p",{className:"text-gray-500 font-medium text-center",children:"No targets data available"})]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col sm:flex-row items-stretch sm:items-center gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full sm:flex-1 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search targets...",value:x,onChange:le=>v(le.target.value),className:"w-full outline-none"})]}),a.jsx("div",{className:"w-full sm:w-64",children:a.jsxs("select",{value:j,onChange:le=>y(le.target.value),className:"w-full h-11 border border-gray-300 rounded-lg px-3 text-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[a.jsx("option",{value:"",children:"All users"}),xe.map(le=>a.jsx("option",{value:String(le.id),children:`${le.first_name||""} ${le.last_name||""}`.trim()||"Unknown"},le.id))]})})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full border border-gray-200 rounded-lg bg-white shadow-sm text-sm",children:[a.jsx("thead",{className:"bg-gray-100 font-semibold text-gray-600",children:a.jsxs("tr",{children:[he&&a.jsx("th",{className:"py-3 px-4 w-10",children:a.jsx("input",{type:"checkbox",className:"w-4 h-4 accent-blue-600",checked:Ce.length>0&&(e?.toUpperCase()==="GROUP MANAGER"?Ce.filter(le=>Number(le.created_by)===Number(r)).every(le=>X.includes(le.id))&&Ce.filter(le=>Number(le.created_by)===Number(r)).length>0:Ce.every(le=>X.includes(le.id))),onChange:Y})}),a.jsx("th",{className:"py-3 px-4 text-left",children:"User"}),a.jsx("th",{className:"py-3 px-4 text-left",children:"Target Amount"}),a.jsx("th",{className:"py-3 px-4 text-left",children:"Achieved Amount"}),a.jsx("th",{className:"py-3 px-4 text-left",children:"Achievement %"}),a.jsx("th",{className:"py-3 px-4 text-left",children:"Start Date"}),a.jsx("th",{className:"py-3 px-4 text-left",children:"End Date"}),["ADMIN","CEO"].includes(e?.toUpperCase())&&a.jsx("th",{className:"py-3 px-4 text-left",children:"Status"}),he&&a.jsx("th",{className:"py-3 px-4 text-center w-24",children:X.length>0?a.jsx("button",{onClick:ue,className:e?.toUpperCase()==="GROUP MANAGER"?"text-orange-500 hover:text-orange-700 transition p-1 rounded-full hover:bg-orange-50":"text-red-500 hover:text-red-700 transition p-1 rounded-full hover:bg-red-50",title:e?.toUpperCase()==="GROUP MANAGER"?`Archive ${X.length} selected targets`:`Delete ${X.length} selected targets`,children:e?.toUpperCase()==="GROUP MANAGER"?a.jsx(Zt,{size:18}):a.jsx(wa,{size:18})}):""})]})}),a.jsx("tbody",{children:Ce.length>0?Ce.map(le=>{const Ie=Number(le.target_amount)>0?(Number(le.achieved_amount)/Number(le.target_amount)*100).toFixed(1):0,ie=!(e?.toUpperCase()==="GROUP MANAGER")||Number(le.created_by)===Number(r);return a.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer border-b border-gray-200",children:[he&&a.jsx("td",{className:"py-3 px-4",onClick:Me=>Me.stopPropagation(),children:ie&&a.jsx("input",{type:"checkbox",className:"w-4 h-4 accent-blue-600",checked:X.includes(le.id),onChange:()=>F(le.id)})}),a.jsx("td",{className:"py-3 px-4 text-left font-medium",onClick:()=>q(le),children:le.user?`${le.user.first_name} ${le.user.last_name}`:"Unknown"}),a.jsxs("td",{className:"py-3 px-4 text-left",onClick:()=>q(le),children:[i,Number(le.target_amount).toLocaleString()]}),a.jsxs("td",{className:"py-3 px-4 text-left",onClick:()=>q(le),children:[i,Number(le.achieved_amount).toLocaleString()]}),a.jsx("td",{className:"py-3 px-4 text-left",onClick:()=>q(le),children:a.jsxs("span",{className:`px-2 py-1 rounded text-white text-xs font-semibold ${Ie>=100?"bg-green-500":Ie>=75?"bg-blue-500":Ie>=50?"bg-yellow-500":"bg-red-500"}`,children:[Ie,"%"]})}),a.jsx("td",{className:"py-3 px-4 text-left",onClick:()=>q(le),children:le.start_date}),a.jsx("td",{className:"py-3 px-4 text-left",onClick:()=>q(le),children:le.end_date}),["ADMIN","CEO"].includes(e?.toUpperCase())&&a.jsx("td",{className:"py-3 px-4 text-left",onClick:()=>q(le),children:a.jsx("span",{className:`px-2 py-1 rounded text-white text-xs font-semibold ${le.status&&le.status.toUpperCase()==="INACTIVE"?"bg-red-500":"bg-green-500"}`,children:le.status&&le.status.toUpperCase()==="INACTIVE"?"Inactive":"Active"})}),a.jsx("td",{})]},le.id)}):a.jsx("tr",{children:a.jsx("td",{colSpan:["ADMIN","CEO"].includes(e?.toUpperCase())?"9":"8",className:"py-4 px-4 text-center text-gray-500",children:"No targets found"})})})]})}),a.jsx(ca,{className:"mt-4",totalItems:ve.length,pageSize:S,currentPage:N,onPrev:()=>w(le=>Math.max(le-1,1)),onNext:()=>w(le=>Math.min(le+1,Oe)),onPageSizeChange:le=>{_(le),w(1)},pageSizeOptions:[10,20,30,40,50],label:"targets"})]}),ge==="leaderboard"&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm flex flex-wrap gap-4 items-center",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ot,{className:"text-gray-500"}),a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Filter by Period:"})]}),a.jsx("select",{value:pe,onChange:le=>ce(Number(le.target.value)),className:"border border-gray-300 rounded-lg px-3 py-2 text-sm",children:[...Array(5)].map((le,Ie)=>{const K=new Date().getFullYear()-Ie;return a.jsx("option",{value:K,children:K},K)})}),a.jsxs("select",{value:Q,onChange:le=>{ne(le.target.value),Pe(1)},className:"border border-gray-300 rounded-lg px-3 py-2 text-sm",children:[a.jsx("option",{value:"",children:"All Periods"}),a.jsx("option",{value:"MONTHLY",children:"Monthly"}),a.jsx("option",{value:"QUARTERLY",children:"Quarterly"}),a.jsx("option",{value:"SEMIANNUAL",children:"Semi-Annual"}),a.jsx("option",{value:"ANNUAL",children:"Annual"})]}),Q==="QUARTERLY"&&a.jsxs("select",{value:ae,onChange:le=>Pe(Number(le.target.value)),className:"border border-gray-300 rounded-lg px-3 py-2 text-sm",children:[a.jsx("option",{value:1,children:"Q1"}),a.jsx("option",{value:2,children:"Q2"}),a.jsx("option",{value:3,children:"Q3"}),a.jsx("option",{value:4,children:"Q4"})]}),Q==="SEMIANNUAL"&&a.jsxs("select",{value:ae,onChange:le=>Pe(Number(le.target.value)),className:"border border-gray-300 rounded-lg px-3 py-2 text-sm",children:[a.jsx("option",{value:1,children:"H1 (Jan-Jun)"}),a.jsx("option",{value:2,children:"H2 (Jul-Dec)"})]}),Q==="MONTHLY"&&a.jsx("select",{value:ae,onChange:le=>Pe(Number(le.target.value)),className:"border border-gray-300 rounded-lg px-3 py-2 text-sm",children:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].map((le,Ie)=>a.jsx("option",{value:Ie+1,children:le},Ie))}),a.jsx("button",{onClick:ot,className:"bg-blue-600 text-white px-4 py-2 rounded-lg text-sm hover:bg-blue-700",children:"Apply Filter"})]}),Ze&&a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[a.jsx(Fc,{title:"Sales Reps",value:Ze.total_sales_reps,icon:a.jsx(Za,{size:22}),color:"blue"}),a.jsx(Fc,{title:"Met Quota",value:Ze.above_target_count,icon:a.jsx(cd,{size:22}),color:"green"}),a.jsx(Fc,{title:"Below Quota",value:Ze.below_target_count,icon:a.jsx(n2,{size:22}),color:"orange"}),a.jsx(Fc,{title:"Team Achievement",value:`${Ze.overall_achievement}%`,icon:a.jsx(fr,{size:22}),color:"purple"})]}),Ue?a.jsx(Wt,{message:"Loading leaderboard..."}):be?.entries?.length>0?a.jsxs("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden",children:[a.jsx("div",{className:"p-4 border-b border-gray-200",children:a.jsxs("h2",{className:"text-lg font-semibold flex items-center",children:[a.jsx(a2,{className:"mr-2 text-yellow-500"}),"Sales Leaderboard",be.period_type!=="ALL"&&a.jsxs("span",{className:"ml-2 text-sm font-normal text-gray-500",children:["(",be.period_type," ",be.period_year,")"]})]})}),a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 text-left font-semibold text-gray-600",children:"Rank"}),a.jsx("th",{className:"py-3 px-4 text-left font-semibold text-gray-600",children:"Sales Rep"}),a.jsx("th",{className:"py-3 px-4 text-left font-semibold text-gray-600",children:"Role"}),a.jsx("th",{className:"py-3 px-4 text-right font-semibold text-gray-600",children:"Target"}),a.jsx("th",{className:"py-3 px-4 text-right font-semibold text-gray-600",children:"Achieved"}),a.jsx("th",{className:"py-3 px-4 text-right font-semibold text-gray-600",children:"Achievement"}),a.jsx("th",{className:"py-3 px-4 text-center font-semibold text-gray-600",children:"Actions"})]})}),a.jsx("tbody",{children:be.entries.map(le=>a.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`inline-flex items-center justify-center w-8 h-8 rounded-full font-bold text-sm ${le.rank===1?"bg-yellow-100 text-yellow-700":le.rank===2?"bg-gray-100 text-gray-700":le.rank===3?"bg-orange-100 text-orange-700":"bg-gray-50 text-gray-600"}`,children:le.rank})}),a.jsx("td",{className:"py-3 px-4 font-medium",children:le.user_name}),a.jsx("td",{className:"py-3 px-4 text-gray-500",children:le.role}),a.jsxs("td",{className:"py-3 px-4 text-right",children:[i,Number(le.target_amount).toLocaleString()]}),a.jsxs("td",{className:"py-3 px-4 text-right",children:[i,Number(le.achieved_amount).toLocaleString()]}),a.jsx("td",{className:"py-3 px-4 text-right",children:a.jsxs("span",{className:`px-2 py-1 rounded text-white text-xs font-semibold ${le.achievement_percentage>=100?"bg-green-500":le.achievement_percentage>=75?"bg-blue-500":le.achievement_percentage>=50?"bg-yellow-500":"bg-red-500"}`,children:[le.achievement_percentage,"%"]})}),a.jsx("td",{className:"py-3 px-4 text-center",children:a.jsx("button",{onClick:()=>{it(le.user_id),$e("history")},className:"text-blue-600 hover:text-blue-800 text-sm",children:"View History"})})]},le.user_id))})]})]}):a.jsxs("div",{className:"bg-white rounded-xl p-8 text-center text-gray-500",children:[a.jsx(a2,{size:48,className:"mx-auto mb-4 opacity-20"}),a.jsx("p",{children:"No leaderboard data available for the selected period."})]}),Ze?.needs_attention?.length>0&&a.jsxs("div",{className:"bg-red-50 rounded-xl p-4 border border-red-200",children:[a.jsxs("h3",{className:"text-lg font-semibold text-red-800 mb-3 flex items-center",children:[a.jsx(n2,{className:"mr-2"}),"Needs Attention (Below 50%)"]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:Ze.needs_attention.map(le=>a.jsxs("div",{className:"bg-white rounded-lg p-3 border border-red-100",children:[a.jsx("p",{className:"font-medium text-gray-800",children:le.user_name}),a.jsx("p",{className:"text-sm text-gray-500",children:le.role}),a.jsxs("div",{className:"mt-2 flex justify-between items-center",children:[a.jsxs("span",{className:"text-red-600 font-semibold",children:[le.achievement_percentage,"%"]}),a.jsxs("span",{className:"text-xs text-gray-500",children:[i,Number(le.remaining_amount).toLocaleString()," remaining"]})]})]},le.user_id))})]})]}),ge==="history"&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm",children:[a.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Select Sales Rep to View History:"}),a.jsxs("div",{className:"flex gap-4 flex-wrap",children:[a.jsxs("select",{onChange:le=>{const Ie=Number(le.target.value);Ie&&it(Ie,st)},className:"border border-gray-300 rounded-lg px-4 py-2 text-sm",value:We?.user_id||"",children:[a.jsx("option",{value:"",children:"-- Select User --"}),u.map(le=>a.jsxs("option",{value:le.id,children:[le.first_name," ",le.last_name]},le.id))]}),a.jsxs("select",{className:"border border-gray-300 rounded-lg px-4 py-2 text-sm",value:st,onChange:le=>{const Ie=le.target.value;Xe(Ie),We?.user_id&&it(Number(We.user_id),Ie)},children:[a.jsx("option",{value:"",children:"All period types"}),a.jsx("option",{value:"MONTHLY",children:"Monthly"}),a.jsx("option",{value:"QUARTERLY",children:"Quarterly"}),a.jsx("option",{value:"SEMIANNUAL",children:"Semi-Annual"}),a.jsx("option",{value:"ANNUAL",children:"Annual"}),a.jsx("option",{value:"CUSTOM",children:"Custom"})]})]})]}),lt?a.jsx(Wt,{message:"Loading history..."}):We?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[a.jsx("h2",{className:"text-xl font-semibold mb-4",children:We.user_name}),We.current_period&&We.previous_period&&a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[a.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[a.jsx("p",{className:"text-sm text-blue-600 font-medium",children:"Current Period"}),a.jsx("p",{className:"text-xs text-gray-500",children:We.current_period.period_label}),a.jsxs("p",{className:"text-2xl font-bold text-blue-700 mt-2",children:[We.current_period.achievement_percentage,"%"]}),a.jsxs("p",{className:"text-sm text-gray-600",children:[i,Number(We.current_period.achieved_amount).toLocaleString()," / ",i,Number(We.current_period.target_amount).toLocaleString()]})]}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[a.jsx("p",{className:"text-sm text-gray-600 font-medium",children:"Previous Period"}),a.jsx("p",{className:"text-xs text-gray-500",children:We.previous_period.period_label}),a.jsxs("p",{className:"text-2xl font-bold text-gray-700 mt-2",children:[We.previous_period.achievement_percentage,"%"]}),a.jsxs("p",{className:"text-sm text-gray-600",children:[i,Number(We.previous_period.achieved_amount).toLocaleString()," / ",i,Number(We.previous_period.target_amount).toLocaleString()]})]}),a.jsxs("div",{className:`rounded-lg p-4 ${We.growth_percentage>=0?"bg-green-50":"bg-red-50"}`,children:[a.jsx("p",{className:"text-sm font-medium",style:{color:We.growth_percentage>=0?"#16a34a":"#dc2626"},children:"Growth"}),a.jsxs("p",{className:`text-2xl font-bold mt-2 flex items-center ${We.growth_percentage>=0?"text-green-700":"text-red-700"}`,children:[We.growth_percentage>=0?a.jsx(cd,{className:"mr-2"}):a.jsx(n2,{className:"mr-2"}),We.growth_percentage>=0?"+":"",We.growth_percentage?.toFixed(1),"%"]}),a.jsxs("p",{className:"text-sm text-gray-600",children:[We.growth_amount>=0?"+":"",i,Number(We.growth_amount||0).toLocaleString()]})]})]}),We.periods?.length>0&&a.jsx("div",{className:"h-64",children:a.jsx(z_,{width:"100%",height:"100%",children:a.jsxs(j$e,{data:[...We.periods].reverse(),children:[a.jsx($E,{strokeDasharray:"3 3"}),a.jsx(HE,{dataKey:"period_label",tick:{fontSize:12}}),a.jsx(GE,{tick:{fontSize:12}}),a.jsx(K_,{formatter:(le,Ie)=>[`${i}${Number(le).toLocaleString()}`,Ie]}),a.jsx($Q,{}),a.jsx(RE,{type:"monotone",dataKey:"target_amount",stroke:"#6366f1",name:"Target",strokeWidth:2,dot:{r:2},activeDot:{r:5}}),a.jsx(RE,{type:"monotone",dataKey:"achieved_amount",stroke:"#22c55e",name:"Achieved",strokeWidth:2,dot:{r:3},activeDot:{r:6}})]})})})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden",children:[a.jsx("div",{className:"p-4 border-b border-gray-200",children:a.jsx("h3",{className:"font-semibold",children:"All Historical Periods"})}),a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 text-left font-semibold text-gray-600",children:"Period"}),a.jsx("th",{className:"py-3 px-4 text-left font-semibold text-gray-600",children:"Date Range"}),a.jsx("th",{className:"py-3 px-4 text-right font-semibold text-gray-600",children:"Target"}),a.jsx("th",{className:"py-3 px-4 text-right font-semibold text-gray-600",children:"Achieved"}),a.jsx("th",{className:"py-3 px-4 text-right font-semibold text-gray-600",children:"Achievement"})]})}),a.jsx("tbody",{children:We.periods.map((le,Ie)=>a.jsxs("tr",{className:"border-b border-gray-100",children:[a.jsx("td",{className:"py-3 px-4 font-medium",children:le.period_label}),a.jsxs("td",{className:"py-3 px-4 text-gray-500",children:[le.start_date," - ",le.end_date]}),a.jsxs("td",{className:"py-3 px-4 text-right",children:[i,Number(le.target_amount).toLocaleString()]}),a.jsxs("td",{className:"py-3 px-4 text-right",children:[i,Number(le.achieved_amount).toLocaleString()]}),a.jsx("td",{className:"py-3 px-4 text-right",children:a.jsxs("span",{className:`px-2 py-1 rounded text-white text-xs font-semibold ${le.achievement_percentage>=100?"bg-green-500":le.achievement_percentage>=75?"bg-blue-500":le.achievement_percentage>=50?"bg-yellow-500":"bg-red-500"}`,children:[le.achievement_percentage,"%"]})})]},Ie))})]})]})]}):a.jsxs("div",{className:"bg-white rounded-xl p-8 text-center text-gray-500",children:[a.jsx(zs,{size:48,className:"mx-auto mb-4 opacity-20"}),a.jsx("p",{children:"Select a sales rep to view their historical performance."})]})]})]}),R&&a.jsx(R$e,{target:R,currencySymbol:i,onClose:()=>q(null),onEdit:()=>W(R),onArchive:()=>J(R),canEdit:e?.toUpperCase()==="GROUP MANAGER"?R.created_by===null||Number(R.created_by)===Number(r):Te,canArchive:e?.toUpperCase()==="GROUP MANAGER"?R.created_by===null||Number(R.created_by)===Number(r):he,currentUserRole:e,currentUserId:r}),k&&Te&&a.jsx(z$e,{formData:U,users:u,isEditing:A,isSubmitting:M,isSubmitted:ye,onChange:Qe,onClose:()=>T(!1),onSubmit:De,fiscalSettings:Be}),Z&&a.jsx(F$e,{...Z,loading:oe,onConfirm:async()=>{je(!0),await Z.action(),je(!1),V(null)},onCancel:()=>V(null)})]})}function Fc({title:e,value:t,icon:n,color:s="blue"}){const r={blue:"bg-blue-100 text-blue-600",green:"bg-green-100 text-green-600",purple:"bg-purple-100 text-purple-600",orange:"bg-orange-100 text-orange-600"};return a.jsxs("div",{className:"flex items-center p-4 bg-white rounded-xl shadow-md border border-gray-200",children:[a.jsx("div",{className:`p-3 rounded-full ${r[s]} mr-4`,children:n}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:e}),a.jsx("p",{className:"text-xl font-bold",children:t})]})]})}function R$e({target:e,onClose:t,onEdit:n,onArchive:s,canEdit:r,canArchive:i,currencySymbol:o,currentUserRole:l,currentUserId:c}){const u=Number(e.target_amount)>0?(Number(e.achieved_amount)/Number(e.target_amount)*100).toFixed(1):0;return a.jsx("div",{className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center p-4",onClick:t,children:a.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-4xl max-h-[92vh] overflow-y-auto hide-scrollbar animate-scale-in font-inter relative",onClick:d=>d.stopPropagation(),children:[a.jsxs("div",{className:"bg-tertiary w-full flex items-center justify-between p-3 lg:p-4 rounded-t-xl",children:[a.jsx("h1",{className:"lg:text-3xl text-xl text-white font-semibold text-center w-full",children:"Target Details"}),a.jsx("button",{onClick:t,className:"text-gray-200 hover:text-white transition cursor-pointer",children:a.jsx(ea,{size:25})})]}),(r||i)&&a.jsxs("div",{className:"p-6 lg:p-4",children:[a.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between lg:flex-row lg:items-center lg:justify-between mt-3 gap-2 px-2 md:items-center lg:gap-4 md:mx-7 lg:mx-7",children:[a.jsx("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:a.jsx("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-800",children:e.user&&`${e.user.first_name} ${e.user.last_name}`})}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[r&&a.jsxs("button",{className:"inline-flex items-center justify-center w-full sm:w-auto bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 transition text-sm focus:outline-none focus:ring-2 focus:ring-blue-400 cursor-pointer",onClick:n,children:[a.jsx(gn,{className:"mr-2"}),"Edit"]}),i&&a.jsx("button",{className:`inline-flex items-center justify-center w-full sm:w-auto px-4 py-2 rounded-md text-sm text-white transition focus:outline-none cursor-pointer ${l?.toUpperCase()==="GROUP MANAGER"?"bg-orange-500 hover:bg-orange-600 focus:ring-2 focus:ring-orange-400":"bg-red-500 hover:bg-red-600 focus:ring-2 focus:ring-red-400"}`,onClick:s,children:l?.toUpperCase()==="GROUP MANAGER"?a.jsxs(a.Fragment,{children:[a.jsx(Zt,{className:"mr-2"}),"Archive"]}):a.jsxs(a.Fragment,{children:[a.jsx(wa,{className:"mr-2"}),"Delete"]})})]})]}),a.jsx("div",{className:"border-b border-gray-200 my-5"})]}),a.jsxs("div",{className:"p-4 lg:p-6",children:[a.jsx("div",{className:"flex w-full bg-gray-600 text-white overflow-x-auto",children:a.jsx("button",{className:"flex-1 min-w-[90px] px-4 py-2 lg:text-lg text-sm font-medium text-center text-white",children:"Overview"})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm sm:p-6 lg:p-5 border border-gray-200 text-sm text-gray-700",children:a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-gray-900",children:"Sales Person:"}),a.jsx("p",{children:e.user?`${e.user.first_name} ${e.user.last_name}`:"Unknown"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-gray-900",children:"Target Amount:"}),a.jsxs("p",{className:"text-green-600 font-semibold",children:[o,Number(e.target_amount).toLocaleString()]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-gray-900",children:"Achieved Amount:"}),a.jsxs("p",{className:"text-blue-600 font-semibold",children:[o,Number(e.achieved_amount).toLocaleString()]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-gray-900",children:"Achievement Rate:"}),a.jsxs("p",{className:`font-semibold ${u>=100?"text-green-600":u>=75?"text-blue-600":u>=50?"text-yellow-600":"text-red-600"}`,children:[u,"%"]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-gray-900",children:"Start Date:"}),a.jsx("p",{children:e.start_date})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-gray-900",children:"End Date:"}),a.jsx("p",{children:e.end_date})]})]})})]})]})})}function z$e({formData:e,users:t,isEditing:n,isSubmitting:s,onChange:r,onClose:i,onSubmit:o,fiscalSettings:l,isSubmitted:c}){const u=l?.fiscal_start_month||1,d=e.use_annual_mode!==!1&&e.period_type!=="CUSTOM"&&e.period_type!==""&&!n,h=c&&d&&(!e.annual_amount||Number(e.annual_amount)<=0),p=c&&!d&&(!e.target_amount||Number(e.target_amount)<=0),x=c&&!e.period_type,v=n||e.period_type==="CUSTOM",j=_=>{const k=_.getFullYear(),T=String(_.getMonth()+1).padStart(2,"0"),A=String(_.getDate()).padStart(2,"0");return`${k}-${T}-${A}`},y=(_,k,T)=>{let A,E;if(_==="MONTHLY")A=new Date(k,T-1,1),E=new Date(k,T,0);else if(_==="QUARTERLY"){const M=(T-1)*3,z=(u-1+M)%12;let P=k;u>1&&(z>=u-1?P=k-1:P=k),A=new Date(P,z,1);const D=(z+2)%12,U=z+2>=12?P+1:P;E=new Date(U,D+1,0)}else if(_==="SEMIANNUAL"){const M=(T-1)*6,z=(u-1+M)%12;let P=k;u>1&&(z>=u-1?P=k-1:P=k),A=new Date(P,z,1);const D=(z+5)%12,U=z+5>=12?P+1:P;E=new Date(U,D+1,0)}else if(_==="ANNUAL"){const M=u-1;let z=u>1?k-1:k;A=new Date(z,M,1);const P=(u-2+12)%12;E=new Date(z+1,P+1,0)}return{startDate:A,endDate:E}},N=_=>{const k=_.target.value;if(r({target:{name:"period_type",value:k}}),e.use_annual_mode!==!1&&k!=="CUSTOM"&&k!==""&&!n){e.start_date||r({target:{name:"start_date",value:new Date().toISOString().split("T")[0]}});return}if(k!=="CUSTOM"){const A=e.period_year||new Date().getFullYear(),E=e.period_number||1,{startDate:M,endDate:z}=y(k,A,E);M&&z&&(r({target:{name:"start_date",value:j(M)}}),r({target:{name:"end_date",value:j(z)}}))}},w=_=>{const k=Number(_.target.value);r({target:{name:"period_number",value:k}});const T=e.period_year||new Date().getFullYear(),A=e.period_type;if(A!=="CUSTOM"&&!d){const{startDate:E,endDate:M}=y(A,T,k);E&&M&&(r({target:{name:"start_date",value:j(E)}}),r({target:{name:"end_date",value:j(M)}}))}},S=_=>{const k=Number(_.target.value);r({target:{name:"period_year",value:k}});const T=e.period_type,A=e.period_number||1;if(T!=="CUSTOM"&&!d){const{startDate:E,endDate:M}=y(T,k,A);E&&M&&(r({target:{name:"start_date",value:j(E)}}),r({target:{name:"end_date",value:j(M)}}))}};return f.useEffect(()=>{if(!d&&e.period_type!=="CUSTOM"&&!e.start_date){const _=e.period_year||new Date().getFullYear(),k=e.period_number||1,{startDate:T,endDate:A}=y(e.period_type,_,k);T&&A&&(r({target:{name:"start_date",value:j(T)}}),r({target:{name:"end_date",value:j(A)}}))}},[l]),a.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-2xl p-8 relative overflow-y-auto max-h-[90vh] hide-scrollbar",children:[a.jsx("button",{onClick:i,className:"absolute top-5 right-5",children:a.jsx(ea,{size:24})}),a.jsx("h2",{className:"text-2xl font-semibold text-center mb-6",children:n?"Edit Target":"Add New Target"}),a.jsxs("form",{onSubmit:o,noValidate:!0,className:"grid gap-4 text-base",children:[a.jsxs("div",{className:"flex flex-col gap-1 relative",children:[a.jsxs("label",{className:"text-sm font-medium text-gray-700",children:["Assign User ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx($$e,{name:"user_id",items:t,value:e.user_id,onChange:r,getLabel:_=>`${_.first_name} ${_.last_name}`,placeholder:"Search user...",required:!0,isSubmitted:c})]}),a.jsxs("div",{className:"flex flex-col gap-1",children:[a.jsxs("label",{className:"text-sm font-medium text-gray-700 text-left",children:["Period Type ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("select",{name:"period_type",value:e.period_type,onChange:N,isSubmitted:c,className:`w-full border rounded-lg p-2 text-gray-700 focus:outline-none focus:ring-1
                ${x?"border-red-500 focus:ring-red-400 focus:border-red-400":"border-gray-300 focus:ring-blue-400 focus:border-blue-400"}`,children:[a.jsx("option",{value:"",children:"-- Choose Period Type --"}),NZ.map(_=>a.jsx("option",{value:_.value,children:_.label},_.value))]})]}),e.period_type&&e.period_type!=="CUSTOM"&&e.period_type!=="ANNUAL"&&a.jsxs("div",{className:"flex flex-col gap-1",children:[a.jsx("label",{className:"text-sm font-medium text-gray-700 text-left",children:e.period_type==="MONTHLY"?"Month":e.period_type==="QUARTERLY"?"Quarter":"Half"}),a.jsxs("select",{name:"period_number",value:e.period_number,onChange:w,required:!0,className:"w-full border text-gray-500 border-gray-300 rounded-lg p-2 focus:outline-none focus:ring-1 focus:ring-blue-400 focus:border-blue-400",children:[e.period_type==="MONTHLY"&&["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].map((_,k)=>a.jsx("option",{value:k+1,children:_},k)),e.period_type==="QUARTERLY"&&[1,2,3,4].map(_=>a.jsxs("option",{value:_,children:["Q",_," ",l?.quarters?.[`Q${_}`]?`(${l.quarters[`Q${_}`]})`:""]},_)),e.period_type==="SEMIANNUAL"&&[1,2].map(_=>a.jsxs("option",{value:_,children:["H",_," ",l?.halves?.[`H${_}`]?`(${l.halves[`H${_}`]})`:`(${_===1?"Jan-Jun":"Jul-Dec"})`]},_))]})]}),e.period_type&&e.period_type!=="CUSTOM"&&a.jsxs("div",{className:"flex flex-col gap-1",children:[a.jsx("label",{className:"text-sm font-medium text-gray-700 text-left",children:u!==1?"Fiscal Year":"Year"}),a.jsx("select",{name:"period_year",value:e.period_year,onChange:S,className:"w-full border text-gray-500 border-gray-300 rounded-lg p-2 focus:outline-none focus:ring-1 focus:ring-blue-400 focus:border-blue-400",children:[...Array(5)].map((_,k)=>{const T=new Date().getFullYear()+1-k;return a.jsx("option",{value:T,children:u!==1?`FY${T}`:T},T)})})]}),d&&a.jsxs("div",{className:"flex flex-col gap-1",children:[a.jsx("label",{className:"text-sm font-medium text-gray-700 text-left",children:"Start Date"}),a.jsx("div",{className:"flex justify-center w-full",children:a.jsx("input",{type:"date",name:"start_date",value:e.start_date,onChange:r,className:"w-full max-w-md border text-gray-500 border-gray-300 rounded-lg p-1 focus:outline-none focus:ring-1 focus:ring-blue-400 focus:border-blue-400"})}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Used to prorate the first period when enabled."})]}),d&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex flex-col gap-1",children:[a.jsxs("label",{className:"text-sm font-medium text-gray-700 text-left",children:["Annual Target Amount ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("div",{className:"flex justify-center w-full",children:a.jsx("input",{type:"number",name:"annual_amount",placeholder:"e.g., 12000000 for 12M",value:e.annual_amount,onChange:r,required:!0,className:`w-full max-w-md border rounded-lg p-2 text-gray-700 focus:outline-none focus:ring-1
                      ${h?"border-red-500 focus:ring-red-400 focus:border-red-400":"border-gray-300 focus:ring-blue-400 focus:border-blue-400"}`})}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Enter the full year target. It will be automatically divided based on the period type."})]}),e.annual_amount&&Number(e.annual_amount)>0&&a.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:[a.jsx("p",{className:"text-sm font-medium text-blue-800 mb-2",children:"Period Breakdown:"}),a.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[a.jsx("div",{className:"text-gray-600",children:"Annual:"}),a.jsx("div",{className:"text-right font-semibold text-gray-900",children:Number(e.annual_amount).toLocaleString()}),e.period_type==="MONTHLY"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"text-gray-600",children:["Monthly (",e.period_type,"):"]}),a.jsx("div",{className:"text-right font-semibold text-green-600",children:(Number(e.annual_amount)/12).toLocaleString(void 0,{maximumFractionDigits:2})})]}),e.period_type==="QUARTERLY"&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"text-gray-600",children:"Quarterly:"}),a.jsx("div",{className:"text-right font-semibold text-green-600",children:(Number(e.annual_amount)/4).toLocaleString(void 0,{maximumFractionDigits:2})})]}),e.period_type==="SEMIANNUAL"&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"text-gray-600",children:"Semi-Annual:"}),a.jsx("div",{className:"text-right font-semibold text-green-600",children:(Number(e.annual_amount)/2).toLocaleString(void 0,{maximumFractionDigits:2})})]}),e.period_type==="ANNUAL"&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"text-gray-600",children:"Full Year:"}),a.jsx("div",{className:"text-right font-semibold text-green-600",children:Number(e.annual_amount).toLocaleString(void 0,{maximumFractionDigits:2})})]})]}),a.jsx("p",{className:"text-xs text-blue-600 mt-2",children:"* First period may be prorated if starting mid-period"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",id:"prorate_first_period",name:"prorate_first_period",checked:e.prorate_first_period!==!1,onChange:_=>r({target:{name:"prorate_first_period",value:_.target.checked}}),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),a.jsx("label",{htmlFor:"prorate_first_period",className:"text-sm text-gray-700",children:"Prorate first period based on remaining days"})]})]}),v&&a.jsxs("div",{className:"flex flex-col gap-1",children:[a.jsxs("label",{className:"text-sm font-medium text-gray-700 text-left",children:["Target Amount ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("div",{className:"flex justify-center w-full",children:a.jsx("input",{type:"number",name:"target_amount",placeholder:"0.00",value:e.target_amount,onChange:r,required:!0,className:`w-full max-w-md border rounded-lg p-2 text-gray-700 focus:outline-none focus:ring-1
                    ${p?"border-red-500 focus:ring-red-400 focus:border-red-400":"border-gray-300 focus:ring-blue-400 focus:border-blue-400"}`})})]}),v&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex flex-col gap-1",children:[a.jsx("label",{className:"text-sm font-medium text-gray-700 text-left",children:"Start Date"}),a.jsx("div",{className:"flex justify-center w-full",children:a.jsx("input",{type:"date",name:"start_date",value:e.start_date,onChange:r,className:"w-full max-w-md border text-gray-500 border-gray-300 rounded-lg p-1 focus:outline-none focus:ring-1 focus:ring-blue-400 focus:border-blue-400"})})]}),a.jsxs("div",{className:"flex flex-col gap-1",children:[a.jsx("label",{className:"text-sm font-medium text-gray-700 text-left",children:"End Date"}),a.jsx("div",{className:"flex justify-center w-full",children:a.jsx("input",{type:"date",name:"end_date",value:e.end_date,onChange:r,className:"w-full max-w-md border text-gray-500 border-gray-300 rounded-lg p-1 focus:outline-none focus:ring-1 focus:ring-blue-400 focus:border-blue-400"})})]})]}),a.jsxs("div",{className:"flex justify-end gap-3 mt-4",children:[a.jsx("button",{type:"button",onClick:i,className:"bg-red-400 text-white px-5 py-2 rounded-lg",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:s,className:"bg-tertiary text-white px-5 py-2 rounded-lg hover:bg-tertiary/90 disabled:opacity-50",children:s?"Saving...":n?"Update Target":"Create Targets"})]})]})]})})}function F$e({title:e,message:t,confirmLabel:n,cancelLabel:s,variant:r,loading:i,onConfirm:o,onCancel:l}){return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:e}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:t}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{onClick:l,disabled:i,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",children:s}),a.jsx("button",{onClick:o,disabled:i,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${r==="archive"?"bg-orange-500 hover:bg-orange-600 border border-orange-400":r==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":"bg-tertiary hover:bg-tertiary/90 border border-tertiary"}`,children:i?"Processing...":n})]})]})})}function U$e(){const{userRole:e}=Ks();return a.jsx(y1,{currentUserRole:e,currentUserId:null})}const I7=[{value:"Product",label:"Product"},{value:"Service",label:"Service"}],uA={id:null,item_type:"Product",name:"",description:"",sku:"",variant:"",unit:"pcs",quantity:1,unit_price:0,discount_percent:0,discount_amount:0,line_total:0,sort_order:0},xb=e=>{const t=parseFloat(e.quantity)||0,n=parseFloat(e.unit_price)||0,s=parseFloat(e.discount_percent)||0,r=t*n,i=r*(s/100),o=r-i;return{discount_amount:i,line_total:o}},Uc=(e,t="")=>{const n=parseFloat(e)||0;return`${t}${n.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`};function jd({items:e=[],onChange:t,currencySymbol:n="",readOnly:s=!1,taxRate:r=0,discountType:i=null,discountValue:o=0,onTotalsChange:l}){const[c,u]=f.useState(null),[d,h]=f.useState(null),[p,x]=f.useState(!1),[v,j]=f.useState({...uA});f.useEffect(()=>{if(l){const E=e.reduce((U,B)=>U+(parseFloat(B.line_total)||0),0);let M=0;i==="percentage"&&o?M=E*(parseFloat(o)/100):i==="fixed"&&o&&(M=parseFloat(o));const z=E-M,P=z*(parseFloat(r)/100),D=z+P;l({subtotal:E,discount_amount:M,tax_amount:P,total_amount:D})}},[e,r,i,o,l]);const y=f.useCallback(()=>{if(!v.name.trim()){H.error("Item name is required");return}if(parseFloat(v.unit_price)<=0){H.error("Unit price must be greater than 0");return}if(parseFloat(v.quantity)<=0){H.error("Quantity must be greater than 0");return}const E=xb(v),M={...v,...E,sort_order:e.length};t([...e,M]),j({...uA}),x(!1),H.success("Item added")},[v,e,t]),N=E=>{if(!d){H.error("No item being edited");return}if(!d.name.trim()){H.error("Item name is required");return}if(parseFloat(d.unit_price)<=0){H.error("Unit price must be greater than 0");return}if(parseFloat(d.quantity)<=0){H.error("Quantity must be greater than 0");return}const M=xb(d),z={...d,...M},P=e.map((D,U)=>U===E?z:D);t(P),u(null),h(null),H.success("Item updated")},w=f.useCallback(E=>{const M=e.filter((z,P)=>P!==E);M.forEach((z,P)=>{z.sort_order=P}),t(M),H.success("Item removed")},[e,t]),S=f.useCallback((E,M)=>{const z=M==="up"?E-1:E+1;if(z<0||z>=e.length)return;const P=[...e];[P[E],P[z]]=[P[z],P[E]],P.forEach((D,U)=>{D.sort_order=U}),t(P)},[e,t]),_=E=>{u(E),h({...e[E]})},k=()=>{u(null),h(null)},T=e.reduce((E,M)=>E+(parseFloat(M.line_total)||0),0),A=(E,M)=>c===M&&!s?a.jsxs("tr",{className:"bg-blue-50",children:[a.jsx("td",{className:"px-3 py-2",children:a.jsx("select",{value:d.item_type,onChange:P=>h(D=>({...D,item_type:P.target.value})),className:"w-full px-2 py-1 border rounded text-sm",children:I7.map(P=>a.jsx("option",{value:P.value,children:P.label},P.value))})}),a.jsxs("td",{className:"px-3 py-2",children:[a.jsx("input",{type:"text",value:d.name,onChange:P=>h(D=>({...D,name:P.target.value})),className:"w-full px-2 py-1 border rounded text-sm",placeholder:"Name *"}),a.jsx("input",{type:"text",value:d.variant||"",onChange:P=>h(D=>({...D,variant:P.target.value})),className:"w-full px-2 py-1 border rounded text-sm mt-1",placeholder:"Variant (optional)"})]}),a.jsx("td",{className:"px-3 py-2",children:a.jsx("input",{type:"text",value:d.sku||"",onChange:P=>h(D=>({...D,sku:P.target.value})),className:"w-full px-2 py-1 border rounded text-sm",placeholder:"SKU"})}),a.jsx("td",{className:"px-3 py-2",children:a.jsxs("div",{className:"flex gap-1",children:[a.jsx("input",{type:"number",value:d.quantity,onChange:P=>h(D=>({...D,quantity:P.target.value})),className:"w-16 px-2 py-1 border rounded text-sm text-right",min:"0.01",step:"0.01"}),a.jsx("input",{type:"text",value:d.unit||"",onChange:P=>h(D=>({...D,unit:P.target.value})),className:"w-16 px-2 py-1 border rounded text-sm",placeholder:"Unit"})]})}),a.jsx("td",{className:"px-3 py-2",children:a.jsx("input",{type:"number",value:d.unit_price,onChange:P=>h(D=>({...D,unit_price:P.target.value})),className:"w-24 px-2 py-1 border rounded text-sm text-right",min:"0",step:"0.01"})}),a.jsx("td",{className:"px-3 py-2",children:a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("input",{type:"number",value:d.discount_percent||0,onChange:P=>h(D=>({...D,discount_percent:P.target.value})),className:"w-16 px-2 py-1 border rounded text-sm text-right",min:"0",max:"100",step:"0.01"}),a.jsx("span",{className:"text-sm text-gray-500",children:"%"})]})}),a.jsx("td",{className:"px-3 py-2 text-right font-medium",children:Uc(xb(d).line_total,n)}),a.jsx("td",{className:"px-3 py-2",children:a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{type:"button",onClick:()=>N(M),className:"p-1 text-green-600 hover:bg-green-100 rounded",title:"Save",children:a.jsx(jL,{size:16})}),a.jsx("button",{type:"button",onClick:k,className:"p-1 text-gray-600 hover:bg-gray-100 rounded",title:"Cancel",children:a.jsx(ea,{size:16})})]})})]},E.id||`edit-${M}`):a.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[a.jsx("td",{className:"px-3 py-2",children:a.jsx("span",{className:`inline-block px-2 py-0.5 rounded text-xs font-medium ${E.item_type==="Service"?"bg-purple-100 text-purple-700":"bg-blue-100 text-blue-700"}`,children:E.item_type})}),a.jsxs("td",{className:"px-3 py-2",children:[a.jsx("div",{className:"font-medium text-gray-900",children:E.name}),E.variant&&a.jsx("div",{className:"text-xs text-gray-500",children:E.variant}),E.description&&a.jsx("div",{className:"text-xs text-gray-400 mt-0.5",children:E.description})]}),a.jsx("td",{className:"px-3 py-2 text-gray-600 text-sm",children:E.sku||"-"}),a.jsxs("td",{className:"px-3 py-2 text-center",children:[a.jsx("span",{className:"font-medium",children:parseFloat(E.quantity).toLocaleString()}),E.unit&&a.jsx("span",{className:"text-gray-500 text-sm ml-1",children:E.unit})]}),a.jsx("td",{className:"px-3 py-2 text-right",children:Uc(E.unit_price,n)}),a.jsx("td",{className:"px-3 py-2 text-right text-sm",children:parseFloat(E.discount_percent)>0?a.jsxs("span",{className:"text-red-600",children:["-",parseFloat(E.discount_percent).toFixed(1),"%"]}):a.jsx("span",{className:"text-gray-400",children:"-"})}),a.jsx("td",{className:"px-3 py-2 text-right font-medium",children:Uc(E.line_total,n)}),!s&&a.jsx("td",{className:"px-3 py-2",children:a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{type:"button",onClick:()=>S(M,"up"),disabled:M===0,className:"p-1 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded disabled:opacity-30",title:"Move up",children:a.jsx(Kie,{size:14})}),a.jsx("button",{type:"button",onClick:()=>S(M,"down"),disabled:M===e.length-1,className:"p-1 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded disabled:opacity-30",title:"Move down",children:a.jsx(Pt,{size:14})}),a.jsx("button",{type:"button",onClick:()=>_(M),className:"p-1 text-blue-600 hover:bg-blue-100 rounded",title:"Edit",children:a.jsx(hn,{size:14})}),a.jsx("button",{type:"button",onClick:()=>w(M),className:"p-1 text-red-600 hover:bg-red-100 rounded",title:"Delete",children:a.jsx(wa,{size:14})})]})})]},E.id||`row-${M}`);return a.jsxs("div",{className:"border border-gray-300 rounded-lg overflow-hidden bg-white",children:[a.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gray-50 border border-gray-300",children:[a.jsxs("h3",{className:"font-semibold text-gray-800",children:["Line Items ",e.length>0&&a.jsxs("span",{className:"text-gray-500 font-normal",children:["(",e.length,")"]})]}),!s&&!p&&a.jsxs("button",{onClick:()=>x(!0),className:"flex items-center gap-1.5 px-3 py-1.5 bg-blue-600 text-white text-sm rounded hover:bg-blue-700 transition",children:[a.jsx(aa,{size:14}),"Add Item"]})]}),p&&!s&&a.jsxs("div",{className:"p-4 bg-blue-50 border border-gray-300",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Type"}),a.jsx("select",{value:v.item_type,onChange:E=>j({...v,item_type:E.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-3 focus:ring-blue-500 focus:border-blue-500",children:I7.map(E=>a.jsx("option",{value:E.value,children:E.label},E.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Name *"}),a.jsx("input",{type:"text",value:v.name,onChange:E=>j({...v,name:E.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-3 focus:ring-blue-500 focus:border-blue-500",placeholder:"Product/Service name"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"SKU"}),a.jsx("input",{type:"text",value:v.sku,onChange:E=>j({...v,sku:E.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-3 focus:ring-blue-500 focus:border-blue-500",placeholder:"Item code"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Variant"}),a.jsx("input",{type:"text",value:v.variant,onChange:E=>j({...v,variant:E.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-3 focus:ring-blue-500 focus:border-blue-500",placeholder:"Size, color, etc."})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Quantity *"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("input",{type:"number",value:v.quantity,onChange:E=>j({...v,quantity:E.target.value}),className:"w-20 px-3 py-2 border border-gray-300 rounded-lg text-sm text-right focus:ring-3 focus:ring-blue-500 focus:border-blue-500",min:"0.01",step:"0.01"}),a.jsx("input",{type:"text",value:v.unit,onChange:E=>j({...v,unit:E.target.value}),className:"w-20 px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-3 focus:ring-blue-500 focus:border-blue-500",placeholder:"Unit"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Unit Price *"}),a.jsxs("div",{className:"relative",children:[a.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500",children:n}),a.jsx("input",{type:"number",value:v.unit_price,onChange:E=>j({...v,unit_price:E.target.value}),className:"w-full pl-8 pr-3 py-2 border border-gray-300 rounded-lg text-sm text-right focus:ring-3 focus:ring-blue-500 focus:border-blue-500",min:"0",step:"0.01"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Discount %"}),a.jsx("input",{type:"number",value:v.discount_percent,onChange:E=>j({...v,discount_percent:E.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm text-right focus:ring-3 focus:ring-blue-500 focus:border-blue-500",min:"0",max:"100",step:"0.01"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Line Total"}),a.jsx("div",{className:"px-3 py-2 bg-gray-100 rounded-lg text-sm text-right font-medium",children:Uc(xb(v).line_total,n)})]})]}),a.jsxs("div",{className:"mt-3",children:[a.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Description (optional)"}),a.jsx("textarea",{value:v.description,onChange:E=>j({...v,description:E.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-3 focus:ring-blue-500 focus:border-blue-500",rows:2,placeholder:"Additional details about this item..."})]}),a.jsxs("div",{className:"flex justify-end gap-2 mt-3",children:[a.jsx("button",{onClick:()=>{x(!1),j({...uA})},className:"px-4 py-2 text-gray-600 bg-gray-100 rounded-lg hover:bg-gray-200 transition text-sm",children:"Cancel"}),a.jsx("button",{onClick:y,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition text-sm",children:"Add Item"})]})]}),e.length>0?a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50 border-b",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-600 w-20",children:"Type"}),a.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-600",children:"Item"}),a.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-600 w-24",children:"SKU"}),a.jsx("th",{className:"px-3 py-2 text-center font-medium text-gray-600 w-28",children:"Qty"}),a.jsx("th",{className:"px-3 py-2 text-right font-medium text-gray-600 w-28",children:"Price"}),a.jsx("th",{className:"px-3 py-2 text-right font-medium text-gray-600 w-20",children:"Disc."}),a.jsx("th",{className:"px-3 py-2 text-right font-medium text-gray-600 w-28",children:"Total"}),!s&&a.jsx("th",{className:"px-3 py-2 w-28"})]})}),a.jsx("tbody",{children:e.map((E,M)=>A(E,M))})]})}):a.jsxs("div",{className:"p-8 text-center text-gray-500",children:[a.jsx("p",{children:"No items added yet."}),!s&&a.jsx("button",{onClick:()=>x(!0),className:"mt-2 text-blue-600 hover:underline text-sm",children:"+ Add your first item"})]}),e.length>0&&a.jsx("div",{className:"border-t bg-gray-50 px-4 py-3",children:a.jsx("div",{className:"flex justify-end",children:a.jsxs("div",{className:"w-64 space-y-1",children:[a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-gray-600",children:"Subtotal:"}),a.jsx("span",{className:"font-medium",children:Uc(T,n)})]}),parseFloat(o)>0&&a.jsxs("div",{className:"flex justify-between text-sm text-red-600",children:[a.jsxs("span",{children:["Discount (",i==="percentage"?`${o}%`:"Fixed","):"]}),a.jsxs("span",{children:["-",Uc(i==="percentage"?T*(parseFloat(o)/100):parseFloat(o),n)]})]}),parseFloat(r)>0&&a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsxs("span",{className:"text-gray-600",children:["Tax (",r,"%):"]}),a.jsx("span",{children:Uc((T-(i==="percentage"?T*(parseFloat(o)/100):parseFloat(o)||0))*(parseFloat(r)/100),n)})]}),a.jsxs("div",{className:"flex justify-between text-base font-semibold pt-1 border-t",children:[a.jsx("span",{children:"Total:"}),a.jsx("span",{children:Uc((()=>{let E=0;i==="percentage"&&o?E=T*(parseFloat(o)/100):i==="fixed"&&o&&(E=parseFloat(o));const M=T-E,z=M*(parseFloat(r)/100);return M+z})(),n)})]})]})})})]})}const mA=[{value:"Draft",label:"Draft"},{value:"Presented",label:"Presented"},{value:"Accepted",label:"Accepted"},{value:"Rejected",label:"Rejected"}],fA={deal_id:"",account_id:"",contact_id:"",total_amount:"",presented_date:"",validity_days:"",status:"Draft",assigned_to:"",notes:"",subtotal:0,tax_rate:0,tax_amount:0,discount_type:"",discount_value:0,discount_amount:0,currency:"PHP",items:[]},$i=e=>{if(!e)return"Draft";const t=e.toString().trim().toLowerCase();return{draft:"Draft",presented:"Presented",accepted:"Accepted",rejected:"Rejected",inactive:"Inactive"}[t]||"Draft"},hA=e=>e?e.toString().toLowerCase().replace(/\b\w/g,t=>t.toUpperCase()):"--",B$e=e=>{switch($i(e).toLowerCase()){case"draft":return"bg-gray-100 text-gray-700";case"presented":return"bg-yellow-100 text-yellow-700";case"accepted":return"bg-green-100 text-green-700";case"rejected":return"bg-red-100 text-red-700";case"inactive":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-700"}},H$e=e=>{switch($i(e).toLowerCase()){case"draft":return"bg-gray-600 text-white";case"presented":return"bg-yellow-600 text-white";case"accepted":return"bg-green-600 text-white";case"rejected":return"bg-red-600 text-white";case"inactive":return"bg-red-600 text-white";default:return"bg-gray-600 text-white"}},yb=e=>e?new Date(e).toLocaleString("en-US",{month:"2-digit",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).replace(",",""):"",Tg=e=>e?new Date(e).toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"numeric"}):"",q$e=e=>{if(!e)return"";if(typeof e=="string"&&e.match(/^\d{4}-\d{2}-\d{2}$/))return e;try{const t=new Date(e);if(isNaN(t.getTime()))return"";const n=t.getFullYear(),s=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0");return`${n}-${s}-${r}`}catch{return""}},gA=(e,t)=>{if(!e||t==null||t==="")return"";const n=Number(t);if(Number.isNaN(n))return"";const s=new Date(e);return isNaN(s.getTime())?"":(s.setDate(s.getDate()+n),s.toISOString().slice(0,10))},$7=e=>{if(!e)return"";const t=String(e).split("-");return t.length===3?`${t[0]}-${t[2]}`:String(e)},pA=e=>{if(!e)return"";const t=String(e).split("-");return t.length===3?`${t[0]}-${t[2]}`:String(e)},Uw=e=>{if(!e)return null;if(typeof e=="number")return e;if(typeof e=="string"&&e.trim()&&!Number.isNaN(Number(e)))return Number(e);if(typeof e=="object"){if(e.id&&!Number.isNaN(Number(e.id)))return Number(e.id);if(e.user?.id&&!Number.isNaN(Number(e.user.id)))return Number(e.user.id);if(e.data?.id&&!Number.isNaN(Number(e.data.id)))return Number(e.data.id);if(e.profile?.id&&!Number.isNaN(Number(e.profile.id)))return Number(e.profile.id)}return null},G$e=()=>{const e=["user","currentUser","userData","authUser","profile"];for(const s of e){const r=localStorage.getItem(s);if(r)try{const i=JSON.parse(r),o=Uw(i);if(o)return o}catch{}}const t=localStorage.getItem("user_id"),n=Uw(t);return n||null},W$e=e=>{if(!e)return"";const n=[e.account_id,e.accountId,e.account?.id,e.account?.account_id,e.account?.accountId].find(s=>s!=null&&String(s).trim()!=="");return n?String(n):""},V$e=e=>{if(!e)return"";const n=[e.contact_id,e.contactId,e.contact?.id,e.primary_contact_id,e.primaryContactId,e.primary_contact?.id,e.primaryContact?.id].find(s=>s!=null&&String(s).trim()!=="");return n?String(n):""};function Y$e(){const e=kt(),t=ta(),{user:n}=Vt(),s=n?.company?.currency||"";f.useEffect(()=>{document.title="Quotes | Sari-Sari CRM"},[]);const[r,i]=f.useState([]),[o,l]=f.useState(!1),[c,u]=f.useState([]),[d,h]=f.useState([]),[p,x]=f.useState([]),[v,j]=f.useState([]),[y,N]=f.useState(null),[w,S]=f.useState(null),[_,k]=f.useState(!1),[T,A]=f.useState(!1),[E,M]=f.useState(!1),[z,P]=f.useState(null),[D,U]=f.useState(!1),[B,R]=f.useState(!1),[q,Z]=f.useState(null),[V,oe]=f.useState(fA),[je,X]=f.useState(""),[se,ye]=f.useState("Filter by Status"),[Ne,fe]=f.useState(null),we=f.useCallback(async()=>{if(w)try{R(!0);const I=(await re.get("/company/invoice-info"))?.data;e(`/admin/quotes/${encodeURIComponent(w.id)}/print`,{state:{quote:w,companyInfo:I}})}catch(Ae){const I=Ae?.response?.data?.detail||Ae?.message||"Failed to open print page.";H.error(I)}finally{R(!1)}},[w,s]),[de,ke]=f.useState(1),[ge,$e]=f.useState(10),[be,me]=f.useState("Overview"),[Ue,Ee]=f.useState("Draft"),[We,tt]=f.useState([]),[lt,Fe]=f.useState(null),{comments:st,addComment:Xe,refresh:Ze}=kn({relatedType:"quote",relatedId:w?.id});f.useEffect(()=>{w?.id&&Ze()},[w?.id,Ze]),f.useEffect(()=>{const I=t.state?.quoteID;if(I){Fe(I),e(t.pathname,{replace:!0,state:{}});return}},[t,e]),f.useEffect(()=>{if(lt&&r.length>0&&!o){const Ae=r.find(I=>I.id===lt);Ae?S(Ae):H.error("Quote not found."),Fe(null)}},[lt,p,o]),f.useEffect(()=>{let Ae=!0;return(async()=>{const L=G$e();if(L&&Ae){N(L);return}try{const ee=await re.get("/auth/me"),Le=Uw(ee?.data);if(Le&&Ae){N(Le);return}}catch{}try{const ee=await re.get("/users/me"),Le=Uw(ee?.data);if(Le&&Ae){N(Le);return}}catch{}Ae&&N(null)})(),()=>{Ae=!1}},[]);const Je=f.useCallback(Ae=>Ae&&d.find(L=>String(L.id)===String(Ae))?.name||"",[d]),Be=f.useCallback(Ae=>{if(!Ae)return"";const I=p.find(L=>String(L.id)===String(Ae));return I?`${I.first_name} ${I.last_name}`.trim():""},[p]),_e=f.useCallback(Ae=>{if(!Ae)return"--";const I=c.find(L=>String(L.id)===String(Ae));return I?.deal_name||I?.name||`Deal #${$7(Ae)}`},[c]),pe=f.useCallback(Ae=>{const I=c.find(Le=>String(Le.id)===String(Ae)),L=W$e(I);let ee=V$e(I);if(!ee&&L){const Le=p.filter(ze=>String(ze.account_id||"")===String(L));if(Le.length>0){const ze=[...Le].sort((Ve,ft)=>{const _t=`${Ve.first_name||""} ${Ve.last_name||""}`.trim().toLowerCase(),At=`${ft.first_name||""} ${ft.last_name||""}`.trim().toLowerCase();return _t.localeCompare(At)});ee=String(ze[0].id)}}if(L&&ee){const Le=p.find(ze=>String(ze.id)===String(ee));Le?.account_id&&String(Le.account_id)!==String(L)&&(ee="")}return{accountId:L||"",contactId:ee||""}},[c,p]),ce=f.useCallback(Ae=>{if(!Ae)return"--";if(Ae.deal?.deal_name)return Ae.deal.deal_name;if(Ae.deal?.name)return Ae.deal.name;const I=Ae.deal_id||Ae.deal?.id;return I?_e(I):"--"},[_e]),Q=f.useCallback(Ae=>{if(!Ae)return"--";if(Ae.account?.name)return Ae.account.name;let I=Ae.account_id||Ae.account?.id;if(!I){const L=Ae.deal_id||Ae.deal?.id;L&&(I=pe(L).accountId)}return I?Je(I)||`Account #${I}`:"--"},[pe,Je]),ne=f.useCallback(Ae=>{if(!Ae)return"--";if(Ae.contact?.first_name||Ae.contact?.last_name)return`${Ae.contact?.first_name||""} ${Ae.contact?.last_name||""}`.trim()||"--";let I=Ae.contact_id||Ae.contact?.id;if(!I){const ee=Ae.deal_id||Ae.deal?.id;ee&&(I=pe(ee).contactId)}return(I?Be(I):"")||(I?`Contact #${I}`:"--")},[pe,Be]),ae=f.useCallback(async(Ae=null)=>{l(!0);try{const I=await re.get("/quotes/admin/fetch-all"),ee=[...Array.isArray(I.data)?I.data:[]].sort((Le,ze)=>{const Ve=Le?.created_at||Le?.updated_at||0,ft=ze?.created_at||ze?.updated_at||0;return new Date(ft)-new Date(Ve)});if(i(ee),Ae){const Le=ee.find(ze=>ze.id===Ae);S(Le||null)}}catch(I){console.error(I),i([]),I.response?.status===403?H.error("Permission denied. Only CEO, Admin, or Group Manager can access this page."):H.error("Failed to fetch quotes. Please try again later.")}finally{l(!1)}},[]),Pe=f.useCallback(async()=>{try{const Ae=await re.get("/deals/admin/fetch-all");u(Array.isArray(Ae.data)?Ae.data:[])}catch(Ae){console.error(Ae),Ae.response?.status===403&&H.warn("Unable to load deals (permission denied).")}},[]),Te=f.useCallback(async()=>{try{const Ae=await re.get("/accounts/admin/fetch-all");h(Array.isArray(Ae.data)?Ae.data:[])}catch(Ae){console.error(Ae),Ae.response?.status===403&&H.warn("Unable to load accounts (permission denied).")}},[]),he=f.useCallback(async()=>{try{const Ae=await re.get("/contacts/admin/fetch-all");x(Array.isArray(Ae.data)?Ae.data:[])}catch(Ae){console.error(Ae),Ae.response?.status===403&&H.warn("Unable to load contacts (permission denied).")}},[]),He=f.useCallback(async()=>{try{const Ae=await re.get("/users/all");j(Array.isArray(Ae.data)?Ae.data:[])}catch(Ae){console.error(Ae),Ae.response?.status===403&&H.warn("Unable to load users (permission denied).")}},[]);f.useEffect(()=>{ae(),Pe(),Te(),he(),He()},[ae,Pe,Te,he,He]);const qe=f.useMemo(()=>{const Ae=je.trim().toLowerCase(),I=se.trim();return r.filter(L=>{const ee=ce(L),Le=Q(L),ze=ne(L),Ve=gA(L.presented_date,L.validity_days),ft=[L.quote_id,ee,Le,ze,L.total_amount?.toString(),L.validity_days?.toString(),L.presented_date?Tg(L.presented_date):"",Ve?Tg(Ve):"",L.assigned_user?.first_name,L.assigned_user?.last_name,L.creator?.first_name,L.creator?.last_name,L.status,L.notes,yb(L.created_at),yb(L.updated_at)],_t=Ae===""||ft.some(Yt=>Yt==null?!1:Yt.toString().toLowerCase().includes(Ae)),At=I==="Filter by Status"||$i(L.status)===I;return _t&&At})},[r,je,se,ce,Q,ne]),nt=Math.max(1,Math.ceil(qe.length/ge)||1);f.useEffect(()=>ke(1),[je,se]),f.useEffect(()=>{ke(Ae=>{const I=Math.max(1,Math.ceil(qe.length/ge)||1);return Ae>I?I:Ae})},[qe.length,ge]);const ot=f.useMemo(()=>{const Ae=(de-1)*ge;return qe.slice(Ae,Ae+ge)},[qe,de,ge]),Re=()=>ke(Ae=>Math.max(Ae-1,1)),it=()=>ke(Ae=>Math.min(Ae+1,nt)),St=Ae=>{S(Ae),me("Overview"),Ee($i(Ae?.status)||"Draft")},Et=()=>{S(null),me("Overview")},Tt=Ae=>{Ae.target.id==="quoteModalBackdrop"&&!D&&Et()},Nt=f.useCallback(()=>{k(!1),A(!1),Z(null),oe(fA),M(!1)},[]),xe=Ae=>{Ae.target.id==="modalBackdrop"&&!E&&!D&&Nt()},ve=Ae=>{const{name:I,value:L}=Ae.target;if(I==="deal_id"){const{accountId:ee,contactId:Le}=pe(L);oe(ze=>({...ze,deal_id:L,account_id:ee,contact_id:Le}));return}oe(ee=>({...ee,[I]:L}))},Oe=()=>{const Ae=n?.company?.tax_rate??0;oe({...fA,tax_rate:Ae}),A(!1),Z(null),k(!0)},Ce=Ae=>{if(!Ae)return;S(null);const I=Ae.deal?.id?String(Ae.deal.id):Ae.deal_id?String(Ae.deal_id):"",L=I?pe(I):{accountId:"",contactId:""},ee=Ae.account?.id?String(Ae.account.id):Ae.account_id?String(Ae.account_id):L.accountId,Le=Ae.contact?.id?String(Ae.contact.id):Ae.contact_id?String(Ae.contact_id):L.contactId,ze=Ae.assigned_user?.id?String(Ae.assigned_user.id):Ae.assigned_to?String(Ae.assigned_to):"";oe({deal_id:I,account_id:ee||"",contact_id:Le||"",total_amount:Ae.total_amount?.toString()||"",presented_date:q$e(Ae.presented_date),validity_days:Ae.validity_days!==null&&Ae.validity_days!==void 0?String(Ae.validity_days):"",status:$i(Ae.status)||"Draft",assigned_to:ze,notes:Ae.notes||"",subtotal:parseFloat(Ae.subtotal)||0,tax_rate:parseFloat(Ae.tax_rate)||0,tax_amount:parseFloat(Ae.tax_amount)||0,discount_type:Ae.discount_type||"",discount_value:parseFloat(Ae.discount_value)||0,discount_amount:parseFloat(Ae.discount_amount)||0,currency:Ae.currency||"PHP",items:Array.isArray(Ae.items)?Ae.items.map(Ve=>({id:Ve.id,item_type:Ve.item_type||"Product",name:Ve.name||"",description:Ve.description||"",sku:Ve.sku||"",variant:Ve.variant||"",unit:Ve.unit||"pcs",quantity:parseFloat(Ve.quantity)||1,unit_price:parseFloat(Ve.unit_price)||0,discount_percent:parseFloat(Ve.discount_percent)||0,discount_amount:parseFloat(Ve.discount_amount)||0,line_total:parseFloat(Ve.line_total)||0,sort_order:Ve.sort_order||0})):[]}),A(!0),Z(Ae.id),k(!0)},Qe=Ae=>{if(Ae.target.checked){const I=ot.map(L=>L.id);tt(I)}else tt([])},G=Ae=>{tt(I=>I.includes(Ae)?I.filter(L=>L!==Ae):[...I,Ae])},W=Ae=>{if(!Ae)return;const I=Ae.quote_id||"this quote";P({title:"Delete Quote",message:a.jsxs("span",{children:["Are you sure you want to permanently delete"," ",a.jsx("span",{className:"font-semibold",children:I}),"? This action cannot be undone."]}),confirmLabel:"Delete Quote",cancelLabel:"Cancel",variant:"danger",action:{type:"delete",targetId:Ae.id,name:I}})},J=async()=>{We.length!==0&&P({title:"Delete Quotes",message:a.jsxs("span",{children:["Are you sure you want to delete"," ",a.jsx("span",{className:"font-semibold",children:We.length})," selected quotes? This action cannot be undone."]}),confirmLabel:`Delete ${We.length} Quote(s)`,cancelLabel:"Cancel",variant:"danger",action:{type:"bulk-delete",quote_ids:We}})},[Y,F]=f.useState(!1),ue=Ae=>{if(Ae.preventDefault(),F(!0),!y){H.error("Unable to determine current user. Please log in again.");return}if(!V.deal_id){H.error("Deal is required.");return}if(!V.assigned_to){H.error("Assigned To is required.");return}const L=pe(V.deal_id),ee=V.items.map((_t,At)=>({item_type:_t.item_type||"Product",name:_t.name,description:_t.description||null,sku:_t.sku||null,variant:_t.variant||null,unit:_t.unit||null,quantity:parseFloat(_t.quantity)||1,unit_price:parseFloat(_t.unit_price)||0,discount_percent:parseFloat(_t.discount_percent)||0,sort_order:_t.sort_order??At})),Le={deal_id:Number(V.deal_id),account_id:L.accountId?Number(L.accountId):null,contact_id:L.contactId?Number(L.contactId):null,subtotal:parseFloat(V.subtotal)||0,tax_rate:parseFloat(V.tax_rate)||0,tax_amount:parseFloat(V.tax_amount)||0,discount_type:V.discount_type||null,discount_value:parseFloat(V.discount_value)||0,discount_amount:parseFloat(V.discount_amount)||0,total_amount:parseFloat(V.total_amount)||0,currency:V.currency||"PHP",presented_date:V.presented_date||null,validity_days:V.validity_days===""?null:Number(V.validity_days),status:V.status||"Draft",assigned_to:V.assigned_to?Number(V.assigned_to):null,notes:V.notes?.trim()||null,items:ee},ze=T&&q?"update":"create",Ve=_e(V.deal_id),ft=ze==="create"?{...Le,created_by_id:Number(y)}:Le;P({title:ze==="create"?"Confirm New Quote":"Confirm Update",message:ze==="create"?a.jsxs("span",{children:["Are you sure you want to create a quote for"," ",a.jsx("span",{className:"font-semibold",children:Ve}),"?"]}):a.jsxs("span",{children:["Save changes to"," ",a.jsx("span",{className:"font-semibold",children:Ve}),"?"]}),confirmLabel:ze==="create"?"Create Quote":"Update Quote",cancelLabel:"Cancel",variant:"primary",action:{type:ze,payload:ft,targetId:q||null,name:Ve}})},De=async()=>{if(!z?.action){P(null);return}const{action:Ae}=z,{type:I,payload:L,targetId:ee,name:Le}=Ae;U(!0);try{if(I==="create")M(!0),await re.post("/quotes/admin",L),H.success("Quote created successfully."),Nt(),await ae();else if(I==="update"){if(!ee)throw new Error("Missing quote identifier for update.");M(!0),await re.put(`/quotes/admin/${ee}`,L),H.success("Quote updated successfully."),Nt(),await ae(),w?.id===ee&&S(null)}else if(I==="delete"){if(!ee)throw new Error("Missing quote identifier for deletion.");const ze=w?.id;fe(ee),await re.delete(`/quotes/admin/${ee}`),H.success(`Quote "${Le}" deleted successfully.`),await ae(ze&&ze!==ee?ze:null),ze===ee&&S(null)}else I==="bulk-delete"&&(await re.post("/quotes/admin/bulk-delete",{quote_ids:We}),H.success(`Successfully deleted ${We.length} quotes`),tt([]),await ae())}catch(ze){console.error(ze);const Ve=I==="create"?"Failed to create quote. Please review the details and try again.":I==="update"?"Failed to update quote. Please review the details and try again.":"Failed to delete quote. Please try again.";H.error(Ve),(I==="create"||I==="update")&&M(!1),I==="delete"&&fe(null)}finally{(I==="create"||I==="update")&&M(!1),I==="delete"&&fe(null),U(!1),P(null)}},le=()=>{D||P(null)},Ie=f.useCallback((Ae,I)=>{const L=Ae?.deal_id??Ae?.deal?.id??"",ee=L?Number(L):null,Le=ee?pe(String(ee)):{accountId:"",contactId:""},ze=Ae?.account_id??Ae?.account?.id??Le.accountId??null,Ve=Ae?.contact_id??Ae?.contact?.id??Le.contactId??null,ft=Ae?.total_amount??0,_t=Ae?.assigned_to??Ae?.assigned_user?.id??null;return{deal_id:ee,account_id:ze!=null&&String(ze).trim()!==""?Number(ze):null,contact_id:Ve!=null&&String(Ve).trim()!==""?Number(Ve):null,total_amount:Number(ft),presented_date:Ae?.presented_date||null,validity_days:Ae?.validity_days===""||Ae?.validity_days===void 0||Ae?.validity_days===null?null:Number(Ae.validity_days),status:I,assigned_to:_t!=null&&String(_t).trim()!==""?Number(_t):null,notes:Ae?.notes?.trim()||null}},[pe]),K=f.useCallback(async()=>{if(!w?.id)return;const Ae=$i(Ue),I=[Ae,Ae.toLowerCase()],L=async ee=>re.patch(`/quotes/admin/${w.id}/status`,{status:ee},{headers:{"Content-Type":"application/json"}});try{let ee=!1;for(const Le of I)try{await L(Le),ee=!0;break}catch(ze){if(ze?.response?.status===422)continue;throw ze}if(!ee){const Le=Ie(w,Ae);if(!Le.deal_id){H.error("Cannot update status: missing deal_id on selected quote.");return}if(!Le.total_amount||Le.total_amount<=0){H.error("Cannot update status: missing/invalid total_amount on selected quote.");return}await re.put(`/quotes/admin/${w.id}`,Le)}H.success(`Quote status updated to ${Ae}`),S(null),me("Overview"),await ae()}catch(ee){console.error(ee);const Le=ee?.response?.data?.message||(ee?.response?.data?.errors?Object.values(ee.response.data.errors).flat().join(" "):null)||"Failed to update quote status. Please try again.";H.error(Le)}},[w,Ue,ae,Ie]),ie=[{label:"Filter by Status",value:"Filter by Status"},...mA.map(Ae=>({label:Ae.label,value:Ae.value}))],Me=z?.action?.type==="delete"?z.action.targetId:null,Ke=w&&(Ne===w.id||Me===w.id),gt=w&&Ne===w.id,Ct=w?a.jsx("div",{id:"quoteModalBackdrop",onClick:Tt,className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-6xl max-h-[92vh] overflow-y-auto hide-scrollbar animate-scale-in font-inter relative",onClick:Ae=>Ae.stopPropagation(),children:[a.jsx("div",{className:"w-full flex flex-col items-center justify-center rounded-t-xl",children:a.jsxs("div",{className:"bg-tertiary w-full flex items-center justify-between p-3 lg:p-3 rounded-t-xl",children:[a.jsx("h1",{className:"lg:text-3xl text-xl text-white font-semibold text-center w-full",children:"Quotes"}),a.jsx("button",{onClick:Et,className:"text-gray-500 hover:text-white transition cursor-pointer",children:a.jsx(Ja,{size:25})})]})}),a.jsxs("div",{className:"p-6 lg:p-4",children:[a.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between lg:flex-row lg:items-center lg:justify-between mt-3 gap-2 px-2 md:items-center lg:gap-4 md:mx-7 lg:mx-7",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[a.jsx("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-800",children:ce(w)}),a.jsx("span",{className:`text-xs sm:text-sm font-medium px-2 sm:px-3 py-1 rounded-full whitespace-nowrap ${H$e(w.status)}`,children:hA(w.status)})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsxs("button",{className:"inline-flex items-center justify-center w-full sm:w-auto bg-white text-gray-700 px-4 py-2 rounded-md border border-gray-300 hover:bg-gray-50 disabled:opacity-70 transition text-sm focus:outline-none focus:ring-2 focus:ring-gray-300",onClick:we,disabled:B||E||D,children:[a.jsx(ia,{className:"mr-2"}),B?"Preparing...":"Print Quotation"]}),a.jsxs("button",{className:"inline-flex items-center justify-center w-full sm:w-auto bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 disabled:opacity-70 transition text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",onClick:()=>Ce(w),disabled:D||z?.action?.type==="update"&&z.action.targetId===w.id,children:[a.jsx(gn,{className:"mr-2"}),"Edit"]}),a.jsx("button",{className:"inline-flex items-center justify-center w-full sm:w-auto px-4 py-2 rounded-md text-sm bg-red-500 text-white hover:bg-red-600 transition focus:outline-none focus:ring-2 focus:ring-red-400",onClick:()=>W(w),disabled:!!Ke,children:gt?"Deleting...":a.jsxs(a.Fragment,{children:[a.jsx(wa,{className:"mr-2"}),"Delete"]})})]})]}),a.jsx("div",{className:"border-b border-gray-200 my-5"}),a.jsxs("div",{className:"p-1 lg:p-4",children:[a.jsx("div",{className:"flex w-full bg-[#6A727D] text-white mt-1 overflow-x-auto mb-6",children:["Overview","Notes"].map(Ae=>a.jsx("button",{onClick:()=>me(Ae),className:`flex-1 min-w-[90px] px-4 py-2.5 text-xs sm:text-sm font-medium text-center transition-all duration-200 border-b-2
                    ${be===Ae?"bg-paper-white text-[#6A727D] border-white":"text-white hover:bg-[#5c636d]"}`,children:Ae},Ae))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 items-start",children:[a.jsxs("div",{className:"lg:col-span-3",children:[be==="Overview"&&a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 md:p-8 border border-gray-200",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4 sm:gap-6 text-sm text-gray-700",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Quote ID:"}),a.jsx("p",{children:pA(w.quote_id)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Deal:"}),a.jsx("p",{children:ce(w)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Account:"}),a.jsx("p",{children:Q(w)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Contact:"}),a.jsx("p",{children:ne(w)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Total Amount:"}),a.jsx("p",{children:w.total_amount?`${s}${Number(w.total_amount).toLocaleString()}`:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Presented Date:"}),a.jsx("p",{children:Tg(w.presented_date)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Validity Days:"}),a.jsx("p",{children:w.validity_days!==null&&w.validity_days!==void 0?w.validity_days:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Expiry Date:"}),a.jsx("p",{children:Tg(gA(w.presented_date,w.validity_days))||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Status:"}),a.jsx("p",{children:hA(w.status)})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Assigned To:"}),a.jsx("p",{children:w.assigned_user?`${w.assigned_user.first_name} ${w.assigned_user.last_name}`:"Unassigned"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created By:"}),a.jsx("p",{children:w.creator?`${w.creator.first_name} ${w.creator.last_name}`:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created At:"}),a.jsx("p",{children:yb(w.created_at)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Last Updated:"}),a.jsx("p",{children:yb(w.updated_at)||"N/A"})]})]}),w.items&&w.items.length>0&&a.jsx("div",{className:"mt-6",children:a.jsx(jd,{items:w.items,onChange:()=>{},currencySymbol:s,readOnly:!0,taxRate:parseFloat(w.tax_rate)||0,discountType:w.discount_type,discountValue:parseFloat(w.discount_value)||0})})]}),be==="Notes"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"bg-white p-4 sm:p-6 rounded-xl border border-gray-200 shadow-sm",children:[a.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Notes:"}),a.jsx("p",{className:"text-sm text-gray-700 leading-relaxed whitespace-pre-wrap",children:w.notes||"No notes available."})]}),a.jsx(Tn,{comments:st,onAddComment:Xe})]})]}),a.jsxs("div",{className:"flex flex-col gap-4",children:[a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Quick Actions"}),a.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[a.jsxs("button",{onClick:()=>e("/admin/calls",{state:{openCallModal:!0,initialCallData:{subject:`Call regarding Quote ${pA(w.quote_id)}`,assigned_to:w.assigned_user?.id?String(w.assigned_user.id):w.assigned_to?String(w.assigned_to):"",direction:"Outgoing",status:"Planned"}}}),className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(It,{className:"text-gray-600 w-4 h-4"}),"Schedule Call"]}),a.jsxs("button",{className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",onClick:()=>e("/admin/meetings",{state:{openMeetingModal:!0,initialMeetingData:{subject:`Meeting with ${w.quote_id}`,assignedTo:w.assigned_user?.id?String(w.assigned_user.id):w.assigned_to?String(w.assigned_to):"",status:"Planned"}}}),children:[a.jsx(Ot,{className:"text-gray-600 w-4 h-4"}),"Book Meeting"]}),a.jsxs("button",{onClick:()=>e("/admin/tasks",{state:{openTaskModal:!0,initialTaskData:{subject:`Follow up with ${w.quote_id}`,assignedTo:w.assigned_user?.id?String(w.assigned_user.id):w.assigned_to?String(w.assigned_to):"",priority:"NORMAL",status:"Not Started"}}}),className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(Qt,{className:"text-gray-600 w-4 h-4"}),"Tasks"]})]})]}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm w-full",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Status"}),a.jsx("select",{className:"border border-gray-200 rounded-md px-2 sm:px-3 py-1.5 w-full text-sm mb-2 focus:ring-2 focus:ring-indigo-500 outline-none",value:Ue||$i(w.status)||"Draft",onChange:Ae=>Ee(Ae.target.value),children:mA.map(Ae=>a.jsx("option",{value:Ae.value,children:Ae.label},Ae.value))}),a.jsx("button",{onClick:K,disabled:$i(Ue)===$i(w.status),className:`w-full py-1.5 rounded-md text-sm transition focus:outline-none focus:ring-2 ${$i(Ue)===$i(w.status)?"bg-gray-400 cursor-not-allowed text-white":"bg-gray-900 text-white hover:bg-gray-800 focus:ring-gray-400"}`,children:"Update"})]})]})]})]})]})]})}):null,Ht=a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[o&&a.jsx(Wt,{message:"Loading quotes..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h2",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(ia,{className:"mr-2 text-blue-600"})," Quotes"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto gap-2",children:a.jsxs("button",{onClick:()=>{Oe(),F(!1)},className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 rounded-md hover:bg-gray-800 text-sm sm:text-base mx-auto sm:ml-auto cursor-pointer",children:[a.jsx(aa,{className:"mr-2"})," Add Quote"]})})]}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search quotes",value:je,onChange:Ae=>X(Ae.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsx("div",{className:"w-full lg:w-1/4",children:a.jsx("select",{value:se,onChange:Ae=>ye(Ae.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:ie.map(Ae=>a.jsx("option",{value:Ae.value,children:Ae.label},Ae.value))})})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[900px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 text-sm tracking-wide font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 w-12",children:a.jsx("input",{type:"checkbox",checked:ot.length>0&&We.length===ot.length,onChange:Qe,className:"cursor-pointer"})}),a.jsx("th",{className:"py-3 px-4",children:"Quote ID"}),a.jsx("th",{className:"py-3 px-4",children:"Deal"}),a.jsx("th",{className:"py-3 px-4",children:"Account"}),a.jsx("th",{className:"py-3 px-4",children:"Contact"}),a.jsx("th",{className:"py-3 px-4",children:"Total Amount"}),a.jsx("th",{className:"py-3 px-4",children:"Status"}),a.jsx("th",{className:"py-3 px-4",children:"Assigned To"}),a.jsx("th",{className:"py-3 px-4",children:"Expiry Date"}),a.jsx("th",{className:"py-3 px-4 text-center w-24",children:We.length>0?a.jsx("button",{onClick:J,className:"text-red-600 hover:text-red-800 transition p-1 rounded-full hover:bg-red-50",title:`Delete ${We.length} selected items`,children:a.jsx(wa,{size:18})}):""})]})}),a.jsx("tbody",{children:o?a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:10,children:"Loading quotes..."})}):qe.length>0?ot.map(Ae=>{const I=gA(Ae.presented_date,Ae.validity_days);return a.jsxs("tr",{className:"hover:bg-gray-50 text-sm cursor-pointer transition",onClick:()=>St(Ae),children:[a.jsx("td",{className:"py-3 px-4 align-top w-12",onClick:L=>L.stopPropagation(),children:a.jsx("input",{type:"checkbox",checked:We.includes(Ae.id),onChange:()=>G(Ae.id),className:"cursor-pointer"})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("div",{className:"font-medium text-blue-600 hover:underline whitespace-nowrap",children:pA(Ae.quote_id)||"--"})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("div",{className:"break-words",children:ce(Ae)||"--"})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("div",{className:"text-sm text-gray-700 break-words",children:Q(Ae)||"--"})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("div",{className:"break-words",children:ne(Ae)||"--"})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("div",{className:"text-gray-700",children:Ae.total_amount?`${s}${Number(Ae.total_amount).toLocaleString()}`:"--"})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-medium ${B$e(Ae.status)}`,children:hA(Ae.status)})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("div",{children:Ae.assigned_user?`${Ae.assigned_user.first_name} ${Ae.assigned_user.last_name}`:"Unassigned"})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("div",{className:"text-gray-500 text-xs",children:Tg(I)||"--"})}),a.jsx("td",{className:"py-3 px-4 align-top text-center w-24"})]},Ae.id)}):a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:10,children:"No quotes found."})})})]})}),a.jsx(ca,{className:"mt-4",totalItems:qe.length,pageSize:ge,currentPage:de,onPrev:Re,onNext:it,onPageSizeChange:Ae=>{$e(Ae),ke(1)},pageSizeOptions:[10,20,30,40,50],label:"quotes"})]}),da=_?a.jsx("div",{id:"modalBackdrop",onClick:xe,className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-full sm:max-w-3xl rounded-2xl shadow-lg p-4 sm:p-6 md:p-8 relative border border-gray-200 overflow-y-auto max-h-[90vh] hide-scrollbar",onClick:Ae=>Ae.stopPropagation(),children:[a.jsx("button",{onClick:()=>{Nt(),F(!1)},className:"absolute top-4 right-4 text-gray-500 hover:text-black transition disabled:opacity-60",disabled:E||D,children:a.jsx(ea,{size:22})}),a.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800 mb-4 sm:mb-6 flex items-center justify-center",children:T?"Edit Quote":"Add New Quote"}),a.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",onSubmit:ue,children:[a.jsx(F7,{label:"Deal",name:"deal_id",value:V.deal_id,onChange:Ae=>{const{accountId:I,contactId:L}=pe(Ae);oe(ee=>({...ee,deal_id:Ae,account_id:I,contact_id:L}))},items:Array.isArray(c)?c:[],getLabel:Ae=>`${$7(Ae?.deal_id??"")} ${Ae?.name??""}`.trim(),placeholder:"Search deal...",required:!0,isSubmitted:Y,disabled:E||c.length===0,className:"md:col-span-2"}),a.jsx(z7,{label:"Account",value:Je(V.account_id)||(V.account_id?`Account #${V.account_id}`:""),disabled:!0}),a.jsx(z7,{label:"Contact",value:Be(V.contact_id)||(V.contact_id?`Contact #${V.contact_id}`:""),disabled:!0}),a.jsx("div",{className:"md:col-span-2 mt-2",children:a.jsx(jd,{items:V.items,onChange:Ae=>oe(I=>({...I,items:Ae})),currencySymbol:s,readOnly:E,taxRate:V.tax_rate,discountType:V.discount_type,discountValue:V.discount_value,onTotalsChange:Ae=>{oe(I=>({...I,subtotal:Ae.subtotal,discount_amount:Ae.discount_amount,tax_amount:Ae.tax_amount,total_amount:Ae.total_amount}))}})}),a.jsxs("div",{className:"md:col-span-2 mt-2 p-4 bg-gray-50 rounded-lg",children:[a.jsx("h4",{className:"font-medium text-gray-700 mb-3",children:"Pricing Settings"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-600 text-xs mb-1",children:"Discount Type"}),a.jsxs("select",{value:V.discount_type||"",onChange:Ae=>oe(I=>({...I,discount_type:Ae.target.value})),className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm",disabled:E,children:[a.jsx("option",{value:"",children:"No Discount"}),a.jsx("option",{value:"percentage",children:"Percentage (%)"}),a.jsx("option",{value:"fixed",children:"Fixed Amount"})]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-gray-600 text-xs mb-1",children:["Discount"," ",V.discount_type==="percentage"?"%":"Amount"]}),a.jsx("input",{type:"number",value:V.discount_value||"",onChange:Ae=>oe(I=>({...I,discount_value:Ae.target.value})),className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm",placeholder:"0",min:"0",max:V.discount_type==="percentage"?"100":void 0,step:"0.01",disabled:E||!V.discount_type})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-600 text-xs mb-1",children:"Tax Rate (%)"}),a.jsx("input",{type:"number",value:V.tax_rate??"",onChange:Ae=>oe(I=>({...I,tax_rate:Ae.target.value})),className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm",placeholder:"0",min:"0",max:"100",step:"0.01",disabled:E})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-600 text-xs mb-1",children:"Total Amount"}),a.jsxs("div",{className:"w-full bg-gray-100 border border-gray-300 rounded-md px-2 py-1.5 text-sm font-medium",children:[s,parseFloat(V.total_amount||0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]})]}),a.jsx(R7,{label:"Presented Date",name:"presented_date",type:"date",value:V.presented_date,onChange:ve,disabled:E}),a.jsx(R7,{label:"Validity Days",name:"validity_days",type:"number",value:V.validity_days,onChange:ve,placeholder:"30",disabled:E}),a.jsx(F7,{label:"Assigned To",value:V.assigned_to||"",onChange:Ae=>oe(I=>({...I,assigned_to:Ae})),items:Array.isArray(v)?v:[],getLabel:Ae=>{const I=`${Ae?.first_name??""} ${Ae?.last_name??""}`.trim();if(!I)return Ae?.email||"";const L=Ae?.role?.toUpperCase()==="CEO"?"Admin":Ae?.role;return L?`${I} (${L})`:I},placeholder:"Search assignee...",required:!0,isSubmitted:Y,disabled:E}),a.jsx(Q$e,{label:"Status",name:"status",value:V.status,onChange:ve,options:mA,required:!0,disabled:E}),a.jsx(X$e,{label:"Notes",name:"notes",value:V.notes,onChange:ve,placeholder:"Additional details...",rows:3,disabled:E,className:"md:col-span-2"}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-2 md:col-span-2 mt-4",children:[a.jsx("button",{type:"button",onClick:()=>{Nt(),F(!1)},className:"w-full sm:w-auto px-4 py-2 text-white bg-red-400 border border-red-300 rounded hover:bg-red-500 transition disabled:opacity-70",disabled:E||D,children:"Cancel"}),a.jsx("button",{type:"submit",className:"w-full sm:w-auto px-4 py-2 text-white border border-tertiary bg-tertiary rounded hover:bg-secondary transition disabled:opacity-70",disabled:E||D,children:E?"Saving...":T?"Update Quote":"Save Quote"})]})]})]})}):null,Ge=z?a.jsx(Z$e,{open:!0,title:z.title,message:z.message,confirmLabel:z.confirmLabel,cancelLabel:z.cancelLabel,variant:z.variant,onConfirm:De,onCancel:le,loading:D}):null;return a.jsxs(a.Fragment,{children:[w?Ct:Ht,da,Ge]})}function R7({label:e,name:t,value:n,onChange:s,placeholder:r,type:i="text",required:o=!1,disabled:l=!1,className:c="",isSubmitted:u=!1}){const d=u&&!n?.trim();return a.jsxs("div",{className:c,children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",o&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:i,name:t,value:n??"",onChange:s,placeholder:r,required:o,disabled:l,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border focus:ring-2
          ${d?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}
          ${c}
        `})]})}function z7({label:e,value:t,className:n="",disabled:s=!0}){return a.jsxs("div",{className:n,children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsx("input",{type:"text",value:t??"",disabled:s,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm outline-none disabled:bg-gray-100"})]})}function Q$e({label:e,name:t,value:n,onChange:s,options:r,required:i=!1,disabled:o=!1,className:l=""}){const c=n!=null?String(n):"",d=r.some(h=>String(h.value)===c)?c:"";return a.jsxs("div",{className:l,children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsx("select",{name:t,value:d,onChange:s,required:i,disabled:o,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100",children:r.map(h=>a.jsx("option",{value:String(h.value??""),children:h.label},h.value??h.label))})]})}function F7({label:e,items:t=[],value:n="",onChange:s,getLabel:r,placeholder:i="Search...",disabled:o=!1,className:l="",required:c=!1,isSubmitted:u=!1}){const d=u&&c&&!n;return a.jsxs("div",{className:l,children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",c&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx(K$e,{items:t,value:n??"",onChange:s,getLabel:r,placeholder:i,disabled:o,hasError:d})]})}function K$e({items:e=[],value:t="",onChange:n,getLabel:s,placeholder:r="Search...",disabled:i=!1,maxRender:o=200,hasError:l=!1}){const[c,u]=f.useState(!1),[d,h]=f.useState(""),p=f.useRef(null),x=e.find(y=>String(y.id)===String(t)),v=x?s(x):"",j=f.useMemo(()=>{const y=d.trim().toLowerCase();return(y?e.filter(w=>(s(w)||"").toLowerCase().includes(y)):e).slice(0,o)},[e,d,s,o]);return f.useEffect(()=>{const y=N=>{p.current&&!p.current.contains(N.target)&&u(!1)};return document.addEventListener("mousedown",y),()=>document.removeEventListener("mousedown",y)},[]),f.useEffect(()=>{c||h("")},[c]),a.jsxs("div",{ref:p,className:"relative w-full",children:[a.jsx("input",{disabled:i,value:c?d:v,placeholder:r,onFocus:()=>!i&&u(!0),onChange:y=>{h(y.target.value),c||u(!0)},className:`w-full border rounded-md px-2 py-1.5 text-sm outline-none focus:ring-2
          ${l?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}`}),c&&!i&&a.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg overflow-hidden",children:[a.jsx("div",{className:"max-h-56 overflow-y-auto hide-scrollbar",children:j.length>0?j.map(y=>{const N=String(y.id),w=s(y),S=String(t)===N;return a.jsx("button",{type:"button",onClick:()=>{n(N),u(!1)},className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-50 ${S?"bg-blue-50":""}`,children:w||"--"},N)}):a.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No results"})}),e.length>o&&a.jsxs("div",{className:"px-3 py-2 text-[11px] text-gray-400 border-t",children:["Showing first ",o," results  keep typing to narrow."]})]})]})}function X$e({label:e,name:t,value:n,onChange:s,placeholder:r,rows:i=3,disabled:o=!1,className:l=""}){return a.jsxs("div",{className:l,children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsx("textarea",{name:t,value:n??"",onChange:s,placeholder:r,rows:i,disabled:o,className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100 resize-none"})]})}function Z$e({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o=!1,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsx("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${u}`,disabled:o,children:o?"Processing...":s})]})]})})}const b1=[{value:"CEO",label:"Admin"},{value:"Group Manager",label:"Group Manager"},{value:"Manager",label:"Manager"},{value:"Sales",label:"Sales"}],kg={firstName:"",lastName:"",email:"",password:"",role:""},J$e={CEO:"bg-purple-100 text-purple-700",ADMIN:"bg-purple-100 text-purple-700",GROUP_MANAGER:"bg-indigo-100 text-indigo-700",MANAGER:"bg-blue-100 text-blue-700",MARKETING:"bg-yellow-100 text-yellow-700",SALES:"bg-green-100 text-green-700"},ko=e=>e?e.toString().trim().replace(/([a-z0-9])([A-Z])/g,"$1_$2").replace(/\s+/g,"_").toUpperCase():"",e6e=e=>{const t=ko(e),n=b1.find(s=>ko(s.value)===t);return n?n.value:e||""},QE=e=>{const t=ko(e),n=b1.find(s=>ko(s.value)===t);return n?n.label:typeof e=="string"?e.toLowerCase().replace(/\b\w/g,s=>s.toUpperCase()):"--"},U7=e=>{if(!e)return"--";const t=new Date(e);return Number.isNaN(t.getTime())?"--":t.toLocaleString("en-US",{month:"2-digit",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).replace(",","")},xA=(e,{size:t="sm"}={})=>{const n=ko(e),s=J$e[n]||"bg-gray-100 text-gray-700",r=t==="lg"?"px-3 py-1 text-sm":t==="md"?"px-2.5 py-1 text-sm":"px-2 py-1 text-xs";return a.jsx("span",{className:`${r} font-semibold rounded-md inline-flex items-center justify-center ${s}`,children:QE(e)})},t6e=(e,t)=>{const n=e?.trim()?.[0]??"",s=t?.trim()?.[0]??"";return`${n}${s}`.toUpperCase()||"U"},B7=e=>[...e].sort((t,n)=>{const s=t.created_at?new Date(t.created_at).getTime():0;return(n.created_at?new Date(n.created_at).getTime():0)-s});function a6e(){const{user:e,loading:t}=Vt(),[n,s]=f.useState([]),[r,i]=f.useState(!1),[o,l]=f.useState(""),[c,u]=f.useState(""),[d,h]=f.useState(null),[p,x]=f.useState(!1),[v,j]=f.useState(!1),[y,N]=f.useState(null),[w,S]=f.useState(kg),[_,k]=f.useState(!1),[T,A]=f.useState(null),[E,M]=f.useState(!1),[z,P]=f.useState(1),[D,U]=f.useState(10),[B,R]=f.useState("Overview"),[q,Z]=f.useState(""),[V,oe]=f.useState(!1),[je,X]=f.useState([]),se=ko(e?.role),ye=["ADMIN","CEO"].includes(se),Ne=!t&&ye,fe=f.useMemo(()=>{const Te=b1.filter(he=>ko(he.value)!=="CEO");return[{label:"Filter by Roles",value:""},{label:"CEO",value:"CEO"},...Te]},[]),we=f.useCallback(Te=>{Te&&(s(he=>he.map(He=>He.id===Te?{...He,highlight:!0}:He)),setTimeout(()=>{s(he=>he.map(He=>He.id===Te?{...He,highlight:!1}:He))},2e3))},[]),de=f.useCallback(async()=>{i(!0);try{const Te=await re.get("/users/all"),he=Array.isArray(Te.data)?Te.data:[],He=B7(he);s(He),h(qe=>qe&&(He.find(ot=>ot.id===qe.id)||null)),console.log(Te.data)}catch(Te){console.error("Error fetching users:",Te);const he=Te.response?.data?.detail||"Failed to load users. Please try again later.";H.error(he)}finally{i(!1)}},[]);f.useEffect(()=>{!t&&!ye&&e&&H.error("You are not authorized to access User Management.")},[ye,t,e]),f.useEffect(()=>{t||!ye||de()},[t,ye,de]),f.useEffect(()=>{document.title="Users | Sari-Sari CRM"},[]);const ke=f.useMemo(()=>{const Te=o.trim().toLowerCase(),he=ko(c);return B7(n.filter(He=>{if(!He)return!1;const qe=Te===""||[He.first_name,He.last_name,`${He.first_name||""} ${He.last_name||""}`,He.email,QE(He.role)].filter(Boolean).some(ot=>ot.toString().toLowerCase().includes(Te)),nt=he===""||he==="CEO"&&["CEO","ADMIN"].includes(ko(He.role))||ko(He.role)===he;return qe&&nt}))},[n,o,c]),ge=Math.max(1,Math.ceil(ke.length/D)||1);f.useEffect(()=>{P(1)},[o,c,D]),f.useEffect(()=>{P(Te=>{const he=Math.max(1,Math.ceil(ke.length/D)||1);return Te>he?he:Te})},[ke.length,D]);const $e=f.useMemo(()=>{const Te=(z-1)*D;return ke.slice(Te,Te+D)},[ke,z,D]);ke.length===0||(z-1)*D+1,Math.min(z*D,ke.length);const be=()=>P(Te=>Math.max(Te-1,1)),me=()=>P(Te=>Math.min(Te+1,ge)),Ue=()=>{S(kg),j(!1),N(null),x(!0)},Ee=Te=>{h(Te),R("Overview"),Z(Te?.is_active?"Active":"Inactive")},We=Te=>{Te.target.id==="userModalBackdrop"&&!E&&tt()},tt=()=>{h(null)},lt=(Te,he)=>{S(He=>({...He,[Te]:he}))},Fe=()=>{const Te="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*";let he="";for(let He=0;He<10;He+=1)he+=Te.charAt(Math.floor(Math.random()*Te.length));lt("password",he)},st=()=>{_||E||(x(!1),S(kg),N(null),j(!1))},Xe=Te=>{S({firstName:Te.first_name||"",lastName:Te.last_name||"",email:Te.email||"",password:"",role:e6e(Te.role)}),j(!0),N(Te.id),x(!0),h(null)},Ze=Te=>{A({title:"Delete User",message:a.jsxs("span",{children:["Are you sure you want to delete"," ",a.jsxs("span",{className:"font-semibold",children:[Te.first_name," ",Te.last_name]}),"? This action cannot be undone."]}),confirmLabel:"Delete",cancelLabel:"Cancel",variant:"danger",action:{type:"delete",targetId:Te.id,name:`${Te.first_name||""} ${Te.last_name||""}`.trim()||Te.email||"user"}})},Je=Te=>{Te.preventDefault();const he=w.firstName.trim(),He=w.lastName.trim(),qe=w.email.trim(),nt=w.password.trim(),ot=w.role,Re=!(v&&y);if(!he||!qe||!ot){H.warn("Please fill in all required fields.");return}if(Re&&!nt){H.warn("Please fill in all required fields.");return}if(nt&&nt.length<8){H.warn("Password should be at least 8 characters long.");return}const it={first_name:he,last_name:He,email:qe,role:ot};(Re||nt)&&(it.password=nt);const St=`${he} ${He}`.trim(),Et=Re?"create":"update";A({title:Et==="create"?"Confirm New User":"Confirm User Update",message:Et==="create"?a.jsxs("span",{children:["Create user ",a.jsx("span",{className:"font-semibold",children:St})," with role"," ",a.jsx("span",{className:"font-semibold",children:QE(ot)}),"?"]}):a.jsxs("span",{children:["Save changes for"," ",a.jsx("span",{className:"font-semibold",children:St||qe}),"?"]}),confirmLabel:Et==="create"?"Create User":"Update User",cancelLabel:"Cancel",variant:"primary",action:{type:Et,payload:it,targetId:y,name:St||qe}})},Be=async()=>{je.length!==0&&A({title:"Delete Users",message:a.jsxs("span",{children:["Are you sure you want to deactivate"," ",a.jsx("span",{className:"font-semibold",children:je.length})," selected users? This action cannot be undone."]}),confirmLabel:`Deactivate ${je.length} User(s)`,cancelLabel:"Cancel",variant:"danger",action:{type:"bulk-delete",user_ids:je}})},_e=Te=>{if(Te.target.checked){const he=$e.map(He=>He.id);X(he)}else X([])},pe=Te=>{X(he=>he.includes(Te)?he.filter(He=>He!==Te):[...he,Te])},ce=async()=>{if(!T?.action){A(null);return}const{action:Te}=T,{type:he,payload:He,targetId:qe,name:nt}=Te;M(!0),(he==="create"||he==="update")&&k(!0);try{if(he==="create"){const Re=(await re.post("/users/createuser",He)).data;await de(),we(Re.id),H.success(`User "${nt}" created successfully.`),x(!1),S(kg),N(null),j(!1)}else if(he==="update"){if(!qe)throw new Error("Missing user identifier for update.");const Re=(await re.put(`/users/updateuser/${qe}`,He)).data;await de(),h(null),we(Re.id),H.success(`User "${nt}" updated successfully.`),x(!1),S(kg),N(null),j(!1)}else if(he==="delete"){if(!qe)throw new Error("Missing user identifier for deletion.");await re.delete(`/users/deleteuser/${qe}`),s(ot=>ot.map(Re=>Re.id===qe?{...Re,is_active:!1}:Re)),d&&d.id===qe&&(h(null),Z("")),H.success(`User "${nt}" deactivated successfully.`)}else he==="bulk-delete"&&(await re.delete("/users/admin/bulk-delete",{data:{user_ids:Te.user_ids}}),s(ot=>ot.map(Re=>Te.user_ids.includes(Re.id)?{...Re,is_active:!1}:Re)),d&&Te.user_ids.includes(d.id)&&(h(null),Z("")),H.success(`Successfully deactivated ${Te.user_ids.length} users`),X([]))}catch(ot){console.error("User management error:",ot);const Re=he==="create"?"Failed to create user. Please review the details and try again.":he==="update"?"Failed to update user. Please review the details and try again.":"Failed to delete user. Please try again.",it=ot.response?.data?.detail||Re;H.error(it)}finally{(he==="create"||he==="update")&&k(!1),M(!1),A(null)}},Q=()=>{E||A(null)},ne=async()=>{if(!d||!q)return;const Te=d.is_active?"Active":"Inactive";if(q===Te)return;const he=q==="Active";oe(!0);try{const qe=(await re.put(`/users/updateuser/${d.id}`,{is_active:he})).data;s(nt=>nt.map(ot=>ot.id===qe.id?qe:ot)),h(null),Z(""),H.success(`User status updated to ${q}`)}catch(He){console.error("Failed to update user status:",He);const qe=He.response?.data?.detail||"Failed to update user status. Please try again.";H.error(qe)}finally{oe(!1)}},ae=a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[(r||t||!Ne)&&a.jsx(Wt,{}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h1",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(xj,{className:"mr-2 text-blue-600"}),"User Management"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{type:"button",onClick:Ue,className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 rounded-md hover:bg-gray-800 text-sm sm:text-base self-end sm:self-auto cursor-pointer",children:[a.jsx(Xa,{className:"mr-2"})," Add User"]})})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search users",value:o,onChange:Te=>l(Te.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsx("div",{className:"w-full lg:w-1/4",children:a.jsx("select",{value:c,onChange:Te=>u(Te.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:fe.map(Te=>a.jsx("option",{value:Te.value,children:Te.label},Te.value))})})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[600px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 text-sm tracking-wide font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 w-10",children:a.jsx("input",{type:"checkbox",className:"w-4 h-4 accent-blue-600",checked:$e.length>0&&$e.every(Te=>je.includes(Te.id)),onChange:_e})}),a.jsx("th",{className:"py-3 px-4",children:"Fullname"}),a.jsx("th",{className:"py-3 px-4",children:"Email"}),a.jsx("th",{className:"py-3 px-4",children:"Role"}),a.jsx("th",{className:"py-3 px-4",children:"Status"}),a.jsx("th",{className:"py-3 px-4 text-center w-24",children:je.length>0?a.jsx("button",{onClick:Be,className:"text-red-600 hover:text-red-800 transition p-1 rounded-full hover:bg-red-50",title:`Deactivate ${je.length} selected users`,children:a.jsx(wa,{size:18})}):""})]})}),a.jsx("tbody",{children:r?a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:3,children:"Loading users..."})}):ke.length===0?a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-400",colSpan:4,children:"No users found."})}):$e.map(Te=>a.jsxs("tr",{className:`hover:bg-gray-50 transition-colors ${Te.highlight?"bg-green-50":""} ${Te.is_active?"":"opacity-60 bg-gray-50"}`,children:[a.jsx("td",{className:"py-3 px-4",onClick:he=>he.stopPropagation(),children:a.jsx("input",{type:"checkbox",className:"w-4 h-4 accent-blue-600",checked:je.includes(Te.id),onChange:()=>pe(Te.id)})}),a.jsx("td",{className:"py-3 px-4 cursor-pointer",onClick:()=>Ee(Te),children:a.jsxs("div",{className:"font-medium text-blue-600 hover:underline text-sm",children:[Te.first_name," ",Te.last_name]})}),a.jsx("td",{className:"py-3 px-4 cursor-pointer text-sm",onClick:()=>Ee(Te),children:Te.email}),a.jsx("td",{className:"py-3 px-4 cursor-pointer",onClick:()=>Ee(Te),children:xA(Te.role)}),a.jsx("td",{className:"py-3 px-4 cursor-pointer",onClick:()=>Ee(Te),children:a.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-md ${Te.is_active?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:Te.is_active?"Active":"Inactive"})})]},Te.id))})]})}),a.jsx(ca,{className:"mt-4",totalItems:ke.length,pageSize:D,currentPage:z,onPrev:be,onNext:me,onPageSizeChange:Te=>{U(Te),P(1)},label:"users"})]}),Pe=d?a.jsx("div",{id:"userModalBackdrop",onClick:We,className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-6xl max-h-[92vh] overflow-y-auto hide-scrollbar animate-scale-in p-4 sm:p-6 md:p-8 font-inter relative",children:[a.jsx("div",{className:"flex justify-end w-full",children:a.jsx("button",{onClick:tt,className:"text-gray-500 hover:text-gray-700 transition mb-5 cursor-pointer",children:a.jsx(Ja,{size:30})})}),a.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between lg:flex-row lg:items-center lg:justify-between mt-3 gap-2 px-2 md:items-center lg:gap-4 md:mx-7 lg:mx-7 mb-4 lg:mb-6 md:mb-4",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[d.profile_picture?a.jsx("img",{src:d.profile_picture,alt:`${d.first_name} ${d.last_name}`,className:"w-12 h-12 sm:w-16 sm:h-16 rounded-full object-cover border border-gray-200 shadow-sm"}):a.jsx("div",{className:"w-12 h-12 sm:w-16 sm:h-16 rounded-full bg-gray-200 text-gray-700 flex items-center justify-center text-lg sm:text-xl font-semibold border border-gray-200 shadow-sm",children:t6e(d.first_name,d.last_name)}),a.jsxs("div",{children:[a.jsxs("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-800",children:[d.first_name," ",d.last_name]}),a.jsx("p",{className:"text-sm text-gray-500 break-all",children:d.email})]})]}),xA(d.role,{size:"md"})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsxs("button",{type:"button",className:"inline-flex items-center justify-center w-full sm:w-auto bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 disabled:opacity-70 transition text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",onClick:()=>Xe(d),disabled:E,children:[a.jsx(hn,{className:"mr-2"}),"Edit"]}),a.jsxs("button",{type:"button",className:"inline-flex items-center justify-center w-full sm:w-auto px-4 py-2 rounded-md text-sm bg-red-500 text-white hover:bg-red-600 transition focus:outline-none focus:ring-2 focus:ring-red-400",onClick:()=>Ze(d),disabled:E,children:[a.jsx(wa,{className:"mr-2"}),"Delete"]})]})]}),a.jsx("div",{className:"border-b border-gray-200 mb-6"}),a.jsx("div",{className:"flex w-full bg-[#6A727D] text-white mt-1 overflow-x-auto mb-6",children:["Overview"].map(Te=>a.jsx("button",{onClick:()=>R(Te),className:`flex-1 min-w-[90px] px-4 py-2.5 text-xs sm:text-sm font-medium text-center transition-all duration-200 border-b-2
        ${B===Te?"bg-[#5c636d] text-white border-white":"text-white hover:bg-[#5c636d]"}`,children:Te},Te))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 items-start",children:[a.jsx("div",{className:"lg:col-span-3",children:B==="Overview"&&a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 md:p-8 border border-gray-200",children:a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4 sm:gap-6 text-sm text-gray-700",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Email:"}),a.jsx("p",{children:d.email||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Role:"}),a.jsx("p",{children:xA(d.role,{size:"sm"})})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Status:"}),a.jsx("p",{children:d.is_active?"Active":"Inactive"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Auth Provider:"}),a.jsx("p",{children:d.auth_provider?d.auth_provider.toString().replace(/\b\w/g,Te=>Te.toUpperCase()):"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Phone Number:"}),a.jsx("p",{children:d.phone_number||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Company:"}),a.jsx("p",{children:d.company?.company_name||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Company Number:"}),a.jsx("p",{children:d.company?.company_number||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Related to CEO:"}),a.jsx("p",{children:d.manager?`${d.manager.first_name} ${d.manager.last_name}`:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created At:"}),a.jsx("p",{children:U7(d.created_at)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Last Login:"}),a.jsx("p",{children:d.last_login?U7(d.last_login):"Never"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Profile Picture:"}),a.jsx("p",{children:d.profile_picture?a.jsx("a",{href:d.profile_picture,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline break-all",children:"View image"}):"N/A"})]})]})})}),a.jsxs("div",{className:"flex flex-col gap-4",children:[a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Quick Actions"}),a.jsx("div",{className:"flex flex-col gap-2 w-full",children:a.jsxs("button",{type:"button",onClick:()=>{if(!d.email){alert("No email address available");return}const Te=encodeURIComponent(d.email),he=encodeURIComponent(""),He=encodeURIComponent(""),qe=`https://mail.google.com/mail/?view=cm&fs=1&to=${Te}&su=${he}&body=${He}`;window.open(qe,"_blank")},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(rn,{className:"text-gray-600 w-4 h-4"}),"Send E-mail"]})})]}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm w-full",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Status"}),a.jsxs("select",{className:"border border-gray-200 rounded-md px-2 sm:px-3 py-1.5 w-full text-sm mb-2 focus:ring-2 focus:ring-indigo-500 outline-none",value:q||(d.is_active?"Active":"Inactive"),onChange:Te=>Z(Te.target.value),children:[a.jsx("option",{value:"Active",children:"Active"}),a.jsx("option",{value:"Inactive",children:"Inactive"})]}),a.jsx("button",{onClick:ne,disabled:V||q===(d.is_active?"Active":"Inactive"),className:`w-full py-1.5 rounded-md text-sm transition focus:outline-none focus:ring-2 ${V||q===(d.is_active?"Active":"Inactive")?"bg-gray-400 cursor-not-allowed text-white":"bg-gray-900 text-white hover:bg-gray-800 focus:ring-gray-400"}`,children:V?"Updating...":"Update"})]})]})]})]})}):null;return a.jsxs(a.Fragment,{children:[ae,Pe,a.jsx(n6e,{open:p,isEditing:v,isSubmitting:_,confirmProcessing:E,formData:w,onClose:st,onSubmit:Je,onChange:lt,onGeneratePassword:Fe}),a.jsx(s6e,{open:!!T,title:T?.title,message:T?.message,confirmLabel:T?.confirmLabel,cancelLabel:T?.cancelLabel,variant:T?.variant,loading:E,onConfirm:ce,onCancel:Q})]})}function n6e({open:e,isEditing:t,isSubmitting:n,confirmProcessing:s,formData:r,onClose:i,onSubmit:o,onChange:l,onGeneratePassword:c}){if(!e)return null;const u=n||s;return a.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-2xl rounded-2xl shadow-lg border border-gray-200 p-6 sm:p-8 relative overflow-y-auto max-h-[90vh]",children:[a.jsx("button",{onClick:i,className:"absolute top-4 right-4 text-gray-500 hover:text-black transition disabled:opacity-60",disabled:u,children:a.jsx(ea,{size:22})}),a.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800 mb-6 text-center",children:t?"Edit User":"Add New User"}),a.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",onSubmit:o,children:[a.jsx(bb,{label:"First Name",value:r.firstName,onChange:d=>l("firstName",d),placeholder:"John",required:!0,disabled:u}),a.jsx(bb,{label:"Last Name",value:r.lastName,onChange:d=>l("lastName",d),placeholder:"Doe",required:!0,disabled:u}),a.jsx(bb,{label:"Email",type:"email",value:r.email,onChange:d=>l("email",d),placeholder:"john.doe@company.com",required:!0,disabled:u||t}),a.jsx(bb,{label:"Role",type:"select",value:r.role,onChange:d=>l("role",d),options:[{value:"",label:"Select role"},...b1],required:!0,disabled:u}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Password"}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2",children:[a.jsx("input",{type:"text",value:r.password,onChange:d=>l("password",d.target.value),placeholder:t?"Leave blank to keep current password":"Enter or generate password",required:!t,disabled:u,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-indigo-500 outline-none disabled:bg-gray-100"}),a.jsx("button",{type:"button",onClick:c,className:"flex items-center justify-center px-4 py-2 bg-gray-900 text-white rounded-md hover:bg-gray-800 transition disabled:opacity-60",disabled:u,children:"Generate"})]}),t?a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Setting a password will reset the user's credentials; leave it blank to keep the current password."}):a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Password must be at least 8 characters long."})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-2 md:col-span-2 mt-4",children:[a.jsx("button",{type:"button",onClick:i,className:"w-full sm:w-auto px-4 py-2 text-white bg-red-400 border border-red-300 rounded hover:bg-red-500 transition disabled:opacity-70",disabled:u,children:"Cancel"}),a.jsx("button",{type:"submit",className:"w-full sm:w-auto px-4 py-2 text-white border border-tertiary bg-tertiary rounded hover:bg-secondary transition disabled:opacity-70",disabled:u,children:n?"Saving...":t?"Update User":"Save User"})]})]})]})})}function bb({label:e,type:t="text",value:n,onChange:s,placeholder:r,options:i=[],required:o=!1,disabled:l=!1}){return a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),t==="select"?a.jsx("select",{value:n??"",onChange:c=>s(c.target.value),required:o,disabled:l,className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-indigo-500 outline-none disabled:bg-gray-100",children:i.map(c=>a.jsx("option",{value:c.value,children:c.label},c.value))}):a.jsx("input",{type:t,value:n??"",onChange:c=>s(c.target.value),placeholder:r,required:o,disabled:l,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-indigo-500 outline-none disabled:bg-gray-100"})]})}function s6e({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o=!1,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":"bg-black hover:bg-gray-800 border border-black";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("div",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsx("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${u}`,disabled:o,children:o?"Processing...":s})]})]})})}const r6e=(e,t)=>{const n=e?.trim()?.[0]??"",s=t?.trim()?.[0]??"";return`${n}${s}`.toUpperCase()||"U"};function i6e(){const{user:e,loading:t,fetchUser:n}=Vt(),[s,r]=f.useState(!1),[i,o]=f.useState(!1),[l,c]=f.useState(!1),[u,d]=f.useState(!1),[h,p]=f.useState(!1),[x,v]=f.useState(null),[j,y]=f.useState(null),N=f.useRef(null),[w,S]=f.useState({firstName:"",lastName:"",email:"",phoneNumber:""}),[_,k]=f.useState({currentPassword:"",newPassword:"",confirmPassword:""});f.useEffect(()=>{e&&(S({firstName:e.first_name||"",lastName:e.last_name||"",email:e.email||"",phoneNumber:e.phone_number||""}),y(e.profile_picture||null))},[e]),f.useEffect(()=>{document.title="Manage Account | Sari-Sari CRM"},[]);const T=(P,D)=>{S(U=>({...U,[P]:D}))},A=(P,D)=>{k(U=>({...U,[P]:D}))},E=P=>{const D=P.target.files?.[0];if(!D)return;if(!D.type.startsWith("image/")){H.error("Please select an image file");return}if(D.size>5*1024*1024){H.error("Image size should be less than 5MB");return}const U=new FileReader;U.onloadend=()=>{v(U.result),y(U.result)},U.readAsDataURL(D)},M=async P=>{if(P.preventDefault(),!w.firstName.trim()||!w.lastName.trim()){H.warn("Please fill in all required fields.");return}r(!0);try{const D={first_name:w.firstName.trim(),last_name:w.lastName.trim(),phone_number:w.phoneNumber.trim()||null};x!==null&&(D.profile_picture=x),await re.put("/users/me",D),await n(),o(!1),v(null),window.dispatchEvent(new CustomEvent("userProfileUpdated")),H.success("Account information updated successfully!")}catch(D){console.error("Error updating account:",D);const U=D.response?.data?.detail||"Failed to update account information. Please try again.";H.error(U)}finally{r(!1)}},z=async P=>{if(P.preventDefault(),!_.newPassword||!_.confirmPassword){H.warn("Please fill in all password fields.");return}if(_.newPassword.length<8){H.warn("Password must be at least 8 characters long.");return}if(_.newPassword!==_.confirmPassword){H.warn("New password and confirm password do not match.");return}p(!0);try{const D={password:_.newPassword};await re.put("/users/me",D),await n(),k({currentPassword:"",newPassword:"",confirmPassword:""}),window.dispatchEvent(new CustomEvent("userProfileUpdated")),p(!1),H.success("Password changed successfully!")}catch(D){console.error("Error changing password:",D);const U=D.response?.data?.detail||"Failed to change password. Please try again.";H.error(U)}finally{p(!1)}};return a.jsxs("div",{className:"p-2 lg:p-8 font-inter relative",children:[(t||!e)&&a.jsx(Wt,{}),e&&a.jsxs("div",{children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("h1",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 mb-2",children:"Manage Your Profile"}),a.jsx("p",{className:"text-gray-600 text-sm sm:text-base",children:"Update your account information and change your password"})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm p-6 mb-6",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h2",{className:"text-xl font-semibold text-gray-800 flex items-center gap-2",children:[a.jsx(ra,{className:"text-blue-600"}),"Profile Information"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:!i&&a.jsxs("button",{onClick:()=>o(!0),className:"flex items-center gap-2 px-4 py-2 bg-gray-900 text-white rounded-md hover:bg-gray-800 transition text-sm",children:[a.jsx(hn,{}),"Edit Profile"]})})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-4 mb-6 pb-6 border-b border-gray-200",children:[a.jsxs("div",{className:"flex-shrink-0 relative group",children:[j?a.jsx("div",{className:"relative",children:a.jsx("img",{src:j,alt:`${e.first_name} ${e.last_name}`,className:"w-20 h-20 sm:w-24 sm:h-24 rounded-full object-cover border-2 border-gray-200 shadow-sm"})}):a.jsx("div",{className:"w-20 h-20 sm:w-24 sm:h-24 rounded-full bg-gradient-to-br from-blue-500 to-indigo-600 text-white flex items-center justify-center text-2xl sm:text-3xl font-semibold border-2 border-gray-200 shadow-sm",children:r6e(e.first_name,e.last_name)}),i&&a.jsxs("div",{className:"absolute bottom-0 right-0",children:[a.jsx("input",{type:"file",ref:N,accept:"image/*",onChange:E,className:"hidden",id:"profile-picture-upload"}),a.jsx("label",{htmlFor:"profile-picture-upload",className:"cursor-pointer bg-gray-900 text-white p-1.5 rounded-full shadow-lg hover:bg-gray-800 transition flex items-center justify-center border-2 border-white",title:"Change profile picture",children:a.jsx(f9,{size:14})})]})]}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-800",children:[i?w.firstName:e.first_name," ",i?w.lastName:e.last_name]}),a.jsx("p",{className:"text-gray-600 text-sm",children:e.email}),a.jsx("span",{className:"inline-block mt-2 px-3 py-1 bg-blue-100 text-blue-700 text-xs font-semibold rounded-md",children:e.role.toUpperCase()==="CEO"&&"Admin"})]})]}),i?a.jsxs("form",{onSubmit:M,className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-2 text-sm",children:["First Name ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("div",{className:"relative",children:[a.jsx(ra,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),a.jsx("input",{type:"text",value:w.firstName,onChange:P=>T("firstName",P.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none",required:!0})]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-2 text-sm",children:["Last Name ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("div",{className:"relative",children:[a.jsx(ra,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),a.jsx("input",{type:"text",value:w.lastName,onChange:P=>T("lastName",P.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none",required:!0})]})]}),a.jsxs("div",{className:"sm:col-span-2",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-2 text-sm",children:"Email"}),a.jsxs("div",{className:"relative",children:[a.jsx(rn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),a.jsx("input",{type:"email",value:w.email,disabled:!0,className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md bg-gray-100 text-gray-600 cursor-not-allowed outline-none",readOnly:!0})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Email cannot be changed"})]}),a.jsxs("div",{className:"sm:col-span-2",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-2 text-sm",children:"Phone Number"}),a.jsxs("div",{className:"relative",children:[a.jsx(It,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),a.jsx("input",{type:"tel",value:w.phoneNumber,onChange:P=>T("phoneNumber",P.target.value),placeholder:"+1 (555) 123-4567",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none"})]})]})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-3 pt-4 border-t border-gray-200",children:[a.jsx("button",{type:"button",onClick:()=>{o(!1),S({firstName:e.first_name||"",lastName:e.last_name||"",email:e.email||"",phoneNumber:e.phone_number||""}),v(null),y(e.profile_picture||null),N.current&&(N.current.value="")},className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition",disabled:s,children:"Cancel"}),a.jsxs("button",{type:"submit",className:"flex items-center justify-center gap-2 px-4 py-2 bg-gray-900 text-white rounded-md hover:bg-gray-800 transition disabled:opacity-70",disabled:s,children:[a.jsx(CL,{}),s?"Saving...":"Save Changes"]})]})]}):a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"First Name"}),a.jsx("p",{className:"text-gray-800 font-medium",children:e.first_name||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Last Name"}),a.jsx("p",{className:"text-gray-800 font-medium",children:e.last_name||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Email"}),a.jsx("p",{className:"text-gray-800 font-medium",children:e.email||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Phone Number"}),a.jsx("p",{className:"text-gray-800 font-medium",children:e.phone_number||"N/A"})]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm p-6",children:[a.jsxs("h2",{className:"text-xl font-semibold text-gray-800 flex items-center gap-2 mb-6 justify-center lg:justify-start",children:[a.jsx(Po,{className:"text-blue-600"}),"Change Password"]}),a.jsxs("form",{onSubmit:z,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-2 text-sm",children:["New Password ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("div",{className:"relative",children:[a.jsx(Po,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),a.jsx("input",{type:"text",style:l?void 0:{WebkitTextSecurity:"disc"},value:_.newPassword,onChange:P=>A("newPassword",P.target.value),placeholder:"Enter new password (min. 8 characters)",className:"w-full pl-10 pr-10 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none",required:!0,minLength:8}),a.jsx("button",{type:"button",onClick:()=>c(P=>!P),className:"absolute inset-y-0 right-0 flex items-center pr-3 text-gray-700 hover:text-gray-900 focus:outline-none z-10 transition-colors cursor-pointer","aria-label":l?"Hide password":"Show password",children:l?a.jsx(Pu,{className:"size-5"}):a.jsx(md,{className:"size-5"})})]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-2 text-sm",children:["Confirm New Password ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("div",{className:"relative",children:[a.jsx(Po,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),a.jsx("input",{type:"text",style:u?void 0:{WebkitTextSecurity:"disc"},value:_.confirmPassword,onChange:P=>A("confirmPassword",P.target.value),placeholder:"Confirm new password",className:"w-full pl-10 pr-10 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none",required:!0,minLength:8}),a.jsx("button",{type:"button",onClick:()=>d(P=>!P),className:"absolute inset-y-0 right-0 flex items-center pr-3 text-gray-700 hover:text-gray-900 focus:outline-none z-10 transition-colors cursor-pointer","aria-label":u?"Hide password":"Show password",children:u?a.jsx(Pu,{className:"size-5"}):a.jsx(md,{className:"size-5"})})]})]}),a.jsx("div",{className:"pt-4 border-t border-gray-200 flex justify-center lg:justify-start",children:a.jsxs("button",{type:"submit",className:"flex items-center justify-center gap-2 px-4 py-2 bg-gray-900 text-white rounded-md hover:bg-gray-800 transition disabled:opacity-70",disabled:h,children:[a.jsx(Po,{}),h?"Changing Password...":"Change Password"]})})]})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm p-6 mt-6",children:[a.jsxs("h2",{className:"text-xl font-semibold text-gray-800 flex items-center gap-2 mb-6 justify-center lg:justify-start",children:[a.jsx(g9,{className:"text-blue-600"}),"Account Information"]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Role"}),a.jsx("span",{className:"inline-block px-3 py-1 bg-blue-100 text-blue-700 text-sm font-semibold rounded-md",children:e.role.toUpperCase()==="CEO"&&"Admin"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Status"}),a.jsx("span",{className:`inline-block px-3 py-1 text-sm font-semibold rounded-md ${e.is_active?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:e.is_active?"Active":"Inactive"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Company"}),a.jsx("p",{className:"text-gray-800 font-medium",children:e.company?.company_name||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Auth Provider"}),a.jsx("p",{className:"text-gray-800 font-medium",children:e.auth_provider?e.auth_provider.charAt(0).toUpperCase()+e.auth_provider.slice(1):"N/A"})]}),e.created_at&&a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Account Created"}),a.jsx("p",{className:"text-gray-800 font-medium",children:new Date(e.created_at).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]}),e.last_login&&a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Last Login"}),a.jsx("p",{className:"text-gray-800 font-medium",children:new Date(e.last_login).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"})})]})]})]})]})]})}function CZ({selectedDeal:e,onStatusUpdate:t,onClose:n}){const[s,r]=f.useState(e?.stage||""),[i,o]=f.useState(!1),l=kt(),c=[{value:"PROSPECTING",label:"Prospecting"},{value:"QUALIFICATION",label:"Qualification"},{value:"PROPOSAL",label:"Proposal"},{value:"NEGOTIATION",label:"Negotiation"},{value:"CLOSED_WON",label:"Closed Won"},{value:"CLOSED_LOST",label:"Closed Lost"},{value:"CLOSED_CANCELLED",label:"Closed Cancelled"}];f.useEffect(()=>{e?.stage&&r(e.stage)},[e]);const u=async()=>{if(!e||!e.id){H.error("No deal selected");return}if(!s||s===e.stage){H.info("Please select a different stage");return}const d=e.id;o(!0);try{await re.put(`/deals/admin/${d}`,{stage:s}),n&&n(),t&&setTimeout(async()=>{await t(!0)},100),setTimeout(()=>{H.success("Deal status updated successfully")},300)}catch(h){console.error(h);const p=h.response?.data?.detail||"Failed to update deal status";H.error(p)}finally{o(!1)}};return e?a.jsxs("div",{className:"space-y-4 font-inter text-[13px] w-full sm:w-[85%] mx-auto flex flex-col gap-4",children:[a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Quick Actions"}),a.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[a.jsxs("button",{onClick:()=>{const d=e.account?.id||e.account_id;l("/admin/calls",{state:{openCallModal:!0,initialCallData:{subject:e.name?`Call regarding: ${e.name}`:"",relatedType1:"Account",relatedTo1:d,relatedType2:"Deal",relatedTo2:e.id,contactId:e.contact?.id,assigned_to:e.assigned_deals?.id?String(e.assigned_deals.id):"",assignedTo:e.assigned_to?.id?String(e.assigned_to.id):""}}})},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(It,{className:"text-gray-600 w-4 h-4"}),"Schedule Call"]}),a.jsxs("button",{type:"button",onClick:()=>{if(!e.contact?.email){alert("No email address available");return}const d=encodeURIComponent(e.contact.email),h=encodeURIComponent(""),p=encodeURIComponent(""),x=`mailto:${d}?subject=${h}&body=${p}`;window.location.href=x},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(rn,{className:"text-gray-600 w-4 h-4"}),"Send E-mail"]}),a.jsxs("button",{className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",onClick:()=>{const d=e.account?.id||e.account_id;l("/admin/meetings",{state:{openMeetingModal:!0,initialMeetingData:{subject:e.name?`Meeting: ${e.name}`:"",relatedType1:"Account",relatedTo1:d,relatedType2:"Deal",relatedTo2:e.id,assignedTo:e.assigned_deals?.id?String(e.assigned_deals.id):""}}})},children:[a.jsx(Ot,{className:"text-gray-600 w-4 h-4"}),"Book Meeting"]}),a.jsxs("button",{onClick:()=>{const d=e.account?.id||e.account_id;l("/admin/tasks",{state:{openTaskModal:!0,initialTaskData:{subject:e.name?`Task for: ${e.name}`:"",relatedType1:"Account",relatedTo1:d,relatedType2:"Deal",relatedTo2:e.id,contactId:e.contact?.id,assignedTo:e.assigned_deals?.id?String(e.assigned_deals.id):"",priority:"NORMAL",status:"Not Started"}}})},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(Qt,{className:"text-gray-600 w-4 h-4"}),"Tasks"]})]})]}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm w-full",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Promote Deal"}),a.jsx("select",{className:"border border-gray-200 rounded-md px-2 sm:px-3 py-1.5 w-full text-sm mb-2 focus:ring-2 focus:ring-gray-300 focus:outline-none",value:s,onChange:d=>r(d.target.value),disabled:i,children:c.map(d=>a.jsx("option",{value:d.value,children:d.label},d.value))}),a.jsx("button",{className:"w-full bg-gray-900 text-white py-1.5 rounded-md text-sm hover:bg-gray-800 transition disabled:opacity-50 disabled:cursor-not-allowed",onClick:u,disabled:i||!s||s===e.stage,children:i?"Updating...":"Update"})]})]}):null}function SZ({selectedDeal:e,show:t,onClose:n,activeTab:s,setActiveTab:r,onEdit:i,onDelete:o,onStatusUpdate:l,relatedActs:c}){const u=kt(),[d]=Bs(),h=d.get("id"),[p,x]=f.useState(e||null),[v,j]=f.useState(s||"Overview"),[y,N]=f.useState(null),[w,S]=f.useState(""),{userRole:_}=Ks(),k=D=>{if(!D)return"";const U=String(D).split("-");return U.length===3?`${U[0]}-${U[2]}`:String(D)},T=D=>D?new Date(D).toLocaleString("en-US",{month:"short",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).replace(",",""):"",{comments:A,addComment:E,refresh:M}=kn({relatedType:"deal",relatedId:p?.id});f.useEffect(()=>{p?.id&&M()},[p?.id,M]);const z=s!==void 0?s:v;if(f.useEffect(()=>{_.toLowerCase()==="ceo"||_.toLowerCase()==="admin"?S("admin"):_.toLowerCase()==="group manager"||_.toLowerCase()==="group_manager"?S("group-manager"):_.toLowerCase()==="manager"?S("manager"):_.toLowerCase()==="sales"?S("sales"):S("guest")},[_]),f.useEffect(()=>{(async()=>{if(h&&!e)try{const R=((await re.get("/deals/admin/fetch-all")).data||[]).find(q=>q.id===parseInt(h));if(R){const q={...R,amount:typeof R.amount=="number"?R.amount:parseFloat(R.amount||0),probability:R.probability||0};x(q)}else console.warn("Deal not found with ID:",h)}catch(U){console.error("Error fetching deal:",U)}})()},[h,e]),!p&&!h||h&&!p)return null;const P=D=>({PROSPECTING:"bg-blue-100 text-blue-700",QUALIFICATION:"bg-yellow-100 text-yellow-700",PROPOSAL:"bg-orange-100 text-orange-700",NEGOTIATION:"bg-purple-100 text-purple-700",CLOSED_WON:"bg-green-100 text-green-700",CLOSED_LOST:"bg-red-100 text-red-700"})[D]||"bg-gray-100 text-gray-700";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[9999] font-inter p-2 sm:p-4 overflow-x-hidden",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-lg w-full max-w-full sm:max-w-6xl max-h-[90vh] overflow-y-auto hide-scrollbar relative box-border",children:[a.jsx("div",{className:"bg-tertiary w-full rounded-t-xl p-3 lg:p-3",children:a.jsxs("div",{className:"flex items-start justify-between w-full",children:[a.jsx("h1",{className:"lg:text-3xl text-xl text-white font-semibold text-center w-full",children:"Deal"}),a.jsx("div",{className:"flex items-center gap-2 sm:gap-3",children:a.jsx("button",{onClick:()=>{n?n():u(-1)},className:"text-gray-400 hover:text-white mt-1 cursor-pointer",children:a.jsx(ea,{size:25})})})]})}),a.jsx("div",{className:"p-4 lg:p-2 lg:mx-7",children:a.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-2 sm:gap-3 mt-3",children:[a.jsxs("div",{className:"flex flex-col gap-1",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3 lg:gap-1",children:[a.jsxs("h2",{className:"text-xl lg:text-xl font-semibold text-gray-800 break-words",children:[k(p.deal_id)," - ",p.name]}),a.jsx("span",{className:`text-xs sm:text-sm inline-block font-medium px-1.5 py-0.5 sm:px-3 sm:py-1 rounded-full break-words ${P(p.stage)}`,children:p.stage})]}),a.jsxs("p",{className:"text-gray-500 text-sm break-words",children:["Created on ",T(p.created_at)]})]}),a.jsxs("div",{className:"flex flex-col items-end gap-2",children:[a.jsxs("h2",{className:"text-xl sm:text-2xl font-bold text-gray-600 break-words",children:[""," ",p.amount?p.amount.toLocaleString():"0"]}),a.jsx("div",{className:"w-full sm:w-40 bg-gray-200 rounded-full h-2",children:a.jsx("div",{className:"bg-green-500 h-2 rounded-full",style:{width:`${p.probability}%`}})}),a.jsxs("p",{className:"text-xs text-gray-500 break-words",children:[" ",p.probability,"% Complete"," "]}),a.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 mt-3",children:[a.jsxs("button",{type:"button",onClick:()=>{i&&i(p)},className:"inline-flex items-center justify-center bg-blue-500 text-white px-3 sm:px-4 py-1.5 sm:py-2 rounded-md hover:bg-blue-600 transition text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",children:[a.jsx(hn,{className:"mr-1 sm:mr-2",size:16}),a.jsx("span",{className:"hidden sm:inline",children:"Edit"})]}),a.jsxs("button",{type:"button",onClick:()=>{o&&o(p)},className:"inline-flex items-center justify-center px-3 sm:px-4 py-1.5 sm:py-2 rounded-md text-sm bg-red-500 text-white hover:bg-red-600 transition focus:outline-none focus:ring-2 focus:ring-red-400",children:[a.jsx(wa,{className:"mr-1 sm:mr-2",size:16}),a.jsx("span",{className:"hidden sm:inline",children:"Delete"})]})]})]})]})}),a.jsx("div",{className:"border-b border-gray-200 my-5"}),a.jsxs("div",{className:"p-6 lg:p-4",children:[a.jsx("div",{className:"flex w-full bg-[#6A727D] text-white mt-1 overflow-x-auto mb-6",children:["Overview","Notes","Activities"].map(D=>a.jsx("button",{onClick:()=>{r?r(D):j(D)},className:`flex-1 min-w-[90px] px-4 py-2.5 text-xs sm:text-sm font-medium text-center transition-all duration-200 border-b-2
                ${z===D?"bg-paper-white text-[#6A727D] border-white":"text-white hover:bg-[#5c636d]"}`,children:D},D))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 items-start",children:[a.jsxs("div",{className:"lg:col-span-3 space-y-6",children:[z==="Overview"&&a.jsxs("div",{className:"grid md:grid-cols-2 gap-4 sm:gap-6 w-full",children:[a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 sm:p-5 shadow-sm pb-20 break-words",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 sm:mb-3",children:"Deal Information"}),a.jsxs("p",{className:"text-sm sm:text-sm text-gray-700 mb-2 py-5 break-words",children:[a.jsx("strong",{children:"Description:"})," ",p.description]}),a.jsx("div",{className:"h-px bg-gray-200 w-full"}),a.jsxs("p",{className:"text-sm sm:text-sm text-gray-700 mb-2 py-5 break-words",children:[a.jsx("strong",{children:"Expected Close Date:"})," ",T(p.close_date)||"--"]}),a.jsx("div",{className:"h-px bg-gray-200 w-full"}),a.jsxs("div",{className:"mt-4 py-3 w-full",children:[a.jsxs("div",{className:"relative flex flex-col w-full",children:[a.jsx("div",{className:"absolute top-0 left-0 right-0 flex items-center justify-between w-full",children:(()=>{const D=(p?.stage||"PROSPECTING").toUpperCase(),B=(q=>q==="PROSPECTING"?0:q==="QUALIFICATION"?1:q==="PROPOSAL"?2:q==="NEGOTIATION"?3:q==="CLOSED_WON"||q==="CLOSED_LOST"?4:-1)(D);return[0,1,2,3,4].map(q=>B===q?"orange":B>q?"green":"gray").map((q,Z)=>a.jsxs(wt.Fragment,{children:[a.jsx("div",{className:`relative z-10 w-6 h-6 rounded-full border-2 ${q==="green"?"bg-green-500 border-green-500":q==="orange"?"bg-orange-400 border-orange-400":"bg-gray-300 border-gray-300"}`}),Z<4&&a.jsx("div",{className:"flex-grow h-1 bg-gray-200 mx-1 min-w-0"})]},Z))})()}),a.jsx("div",{className:"flex justify-between mt-8 gap-2 text-[9px] lg:text-[9px] sm:text-xs text-gray-600 w-full",children:["Prospecting","Qualification","Proposal","Negotiation","Closed"].map((D,U)=>a.jsx("span",{className:"text-center flex-1 break-words",children:D},U))})]}),a.jsx("p",{className:"text-sm text-orange-600 font-medium mt-6 text-center break-words",children:p.stage})]})]}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 sm:p-5 shadow-sm break-words",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-3",children:"Contact Information"}),a.jsxs("div",{className:"text-sm sm:text-sm text-gray-700 space-y-3",children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Account:"})," ",p.account?.name]}),a.jsx("div",{className:"h-px bg-gray-200 w-full"}),a.jsxs("p",{children:[a.jsx("strong",{children:"Primary Contact:"})," ",p.contact?.first_name," ",p.contact?.last_name]}),a.jsx("div",{className:"h-px bg-gray-200 w-full"}),a.jsxs("p",{children:[a.jsx("strong",{children:"Phone:"})," ",p.contact?.work_phone]}),a.jsx("div",{className:"h-px bg-gray-200 w-full"}),a.jsxs("p",{children:[a.jsx("strong",{children:"Email:"})," ",p.contact?.email]}),a.jsx("div",{className:"h-px bg-gray-200 w-full"}),a.jsxs("p",{children:[a.jsx("strong",{children:"Assigned To:"})," ",p.assigned_deals?.first_name," ",p.assigned_deals?.last_name]})]})]})]}),z==="Notes"&&a.jsxs("div",{className:"mt-4 w-full",children:[a.jsx("div",{className:"flex flex-wrap items-center justify-between mb-4 gap-2",children:a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words",children:"Deal Note"})}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 shadow-sm break-words",children:[a.jsx("div",{className:"flex items-start justify-between",children:a.jsx("div",{children:a.jsx("p",{className:"text-sm font-medium text-gray-800 break-words",children:"Note"})})}),a.jsx("div",{className:"mt-3 text-sm text-gray-700 whitespace-pre-wrap break-words",children:p.description||"No notes available."})]}),a.jsx(Tn,{comments:A,onAddComment:E})]}),s==="Activities"&&a.jsxs("div",{className:"space-y-2 w-full h-full max-h-[50dvh] overflow-y-auto bg-gray-50 p-2 hide-scrollbar rounded-lg border border-gray-200 shadow-sm",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words border-b border-gray-300 py-2",children:"Related Activities"}),a.jsxs("div",{className:"space-y-2 text-sm",children:[c.tasks&&c.tasks.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>N(y==="tasks"?null:"tasks"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Qt,{className:"text-blue-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Tasks (",c.tasks.length,")"]})]}),y==="tasks"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),y==="tasks"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:c.tasks.map((D,U)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>u(`/${w}/tasks`,{state:{taskID:D.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-blue-600 mt-1",children:a.jsx(Qt,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:D.subject||D.title||"Task"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:D.description||"No description"}),D.assigned_to&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Assigned: ",D.assigned_to.first_name," ",D.assigned_to.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:T(D.due_date||D.created_at)})]},`task-${U}`))})]}),c.meetings&&c.meetings.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>N(y==="meetings"?null:"meetings"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ot,{className:"text-green-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Meetings (",c.meetings.length,")"]})]}),y==="meetings"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),y==="meetings"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:c.meetings.map((D,U)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>u(`/${w}/meetings`,{state:{meetingID:D.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-green-600 mt-1",children:a.jsx(Ot,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:D.subject||D.title||"Meeting"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:D.description||D.location||"No description"}),D.host&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Host: ",D.host.first_name," ",D.host.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:T(D.start_time||D.created_at)})]},`meeting-${U}`))})]}),c.calls&&c.calls.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>N(y==="calls"?null:"calls"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(It,{className:"text-purple-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Calls (",c.calls.length,")"]})]}),y==="calls"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),y==="calls"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:c.calls.map((D,U)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>u(`/${w}/calls`,{state:{callID:D.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-purple-600 mt-1",children:a.jsx(It,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:D.subject||D.title||"Call"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:D.direction||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:T(D.call_time||D.created_at)})]},`call-${U}`))})]}),c.quotes&&c.quotes.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>N(y==="quotes"?null:"quotes"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ia,{className:"text-orange-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Quotes (",c.quotes.length,")"]})]}),y==="quotes"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),y==="quotes"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:c.quotes.map((D,U)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>u(`/${w}/quotes`,{state:{quoteID:D.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-orange-600 mt-1",children:a.jsx(ia,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:(D.quote_id?D.quote_id.replace(/Q(\d+)-\d+-/,"Q$1-"):"--")||"Quote"}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:D.status||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:T(D.presented_date)||""})]},`quote-${U}`))})]}),(!c||(!c.tasks||c.tasks.length===0)&&(!c.meetings||c.meetings.length===0)&&(!c.calls||c.calls.length===0)&&(!c.quotes||c.quotes.length===0)&&(!c.deals||c.deals.length===0)&&(!c.contacts||c.contacts.length===0))&&a.jsx("div",{className:"text-center py-8 text-gray-500",children:a.jsx("p",{children:"No related activities found for this account."})})]})]}),z==="Edit"&&a.jsxs("div",{className:"mt-4 space-y-4 w-full",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words",children:"Edit Deal"}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 sm:p-5 shadow-sm w-full",children:[a.jsxs("label",{className:"block mb-3 break-words",children:[a.jsx("span",{className:"text-sm text-gray-700",children:"Deal Name"}),a.jsx("input",{type:"text",className:"mt-1 block w-full border border-gray-200 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-gray-200",defaultValue:p.name})]}),a.jsxs("label",{className:"block mb-3 break-words",children:[a.jsx("span",{className:"text-sm text-gray-700",children:"Description"}),a.jsx("textarea",{className:"mt-1 block w-full border border-gray-200 rounded-md px-3 py-2 text-sm h-24 resize-y focus:outline-none focus:ring-2 focus:ring-gray-200",defaultValue:p.description})]}),a.jsx("button",{className:"bg-gray-900 text-white px-4 py-2 rounded-md hover:bg-gray-800",children:"Save Changes"})]})]})]}),a.jsx("div",{className:"w-full lg:w-auto",children:a.jsx(CZ,{selectedDeal:p,onStatusUpdate:l,onClose:n})})]})]})]})})}function o6e(){f.useEffect(()=>{document.title="Deals | Sari-Sari CRM"},[]);const e=kt(),t=ta(),[n,s]=f.useState(""),[r,i]=f.useState("Filter by Stage"),[o,l]=f.useState("Filter by Owner"),[c,u]=f.useState(null),[d,h]=f.useState("Overview"),[p,x]=f.useState(!1),[v,j]=f.useState(null),[y,N]=f.useState(!1),[w,S]=f.useState(1),[_,k]=f.useState(10),[T,A]=f.useState(!1),[E,M]=f.useState(null),[z,P]=f.useState(!1),[D,U]=f.useState([]),[B,R]=f.useState(!1),[q,Z]=f.useState(null),[V,oe]=f.useState([]),[je,X]=f.useState([]),[se,ye]=f.useState([]),[Ne,fe]=f.useState({}),[we,de]=f.useState(null);f.useEffect(()=>{const J=t.state,Y=J?.dealID;if(Y&&!J?.openDealModal){de(Y),e(t.pathname,{replace:!0,state:{}});return}},[t,e]),f.useEffect(()=>{if(we&&v?.length>0&&!y){const J=v.find(Y=>Y.id===we);J?u(J):H.error("Deal not found."),de(null)}},[we,v,y]);const[ke,ge]=f.useState({id:null,name:"",account_id:"",primary_contact_id:"",stage:"PROPOSAL",amount:"",close_date:"",assigned_to:"",currency:"PHP",description:""}),$e="dealDraft:admin/deals",be=3600*1e3,me=f.useRef(!1);f.useEffect(()=>{if(!me.current){me.current=!0;try{const J=sessionStorage.getItem($e);if(!J)return;const Y=JSON.parse(J);if(typeof Y?.ts=="number"&&Date.now()-Y.ts>be){sessionStorage.removeItem($e);return}if(Y?.returnTo&&Y.returnTo!==t.pathname)return;Y?.dealForm&&typeof Y.dealForm=="object"&&ge(Y.dealForm),typeof Y?.isEditing=="boolean"&&R(Y.isEditing),Y?.currentDealId!==void 0&&Z(Y.currentDealId),x(!0),sessionStorage.removeItem($e)}catch{sessionStorage.removeItem($e)}}},[t.pathname]);const Ue=f.useCallback(()=>{try{sessionStorage.setItem($e,JSON.stringify({ts:Date.now(),returnTo:t.pathname,dealForm:ke,isEditing:B,currentDealId:q}))}catch{}},[$e,t.pathname,ke,B,q]),Ee=f.useCallback(()=>{Ue(),window.open("/admin/accounts?openModal=1","_blank","noopener,noreferrer")},[Ue]),We=f.useCallback(()=>{Ue(),window.open("/admin/contacts?openModal=1","_blank","noopener,noreferrer")},[Ue]),tt={"Prospecting Stage":"PROSPECTING","Qualification Stage":"QUALIFICATION","Proposal Stage":"PROPOSAL","Negotiation Stage":"NEGOTIATION","Closed Won Stage":"CLOSED_WON","Closed Lost Stage":"CLOSED_LOST","Closed Cancelled Stage":"CLOSED_CANCELLED"},lt=J=>({PROSPECTING:"Prospecting",QUALIFICATION:"Qualification",PROPOSAL:"Proposal",NEGOTIATION:"Negotiation",CLOSED_WON:"Closed Won",CLOSED_LOST:"Closed Lost",CLOSED_CANCELLED:"Closed Cancelled"})[J]||J||"--",Fe=J=>({PROSPECTING:"bg-blue-100 text-blue-700",QUALIFICATION:"bg-yellow-100 text-yellow-700",PROPOSAL:"bg-orange-100 text-orange-700",NEGOTIATION:"bg-purple-100 text-purple-700",CLOSED_WON:"bg-green-100 text-green-700",CLOSED_LOST:"bg-red-100 text-red-700",CLOSED_CANCELLED:"bg-red-100 text-red-700"})[J]||"bg-gray-100 text-gray-700",st=f.useCallback(async J=>{try{const Y=await re.get(`/activities/deal/${J}`);fe(Y.data&&typeof Y.data=="object"?Y.data:{})}catch(Y){console.error(Y),Y.response?.status===404&&(console.warn("No activities found for this account."),fe({}))}},[]),Xe=J=>{if(!J)return"";const Y=String(J).split("-");return Y.length===3?`${Y[0]}-${Y[2]}`:String(J)},Ze=f.useMemo(()=>{const J=n.trim().toLowerCase(),Y=r.trim(),F=o.trim();return(v??[]).filter(ue=>{const De=[ue?.name,ue?.description,ue?.account?.name,ue?.contact?.first_name,ue?.contact?.last_name,ue?.assigned_deals?.first_name,ue?.assigned_deals?.last_name],le=J===""||De.some(ie=>ie==null||ie===""?!1:ie.toString().toLowerCase().includes(J)),Ie=Y==="Filter by Stage"||Y===""||ue.stage===tt[Y]||ue.stage===Y,K=F==="Filter by Owner"||F===""||`${ue.assigned_deals?.first_name||""} ${ue.assigned_deals?.last_name||""}`.trim().toLowerCase()===F.toLowerCase();return le&&Ie&&K})},[v,n,r,o]),Je=Math.max(1,Math.ceil(Ze.length/_)||1);f.useEffect(()=>{S(1)},[n,r,o,_]),f.useEffect(()=>{S(J=>{const Y=Math.max(1,Math.ceil(Ze.length/_)||1);return J>Y?Y:J})},[Ze.length,_]);const Be=f.useMemo(()=>{const J=(w-1)*_;return Ze.slice(J,J+_)},[Ze,w,_]),_e=()=>S(J=>Math.max(J-1,1)),pe=()=>S(J=>Math.min(J+1,Je)),ce=()=>{ge({id:null,name:"",account_id:"",primary_contact_id:"",stage:"PROPOSAL",amount:"",close_date:"",assigned_to:"",currency:"PHP",description:""}),R(!1),Z(null),x(!0)},Q=async()=>{N(!0);try{const J=await re.get("/deals/admin/fetch-all"),F=[...Array.isArray(J.data)?J.data:[]].sort((ue,De)=>{const le=ue?.created_at?new Date(ue.created_at).getTime():0;return(De?.created_at?new Date(De.created_at).getTime():0)-le});j(F)}catch(J){J.response&&J.response.status===403?H.error("Permission denied. Only CEO, Admin, or Group Manager can access this page."):H.error("Failed to fetch deals. Please try again later."),console.error(J)}finally{N(!1)}},ne=async()=>{try{const J=await re.get("/accounts/admin/fetch-all");oe(Array.isArray(J.data)?J.data:[])}catch(J){console.error(J),J.response?.status===403&&H.warn("Unable to load accounts (permission denied).")}},ae=async()=>{try{const J=await re.get("/contacts/admin/fetch-all");X(Array.isArray(J.data)?J.data:[])}catch(J){console.error(J),J.response?.status===403&&H.warn("Unable to load contacts (permission denied).")}},Pe=async()=>{try{const J=await re.get("/users/all");ye(Array.isArray(J.data)?J.data:[])}catch(J){console.error(J),J.response?.status===403&&H.warn("Unable to load users (permission denied).")}};f.useEffect(()=>{Q(),ne(),ae(),Pe()},[]);const Te=J=>{J&&(ge({id:J.id||null,name:J.name||"",account_id:J.account_id?.toString()||"",primary_contact_id:J.primary_contact_id?.toString()||"",stage:J.stage||"PROPOSAL",amount:J.amount?.toString()||"",close_date:J.close_date?new Date(J.close_date).toISOString().split("T")[0]:"",assigned_to:J.assigned_to?.toString()||"",currency:J.currency||"PHP",description:J.description||""}),R(!0),Z(J.id),u(null),x(!0))},he=async(J=!1)=>{try{const Y=await re.get("/deals/admin/fetch-all"),ue=[...Array.isArray(Y.data)?Y.data:[]].sort((De,le)=>{const Ie=De?.created_at?new Date(De.created_at).getTime():0;return(le?.created_at?new Date(le.created_at).getTime():0)-Ie});if(j(ue),!J&&c&&c.id){const De=ue.find(le=>le.id===c.id);De&&u({...De})}}catch(Y){console.error("Failed to refresh deal data:",Y),await Q()}},He=J=>{const Y=J.name.trim();if(!Y){H.error("Deal name is required.");return}if(!J.account_id){H.error("Account is required.");return}const F=B&&q?"update":"create",ue=Y;M({title:F==="create"?"Confirm New Deal":"Confirm Update",message:F==="create"?a.jsxs("span",{children:["Are you sure you want to create"," ",a.jsx("span",{className:"font-semibold",children:ue}),"?"]}):a.jsxs("span",{children:["Save changes to ",a.jsx("span",{className:"font-semibold",children:ue}),"?"]}),confirmLabel:F==="create"?"Create Deal":"Update Deal",cancelLabel:"Cancel",variant:"primary",action:{type:F,formData:J,targetId:q||null,name:ue}})},qe=J=>{if(!J)return;const Y=J.name||"this deal";M({title:"Delete Deal",message:a.jsxs("span",{children:["Are you sure you want to permanently delete"," ",a.jsx("span",{className:"font-semibold",children:Y}),"? This action cannot be undone."]}),confirmLabel:"Delete Deal",cancelLabel:"Cancel",variant:"danger",action:{type:"delete",targetId:J.id,name:Y}})},nt=J=>{if(J.target.checked){const Y=Be.map(F=>F.id);U(Y)}else U([])},ot=J=>{U(Y=>Y.includes(J)?Y.filter(F=>F!==J):[...Y,J])},Re=async()=>{D.length!==0&&M({title:"Delete Deals",message:a.jsxs("span",{children:["Are you sure you want to delete"," ",a.jsx("span",{className:"font-semibold",children:D.length})," selected deals? This action cannot be undone."]}),confirmLabel:`Delete ${D.length} Deal(s)`,cancelLabel:"Cancel",variant:"danger",action:{type:"bulk-delete",dealIds:D}})},it=async()=>{if(!E?.action){M(null);return}const{action:J}=E,{type:Y,formData:F,targetId:ue,name:De}=J;P(!0);try{if(Y==="create"){A(!0);const le={name:F.name.trim(),account_id:parseInt(F.account_id),primary_contact_id:F.primary_contact_id?parseInt(F.primary_contact_id):null,stage:F.stage,amount:F.amount?parseFloat(F.amount):null,currency:F.currency||"PHP",close_date:F.close_date||null,description:F.description||null,assigned_to:F.assigned_to?parseInt(F.assigned_to):null};await re.post("/deals/admin/create",le),H.success(`Deal "${De}" created successfully.`),x(!1),await Q()}else if(Y==="update"){if(!ue)throw new Error("Missing deal identifier for update.");A(!0);const le={};F.name!==void 0&&(le.name=F.name.trim()),F.account_id!==void 0&&F.account_id!==""&&(le.account_id=parseInt(F.account_id)),F.primary_contact_id!==void 0&&(le.primary_contact_id=F.primary_contact_id?parseInt(F.primary_contact_id):null),F.stage!==void 0&&(le.stage=F.stage),F.amount!==void 0&&F.amount!==""&&(le.amount=parseFloat(F.amount)),F.currency!==void 0&&(le.currency=F.currency),F.close_date!==void 0&&(le.close_date=F.close_date||null),F.description!==void 0&&(le.description=F.description||null),F.assigned_to!==void 0&&(le.assigned_to=F.assigned_to?parseInt(F.assigned_to):null),await re.put(`/deals/admin/${ue}`,le),H.success(`Deal "${De}" updated successfully.`),x(!1),await Q()}else if(Y==="delete"){if(!ue)throw new Error("Missing deal identifier for deletion.");await re.delete(`/deals/admin/${ue}`),H.success(`Deal "${De}" deleted successfully.`),c?.id===ue&&u(null),await Q()}else if(Y==="bulk-delete"){const{dealIds:le}=J;await re.delete("/deals/admin/bulk-delete",{data:{deal_ids:le}}),H.success(`Successfully deleted ${le.length} deals`),U([]),await Q()}}catch(le){console.error(le);const Ie=Y==="create"?"Failed to create deal. Please review the details and try again.":Y==="update"?"Failed to update deal. Please review the details and try again.":"Failed to delete deal. Please try again.",K=le.response?.data?.detail||Ie;H.error(K)}finally{(Y==="create"||Y==="update")&&A(!1),P(!1),M(null)}},St=()=>{z||M(null)},Et=()=>{x(!1),ge({id:null,name:"",account_id:"",primary_contact_id:"",stage:"PROPOSAL",amount:"",close_date:"",assigned_to:"",currency:"PHP",description:""}),R(!1),Z(null),A(!1)},Tt=J=>J?new Date(J).toLocaleString("en-US",{month:"short",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).replace(",",""):"",Nt=(v??[]).filter(J=>J.stage==="PROSPECTING"&&J.status!=="Inactive").length,xe=(v??[]).filter(J=>J.stage==="QUALIFICATION"&&J.status!=="Inactive").length,ve=(v??[]).filter(J=>J.stage==="PROPOSAL"&&J.status!=="Inactive").length,Oe=(v??[]).filter(J=>J.stage==="NEGOTIATION"&&J.status!=="Inactive").length,Ce=(v??[]).filter(J=>J.stage==="CLOSED_WON"&&J.status!=="Inactive").length,Qe=(v??[]).filter(J=>J.stage==="CLOSED_LOST"&&J.status!=="Inactive").length,G=(v??[]).filter(J=>J.stage==="CLOSED_CANCELLED"&&J.status!=="Inactive").length,W=[{title:"Prospecting",value:Nt,icon:yj,color:"text-blue-600",bgColor:"bg-blue-100"},{title:"Qualification",value:xe,icon:gn,color:"text-yellow-600",bgColor:"bg-yellow-100"},{title:"Proposal",value:ve,icon:sa,color:"text-orange-600",bgColor:"bg-orange-100"},{title:"Negotiation",value:Oe,icon:cd,color:"text-purple-600",bgColor:"bg-purple-100"},{title:"Closed Won",value:Ce,icon:Qa,color:"text-green-600",bgColor:"bg-green-100"},{title:"Closed Lost",value:Qe,icon:Us,color:"text-red-600",bgColor:"bg-red-100"},{title:"Closed Cancelled",value:G,icon:Us,color:"text-gray-600",bgColor:"bg-gray-100"}];return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[y&&a.jsx(Wt,{message:"Loading deals..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h1",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(sa,{className:"mr-2 text-blue-600"}),"Deals"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{onClick:ce,className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 lg:my-0 rounded-md hover:bg-gray-800 text-sm sm:text-base mx-auto sm:ml-auto cursor-pointer",children:[a.jsx(aa,{className:"mr-2"})," Add Deal"]})})]}),a.jsx("div",{className:"grid grid-cols-1 p-2 lg:grid-cols-4 gap-4 mb-6 w-full break-words overflow-hidden",children:W.map(J=>a.jsx(c6e,{...J},J.title))}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search deals",value:n,onChange:J=>s(J.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsxs("div",{className:"w-full lg:w-auto flex flex-col lg:flex-row gap-3",children:[a.jsxs("select",{value:r,onChange:J=>i(J.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full lg:w-40 focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{value:"Filter by Stage",children:"Filter by Stage"}),a.jsx("option",{value:"Prospecting Stage",children:"Prospecting"}),a.jsx("option",{value:"Qualification Stage",children:"Qualification"}),a.jsx("option",{value:"Proposal Stage",children:"Proposal"}),a.jsx("option",{value:"Negotiation Stage",children:"Negotiation"}),a.jsx("option",{value:"Closed Won Stage",children:"Closed Won"}),a.jsx("option",{value:"Closed Lost Stage",children:"Closed Lost"}),a.jsx("option",{value:"Closed Cancelled Stage",children:"Closed Cancelled"})]}),a.jsxs("select",{value:o,onChange:J=>l(J.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full lg:w-40 focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{value:"Filter by Owner",children:"Filter by Owner"}),[...new Set((v??[]).map(J=>`${J.assigned_deals?.first_name} ${J.assigned_deals?.last_name}`))].map((J,Y)=>a.jsx("option",{value:J,children:J},Y))]})]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[500px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 text-sm tracking-wide font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 w-10",children:a.jsx("input",{type:"checkbox",className:"w-4 h-4 accent-blue-600",checked:Be.length>0&&Be.every(J=>D.includes(J.id)),onChange:nt})}),a.jsx("th",{className:"py-3 px-4",children:"Deal ID"}),a.jsx("th",{className:"py-3 px-4 truncate",children:"Deal Name"}),a.jsx("th",{className:"py-3 px-4",children:"Account"}),a.jsx("th",{className:"py-3 px-4",children:"Contact"}),a.jsx("th",{className:"py-3 px-4",children:"Stage/Status"}),a.jsx("th",{className:"py-3 px-4",children:"Value"}),a.jsx("th",{className:"py-3 px-4",children:"Close Date"}),a.jsx("th",{className:"py-3 px-4",children:"Owner"}),a.jsx("th",{className:"py-3 px-4 text-center w-24",children:D.length>0?a.jsx("button",{onClick:Re,className:"text-red-600 hover:text-red-800 transition p-1 rounded-full hover:bg-red-50",title:`Delete ${D.length} selected items`,children:a.jsx(wa,{size:18})}):""})]})}),a.jsx("tbody",{children:Ze.length>0?Be.map(J=>a.jsxs("tr",{className:"hover:bg-gray-50 text-sm cursor-pointer",onClick:()=>{u({...J}),st(J.id)},children:[a.jsx("td",{className:"py-3 px-4",onClick:Y=>Y.stopPropagation(),children:a.jsx("input",{type:"checkbox",className:"w-4 h-4 accent-blue-600",checked:D.includes(J.id),onChange:()=>ot(J.id)})}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",children:Xe(J.deal_id)}),a.jsx("td",{className:"py-3 px-4",children:a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-blue-600 hover:underline break-all text-sm",children:J.name}),a.jsx("div",{className:"text-gray-500 text-xs break-all",children:J.description||"--"})]})}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",children:J.account?.name||"--"}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",children:J.contact?.first_name&&J.contact?.last_name?`${J.contact.first_name} ${J.contact.last_name}`:J.contact?.first_name||J.contact?.last_name||"--"}),a.jsx("td",{className:"py-3 px-4",children:J.status==="Inactive"?a.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-gray-300 text-gray-800",children:"Inactive"}):a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${Fe(J.stage)}`,children:lt(J.stage)})}),a.jsxs("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",children:[" ",J.amount?.toLocaleString()||"0"]}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",children:Tt(J.close_date)||"--"}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",children:J.assigned_deals?.first_name&&J.assigned_deals?.last_name?`${J.assigned_deals.first_name} ${J.assigned_deals.last_name}`:J.assigned_deals?.first_name||J.assigned_deals?.last_name||"--"})]},J.id)):a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:8,children:"No deals found."})})})]})}),a.jsx(ca,{className:"mt-4",totalItems:Ze.length,pageSize:_,currentPage:w,onPrev:_e,onNext:pe,onPageSizeChange:J=>{k(J),S(1)},pageSizeOptions:[10,20,30,40,50],label:"deals"}),p&&a.jsx(d6e,{onClose:Et,formData:ke,setFormData:ge,isEditing:B,onSubmit:He,isSubmitting:T||z,accounts:V,contacts:je,users:se,onAddAccount:Ee,onAddContact:We,onRefreshAccounts:ne,onRefreshContacts:ae}),c&&a.jsx(SZ,{relatedActs:Ne,selectedDeal:c,show:!!c,onClose:()=>u(null),activeTab:d,setActiveTab:h,onEdit:Te,onDelete:qe,onStatusUpdate:he}),E&&a.jsx(l6e,{open:!0,title:E.title,message:E.message,confirmLabel:E.confirmLabel,cancelLabel:E.cancelLabel,variant:E.variant,onConfirm:it,onCancel:St,loading:z})]})}function l6e({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o=!1,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[10000]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsx("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${u}`,disabled:o,children:o?"Processing...":s})]})]})})}function c6e({icon:e,title:t,value:n,color:s="text-blue-600",bgColor:r="bg-blue-100",onClick:i}){const o=()=>{typeof i=="function"?i():console.log(`Clicked: ${t}`)};return a.jsxs("div",{className:"flex items-center p-4 bg-white rounded-xl shadow-md border border-gray-200 transition-all duration-300",onClick:o,children:[a.jsx("div",{className:`flex-shrink-0 p-3 rounded-full ${r} ${s} mr-4`,children:e?a.jsx(e,{size:22}):null}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:t}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:n})]})]})}function d6e({onClose:e,formData:t,setFormData:n,isEditing:s=!1,onSubmit:r,isSubmitting:i=!1,accounts:o=[],contacts:l=[],users:c=[],onAddAccount:u,onAddContact:d,onRefreshAccounts:h,onRefreshContacts:p}){const[x,v]=f.useState(!1),j=w=>{if(w.preventDefault(),v(!0),!t.name?.trim()){H.error("Deal name is required.");return}const S=Number(t.amount);if(!t.amount||isNaN(S)||S<=0){H.error("Amount must be a number greater than 0.");return}if(!t.account_id){H.error("Please select an account.");return}if(!t.primary_contact_id){H.error("Please select a primary contact.");return}if(!t.assigned_to){H.error("Please assign this deal to a user.");return}r?.(t)},y=w=>{w.target.id==="modalBackdrop"&&e()},N=f.useMemo(()=>{const w=String(t.account_id||"").trim(),S=Array.isArray(l)?l:[];return w?S.filter(_=>{const T=[_?.account_id,_?.accountId,_?.account?.id,_?.account?.account_id,_?.account?.accountId].find(A=>A!=null&&String(A).trim()!=="");return T?String(T)===w:!1}):S},[l,t.account_id]);return f.useEffect(()=>{const w=String(t.account_id||"").trim(),S=String(t.primary_contact_id||"").trim();if(!S||!w)return;N.some(k=>String(k?.id)===S)||n(k=>({...k,primary_contact_id:""}))},[t.account_id,t.primary_contact_id,N,n]),a.jsx("div",{id:"modalBackdrop",onClick:y,className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-full sm:max-w-3xl rounded-2xl shadow-lg p-4 sm:p-6 md:p-8 relative border border-gray-200 overflow-y-auto max-h-[90vh] hide-scrollbar",onClick:w=>w.stopPropagation(),children:[a.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-gray-500 hover:text-black transition",children:a.jsx(ea,{size:22})}),a.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800 mb-4 sm:mb-6 flex items-center justify-center",children:s?"Edit Deal":"Create Deal"}),a.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",onSubmit:j,noValidate:!0,children:[a.jsx(yA,{label:"Deal Name",name:"name",value:t.name,onChange:w=>n({...t,name:w.target.value}),placeholder:"Enter deal name",required:!0,isSubmitted:x,className:"md:col-span-2"}),a.jsx(bA,{label:"Account",value:t.account_id||"",onChange:w=>n({...t,account_id:w}),items:o||[],getLabel:w=>w?.name??"",placeholder:"Search account...",disabled:i,required:!0,isSubmitted:x,actions:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{type:"button",onClick:u,disabled:i,title:"Add account",className:"inline-flex items-center justify-center w-8 h-8 rounded-md border border-gray-300 text-gray-600 hover:bg-gray-50 transition disabled:opacity-60",children:a.jsx(aa,{size:16})}),a.jsx("button",{type:"button",onClick:h,disabled:i,title:"Refresh accounts",className:"inline-flex items-center justify-center w-8 h-8 rounded-md border border-gray-300 text-gray-600 hover:bg-gray-50 transition disabled:opacity-60",children:a.jsx(Br,{size:16})})]})}),a.jsx(bA,{label:"Primary Contact",value:t.primary_contact_id||"",onChange:w=>n({...t,primary_contact_id:w}),items:N||[],getLabel:w=>`${w?.first_name??""} ${w?.last_name??""}`.trim()||w?.email||"",placeholder:"Search contact...",required:!0,isSubmitted:x,disabled:i,actions:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{type:"button",onClick:d,disabled:i,title:"Add contact",className:"inline-flex items-center justify-center w-8 h-8 rounded-md border border-gray-300 text-gray-600 hover:bg-gray-50 transition disabled:opacity-60",children:a.jsx(aa,{size:16})}),a.jsx("button",{type:"button",onClick:p,disabled:i,title:"Refresh contacts",className:"inline-flex items-center justify-center w-8 h-8 rounded-md border border-gray-300 text-gray-600 hover:bg-gray-50 transition disabled:opacity-60",children:a.jsx(Br,{size:16})})]})}),a.jsx(H7,{label:"Stage",name:"stage",value:t.stage,onChange:w=>n({...t,stage:w.target.value}),options:[{value:"PROSPECTING",label:"Prospecting"},{value:"QUALIFICATION",label:"Qualification"},{value:"PROPOSAL",label:"Proposal"},{value:"NEGOTIATION",label:"Negotiation"},{value:"CLOSED_WON",label:"Closed Won"},{value:"CLOSED_LOST",label:"Closed Lost"},{value:"CLOSED_CANCELLED",label:"Closed Cancelled"}],disabled:i}),a.jsx(yA,{label:"Amount",name:"amount",type:"number",step:"0.01",value:t.amount,onChange:w=>n({...t,amount:w.target.value}),placeholder:"0",required:!0,isSubmitted:x}),a.jsx(H7,{label:"Currency",name:"currency",value:t.currency||"PHP",onChange:w=>n({...t,currency:w.target.value}),options:[{value:"PHP",label:"PHP"},{value:"USD",label:"USD"}],disabled:i}),a.jsx(yA,{label:"Close Date",name:"close_date",type:"date",value:t.close_date||"",onChange:w=>n({...t,close_date:w.target.value}),disabled:i}),a.jsx(bA,{label:"Assign To",value:t.assigned_to||"",onChange:w=>n({...t,assigned_to:w}),items:c||[],getLabel:w=>`${w?.first_name??""} ${w?.last_name??""}`.trim()||w?.email||"",placeholder:"Search assignee...",disabled:i,required:!0,isSubmitted:x,className:"md:col-span-2"}),a.jsx(m6e,{label:"Description",name:"description",value:t.description,onChange:w=>n({...t,description:w.target.value}),placeholder:"Additional details...",rows:3,className:"md:col-span-2",disabled:i}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-2 md:col-span-2 mt-4",children:[a.jsx("button",{type:"button",onClick:e,className:"w-full sm:w-auto px-4 py-2 text-white bg-red-400 border border-red-300 rounded hover:bg-red-500 transition disabled:opacity-70",disabled:i,children:"Cancel"}),a.jsx("button",{type:"submit",className:"w-full sm:w-auto px-4 py-2 text-white border border-tertiary bg-tertiary rounded hover:bg-secondary transition disabled:opacity-70",disabled:i,children:i?"Saving...":s?"Update Deal":"Save Deal"})]})]})]})})}function yA({label:e,name:t,value:n,onChange:s,placeholder:r,type:i="text",required:o=!1,disabled:l=!1,className:c="",isSubmitted:u=!1}){const d=u&&!n?.trim();return a.jsxs("div",{className:c,children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",o&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:i,name:t,value:n??"",onChange:s,placeholder:r,required:o,disabled:l,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border focus:ring-2
          ${d?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}
          ${c}
        `})]})}function H7({label:e,name:t,value:n,onChange:s,options:r,required:i=!1,disabled:o=!1,className:l=""}){return a.jsxs("div",{className:l,children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsx("select",{name:t,value:n??"",onChange:s,required:i,disabled:o,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100",children:r.map(c=>a.jsx("option",{value:c.value,children:c.label},c.value))})]})}function bA({label:e,items:t=[],value:n="",onChange:s,getLabel:r,placeholder:i="Search...",disabled:o=!1,className:l="",required:c=!1,isSubmitted:u=!1,actions:d=null}){const h=u&&c&&!n;return a.jsxs("div",{className:l,children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",c&&a.jsx("span",{className:"text-red-500",children:"*"})]}),d?a.jsx("div",{className:"flex items-center",children:d}):null]}),a.jsx(u6e,{items:t,value:n??"",onChange:s,getLabel:r,placeholder:i,disabled:o,hasError:h})]})}function u6e({items:e=[],value:t="",onChange:n,getLabel:s,placeholder:r="Search...",disabled:i=!1,maxRender:o=200,hasError:l=!1}){const[c,u]=f.useState(!1),[d,h]=f.useState(""),p=f.useRef(null),x=e.find(y=>String(y.id)===String(t)),v=x?s(x):"",j=f.useMemo(()=>{const y=d.trim().toLowerCase();return(y?e.filter(w=>(s(w)||"").toLowerCase().includes(y)):e).slice(0,o)},[e,d,s,o]);return f.useEffect(()=>{const y=N=>{p.current&&!p.current.contains(N.target)&&u(!1)};return document.addEventListener("mousedown",y),()=>document.removeEventListener("mousedown",y)},[]),f.useEffect(()=>{c||h("")},[c]),a.jsxs("div",{ref:p,className:"relative w-full",children:[a.jsx("input",{disabled:i,value:c?d:v,placeholder:r,onFocus:()=>!i&&u(!0),onChange:y=>{h(y.target.value),c||u(!0)},className:`w-full border rounded-md px-2 py-1.5 text-sm outline-none focus:ring-2
          ${l?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}`}),c&&!i&&a.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg overflow-hidden",children:[a.jsx("div",{className:"max-h-56 overflow-y-auto hide-scrollbar",children:j.length>0?j.map(y=>{const N=String(y.id),w=s(y),S=String(t)===N;return a.jsx("button",{type:"button",onClick:()=>{n(N),u(!1)},className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-50 ${S?"bg-blue-50":""}`,children:w||"--"},N)}):a.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No results"})}),e.length>o&&a.jsxs("div",{className:"px-3 py-2 text-[11px] text-gray-400 border-t",children:["Showing first ",o," results  keep typing to narrow."]})]})]})}function m6e({label:e,name:t,value:n,onChange:s,placeholder:r,required:i=!1,disabled:o=!1,className:l="",rows:c=3}){return a.jsxs("div",{className:l,children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsx("textarea",{name:t,value:n??"",onChange:s,placeholder:r,required:i,disabled:o,rows:c,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100 resize-none"})]})}var f6e=Object.defineProperty,h6e=(e,t,n)=>t in e?f6e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,vA=(e,t,n)=>(h6e(e,typeof t!="symbol"?t+"":t,n),n);let g6e=class{constructor(){vA(this,"current",this.detect()),vA(this,"handoffState","pending"),vA(this,"currentId",0)}set(t){this.current!==t&&(this.handoffState="pending",this.currentId=0,this.current=t)}reset(){this.set(this.detect())}nextId(){return++this.currentId}get isServer(){return this.current==="server"}get isClient(){return this.current==="client"}detect(){return typeof window>"u"||typeof document>"u"?"server":"client"}handoff(){this.handoffState==="pending"&&(this.handoffState="complete")}get isHandoffComplete(){return this.handoffState==="complete"}},zo=new g6e;function x0(e){var t;return zo.isServer?null:e==null?document:(t=e?.ownerDocument)!=null?t:document}function KE(e){var t,n;return zo.isServer?null:e==null?document:(n=(t=e?.getRootNode)==null?void 0:t.call(e))!=null?n:document}function _Z(e){var t,n;return(n=(t=KE(e))==null?void 0:t.activeElement)!=null?n:null}function p6e(e){return _Z(e)===e}function v1(e){typeof queueMicrotask=="function"?queueMicrotask(e):Promise.resolve().then(e).catch(t=>setTimeout(()=>{throw t}))}function fc(){let e=[],t={addEventListener(n,s,r,i){return n.addEventListener(s,r,i),t.add(()=>n.removeEventListener(s,r,i))},requestAnimationFrame(...n){let s=requestAnimationFrame(...n);return t.add(()=>cancelAnimationFrame(s))},nextFrame(...n){return t.requestAnimationFrame(()=>t.requestAnimationFrame(...n))},setTimeout(...n){let s=setTimeout(...n);return t.add(()=>clearTimeout(s))},microTask(...n){let s={current:!0};return v1(()=>{s.current&&n[0]()}),t.add(()=>{s.current=!1})},style(n,s,r){let i=n.style.getPropertyValue(s);return Object.assign(n.style,{[s]:r}),this.add(()=>{Object.assign(n.style,{[s]:i})})},group(n){let s=fc();return n(s),this.add(()=>s.dispose())},add(n){return e.includes(n)||e.push(n),()=>{let s=e.indexOf(n);if(s>=0)for(let r of e.splice(s,1))r()}},dispose(){for(let n of e.splice(0))n()}};return t}function w1(){let[e]=f.useState(fc);return f.useEffect(()=>()=>e.dispose(),[e]),e}let br=(e,t)=>{zo.isServer?f.useEffect(e,t):f.useLayoutEffect(e,t)};function om(e){let t=f.useRef(e);return br(()=>{t.current=e},[e]),t}let Ya=function(e){let t=om(e);return wt.useCallback((...n)=>t.current(...n),[t])};function y0(e){return f.useMemo(()=>e,Object.values(e))}let x6e=f.createContext(void 0);function y6e(){return f.useContext(x6e)}function XE(...e){return Array.from(new Set(e.flatMap(t=>typeof t=="string"?t.split(" "):[]))).filter(Boolean).join(" ")}function Jl(e,t,...n){if(e in t){let r=t[e];return typeof r=="function"?r(...n):r}let s=new Error(`Tried to handle "${e}" but there is no handler defined. Only defined handlers are: ${Object.keys(t).map(r=>`"${r}"`).join(", ")}.`);throw Error.captureStackTrace&&Error.captureStackTrace(s,Jl),s}var Bw=(e=>(e[e.None=0]="None",e[e.RenderStrategy=1]="RenderStrategy",e[e.Static=2]="Static",e))(Bw||{}),ad=(e=>(e[e.Unmount=0]="Unmount",e[e.Hidden=1]="Hidden",e))(ad||{});function Li(){let e=v6e();return f.useCallback(t=>b6e({mergeRefs:e,...t}),[e])}function b6e({ourProps:e,theirProps:t,slot:n,defaultTag:s,features:r,visible:i=!0,name:o,mergeRefs:l}){l=l??w6e;let c=AZ(t,e);if(i)return vb(c,n,s,o,l);let u=r??0;if(u&2){let{static:d=!1,...h}=c;if(d)return vb(h,n,s,o,l)}if(u&1){let{unmount:d=!0,...h}=c;return Jl(d?0:1,{0(){return null},1(){return vb({...h,hidden:!0,style:{display:"none"}},n,s,o,l)}})}return vb(c,n,s,o,l)}function vb(e,t={},n,s,r){let{as:i=n,children:o,refName:l="ref",...c}=wA(e,["unmount","static"]),u=e.ref!==void 0?{[l]:e.ref}:{},d=typeof o=="function"?o(t):o;"className"in c&&c.className&&typeof c.className=="function"&&(c.className=c.className(t)),c["aria-labelledby"]&&c["aria-labelledby"]===c.id&&(c["aria-labelledby"]=void 0);let h={};if(t){let p=!1,x=[];for(let[v,j]of Object.entries(t))typeof j=="boolean"&&(p=!0),j===!0&&x.push(v.replace(/([A-Z])/g,y=>`-${y.toLowerCase()}`));if(p){h["data-headlessui-state"]=x.join(" ");for(let v of x)h[`data-${v}`]=""}}if(cp(i)&&(Object.keys(ru(c)).length>0||Object.keys(ru(h)).length>0))if(!f.isValidElement(d)||Array.isArray(d)&&d.length>1||N6e(d)){if(Object.keys(ru(c)).length>0)throw new Error(['Passing props on "Fragment"!',"",`The current component <${s} /> is rendering a "Fragment".`,"However we need to passthrough the following props:",Object.keys(ru(c)).concat(Object.keys(ru(h))).map(p=>`  - ${p}`).join(`
`),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "Fragment".',"Render a single element as the child so that we can forward the props onto that element."].map(p=>`  - ${p}`).join(`
`)].join(`
`))}else{let p=d.props,x=p?.className,v=typeof x=="function"?(...N)=>XE(x(...N),c.className):XE(x,c.className),j=v?{className:v}:{},y=AZ(d.props,ru(wA(c,["ref"])));for(let N in h)N in y&&delete h[N];return f.cloneElement(d,Object.assign({},y,h,u,{ref:r(j6e(d),u.ref)},j))}return f.createElement(i,Object.assign({},wA(c,["ref"]),!cp(i)&&u,!cp(i)&&h),d)}function v6e(){let e=f.useRef([]),t=f.useCallback(n=>{for(let s of e.current)s!=null&&(typeof s=="function"?s(n):s.current=n)},[]);return(...n)=>{if(!n.every(s=>s==null))return e.current=n,t}}function w6e(...e){return e.every(t=>t==null)?void 0:t=>{for(let n of e)n!=null&&(typeof n=="function"?n(t):n.current=t)}}function AZ(...e){if(e.length===0)return{};if(e.length===1)return e[0];let t={},n={};for(let s of e)for(let r in s)r.startsWith("on")&&typeof s[r]=="function"?(n[r]!=null||(n[r]=[]),n[r].push(s[r])):t[r]=s[r];if(t.disabled||t["aria-disabled"])for(let s in n)/^(on(?:Click|Pointer|Mouse|Key)(?:Down|Up|Press)?)$/.test(s)&&(n[s]=[r=>{var i;return(i=r?.preventDefault)==null?void 0:i.call(r)}]);for(let s in n)Object.assign(t,{[s](r,...i){let o=n[s];for(let l of o){if((r instanceof Event||r?.nativeEvent instanceof Event)&&r.defaultPrevented)return;l(r,...i)}}});return t}function _r(e){var t;return Object.assign(f.forwardRef(e),{displayName:(t=e.displayName)!=null?t:e.name})}function ru(e){let t=Object.assign({},e);for(let n in t)t[n]===void 0&&delete t[n];return t}function wA(e,t=[]){let n=Object.assign({},e);for(let s of t)s in n&&delete n[s];return n}function j6e(e){return wt.version.split(".")[0]>="19"?e.props.ref:e.ref}function cp(e){return e===f.Fragment||e===Symbol.for("react.fragment")}function N6e(e){return cp(e.type)}let C6e="span";var Hw=(e=>(e[e.None=1]="None",e[e.Focusable=2]="Focusable",e[e.Hidden=4]="Hidden",e))(Hw||{});function S6e(e,t){var n;let{features:s=1,...r}=e,i={ref:t,"aria-hidden":(s&2)===2?!0:(n=r["aria-hidden"])!=null?n:void 0,hidden:(s&4)===4?!0:void 0,style:{position:"fixed",top:1,left:1,width:1,height:0,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0",...(s&4)===4&&(s&2)!==2&&{display:"none"}}};return Li()({ourProps:i,theirProps:r,slot:{},defaultTag:C6e,name:"Hidden"})}let ZE=_r(S6e);function _6e(e){return typeof e!="object"||e===null?!1:"nodeType"in e}function dd(e){return _6e(e)&&"tagName"in e}function Vu(e){return dd(e)&&"accessKey"in e}function nd(e){return dd(e)&&"tabIndex"in e}function A6e(e){return dd(e)&&"style"in e}function T6e(e){return Vu(e)&&e.nodeName==="IFRAME"}function k6e(e){return Vu(e)&&e.nodeName==="INPUT"}let TZ=Symbol();function E6e(e,t=!0){return Object.assign(e,{[TZ]:t})}function Xo(...e){let t=f.useRef(e);f.useEffect(()=>{t.current=e},[e]);let n=Ya(s=>{for(let r of t.current)r!=null&&(typeof r=="function"?r(s):r.current=s)});return e.every(s=>s==null||s?.[TZ])?void 0:n}let XD=f.createContext(null);XD.displayName="DescriptionContext";function kZ(){let e=f.useContext(XD);if(e===null){let t=new Error("You used a <Description /> component, but it is not inside a relevant parent.");throw Error.captureStackTrace&&Error.captureStackTrace(t,kZ),t}return e}function L6e(){let[e,t]=f.useState([]);return[e.length>0?e.join(" "):void 0,f.useMemo(()=>function(n){let s=Ya(i=>(t(o=>[...o,i]),()=>t(o=>{let l=o.slice(),c=l.indexOf(i);return c!==-1&&l.splice(c,1),l}))),r=f.useMemo(()=>({register:s,slot:n.slot,name:n.name,props:n.props,value:n.value}),[s,n.slot,n.name,n.props,n.value]);return wt.createElement(XD.Provider,{value:r},n.children)},[t])]}let P6e="p";function D6e(e,t){let n=f.useId(),s=y6e(),{id:r=`headlessui-description-${n}`,...i}=e,o=kZ(),l=Xo(t);br(()=>o.register(r),[r,o.register]);let c=y0({...o.slot,disabled:s||!1}),u={ref:l,...o.props,id:r};return Li()({ourProps:u,theirProps:i,slot:c,defaultTag:P6e,name:o.name||"Description"})}let O6e=_r(D6e),M6e=Object.assign(O6e,{});var EZ=(e=>(e.Space=" ",e.Enter="Enter",e.Escape="Escape",e.Backspace="Backspace",e.Delete="Delete",e.ArrowLeft="ArrowLeft",e.ArrowUp="ArrowUp",e.ArrowRight="ArrowRight",e.ArrowDown="ArrowDown",e.Home="Home",e.End="End",e.PageUp="PageUp",e.PageDown="PageDown",e.Tab="Tab",e))(EZ||{});let I6e=f.createContext(()=>{});function $6e({value:e,children:t}){return wt.createElement(I6e.Provider,{value:e},t)}let LZ=class extends Map{constructor(t){super(),this.factory=t}get(t){let n=super.get(t);return n===void 0&&(n=this.factory(t),this.set(t,n)),n}};var R6e=Object.defineProperty,z6e=(e,t,n)=>t in e?R6e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,F6e=(e,t,n)=>(z6e(e,t+"",n),n),PZ=(e,t,n)=>{if(!t.has(e))throw TypeError("Cannot "+n)},li=(e,t,n)=>(PZ(e,t,"read from private field"),n?n.call(e):t.get(e)),jA=(e,t,n)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},q7=(e,t,n,s)=>(PZ(e,t,"write to private field"),t.set(e,n),n),jo,Kg,Xg;let U6e=class{constructor(t){jA(this,jo,{}),jA(this,Kg,new LZ(()=>new Set)),jA(this,Xg,new Set),F6e(this,"disposables",fc()),q7(this,jo,t),zo.isServer&&this.disposables.microTask(()=>{this.dispose()})}dispose(){this.disposables.dispose()}get state(){return li(this,jo)}subscribe(t,n){if(zo.isServer)return()=>{};let s={selector:t,callback:n,current:t(li(this,jo))};return li(this,Xg).add(s),this.disposables.add(()=>{li(this,Xg).delete(s)})}on(t,n){return zo.isServer?()=>{}:(li(this,Kg).get(t).add(n),this.disposables.add(()=>{li(this,Kg).get(t).delete(n)}))}send(t){let n=this.reduce(li(this,jo),t);if(n!==li(this,jo)){q7(this,jo,n);for(let s of li(this,Xg)){let r=s.selector(li(this,jo));DZ(s.current,r)||(s.current=r,s.callback(r))}for(let s of li(this,Kg).get(t.type))s(li(this,jo),t)}}};jo=new WeakMap,Kg=new WeakMap,Xg=new WeakMap;function DZ(e,t){return Object.is(e,t)?!0:typeof e!="object"||e===null||typeof t!="object"||t===null?!1:Array.isArray(e)&&Array.isArray(t)?e.length!==t.length?!1:NA(e[Symbol.iterator](),t[Symbol.iterator]()):e instanceof Map&&t instanceof Map||e instanceof Set&&t instanceof Set?e.size!==t.size?!1:NA(e.entries(),t.entries()):G7(e)&&G7(t)?NA(Object.entries(e)[Symbol.iterator](),Object.entries(t)[Symbol.iterator]()):!1}function NA(e,t){do{let n=e.next(),s=t.next();if(n.done&&s.done)return!0;if(n.done||s.done||!Object.is(n.value,s.value))return!1}while(!0)}function G7(e){if(Object.prototype.toString.call(e)!=="[object Object]")return!1;let t=Object.getPrototypeOf(e);return t===null||Object.getPrototypeOf(t)===null}var B6e=Object.defineProperty,H6e=(e,t,n)=>t in e?B6e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,W7=(e,t,n)=>(H6e(e,typeof t!="symbol"?t+"":t,n),n),q6e=(e=>(e[e.Push=0]="Push",e[e.Pop=1]="Pop",e))(q6e||{});let G6e={0(e,t){let n=t.id,s=e.stack,r=e.stack.indexOf(n);if(r!==-1){let i=e.stack.slice();return i.splice(r,1),i.push(n),s=i,{...e,stack:s}}return{...e,stack:[...e.stack,n]}},1(e,t){let n=t.id,s=e.stack.indexOf(n);if(s===-1)return e;let r=e.stack.slice();return r.splice(s,1),{...e,stack:r}}},W6e=class OZ extends U6e{constructor(){super(...arguments),W7(this,"actions",{push:t=>this.send({type:0,id:t}),pop:t=>this.send({type:1,id:t})}),W7(this,"selectors",{isTop:(t,n)=>t.stack[t.stack.length-1]===n,inStack:(t,n)=>t.stack.includes(n)})}static new(){return new OZ({stack:[]})}reduce(t,n){return Jl(n.type,G6e,t,n)}};const MZ=new LZ(()=>W6e.new());function IZ(e,t,n=DZ){return BOe.useSyncExternalStoreWithSelector(Ya(s=>e.subscribe(V6e,s)),Ya(()=>e.state),Ya(()=>e.state),Ya(t),n)}function V6e(e){return e}function b0(e,t){let n=f.useId(),s=MZ.get(t),[r,i]=IZ(s,f.useCallback(o=>[s.selectors.isTop(o,n),s.selectors.inStack(o,n)],[s,n]));return br(()=>{if(e)return s.actions.push(n),()=>s.actions.pop(n)},[s,e,n]),e?i?r:!0:!1}let JE=new Map,dp=new Map;function V7(e){var t;let n=(t=dp.get(e))!=null?t:0;return dp.set(e,n+1),n!==0?()=>Y7(e):(JE.set(e,{"aria-hidden":e.getAttribute("aria-hidden"),inert:e.inert}),e.setAttribute("aria-hidden","true"),e.inert=!0,()=>Y7(e))}function Y7(e){var t;let n=(t=dp.get(e))!=null?t:1;if(n===1?dp.delete(e):dp.set(e,n-1),n!==1)return;let s=JE.get(e);s&&(s["aria-hidden"]===null?e.removeAttribute("aria-hidden"):e.setAttribute("aria-hidden",s["aria-hidden"]),e.inert=s.inert,JE.delete(e))}function Y6e(e,{allowed:t,disallowed:n}={}){let s=b0(e,"inert-others");br(()=>{var r,i;if(!s)return;let o=fc();for(let c of(r=n?.())!=null?r:[])c&&o.add(V7(c));let l=(i=t?.())!=null?i:[];for(let c of l){if(!c)continue;let u=x0(c);if(!u)continue;let d=c.parentElement;for(;d&&d!==u.body;){for(let h of d.children)l.some(p=>h.contains(p))||o.add(V7(h));d=d.parentElement}}return o.dispose},[s,t,n])}function Q6e(e,t,n){let s=om(r=>{let i=r.getBoundingClientRect();i.x===0&&i.y===0&&i.width===0&&i.height===0&&n()});f.useEffect(()=>{if(!e)return;let r=t===null?null:Vu(t)?t:t.current;if(!r)return;let i=fc();if(typeof ResizeObserver<"u"){let o=new ResizeObserver(()=>s.current(r));o.observe(r),i.add(()=>o.disconnect())}if(typeof IntersectionObserver<"u"){let o=new IntersectionObserver(()=>s.current(r));o.observe(r),i.add(()=>o.disconnect())}return()=>i.dispose()},[t,s,e])}let qw=["[contentEditable=true]","[tabindex]","a[href]","area[href]","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","details>summary","textarea:not([disabled])"].map(e=>`${e}:not([tabindex='-1'])`).join(","),K6e=["[data-autofocus]"].map(e=>`${e}:not([tabindex='-1'])`).join(",");var El=(e=>(e[e.First=1]="First",e[e.Previous=2]="Previous",e[e.Next=4]="Next",e[e.Last=8]="Last",e[e.WrapAround=16]="WrapAround",e[e.NoScroll=32]="NoScroll",e[e.AutoFocus=64]="AutoFocus",e))(El||{}),eL=(e=>(e[e.Error=0]="Error",e[e.Overflow=1]="Overflow",e[e.Success=2]="Success",e[e.Underflow=3]="Underflow",e))(eL||{}),X6e=(e=>(e[e.Previous=-1]="Previous",e[e.Next=1]="Next",e))(X6e||{});function Z6e(e=document.body){return e==null?[]:Array.from(e.querySelectorAll(qw)).sort((t,n)=>Math.sign((t.tabIndex||Number.MAX_SAFE_INTEGER)-(n.tabIndex||Number.MAX_SAFE_INTEGER)))}function J6e(e=document.body){return e==null?[]:Array.from(e.querySelectorAll(K6e)).sort((t,n)=>Math.sign((t.tabIndex||Number.MAX_SAFE_INTEGER)-(n.tabIndex||Number.MAX_SAFE_INTEGER)))}var $Z=(e=>(e[e.Strict=0]="Strict",e[e.Loose=1]="Loose",e))($Z||{});function eRe(e,t=0){var n;return e===((n=x0(e))==null?void 0:n.body)?!1:Jl(t,{0(){return e.matches(qw)},1(){let s=e;for(;s!==null;){if(s.matches(qw))return!0;s=s.parentElement}return!1}})}var tRe=(e=>(e[e.Keyboard=0]="Keyboard",e[e.Mouse=1]="Mouse",e))(tRe||{});typeof window<"u"&&typeof document<"u"&&(document.addEventListener("keydown",e=>{e.metaKey||e.altKey||e.ctrlKey||(document.documentElement.dataset.headlessuiFocusVisible="")},!0),document.addEventListener("click",e=>{e.detail===1?delete document.documentElement.dataset.headlessuiFocusVisible:e.detail===0&&(document.documentElement.dataset.headlessuiFocusVisible="")},!0));function $l(e){e?.focus({preventScroll:!0})}let aRe=["textarea","input"].join(",");function nRe(e){var t,n;return(n=(t=e?.matches)==null?void 0:t.call(e,aRe))!=null?n:!1}function sRe(e,t=n=>n){return e.slice().sort((n,s)=>{let r=t(n),i=t(s);if(r===null||i===null)return 0;let o=r.compareDocumentPosition(i);return o&Node.DOCUMENT_POSITION_FOLLOWING?-1:o&Node.DOCUMENT_POSITION_PRECEDING?1:0})}function up(e,t,{sorted:n=!0,relativeTo:s=null,skipElements:r=[]}={}){let i=Array.isArray(e)?e.length>0?KE(e[0]):document:KE(e),o=Array.isArray(e)?n?sRe(e):e:t&64?J6e(e):Z6e(e);r.length>0&&o.length>1&&(o=o.filter(x=>!r.some(v=>v!=null&&"current"in v?v?.current===x:v===x))),s=s??i?.activeElement;let l=(()=>{if(t&5)return 1;if(t&10)return-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),c=(()=>{if(t&1)return 0;if(t&2)return Math.max(0,o.indexOf(s))-1;if(t&4)return Math.max(0,o.indexOf(s))+1;if(t&8)return o.length-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),u=t&32?{preventScroll:!0}:{},d=0,h=o.length,p;do{if(d>=h||d+h<=0)return 0;let x=c+d;if(t&16)x=(x+h)%h;else{if(x<0)return 3;if(x>=h)return 1}p=o[x],p?.focus(u),d+=l}while(p!==_Z(p));return t&6&&nRe(p)&&p.select(),2}function RZ(){return/iPhone/gi.test(window.navigator.platform)||/Mac/gi.test(window.navigator.platform)&&window.navigator.maxTouchPoints>0}function rRe(){return/Android/gi.test(window.navigator.userAgent)}function Q7(){return RZ()||rRe()}function wb(e,t,n,s){let r=om(n);f.useEffect(()=>{if(!e)return;function i(o){r.current(o)}return document.addEventListener(t,i,s),()=>document.removeEventListener(t,i,s)},[e,t,s])}function zZ(e,t,n,s){let r=om(n);f.useEffect(()=>{if(!e)return;function i(o){r.current(o)}return window.addEventListener(t,i,s),()=>window.removeEventListener(t,i,s)},[e,t,s])}const K7=30;function iRe(e,t,n){let s=om(n),r=f.useCallback(function(l,c){if(l.defaultPrevented)return;let u=c(l);if(u===null||!u.getRootNode().contains(u)||!u.isConnected)return;let d=(function h(p){return typeof p=="function"?h(p()):Array.isArray(p)||p instanceof Set?p:[p]})(t);for(let h of d)if(h!==null&&(h.contains(u)||l.composed&&l.composedPath().includes(h)))return;return!eRe(u,$Z.Loose)&&u.tabIndex!==-1&&l.preventDefault(),s.current(l,u)},[s,t]),i=f.useRef(null);wb(e,"pointerdown",l=>{var c,u;Q7()||(i.current=((u=(c=l.composedPath)==null?void 0:c.call(l))==null?void 0:u[0])||l.target)},!0),wb(e,"pointerup",l=>{if(Q7()||!i.current)return;let c=i.current;return i.current=null,r(l,()=>c)},!0);let o=f.useRef({x:0,y:0});wb(e,"touchstart",l=>{o.current.x=l.touches[0].clientX,o.current.y=l.touches[0].clientY},!0),wb(e,"touchend",l=>{let c={x:l.changedTouches[0].clientX,y:l.changedTouches[0].clientY};if(!(Math.abs(c.x-o.current.x)>=K7||Math.abs(c.y-o.current.y)>=K7))return r(l,()=>nd(l.target)?l.target:null)},!0),zZ(e,"blur",l=>r(l,()=>T6e(window.document.activeElement)?window.document.activeElement:null),!0)}function ZD(...e){return f.useMemo(()=>x0(...e),[...e])}function FZ(e,t,n,s){let r=om(n);f.useEffect(()=>{e=e??window;function i(o){r.current(o)}return e.addEventListener(t,i,s),()=>e.removeEventListener(t,i,s)},[e,t,s])}function oRe(e){return f.useSyncExternalStore(e.subscribe,e.getSnapshot,e.getSnapshot)}function lRe(e,t){let n=e(),s=new Set;return{getSnapshot(){return n},subscribe(r){return s.add(r),()=>s.delete(r)},dispatch(r,...i){let o=t[r].call(n,...i);o&&(n=o,s.forEach(l=>l()))}}}function cRe(){let e;return{before({doc:t}){var n;let s=t.documentElement,r=(n=t.defaultView)!=null?n:window;e=Math.max(0,r.innerWidth-s.clientWidth)},after({doc:t,d:n}){let s=t.documentElement,r=Math.max(0,s.clientWidth-s.offsetWidth),i=Math.max(0,e-r);n.style(s,"paddingRight",`${i}px`)}}}function dRe(){return RZ()?{before({doc:e,d:t,meta:n}){function s(r){for(let i of n().containers)for(let o of i())if(o.contains(r))return!0;return!1}t.microTask(()=>{var r;if(window.getComputedStyle(e.documentElement).scrollBehavior!=="auto"){let l=fc();l.style(e.documentElement,"scrollBehavior","auto"),t.add(()=>t.microTask(()=>l.dispose()))}let i=(r=window.scrollY)!=null?r:window.pageYOffset,o=null;t.addEventListener(e,"click",l=>{if(nd(l.target))try{let c=l.target.closest("a");if(!c)return;let{hash:u}=new URL(c.href),d=e.querySelector(u);nd(d)&&!s(d)&&(o=d)}catch{}},!0),t.group(l=>{t.addEventListener(e,"touchstart",c=>{if(l.dispose(),nd(c.target)&&A6e(c.target))if(s(c.target)){let u=c.target;for(;u.parentElement&&s(u.parentElement);)u=u.parentElement;l.style(u,"overscrollBehavior","contain")}else l.style(c.target,"touchAction","none")})}),t.addEventListener(e,"touchmove",l=>{if(nd(l.target)){if(k6e(l.target))return;if(s(l.target)){let c=l.target;for(;c.parentElement&&c.dataset.headlessuiPortal!==""&&!(c.scrollHeight>c.clientHeight||c.scrollWidth>c.clientWidth);)c=c.parentElement;c.dataset.headlessuiPortal===""&&l.preventDefault()}else l.preventDefault()}},{passive:!1}),t.add(()=>{var l;let c=(l=window.scrollY)!=null?l:window.pageYOffset;i!==c&&window.scrollTo(0,i),o&&o.isConnected&&(o.scrollIntoView({block:"nearest"}),o=null)})})}}:{}}function uRe(){return{before({doc:e,d:t}){t.style(e.documentElement,"overflow","hidden")}}}function X7(e){let t={};for(let n of e)Object.assign(t,n(t));return t}let yu=lRe(()=>new Map,{PUSH(e,t){var n;let s=(n=this.get(e))!=null?n:{doc:e,count:0,d:fc(),meta:new Set,computedMeta:{}};return s.count++,s.meta.add(t),s.computedMeta=X7(s.meta),this.set(e,s),this},POP(e,t){let n=this.get(e);return n&&(n.count--,n.meta.delete(t),n.computedMeta=X7(n.meta)),this},SCROLL_PREVENT(e){let t={doc:e.doc,d:e.d,meta(){return e.computedMeta}},n=[dRe(),cRe(),uRe()];n.forEach(({before:s})=>s?.(t)),n.forEach(({after:s})=>s?.(t))},SCROLL_ALLOW({d:e}){e.dispose()},TEARDOWN({doc:e}){this.delete(e)}});yu.subscribe(()=>{let e=yu.getSnapshot(),t=new Map;for(let[n]of e)t.set(n,n.documentElement.style.overflow);for(let n of e.values()){let s=t.get(n.doc)==="hidden",r=n.count!==0;(r&&!s||!r&&s)&&yu.dispatch(n.count>0?"SCROLL_PREVENT":"SCROLL_ALLOW",n),n.count===0&&yu.dispatch("TEARDOWN",n)}});function mRe(e,t,n=()=>({containers:[]})){let s=oRe(yu),r=t?s.get(t):void 0,i=r?r.count>0:!1;return br(()=>{if(!(!t||!e))return yu.dispatch("PUSH",t,n),()=>yu.dispatch("POP",t,n)},[e,t]),i}function fRe(e,t,n=()=>[document.body]){let s=b0(e,"scroll-lock");mRe(s,t,r=>{var i;return{containers:[...(i=r.containers)!=null?i:[],n]}})}function hRe(e=0){let[t,n]=f.useState(e),s=f.useCallback(c=>n(c),[]),r=f.useCallback(c=>n(u=>u|c),[]),i=f.useCallback(c=>(t&c)===c,[t]),o=f.useCallback(c=>n(u=>u&~c),[]),l=f.useCallback(c=>n(u=>u^c),[]);return{flags:t,setFlag:s,addFlag:r,hasFlag:i,removeFlag:o,toggleFlag:l}}var gRe={},Z7,J7;typeof process<"u"&&typeof globalThis<"u"&&typeof Element<"u"&&((Z7=process==null?void 0:gRe)==null?void 0:Z7.NODE_ENV)==="test"&&typeof((J7=Element?.prototype)==null?void 0:J7.getAnimations)>"u"&&(Element.prototype.getAnimations=function(){return console.warn(["Headless UI has polyfilled `Element.prototype.getAnimations` for your tests.","Please install a proper polyfill e.g. `jsdom-testing-mocks`, to silence these warnings.","","Example usage:","```js","import { mockAnimationsApi } from 'jsdom-testing-mocks'","mockAnimationsApi()","```"].join(`
`)),[]});var pRe=(e=>(e[e.None=0]="None",e[e.Closed=1]="Closed",e[e.Enter=2]="Enter",e[e.Leave=4]="Leave",e))(pRe||{});function xRe(e){let t={};for(let n in e)e[n]===!0&&(t[`data-${n}`]="");return t}function yRe(e,t,n,s){let[r,i]=f.useState(n),{hasFlag:o,addFlag:l,removeFlag:c}=hRe(e&&r?3:0),u=f.useRef(!1),d=f.useRef(!1),h=w1();return br(()=>{var p;if(e){if(n&&i(!0),!t){n&&l(3);return}return(p=s?.start)==null||p.call(s,n),bRe(t,{inFlight:u,prepare(){d.current?d.current=!1:d.current=u.current,u.current=!0,!d.current&&(n?(l(3),c(4)):(l(4),c(2)))},run(){d.current?n?(c(3),l(4)):(c(4),l(3)):n?c(1):l(1)},done(){var x;d.current&&jRe(t)||(u.current=!1,c(7),n||i(!1),(x=s?.end)==null||x.call(s,n))}})}},[e,n,t,h]),e?[r,{closed:o(1),enter:o(2),leave:o(4),transition:o(2)||o(4)}]:[n,{closed:void 0,enter:void 0,leave:void 0,transition:void 0}]}function bRe(e,{prepare:t,run:n,done:s,inFlight:r}){let i=fc();return wRe(e,{prepare:t,inFlight:r}),i.nextFrame(()=>{n(),i.requestAnimationFrame(()=>{i.add(vRe(e,s))})}),i.dispose}function vRe(e,t){var n,s;let r=fc();if(!e)return r.dispose;let i=!1;r.add(()=>{i=!0});let o=(s=(n=e.getAnimations)==null?void 0:n.call(e).filter(l=>l instanceof CSSTransition))!=null?s:[];return o.length===0?(t(),r.dispose):(Promise.allSettled(o.map(l=>l.finished)).then(()=>{i||t()}),r.dispose)}function wRe(e,{inFlight:t,prepare:n}){if(t!=null&&t.current){n();return}let s=e.style.transition;e.style.transition="none",n(),e.offsetHeight,e.style.transition=s}function jRe(e){var t,n;return((n=(t=e.getAnimations)==null?void 0:t.call(e))!=null?n:[]).some(s=>s instanceof CSSTransition&&s.playState!=="finished")}function JD(e,t){let n=f.useRef([]),s=Ya(e);f.useEffect(()=>{let r=[...n.current];for(let[i,o]of t.entries())if(n.current[i]!==o){let l=s(t,r);return n.current=t,l}},[s,...t])}let j1=f.createContext(null);j1.displayName="OpenClosedContext";var Wi=(e=>(e[e.Open=1]="Open",e[e.Closed=2]="Closed",e[e.Closing=4]="Closing",e[e.Opening=8]="Opening",e))(Wi||{});function N1(){return f.useContext(j1)}function NRe({value:e,children:t}){return wt.createElement(j1.Provider,{value:e},t)}function CRe({children:e}){return wt.createElement(j1.Provider,{value:null},e)}function SRe(e){function t(){document.readyState!=="loading"&&(e(),document.removeEventListener("DOMContentLoaded",t))}typeof window<"u"&&typeof document<"u"&&(document.addEventListener("DOMContentLoaded",t),t())}let Zc=[];SRe(()=>{function e(t){if(!nd(t.target)||t.target===document.body||Zc[0]===t.target)return;let n=t.target;n=n.closest(qw),Zc.unshift(n??t.target),Zc=Zc.filter(s=>s!=null&&s.isConnected),Zc.splice(10)}window.addEventListener("click",e,{capture:!0}),window.addEventListener("mousedown",e,{capture:!0}),window.addEventListener("focus",e,{capture:!0}),document.body.addEventListener("click",e,{capture:!0}),document.body.addEventListener("mousedown",e,{capture:!0}),document.body.addEventListener("focus",e,{capture:!0})});function UZ(e){let t=Ya(e),n=f.useRef(!1);f.useEffect(()=>(n.current=!1,()=>{n.current=!0,v1(()=>{n.current&&t()})}),[t])}let BZ=f.createContext(!1);function _Re(){return f.useContext(BZ)}function e8(e){return wt.createElement(BZ.Provider,{value:e.force},e.children)}function ARe(e){let t=_Re(),n=f.useContext(qZ),[s,r]=f.useState(()=>{var i;if(!t&&n!==null)return(i=n.current)!=null?i:null;if(zo.isServer)return null;let o=e?.getElementById("headlessui-portal-root");if(o)return o;if(e===null)return null;let l=e.createElement("div");return l.setAttribute("id","headlessui-portal-root"),e.body.appendChild(l)});return f.useEffect(()=>{s!==null&&(e!=null&&e.body.contains(s)||e==null||e.body.appendChild(s))},[s,e]),f.useEffect(()=>{t||n!==null&&r(n.current)},[n,r,t]),s}let HZ=f.Fragment,TRe=_r(function(e,t){let{ownerDocument:n=null,...s}=e,r=f.useRef(null),i=Xo(E6e(p=>{r.current=p}),t),o=ZD(r.current),l=n??o,c=ARe(l),u=f.useContext(tL),d=w1(),h=Li();return UZ(()=>{var p;c&&c.childNodes.length<=0&&((p=c.parentElement)==null||p.removeChild(c))}),c?Gi.createPortal(wt.createElement("div",{"data-headlessui-portal":"",ref:p=>{d.dispose(),u&&p&&d.add(u.register(p))}},h({ourProps:{ref:i},theirProps:s,slot:{},defaultTag:HZ,name:"Portal"})),c):null});function kRe(e,t){let n=Xo(t),{enabled:s=!0,ownerDocument:r,...i}=e,o=Li();return s?wt.createElement(TRe,{...i,ownerDocument:r,ref:n}):o({ourProps:{ref:n},theirProps:i,slot:{},defaultTag:HZ,name:"Portal"})}let ERe=f.Fragment,qZ=f.createContext(null);function LRe(e,t){let{target:n,...s}=e,r={ref:Xo(t)},i=Li();return wt.createElement(qZ.Provider,{value:n},i({ourProps:r,theirProps:s,defaultTag:ERe,name:"Popover.Group"}))}let tL=f.createContext(null);function PRe(){let e=f.useContext(tL),t=f.useRef([]),n=Ya(i=>(t.current.push(i),e&&e.register(i),()=>s(i))),s=Ya(i=>{let o=t.current.indexOf(i);o!==-1&&t.current.splice(o,1),e&&e.unregister(i)}),r=f.useMemo(()=>({register:n,unregister:s,portals:t}),[n,s,t]);return[t,f.useMemo(()=>function({children:i}){return wt.createElement(tL.Provider,{value:r},i)},[r])]}let DRe=_r(kRe),GZ=_r(LRe),ORe=Object.assign(DRe,{Group:GZ});function MRe(e,t=typeof document<"u"?document.defaultView:null,n){let s=b0(e,"escape");FZ(t,"keydown",r=>{s&&(r.defaultPrevented||r.key===EZ.Escape&&n(r))})}function IRe(){var e;let[t]=f.useState(()=>typeof window<"u"&&typeof window.matchMedia=="function"?window.matchMedia("(pointer: coarse)"):null),[n,s]=f.useState((e=t?.matches)!=null?e:!1);return br(()=>{if(!t)return;function r(i){s(i.matches)}return t.addEventListener("change",r),()=>t.removeEventListener("change",r)},[t]),n}function $Re({defaultContainers:e=[],portals:t,mainTreeNode:n}={}){let s=Ya(()=>{var r,i;let o=x0(n),l=[];for(let c of e)c!==null&&(dd(c)?l.push(c):"current"in c&&dd(c.current)&&l.push(c.current));if(t!=null&&t.current)for(let c of t.current)l.push(c);for(let c of(r=o?.querySelectorAll("html > *, body > *"))!=null?r:[])c!==document.body&&c!==document.head&&dd(c)&&c.id!=="headlessui-portal-root"&&(n&&(c.contains(n)||c.contains((i=n?.getRootNode())==null?void 0:i.host))||l.some(u=>c.contains(u))||l.push(c));return l});return{resolveContainers:s,contains:Ya(r=>s().some(i=>i.contains(r)))}}let WZ=f.createContext(null);function t8({children:e,node:t}){let[n,s]=f.useState(null),r=VZ(t??n);return wt.createElement(WZ.Provider,{value:r},e,r===null&&wt.createElement(ZE,{features:Hw.Hidden,ref:i=>{var o,l;if(i){for(let c of(l=(o=x0(i))==null?void 0:o.querySelectorAll("html > *, body > *"))!=null?l:[])if(c!==document.body&&c!==document.head&&dd(c)&&c!=null&&c.contains(i)){s(c);break}}}}))}function VZ(e=null){var t;return(t=f.useContext(WZ))!=null?t:e}function RRe(){let e=typeof document>"u";return"useSyncExternalStore"in ku?(t=>t.useSyncExternalStore)(ku)(()=>()=>{},()=>!1,()=>!e):!1}function C1(){let e=RRe(),[t,n]=f.useState(zo.isHandoffComplete);return t&&zo.isHandoffComplete===!1&&n(!1),f.useEffect(()=>{t!==!0&&n(!0)},[t]),f.useEffect(()=>zo.handoff(),[]),e?!1:t}function e3(){let e=f.useRef(!1);return br(()=>(e.current=!0,()=>{e.current=!1}),[]),e}var Zg=(e=>(e[e.Forwards=0]="Forwards",e[e.Backwards=1]="Backwards",e))(Zg||{});function zRe(){let e=f.useRef(0);return zZ(!0,"keydown",t=>{t.key==="Tab"&&(e.current=t.shiftKey?1:0)},!0),e}function YZ(e){if(!e)return new Set;if(typeof e=="function")return new Set(e());let t=new Set;for(let n of e.current)dd(n.current)&&t.add(n.current);return t}let FRe="div";var cu=(e=>(e[e.None=0]="None",e[e.InitialFocus=1]="InitialFocus",e[e.TabLock=2]="TabLock",e[e.FocusLock=4]="FocusLock",e[e.RestoreFocus=8]="RestoreFocus",e[e.AutoFocus=16]="AutoFocus",e))(cu||{});function URe(e,t){let n=f.useRef(null),s=Xo(n,t),{initialFocus:r,initialFocusFallback:i,containers:o,features:l=15,...c}=e;C1()||(l=0);let u=ZD(n.current);GRe(l,{ownerDocument:u});let d=WRe(l,{ownerDocument:u,container:n,initialFocus:r,initialFocusFallback:i});VRe(l,{ownerDocument:u,container:n,containers:o,previousActiveElement:d});let h=zRe(),p=Ya(w=>{if(!Vu(n.current))return;let S=n.current;(_=>_())(()=>{Jl(h.current,{[Zg.Forwards]:()=>{up(S,El.First,{skipElements:[w.relatedTarget,i]})},[Zg.Backwards]:()=>{up(S,El.Last,{skipElements:[w.relatedTarget,i]})}})})}),x=b0(!!(l&2),"focus-trap#tab-lock"),v=w1(),j=f.useRef(!1),y={ref:s,onKeyDown(w){w.key=="Tab"&&(j.current=!0,v.requestAnimationFrame(()=>{j.current=!1}))},onBlur(w){if(!(l&4))return;let S=YZ(o);Vu(n.current)&&S.add(n.current);let _=w.relatedTarget;nd(_)&&_.dataset.headlessuiFocusGuard!=="true"&&(QZ(S,_)||(j.current?up(n.current,Jl(h.current,{[Zg.Forwards]:()=>El.Next,[Zg.Backwards]:()=>El.Previous})|El.WrapAround,{relativeTo:w.target}):nd(w.target)&&$l(w.target)))}},N=Li();return wt.createElement(wt.Fragment,null,x&&wt.createElement(ZE,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:p,features:Hw.Focusable}),N({ourProps:y,theirProps:c,defaultTag:FRe,name:"FocusTrap"}),x&&wt.createElement(ZE,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:p,features:Hw.Focusable}))}let BRe=_r(URe),HRe=Object.assign(BRe,{features:cu});function qRe(e=!0){let t=f.useRef(Zc.slice());return JD(([n],[s])=>{s===!0&&n===!1&&v1(()=>{t.current.splice(0)}),s===!1&&n===!0&&(t.current=Zc.slice())},[e,Zc,t]),Ya(()=>{var n;return(n=t.current.find(s=>s!=null&&s.isConnected))!=null?n:null})}function GRe(e,{ownerDocument:t}){let n=!!(e&8),s=qRe(n);JD(()=>{n||p6e(t?.body)&&$l(s())},[n]),UZ(()=>{n&&$l(s())})}function WRe(e,{ownerDocument:t,container:n,initialFocus:s,initialFocusFallback:r}){let i=f.useRef(null),o=b0(!!(e&1),"focus-trap#initial-focus"),l=e3();return JD(()=>{if(e===0)return;if(!o){r!=null&&r.current&&$l(r.current);return}let c=n.current;c&&v1(()=>{if(!l.current)return;let u=t?.activeElement;if(s!=null&&s.current){if(s?.current===u){i.current=u;return}}else if(c.contains(u)){i.current=u;return}if(s!=null&&s.current)$l(s.current);else{if(e&16){if(up(c,El.First|El.AutoFocus)!==eL.Error)return}else if(up(c,El.First)!==eL.Error)return;if(r!=null&&r.current&&($l(r.current),t?.activeElement===r.current))return;console.warn("There are no focusable elements inside the <FocusTrap />")}i.current=t?.activeElement})},[r,o,e]),i}function VRe(e,{ownerDocument:t,container:n,containers:s,previousActiveElement:r}){let i=e3(),o=!!(e&4);FZ(t?.defaultView,"focus",l=>{if(!o||!i.current)return;let c=YZ(s);Vu(n.current)&&c.add(n.current);let u=r.current;if(!u)return;let d=l.target;Vu(d)?QZ(c,d)?(r.current=d,$l(d)):(l.preventDefault(),l.stopPropagation(),$l(u)):$l(r.current)},!0)}function QZ(e,t){for(let n of e)if(n.contains(t))return!0;return!1}function KZ(e){var t;return!!(e.enter||e.enterFrom||e.enterTo||e.leave||e.leaveFrom||e.leaveTo)||!cp((t=e.as)!=null?t:ZZ)||wt.Children.count(e.children)===1}let S1=f.createContext(null);S1.displayName="TransitionContext";var YRe=(e=>(e.Visible="visible",e.Hidden="hidden",e))(YRe||{});function QRe(){let e=f.useContext(S1);if(e===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return e}function KRe(){let e=f.useContext(_1);if(e===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return e}let _1=f.createContext(null);_1.displayName="NestingContext";function A1(e){return"children"in e?A1(e.children):e.current.filter(({el:t})=>t.current!==null).filter(({state:t})=>t==="visible").length>0}function XZ(e,t){let n=om(e),s=f.useRef([]),r=e3(),i=w1(),o=Ya((x,v=ad.Hidden)=>{let j=s.current.findIndex(({el:y})=>y===x);j!==-1&&(Jl(v,{[ad.Unmount](){s.current.splice(j,1)},[ad.Hidden](){s.current[j].state="hidden"}}),i.microTask(()=>{var y;!A1(s)&&r.current&&((y=n.current)==null||y.call(n))}))}),l=Ya(x=>{let v=s.current.find(({el:j})=>j===x);return v?v.state!=="visible"&&(v.state="visible"):s.current.push({el:x,state:"visible"}),()=>o(x,ad.Unmount)}),c=f.useRef([]),u=f.useRef(Promise.resolve()),d=f.useRef({enter:[],leave:[]}),h=Ya((x,v,j)=>{c.current.splice(0),t&&(t.chains.current[v]=t.chains.current[v].filter(([y])=>y!==x)),t?.chains.current[v].push([x,new Promise(y=>{c.current.push(y)})]),t?.chains.current[v].push([x,new Promise(y=>{Promise.all(d.current[v].map(([N,w])=>w)).then(()=>y())})]),v==="enter"?u.current=u.current.then(()=>t?.wait.current).then(()=>j(v)):j(v)}),p=Ya((x,v,j)=>{Promise.all(d.current[v].splice(0).map(([y,N])=>N)).then(()=>{var y;(y=c.current.shift())==null||y()}).then(()=>j(v))});return f.useMemo(()=>({children:s,register:l,unregister:o,onStart:h,onStop:p,wait:u,chains:d}),[l,o,s,h,p,d,u])}let ZZ=f.Fragment,JZ=Bw.RenderStrategy;function XRe(e,t){var n,s;let{transition:r=!0,beforeEnter:i,afterEnter:o,beforeLeave:l,afterLeave:c,enter:u,enterFrom:d,enterTo:h,entered:p,leave:x,leaveFrom:v,leaveTo:j,...y}=e,[N,w]=f.useState(null),S=f.useRef(null),_=KZ(e),k=Xo(..._?[S,t,w]:t===null?[]:[t]),T=(n=y.unmount)==null||n?ad.Unmount:ad.Hidden,{show:A,appear:E,initial:M}=QRe(),[z,P]=f.useState(A?"visible":"hidden"),D=KRe(),{register:U,unregister:B}=D;br(()=>U(S),[U,S]),br(()=>{if(T===ad.Hidden&&S.current){if(A&&z!=="visible"){P("visible");return}return Jl(z,{hidden:()=>B(S),visible:()=>U(S)})}},[z,S,U,B,A,T]);let R=C1();br(()=>{if(_&&R&&z==="visible"&&S.current===null)throw new Error("Did you forget to passthrough the `ref` to the actual DOM node?")},[S,z,R,_]);let q=M&&!E,Z=E&&A&&M,V=f.useRef(!1),oe=XZ(()=>{V.current||(P("hidden"),B(S))},D),je=Ya(de=>{V.current=!0;let ke=de?"enter":"leave";oe.onStart(S,ke,ge=>{ge==="enter"?i?.():ge==="leave"&&l?.()})}),X=Ya(de=>{let ke=de?"enter":"leave";V.current=!1,oe.onStop(S,ke,ge=>{ge==="enter"?o?.():ge==="leave"&&c?.()}),ke==="leave"&&!A1(oe)&&(P("hidden"),B(S))});f.useEffect(()=>{_&&r||(je(A),X(A))},[A,_,r]);let se=!(!r||!_||!R||q),[,ye]=yRe(se,N,A,{start:je,end:X}),Ne=ru({ref:k,className:((s=XE(y.className,Z&&u,Z&&d,ye.enter&&u,ye.enter&&ye.closed&&d,ye.enter&&!ye.closed&&h,ye.leave&&x,ye.leave&&!ye.closed&&v,ye.leave&&ye.closed&&j,!ye.transition&&A&&p))==null?void 0:s.trim())||void 0,...xRe(ye)}),fe=0;z==="visible"&&(fe|=Wi.Open),z==="hidden"&&(fe|=Wi.Closed),A&&z==="hidden"&&(fe|=Wi.Opening),!A&&z==="visible"&&(fe|=Wi.Closing);let we=Li();return wt.createElement(_1.Provider,{value:oe},wt.createElement(NRe,{value:fe},we({ourProps:Ne,theirProps:y,defaultTag:ZZ,features:JZ,visible:z==="visible",name:"Transition.Child"})))}function ZRe(e,t){let{show:n,appear:s=!1,unmount:r=!0,...i}=e,o=f.useRef(null),l=KZ(e),c=Xo(...l?[o,t]:t===null?[]:[t]);C1();let u=N1();if(n===void 0&&u!==null&&(n=(u&Wi.Open)===Wi.Open),n===void 0)throw new Error("A <Transition /> is used but it is missing a `show={true | false}` prop.");let[d,h]=f.useState(n?"visible":"hidden"),p=XZ(()=>{n||h("hidden")}),[x,v]=f.useState(!0),j=f.useRef([n]);br(()=>{x!==!1&&j.current[j.current.length-1]!==n&&(j.current.push(n),v(!1))},[j,n]);let y=f.useMemo(()=>({show:n,appear:s,initial:x}),[n,s,x]);br(()=>{n?h("visible"):!A1(p)&&o.current!==null&&h("hidden")},[n,p]);let N={unmount:r},w=Ya(()=>{var k;x&&v(!1),(k=e.beforeEnter)==null||k.call(e)}),S=Ya(()=>{var k;x&&v(!1),(k=e.beforeLeave)==null||k.call(e)}),_=Li();return wt.createElement(_1.Provider,{value:p},wt.createElement(S1.Provider,{value:y},_({ourProps:{...N,as:f.Fragment,children:wt.createElement(eJ,{ref:c,...N,...i,beforeEnter:w,beforeLeave:S})},theirProps:{},defaultTag:f.Fragment,features:JZ,visible:d==="visible",name:"Transition"})))}function JRe(e,t){let n=f.useContext(S1)!==null,s=N1()!==null;return wt.createElement(wt.Fragment,null,!n&&s?wt.createElement(aL,{ref:t,...e}):wt.createElement(eJ,{ref:t,...e}))}let aL=_r(ZRe),eJ=_r(XRe),t3=_r(JRe),wv=Object.assign(aL,{Child:t3,Root:aL});var eze=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(eze||{}),tze=(e=>(e[e.SetTitleId=0]="SetTitleId",e))(tze||{});let aze={0(e,t){return e.titleId===t.id?e:{...e,titleId:t.id}}},a3=f.createContext(null);a3.displayName="DialogContext";function T1(e){let t=f.useContext(a3);if(t===null){let n=new Error(`<${e} /> is missing a parent <Dialog /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(n,T1),n}return t}function nze(e,t){return Jl(t.type,aze,e,t)}let a8=_r(function(e,t){let n=f.useId(),{id:s=`headlessui-dialog-${n}`,open:r,onClose:i,initialFocus:o,role:l="dialog",autoFocus:c=!0,__demoMode:u=!1,unmount:d=!1,...h}=e,p=f.useRef(!1);l=(function(){return l==="dialog"||l==="alertdialog"?l:(p.current||(p.current=!0,console.warn(`Invalid role [${l}] passed to <Dialog />. Only \`dialog\` and and \`alertdialog\` are supported. Using \`dialog\` instead.`)),"dialog")})();let x=N1();r===void 0&&x!==null&&(r=(x&Wi.Open)===Wi.Open);let v=f.useRef(null),j=Xo(v,t),y=ZD(v.current),N=r?0:1,[w,S]=f.useReducer(nze,{titleId:null,descriptionId:null,panelRef:f.createRef()}),_=Ya(()=>i(!1)),k=Ya(ye=>S({type:0,id:ye})),T=C1()?N===0:!1,[A,E]=PRe(),M={get current(){var ye;return(ye=w.panelRef.current)!=null?ye:v.current}},z=VZ(),{resolveContainers:P}=$Re({mainTreeNode:z,portals:A,defaultContainers:[M]}),D=x!==null?(x&Wi.Closing)===Wi.Closing:!1;Y6e(u||D?!1:T,{allowed:Ya(()=>{var ye,Ne;return[(Ne=(ye=v.current)==null?void 0:ye.closest("[data-headlessui-portal]"))!=null?Ne:null]}),disallowed:Ya(()=>{var ye;return[(ye=z?.closest("body > *:not(#headlessui-portal-root)"))!=null?ye:null]})});let U=MZ.get(null);br(()=>{if(T)return U.actions.push(s),()=>U.actions.pop(s)},[U,s,T]);let B=IZ(U,f.useCallback(ye=>U.selectors.isTop(ye,s),[U,s]));iRe(B,P,ye=>{ye.preventDefault(),_()}),MRe(B,y?.defaultView,ye=>{ye.preventDefault(),ye.stopPropagation(),document.activeElement&&"blur"in document.activeElement&&typeof document.activeElement.blur=="function"&&document.activeElement.blur(),_()}),fRe(u||D?!1:T,y,P),Q6e(T,v,_);let[R,q]=L6e(),Z=f.useMemo(()=>[{dialogState:N,close:_,setTitleId:k,unmount:d},w],[N,_,k,d,w]),V=y0({open:N===0}),oe={ref:j,id:s,role:l,tabIndex:-1,"aria-modal":u?void 0:N===0?!0:void 0,"aria-labelledby":w.titleId,"aria-describedby":R,unmount:d},je=!IRe(),X=cu.None;T&&!u&&(X|=cu.RestoreFocus,X|=cu.TabLock,c&&(X|=cu.AutoFocus),je&&(X|=cu.InitialFocus));let se=Li();return wt.createElement(CRe,null,wt.createElement(e8,{force:!0},wt.createElement(ORe,null,wt.createElement(a3.Provider,{value:Z},wt.createElement(GZ,{target:v},wt.createElement(e8,{force:!1},wt.createElement(q,{slot:V},wt.createElement(E,null,wt.createElement(HRe,{initialFocus:o,initialFocusFallback:v,containers:P,features:X},wt.createElement($6e,{value:_},se({ourProps:oe,theirProps:h,slot:V,defaultTag:sze,features:rze,visible:N===0,name:"Dialog"})))))))))))}),sze="div",rze=Bw.RenderStrategy|Bw.Static;function ize(e,t){let{transition:n=!1,open:s,...r}=e,i=N1(),o=e.hasOwnProperty("open")||i!==null,l=e.hasOwnProperty("onClose");if(!o&&!l)throw new Error("You have to provide an `open` and an `onClose` prop to the `Dialog` component.");if(!o)throw new Error("You provided an `onClose` prop to the `Dialog`, but forgot an `open` prop.");if(!l)throw new Error("You provided an `open` prop to the `Dialog`, but forgot an `onClose` prop.");if(!i&&typeof e.open!="boolean")throw new Error(`You provided an \`open\` prop to the \`Dialog\`, but the value is not a boolean. Received: ${e.open}`);if(typeof e.onClose!="function")throw new Error(`You provided an \`onClose\` prop to the \`Dialog\`, but the value is not a function. Received: ${e.onClose}`);return(s!==void 0||n)&&!r.static?wt.createElement(t8,null,wt.createElement(wv,{show:s,transition:n,unmount:r.unmount},wt.createElement(a8,{ref:t,...r}))):wt.createElement(t8,null,wt.createElement(a8,{ref:t,open:s,...r}))}let oze="div";function lze(e,t){let n=f.useId(),{id:s=`headlessui-dialog-panel-${n}`,transition:r=!1,...i}=e,[{dialogState:o,unmount:l},c]=T1("Dialog.Panel"),u=Xo(t,c.panelRef),d=y0({open:o===0}),h=Ya(y=>{y.stopPropagation()}),p={ref:u,id:s,onClick:h},x=r?t3:f.Fragment,v=r?{unmount:l}:{},j=Li();return wt.createElement(x,{...v},j({ourProps:p,theirProps:i,slot:d,defaultTag:oze,name:"Dialog.Panel"}))}let cze="div";function dze(e,t){let{transition:n=!1,...s}=e,[{dialogState:r,unmount:i}]=T1("Dialog.Backdrop"),o=y0({open:r===0}),l={ref:t,"aria-hidden":!0},c=n?t3:f.Fragment,u=n?{unmount:i}:{},d=Li();return wt.createElement(c,{...u},d({ourProps:l,theirProps:s,slot:o,defaultTag:cze,name:"Dialog.Backdrop"}))}let uze="h2";function mze(e,t){let n=f.useId(),{id:s=`headlessui-dialog-title-${n}`,...r}=e,[{dialogState:i,setTitleId:o}]=T1("Dialog.Title"),l=Xo(t);f.useEffect(()=>(o(s),()=>o(null)),[s,o]);let c=y0({open:i===0}),u={ref:l,id:s};return Li()({ourProps:u,theirProps:r,slot:c,defaultTag:uze,name:"Dialog.Title"})}let fze=_r(ize),hze=_r(lze);_r(dze);let gze=_r(mze),n8=Object.assign(fze,{Panel:hze,Title:gze,Description:M6e});function v0({isOpen:e,onClose:t,onSave:n,onEdit:s,setFormData:r,formData:i,isEditing:o=!1,viewMode:l=!1,users:c=[],currentUser:u,onDelete:d}){const[h,p]=f.useState([]),[x,v]=f.useState([]),[j,y]=f.useState({}),{comments:N,addComment:w,refresh:S}=kn({relatedType:"task",relatedId:i?.id});f.useEffect(()=>{i?.id&&S()},[i?.id,S]);const _=z=>{if(!z)return"";const P=String(z).split("-");return P.length===3?`${P[0]}-${P[2]}`:String(z)},k=z=>{const{name:P,value:D}=z.target;P==="subject"&&D.trim()&&y(U=>({...U,subject:!1})),r(U=>{const B={...U,[P]:D};return P==="relatedType1"&&(B.relatedTo1="",D==="Lead"?(B.relatedType2=null,B.relatedTo2=null,v([])):D==="Account"&&(B.relatedType2="Contact")),P==="relatedType2"&&(B.relatedTo2=""),B})};f.useEffect(()=>{if(!e)return;(async()=>{try{p([]);let P;i.relatedType1==="Lead"?P=await re.get("/leads/admin/getLeads"):i.relatedType1==="Account"&&(P=await re.get("/accounts/admin/fetch-all"));let D=[];if(P&&Array.isArray(P.data)&&(D=P.data),o&&i.relatedTo1)try{let U;i.relatedType1==="Lead"?U=await re.get(`/leads/get/${i.relatedTo1}`):i.relatedType1==="Account"&&(U=await re.get(`/accounts/get/${i.relatedTo1}`)),U&&U.data&&(D.some(R=>String(R.id)===String(i.relatedTo1))||(D=[U.data,...D]))}catch(U){console.error("Error fetching specific related item:",U)}p(D)}catch(P){console.error("Error fetching related 1 data:",P),p([])}})()},[i.relatedType1,e,o,i.relatedTo1]),f.useEffect(()=>{if(!e||l)return;(async()=>{try{if(v([]),i.relatedType1==="Account"&&i.relatedTo1){let P;i.relatedType2==="Contact"?P=await re.get(`/contacts/from-acc/${i.relatedTo1}`):i.relatedType2==="Deal"?P=await re.get(`/deals/from-acc/${i.relatedTo1}`):i.relatedType2==="Quote"&&(P=await re.get(`/quotes/from-acc/${i.relatedTo1}`));let D=[];if(P&&Array.isArray(P.data)&&(D=P.data),o&&i.relatedTo2)try{let U;i.relatedType2==="Contact"?U=await re.get(`/contacts/get/${i.relatedTo2}`):i.relatedType2==="Deal"?U=await re.get(`/deals/get/${i.relatedTo2}`):i.relatedType2==="Quote"&&(U=await re.get(`/quotes/get/${i.relatedTo2}`)),U&&U.data&&(D.some(R=>String(R.id)===String(i.relatedTo2))||(D=[U.data,...D]))}catch(U){console.error("Error fetching specific related item:",U)}v(D)}}catch(P){console.error("Error fetching related 2 data:",P),v([])}})()},[i.relatedType1,i.relatedTo1,i.relatedType2,i.relatedTo2,e,l,o]);const[T,A]=f.useState(!1);f.useEffect(()=>{e&&(A(!1),y({}))},[e]);const E=z=>{z.preventDefault(),A(!0);const P={};i.subject?.trim()||(P.subject=!0,H.error("Title is required")),y(P),i.relatedTo1||(P.relatedTo1=!0,H.error(`Please select a ${i.relatedType1||"Lead/Account"}.`)),i.assignedTo||(P.assignedTo=!0,H.error("Assigned To is required.")),!(Object.keys(P).length>0)&&n?.(i)},M=l?"Task Details":o?"Edit Task":"Create Task";return a.jsx(wv,{appear:!0,show:e,as:f.Fragment,children:a.jsxs(n8,{as:"div",className:"relative z-50",onClose:t,children:[a.jsx(wv.Child,{as:f.Fragment,enter:"ease-out duration-200",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-150",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:a.jsx("div",{className:"fixed inset-0 bg-black/40"})}),a.jsx("div",{className:"fixed inset-0 flex items-center justify-center p-4 overflow-y-auto",children:a.jsx("div",{className:"flex min-h-full items-center justify-center text-center",children:a.jsx(wv.Child,{as:f.Fragment,enter:"ease-out duration-200",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-150",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:a.jsx(n8.Panel,{className:"w-full max-w-full sm:max-w-3xl text-left align-middle transform transition-all",children:a.jsxs("div",{className:"bg-white w-full min-w-sm md:min-w-lg rounded-2xl shadow-lg p-4 sm:p-6 md:p-8 relative border border-gray-200 overflow-y-auto max-h-[90vh] flex flex-col hide-scrollbar",children:[a.jsx("button",{onClick:()=>{t(),A(!1),y({})},className:"absolute top-4 right-4 text-gray-500 hover:text-black transition",children:a.jsx(Ja,{size:25})}),a.jsx("h3",{className:"text-xl sm:text-2xl font-semibold text-gray-800 mb-4 sm:mb-6 flex items-center justify-center",children:M}),l&&a.jsx("div",{className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center p-4",onClick:t,children:a.jsxs("div",{className:"bg-white rounded-xl shadow-lg w-full max-w-full lg:max-w-4xl max-h-[90vh] overflow-y-auto hide-scrollbar font-manrope relative",onClick:z=>z.stopPropagation(),children:[a.jsxs("div",{className:"bg-tertiary w-full flex items-center justify-between p-3 lg:p-4 rounded-t-xl",children:[a.jsx("h1",{className:"lg:text-3xl text-xl text-white font-semibold text-center w-full",children:"Tasks"}),a.jsx("button",{onClick:()=>{t(),A(!1)},className:"text-gray-500 hover:text-white transition cursor-pointer",children:a.jsx(Ja,{size:25})})]}),a.jsx("div",{className:"p-6 lg:p-4",children:a.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between lg:flex-row lg:items-center lg:justify-between mt-3 gap-2 px-2 md:items-center lg:gap-4 md:mx-7 lg:mx-7",children:[a.jsx("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:a.jsx("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-800",children:i.subject||"No Title"})}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[!(/group.manager/i.test(u?.role)&&String(i?.createdById)!==String(u?.id))&&a.jsxs("button",{className:"inline-flex items-center justify-center w-full sm:w-auto bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 transition text-sm focus:outline-none focus:ring-2 focus:ring-blue-400 cursor-pointer",onClick:()=>{r&&r(i),typeof s=="function"&&s()},children:[a.jsx(hn,{className:"mr-2"}),"Edit"]}),/group.manager/i.test(u?.role)&&String(i?.createdById)!==String(u?.id)?null:/group.manager/i.test(u?.role)?a.jsxs("button",{className:"inline-flex items-center justify-center w-full sm:w-auto px-4 py-2 rounded-md text-sm bg-orange-500 text-white hover:bg-orange-600 transition focus:outline-none focus:ring-2 focus:ring-orange-400 cursor-pointer",onClick:()=>d(i),children:[a.jsx(Zt,{className:"mr-2"}),"Archive"]}):u?.role==="ADMIN"||u?.role==="CEO"?a.jsxs("button",{className:"inline-flex items-center justify-center w-full sm:w-auto px-4 py-2 rounded-md text-sm bg-red-500 text-white hover:bg-red-600 transition focus:outline-none focus:ring-2 focus:ring-red-400 cursor-pointer",onClick:()=>d(i),children:[a.jsx(wa,{className:"mr-2"}),"Delete"]}):null]})]})}),a.jsx("div",{className:"border-b border-gray-200 my-5"}),a.jsxs("div",{className:"p-4",children:[a.jsx("div",{className:"flex w-full bg-[#6A727D] text-white overflow-x-auto",children:a.jsx("button",{className:"flex-1 min-w-[90px] px-4 py-2 lg:text-lg text-sm font-medium text-center text-white",children:"Overview"})}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 lg:p-5 border border-gray-200 text-sm text-gray-700",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Title:"}),a.jsx("p",{children:i.subject||""})]}),i.relatedType1Text&&i.relatedTo1Text&&a.jsxs("div",{children:[a.jsxs("p",{className:"font-semibold",children:[i.relatedType1Text,":"]}),a.jsx("p",{children:i.relatedTo1Text})]}),i.relatedType2Text&&i.relatedTo2Text&&a.jsxs("div",{children:[a.jsxs("p",{className:"font-semibold",children:[i.relatedType2,":"]}),a.jsx("p",{children:i.relatedTo2Text})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Assigned To:"}),a.jsx("p",{children:i.assignedToName||""})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created By:"}),a.jsx("p",{children:i.createdBy||""})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Priority:"}),a.jsx("p",{children:i.priority||""})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Status:"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("p",{children:i.status||""}),i.rawStatus==="INACTIVE"&&(u?.role==="ADMIN"||u?.role==="CEO")&&a.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-red-600 text-white",children:"INACTIVE"})]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Due Date:"}),a.jsx("p",{children:i.dueDate||""})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("p",{className:"font-semibold",children:"Description:"}),a.jsx("p",{className:"whitespace-pre-wrap",children:i.description||""})]})]}),a.jsx(Tn,{comments:N,onAddComment:w})]})]})]})}),!l&&a.jsxs("form",{onSubmit:E,className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm flex-1",children:[a.jsxs("div",{className:"md:col-span-2",children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:["Title"," ",a.jsx("span",{className:"text-red-500 font-semibold",children:"*"})]}),a.jsx("input",{type:"text",name:"subject",value:i.subject,onChange:k,disabled:l,placeholder:"Enter task title",className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border focus:ring-2
                            ${j.subject?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}
                            ${l?"bg-gray-50 cursor-not-allowed":""}
                          `})]}),a.jsxs("div",{className:"w-full flex flex-col",children:[a.jsxs("div",{className:"relative w-25",children:[a.jsxs("select",{name:"relatedType1",onChange:k,value:i.relatedType1,disabled:l,className:"w-full pr-6 rounded-md text-sm mb-2",children:[a.jsx("option",{value:"Lead",children:"Lead"}),a.jsx("option",{value:"Account",children:"Account"})]}),a.jsx("span",{className:"absolute left-10 md:pl-6 pl-6 top-1/2 -translate-y-1/2 text-red-500 pointer-events-none",children:"*"})]}),a.jsx(CA,{disabled:!1,items:Array.isArray(h)?h:[],value:i.relatedTo1??"",placeholder:`Search ${i.relatedType1||"here"}...`,getLabel:z=>i.relatedType1==="Lead"?z.title:z.name??"",onChange:z=>r(P=>({...P,relatedTo1:z})),required:!0,isSubmitted:T})]}),a.jsxs("div",{className:"w-full flex flex-col",children:[a.jsxs("select",{name:"relatedType2",onChange:k,value:i.relatedType2??"Contact",className:"w-23 rounded-md text-sm focus:ring-2 focus:ring-blue-400 outline-none mb-2 disabled:text-gray-400 disabled:cursor-not-allowed",disabled:l||i.relatedType1==="Lead",children:[a.jsx("option",{value:"Contact",children:"Contact"}),a.jsx("option",{value:"Deal",children:"Deal"}),a.jsx("option",{value:"Quote",children:"Quote"})]}),a.jsx(CA,{disabled:i.relatedType1==="Lead",items:Array.isArray(x)?x:[],value:i.relatedTo2??"",placeholder:i.relatedType1==="Lead"?"":Array.isArray(x)&&x.length>0?`Search ${i.relatedType2||"Contact"}...`:`No ${i.relatedType2||""} data found`,getLabel:z=>i.relatedType2==="Contact"?`${z.first_name??""} ${z.last_name??""}`.trim():i.relatedType2==="Quote"?_(z.quote_id)??"":z.name??"",onChange:z=>r(P=>({...P,relatedTo2:z}))})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Description"}),a.jsx("textarea",{name:"description",value:i.description,onChange:k,disabled:l,placeholder:"Enter task description",rows:3,className:`w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none ${l?"bg-gray-50 cursor-not-allowed":""}`})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Priority"}),a.jsxs("select",{name:"priority",value:i.priority,onChange:k,disabled:l,className:`w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none ${l?"bg-gray-50 cursor-not-allowed":""}`,children:[a.jsx("option",{value:"Low",children:"Low"}),a.jsx("option",{value:"Normal",children:"Normal"}),a.jsx("option",{value:"High",children:"High"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Due Date"}),a.jsx("input",{type:"datetime-local",name:"dueDate",value:i.dueDate,onChange:k,disabled:l,className:`w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none ${l?"bg-gray-50 cursor-not-allowed":""}`})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:["Assign To"," ",u?.role!=="Sales"&&a.jsx("span",{className:"text-red-500 font-semibold",children:"*"})]}),a.jsx(CA,{items:Array.isArray(c)?c:[],value:i.assignedTo??"",placeholder:u?.role==="Sales"?`${u.first_name} ${u.last_name}`:"Search an account...",getLabel:z=>`${z.first_name} ${z.last_name}`,onChange:z=>r(P=>({...P,assignedTo:z})),disabled:l||u?.role==="Sales",required:u?.role!=="Sales",isSubmitted:T})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Status"}),a.jsxs("select",{name:"status",value:i.status,onChange:k,disabled:l,className:`w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none ${l?"bg-gray-50 cursor-not-allowed":""}`,children:[a.jsx("option",{value:"Not started",children:"Not started"}),a.jsx("option",{value:"In progress",children:"In Progress"}),a.jsx("option",{value:"Deferred",children:"Deferred"}),a.jsx("option",{value:"Completed",children:"Completed"})]})]}),!l&&a.jsxs("div",{className:"flex flex-col sm:flex-row justify-end sm:justify-end space-y-2 sm:space-y-0 sm:space-x-2 col-span-1 md:col-span-2 mt-4 w-full",children:[a.jsx("button",{type:"button",onClick:()=>{t(),A(!1),y({})},className:"w-full sm:w-auto px-4 py-2 text-white bg-red-400 border border-red-300 rounded hover:bg-red-500 transition",children:"Cancel"}),a.jsx("button",{type:"submit",className:"w-full sm:w-auto px-4 py-2 text-white border border-tertiary bg-tertiary rounded hover:bg-secondary transition",children:o?"Update Task":"Create Task"})]})]})]})})})})})]})})}function CA({items:e=[],value:t="",onChange:n,getLabel:s,placeholder:r="Search...",disabled:i=!1,maxRender:o=200,required:l=!1,isSubmitted:c=!1}){const[u,d]=f.useState(!1),[h,p]=f.useState(""),x=f.useRef(null),v=e.find(w=>String(w.id)===String(t)),j=v?s(v):"",y=l&&c&&!t,N=f.useMemo(()=>{const w=h.trim().toLowerCase();return(w?e.filter(_=>(s(_)||"").toLowerCase().includes(w)):e).slice(0,o)},[e,h,s,o]);return f.useEffect(()=>{const w=S=>{x.current&&!x.current.contains(S.target)&&d(!1)};return document.addEventListener("mousedown",w),()=>document.removeEventListener("mousedown",w)},[]),f.useEffect(()=>{u||p("")},[u]),a.jsxs("div",{ref:x,className:"relative w-full",children:[a.jsx("input",{disabled:i,value:u?h:j,placeholder:r,onFocus:()=>!i&&d(!0),onChange:w=>{p(w.target.value),u||d(!0)},className:`w-full border rounded-md px-2 py-1.5 text-sm outline-none focus:ring-2 disabled:bg-gray-100
          ${y?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}`}),u&&!i&&a.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg overflow-hidden",children:[a.jsx("div",{className:"max-h-56 overflow-y-auto",children:N.length>0?N.map(w=>{const S=String(w.id),_=s(w),k=String(t)===S;return a.jsx("button",{type:"button",onClick:()=>{n(S),d(!1)},className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-50 ${k?"bg-blue-50":""}`,children:_||"--"},S)}):a.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No results"})}),e.length>o&&a.jsxs("div",{className:"px-3 py-2 text-[11px] text-gray-400 border-t",children:["Showing first ",o," results  keep typing to narrow."]})]})]})}const s8=["Not started","In progress","Deferred","Completed"],r8={NOT_STARTED:"Not started","NOT STARTED":"Not started","TO DO":"Not started",IN_PROGRESS:"In progress","IN PROGRESS":"In progress",COMPLETED:"Completed",DEFERRED:"Deferred","Not started":"Not started","In progress":"In progress",Completed:"Completed",Deferred:"Deferred","In Progress":"In progress","To Do":"Not started",Review:"Deferred"},tJ=e=>e&&(r8[e]||r8[String(e).toUpperCase()])||"Not started",pze=e=>{if(!e)return"";const t=new Date(e);if(Number.isNaN(t.getTime()))return"";const n=t.getTimezoneOffset();return new Date(t.getTime()-n*60*1e3).toISOString().slice(0,16)},SA=e=>{if(!e)return"";const t=new Date(e);return Number.isNaN(t.getTime())?"":t.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},xze=e=>{const t=e.subject?.trim()??"",n=e.description?.trim()??"",s=e.notes?.trim()??"";e.priority&&String(e.priority).toUpperCase(),tJ(e.status);let r=null,i=null,o=null,l=null,c=null;e.relatedType1==="Lead"&&e.relatedTo1?r=Number(e.relatedTo1):e.relatedType1==="Account"&&e.relatedTo1&&(i=Number(e.relatedTo1)),e.relatedType1==="Account"&&(e.relatedType2==="Contact"&&e.relatedTo2?o=Number(e.relatedTo2):e.relatedType2==="Deal"&&e.relatedTo2?l=Number(e.relatedTo2):e.relatedType2==="Quote"&&e.relatedTo2&&(c=Number(e.relatedTo2)));const u=e.assignedTo?Number(e.assignedTo):null,d=o||l||i||r,h=o?"Contact":l?"Deal":i?"Account":r?"Lead":c?"Quote":null;return{title:t,description:n,priority:e.priority||"Normal",status:e.status||"Not started",due_date:e.dueDate?e.dueDate:null,assigned_to:u,notes:s,is_personal:!1,lead_id:r,account_id:i,contact_id:o,deal_id:l,quote_id:c,related_to_1:e.relatedTo1?Number(e.relatedTo1):null,related_type_1:e.relatedType1,related_to_2:e.relatedTo2?Number(e.relatedTo2):null,related_type_2:e.relatedType2,related_to:d,related_type:h}},yze=e=>{const t=e.task_assign_to?`${e.task_assign_to.first_name} ${e.task_assign_to.last_name}`:e.assigned_to?String(e.assigned_to):"Unassigned",n=e.task_creator?`${e.task_creator.first_name} ${e.task_creator.last_name}`:e.created_by?String(e.created_by):"System",s=e.due_date||e.dueDate||null,r=e.date_assigned||e.created_at||null,i=e.contact?`${e.contact.first_name} ${e.contact.last_name}`:e.assigned_to?String(e.assigned_to.id):"Unassigned",o=B=>{if(!B)return"";const R=String(B).split("-");return R.length===3?`${R[0]}-${R[2]}`:String(B)},l=()=>e.lead?.id||e.lead_id,c=()=>e.account?.id||e.account_id,u=()=>e.contact?.id||e.contact_id,d=()=>e.deal?.id||e.deal_id,h=()=>e.quote?.id||e.quote_id,p=()=>e.task_assign_to?.id||e.assigned_to,x=()=>e.lead?.title||e.lead_id,v=()=>e.account?.name||e.account_id,j=()=>i||e.contact_id,y=()=>e.deal?.name||e.deal_id,N=()=>o(e.quote?.quote_id)||e.id;let w="Lead",S="",_="",k="",T="Lead",A="",E="",M="";const z=c(),P=v(),D=l(),U=x();if(z){w="Account",T="Account",A=P,S=String(z);const B=u(),R=d(),q=j(),Z=y(),V=h(),oe=N();B?(_="Contact",E="Contact",M=q,k=String(B)):R?(E="Deal",_="Deal",M=Z,k=String(R)):V&&(E="Quote",_="Quote",M=oe,k=String(V))}else D?(T="Lead",A=U,w="Lead",S=String(D)):e.related_type==="Account"&&(w="Account",S=String(e.related_to));return{id:e.id,title:e.title,description:e.description,priority:e.priority||"Normal",status:tJ(e.status),rawStatus:e.status,dueDate:s,dateAssigned:r,assignedToId:p()||null,assignedToName:t,createdAt:e.created_at||null,createdById:e.created_by??null,createdBy:n,notes:e.notes||"",isPersonal:!!e.is_personal,relatedType1Text:T,relatedTo1Text:A,relatedType2Text:E,relatedTo2Text:M,subject:e.title,relatedType1:w,relatedTo1:S,relatedType2:_,relatedTo2:k}};function bze(){f.useEffect(()=>{document.title="Tasks | Sari-Sari CRM"},[]);const{user:e,loading:t}=Vt(),[n,s]=f.useState("board"),[r,i]=f.useState(!1),[o,l]=f.useState(null),[c,u]=f.useState(!1),[d,h]=f.useState([]),[p,x]=f.useState(!0),[v,j]=f.useState(""),[y,N]=f.useState("Filter by Status"),[w,S]=f.useState("Filter by Priority"),[_,k]=f.useState([]),[T,A]=f.useState(1),[E,M]=f.useState(10),[z,P]=f.useState(null),[D,U]=f.useState(!1),[B,R]=f.useState([]),[q,Z]=f.useState(null),V=kt(),oe=ta(),[je,X]=f.useState({id:"",subject:"",description:"",priority:"",status:"",dueDate:"",assignedTo:"",notes:"",relatedType1:"Lead",relatedType2:"Contact",relatedTo1:"",relatedTo2:""}),[se,ye]=f.useState(null),Ne=Ux(Ff(sm,{activationConstraint:{distance:8}})),fe=Q=>{const{active:ne}=Q,ae=d.find(Pe=>Pe.id===ne.id);Z(ae)},we=async Q=>{const{active:ne,over:ae}=Q;if(Z(null),!ae)return;const Pe=ne.id,Te=ae.id,he=d.find(He=>He.id===Pe);if(!(!he||he.status===Te)){h(He=>He.map(qe=>qe.id===Pe?{...qe,status:Te}:qe));try{const He={title:he.title,description:he.description||"",priority:he.priority||"Normal",status:Te,due_date:he.dueDate||null,assigned_to:he.assignedToId||null,related_type_1:he.relatedType1||null,related_to_1:he.relatedTo1?parseInt(he.relatedTo1,10):null,related_type_2:he.relatedType2||null,related_to_2:he.relatedTo2?parseInt(he.relatedTo2,10):null};(!He.related_to_1||isNaN(He.related_to_1))&&(He.related_to_1=null),(!He.related_to_2||isNaN(He.related_to_2))&&(He.related_to_2=null),await re.put(`/tasks/${Pe}`,He),H.success(`Task moved to "${Te}"`)}catch(He){console.error("Failed to update task status:",He),H.error("Failed to update task status"),h(qe=>qe.map(nt=>nt.id===Pe?{...nt,status:he.status}:nt))}}},de=()=>{Z(null)};f.useEffect(()=>{const Q=oe.state?.openTaskModal,ne=oe.state?.initialTaskData,ae=oe.state?.taskID;Q?(i(!0),ne&&X(Pe=>({...Pe,...ne})),V(oe.pathname,{replace:!0,state:{}})):ae&&(ye(ae),V(oe.pathname,{replace:!0,state:{}}))},[oe,V]),f.useEffect(()=>{if(se&&d.length>0&&!p){const Q=d.find(ne=>ne.id===se);Q?be(Q,!0):H.error("Task not found."),ye(null)}},[se,d,p]);const ke=async()=>{try{const Q=await re.get("/users/all");k(Array.isArray(Q.data)?Q.data:[])}catch(Q){console.error("Failed to fetch users:",Q),H.error("Failed to fetch users.")}},ge=async()=>{try{x(!0);const Q=await re.get("/tasks/all"),ae=(Array.isArray(Q.data)?Q.data:[]).map(yze);ae.sort((Pe,Te)=>{const he=Pe.createdAt?new Date(Pe.createdAt):0;return(Te.createdAt?new Date(Te.createdAt):0)-he}),h(ae),n==="list"&&A(1)}catch(Q){console.error("Failed to load tasks:",Q),H.error("Failed to load tasks.")}finally{x(!1)}};f.useEffect(()=>{if(!t&&e){ke(),ge();const Q=Mj(e.id),ne=new WebSocket(Q);return ne.onopen=()=>{console.log(" Connected to task notifications")},ne.onmessage=ae=>{try{const Pe=JSON.parse(ae.data);Pe.type==="task_status_updated"&&(H.info(` ${Pe.message}`,{position:"top-right",autoClose:4e3}),ge())}catch(Pe){console.error("Error parsing notification:",Pe)}},ne.onerror=ae=>{console.error(" WebSocket error:",ae)},ne.onclose=()=>{console.log(" Disconnected from task notifications")},()=>{ne&&ne.readyState===WebSocket.OPEN&&ne.close()}}},[t,e]);const $e=()=>{l(null),X({id:"",subject:"",description:"",priority:"Normal",status:"Not started",dueDate:"",assignedTo:"",notes:"",relatedType1:"Lead",relatedType2:"Contact",relatedTo1:"",relatedTo2:""})},be=(Q=null,ne=!1)=>{l(Q),u(ne),Q?X({id:Q.id,subject:Q.title||"",description:Q.description||"",priority:Q.priority||"Normal",status:Q.status||"Not started",rawStatus:Q.rawStatus,dueDate:pze(Q.dueDate),assignedTo:Q.assignedToId?String(Q.assignedToId):"",assignedToName:Q.assignedToName||"",createdBy:Q.createdBy||"",notes:Q.notes||"",relatedType1Text:Q.relatedType1Text||"",relatedTo1Text:Q.relatedTo1Text||"",relatedType2Text:Q.relatedType2Text||"",relatedTo2Text:Q.relatedTo2Text||"",relatedType1:Q.relatedType1||"",relatedTo1:Q.relatedTo1||"",relatedType2:Q.relatedType2||"",relatedTo2:Q.relatedTo2||""}):$e(),i(!0)},me=()=>{i(!1),l(null),u(!1),$e()},Ue=async Q=>{const ne=xze(Q);try{o&&!c?(await re.put(`/tasks/${o.id}`,ne),H.success("Task updated successfully.")):(await re.post("/tasks/create",ne),H.success("Task created successfully.")),i(!1),await ge()}catch(ae){console.error("Failed to save task:",ae);const Pe=ae.response?.data?.detail||"Failed to save task.";H.error(Pe)}},Ee=Q=>{Q&&P({title:"Delete Task",message:a.jsxs(a.Fragment,{children:["Are you sure you want to delete ",a.jsx("span",{className:"font-semibold",children:Q.title}),"?"]}),confirmLabel:"Delete Task",cancelLabel:"Cancel",variant:"danger",action:{type:"delete",targetId:Q.id}})},We=()=>{if(Ze.every(Q=>B.includes(Q.id)))R(B.filter(Q=>!Ze.map(ne=>ne.id).includes(Q)));else{const Q=Ze.map(ne=>ne.id);R([...new Set([...B,...Q])])}},tt=Q=>{R(ne=>ne.includes(Q)?ne.filter(ae=>ae!==Q):[...ne,Q])},lt=async()=>{B.length!==0&&P({title:"Delete Tasks",message:a.jsxs("span",{children:["Are you sure you want to delete"," ",a.jsx("span",{className:"font-semibold",children:B.length})," selected tasks? This action cannot be undone."]}),confirmLabel:`Delete ${B.length} Task(s)`,cancelLabel:"Cancel",variant:"danger",action:{type:"bulk-delete",task_ids:B}})},Fe=async()=>{if(!z?.action){P(null);return}const{action:Q}=z;U(!0);try{Q.type==="delete"?(await re.delete(`/tasks/${Q.targetId}`),H.success("Task deleted successfully."),await ge()):Q.type==="bulk-delete"&&(await re.delete("/tasks/admin/bulk-delete",{data:{task_ids:Q.task_ids}}),H.success(`Successfully deleted ${Q.task_ids.length} tasks`),R([]),await ge())}catch(ne){console.error("Task action failed:",ne),H.error("Failed to delete task.")}finally{U(!1),P(null)}},st=()=>{D||P(null)},Xe=f.useMemo(()=>{const Q=v.trim().toLowerCase();return[...d].sort((ae,Pe)=>{const Te=ae.createdAt?new Date(ae.createdAt):0;return(Pe.createdAt?new Date(Pe.createdAt):0)-Te}).filter(ae=>{const Pe=Q===""||ae.title?.toLowerCase().includes(Q)||ae.description?.toLowerCase().includes(Q)||ae.assignedToName?.toLowerCase().includes(Q)||ae.createdBy?.toLowerCase().includes(Q),Te=y==="Filter by Status"||ae.status===y,he=w==="Filter by Priority"||ae.priority===w;return Pe&&Te&&he})},[d,v,y,w]);f.useEffect(()=>{A(1)},[v,y,w,n,E]),f.useEffect(()=>{if(n==="list"){const Q=Xe.length===0?1:Math.ceil(Xe.length/E);T>Q&&A(Q)}},[Xe.length,T,n,E]);const Ze=f.useMemo(()=>{if(n==="board")return Xe;const Q=(T-1)*E;return Xe.slice(Q,Q+E)},[Xe,T,n,E]),Je=f.useMemo(()=>{const Q=new Date,ne=d.filter(ae=>ae.rawStatus!=="INACTIVE");return[{title:"To Do",value:ne.filter(ae=>ae.status==="Not started").length,icon:zs,color:"text-blue-600",bgColor:"bg-blue-100"},{title:"In Progress",value:ne.filter(ae=>ae.status==="In progress").length,icon:Yi,color:"text-purple-600",bgColor:"bg-purple-100"},{title:"Completed",value:ne.filter(ae=>ae.status==="Completed").length,icon:Qa,color:"text-green-600",bgColor:"bg-green-100"},{title:"Overdue",value:ne.filter(ae=>ae.dueDate&&new Date(ae.dueDate)<Q&&ae.status!=="Completed").length,icon:Fl,color:"text-red-600",bgColor:"bg-red-100"},{title:"High Priority",value:ne.filter(ae=>ae.priority==="High").length,icon:ec,color:"text-orange-600",bgColor:"bg-orange-100"}]},[d]),Be=Q=>Q.dueDate&&new Date(Q.dueDate)<new Date&&Q.status!=="Completed",_e=Q=>{switch(Q.status){case"Not started":return"bg-blue-50 hover:bg-blue-100 border-blue-200";case"In progress":return"bg-purple-50 hover:bg-purple-100 border-purple-200";case"Deferred":return"bg-orange-50 hover:bg-orange-100 border-orange-200";case"Completed":return"bg-green-50 hover:bg-green-100 border-green-200";default:return"bg-gray-50 hover:bg-gray-100 border-gray-100"}},pe=Q=>{switch(Q){case"Not started":return"bg-blue-100 text-blue-700";case"In progress":return"bg-purple-100 text-purple-700";case"Deferred":return"bg-orange-100 text-orange-700";case"Completed":return"bg-green-100 text-green-700";default:return"bg-gray-100 text-gray-700"}},ce=Q=>{switch(Q){case"High":return"bg-red-100 text-red-700";case"Normal":return"bg-yellow-100 text-yellow-700";default:return"bg-gray-100 text-gray-700"}};return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 min-h-screen font-inter relative",children:[(p||t)&&a.jsx(Wt,{message:"Loading tasks..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 space-y-2 sm:space-y-0",children:[a.jsxs("h1",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[a.jsx(Yi,{className:"text-blue-600"})," Tasks Board"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{type:"button",onClick:()=>be(),className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 rounded-md hover:bg-gray-800 text-sm sm:text-base self-end sm:self-auto mt-2 lg:mt-0 cursor-pointer",children:[a.jsx(aa,{})," Create Task"]})})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 xl:grid-cols-5 gap-4 mb-6 w-full break-words overflow-hidden lg:overflow-visible",children:Je.map(Q=>a.jsx(vze,{...Q},Q.title))}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mt-6 mb-4 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search tasks",value:v,onChange:Q=>j(Q.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row w-full lg:w-1/2 gap-2",children:[a.jsxs("select",{value:y,onChange:Q=>N(Q.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{children:"Filter by Status"}),s8.map(Q=>a.jsx("option",{children:Q},Q))]}),a.jsxs("select",{value:w,onChange:Q=>S(Q.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{children:"Filter by Priority"}),a.jsx("option",{children:"High"}),a.jsx("option",{children:"Normal"}),a.jsx("option",{children:"Low"})]})]})]}),a.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[a.jsx("button",{type:"button",onClick:()=>s("board"),className:`px-4 py-2 rounded-full text-sm ${n==="board"?"bg-gray-800 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Board View"}),a.jsx("button",{type:"button",onClick:()=>s("list"),className:`px-4 py-2 rounded-full text-sm ${n==="list"?"bg-gray-800 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"List View"})]}),!p&&!t&&n==="board"&&(Xe.length>0?a.jsxs(qx,{sensors:Ne,collisionDetection:Bx,onDragStart:fe,onDragEnd:we,onDragCancel:de,children:[a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4 rounded-md",children:s8.map(Q=>{const ne=Ze.filter(ae=>ae.status===Q);return a.jsx(jze,{column:Q,columnTasks:ne,getTaskCardColor:_e,isTaskOverdue:Be,formatDateDisplay:SA,handleOpenModal:be,handleDeleteTask:Ee,currentUser:e},Q)})}),a.jsx(EN,{children:q?a.jsx(Cze,{task:q,getTaskCardColor:_e,isTaskOverdue:Be,formatDateDisplay:SA}):null})]}):a.jsx("div",{className:"col-span-4 text-center py-10 text-gray-500 border border-dashed rounded-xl",children:"No tasks found."})),!p&&!t&&n==="list"&&a.jsx("div",{className:"bg-white rounded-md shadow-sm overflow-hidden",children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-gray-600 text-left",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 w-10",children:a.jsx("input",{type:"checkbox",className:"w-4 h-4 accent-blue-600",checked:Ze.length>0&&Ze.every(Q=>B.includes(Q.id)),onChange:We})}),a.jsx("th",{className:"py-3 px-4 font-medium",children:"Task"}),a.jsx("th",{className:"py-3 px-4 font-medium",children:"Status"}),a.jsx("th",{className:"py-3 px-4 font-medium",children:"Priority"}),a.jsx("th",{className:"py-3 px-4 font-medium",children:"Assigned To"}),a.jsx("th",{className:"py-3 px-4 font-medium",children:"Date Assigned"}),a.jsx("th",{className:"py-3 px-4 font-medium text-center w-24",children:B.length>0?a.jsx("button",{onClick:lt,className:"text-red-600 hover:text-red-800 transition p-1 rounded-full hover:bg-red-50",title:`Delete ${B.length} selected tasks`,children:a.jsx(wa,{size:18})}):""})]})}),a.jsx("tbody",{children:Ze.length>0?Ze.map(Q=>a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors text-sm cursor-pointer",children:[a.jsx("td",{className:"py-3 px-4",onClick:ne=>ne.stopPropagation(),children:a.jsx("input",{type:"checkbox",className:"w-4 h-4 accent-blue-600",checked:B.includes(Q.id),onChange:()=>tt(Q.id)})}),a.jsx("td",{className:"py-3 px-4 text-gray-700 whitespace-nowrap font-medium",onClick:()=>be(Q,!0),children:Q.title}),a.jsx("td",{className:"py-3 px-4 whitespace-nowrap",onClick:()=>be(Q,!0),children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium whitespace-nowrap ${pe(Q.status||"Not started")}`,children:Q.status||"Not started"}),Q.rawStatus==="INACTIVE"&&(e?.role==="ADMIN"||e?.role==="CEO")&&a.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium whitespace-nowrap bg-red-600 text-white",children:"INACTIVE"})]})}),a.jsx("td",{className:"py-3 px-4 whitespace-nowrap",onClick:()=>be(Q,!0),children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium whitespace-nowrap ${ce(Q.priority||"Low")}`,children:Q.priority||"Low"})}),a.jsx("td",{className:"py-3 px-4 text-gray-700 whitespace-nowrap",onClick:()=>be(Q,!0),children:Q.assignedToName||"Unassigned"}),a.jsx("td",{className:`py-3 px-4 text-gray-700 whitespace-nowrap ${Be(Q)?"text-red-600 font-medium":""}`,onClick:()=>be(Q,!0),children:Q.dateAssigned?SA(Q.dateAssigned):""}),a.jsx("td",{})]},Q.id)):a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"text-center py-4 text-gray-500",children:"No tasks found."})})})]})})}),!p&&!t&&n==="list"&&a.jsx(ca,{className:"mt-6",totalItems:Xe.length,pageSize:E,currentPage:Xe.length===0?0:T,onPrev:()=>A(Q=>Math.max(Q-1,1)),onNext:()=>A(Q=>Math.min(Q+1,Math.max(1,Math.ceil(Xe.length/E)||1))),onPageSizeChange:Q=>{M(Q),A(1)},pageSizeOptions:[10,20,30,40,50],label:"tasks"}),a.jsx(v0,{isOpen:r,onClose:me,onSave:Ue,onEdit:()=>u(!1),setFormData:X,formData:je,isEditing:!c&&!!o,viewMode:c,users:_,currentUser:e,onDelete:Ee}),z&&a.jsx(wze,{open:!0,title:z.title,message:z.message,confirmLabel:z.confirmLabel,cancelLabel:z.cancelLabel,variant:z.variant,onConfirm:Fe,onCancel:st,loading:D})]})}function vze({icon:e,title:t,value:n,color:s,bgColor:r,onClick:i}){return a.jsxs("div",{className:"flex items-center p-4 bg-white rounded-xl shadow-md border border-gray-200 transition-all duration-300 cursor-default",onClick:i,children:[a.jsx("div",{className:`flex-shrink-0 p-3 rounded-full ${r} ${s} mr-4`,children:e?a.jsx(e,{size:22}):null}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:t}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:n})]})]})}function wze({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r,variant:i,loading:o,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsx("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${u}`,disabled:o,children:o?"Processing...":s})]})]})})}function jze({column:e,columnTasks:t,getTaskCardColor:n,isTaskOverdue:s,formatDateDisplay:r,handleOpenModal:i,handleDeleteTask:o,currentUser:l}){const{isOver:c,setNodeRef:u}=Wx({id:e});return a.jsxs("div",{ref:u,className:`bg-white p-4 shadow border flex flex-col relative rounded-md transition-all duration-200 min-h-[200px] ${c?"border-blue-400 bg-blue-50 ring-2 ring-blue-300":"border-gray-200"}`,children:[a.jsx("div",{className:"absolute top-0 left-0 w-full h-5 bg-secondary rounded-t-md"}),a.jsxs("div",{className:"flex items-center justify-between mb-3 pt-7",children:[a.jsx("h3",{className:"font-medium text-gray-900",children:e}),a.jsx("span",{className:"text-xs bg-gray-100 px-2 py-1 rounded-full text-gray-500",children:t.length})]}),a.jsx("div",{className:`space-y-3 flex-1 ${t.length>3?"overflow-y-auto max-h-[480px] hide-scrollbar":""}`,children:t.length>0?t.map(d=>a.jsx(Nze,{task:d,getTaskCardColor:n,isTaskOverdue:s,formatDateDisplay:r,handleOpenModal:i,handleDeleteTask:o,currentUser:l},d.id)):a.jsx("div",{className:`text-center py-10 text-gray-500 border-2 border-dashed rounded-lg ${c?"border-blue-300 bg-blue-50":"border-gray-200"}`,children:c?"Drop here":"No tasks"})})]})}function Nze({task:e,getTaskCardColor:t,isTaskOverdue:n,formatDateDisplay:s,handleOpenModal:r,handleDeleteTask:i,currentUser:o}){const{attributes:l,listeners:c,setNodeRef:u,transform:d,isDragging:h}=Gx({id:e.id}),p=d?{transform:`translate3d(${d.x}px, ${d.y}px, 0)`}:void 0;return a.jsxs("div",{ref:u,style:p,className:`border rounded-lg p-3 transition flex justify-between items-start cursor-grab active:cursor-grabbing ${t(e)} ${h?"opacity-50 shadow-lg ring-2 ring-blue-400":""}`,...c,...l,children:[a.jsxs("div",{className:"text-left flex-1",onClick:x=>{x.stopPropagation(),r(e,!0)},children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx("p",{className:"font-medium text-gray-800 text-sm",children:e.title}),e.rawStatus==="INACTIVE"&&(o?.role==="ADMIN"||o?.role==="CEO")&&a.jsx("span",{className:"px-2 py-0.5 rounded text-xs font-medium bg-red-600 text-white",children:"INACTIVE"})]}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Priority: ",e.priority]}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Assigned To: ",e.assignedToName]}),a.jsxs("p",{className:"text-xs mt-1 text-gray-500",children:["Date: ",a.jsx("span",{className:n(e)?"text-red-600":"text-gray-600",children:e.dateAssigned?s(e.dateAssigned):""})]})]}),a.jsxs("div",{className:"flex items-center gap-2 ml-3",onClick:x=>x.stopPropagation(),children:[a.jsx("button",{type:"button",onClick:x=>{x.stopPropagation(),r(e)},className:"text-blue-500 hover:text-blue-700",children:a.jsx(hn,{})}),a.jsx("button",{type:"button",onClick:x=>{x.stopPropagation(),i(e)},className:"text-red-500 hover:text-red-700",children:a.jsx(wa,{})})]})]})}function Cze({task:e,getTaskCardColor:t,isTaskOverdue:n,formatDateDisplay:s}){return a.jsx("div",{className:`border rounded-lg p-3 shadow-xl ring-2 ring-blue-400 ${t(e)}`,style:{width:"280px"},children:a.jsxs("div",{className:"text-left flex-1",children:[a.jsx("p",{className:"font-medium text-gray-800 text-sm",children:e.title}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Priority: ",e.priority]}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Assigned To: ",e.assignedToName]}),a.jsxs("p",{className:"text-xs mt-1 text-gray-500",children:["Date: ",a.jsx("span",{className:n(e)?"text-red-600":"text-gray-600",children:e.dateAssigned?s(e.dateAssigned):""})]})]})})}function Sze(e){return Dt({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M235.4 172.2c0-11.4 9.3-19.9 20.5-19.9 11.4 0 20.7 8.5 20.7 19.9s-9.3 20-20.7 20c-11.2 0-20.5-8.6-20.5-20zm1.4 35.7H275V352h-38.2V207.9z"},child:[]},{tag:"path",attr:{d:"M256 76c48.1 0 93.3 18.7 127.3 52.7S436 207.9 436 256s-18.7 93.3-52.7 127.3S304.1 436 256 436c-48.1 0-93.3-18.7-127.3-52.7S76 304.1 76 256s18.7-93.3 52.7-127.3S207.9 76 256 76m0-28C141.1 48 48 141.1 48 256s93.1 208 208 208 208-93.1 208-208S370.9 48 256 48z"},child:[]}]})(e)}const _A={name:"",description:"",manager_id:"",user_ids:[],company_id:""};function _ze({label:e,options:t,selectedValues:n,onChange:s,disabled:r=!1,placeholder:i="Select users...",isSubmitted:o=!1,required:l=!1}){const[c,u]=f.useState(!1),[d,h]=f.useState(""),p=f.useRef(null);f.useEffect(()=>{function N(w){p.current&&!p.current.contains(w.target)&&(u(!1),h(""))}return document.addEventListener("mousedown",N),()=>document.removeEventListener("mousedown",N)},[]);const x=t.filter(N=>N.label.toLowerCase().includes(d.toLowerCase())),v=N=>{const w=n.includes(N);let S;w?S=n.filter(_=>_!==N):S=[...n,N],s(S)},j=(N,w)=>{N.stopPropagation(),s(n.filter(S=>S!==w))},y=t.filter(N=>n.includes(N.value));return a.jsxs("div",{className:"relative",ref:p,children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsxs("div",{onClick:()=>!r&&u(!c),className:`w-full border ${l&&o&&n.length===0?"border-red-500 ring-red-500":c?"border-gray-500 ring-1 ring-gray-400":"border-gray-300"} 
  rounded-md px-3 py-2 text-sm bg-white cursor-pointer min-h-[38px] flex flex-wrap items-center gap-2
  ${r?"bg-gray-100 cursor-not-allowed":""}`,children:[n.length===0&&a.jsx("span",{className:"text-gray-400 select-none",children:i}),y.map(N=>a.jsxs("span",{className:"bg-indigo-100 text-indigo-700 px-2 py-0.5 rounded text-xs flex items-center gap-1 border border-indigo-200",children:[N.label,!r&&a.jsx(ea,{className:"cursor-pointer hover:text-indigo-900",onClick:w=>j(w,N.value)})]},N.value)),a.jsx("div",{className:"ml-auto text-gray-400",children:a.jsx(Pt,{})})]}),c&&!r&&a.jsxs("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-hidden flex flex-col",children:[a.jsx("div",{className:"p-2 border-b border-gray-100 sticky top-0 bg-white",children:a.jsxs("div",{className:"flex items-center px-2 py-1 bg-gray-50 rounded border border-gray-200",children:[a.jsx(Kt,{className:"text-gray-400 mr-2"}),a.jsx("input",{type:"text",className:"bg-transparent outline-none w-full text-sm",placeholder:"Search...",value:d,onChange:N=>h(N.target.value),autoFocus:!0})]})}),a.jsx("div",{className:"overflow-y-auto flex-1",children:x.length>0?x.map(N=>{const w=n.includes(N.value);return a.jsxs("div",{onClick:()=>v(N.value),className:`px-4 py-2 text-sm cursor-pointer flex items-center justify-between hover:bg-gray-50 
                      ${w?"bg-indigo-50 text-indigo-700":"text-gray-700"}`,children:[a.jsx("span",{children:N.label}),w&&a.jsx(jL,{className:"text-indigo-600"})]},N.value)}):a.jsx("div",{className:"px-4 py-3 text-sm text-gray-500 text-center",children:"No results found"})})]})]})}function Bc(){f.useEffect(()=>{document.title="Territory | Sari-Sari CRM"},[]);const e=kt(),{id:t}=Wo(),[n,s]=f.useState(""),[r,i]=f.useState(""),[o,l]=f.useState(""),[c,u]=f.useState(null),[d,h]=f.useState(!1),[p,x]=f.useState([]),[v,j]=f.useState(!1),[y,N]=f.useState([]),[w,S]=f.useState(_A),[_,k]=f.useState(!1),[T,A]=f.useState(!1),[E,M]=f.useState(null),[z,P]=f.useState(null),[D,U]=f.useState("board"),[B,R]=f.useState(null),[q,Z]=f.useState(!1),[V,oe]=f.useState(null),[je,X]=f.useState(1),[se,ye]=f.useState(10),[Ne,fe]=f.useState([]),[we,de]=f.useState(null),ke=f.useRef(!1),ge=f.useRef(!1),{userRole:$e}=Ks(),be=f.useMemo(()=>{const Re=new Map;return p.forEach(it=>{const St=`${it.name}-${it.manager_id||"no-manager"}`;if(!Re.has(St))Re.set(St,{...it,territory_ids:[it.id],assigned_users_list:it.assigned_to?[it.assigned_to]:[]});else{const Et=Re.get(St);Et.territory_ids.push(it.id),it.assigned_to&&(Et.assigned_users_list.some(Tt=>Tt.id===it.assigned_to.id)||Et.assigned_users_list.push(it.assigned_to))}}),Array.from(Re.values())},[p]),me=f.useMemo(()=>{const Re=n.trim().toLowerCase(),it=r.trim().toLowerCase(),St=o.trim();return[...be].sort((Tt,Nt)=>{const xe=Tt?.created_at?new Date(Tt.created_at):0;return(Nt?.created_at?new Date(Nt.created_at):0)-xe}).filter(Tt=>{const Nt=Tt.name?.toLowerCase()||"",xe=Tt.description?.toLowerCase()||"",ve=Tt.managed_by?`${Tt.managed_by.first_name} ${Tt.managed_by.last_name}`.toLowerCase():"",Oe=Tt.status?.toString().toLowerCase()||"",Ce=Tt.assigned_users_list.map(Y=>`${Y.first_name} ${Y.last_name}`.toLowerCase()).join(" "),G=Re===""||[Nt,xe,ve,Oe,Ce].some(Y=>Y&&Y.includes(Re)),W=it===""||Oe===it,J=St===""||String(Tt.managed_by?.id||"")===St||Tt.assigned_users_list.some(Y=>String(Y.id)===St);return G&&W&&J})},[be,n,r,o]);f.useEffect(()=>{if(ke.current){ke.current=!1;return}if(t&&be.length>0&&!_&&!d&&!T){const Re=be.find(it=>it.id===parseInt(t));Re&&u(Re)}!t&&!_&&!d&&u(null)},[t,be,_,d,T]),f.useEffect(()=>{X(1)},[n,r,o]),f.useEffect(()=>{X(Re=>{const it=Math.max(1,Math.ceil(me.length/se)||1);return Re>it?it:Re})},[me.length,se]);const Ue=async()=>{try{const Re=await re.get("/users/read/territory");N(Re.data)}catch(Re){console.error("Error fetching users:",Re)}},Ee=async()=>{j(!0);try{const Re=await re.get("/territories/fetch"),it=Array.isArray(Re.data)?Re.data:[];x(it),console.log(Re.data)}catch(Re){console.error("Error fetching territories:",Re)}finally{j(!1)}},We=async()=>{try{const Re=await re.get("/auth/me");de(Re.data)}catch(Re){console.error("Error fetching current user:",Re)}};f.useEffect(()=>{Ue(),Ee(),We()},[]);const tt=Re=>$e.toLowerCase()==="ceo"||$e.toLowerCase()==="admin"?!0:$e.toLowerCase()==="group_manager"||$e.toLowerCase()==="group manager"?we&&Re.territory_creator?.id===we.id:!1,lt=()=>$e.toLowerCase()==="group_manager"||$e.toLowerCase()==="group manager",Fe=Re=>{const{name:it,value:St}=Re.target;S(Et=>({...Et,[it]:St}))},st=Re=>{S(it=>({...it,user_ids:Re}))},Xe=()=>{S(_A),k(!1),M(null),h(!0)},Ze=(Re=!0)=>{h(!1),k(!1),M(null),S(_A)},Je=Re=>{if(!Re)return;const it=Re.assigned_users_list?Re.assigned_users_list.map(St=>String(St.id)):[];S({name:Re.name||"",description:Re.description||"",manager_id:Re.managed_by?String(Re.managed_by.id):"",user_ids:it,company_id:Re.company_id?String(Re.company_id):""}),k(!0),M(Re.id),u(null),h(!0)},[Be,_e]=f.useState(!1),pe=Re=>{if(Re.preventDefault(),T||B)return;_e(!0);const it=w.name.trim();if(!it){H.error("Territory name is required.");return}if(!w.manager_id){H.error("Territory manager is required.");return}if(w.user_ids.length===0){H.error("Please assign at least one user.");return}let St=w.company_id?Number(w.company_id):null;if(!St&&w.user_ids.length>0){const xe=w.user_ids[0],ve=y.find(Oe=>String(Oe.id)===String(xe));ve&&ve.company&&(St=ve.company.id)}const Et=[...new Set(w.user_ids.map(xe=>Number(xe)))],Tt={name:it,description:w.description?.trim()||"",manager_id:w.manager_id?Number(w.manager_id):null,user_ids:Et,company_id:St},Nt=_&&E?"update":"create";R({title:Nt==="create"?"Confirm New Territory":"Confirm Update",message:a.jsxs("span",{children:[Nt==="create"?"Create":"Update"," territory ",a.jsx("span",{className:"font-semibold",children:it})," with ",Tt.user_ids.length," assigned users?"]}),confirmLabel:Nt==="create"?"Create":"Update",cancelLabel:"Cancel",variant:"primary",action:{type:Nt,payload:Tt,targetId:E,name:it}})},ce=Re=>{if(!Re)return;const it=$e.toLowerCase()==="group_manager"||$e.toLowerCase()==="group manager",St=it?"Archive":"Delete",Et=it?`Are you sure you want to archive <span class="font-semibold">${Re.name}</span>? 
          <br/><span class="text-xs text-orange-500">This will archive assignments for all ${Re.assigned_users_list.length} users in this group.</span>`:`Are you sure you want to delete <span class="font-semibold">${Re.name}</span>? 
          <br/><span class="text-xs text-red-500">This will remove assignments for all ${Re.assigned_users_list.length} users in this group.</span>`,Tt={type:"bulk-delete",territory_ids:Re.territory_ids,name:Re.name};R({title:`${St} Territory Group`,message:a.jsx("span",{dangerouslySetInnerHTML:{__html:Et}}),confirmLabel:St,cancelLabel:"Cancel",variant:it?"warning":"danger",action:Tt})},Q=async()=>{if(Ne.length===0)return;const Re=$e.toLowerCase()==="group_manager"||$e.toLowerCase()==="group manager",it=Re?"Archive":"Delete",St=Re?`Are you sure you want to archive <span class="font-semibold">${Ne.length}</span> selected territories? This action cannot be undone.`:`Are you sure you want to delete <span class="font-semibold">${Ne.length}</span> selected territories? This action cannot be undone.`;R({title:`${it} Territories`,message:a.jsx("span",{dangerouslySetInnerHTML:{__html:St}}),confirmLabel:`${it} ${Ne.length} Territory(ies)`,cancelLabel:"Cancel",variant:Re?"warning":"danger",action:{type:"bulk-delete",territory_ids:Ne}})},ne=Re=>{if(Re.target.checked){const it=he.filter(St=>tt(St)).flatMap(St=>St.territory_ids?St.territory_ids:[St.id]);fe(it)}else fe([])},ae=Re=>{let it=[];typeof Re=="object"&&Re.territory_ids?it=Re.territory_ids:typeof Re=="object"&&Re.id?it=[Re.id]:it=[Re],fe(St=>it.every(Tt=>St.includes(Tt))?St.filter(Tt=>!it.includes(Tt)):[...St,...it.filter(Tt=>!St.includes(Tt))])},Pe=async()=>{if(!B?.action){R(null);return}const{action:Re}=B,{type:it,payload:St,targetId:Et,name:Tt}=Re;if(!(it==="create"&&ge.current)){it==="create"&&(ge.current=!0),Z(!0);try{if(it==="create")A(!0),await re.post("/territories/assign",St),H.success(`Territory "${Tt}" created.`),await Ee(),await Ue(),Ze(!1);else if(it==="update")A(!0),await re.put(`/territories/${Et}`,St),H.success(`Territory "${Tt}" updated.`),ke.current=!0,Ze(!1),u(null),t&&e("/admin/territory"),await Ee(),await Ue();else if(it==="delete"){oe(Et),await re.delete(`/territories/${Et}`);const Nt=lt()?"archived":"deleted";H.success(`Territory "${Tt}" ${Nt}.`),await Ee(),c?.id===Et&&u(null),h(!1)}else if(it==="bulk-delete"){await re.delete("/territories/admin/bulk-delete",{data:{territory_ids:Re.territory_ids}});const Nt=lt()?"archived":"deleted",xe=Tt?`Territory "${Tt}" ${Nt} (${Re.territory_ids.length} user(s)).`:`Successfully ${Nt} ${Re.territory_ids.length} territories`;H.success(xe),fe([]),await Ee(),u(null),h(!1)}}catch(Nt){console.error(Nt),H.error("An error occurred.")}finally{A(!1),_e(!1),oe(null),Z(!1),R(null),it==="create"&&(ge.current=!1)}}},Te=()=>{q||R(null)},he=f.useMemo(()=>{if(D==="board")return me;const Re=(je-1)*se;return me.slice(Re,Re+se)},[me,je,se,D]),He=me.length>0,qe=()=>X(Re=>Math.max(Re-1,1)),nt=()=>X(Re=>Math.min(Re+1,Math.ceil(me.length/se)||1)),ot=Re=>!Re||Re.length===0?"Unassigned":Re.length===1?`${Re[0].first_name} ${Re[0].last_name}`:`${Re[0].first_name} ${Re[0].last_name} +${Re.length-1} more`;return a.jsx(a.Fragment,{children:a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 min-h-screen font-inter relative",children:[v&&a.jsx(Wt,{message:"Loading territories..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-3 sm:gap-0 mb-7",children:[a.jsxs("h2",{className:"flex items-center text-2xl font-semibold text-gray-800",children:[a.jsx(tc,{className:"mr-2 text-blue-600"})," Territory"]}),a.jsx("div",{className:"flex justify-center lg:justify-end md:justify-end w-full",children:["ceo","admin","group manager","group_manager"].includes($e.toLowerCase())&&(Array.isArray(y)&&y.length>0?a.jsxs("button",{onClick:Xe,className:"flex items-center bg-black text-white px-3 py-2 rounded-md hover:bg-gray-800 text-sm",children:[a.jsx(aa,{})," Create Territory"]}):a.jsxs("div",{className:"text-xs bg-red-50 p-2 rounded-lg ring ring-red-300 text-red-700 flex items-center gap-1",children:[a.jsx(Sze,{})," Add users to assign territories"]}))})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-4 shadow-sm mt-6 mb-4 flex flex-col md:flex-row items-center gap-2",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full md:w-4/4",children:[a.jsx(Kt,{className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search territory",className:"focus:outline-none w-full",value:n,onChange:Re=>s(Re.target.value)})]}),$e.toLowerCase()!=="sales"&&a.jsx("div",{className:"flex flex-col md:flex-row gap-2 w-full md:w-1/2",children:a.jsxs("select",{className:"border border-gray-300 rounded-lg px-3 h-11 w-full text-sm",value:o,onChange:Re=>l(Re.target.value),children:[a.jsx("option",{value:"",children:"Filter by Users"}),y.map(Re=>a.jsxs("option",{value:String(Re.id),children:[Re.first_name," ",Re.last_name]},Re.id))]})})]}),a.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[a.jsx("button",{onClick:()=>U("board"),className:`px-4 py-2 rounded-full text-sm ${D==="board"?"bg-gray-800 text-white":"bg-gray-100"}`,children:"Board View"}),a.jsx("button",{onClick:()=>U("list"),className:`px-4 py-2 rounded-full text-sm ${D==="list"?"bg-gray-800 text-white":"bg-gray-100"}`,children:"List View"})]}),D==="board"&&a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4",children:He?he.map(Re=>a.jsxs("div",{onClick:()=>{u(Re);let it;$e.toLowerCase()==="ceo"||$e.toLowerCase()==="admin"?it="admin":$e.toLowerCase()==="group manager"||$e.toLowerCase()==="group_manager"?it="group-manager":$e.toLowerCase()==="manager"?it="manager":it="sales",e(`/${it}/territory/${Re.id}`)},className:`relative flex flex-col cursor-pointer transition p-4 border shadow ${Re.status==="Inactive"?"bg-gray-50 border-gray-300":"bg-white border-gray-200 hover:shadow-md"}`,children:[a.jsx("div",{className:`absolute top-0 left-0 w-full h-5 rounded-t-md ${Re.status==="Inactive"?"bg-gray-400":"bg-secondary"}`}),Re.status==="Inactive"&&a.jsx("span",{className:"absolute top-2 right-2 bg-red-100 text-red-700 text-xs font-semibold px-2 py-1 rounded",children:"Inactive"}),a.jsx("h3",{className:"font-medium text-gray-900 mb-2 pt-7",children:Re.name}),Re.description&&a.jsx("p",{className:"text-xs text-gray-600 mb-2 line-clamp-2",children:Re.description}),a.jsxs("div",{className:"flex items-center gap-2 text-gray-500 text-sm mb-2",children:[a.jsx(ra,{})," ",ot(Re.assigned_users_list)]}),a.jsx("div",{className:"h-px bg-gray-200 w-full mb-2"}),a.jsx("div",{className:"text-gray-400 text-xs text-right",children:Re.created_at?new Date(Re.created_at).toLocaleDateString():""})]},Re.id)):a.jsx("div",{className:"col-span-4 text-center py-10 text-gray-500 border border-dashed rounded-xl",children:"No territories found."})}),D==="list"&&a.jsx("div",{className:"bg-white rounded-md shadow-sm overflow-hidden",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-gray-600 text-left",children:a.jsxs("tr",{children:[!["sales","manager"].includes($e.toLowerCase())&&a.jsx("th",{className:"py-3 px-4 w-10",children:a.jsx("input",{type:"checkbox",className:"w-4 h-4 accent-blue-600",checked:(()=>{const Re=he.filter(it=>tt(it));return Re.length===0?!1:Re.every(it=>it.territory_ids&&it.territory_ids.every(St=>Ne.includes(St)))})(),onChange:ne})}),a.jsx("th",{className:"py-3 px-4",children:"Territory"}),a.jsx("th",{className:"py-3 px-4",children:"Assigned To"}),a.jsx("th",{className:"py-3 px-4",children:"Manager"}),!["sales","manager"].includes($e.toLowerCase())&&a.jsx("th",{className:"py-3 px-4 text-center w-24",children:Ne.length>0?a.jsx("button",{onClick:Q,className:`${$e.toLowerCase()==="group_manager"||$e.toLowerCase()==="group manager"?"text-orange-600 hover:text-orange-800 hover:bg-orange-50":"text-red-600 hover:text-red-800 hover:bg-red-50"} transition p-1 rounded-full`,title:`${$e.toLowerCase()==="group_manager"||$e.toLowerCase()==="group manager"?"Archive":"Delete"} ${Ne.length} selected territories`,children:$e.toLowerCase()==="group_manager"||$e.toLowerCase()==="group manager"?a.jsx(Zt,{size:18}):a.jsx(wa,{size:18})}):""})]})}),a.jsx("tbody",{children:He?he.map(Re=>a.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer",children:[!["sales","manager"].includes($e.toLowerCase())&&a.jsx("td",{className:"py-3 px-4",onClick:it=>it.stopPropagation(),children:tt(Re)?a.jsx("input",{type:"checkbox",className:"w-4 h-4 accent-blue-600",checked:Re.territory_ids&&Re.territory_ids.some(it=>Ne.includes(it)),onChange:()=>ae(Re)}):a.jsx("div",{className:"w-4 h-4"})}),a.jsx("td",{className:"py-3 px-4 font-medium",onClick:()=>{u(Re);let it;$e.toLowerCase()==="ceo"||$e.toLowerCase()==="admin"?it="admin":$e.toLowerCase()==="group manager"||$e.toLowerCase()==="group_manager"?it="group-manager":$e.toLowerCase()==="manager"?it="manager":it="sales",e(`/${it}/territory/${Re.id}`)},children:a.jsxs("div",{className:"flex items-center gap-2",children:[Re.name,Re.status==="Inactive"&&a.jsx("span",{className:"bg-red-100 text-red-700 text-xs font-semibold px-2 py-1 rounded",children:"Inactive"})]})}),a.jsx("td",{className:"py-3 px-4",children:ot(Re.assigned_users_list)}),a.jsx("td",{className:"py-3 px-4",children:Re.managed_by?`${Re.managed_by.first_name}`:""}),a.jsx("td",{})]},Re.id)):a.jsx("tr",{children:a.jsx("td",{colSpan:5,className:"text-center py-4 text-gray-500",children:"No territories found."})})})]})}),c&&a.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-xl p-8 relative",children:[a.jsx("button",{className:"absolute top-2 right-4 text-gray-500 hover:text-black",onClick:()=>{u(null);let Re;$e.toLowerCase()==="ceo"||$e.toLowerCase()==="admin"?Re="admin":$e.toLowerCase()==="group manager"||$e.toLowerCase()==="group_manager"?Re="group-manager":$e.toLowerCase()==="manager"?Re="manager":Re="sales",e(`/${Re}/territory`)},children:a.jsx(ea,{size:24})}),a.jsxs("h2",{className:"text-3xl font-semibold mb-1",children:[c.name,c.status==="Inactive"&&a.jsx("span",{className:"ml-3 inline-block bg-red-100 text-red-700 text-sm font-semibold px-3 py-1 rounded",children:"Inactive"})]}),a.jsx("div",{className:"h-px bg-gray-200 w-full mb-4"}),a.jsx("p",{className:"text-gray-500 mb-1",children:"Description"}),a.jsx("p",{className:"text-gray-700 text-sm mb-6",children:c.description||""}),a.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-6 text-sm",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-gray-500",children:"Manager"}),a.jsx("div",{className:"font-medium",children:c.managed_by?`${c.managed_by.first_name} ${c.managed_by.last_name}`:"Unassigned"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-gray-500",children:"Assigned To"}),a.jsx("div",{className:"flex flex-col gap-1 mt-1 max-h-32 overflow-y-auto",children:c.assigned_users_list&&c.assigned_users_list.length>0?c.assigned_users_list.map(Re=>a.jsxs("div",{className:"flex items-center gap-2 text-gray-800 font-medium",children:[a.jsx(ra,{})," ",Re.first_name," ",Re.last_name]},Re.id)):"Unassigned"})]})]}),($e.toLowerCase()==="ceo"||$e.toLowerCase()==="admin"||($e.toLowerCase()==="group_manager"||$e.toLowerCase()==="group manager")&&we&&c?.territory_creator?.id===we.id)&&a.jsxs("div",{className:"flex justify-end gap-2",children:[a.jsxs("button",{onClick:()=>Je(c),className:"bg-blue-500 text-white px-4 py-2 rounded flex items-center gap-2",children:[a.jsx(hn,{})," Edit"]}),a.jsx("button",{onClick:()=>ce(c),className:`${$e.toLowerCase()==="group_manager"||$e.toLowerCase()==="group manager"?"bg-orange-500 hover:bg-orange-600":"bg-red-500 hover:bg-red-600"} text-white px-4 py-2 rounded flex items-center gap-2`,children:$e.toLowerCase()==="group_manager"||$e.toLowerCase()==="group manager"?a.jsxs(a.Fragment,{children:[a.jsx(Zt,{})," Archive"]}):a.jsxs(a.Fragment,{children:[a.jsx(wa,{})," Delete"]})})]})]})}),d&&a.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-lg w-full max-w-xl p-6 relative",children:[a.jsxs("button",{className:"absolute top-4 right-4",onClick:()=>{Ze(),_e(!1)},children:[a.jsx(ea,{size:22})," "]}),a.jsx("h2",{className:"text-xl font-semibold text-center mb-6",children:_?"Edit Territory":"Create Territory"}),a.jsxs("form",{className:"space-y-4",onSubmit:pe,noValidate:!0,children:[a.jsx(Aze,{label:"Territory Name",name:"name",value:w.name,onChange:Fe,required:!0,isSubmitted:Be}),a.jsx(Tze,{label:"Territory Manager",name:"manager_id",value:w.manager_id,onChange:Fe,options:[{value:"",label:"Assign Manager"},...y.map(Re=>({value:String(Re.id),label:`${Re.first_name} ${Re.last_name}`}))],required:!0,isSubmitted:Be}),a.jsx(_ze,{label:a.jsxs(a.Fragment,{children:["Assign Users ",a.jsx("span",{className:"text-red-600 font-semibold",children:"*"})]}),placeholder:"Search and select users...",options:y.map(Re=>({value:String(Re.id),label:`${Re.first_name} ${Re.last_name}`})),selectedValues:w.user_ids,onChange:st,required:!0,isSubmitted:Be}),a.jsx(kze,{label:"Description",name:"description",value:w.description,onChange:Fe}),a.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[a.jsx("button",{type:"button",onClick:()=>{Ze(),_e(!1)},className:"px-4 py-2 bg-red-400 text-white rounded",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:T,className:"px-4 py-2 bg-tertiary text-white rounded",children:T?"Saving...":"Save Territory"})]})]})]})}),D==="list"&&a.jsx(ca,{className:"mt-4",totalItems:me.length,pageSize:se,currentPage:je,onPrev:qe,onNext:nt,onPageSizeChange:Re=>{ye(Re),X(1)},label:"territories"}),B&&a.jsx(Eze,{open:!0,title:B.title,message:B.message,confirmLabel:B.confirmLabel,cancelLabel:B.cancelLabel,variant:B.variant,onConfirm:Pe,onCancel:Te,loading:q})]})})}function Aze({label:e,name:t,value:n,onChange:s,placeholder:r,type:i="text",required:o=!1,disabled:l=!1,isSubmitted:c=!1,className:u=""}){const d=c&&o&&!n?.trim();return a.jsxs("div",{children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",o&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:i,name:t,value:n??"",onChange:s,placeholder:r,required:o,disabled:l,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border focus:ring-2 disabled:bg-gray-100 ${d?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}
${u}
`})]})}function Tze({label:e,name:t,value:n,onChange:s,options:r,disabled:i=!1,required:o=!1,isSubmitted:l=!1}){const c=l&&o&&!n;return a.jsxs("div",{children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",o&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("select",{name:t,value:n??"",onChange:s,disabled:i,className:`w-full border rounded-md px-3 py-2 text-sm bg-white focus:ring-2 outline-none disabled:bg-gray-100 ${c?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-gray-400"}`,children:r.map(u=>a.jsx("option",{value:u.value,children:u.label},u.value))})]})}function kze({label:e,name:t,value:n,onChange:s,placeholder:r,rows:i=3,disabled:o=!1}){return a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsx("textarea",{name:t,value:n??"",onChange:s,placeholder:r,rows:i,disabled:o,className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-gray-400 outline-none disabled:bg-gray-100"})]})}function Eze({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o=!1,onConfirm:l,onCancel:c}){const[u,d]=f.useState(!1);if(!e)return d(!1),null;let h;i==="danger"?h="bg-red-500 hover:bg-red-600 border border-red-400":i==="warning"?h="bg-orange-500 hover:bg-orange-600 border border-orange-400":h="bg-tertiary hover:bg-secondary border border-tertiary";const p=()=>{u||o||(d(!0),l())};return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o||u,children:r}),a.jsx("button",{type:"button",onClick:p,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${h}`,disabled:o||u,children:o?"Processing...":s})]})]})})}const Lze=[{value:"PLANNED",label:"PLANNED"},{value:"HELD",label:"HELD"},{value:"NOT_HELD",label:"NOT HELD"},{value:"INACTIVE",label:"INACTIVE"}],Pze=e=>e?String(e).toUpperCase():"",du=e=>{const t=Pze(e);return t==="PLANNED"||t==="PENDING"?"PLANNED":t==="HELD"||t==="COMPLETED"?"HELD":t==="NOT HELD"||t==="NOT_HELD"||t==="CANCELLED"?"NOT_HELD":t==="INACTIVE"?"INACTIVE":"PLANNED"},AA=e=>{const t=du(e);return t==="PLANNED"?"PLANNED":t==="HELD"?"HELD":t==="NOT_HELD"?"NOT HELD":t==="INACTIVE"?"INACTIVE":"--"},i8=e=>{switch(du(e)){case"PLANNED":return"bg-indigo-100 text-indigo-700";case"HELD":return"bg-green-100 text-green-700";case"NOT_HELD":return"bg-gray-200 text-gray-700";case"INACTIVE":return"bg-gray-200 text-gray-700";default:return"bg-gray-100 text-gray-700"}},o8=e=>e?new Date(e).toLocaleString("en-US",{month:"2-digit",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}):"--";function l8(){const[e,t]=f.useState(!1),[n,s]=f.useState(null),[r,i]=f.useState(null),[o,l]=f.useState(null),[c,u]=f.useState(null),[d,h]=f.useState([]),[p,x]=f.useState(null),[v,j]=f.useState(!1),[y,N]=f.useState(null),[w,S]=f.useState(!1),[_,k]=f.useState(!1),[T,A]=f.useState("PLANNED"),[E,M]=f.useState(!1),[z,P]=f.useState(!1),[D,U]=f.useState(10),[B,R]=f.useState(1),[q,Z]=f.useState([]),[V,oe]=f.useState(null),{comments:je,addComment:X,refresh:se}=kn({relatedType:"call",relatedId:n?.id});f.useEffect(()=>{n?.id&&se()},[n?.id,se]),Bs();const ye=kt(),Ne=ta(),fe=ve=>{if(!ve)return"";const Oe=String(ve).split("-");return Oe.length===3?`${Oe[0]}-${Oe[2]}`:String(ve)},de={subject:"",call_time:(()=>{const ve=new Date,Oe=ve.getFullYear(),Ce=String(ve.getMonth()+1).padStart(2,"0"),Qe=String(ve.getDate()).padStart(2,"0");return`${Oe}-${Ce}-${Qe}T08:00`})(),duration_minutes:"",direction:"Outgoing",status:"Planned",notes:"",relatedType1:"Lead",relatedType2:null,relatedTo1:null,relatedTo2:null,assigned_to:null},[ke,ge]=f.useState(de);f.useEffect(()=>{const ve=Ne.state,Oe=ve?.callID;if(Oe&&!ve?.openCallModal){oe(Oe),ye(Ne.pathname,{replace:!0,state:{}});return}!ve?.openCallModal||!ve?.initialCallData||ve.initialCallData.relatedType1==="Lead"&&Array.isArray(o)&&o.length===0||ve.initialCallData.relatedType1==="Account"&&(!Array.isArray(o)||o.length===0)||(t(!0),ge(Ce=>({...Ce,...ve.initialCallData,relatedTo1:ve.initialCallData.relatedTo1?String(ve.initialCallData.relatedTo1):"",relatedTo2:ve.initialCallData.relatedTo2?String(ve.initialCallData.relatedTo2):""})),ye(Ne.pathname,{replace:!0,state:{}}))},[Ne.state,o]),f.useEffect(()=>{if(V&&d.length>0&&!z){const ve=d.find(Oe=>Oe.id===V);ve?s(ve):H.error("Call not found."),oe(null)}},[V,d,z]);const $e=async()=>{try{P(!0);const ve=await re.get("/calls/admin/fetch-all"),Ce=[...Array.isArray(ve.data)?ve.data:[]].sort((Qe,G)=>{const W=Qe?.created_at?new Date(Qe.created_at):0;return(G?.created_at?new Date(G.created_at):0)-W});h(Ce)}catch(ve){console.error("Error fetching calls:",ve),H.error("Failed to load calls")}finally{P(!1)}},be=async()=>{try{const ve=await re.get("/users/all");x(ve.data)}catch(ve){console.error("Error fetching users: ",ve)}};f.useEffect(()=>{be(),$e()},[]);const[me,Ue]=f.useState(""),[Ee,We]=f.useState("Filter by Status"),[tt,lt]=f.useState("Filter by Users");f.useEffect(()=>{R(1)},[me,Ee,tt,D]);const Fe=f.useMemo(()=>d.filter(ve=>{const Oe=!me||[ve.subject,ve.notes,ve.lead?.title,ve.account?.name,ve.contact?.first_name,ve.contact?.last_name,ve.deal?.name].some(W=>W&&String(W).toLowerCase().includes(me.toLowerCase())),Ce=Ee==="Filter by Status"||du(ve.status)===Ee,Qe=ve.call_assign_to?`${ve.call_assign_to.first_name} ${ve.call_assign_to.last_name}`:"";return Oe&&Ce&&(tt==="Filter by Users"||Qe===tt)}),[d,me,Ee,tt]),st=f.useMemo(()=>{const ve=(B-1)*D;return Fe.slice(ve,ve+D)},[Fe,B,D]),Xe=Array.isArray(p)?p.map(ve=>({id:ve.id,name:`${ve.first_name} ${ve.last_name}`})):[],Ze=()=>R(ve=>Math.max(1,ve-1)),Je=()=>R(ve=>Math.min(ve+1,Math.ceil(Fe.length/D)||1)),Be=ve=>{if(ve.target.checked){const Oe=st.map(Ce=>Ce.id);Z(Oe)}else Z([])},_e=ve=>{Z(Oe=>Oe.includes(ve)?Oe.filter(Ce=>Ce!==ve):[...Oe,ve])},pe=d.length,ce=d.filter(ve=>du(ve.status)==="PLANNED").length,Q=d.filter(ve=>du(ve.status)==="HELD").length,ne=d.filter(ve=>du(ve.status)==="NOT_HELD").length,ae=[{title:"Total",value:pe,icon:Fs,color:"text-slate-600",bgColor:"bg-slate-100"},{title:"Planned",value:ce,icon:zs,color:"text-indigo-600",bgColor:"bg-indigo-100"},{title:"Held",value:Q,icon:Qa,color:"text-green-600",bgColor:"bg-green-100"},{title:"Not Held",value:ne,icon:Us,color:"text-gray-600",bgColor:"bg-gray-100"}],[Pe,Te]=f.useState("Overview"),he=ve=>{const{name:Oe,value:Ce}=ve.target;ge(Qe=>{const G={...Qe,[Oe]:Ce};return Oe==="relatedType1"&&(G.relatedTo1="",Ce==="Lead"?(G.relatedType2=null,G.relatedTo2=null,u([])):Ce==="Account"&&(G.relatedType2="Contact")),Oe==="relatedType2"&&(G.relatedTo2=""),G})};f.useEffect(()=>{const ve=async()=>{try{l([]);let Oe;ke.relatedType1==="Lead"?Oe=await re.get("/leads/admin/getLeads"):ke.relatedType1==="Account"&&(Oe=await re.get("/accounts/admin/fetch-all")),Oe&&Array.isArray(Oe.data)?l(Oe.data):l([])}catch(Oe){console.error("Error fetching data:",Oe),l([])}};ke.relatedType1&&ve()},[ke.relatedType1]),f.useEffect(()=>{const ve=async()=>{try{u([]);let Oe;if(ke.relatedType1==="Account"&&ke.relatedTo1)ke.relatedType2==="Contact"?Oe=await re.get(`/contacts/from-acc/${ke.relatedTo1}`):ke.relatedType2==="Deal"?Oe=await re.get(`/deals/from-acc/${ke.relatedTo1}`):ke.relatedType2==="Quote"&&(Oe=await re.get(`/quotes/from-acc/${ke.relatedTo1}`));else{u([]);return}Oe&&Array.isArray(Oe.data)?u(Oe.data):u([])}catch(Oe){console.error("Error fetching data:",Oe),u([])}};ke.relatedType2&&ve()},[ke.relatedType2,ke.relatedTo1,ke.relatedType1]);const[He,qe]=f.useState(!1),nt=ve=>{ve.preventDefault(),qe(!0);const Oe=ke.subject;if(!Oe||Oe.trim()===""){H.error("Subject is required.");return}if(!ke.relatedTo1){H.error(`Please select a ${ke.relatedType1||"Lead/Account"}.`);return}if(!ke.assigned_to){H.error("Subject is required.");return}const Qe={...ke,duration_minutes:ke.duration_minutes?parseInt(ke.duration_minutes,10):null,relatedTo1:ke.relatedTo1?parseInt(ke.relatedTo1,10):null,relatedTo2:ke.relatedType1==="Lead"?null:ke.relatedTo2?parseInt(ke.relatedTo2,10):null,relatedType2:ke.relatedType1==="Lead"?null:ke.relatedType2,assigned_to:ke.assigned_to?parseInt(ke.assigned_to,10):null},G=v&&y?"update":"create",W=(ke.subject||"").trim()||"Untitled Call";i({title:G==="create"?"Confirm New Call":"Confirm Update",message:G==="create"?`Create "${W}"?`:`Save changes to "${W}"?`,confirmLabel:G==="create"?"Create Call":"Update Call",cancelLabel:"Cancel",variant:"primary",action:{type:G,payload:Qe,targetId:y||null,name:W}})},ot=ve=>s(ve),Re=()=>{t(!1),j(!1),N(null)},it=async()=>{q.length!==0&&i({title:"Delete Calls",message:a.jsxs("span",{children:["Are you sure you want to delete"," ",a.jsx("span",{className:"font-semibold",children:q.length})," selected calls? This action cannot be undone."]}),confirmLabel:`Delete ${q.length} Call(s)`,cancelLabel:"Cancel",variant:"danger",action:{type:"bulk-delete",call_ids:q}})},St=async()=>{if(!r?.action){i(null);return}const{action:ve}=r,{type:Oe,payload:Ce,targetId:Qe,name:G}=ve;k(!0);try{if(Oe==="create")S(!0),await re.post("/calls/create",Ce),H.success(`Call "${G}" created successfully.`),t(!1),ge(de),j(!1),N(null),await $e();else if(Oe==="update"){if(!Qe)throw new Error("Missing call identifier for update.");S(!0),await re.put(`/calls/${Qe}`,Ce),H.success(`Call "${G}" updated successfully.`),t(!1),ge(de),j(!1),N(null),await $e()}else if(Oe==="delete"){if(!Qe)throw new Error("Missing call identifier for deletion.");await re.delete(`/calls/${Qe}`),H.success(`Call "${G}" deleted successfully.`),n?.id===Qe&&s(null),await $e()}else Oe==="bulk-delete"&&(await re.delete("/calls/admin/bulk-delete",{data:{call_ids:q}}),H.success(`Successfully deleted ${q.length} calls`),Z([]),await $e())}catch(W){const J=Oe==="create"?"Failed to create call. Please review the details and try again.":Oe==="update"?"Failed to update call. Please review the details and try again.":"Failed to delete call. Please try again.",Y=W?.response?.data?.detail||J;H.error(Y)}finally{(Oe==="create"||Oe==="update")&&S(!1),k(!1),i(null)}},Et=()=>{_||i(null)},Tt=async()=>{if(n?.id)try{M(!0),await re.put(`/calls/${n.id}`,{status:T}),H.success(`Status updated to ${AA(T)}`),h(ve=>Array.isArray(ve)?ve.map(Oe=>Oe.id===n.id?{...Oe,status:T}:Oe):ve),s(null)}catch(ve){const Oe=ve.response?.data?.detail||"Failed to update status.";H.error(Oe)}finally{M(!1)}};f.useEffect(()=>{n&&A(du(n.status))},[n]);const Nt=n?a.jsxs("div",{id:"callModalBackdrop",onClick:ve=>ve.target.id==="callModalBackdrop"&&s(null),className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center p-4",children:[z&&a.jsx(Wt,{message:"Loading call details..."}),a.jsxs("div",{className:"bg-white rounded-xl shadow-lg w-full max-w-full lg:max-w-4xl max-h-[95vh] overflow-y-auto hide-scrollbar relative box-border",children:[a.jsxs("div",{className:"bg-tertiary w-full rounded-t-xl p-3 lg:p-3 relative",children:[a.jsx("h1",{className:"lg:text-3xl text-xl text-white font-semibold text-center w-full",children:"Calls"}),a.jsx("button",{onClick:()=>s(null),className:"text-gray-500 hover:text-white transition cursor-pointer absolute top-3 right-3",children:a.jsx(Ja,{size:25})})]}),a.jsx("div",{className:"mt-4 gap-2 px-2 lg:gap-4 lg:mx-7",children:a.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between lg:flex-row lg:items-center lg:justify-between mt-3 gap-2 px-2 md:items-center lg:gap-4 md:mx-7 lg:mx-7",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[a.jsx("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-800",children:n.subject}),a.jsx("span",{className:`text-xs sm:text-sm font-medium px-2 sm:px-3 py-1 rounded-full ${i8(n.status)}`,children:AA(n.status)})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsxs("button",{className:"inline-flex items-center justify-center w-full sm:w-auto bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 transition text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",onClick:()=>{const ve=W=>{if(!W)return"";const J=new Date(W),Y=J.getFullYear(),F=String(J.getMonth()+1).padStart(2,"0"),ue=String(J.getDate()).padStart(2,"0"),De=String(J.getHours()).padStart(2,"0"),le=String(J.getMinutes()).padStart(2,"0");return`${Y}-${F}-${ue}T${De}:${le}`},Oe=n.lead?"Lead":n.account?"Account":"Lead",Ce=n.lead?n.lead.id:n.account?n.account.id:null,Qe=Oe==="Lead"?null:n.contact?"Contact":n.deal?"Deal":n.quote?"Quote":"Contact",G=Oe==="Lead"?null:n.contact?n.contact.id:n.deal?n.deal.id:n.quote?n.quote.id:null;ge({subject:n.subject||"",call_time:ve(n.call_time),duration_minutes:n.duration_minutes?String(n.duration_minutes):"",direction:n.direction||"Outgoing",status:n.status||"Planned",notes:n.notes||"",relatedType1:Oe,relatedType2:Qe,relatedTo1:Ce?String(Ce):"",relatedTo2:G?String(G):"",assigned_to:n.call_assign_to?.id?String(n.call_assign_to.id):""}),j(!0),N(n.id),s(null),t(!0)},children:[a.jsx(gn,{className:"mr-2"}),"Edit"]}),a.jsxs("button",{className:"inline-flex items-center justify-center w-full sm:w-auto px-4 py-2 rounded-md text-sm bg-red-500 text-white hover:bg-red-600 transition focus:outline-none focus:ring-2 focus:ring-red-400",onClick:()=>{const ve=n.subject||"this call";i({title:"Delete Call",message:`Are you sure you want to permanently delete "${ve}"? This action cannot be undone.`,confirmLabel:"Delete Call",cancelLabel:"Cancel",variant:"danger",action:{type:"delete",targetId:n.id,name:ve}})},children:[a.jsx(wa,{className:"mr-2"}),"Delete"]})]})]})}),a.jsx("div",{className:"border-b border-gray-200 my-5"}),a.jsxs("div",{className:"p-6 lg:p-4",children:[a.jsx("div",{className:"flex w-full bg-[#6A727D] text-white mt-1 overflow-x-auto mb-6",children:["Overview","Notes"].map(ve=>a.jsx("button",{onClick:()=>Te(ve),className:`flex-1 min-w-[90px] px-4 py-2.5 text-xs sm:text-sm font-medium border-b-2 ${Pe===ve?"bg-paper-white text-[#6A727D] border-white":"text-white hover:bg-[#5c636d]"}`,children:ve},ve))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 items-start",children:[a.jsxs("div",{className:"lg:col-span-3",children:[Pe==="Overview"&&a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 md:p-8 border border-gray-200",children:a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4 sm:gap-6 text-sm text-gray-700",children:[a.jsx(go,{label:"Call Time",value:o8(n.call_time)}),a.jsx(go,{label:"Duration",value:n.duration_minutes?`${n.duration_minutes} min`:null}),a.jsx(go,{label:"Direction",value:n.direction||"--"}),a.jsx(go,{label:"Assigned To",value:`${n.call_assign_to.first_name} ${n.call_assign_to.last_name}`}),n.lead&&a.jsx(go,{label:"Lead",value:n.lead.title}),n.account&&a.jsx(go,{label:"Account",value:n.account.name}),n.contact&&a.jsx(go,{label:"Contact",value:`${n.contact.first_name} ${n.contact.last_name}`}),n.deal&&a.jsx(go,{label:"Deal",value:n.deal.name}),n.quote&&a.jsx(go,{label:"Quote",value:fe(n.quote.quote_id)}),a.jsx(go,{label:"Created At",value:o8(n.created_at)})]})}),Pe==="Notes"&&a.jsxs("div",{className:"mt-4 w-full",children:[a.jsx("div",{className:"flex flex-wrap items-center justify-between mb-4 gap-2",children:a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words",children:"Call Note"})}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 shadow-sm break-words",children:[a.jsx("div",{className:"flex items-start justify-between",children:a.jsx("div",{children:a.jsx("p",{className:"text-sm font-medium text-gray-800 break-words",children:"Note"})})}),a.jsx("div",{className:"mt-3 text-sm text-gray-700 whitespace-pre-wrap break-words",children:n.notes||"No notes available."})]}),a.jsx(Tn,{comments:je,onAddComment:X})]})]}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm w-full",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Status"}),a.jsxs("select",{className:"border border-gray-200 rounded-md px-2 py-1.5 w-full text-sm mb-2",value:T,onChange:ve=>A(ve.target.value),children:[a.jsx("option",{value:"PLANNED",children:"PLANNED"}),a.jsx("option",{value:"HELD",children:"HELD"}),a.jsx("option",{value:"NOT_HELD",children:"NOT HELD"})]}),a.jsx("button",{onClick:Tt,disabled:E,className:"w-full py-1.5 rounded-md text-sm bg-gray-900 text-white hover:bg-gray-800 disabled:opacity-50",children:E?"Updating...":"Update"})]})]})]})]})]}):null,xe=e?a.jsx("div",{id:"modalBackdrop",onClick:ve=>ve.target.id==="modalBackdrop"&&Re(),className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-xl rounded-2xl shadow-lg p-4 sm:p-6 md:p-8 relative border border-gray-200 overflow-y-auto max-h-[90vh] hide-scrollbar",children:[a.jsx("button",{onClick:()=>{Re(),qe(!1)},className:"absolute top-4 right-4 text-gray-500 hover:text-black transition",children:a.jsx(ea,{size:22})}),a.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800 mb-4 sm:mb-6 flex items-center justify-center",children:v?"Edit Call":"Add New Call"}),a.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 w-full gap-4 text-sm",onSubmit:nt,noValidate:!0,children:[a.jsx(Oze,{label:"Subject",className:"md:col-span-2",name:"subject",value:ke.subject,onChange:he,isSubmitted:He,required:!0}),a.jsxs("div",{className:"w-full flex flex-col",children:[a.jsxs("div",{className:"relative w-25",children:[a.jsxs("select",{name:"relatedType1",onChange:he,value:ke.relatedType1,className:"outline-none cursor-pointer mb-1 w-22 text-gray-700 disabled:text-gray-400 disabled:cursor-not-allowed",disabled:w||v,children:[a.jsx("option",{value:"Lead",children:"Lead"}),a.jsx("option",{value:"Account",children:"Account"})]}),a.jsx("span",{className:"absolute left-10 md:pl-6 pl-6 top-1/2 -translate-y-1/2 text-red-500 pointer-events-none",children:"*"})]}),a.jsx(TA,{items:Array.isArray(o)?o:[],value:ke.relatedTo1??"",placeholder:`Search ${ke.relatedType1||"here"}...`,getLabel:ve=>ke.relatedType1==="Lead"?ve.title:ve.name??"",onChange:ve=>ge(Oe=>({...Oe,relatedTo1:ve})),required:!0,isSubmitted:He,disabled:w||v})]}),a.jsxs("div",{className:"w-full flex flex-col",children:[a.jsxs("select",{name:"relatedType2",onChange:he,value:ke.relatedType2??"Contact",className:"text-gray-700 outline-none cursor-pointer mb-1 w-22 disabled:text-gray-400 disabled:cursor-not-allowed",disabled:ke.relatedType1==="Lead"||w||v,children:[a.jsx("option",{value:"Contact",children:"Contact"}),a.jsx("option",{value:"Deal",children:"Deal"}),a.jsx("option",{value:"Quote",children:"Quote"})]}),a.jsx(TA,{disabled:ke.relatedType1==="Lead"||w||v,items:Array.isArray(c)?c:[],value:ke.relatedTo2??"",placeholder:ke.relatedType1==="Lead"?"":Array.isArray(c)&&c.length>0?`Search ${ke.relatedType2||"Contact"}...`:`No ${ke.relatedType2||""} data found`,getLabel:ve=>ke.relatedType2==="Contact"?`${ve.first_name??""} ${ve.last_name??""}`.trim():ke.relatedType2==="Quote"?fe(ve.quote_id)??"":ve.name??"",onChange:ve=>ge(Oe=>({...Oe,relatedTo2:ve}))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Call Time"}),a.jsx("input",{type:"datetime-local",value:ke.call_time,onChange:he,name:"call_time",className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100"})]}),a.jsxs("div",{className:"w-full",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Duration"}),a.jsxs("div",{className:"w-full rounded-md text-sm flex flex-row items-center justify-start",children:[a.jsx("input",{type:"tel",value:ke.duration_minutes,onChange:he,name:"duration_minutes",className:"border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100 w-44 mr-3"}),a.jsx("p",{children:"minutes"})]})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[" ","Assign To ",a.jsx("span",{className:"text-red-600 font-semibold",children:"*"})]}),a.jsx(TA,{items:Array.isArray(p)?p:[],value:ke.assigned_to??"",placeholder:"Search an account...",getLabel:ve=>`${ve.first_name} ${ve.last_name}`,onChange:ve=>ge(Oe=>({...Oe,assigned_to:ve})),required:!0,isSubmitted:He})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Direction"}),a.jsxs("select",{name:"direction",onChange:he,value:ke.direction,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100",children:[a.jsx("option",{value:"Incoming",children:"Incoming"}),a.jsx("option",{value:"Outgoing",children:"Outgoing"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Status"}),a.jsxs("select",{name:"status",onChange:he,value:ke.status,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100",children:[a.jsx("option",{value:"Planned",children:"Planned"}),a.jsx("option",{value:"Held",children:"Held"}),a.jsx("option",{value:"Not held",children:"Not held"})]})]}),a.jsx(Mze,{className:"col-span-2",label:"Notes",value:ke.notes,onChange:he,name:"notes"}),a.jsxs("div",{className:"flex flex-col md:flex-row justify-end col-span-2 mt-4 gap-2 w-full",children:[a.jsx("button",{type:"button",onClick:()=>{Re(),qe(!1)},className:"w-full sm:w-auto px-4 py-2 text-white bg-red-400 border border-red-300 rounded hover:bg-red-500 transition",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:w,className:"w-full sm:w-auto px-4 py-2 text-white bg-tertiary border border-tertiary rounded hover:bg-secondary transition",children:w?"Saving...":v?"Update Call":"Save Call"})]})]})]})}):null;return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h1",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(Fs,{className:"mr-2 text-blue-600"})," Calls"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto gap-2",children:a.jsxs("button",{onClick:()=>{ge(de),j(!1),N(null),t(!0),qe(!1)},className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 my-1 lg:my-0 rounded-md hover:bg-gray-800 text-sm sm:text-base mx-auto sm:ml-auto cursor-pointer",children:[a.jsx(aa,{className:"mr-2"})," Add Call"]})})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-4 mb-6 w-full break-words overflow-hidden lg:overflow-visible",children:ae.map(ve=>a.jsx(Dze,{...ve},ve.title))}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center gap-3",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search calls",className:"focus:outline-none text-base w-full",value:me,onChange:ve=>Ue(ve.target.value)})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row w-full lg:w-1/2 gap-2",children:[a.jsxs("select",{value:Ee,onChange:ve=>We(ve.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm bg-white w-full",children:[a.jsx("option",{value:"Filter by Status",children:"Filter by Status"}),Lze.map(ve=>a.jsx("option",{value:ve.value,children:ve.label},ve.value))]}),a.jsxs("select",{value:tt,onChange:ve=>lt(ve.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm bg-white w-full",children:[a.jsx("option",{value:"Filter by Users",children:"Filter by Users"}),Xe.map(ve=>a.jsx("option",{value:ve.name,children:ve.name},ve.id))]})]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[500px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm mb-4",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 w-12",children:a.jsx("input",{type:"checkbox",checked:st.length>0&&q.length===st.length,onChange:Be,className:"cursor-pointer"})}),a.jsx("th",{className:"py-3 px-4",children:"Subject"}),a.jsx("th",{className:"py-3 px-4",children:"Related To"}),a.jsx("th",{className:"py-3 px-4",children:"Call Time"}),a.jsx("th",{className:"py-3 px-4",children:"Assigned To"}),a.jsx("th",{className:"py-3 px-4",children:"Status"}),a.jsx("th",{className:"py-3 px-4 text-center w-24",children:q.length>0?a.jsx("button",{onClick:it,className:"text-red-600 hover:text-red-800 transition p-1 rounded-full hover:bg-red-50",title:`Delete ${q.length} selected calls`,children:a.jsx(wa,{size:18})}):""})]})}),a.jsx("tbody",{children:z?a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"py-10",children:a.jsx(Wt,{message:"Loading calls..."})})}):st.length>0?st.map(ve=>a.jsxs("tr",{onClick:()=>ot(ve),className:"hover:bg-gray-50 cursor-pointer border-b border-gray-100",children:[a.jsx("td",{className:"py-3 px-4 align-top w-12",onClick:Oe=>Oe.stopPropagation(),children:a.jsx("input",{type:"checkbox",checked:q.includes(ve.id),onChange:()=>_e(ve.id),className:"cursor-pointer"})}),a.jsx("td",{className:"py-3 px-4 text-blue-600 font-medium",children:ve.subject||"--"}),a.jsxs("td",{className:"py-3 px-4",children:[ve.lead&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:ve.lead.title}),ve.account&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:ve.account.name}),ve.contact&&a.jsxs("p",{className:"font-medium text-blue-500 text-xs",children:[ve.contact.first_name," ",ve.contact.last_name]}),ve.deal&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:ve.deal.name}),ve.quote&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:fe(ve.quote.quote_id)})]}),a.jsx("td",{className:"py-3 px-4 text-gray-800",children:ve.call_time?new Date(ve.call_time).toLocaleString():"--"}),a.jsx("td",{className:"py-3 px-4 text-gray-800",children:ve?.call_assign_to?`${ve.call_assign_to.first_name} ${ve.call_assign_to.last_name}`:"--"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${i8(ve.status)}`,children:AA(ve.status)})}),a.jsx("td",{className:"py-3 px-4"})]},ve.id)):a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"text-center py-4 text-gray-500",children:"No calls found."})})})]})}),a.jsx(ca,{totalItems:Fe.length,pageSize:D,currentPage:B,onPrev:Ze,onNext:Je,onPageSizeChange:ve=>{U(ve),R(1)},pageSizeOptions:[10,20,30,40,50],label:"calls"})]}),Nt,xe,r&&a.jsx(Ize,{open:!0,title:r.title,message:r.message,confirmLabel:r.confirmLabel,cancelLabel:r.cancelLabel,variant:r.variant,onConfirm:St,onCancel:Et,loading:_})]})}function Dze({icon:e,title:t,value:n,color:s,bgColor:r}){return a.jsxs("div",{className:"flex items-center p-4 bg-white rounded-xl shadow-md border border-gray-200 transition-all duration-300",children:[a.jsx("div",{className:`p-3 rounded-full ${r} ${s} mr-4`,children:a.jsx(e,{size:22})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:t}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:n})]})]})}function Oze({label:e,name:t,value:n,onChange:s,placeholder:r="",type:i="text",required:o=!1,disabled:l=!1,isSubmitted:c=!1,className:u=""}){const d=c&&o&&!n;return a.jsxs("div",{className:u,children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",o&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:i,name:t,value:n??"",onChange:s,placeholder:r,disabled:l,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border focus:ring-2 disabled:bg-gray-100
          ${d?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}
        `})]})}function Mze(e){return a.jsxs("div",{className:e.className,children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e.label}),a.jsx("textarea",{...e,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100 resize-none"})]})}function go({label:e,value:t}){return a.jsxs("p",{children:[a.jsxs("span",{className:"font-semibold",children:[e,":"]})," ",a.jsx("br",{}),a.jsx("span",{className:"break-words",children:t||"--"})]})}function Ize({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o=!1,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsx("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${u}`,disabled:o,children:o?"Processing...":s})]})]})})}function TA({items:e=[],value:t="",onChange:n,getLabel:s,placeholder:r="Search...",disabled:i=!1,maxRender:o=200,required:l=!1,isSubmitted:c=!1}){const[u,d]=f.useState(!1),[h,p]=f.useState(""),x=f.useRef(null),v=e.find(w=>String(w.id)===String(t)),j=v?s(v):"",y=l&&c&&!t,N=f.useMemo(()=>{const w=h.trim().toLowerCase();return(w?e.filter(_=>(s(_)||"").toLowerCase().includes(w)):e).slice(0,o)},[e,h,s,o]);return f.useEffect(()=>{const w=S=>{x.current&&!x.current.contains(S.target)&&d(!1)};return document.addEventListener("mousedown",w),()=>document.removeEventListener("mousedown",w)},[]),f.useEffect(()=>{u||p("")},[u]),a.jsxs("div",{ref:x,className:"relative w-full",children:[a.jsx("input",{disabled:i,value:u?h:j,placeholder:r,onFocus:()=>!i&&d(!0),onChange:w=>{p(w.target.value),u||d(!0)},className:`w-full border rounded-md px-2 py-1.5 text-sm outline-none focus:ring-2 disabled:bg-gray-100
          ${y?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}`}),u&&!i&&a.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg overflow-hidden",children:[a.jsx("div",{className:"max-h-56 overflow-y-auto",children:N.length>0?N.map(w=>{const S=String(w.id),_=s(w),k=String(t)===S;return a.jsx("button",{type:"button",onClick:()=>{n(S),d(!1)},className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-50 ${k?"bg-blue-50":""}`,children:_||"--"},S)}):a.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No results"})}),e.length>o&&a.jsxs("div",{className:"px-3 py-2 text-[11px] text-gray-400 border-t",children:["Showing first ",o," results  keep typing to narrow."]})]})]})}const k1=({onClose:e,formData:t,setFormData:n,isEditing:s=!1,onSubmit:r,isSubmitting:i=!1,users:o=[]})=>{const c=(()=>{const A=new Date,E=A.getFullYear(),M=String(A.getMonth()+1).padStart(2,"0"),z=String(A.getDate()).padStart(2,"0");return{startTime:`${E}-${M}-${z}T08:00`,endTime:`${E}-${M}-${z}T09:00`}})(),[u,d]=f.useState({subject:"",startTime:c.startTime,endTime:c.endTime,location:"",status:"Planned",notes:"",assignedTo:"",relatedType1:"Lead",relatedTo1:"",relatedType2:"Contact",relatedTo2:""}),[h,p]=f.useState([]),[x,v]=f.useState([]);f.useEffect(()=>{t!==void 0&&n&&(!t.startTime||!t.endTime)&&n(A=>({...A,startTime:A.startTime||c.startTime,endTime:A.endTime||c.endTime}))},[]);const j=A=>{if(!A)return"";const E=String(A).split("-");return E.length===3?`${E[0]}-${E[2]}`:String(A)},y=t!==void 0?t:u,N=n||d,{userRole:w}=Ks();f.useEffect(()=>{const A=async()=>{try{p([]);let E;y.relatedType1==="Lead"?E=await re.get("/leads/admin/getLeads"):y.relatedType1==="Account"&&(E=await re.get("/accounts/admin/fetch-all"));let M=[];if(E&&Array.isArray(E.data)&&(M=E.data),s&&y.relatedTo1)try{let z;y.relatedType1==="Lead"?z=await re.get(`/leads/get/${y.relatedTo1}`):y.relatedType1==="Account"&&(z=await re.get(`/accounts/get/${y.relatedTo1}`)),z&&z.data&&(M.some(D=>String(D.id)===String(y.relatedTo1))||(M=[z.data,...M]))}catch(z){console.error("Error fetching specific related item:",z)}p(M)}catch(E){console.error("Error fetching relatedTo1 data:",E),p([])}};y.relatedType1&&A()},[y.relatedType1,w,s,y.relatedTo1]),f.useEffect(()=>{const A=async()=>{try{if(v([]),y.relatedType1==="Account"&&y.relatedTo1){let E;y.relatedType2==="Contact"?E=await re.get(`/contacts/from-acc/${y.relatedTo1}`):y.relatedType2==="Deal"?E=await re.get(`/deals/from-acc/${y.relatedTo1}`):y.relatedType2==="Quote"&&(E=await re.get(`/quotes/from-acc/${y.relatedTo1}`)),E&&Array.isArray(E.data)?v(E.data):v([])}else v([])}catch(E){console.error("Error fetching relatedTo2 data:",E),v([])}};y.relatedType2&&A()},[y.relatedType2,y.relatedTo1,y.relatedType1]);const S=A=>{const{name:E,value:M}=A.target;N(z=>{const P={...z,[E]:M};return E==="relatedType1"&&(z.relatedType1!==M&&(P.relatedTo1=""),M==="Lead"?(P.relatedType2=null,P.relatedTo2=null,v([])):M==="Account"&&(P.relatedType2="Contact",P.relatedTo2="")),E==="relatedType2"&&z.relatedType2!==M&&(P.relatedTo2=""),P})},[_,k]=f.useState(!1),T=A=>{if(A.preventDefault(),k(!0),y.status==="--"){H.warn("Please select a valid status.");return}const E=y.subject;if(!E||E.trim()===""){H.error("Subject is required.");return}if(!y.assignedTo){H.error("Assigned To is required.");return}if(!y.relatedTo1){H.error(`Please select a ${y.relatedType1||"Lead/Account"}.`);return}r?r(y):e()};return a.jsx("div",{id:"modalBackdrop",onClick:A=>A.target.id==="modalBackdrop"&&e(),className:"fixed inset-0 bg-black/40 flex items-center justify-center z-60 p-2 sm:p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-full sm:max-w-3xl rounded-2xl shadow-lg p-3 sm:p-6 md:p-8 relative border border-gray-200 overflow-y-auto max-h-[90vh] hide-scrollbar",children:[a.jsx("button",{onClick:e,className:"absolute top-3 right-3 sm:top-4 sm:right-4 text-gray-500 hover:text-black transition",children:a.jsx(ea,{size:22})}),a.jsx("h2",{className:"text-lg sm:text-2xl font-semibold text-gray-800 mb-4 sm:mb-6 text-center",children:s?"Edit Meeting":"Schedule Meeting"}),a.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 sm:gap-4 text-sm",onSubmit:T,noValidate:!0,children:[a.jsx(jb,{label:"Subject",name:"subject",value:y.subject,onChange:S,placeholder:"e.g. Meeting with Client",required:!0,isSubmitted:_,className:"md:col-span-2"}),a.jsxs("div",{className:"flex flex-col w-full",children:[a.jsxs("div",{className:"relative w-25",children:[a.jsxs("select",{name:"relatedType1",onChange:S,value:y.relatedType1||"Lead",className:"w-full outline-none cursor-pointer mb-1 rounded text-gray-700 disabled:text-gray-400",disabled:i,children:[a.jsx("option",{value:"Lead",children:"Lead"}),a.jsx("option",{value:"Account",children:"Account"})]}),a.jsx("span",{className:"absolute left-10 md:pl-8 pl-8 top-1/2 -translate-y-1/2 text-red-500 pointer-events-none",children:"*"})]}),a.jsx(kA,{items:Array.isArray(h)?h:[],disabled:i,value:y.relatedTo1??"",placeholder:`Search ${y.relatedType1||"here"}...`,getLabel:A=>y.relatedType1==="Lead"?A.title:A.name??"",onChange:A=>N(E=>({...E,relatedTo1:A})),required:!0,isSubmitted:_})]}),a.jsxs("div",{className:"flex flex-col w-full",children:[a.jsx("div",{className:"relative w-25",children:a.jsxs("select",{name:"relatedType2",onChange:S,value:y.relatedType2||"Contact",className:"w-full outline-none cursor-pointer mb-1 rounded text-gray-700 disabled:text-gray-400 disabled:cursor-not-allowed",disabled:i||y.relatedType1==="Lead",children:[a.jsx("option",{value:"Contact",children:"Contact"}),a.jsx("option",{value:"Deal",children:"Deal"}),a.jsx("option",{value:"Quote",children:"Quote"})]})}),a.jsx(kA,{items:Array.isArray(x)?x:[],value:y.relatedTo2??"",placeholder:y.relatedType1==="Lead"?"":x?.length?`Search ${y.relatedType2}...`:`No ${y.relatedType2} data found`,getLabel:A=>y.relatedType2==="Contact"?`${A.first_name??""} ${A.last_name??""}`.trim():y.relatedType2==="Quote"?j(A.quote_id)??"":A.name??"",onChange:A=>N(E=>({...E,relatedTo2:A})),disabled:y.relatedType1==="Lead"})]}),a.jsx(jb,{label:"Location",name:"location",className:"md:col-span-2",value:y.location,onChange:S,disabled:i}),a.jsxs("div",{className:"md:col-span-2 grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[a.jsx(jb,{label:"Start Time",name:"startTime",type:"datetime-local",value:y.startTime,onChange:S,disabled:i}),a.jsx(jb,{label:"End Time",name:"endTime",type:"datetime-local",value:y.endTime,onChange:S,disabled:i})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:["Assign To ",a.jsx("span",{className:"text-red-600 font-semibold",children:"*"})]}),a.jsx(kA,{items:Array.isArray(o)?o:[],value:y.assignedTo??"",placeholder:"Search an account...",getLabel:A=>`${A.first_name} ${A.last_name}`,onChange:A=>N(E=>({...E,assignedTo:A})),disabled:w==="Sales",required:!0,isSubmitted:_})]}),a.jsx($ze,{label:"Status",name:"status",value:y.status,onChange:S,options:["--","Planned","Held","Not held"].map(A=>({value:A,label:A.replace("_"," ")})),disabled:i}),a.jsx(Rze,{label:"Notes",name:"notes",value:y.notes,onChange:S,rows:3,className:"md:col-span-2",disabled:i}),a.jsxs("div",{className:"md:col-span-2 flex flex-col sm:flex-row justify-end gap-2 mt-4",children:[a.jsx("button",{type:"button",onClick:e,className:"w-full sm:w-auto px-4 py-2 text-white bg-red-400 border border-red-300 rounded hover:bg-red-500 transition disabled:opacity-70",disabled:i,children:"Cancel"}),a.jsx("button",{type:"submit",className:"w-full sm:w-auto px-4 py-2 text-white border border-tertiary bg-tertiary rounded hover:bg-secondary transition disabled:opacity-70",disabled:i,children:i?"Saving...":s?"Update Meeting":"Save Meeting"})]})]})]})})};function jb({label:e,name:t,value:n,onChange:s,placeholder:r,type:i="text",required:o=!1,disabled:l=!1,className:c="",isSubmitted:u=!1}){const d=u&&!n?.trim();return a.jsxs("div",{className:c,children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",o&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:i,name:t,value:n??"",onChange:s,placeholder:r,required:o,disabled:l,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border focus:ring-2 outline-none disabled:bg-gray-100
          ${d?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}
          ${c}
        `})]})}function $ze({label:e,name:t,value:n,onChange:s,options:r,required:i=!1,disabled:o=!1,className:l="",isSubmitted:c=!1}){const u=c&&i&&!n;return a.jsxs("div",{className:l,children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",i&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("select",{name:t,value:n??"",onChange:s,required:i,disabled:o,hasError:u,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100",children:r.map(d=>a.jsx("option",{value:d.value,children:d.label},d.value))})]})}function Rze({label:e,name:t,value:n,onChange:s,placeholder:r,required:i=!1,disabled:o=!1,className:l="",rows:c=3}){return a.jsxs("div",{className:l,children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsx("textarea",{name:t,value:n??"",onChange:s,placeholder:r,required:i,disabled:o,rows:c,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100 resize-none"})]})}function kA({items:e=[],value:t="",onChange:n,getLabel:s,placeholder:r="Search...",disabled:i=!1,maxRender:o=200,required:l=!1,isSubmitted:c=!1}){const[u,d]=f.useState(!1),[h,p]=f.useState(""),x=f.useRef(null),v=e.find(w=>String(w.id)===String(t)),j=v?s(v):"",y=l&&c&&!t,N=f.useMemo(()=>{const w=h.trim().toLowerCase();return(w?e.filter(_=>(s(_)||"").toLowerCase().includes(w)):e).slice(0,o)},[e,h,s,o]);return f.useEffect(()=>{const w=S=>{x.current&&!x.current.contains(S.target)&&d(!1)};return document.addEventListener("mousedown",w),()=>document.removeEventListener("mousedown",w)},[]),f.useEffect(()=>{u||p("")},[u]),a.jsxs("div",{ref:x,className:"relative w-full",children:[a.jsx("input",{disabled:i,value:u?h:j,placeholder:r,onFocus:()=>!i&&d(!0),onChange:w=>{p(w.target.value),u||d(!0)},className:`w-full border rounded-md px-2 py-1.5 text-sm outline-none focus:ring-2 disabled:bg-gray-100
          ${y?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}`}),u&&!i&&a.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg overflow-hidden",children:[a.jsx("div",{className:"max-h-56 overflow-y-auto",children:N.length>0?N.map(w=>{const S=String(w.id),_=s(w),k=String(t)===S;return a.jsx("button",{type:"button",onClick:()=>{n(S),d(!1)},className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-50 ${k?"bg-blue-50":""}`,children:_||"--"},S)}):a.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No results"})}),e.length>o&&a.jsxs("div",{className:"px-3 py-2 text-[11px] text-gray-400 border-t",children:["Showing first ",o," results  keep typing to narrow."]})]})]})}const Nd=({meeting:e,onClose:t,onEdit:n,onDelete:s,onStatusUpdate:r,currentUser:i,isSalesView:o=!1})=>{kt();const[l,c]=f.useState("Overview");f.useEffect(()=>{console.log("AdminMeetingInformation - checking permissions:"),console.log("meeting.created_by:",e?.created_by),console.log("currentUser?.id:",i?.id),console.log("Match:",e?.created_by===i?.id)},[e,i]);const u=_=>{if(!_)return"";const k=String(_).split("-");return k.length===3?`${k[0]}-${k[2]}`:String(_)},d=_=>{const k=(_||"").toUpperCase();return k==="PLANNED"||k==="IN PROGRESS"?"PLANNED":k==="HELD"||k==="DONE"?"HELD":k==="NOT HELD"?"NOT_HELD":"PLANNED"},h=_=>{const k=(_||"").toUpperCase();return k==="PLANNED"?"PLANNED":k==="HELD"?"HELD":k==="NOT HELD"||k==="NOT_HELD"?"NOT HELD":"PENDING"},[p,x]=f.useState(d(e?.status||"PENDING")),[v,j]=f.useState(!1),{comments:y,addComment:N,refresh:w}=kn({relatedType:"meeting",relatedId:e?.id});if(f.useEffect(()=>{e?.id&&w()},[e?.id,w]),!e)return null;const S=_=>{const k=(_||"").toUpperCase(),T=k==="PLANNED"?"PENDING":k==="HELD"?"COMPLETED":k==="NOT_HELD"?"CANCELLED":k;switch(k){case"PENDING":return"bg-indigo-100 text-indigo-700";case"COMPLETED":case"DONE":return"bg-green-100 text-green-700";case"CANCELLED":return"bg-gray-200 text-gray-700";case"IN PROGRESS":return"bg-blue-100 text-blue-700";default:switch(T){case"PENDING":return"bg-indigo-100 text-indigo-700";case"COMPLETED":return"bg-green-100 text-green-700";case"CANCELLED":return"bg-gray-200 text-gray-700";default:return"bg-gray-100 text-gray-700"}}};return a.jsx(a.Fragment,{children:a.jsx("div",{className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-lg w-full max-w-full lg:max-w-4xl max-h-[95vh] overflow-y-auto hide-scrollbar relative box-border",children:[a.jsxs("div",{className:"bg-tertiary w-full rounded-t-xl p-3 lg:p-3 relative",children:[a.jsx("h1",{className:"lg:text-3xl text-xl text-white font-semibold text-center w-full",children:"Meeting"}),a.jsx("button",{onClick:t,className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-white cursor-pointer",children:a.jsx(Ja,{size:25})})]}),a.jsx("div",{className:"mt-4 gap-2 px-2 lg:gap-4 lg:mx-7",children:a.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between lg:flex-row lg:items-center lg:justify-between mt-3 gap-2 px-2 md:items-center lg:gap-4 md:mx-7",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[a.jsx("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-800",children:e.subject||"Meeting"}),a.jsx("span",{className:`text-xs sm:text-sm font-medium px-2 sm:px-3 py-1 rounded-full whitespace-nowrap ${S(d(e.status))}`,children:d(e.status||"PENDING").replace("_"," ")})]}),a.jsx("div",{className:"flex flex-col sm:flex-row sm:space-x-3 space-y-2 sm:space-y-0",children:(!["MANAGER","GROUP MANAGER","SALES"].includes(i?.role?.toUpperCase())||e?.created_by===i?.id)&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{type:"button",onClick:()=>{console.log("Edit button clicked"),n&&n(e)},className:"inline-flex items-center justify-center w-full sm:w-auto bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 transition text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",children:[a.jsx(hn,{className:"mr-2"}),"Edit"]}),a.jsxs("button",{type:"button",onClick:()=>{console.log("Archive button clicked"),s&&s(e)},className:`inline-flex items-center justify-center w-full sm:w-auto px-4 py-2 rounded-md text-sm text-white transition focus:outline-none ${o?"bg-orange-500 hover:bg-orange-600 focus:ring-2 focus:ring-orange-400":"bg-red-500 hover:bg-red-600 focus:ring-2 focus:ring-red-400"}`,children:[o?a.jsx(Zt,{className:"mr-2"}):a.jsx(wa,{className:"mr-2"}),o?"Archive":"Delete"]})]})})]})}),a.jsx("div",{className:"border-b border-gray-200 my-5"}),a.jsxs("div",{className:"p-6 lg:p-4",children:[a.jsx("div",{className:"flex w-full bg-[#6A727D] text-white mt-1 overflow-x-auto mb-6",children:["Overview","Notes"].map(_=>a.jsx("button",{onClick:()=>c(_),className:`flex-1 min-w-[90px] px-4 py-2.5 text-xs sm:text-sm font-medium text-center transition-all duration-200 border-b-2
        ${l===_?"bg-paper-white text-[#6A727D] border-white":"text-white hover:bg-[#5c636d]"}`,children:_},_))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 items-start",children:[a.jsxs("div",{className:"lg:col-span-3",children:[l==="Overview"&&a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 md:p-8 border border-gray-200",children:a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4 sm:gap-6 text-sm text-gray-700",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Start Time:"}),a.jsx("p",{children:e.start_time?new Date(e.start_time).toLocaleString():"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"End Time:"}),a.jsx("p",{children:e.end_time?new Date(e.end_time).toLocaleString():"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Meeting Title:"}),a.jsx("p",{children:e.subject||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Location:"}),a.jsx("p",{children:e.location||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Assigned To:"}),a.jsxs("p",{children:[e.meet_assign_to.first_name," ",e.meet_assign_to.last_name]})]}),e.lead&&a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Lead:"}),a.jsx("p",{children:e.lead.title})]}),e.account&&a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Account:"}),a.jsx("p",{children:e.account.name})]}),e.contact&&a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Contact:"}),a.jsxs("p",{children:[e.contact.first_name," ",e.contact.last_name]})]}),e.deal&&a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Deal:"}),a.jsx("p",{children:e.deal.name})]}),e.quote&&a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Quote:"}),a.jsx("p",{children:u(e.quote.quote_id)})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Status:"}),a.jsx("p",{children:d(e.status||"PENDING").replace("_"," ")})]})]})}),l==="Notes"&&a.jsxs("div",{className:"mt-4 w-full",children:[a.jsx("div",{className:"flex flex-wrap items-center justify-between mb-4 gap-2",children:a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words",children:"Meeting Note"})}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 shadow-sm break-words",children:[a.jsx("div",{className:"flex items-start justify-between",children:a.jsx("div",{children:a.jsx("p",{className:"text-sm font-medium text-gray-800 break-words",children:"Note"})})}),a.jsx("div",{className:"mt-3 text-sm text-gray-700 whitespace-pre-wrap break-words",children:e.notes||"No notes available."})]}),a.jsx(Tn,{comments:y,onAddComment:N})]})]}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm w-full",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Status"}),a.jsxs("select",{className:"border border-gray-200 rounded-md px-2 sm:px-3 py-1.5 w-full text-sm mb-2 focus:ring-2 focus:ring-indigo-500 outline-none",value:p,onChange:_=>x(_.target.value),children:[a.jsx("option",{value:"PLANNED",children:"PLANNED"}),a.jsx("option",{value:"HELD",children:"HELD"}),a.jsx("option",{value:"NOT_HELD",children:"NOT HELD"})]}),a.jsx("button",{onClick:async()=>{if(!r||!e?.id)return;const _=h(p);if(d(e.status)!==p){j(!0);try{await r(e.id,_)}catch(k){console.error("Failed to update status:",k)}finally{j(!1)}}},disabled:p===e.status||v,className:`w-full py-1.5 rounded-md text-sm transition focus:outline-none focus:ring-2 ${p===e.status||v?"bg-gray-400 cursor-not-allowed text-white":"bg-gray-900 text-white hover:bg-gray-800 focus:ring-gray-400"}`,children:v?"Updating...":"Update"})]})]})]})]})})})},aJ=e=>e?e.toUpperCase():"",Nb=e=>{const t=aJ(e);return t==="INACTIVE"?"INACTIVE":t==="PLANNED"||t==="IN PROGRESS"?"PLANNED":t==="HELD"||t==="DONE"?"HELD":t==="NOT_HELD"||t==="NOT HELD"?"NOT_HELD":"PLANNED"},zze=e=>{if(!e)return"--";try{return new Date(e).toLocaleString()}catch{return"--"}},Fze=e=>{if(!e)return"";const t=String(e).split("-");return t.length===3?`${t[0]}-${t[2]}`:String(e)},Uze=e=>{const t=aJ(e);if(t==="INACTIVE")return"bg-gray-200 text-gray-700";switch(t==="PLANNED"?"PENDING":t==="HELD"?"COMPLETED":t==="NOT_HELD"?"CANCELLED":t){case"PENDING":return"bg-indigo-100 text-indigo-700";case"COMPLETED":case"DONE":return"bg-green-100 text-green-700";case"CANCELLED":return"bg-gray-200 text-gray-700";case"IN PROGRESS":return"bg-blue-100 text-blue-700";default:return"bg-gray-100 text-gray-700"}},EA={subject:"",startTime:"",endTime:"",location:"",status:"PLANNED",notes:"",assignedTo:"",relatedType1:"Lead",relatedTo1:"",relatedType2:null,relatedTo2:""},c8=()=>{const e=kt(),t=ta(),[n]=Bs(),s=n.get("id"),r=t.pathname==="/admin/meetings/info";f.useEffect(()=>{document.title="Meetings | Sari-Sari CRM"},[]);const[i,o]=f.useState([]),[l,c]=f.useState(!1),[u,d]=f.useState([]),[h,p]=f.useState(""),[x,v]=f.useState("Filter by Status"),[j,y]=f.useState(!1),[N,w]=f.useState(null),[S,_]=f.useState(1),[k,T]=f.useState(10),[A,E]=f.useState(EA),[M,z]=f.useState(!1),[P,D]=f.useState(null),[U,B]=f.useState(!1),[R,q]=f.useState(null),[Z,V]=f.useState(!1),[oe,je]=f.useState([]),[X,se]=f.useState(null);f.useEffect(()=>{const Fe=t.state?.openMeetingModal,st=t.state?.initialMeetingData?.relatedTo||n.get("id"),Xe=t.state?.meetingID;Fe||st?(y(!0),t.state?.initialMeetingData&&E(Ze=>({...Ze,...t.state.initialMeetingData})),e(t.pathname,{replace:!0,state:{}})):Xe&&(se(Xe),e(t.pathname,{replace:!0,state:{}}))},[t,n,e]),f.useEffect(()=>{if(X&&i.length>0&&!l){const Fe=i.find(st=>st.id===X);Fe?w(Fe):H.error("Meeting not found."),se(null)}},[X,i,l]);const ye=async()=>{if(s&&r){const Fe=sessionStorage.getItem("meetingDetailData");if(Fe)try{const st=JSON.parse(Fe);if(st.id===parseInt(s)){w(st),sessionStorage.removeItem("meetingDetailData");return}}catch(st){console.error(st)}}c(!0);try{const Fe=await re.get("/meetings/admin/fetch-all"),Xe=[...Array.isArray(Fe.data)?Fe.data:[]].sort((Ze,Je)=>{const Be=Ze?.created_at?new Date(Ze.created_at).getTime():0;return(Je?.created_at?new Date(Je.created_at).getTime():0)-Be});if(o(Xe),s&&!N){const Ze=Xe.find(Je=>Je.id===parseInt(s));Ze&&w(Ze)}}catch{H.error("Failed to load meetings.")}finally{c(!1)}},Ne=async()=>{try{const Fe=await re.get("/users/all");d(Array.isArray(Fe.data)?Fe.data:[])}catch(Fe){console.error(Fe)}};f.useEffect(()=>{ye(),Ne()},[]);const fe=Fe=>p(Fe.target.value),we=Fe=>{if(Fe.target.checked){const st=ge.map(Xe=>Xe.id);je(st)}else je([])},de=Fe=>{je(st=>st.includes(Fe)?st.filter(Xe=>Xe!==Fe):[...st,Fe])},ke=f.useMemo(()=>{const Fe=h.trim().toLowerCase(),st=x.trim().toUpperCase();return i.filter(Xe=>{const Ze=[Xe?.activity,Xe?.description,Xe?.relatedTo,Xe?.assignedTo],Je=Fe===""||Ze.some(_e=>_e&&_e.toString().toLowerCase().includes(Fe)),Be=st==="FILTER BY STATUS"||Nb(Xe.status||"PENDING")===st;return Je&&Be})},[i,h,x]);f.useEffect(()=>{_(1)},[h,x,k]);const ge=f.useMemo(()=>{const Fe=(S-1)*k;return ke.slice(Fe,Fe+k)},[ke,S,k]),$e=()=>{y(!1),E(EA),z(!1),D(null),B(!1)},be=()=>{E(EA),z(!1),D(null),y(!0)},me=Fe=>{let st="";if(Fe.meet_assign_to?.id)st=String(Fe.meet_assign_to.id);else if(Fe.assignedTo){const ne=u.find(ae=>`${ae.first_name} ${ae.last_name}`===Fe.assignedTo);st=ne?String(ne.id):""}const Xe=ne=>{if(!ne)return"";try{const ae=new Date(ne),Pe=ae.getTimezoneOffset()*6e4;return new Date(ae.getTime()-Pe).toISOString().slice(0,16)}catch{return""}};let Ze="Lead",Je="",Be="Contact",_e="";if(Fe.lead)Ze="Lead",Je=String(Fe.lead.id);else if(Fe.account)Ze="Account",Je=String(Fe.account.id),Fe.contact?(Be="Contact",_e=String(Fe.contact.id)):Fe.deal?(Be="Deal",_e=String(Fe.deal.id)):Fe.quote&&(Be="Quote",_e=String(Fe.quote.id));else if(Fe.relatedType||Fe.related_type){const ne=Fe.relatedType||Fe.related_type,ae=Fe.related_to||Fe.relatedToId;ne==="Lead"?(Ze="Lead",Je=String(ae)):(Ze="Account",Je=Fe.account_id?String(Fe.account_id):"")}const pe={PLANNED:"Planned",HELD:"Held",NOT_HELD:"Not held"},ce=Nb(Fe.status),Q=pe[ce]||"Planned";E({subject:Fe.subject||Fe.activity||"",location:Fe.location||"",startTime:Xe(Fe.start_time||Fe.startTime),endTime:Xe(Fe.end_time||Fe.endTime),status:Q,notes:Fe.description||Fe.notes||"",assignedTo:st,relatedType1:Ze,relatedTo1:Je,relatedType2:Be,relatedTo2:_e}),z(!0),D(Fe.id),w(null),y(!0)},Ue=Fe=>{if(!Fe.subject?.trim())return H.error("Subject is required.");if(!Fe.startTime)return H.error("Start time is required.");if(Fe.endTime&&!(new Date(Fe.endTime)-new Date(Fe.startTime)>0))return H.error("End time must be after start time.");Fe.relatedType1,Fe.relatedTo1,Fe.relatedType1==="Account"&&Fe.relatedType2&&Fe.relatedTo2&&(Fe.relatedType2,Fe.relatedTo2);const st={...Fe,assignedTo:parseInt(Fe.assignedTo),relatedTo1:parseInt(Fe.relatedTo1),relatedTo2:parseInt(Fe.relatedTo2)},Xe=M&&P?"update":"create";q({title:Xe==="create"?"Confirm New Meeting":"Confirm Update",message:`Are you sure you want to ${Xe} "${st.subject}"?`,confirmLabel:Xe==="create"?"Create Meeting":"Update Meeting",variant:"primary",action:{type:Xe,payload:st,targetId:P,name:st.subject}})},Ee=async()=>{if(!R?.action)return;const{type:Fe,payload:st,targetId:Xe,name:Ze}=R.action;V(!0);try{if(Fe==="create")B(!0),await re.post("/meetings/create",st),H.success(`Meeting "${Ze}" created.`),$e(),await ye();else if(Fe==="update")B(!0),await re.put(`/meetings/${Xe}`,st),H.success(`Meeting "${Ze}" updated.`),$e(),await ye();else if(Fe==="delete")await re.delete(`/meetings/${Xe}`),H.success(`Meeting "${Ze}" deleted.`),N?.id===Xe&&w(null),await ye();else if(Fe==="bulk-delete"){const{meeting_ids:Je}=R.action;await re.delete("/meetings/admin/bulk-delete",{data:{meeting_ids:Je}}),H.success(`${Je.length} meetings deleted.`),je([]),await ye()}}catch(Je){const Be=Je.response?.data?.detail||"Action failed.";H.error(typeof Be=="string"?Be:JSON.stringify(Be)),console.error(Be)}finally{B(!1),V(!1),q(null)}},We=async()=>{oe.length!==0&&q({title:"Delete Meetings",message:a.jsxs("span",{children:["Are you sure you want to delete"," ",a.jsx("span",{className:"font-semibold",children:oe.length})," selected meetings? This action cannot be undone."]}),confirmLabel:`Delete ${oe.length} Meeting(s)`,cancelLabel:"Cancel",variant:"danger",action:{type:"bulk-delete",meeting_ids:oe}})},tt=Fe=>{q({title:"Delete Meeting",message:`Permanently delete "${Fe.subject}"? This action cannot be undone.`,confirmLabel:"Delete",variant:"danger",action:{type:"delete",targetId:Fe.id,name:Fe.subject}})},lt=async(Fe,st)=>{try{await re.put(`/meetings/${Fe}`,{status:st}),H.success("Status updated"),ye(),w(null)}catch{H.error("Failed to update status")}};return r&&s?N?a.jsx(Nd,{meeting:N,onClose:()=>{w(null),e("/admin/dashboard")},onEdit:me,onDelete:tt,onStatusUpdate:lt,isSalesView:!1}):a.jsx(Wt,{message:"Loading meeting..."}):a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[l&&a.jsx(Wt,{message:"Loading meetings..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h1",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800 mb-4 lg:mb-0",children:[a.jsx(Ot,{className:"mr-2 text-blue-600"})," Meetings"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{onClick:be,className:"bg-black text-white px-4 py-2 rounded-md flex items-center hover:bg-gray-800",children:[a.jsx(aa,{className:"mr-2"})," Add Meeting"]})})]}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full sm:w-auto lg:w-4/4 md:w-3/4",children:[a.jsx(Kt,{className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search meetings",value:h,onChange:fe,className:"w-full outline-none"})]}),a.jsxs("select",{value:x,onChange:Fe=>v(Fe.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm bg-white w-full sm:w-auto",children:[a.jsx("option",{children:"Filter by Status"}),a.jsx("option",{value:"PLANNED",children:"PLANNED"}),a.jsx("option",{value:"HELD",children:"HELD"}),a.jsx("option",{value:"NOT_HELD",children:"NOT HELD"})]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[500px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm mb-4",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 w-12",children:a.jsx("input",{type:"checkbox",checked:ge.length>0&&oe.length===ge.length,onChange:we,className:"cursor-pointer"})}),a.jsx("th",{className:"py-3 px-4",children:"Subject"}),a.jsx("th",{className:"py-3 px-4",children:"Related To"}),a.jsx("th",{className:"py-3 px-4",children:"Start Time"}),a.jsx("th",{className:"py-3 px-4",children:"Assigned"}),a.jsx("th",{className:"py-3 px-4",children:"Status"}),a.jsx("th",{className:"py-3 px-4 text-center w-24",children:oe.length>0?a.jsx("button",{onClick:We,className:"text-red-600 hover:text-red-800 transition p-1 rounded-full hover:bg-red-50",title:`Delete ${oe.length} selected items`,children:a.jsx(wa,{size:18})}):""})]})}),a.jsx("tbody",{children:ge.length>0?ge.map(Fe=>a.jsxs("tr",{onClick:()=>w(Fe),className:"hover:bg-gray-50 cursor-pointer border-b border-gray-100",children:[a.jsx("td",{className:"py-3 px-4 align-top w-12",onClick:st=>st.stopPropagation(),children:a.jsx("input",{type:"checkbox",checked:oe.includes(Fe.id),onChange:()=>de(Fe.id),className:"cursor-pointer"})}),a.jsx("td",{className:"py-3 px-4 font-medium text-blue-600",children:Fe.subject}),a.jsxs("td",{className:"py-3 px-4",children:[Fe.lead&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:Fe.lead.title}),Fe.account&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:Fe.account.name}),Fe.contact&&a.jsxs("p",{className:"font-medium text-blue-500 text-xs",children:[Fe.contact.first_name," ",Fe.contact.last_name]}),Fe.deal&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:Fe.deal.name}),Fe.quote&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:Fze(Fe.quote.quote_id)})]}),a.jsx("td",{className:"py-3 px-4",children:zze(Fe.start_time)}),a.jsxs("td",{className:"py-3 px-4",children:[Fe.meet_assign_to.first_name," ",Fe.meet_assign_to.last_name]}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${Uze(Nb(Fe.status))}`,children:Nb(Fe.status).replace("_"," ")})}),a.jsx("td",{className:"py-3 px-4 text-center"})]},Fe.id)):a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"text-center py-4 text-gray-500",children:"No meetings found."})})})]})}),a.jsx(ca,{totalItems:ke.length,pageSize:k,currentPage:S,onPrev:()=>_(Fe=>Math.max(1,Fe-1)),onNext:()=>_(Fe=>Math.min(Fe+1,Math.ceil(ke.length/k)||1)),onPageSizeChange:T,label:"meetings"}),j&&a.jsx(k1,{onClose:$e,formData:A,setFormData:E,isEditing:M,onSubmit:Ue,isSubmitting:U||Z,users:u}),N&&a.jsx(Nd,{meeting:N,onClose:()=>w(null),onEdit:me,onDelete:tt,onStatusUpdate:lt,isSalesView:!1}),R&&a.jsx(Bze,{open:!0,title:R.title,message:R.message,confirmLabel:R.confirmLabel,variant:R.variant,onConfirm:Ee,onCancel:()=>q(null),loading:Z})]})};function Bze({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{onClick:c,disabled:o,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",children:"Cancel"}),a.jsx("button",{onClick:l,disabled:o,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70
                       ${u}`,children:o?"...":s})]})]})})}function Hze(){const{user:e,mutate:t}=Vt(),n=f.useRef(null),[s,r]=f.useState(""),[i,o]=f.useState(""),[l,c]=f.useState("January"),[u,d]=f.useState(0),[h,p]=f.useState(null),[x,v]=f.useState(null),[j,y]=f.useState(""),[N,w]=f.useState(!1),[S,_]=f.useState(!1),[k,T]=f.useState({type:"",text:""}),A=["January","February","March","April","May","June","July","August","September","October","November","December"];f.useEffect(()=>{e?.company&&(e.company.company_name&&r(e.company.company_name),e.company.currency&&o(e.company.currency),e.company.quota_period&&c(e.company.quota_period),e.company.tax_rate!==void 0&&d(e.company.tax_rate),e.company.company_logo&&p(e.company.company_logo),e.company.address&&y(e.company.address))},[e]);const E=U=>{const B=U.target.files?.[0];if(!B)return;if(!B.type.startsWith("image/")){T({type:"error",text:"Please select an image file"});return}if(B.size>2*1024*1024){T({type:"error",text:"Image size should be less than 2MB"});return}const R=new FileReader;R.onloadend=()=>{v(R.result)},R.readAsDataURL(B)},M=()=>{v(""),p(null)},z=async U=>{U.preventDefault(),w(!0),T({type:"",text:""});try{const B={company_name:s,currency:i,quota_period:l,tax_rate:parseFloat(u),address:j};x!==null&&(B.company_logo=x),await re.put("/company/update-name",B),t&&await t(),v(null),T({type:"success",text:"Company settings updated successfully!"})}catch(B){console.error("Update error:",B);const R=B.response?.data?.detail||"Failed to update settings.";T({type:"error",text:R})}finally{w(!1)}},P=async()=>{_(!0),T({type:"",text:""});try{const U=await re.get("/admin/backup/csv",{responseType:"blob"}),B=U.headers?.["content-disposition"]||"",q=/filename="?([^";]+)"?/i.exec(B)?.[1]||"crm-backup.zip",Z=window.URL.createObjectURL(new Blob([U.data])),V=document.createElement("a");V.href=Z,V.setAttribute("download",q),document.body.appendChild(V),V.click(),V.remove(),window.URL.revokeObjectURL(Z)}catch(U){console.error("Backup download error:",U);const B=U?.response?.data?.detail||"Failed to download backup. Please try again.";T({type:"error",text:B})}finally{_(!1)}},D=["CEO","ADMIN"].includes(e?.role?.toUpperCase());return a.jsxs("div",{className:"max-w-2xl mx-auto mt-10 bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[a.jsxs("div",{className:"bg-[#fbbf24] px-6 py-4",children:[a.jsxs("h2",{className:"text-gray-900 font-bold text-xl flex items-center gap-2",children:[a.jsx(sa,{})," Company Details"]}),a.jsx("p",{className:"text-gray-700 text-sm",children:"Manage your organization's identity and fiscal settings"})]}),a.jsxs("form",{onSubmit:z,className:"p-6 space-y-6",children:[!D&&a.jsxs("div",{className:"flex items-center gap-2 p-3 bg-amber-50 text-amber-700 rounded-lg text-sm border border-amber-200",children:[a.jsx(Fl,{}),a.jsx("span",{children:"You only have view-access. Changes can only be made by an Admin."})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Company Name"}),a.jsx("input",{type:"text",value:s,onChange:U=>r(U.target.value),disabled:!D||N,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#fbbf24] focus:border-transparent outline-none transition disabled:bg-gray-50 disabled:cursor-not-allowed",placeholder:"Enter company name",required:!0})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-gray-700 mb-2",children:[a.jsx(eoe,{className:"text-gray-500"})," Company Address"]}),a.jsx("textarea",{value:j,onChange:U=>y(U.target.value),disabled:!D||N,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#fbbf24] focus:border-transparent outline-none transition disabled:bg-gray-50 disabled:cursor-not-allowed resize-none",placeholder:"Enter company address",rows:3})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-gray-700 mb-2",children:[a.jsx(UI,{className:"text-gray-500"})," Company Logo"]}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"flex-shrink-0",children:x||h?a.jsx("img",{src:x||h,alt:"Company Logo",className:"w-16 h-16 object-contain border border-gray-200 rounded-lg bg-gray-50"}):a.jsx("div",{className:"w-16 h-16 border-2 border-dashed border-gray-300 rounded-lg flex items-center justify-center bg-gray-50",children:a.jsx(UI,{className:"text-gray-400 text-xl"})})}),D&&a.jsxs("div",{className:"flex flex-col gap-2",children:[a.jsx("input",{type:"file",ref:n,accept:"image/*",onChange:E,className:"hidden",id:"company-logo-upload"}),a.jsxs("button",{type:"button",onClick:()=>n.current?.click(),disabled:N,className:"flex items-center gap-2 px-3 py-1.5 text-sm border border-gray-300 rounded-lg hover:bg-gray-50 transition disabled:opacity-50",children:[a.jsx(roe,{className:"text-gray-500"}),x||h?"Change Logo":"Upload Logo"]}),(x||h)&&a.jsx("button",{type:"button",onClick:M,disabled:N,className:"text-xs text-red-600 hover:text-red-700 transition",children:"Remove Logo"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Max 2MB, PNG or JPG"})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-gray-700 mb-2",children:[a.jsx(Ot,{className:"text-gray-500"})," Fiscal Year Start"]}),a.jsxs("div",{className:"relative",children:[a.jsx("select",{value:l,onChange:U=>c(U.target.value),disabled:!D||N,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#fbbf24] focus:border-transparent outline-none appearance-none bg-white disabled:bg-gray-50 cursor-pointer",children:A.map(U=>a.jsx("option",{value:U,children:U},U))}),a.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none text-gray-500",children:a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})})]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-gray-700 mb-2",children:[a.jsx(aoe,{className:"text-gray-500"})," Default Tax Rate"]}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"number",step:"0.01",value:u,onChange:U=>d(U.target.value),disabled:!D||N,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#fbbf24] focus:border-transparent outline-none transition disabled:bg-gray-50",placeholder:"0.00"}),a.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-8 pointer-events-none text-gray-400 font-medium",children:"%"})]})]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-gray-700 mb-2",children:[a.jsx(h9,{className:"text-gray-500"})," Currency"]}),a.jsxs("div",{className:"flex gap-3 max-w-xs",children:[a.jsxs("label",{className:`flex-1 flex items-center justify-center gap-1 p-2 border rounded-lg cursor-pointer transition-all ${i===""?"bg-amber-50 border-[#fbbf24] text-amber-900 font-medium ring-1 ring-[#fbbf24]":"border-gray-200 hover:bg-gray-50 text-gray-600"} ${!D||N?"opacity-50 cursor-not-allowed":""}`,children:[a.jsx("input",{type:"radio",name:"currency",value:"",checked:i==="",onChange:()=>o(""),disabled:!D||N,className:"hidden"}),a.jsx("span",{className:"text-lg font-bold",children:""})," PHP"]}),a.jsxs("label",{className:`flex-1 flex items-center justify-center gap-1 p-2 border rounded-lg cursor-pointer transition-all ${i==="$"?"bg-amber-50 border-[#fbbf24] text-amber-900 font-medium ring-1 ring-[#fbbf24]":"border-gray-200 hover:bg-gray-50 text-gray-600"} ${!D||N?"opacity-50 cursor-not-allowed":""}`,children:[a.jsx("input",{type:"radio",name:"currency",value:"$",checked:i==="$",onChange:()=>o("$"),disabled:!D||N,className:"hidden"}),a.jsx("span",{className:"text-lg font-bold",children:"$"})," USD"]})]})]}),k.text&&a.jsx("div",{className:`p-3 rounded-lg text-sm border transition-all ${k.type==="success"?"bg-green-50 text-green-700 border-green-200":"bg-red-50 text-red-700 border-red-200"}`,children:k.text}),a.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:D&&a.jsxs("div",{className:"flex flex-wrap gap-3",children:[a.jsxs("button",{type:"button",onClick:P,disabled:N||S,className:"flex items-center gap-2 border border-gray-300 bg-white text-gray-700 px-4 py-2 rounded-lg font-medium hover:bg-gray-50 disabled:opacity-50 transition active:scale-95",children:[a.jsx(Vo,{}),S?"Preparing...":"Download Backup (CSV)"]}),a.jsxs("button",{type:"submit",disabled:N||S,className:"flex items-center gap-2 bg-[#1e293b] text-white px-6 py-2 rounded-lg font-medium hover:bg-[#334155] disabled:opacity-50 transition shadow-md active:scale-95",children:[a.jsx(CL,{}),N?"Updating...":"Save Settings"]})]})})]})]})}function qze(){const[e,t]=f.useState(null),[n,s]=f.useState({subject:"",category:"",description:"",priority:"medium"}),[r,i]=f.useState(""),[o,l]=f.useState(!1),[c,u]=f.useState([{id:1,sender:"support",message:"Hello! Welcome to Sari-Sari CRM Support. How can I help you today?",timestamp:new Date}]),[d,h]=f.useState(""),[p,x]=f.useState(!1),v=f.useRef(null);f.useEffect(()=>{v.current?.scrollIntoView({behavior:"smooth"})},[c]),f.useEffect(()=>{document.title="Help Center | Sari-Sari CRM"},[]);const j=[{id:1,category:"Getting Started",title:"How to create your first account?",content:"Navigate to the Accounts page from the sidebar, click the 'Add Account' button, fill in the required information such as company name, email, and phone number, then click Save."},{id:2,category:"Getting Started",title:"How to add new contacts?",content:"Go to Contacts in the sidebar, click 'Add Contact', enter the contact details including name, email, phone, and associated account, then save the contact."},{id:3,category:"Leads & Deals",title:"How to convert a lead to a deal?",content:"Open the lead you want to convert, click on the 'Convert to Deal' button, review the pre-filled information, make any necessary adjustments, and confirm the conversion."},{id:4,category:"Leads & Deals",title:"How to manage deal stages?",content:"Deals progress through stages: Prospecting, Qualification, Proposal, Negotiation, and Closed. Update the stage by editing the deal and selecting the appropriate stage from the dropdown."},{id:5,category:"Tasks & Activities",title:"How to create and assign tasks?",content:"Navigate to Tasks, click 'Add Task', fill in the task details, assign it to a team member, set the due date and priority, then save. The assigned user will be notified."},{id:6,category:"Tasks & Activities",title:"How to schedule meetings?",content:"Go to Meetings, click 'Schedule Meeting', select participants, set the date and time, add an agenda, and save. All participants will receive calendar invites."},{id:7,category:"Reports & Analytics",title:"How to view sales performance?",content:"Access the Dashboard to see key metrics. For detailed reports, navigate to Targets to view individual and team performance against set goals."},{id:8,category:"Account Settings",title:"How to manage user permissions?",content:"Go to Users in the sidebar, select a user, and edit their role. Different roles (Admin, Manager, Sales, Marketing) have different access levels and permissions."}],y=["Technical Issue","Login Problem","Data Issue","Feature Request","Performance Issue","Other"],w=j.filter(M=>M.title.toLowerCase().includes(r.toLowerCase())||M.content.toLowerCase().includes(r.toLowerCase())||M.category.toLowerCase().includes(r.toLowerCase())).reduce((M,z)=>(M[z.category]||(M[z.category]=[]),M[z.category].push(z),M),{}),S=(M,z)=>{s(P=>({...P,[M]:z}))},_=async M=>{if(M.preventDefault(),!n.subject.trim()||!n.category||!n.description.trim()){H.warn("Please fill in all required fields.");return}l(!0),setTimeout(()=>{H.success("Your issue has been submitted successfully! We'll get back to you soon."),s({subject:"",category:"",description:"",priority:"medium"}),t(null),l(!1)},1500)},[k,T]=f.useState(null),A=M=>{if(M.preventDefault(),!d.trim())return;const z={id:c.length+1,sender:"user",message:d.trim(),timestamp:new Date};u(P=>[...P,z]),h(""),x(!0),setTimeout(()=>{const P=["Thank you for your message. Let me look into that for you.","I understand your concern. Can you provide more details?","That's a great question! Here's what I can help you with...","I'm checking our system now. Please hold on for a moment.","Thanks for reaching out! I'll make sure to assist you with this."],D=P[Math.floor(Math.random()*P.length)];u(U=>[...U,{id:U.length+1,sender:"support",message:D,timestamp:new Date}]),x(!1)},1500)},E=M=>new Date(M).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return a.jsxs("div",{className:"p-6 max-w-6xl mx-auto",children:[a.jsxs("div",{className:"mb-8 text-center",children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Help Center"}),a.jsx("p",{className:"text-gray-600",children:"How can we help you today?"})]}),a.jsxs("div",{className:"grid md:grid-cols-3 gap-6 mb-8",children:[a.jsx("div",{onClick:()=>t(e==="report"?null:"report"),className:`bg-white rounded-xl shadow-md border-2 cursor-pointer transition-all duration-300 hover:shadow-lg ${e==="report"?"border-red-400 ring-2 ring-red-100":"border-transparent hover:border-red-200"}`,children:a.jsx("div",{className:"p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-14 h-14 bg-red-100 rounded-full flex items-center justify-center",children:a.jsx(Fl,{className:"w-7 h-7 text-red-600"})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Report an Issue"}),a.jsx("p",{className:"text-gray-500 text-sm",children:"Having a problem? Let us know"})]})]}),a.jsx(Mt,{className:`w-6 h-6 text-gray-400 transition-transform duration-300 ${e==="report"?"rotate-90":""}`})]})})}),a.jsx("div",{onClick:()=>t(e==="solutions"?null:"solutions"),className:`bg-white rounded-xl shadow-md border-2 cursor-pointer transition-all duration-300 hover:shadow-lg ${e==="solutions"?"border-blue-400 ring-2 ring-blue-100":"border-transparent hover:border-blue-200"}`,children:a.jsx("div",{className:"p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-14 h-14 bg-blue-100 rounded-full flex items-center justify-center",children:a.jsx(Yie,{className:"w-7 h-7 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Browse Solutions"}),a.jsx("p",{className:"text-gray-500 text-sm",children:"Find answers to common questions"})]})]}),a.jsx(Mt,{className:`w-6 h-6 text-gray-400 transition-transform duration-300 ${e==="solutions"?"rotate-90":""}`})]})})}),a.jsx("div",{onClick:()=>t(e==="chat"?null:"chat"),className:`bg-white rounded-xl shadow-md border-2 cursor-pointer transition-all duration-300 hover:shadow-lg ${e==="chat"?"border-green-400 ring-2 ring-green-100":"border-transparent hover:border-green-200"}`,children:a.jsx("div",{className:"p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("div",{className:"w-14 h-14 bg-green-100 rounded-full flex items-center justify-center relative",children:[a.jsx(zy,{className:"w-7 h-7 text-green-600"}),a.jsx("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-green-500 rounded-full border-2 border-white"})]}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Live Chat Support"}),a.jsx("p",{className:"text-gray-500 text-sm",children:"Chat with our support team"})]})]}),a.jsx(Mt,{className:`w-6 h-6 text-gray-400 transition-transform duration-300 ${e==="chat"?"rotate-90":""}`})]})})})]}),e==="report"&&a.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 mb-8 animate-fade-in",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-800 flex items-center gap-2",children:[a.jsx(BI,{className:"text-red-500"}),"Report an Issue"]}),a.jsx("button",{onClick:()=>t(null),className:"p-2 hover:bg-gray-100 rounded-full transition",children:a.jsx(ea,{className:"w-5 h-5 text-gray-500"})})]}),a.jsxs("form",{onSubmit:_,className:"space-y-5",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Subject ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",value:n.subject,onChange:M=>S("subject",M.target.value),placeholder:"Brief description of the issue",className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-200 focus:border-red-400 outline-none transition"})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Category ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("select",{value:n.category,onChange:M=>S("category",M.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-200 focus:border-red-400 outline-none transition bg-white",children:[a.jsx("option",{value:"",children:"Select a category"}),y.map(M=>a.jsx("option",{value:M,children:M},M))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Priority"}),a.jsx("div",{className:"flex gap-3",children:["low","medium","high"].map(M=>a.jsx("button",{type:"button",onClick:()=>S("priority",M),className:`px-4 py-2 rounded-lg border transition capitalize ${n.priority===M?M==="high"?"bg-red-500 text-white border-red-500":M==="medium"?"bg-yellow-500 text-white border-yellow-500":"bg-green-500 text-white border-green-500":"bg-white text-gray-600 border-gray-300 hover:border-gray-400"}`,children:M},M))})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Description ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("textarea",{value:n.description,onChange:M=>S("description",M.target.value),placeholder:"Please describe the issue in detail. Include steps to reproduce if applicable.",rows:5,className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-200 focus:border-red-400 outline-none transition resize-none"})]}),a.jsx("div",{className:"flex justify-end",children:a.jsx("button",{type:"submit",disabled:o,className:"flex items-center gap-2 bg-red-500 hover:bg-red-600 text-white px-6 py-2.5 rounded-lg font-medium transition disabled:opacity-50 disabled:cursor-not-allowed",children:o?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Submitting..."]}):a.jsxs(a.Fragment,{children:[a.jsx(nk,{className:"w-4 h-4"}),"Submit Issue"]})})})]})]}),e==="solutions"&&a.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 mb-8 animate-fade-in",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-800 flex items-center gap-2",children:[a.jsx(Zie,{className:"text-blue-500"}),"Browse Solutions"]}),a.jsx("button",{onClick:()=>t(null),className:"p-2 hover:bg-gray-100 rounded-full transition",children:a.jsx(ea,{className:"w-5 h-5 text-gray-500"})})]}),a.jsxs("div",{className:"relative mb-6",children:[a.jsx(Kt,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),a.jsx("input",{type:"text",value:r,onChange:M=>i(M.target.value),placeholder:"Search for solutions...",className:"w-full pl-12 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-200 focus:border-blue-400 outline-none transition"})]}),a.jsx("div",{className:"space-y-6",children:Object.keys(w).length>0?Object.entries(w).map(([M,z])=>a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-semibold text-gray-500 uppercase tracking-wide mb-3",children:M}),a.jsx("div",{className:"space-y-2",children:z.map(P=>a.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[a.jsxs("button",{onClick:()=>T(k===P.id?null:P.id),className:"w-full px-4 py-3 flex items-center justify-between bg-gray-50 hover:bg-gray-100 transition text-left",children:[a.jsx("span",{className:"font-medium text-gray-700",children:P.title}),a.jsx(Mt,{className:`w-5 h-5 text-gray-400 transition-transform duration-200 ${k===P.id?"rotate-90":""}`})]}),k===P.id&&a.jsxs("div",{className:"px-4 py-3 bg-white border-t border-gray-200",children:[a.jsx("p",{className:"text-gray-600 text-sm leading-relaxed",children:P.content}),a.jsxs("div",{className:"mt-3 flex items-center gap-2 text-xs text-gray-500",children:[a.jsx(Qa,{className:"text-green-500"}),"Was this helpful?",a.jsx("button",{className:"text-blue-500 hover:underline ml-1",children:"Yes"}),a.jsx("span",{children:"|"}),a.jsx("button",{className:"text-blue-500 hover:underline",children:"No"})]})]})]},P.id))})]},M)):a.jsxs("div",{className:"text-center py-8",children:[a.jsx(Kt,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),a.jsxs("p",{className:"text-gray-500",children:['No solutions found matching "',r,'"']}),a.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:["Try a different search term or"," ",a.jsx("button",{onClick:()=>t("report"),className:"text-blue-500 hover:underline",children:"report an issue"})]})]})})]}),e==="chat"&&a.jsxs("div",{className:"bg-white rounded-xl shadow-md mb-8 animate-fade-in overflow-hidden",children:[a.jsxs("div",{className:"bg-green-500 text-white p-4 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-white/20 rounded-full flex items-center justify-center",children:a.jsx(zy,{className:"w-5 h-5"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold",children:"Live Chat Support"}),a.jsxs("p",{className:"text-green-100 text-xs flex items-center gap-1",children:[a.jsx("span",{className:"w-2 h-2 bg-green-300 rounded-full animate-pulse"}),"Online - Typically replies in minutes"]})]})]}),a.jsx("button",{onClick:()=>t(null),className:"p-2 hover:bg-white/10 rounded-full transition",children:a.jsx(ea,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"h-80 overflow-y-auto p-4 bg-gray-50 space-y-4",children:[c.map(M=>a.jsx("div",{className:`flex ${M.sender==="user"?"justify-end":"justify-start"}`,children:a.jsxs("div",{className:`flex items-end gap-2 max-w-[80%] ${M.sender==="user"?"flex-row-reverse":""}`,children:[a.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 ${M.sender==="user"?"bg-blue-500 text-white":"bg-green-500 text-white"}`,children:M.sender==="user"?a.jsx(ra,{className:"w-4 h-4"}):a.jsx(zy,{className:"w-4 h-4"})}),a.jsxs("div",{className:`px-4 py-2.5 rounded-2xl ${M.sender==="user"?"bg-blue-500 text-white rounded-br-md":"bg-white shadow-sm border border-gray-200 text-gray-700 rounded-bl-md"}`,children:[a.jsx("p",{className:"text-sm",children:M.message}),a.jsx("p",{className:`text-[10px] mt-1 ${M.sender==="user"?"text-blue-100":"text-gray-400"}`,children:E(M.timestamp)})]})]})},M.id)),p&&a.jsx("div",{className:"flex justify-start",children:a.jsxs("div",{className:"flex items-end gap-2",children:[a.jsx("div",{className:"w-8 h-8 rounded-full bg-green-500 text-white flex items-center justify-center",children:a.jsx(zy,{className:"w-4 h-4"})}),a.jsx("div",{className:"bg-white shadow-sm border border-gray-200 px-4 py-3 rounded-2xl rounded-bl-md",children:a.jsxs("div",{className:"flex gap-1",children:[a.jsx("span",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),a.jsx("span",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),a.jsx("span",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})})]})}),a.jsx("div",{ref:v})]}),a.jsx("form",{onSubmit:A,className:"p-4 border-t border-gray-200 bg-white",children:a.jsxs("div",{className:"flex gap-3",children:[a.jsx("input",{type:"text",value:d,onChange:M=>h(M.target.value),placeholder:"Type your message...",className:"flex-1 px-4 py-2.5 border border-gray-300 rounded-full focus:ring-2 focus:ring-green-200 focus:border-green-400 outline-none transition"}),a.jsxs("button",{type:"submit",disabled:!d.trim(),className:"px-5 py-2.5 bg-green-500 hover:bg-green-600 text-white rounded-full transition disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[a.jsx(nk,{className:"w-4 h-4"}),a.jsx("span",{className:"hidden sm:inline",children:"Send"})]})]})})]}),!e&&a.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-6 text-center",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Need more help?"}),a.jsx("p",{className:"text-gray-600 mb-4",children:"Contact our support team for personalized assistance"}),a.jsx("div",{className:"flex justify-center gap-4",children:a.jsxs("a",{href:"mailto:support@example.com",className:"inline-flex items-center gap-2 bg-white px-4 py-2 rounded-lg shadow-sm hover:shadow-md transition text-gray-700",children:[a.jsx(BI,{className:"w-4 h-4"}),"Email Support"]})})]})]})}function Gze(){const e=kt();f.useEffect(()=>{document.title="Super Admin | Sari-Sari CRM"},[]);const t=async()=>{try{await re.post("/auth/logout"),H.success("Logged out successfully"),e("/login")}catch(r){console.error("Logout error:",r),H.error("Error logging out")}},n="flex items-center gap-3 px-3 py-2 rounded-lg bg-white text-[#1e293b] font-semibold shadow-sm",s="flex items-center gap-3 px-3 py-2 rounded-lg text-gray-300 hover:bg-[#334155] hover:text-white transition";return a.jsxs("div",{className:"flex h-screen bg-gray-100 overflow-hidden",children:[a.jsxs("div",{className:"w-64 bg-[#1e293b] text-white flex flex-col shadow-lg",children:[a.jsxs("div",{className:"px-4 py-3 bg-[#ef4444] leading-none",children:[a.jsx("p",{className:"text-white font-bold text-lg m-0 p-0",children:"Admin Panel"}),a.jsx("p",{className:"text-[12px] text-red-100 font-medium",children:"System Management"})]}),a.jsx("nav",{className:"flex-1 overflow-y-auto p-4 space-y-2",children:a.jsxs(Ft,{to:"/super-admin/dashboard",className:({isActive:r})=>r?n:s,children:[a.jsx(eh,{className:"text-lg"}),a.jsx("span",{children:"Tenants Dashboard"})]})}),a.jsx("div",{className:"p-4 border-t border-gray-700",children:a.jsxs("button",{onClick:t,className:"w-full flex items-center gap-3 px-3 py-2 rounded-lg text-gray-300 hover:bg-red-600 hover:text-white transition",children:[a.jsx(Jie,{className:"text-lg"}),a.jsx("span",{children:"Logout"})]})})]}),a.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[a.jsxs("header",{className:"bg-white shadow-sm px-6 py-4 flex items-center justify-between",children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Admin Dashboard"}),a.jsx("div",{className:"flex items-center gap-4",children:a.jsx("span",{className:"text-sm text-gray-600",children:"System Administrator"})})]}),a.jsx("main",{className:"flex-1 overflow-y-auto bg-gray-50",children:a.jsx(Xf,{})})]})]})}const Wze=()=>{const[e,t]=f.useState(null),[n,s]=f.useState([]),[r,i]=f.useState(!0),[o,l]=f.useState(""),[c,u]=f.useState(null),[d,h]=f.useState(!1),[p,x]=f.useState(null),[v,j]=f.useState(null),[y,N]=f.useState("all");f.useEffect(()=>{w(),S(),_(),k()},[]);const w=async()=>{try{const P=await re.get("/admin/stats");t(P.data)}catch(P){console.error("Error fetching stats:",P),H.error("Failed to load statistics")}},S=async()=>{try{i(!0);const P=await re.get("/admin/tenants");console.log("Tenants API Response:",P.data),console.log("Number of tenants:",P.data.tenants?.length),s(P.data.tenants||[])}catch(P){console.error("Error fetching tenants:",P),console.error("Error details:",P.response?.data),H.error("Failed to load tenants: "+(P.response?.data?.detail||P.message))}finally{i(!1)}},_=async()=>{try{const P=await re.get("/admin/subscriptions/alerts");x(P.data)}catch(P){console.error("Error fetching subscription alerts:",P)}},k=async()=>{try{const P=await re.get("/admin/activity");j(P.data)}catch(P){console.error("Error fetching activity stats:",P)}},T=async P=>{try{const D=await re.get(`/admin/tenants/${P}`);u(D.data),h(!0)}catch(D){console.error("Error fetching tenant details:",D),H.error("Failed to load tenant details")}},A=async(P,D)=>{try{const U=await re.patch(`/admin/users/${P}/toggle-status`);H.success(U.data.message),c&&T(c.id),S()}catch(U){console.error("Error toggling user status:",U),H.error(U.response?.data?.detail||"Failed to update user status")}},E=async(P,D)=>{const U=D==="Active"?"Cancelled":"Active";if(window.confirm(`Are you sure you want to ${U==="Cancelled"?"suspend":"activate"} this subscription?`))try{const B=await re.patch(`/admin/subscriptions/${P}/status`,{status:U});H.success(B.data.message),S(),_(),c&&T(c.id)}catch(B){console.error("Error updating subscription:",B),H.error(B.response?.data?.detail||"Failed to update subscription")}},M=()=>{w(),S(),_(),k(),H.success("Dashboard refreshed")},z=n.filter(P=>{const D=P.company_name.toLowerCase().includes(o.toLowerCase())||P.company_number.toLowerCase().includes(o.toLowerCase());if(y==="all")return D;if(!P.subscription)return y==="expired"?D:!1;const U=new Date(P.subscription.end_date),R=Math.ceil((U-new Date)/(1e3*60*60*24));return y==="active"?D&&P.subscription.status==="Active"&&R>7:y==="expiring"?D&&P.subscription.status==="Active"&&R<=7&&R>0:y==="expired"?D&&(P.subscription.status==="Expired"||R<=0):D});return r&&!e?a.jsx(Wt,{}):a.jsxs("div",{className:"min-h-screen bg-gray-50 p-6",children:[a.jsxs("div",{className:"mb-8 flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Admin Dashboard"}),a.jsx("p",{className:"text-gray-600",children:"Manage all tenants and monitor system-wide statistics"})]}),a.jsxs("button",{onClick:M,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:[a.jsx(Br,{})," Refresh"]})]}),e&&a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[a.jsx(Cb,{icon:a.jsx(ac,{className:"w-8 h-8"}),title:"Total Tenants",value:e.total_tenants,bgColor:"bg-blue-500"}),a.jsx(Cb,{icon:a.jsx(Za,{className:"w-8 h-8"}),title:"Total Users",value:e.total_users,bgColor:"bg-purple-500"}),a.jsx(Cb,{icon:a.jsx(Qi,{className:"w-8 h-8"}),title:"Active Users",value:e.active_users,bgColor:"bg-green-500"}),a.jsx(Cb,{icon:a.jsx(Ki,{className:"w-8 h-8"}),title:"Inactive Users",value:e.inactive_users,bgColor:"bg-red-500"})]}),p&&p.total_alerts>0&&a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-8 border-l-4 border-orange-500",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(Fl,{className:"text-orange-500 w-6 h-6"}),a.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Subscription Alerts"}),a.jsxs("span",{className:"ml-auto bg-orange-100 text-orange-800 px-3 py-1 rounded-full text-sm font-semibold",children:[p.total_alerts," alerts"]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[p.expiring_soon.length>0&&a.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg",children:[a.jsxs("h3",{className:"font-semibold text-yellow-800 mb-2 flex items-center gap-2",children:[a.jsx(zs,{})," Expiring Soon (",p.expiring_soon.length,")"]}),a.jsx("div",{className:"space-y-2",children:p.expiring_soon.map(P=>a.jsxs("div",{className:"text-sm",children:[a.jsx("p",{className:"font-medium text-gray-800",children:P.company_name}),a.jsxs("p",{className:"text-gray-600",children:[P.plan_name," - ",P.days_remaining," days left"]})]},P.id))})]}),p.expired.length>0&&a.jsxs("div",{className:"bg-red-50 p-4 rounded-lg",children:[a.jsxs("h3",{className:"font-semibold text-red-800 mb-2 flex items-center gap-2",children:[a.jsx(Fl,{})," Expired (",p.expired.length,")"]}),a.jsx("div",{className:"space-y-2",children:p.expired.map(P=>a.jsxs("div",{className:"text-sm",children:[a.jsx("p",{className:"font-medium text-gray-800",children:P.company_name}),a.jsxs("p",{className:"text-gray-600",children:[P.plan_name," - Expired"]})]},P.id))})]})]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6",children:[a.jsxs("h2",{className:"text-xl font-semibold text-gray-800",children:["All Tenants (",z.length,")"]}),a.jsxs("div",{className:"flex flex-col md:flex-row gap-3 w-full md:w-auto",children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:()=>N("all"),className:`px-3 py-1 rounded-lg text-sm font-medium transition ${y==="all"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"All"}),a.jsx("button",{onClick:()=>N("active"),className:`px-3 py-1 rounded-lg text-sm font-medium transition ${y==="active"?"bg-green-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"Active"}),a.jsx("button",{onClick:()=>N("expiring"),className:`px-3 py-1 rounded-lg text-sm font-medium transition ${y==="expiring"?"bg-orange-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"Expiring"}),a.jsx("button",{onClick:()=>N("expired"),className:`px-3 py-1 rounded-lg text-sm font-medium transition ${y==="expired"?"bg-red-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"Expired"})]}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",placeholder:"Search tenants...",value:o,onChange:P=>l(P.target.value),className:"pl-10 pr-10 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent w-full md:w-64"}),a.jsx(Kt,{className:"absolute left-3 top-3 text-gray-400"}),o&&a.jsx("button",{onClick:()=>l(""),className:"absolute right-3 top-3 text-gray-400 hover:text-gray-600",children:a.jsx(ea,{})})]})]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Company"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contact"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Users"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Subscription"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:z.map(P=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center",children:[P.company_logo?a.jsx("img",{src:P.company_logo,alt:P.company_name,className:"h-10 w-10 rounded-full object-cover"}):a.jsx("div",{className:"h-10 w-10 rounded-full bg-blue-500 flex items-center justify-center text-white font-semibold",children:P.company_name.charAt(0)}),a.jsxs("div",{className:"ml-4",children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:P.company_name}),a.jsx("div",{className:"text-sm text-gray-500",children:P.company_number})]})]})}),a.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[a.jsx("div",{className:"text-sm text-gray-900",children:P.company_website||"N/A"}),a.jsx("div",{className:"text-sm text-gray-500",children:P.address||"N/A"})]}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"text-sm text-gray-900",children:[a.jsx("span",{className:"text-green-600",children:P.active_users})," / ",P.total_users]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:P.subscription?a.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${P.subscription.status==="Active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:P.subscription.plan_name}):a.jsx("span",{className:"text-sm text-gray-500",children:"No plan"})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(P.created_at).toLocaleDateString()}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:a.jsxs("button",{onClick:()=>T(P.id),className:"text-blue-600 hover:text-blue-900 flex items-center gap-1",children:[a.jsx(md,{})," View"]})})]},P.id))})]})})]}),d&&c&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex justify-between items-center",children:[a.jsxs("h3",{className:"text-xl font-semibold text-gray-800",children:[c.company_name," Details"]}),a.jsx("button",{onClick:()=>h(!1),className:"text-gray-500 hover:text-gray-700",children:""})]}),a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("h4",{className:"text-lg font-semibold mb-3",children:"Company Information"}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 bg-gray-50 p-4 rounded-lg",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Company Number"}),a.jsx("p",{className:"font-medium",children:c.company_number})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Website"}),a.jsx("p",{className:"font-medium",children:c.company_website||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Address"}),a.jsx("p",{className:"font-medium",children:c.address||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Currency"}),a.jsx("p",{className:"font-medium",children:c.currency})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Tax Rate"}),a.jsxs("p",{className:"font-medium",children:[c.tax_rate,"%"]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Territories"}),a.jsx("p",{className:"font-medium",children:c.territories_count})]})]})]}),c.subscription&&a.jsxs("div",{className:"mb-6",children:[a.jsxs("div",{className:"flex justify-between items-center mb-3",children:[a.jsx("h4",{className:"text-lg font-semibold",children:"Subscription"}),a.jsx("button",{onClick:()=>{const P=c.subscription,D=c.id;E(D,P.status)},className:`px-4 py-2 rounded-lg font-medium text-sm transition ${c.subscription.status==="Active"?"bg-red-100 text-red-700 hover:bg-red-200":"bg-green-100 text-green-700 hover:bg-green-200"}`,children:c.subscription.status==="Active"?" Suspend Subscription":" Activate Subscription"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 bg-gray-50 p-4 rounded-lg",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Plan"}),a.jsx("p",{className:"font-medium",children:c.subscription.plan_name})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Status"}),a.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${c.subscription.status==="Active"?"bg-green-100 text-green-800":c.subscription.status==="Cancelled"?"bg-orange-100 text-orange-800":"bg-red-100 text-red-800"}`,children:c.subscription.status})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Start Date"}),a.jsx("p",{className:"font-medium",children:c.subscription.start_date?new Date(c.subscription.start_date).toLocaleDateString():"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"End Date"}),a.jsx("p",{className:"font-medium",children:c.subscription.end_date?new Date(c.subscription.end_date).toLocaleDateString():"N/A"})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Days Remaining"}),a.jsx("p",{className:`font-medium ${(()=>{const P=Math.ceil((new Date(c.subscription.end_date)-new Date)/864e5);return P<=0?"text-red-600":P<=7?"text-orange-600":"text-green-600"})()}`,children:(()=>{const P=Math.ceil((new Date(c.subscription.end_date)-new Date)/864e5);return P<=0?"Expired":`${P} days`})()})]})]})]}),a.jsxs("div",{children:[a.jsxs("h4",{className:"text-lg font-semibold mb-3",children:["Users (",c.users.length,")"]}),a.jsx("div",{className:"space-y-2",children:c.users.map(P=>a.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("p",{className:"font-medium",children:[P.first_name," ",P.last_name]}),a.jsx("p",{className:"text-sm text-gray-500",children:P.email}),a.jsxs("div",{className:"flex gap-2 mt-1",children:[a.jsx("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded",children:P.role}),P.last_login&&a.jsxs("span",{className:"text-xs text-gray-500",children:["Last login: ",new Date(P.last_login).toLocaleDateString()]})]})]}),a.jsxs("button",{onClick:()=>A(P.id,P.is_active),className:`flex items-center gap-2 px-3 py-2 rounded-lg ${P.is_active?"bg-green-100 text-green-700 hover:bg-green-200":"bg-red-100 text-red-700 hover:bg-red-200"}`,children:[P.is_active?a.jsx(soe,{size:20}):a.jsx(noe,{size:20}),P.is_active?"Active":"Inactive"]})]},P.id))})]})]})]})})]})},Cb=({icon:e,title:t,value:n,bgColor:s})=>a.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-600 mb-1",children:t}),a.jsx("p",{className:"text-3xl font-bold text-gray-800",children:n})]}),a.jsx("div",{className:`${s} text-white p-3 rounded-lg`,children:e})]})});function Vze({toggleSidebar:e}){const[t,n]=f.useState(!1),[s,r]=f.useState(!1),[i,o]=f.useState([]),[l,c]=f.useState(0),u=f.useRef(null),d=f.useRef(null),h=ta(),p=kt(),{logout:x}=Ks(),{user:v,fetchUser:j}=Vt(),N={"/sales/overview":"Dashboard","/sales/accounts":"Accounts","/sales/contacts":"Contacts","/sales/leads":"Leads","/sales/deals":"Deals","/sales/quotes":"Quotes","/sales/targets":"Targets","/sales/reports":"Reports","/sales/tasks":"Tasks"}[h.pathname]||"Sales Panel";f.useEffect(()=>{j();const T=()=>{j()};return window.addEventListener("userProfileUpdated",T),()=>{window.removeEventListener("userProfileUpdated",T)}},[]),f.useEffect(()=>{const T=async()=>{try{const A=await re.get("/logs/notifications");console.log(" Fetched notifications from DB:",A.data);const E=(A.data||[]).map(M=>{const z=M.entity_id||M.new_data?.id,P=(M.entity_type||"").toLowerCase();return S({id:M.id,type:M.notif_type||M.notification_type||M.type||w(M),title:M.title||M.description,assignedBy:M.assignedBy||M.name,createdAt:M.createdAt||M.timestamp,read:M.is_read??M.read??!1,leadId:P==="lead"?z:M.leadId||M.lead_id,taskId:P==="task"?z:M.taskId||M.task_id,contactId:P==="contact"?z:M.contactId||M.contact_id,dealId:P==="deal"?z:M.dealId||M.deal_id,accountId:P==="account"?z:M.accountId||M.account_id})});o(E),c(E.filter(M=>!M.read).length)}catch(A){console.error("Failed to load history notifications",A)}};v?.id&&T()},[v?.id]);const w=T=>{const A=String(T.action||T.type||"").toUpperCase(),E={TASK_ASSIGNMENT:"task_assignment",LEAD_ASSIGNMENT:"lead_assignment",LEAD_UPDATE:"lead_update",CONTACT_ASSIGNMENT:"contact_assignment",CONTACT_UPDATE:"contact_update",DEAL_ASSIGNMENT:"deal_assignment",DEAL_UPDATE:"deal_update",ACCOUNT_ASSIGNMENT:"account_assignment",ACCOUNT_UPDATE:"account_update",TERRITORY_ASSIGNMENT:"territory_assignment",CREATE:"create",UPDATE:"update",DELETE:"delete"};if(E[A])return E[A];const M=String(T.title||T.description||"").toLowerCase(),z=String(T.entity_type||"").toLowerCase(),P=A.includes("UPDATE"),D=A.includes("CREATE");return A.includes("DELETE"),M.includes("task")||z==="task"?P?"task_update":"task_assignment":M.includes("territory")||z==="territory"?"territory_assignment":M.includes("lead")||z==="lead"?P?"lead_update":D?"lead_assignment":"lead_update":M.includes("contact")||z==="contact"?P?"contact_update":D?"contact_assignment":"contact_update":M.includes("deal")||z==="deal"?P?"deal_update":D?"deal_assignment":"deal_update":M.includes("account")||z==="account"?P?"account_update":D?"account_assignment":"account_update":M.includes("quote")||z==="quote"?"quote":M.includes("meeting")||z==="meeting"?"meeting":M.includes("call")||z==="call"?"call":"info"},S=T=>{const A={...T};switch(A.read=!!A.read,A.type){case"territory_assignment":A.title=A.title||`You have been assigned to ${A.territoryName||"a territory"}`;break;case"lead_assigned":A.type="lead_assignment",A.title=A.title||`New lead assigned: ${A.leadName||A.company||"Lead"}`;break;case"lead_assignment":A.title=A.title||`New lead assigned: ${A.leadName||A.company||"Lead"}`;break;case"lead_update":A.title=A.title||`Lead updated: ${A.leadName||A.company||"Lead"}`;break;case"task_assignment":case"task_update":A.title=A.title||`Task: ${A.taskTitle||"Task"}`;break;case"contact_assignment":A.title=A.title||`New contact assigned: ${A.contactName||A.contact||"Contact"}`;break;case"contact_update":A.title=A.title||`Contact updated: ${A.contactName||A.contact||"Contact"}`;break;case"deal_assignment":A.title=A.title||`New deal assigned: ${A.dealName||A.name||"Deal"}`;break;case"deal_update":A.title=A.title||`Deal updated: ${A.dealName||A.name||"Deal"}`;break;case"account_assignment":A.title=A.title||`New account assigned: ${A.accountName||A.name||"Account"}`;break;case"account_update":A.title=A.title||`Account updated: ${A.accountName||A.name||"Account"}`;break;case"quote":A.title=A.title||"Quote activity";break;case"meeting":A.title=A.title||"Meeting activity";break;case"call":A.title=A.title||"Call activity";break;default:A.title=A.title||"Activity"}return A},_=T=>{switch(T.type){case"task_assignment":p(`/sales/tasks/${T.taskId||T.task_id||""}`);break;case"lead_assignment":case"lead_update":p(`/sales/leads/${T.leadId||T.lead_id||""}`);break;case"contact_assignment":case"contact_update":p(`/sales/contacts/${T.contactId||T.contact_id||""}`);break;case"deal_assignment":case"deal_update":p(`/sales/deals/${T.dealId||T.deal_id||""}`);break;case"account_assignment":case"account_update":p(`/sales/accounts/${T.accountId||T.account_id||""}`);break;default:p("/sales/overview")}},k=async T=>{if(T.read){_(T);return}try{await re.patch(`/logs/mark-read/${T.id}`),o(A=>A.map(E=>E.id===T.id?{...E,read:!0}:E)),c(A=>A>0?A-1:0),_(T)}catch(A){console.error("Failed to mark notification as read",A),_(T)}};return f.useEffect(()=>{if(!v?.id)return;const T=Mj(v.id);console.log(" Connecting to WebSocket:",T);const A=new WebSocket(T);let E;const M=()=>{E=setTimeout(()=>{console.log(" Attempting WebSocket reconnection...")},3e3)};return A.onopen=()=>{console.log(" Sales WS Connected to:",T),clearTimeout(E)},A.onmessage=z=>{try{const P=JSON.parse(z.data);console.log(" Notification received:",P);const D=S(P);o(U=>[D,...U]),c(U=>U+1)}catch(P){console.error("Error parsing notification:",P)}},A.onclose=()=>{console.log(" Sales WS Disconnected"),M()},A.onerror=z=>{console.error(" Sales WS Error:",z)},()=>{clearTimeout(E),A&&A.readyState===WebSocket.OPEN&&A.close()}},[v?.id]),f.useEffect(()=>{function T(A){u.current&&!u.current.contains(A.target)&&n(!1),d.current&&!d.current.contains(A.target)&&r(!1)}return document.addEventListener("mousedown",T),()=>document.removeEventListener("mousedown",T)},[]),a.jsxs("header",{className:"flex justify-between items-center bg-white shadow px-4 sm:px-6 py-3 border-b relative",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("button",{onClick:e,className:"lg:hidden text-gray-700 hover:text-gray-900",children:a.jsx(th,{className:"text-2xl"})}),v?.company?.company_logo&&a.jsx("img",{src:v.company.company_logo,alt:"Company Logo",className:"w-20 h-10 object-contain rounded"}),a.jsx("h1",{className:"text-lg sm:text-xl font-semibold text-gray-800 truncate max-w-[150px] sm:max-w-none",children:N})]}),a.jsxs("div",{className:"flex items-center space-x-3 sm:space-x-4",children:[a.jsxs("div",{className:"relative",ref:d,children:[a.jsxs("button",{onClick:()=>r(!s),className:"relative text-gray-600 hover:text-gray-800 transition",children:[a.jsx(mx,{className:"text-xl sm:text-2xl"}),l>0&&a.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-[10px] w-4 h-4 flex items-center justify-center rounded-full font-semibold",children:l})]}),s&&a.jsxs("div",{className:"absolute right-0 mt-3 w-80 bg-white rounded-xl shadow-lg border z-50 overflow-hidden animate-fade-in",children:[a.jsxs("div",{className:"p-3 border-b bg-gray-50 flex justify-between items-center",children:[a.jsx("h3",{className:"font-semibold text-gray-800 text-sm",children:"Notifications"}),i.length>0&&a.jsx("button",{onClick:async()=>{try{await re.patch("/logs/mark-all-read"),o(T=>T.map(A=>({...A,read:!0}))),c(0)}catch(T){console.error("Failed to mark all notifications as read",T)}},className:"text-xs text-blue-600 hover:underline",children:"Clear all"})]}),a.jsx("div",{className:"max-h-80 overflow-y-auto",children:i.length>0?i.map((T,A)=>a.jsxs("div",{onClick:()=>k(T),className:`p-4 border-b hover:bg-gray-50 cursor-pointer transition ${T.read?"bg-gray-50":"bg-white"}`,children:[a.jsxs("div",{className:"flex justify-between items-center mb-1",children:[a.jsx("span",{className:`text-[10px] px-2 py-1 rounded-full font-semibold uppercase
                            ${T.type==="task_assignment"||T.type==="task_update"?"bg-purple-100 text-purple-700":T.type==="lead_assignment"||T.type==="lead_update"?"bg-green-100 text-green-700":T.type==="contact_assignment"||T.type==="contact_update"?"bg-amber-100 text-amber-700":T.type==="deal_assignment"||T.type==="deal_update"?"bg-indigo-100 text-indigo-700":T.type==="account_assignment"||T.type==="account_update"?"bg-cyan-100 text-cyan-700":T.type==="territory_assignment"?"bg-blue-100 text-blue-700":T.type==="quote"?"bg-pink-100 text-pink-700":T.type==="meeting"?"bg-teal-100 text-teal-700":T.type==="call"?"bg-red-100 text-red-700":T.type==="create"?"bg-emerald-100 text-emerald-700":T.type==="update"?"bg-yellow-100 text-yellow-700":T.type==="delete"?"bg-rose-100 text-rose-700":"bg-gray-100 text-gray-700"}`,children:T.type==="task_assignment"||T.type==="task_update"?"Task":T.type==="lead_assignment"?"Lead":T.type==="lead_update"?"Lead Update":T.type==="contact_assignment"?"Contact":T.type==="contact_update"?"Contact Update":T.type==="deal_assignment"?"Deal":T.type==="deal_update"?"Deal Update":T.type==="account_assignment"?"Account":T.type==="account_update"?"Account Update":T.type==="territory_assignment"?"Territory":T.type==="quote"?"Quote":T.type==="meeting"?"Meeting":T.type==="call"?"Call":T.type==="create"?"Created":T.type==="update"?"Updated":T.type==="delete"?"Deleted":"Activity"}),!T.read&&a.jsx("span",{className:"w-2 h-2 rounded-full bg-red-500"})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"font-medium text-gray-800 text-sm",children:T.title}),a.jsx("span",{className:"text-xs text-gray-600 mt-0.5",children:T.assignedBy?`Assigned by ${T.assignedBy}`:"System"}),a.jsx("span",{className:"text-[11px] text-gray-400 mt-1",children:T.createdAt?new Date(T.createdAt).toLocaleString():""})]})]},T.id??A)):a.jsx("div",{className:"p-6 text-center text-gray-500 text-sm",children:"No new notifications"})})]})]}),a.jsxs("div",{className:"relative",ref:u,children:[a.jsxs("button",{onClick:()=>n(!t),className:"flex items-center gap-2 cursor-pointer hover:bg-gray-100 px-2 py-1 rounded",children:[a.jsx("img",{src:v?.profile_picture||"https://via.placeholder.com/40",alt:"Profile",className:"w-8 aspect-square object-cover rounded-full"}),a.jsxs("span",{className:"hidden lg:inline text-sm font-medium text-gray-700",children:[v?.first_name," ",v?.last_name]})]}),t&&a.jsxs("div",{className:"absolute right-0 mt-2 w-64 bg-white shadow-xl rounded-xl border border-gray-200 z-50 p-4",children:[a.jsxs("div",{className:"flex flex-col items-center text-center space-y-3",children:[a.jsx("img",{src:v?.profile_picture||"https://via.placeholder.com/80",alt:"Profile",className:"w-16 h-16 rounded-full object-cover"}),a.jsxs("div",{children:[a.jsxs("h2",{className:"text-gray-800 font-semibold text-sm",children:[v?.first_name," ",v?.middle_name," ",v?.last_name]}),a.jsx("p",{className:"text-[11px] text-gray-600 font-light w-full truncate",children:"Sales"})]}),v?.company&&a.jsxs("div",{className:"flex items-center gap-2 pt-2 border-t border-gray-100 w-full justify-center",children:[v.company.company_logo&&a.jsx("img",{src:v.company.company_logo,alt:"Company Logo",className:"w-6 h-6 object-contain rounded"}),a.jsx("span",{className:"text-xs text-gray-500 truncate",children:v.company.company_name})]})]}),a.jsxs("div",{className:"mt-4 space-y-1 px-4 text-left",children:[a.jsx("button",{className:"block w-full text-sm text-gray-700 hover:bg-gray-50 py-2 rounded text-left",onClick:()=>{p("/sales/manage-account"),n(!1)},children:"Manage Your Account"}),a.jsx("div",{className:"border-t border-gray-200 my-2"}),a.jsx("button",{onClick:x,className:"block w-full text-sm text-red-600 hover:text-red-700 hover:bg-gray-50 py-2 rounded text-left",children:"Logout"})]})]})]})]})]})}function Yze(){const[e,t]=f.useState(!1),[n,s]=f.useState(!1),{user:r}=Vt(),[i,o]=f.useState(!1);f.useEffect(()=>{r&&console.log("Fetched user:",r)},[r]);const l=["/sales/overview","/sales/hub","/sales/accounts","/sales/contacts","/sales/leads","/sales/deals","/sales/quotes","/sales/targets"],c=ta();l.includes(c.pathname);const u="flex items-center gap-3 px-3 py-2 rounded-lg bg-white text-[#1e293b] font-semibold shadow-sm",d="flex items-center gap-3 px-3 py-2 rounded-lg text-gray-300 hover:bg-[#334155] hover:text-white transition";return a.jsxs("div",{className:"flex h-screen bg-gray-100 overflow-hidden",children:[a.jsxs("div",{className:`fixed top-0 left-0 h-screen w-64 bg-[#1e293b] text-white flex flex-col shadow-lg transform transition-transform duration-300 z-50
        ${e?"translate-x-0":"-translate-x-full"} lg:translate-x-0`,children:[a.jsxs("div",{className:"px-4 py-3 bg-[#fbbf24] leading-none",children:[a.jsxs("p",{className:"text-gray-900 font-bold text-lg m-0 p-0",children:[" Sari-Sari.CRM"," ",a.jsx("span",{className:"text-[12px] text-gray-700 font-medium align-bottom",children:"v2"})]}),r&&r.company&&a.jsx("p",{className:"text-[12px] text-gray-600 font-medium w-full truncate",children:r.company.company_name})]}),a.jsxs("nav",{className:"flex-1 overflow-y-auto p-4 space-y-2 hide-scrollbar",children:[a.jsxs(Ft,{to:"/sales/overview",className:({isActive:h})=>h?u:d,children:[a.jsx(eh,{})," Dashboard"]}),a.jsxs("div",{children:[a.jsxs("button",{className:"w-full px-3 py-2 flex justify-between items-center text-sm font-medium text-gray-300 hover:bg-[#334155] rounded-lg transition",onClick:()=>o(!i),children:[a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx(sa,{className:"text-lg"}),"Sales"]}),a.jsx(Pt,{className:`transition-transform ${i?"rotate-180":""}`})]}),i&&a.jsxs("div",{className:"ml-6 mt-2 space-y-1",children:[a.jsxs(Ft,{to:"/sales/accounts",className:({isActive:h})=>h?u:d,children:[a.jsx(ac,{})," Accounts"]}),a.jsxs(Ft,{to:"/sales/contacts",className:({isActive:h})=>h?u:d,children:[a.jsx(ra,{})," Contacts"]}),a.jsxs(Ft,{to:"/sales/leads",className:({isActive:h})=>h?u:d,children:[a.jsx(Xa,{})," Leads"]}),a.jsxs(Ft,{to:"/sales/deals",className:({isActive:h})=>h?u:d,children:[a.jsx(sa,{})," Deals"]}),a.jsxs(Ft,{to:"/sales/quotes",className:({isActive:h})=>h?u:d,children:[a.jsx(ia,{})," Quotes"]}),a.jsxs(Ft,{to:"/sales/targets",className:({isActive:h})=>h?u:d,children:[a.jsx(fr,{})," Targets"]})]})]}),a.jsxs("div",{children:[a.jsxs("button",{className:"w-full px-3 py-2 flex justify-between items-center text-sm font-medium text-gray-300 hover:bg-[#334155] rounded-lg transition",onClick:()=>s(!n),children:[a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx(ks,{className:"text-lg"}),"Activity"]}),a.jsx(Pt,{className:`transition-transform ${n?"rotate-180":""}`})]}),n&&a.jsxs("div",{className:"ml-6 mt-2 space-y-1",children:[a.jsxs(Ft,{to:"/sales/tasks",className:({isActive:h})=>h?u:d,children:[a.jsx(Qt,{})," Tasks"]}),a.jsxs(Ft,{to:"/sales/meetings",className:({isActive:h})=>h?u:d,children:[a.jsx(Ot,{})," Meetings"]}),a.jsxs(Ft,{to:"/sales/calls",className:({isActive:h})=>h?u:d,children:[a.jsx(Fs,{})," Calls"]}),a.jsxs(Ft,{to:"/sales/audit",className:({isActive:h})=>h?u:d,children:[a.jsx(ks,{})," Audit"]})]})]}),a.jsx("div",{children:a.jsx(Ft,{to:"/sales/territory",className:({isActive:h})=>h?u:d,children:a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx(tc,{className:"text-lg"}),"Territory"]})})}),a.jsxs(Ft,{to:"/sales/manage-account",className:({isActive:h})=>h?u:d,children:[a.jsx(ra,{className:"text-lg"}),a.jsx("span",{children:"Your Profile"})]})]}),a.jsxs("div",{className:"px-4 py-3 text-xs text-gray-400 border-t border-gray-700",children:[" ",new Date().getFullYear()," Sari-Sari CRM"]})]}),e&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 lg:hidden",onClick:()=>t(!1)}),a.jsxs("div",{className:"flex-1 flex flex-col lg:ml-64 overflow-hidden",children:[a.jsx(Vze,{toggleSidebar:()=>t(!0)}),a.jsx("main",{className:"flex-1 p-6 overflow-auto hide-scrollbar",style:{backgroundColor:"#fffeee"},children:a.jsx(Xf,{})})]})]})}const Qze=e=>a.jsx(Kt,{...e}),Kze=e=>a.jsx(ac,{...e}),nJ=e=>a.jsx(zs,{...e}),sJ=e=>a.jsx(ux,{...e}),rJ=e=>a.jsx(hj,{...e}),Xze=e=>a.jsx(Ot,{...e}),Zze=e=>a.jsx(It,{...e}),Jze=e=>a.jsx(pj,{...e}),iJ=e=>a.jsx(gj,{...e}),eFe=e=>a.jsx(Za,{...e}),oJ=e=>a.jsx(ra,{...e}),tFe=e=>a.jsx(Xa,{...e}),lJ=e=>a.jsx(sa,{...e}),aFe=e=>a.jsx(ia,{...e}),cJ=e=>a.jsx(fr,{...e}),Gw=e=>a.jsx(Qa,{...e}),Ww=e=>a.jsx(Ot,{...e}),Vw=e=>a.jsx(Fs,{...e}),nFe=e=>a.jsx(tc,{...e}),sFe=e=>a.jsx(ks,{...e}),dJ=(e,t="")=>{const n=parseFloat(e)||0;return new Intl.NumberFormat("en-US",{notation:"compact",compactDisplay:"short",maximumFractionDigits:1}).format(n).replace(/^/,`${t} `)},rFe=e=>{switch(e){case"Negotiation":return{text:"text-purple-700",bg:"bg-purple-100"};case"Proposal":return{text:"text-red-700",bg:"bg-red-100"};case"Qualification":return{text:"text-yellow-700",bg:"bg-yellow-100"};case"Prospecting":return{text:"text-blue-700",bg:"bg-blue-100"};case"Closed Won":return{text:"text-green-700",bg:"bg-green-100"};case"Closed Lost":return{text:"text-red-700",bg:"bg-red-100"};default:return{text:"text-gray-700",bg:"bg-gray-100"}}},iFe=e=>{switch(e){case"Website":return{text:"text-green-600",bg:"bg-green-100"};case"Referral":return{text:"text-purple-600",bg:"bg-purple-100"};case"Trade Show":return{text:"text-orange-600",bg:"bg-orange-100"};case"Cold Call":return{text:"text-red-600",bg:"bg-red-100"};default:return{text:"text-gray-600",bg:"bg-gray-100"}}},oFe=e=>{switch(e){case"call":return{Icon:Zze,color:"text-red-500",bgColor:"bg-red-100"};case"qualification":return{Icon:Jze,color:"text-green-600",bgColor:"bg-green-100"};default:return{Icon:Xze,color:"text-blue-500",bgColor:"bg-blue-100"}}},lFe=e=>{switch(e.toUpperCase()){case"HIGH":return{text:"text-red-700",bg:"bg-red-100"};case"LOW":return{text:"text-blue-700",bg:"bg-blue-100"};default:return{text:"text-gray-700",bg:"bg-gray-100"}}},cFe=({searchQuery:e,onSearchChange:t,searchResults:n,onSearchResultClick:s})=>{const r=kt(),[i,o]=f.useState(!1),l=f.useRef(null),c=[{icon:Kze,label:"Account"},{icon:oJ,label:"Contact"},{icon:tFe,label:"Leads"},{icon:lJ,label:"Deals"},{icon:aFe,label:"Quotes"},{icon:cJ,label:"Target"},{icon:Gw,label:"Task"},{icon:Ww,label:"Meeting"},{icon:Vw,label:"Call"},{icon:sFe,label:"Audit"},{icon:nFe,label:"Territory"}];f.useEffect(()=>{const h=p=>{l.current&&!l.current.contains(p.target)&&o(!1)};return document.addEventListener("mousedown",h),()=>document.removeEventListener("mousedown",h)},[]);const u=h=>{t(h.target.value),o(h.target.value.trim().length>0)},d=h=>{s&&s(h),o(!1)};return a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-3 sm:p-4 flex flex-col items-start space-y-4 w-full",children:[a.jsxs("div",{className:"w-full flex justify-center relative",ref:l,children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg lg:mt-3 px-4 py-2 w-full max-w-md md:max-w-lg lg:max-w-2xl focus-within:ring-2 focus-within:ring-blue-500 transition duration-150",children:[a.jsx(Qze,{size:20,className:"text-gray-400 mr-3 flex-shrink-0"}),a.jsx("input",{type:"text",placeholder:"Search Leads, Deals, or Accounts...",className:"focus:outline-none text-base w-full",value:e,onChange:u,onFocus:()=>e.trim().length>0&&o(!0)})]}),i&&Array.isArray(n)&&n.length>0&&a.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 mt-2 w-full max-w-md md:max-w-lg lg:max-w-2xl bg-white rounded-lg shadow-xl border border-gray-200 z-50 max-h-96 overflow-y-auto",children:n.map((h,p)=>a.jsx("div",{className:"px-4 py-3 hover:bg-gray-50 cursor-pointer border-b border-gray-100 last:border-b-0 transition duration-150",onClick:()=>d(h),children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-semibold text-gray-800 text-sm",children:h.name}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:h.type}),h.details&&a.jsx("p",{className:"text-xs text-gray-400 mt-1",children:h.details})]}),a.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${h.type==="Lead"?"bg-blue-100 text-blue-600":h.type==="Deal"?"bg-yellow-100 text-yellow-600":"bg-green-100 text-green-600"}`,children:h.type})]})},p))}),i&&e.trim().length>0&&(!Array.isArray(n)||n.length===0)&&a.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 mt-2 w-full max-w-md md:max-w-lg lg:max-w-2xl bg-white rounded-lg shadow-xl border border-gray-200 z-50 p-4 text-center text-sm text-gray-500",children:"No results found"})]}),a.jsx("div",{className:"w-full overflow-x-auto lg:overflow-x-hidden scroll-smooth flex justify-center",children:a.jsx("div",{className:"flex flex-nowrap space-x-3 lg:space-x-4 xl:space-x-3 px-2 sm:px-0",children:c.map((h,p)=>a.jsxs("div",{className:"relative flex-shrink-0 group flex items-center justify-center",children:[a.jsx("button",{className:"p-3 text-gray-500 hover:text-gray-900 transition duration-150 rounded-full hover:bg-gray-100 focus:outline-none cursor-pointer","aria-label":h.label,title:h.label,onClick:()=>{switch(h.label){case"Account":r("/sales/accounts");break;case"Contact":r("/sales/contacts");break;case"Leads":r("/sales/leads");break;case"Deals":r("/sales/deals");break;case"Quotes":r("/sales/quotes");break;case"Target":r("/sales/targets");break;case"Task":r("/sales/tasks");break;case"Meeting":r("/sales/meetings");break;case"Call":r("/sales/calls");break;case"Audit":r("/sales/audit");break;case"Territory":r("/sales/territory");break;default:console.log(`Clicked ${h.label}`)}},children:a.jsx(h.icon,{size:24,className:"lg:scale-95"})}),a.jsxs("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 px-3 py-1.5 bg-gray-900 text-white text-xs font-semibold rounded-md whitespace-nowrap opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-75 ease-in-out z-50 shadow-lg",children:[h.label,a.jsx("div",{className:"absolute top-full left-1/2 -translate-x-1/2 -mt-1 border-4 border-transparent border-t-gray-900"})]})]},p))})})]})},dFe=({action:e,description:t,entity_type:n,entity_name:s,timestamp:r})=>{const i=kt(),o=d=>{if(!d)return"Unknown";const h=new Date(d),x=new Date-h,v=Math.floor(x/6e4),j=Math.floor(x/36e5),y=Math.floor(x/864e5);return v<1?"Just now":v<60?`${v} min ago`:j<24?`${j} hour${j>1?"s":""} ago`:y<7?`${y} day${y>1?"s":""} ago`:h.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},l=e||t||"Action",c=s||n||"System",u=o(r);return a.jsxs("li",{className:"flex justify-between items-center py-2 border-b border-gray-100 last:border-b-0 cursor-pointer hover:bg-gray-50 transition duration-150 px-2 -mx-2 rounded-md",onClick:()=>i("/sales/audit"),children:[a.jsxs("p",{className:"text-sm text-gray-800 flex-grow font-medium",children:[l," ",a.jsxs("span",{className:"text-gray-500 italic text-xs",children:["(",c,")"]})]}),a.jsx("span",{className:"text-xs text-gray-400 flex-shrink-0 ml-4",children:u})]})},uFe=({logs:e,loading:t})=>{const n=kt();return a.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg border border-gray-100 flex flex-col h-full",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h2",{className:"text-md font-semibold text-gray-800",children:"Recent Logs"}),a.jsxs("span",{className:"text-sm text-blue-500 cursor-pointer hover:underline flex items-center space-x-1 font-medium",onClick:()=>n("/sales/audit"),children:[a.jsx("span",{children:"See All"}),a.jsx(iJ,{size:14,className:"transform -rotate-45"})]})]}),e&&e.length>0?a.jsx("ul",{className:"space-y-1",children:e.slice(0,3).map((s,r)=>a.jsx(dFe,{...s},r))}):a.jsx("div",{className:"text-sm text-gray-500 py-4",children:"No recent logs"})]})},mFe=({icon:e,title:t,value:n,color:s,bgColor:r,loading:i,onClick:o})=>a.jsxs("div",{className:"flex items-center p-4 bg-white rounded-xl shadow-md border border-gray-200 transition-all duration-300",onClick:o||(()=>console.log(`Clicked metric card: ${t}`)),children:[a.jsx("div",{className:`p-3 rounded-full ${r} ${s} mr-4`,children:a.jsx(e,{size:20})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-500 font-medium uppercase",children:t}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:n||0})]})]}),fFe=({revenueData:e,loading:t})=>{const n=kt(),s=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],r=f.useMemo(()=>{if(console.log("=== RevenueChart calculateRevenueData ==="),console.log("revenueData:",e),console.log("revenueData length:",e?.length),!e||e.length===0){console.log("No revenue data, returning empty chart");const y=new Date;y.getFullYear();const N=y.getMonth(),w=[],S=[];for(let _=0;_<=N;_++)w.push(s[_]),S.push(0);return{labels:w,revenues:S,maxRevenue:0}}const l={};let c=0,u=0;console.log("Processing deals:",e.length),e.forEach((y,N)=>{const w=y.close_date||y.closeDate||null,S=w&&w!==null&&w!=="",_=y.stage||"",k=_.toUpperCase()==="CLOSED_WON"||_==="CLOSED_WON";let T=y.amount;T&&typeof T=="object"&&T.toString?T=parseFloat(T.toString()):T=parseFloat(T)||0;const A=T>0;if(k&&(u++,console.log(`Deal ${N+1} (CLOSED_WON):`,{id:y.id,name:y.name,stage:_,close_date:w,close_date_type:typeof w,amount:T,amount_type:typeof y.amount,hasCloseDate:S,hasAmount:A,willBeAdded:S&&A,allFields:Object.keys(y)})),S&&k&&A)try{let E=new Date(w);if(isNaN(E.getTime())){const M=String(w).split("T")[0];E=new Date(M+"T00:00:00")}if(isNaN(E.getTime()))console.warn(` Invalid date for deal ${y.id}:`,w,"Type:",typeof w);else{const M=E.getFullYear(),z=E.getMonth()+1,P=`${M}-${String(z).padStart(2,"0")}`;l[P]||(l[P]=0),l[P]+=T,c++,console.log(` Added deal ${y.id} to month ${P}: ${T}, total: ${l[P]}`),console.log(`  - Close date: ${w} -> Parsed: ${E.toISOString()} -> Month: ${P} (Year: ${M}, Month: ${z})`)}}catch(E){console.error("Error parsing deal date:",w,E)}else k&&console.warn(` Deal ${y.id} is CLOSED_WON but missing data:`,{hasCloseDate:S,hasAmount:A,closeDate:w,amount:T,originalAmount:y.amount})}),console.log("Summary:",{totalDeals:e.length,closedWonDeals:u,validDealsForGraph:c,monthlyRevenue:l});const d=Object.keys(l).map(y=>parseInt(y.split("-")[0])),h=d.length>0?[...new Set(d)].sort():[],p=new Date().getFullYear();new Date().getMonth();const x=[],v=[];for(let y=0;y<12;y++){const N=`${p}-${String(y+1).padStart(2,"0")}`;x.push(s[y]);const w=l[N]||0;v.push(w),w>0&&console.log(`Month ${s[y]} (${N}): ${w}`)}if(h.length>0){const y=Math.max(...h);if(y>p)for(let N=p+1;N<=y;N++)for(let w=0;w<12;w++){const S=`${N}-${String(w+1).padStart(2,"0")}`,_=l[S]||0;x.push(`${s[w]} ${N}`),v.push(_),_>0&&console.log(`Month ${s[w]} ${N} (${S}): ${_}`)}}const j=Math.max(...v,1);return console.log("Final chart data:",{labels:x,revenues:v,maxRevenue:j,hasData:v.some(y=>y>0)}),{labels:x,revenues:v,maxRevenue:j}},[e]),i=r.labels,o=r.revenues;return console.log("=== FINAL CHART DATA ==="),console.log("X Axis (Months):",i),console.log("Y Axis (Revenue):",o),console.log("Has any revenue > 0:",o.some(l=>l>0)),console.log("All revenue values:",o),console.log("Max revenue:",r.maxRevenue),a.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg h-full flex flex-col",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Revenue Overview"}),a.jsxs("span",{className:"text-sm text-blue-500 cursor-pointer hover:underline flex items-center space-x-1 font-medium",onClick:()=>n("/sales/deals"),children:[a.jsx("span",{children:"See All"}),a.jsx(iJ,{size:14,className:"transform -rotate-45"})]})]}),a.jsx("div",{className:"h-80 relative flex-1 flex items-center justify-center p-6",children:a.jsx("div",{className:"w-full h-full flex items-center justify-center",children:i&&i.length>0&&o&&o.length>0?a.jsx(lh,{xAxis:[{data:i,scaleType:"point"}],yAxis:[{valueFormatter:l=>l>=1e3?`${(l/1e3).toFixed(0)}k`:l.toString()}],series:[{data:o,showMark:!0,area:!0}],height:320,width:void 0,grid:{vertical:!0,horizontal:!0},margin:{top:40,right:40,bottom:50,left:50},sx:{width:"100%",maxWidth:"100%"}}):a.jsxs("div",{className:"text-center text-gray-500",children:[a.jsx("p",{className:"text-sm",children:"No revenue data available"}),a.jsx("p",{className:"text-xs mt-2",children:"Closed won deals with close dates will appear here"})]})})})]})},hFe=({activityData:e,loading:t})=>{const[n,s]=f.useState(!0),[r,i]=f.useState(!0),[o,l]=f.useState(!0),[c,u]=f.useState(!0),[d,h]=f.useState("monthly"),p=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],x=["Q1","Q2","Q3","Q4"],v=R=>{const q=[0,0,0,0];for(let Z=0;Z<12;Z++){const V=Math.floor(Z/3);q[V]+=R[Z]}return q},j=R=>[R.reduce((q,Z)=>q+Z,0)],y=f.useMemo(()=>{if(!e){const ke=new Array(12).fill(0),ge=new Array(4).fill(0),$e=new Array(1).fill(0);return{labels:d==="monthly"?p:d==="quarterly"?x:[new Date().getFullYear().toString()],tasksCurrentYear:d==="monthly"?ke:d==="quarterly"?ge:$e,tasksLastYear:d==="monthly"?ke:d==="quarterly"?ge:$e,meetingsCurrentYear:d==="monthly"?ke:d==="quarterly"?ge:$e,meetingsLastYear:d==="monthly"?ke:d==="quarterly"?ge:$e,callsCurrentYear:d==="monthly"?ke:d==="quarterly"?ge:$e,callsLastYear:d==="monthly"?ke:d==="quarterly"?ge:$e}}const R=e.tasks?.currentYear||new Array(12).fill(0),q=e.tasks?.lastYear||new Array(12).fill(0),Z=e.meetings?.currentYear||new Array(12).fill(0),V=e.meetings?.lastYear||new Array(12).fill(0),oe=e.calls?.currentYear||new Array(12).fill(0),je=e.calls?.lastYear||new Array(12).fill(0);let X,se,ye,Ne,fe,we,de;return d==="monthly"?(X=p,se=R,ye=q,Ne=Z,fe=V,we=oe,de=je):d==="quarterly"?(X=x,se=v(R),ye=v(q),Ne=v(Z),fe=v(V),we=v(oe),de=v(je)):(X=[new Date().getFullYear().toString()],se=j(R),ye=j(q),Ne=j(Z),fe=j(V),we=j(oe),de=j(je)),{labels:X,tasksCurrentYear:se,tasksLastYear:ye,meetingsCurrentYear:Ne,meetingsLastYear:fe,callsCurrentYear:we,callsLastYear:de}},[e,d]),N=y.tasksCurrentYear.some(R=>R>0)||y.tasksLastYear.some(R=>R>0)||y.meetingsCurrentYear.some(R=>R>0)||y.meetingsLastYear.some(R=>R>0)||y.callsCurrentYear.some(R=>R>0)||y.callsLastYear.some(R=>R>0),w=y.tasksCurrentYear.reduce((R,q)=>R+q,0),S=y.meetingsCurrentYear.reduce((R,q)=>R+q,0),_=y.callsCurrentYear.reduce((R,q)=>R+q,0),k=w+S+_,T=y.tasksLastYear.reduce((R,q)=>R+q,0),A=y.meetingsLastYear.reduce((R,q)=>R+q,0),E=y.callsLastYear.reduce((R,q)=>R+q,0),M=T+A+E,z=M>0?((k-M)/M*100).toFixed(1):0,P=T>0?((w-T)/T*100).toFixed(0):w>0?100:0,D=A>0?((S-A)/A*100).toFixed(0):S>0?100:0,U=E>0?((_-E)/E*100).toFixed(0):_>0?100:0,B=[];return n&&(B.push({data:y.tasksCurrentYear,label:`Tasks ${new Date().getFullYear()}`,color:"#10b981",showMark:!0,curve:"catmullRom"}),c&&B.push({data:y.tasksLastYear,label:`Tasks ${new Date().getFullYear()-1}`,color:"#86efac",showMark:!1,curve:"linear"})),r&&(B.push({data:y.meetingsCurrentYear,label:`Meetings ${new Date().getFullYear()}`,color:"#14b8a6",showMark:!0,curve:"catmullRom"}),c&&B.push({data:y.meetingsLastYear,label:`Meetings ${new Date().getFullYear()-1}`,color:"#5eead4",showMark:!1,curve:"linear"})),o&&(B.push({data:y.callsCurrentYear,label:`Calls ${new Date().getFullYear()}`,color:"#6366f1",showMark:!0,curve:"catmullRom"}),c&&B.push({data:y.callsLastYear,label:`Calls ${new Date().getFullYear()-1}`,color:"#a5b4fc",showMark:!1,curve:"linear"})),a.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg border border-gray-100 flex flex-col h-full",children:[a.jsxs("div",{className:"flex justify-between items-start mb-4",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("h2",{className:"text-lg font-semibold text-gray-800 flex items-center",children:["My Activities",N&&a.jsxs("span",{className:`ml-3 text-sm font-medium px-2 py-1 rounded-full ${z>=0?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:[z>=0?"":""," ",Math.abs(z),"%"]})]}),a.jsxs("select",{value:d,onChange:R=>h(R.target.value),className:"text-xs px-3 py-1.5 rounded-lg border border-gray-300 bg-white text-gray-700 font-medium focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 cursor-pointer",children:[a.jsx("option",{value:"monthly",children:"Monthly"}),a.jsx("option",{value:"quarterly",children:"Quarterly"}),a.jsx("option",{value:"yearly",children:"Yearly"})]})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Track your productivity across tasks, meetings & calls"})]}),N&&a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"text-3xl font-bold text-gray-800",children:k}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Total this year"})]})]}),N&&a.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-4",children:[a.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 p-3 rounded-lg border border-green-200",children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsx(Gw,{size:16,className:"text-green-600"}),P!==0&&a.jsxs("span",{className:`text-xs font-semibold ${P>=0?"text-green-700":"text-red-600"}`,children:[P>=0?"+":"",P,"%"]})]}),a.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Tasks"}),a.jsx("p",{className:"text-xl font-bold text-green-700",children:w}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["vs ",T," last year"]})]}),a.jsxs("div",{className:"bg-gradient-to-br from-teal-50 to-teal-100 p-3 rounded-lg border border-teal-200",children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsx(Ww,{size:16,className:"text-teal-600"}),D!==0&&a.jsxs("span",{className:`text-xs font-semibold ${D>=0?"text-teal-700":"text-red-600"}`,children:[D>=0?"+":"",D,"%"]})]}),a.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Meetings"}),a.jsx("p",{className:"text-xl font-bold text-teal-700",children:S}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["vs ",A," last year"]})]}),a.jsxs("div",{className:"bg-gradient-to-br from-indigo-50 to-indigo-100 p-3 rounded-lg border border-indigo-200",children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsx(Vw,{size:16,className:"text-indigo-600"}),U!==0&&a.jsxs("span",{className:`text-xs font-semibold ${U>=0?"text-indigo-700":"text-red-600"}`,children:[U>=0?"+":"",U,"%"]})]}),a.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Calls"}),a.jsx("p",{className:"text-xl font-bold text-indigo-700",children:_}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["vs ",E," last year"]})]})]}),N&&a.jsxs("div",{className:"flex flex-wrap gap-2 mb-4 pb-4 border-b border-gray-100",children:[a.jsxs("button",{onClick:()=>s(!n),className:`text-xs px-3 py-1.5 rounded-full font-medium transition-all ${n?"bg-green-100 text-green-700 border-2 border-green-300":"bg-gray-100 text-gray-500 border-2 border-gray-200"}`,children:[a.jsx(Gw,{size:12,className:"inline mr-1"}),"Tasks"]}),a.jsxs("button",{onClick:()=>i(!r),className:`text-xs px-3 py-1.5 rounded-full font-medium transition-all ${r?"bg-teal-100 text-teal-700 border-2 border-teal-300":"bg-gray-100 text-gray-500 border-2 border-gray-200"}`,children:[a.jsx(Ww,{size:12,className:"inline mr-1"}),"Meetings"]}),a.jsxs("button",{onClick:()=>l(!o),className:`text-xs px-3 py-1.5 rounded-full font-medium transition-all ${o?"bg-indigo-100 text-indigo-700 border-2 border-indigo-300":"bg-gray-100 text-gray-500 border-2 border-gray-200"}`,children:[a.jsx(Vw,{size:12,className:"inline mr-1"}),"Calls"]}),a.jsxs("button",{onClick:()=>u(!c),className:`text-xs px-3 py-1.5 rounded-full font-medium transition-all ml-auto ${c?"bg-gray-200 text-gray-700 border-2 border-gray-300":"bg-gray-100 text-gray-500 border-2 border-gray-200"}`,children:["Compare vs ",new Date().getFullYear()-1]})]}),a.jsx("div",{className:"flex-grow min-h-[320px]",children:t?a.jsx("div",{className:"flex items-center justify-center h-full",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):N&&B.length>0?a.jsx(lh,{xAxis:[{scaleType:"point",data:y.labels}],series:B,height:320,width:void 0,grid:{vertical:!1,horizontal:!0},margin:{top:10,right:10,bottom:40,left:50},sx:{width:"100%",maxWidth:"100%","& .MuiLineElement-root":{strokeWidth:2.5},"& .MuiMarkElement-root":{scale:"0.8"}}}):N&&B.length===0?a.jsx("div",{className:"text-center text-gray-500 flex items-center justify-center h-full",children:a.jsxs("div",{children:[a.jsx(Qa,{size:48,className:"mx-auto mb-3 text-gray-300"}),a.jsx("p",{className:"text-sm font-medium",children:"Select at least one activity type"}),a.jsx("p",{className:"text-xs mt-2",children:"Toggle the filters above to view data"})]})}):a.jsx("div",{className:"text-center text-gray-500 flex items-center justify-center h-full",children:a.jsxs("div",{children:[a.jsx(Qa,{size:48,className:"mx-auto mb-3 text-gray-300"}),a.jsx("p",{className:"text-sm font-medium",children:"No completed activities yet"}),a.jsx("p",{className:"text-xs mt-2 text-gray-400",children:"Complete tasks, meetings, or calls to track your productivity"})]})})})]})},gFe=({comparisonData:e,loading:t})=>{const[n,s]=f.useState(!0),[r,i]=f.useState(!0),[o,l]=f.useState(!0),[c,u]=f.useState(!0),[d,h]=f.useState(!0),[p,x]=f.useState("monthly"),v=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],j=["Q1","Q2","Q3","Q4"],y=je=>{const X=[0,0,0,0];for(let se=0;se<12;se++){const ye=Math.floor(se/3);X[ye]+=je[se]}return X},N=je=>[je.reduce((X,se)=>X+se,0)],w=f.useMemo(()=>{if(!e){const lt=new Array(12).fill(0),Fe=new Array(4).fill(0),st=new Array(1).fill(0);return{labels:p==="monthly"?v:p==="quarterly"?j:[new Date().getFullYear().toString()],dealsCurrentYear:p==="monthly"?lt:p==="quarterly"?Fe:st,dealsLastYear:p==="monthly"?lt:p==="quarterly"?Fe:st,accountsCurrentYear:p==="monthly"?lt:p==="quarterly"?Fe:st,accountsLastYear:p==="monthly"?lt:p==="quarterly"?Fe:st,contactsCurrentYear:p==="monthly"?lt:p==="quarterly"?Fe:st,contactsLastYear:p==="monthly"?lt:p==="quarterly"?Fe:st,leadsCurrentYear:p==="monthly"?lt:p==="quarterly"?Fe:st,leadsLastYear:p==="monthly"?lt:p==="quarterly"?Fe:st}}const je=e.deals?.currentYear||new Array(12).fill(0),X=e.deals?.lastYear||new Array(12).fill(0),se=e.accounts?.currentYear||new Array(12).fill(0),ye=e.accounts?.lastYear||new Array(12).fill(0),Ne=e.contacts?.currentYear||new Array(12).fill(0),fe=e.contacts?.lastYear||new Array(12).fill(0),we=e.leads?.currentYear||new Array(12).fill(0),de=e.leads?.lastYear||new Array(12).fill(0);let ke,ge,$e,be,me,Ue,Ee,We,tt;return p==="monthly"?(ke=v,ge=je,$e=X,be=se,me=ye,Ue=Ne,Ee=fe,We=we,tt=de):p==="quarterly"?(ke=j,ge=y(je),$e=y(X),be=y(se),me=y(ye),Ue=y(Ne),Ee=y(fe),We=y(we),tt=y(de)):(ke=[new Date().getFullYear().toString()],ge=N(je),$e=N(X),be=N(se),me=N(ye),Ue=N(Ne),Ee=N(fe),We=N(we),tt=N(de)),{labels:ke,dealsCurrentYear:ge,dealsLastYear:$e,accountsCurrentYear:be,accountsLastYear:me,contactsCurrentYear:Ue,contactsLastYear:Ee,leadsCurrentYear:We,leadsLastYear:tt}},[e,p]),S=w.dealsCurrentYear.some(je=>je>0)||w.dealsLastYear.some(je=>je>0)||w.accountsCurrentYear.some(je=>je>0)||w.accountsLastYear.some(je=>je>0)||w.contactsCurrentYear.some(je=>je>0)||w.contactsLastYear.some(je=>je>0)||w.leadsCurrentYear.some(je=>je>0)||w.leadsLastYear.some(je=>je>0),_=w.dealsCurrentYear.reduce((je,X)=>je+X,0),k=w.accountsCurrentYear.reduce((je,X)=>je+X,0),T=w.contactsCurrentYear.reduce((je,X)=>je+X,0),A=w.leadsCurrentYear.reduce((je,X)=>je+X,0),E=_+k+T+A,M=w.dealsLastYear.reduce((je,X)=>je+X,0),z=w.accountsLastYear.reduce((je,X)=>je+X,0),P=w.contactsLastYear.reduce((je,X)=>je+X,0),D=w.leadsLastYear.reduce((je,X)=>je+X,0),U=M+z+P+D,B=U>0?((E-U)/U*100).toFixed(1):0,R=M>0?((_-M)/M*100).toFixed(0):_>0?100:0,q=z>0?((k-z)/z*100).toFixed(0):k>0?100:0,Z=P>0?((T-P)/P*100).toFixed(0):T>0?100:0,V=D>0?((A-D)/D*100).toFixed(0):A>0?100:0,oe=[];return n&&(oe.push({data:w.dealsCurrentYear,label:`Deals ${new Date().getFullYear()}`,color:"#f59e0b",showMark:!0,curve:"catmullRom"}),d&&oe.push({data:w.dealsLastYear,label:`Deals ${new Date().getFullYear()-1}`,color:"#fcd34d",showMark:!1,curve:"linear"})),r&&(oe.push({data:w.accountsCurrentYear,label:`Accounts ${new Date().getFullYear()}`,color:"#3b82f6",showMark:!0,curve:"catmullRom"}),d&&oe.push({data:w.accountsLastYear,label:`Accounts ${new Date().getFullYear()-1}`,color:"#93c5fd",showMark:!1,curve:"linear"})),o&&(oe.push({data:w.contactsCurrentYear,label:`Contacts ${new Date().getFullYear()}`,color:"#8b5cf6",showMark:!0,curve:"catmullRom"}),d&&oe.push({data:w.contactsLastYear,label:`Contacts ${new Date().getFullYear()-1}`,color:"#c4b5fd",showMark:!1,curve:"linear"})),c&&(oe.push({data:w.leadsCurrentYear,label:`Leads ${new Date().getFullYear()}`,color:"#10b981",showMark:!0,curve:"catmullRom"}),d&&oe.push({data:w.leadsLastYear,label:`Leads ${new Date().getFullYear()-1}`,color:"#6ee7b7",showMark:!1,curve:"linear"})),a.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg border border-gray-100 flex flex-col h-full",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-800 flex items-center",children:["Growth Comparison",a.jsxs("span",{className:"ml-2 text-xs font-normal text-gray-500",children:["(",p.charAt(0).toUpperCase()+p.slice(1),")"]})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Compare deals, accounts, contacts, and leads creation"})]}),S&&U>0&&a.jsxs("div",{className:`text-sm font-semibold ${B>=0?"text-green-600":"text-red-600"}`,children:[B>=0?a.jsx(sJ,{className:"inline mr-1",size:16}):a.jsx(rJ,{className:"inline mr-1",size:16}),B>=0?"+":"",B,"%"]})]}),a.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[a.jsx("button",{onClick:()=>x("monthly"),className:`text-xs px-3 py-1.5 rounded-full font-medium transition-all ${p==="monthly"?"bg-blue-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"Monthly"}),a.jsx("button",{onClick:()=>x("quarterly"),className:`text-xs px-3 py-1.5 rounded-full font-medium transition-all ${p==="quarterly"?"bg-blue-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"Quarterly"}),a.jsx("button",{onClick:()=>x("yearly"),className:`text-xs px-3 py-1.5 rounded-full font-medium transition-all ${p==="yearly"?"bg-blue-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"Yearly"})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-4",children:[a.jsxs("button",{onClick:()=>s(!n),className:`text-xs px-3 py-1.5 rounded-full font-medium transition-all flex items-center ${n?"bg-amber-100 text-amber-700 border-2 border-amber-300":"bg-gray-100 text-gray-500 border-2 border-gray-200"}`,children:[a.jsx("span",{className:"mr-1.5",children:"Deals"}),a.jsx("span",{className:"font-bold",children:_}),M>0&&a.jsxs("span",{className:`ml-1.5 text-[10px] ${R>=0?"text-green-600":"text-red-600"}`,children:["(",R>=0?"+":"",R,"%)"]})]}),a.jsxs("button",{onClick:()=>i(!r),className:`text-xs px-3 py-1.5 rounded-full font-medium transition-all flex items-center ${r?"bg-blue-100 text-blue-700 border-2 border-blue-300":"bg-gray-100 text-gray-500 border-2 border-gray-200"}`,children:[a.jsx("span",{className:"mr-1.5",children:"Accounts"}),a.jsx("span",{className:"font-bold",children:k}),z>0&&a.jsxs("span",{className:`ml-1.5 text-[10px] ${q>=0?"text-green-600":"text-red-600"}`,children:["(",q>=0?"+":"",q,"%)"]})]}),a.jsxs("button",{onClick:()=>l(!o),className:`text-xs px-3 py-1.5 rounded-full font-medium transition-all flex items-center ${o?"bg-purple-100 text-purple-700 border-2 border-purple-300":"bg-gray-100 text-gray-500 border-2 border-gray-200"}`,children:[a.jsx("span",{className:"mr-1.5",children:"Contacts"}),a.jsx("span",{className:"font-bold",children:T}),P>0&&a.jsxs("span",{className:`ml-1.5 text-[10px] ${Z>=0?"text-green-600":"text-red-600"}`,children:["(",Z>=0?"+":"",Z,"%)"]})]}),a.jsxs("button",{onClick:()=>u(!c),className:`text-xs px-3 py-1.5 rounded-full font-medium transition-all flex items-center ${c?"bg-green-100 text-green-700 border-2 border-green-300":"bg-gray-100 text-gray-500 border-2 border-gray-200"}`,children:[a.jsx("span",{className:"mr-1.5",children:"Leads"}),a.jsx("span",{className:"font-bold",children:A}),D>0&&a.jsxs("span",{className:`ml-1.5 text-[10px] ${V>=0?"text-green-600":"text-red-600"}`,children:["(",V>=0?"+":"",V,"%)"]})]}),U>0&&a.jsxs("button",{onClick:()=>h(!d),className:`text-xs px-3 py-1.5 rounded-full font-medium transition-all ml-auto ${d?"bg-gray-200 text-gray-700 border-2 border-gray-300":"bg-gray-100 text-gray-500 border-2 border-gray-200"}`,children:["Compare vs ",new Date().getFullYear()-1]})]}),a.jsx("div",{className:"flex-grow min-h-[320px]",children:t?a.jsx("div",{className:"flex items-center justify-center h-full",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):S&&oe.length>0?a.jsx(lh,{xAxis:[{scaleType:"point",data:w.labels}],series:oe,height:320,width:void 0,grid:{vertical:!1,horizontal:!0},margin:{top:10,right:10,bottom:40,left:50},sx:{width:"100%",maxWidth:"100%","& .MuiLineElement-root":{strokeWidth:2.5},"& .MuiMarkElement-root":{scale:"0.8"}}}):S&&oe.length===0?a.jsx("div",{className:"text-center text-gray-500 flex items-center justify-center h-full",children:a.jsxs("div",{children:[a.jsx(Qa,{size:48,className:"mx-auto mb-3 text-gray-300"}),a.jsx("p",{className:"text-sm font-medium",children:"Select at least one entity type"}),a.jsx("p",{className:"text-xs mt-2",children:"Toggle the filters above to view data"})]})}):a.jsx("div",{className:"text-center text-gray-500 flex items-center justify-center h-full",children:a.jsxs("div",{children:[a.jsx(Qa,{size:48,className:"mx-auto mb-3 text-gray-300"}),a.jsx("p",{className:"text-sm font-medium",children:"No data yet"}),a.jsx("p",{className:"text-xs mt-2 text-gray-400",children:"Start creating deals, accounts, contacts, and leads to track growth"})]})})})]})},LA=({title:e,items:t,children:n,onSeeAll:s})=>{const r=kt(),i=()=>{if(s)s();else{const o={"Latest Leads":"/sales/leads","Latest Deals":"/sales/deals","Upcoming Activities":"/sales/tasks"};o[e]&&r(o[e])}};return a.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg flex flex-col",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:e}),a.jsx("span",{className:"text-sm text-blue-500 cursor-pointer hover:underline",onClick:i,children:"See All"})]}),n]})},pFe=({first_name:e,last_name:t,company_name:n,source:s,created_at:r,id:i})=>{const o=kt(),{text:l,bg:c}=iFe(s||"Website"),u=x=>{if(!x)return"Unknown";const v=new Date(x),y=new Date-v,N=Math.floor(y/6e4),w=Math.floor(y/36e5),S=Math.floor(y/864e5);return N<60?`${N} min ago`:w<24?v.toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}):S<7?v.toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}):v.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})},d=`${e||""} ${t||""}`.trim()||"Unknown",h=n||"Unknown Company",p=u(r);return a.jsx("div",{className:"py-3 border-b border-gray-100 last:border-b-0 cursor-pointer hover:bg-gray-50 transition duration-150 px-2 -mx-2 rounded-md",onClick:()=>i&&o(`/sales/leads/${i}`),children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-gray-800",children:d}),a.jsx("p",{className:"text-xs text-gray-500",children:h})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"text-xs text-gray-400",children:p}),a.jsx("span",{className:`inline-block mt-1 text-xs font-medium ${l} ${c} px-2 py-0.5 rounded-full`,children:s||"Website"})]})]})})},xFe=({name:e,amount:t,account:n,stage:s,created_at:r,id:i,previousAmount:o,currencySymbol:l})=>{const c=kt(),d={PROSPECTING:"Prospecting",QUALIFICATION:"Qualification",PROPOSAL:"Proposal",NEGOTIATION:"Negotiation",CLOSED_WON:"Closed Won",CLOSED_LOST:"Closed Lost"}[s]||s||"Unknown",{text:h,bg:p}=rFe(d),x=parseFloat(t||0),v=o?x>=o?"up":"down":"up",j=v==="up"?sJ:rJ,y=v==="up"?"text-green-400":"text-red-400",N=n?.name||"Unknown Company";return a.jsx("div",{className:"py-3 border-b border-gray-100 last:border-b-0 cursor-pointer hover:bg-gray-50 transition duration-150 px-2 -mx-2 rounded-md",onClick:()=>i&&c(`/sales/deals/info?id=${i}`),children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{className:"flex-shrink",children:[a.jsx("p",{className:"font-semibold text-sm text-gray-900",children:e||"Unnamed Deal"}),a.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:N}),a.jsx("span",{className:`inline-block mt-1 text-xs font-medium ${h} ${p} px-2 py-0.5 rounded-full`,children:d})]}),a.jsxs("div",{className:"text-right flex flex-col items-end flex-shrink-0",children:[a.jsx("p",{className:"text-md font-bold text-gray-800",children:dJ(x,l)}),a.jsx(j,{size:16,className:`${y} mt-1`})]})]})})},yFe=({type:e,title:t,assignedTo:n,dueDate:s,scheduledDate:r,priority:i,id:o,activityType:l,fullData:c})=>{const u=kt(),h=l||{Call:"call",Meeting:"meeting",Task:"qualification"}[e]||"meeting",{Icon:p,color:x,bgColor:v}=oFe(h),{text:j,bg:y}=lFe(i||"MEDIUM"),S=(T=>{if(!T)return"No date set";const A=new Date(T),M=A-new Date,z=Math.floor(M/864e5);return z===0?`Today, ${A.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}`:z===1?`Tomorrow, ${A.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}`:z===-1?`Yesterday, ${A.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}`:A.toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})})(s||r),_=n||"Unassigned",k=()=>{o&&(c?h==="call"?(sessionStorage.setItem("callDetailData",JSON.stringify(c)),u(`/sales/calls/info?id=${o}`)):h==="meeting"?(sessionStorage.setItem("meetingDetailData",JSON.stringify(c)),u(`/sales/meetings/info?id=${o}`)):u("/sales/tasks"):u(h==="call"?`/sales/calls/info?id=${o}`:h==="meeting"?`/sales/meetings/info?id=${o}`:"/sales/tasks"))};return a.jsxs("div",{className:"flex items-start py-3 border-b border-gray-100 last:border-b-0 cursor-pointer hover:bg-gray-50 transition duration-150 px-2 -mx-2 rounded-md",onClick:k,children:[a.jsx("div",{className:`p-2 rounded-lg ${v} mr-3 flex-shrink-0 mt-1`,children:a.jsx(p,{size:20,className:`${x}`})}),a.jsxs("div",{className:"flex-grow",children:[a.jsxs("p",{className:"font-medium text-gray-800 flex items-center mb-1",children:[a.jsx("span",{className:"text-xl leading-none mr-2",children:""}),t||"Untitled Activity"]}),a.jsxs("div",{className:"space-y-1 text-xs text-gray-500",children:[a.jsxs("p",{className:"flex items-center",children:[a.jsx(nJ,{size:14,className:"mr-1.5 text-gray-400"}),S]}),a.jsxs("p",{className:"flex items-center",children:[a.jsx(oJ,{size:14,className:"mr-1.5 text-gray-400"}),"Assigned to: ",_]})]})]}),a.jsx("span",{className:`inline-block text-xs font-medium ${j} ${y} px-2 py-0.5 rounded-full flex-shrink-0 self-center ml-4`,children:(i||"MEDIUM").toUpperCase()})]})},bFe=()=>{const e=kt(),{user:t}=Vt(),n=t?.company?.currency||"",[s,r]=f.useState({activeLeads:0,totalDeals:0,activeAccounts:0,overdueTasks:0,completedTasks:0,completedMeetings:0,completedCalls:0}),[i,o]=f.useState([]),[l,c]=f.useState([]),[u,d]=f.useState([]),[h,p]=f.useState([]),[x,v]=f.useState([]),[j,y]=f.useState([]),[N,w]=f.useState({tasks:{currentYear:new Array(12).fill(0),lastYear:new Array(12).fill(0)},meetings:{currentYear:new Array(12).fill(0),lastYear:new Array(12).fill(0)},calls:{currentYear:new Array(12).fill(0),lastYear:new Array(12).fill(0)}}),[S,_]=f.useState(!0),[k,T]=f.useState(null),[A,E]=f.useState(""),[M,z]=f.useState([]),[P,D]=f.useState([]),[U,B]=f.useState([]),[R,q]=f.useState([]),[Z,V]=f.useState({deals:{currentYear:new Array(12).fill(0),lastYear:new Array(12).fill(0)},accounts:{currentYear:new Array(12).fill(0),lastYear:new Array(12).fill(0)},contacts:{currentYear:new Array(12).fill(0),lastYear:new Array(12).fill(0)},leads:{currentYear:new Array(12).fill(0),lastYear:new Array(12).fill(0)}}),[oe,je]=f.useState([]),[X,se]=f.useState(0),[ye,Ne]=f.useState(new Date),fe=f.useRef(null),we=f.useRef(null),de=f.useMemo(()=>{try{if(!A.trim())return[];const be=A.toLowerCase().trim(),me=[];return Array.isArray(M)&&M.forEach(Ue=>{const Ee=`${Ue.first_name||""} ${Ue.last_name||""}`.trim().toLowerCase(),We=(Ue.company_name||"").toLowerCase(),tt=(Ue.email||"").toLowerCase(),lt=(Ue.phone||"").toLowerCase();(Ee.includes(be)||We.includes(be)||tt.includes(be)||lt.includes(be))&&me.push({id:Ue.id,name:`${Ue.first_name||""} ${Ue.last_name||""}`.trim()||"Unnamed Lead",type:"Lead",details:Ue.company_name||"No company",route:`/sales/leads/${Ue.id}`})}),Array.isArray(P)&&P.forEach(Ue=>{const Ee=(Ue.name||"").toLowerCase(),We=(Ue.account?.name||"").toLowerCase(),tt=(Ue.description||"").toLowerCase();(Ee.includes(be)||We.includes(be)||tt.includes(be))&&me.push({id:Ue.id,name:Ue.name||"Unnamed Deal",type:"Deal",details:Ue.account?.name||"No account",route:`/sales/deals/info?id=${Ue.id}`})}),Array.isArray(U)&&U.forEach(Ue=>{const Ee=(Ue.name||"").toLowerCase(),We=(Ue.email||"").toLowerCase(),tt=(Ue.phone||"").toLowerCase(),lt=(Ue.website||"").toLowerCase();(Ee.includes(be)||We.includes(be)||tt.includes(be)||lt.includes(be))&&me.push({id:Ue.id,name:Ue.name||"Unnamed Account",type:"Account",details:Ue.email||Ue.phone||"No contact info",route:"/sales/accounts"})}),Array.isArray(R)&&R.forEach(Ue=>{const Ee=(Ue.first_name||"").toLowerCase(),We=(Ue.last_name||"").toLowerCase(),tt=`${Ee} ${We}`.trim(),lt=(Ue.email||"").toLowerCase(),Fe=(Ue.phone||"").toLowerCase();(tt.includes(be)||Ee.includes(be)||We.includes(be)||lt.includes(be)||Fe.includes(be))&&me.push({id:Ue.id,name:tt||"Unnamed Contact",type:"Contact",details:Ue.email||Ue.phone||"No contact info",route:"/sales/contacts"})}),me.slice(0,10)}catch(be){return console.error("Error in search:",be),[]}},[A,M,P,U,R]),ke=be=>{be.route&&(e(be.route),E(""))},ge=f.useCallback(async()=>{_(!0),T(null);try{const[be,me,Ue,Ee,We,tt,lt,Fe,st]=await Promise.all([re.get("/leads/admin/getLeads").catch(Oe=>(console.error("Error fetching leads:",Oe),{data:[]})),re.get("/deals/admin/fetch-all").catch(Oe=>(console.error("Error fetching deals:",Oe),{data:[]})),re.get("/accounts/admin/fetch-all").catch(Oe=>(console.error("Error fetching accounts:",Oe),{data:[]})),re.get("/contacts/admin/fetch-all").catch(Oe=>(console.error("Error fetching contacts:",Oe),{data:[]})),re.get("/tasks/all").catch(Oe=>(console.error("Error fetching tasks:",Oe),{data:[]})),re.get("/meetings/admin/fetch-all").catch(Oe=>(console.error("Error fetching meetings:",Oe),{data:[]})),re.get("/calls/admin/fetch-all").catch(Oe=>(console.error("Error fetching calls:",Oe),{data:[]})),re.get("/logs/read-all").catch(Oe=>(console.error("Error fetching logs:",Oe),{data:[]})),re.get("/targets/admin/fetch-all").catch(Oe=>(console.error("Error fetching targets:",Oe),{data:[]}))]),Xe=Array.isArray(be.data)?be.data:[],Ze=Array.isArray(me.data)?me.data:[],Je=Array.isArray(Ue.data)?Ue.data:[],Be=Array.isArray(Ee.data)?Ee.data:[],_e=Array.isArray(We.data)?We.data:[],pe=Array.isArray(tt.data)?tt.data:[],ce=Array.isArray(lt.data)?lt.data:[],Q=Array.isArray(Fe.data)?Fe.data:[],ne=Array.isArray(st.data)?st.data:[];console.log("=== RAW DEALS API RESPONSE ==="),console.log("Deals count:",Ze.length),Ze.length>0&&(console.log("First deal sample (raw):",JSON.stringify(Ze[0],null,2)),console.log("First deal keys:",Object.keys(Ze[0]))),z(Xe),D(Ze),B(Je),q(Be),je(ne);const ae=ne.reduce((Oe,Ce)=>{const Qe=Ce.amount||Ce.value||Ce.target_amount||0,G=parseFloat(typeof Qe=="string"?Qe.replace(/[^\d.-]/g,""):Qe);return Oe+(Number.isFinite(G)?G:0)},0);se(ae);const Pe=Xe.filter(Oe=>Oe.status&&!["Lost","Converted"].includes(Oe.status)).length,Te=_e.filter(Oe=>!Oe.dueDate||Oe.status==="Completed"?!1:new Date(Oe.dueDate)<new Date).length,he=_e.filter(Oe=>(Oe.status||"").toLowerCase()==="completed").length,He=pe.filter(Oe=>{const Ce=(Oe.status||"").toUpperCase();return Ce==="COMPLETED"||Ce==="DONE"}).length,qe=ce.filter(Oe=>{const Ce=(Oe.status||"").toUpperCase();return Ce==="COMPLETED"||Ce==="HELD"}).length;r({activeLeads:Pe,totalDeals:Ze.length,activeAccounts:Je.length,overdueTasks:Te,completedTasks:he,completedMeetings:He,completedCalls:qe});const nt=[...Xe].sort((Oe,Ce)=>new Date(Ce.created_at||0)-new Date(Oe.created_at||0)).slice(0,5);o(nt);const ot=[...Ze].sort((Oe,Ce)=>new Date(Ce.created_at||0)-new Date(Oe.created_at||0)).slice(0,5);c(ot);const Re=new Date,it=[];ce.forEach(Oe=>{const Ce=Oe.due_date||Oe.call_time,Qe=(Oe.status||"").toUpperCase();if(Ce){const G=new Date(Ce);Qe==="COMPLETED"||Qe==="MISSED"||Qe==="NOT_HELD"||Qe==="HELD"||it.push({type:"Call",title:Oe.subject||"Untitled Call",assignedTo:Oe.assigned_to||(Oe.call_assign_to?`${Oe.call_assign_to.first_name||""} ${Oe.call_assign_to.last_name||""}`.trim():"Unassigned"),scheduledDate:Ce,priority:(Oe.priority||"MEDIUM").toUpperCase(),id:Oe.id,activityType:"call",fullData:Oe})}}),pe.forEach(Oe=>{const Ce=Oe.dueDate||Oe.start_time,Qe=(Oe.status||"").toUpperCase();if(Ce){const G=new Date(Ce);Qe==="COMPLETED"||Qe==="CANCELLED"||Qe==="DONE"||it.push({type:"Meeting",title:Oe.subject||Oe.activity||"Untitled Meeting",assignedTo:Oe.assignedTo||(Oe.meet_assign_to?`${Oe.meet_assign_to.first_name||""} ${Oe.meet_assign_to.last_name||""}`.trim():"Unassigned"),scheduledDate:Ce,priority:(Oe.priority||"MEDIUM").toUpperCase(),id:Oe.id,activityType:"meeting",fullData:Oe})}});const St={HIGH:1,MEDIUM:2,LOW:3},Et=it.sort((Oe,Ce)=>{const Qe=St[Oe.priority]||3,G=St[Ce.priority]||3;if(Qe!==G)return Qe-G;const W=new Date(Oe.scheduledDate||0),J=new Date(Ce.scheduledDate||0);return W-J}).slice(0,5);d(Et),p(Ze),w((()=>{const Oe=new Date().getFullYear(),Ce=Oe-1,Qe=new Array(12).fill(0),G=new Array(12).fill(0),W=new Array(12).fill(0),J=new Array(12).fill(0),Y=new Array(12).fill(0),F=new Array(12).fill(0);console.log("=== MY ACTIVITIES DEBUG ==="),console.log("Total tasks:",_e.length),console.log("Total meetings:",pe.length),console.log("Total calls:",ce.length);let ue=0,De=0,le=0;return _e.forEach((Ie,K)=>{if(K===0&&console.log("Sample task:",{id:Ie.id,status:Ie.status,due_date:Ie.due_date,updated_at:Ie.updated_at}),(Ie.status||"").toLowerCase()!=="completed")return;ue++;const Me=Ie.completedAt||Ie.completed_at||Ie.updatedAt||Ie.updated_at||Ie.dueDate||Ie.due_date;if(Me)try{const Ke=new Date(Me);if(isNaN(Ke.getTime()))return;const gt=Ke.getFullYear(),Ct=Ke.getMonth();gt===Oe?Qe[Ct]++:gt===Ce&&G[Ct]++}catch(Ke){console.error("Error parsing task date:",Ke)}}),pe.forEach((Ie,K)=>{K===0&&console.log("Sample meeting:",{id:Ie.id,status:Ie.status,dueDate:Ie.dueDate,updated_at:Ie.updated_at});const ie=(Ie.status||"").toUpperCase();if(ie!=="COMPLETED"&&ie!=="DONE")return;De++;const Me=Ie.completedAt||Ie.completed_at||Ie.updatedAt||Ie.updated_at||Ie.dueDate||Ie.start_time;if(Me)try{const Ke=new Date(Me);if(isNaN(Ke.getTime()))return;const gt=Ke.getFullYear(),Ct=Ke.getMonth();gt===Oe?W[Ct]++:gt===Ce&&J[Ct]++}catch(Ke){console.error("Error parsing meeting date:",Ke)}}),ce.forEach((Ie,K)=>{K===0&&console.log("Sample call:",{id:Ie.id,status:Ie.status,due_date:Ie.due_date,updated_at:Ie.updated_at});const ie=(Ie.status||"").toUpperCase();if(ie!=="COMPLETED"&&ie!=="HELD")return;le++;const Me=Ie.completedAt||Ie.completed_at||Ie.updatedAt||Ie.updated_at||Ie.due_date||Ie.call_time;if(Me)try{const Ke=new Date(Me);if(isNaN(Ke.getTime()))return;const gt=Ke.getFullYear(),Ct=Ke.getMonth();gt===Oe?Y[Ct]++:gt===Ce&&F[Ct]++}catch(Ke){console.error("Error parsing call date:",Ke)}}),console.log("Activities summary:",{completedTasks:ue,completedMeetings:De,completedCalls:le,tasksCurrentYear:Qe,tasksLastYear:G,meetingsCurrentYear:W,meetingsLastYear:J,callsCurrentYear:Y,callsLastYear:F}),{tasks:{currentYear:Qe,lastYear:G},meetings:{currentYear:W,lastYear:J},calls:{currentYear:Y,lastYear:F}}})()),V((()=>{const Oe=new Date().getFullYear(),Ce=Oe-1,Qe=new Array(12).fill(0),G=new Array(12).fill(0),W=new Array(12).fill(0),J=new Array(12).fill(0),Y=new Array(12).fill(0),F=new Array(12).fill(0),ue=new Array(12).fill(0),De=new Array(12).fill(0);return Ze.forEach(le=>{const Ie=le.created_at||le.createdAt;if(Ie)try{const K=new Date(Ie);if(isNaN(K.getTime()))return;const ie=K.getFullYear(),Me=K.getMonth();ie===Oe?Qe[Me]++:ie===Ce&&G[Me]++}catch(K){console.error("Error parsing deal date:",K)}}),Je.forEach(le=>{const Ie=le.created_at||le.createdAt;if(Ie)try{const K=new Date(Ie);if(isNaN(K.getTime()))return;const ie=K.getFullYear(),Me=K.getMonth();ie===Oe?W[Me]++:ie===Ce&&J[Me]++}catch(K){console.error("Error parsing account date:",K)}}),Be.forEach(le=>{const Ie=le.created_at||le.createdAt;if(Ie)try{const K=new Date(Ie);if(isNaN(K.getTime()))return;const ie=K.getFullYear(),Me=K.getMonth();ie===Oe?Y[Me]++:ie===Ce&&F[Me]++}catch(K){console.error("Error parsing contact date:",K)}}),Xe.forEach(le=>{const Ie=le.created_at||le.createdAt;if(Ie)try{const K=new Date(Ie);if(isNaN(K.getTime()))return;const ie=K.getFullYear(),Me=K.getMonth();ie===Oe?ue[Me]++:ie===Ce&&De[Me]++}catch(K){console.error("Error parsing lead date:",K)}}),console.log("Comparison data summary:",{dealsCurrentYear:Qe,dealsLastYear:G,accountsCurrentYear:W,accountsLastYear:J,contactsCurrentYear:Y,contactsLastYear:F,leadsCurrentYear:ue,leadsLastYear:De}),{deals:{currentYear:Qe,lastYear:G},accounts:{currentYear:W,lastYear:J},contacts:{currentYear:Y,lastYear:F},leads:{currentYear:ue,lastYear:De}}})()),console.log("=== ALL DEALS DATA ==="),console.log("Total deals:",Ze.length);const xe=Ze.filter(Oe=>(Oe.stage||"").toUpperCase()==="CLOSED_WON");console.log("CLOSED_WON deals:",xe.length),xe.length>0?(console.log("=== CLOSED_WON DEALS DETAILS ==="),xe.forEach((Oe,Ce)=>{let Qe=Oe.amount;Qe&&typeof Qe=="object"?Qe.toString?Qe=parseFloat(Qe.toString()):Qe=parseFloat(Qe):Qe=parseFloat(Qe)||0,console.log(`Deal ${Ce+1}:`,{id:Oe.id,name:Oe.name,stage:Oe.stage,stage_upper:(Oe.stage||"").toUpperCase(),amount:Oe.amount,amount_parsed:Qe,amount_type:typeof Oe.amount,close_date:Oe.close_date,close_date_type:typeof Oe.close_date,close_date_value:Oe.close_date?new Date(Oe.close_date):null,has_close_date:!!Oe.close_date,has_amount:Qe>0,all_keys:Object.keys(Oe),full_deal:Oe})})):(console.log(" No CLOSED_WON deals found!"),console.log("All deal stages:",Ze.map(Oe=>Oe.stage))),y(Ze);const ve=[...Q].sort((Oe,Ce)=>new Date(Ce.timestamp||0)-new Date(Oe.timestamp||0));v(ve)}catch(be){console.error("Error fetching dashboard data:",be),T("Failed to load dashboard data. Please refresh the page.")}finally{_(!1)}},[]);f.useEffect(()=>(document.title="Dashboard | Sari-Sari CRM",console.log("SalesOverview mounted, fetching data..."),ge(),fe.current=setInterval(()=>{console.log("Auto-refreshing dashboard data..."),ge(),Ne(new Date)},3e4),()=>{fe.current&&clearInterval(fe.current)}),[ge]),f.useEffect(()=>{if(!t||!t.id)return;let be=0;const me=3;let Ue=null;const Ee=()=>{const We=window.location.protocol==="https:"?"wss:":"ws:",tt=window.location.hostname==="localhost"?"localhost:8000":window.location.host,lt=`${We}//${tt}/ws/notifications?user_id=${t.id}`;try{const Fe=new WebSocket(lt);we.current=Fe,Fe.onopen=()=>{console.log(" WebSocket connected for dashboard updates"),be=0},Fe.onmessage=st=>{try{const Xe=JSON.parse(st.data);console.log(" Real-time notification received:",Xe),Xe.event&&["new_task","task_updated","new_lead","lead_updated","new_deal","deal_updated","new_account","account_updated","new_meeting","meeting_updated","new_call","call_updated"].includes(Xe.event)&&(console.log(" Refreshing dashboard due to:",Xe.event),ge(),Ne(new Date))}catch(Xe){console.error("Error parsing WebSocket message:",Xe)}},Fe.onerror=st=>{be===0&&console.warn(" WebSocket connection unavailable (this is optional)")},Fe.onclose=()=>{be<me&&(be++,Ue=setTimeout(()=>{t&&t.id&&Ee()},5e3))}}catch{console.warn(" WebSocket not available (optional feature)")}};return Ee(),()=>{Ue&&clearTimeout(Ue),we.current&&(we.current.close(),we.current=null)}},[t,ge]);const $e=[{icon:eFe,title:"Active Leads",value:s.activeLeads,color:"text-blue-600",bgColor:"bg-blue-50",onClick:()=>e("/sales/leads")},{icon:cJ,title:"Total Targets",value:dJ(X,n),color:"text-purple-600",bgColor:"bg-purple-50",onClick:()=>e("/sales/targets")},{icon:lJ,title:"Total Deals",value:s.totalDeals,color:"text-yellow-600",bgColor:"bg-yellow-50",onClick:()=>e("/sales/deals")},{icon:nJ,title:"Overdue Tasks",value:s.overdueTasks,color:"text-red-600",bgColor:"bg-red-50",onClick:()=>e("/sales/tasks")},{icon:Gw,title:"Completed Tasks",value:s.completedTasks,color:"text-green-600",bgColor:"bg-green-50",onClick:()=>e("/sales/tasks")},{icon:Ww,title:"Completed Meetings",value:s.completedMeetings,color:"text-teal-600",bgColor:"bg-teal-50",onClick:()=>e("/sales/meetings")},{icon:Vw,title:"Completed Calls",value:s.completedCalls,color:"text-indigo-600",bgColor:"bg-indigo-50",onClick:()=>e("/sales/calls")}];return console.log("SalesOverview rendering, loading:",S,"error:",k),a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative w-full",children:[S&&a.jsx(Wt,{}),a.jsxs("div",{className:"max-w-screen-2xl mx-auto",children:[k&&a.jsx("div",{className:"mb-6 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:a.jsx("p",{className:"font-medium",children:k})}),a.jsx("div",{className:"mb-8",children:a.jsx(cFe,{searchQuery:A,onSearchChange:E,searchResults:de,onSearchResultClick:ke})}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-7 gap-4 mb-8",children:$e.map(be=>a.jsx(mFe,{...be,loading:S},be.title))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[a.jsx(uFe,{logs:x,loading:S}),a.jsx(hFe,{activityData:N,loading:S})]}),a.jsx("div",{className:"mb-8",children:a.jsx(LN,{leads:M,deals:P,targets:oe,currencySymbol:n,basePath:"/sales",currentUser:t})}),a.jsx("div",{className:"grid grid-cols-1 mb-8",children:a.jsx(fFe,{revenueData:j,loading:S})}),a.jsx("div",{className:"grid grid-cols-1 mb-8",children:a.jsx(gFe,{comparisonData:Z,loading:S})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[a.jsx(LA,{title:"Latest Leads",children:i.length>0?i.map((be,me)=>a.jsx(pFe,{...be},be.id||me)):a.jsx("div",{className:"text-sm text-gray-500 py-4 text-center",children:"No leads found"})}),a.jsx(LA,{title:"Latest Deals",children:S?a.jsxs("div",{className:"flex flex-col items-center justify-center py-8",children:[a.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-500 mb-2"}),a.jsx("div",{className:"text-sm text-gray-500",children:"Loading deals..."})]}):l.length>0?l.map((be,me)=>a.jsx(xFe,{...be,currencySymbol:n},be.id||me)):a.jsx("div",{className:"text-sm text-gray-500 py-4 text-center",children:"No deals found"})}),a.jsx(LA,{title:"Upcoming Activities",children:u.length>0?u.map((be,me)=>a.jsx(yFe,{...be},be.id||me)):a.jsx("div",{className:"text-sm text-gray-500 py-4 text-center",children:"No upcoming activities"})})]})]})]})},PA=[{value:"CUSTOMER",label:"Customer"},{value:"PROSPECT",label:"Prospect"},{value:"PARTNER",label:"Partner"},{value:"ACTIVE",label:"Vendor"},{value:"INACTIVE",label:"Inactive"},{value:"FORMER",label:"Delete"}],Sb={name:"",website:"",phone_number:"",billing_address:"",shipping_address:"",industry:"",parent_company:"",status:"PROSPECT",territory_id:"",assigned_to:""},Or=e=>e?e.toUpperCase():"",DA=e=>e?e.toString().toLowerCase().replace(/\b\w/g,t=>t.toUpperCase()):"--",vFe=e=>{switch(Or(e)){case"CUSTOMER":return"bg-green-600 text-white";case"PROSPECT":return"bg-purple-600 text-white";case"PARTNER":return"bg-pink-600 text-white";case"ACTIVE":return"bg-blue-600 text-white";case"INACTIVE":return"bg-gray-600 text-white";case"FORMER":return"bg-orange-600 text-white";default:return"bg-gray-500 text-white"}},wFe=e=>{switch(Or(e)){case"CUSTOMER":return"bg-green-100 text-green-700";case"PROSPECT":return"bg-purple-100 text-purple-700";case"PARTNER":return"bg-pink-100 text-pink-700";case"ACTIVE":return"bg-blue-100 text-blue-700";case"INACTIVE":return"bg-gray-200 text-gray-700";case"FORMER":return"bg-orange-100 text-orange-700";default:return"bg-gray-100 text-gray-700"}};function jFe(){const e=kt(),t=ta(),{user:n}=Vt(),s=n?.role==="Sales";f.useEffect(()=>{document.title="Accounts | Sari-Sari CRM"},[]);const[r,i]=f.useState(!1),[o,l]=f.useState(!1),[c,u]=f.useState(!1),[d,h]=f.useState(null),[p,x]=f.useState(null),[v,j]=f.useState(Sb),[y,N]=f.useState(null),[w,S]=f.useState([]),[_,k]=f.useState(!1),[T,A]=f.useState([]),[E,M]=f.useState(null),[z,P]=f.useState([]),[D,U]=f.useState([]),[B,R]=f.useState("Filter by Status"),[q,Z]=f.useState(""),[V,oe]=f.useState(null),[je,X]=f.useState(!1),[se,ye]=f.useState(1),[Ne,fe]=f.useState(10),[we,de]=f.useState("Overview"),[ke,ge]=f.useState(""),[$e,be]=f.useState(!1),[me,Ue]=f.useState([]),[Ee,We]=f.useState({}),[tt,lt]=f.useState(null);f.useEffect(()=>{r&&!o&&s&&n&&!v.assigned_to&&(j(I=>({...I,assigned_to:n.id})),M(n))},[r,o,s,n,v.assigned_to]);const{comments:Fe,addComment:st,refresh:Xe}=kn({relatedType:"account",relatedId:y?.id});f.useEffect(()=>{y?.id&&Xe()},[y?.id,Xe]);const Ze=f.useCallback(async(I=null)=>{k(!0);try{const L=await re.get("/accounts/admin/fetch-all"),Le=[...Array.isArray(L.data)?L.data:[]].sort((ze,Ve)=>{const ft=ze?.created_at||ze?.updated_at||0,_t=Ve?.created_at||Ve?.updated_at||0;return new Date(_t)-new Date(ft)});if(S(Le),I){const ze=Le.find(Ve=>Ve.id===I);N(ze||null)}}catch(L){console.error(L),S([]),L.response?.status===403?H.error("Permission denied. Only CEO, Admin, or Group Manager can access this page."):H.error("Failed to fetch accounts. Please try again later.")}finally{k(!1)}},[N]),Je=f.useCallback(async()=>{try{const I=await re.get("/users/all");A(Array.isArray(I.data)?I.data:[])}catch(I){console.error(I),I.response?.status===403&&H.warn("Unable to load users for assignment (permission denied).")}},[]),Be=f.useCallback(async()=>{try{const I=await re.get("/territories/fetch");P(Array.isArray(I.data)?I.data:[])}catch(I){console.error(I),I.response?.status===403&&H.warn("Unable to load territories (permission denied).")}},[]),_e=f.useCallback(async()=>{try{const I=await re.get("/accounts/admin/parent-companies");U(Array.isArray(I.data)?I.data:[])}catch(I){console.error(I),I.response?.status===403&&H.warn("Unable to load parent companies (permission denied).")}},[]),pe=f.useCallback(async I=>{try{const L=await re.get(`/activities/accounts/${I}`);We(L.data&&typeof L.data=="object"?L.data:{})}catch(L){console.error(L),L.response?.status===404&&(console.warn("No activities found for this account."),We({}))}},[]);f.useEffect(()=>{Ze(),Je(),Be(),_e()},[Ze,Je,Be,_e]),f.useEffect(()=>{y&&ge(Or(y.status)||"PROSPECT")},[y]);const ce=f.useMemo(()=>{const I=q.trim().toLowerCase(),L=B.trim().toUpperCase();return w.filter(ee=>{if(!(n?.role==="Admin"||n?.role==="CEO"||n?.role==="MANAGER"||n?.role==="GROUP MANAGER")&&ee.status?.toUpperCase()==="INACTIVE")return!1;const ze=[ee?.name,ee?.website,ee?.industry,ee?.territory?.name,ee?.phone_number],Ve=I===""||ze.some(_t=>_t==null?!1:_t.toString().toLowerCase().includes(I)),ft=L==="FILTER BY STATUS"||Or(ee.status)===L;return Ve&&ft})},[w,q,B,n]),Q=f.useMemo(()=>ce.length,[ce]),ne=f.useMemo(()=>ce.filter(I=>I.status?.toLowerCase()==="customer").length,[ce]),ae=f.useMemo(()=>ce.filter(I=>I.status?.toLowerCase()==="prospect").length,[ce]),Pe=f.useMemo(()=>ce.filter(I=>I.status?.toLowerCase()==="partner").length,[ce]),Te=f.useMemo(()=>ce.filter(I=>I.status?.toLowerCase()==="active").length,[ce]),he=f.useMemo(()=>ce.filter(I=>I.status?.toLowerCase()==="inactive").length,[ce]),He=f.useMemo(()=>ce.filter(I=>I.status?.toLowerCase()==="former").length,[ce]),qe=f.useMemo(()=>[{title:"Total",value:Q,icon:Za,color:"text-slate-600",bgColor:"bg-slate-100"},{title:"Customers",value:ne,icon:Qi,color:"text-green-600",bgColor:"bg-green-100"},{title:"Prospects",value:ae,icon:Xa,color:"text-purple-600",bgColor:"bg-purple-100"},{title:"Partners",value:Pe,icon:ra,color:"text-pink-600",bgColor:"bg-pink-100"},{title:"Active",value:Te,icon:Qi,color:"text-blue-600",bgColor:"bg-blue-100"},{title:"Inactive",value:he,icon:Ki,color:"text-gray-600",bgColor:"bg-gray-100"},{title:"Former",value:He,icon:Ki,color:"text-orange-600",bgColor:"bg-orange-100"}],[Q,ne,ae,Pe,Te,he,He]),nt=Math.max(1,Math.ceil(ce.length/Ne)||1);f.useEffect(()=>{ye(1)},[q,B]),f.useEffect(()=>{ye(I=>{const L=Math.max(1,Math.ceil(ce.length/Ne)||1);return I>L?L:I})},[ce.length,Ne]);const ot=f.useMemo(()=>{const I=(se-1)*Ne;return ce.slice(I,I+Ne)},[ce,se,Ne]),Re=I=>{if(I.target.checked){const L=ot.filter(ee=>ee.assigned_accs?.id===n?.id&&ee.acc_creator?.id===n?.id).map(ee=>ee.id);Ue(L)}else Ue([])},it=I=>{Ue(L=>L.includes(I)?L.filter(ee=>ee!==I):[...L,I])},St=async()=>{if(me.length===0)return;const I=n?.role==="Admin"||n?.role==="CEO"||n?.role==="MANAGER"||n?.role==="GROUP MANAGER",L=I?"delete":"archive",ee=I?"This action cannot be undone.":"These accounts will be hidden from your view but admins can still see them.",Le=!I;oe({title:`${L.charAt(0).toUpperCase()+L.slice(1)} Accounts`,message:a.jsxs("span",{children:["Are you sure you want to ",L," ",a.jsx("span",{className:"font-semibold",children:me.length})," selected accounts? ",ee]}),confirmLabel:`${L.charAt(0).toUpperCase()+L.slice(1)} ${me.length} account(s)`,cancelLabel:"Cancel",variant:"danger",icon:Le?Zt:null,isArchive:Le,action:{type:"bulk-delete",accountIds:me}})};ce.length===0||(se-1)*Ne+1,Math.min(se*Ne,ce.length);const Et=()=>ye(I=>Math.max(I-1,1)),Tt=()=>ye(I=>Math.min(I+1,nt)),Nt=I=>{N(I),de("Overview"),ge(Or(I?.status)||"PROSPECT")},xe=()=>N(null),ve=I=>{I.target.id==="accountModalBackdrop"&&!je&&xe()},Oe=()=>{i(!1),l(!1),x(null),j(Sb),u(!1),M(null)},Ce=I=>{I.target.id==="modalBackdrop"&&Oe()},Qe=I=>I?new Date(I).toLocaleString("en-US",{month:"short",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).replace(",",""):"",G=I=>{const{name:L,value:ee}=I.target;j(Le=>({...Le,[L]:ee}))},W=()=>{j(Sb),l(!1),x(null),i(!0)};f.useEffect(()=>{const I=new URLSearchParams(t.search||"");(t.state?.openAccountModal||I.get("openModal")==="1")&&(j(Sb),l(!1),x(null),i(!0),Ie(!1),e(t.pathname,{replace:!0,state:{}}))},[t.state,t.pathname,t.search,e]);const J=I=>{N(null);let L=null;I.assigned_accs&&(L=T.find(ee=>ee.id===I.assigned_accs.id),L||(L=I.assigned_accs)),M(L),j({name:I.name||"",website:I.website||"",phone_number:I.phone_number||"",billing_address:I.billing_address||"",shipping_address:I.shipping_address||"",parent_company:I.parent_company||"",industry:I.industry||"",status:Or(I.status)||"PROSPECT",territory_id:I.territory?.id?String(I.territory.id):"",assigned_to:I.assigned_accs?.id?String(I.assigned_accs.id):""}),l(!0),x(I.id),i(!0)},Y=I=>{if(!I)return;const L=n?.role==="Admin"||n?.role==="CEO"||n?.role==="MANAGER"||n?.role==="GROUP MANAGER",ee=L?"delete":"archive",Le=L?"This action cannot be undone.":"This account will be hidden from your view but admins can still see it.",ze=!L;oe({title:`${ee.charAt(0).toUpperCase()+ee.slice(1)} Account`,message:a.jsxs("span",{children:["Are you sure you want to ",ee," the account"," ",a.jsx("span",{className:"font-semibold",children:I.name}),"? ",Le]}),confirmLabel:`${ee.charAt(0).toUpperCase()+ee.slice(1)} Account`,cancelLabel:"Cancel",variant:"danger",icon:ze?Zt:null,isArchive:ze,action:{type:"delete",targetId:I.id,name:I.name}})},F=async()=>{if(!V?.action){oe(null);return}const{action:I}=V,{type:L,payload:ee,targetId:Le,name:ze}=I;X(!0);try{if(L==="create"){u(!0);const Ve=await re.post("/accounts/admin",ee);_e(),H.success(`Account "${ze}" created successfully.`);const ft=y?.id||null;Oe(),await Ze(ft),!y&&Ve.data?.id}else if(L==="update"){if(!Le)throw new Error("Missing account identifier for update.");u(!0),await re.put(`/accounts/admin/${Le}`,ee),H.success(`Account "${ze}" updated successfully.`);const Ve=y?.id&&y.id===Le?Le:null;Oe(),await Ze(Ve),y?.id===Le&&N(null)}else if(L==="delete"){if(!Le)throw new Error("Missing account identifier for deletion.");const Ve=y?.id;h(Le);const _t=n?.role==="Admin"||n?.role==="CEO"||n?.role==="MANAGER"||n?.role==="GROUP MANAGER"?`Account "${ze}" deleted successfully.`:`Account "${ze}" archived successfully.`;await re.delete(`/accounts/admin/${Le}`),H.success(_t),await Ze(Ve&&Ve!==Le?Ve:null),Ve===Le&&N(null)}else if(L==="bulk-delete"){const{accountIds:Ve}=I,_t=n?.role==="Admin"||n?.role==="CEO"||n?.role==="MANAGER"||n?.role==="GROUP MANAGER"?"deleted":"archived";await re.delete("/accounts/admin/bulk-delete",{data:{account_ids:Ve}}),H.success(`Successfully ${_t} ${Ve.length} accounts`),Ue([]),await Ze()}}catch(Ve){console.error(Ve);const ft=L==="create"?"Failed to create account. Please review the details and try again.":L==="update"?"Failed to update account. Please review the details and try again.":L==="bulk-delete"?"Failed to delete selected accounts.":"Failed to delete account. Please try again.",_t=Ve.response?.data?.detail||ft;H.error(_t),(L==="create"||L==="update")&&u(!1),L==="delete"&&h(null)}finally{(L==="create"||L==="update")&&u(!1),L==="delete"&&h(null),X(!1),oe(null)}},ue=()=>{je||oe(null)},De=async()=>{if(!y||!ke)return;const I=Or(ke),L=Or(y.status);if(I!==L){be(!0);try{await re.put(`/accounts/admin/${y.id}`,{status:I}),H.success(`Account status updated to ${DA(I)}`),S(ee=>ee.map(Le=>Le.id===y.id?{...Le,status:I}:Le)),N(null)}catch(ee){console.error(ee);const Le=ee.response?.data?.detail||"Failed to update account status. Please try again.";H.error(Le)}finally{be(!1)}}},[le,Ie]=f.useState(!1),K=I=>{I.preventDefault(),Ie(!0);const L=v.name.trim();if(!L){H.error("Account name is required.");return}if(!v.assigned_to){H.error("Assigned To is required.");return}const Le={name:L,website:v.website?.trim()||null,phone_number:v.phone_number?.trim()||null,billing_address:v.billing_address?.trim()||null,shipping_address:v.shipping_address?.trim()||null,industry:v.industry?.trim()||null,parent_company:v.parent_company?.trim()||null,status:v.status||"PROSPECT",territory_id:v.territory_id?Number(v.territory_id):null,assigned_to:v.assigned_to?Number(v.assigned_to):null},ze=o&&p?"update":"create";oe({title:ze==="create"?"Confirm New Account":"Confirm Update",message:ze==="create"?a.jsxs("span",{children:["Are you sure you want to create the account"," ",a.jsx("span",{className:"font-semibold",children:L}),"?"]}):a.jsxs("span",{children:["Save changes to the account"," ",a.jsx("span",{className:"font-semibold",children:L}),"?"]}),confirmLabel:ze==="create"?"Create Account":"Update Account",cancelLabel:"Cancel",variant:"primary",action:{type:ze,payload:Le,targetId:p||null,name:L}})},ie=[{label:"Filter by Status",value:"Filter by Status"},...PA.map(I=>({label:I.label,value:I.value}))],Me=V?.action?.type==="delete"?V.action.targetId:null,Ke=y&&(d===y.id||Me===y.id),gt=y&&d===y.id,Ct=y?vFe(y.status):"",Ht=y?a.jsx("div",{id:"accountModalBackdrop",onClick:ve,className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-6xl max-h-[92vh] overflow-y-auto hide-scrollbar animate-scale-in font-inter relative",onClick:I=>I.stopPropagation(),children:[a.jsxs("div",{className:"bg-tertiary w-full rounded-t-xl flex items-center justify-between p-3 lg:p-3",children:[a.jsx("h1",{className:"lg:text-3xl text-xl text-white font-semibold text-center w-full",children:"Account"}),a.jsx("button",{onClick:xe,className:"text-gray-400 hover:text-white cursor-pointer",children:a.jsx(Ja,{size:25})})]}),a.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between lg:flex-row lg:items-center lg:justify-between mt-3 gap-2 px-2 md:items-center lg:gap-4 md:mx-7 lg:mx-7",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[a.jsx("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-800",children:y.name}),a.jsx("span",{className:`text-xs sm:text-sm font-medium px-2 sm:px-3 py-1 rounded-full whitespace-nowrap ${Ct}`,children:DA(y.status)})]}),a.jsx("div",{className:"flex flex-col sm:flex-row sm:space-x-3 space-y-2 sm:space-y-0",children:y.assigned_accs&&y.assigned_accs.id===n?.id&&y.acc_creator&&y.acc_creator.id===n?.id&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{className:"inline-flex items-center justify-center w-full sm:w-auto bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 disabled:opacity-70 transition text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",onClick:()=>J(y),disabled:V?.action?.type==="update"&&V.action.targetId===y.id,children:[a.jsx(gn,{className:"mr-2"}),"Edit"]}),a.jsx("button",{className:"inline-flex items-center justify-center w-full sm:w-auto px-4 py-2 rounded-md text-sm bg-orange-500 text-white hover:bg-orange-600 transition focus:outline-none focus:ring-2 focus:ring-orange-400",onClick:()=>Y(y),disabled:!!Ke,children:gt?"Archiving...":a.jsxs(a.Fragment,{children:[a.jsx(Zt,{className:"mr-2"}),"Archive"]})})]})})]}),a.jsx("div",{className:"border-b border-gray-200 my-5"}),a.jsxs("div",{className:"p-6 lg:p-4",children:[a.jsx("div",{className:"flex w-full bg-[#6A727D] text-white mt-1 overflow-x-auto mb-6",children:["Overview","Activities"].map(I=>a.jsx("button",{onClick:()=>de(I),className:`flex-1 min-w-[90px] px-4 py-2.5 text-xs sm:text-sm font-medium text-center transition-all duration-200 border-b-2
        ${we===I?"bg-paper-white text-[#6A727D] border-white":"text-white hover:bg-[#5c636d]"}`,children:I},I))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 items-start",children:[a.jsxs("div",{className:"lg:col-span-3",children:[we==="Overview"&&a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 md:p-8 border border-gray-200",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4 sm:gap-6 text-sm text-gray-700",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Website:"}),a.jsx("p",{children:y.website?a.jsx("a",{href:y.website,className:"text-blue-600 hover:underline break-all",target:"_blank",rel:"noopener noreferrer",children:y.website}):"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Industry:"}),a.jsx("p",{children:y.industry||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Parent Company:"}),a.jsx("p",{children:y.parent_company||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Territory:"}),a.jsx("p",{children:y.territory?.name||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Phone Number:"}),a.jsx("p",{children:y.phone_number||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Billing Address:"}),a.jsx("p",{children:y.billing_address||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Shipping Address:"}),a.jsx("p",{children:y.shipping_address||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Assigned To:"}),a.jsx("p",{children:y.assigned_accs?`${y.assigned_accs.first_name} ${y.assigned_accs.last_name}`:"Unassigned"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created By:"}),a.jsx("p",{children:y.acc_creator?`${y.acc_creator.first_name} ${y.acc_creator.last_name}`:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created At:"}),a.jsx("p",{children:Qe(y.created_at)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Last Updated:"}),a.jsx("p",{children:Qe(y.updated_at)||"N/A"})]})]}),a.jsx(Tn,{comments:Fe,onAddComment:st})]}),we==="Notes"&&a.jsxs("div",{className:"mt-4 w-full",children:[a.jsx("div",{className:"flex flex-wrap items-center justify-between mb-4 gap-2",children:a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words",children:"Account Note"})}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 shadow-sm break-words",children:[a.jsx("div",{className:"flex items-start justify-between",children:a.jsx("div",{children:a.jsx("p",{className:"text-sm font-medium text-gray-800 break-words",children:"Note"})})}),a.jsx("div",{className:"mt-3 text-sm text-gray-700 whitespace-pre-wrap break-words",children:w.notes||"No notes available."})]})]}),we==="Activities"&&a.jsxs("div",{className:"space-y-2 w-full h-full max-h-[50dvh] overflow-y-auto bg-gray-50 p-2 hide-scrollbar rounded-lg border border-gray-200 shadow-sm",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words border-b border-gray-300 py-2",children:"Related Activities"}),a.jsxs("div",{className:"space-y-2 text-sm",children:[Ee.tasks&&Ee.tasks.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>lt(tt==="tasks"?null:"tasks"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Qt,{className:"text-blue-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Tasks (",Ee.tasks.length,")"]})]}),tt==="tasks"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),tt==="tasks"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:Ee.tasks.map((I,L)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/sales/tasks",{state:{taskID:I.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-blue-600 mt-1",children:a.jsx(Qt,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:I.subject||I.title||"Task"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:I.description||"No description"}),I.assigned_to&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Assigned: ",I.assigned_to.first_name," ",I.assigned_to.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:Qe(I.due_date||I.created_at)})]},`task-${L}`))})]}),Ee.meetings&&Ee.meetings.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>lt(tt==="meetings"?null:"meetings"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ot,{className:"text-green-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Meetings (",Ee.meetings.length,")"]})]}),tt==="meetings"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),tt==="meetings"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:Ee.meetings.map((I,L)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/sales/meetings",{state:{meetingID:I.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-green-600 mt-1",children:a.jsx(Ot,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:I.subject||I.title||"Meeting"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:I.description||I.location||"No description"}),I.host&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Host: ",I.host.first_name," ",I.host.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:Qe(I.start_time||I.created_at)})]},`meeting-${L}`))})]}),Ee.calls&&Ee.calls.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>lt(tt==="calls"?null:"calls"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(It,{className:"text-purple-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Calls (",Ee.calls.length,")"]})]}),tt==="calls"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),tt==="calls"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:Ee.calls.map((I,L)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/sales/calls",{state:{callID:I.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-purple-600 mt-1",children:a.jsx(It,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:I.subject||I.title||"Call"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:I.direction||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:Qe(I.call_time||I.created_at)})]},`call-${L}`))})]}),Ee.contacts&&Ee.contacts.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>lt(tt==="contacts"?null:"contacts"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ra,{className:"text-teal-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Contacts (",Ee.contacts.length,")"]})]}),tt==="contacts"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),tt==="contacts"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:Ee.contacts.map((I,L)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/sales/contacts",{state:{contactID:I.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-teal-600 mt-1",children:a.jsx(ra,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("h4",{className:"font-medium text-blue-600 break-words text-sm",children:[I.first_name?`${I.first_name} `:"",I.last_name]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:I.title||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:Qe(I.created_at)})]},`contact-${L}`))})]}),Ee.deals&&Ee.deals.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>lt(tt==="deals"?null:"deals"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(sa,{className:"text-indigo-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Deals (",Ee.deals.length,")"]})]}),tt==="deals"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),tt==="deals"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:Ee.deals.map((I,L)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/sales/deals",{state:{dealID:I.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-indigo-600 mt-1",children:a.jsx(sa,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("h4",{className:"font-medium text-blue-600 break-words text-sm",children:[I.deal_id?I.deal_id.replace(/D(\d+)-\d+-/,"D$1-"):"--"," ",I.name||I.title||"Deal"]}),a.jsx("p",{className:"text-xs text-gray-500 break-words capitalize",children:I.stage||I.description||"No description"})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:Qe(I.close_date||I.created_at)})]},`deal-${L}`))})]}),Ee.quotes&&Ee.quotes.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>lt(tt==="quotes"?null:"quotes"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ia,{className:"text-orange-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Quotes (",Ee.quotes.length,")"]})]}),tt==="quotes"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),tt==="quotes"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:Ee.quotes.map((I,L)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/sales/quotes",{state:{quoteID:I.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-orange-600 mt-1",children:a.jsx(ia,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:(I.quote_id?I.quote_id.replace(/Q(\d+)-\d+-/,"Q$1-"):"--")||"Quote"}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:I.status||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:Qe(I.presented_date)||""})]},`quote-${L}`))})]}),(!Ee||(!Ee.tasks||Ee.tasks.length===0)&&(!Ee.meetings||Ee.meetings.length===0)&&(!Ee.calls||Ee.calls.length===0)&&(!Ee.quotes||Ee.quotes.length===0)&&(!Ee.deals||Ee.deals.length===0)&&(!Ee.contacts||Ee.contacts.length===0))&&a.jsx("div",{className:"text-center py-8 text-gray-500",children:a.jsx("p",{children:"No related activities found for this account."})})]})]})]}),a.jsxs("div",{className:"flex flex-col gap-4",children:[a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Quick Actions"}),a.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[a.jsxs("button",{onClick:()=>e("/sales/calls",{state:{openCallModal:!0,initialCallData:{subject:`Call with ${y.name}`,relatedType1:"Account",relatedTo1:String(y.id),relatedType2:null,relatedTo2:null,assigned_to:y.assigned_accs?.id?String(y.assigned_accs.id):"",direction:"Outgoing",status:"Planned"}}}),className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(It,{className:"text-gray-600 w-4 h-4"}),"Schedule Call"]}),a.jsxs("button",{className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",onClick:()=>e("/sales/meetings",{state:{openMeetingModal:!0,initialMeetingData:{subject:`Meeting with ${y.name}`,relatedType1:"Account",relatedTo1:String(y.id),relatedType2:null,relatedTo2:null,assigned_to:y.assigned_accs?.id?String(y.assigned_accs.id):"",status:"Planned"}}}),children:[a.jsx(Ot,{className:"text-gray-600 w-4 h-4"}),"Book Meeting"]}),a.jsxs("button",{onClick:()=>e("/sales/tasks",{state:{openTaskModal:!0,initialTaskData:{subject:`Follow up with ${y.name}`,relatedType1:"Account",relatedTo1:String(y.id),relatedType2:null,relatedTo2:null,assignedTo:y.assigned_accs?.id?String(y.assigned_accs.id):"",priority:"NORMAL",status:"Not Started"}}}),className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(Qt,{className:"text-gray-600 w-4 h-4"}),"Tasks"]})]})]}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm w-full",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Status"}),a.jsx("select",{className:"border border-gray-200 rounded-md px-2 sm:px-3 py-1.5 w-full text-sm mb-2 focus:ring-2 focus:ring-indigo-500 outline-none",value:ke||Or(y?.status)||"PROSPECT",onChange:I=>ge(I.target.value),children:PA.map(I=>a.jsx("option",{value:I.value,children:I.label},I.value))}),a.jsx("button",{onClick:De,disabled:$e||!ke||Or(ke)===Or(y?.status),className:`w-full py-1.5 rounded-md text-sm transition focus:outline-none focus:ring-2 ${$e||!ke||Or(ke)===Or(y?.status)?"bg-gray-400 cursor-not-allowed text-white":"bg-gray-900 text-white hover:bg-gray-800 focus:ring-gray-400"}`,children:$e?"Updating...":"Update"})]})]})]})]})]})}):null,da=a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[_&&a.jsx(Wt,{message:"Loading accounts..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h2",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(Za,{className:"mr-2 text-blue-600"}),"Accounts Management"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{onClick:()=>{W(),Ie(!1)},className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 my-1 lg:my-0 rounded-md hover:bg-gray-800 text-sm sm:text-base mx-auto sm:ml-auto cursor-pointer",children:[a.jsx(aa,{className:"mr-2"})," Add Account"]})})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4 mb-6 w-full break-words overflow-hidden lg:overflow-visible",children:qe.map(I=>a.jsx(NFe,{...I},I.title))}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search accounts",value:q,onChange:I=>Z(I.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsx("div",{className:"w-full lg:w-1/4",children:a.jsx("select",{value:B,onChange:I=>R(I.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:ie.map(I=>a.jsx("option",{value:I.value,children:I.label},I.value))})})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[500px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 text-sm tracking-wide font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 text-center w-12",children:a.jsx("input",{type:"checkbox",checked:ot.length>0&&ot.filter(I=>I.assigned_accs?.id===n?.id&&I.acc_creator?.id===n?.id).every(I=>me.includes(I.id))&&ot.some(I=>I.assigned_accs?.id===n?.id&&I.acc_creator?.id===n?.id),onChange:Re,className:"form-checkbox h-4 w-4 text-blue-600 rounded focus:ring-blue-500 border-gray-300"})}),a.jsx("th",{className:"py-3 px-4 truncate",children:"Account"}),a.jsx("th",{className:"py-3 px-4",children:"Status"}),a.jsx("th",{className:"py-3 px-4",children:"Industry"}),a.jsx("th",{className:"py-3 px-4",children:"Territory"}),a.jsx("th",{className:"py-3 px-4",children:"Phone"}),a.jsx("th",{className:"py-3 px-4 text-center w-24",children:me.length>0?a.jsx("button",{onClick:St,className:"text-orange-600 hover:text-orange-800 transition p-1 rounded-full hover:bg-orange-50",title:`Archive ${me.length} selected accounts`,children:a.jsx(Zt,{size:18})}):""})]})}),a.jsx("tbody",{children:_?a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:7,children:"Loading accounts..."})}):ce.length>0?ot.map(I=>a.jsxs("tr",{className:"hover:bg-gray-50 text-xs cursor-pointer",onClick:()=>{Nt(I),pe(I.id)},children:[a.jsx("td",{className:"py-3 px-4 text-center",children:I.assigned_accs?.id===n?.id&&I.acc_creator?.id===n?.id?a.jsx("input",{type:"checkbox",checked:me.includes(I.id),onChange:()=>it(I.id),onClick:L=>L.stopPropagation(),className:"form-checkbox h-4 w-4 text-blue-600 rounded focus:ring-blue-500 border-gray-300"}):null}),a.jsx("td",{className:"py-3 px-4",children:a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-blue-600 hover:underline break-all text-sm",children:I.name}),a.jsx("div",{className:"text-gray-500 text-xs break-all",children:I.website||"--"})]})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${wFe(I.status)}`,children:DA(I.status)})}),a.jsx("td",{className:"py-3 px-4 text-sm",children:I.industry||"--"}),a.jsx("td",{className:"py-3 px-4 text-sm",children:I.territory?.name||"--"}),a.jsx("td",{className:"py-3 px-4",children:a.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[a.jsx(It,{className:"text-gray-500"}),a.jsx("span",{children:I.phone_number||"--"})]})}),a.jsx("td",{className:"py-3 px-4"})]},I.id)):a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:7,children:"No accounts found."})})})]})}),a.jsx(ca,{className:"mt-4",totalItems:ce.length,pageSize:Ne,currentPage:se,onPrev:Et,onNext:Tt,onPageSizeChange:I=>{fe(I),ye(1)},pageSizeOptions:[10,20,30,40,50],label:"accounts"})]}),Ge=r?a.jsx("div",{id:"modalBackdrop",onClick:Ce,className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-full sm:max-w-3xl rounded-2xl shadow-lg p-4 sm:p-6 md:p-8 relative border border-gray-200 overflow-y-auto hide-scrollbar max-h-[90vh]",onClick:I=>I.stopPropagation(),children:[a.jsx("button",{onClick:()=>{Oe(),Ie(!1)},className:"absolute top-4 right-4 text-gray-500 hover:text-black transition",disabled:c||je,children:a.jsx(ea,{size:22})}),a.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800 mb-4 sm:mb-6 flex items-center justify-center",children:o?"Edit Account":"Add New Account"}),a.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",onSubmit:K,noValidate:!0,children:[a.jsx("div",{className:"md:col-span-2",children:a.jsx(tf,{label:"Name",name:"name",value:v.name,onChange:G,placeholder:"Company name",required:!0,isSubmitted:le})}),a.jsx(u8,{label:"Parent Company",value:v.parent_company,onChange:I=>{j(L=>({...L,parent_company:I}))},items:D.map(I=>({id:I,name:I})),getLabel:I=>I?.name||"",placeholder:"Select parent company...",disabled:c}),a.jsx(tf,{label:"Website",name:"website",value:v.website,onChange:G,placeholder:"https://example.com",disabled:c}),a.jsx(tf,{label:"Phone Number",name:"phone_number",value:v.phone_number,onChange:G,placeholder:"09xx xxx xxxx",type:"tel",disabled:c}),a.jsx(tf,{label:"Industry",name:"industry",value:v.industry,onChange:G,placeholder:"Industry",disabled:c}),a.jsx(tf,{label:"Billing Address",name:"billing_address",value:v.billing_address,onChange:G,placeholder:"Billing address",disabled:c}),a.jsx(tf,{label:"Shipping Address",name:"shipping_address",value:v.shipping_address,onChange:G,placeholder:"Shipping address",disabled:c}),a.jsx(d8,{label:"Status",name:"status",value:v.status,onChange:G,options:[{value:"",label:"Select status"},...PA],required:!0,disabled:c}),a.jsx(u8,{label:"Assigned To",value:v.assigned_to,onChange:I=>{const L=T.find(ee=>String(ee.id)===String(I));M(L),j(ee=>({...ee,assigned_to:I}))},items:T||[],getLabel:I=>`${I?.first_name??""} ${I?.last_name??""} (${I?.role??""})`.trim(),placeholder:"Search assignee...",required:!0,isSubmitted:le,disabled:c||T.length===0||s}),a.jsx("div",{className:"md:col-span-2",children:a.jsx(d8,{label:"Territory",name:"territory_id",value:v.territory_id||"",onChange:G,options:[{value:"",label:E?E.assigned_territory&&E.assigned_territory.length>0?"Select Territory":"No territories assigned to this user":"Select a user first"},...E&&E.assigned_territory&&E.assigned_territory.map(I=>({value:String(I.id),label:I.name}))||[]],disabled:c||!E||!E.assigned_territory||E.assigned_territory.length===0})}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-end sm:justify-end space-y-2 sm:space-y-0 sm:space-x-2 col-span-1 md:col-span-2 mt-4 w-full",children:[a.jsx("button",{type:"button",onClick:()=>{Oe(),Ie(!1)},className:"w-full sm:w-auto px-4 py-2 text-white bg-red-400 border border-red-300 rounded hover:bg-red-500 transition disabled:opacity-70",disabled:c||je,children:"Cancel"}),a.jsx("button",{type:"submit",className:"w-full sm:w-auto px-4 py-2 text-white border border-tertiary bg-tertiary rounded hover:bg-secondary transition disabled:opacity-70",disabled:c||je,children:c?"Saving...":o?"Update Account":"Save Account"})]})]})]})}):null,Ae=V?a.jsx(SFe,{open:!0,title:V.title,message:V.message,confirmLabel:V.confirmLabel,cancelLabel:V.cancelLabel,variant:V.variant,onConfirm:F,onCancel:ue,loading:je,icon:V.icon,isArchive:V.isArchive}):null;return a.jsxs(a.Fragment,{children:[da,Ht,Ge,Ae]})}function NFe({icon:e,title:t,value:n,color:s="text-blue-600",bgColor:r="bg-blue-100",onClick:i}){const o=()=>{typeof i=="function"?i():console.log(`Clicked: ${t}`)};return a.jsxs("div",{className:"flex items-center p-4 bg-white rounded-xl shadow-md border border-gray-200 transition-all duration-300",onClick:o,children:[a.jsx("div",{className:`flex-shrink-0 p-3 rounded-full ${r} ${s} mr-4`,children:e?a.jsx(e,{size:22}):null}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:t}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:n})]})]})}function tf({label:e,name:t,value:n,onChange:s,placeholder:r,type:i="text",required:o=!1,disabled:l=!1,className:c="",isSubmitted:u=!1}){const d=u&&!n?.trim();return a.jsxs("div",{children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",o&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:i,name:t,value:n??"",onChange:s,placeholder:r,required:o,disabled:l,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border focus:ring-2
          ${d?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}
          ${c}
        `})]})}function d8({label:e,name:t,value:n,onChange:s,options:r,required:i=!1,disabled:o=!1}){return a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsx("select",{name:t,value:n??"",onChange:s,required:i,disabled:o,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100",children:r.map(l=>a.jsx("option",{value:l.value,disabled:l.value==="",children:l.label},l.value))})]})}function u8({label:e,items:t=[],value:n="",onChange:s,getLabel:r,placeholder:i="Search...",disabled:o=!1,className:l="",required:c=!1,isSubmitted:u=!1,allowFreeText:d=!1}){const h=u&&c&&!n;return a.jsxs("div",{className:l,children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",c&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx(CFe,{items:t,value:n??"",onChange:s,getLabel:r,placeholder:i,disabled:o,hasError:h,allowFreeText:d})]})}function CFe({items:e=[],value:t="",onChange:n,getLabel:s,placeholder:r="Search...",disabled:i=!1,maxRender:o=200,hasError:l=!1,allowFreeText:c=!1}){const[u,d]=f.useState(!1),[h,p]=f.useState(""),x=f.useRef(null),v=e.find(N=>String(N.id)===String(t)),j=v?s(v):t,y=f.useMemo(()=>{const N=h.trim().toLowerCase();return(N?e.filter(S=>(s(S)||"").toLowerCase().includes(N)):e).slice(0,o)},[e,h,s,o]);return f.useEffect(()=>{const N=w=>{x.current&&!x.current.contains(w.target)&&d(!1)};return document.addEventListener("mousedown",N),()=>document.removeEventListener("mousedown",N)},[]),f.useEffect(()=>{u||p("")},[u]),a.jsxs("div",{ref:x,className:"relative w-full",children:[a.jsx("input",{disabled:i,value:u?h:j,placeholder:r,onFocus:()=>!i&&d(!0),onChange:N=>{p(N.target.value),u||d(!0)},className:`w-full border rounded-md px-2 py-1.5 text-sm outline-none focus:ring-2 disabled:bg-gray-100
          ${l?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}`}),u&&!i&&a.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg overflow-hidden",children:[a.jsxs("div",{className:"max-h-56 overflow-y-auto hide-scrollbar",children:[c&&h.trim()&&!y.some(N=>s(N).toLowerCase()===h.trim().toLowerCase())&&a.jsxs("button",{type:"button",onClick:()=>{n(h.trim()),d(!1)},className:"w-full text-left px-3 py-2 text-sm hover:bg-green-50 bg-blue-50 font-medium text-blue-700",children:['+ Add "',h.trim(),'" as new parent company']}),y.length>0?y.map(N=>{const w=String(N.id),S=s(N),_=String(t)===w;return a.jsx("button",{type:"button",onClick:()=>{n(w),d(!1)},className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-50 ${_?"bg-blue-50":""}`,children:S||"--"},w)}):!c||!h.trim()?a.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No results"}):null]}),e.length>o&&a.jsxs("div",{className:"px-3 py-2 text-[11px] text-gray-400 border-t",children:["Showing first ",o," results  keep typing to narrow."]})]})]})}function SFe({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o=!1,onConfirm:l,onCancel:c,icon:u=null,isArchive:d=!1}){if(!e)return null;const h=d?"bg-orange-500 hover:bg-orange-600 border border-orange-400":i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsxs("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 flex items-center justify-center ${h}`,disabled:o,children:[u&&a.jsx(u,{className:"mr-2",size:18}),o?"Processing...":s]})]})]})})}const _b={first_name:"",last_name:"",account_id:"",title:"",department:"",email:"",work_phone:"",mobile_phone_1:"",mobile_phone_2:"",notes:"",assigned_to:""},vl=e=>[e?.first_name,e?.last_name].filter(Boolean).join(" ").trim(),Ii=e=>e?new Date(e).toLocaleString("en-US",{month:"short",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).replace(",",""):"";function _Fe(){const e=kt(),t=ta();f.useEffect(()=>{document.title="Contacts | Sari-Sari CRM"},[]);const[n,s]=f.useState([]),[r,i]=f.useState(!1),[o,l]=f.useState([]),[c,u]=f.useState([]),[d,h]=f.useState(null),[p,x]=f.useState(!1),[v,j]=f.useState(!1),[y,N]=f.useState(!1),[w,S]=f.useState(null),[_,k]=f.useState(!1),[T,A]=f.useState(null),[E,M]=f.useState(_b),[z,P]=f.useState(""),[D,U]=f.useState("Filter by Accounts"),[B,R]=f.useState(null),[q,Z]=f.useState("Overview"),[V,oe]=f.useState(1),[je,X]=f.useState(10),[se,ye]=f.useState({}),[Ne,fe]=f.useState(null),[we,de]=f.useState(null),[ke,ge]=f.useState(null),[$e,be]=f.useState([]),{comments:me,addComment:Ue,refresh:Ee}=kn({relatedType:"contact",relatedId:d?.id});f.useEffect(()=>{d?.id&&Ee()},[d?.id,Ee]),f.useEffect(()=>{const Y=t.state?.contactID;Y&&(ge(Y),e(t.pathname,{replace:!0,state:{}}))},[t,e]),f.useEffect(()=>{if(ke&&n.length>0&&!r){const Y=n.find(F=>F.id===ke);Y?h(Y):H.error("Contact not found."),ge(null)}},[ke,n,r]),f.useEffect(()=>{async function Y(){try{const F=await re.get("/auth/me");de(F.data)}catch(F){console.error("Failed to fetch current user",F)}}Y()},[]);const We=f.useCallback(async(Y=null)=>{i(!0);try{const F=await re.get("/contacts/admin/fetch-all"),De=[...Array.isArray(F.data)?F.data:[]].sort((le,Ie)=>{const K=le?.created_at||le?.updated_at||0,ie=Ie?.created_at||Ie?.updated_at||0;return new Date(ie)-new Date(K)});if(s(De),Y){const le=De.find(Ie=>Ie.id===Y);h(le||null)}}catch(F){console.error(F),s([]),F.response?.status===403?H.error("Permission denied. Only CEO, Admin, or Group Manager can access this page."):H.error("Failed to fetch contacts. Please try again later.")}finally{i(!1)}},[h]),tt=f.useCallback(async()=>{try{const Y=await re.get("/accounts/admin/fetch-all"),ue=[...Array.isArray(Y.data)?Y.data:[]].sort((De,le)=>(De?.name||"").localeCompare(le?.name||""));l(ue)}catch(Y){console.error(Y),l([]),Y.response?.status===403&&H.warn("Unable to load accounts (permission denied).")}},[]),lt=f.useCallback(()=>{window.open("/sales/accounts?openModal=1","_blank","noopener,noreferrer")},[]),Fe=f.useCallback(async()=>{try{const Y=await re.get("/users/all"),ue=[...Array.isArray(Y.data)?Y.data:[]].sort((De,le)=>vl(De).localeCompare(vl(le)));u(ue)}catch(Y){console.error(Y),u([]),Y.response?.status===403&&H.warn("Unable to load users for assignment (permission denied).")}},[]),st=f.useCallback(async Y=>{try{const F=await re.get(`/activities/contact/${Y}`);ye(F.data&&typeof F.data=="object"?F.data:{})}catch(F){console.error(F),F.response?.status===404&&(console.warn("No activities found for this account."),ye({}))}},[]);f.useEffect(()=>{We(),tt(),Fe()},[We,tt,Fe]);const Xe=f.useMemo(()=>{const Y=new Map;o.forEach(ue=>{ue?.id&&ue?.name&&Y.set(String(ue.id),ue.name)}),n.forEach(ue=>{ue?.account_id&&ue?.account?.name&&Y.set(String(ue.account_id),ue.account.name)});const F=Array.from(Y.entries()).sort((ue,De)=>ue[1].localeCompare(De[1])).map(([ue,De])=>({value:ue,label:De}));return[{value:"Filter by Accounts",label:"Filter by Accounts"},...F]},[o,n]),Ze=f.useMemo(()=>{const Y=z.trim().toLowerCase(),F=D.trim();return n.filter(ue=>{const De=[ue?.first_name,ue?.last_name,ue?.email,ue?.title,ue?.department,ue?.account?.name,ue?.account?.status,ue?.work_phone,ue?.mobile_phone_1,ue?.mobile_phone_2,ue?.assigned_contact?.first_name,ue?.assigned_contact?.last_name,ue?.contact_creator?.first_name,ue?.contact_creator?.last_name,ue?.notes,Ii(ue?.created_at),Ii(ue?.updated_at)],le=Y===""||De.some(K=>K==null?!1:K.toString().toLowerCase().includes(Y)),Ie=F==="Filter by Accounts"||String(ue.account_id)===F;return le&&Ie})},[n,z,D]),Je=Math.max(1,Math.ceil(Ze.length/je)||1);f.useEffect(()=>{oe(1)},[z,D]),f.useEffect(()=>{oe(Y=>{const F=Math.max(1,Math.ceil(Ze.length/je)||1);return Y>F?F:Y})},[Ze.length,je]);const Be=f.useMemo(()=>{const Y=(V-1)*je;return Ze.slice(Y,Y+je)},[Ze,V,je]),_e=()=>oe(Y=>Math.max(Y-1,1)),pe=()=>oe(Y=>Math.min(Y+1,Je)),ce=f.useMemo(()=>{if(!v||!T)return o;const Y=n.find(ue=>ue.id===T);return!Y||!Y.account||o.some(ue=>ue.id===Y.account.id)?o:[...o,Y.account]},[o,v,T,n]),Q=f.useCallback(()=>{x(!1),j(!1),A(null),M(_b),N(!1),Re(!1)},[]),ne=Y=>{Y.target.id==="modalBackdrop"&&!y&&!_&&Q()},ae=Y=>{const{name:F,value:ue}=Y.target;M(De=>({...De,[F]:ue}))},Pe=()=>{M(_b),j(!1),A(null),x(!0),we?.role==="Sales"&&M(Y=>({...Y,assigned_to:we.id}))};f.useEffect(()=>{const Y=new URLSearchParams(t.search||"");(t.state?.openContactModal||Y.get("openModal")==="1")&&(M(_b),j(!1),A(null),x(!0),Re(!1),we?.role==="Sales"&&M(ue=>({...ue,assigned_to:we.id})),e(t.pathname,{replace:!0,state:{}}))},[t.state,t.pathname,t.search,e,we]);const Te=async Y=>{if(!Y)return;const F=await re.get(`/accounts/get/${Y.account_id}`);M({first_name:Y.first_name||"",last_name:Y.last_name||"",account_id:F.data.id?F.data.id:"",title:Y.title||"",department:Y.department||"",email:Y.email||"",work_phone:Y.work_phone||"",mobile_phone_1:Y.mobile_phone_1||"",mobile_phone_2:Y.mobile_phone_2||"",notes:Y.notes||"",assigned_to:Y.assigned_to?String(Y.assigned_to):""}),j(!0),A(Y.id),x(!0),h(null)},he=Y=>{if(!Y)return;const F=vl(Y)||"this contact",ue=we?.role==="Admin"||we?.role==="CEO"||we?.role==="MANAGER"||we?.role==="GROUP MANAGER",De=ue?"delete":"archive",le=ue?"This action cannot be undone.":"This contact will be hidden from your view but admins can still see it.",Ie=!ue;S({title:`${De.charAt(0).toUpperCase()+De.slice(1)} Contact`,message:a.jsxs("span",{children:["Are you sure you want to ",De," ",a.jsx("span",{className:"font-semibold",children:F}),"? ",le]}),confirmLabel:`${De.charAt(0).toUpperCase()+De.slice(1)} Contact`,cancelLabel:"Cancel",variant:"danger",icon:Ie?Zt:null,isArchive:Ie,action:{type:"delete",targetId:Y.id,name:F}})},He=()=>{const Y=Be.filter(F=>F.assigned_contact?.id===we?.id&&F.contact_creator?.id===we?.id);$e.length===Y.length&&Y.length>0?be([]):be(Y.map(F=>F.id))},qe=Y=>{be(F=>F.includes(Y)?F.filter(ue=>ue!==Y):[...F,Y])},nt=async()=>{if($e.length===0)return;const Y=we?.role==="Admin"||we?.role==="CEO"||we?.role==="MANAGER"||we?.role==="GROUP MANAGER",F=Y?"delete":"archive",ue=Y?"This action cannot be undone.":"These contacts will be hidden from your view but admins can still see them.",De=!Y;S({title:`${F.charAt(0).toUpperCase()+F.slice(1)} Contacts`,message:a.jsxs("span",{children:["Are you sure you want to ",F," ",a.jsx("span",{className:"font-semibold",children:$e.length})," selected contacts? ",ue]}),confirmLabel:`${F.charAt(0).toUpperCase()+F.slice(1)} ${$e.length} contact(s)`,cancelLabel:"Cancel",variant:"danger",icon:De?Zt:null,isArchive:De,action:{type:"bulk-delete",contactIds:$e}})},[ot,Re]=f.useState(!1),it=Y=>{Y.preventDefault(),Re(!0);const F=E.first_name.trim(),ue=E.last_name.trim();if(!F||!ue){H.error("First name and last name are required.");return}if(!E.account_id){H.error("Account is required.");return}if(!E.assigned_to){H.error("Assigned To is required.");return}const le=E.email?.trim();if(!le){H.error("Email is required.");return}if(!le.includes("@")){H.error("Email must contain '@'.");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(le)){H.error("Please enter a valid email address.");return}const K={first_name:F,last_name:ue,account_id:Number(E.account_id),title:E.title?.trim()||null,department:E.department?.trim()||null,email:E.email?.trim().toLowerCase()||null,work_phone:E.work_phone?.trim()||null,mobile_phone_1:E.mobile_phone_1?.trim()||null,mobile_phone_2:E.mobile_phone_2?.trim()||null,notes:E.notes?.trim()||null,assigned_to:E.assigned_to?Number(E.assigned_to):null},ie=v&&T?"update":"create",Me=`${F} ${ue}`.trim();S({title:ie==="create"?"Confirm New Contact":"Confirm Update",message:ie==="create"?a.jsxs("span",{children:["Are you sure you want to add"," ",a.jsx("span",{className:"font-semibold",children:Me})," to your contacts?"]}):a.jsxs("span",{children:["Save changes to ",a.jsx("span",{className:"font-semibold",children:Me}),"?"]}),confirmLabel:ie==="create"?"Create Contact":"Update Contact",cancelLabel:"Cancel",variant:"primary",action:{type:ie,payload:K,targetId:T||null,name:Me}})},St=async()=>{if(!w?.action){S(null);return}const{action:Y}=w,{type:F,payload:ue,targetId:De,name:le}=Y;k(!0);try{if(F==="create"){N(!0),await re.post("/contacts/admin",ue),H.success(`Contact "${le}" created successfully.`);const Ie=d?.id||null;Q(),await We(Ie)}else if(F==="update"){if(!De)throw new Error("Missing contact identifier for update.");N(!0),await re.put(`/contacts/admin/${De}`,ue),H.success(`Contact "${le}" updated successfully.`);const Ie=d?.id&&d.id===De?De:d?.id||null;Q(),await We(Ie),d?.id===De&&h(null)}else if(F==="delete"){if(!De)throw new Error("Missing contact identifier for deletion.");const Ie=d?.id;R(De);const ie=we?.role==="Admin"||we?.role==="CEO"||we?.role==="MANAGER"||we?.role==="GROUP MANAGER"?`Contact "${le}" deleted successfully.`:`Contact "${le}" archived successfully.`;await re.delete(`/contacts/admin/${De}`),H.success(ie),await We(Ie&&Ie!==De?Ie:null),Ie===De&&h(null)}else if(F==="bulk-delete"){const{contactIds:Ie}=Y;if(!Ie||Ie.length===0)throw new Error("No contacts provided for bulk deletion.");const ie=we?.role==="Admin"||we?.role==="CEO"||we?.role==="MANAGER"||we?.role==="GROUP MANAGER"?`Successfully deleted ${Ie.length} contact(s).`:`Successfully archived ${Ie.length} contact(s).`;await re.delete("/contacts/admin/bulk-delete",{data:{contact_ids:Ie}}),H.success(ie),be([]),await We(),h(null)}}catch(Ie){console.error(Ie);const K=F==="create"?"Failed to create contact. Please review the details and try again.":F==="update"?"Failed to update contact. Please review the details and try again.":F==="bulk-delete"?"Failed to delete contacts. Please try again.":"Failed to delete contact. Please try again.",ie=Ie.response?.data?.detail||K;H.error(ie)}finally{(F==="create"||F==="update")&&N(!1),F==="delete"&&R(null),k(!1),S(null)}},Et=()=>{_||S(null)},Tt=Y=>{h(Y),Z("Overview")},Nt=()=>h(null),xe=Y=>{Y.target.id==="contactModalBackdrop"&&!_&&Nt()},ve=w?.action?.type==="delete"?w.action.targetId:null,Oe=d&&(B===d.id||ve===d.id),Ce=d&&B===d.id,Qe=d?a.jsx("div",{id:"contactModalBackdrop",onClick:xe,className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-6xl max-h-[92vh] overflow-y-auto hide-scrollbar animate-scale-in font-inter relative",onClick:Y=>Y.stopPropagation(),children:[a.jsxs("div",{className:"bg-tertiary w-full rounded-t-xl relative p-3 lg:p-3",children:[a.jsx("h1",{className:"lg:text-3xl text-xl text-white font-semibold text-center w-full",children:"Contact"}),a.jsx("button",{onClick:Nt,className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-white cursor-pointer",children:a.jsx(Ja,{size:25})})]}),a.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between lg:flex-row lg:items-center lg:justify-between mt-3 gap-2 px-2 md:items-center lg:gap-4 md:mx-7 lg:mx-7",children:[a.jsx("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:a.jsx("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-800",children:vl(d)||"Unnamed contact"})}),a.jsx("div",{className:"flex flex-col sm:flex-row sm:space-x-3 space-y-2 sm:space-y-0",children:d.assigned_contact&&d.assigned_contact.id===we?.id&&d.contact_creator&&d.contact_creator.id===we?.id&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{className:"inline-flex items-center justify-center w-full sm:w-auto bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 disabled:opacity-70 transition text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",onClick:()=>Te(d),disabled:_||w?.action?.type==="update"&&w.action.targetId===d.id,children:[a.jsx(gn,{className:"mr-2"}),"Edit"]}),a.jsx("button",{className:"inline-flex items-center justify-center w-full sm:w-auto px-4 py-2 rounded-md text-sm bg-orange-500 text-white hover:bg-orange-600 transition focus:outline-none focus:ring-2 focus:ring-orange-400",onClick:()=>he(d),disabled:!!Oe,children:Ce?"Archiving...":a.jsxs(a.Fragment,{children:[a.jsx(Zt,{className:"mr-2"}),"Archive"]})})]})})]}),a.jsx("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-2 px-2 lg:gap-4 md:mx-7 lg:mx-7",children:a.jsx("p",{className:"text-sm text-gray-500",children:d.account?.name||"No associated account"})}),a.jsx("div",{className:"border-b border-gray-200 my-5"}),a.jsxs("div",{className:"p-6 lg:p-4",children:[a.jsx("div",{className:"flex w-full bg-[#6A727D] text-white mt-1 overflow-x-auto mb-6",children:["Overview","Notes","Activities"].map(Y=>a.jsx("button",{onClick:()=>Z(Y),className:`flex-1 min-w-[90px] px-4 py-2.5 text-xs sm:text-sm font-medium text-center transition-all duration-200 border-b-2
        ${q===Y?"bg-paper-white text-[#6A727D] border-white":"text-white hover:bg-[#5c636d]"}`,children:Y},Y))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 items-start",children:[a.jsxs("div",{className:"lg:col-span-3",children:[q==="Overview"&&a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 md:p-8 border border-gray-200",children:a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4 sm:gap-6 text-sm text-gray-700",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Contact Name:"}),a.jsx("p",{children:vl(d)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Title:"}),a.jsx("p",{children:d.title||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Email:"}),a.jsx("p",{children:d.email?a.jsx("a",{href:`mailto:${d.email}`,className:"text-blue-600 hover:underline break-all",children:d.email}):"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Department:"}),a.jsx("p",{children:d.department||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Work Phone:"}),a.jsx("p",{children:d.work_phone||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Mobile Phone 1:"}),a.jsx("p",{children:d.mobile_phone_1||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Mobile Phone 2:"}),a.jsx("p",{children:d.mobile_phone_2||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Assigned To:"}),a.jsx("p",{children:d.assigned_contact?`${d.assigned_contact.first_name} ${d.assigned_contact.last_name}`:"Unassigned"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created By:"}),a.jsx("p",{children:d.contact_creator?`${d.contact_creator.first_name} ${d.contact_creator.last_name}`:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created At:"}),a.jsx("p",{children:Ii(d.created_at)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Last Updated:"}),a.jsx("p",{children:Ii(d.updated_at)||"N/A"})]})]})}),q==="Notes"&&a.jsxs("div",{className:"mt-4 w-full",children:[a.jsx("div",{className:"flex flex-wrap items-center justify-between mb-4 gap-2",children:a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words",children:"Contact Note"})}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 shadow-sm break-words",children:[a.jsx("div",{className:"flex items-start justify-between",children:a.jsx("div",{children:a.jsx("p",{className:"text-sm font-medium text-gray-800 break-words",children:"Note"})})}),a.jsx("div",{className:"mt-3 text-sm text-gray-700 whitespace-pre-wrap break-words",children:d.notes||"No notes available."})]}),a.jsx(Tn,{comments:me,onAddComment:Ue})]}),q==="Activities"&&a.jsxs("div",{className:"space-y-2 w-full h-full max-h-[50dvh] overflow-y-auto bg-gray-50 p-2 hide-scrollbar rounded-lg border border-gray-200 shadow-sm",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words border-b border-gray-300 py-2",children:"Related Activities"}),a.jsxs("div",{className:"space-y-2 text-sm",children:[se.tasks&&se.tasks.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>fe(Ne==="tasks"?null:"tasks"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Qt,{className:"text-blue-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Tasks (",se.tasks.length,")"]})]}),Ne==="tasks"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Ne==="tasks"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:se.tasks.map((Y,F)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words",children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-blue-600 mt-1",children:a.jsx(Qt,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:Y.subject||Y.title||"Task"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:Y.description||"No description"}),Y.assigned_to&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Assigned: ",Y.assigned_to.first_name," ",Y.assigned_to.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:Ii(Y.due_date||Y.created_at)})]},`task-${F}`))})]}),se.meetings&&se.meetings.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>fe(Ne==="meetings"?null:"meetings"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ot,{className:"text-green-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Meetings (",se.meetings.length,")"]})]}),Ne==="meetings"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Ne==="meetings"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:se.meetings.map((Y,F)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words",children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-green-600 mt-1",children:a.jsx(Ot,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:Y.subject||Y.title||"Meeting"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:Y.description||Y.location||"No description"}),Y.host&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Host: ",Y.host.first_name," ",Y.host.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:Ii(Y.start_time||Y.created_at)})]},`meeting-${F}`))})]}),se.calls&&se.calls.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>fe(Ne==="calls"?null:"calls"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(It,{className:"text-purple-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Calls (",se.calls.length,")"]})]}),Ne==="calls"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Ne==="calls"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:se.calls.map((Y,F)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words",children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-purple-600 mt-1",children:a.jsx(It,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:Y.subject||Y.title||"Call"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:Y.direction||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:Ii(Y.call_time||Y.created_at)})]},`call-${F}`))})]}),se.contacts&&se.contacts.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>fe(Ne==="contacts"?null:"contacts"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ra,{className:"text-teal-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Contacts (",se.contacts.length,")"]})]}),Ne==="contacts"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Ne==="contacts"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:se.contacts.map((Y,F)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words",children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-teal-600 mt-1",children:a.jsx(ra,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("h4",{className:"font-medium text-blue-600 break-words text-sm",children:[Y.first_name?`${Y.first_name} `:"",Y.last_name]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:Y.title||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:Ii(Y.created_at)})]},`contact-${F}`))})]}),se.deals&&se.deals.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>fe(Ne==="deals"?null:"deals"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(sa,{className:"text-indigo-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Deals (",se.deals.length,")"]})]}),Ne==="deals"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Ne==="deals"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:se.deals.map((Y,F)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words",children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-indigo-600 mt-1",children:a.jsx(sa,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("h4",{className:"font-medium text-blue-600 break-words text-sm",children:[Y.deal_id?Y.deal_id.replace(/D(\d+)-\d+-/,"D$1-"):"--"," ",Y.name||Y.title||"Deal"]}),a.jsx("p",{className:"text-xs text-gray-500 break-words capitalize",children:Y.stage||Y.description||"No description"})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:Ii(Y.close_date||Y.created_at)})]},`deal-${F}`))})]}),se.quotes&&se.quotes.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>fe(Ne==="quotes"?null:"quotes"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ia,{className:"text-orange-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Quotes (",se.quotes.length,")"]})]}),Ne==="quotes"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Ne==="quotes"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:se.quotes.map((Y,F)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words",children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-orange-600 mt-1",children:a.jsx(ia,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:(Y.quote_id?Y.quote_id.replace(/Q(\d+)-\d+-/,"Q$1-"):"--")||"Quote"}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:Y.status||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:Ii(Y.presented_date)||""})]},`quote-${F}`))})]}),(!se||(!se.tasks||se.tasks.length===0)&&(!se.meetings||se.meetings.length===0)&&(!se.calls||se.calls.length===0)&&(!se.quotes||se.quotes.length===0)&&(!se.deals||se.deals.length===0)&&(!se.contacts||se.contacts.length===0))&&a.jsx("div",{className:"text-center py-8 text-gray-500",children:a.jsx("p",{children:"No related activities found for this account."})})]})]})]}),a.jsx("div",{className:"flex flex-col gap-4",children:a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Quick Actions"}),a.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[a.jsxs("button",{onClick:()=>e("/sales/calls",{state:{openCallModal:!0,initialCallData:{subject:`Call with ${vl(d)||""}`.trim(),relatedType1:"Account",relatedTo1:d?.account_id?String(d.account_id):d?.account?.id?String(d.account.id):"",relatedType2:"Contact",relatedTo2:d?.id?String(d.id):"",assigned_to:d?.assigned_contact?.id?String(d.assigned_contact.id):"",direction:"Outgoing",status:"Planned"}}}),className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(It,{className:"text-gray-600 w-4 h-4"}),"Schedule Call"]}),a.jsxs("button",{type:"button",onClick:()=>{if(!d?.email){alert("No email address available");return}const Y=encodeURIComponent(d.email),F=encodeURIComponent(""),ue=encodeURIComponent(""),De=`mailto:${Y}?subject=${F}&body=${ue}`;window.location.href=De},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(rn,{className:"text-gray-600 w-4 h-4"}),"Send E-mail"]}),a.jsxs("button",{className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",onClick:()=>e("/sales/meetings",{state:{openMeetingModal:!0,initialMeetingData:{subject:`Meeting with ${vl(d)||""}`.trim(),relatedType1:"Account",relatedTo1:d?.account_id?String(d.account_id):d?.account?.id?String(d.account.id):"",relatedType2:"Contact",relatedTo2:d?.id?String(d.id):"",assignedTo:d?.assigned_contact?.id?String(d.assigned_contact.id):"",status:"Planned"}}}),children:[a.jsx(Ot,{className:"text-gray-600 w-4 h-4"}),"Book Meeting"]}),a.jsxs("button",{onClick:()=>e("/sales/tasks",{state:{openTaskModal:!0,initialTaskData:{subject:`Task for ${vl(d)||""}`.trim(),relatedType1:"Account",relatedTo1:d?.account_id?String(d.account_id):d?.account?.id?String(d.account.id):"",relatedType2:"Contact",relatedTo2:d?.id?String(d.id):"",assignedTo:d?.assigned_contact?.id?String(d.assigned_contact.id):"",priority:"NORMAL",status:"Not Started"}}}),className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(Qt,{className:"text-gray-600 w-4 h-4"}),"Tasks"]})]})]})})]})]})]})}):null,G=a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[r&&a.jsx(Wt,{message:"Loading contacts..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0 w-full",children:[a.jsxs("h2",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(Za,{className:"mr-2 text-blue-600"})," Contacts Management"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{onClick:()=>{Pe(),Re(!1)},className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 rounded-md hover:bg-gray-800 text-sm sm:text-base self-end sm:self-auto cursor-pointer",children:[a.jsx(aa,{className:"mr-2"})," Add Contact"]})})]}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search contacts",value:z,onChange:Y=>P(Y.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsx("div",{className:"w-full lg:w-1/4",children:a.jsx("select",{value:D,onChange:Y=>U(Y.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:Xe.map(Y=>a.jsx("option",{value:Y.value,children:Y.label},Y.value??Y.label))})})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[600px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 text-sm tracking-wide font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 text-center w-12",children:a.jsx("input",{type:"checkbox",checked:Be.length>0&&Be.filter(Y=>Y.assigned_contact?.id===we?.id&&Y.contact_creator?.id===we?.id).every(Y=>$e.includes(Y.id))&&Be.some(Y=>Y.assigned_contact?.id===we?.id&&Y.contact_creator?.id===we?.id),onChange:He,className:"form-checkbox h-4 w-4 text-blue-600 rounded focus:ring-blue-500 border-gray-300"})}),a.jsx("th",{className:"py-3 px-4 truncate",children:"Contact"}),a.jsx("th",{className:"py-3 px-4",children:"Account"}),a.jsx("th",{className:"py-3 px-4 truncate",children:"Contact Info"}),a.jsx("th",{className:"py-3 px-4",children:"Department"}),a.jsx("th",{className:"py-3 px-4",children:"Assigned To"}),a.jsx("th",{className:"py-3 px-4",children:"Created"}),a.jsx("th",{className:"py-3 px-4 text-center w-24",children:$e.length>0?a.jsx("button",{onClick:nt,className:"text-orange-600 hover:text-orange-800 transition p-1 rounded-full hover:bg-orange-50",title:`Archive ${$e.length} selected contacts`,children:a.jsx(Zt,{size:18})}):""})]})}),a.jsx("tbody",{children:r?a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:8,children:"Loading contacts..."})}):Ze.length>0?Be.map(Y=>{const F=[{Icon:rn,value:Y.email,key:"email"},{Icon:It,value:Y.work_phone,key:"work_phone"},{Icon:fd,value:Y.mobile_phone_1,key:"mobile_phone_1"},{Icon:fd,value:Y.mobile_phone_2,key:"mobile_phone_2"}].filter(ue=>!!ue.value);return a.jsxs("tr",{className:"hover:bg-gray-50 text-sm cursor-pointer transition",children:[a.jsx("td",{className:"py-3 px-4 align-top text-center",onClick:ue=>ue.stopPropagation(),children:Y.assigned_contact&&Y.assigned_contact.id===we?.id&&Y.contact_creator&&Y.contact_creator.id===we?.id?a.jsx("input",{type:"checkbox",checked:$e.includes(Y.id),onChange:()=>qe(Y.id),className:"form-checkbox h-4 w-4 text-blue-600 rounded focus:ring-blue-500 border-gray-300",onClick:ue=>ue.stopPropagation()}):null}),a.jsxs("td",{className:"py-3 px-4 align-top",onClick:()=>{Tt(Y),st(Y.id)},children:[a.jsx("div",{className:"font-medium text-blue-600 hover:underline break-all text-sm",children:vl(Y)||"--"}),a.jsx("div",{className:"text-xs text-gray-500",children:Y.title||"No title"})]}),a.jsx("td",{className:"py-3 px-4 align-top",onClick:()=>{Tt(Y),st(Y.id)},children:a.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-700",children:[a.jsx(Vx,{className:"text-gray-500 flex-shrink-0"}),a.jsx("span",{className:"break-words",children:Y.account?.name||"--"})]})}),a.jsx("td",{className:"py-3 px-4 align-top",onClick:()=>{Tt(Y),st(Y.id)},children:F.length>0?a.jsx("div",{className:"space-y-1 text-gray-700",children:F.map(({Icon:ue,value:De,key:le})=>{const Ie=wt.createElement(ue,{className:"text-gray-500 flex-shrink-0"});return a.jsxs("div",{className:"flex items-center space-x-2 break-all text-sm",children:[Ie,a.jsx("span",{children:De})]},le)})}):a.jsx("span",{className:"text-gray-400 text-sm",children:"--"})}),a.jsx("td",{className:"py-3 px-4 align-top",onClick:()=>{Tt(Y),st(Y.id)},children:a.jsxs("div",{className:"flex items-center space-x-2 text-gray-700 text-sm",children:[a.jsx(sa,{className:"text-gray-500 flex-shrink-0"}),a.jsx("span",{children:Y.department||"--"})]})}),a.jsx("td",{className:"py-3 px-4 align-top",onClick:()=>{Tt(Y),st(Y.id)},children:a.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[a.jsx(ra,{className:"text-gray-500 flex-shrink-0"}),a.jsx("span",{children:Y.assigned_contact?`${Y.assigned_contact.first_name} ${Y.assigned_contact.last_name}`:"Unassigned"})]})}),a.jsx("td",{className:"py-3 px-4 align-top",onClick:()=>{Tt(Y),st(Y.id)},children:a.jsxs("div",{className:"flex items-center space-x-2 text-gray-500",children:[a.jsx(Ot,{className:"text-gray-500 flex-shrink-0"}),a.jsx("span",{className:"text-xs",children:Ii(Y.created_at)||"--"})]})})]},Y.id)}):a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:8,children:"No contacts found."})})})]})}),a.jsx(ca,{className:"mt-4",totalItems:Ze.length,pageSize:je,currentPage:V,onPrev:_e,onNext:pe,onPageSizeChange:Y=>{X(Y),oe(1)},pageSizeOptions:[10,20,30,40,50],label:"contacts"})]}),W=p?a.jsx("div",{id:"modalBackdrop",onClick:ne,className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-full sm:max-w-3xl rounded-2xl shadow-lg p-4 sm:p-6 md:p-8 relative border border-gray-200 overflow-y-auto max-h-[90vh] hide-scrollbar",onClick:Y=>Y.stopPropagation(),children:[a.jsx("button",{onClick:()=>{Q(),Re(!1)},className:"absolute top-4 right-4 text-gray-500 hover:text-black transition disabled:opacity-60",disabled:y||_,children:a.jsx(ea,{size:22})}),a.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800 mb-4 sm:mb-6 flex items-center justify-center",children:v?"Edit Contact":"Add New Contact"}),a.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",onSubmit:it,noValidate:!0,children:[a.jsx(Hc,{label:"First Name",name:"first_name",value:E.first_name,onChange:ae,placeholder:"First name",required:!0,isSubmitted:ot}),a.jsx(Hc,{label:"Last Name",name:"last_name",value:E.last_name,onChange:ae,placeholder:"Last name",required:!0,isSubmitted:ot}),a.jsx(m8,{label:"Account",value:E.account_id,onChange:Y=>M(F=>({...F,account_id:Y})),items:v?ce:o||[],getLabel:Y=>Y?.name??"",placeholder:"Search account...",actions:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{type:"button",onClick:lt,disabled:y,title:"Add account",className:"inline-flex items-center justify-center w-8 h-8 rounded-md border border-gray-300 text-gray-600 hover:bg-gray-50 transition disabled:opacity-60",children:a.jsx(aa,{size:16})}),a.jsx("button",{type:"button",onClick:tt,disabled:y,title:"Refresh accounts",className:"inline-flex items-center justify-center w-8 h-8 rounded-md border border-gray-300 text-gray-600 hover:bg-gray-50 transition disabled:opacity-60",children:a.jsx(Br,{size:16})})]}),disabled:y||(v?ce.length===0:o.length===0),required:!0,isSubmitted:ot}),a.jsx(m8,{label:"Assigned To",value:E.assigned_to,onChange:Y=>M(F=>({...F,assigned_to:Y})),items:c||[],getLabel:Y=>`${Y?.first_name??""} ${Y?.last_name??""} (${Y?.role??""})`.trim(),placeholder:"Search assignee...",required:!0,isSubmitted:ot,disabled:y||c.length===0||we?.role==="Sales"}),a.jsx(Hc,{label:"Title",name:"title",value:E.title,onChange:ae,placeholder:"Job title",disabled:y}),a.jsx(Hc,{label:"Department",name:"department",value:E.department,onChange:ae,placeholder:"Department",disabled:y}),a.jsx(Hc,{label:"Email",name:"email",type:"email",value:E.email,onChange:ae,placeholder:"example@email.com",required:!0,isSubmitted:ot}),a.jsx(Hc,{label:"Work Phone",name:"work_phone",value:E.work_phone,onChange:ae,placeholder:"09xx xxx xxxx",disabled:y}),a.jsx(Hc,{label:"Mobile Phone 1",name:"mobile_phone_1",value:E.mobile_phone_1,onChange:ae,placeholder:"09xx xxx xxxx",disabled:y}),a.jsx(Hc,{label:"Mobile Phone 2",name:"mobile_phone_2",value:E.mobile_phone_2,onChange:ae,placeholder:"09xx xxx xxxx",disabled:y}),a.jsx(TFe,{label:"Notes",name:"notes",value:E.notes,onChange:ae,placeholder:"Additional details...",rows:3,disabled:y,className:"md:col-span-2"}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-2 md:col-span-2 mt-4",children:[a.jsx("button",{type:"button",onClick:()=>{Q(),Re(!1)},className:"w-full sm:w-auto px-4 py-2 text-white bg-red-400 border border-red-300 rounded hover:bg-red-500 transition disabled:opacity-70",disabled:y||_,children:"Cancel"}),a.jsx("button",{type:"submit",className:"w-full sm:w-auto px-4 py-2 text-white border border-tertiary bg-tertiary rounded hover:bg-secondary transition disabled:opacity-70",disabled:y||_,children:y?"Saving...":v?"Update Contact":"Save Contact"})]})]})]})}):null,J=w?a.jsx(kFe,{open:!0,title:w.title,message:w.message,confirmLabel:w.confirmLabel,cancelLabel:w.cancelLabel,variant:w.variant,onConfirm:St,onCancel:Et,loading:_,icon:w.icon,isArchive:w.isArchive}):null;return a.jsxs(a.Fragment,{children:[G,Qe,W,J]})}function Hc({label:e,name:t,value:n,onChange:s,placeholder:r,type:i="text",required:o=!1,disabled:l=!1,isSubmitted:c=!1,className:u=""}){const d=c&&!n?.trim();return a.jsxs("div",{children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",o&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:i,name:t,value:n??"",onChange:s,placeholder:r,required:o,disabled:l,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border focus:ring-2
          ${d?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}
          ${u}
        `})]})}function m8({label:e,items:t=[],value:n="",onChange:s,getLabel:r,placeholder:i="Search...",disabled:o=!1,className:l="",required:c=!1,isSubmitted:u=!1,actions:d=null}){const h=u&&c&&!n;return a.jsxs("div",{className:l,children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",c&&a.jsx("span",{className:"text-red-500",children:"*"})]}),d?a.jsx("div",{className:"flex items-center",children:d}):null]}),a.jsx(AFe,{items:t,value:n??"",onChange:s,getLabel:r,placeholder:i,disabled:o,hasError:h})]})}function AFe({items:e=[],value:t="",onChange:n,getLabel:s,placeholder:r="Search...",disabled:i=!1,maxRender:o=200,hasError:l=!1}){const[c,u]=f.useState(!1),[d,h]=f.useState(""),p=f.useRef(null),x=e.find(y=>String(y.id)===String(t)),v=x?s(x):"",j=f.useMemo(()=>{const y=d.trim().toLowerCase();return(y?e.filter(w=>(s(w)||"").toLowerCase().includes(y)):e).slice(0,o)},[e,d,s,o]);return f.useEffect(()=>{const y=N=>{p.current&&!p.current.contains(N.target)&&u(!1)};return document.addEventListener("mousedown",y),()=>document.removeEventListener("mousedown",y)},[]),f.useEffect(()=>{c||h("")},[c]),a.jsxs("div",{ref:p,className:"relative w-full",children:[a.jsx("input",{disabled:i,value:c?d:v,placeholder:r,onFocus:()=>!i&&u(!0),onChange:y=>{h(y.target.value),c||u(!0)},className:`w-full border rounded-md px-2 py-1.5 text-sm outline-none focus:ring-2 disabled:bg-gray-100
          ${l?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}`}),c&&!i&&a.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg overflow-hidden",children:[a.jsx("div",{className:"max-h-56 overflow-y-auto",children:j.length>0?j.map(y=>{const N=String(y.id),w=s(y),S=String(t)===N;return a.jsx("button",{type:"button",onClick:()=>{n(N),u(!1)},className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-50 ${S?"bg-blue-50":""}`,children:w||"--"},N)}):a.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No results"})}),e.length>o&&a.jsxs("div",{className:"px-3 py-2 text-[11px] text-gray-400 border-t",children:["Showing first ",o," results  keep typing to narrow."]})]})]})}function TFe({label:e,name:t,value:n,onChange:s,placeholder:r,rows:i=3,disabled:o=!1,className:l=""}){return a.jsxs("div",{className:l,children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsx("textarea",{name:t,value:n??"",onChange:s,placeholder:r,rows:i,disabled:o,className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100 resize-none"})]})}function kFe({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o=!1,onConfirm:l,onCancel:c,icon:u=null,isArchive:d=!1}){if(!e)return null;const h=d?"bg-orange-500 hover:bg-orange-600 border border-orange-400":i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsxs("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 flex items-center justify-center ${h}`,disabled:o,children:[u&&a.jsx(u,{className:"mr-2",size:18}),o?"Processing...":s]})]})]})})}const OA=e=>e?new Date(e).toLocaleString("en-US",{month:"short",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).replace(",",""):"";function uJ({lead:e,onBack:t,fetchLeads:n,onEdit:s,onArchive:r,setSelectedLead:i,relatedActs:o}){const l=kt(),{leadID:c}=Wo(),{user:u}=Vt(),[d,h]=f.useState(e||null),[p,x]=f.useState("Overview"),[v,j]=f.useState(""),y=d?.status?.toUpperCase()==="QUALIFIED",[N,w]=f.useState(null),S=d&&u&&d.creator?.id===u.id,[_,k]=f.useState({name:"",website:"",countryCode:"",phone_number:"",billing_address:"",shipping_address:"",industry:"",status:"Prospect",territory_id:null,assigned_to:null,created_by:null}),[T,A]=f.useState({last_name:"",first_name:"",account_id:null,title:"",department:"",email:"",work_phone:"",mobile_phone_1:"",mobile_phone_2:"",notes:"",assigned_to:null,created_by:null}),[E,M]=f.useState({name:"Converted from Lead",account_id:null,primary_contact_id:null,stage:"Prospecting",probability:10,amount:0,currency:"PHP",description:"Initial deal from lead conversion.",assigned_to:null,created_by:null}),z=async()=>{try{if(e){h(e),j(e.status||"New");return}if(!c)return;const R=await re.get(`/leads/get/${c}`);h(R.data),j(R.data.status||"New"),k({name:R.data.company_name||"",website:"",countryCode:"+63",phone_number:"",billing_address:"",shipping_address:"",industry:"",status:"Prospect",territory_id:R.data.territory?.id||null,assigned_to:R.data.assigned_to?.id||null,created_by:R.data.creator?.id||null}),A({last_name:R.data.last_name||"",first_name:R.data.first_name||"",account_id:null,title:R.data.title||"",department:R.data.department||"",email:R.data.email||"",work_phone:R.data.work_phone||"",mobile_phone_1:R.data.mobile_phone_1||"",mobile_phone_2:R.data.mobile_phone_2||"",notes:"",assigned_to:R.data.assigned_to?.id||null,created_by:R.data.creator?.id||null}),M({name:"Converted from Lead",account_id:null,primary_contact_id:null,stage:"Prospecting",probability:10,amount:0,currency:"PHP",description:"Initial deal from lead conversion.",assigned_to:R.data.assigned_to?.id||null,created_by:R.data.creator?.id||null})}catch(R){console.error(R)}};f.useEffect(()=>{e?(h(e),j(e.status||"New")):c&&z()},[c,e]);const P=async()=>{try{if(v==="Converted"&&d?.status?.toUpperCase()!=="QUALIFIED"){H.error("Lead must be Qualified before it can be converted.");return}const R=await re.put(`/leads/${d.id}/update/status`,{status:v});H.success("Lead status updated successfully");const q={...d,status:R.data.status};h(q),i&&i(q),n&&n(),t&&t()}catch(R){console.error(R),H.error("Failed to update lead status")}},D=async R=>{const q={..._,assigned_to:R.assigned_to?.id,billing_address:R.address,shipping_address:R.address,created_by:R.creator?.id,industry:null,name:R.company_name,phone_number:R.work_phone,status:"Prospect",territory_id:R.territory?.id,website:""};console.log("Account data: ",q),console.log("Contact data: ",T),console.log("Deal data: ",E),console.log("Lead data: ",R);try{const V=(await re.post("/accounts/convertedLead",q)).data.id,oe={...T,account_id:V,assigned_to:R.assigned_to?.id,created_by:R.creator?.id,department:R.department,email:R.email,first_name:R.first_name,last_name:R.last_name,mobile_phone_1:R.mobile_phone_1,mobile_phone_2:R.mobile_phone_2,notes:R.notes,title:R.title,work_phone:R.work_phone},X=(await re.post("/contacts/convertedLead",oe)).data.id,se=()=>{switch(E.stage){case"PROSPECTING":return 10;case"QUALIFICATION":return 25;case"PROPOSAL":return 60;case"NEGOTIATION":return 80;case"CLOSED_WON":return 100;case"CLOSED_LOST":return 0;default:return 0}},ye=E.amount&&E.amount!==""?parseFloat(E.amount):0,Ne={...E,account_id:V,assigned_to:R.assigned_to?.id,created_by:R.creator?.id,primary_contact_id:X,probability:se(),stage:"Prospecting"},fe=await re.post("/deals/convertedLead",Ne),we=await re.put(`/leads/convert/${R.id}`);i&&i(null),n(),H.success("Lead converted successfully!"),t()}catch(Z){console.error("Error during conversion:",Z);const V=Z.response?.data?.detail||Z.message||"Failed to convert lead. Please try again.";H.error(V)}},U=R=>{switch((R||"").toUpperCase()){case"NEW":return"bg-indigo-100 text-indigo-700";case"CONTACTED":return"bg-blue-100 text-blue-700";case"QUALIFIED":return"bg-green-100 text-green-700";case"CONVERTED":return"bg-emerald-100 text-emerald-700";case"LOST":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-700"}},B=R=>R.toString().toLowerCase().replace(/\b\w/g,q=>q.toUpperCase());return d?a.jsx(a.Fragment,{children:a.jsx("div",{className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-lg w-full max-w-full sm:max-w-6xl max-h-[90vh] overflow-y-auto hide-scrollbar relative box-border",children:[a.jsx("div",{className:"bg-tertiary w-full rounded-t-xl p-3 lg:p-3",children:a.jsxs("div",{className:"flex items-start justify-between w-full",children:[a.jsx("h1",{className:"lg:text-3xl text-xl text-white font-semibold text-center w-full",children:"Lead"}),a.jsx("button",{onClick:()=>{t?t():l(-1)},className:"text-gray-400 hover:text-white mt-1 cursor-pointer",children:a.jsx(Ja,{size:25})})]})}),a.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between lg:flex-row lg:items-center lg:justify-between mt-3 gap-2 px-2 md:items-center lg:gap-4 md:mx-7 lg:mx-7",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[a.jsxs("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-800",children:[d.first_name," ",d.last_name]}),a.jsx("span",{className:`text-xs sm:text-sm font-medium px-2 sm:px-3 py-1 rounded-full whitespace-nowrap ${U(d.status)}`,children:B(d.status||"New")}),a.jsx("div",{className:"flex flex-col",children:a.jsx("button",{onClick:()=>D(d),disabled:!y,title:y?"Convert Lead":"Lead must be Qualified before converting",className:`px-3 sm:px-4 py-1.5 sm:py-2 rounded-md font-medium text-xs sm:text-sm transition focus:outline-none focus:ring-2
      ${y?"bg-green-600 hover:bg-green-700 text-white focus:ring-green-400":"bg-gray-200 text-gray-400 cursor-not-allowed"}
    `,children:"Convert"})})]}),S&&a.jsxs("div",{className:"flex flex-col sm:flex-row sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsxs("button",{type:"button",onClick:()=>{s&&d&&s(d)},className:"inline-flex items-center justify-center w-full sm:w-auto bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 transition text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",children:[a.jsx(hn,{className:"mr-2"}),"Edit"]}),a.jsxs("button",{type:"button",onClick:()=>{r&&d&&r(d)},className:"inline-flex items-center justify-center w-full sm:w-auto px-4 py-2 rounded-md text-sm bg-orange-500 text-white hover:bg-orange-600 transition focus:outline-none focus:ring-2 focus:ring-orange-400",children:[a.jsx(Zt,{className:"mr-2"}),"Archive"]})]})]}),a.jsx("div",{className:"border-b border-gray-200 my-5"}),a.jsxs("div",{className:"p-4 lg:p-4",children:[a.jsx("div",{className:"flex w-full bg-[#6A727D] text-white mt-1 overflow-x-auto mb-6",children:["Overview","Notes","Activities"].map(R=>a.jsx("button",{onClick:()=>x(R),className:`flex-1 min-w-[90px] px-4 py-2.5 text-xs sm:text-sm font-medium text-center transition-all duration-200 border-b-2
        ${p===R?"bg-paper-white text-[#6A727D] border-white":"text-white hover:bg-[#5c636d]"}`,children:R},R))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 items-start",children:[a.jsxs("div",{className:"lg:col-span-3",children:[p==="Overview"&&a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 md:p-8 border border-gray-200",children:a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4 sm:gap-6 text-sm text-gray-700",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Name:"}),a.jsxs("p",{children:[d.first_name," ",d.last_name||"N/A"]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Company:"}),a.jsx("p",{children:d.company_name||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Job Title:"}),a.jsx("p",{children:d.title||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Department:"}),a.jsx("p",{children:d.department||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Email:"}),a.jsx("p",{children:d.email||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Territory:"}),a.jsx("p",{children:d.territory?.name||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Assigned To:"}),a.jsx("p",{children:d.assigned_to?`${d.assigned_to.first_name} ${d.assigned_to.last_name}`:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created By:"}),a.jsx("p",{children:d.creator?`${d.creator.first_name} ${d.creator.last_name}`:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Work Phone:"}),a.jsx("p",{children:d.work_phone||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Mobile Phone 1:"}),a.jsx("p",{children:d.mobile_phone_1||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Mobile Phone 2:"}),a.jsx("p",{children:d.mobile_phone_2||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Source:"}),a.jsx("p",{children:d.source||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Address:"}),a.jsx("p",{children:d.address||"N/A"})]})]})}),p==="Notes"&&a.jsxs("div",{className:"mt-4 w-full",children:[a.jsx("div",{className:"flex flex-wrap items-center justify-between mb-4 gap-2",children:a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words",children:"Lead Note"})}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 shadow-sm break-words",children:[a.jsx("div",{className:"flex items-start justify-between",children:a.jsx("div",{children:a.jsx("p",{className:"text-sm font-medium text-gray-800 break-words",children:"Note"})})}),a.jsx("div",{className:"mt-3 text-sm text-gray-700 whitespace-pre-wrap break-words",children:d.notes||"No notes available."})]})]}),p==="Activities"&&a.jsxs("div",{className:"space-y-2 w-full h-full max-h-[50dvh] overflow-y-auto bg-gray-50 p-2 hide-scrollbar rounded-lg border border-gray-200 shadow-sm",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words border-b border-gray-300 py-2",children:"Related Activities"}),a.jsxs("div",{className:"space-y-2 text-sm",children:[o.tasks&&o.tasks.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>w(N==="tasks"?null:"tasks"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Qt,{className:"text-blue-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Tasks (",o.tasks.length,")"]})]}),N==="tasks"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),N==="tasks"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:o.tasks.map((R,q)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words",children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-blue-600 mt-1",children:a.jsx(Qt,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:R.subject||R.title||"Task"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:R.description||"No description"}),R.assigned_to&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Assigned:"," ",R.assigned_to.first_name," ",R.assigned_to.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:OA(R.due_date||R.created_at)})]},`task-${q}`))})]}),o.meetings&&o.meetings.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>w(N==="meetings"?null:"meetings"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ot,{className:"text-green-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Meetings (",o.meetings.length,")"]})]}),N==="meetings"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),N==="meetings"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:o.meetings.map((R,q)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words",children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-green-600 mt-1",children:a.jsx(Ot,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:R.subject||R.title||"Meeting"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:R.description||R.location||"No description"}),R.host&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Host: ",R.host.first_name," ",R.host.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:OA(R.start_time||R.created_at)})]},`meeting-${q}`))})]}),o.calls&&o.calls.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>w(N==="calls"?null:"calls"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(It,{className:"text-purple-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Calls (",o.calls.length,")"]})]}),N==="calls"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),N==="calls"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:o.calls.map((R,q)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words",children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-purple-600 mt-1",children:a.jsx(It,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:R.subject||R.title||"Call"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:R.direction||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:OA(R.call_time||R.created_at)})]},`call-${q}`))})]}),(!o||(!o.tasks||o.tasks.length===0)&&(!o.meetings||o.meetings.length===0)&&(!o.calls||o.calls.length===0)&&(!o.quotes||o.quotes.length===0)&&(!o.deals||o.deals.length===0)&&(!o.contacts||o.contacts.length===0))&&a.jsx("div",{className:"text-center py-8 text-gray-500",children:a.jsx("p",{children:"No related activities found for this account."})})]})]})]}),a.jsxs("div",{className:"flex flex-col gap-4",children:[a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Quick Actions"}),a.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[a.jsxs("button",{onClick:()=>{d&&l("/sales/calls",{state:{openCallModal:!0,initialCallData:{subject:d.title?`Call regarding ${d.title}`:`Call with ${d.first_name} ${d.last_name}`,relatedType1:"Lead",relatedTo1:String(d.id),relatedType2:null,relatedTo2:null,assigned_to:d.assigned_to?.id?String(d.assigned_to.id):"",direction:"Outgoing",status:"Planned"}}})},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(It,{className:"text-gray-600 w-4 h-4"}),"Schedule Call"]}),a.jsxs("button",{type:"button",onClick:()=>{if(!d?.email){alert("No email address available");return}const R=encodeURIComponent(d.email),q=encodeURIComponent(""),Z=encodeURIComponent(""),V=`mailto:${R}?subject=${q}&body=${Z}`;window.location.href=V},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(rn,{className:"text-gray-600 w-4 h-4"}),"Send E-mail"]}),a.jsxs("button",{className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",onClick:()=>{d&&l("/sales/meetings",{state:{openMeetingModal:!0,initialMeetingData:{subject:d.title?`Meeting regarding ${d.title}`:`Meeting with ${d.first_name||""} ${d.last_name||""}`.trim(),relatedType1:"Lead",relatedTo1:String(d.id),relatedType2:null,relatedTo2:null,assignedTo:d.assigned_to?.id?String(d.assigned_to.id):"",status:"Planned"}}})},children:[a.jsx(Ot,{className:"text-gray-600 w-4 h-4"}),"Book Meeting"]}),a.jsxs("button",{onClick:()=>{d&&l("/sales/tasks",{state:{openTaskModal:!0,initialTaskData:{subject:d.title?`Follow up on ${d.title}`:`Follow up with ${d.first_name||""} ${d.last_name||""}`.trim(),relatedType1:"Lead",relatedTo1:String(d.id),relatedType2:null,relatedTo2:null,assignedTo:d.assigned_to?.id?String(d.assigned_to.id):"",priority:"NORMAL",status:"Not Started"}}})},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(Qt,{className:"text-gray-600 w-4 h-4"}),"Tasks"]})]})]}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm w-full",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Status"}),a.jsxs("select",{className:"border border-gray-200 rounded-md px-2 sm:px-3 py-1.5 w-full text-sm mb-2 focus:ring-2 focus:ring-indigo-500 outline-none",value:v,onChange:R=>j(R.target.value),children:[a.jsx("option",{value:"New",children:"New"}),a.jsx("option",{value:"Contacted",children:"Contacted"}),a.jsx("option",{value:"Qualified",children:"Qualified"}),d?.status?.toUpperCase()==="QUALIFIED"&&a.jsx("option",{value:"Converted",children:"Converted"}),a.jsx("option",{value:"Lost",children:"Lost"})]}),a.jsx("button",{onClick:P,disabled:v===d.status,className:`w-full py-1.5 rounded-md text-sm transition focus:outline-none focus:ring-2 ${v===d.status?"bg-gray-400 cursor-not-allowed text-white":"bg-gray-900 text-white hover:bg-gray-800 focus:ring-gray-400"}`,children:"Update"})]})]})]})]})]})})}):null}const EFe=nh.all(),MA=EFe.map((e,t)=>({code:`+${e.countryCallingCode}`,name:e.countryCode,id:`${e.countryCallingCode}-${e.countryCode}-${t}`})),LFe=e=>e.toString().toLowerCase().replace(/\b\w/g,t=>t.toUpperCase()),PFe=e=>{switch(e.toUpperCase()){case"NEW":return"bg-indigo-100 text-indigo-700";case"CONTACTED":return"bg-blue-100 text-blue-700";case"QUALIFIED":return"bg-green-100 text-green-700";case"CONVERTED":return"bg-emerald-100 text-emerald-700";case"LOST":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-700"}},IA={first_name:"",last_name:"",company_name:"",title:"",department:"",email:"",work_ccode:"+63",work_phone:"",m1_ccode:"+63",mobile_phone_1:"",m2_ccode:"+63",mobile_phone_2:"",address:"",notes:"",source:"",territory_id:null,lead_owner:null,status:"New"};function DFe(){const e=kt(),{leadID:t}=Wo();Bs();const[n,s]=f.useState(null),[r,i]=f.useState(!1),[o,l]=f.useState(null),[c,u]=f.useState(null),[d,h]=f.useState([]),[p,x]=f.useState(!1),[v,j]=f.useState(""),[y,N]=f.useState("Filter by Status"),[w,S]=f.useState(1),[_,k]=f.useState(10),[T,A]=f.useState(IA),[E,M]=f.useState(!1),[z,P]=f.useState(null),[D,U]=f.useState(!1),[B,R]=f.useState(null),[q,Z]=f.useState(!1),[V,oe]=f.useState({}),[je,X]=f.useState(new Set),[se,ye]=f.useState(!1),[Ne,fe]=f.useState(null);f.useRef(null);const[we,de]=f.useState(!1),[ke,ge]=f.useState(null),[$e,be]=f.useState({name:"",website:"",countryCode:"+63",phone_number:"",combinedPhoneNumbers:"",billing_address:"",shipping_address:"",industry:"",status:"Prospect",territory_id:null,assigned_to:null,created_by:null}),[me,Ue]=f.useState({last_name:"",first_name:"",account_id:null,title:"",department:"",email:"",work_phone:"",mobile_phone_1:"",mobile_phone_2:"",notes:"",assigned_to:null,created_by:null}),[Ee,We]=f.useState({name:"Converted from Lead",account_id:null,primary_contact_id:null,stage:"PROSPECTING",probability:10,amount:0,currency:"PHP",description:"Initial deal from lead conversion.",assigned_to:null,created_by:null});f.useEffect(()=>{document.title="Leads | Sari-Sari CRM"},[]);const tt=async()=>{try{const W=await re.get("/leads/getUsers");l(W.data)}catch(W){console.error(`Error fetching users: ${W}`)}},lt=async()=>{x(!0);try{const W=await re.get("/leads/admin/getLeads");h(W.data),console.log(W.data)}catch(W){console.error(`Error fetching leads: ${W}`)}finally{x(!1)}};f.useEffect(()=>{tt(),lt()},[]);const{user:Fe}=Vt(),st=Fe?.role==="Sales";f.useEffect(()=>{r&&!E&&st&&Fe&&!T.lead_owner&&(A(W=>({...W,lead_owner:Fe.id})),u(Fe))},[r,E,st,Fe,T.lead_owner]),f.useEffect(()=>{if(t&&d.length>0&&!r&&!E){const W=d.find(J=>J.id===Number(t));W&&s(W)}else!t&&!n&&s(null)},[t,d,r,E]),f.useEffect(()=>{if(ke){const J=(ue=>{if(!ue)return{code:"+63",number:""};const De=ue.match(/^(\+\d+)\s(.+)$/);if(De)return{code:De[1],number:De[2]};if(ue.startsWith("+")){const le=ue.match(/^(\+\d{1,3})/);if(le)return{code:le[1],number:ue.substring(le[1].length).trim()}}return{code:"+63",number:ue}})(ke.work_phone),Y=[];ke.work_phone&&Y.push(`Work: ${ke.work_phone}`),ke.mobile_phone_1&&Y.push(`Mobile 1: ${ke.mobile_phone_1}`),ke.mobile_phone_2&&Y.push(`Mobile 2: ${ke.mobile_phone_2}`);const F=Y.length>0?Y.join(" | "):"";be({name:ke.company_name||"",website:"",countryCode:J.code,phone_number:J.number,combinedPhoneNumbers:F,billing_address:ke.address||"",shipping_address:ke.address||"",industry:"",status:"Prospect",territory_id:ke.assigned_to?.territory?.id||null,assigned_to:ke.assigned_to?.id||null,created_by:ke.creator?.id||null}),Ue({last_name:ke.last_name||"",first_name:ke.first_name||"",account_id:null,title:ke.title||"",department:ke.department||"",email:ke.email||"",work_phone:ke.work_phone||"",mobile_phone_1:ke.mobile_phone_1||"",mobile_phone_2:ke.mobile_phone_2||"",notes:ke.notes||"",assigned_to:ke.assigned_to?.id||null,created_by:ke.creator?.id||null}),We({name:"Converted from Lead",account_id:null,primary_contact_id:null,stage:"PROSPECTING",probability:10,amount:0,currency:"PHP",description:"Initial deal from lead conversion.",assigned_to:ke.assigned_to?.id||null,created_by:ke.creator?.id||null})}},[ke]);const Xe=W=>j(W.target.value),Ze=f.useMemo(()=>{const W=v.trim().toLowerCase(),J=y.trim().toUpperCase();let Y=d.filter(F=>{const ue=[F?.first_name,F?.last_name,F?.company_name,F?.title,F?.email,F?.work_phone,F?.assigned_to?`${F.assigned_to.first_name} ${F.assigned_to.last_name}`:""],De=W===""||ue.some(Ie=>Ie==null||Ie===""?!1:Ie.toString().toLowerCase().includes(W));let le=!1;if(J==="FILTER BY STATUS"){const Ie=F.status?F.status.toUpperCase():"";le=Ie!=="CONVERTED"&&Ie!=="INACTIVE"}else le=(F.status?F.status.toUpperCase():"")===J;return De&&le});return Y.sort((F,ue)=>{const De=new Date(F.created_at).getTime();return new Date(ue.created_at).getTime()-De}),Y},[d,v,y]),Je=Math.max(1,Math.ceil(Ze.length/_)||1);f.useEffect(()=>{S(1)},[v,y]),f.useEffect(()=>{S(W=>{const J=Math.max(1,Math.ceil(Ze.length/_)||1);return W>J?J:W})},[Ze.length,_]);const Be=f.useMemo(()=>{const W=(w-1)*_;return Ze.slice(W,W+_)},[Ze,w,_]),_e=()=>S(W=>Math.max(W-1,1)),pe=()=>S(W=>Math.min(W+1,Je)),ce=f.useCallback(async W=>{try{const J=await re.get(`/activities/lead/${W}`);oe(J.data&&typeof J.data=="object"?J.data:{})}catch(J){console.error(J),J.response?.status===404&&(console.warn("No activities found for this account."),oe({}))}},[]),Q=W=>{s(W),ce(W.id)},ne=()=>{s(null),t&&e("/admin/leads",{replace:!0})},ae=()=>{i(!1),A(IA),M(!1),P(null),U(!1),u(null),sessionStorage.removeItem("editLeadData")},Pe=W=>{W.target.id==="modalBackdrop"&&ae()},Te=()=>{A(IA),M(!1),P(null),u(null),i(!0)},he=W=>{if(!W){console.error("handleEditClick: lead is null or undefined");return}console.log("handleEditClick called with lead:",W),console.log("Current state - leadID:",t,"selectedLead:",n,"showModal:",r);const J=le=>{if(!le)return{code:"+63",number:""};const Ie=le.match(/^(\+\d+)\s(.+)$/);return Ie?{code:Ie[1],number:Ie[2]}:{code:"+63",number:le}},Y=J(W.work_phone),F=J(W.mobile_phone_1),ue=J(W.mobile_phone_2);let De="";if(W.assigned_to){De=String(W.assigned_to.id);const le=o?.find(Ie=>Ie.id===W.assigned_to.id);u(le)}A({first_name:W.first_name||"",last_name:W.last_name||"",company_name:W.company_name||"",title:W.title||"",department:W.department||"",email:W.email||"",work_ccode:Y.code,work_phone:Y.number,m1_ccode:F.code,mobile_phone_1:F.number,m2_ccode:ue.code,mobile_phone_2:ue.number,address:W.address||"",notes:W.notes||"",source:W.source||"",territory_id:W.territory?.id||null,lead_owner:De,status:W.status||"New"}),M(!0),P(W.id),n?(console.log("Coming from detail view - closing detail modal and showing edit form"),s(null),i(!0)):(console.log("Already in list view - showing modal"),i(!0))},He=W=>{if(!W){console.error("handleArchive: lead is null or undefined");return}const J=`${W.first_name} ${W.last_name}`||"this lead";R({title:"Archive Lead",message:a.jsxs("span",{children:["Are you sure you want to archive"," ",a.jsx("span",{className:"font-semibold",children:J}),"? You can restore it later if needed."]}),confirmLabel:"Archive Lead",cancelLabel:"Cancel",variant:"archive",action:{type:"archive",targetId:W.id,name:J}})},qe=W=>{const J=d.find(F=>F.id===W);!J||!(J.creator?.id===Fe?.id)||X(F=>{const ue=new Set(F);return ue.has(W)?ue.delete(W):ue.add(W),ue})},nt=()=>{const W=Be.filter(J=>J.creator?.id===Fe?.id);je.size===W.length&&W.length>0?X(new Set):X(new Set(W.map(J=>J.id)))},ot=()=>{if(je.size===0){H.warning("Please select at least one lead to archive.");return}const W=je.size;R({title:"Archive Leads",message:a.jsxs("span",{children:["Are you sure you want to archive ",a.jsx("span",{className:"font-semibold",children:W})," lead",W>1?"s":"","? They will be marked as inactive."]}),confirmLabel:`Archive ${W} Lead${W>1?"s":""}`,cancelLabel:"Cancel",variant:"archive",action:{type:"bulk-archive",targetIds:Array.from(je)}})},Re=W=>{const{name:J,value:Y}=W.target;if(A(F=>({...F,[J]:Y})),J==="lead_owner"){const F=o.find(ue=>ue.id===parseInt(Y));u(F)}},[it,St]=f.useState(!1),Et=W=>{if(W.preventDefault(),St(!0),!T.last_name?.trim()){H.error("Last name is required.");return}if(!T.company_name?.trim()){H.error("Company is required.");return}if(!T.email?.trim()){H.error("Email is required.");return}if(!T.email.includes("@")){H.error("Email must contain '@'.");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(T.email)){H.error("Please enter a valid email address with a dot in the domain.");return}if(!T.lead_owner){H.error("Please assign a lead owner.");return}const Y={...T,territory_id:T.territory_id?parseInt(T.territory_id):null,lead_owner:parseInt(T.lead_owner),work_phone:`${T.work_ccode} ${T.work_phone}`,mobile_phone_1:`${T.m1_ccode} ${T.mobile_phone_1}`,mobile_phone_2:`${T.m2_ccode} ${T.mobile_phone_2}`},F=E&&z?"update":"create",ue=`${T.first_name} ${T.last_name}`;R({title:F==="create"?"Confirm New Lead":"Confirm Update",message:F==="create"?a.jsxs("span",{children:["Are you sure you want to create a new lead for"," ",a.jsx("span",{className:"font-semibold",children:ue}),"?"]}):a.jsxs("span",{children:["Save changes to ",a.jsx("span",{className:"font-semibold",children:ue}),"?"]}),confirmLabel:F==="create"?"Create Lead":"Update Lead",cancelLabel:"Cancel",variant:"primary",action:{type:F,payload:Y,targetId:z||null,name:ue}})},Tt=async()=>{if(!B?.action){R(null);return}const{action:W}=B,{type:J,payload:Y,targetId:F,name:ue,lead:De}=W;console.log(Y),Z(!0);try{if(J==="create")U(!0),await re.post("/leads/create",Y),H.success(`Lead "${ue}" created successfully.`),ae(),await lt();else if(J==="update"){if(!F)throw new Error("Missing lead identifier for update.");U(!0);const le=await re.put(`/leads/${F}`,Y);H.success(`Lead "${ue}" updated successfully.`),n&&n.id===F&&s(null),ae(),await lt()}else if(J==="delete"){if(!F)throw new Error("Missing lead identifier for deletion.");await re.delete(`/leads/${F}`),H.success(`Lead "${ue}" deleted successfully.`),n?.id===F&&s(null),await lt()}else if(J==="archive"){if(!F)throw new Error("Missing lead identifier for archiving.");const le=n?.id;fe(F),await re.put(`/leads/${F}`,{status:"Inactive"}),H.success(`Lead "${ue}" archived successfully.`),await lt(),le===F&&s(null)}else if(J==="bulk-archive"){const le=W.targetIds;if(!le||le.length===0)throw new Error("Missing leads to archive.");ye(!0),await Promise.all(le.map(Ie=>re.put(`/leads/${Ie}`,{status:"Inactive"}))),H.success(`${le.length} lead${le.length>1?"s":""} archived successfully.`),X(new Set),n&&le.includes(n.id)&&s(null),await lt()}}catch(le){console.error(le);const Ie=J==="create"?"Failed to create lead. Please review the details and try again.":J==="update"?"Failed to update lead. Please review the details and try again.":J==="delete"?"Failed to delete lead. Please try again.":J==="archive"?"Failed to archive lead. Please try again.":"Failed to archive leads. Please try again.",K=le.response?.data?.detail||Ie;H.error(K)}finally{(J==="create"||J==="update")&&U(!1),J==="archive"&&fe(null),J==="bulk-archive"&&ye(!1),J!=="edit"&&(Z(!1),R(null))}},Nt=()=>{q||R(null)},xe=d.filter(W=>W.status==="New").length,ve=d.filter(W=>W.status==="Contacted").length,Oe=d.filter(W=>W.status==="Qualified").length,Ce=d.filter(W=>W.status==="Converted").length,Qe=d.filter(W=>W.status==="Lost").length,G=[{title:"New",value:xe,icon:Xa,color:"text-indigo-600",bgColor:"bg-indigo-100"},{title:"Contacted",value:ve,icon:It,color:"text-blue-600",bgColor:"bg-blue-100"},{title:"Qualified",value:Oe,icon:Qa,color:"text-green-600",bgColor:"bg-green-100"},{title:"Converted",value:Ce,icon:ec,color:"text-emerald-600",bgColor:"bg-emerald-100"},{title:"Lost",value:Qe,icon:Us,color:"text-red-600",bgColor:"bg-red-100"}];return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[p&&a.jsx(Wt,{message:"Loading leads..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h1",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(Xa,{className:"mr-2 text-blue-600"}),"Leads"]}),a.jsx("div",{className:"flex justify-center lg:justify-end gap-3 w-full sm:w-auto",children:a.jsxs("button",{onClick:()=>{Te(),St(!1)},className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 rounded-md hover:bg-gray-800 text-sm sm:text-base self-end sm:self-auto cursor-pointer",children:[a.jsx(aa,{className:"mr-2"})," Add Lead"]})})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 xl:grid-cols-5 gap-4 mb-6 w-full break-words overflow-hidden lg:overflow-visible",children:G.map(W=>a.jsx(MFe,{...W},W.title))}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search leads",value:v,onChange:Xe,className:"focus:outline-none text-base w-full"})]}),a.jsx("div",{className:"w-full lg:w-1/4",children:a.jsxs("select",{value:y,onChange:W=>N(W.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{value:"Filter by Status",children:"Filter by Status"}),a.jsx("option",{value:"New",children:"New"}),a.jsx("option",{value:"Contacted",children:"Contacted"}),a.jsx("option",{value:"Qualified",children:"Qualified"}),a.jsx("option",{value:"Converted",children:"Converted"}),a.jsx("option",{value:"Lost",children:"Lost"})]})})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[600px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 text-sm tracking-wide font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 w-12",children:a.jsx("input",{type:"checkbox",checked:je.size>0&&je.size===Be.filter(W=>W.creator?.id===Fe?.id).length&&Be.filter(W=>W.creator?.id===Fe?.id).length>0,onChange:nt,className:"w-4 h-4 cursor-pointer"})}),a.jsx("th",{className:"py-3 px-4",children:"Name"}),a.jsx("th",{className:"py-3 px-4",children:"Company"}),a.jsx("th",{className:"py-3 px-4",children:"Job Title"}),a.jsx("th",{className:"py-3 px-4",children:"Email"}),a.jsx("th",{className:"py-3 px-4",children:"Assigned To"}),a.jsx("th",{className:"py-3 px-4",children:"Status"}),a.jsx("th",{className:"py-3 px-4 w-12",children:je.size>0&&a.jsx("button",{onClick:ot,className:"text-orange-500 hover:text-orange-700 transition",title:"Archive selected leads",disabled:se,children:a.jsx(Zt,{size:18})})})]})}),a.jsx("tbody",{children:Ze.length>0?Be.map(W=>a.jsxs("tr",{className:"hover:bg-gray-50 text-sm cursor-pointer transition",onClick:()=>Q(W),children:[a.jsx("td",{className:"py-3 px-4 w-12",onClick:J=>J.stopPropagation(),children:W.creator?.id===Fe?.id&&a.jsx("input",{type:"checkbox",checked:je.has(W.id),onChange:J=>{J.stopPropagation(),qe(W.id)},className:"w-4 h-4 cursor-pointer"})}),a.jsx("td",{className:"py-3 px-4",children:a.jsxs("div",{className:"font-medium text-blue-600 hover:underline break-all text-sm",children:[W.first_name," ",W.last_name]})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("div",{className:"font-medium text-gray-800 text-sm leading-tight",children:W.company_name||"--"})}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",children:W.title||"--"}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",children:W.email||"--"}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",children:W.assigned_to?`${W.assigned_to.first_name} ${W.assigned_to.last_name}`:"--"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium whitespace-nowrap ${PFe(W.status||"New")}`,children:LFe(W.status||"New")})}),a.jsx("td",{className:"py-3 px-4 w-12"})]},W.id)):a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:8,children:"No leads found."})})})]})}),a.jsx(ca,{className:"mt-4",totalItems:Ze.length,pageSize:_,currentPage:w,onPrev:_e,onNext:pe,onPageSizeChange:W=>{k(W),S(1)},pageSizeOptions:[10,20,30,40,50],label:"leads"}),r&&a.jsx("div",{id:"modalBackdrop",onClick:Pe,className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-full sm:max-w-3xl rounded-2xl shadow-lg p-4 sm:p-6 md:p-8 relative border border-gray-200 overflow-y-auto max-h-[90vh] hide-scrollbar",onClick:W=>W.stopPropagation(),children:[a.jsx("button",{onClick:()=>{ae(),St(!1)},className:"absolute top-4 right-4 text-gray-500 hover:text-black transition",children:a.jsx(ea,{size:22})}),a.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800 mb-4 sm:mb-6 flex items-center justify-center",children:E?"Edit Lead":"Add New Lead"}),a.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 text-sm",children:[a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"First Name"}),a.jsx("input",{type:"text",name:"first_name",value:T.first_name,onChange:Re,placeholder:"Joe",className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:["Last Name ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",placeholder:"Smith",name:"last_name",value:T.last_name,onChange:Re,required:!0,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border
                      ${it&&!T.last_name?.trim()?"border-red-400 focus:ring-red-400":"border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"}
                  focus:ring-2`})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:["Company ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",placeholder:"ABC Company",name:"company_name",value:T.company_name,onChange:Re,required:!0,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border
                       ${it&&!T.company_name?.trim()?"border-red-400 focus:ring-red-400":"border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"}
                  focus:ring-2`})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:["Job Title",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",placeholder:"ABC Agenda",name:"title",value:T.title,onChange:Re,required:!0,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border
                       ${it&&!T.title?.trim()?"border-red-400 focus:ring-red-400":"border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"}
                      focus:ring-2`})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Department"}),a.jsx("input",{type:"text",placeholder:"Sales",name:"department",value:T.department,onChange:Re,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:["Email",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"email",placeholder:"abc@gmail.com",name:"email",value:T.email,onChange:Re,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border
                       ${it&&!T.email?.trim()?"border-red-400 focus:ring-red-400":"border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"}
                      focus:ring-2`})]}),a.jsxs("div",{className:"flex flex-col col-span-1 md:col-span-2 lg:col-span-1",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Work Phone"}),a.jsxs("div",{className:"w-full border border-gray-300 rounded-md focus-within:ring-2 focus-within:ring-blue-400 outline-none flex flex-row gap-1",children:[a.jsx("select",{name:"work_ccode",value:T.work_ccode,onChange:Re,className:"outline-none cursor-pointer py-1.5 px-2 border-r border-gray-400 text-sm",children:MA.map(W=>a.jsx("option",{value:W.code,children:W.code},W.id))}),a.jsx("input",{type:"text",placeholder:"9----------",name:"work_phone",value:T.work_phone,onChange:Re,className:"w-full outline-none px-2 py-1.5 text-sm"})]})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Mobile Phone 1"}),a.jsxs("div",{className:"w-full border border-gray-300 rounded-md focus-within:ring-2 focus-within:ring-blue-400 outline-none flex flex-row gap-1",children:[a.jsx("select",{name:"m1_ccode",value:T.m1_ccode,onChange:Re,className:"outline-none cursor-pointer py-1.5 px-2 border-r border-gray-400 text-sm",children:MA.map(W=>a.jsx("option",{value:W.code,children:W.code},W.id))}),a.jsx("input",{type:"text",placeholder:"9----------",name:"mobile_phone_1",value:T.mobile_phone_1,onChange:Re,className:"w-full outline-none px-2 py-1.5 text-sm"})]})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Mobile Phone 2"}),a.jsxs("div",{className:"w-full border border-gray-300 rounded-md focus-within:ring-2 focus-within:ring-blue-400 outline-none flex flex-row gap-1",children:[a.jsx("select",{name:"m2_ccode",value:T.m2_ccode,onChange:Re,className:"outline-none cursor-pointer py-1.5 px-2 border-r border-gray-400 text-sm",children:MA.map(W=>a.jsx("option",{value:W.code,children:W.code},W.id))}),a.jsx("input",{type:"text",placeholder:"9----------",name:"mobile_phone_2",value:T.mobile_phone_2,onChange:Re,className:"w-full outline-none px-2 py-1.5 text-sm"})]})]}),a.jsxs("div",{className:"flex flex-col col-span-1 sm:col-span-2 lg:col-span-3",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Address"}),a.jsx("input",{type:"text",name:"address",value:T.address,onChange:Re,placeholder:"Street No., Street Name, City, State/Province, Postal Code",className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"})]}),a.jsxs("div",{className:"flex flex-col col-span-1 md:col-span-2 lg:col-span-1",children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:["Assign To",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("div",{className:`w-full rounded-lg ${it&&!T.lead_owner?"border border-red-400":"border border-gray-300"}`,children:a.jsx(IFe,{items:Array.isArray(o)?o:[],value:T.lead_owner??"",placeholder:"Search a user...",disabled:D||st,getLabel:W=>`${W.first_name} ${W.last_name}`,onChange:W=>{const J=o.find(F=>String(F.id)===String(W));u(J);let Y=null;J&&J.assigned_territory&&J.assigned_territory.length===1&&(Y=J.assigned_territory[0].id),A(F=>({...F,lead_owner:W,territory_id:Y}))}})})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Territory"}),a.jsxs("select",{name:"territory_id",value:T.territory_id||"",onChange:Re,disabled:!c||!c.assigned_territory||c.assigned_territory.length===0,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm bg-white focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100 disabled:text-gray-500",children:[a.jsx("option",{value:"",disabled:!0,children:c?c.assigned_territory&&c.assigned_territory.length>0?"Select Territory":"No territories assigned to this user":"Select a user first"}),c&&c.assigned_territory&&c.assigned_territory.map(W=>a.jsx("option",{value:W.id,children:W.name},W.id))]})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Source"}),a.jsxs("select",{className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none",defaultValue:"",name:"source",value:T.source,onChange:Re,children:[a.jsx("option",{value:"",disabled:!0,children:"Select Source"}),a.jsx("option",{value:"Website",children:"Website"}),a.jsx("option",{value:"Referral",children:"Referral"}),a.jsx("option",{value:"Cold call",children:"Cold call"}),a.jsx("option",{value:"Event",children:"Event"}),a.jsx("option",{value:"Other",children:"Other"})]})]}),a.jsxs("div",{className:"flex flex-col col-span-1 sm:col-span-2 lg:col-span-3",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Notes"}),a.jsx("textarea",{placeholder:"Additional details...",name:"notes",value:T.notes,onChange:Re,rows:3,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none resize-none"})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-2 mt-4 col-span-1 sm:col-span-2 lg:col-span-3",children:[a.jsx("button",{type:"button",onClick:()=>{ae(),St(!1)},className:"w-full sm:w-auto px-4 py-2 text-white bg-red-400 border border-red-300 rounded hover:bg-red-500 transition disabled:opacity-70",disabled:D||q,children:"Cancel"}),a.jsx("button",{type:"submit",onClick:Et,className:"w-full sm:w-auto px-4 py-2 text-white border border-tertiary bg-tertiary rounded hover:bg-secondary transition disabled:opacity-70",disabled:D||q,children:D||q?"Processing...":E?"Update Lead":"Save Lead"})]})]})]})}),B&&a.jsx(OFe,{open:!0,title:B.title,message:B.message,confirmLabel:B.confirmLabel,cancelLabel:B.cancelLabel,variant:B.variant,onConfirm:Tt,onCancel:Nt,loading:q}),n&&!r&&!E&&a.jsx(uJ,{relatedActs:V,lead:n,onBack:ne,fetchLeads:lt,setSelectedLead:s,onEdit:he,onArchive:He})]})}function OFe({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o=!1,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":i==="archive"?"bg-orange-500 hover:bg-orange-600 border border-orange-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsx("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${u}`,disabled:o,children:o?"Processing...":s})]})]})})}function MFe({icon:e,title:t,value:n,color:s="text-blue-600",bgColor:r="bg-blue-100",onClick:i}){const o=()=>{typeof i=="function"?i():console.log(`Clicked: ${t}`)};return a.jsxs("div",{className:"flex items-center p-4 bg-white rounded-xl shadow-md border border-gray-200 transition-all duration-300",onClick:o,children:[a.jsx("div",{className:`flex-shrink-0 p-3 rounded-full ${r} ${s} mr-4`,children:e?a.jsx(e,{size:22}):null}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:t}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:n})]})]})}function IFe({items:e=[],value:t="",onChange:n,getLabel:s,placeholder:r="Search...",disabled:i=!1,maxRender:o=200}){const[l,c]=f.useState(!1),[u,d]=f.useState(""),h=f.useRef(null),p=e.find(j=>String(j.id)===String(t)),x=p?s(p):"",v=f.useMemo(()=>{const j=u.trim().toLowerCase();return(j?e.filter(N=>(s(N)||"").toLowerCase().includes(j)):e).slice(0,o)},[e,u,s,o]);return f.useEffect(()=>{const j=y=>{h.current&&!h.current.contains(y.target)&&c(!1)};return document.addEventListener("mousedown",j),()=>document.removeEventListener("mousedown",j)},[]),f.useEffect(()=>{l||d("")},[l]),a.jsxs("div",{ref:h,className:"relative w-full",children:[a.jsx("input",{disabled:i,value:l?u:x,placeholder:r,onFocus:()=>!i&&c(!0),onChange:j=>{d(j.target.value),l||c(!0)},className:"w-full rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100"}),l&&!i&&a.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg overflow-hidden",children:[a.jsx("div",{className:"max-h-56 overflow-y-auto",children:v.length>0?v.map(j=>{const y=String(j.id),N=s(j),w=String(t)===y;return a.jsx("button",{type:"button",onClick:()=>{n(y),c(!1)},className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-50 ${w?"bg-blue-50":""}`,children:N||"--"},y)}):a.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No results"})}),e.length>o&&a.jsxs("div",{className:"px-3 py-2 text-[11px] text-gray-400 border-t",children:["Showing first ",o," results  keep typing to narrow."]})]})]})}const Ab={accountName:"Josh Inc.",companyNumber:"09135007323",companyWebsite:"joshenc.com",industry:"Agriculture",billingAddress:"#1 Pilar Las Pinas City",shippingAddress:"#3 BNW ASS-CBN",firstName:"Josh",lastName:"Vergara",department:"Administration",title:"CEO",workPhone:"09253677323",email:"josh@joshinc.com",mobile1:"09253677323",mobile2:"0907452874",dealName:"Josh Deal",dealAmount:"60.00",stage:"Prospecting",territory:"Cavite",description:"Initial lead conversion deal.",dealTitle:"New Client Agreement"},Zn=({label:e,value:t,name:n,className:s=""})=>a.jsxs("div",{className:`flex flex-col ${s}`,children:[a.jsx("label",{className:"text-xs text-gray-500 mb-1",children:e}),a.jsx("input",{type:"text",name:n,defaultValue:t,readOnly:!0,className:"w-full border border-gray-300 p-2 rounded-lg text-sm focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 outline-none bg-gray-50"})]}),$Fe=({data:e})=>a.jsxs("div",{className:"space-y-6 p-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-700",children:"Account Information"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsx(Zn,{label:"Company Number",name:"companyNumber",value:e.companyNumber}),a.jsx(Zn,{label:"Company Website",name:"companyWebsite",value:e.companyWebsite}),a.jsx(Zn,{label:"Industry",name:"industry",value:e.industry})]}),a.jsx(Zn,{label:"Billing Address",name:"billingAddress",value:e.billingAddress,className:"col-span-3"}),a.jsx(Zn,{label:"Shipping Address",name:"shippingAddress",value:e.shippingAddress,className:"col-span-3"})]}),RFe=({data:e})=>a.jsxs("div",{className:"space-y-6 p-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-700",children:"Contact Information"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx(Zn,{label:"First Name",name:"firstName",value:e.firstName}),a.jsx(Zn,{label:"Last Name",name:"lastName",value:e.lastName}),a.jsx(Zn,{label:"Department",name:"department",value:e.department}),a.jsx(Zn,{label:"Title",name:"title",value:e.title}),a.jsx(Zn,{label:"Work Phone",name:"workPhone",value:e.workPhone}),a.jsx(Zn,{label:"Email",name:"email",value:e.email}),a.jsx(Zn,{label:"Mobile Number 1",name:"mobile1",value:e.mobile1}),a.jsx(Zn,{label:"Mobile Number 2",name:"mobile2",value:e.mobile2})]})]}),zFe=({data:e})=>a.jsxs("div",{className:"space-y-6 p-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-700",children:"Deal"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx(Zn,{label:"Deal Name",name:"dealName",value:e.dealName}),a.jsxs("div",{className:"flex",children:[a.jsx(Zn,{label:"Deal Amount",name:"dealAmount",value:e.dealAmount,className:"flex-grow"}),a.jsx("div",{className:"flex flex-col justify-end ml-1",children:a.jsx("span",{className:"text-sm font-medium text-gray-600 border border-gray-300 bg-gray-100 p-2 rounded-r-lg h-10 flex items-center",children:"PHP"})})]}),a.jsx(Zn,{label:"Stage",name:"stage",value:e.stage}),a.jsx(Zn,{label:"Territory",name:"territory",value:e.territory})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx(Zn,{label:"Description",name:"description",value:e.description}),a.jsx(Zn,{label:"Title",name:"dealTitle",value:e.dealTitle})]})]});function FFe({isOpen:e,onClose:t}){const[n,s]=f.useState(1),r=3;if(!e)return null;const i=()=>{n<r?s(n+1):(t(),s(1))},o=()=>{n>1&&s(n-1)},l=[{id:1,name:"Account"},{id:2,name:"Contact"},{id:3,name:"Deal"}],c=()=>{switch(n){case 1:return a.jsx($Fe,{data:Ab});case 2:return a.jsx(RFe,{data:Ab});case 3:return a.jsx(zFe,{data:Ab});default:return null}};return a.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-[800px] h-[600px] overflow-hidden flex flex-col",children:[a.jsxs("div",{className:"p-6 border-b border-gray-200 flex justify-between items-start",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wider",children:"Convert Lead"}),a.jsx("h1",{className:"text-2xl font-bold text-gray-900 mt-1",children:Ab.accountName})]}),a.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition",children:a.jsx(PN,{className:"w-6 h-6"})})]}),a.jsx("div",{className:"flex border-b border-gray-200 bg-gray-50",children:l.map(u=>a.jsx("button",{onClick:()=>s(u.id),className:`flex-1 py-3 px-6 text-sm font-medium transition ${n===u.id?"bg-white text-gray-800 border-b-2 border-indigo-600":"bg-gray-600 text-white hover:bg-gray-700"}`,children:u.name},u.id))}),a.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:c()}),a.jsxs("div",{className:"p-4 border-t border-gray-200 bg-gray-50 flex justify-end space-x-3",children:[n>1&&a.jsx("button",{onClick:o,className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-100 flex items-center",children:"Cancel"}),n<r?a.jsx("button",{onClick:i,className:"px-5 py-2 text-white bg-gray-900 rounded-xl hover:bg-gray-800 transition",children:"Next"}):a.jsx("button",{onClick:i,className:"px-5 py-2 text-white bg-gray-900 rounded-xl hover:bg-gray-800 transition",children:"Convert"})]})]})})}function mJ({selectedDeal:e,onStatusUpdate:t,onClose:n}){const[s,r]=f.useState(e?.stage||""),[i,o]=f.useState(!1),l=kt(),{user:c}=Vt();f.useEffect(()=>{console.log("SalesDealsQuickAction mounted sahdksd",e),console.log("User sadad:",c)},[e,c]);const u=[{value:"PROSPECTING",label:"Prospecting"},{value:"QUALIFICATION",label:"Qualification"},{value:"PROPOSAL",label:"Proposal"},{value:"NEGOTIATION",label:"Negotiation"},{value:"CLOSED_WON",label:"Closed Won"},{value:"CLOSED_LOST",label:"Closed Lost"}];f.useEffect(()=>{e?.stage&&r(e.stage)},[e]);const d=async()=>{if(!e||!e.id){H.error("No deal selected");return}if(!s||s===e.stage){H.info("Please select a different stage");return}const h=e.id;o(!0);try{await re.put(`/deals/admin/${h}`,{stage:s}),n&&n(),t&&setTimeout(async()=>{await t(!0)},100),setTimeout(()=>{H.success("Deal status updated successfully")},300)}catch(p){console.error(p);const x=p.response?.data?.detail||"Failed to update deal status";H.error(x)}finally{o(!1)}};return e?a.jsxs("div",{className:"space-y-4 font-inter text-[13px] w-full sm:w-[85%] mx-auto flex flex-col gap-4",children:[a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Quick Actions"}),a.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[a.jsxs("button",{onClick:()=>{const h=e.account?.id||e.account_id;l("/sales/calls",{state:{openCallModal:!0,initialCallData:{subject:e.name?`Call regarding: ${e.name}`:"",relatedType1:"Account",relatedTo1:h,relatedType2:"Deal",relatedTo2:e.id,contactId:e.contact?.id,assigned_to:e.assigned_deals?.id?String(e.assigned_deals.id):"",assignedTo:e.assigned_to?.id?String(e.assigned_to.id):""}}})},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(It,{className:"text-gray-600 w-4 h-4"}),"Schedule Call"]}),a.jsxs("button",{type:"button",onClick:()=>{if(!e.contact?.email){alert("No email address available");return}const h=encodeURIComponent(e.contact.email),p=encodeURIComponent(""),x=encodeURIComponent(""),v=`mailto:${h}?subject=${p}&body=${x}`;window.location.href=v},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(rn,{className:"text-gray-600 w-4 h-4"}),"Send E-mail"]}),a.jsxs("button",{className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",onClick:()=>{const h=e.account?.id||e.account_id;l("/sales/meetings",{state:{openMeetingModal:!0,initialMeetingData:{subject:e.name?`Meeting: ${e.name}`:"",relatedType1:"Account",relatedTo1:h,relatedType2:"Deal",relatedTo2:e.id,assignedTo:e.assigned_deals?.id?String(e.assigned_deals.id):""}}})},children:[a.jsx(Ot,{className:"text-gray-600 w-4 h-4"}),"Book Meeting"]}),a.jsxs("button",{onClick:()=>{const h=e.account?.id||e.account_id;l("/sales/tasks",{state:{openTaskModal:!0,initialTaskData:{subject:e.name?`Task for: ${e.name}`:"",relatedType1:"Account",relatedTo1:h,relatedType2:"Deal",relatedTo2:e.id,contactId:e.contact?.id,assignedTo:e.assigned_deals?.id?String(e.assigned_deals.id):"",priority:"NORMAL",status:"Not Started"}}})},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(Qt,{className:"text-gray-600 w-4 h-4"}),"Tasks"]})]})]}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm w-full",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Promote Deal"}),a.jsx("select",{className:"border border-gray-200 rounded-md px-2 sm:px-3 py-1.5 w-full text-sm mb-2 focus:ring-2 focus:ring-gray-300 focus:outline-none",value:s,onChange:h=>r(h.target.value),disabled:i||e.created_by!==c?.id&&e.assigned_to!==c?.id,children:u.map(h=>a.jsx("option",{value:h.value,children:h.label},h.value))}),(e.created_by===c?.id||e.assigned_to===c?.id)&&a.jsx("button",{className:"w-full bg-gray-900 text-white py-1.5 rounded-md text-sm hover:bg-gray-800 transition disabled:opacity-50 disabled:cursor-not-allowed",onClick:d,disabled:i||!s||s===e.stage,children:i?"Updating...":"Update"})]})]}):null}function fJ({selectedDeal:e,relatedActs:t={},show:n,onClose:s,activeTab:r,setActiveTab:i,onEdit:o,onDelete:l,onStatusUpdate:c}){const u=kt(),[d]=Bs(),h=d.get("id"),[p,x]=f.useState(e||null),[v,j]=f.useState(r||"Overview"),[y,N]=f.useState(null),{user:w}=Vt(),{comments:S,addComment:_,refresh:k}=kn({relatedType:"deal",relatedId:p?.id});f.useEffect(()=>{p?.id&&k()},[p?.id,k]);const T=r!==void 0?r:v,A=(()=>{const P=String(w?.role||"").toLowerCase();return P==="ceo"||P==="admin"?"admin":P==="manager"?"manager":P==="sales"?"sales":P==="group manager"||P==="group_manager"||P==="group-manager"?"group-manager":"guest"})();if(f.useEffect(()=>{(async()=>{if(h&&!e)try{const B=((await re.get("/deals/admin/fetch-all")).data||[]).find(R=>R.id===parseInt(h));if(B){const R={...B,amount:typeof B.amount=="number"?B.amount:parseFloat(B.amount||0),probability:B.probability||0};x(R)}else console.warn("Deal not found with ID:",h)}catch(D){console.error("Error fetching deal:",D)}})()},[h,e]),!p&&!h||h&&!p)return null;const E=P=>({PROSPECTING:"bg-blue-100 text-blue-700",QUALIFICATION:"bg-yellow-100 text-yellow-700",PROPOSAL:"bg-orange-100 text-orange-700",NEGOTIATION:"bg-purple-100 text-purple-700",CLOSED_WON:"bg-green-100 text-green-700",CLOSED_LOST:"bg-red-100 text-red-700"})[P]||"bg-gray-100 text-gray-700",M=P=>{if(!P)return"";const D=String(P).split("-");return D.length===3?`${D[0]}-${D[2]}`:String(P)},z=P=>P?new Date(P).toLocaleString("en-US",{month:"short",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).replace(",",""):"";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[9999] font-inter p-2 sm:p-4 overflow-x-hidden",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-lg w-full max-w-full sm:max-w-6xl max-h-[90vh] overflow-y-auto hide-scrollbar relative box-border",children:[a.jsx("div",{className:"bg-tertiary w-full rounded-t-xl p-3 lg:p-3",children:a.jsxs("div",{className:"flex items-start justify-between w-full",children:[a.jsx("h1",{className:"lg:text-3xl text-xl text-white font-semibold text-center w-full",children:"Deal"}),a.jsx("div",{className:"flex items-center gap-2 sm:gap-3",children:a.jsx("button",{onClick:()=>{s?s():u(-1)},className:"text-gray-400 hover:text-white mt-1 cursor-pointer",children:a.jsx(ea,{size:25})})})]})}),a.jsx("div",{className:"p-4 lg:p-2 lg:mx-7",children:a.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-2 sm:gap-3 mt-3",children:[a.jsxs("div",{className:"flex flex-col gap-1",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3 lg:gap-1",children:[a.jsxs("h2",{className:"text-xl lg:text-xl font-semibold text-gray-800 break-words",children:[M(p.deal_id)," - ",p.name]}),a.jsx("span",{className:`text-xs sm:text-sm inline-block font-medium px-1.5 py-0.5 sm:px-3 sm:py-1 rounded-full break-words ${E(p.stage)}`,children:p.stage})]}),a.jsxs("p",{className:"text-gray-500 text-sm break-words",children:["Created on ",z(p.created_at)]})]}),a.jsxs("div",{className:"flex flex-col items-end gap-2",children:[a.jsxs("h2",{className:"text-xl sm:text-2xl font-bold text-gray-600 break-words",children:[" ",p.amount?p.amount.toLocaleString():"0"]}),a.jsx("div",{className:"w-full sm:w-40 bg-gray-200 rounded-full h-2",children:a.jsx("div",{className:"bg-green-500 h-2 rounded-full",style:{width:`${p.probability}%`}})}),a.jsxs("p",{className:"text-xs text-gray-500 break-words",children:[" ",p.probability,"% Complete "]}),p.deal_creator?.id===w?.id&&a.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 mt-3",children:[a.jsxs("button",{type:"button",onClick:()=>{o&&o(p)},className:"inline-flex items-center justify-center bg-blue-500 text-white px-3 sm:px-4 py-1.5 sm:py-2 rounded-md hover:bg-blue-600 transition text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",children:[a.jsx(hn,{className:"mr-1 sm:mr-2",size:16}),a.jsx("span",{className:"hidden sm:inline",children:"Edit"})]}),a.jsxs("button",{type:"button",onClick:()=>{l&&l(p)},className:"inline-flex items-center justify-center px-3 sm:px-4 py-1.5 sm:py-2 rounded-md text-sm bg-orange-500 text-white hover:bg-orange-600 transition focus:outline-none focus:ring-2 focus:ring-orange-400",children:[a.jsx(Zt,{className:"mr-1 sm:mr-2",size:16}),a.jsx("span",{className:"hidden sm:inline",children:"Archive"})]})]})]})]})}),a.jsx("div",{className:"border-b border-gray-200 my-5"}),a.jsxs("div",{className:"p-6 lg:p-4",children:[a.jsx("div",{className:"flex w-full bg-[#6A727D] text-white mt-1 overflow-x-auto mb-6",children:["Overview","Notes","Activities"].map(P=>a.jsx("button",{onClick:()=>{i?i(P):j(P)},className:`flex-1 min-w-[90px] px-4 py-2.5 text-xs sm:text-sm font-medium text-center transition-all duration-200 border-b-2
                ${T===P?"bg-paper-white text-[#6A727D] border-white":"text-white hover:bg-[#5c636d]"}`,children:P},P))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 items-start",children:[a.jsxs("div",{className:"lg:col-span-3 space-y-6",children:[T==="Overview"&&a.jsxs("div",{className:"grid md:grid-cols-2 gap-4 sm:gap-6 w-full",children:[a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 sm:p-5 shadow-sm pb-20 break-words",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 sm:mb-3",children:"Deal Information"}),a.jsxs("p",{className:"text-sm sm:text-sm text-gray-700 mb-2 py-5 break-words",children:[a.jsx("strong",{children:"Description:"})," ",p.description]}),a.jsx("div",{className:"h-px bg-gray-200 w-full"}),a.jsxs("p",{className:"text-sm sm:text-sm text-gray-700 mb-2 py-5 break-words",children:[a.jsx("strong",{children:"Expected Close Date:"})," ",z(p.close_date)||"--"]}),a.jsx("div",{className:"h-px bg-gray-200 w-full"}),a.jsxs("div",{className:"mt-4 py-3 w-full",children:[a.jsxs("div",{className:"relative flex flex-col w-full",children:[a.jsx("div",{className:"absolute top-0 left-0 right-0 flex items-center justify-between w-full",children:(()=>{const P=(p?.stage||"PROSPECTING").toUpperCase(),U=(R=>R==="PROSPECTING"?0:R==="QUALIFICATION"?1:R==="PROPOSAL"?2:R==="NEGOTIATION"?3:R==="CLOSED_WON"||R==="CLOSED_LOST"?4:-1)(P);return[0,1,2,3,4].map(R=>U===R?"orange":U>R?"green":"gray").map((R,q)=>a.jsxs(wt.Fragment,{children:[a.jsx("div",{className:`relative z-10 w-6 h-6 rounded-full border-2 ${R==="green"?"bg-green-500 border-green-500":R==="orange"?"bg-orange-400 border-orange-400":"bg-gray-300 border-gray-300"}`}),q<4&&a.jsx("div",{className:"flex-grow h-1 bg-gray-200 mx-1 min-w-0"})]},q))})()}),a.jsx("div",{className:"flex justify-between mt-8 gap-2 text-[9px] lg:text-[9px] sm:text-xs text-gray-600 w-full",children:["Prospecting","Qualification","Proposal","Negotiation","Closed"].map((P,D)=>a.jsx("span",{className:"text-center flex-1 break-words",children:P},D))})]}),a.jsx("p",{className:"text-sm text-orange-600 font-medium mt-6 text-center break-words",children:p.stage})]})]}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 sm:p-5 shadow-sm break-words",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-3",children:"Contact Information"}),a.jsxs("div",{className:"text-sm sm:text-sm text-gray-700 space-y-3",children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Account:"})," ",p.account?.name]}),a.jsx("div",{className:"h-px bg-gray-200 w-full"}),a.jsxs("p",{children:[a.jsx("strong",{children:"Primary Contact:"})," ",p.contact?.first_name," ",p.contact?.last_name]}),a.jsx("div",{className:"h-px bg-gray-200 w-full"}),a.jsxs("p",{children:[a.jsx("strong",{children:"Phone:"})," ",p.contact?.work_phone]}),a.jsx("div",{className:"h-px bg-gray-200 w-full"}),a.jsxs("p",{children:[a.jsx("strong",{children:"Email:"})," ",p.contact?.email]}),a.jsx("div",{className:"h-px bg-gray-200 w-full"}),a.jsxs("p",{children:[a.jsx("strong",{children:"Assigned To:"})," ",p.assigned_deals?.first_name," ",p.assigned_deals?.last_name]})]})]})]}),T==="Notes"&&a.jsxs("div",{className:"mt-4 w-full",children:[a.jsx("div",{className:"flex flex-wrap items-center justify-between mb-4 gap-2",children:a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words",children:"Deal Note"})}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 shadow-sm break-words",children:[a.jsx("div",{className:"flex items-start justify-between",children:a.jsx("div",{children:a.jsx("p",{className:"text-sm font-medium text-gray-800 break-words",children:"Note"})})}),a.jsx("div",{className:"mt-3 text-sm text-gray-700 whitespace-pre-wrap break-words",children:p.description||"No notes available."})]}),a.jsx(Tn,{comments:S,onAddComment:_})]}),T==="Activities"&&a.jsxs("div",{className:"space-y-2 w-full h-full max-h-[50dvh] overflow-y-auto bg-gray-50 p-2 hide-scrollbar rounded-lg border border-gray-200 shadow-sm",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words border-b border-gray-300 py-2",children:"Related Activities"}),a.jsxs("div",{className:"space-y-2 text-sm",children:[t.tasks&&t.tasks.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>N(y==="tasks"?null:"tasks"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Qt,{className:"text-blue-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Tasks (",t.tasks.length,")"]})]}),y==="tasks"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),y==="tasks"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:t.tasks.map((P,D)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>u(`/${A}/tasks`,{state:{taskID:P.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-blue-600 mt-1",children:a.jsx(Qt,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:P.subject||P.title||"Task"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:P.description||"No description"}),P.assigned_to&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Assigned: ",P.assigned_to.first_name," ",P.assigned_to.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:z(P.due_date||P.created_at)})]},`task-${D}`))})]}),t.meetings&&t.meetings.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>N(y==="meetings"?null:"meetings"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ot,{className:"text-green-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Meetings (",t.meetings.length,")"]})]}),y==="meetings"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),y==="meetings"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:t.meetings.map((P,D)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>u(`/${A}/meetings`,{state:{meetingID:P.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-green-600 mt-1",children:a.jsx(Ot,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:P.subject||P.title||"Meeting"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:P.description||P.location||"No description"}),P.host&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Host: ",P.host.first_name," ",P.host.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:z(P.start_time||P.created_at)})]},`meeting-${D}`))})]}),t.calls&&t.calls.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>N(y==="calls"?null:"calls"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(It,{className:"text-purple-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Calls (",t.calls.length,")"]})]}),y==="calls"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),y==="calls"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:t.calls.map((P,D)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>u(`/${A}/calls`,{state:{callID:P.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-purple-600 mt-1",children:a.jsx(It,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:P.subject||P.title||"Call"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:P.direction||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:z(P.call_time||P.created_at)})]},`call-${D}`))})]}),t.quotes&&t.quotes.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>N(y==="quotes"?null:"quotes"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ia,{className:"text-orange-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Quotes (",t.quotes.length,")"]})]}),y==="quotes"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),y==="quotes"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:t.quotes.map((P,D)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>u(`/${A}/quotes`,{state:{quoteID:P.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-orange-600 mt-1",children:a.jsx(ia,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:(P.quote_id?P.quote_id.replace(/Q(\d+)-\d+-/,"Q$1-"):"--")||"Quote"}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:P.status||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:z(P.presented_date)||""})]},`quote-${D}`))})]}),(!t||(!t.tasks||t.tasks.length===0)&&(!t.meetings||t.meetings.length===0)&&(!t.calls||t.calls.length===0)&&(!t.quotes||t.quotes.length===0)&&(!t.deals||t.deals.length===0)&&(!t.contacts||t.contacts.length===0))&&a.jsx("div",{className:"text-center py-8 text-gray-500",children:a.jsx("p",{children:"No related activities found for this account."})})]})]}),T==="Edit"&&a.jsxs("div",{className:"mt-4 space-y-4 w-full",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words",children:"Edit Deal"}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 sm:p-5 shadow-sm w-full",children:[a.jsxs("label",{className:"block mb-3 break-words",children:[a.jsx("span",{className:"text-sm text-gray-700",children:"Deal Name"}),a.jsx("input",{type:"text",className:"mt-1 block w-full border border-gray-200 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-gray-200",defaultValue:p.name})]}),a.jsxs("label",{className:"block mb-3 break-words",children:[a.jsx("span",{className:"text-sm text-gray-700",children:"Description"}),a.jsx("textarea",{className:"mt-1 block w-full border border-gray-200 rounded-md px-3 py-2 text-sm h-24 resize-y focus:outline-none focus:ring-2 focus:ring-gray-200",defaultValue:p.description})]}),a.jsx("button",{className:"bg-gray-900 text-white px-4 py-2 rounded-md hover:bg-gray-800",children:"Save Changes"})]})]})]}),a.jsx("div",{className:"w-full lg:w-auto",children:a.jsx(mJ,{selectedDeal:p,onStatusUpdate:c,onClose:s})})]})]})]})})}function UFe(){f.useEffect(()=>{document.title="Deals | Sari-Sari CRM"},[]);const e=kt(),t=ta(),[n,s]=f.useState(""),[r,i]=f.useState("Filter by Stage"),[o,l]=f.useState("Filter by Owner"),[c,u]=f.useState(null),[d,h]=f.useState("Overview"),[p,x]=f.useState(!1),[v,j]=f.useState(null),[y,N]=f.useState(!1),[w,S]=f.useState(1),[_,k]=f.useState(10),[T,A]=f.useState(!1),[E,M]=f.useState(null),[z,P]=f.useState(!1),[D,U]=f.useState(!1),[B,R]=f.useState(null),[q,Z]=f.useState([]),[V,oe]=f.useState([]),[je,X]=f.useState([]),[se,ye]=f.useState({}),[Ne,fe]=f.useState(null),[we,de]=f.useState(new Set),[ke,ge]=f.useState(!1);f.useEffect(()=>{const ie=t.state,Me=ie?.dealID;if(Me&&!ie?.openDealModal){fe(Me),e(t.pathname,{replace:!0,state:{}});return}},[t,e]),f.useEffect(()=>{if(Ne&&v?.length>0&&!y){const ie=v.find(Me=>Me.id===Ne);ie?u(ie):H.error("Deal not found."),fe(null)}},[Ne,v,y]);const[$e,be]=f.useState({id:null,name:"",account_id:"",primary_contact_id:"",stage:"PROPOSAL",amount:"",close_date:"",assigned_to:"",currency:"PHP",description:""}),[me,Ue]=f.useState(null),[Ee,We]=f.useState(null),tt="dealDraft:sales/deals",lt=3600*1e3,Fe=f.useRef(!1),st=ie=>{if(!ie)return"";const Me=String(ie).split("-");return Me.length===3?`${Me[0]}-${Me[2]}`:String(ie)},Xe=ie=>ie?new Date(ie).toLocaleString("en-US",{month:"short",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).replace(",",""):"";f.useEffect(()=>{if(!Fe.current){Fe.current=!0;try{const ie=sessionStorage.getItem(tt);if(!ie)return;const Me=JSON.parse(ie);if(typeof Me?.ts=="number"&&Date.now()-Me.ts>lt){sessionStorage.removeItem(tt);return}if(Me?.returnTo&&Me.returnTo!==t.pathname)return;Me?.dealForm&&typeof Me.dealForm=="object"&&be(Me.dealForm),typeof Me?.isEditing=="boolean"&&U(Me.isEditing),Me?.currentDealId!==void 0&&R(Me.currentDealId),x(!0),sessionStorage.removeItem(tt)}catch{sessionStorage.removeItem(tt)}}},[t.pathname]);const Ze=f.useCallback(()=>{try{sessionStorage.setItem(tt,JSON.stringify({ts:Date.now(),returnTo:t.pathname,dealForm:$e,isEditing:D,currentDealId:B}))}catch{}},[tt,t.pathname,$e,D,B]),Je=f.useCallback(()=>{Ze(),window.open("/sales/accounts?openModal=1","_blank","noopener,noreferrer")},[Ze]),Be=f.useCallback(()=>{Ze(),window.open("/sales/contacts?openModal=1","_blank","noopener,noreferrer")},[Ze]),_e={"Prospecting Stage":"PROSPECTING","Qualification Stage":"QUALIFICATION","Proposal Stage":"PROPOSAL","Negotiation Stage":"NEGOTIATION","Closed Won Stage":"CLOSED_WON","Closed Lost Stage":"CLOSED_LOST","Closed Cancelled Stage":"CLOSED_CANCELLED"},pe=ie=>({PROSPECTING:"Prospecting",QUALIFICATION:"Qualification",PROPOSAL:"Proposal",NEGOTIATION:"Negotiation",CLOSED_WON:"Closed Won",CLOSED_LOST:"Closed Lost",CLOSED_CANCELLED:"Closed Cancelled"})[ie]||ie||"--",ce=ie=>({PROSPECTING:"bg-blue-100 text-blue-700",QUALIFICATION:"bg-yellow-100 text-yellow-700",PROPOSAL:"bg-orange-100 text-orange-700",NEGOTIATION:"bg-purple-100 text-purple-700",CLOSED_WON:"bg-green-100 text-green-700",CLOSED_LOST:"bg-red-100 text-red-700",CLOSED_CANCELLED:"bg-red-100 text-red-700"})[ie]||"bg-gray-100 text-gray-700",Q=f.useCallback(async ie=>{try{const Me=await re.get(`/activities/deal/${ie}`);ye(Me.data&&typeof Me.data=="object"?Me.data:{})}catch(Me){console.error(Me),Me.response?.status===404&&(console.warn("No activities found for this account."),ye({}))}},[]),ne=f.useMemo(()=>{const ie=n.trim().toLowerCase(),Me=r.trim(),Ke=o.trim();return(v??[]).filter(gt=>{const Ct=[gt?.name,gt?.description,gt?.account?.name,gt?.contact?.first_name,gt?.contact?.last_name,gt?.assigned_deals?.first_name,gt?.assigned_deals?.last_name],Ht=ie===""||Ct.some(Ae=>Ae==null||Ae===""?!1:Ae.toString().toLowerCase().includes(ie)),da=Me==="Filter by Stage"||Me===""||gt.stage===_e[Me]||gt.stage===Me,Ge=Ke==="Filter by Owner"||Ke===""||`${gt.assigned_deals?.first_name||""} ${gt.assigned_deals?.last_name||""}`.trim().toLowerCase()===Ke.toLowerCase();return Ht&&da&&Ge})},[v,n,r,o]),ae=Math.max(1,Math.ceil(ne.length/_)||1);f.useEffect(()=>{S(1)},[n,r,o]),f.useEffect(()=>{S(ie=>{const Me=Math.max(1,Math.ceil(ne.length/_)||1);return ie>Me?Me:ie})},[ne.length,_]);const Pe=f.useMemo(()=>{const ie=(w-1)*_;return ne.slice(ie,ie+_)},[ne,w,_]),Te=()=>S(ie=>Math.max(ie-1,1)),he=()=>S(ie=>Math.min(ie+1,ae)),He=()=>{be({id:null,name:"",account_id:"",primary_contact_id:"",stage:"PROPOSAL",amount:"",close_date:"",assigned_to:"",currency:"PHP",description:""}),U(!1),R(null),x(!0)},qe=async()=>{N(!0);try{const ie=await re.get("/deals/admin/fetch-all"),Ke=[...Array.isArray(ie.data)?ie.data:[]].sort((gt,Ct)=>{const Ht=gt?.created_at?new Date(gt.created_at).getTime():0;return(Ct?.created_at?new Date(Ct.created_at).getTime():0)-Ht});j(Ke)}catch(ie){ie.response&&ie.response.status===403?H.error("Permission denied. Only CEO, Admin, or Group Manager can access this page."):H.error("Failed to fetch deals. Please try again later."),console.error(ie)}finally{N(!1)}},nt=async()=>{try{const ie=await re.get("/accounts/admin/fetch-all");Z(Array.isArray(ie.data)?ie.data:[])}catch(ie){console.error(ie),ie.response?.status===403&&H.warn("Unable to load accounts (permission denied).")}},ot=async()=>{try{const ie=await re.get("/contacts/admin/fetch-all");oe(Array.isArray(ie.data)?ie.data:[])}catch(ie){console.error(ie),ie.response?.status===403&&H.warn("Unable to load contacts (permission denied).")}},Re=async()=>{try{const ie=await re.get("/users/all");X(Array.isArray(ie.data)?ie.data:[])}catch(ie){console.error(ie),ie.response?.status===403&&H.warn("Unable to load users (permission denied).")}};f.useEffect(()=>{qe(),nt(),ot(),Re()},[]);const{user:it}=Vt(),St=it?.role==="Sales";f.useEffect(()=>{p&&!D&&St&&it&&!$e.assigned_to&&be(ie=>({...ie,assigned_to:it.id}))},[p,D,St,it,$e.assigned_to]);const Et=async ie=>{ie&&(be({id:ie.id||null,name:ie.name||"",account_id:ie.account_id?.toString()||"",primary_contact_id:ie.primary_contact_id?.toString()||"",stage:ie.stage||"PROPOSAL",amount:ie.amount?.toString()||"",close_date:ie.close_date?new Date(ie.close_date).toISOString().split("T")[0]:"",assigned_to:ie.assigned_to?.toString()||"",currency:ie.currency||"PHP",description:ie.description||""}),Ue(ie.account||null),We(ie.contact||null),U(!0),R(ie.id),u(null),x(!0))},Tt=async(ie=!1)=>{try{const Me=await re.get("/deals/admin/fetch-all"),gt=[...Array.isArray(Me.data)?Me.data:[]].sort((Ct,Ht)=>{const da=Ct?.created_at?new Date(Ct.created_at).getTime():0;return(Ht?.created_at?new Date(Ht.created_at).getTime():0)-da});if(j(gt),!ie&&c&&c.id){const Ct=gt.find(Ht=>Ht.id===c.id);Ct&&u({...Ct})}}catch(Me){console.error("Failed to refresh deal data:",Me),await qe()}},Nt=ie=>{const Me=ie.name.trim();if(!Me){H.error("Deal name is required.");return}if(!ie.account_id){H.error("Account is required.");return}const Ke=D&&B?"update":"create",gt=Me;M({title:Ke==="create"?"Confirm New Deal":"Confirm Update",message:Ke==="create"?a.jsxs("span",{children:["Are you sure you want to create"," ",a.jsx("span",{className:"font-semibold",children:gt}),"?"]}):a.jsxs("span",{children:["Save changes to ",a.jsx("span",{className:"font-semibold",children:gt}),"?"]}),confirmLabel:Ke==="create"?"Create Deal":"Update Deal",cancelLabel:"Cancel",variant:"primary",action:{type:Ke,formData:ie,targetId:B||null,name:gt}})},xe=ie=>{const Me=Pe?.find(Ke=>Ke.id===ie);Me&&Me.deal_creator?.id===it?.id&&de(Ke=>{const gt=new Set(Ke);return gt.has(ie)?gt.delete(ie):gt.add(ie),gt})},ve=()=>{const ie=Pe?.filter(Me=>Me.deal_creator?.id===it?.id)||[];we.size===ie.length&&ie.length>0?de(new Set):de(new Set(ie.map(Me=>Me.id)))},Oe=()=>{if(we.size===0)return;const ie=we.size;M({title:"Archive Deals",message:a.jsxs("span",{children:["Are you sure you want to archive"," ",a.jsx("span",{className:"font-semibold",children:ie})," deal",ie!==1?"s":"","? You can restore them later if needed."]}),confirmLabel:`Archive ${ie} Deal${ie!==1?"s":""}`,cancelLabel:"Cancel",variant:"archive",action:{type:"bulk-archive",targetIds:Array.from(we),count:ie}})},Ce=ie=>{if(!ie)return;const Me=ie.name||"this deal";M({title:"Archive Deal",message:a.jsxs("span",{children:["Are you sure you want to archive"," ",a.jsx("span",{className:"font-semibold",children:Me}),"? You can restore it later if needed."]}),confirmLabel:"Archive Deal",cancelLabel:"Cancel",variant:"archive",action:{type:"archive",targetId:ie.id,name:Me}})},Qe=async()=>{if(!E?.action){M(null);return}const{action:ie}=E,{type:Me,formData:Ke,targetId:gt,name:Ct}=ie;P(!0);try{if(Me==="create"){A(!0);const Ht={name:Ke.name.trim(),account_id:parseInt(Ke.account_id),primary_contact_id:Ke.primary_contact_id?parseInt(Ke.primary_contact_id):null,stage:Ke.stage,amount:Ke.amount?parseFloat(Ke.amount):null,currency:Ke.currency||"PHP",close_date:Ke.close_date||null,description:Ke.description||null,assigned_to:Ke.assigned_to?parseInt(Ke.assigned_to):null};await re.post("/deals/admin/create",Ht),H.success(`Deal "${Ct}" created successfully.`),x(!1),await qe()}else if(Me==="update"){if(!gt)throw new Error("Missing deal identifier for update.");A(!0);const Ht={};Ke.name!==void 0&&(Ht.name=Ke.name.trim()),Ke.account_id!==void 0&&Ke.account_id!==""&&(Ht.account_id=parseInt(Ke.account_id)),Ke.primary_contact_id!==void 0&&(Ht.primary_contact_id=Ke.primary_contact_id?parseInt(Ke.primary_contact_id):null),Ke.stage!==void 0&&(Ht.stage=Ke.stage),Ke.amount!==void 0&&Ke.amount!==""&&(Ht.amount=parseFloat(Ke.amount)),Ke.currency!==void 0&&(Ht.currency=Ke.currency),Ke.close_date!==void 0&&(Ht.close_date=Ke.close_date||null),Ke.description!==void 0&&(Ht.description=Ke.description||null),Ke.assigned_to!==void 0&&(Ht.assigned_to=Ke.assigned_to?parseInt(Ke.assigned_to):null),await re.put(`/deals/admin/${gt}`,Ht),H.success(`Deal "${Ct}" updated successfully.`),x(!1),await qe()}else if(Me==="delete"){if(!gt)throw new Error("Missing deal identifier for deletion.");await re.delete(`/deals/admin/${gt}`),H.success(`Deal "${Ct}" deleted successfully.`),c?.id===gt&&u(null),await qe()}else if(Me==="archive"){if(!gt)throw new Error("Missing deal identifier for archive.");await re.put(`/deals/single-archive/${gt}`),H.success(`Deal "${Ct}" archived successfully.`),c?.id===gt&&u(null),await qe()}else if(Me==="bulk-archive"){if(ge(!0),!ie.targetIds||ie.targetIds.length===0)throw new Error("No deals selected for archiving.");await re.put("/deals/bulk-archive",{deal_ids:ie.targetIds}),H.success(`${ie.count} deal${ie.count!==1?"s":""} archived successfully.`),de(new Set),c&&ie.targetIds.includes(c.id)&&u(null),await qe()}}catch(Ht){console.error(Ht);const da=Me==="create"?"Failed to create deal. Please review the details and try again.":Me==="update"?"Failed to update deal. Please review the details and try again.":Me==="bulk-archive"?"Failed to archive deals. Please try again.":Me==="archive"?"Failed to archive deal. Please try again.":"Failed to delete deal. Please try again.",Ge=Ht.response?.data?.detail||da;H.error(Ge)}finally{(Me==="create"||Me==="update")&&A(!1),Me==="bulk-archive"&&ge(!1),P(!1),M(null)}},G=()=>{z||M(null)},W=()=>{x(!1),be({id:null,name:"",account_id:"",primary_contact_id:"",stage:"PROPOSAL",amount:"",close_date:"",assigned_to:"",currency:"PHP",description:""}),Ue(null),We(null),U(!1),R(null),A(!1)},J=(v??[]).filter(ie=>ie.stage==="PROSPECTING").length,Y=(v??[]).filter(ie=>ie.stage==="QUALIFICATION").length,F=(v??[]).filter(ie=>ie.stage==="PROPOSAL").length,ue=(v??[]).filter(ie=>ie.stage==="NEGOTIATION").length,De=(v??[]).filter(ie=>ie.stage==="CLOSED_WON").length,le=(v??[]).filter(ie=>ie.stage==="CLOSED_LOST").length,Ie=(v??[]).filter(ie=>ie.stage==="CLOSED_CANCELLED").length,K=[{title:"Prospecting",value:J,icon:yj,color:"text-blue-600",bgColor:"bg-blue-100"},{title:"Qualification",value:Y,icon:gn,color:"text-yellow-600",bgColor:"bg-yellow-100"},{title:"Proposal",value:F,icon:sa,color:"text-orange-600",bgColor:"bg-orange-100"},{title:"Negotiation",value:ue,icon:cd,color:"text-purple-600",bgColor:"bg-purple-100"},{title:"Closed Won",value:De,icon:Qa,color:"text-green-600",bgColor:"bg-green-100"},{title:"Closed Lost",value:le,icon:Us,color:"text-red-600",bgColor:"bg-red-100"},{title:"Closed Cancelled",value:Ie,icon:Us,color:"text-gray-600",bgColor:"bg-gray-100"}];return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[y&&a.jsx(Wt,{message:"Loading deals..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h1",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(sa,{className:"mr-2 text-blue-600"}),"Deals"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{onClick:He,className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 lg:my-0 rounded-md hover:bg-gray-800 text-sm sm:text-base mx-auto sm:ml-auto cursor-pointer",children:[a.jsx(aa,{className:"mr-2"})," Add Deal"]})})]}),a.jsx("div",{className:"grid grid-cols-1 p-2 lg:grid-cols-4 gap-4 mb-6 w-full break-words overflow-hidden",children:K.map(ie=>a.jsx(HFe,{...ie},ie.title))}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search deals",value:n,onChange:ie=>s(ie.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsxs("div",{className:"w-full lg:w-auto flex flex-col lg:flex-row gap-3",children:[a.jsxs("select",{value:r,onChange:ie=>i(ie.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full lg:w-40 focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{value:"Filter by Stage",children:"Filter by Stage"}),a.jsx("option",{value:"Prospecting Stage",children:"Prospecting"}),a.jsx("option",{value:"Qualification Stage",children:"Qualification"}),a.jsx("option",{value:"Proposal Stage",children:"Proposal"}),a.jsx("option",{value:"Negotiation Stage",children:"Negotiation"}),a.jsx("option",{value:"Closed Won Stage",children:"Closed Won"}),a.jsx("option",{value:"Closed Lost Stage",children:"Closed Lost"}),a.jsx("option",{value:"Closed Cancelled Stage",children:"Closed Cancelled"})]}),a.jsxs("select",{value:o,onChange:ie=>l(ie.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full lg:w-40 focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{value:"Filter by Owner",children:"Filter by Owner"}),[...new Set((v??[]).map(ie=>`${ie.assigned_deals?.first_name} ${ie.assigned_deals?.last_name}`))].map((ie,Me)=>a.jsx("option",{value:ie,children:ie},Me))]})]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[500px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 text-sm tracking-wide font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 w-12",children:a.jsx("input",{type:"checkbox",checked:we.size>0&&we.size===Pe?.filter(ie=>ie.deal_creator?.id===it?.id).length&&Pe?.filter(ie=>ie.deal_creator?.id===it?.id).length>0,onChange:ve,className:"w-4 h-4 cursor-pointer"})}),a.jsx("th",{className:"py-3 px-4",children:"Deal ID"}),a.jsx("th",{className:"py-3 px-4 truncate",children:"Deal Name"}),a.jsx("th",{className:"py-3 px-4",children:"Account"}),a.jsx("th",{className:"py-3 px-4",children:"Contact"}),a.jsx("th",{className:"py-3 px-4",children:"Stage"}),a.jsx("th",{className:"py-3 px-4",children:"Value"}),a.jsx("th",{className:"py-3 px-4",children:"Close Date"}),a.jsx("th",{className:"py-3 px-4",children:"Owner"}),a.jsx("th",{className:"py-3 px-4 w-12",children:we.size>0&&a.jsx("button",{onClick:Oe,className:"text-orange-500 hover:text-orange-700 transition",title:"Archive selected deals",disabled:ke,children:a.jsx(Zt,{size:18})})})]})}),a.jsx("tbody",{children:ne.length>0?Pe.map(ie=>a.jsxs("tr",{className:"hover:bg-gray-50 text-sm cursor-pointer",onClick:()=>{u({...ie}),Q(ie.id)},children:[a.jsx("td",{className:"py-3 px-4",children:it?.id===ie.deal_creator?.id&&a.jsx("input",{type:"checkbox",checked:we.has(ie.id),onClick:Me=>{Me.stopPropagation()},onChange:Me=>{Me.stopPropagation(),xe(ie.id)},className:"w-4 h-4 cursor-pointer"})}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",children:st(ie.deal_id)}),a.jsx("td",{className:"py-3 px-4",children:a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-blue-600 hover:underline break-all text-sm",children:ie.name}),a.jsx("div",{className:"text-gray-500 text-xs break-all",children:ie.description||"--"})]})}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",children:ie.account?.name||"--"}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",children:ie.contact?.first_name&&ie.contact?.last_name?`${ie.contact.first_name} ${ie.contact.last_name}`:ie.contact?.first_name||ie.contact?.last_name||"--"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${ce(ie.stage)}`,children:pe(ie.stage)})}),a.jsxs("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",children:[" ",ie.amount?.toLocaleString()||"0"]}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",children:Xe(ie.close_date)||"--"}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",children:ie.assigned_deals?.first_name&&ie.assigned_deals?.last_name?`${ie.assigned_deals.first_name} ${ie.assigned_deals.last_name}`:ie.assigned_deals?.first_name||ie.assigned_deals?.last_name||"--"})]},ie.id)):a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:9,children:"No deals found."})})})]})}),a.jsx(ca,{className:"mt-4",totalItems:ne.length,pageSize:_,currentPage:w,onPrev:Te,onNext:he,onPageSizeChange:ie=>{k(ie),S(1)},pageSizeOptions:[10,20,30,40,50],label:"deals"}),p&&a.jsx(qFe,{onClose:W,formData:$e,setFormData:be,isEditing:D,onSubmit:Nt,isSubmitting:T||z,accounts:q,contacts:V,users:je,currentAccount:me,currentContact:Ee,onAddAccount:Je,onAddContact:Be,onRefreshAccounts:nt,onRefreshContacts:ot}),c&&a.jsx(fJ,{relatedActs:se,selectedDeal:c,show:!!c,onClose:()=>u(null),activeTab:d,setActiveTab:h,onEdit:Et,onDelete:Ce,onStatusUpdate:Tt}),E&&a.jsx(BFe,{open:!0,title:E.title,message:E.message,confirmLabel:E.confirmLabel,cancelLabel:E.cancelLabel,variant:E.variant,onConfirm:Qe,onCancel:G,loading:z})]})}function BFe({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o=!1,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":i==="archive"?"bg-orange-500 hover:bg-orange-600 border border-orange-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[10000]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsx("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${u}`,disabled:o,children:o?"Processing...":s})]})]})})}function HFe({icon:e,title:t,value:n,color:s="text-blue-600",bgColor:r="bg-blue-100",onClick:i}){const o=()=>{typeof i=="function"?i():console.log(`Clicked: ${t}`)};return a.jsxs("div",{className:"flex items-center p-4 bg-white rounded-xl shadow-md border border-gray-200 transition-all duration-300",onClick:o,children:[a.jsx("div",{className:`flex-shrink-0 p-3 rounded-full ${r} ${s} mr-4`,children:e?a.jsx(e,{size:22}):null}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:t}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:n})]})]})}function qFe({onClose:e,formData:t,setFormData:n,isEditing:s=!1,onSubmit:r,isSubmitting:i=!1,accounts:o=[],contacts:l=[],users:c=[],currentAccount:u=null,currentContact:d=null,onAddAccount:h,onAddContact:p,onRefreshAccounts:x,onRefreshContacts:v}){const{user:j}=Vt(),y=j?.role==="Sales";f.useEffect(()=>{!s&&y&&j&&!t.assigned_to&&n(T=>({...T,assigned_to:j.id}))},[s,y,j,t.assigned_to,n]);const[N,w]=f.useState(!1),S=T=>{if(T.preventDefault(),w(!0),!t.name?.trim()){H.error("Deal name is required.");return}const A=Number(t.amount);if(!t.amount||isNaN(A)||A<=0){H.error("Amount must be a number greater than 0.");return}if(!t.account_id){H.error("Please select an account.");return}if(!t.primary_contact_id){H.error("Please select a primary contact.");return}r?.(t)},_=T=>{T.target.id==="modalBackdrop"&&e()},k=f.useMemo(()=>{const T=String(t.account_id||"").trim(),A=Array.isArray(l)?l:[];return T?A.filter(E=>{const z=[E?.account_id,E?.accountId,E?.account?.id,E?.account?.account_id,E?.account?.accountId].find(P=>P!=null&&String(P).trim()!=="");return z?String(z)===T:!1}):A},[l,t.account_id]);return f.useEffect(()=>{const T=String(t.account_id||"").trim(),A=String(t.primary_contact_id||"").trim();if(!A||!T)return;k.some(M=>String(M?.id)===A)||n(M=>({...M,primary_contact_id:""}))},[t.account_id,t.primary_contact_id,k,n]),a.jsx("div",{id:"modalBackdrop",onClick:_,className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-full sm:max-w-3xl rounded-2xl shadow-lg p-4 sm:p-6 md:p-8 relative border border-gray-200 overflow-y-auto max-h-[90vh] hide-scrollbar",onClick:T=>T.stopPropagation(),children:[a.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-gray-500 hover:text-black transition",children:a.jsx(ea,{size:22})}),a.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800 mb-4 sm:mb-6 flex items-center justify-center",children:s?"Edit Deal":"Create Deal"}),a.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",onSubmit:S,noValidate:!0,children:[a.jsx($A,{label:"Deal Name",name:"name",value:t.name,onChange:T=>n({...t,name:T.target.value}),placeholder:"Enter deal name",required:!0,isSubmitted:N,className:"md:col-span-2"}),a.jsx(RA,{label:"Account",value:t.account_id||"",onChange:T=>n({...t,account_id:T}),items:o||[],getLabel:T=>T?.name??"",placeholder:"Search account...",disabled:i,currentItem:u,actions:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{type:"button",onClick:h,disabled:i,title:"Add account",className:"inline-flex items-center justify-center w-8 h-8 rounded-md border border-gray-300 text-gray-600 hover:bg-gray-50 transition disabled:opacity-60",children:a.jsx(aa,{size:16})}),a.jsx("button",{type:"button",onClick:x,disabled:i,title:"Refresh accounts",className:"inline-flex items-center justify-center w-8 h-8 rounded-md border border-gray-300 text-gray-600 hover:bg-gray-50 transition disabled:opacity-60",children:a.jsx(Br,{size:16})})]}),required:!0,isSubmitted:N}),a.jsx(RA,{label:"Primary Contact",value:t.primary_contact_id||"",onChange:T=>n({...t,primary_contact_id:T}),items:k||[],getLabel:T=>`${T?.first_name??""} ${T?.last_name??""}`.trim()||T?.email||"",placeholder:"Search contact...",disabled:i,currentItem:d,actions:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{type:"button",onClick:p,disabled:i,title:"Add contact",className:"inline-flex items-center justify-center w-8 h-8 rounded-md border border-gray-300 text-gray-600 hover:bg-gray-50 transition disabled:opacity-60",children:a.jsx(aa,{size:16})}),a.jsx("button",{type:"button",onClick:v,disabled:i,title:"Refresh contacts",className:"inline-flex items-center justify-center w-8 h-8 rounded-md border border-gray-300 text-gray-600 hover:bg-gray-50 transition disabled:opacity-60",children:a.jsx(Br,{size:16})})]}),required:!0,isSubmitted:N}),a.jsx(f8,{label:"Stage",name:"stage",value:t.stage,onChange:T=>n({...t,stage:T.target.value}),options:[{value:"PROSPECTING",label:"Prospecting"},{value:"QUALIFICATION",label:"Qualification"},{value:"PROPOSAL",label:"Proposal"},{value:"NEGOTIATION",label:"Negotiation"},{value:"CLOSED_WON",label:"Closed Won"},{value:"CLOSED_LOST",label:"Closed Lost"},{value:"CLOSED_CANCELLED",label:"Closed Cancelled"}],disabled:i}),a.jsx($A,{label:"Amount",name:"amount",type:"number",step:"0",value:t.amount,onChange:T=>n({...t,amount:T.target.value}),placeholder:"0",required:!0,isSubmitted:N}),a.jsx(f8,{label:"Currency",name:"currency",value:t.currency||"PHP",onChange:T=>n({...t,currency:T.target.value}),options:[{value:"PHP",label:"PHP"},{value:"USD",label:"USD"}],disabled:i}),a.jsx($A,{label:"Close Date",name:"close_date",type:"date",value:t.close_date||"",onChange:T=>n({...t,close_date:T.target.value}),disabled:i}),a.jsx(RA,{label:"Assign To",value:t.assigned_to||"",onChange:T=>n({...t,assigned_to:T}),items:c||[],getLabel:T=>`${T?.first_name??""} ${T?.last_name??""}`.trim()||T?.email||"",placeholder:"Search assignee...",required:!0,disabled:i||y,className:"md:col-span-2"}),a.jsx(WFe,{label:"Description",name:"description",value:t.description,onChange:T=>n({...t,description:T.target.value}),placeholder:"Additional details...",rows:3,className:"md:col-span-2",disabled:i}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-2 md:col-span-2 mt-4",children:[a.jsx("button",{type:"button",onClick:e,className:"w-full sm:w-auto px-4 py-2 text-white bg-red-400 border border-red-300 rounded hover:bg-red-500 transition disabled:opacity-70",disabled:i,children:"Cancel"}),a.jsx("button",{type:"submit",className:"w-full sm:w-auto px-4 py-2 text-white border border-tertiary bg-tertiary rounded hover:bg-secondary transition disabled:opacity-70",disabled:i,children:i?"Saving...":s?"Update Deal":"Save Deal"})]})]})]})})}function $A({label:e,name:t,value:n,onChange:s,placeholder:r,type:i="text",required:o=!1,disabled:l=!1,className:c="",isSubmitted:u=!1}){const d=u&&!n?.trim();return a.jsxs("div",{className:c,children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",o&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:i,name:t,value:n??"",onChange:s,placeholder:r,required:o,disabled:l,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border focus:ring-2 disabled:bg-gray-100
          ${d?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}
          ${c}
        `})]})}function f8({label:e,name:t,value:n,onChange:s,options:r,required:i=!1,disabled:o=!1,className:l=""}){return a.jsxs("div",{className:l,children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsx("select",{name:t,value:n??"",onChange:s,required:i,disabled:o,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100",children:r.map(c=>a.jsx("option",{value:c.value,children:c.label},c.value))})]})}function RA({label:e,items:t=[],value:n="",onChange:s,getLabel:r,placeholder:i="Search...",disabled:o=!1,className:l="",currentItem:c=null,required:u=!1,isSubmitted:d=!1,actions:h=null}){const p=d&&u&&!n;return a.jsxs("div",{className:l,children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",u&&a.jsx("span",{className:"text-red-500",children:"*"})]}),h?a.jsx("div",{className:"flex items-center",children:h}):null]}),a.jsx(GFe,{items:t,value:n??"",onChange:s,getLabel:r,placeholder:i,disabled:o,currentItem:c,hasError:p})]})}function GFe({items:e=[],value:t="",onChange:n,getLabel:s,placeholder:r="Search...",disabled:i=!1,maxRender:o=200,currentItem:l=null,hasError:c={hasError:c}}){const[u,d]=f.useState(!1),[h,p]=f.useState(""),x=f.useRef(null),j=e.find(w=>String(w.id)===String(t))||l,y=j?s(j):"",N=f.useMemo(()=>{const w=h.trim().toLowerCase();return(w?e.filter(_=>(s(_)||"").toLowerCase().includes(w)):e).slice(0,o)},[e,h,s,o]);return f.useEffect(()=>{const w=S=>{x.current&&!x.current.contains(S.target)&&d(!1)};return document.addEventListener("mousedown",w),()=>document.removeEventListener("mousedown",w)},[]),f.useEffect(()=>{u||p("")},[u]),a.jsxs("div",{ref:x,className:"relative w-full",children:[a.jsx("input",{disabled:i,value:u?h:y,placeholder:r,onFocus:()=>!i&&d(!0),onChange:w=>{p(w.target.value),u||d(!0)},className:`w-full border rounded-md px-2 py-1.5 text-sm outline-none focus:ring-2 disabled:bg-gray-100
          ${c?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}`}),u&&!i&&a.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg overflow-hidden",children:[a.jsx("div",{className:"max-h-56 overflow-y-auto hide-scrollbar",children:N.length>0?N.map(w=>{const S=String(w.id),_=s(w),k=String(t)===S;return a.jsx("button",{type:"button",onClick:()=>{n(S),d(!1)},className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-50 ${k?"bg-blue-50":""}`,children:_||"--"},S)}):a.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No results"})}),e.length>o&&a.jsxs("div",{className:"px-3 py-2 text-[11px] text-gray-400 border-t",children:["Showing first ",o," results  keep typing to narrow."]})]})]})}function WFe({label:e,name:t,value:n,onChange:s,placeholder:r,required:i=!1,disabled:o=!1,className:l="",rows:c=3}){return a.jsxs("div",{className:l,children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsx("textarea",{name:t,value:n??"",onChange:s,placeholder:r,required:i,disabled:o,rows:c,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100 resize-none"})]})}const zA=[{value:"Draft",label:"Draft"},{value:"Presented",label:"Presented"},{value:"Accepted",label:"Accepted"},{value:"Rejected",label:"Rejected"}],FA={deal_id:"",account_id:"",contact_id:"",total_amount:"",presented_date:"",validity_days:"",status:"Draft",assigned_to:"",notes:"",subtotal:0,tax_rate:0,tax_amount:0,discount_type:"",discount_value:0,discount_amount:0,currency:"PHP",items:[]},Ri=e=>{if(!e)return"Draft";const t=e.toString().trim().toLowerCase();return{draft:"Draft",presented:"Presented",accepted:"Accepted",rejected:"Rejected"}[t]||"Draft"},UA=e=>e?e.toString().toLowerCase().replace(/\b\w/g,t=>t.toUpperCase()):"--",VFe=e=>{switch(Ri(e).toLowerCase()){case"draft":return"bg-gray-100 text-gray-700";case"presented":return"bg-yellow-100 text-yellow-700";case"accepted":return"bg-green-100 text-green-700";case"rejected":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-700"}},YFe=e=>{switch(Ri(e).toLowerCase()){case"draft":return"bg-gray-600 text-white";case"presented":return"bg-yellow-600 text-white";case"accepted":return"bg-green-600 text-white";case"rejected":return"bg-red-600 text-white";default:return"bg-gray-600 text-white"}},Tb=e=>e?new Date(e).toLocaleString("en-US",{month:"2-digit",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).replace(",",""):"",Eg=e=>e?new Date(e).toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"numeric"}):"",QFe=e=>{if(!e)return"";if(typeof e=="string"&&e.match(/^\d{4}-\d{2}-\d{2}$/))return e;try{const t=new Date(e);if(isNaN(t.getTime()))return"";const n=t.getFullYear(),s=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0");return`${n}-${s}-${r}`}catch{return""}},BA=(e,t)=>{if(!e||t==null||t==="")return"";const n=Number(t);if(Number.isNaN(n))return"";const s=new Date(e);return isNaN(s.getTime())?"":(s.setDate(s.getDate()+n),s.toISOString().slice(0,10))},h8=e=>{if(!e)return"";const t=String(e).split("-");return t.length===3?`${t[0]}-${t[2]}`:String(e)},HA=e=>{if(!e)return"";const t=String(e).split("-");return t.length===3?`${t[0]}-${t[2]}`:String(e)},Yw=e=>{if(!e)return null;if(typeof e=="number")return e;if(typeof e=="string"&&e.trim()&&!Number.isNaN(Number(e)))return Number(e);if(typeof e=="object"){if(e.id&&!Number.isNaN(Number(e.id)))return Number(e.id);if(e.user?.id&&!Number.isNaN(Number(e.user.id)))return Number(e.user.id);if(e.data?.id&&!Number.isNaN(Number(e.data.id)))return Number(e.data.id);if(e.profile?.id&&!Number.isNaN(Number(e.profile.id)))return Number(e.profile.id)}return null},KFe=()=>{const e=["user","currentUser","userData","authUser","profile"];for(const s of e){const r=localStorage.getItem(s);if(r)try{const i=JSON.parse(r),o=Yw(i);if(o)return o}catch{}}const t=localStorage.getItem("user_id"),n=Yw(t);return n||null},XFe=e=>{if(!e)return"";const n=[e.account_id,e.accountId,e.account?.id,e.account?.account_id,e.account?.accountId].find(s=>s!=null&&String(s).trim()!=="");return n?String(n):""},ZFe=e=>{if(!e)return"";const n=[e.contact_id,e.contactId,e.contact?.id,e.primary_contact_id,e.primaryContactId,e.primary_contact?.id,e.primaryContact?.id].find(s=>s!=null&&String(s).trim()!=="");return n?String(n):""};function JFe(){const e=kt(),t=ta(),{user:n}=Vt(),s=n?.company?.currency||"";f.useEffect(()=>{document.title="Quotes | Sari-Sari CRM"},[]);const[r,i]=f.useState([]),[o,l]=f.useState(!1),[c,u]=f.useState([]),[d,h]=f.useState([]),[p,x]=f.useState([]),[v,j]=f.useState([]),[y,N]=f.useState(null),[w,S]=f.useState(null),[_,k]=f.useState(!1),[T,A]=f.useState(!1),[E,M]=f.useState(!1),[z,P]=f.useState(null),[D,U]=f.useState(!1),[B,R]=f.useState(!1),[q,Z]=f.useState(null),[V,oe]=f.useState(FA),[je,X]=f.useState(""),[se,ye]=f.useState("Filter by Status"),[Ne,fe]=f.useState(null),we=f.useCallback(async()=>{if(w)try{R(!0);const L=(await re.get("/company/invoice-info"))?.data;e(`/sales/quotes/${encodeURIComponent(w.id)}/print`,{state:{quote:w,companyInfo:L}})}catch(I){const L=I?.response?.data?.detail||I?.message||"Failed to open print page.";H.error(L)}finally{R(!1)}},[w,e]),[de,ke]=f.useState(1),[ge,$e]=f.useState(10),[be,me]=f.useState("Overview"),[Ue,Ee]=f.useState("Draft"),[We,tt]=f.useState([]),[lt,Fe]=f.useState(null),{comments:st,addComment:Xe,refresh:Ze}=kn({relatedType:"quote",relatedId:w?.id});f.useEffect(()=>{w?.id&&Ze()},[w?.id,Ze]),f.useEffect(()=>{const L=t.state?.quoteID;if(L){Fe(L),e(t.pathname,{replace:!0,state:{}});return}},[t,e]),f.useEffect(()=>{if(lt&&r.length>0&&!o){const I=r.find(L=>L.id===lt);I?S(I):H.error("Quote not found."),Fe(null)}},[lt,r,o]),f.useEffect(()=>{let I=!0;return(async()=>{const ee=KFe();if(ee&&I){N(ee);return}try{const Le=await re.get("/auth/me"),ze=Yw(Le?.data);if(ze&&I){N(ze);return}}catch{}try{const Le=await re.get("/users/me"),ze=Yw(Le?.data);if(ze&&I){N(ze);return}}catch{}I&&N(null)})(),()=>{I=!1}},[]);const Je=f.useCallback(I=>I&&d.find(ee=>String(ee.id)===String(I))?.name||"",[d]),Be=f.useCallback(I=>{if(!I)return"";const L=p.find(ee=>String(ee.id)===String(I));return L?`${L.first_name} ${L.last_name}`.trim():""},[p]),_e=f.useCallback(I=>{if(!I)return"--";const L=c.find(ee=>String(ee.id)===String(I));return L?.deal_name||L?.name||`Deal #${h8(I)}`},[c]),pe=f.useCallback(I=>{const L=c.find(ze=>String(ze.id)===String(I)),ee=XFe(L);let Le=ZFe(L);if(!Le&&ee){const ze=p.filter(Ve=>String(Ve.account_id||"")===String(ee));if(ze.length>0){const Ve=[...ze].sort((ft,_t)=>{const At=`${ft.first_name||""} ${ft.last_name||""}`.trim().toLowerCase(),Yt=`${_t.first_name||""} ${_t.last_name||""}`.trim().toLowerCase();return At.localeCompare(Yt)});Le=String(Ve[0].id)}}if(ee&&Le){const ze=p.find(Ve=>String(Ve.id)===String(Le));ze?.account_id&&String(ze.account_id)!==String(ee)&&(Le="")}return{accountId:ee||"",contactId:Le||""}},[c,p]),ce=f.useCallback(I=>{if(!I)return"--";if(I.deal?.deal_name)return I.deal.deal_name;if(I.deal?.name)return I.deal.name;const L=I.deal_id||I.deal?.id;return L?_e(L):"--"},[_e]),Q=f.useCallback(I=>{if(!I)return"--";if(I.account?.name)return I.account.name;let L=I.account_id||I.account?.id;if(!L){const ee=I.deal_id||I.deal?.id;ee&&(L=pe(ee).accountId)}return L?Je(L)||`Account #${L}`:"--"},[pe,Je]),ne=f.useCallback(I=>{if(!I)return"--";if(I.contact?.first_name||I.contact?.last_name)return`${I.contact?.first_name||""} ${I.contact?.last_name||""}`.trim()||"--";let L=I.contact_id||I.contact?.id;if(!L){const Le=I.deal_id||I.deal?.id;Le&&(L=pe(Le).contactId)}return(L?Be(L):"")||(L?`Contact #${L}`:"--")},[pe,Be]),ae=f.useCallback(async(I=null)=>{l(!0);try{const L=await re.get("/quotes/admin/fetch-all"),Le=[...Array.isArray(L.data)?L.data:[]].sort((ze,Ve)=>{const ft=ze?.created_at||ze?.updated_at||0,_t=Ve?.created_at||Ve?.updated_at||0;return new Date(_t)-new Date(ft)});if(i(Le),I){const ze=Le.find(Ve=>Ve.id===I);S(ze||null)}}catch(L){console.error(L),i([]),L.response?.status===403?H.error("Permission denied. Only CEO, Admin, or Group Manager can access this page."):H.error("Failed to fetch quotes. Please try again later.")}finally{l(!1)}},[]),Pe=f.useCallback(async()=>{try{const I=await re.get("/deals/admin/fetch-all");u(Array.isArray(I.data)?I.data:[])}catch(I){console.error(I),I.response?.status===403&&H.warn("Unable to load deals (permission denied).")}},[]),Te=f.useCallback(async()=>{try{const I=await re.get("/accounts/admin/fetch-all");h(Array.isArray(I.data)?I.data:[])}catch(I){console.error(I),I.response?.status===403&&H.warn("Unable to load accounts (permission denied).")}},[]),he=f.useCallback(async()=>{try{const I=await re.get("/contacts/admin/fetch-all");x(Array.isArray(I.data)?I.data:[])}catch(I){console.error(I),I.response?.status===403&&H.warn("Unable to load contacts (permission denied).")}},[]),He=f.useCallback(async()=>{try{const I=await re.get("/users/all");j(Array.isArray(I.data)?I.data:[])}catch(I){console.error(I),I.response?.status===403&&H.warn("Unable to load users (permission denied).")}},[]);f.useEffect(()=>{ae(),Pe(),Te(),he(),He()},[ae,Pe,Te,he,He]);const qe=f.useMemo(()=>{const I=je.trim().toLowerCase(),L=se.trim();return r.filter(ee=>{const Le=ce(ee),ze=Q(ee),Ve=ne(ee),ft=BA(ee.presented_date,ee.validity_days),_t=[ee.quote_id,Le,ze,Ve,ee.total_amount?.toString(),ee.validity_days?.toString(),ee.presented_date?Eg(ee.presented_date):"",ft?Eg(ft):"",ee.assigned_user?.first_name,ee.assigned_user?.last_name,ee.creator?.first_name,ee.creator?.last_name,ee.status,ee.notes,Tb(ee.created_at),Tb(ee.updated_at)],At=I===""||_t.some(En=>En==null?!1:En.toString().toLowerCase().includes(I)),Yt=L==="Filter by Status"||Ri(ee.status)===L;return At&&Yt})},[r,je,se,ce,Q,ne]),nt=Math.max(1,Math.ceil(qe.length/ge)||1);f.useEffect(()=>ke(1),[je,se]),f.useEffect(()=>{ke(I=>{const L=Math.max(1,Math.ceil(qe.length/ge)||1);return I>L?L:I})},[qe.length,ge]);const ot=f.useMemo(()=>{const I=(de-1)*ge;return qe.slice(I,I+ge)},[qe,de,ge]),Re=()=>ke(I=>Math.max(I-1,1)),it=()=>ke(I=>Math.min(I+1,nt)),St=I=>{S(I),me("Overview"),Ee(Ri(I?.status)||"Draft")},Et=()=>{S(null),me("Overview")},Tt=I=>{I.target.id==="quoteModalBackdrop"&&!D&&Et()},Nt=f.useCallback(()=>{k(!1),A(!1),Z(null),oe(FA),M(!1)},[]),xe=I=>{I.target.id==="modalBackdrop"&&!E&&!D&&Nt()},ve=I=>{const{name:L,value:ee}=I.target;if(L==="deal_id"){const{accountId:Le,contactId:ze}=pe(ee);oe(Ve=>({...Ve,deal_id:ee,account_id:Le,contact_id:ze}));return}oe(Le=>({...Le,[L]:ee}))},Oe=()=>{const I={...FA};n?.role?.toUpperCase()==="SALES"&&y&&(I.assigned_to=String(y)),oe(I),A(!1),Z(null),k(!0)},Ce=I=>{if(!I)return;S(null);const L=I.deal?.id?String(I.deal.id):I.deal_id?String(I.deal_id):"",ee=L?pe(L):{accountId:"",contactId:""},Le=I.account?.id?String(I.account.id):I.account_id?String(I.account_id):ee.accountId,ze=I.contact?.id?String(I.contact.id):I.contact_id?String(I.contact_id):ee.contactId,Ve=I.assigned_user?.id?String(I.assigned_user.id):I.assigned_to?String(I.assigned_to):"";oe({deal_id:L,account_id:Le||"",contact_id:ze||"",total_amount:I.total_amount?.toString()||"",presented_date:QFe(I.presented_date),validity_days:I.validity_days!==null&&I.validity_days!==void 0?String(I.validity_days):"",status:Ri(I.status)||"Draft",assigned_to:Ve,notes:I.notes||"",subtotal:parseFloat(I.subtotal)||0,tax_rate:parseFloat(I.tax_rate)||0,tax_amount:parseFloat(I.tax_amount)||0,discount_type:I.discount_type||"",discount_value:parseFloat(I.discount_value)||0,discount_amount:parseFloat(I.discount_amount)||0,currency:I.currency||"PHP",items:Array.isArray(I.items)?I.items.map(ft=>({id:ft.id,item_type:ft.item_type||"Product",name:ft.name||"",description:ft.description||"",sku:ft.sku||"",variant:ft.variant||"",unit:ft.unit||"pcs",quantity:parseFloat(ft.quantity)||1,unit_price:parseFloat(ft.unit_price)||0,discount_percent:parseFloat(ft.discount_percent)||0,discount_amount:parseFloat(ft.discount_amount)||0,line_total:parseFloat(ft.line_total)||0,sort_order:ft.sort_order||0})):[]}),A(!0),Z(I.id),k(!0)},Qe=I=>{if(I.target.checked){const L=ot.filter(ee=>ee.created_by===y).map(ee=>ee.id);tt(L)}else tt([])},G=I=>{tt(L=>L.includes(I)?L.filter(ee=>ee!==I):[...L,I])},W=ot.filter(I=>I.created_by===y),J=I=>{if(!I)return;const L=I.quote_id||"this quote";P({title:"Archive Quote",message:a.jsxs("span",{children:["Are you sure you want to archive"," ",a.jsx("span",{className:"font-semibold",children:L}),"? This action cannot be undone."]}),confirmLabel:"Archive Quote",cancelLabel:"Cancel",variant:"danger",action:{type:"delete",targetId:I.id,name:L}})},Y=async()=>{We.length!==0&&P({title:"Archive Quotes",message:a.jsxs("span",{children:["Are you sure you want to archive"," ",a.jsx("span",{className:"font-semibold",children:We.length})," selected quotes? This action cannot be undone."]}),confirmLabel:`Archive ${We.length} Quote(s)`,cancelLabel:"Cancel",variant:"danger",action:{type:"bulk-delete",quote_ids:We}})},[F,ue]=f.useState(!1),De=I=>{if(I.preventDefault(),ue(!0),!y){H.error("Unable to determine current user. Please log in again.");return}if(!V.deal_id){H.error("Deal is required.");return}if(!V.assigned_to&&n?.role?.toUpperCase()!=="SALES"){H.error("Assigned To is required.");return}const ee=pe(V.deal_id),Le=V.items.map((At,Yt)=>({item_type:At.item_type||"Product",name:At.name,description:At.description||null,sku:At.sku||null,variant:At.variant||null,unit:At.unit||null,quantity:parseFloat(At.quantity)||1,unit_price:parseFloat(At.unit_price)||0,discount_percent:parseFloat(At.discount_percent)||0,sort_order:At.sort_order??Yt})),ze={deal_id:Number(V.deal_id),account_id:ee.accountId?Number(ee.accountId):null,contact_id:ee.contactId?Number(ee.contactId):null,subtotal:parseFloat(V.subtotal)||0,tax_rate:parseFloat(V.tax_rate)||0,tax_amount:parseFloat(V.tax_amount)||0,discount_type:V.discount_type||null,discount_value:parseFloat(V.discount_value)||0,discount_amount:parseFloat(V.discount_amount)||0,total_amount:parseFloat(V.total_amount)||0,currency:V.currency||"PHP",presented_date:V.presented_date||null,validity_days:V.validity_days===""?null:Number(V.validity_days),status:V.status||"Draft",assigned_to:V.assigned_to?Number(V.assigned_to):null,notes:V.notes?.trim()||null,items:Le},Ve=T&&q?"update":"create",ft=_e(V.deal_id),_t=Ve==="create"?{...ze,created_by_id:Number(y)}:ze;P({title:Ve==="create"?"Confirm New Quote":"Confirm Update",message:Ve==="create"?a.jsxs("span",{children:["Are you sure you want to create a quote for"," ",a.jsx("span",{className:"font-semibold",children:ft}),"?"]}):a.jsxs("span",{children:["Save changes to"," ",a.jsx("span",{className:"font-semibold",children:ft}),"?"]}),confirmLabel:Ve==="create"?"Create Quote":"Update Quote",cancelLabel:"Cancel",variant:"primary",action:{type:Ve,payload:_t,targetId:q||null,name:ft}})},le=async()=>{if(!z?.action){P(null);return}const{action:I}=z,{type:L,payload:ee,targetId:Le,name:ze}=I;U(!0);try{if(L==="create")M(!0),await re.post("/quotes/admin",ee),H.success("Quote created successfully."),Nt(),await ae();else if(L==="update"){if(!Le)throw new Error("Missing quote identifier for update.");M(!0),await re.put(`/quotes/admin/${Le}`,ee),H.success("Quote updated successfully."),Nt(),await ae(),w?.id===Le&&S(null)}else if(L==="delete"){if(!Le)throw new Error("Missing quote identifier for deletion.");const Ve=w?.id;fe(Le),await re.delete(`/quotes/admin/${Le}`),H.success(`Quote "${ze}" archived successfully.`),await ae(Ve&&Ve!==Le?Ve:null),Ve===Le&&S(null)}else L==="bulk-delete"&&(await re.post("/quotes/admin/bulk-delete",{quote_ids:We}),H.success(`Successfully archived ${We.length} quotes`),tt([]),await ae())}catch(Ve){console.error(Ve);const ft=L==="create"?"Failed to create quote. Please review the details and try again.":L==="update"?"Failed to update quote. Please review the details and try again.":"Failed to archive quote. Please try again.";H.error(ft),(L==="create"||L==="update")&&M(!1),L==="delete"&&fe(null)}finally{(L==="create"||L==="update")&&M(!1),L==="delete"&&fe(null),U(!1),P(null)}},Ie=()=>{D||P(null)},K=f.useCallback((I,L)=>{const ee=I?.deal_id??I?.deal?.id??"",Le=ee?Number(ee):null,ze=Le?pe(String(Le)):{accountId:"",contactId:""},Ve=I?.account_id??I?.account?.id??ze.accountId??null,ft=I?.contact_id??I?.contact?.id??ze.contactId??null,_t=I?.total_amount??0,At=I?.assigned_to??I?.assigned_user?.id??null;return{deal_id:Le,account_id:Ve!=null&&String(Ve).trim()!==""?Number(Ve):null,contact_id:ft!=null&&String(ft).trim()!==""?Number(ft):null,total_amount:Number(_t),presented_date:I?.presented_date||null,validity_days:I?.validity_days===""||I?.validity_days===void 0||I?.validity_days===null?null:Number(I.validity_days),status:L,assigned_to:At!=null&&String(At).trim()!==""?Number(At):null,notes:I?.notes?.trim()||null}},[pe]),ie=f.useCallback(async()=>{if(!w?.id)return;const I=Ri(Ue),L=[I,I.toLowerCase()],ee=async Le=>re.patch(`/quotes/admin/${w.id}/status`,{status:Le},{headers:{"Content-Type":"application/json"}});try{let Le=!1;for(const ze of L)try{await ee(ze),Le=!0;break}catch(Ve){if(Ve?.response?.status===422)continue;throw Ve}if(!Le){const ze=K(w,I);if(!ze.deal_id){H.error("Cannot update status: missing deal_id on selected quote.");return}if(!ze.total_amount||ze.total_amount<=0){H.error("Cannot update status: missing/invalid total_amount on selected quote.");return}await re.put(`/quotes/admin/${w.id}`,ze)}H.success(`Quote status updated to ${I}`),S(null),me("Overview"),await ae()}catch(Le){console.error(Le);const ze=Le?.response?.data?.message||(Le?.response?.data?.errors?Object.values(Le.response.data.errors).flat().join(" "):null)||"Failed to update quote status. Please try again.";H.error(ze)}},[w,Ue,ae,K]),Me=[{label:"Filter by Status",value:"Filter by Status"},...zA.map(I=>({label:I.label,value:I.value}))],Ke=z?.action?.type==="delete"?z.action.targetId:null,gt=w&&(Ne===w.id||Ke===w.id),Ct=w&&Ne===w.id,Ht=w?a.jsx("div",{id:"quoteModalBackdrop",onClick:Tt,className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-6xl max-h-[92vh] overflow-y-auto hide-scrollbar animate-scale-in font-inter relative",onClick:I=>I.stopPropagation(),children:[a.jsx("div",{className:"w-full flex flex-col items-center justify-center rounded-t-xl",children:a.jsxs("div",{className:"bg-tertiary w-full flex items-center justify-between p-3 lg:p-3 rounded-t-xl",children:[a.jsx("h1",{className:"lg:text-3xl text-xl text-white font-semibold text-center w-full",children:"Quotes"}),a.jsx("button",{onClick:Et,className:"text-gray-500 hover:text-white transition cursor-pointer",children:a.jsx(Ja,{size:25})})]})}),a.jsxs("div",{className:"p-6 lg:p-4",children:[a.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between lg:flex-row lg:items-center lg:justify-between mt-3 gap-2 px-2 md:items-center lg:gap-4 md:mx-7 lg:mx-7",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[a.jsx("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-800",children:ce(w)}),a.jsx("span",{className:`text-xs sm:text-sm font-medium px-2 sm:px-3 py-1 rounded-full whitespace-nowrap ${YFe(w.status)}`,children:UA(w.status)})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsxs("button",{className:"inline-flex items-center justify-center w-full sm:w-auto bg-white text-gray-700 px-4 py-2 rounded-md border border-gray-300 hover:bg-gray-50 disabled:opacity-70 transition text-sm focus:outline-none focus:ring-2 focus:ring-gray-300",onClick:we,disabled:B||E||D,children:[a.jsx(ia,{className:"mr-2"}),B?"Preparing...":"Print Quotation"]}),y===w.created_by&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{className:"inline-flex items-center justify-center w-full sm:w-auto bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 disabled:opacity-70 transition text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",onClick:()=>Ce(w),disabled:D||z?.action?.type==="update"&&z.action.targetId===w.id,children:[a.jsx(gn,{className:"mr-2"}),"Edit"]}),a.jsx("button",{className:"inline-flex items-center justify-center w-full sm:w-auto px-4 py-2 rounded-md text-sm bg-orange-500 text-white hover:bg-orange-600 transition focus:outline-none focus:ring-2 focus:ring-orange-400",onClick:()=>J(w),disabled:!!gt,children:Ct?"Archiving...":a.jsxs(a.Fragment,{children:[a.jsx(Zt,{className:"mr-2"}),"Archive"]})})]})]})]}),a.jsx("div",{className:"border-b border-gray-200 my-5"}),a.jsxs("div",{className:"p-1 lg:p-4",children:[a.jsx("div",{className:"flex w-full bg-[#6A727D] text-white mt-1 overflow-x-auto mb-6",children:["Overview","Notes"].map(I=>a.jsx("button",{onClick:()=>me(I),className:`flex-1 min-w-[90px] px-4 py-2.5 text-xs sm:text-sm font-medium text-center transition-all duration-200 border-b-2
                    ${be===I?"bg-paper-white text-[#6A727D] border-white":"text-white hover:bg-[#5c636d]"}`,children:I},I))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 items-start",children:[a.jsxs("div",{className:"lg:col-span-3",children:[be==="Overview"&&a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 md:p-8 border border-gray-200",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4 sm:gap-6 text-sm text-gray-700",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Quote ID:"}),a.jsx("p",{children:HA(w.quote_id)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Deal:"}),a.jsx("p",{children:ce(w)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Account:"}),a.jsx("p",{children:Q(w)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Contact:"}),a.jsx("p",{children:ne(w)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Total Amount:"}),a.jsx("p",{children:w.total_amount?`${s}${Number(w.total_amount).toLocaleString()}`:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Presented Date:"}),a.jsx("p",{children:Eg(w.presented_date)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Validity Days:"}),a.jsx("p",{children:w.validity_days!==null&&w.validity_days!==void 0?w.validity_days:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Expiry Date:"}),a.jsx("p",{children:Eg(BA(w.presented_date,w.validity_days))||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Status:"}),a.jsx("p",{children:UA(w.status)})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Assigned To:"}),a.jsx("p",{children:w.assigned_user?`${w.assigned_user.first_name} ${w.assigned_user.last_name}`:"Unassigned"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created By:"}),a.jsx("p",{children:w.creator?`${w.creator.first_name} ${w.creator.last_name}`:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created At:"}),a.jsx("p",{children:Tb(w.created_at)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Last Updated:"}),a.jsx("p",{children:Tb(w.updated_at)||"N/A"})]})]}),w.items&&w.items.length>0&&a.jsx("div",{className:"mt-6",children:a.jsx(jd,{items:w.items,onChange:()=>{},currencySymbol:s,readOnly:!0,taxRate:parseFloat(w.tax_rate)||0,discountType:w.discount_type,discountValue:parseFloat(w.discount_value)||0})})]}),be==="Notes"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"bg-white p-4 sm:p-6 rounded-xl border border-gray-200 shadow-sm",children:[a.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Notes:"}),a.jsx("p",{className:"text-sm text-gray-700 leading-relaxed whitespace-pre-wrap",children:w.notes||"No notes available."})]}),a.jsx(Tn,{comments:st,onAddComment:Xe})]})]}),a.jsxs("div",{className:"flex flex-col gap-4",children:[a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Quick Actions"}),a.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[a.jsxs("button",{onClick:()=>e("/sales/calls",{state:{openCallModal:!0,initialCallData:{subject:`Call regarding Quote ${HA(w.quote_id)}`,assigned_to:w.assigned_user?.id?String(w.assigned_user.id):w.assigned_to?String(w.assigned_to):"",direction:"Outgoing",status:"Planned"}}}),className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(It,{className:"text-gray-600 w-4 h-4"}),"Schedule Call"]}),a.jsxs("button",{className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",onClick:()=>e("/sales/meetings",{state:{openMeetingModal:!0,initialMeetingData:{subject:`Meeting with ${w.quote_id}`,assignedTo:w.assigned_user?.id?String(w.assigned_user.id):w.assigned_to?String(w.assigned_to):"",status:"Planned"}}}),children:[a.jsx(Ot,{className:"text-gray-600 w-4 h-4"}),"Book Meeting"]}),a.jsxs("button",{onClick:()=>e("/sales/tasks",{state:{openTaskModal:!0,initialTaskData:{subject:`Follow up with ${w.quote_id}`,assignedTo:w.assigned_user?.id?String(w.assigned_user.id):w.assigned_to?String(w.assigned_to):"",priority:"NORMAL",status:"Not Started"}}}),className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(Qt,{className:"text-gray-600 w-4 h-4"}),"Tasks"]})]})]}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm w-full",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Status"}),a.jsx("select",{className:"border border-gray-200 rounded-md px-2 sm:px-3 py-1.5 w-full text-sm mb-2 focus:ring-2 focus:ring-indigo-500 outline-none",value:Ue||Ri(w.status)||"Draft",onChange:I=>Ee(I.target.value),children:zA.map(I=>a.jsx("option",{value:I.value,children:I.label},I.value))}),a.jsx("button",{onClick:ie,disabled:Ri(Ue)===Ri(w.status),className:`w-full py-1.5 rounded-md text-sm transition focus:outline-none focus:ring-2 ${Ri(Ue)===Ri(w.status)?"bg-gray-400 cursor-not-allowed text-white":"bg-gray-900 text-white hover:bg-gray-800 focus:ring-gray-400"}`,children:"Update"})]})]})]})]})]})]})}):null,da=a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[o&&a.jsx(Wt,{message:"Loading quotes..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h2",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(ia,{className:"mr-2 text-blue-600"})," Quotes"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto gap-2",children:a.jsxs("button",{onClick:()=>{Oe(),ue(!1)},className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 rounded-md hover:bg-gray-800 text-sm sm:text-base mx-auto sm:ml-auto cursor-pointer",children:[a.jsx(aa,{className:"mr-2"})," Add Quote"]})})]}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search quotes",value:je,onChange:I=>X(I.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsx("div",{className:"w-full lg:w-1/4",children:a.jsx("select",{value:se,onChange:I=>ye(I.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:Me.map(I=>a.jsx("option",{value:I.value,children:I.label},I.value))})})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[900px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 text-sm tracking-wide font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 w-12",children:a.jsx("input",{type:"checkbox",checked:W.length>0&&We.length===W.length,onChange:Qe,className:"cursor-pointer"})}),a.jsx("th",{className:"py-3 px-4",children:"Quote ID"}),a.jsx("th",{className:"py-3 px-4",children:"Deal"}),a.jsx("th",{className:"py-3 px-4",children:"Account"}),a.jsx("th",{className:"py-3 px-4",children:"Contact"}),a.jsx("th",{className:"py-3 px-4",children:"Total Amount"}),a.jsx("th",{className:"py-3 px-4",children:"Status"}),a.jsx("th",{className:"py-3 px-4",children:"Assigned To"}),a.jsx("th",{className:"py-3 px-4",children:"Expiry Date"}),a.jsx("th",{className:"py-3 px-4 text-center w-24",children:We.length>0?a.jsx("button",{onClick:Y,className:"text-orange-600 hover:text-orange-800 transition p-1 rounded-full hover:bg-orange-50",title:`Archive ${We.length} selected items`,children:a.jsx(Zt,{size:18})}):""})]})}),a.jsx("tbody",{children:o?a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:10,children:"Loading quotes..."})}):qe.length>0?ot.map(I=>{const L=BA(I.presented_date,I.validity_days);return a.jsxs("tr",{className:"hover:bg-gray-50 text-sm cursor-pointer transition",onClick:()=>St(I),children:[a.jsx("td",{className:"py-3 px-4 align-top w-12",onClick:ee=>ee.stopPropagation(),children:I.created_by===y&&a.jsx("input",{type:"checkbox",checked:We.includes(I.id),onChange:()=>G(I.id),className:"cursor-pointer"})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("div",{className:"font-medium text-blue-600 hover:underline whitespace-nowrap",children:HA(I.quote_id)||"--"})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("div",{className:"break-words",children:ce(I)||"--"})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("div",{className:"text-sm text-gray-700 break-words",children:Q(I)||"--"})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("div",{className:"break-words",children:ne(I)||"--"})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("div",{className:"text-gray-700",children:I.total_amount?`${s}${Number(I.total_amount).toLocaleString()}`:"--"})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-medium ${VFe(I.status)}`,children:UA(I.status)})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("div",{children:I.assigned_user?`${I.assigned_user.first_name} ${I.assigned_user.last_name}`:"Unassigned"})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("div",{className:"text-gray-500 text-xs",children:Eg(L)||"--"})}),a.jsx("td",{className:"py-3 px-4 align-top text-center w-24"})]},I.id)}):a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:10,children:"No quotes found."})})})]})}),a.jsx(ca,{className:"mt-4",totalItems:qe.length,pageSize:ge,currentPage:de,onPrev:Re,onNext:it,onPageSizeChange:I=>{$e(I),ke(1)},pageSizeOptions:[10,20,30,40,50],label:"quotes"})]}),Ge=_?a.jsx("div",{id:"modalBackdrop",onClick:xe,className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-full sm:max-w-3xl rounded-2xl shadow-lg p-4 sm:p-6 md:p-8 relative border border-gray-200 overflow-y-auto max-h-[90vh] hide-scrollbar",onClick:I=>I.stopPropagation(),children:[a.jsx("button",{onClick:()=>{Nt(),ue(!1)},className:"absolute top-4 right-4 text-gray-500 hover:text-black transition disabled:opacity-60",disabled:E||D,children:a.jsx(ea,{size:22})}),a.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800 mb-4 sm:mb-6 flex items-center justify-center",children:T?"Edit Quote":"Add New Quote"}),a.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",onSubmit:De,children:[a.jsx(x8,{label:"Deal",name:"deal_id",value:V.deal_id,onChange:I=>{const{accountId:L,contactId:ee}=pe(I);oe(Le=>({...Le,deal_id:I,account_id:L,contact_id:ee}))},items:Array.isArray(c)?c:[],getLabel:I=>`${h8(I?.deal_id??"")} ${I?.name??""}`.trim(),placeholder:"Search deal...",required:!0,isSubmitted:F,disabled:E||c.length===0,className:"md:col-span-2"}),a.jsx(p8,{label:"Account",value:Je(V.account_id)||(V.account_id?`Account #${V.account_id}`:""),disabled:!0}),a.jsx(p8,{label:"Contact",value:Be(V.contact_id)||(V.contact_id?`Contact #${V.contact_id}`:""),disabled:!0}),a.jsx("div",{className:"md:col-span-2 mt-2",children:a.jsx(jd,{items:V.items,onChange:I=>oe(L=>({...L,items:I})),currencySymbol:s,readOnly:E,taxRate:V.tax_rate,discountType:V.discount_type,discountValue:V.discount_value,onTotalsChange:I=>{oe(L=>({...L,subtotal:I.subtotal,discount_amount:I.discount_amount,tax_amount:I.tax_amount,total_amount:I.total_amount}))}})}),a.jsxs("div",{className:"md:col-span-2 mt-2 p-4 bg-gray-50 rounded-lg",children:[a.jsx("h4",{className:"font-medium text-gray-700 mb-3",children:"Pricing Settings"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-600 text-xs mb-1",children:"Discount Type"}),a.jsxs("select",{value:V.discount_type||"",onChange:I=>oe(L=>({...L,discount_type:I.target.value})),className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm",disabled:E,children:[a.jsx("option",{value:"",children:"No Discount"}),a.jsx("option",{value:"percentage",children:"Percentage (%)"}),a.jsx("option",{value:"fixed",children:"Fixed Amount"})]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-gray-600 text-xs mb-1",children:["Discount"," ",V.discount_type==="percentage"?"%":"Amount"]}),a.jsx("input",{type:"number",value:V.discount_value||"",onChange:I=>oe(L=>({...L,discount_value:I.target.value})),className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm",placeholder:"0",min:"0",max:V.discount_type==="percentage"?"100":void 0,step:"0.01",disabled:E||!V.discount_type})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-600 text-xs mb-1",children:"Tax Rate (%)"}),a.jsx("input",{type:"number",value:V.tax_rate||"",onChange:I=>oe(L=>({...L,tax_rate:I.target.value})),className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm",placeholder:"0",min:"0",max:"100",step:"0.01",disabled:E})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-600 text-xs mb-1",children:"Total Amount"}),a.jsxs("div",{className:"w-full bg-gray-100 border border-gray-300 rounded-md px-2 py-1.5 text-sm font-medium",children:[s,parseFloat(V.total_amount||0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]})]}),a.jsx(g8,{label:"Presented Date",name:"presented_date",type:"date",value:V.presented_date,onChange:ve,disabled:E}),a.jsx(g8,{label:"Validity Days",name:"validity_days",type:"number",value:V.validity_days,onChange:ve,placeholder:"30",disabled:E}),n?.role?.toUpperCase()==="SALES"?a.jsxs("div",{children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:["Assigned To ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("div",{className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm bg-white text-black font-medium",children:(()=>{const I=v.find(L=>String(L.id)===V.assigned_to);return I?`${I.first_name} ${I.last_name}`:"Assigning..."})()})]}):a.jsx(x8,{label:"Assigned To",value:V.assigned_to||"",onChange:I=>oe(L=>({...L,assigned_to:I})),items:Array.isArray(v)?v:[],getLabel:I=>{const L=`${I?.first_name??""} ${I?.last_name??""}`.trim();return L?I?.role?`${L} (${I.role})`:L:I?.email||""},placeholder:"Search assignee...",required:!0,isSubmitted:F,disabled:E}),a.jsx(eUe,{label:"Status",name:"status",value:V.status,onChange:ve,options:zA,required:!0,disabled:E}),a.jsx(aUe,{label:"Notes",name:"notes",value:V.notes,onChange:ve,placeholder:"Additional details...",rows:3,disabled:E,className:"md:col-span-2"}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-2 md:col-span-2 mt-4",children:[a.jsx("button",{type:"button",onClick:()=>{Nt(),ue(!1)},className:"w-full sm:w-auto px-4 py-2 text-white bg-gray-400 border border-gray-300 rounded hover:bg-gray-500 transition disabled:opacity-70",disabled:E||D,children:"Cancel"}),a.jsx("button",{type:"submit",className:"w-full sm:w-auto px-4 py-2 text-white border border-tertiary bg-tertiary rounded hover:bg-secondary transition disabled:opacity-70",disabled:E||D,children:E?"Saving...":T?"Update Quote":"Save Quote"})]})]})]})}):null,Ae=z?a.jsx(nUe,{open:!0,title:z.title,message:z.message,confirmLabel:z.confirmLabel,cancelLabel:z.cancelLabel,variant:z.variant,onConfirm:le,onCancel:Ie,loading:D}):null;return a.jsxs(a.Fragment,{children:[w?Ht:da,Ge,Ae]})}function g8({label:e,name:t,value:n,onChange:s,placeholder:r,type:i="text",required:o=!1,disabled:l=!1,className:c="",isSubmitted:u=!1}){const d=u&&!n?.trim();return a.jsxs("div",{className:c,children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",o&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:i,name:t,value:n??"",onChange:s,placeholder:r,required:o,disabled:l,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border focus:ring-2
          ${d?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}
          ${c}
        `})]})}function p8({label:e,value:t,className:n="",disabled:s=!0}){return a.jsxs("div",{className:n,children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsx("input",{type:"text",value:t??"",disabled:s,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm outline-none disabled:bg-gray-100"})]})}function eUe({label:e,name:t,value:n,onChange:s,options:r,required:i=!1,disabled:o=!1,className:l=""}){const c=n!=null?String(n):"",d=r.some(h=>String(h.value)===c)?c:"";return a.jsxs("div",{className:l,children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsx("select",{name:t,value:d,onChange:s,required:i,disabled:o,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100",children:r.map(h=>a.jsx("option",{value:String(h.value??""),children:h.label},h.value??h.label))})]})}function x8({label:e,items:t=[],value:n="",onChange:s,getLabel:r,placeholder:i="Search...",disabled:o=!1,className:l="",required:c=!1,isSubmitted:u=!1}){const d=u&&c&&!n;return a.jsxs("div",{className:l,children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",c&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx(tUe,{items:t,value:n??"",onChange:s,getLabel:r,placeholder:i,disabled:o,hasError:d})]})}function tUe({items:e=[],value:t="",onChange:n,getLabel:s,placeholder:r="Search...",disabled:i=!1,maxRender:o=200,hasError:l=!1}){const[c,u]=f.useState(!1),[d,h]=f.useState(""),p=f.useRef(null),x=e.find(y=>String(y.id)===String(t)),v=x?s(x):"",j=f.useMemo(()=>{const y=d.trim().toLowerCase();return(y?e.filter(w=>(s(w)||"").toLowerCase().includes(y)):e).slice(0,o)},[e,d,s,o]);return f.useEffect(()=>{const y=N=>{p.current&&!p.current.contains(N.target)&&u(!1)};return document.addEventListener("mousedown",y),()=>document.removeEventListener("mousedown",y)},[]),f.useEffect(()=>{c||h("")},[c]),a.jsxs("div",{ref:p,className:"relative w-full",children:[a.jsx("input",{disabled:i,value:c?d:v,placeholder:r,onFocus:()=>!i&&u(!0),onChange:y=>{h(y.target.value),c||u(!0)},className:`w-full border rounded-md px-2 py-1.5 text-sm outline-none focus:ring-2
          ${l?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}`}),c&&!i&&a.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg overflow-hidden",children:[a.jsx("div",{className:"max-h-56 overflow-y-auto hide-scrollbar",children:j.length>0?j.map(y=>{const N=String(y.id),w=s(y),S=String(t)===N;return a.jsx("button",{type:"button",onClick:()=>{n(N),u(!1)},className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-50 ${S?"bg-blue-50":""}`,children:w||"--"},N)}):a.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No results"})}),e.length>o&&a.jsxs("div",{className:"px-3 py-2 text-[11px] text-gray-400 border-t",children:["Showing first ",o," results  keep typing to narrow."]})]})]})}function aUe({label:e,name:t,value:n,onChange:s,placeholder:r,rows:i=3,disabled:o=!1,className:l=""}){return a.jsxs("div",{className:l,children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsx("textarea",{name:t,value:n??"",onChange:s,placeholder:r,rows:i,disabled:o,className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100 resize-none"})]})}function nUe({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o=!1,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-orange-500 hover:bg-orange-600 border border-orange-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsx("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${u}`,disabled:o,children:o?"Processing...":s})]})]})})}function sUe(){const{userRole:e}=Ks();return a.jsx(y1,{currentUserRole:e,currentUserId:null})}function rUe(){f.useEffect(()=>{document.title="Audit | Sari-Sari CRM"},[]);const[e,t]=f.useState(null),[n,s]=f.useState(""),[r,i]=f.useState("Filter by Actions"),[o,l]=f.useState(1),[c,u]=f.useState(10),d=async()=>{try{const w=await re.get("/logs/read-all");t(w.data)}catch(w){console.error("Error fetching audit logs:",w)}};f.useEffect(()=>{d()},[]);const h=f.useMemo(()=>{if(!Array.isArray(e))return[];const w=n.trim().toLowerCase(),S=r?.toUpperCase?.()||"ALL";return e.filter(k=>{const T=k.timestamp?new Date(k.timestamp).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}):"",A=`${k.entity_type||""} ${k.entity_name||k.entity_details?.name||k.entity_details?.title||k.entity_id||""}`,E=`${k.logger?.first_name||""} ${k.logger?.last_name||""}`,M=[T,E,k.action,k.entity_type,A,k.description],z=w===""||M.some(D=>D==null?!1:D.toString().toLowerCase().includes(w)),P=S==="FILTER BY ACTIONS"||(k.action||"").toUpperCase()===S;return z&&P}).sort((k,T)=>{const A=k.timestamp?new Date(k.timestamp).getTime():0;return(T.timestamp?new Date(T.timestamp).getTime():0)-A})},[e,n,r]),p=Math.max(1,Math.ceil(h.length/c)||1);f.useEffect(()=>{l(1)},[n,r]),f.useEffect(()=>{l(w=>{const S=Math.max(1,Math.ceil(h.length/c)||1);return w>S?S:w})},[h.length,c]);const x=f.useMemo(()=>{const w=(o-1)*c;return h.slice(w,w+c)},[h,o,c]);h.length===0||(o-1)*c+1,Math.min(o*c,h.length);const v=()=>l(w=>Math.max(w-1,1)),j=()=>l(w=>Math.min(w+1,p)),y=()=>{if(!h.length){Kx.error("No logs to export!");return}const w=["Timestamp","User","Action","Resource","Details"],S=h.map(E=>[new Date(E.timestamp).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}),`${E.logger?.first_name||""} ${E.logger?.last_name||""}`.trim(),E.action,`${E.entity_type}: ${E.entity_id}`,E.description||""]),_=[w.join(","),...S.map(E=>E.map(M=>`"${String(M).replace(/"/g,'""')}"`).join(","))].join(`
`),k=new Blob([_],{type:"text/csv;charset=utf-8;"}),T=URL.createObjectURL(k),A=document.createElement("a");A.href=T,A.download=`AuditLogs_${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(A),A.click(),document.body.removeChild(A),URL.revokeObjectURL(T)},N=w=>{switch((w||"").toUpperCase()){case"CREATE":return"bg-green-100 text-green-700";case"UPDATE":case"EDIT":return"bg-blue-100 text-blue-700";case"DELETE":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-700"}};return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[e===null&&a.jsx(Wt,{message:"Loading audit logs..."}),a.jsx(Qx,{toastOptions:{duration:1e3}}),a.jsxs("div",{className:"bg-blue-50 border-l-4 border-blue-400 p-4 mb-6 rounded-r-md flex items-center",children:[a.jsx(Ot,{className:"text-blue-600 mr-3 flex-shrink-0",size:20}),a.jsxs("p",{className:"text-sm text-blue-700",children:[a.jsx("span",{className:"font-semibold",children:"Data Retention Policy:"})," Audit logs are automatically purged after 6 months to optimize system performance."]})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-5 space-y-3 sm:space-y-0",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(ks,{className:"text-blue-600",size:20}),a.jsx("h2",{className:"text-2xl sm:text-xl font-semibold text-gray-700",children:"Audit Logs"})]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 rounded-md hover:bg-gray-800 text-sm sm:text-base self-end sm:self-auto cursor-pointer",onClick:y,children:[a.jsx(Vo,{className:"mr-2"}),"Export Logs"]})})]}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition bg-white",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search audit logs",value:n,onChange:w=>s(w.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsx("div",{className:"w-full lg:w-1/4",children:a.jsxs("select",{value:r,onChange:w=>i(w.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{value:"Filter by Actions",children:"Filter by Actions"}),a.jsx("option",{value:"CREATE",children:"CREATE"}),a.jsx("option",{value:"DELETE",children:"DELETE"}),a.jsx("option",{value:"UPDATE",children:"UPDATE"})]})})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[600px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 text-sm tracking-wide font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4",children:"Timestamp"}),a.jsx("th",{className:"py-3 px-4",children:"User"}),a.jsx("th",{className:"py-3 px-4",children:"Action"}),a.jsx("th",{className:"py-3 px-4",children:"Resource"}),a.jsx("th",{className:"py-3 px-4",children:"Details"})]})}),a.jsx("tbody",{children:Array.isArray(h)&&h.length>0?x.map((w,S)=>a.jsxs("tr",{className:"hover:bg-gray-50 text-sm",children:[a.jsx("td",{className:"py-3 px-4 text-gray-700 whitespace-nowrap",children:new Date(w.timestamp).toLocaleString("en-US",{month:"numeric",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}).replace(",","")}),a.jsx("td",{className:"py-3 px-4 text-gray-700",children:w.name}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium whitespace-nowrap ${N(w.action)}`,children:w.action})}),a.jsxs("td",{className:"py-3 px-4 text-gray-700",children:[w.entity_type,": ",w.entity_id]}),a.jsx("td",{className:"py-3 px-4 text-gray-700",children:w.description})]},S)):a.jsx("tr",{children:a.jsx("td",{className:"py-3 px-4 text-sm text-gray-500 text-center",colSpan:5,children:"No activities to show."})})})]})}),a.jsx(ca,{className:"mt-4",totalItems:h.length,pageSize:c,currentPage:o,onPrev:v,onNext:j,onPageSizeChange:w=>{u(w),l(1)},pageSizeOptions:[10,20,30,40,50],label:"logs"})]})}const y8=["Not started","In progress","Deferred","Completed"],b8={NOT_STARTED:"Not started","NOT STARTED":"Not started","TO DO":"Not started",IN_PROGRESS:"In progress","IN PROGRESS":"In progress",COMPLETED:"Completed",DEFERRED:"Deferred","Not started":"Not started","In progress":"In progress",Completed:"Completed",Deferred:"Deferred","In Progress":"In progress","To Do":"Not started",Review:"Deferred"},hJ=e=>e&&(b8[e]||b8[String(e).toUpperCase()])||"Not started",iUe=e=>{if(!e)return"";const t=new Date(e);if(Number.isNaN(t.getTime()))return"";const n=t.getTimezoneOffset();return new Date(t.getTime()-n*60*1e3).toISOString().slice(0,16)},qA=e=>{if(!e)return"";const t=new Date(e);return Number.isNaN(t.getTime())?"":t.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},oUe=e=>{const t=e.subject?.trim()??"",n=e.description?.trim()??"",s=e.notes?.trim()??"";e.priority&&String(e.priority).toUpperCase(),hJ(e.status);let r=null,i=null,o=null,l=null,c=null;e.relatedType1==="Lead"&&e.relatedTo1?r=Number(e.relatedTo1):e.relatedType1==="Account"&&e.relatedTo1&&(i=Number(e.relatedTo1)),e.relatedType1==="Account"&&(e.relatedType2==="Contact"&&e.relatedTo2?o=Number(e.relatedTo2):e.relatedType2==="Deal"&&e.relatedTo2?l=Number(e.relatedTo2):e.relatedType2==="Quote"&&e.relatedTo2&&(c=Number(e.relatedTo2)));const u=e.assignedTo?Number(e.assignedTo):null,d=o||l||i||r,h=o?"Contact":l?"Deal":i?"Account":r?"Lead":c?"Quote":null;return{title:t,description:n,priority:e.priority||"Normal",status:e.status||"Not started",due_date:e.dueDate?e.dueDate:null,assigned_to:u,notes:s,is_personal:!1,lead_id:r,account_id:i,contact_id:o,deal_id:l,quote_id:c,related_to_1:e.relatedTo1?Number(e.relatedTo1):null,related_type_1:e.relatedType1,related_to_2:e.relatedTo2?Number(e.relatedTo2):null,related_type_2:e.relatedType2,related_to:d,related_type:h}},lUe=e=>{const t=e.task_assign_to?`${e.task_assign_to.first_name} ${e.task_assign_to.last_name}`:e.assigned_to?String(e.assigned_to):"Unassigned",n=e.task_creator?`${e.task_creator.first_name} ${e.task_creator.last_name}`:e.created_by?String(e.created_by):"System",s=e.due_date||e.dueDate||null,r=e.date_assigned||e.created_at||null,i=e.contact?`${e.contact.first_name} ${e.contact.last_name}`:e.assigned_to?String(e.assigned_to.id):"Unassigned",o=B=>{if(!B)return"";const R=String(B).split("-");return R.length===3?`${R[0]}-${R[2]}`:String(B)},l=()=>e.lead?.id||e.lead_id,c=()=>e.account?.id||e.account_id,u=()=>e.contact?.id||e.contact_id,d=()=>e.deal?.id||e.deal_id,h=()=>e.quote?.id||e.quote_id,p=()=>e.task_assign_to?.id||e.assigned_to,x=()=>e.lead?.title||e.lead_id,v=()=>e.account?.name||e.account_id,j=()=>i||e.contact_id,y=()=>e.deal?.name||e.deal_id,N=()=>o(e.quote?.quote_id)||e.id;let w="Lead",S="",_="",k="",T="Lead",A="",E="",M="";const z=c(),P=v(),D=l(),U=x();if(z){w="Account",T="Account",A=P,S=String(z);const B=u(),R=d(),q=j(),Z=y(),V=h(),oe=N();B?(_="Contact",E="Contact",M=q,k=String(B)):R?(E="Deal",_="Deal",M=Z,k=String(R)):V&&(E="Quote",_="Quote",M=oe,k=String(V))}else D?(T="Lead",A=U,w="Lead",S=String(D)):e.related_type==="Account"&&(w="Account",S=String(e.related_to));return{id:e.id,title:e.title,description:e.description,priority:e.priority||"Normal",status:hJ(e.status),dueDate:s,dateAssigned:r,assignedToId:p()||null,assignedToName:t,createdAt:e.created_at||null,createdById:e.task_creator?.id??null,createdBy:n,notes:e.notes||"",isPersonal:!!e.is_personal,relatedType1Text:T,relatedTo1Text:A,relatedType2Text:E,relatedTo2Text:M,subject:e.title,relatedType1:w,relatedTo1:S,relatedType2:_,relatedTo2:k}};function cUe(){f.useEffect(()=>{document.title="Tasks | Sari-Sari CRM"},[]);const{user:e,loading:t}=Vt(),[n,s]=f.useState("board"),[r,i]=f.useState(!1),[o,l]=f.useState(null),[c,u]=f.useState(!1),[d,h]=f.useState([]),[p,x]=f.useState(!0),[v,j]=f.useState(""),[y,N]=f.useState("Filter by Status"),[w,S]=f.useState("Filter by Priority"),[_,k]=f.useState([]),[T,A]=f.useState(1),[E,M]=f.useState(10),[z,P]=f.useState(null),[D,U]=f.useState(!1),[B,R]=f.useState([]),[q,Z]=f.useState(null),V=kt(),oe=ta(),[je,X]=f.useState({id:"",subject:"",description:"",priority:"",status:"",dueDate:"",assignedTo:"",notes:"",createdById:null,relatedType1:"Lead",relatedType2:"Contact",relatedTo1:"",relatedTo2:""}),[se,ye]=f.useState(null),Ne=Ux(Ff(sm,{activationConstraint:{distance:8}})),fe=ne=>{const{active:ae}=ne,Pe=d.find(Te=>Te.id===ae.id);Z(Pe)},we=async ne=>{const{active:ae,over:Pe}=ne;if(Z(null),!Pe)return;const Te=ae.id,he=Pe.id,He=d.find(qe=>qe.id===Te);if(!(!He||He.status===he)){h(qe=>qe.map(nt=>nt.id===Te?{...nt,status:he}:nt));try{const qe={title:He.title,description:He.description||"",priority:He.priority||"Normal",status:he,due_date:He.dueDate||null,assigned_to:He.assignedToId||null,related_type_1:He.relatedType1||null,related_to_1:He.relatedTo1?parseInt(He.relatedTo1,10):null,related_type_2:He.relatedType2||null,related_to_2:He.relatedTo2?parseInt(He.relatedTo2,10):null};(!qe.related_to_1||isNaN(qe.related_to_1))&&(qe.related_to_1=null),(!qe.related_to_2||isNaN(qe.related_to_2))&&(qe.related_to_2=null),await re.put(`/tasks/${Te}`,qe),H.success(`Task moved to "${he}"`)}catch(qe){console.error("Failed to update task status:",qe),H.error("Failed to update task status"),h(nt=>nt.map(ot=>ot.id===Te?{...ot,status:He.status}:ot))}}},de=()=>{Z(null)};f.useEffect(()=>{const ne=oe.state?.openTaskModal,ae=oe.state?.initialTaskData,Pe=oe.state?.taskID;ne?(i(!0),ae&&X(Te=>({...Te,...ae})),V(oe.pathname,{replace:!0,state:{}})):Pe&&(ye(Pe),V(oe.pathname,{replace:!0,state:{}}))},[oe,V]),f.useEffect(()=>{if(se&&d.length>0&&!p){const ne=d.find(ae=>ae.id===se);ne?be(ne,!0):H.error("Task not found."),ye(null)}},[se,d,p]);const ke=async()=>{try{const ne=await re.get("/users/all");k(Array.isArray(ne.data)?ne.data:[])}catch(ne){console.error("Failed to fetch users:",ne),H.error("Failed to fetch users.")}},ge=async()=>{try{x(!0);const ne=await re.get("/tasks/all"),Pe=(Array.isArray(ne.data)?ne.data:[]).map(lUe);Pe.sort((Te,he)=>{const He=Te.createdAt?new Date(Te.createdAt):0;return(he.createdAt?new Date(he.createdAt):0)-He}),h(Pe),n==="list"&&A(1)}catch(ne){console.error("Failed to load tasks:",ne),H.error("Failed to load tasks.")}finally{x(!1)}};f.useEffect(()=>{if(!t&&e){ke(),ge();const ne=Mj(e.id),ae=new WebSocket(ne);return ae.onopen=()=>{console.log(" Connected to task notifications")},ae.onmessage=Pe=>{try{const Te=JSON.parse(Pe.data);Te.type==="task_status_updated"&&(H.info(` ${Te.message}`,{position:"top-right",autoClose:4e3}),ge())}catch(Te){console.error("Error parsing notification:",Te)}},ae.onerror=Pe=>{console.error(" WebSocket error:",Pe)},ae.onclose=()=>{console.log(" Disconnected from task notifications")},()=>{ae.readyState===WebSocket.OPEN&&ae.close()}}},[t,e]);const $e=()=>{l(null),X({id:"",subject:"",description:"",priority:"Normal",status:"Not started",dueDate:"",assignedTo:e?.role==="Sales"?String(e.id):"",notes:"",createdById:null,relatedType1:"Lead",relatedType2:"Contact",relatedTo1:"",relatedTo2:""})},be=(ne=null,ae=!1)=>{l(ne),u(ae),ne?X({id:ne.id,subject:ne.title||"",description:ne.description||"",priority:ne.priority||"Normal",status:ne.status||"Not started",dueDate:iUe(ne.dueDate),assignedTo:ne.assignedToId?String(ne.assignedToId):"",assignedToName:ne.assignedToName||"",createdBy:ne.createdBy||"",notes:ne.notes||"",createdById:ne.createdById||null,relatedType1Text:ne.relatedType1Text||"",relatedTo1Text:ne.relatedTo1Text||"",relatedType2Text:ne.relatedType2Text||"",relatedTo2Text:ne.relatedTo2Text||"",relatedType1:ne.relatedType1||"",relatedTo1:ne.relatedTo1||"",relatedType2:ne.relatedType2||"",relatedTo2:ne.relatedTo2||""}):$e(),i(!0)},me=()=>{i(!1),l(null),u(!1),$e()},Ue=async ne=>{const ae=oUe(ne);try{o&&!c?(await re.put(`/tasks/${o.id}`,ae),H.success("Task updated successfully.")):(await re.post("/tasks/create",ae),H.success("Task created successfully.")),i(!1),await ge()}catch(Pe){console.error("Failed to save task:",Pe);const Te=Pe.response?.data?.detail||"Failed to save task.";H.error(Te)}},Ee=ne=>{ne&&P({title:"Archive Task",message:a.jsxs(a.Fragment,{children:["Are you sure you want to archive ",a.jsx("span",{className:"font-semibold",children:ne.title}),"?"]}),confirmLabel:"Archive Task",cancelLabel:"Cancel",variant:"warning",action:{type:"archive",targetId:ne.id}})},We=()=>Je.filter(ne=>String(ne.createdById)===String(e?.id)),tt=()=>{const ne=We();if(ne.length!==0)if(ne.every(ae=>B.includes(ae.id)))R(B.filter(ae=>!ne.map(Pe=>Pe.id).includes(ae)));else{const ae=ne.map(Pe=>Pe.id);R([...new Set([...B,...ae])])}},lt=ne=>{const ae=Je.find(Pe=>Pe.id===ne);String(ae?.createdById)===String(e?.id)&&R(Pe=>Pe.includes(ne)?Pe.filter(Te=>Te!==ne):[...Pe,ne])},Fe=async()=>{B.length!==0&&P({title:"Archive Tasks",message:a.jsxs("span",{children:["Are you sure you want to archive"," ",a.jsx("span",{className:"font-semibold",children:B.length})," selected tasks?"]}),confirmLabel:`Archive ${B.length} Task(s)`,cancelLabel:"Cancel",variant:"warning",action:{type:"bulk-archive",task_ids:B}})},st=async()=>{if(!z?.action){P(null);return}const{action:ne}=z;U(!0);try{ne.type==="archive"?(await re.delete(`/tasks/${ne.targetId}`),H.success("Task archived successfully."),await ge()):ne.type==="bulk-archive"&&(await re.post("/tasks/bulk-archive",{task_ids:ne.task_ids}),H.success(`Successfully archived ${ne.task_ids.length} tasks`),R([]),await ge())}catch(ae){console.error("Task action failed:",ae);const Pe=ae.response?.data?.detail||"Failed to archive task.";H.error(Pe)}finally{U(!1),P(null)}},Xe=()=>{D||P(null)},Ze=f.useMemo(()=>{const ne=v.trim().toLowerCase();return[...d].sort((Pe,Te)=>{const he=Pe.createdAt?new Date(Pe.createdAt):0;return(Te.createdAt?new Date(Te.createdAt):0)-he}).filter(Pe=>{const Te=ne===""||Pe.title?.toLowerCase().includes(ne)||Pe.description?.toLowerCase().includes(ne)||Pe.assignedToName?.toLowerCase().includes(ne)||Pe.createdBy?.toLowerCase().includes(ne),he=y==="Filter by Status"||Pe.status===y,He=w==="Filter by Priority"||Pe.priority===w;return Te&&he&&He})},[d,v,y,w]);f.useEffect(()=>{A(1)},[v,y,w,n,E]),f.useEffect(()=>{if(n==="list"){const ne=Ze.length===0?1:Math.ceil(Ze.length/E);T>ne&&A(ne)}},[Ze.length,T,n,E]);const Je=f.useMemo(()=>{if(n==="board")return Ze;const ne=(T-1)*E;return Ze.slice(ne,ne+E)},[Ze,T,n,E]),Be=f.useMemo(()=>{const ne=new Date;return[{title:"To Do",value:d.filter(ae=>ae.status==="Not started").length,icon:zs,color:"text-blue-600",bgColor:"bg-blue-100"},{title:"In Progress",value:d.filter(ae=>ae.status==="In progress").length,icon:Yi,color:"text-purple-600",bgColor:"bg-purple-100"},{title:"Completed",value:d.filter(ae=>ae.status==="Completed").length,icon:Qa,color:"text-green-600",bgColor:"bg-green-100"},{title:"Overdue",value:d.filter(ae=>ae.dueDate&&new Date(ae.dueDate)<ne&&ae.status!=="Completed").length,icon:Fl,color:"text-red-600",bgColor:"bg-red-100"},{title:"High Priority",value:d.filter(ae=>ae.priority==="High").length,icon:ec,color:"text-orange-600",bgColor:"bg-orange-100"}]},[d]),_e=ne=>ne.dueDate&&new Date(ne.dueDate)<new Date&&ne.status!=="Completed",pe=ne=>{switch(ne.status){case"Not started":return"bg-blue-50 hover:bg-blue-100 border-blue-200";case"In progress":return"bg-purple-50 hover:bg-purple-100 border-purple-200";case"Deferred":return"bg-orange-50 hover:bg-orange-100 border-orange-200";case"Completed":return"bg-green-50 hover:bg-green-100 border-green-200";default:return"bg-gray-50 hover:bg-gray-100 border-gray-100"}},ce=ne=>{switch(ne){case"Not started":return"bg-blue-100 text-blue-700";case"In progress":return"bg-purple-100 text-purple-700";case"Deferred":return"bg-orange-100 text-orange-700";case"Completed":return"bg-green-100 text-green-700";default:return"bg-gray-100 text-gray-700"}},Q=ne=>{switch(ne){case"High":return"bg-red-100 text-red-700";case"Normal":return"bg-yellow-100 text-yellow-700";default:return"bg-gray-100 text-gray-700"}};return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 min-h-screen font-inter relative",children:[(p||t)&&a.jsx(Wt,{message:"Loading tasks..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 space-y-2 sm:space-y-0",children:[a.jsxs("h1",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[a.jsx(Yi,{className:"text-blue-600"})," Tasks Board"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{type:"button",onClick:()=>be(),className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 rounded-md hover:bg-gray-800 text-sm sm:text-base self-end sm:self-auto mt-2 lg:mt-0 cursor-pointer",children:[a.jsx(aa,{})," Create Task"]})})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 xl:grid-cols-5 gap-4 mb-6 w-full break-words overflow-hidden lg:overflow-visible",children:Be.map(ne=>a.jsx(dUe,{...ne},ne.title))}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mt-6 mb-4 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search tasks",value:v,onChange:ne=>j(ne.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row w-full lg:w-1/2 gap-2",children:[a.jsxs("select",{value:y,onChange:ne=>N(ne.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{children:"Filter by Status"}),y8.map(ne=>a.jsx("option",{children:ne},ne))]}),a.jsxs("select",{value:w,onChange:ne=>S(ne.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{children:"Filter by Priority"}),a.jsx("option",{children:"High"}),a.jsx("option",{children:"Normal"}),a.jsx("option",{children:"Low"})]})]})]}),a.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[a.jsx("button",{type:"button",onClick:()=>s("board"),className:`px-4 py-2 rounded-full text-sm ${n==="board"?"bg-gray-800 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Board View"}),a.jsx("button",{type:"button",onClick:()=>s("list"),className:`px-4 py-2 rounded-full text-sm ${n==="list"?"bg-gray-800 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"List View"})]}),!p&&!t&&n==="board"&&(Ze.length>0?a.jsxs(qx,{sensors:Ne,collisionDetection:Bx,onDragStart:fe,onDragEnd:we,onDragCancel:de,children:[a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4 rounded-md",children:y8.map(ne=>{const ae=Je.filter(Pe=>Pe.status===ne);return a.jsx(mUe,{column:ne,columnTasks:ae,getTaskCardColor:pe,isTaskOverdue:_e,formatDateDisplay:qA,handleOpenModal:be,handleArchiveTask:Ee,currentUser:e},ne)})}),a.jsx(EN,{children:q?a.jsx(hUe,{task:q,getTaskCardColor:pe,isTaskOverdue:_e,formatDateDisplay:qA}):null})]}):a.jsx("div",{className:"col-span-4 text-center py-10 text-gray-500 border border-dashed rounded-xl",children:"No tasks found."})),!p&&!t&&n==="list"&&a.jsx("div",{className:"bg-white rounded-md shadow-sm overflow-hidden",children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-gray-600 text-left",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 w-10",children:a.jsx("input",{type:"checkbox",className:"w-4 h-4 accent-blue-600",checked:We().length>0&&We().every(ne=>B.includes(ne.id)),onChange:tt})}),a.jsx("th",{className:"py-3 px-4 font-medium",children:"Task"}),a.jsx("th",{className:"py-3 px-4 font-medium",children:"Status"}),a.jsx("th",{className:"py-3 px-4 font-medium",children:"Priority"}),a.jsx("th",{className:"py-3 px-4 font-medium",children:"Assigned To"}),a.jsx("th",{className:"py-3 px-4 font-medium",children:"Date Assigned"}),a.jsx("th",{className:"py-3 px-4 font-medium text-center w-24",children:B.length>0?a.jsx("button",{onClick:Fe,className:"text-orange-600 hover:text-orange-800 transition p-1 rounded-full hover:bg-orange-50",title:`Archive ${B.length} selected tasks`,children:a.jsx(Zt,{size:18})}):""})]})}),a.jsx("tbody",{children:Je.length>0?Je.map(ne=>a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors text-sm cursor-pointer",children:[a.jsx("td",{className:"py-3 px-4",onClick:ae=>ae.stopPropagation(),children:String(ne.createdById)===String(e?.id)?a.jsx("input",{type:"checkbox",className:"w-4 h-4 accent-blue-600",checked:B.includes(ne.id),onChange:()=>lt(ne.id)}):null}),a.jsx("td",{className:"py-3 px-4 text-gray-700 whitespace-nowrap font-medium",onClick:()=>be(ne,!0),children:ne.title}),a.jsx("td",{className:"py-3 px-4 whitespace-nowrap",onClick:()=>be(ne,!0),children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium whitespace-nowrap ${ce(ne.status||"Not started")}`,children:ne.status||"Not started"})}),a.jsx("td",{className:"py-3 px-4 whitespace-nowrap",onClick:()=>be(ne,!0),children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium whitespace-nowrap ${Q(ne.priority||"Low")}`,children:ne.priority||"Low"})}),a.jsx("td",{className:"py-3 px-4 text-gray-700 whitespace-nowrap",onClick:()=>be(ne,!0),children:ne.assignedToName||"Unassigned"}),a.jsx("td",{className:`py-3 px-4 text-gray-700 whitespace-nowrap ${_e(ne)?"text-red-600 font-medium":""}`,onClick:()=>be(ne,!0),children:ne.dateAssigned?qA(ne.dateAssigned):""}),a.jsx("td",{})]},ne.id)):a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"text-center py-4 text-gray-500",children:"No tasks found."})})})]})})}),!p&&!t&&n==="list"&&a.jsx(ca,{className:"mt-6",totalItems:Ze.length,pageSize:E,currentPage:Ze.length===0?0:T,onPrev:()=>A(ne=>Math.max(ne-1,1)),onNext:()=>A(ne=>Math.min(ne+1,Math.max(1,Math.ceil(Ze.length/E)||1))),onPageSizeChange:ne=>{M(ne),A(1)},pageSizeOptions:[10,20,30,40,50],label:"tasks"}),a.jsx(v0,{isOpen:r,onClose:me,onSave:Ue,onEdit:()=>u(!1),setFormData:X,formData:je,isEditing:!c&&!!o,viewMode:c,users:_,currentUser:e,onDelete:Ee}),z&&a.jsx(uUe,{open:!0,title:z.title,message:z.message,confirmLabel:z.confirmLabel,cancelLabel:z.cancelLabel,variant:z.variant,onConfirm:st,onCancel:Xe,loading:D})]})}function dUe({icon:e,title:t,value:n,color:s,bgColor:r,onClick:i}){return a.jsxs("div",{className:"flex items-center p-4 bg-white rounded-xl shadow-md border border-gray-200 transition-all duration-300 cursor-default",onClick:i,children:[a.jsx("div",{className:`flex-shrink-0 p-3 rounded-full ${r} ${s} mr-4`,children:e?a.jsx(e,{size:22}):null}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:t}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:n})]})]})}function uUe({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r,variant:i,loading:o,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":i==="warning"?"bg-orange-500 hover:bg-orange-600 border border-orange-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsx("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${u}`,disabled:o,children:o?"Processing...":s})]})]})})}function mUe({column:e,columnTasks:t,getTaskCardColor:n,isTaskOverdue:s,formatDateDisplay:r,handleOpenModal:i,handleArchiveTask:o,currentUser:l}){const{isOver:c,setNodeRef:u}=Wx({id:e});return a.jsxs("div",{ref:u,className:`bg-white p-4 shadow border flex flex-col relative rounded-md transition-all duration-200 min-h-[200px] ${c?"border-blue-400 bg-blue-50 ring-2 ring-blue-300":"border-gray-200"}`,children:[a.jsx("div",{className:"absolute top-0 left-0 w-full h-5 bg-secondary rounded-t-md"}),a.jsxs("div",{className:"flex items-center justify-between mb-3 pt-7",children:[a.jsx("h3",{className:"font-medium text-gray-900",children:e}),a.jsx("span",{className:"text-xs bg-gray-100 px-2 py-1 rounded-full text-gray-500",children:t.length})]}),a.jsx("div",{className:`space-y-3 flex-1 ${t.length>3?"overflow-y-auto max-h-[480px] hide-scrollbar":""}`,children:t.length>0?t.map(d=>a.jsx(fUe,{task:d,getTaskCardColor:n,isTaskOverdue:s,formatDateDisplay:r,handleOpenModal:i,handleArchiveTask:o,currentUser:l},d.id)):a.jsx("div",{className:`text-center py-10 text-gray-500 border-2 border-dashed rounded-lg ${c?"border-blue-300 bg-blue-50":"border-gray-200"}`,children:c?"Drop here":"No tasks"})})]})}function fUe({task:e,getTaskCardColor:t,isTaskOverdue:n,formatDateDisplay:s,handleOpenModal:r,handleArchiveTask:i,currentUser:o}){const{attributes:l,listeners:c,setNodeRef:u,transform:d,isDragging:h}=Gx({id:e.id}),p=d?{transform:`translate3d(${d.x}px, ${d.y}px, 0)`}:void 0;return a.jsxs("div",{ref:u,style:p,className:`border rounded-lg p-3 transition flex justify-between items-start cursor-grab active:cursor-grabbing ${t(e)} ${h?"opacity-50 shadow-lg ring-2 ring-blue-400":""}`,...c,...l,children:[a.jsxs("div",{className:"text-left flex-1",onClick:x=>{x.stopPropagation(),r(e,!0)},children:[a.jsx("p",{className:"font-medium text-gray-800 text-sm",children:e.title}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Priority: ",e.priority]}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Assigned To: ",e.assignedToName]}),a.jsxs("p",{className:"text-xs mt-1 text-gray-500",children:["Date: ",a.jsx("span",{className:n(e)?"text-red-600":"text-gray-600",children:e.dateAssigned?s(e.dateAssigned):""})]})]}),a.jsx("div",{className:"flex items-center gap-2 ml-3",onClick:x=>x.stopPropagation(),children:(String(e.createdById)===String(o?.id)||o?.role!=="Sales")&&a.jsxs(a.Fragment,{children:[a.jsx("button",{type:"button",onClick:x=>{x.stopPropagation(),r(e)},className:"text-blue-500 hover:text-blue-700",children:a.jsx(hn,{})}),a.jsx("button",{type:"button",onClick:x=>{x.stopPropagation(),i(e)},className:"text-orange-500 hover:text-orange-700",children:a.jsx(Zt,{})})]})})]})}function hUe({task:e,getTaskCardColor:t,isTaskOverdue:n,formatDateDisplay:s}){return a.jsx("div",{className:`border rounded-lg p-3 shadow-xl ring-2 ring-blue-400 ${t(e)}`,style:{width:"280px"},children:a.jsxs("div",{className:"text-left flex-1",children:[a.jsx("p",{className:"font-medium text-gray-800 text-sm",children:e.title}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Priority: ",e.priority]}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Assigned To: ",e.assignedToName]}),a.jsxs("p",{className:"text-xs mt-1 text-gray-500",children:["Date: ",a.jsx("span",{className:n(e)?"text-red-600":"text-gray-600",children:e.dateAssigned?s(e.dateAssigned):""})]})]})})}const gJ=e=>e?e.toUpperCase():"",kb=e=>{const t=gJ(e);return t==="PLANNED"||t==="IN PROGRESS"?"PLANNED":t==="HELD"||t==="DONE"?"HELD":t==="NOT_HELD"||t==="NOT HELD"?"NOT_HELD":"PLANNED"},gUe=e=>{if(!e)return"";const t=String(e).split("-");return t.length===3?`${t[0]}-${t[2]}`:String(e)},pUe=e=>{if(!e)return"--";try{return new Date(e).toLocaleString()}catch{return"--"}},xUe=e=>{const t=gJ(e);switch(t==="PLANNED"?"PENDING":t==="HELD"?"COMPLETED":t==="NOT_HELD"?"CANCELLED":t){case"PENDING":return"bg-indigo-100 text-indigo-700";case"COMPLETED":case"DONE":return"bg-green-100 text-green-700";case"CANCELLED":return"bg-gray-200 text-gray-700";case"IN PROGRESS":return"bg-blue-100 text-blue-700";default:return"bg-gray-100 text-gray-700"}},GA={subject:"",startTime:"",endTime:"",location:"",status:"PLANNED",notes:"",assignedTo:"",relatedType1:"Lead",relatedTo1:"",relatedType2:null,relatedTo2:""},yUe=()=>{const e=kt(),t=ta(),{user:n}=Vt(),s=n?.role==="Sales",[r]=Bs(),i=r.get("id"),o=t.pathname==="/admin/meetings/info";f.useEffect(()=>{document.title="Meetings | Sari-Sari CRM"},[]);const[l,c]=f.useState([]),[u,d]=f.useState(!1),[h,p]=f.useState([]),[x,v]=f.useState(""),[j,y]=f.useState("Filter by Status"),[N,w]=f.useState(!1),[S,_]=f.useState(null),[k,T]=f.useState(1),[A,E]=f.useState(10),[M,z]=f.useState(GA),[P,D]=f.useState(!1),[U,B]=f.useState(null),[R,q]=f.useState(!1),[Z,V]=f.useState(null),[oe,je]=f.useState(!1),[X,se]=f.useState(null),[ye,Ne]=f.useState([]),[fe,we]=f.useState(null);f.useEffect(()=>{N&&!P&&s&&n&&!M.assignedTo&&z(Be=>({...Be,assignedTo:n.id}))},[N,P,n,s]),f.useEffect(()=>{const Be=t.state?.openMeetingModal,_e=t.state?.initialMeetingData?.relatedTo||r.get("id"),pe=t.state?.meetingID;Be||_e?(w(!0),t.state?.initialMeetingData&&z(ce=>({...ce,...t.state.initialMeetingData})),e(t.pathname,{replace:!0,state:{}})):pe&&(se(pe),e(t.pathname,{replace:!0,state:{}}))},[t,r,e]),f.useEffect(()=>{if(X&&l.length>0&&!u){const Be=l.find(_e=>_e.id===X);Be?_(Be):H.error("Meeting not found."),se(null)}},[X,l,u]);const de=async()=>{if(i&&o){const Be=sessionStorage.getItem("meetingDetailData");if(Be)try{const _e=JSON.parse(Be);if(_e.id===parseInt(i)){_(_e),sessionStorage.removeItem("meetingDetailData");return}}catch(_e){console.error(_e)}}d(!0);try{const Be=await re.get("/meetings/admin/fetch-all"),pe=[...Array.isArray(Be.data)?Be.data:[]].sort((ce,Q)=>{const ne=ce?.created_at?new Date(ce.created_at).getTime():0;return(Q?.created_at?new Date(Q.created_at).getTime():0)-ne});if(c(pe),i&&!S){const ce=pe.find(Q=>Q.id===parseInt(i));ce&&_(ce)}}catch{H.error("Failed to load meetings.")}finally{d(!1)}},ke=async()=>{try{const Be=await re.get("/users/all");p(Array.isArray(Be.data)?Be.data:[])}catch(Be){console.error(Be)}};f.useEffect(()=>{async function Be(){try{const _e=await re.get("/auth/me");we(_e.data)}catch(_e){console.error("Failed to fetch current user",_e)}}Be()},[]),f.useEffect(()=>{de(),ke()},[]);const ge=Be=>v(Be.target.value),$e=f.useMemo(()=>{const Be=x.trim().toLowerCase(),_e=j.trim().toUpperCase();return l.filter(pe=>{const ce=[pe?.activity,pe?.description,pe?.relatedTo,pe?.assignedTo],Q=Be===""||ce.some(ae=>ae&&ae.toString().toLowerCase().includes(Be)),ne=_e==="FILTER BY STATUS"||kb(pe.status||"PENDING")===_e;return Q&&ne})},[l,x,j]),be=f.useMemo(()=>{const Be=(k-1)*A;return $e.slice(Be,Be+A)},[$e,k,A]),me=()=>{w(!1),z(GA),D(!1),B(null),q(!1)},Ue=()=>{z(GA),D(!1),B(null),w(!0)},Ee=Be=>{let _e="";if(Be.meet_assign_to?.id)_e=String(Be.meet_assign_to.id);else if(Be.assignedTo){const He=h.find(qe=>`${qe.first_name} ${qe.last_name}`===Be.assignedTo);_e=He?String(He.id):""}const pe=He=>{if(!He)return"";try{const qe=new Date(He),nt=qe.getTimezoneOffset()*6e4;return new Date(qe.getTime()-nt).toISOString().slice(0,16)}catch{return""}};let ce="Lead",Q="",ne="Contact",ae="";if(Be.lead)ce="Lead",Q=String(Be.lead.id);else if(Be.account)ce="Account",Q=String(Be.account.id),Be.contact?(ne="Contact",ae=String(Be.contact.id)):Be.deal?(ne="Deal",ae=String(Be.deal.id)):Be.quote&&(ne="Quote",ae=String(Be.quote.id));else if(Be.relatedType||Be.related_type){const He=Be.relatedType||Be.related_type,qe=Be.related_to||Be.relatedToId;He==="Lead"?(ce="Lead",Q=String(qe)):(ce="Account",Q=Be.account_id?String(Be.account_id):"")}const Pe={PLANNED:"Planned",HELD:"Held",NOT_HELD:"Not held"},Te=kb(Be.status),he=Pe[Te]||"Planned";z({subject:Be.subject||Be.activity||"",location:Be.location||"",startTime:pe(Be.start_time||Be.startTime),endTime:pe(Be.end_time||Be.endTime),status:he,notes:Be.description||Be.notes||"",assignedTo:_e,relatedType1:ce,relatedTo1:Q,relatedType2:ne,relatedTo2:ae}),D(!0),B(Be.id),_(null),w(!0)},We=Be=>{if(!Be.subject?.trim())return H.error("Subject is required.");if(!Be.startTime)return H.error("Start time is required.");if(Be.endTime&&!(new Date(Be.endTime)-new Date(Be.startTime)>0))return H.error("End time must be after start time.");Be.relatedType1,Be.relatedTo1,Be.relatedType1==="Account"&&Be.relatedType2&&Be.relatedTo2&&(Be.relatedType2,Be.relatedTo2);const _e={...Be,assignedTo:parseInt(Be.assignedTo),relatedTo1:parseInt(Be.relatedTo1),relatedTo2:parseInt(Be.relatedTo2)},pe=P&&U?"update":"create";V({title:pe==="create"?"Confirm New Meeting":"Confirm Update",message:`Are you sure you want to ${pe} "${_e.subject}"?`,confirmLabel:pe==="create"?"Create Meeting":"Update Meeting",variant:"primary",action:{type:pe,payload:_e,targetId:U,name:_e.subject}})},tt=async()=>{if(!Z?.action)return;const{type:Be,payload:_e,targetId:pe,name:ce}=Z.action;je(!0);try{Be==="create"?(q(!0),await re.post("/meetings/create",_e),H.success(`Meeting "${ce}" created.`),me(),await de()):Be==="update"?(q(!0),await re.put(`/meetings/${pe}`,_e),H.success(`Meeting "${ce}" updated.`),me(),await de()):Be==="delete"?(await re.delete(`/meetings/${pe}`),H.success(`Meeting "${ce}" archived.`),S?.id===pe&&_(null),await de()):Be==="bulk-delete"&&(await re.post("/meetings/sales/bulk-delete",{meeting_ids:Z.action.meetingIds}),H.success(`Successfully archived ${Z.action.meetingIds.length} meeting(s)`),Ne([]),await de())}catch(Q){const ne=Q.response?.data?.detail||"Action failed.";H.error(typeof ne=="string"?ne:JSON.stringify(ne)),console.error(ne)}finally{q(!1),je(!1),V(null)}},lt=Be=>{Xe("single")},Fe=()=>{const Be=be.filter(_e=>_e.created_by===fe?.id);ye.length===Be.length&&Be.length>0?Ne([]):Ne(Be.map(_e=>_e.id))},st=Be=>{Ne(_e=>_e.includes(Be)?_e.filter(pe=>pe!==Be):[..._e,Be])},Xe=Be=>{if(Be==="single"){const _e=S.subject||"this meeting";V({title:"Archive Meeting",message:`Are you sure you want to archive "${_e}"?`,confirmLabel:"Archive Meeting",cancelLabel:"Cancel",variant:"archive",action:{type:"delete",targetId:S.id,name:_e}})}else if(Be==="bulk"){if(ye.length===0)return;V({title:"Archive Meetings",message:a.jsxs("span",{children:["Are you sure you want to archive"," ",a.jsx("span",{className:"font-semibold",children:ye.length})," selected meetings?"]}),confirmLabel:`Archive ${ye.length} meeting(s)`,cancelLabel:"Cancel",variant:"archive",action:{type:"bulk-delete",meetingIds:ye}})}},Ze=()=>{Xe("bulk")},Je=async(Be,_e)=>{try{await re.put(`/meetings/${Be}`,{status:_e}),H.success("Status updated"),de(),_(null)}catch{H.error("Failed to update status")}};return o&&i?S?a.jsx(Nd,{meeting:S,onClose:()=>{_(null),e("/admin/dashboard")},onEdit:Ee,onDelete:lt,onStatusUpdate:Je,currentUser:fe,isSalesView:!0}):a.jsx(Wt,{message:"Loading meeting..."}):a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[u&&a.jsx(Wt,{message:"Loading meetings..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h1",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800 mb-4 lg:mb-0",children:[a.jsx(Ot,{className:"mr-2 text-blue-600"})," Meetings"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{onClick:Ue,className:"bg-black text-white px-4 py-2 rounded-md flex items-center hover:bg-gray-800",children:[a.jsx(aa,{className:"mr-2"})," Add Meeting"]})})]}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full sm:w-auto lg:w-4/4 md:w-3/4",children:[a.jsx(Kt,{className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search meetings",value:x,onChange:ge,className:"w-full outline-none"})]}),a.jsxs("select",{value:j,onChange:Be=>y(Be.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm bg-white w-full sm:w-auto",children:[a.jsx("option",{children:"Filter by Status"}),a.jsx("option",{value:"PLANNED",children:"PLANNED"}),a.jsx("option",{value:"HELD",children:"HELD"}),a.jsx("option",{value:"NOT_HELD",children:"NOT HELD"})]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[500px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm mb-4",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 text-center w-12",children:a.jsx("input",{type:"checkbox",checked:be.length>0&&be.filter(Be=>Be.created_by===fe?.id).every(Be=>ye.includes(Be.id))&&be.some(Be=>Be.created_by===fe?.id),onChange:Fe,className:"form-checkbox h-4 w-4 text-blue-600 rounded focus:ring-blue-500 border-gray-300"})}),a.jsx("th",{className:"py-3 px-4",children:"Subject"}),a.jsx("th",{className:"py-3 px-4",children:"Related To"}),a.jsx("th",{className:"py-3 px-4",children:"Start Time"}),a.jsx("th",{className:"py-3 px-4",children:"Assigned"}),a.jsx("th",{className:"py-3 px-4",children:"Status"}),a.jsx("th",{className:"py-3 px-4 text-center w-24",children:ye.length>0?a.jsx("button",{onClick:Ze,className:"text-orange-600 hover:text-orange-800 transition p-1 rounded-full hover:bg-orange-50",title:`Archive ${ye.length} selected meetings`,children:a.jsx(Zt,{size:18})}):""})]})}),a.jsx("tbody",{children:be.length>0?be.map(Be=>a.jsxs("tr",{onClick:()=>_(Be),className:"hover:bg-gray-50 cursor-pointer border-b border-gray-100",children:[a.jsx("td",{className:"py-3 px-4 text-center",onClick:_e=>_e.stopPropagation(),children:fe&&Be.created_by===fe.id?a.jsx("input",{type:"checkbox",checked:ye.includes(Be.id),onChange:()=>st(Be.id),className:"form-checkbox h-4 w-4 text-blue-600 rounded focus:ring-blue-500 border-gray-300",onClick:_e=>_e.stopPropagation()}):null}),a.jsx("td",{className:"py-3 px-4 font-medium text-blue-600",children:Be.subject}),a.jsxs("td",{className:"py-3 px-4",children:[Be.lead&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:Be.lead.title}),Be.account&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:Be.account.name}),Be.contact&&a.jsxs("p",{className:"font-medium text-blue-500 text-xs",children:[Be.contact.first_name," ",Be.contact.last_name]}),Be.deal&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:Be.deal.name}),Be.quote&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:gUe(Be.quote.quote_id)})]}),a.jsx("td",{className:"py-3 px-4",children:pUe(Be.start_time)}),a.jsxs("td",{className:"py-3 px-4",children:[Be.meet_assign_to.first_name," ",Be.meet_assign_to.last_name]}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${xUe(kb(Be.status))}`,children:kb(Be.status).replace("_"," ")})}),a.jsx("td",{className:"py-3 px-4"})]},Be.id)):a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"text-center py-4 text-gray-500",children:"No meetings found."})})})]})}),a.jsx(ca,{totalItems:$e.length,pageSize:A,currentPage:k,onPrev:()=>T(Be=>Math.max(1,Be-1)),onNext:()=>T(Be=>Be+1),onPageSizeChange:Be=>{E(Be),T(1)},pageSizeOptions:[10,20,30,40,50],label:"meetings"}),N&&a.jsx(k1,{onClose:me,formData:M,setFormData:z,isEditing:P,onSubmit:We,isSubmitting:R||oe,users:h,currentUser:n}),S&&a.jsx(Nd,{meeting:S,onClose:()=>_(null),onEdit:Ee,onDelete:lt,onStatusUpdate:Je,currentUser:fe,isSalesView:!0}),Z&&a.jsx(bUe,{open:!0,title:Z.title,message:Z.message,confirmLabel:Z.confirmLabel,variant:Z.variant,onConfirm:tt,onCancel:()=>V(null),loading:oe})]})};function bUe({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":i==="archive"?"bg-orange-500 hover:bg-orange-600 border border-orange-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{onClick:c,disabled:o,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",children:"Cancel"}),a.jsx("button",{onClick:l,disabled:o,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70
                       ${u}`,children:o?"...":s})]})]})})}const vUe=[{value:"PLANNED",label:"PLANNED"},{value:"HELD",label:"HELD"},{value:"NOT_HELD",label:"NOT HELD"}],wUe=e=>e?String(e).toUpperCase():"",hf=e=>{const t=wUe(e);return t==="PLANNED"||t==="PENDING"?"PLANNED":t==="HELD"||t==="COMPLETED"?"HELD":t==="NOT HELD"||t==="NOT_HELD"||t==="CANCELLED"?"NOT_HELD":"PLANNED"},WA=e=>{const t=hf(e);return t==="PLANNED"?"PLANNED":t==="HELD"?"HELD":t==="NOT_HELD"?"NOT HELD":"--"},v8=e=>{switch(hf(e)){case"PLANNED":return"bg-indigo-100 text-indigo-700";case"HELD":return"bg-green-100 text-green-700";case"NOT_HELD":return"bg-gray-200 text-gray-700";default:return"bg-gray-100 text-gray-700"}},VA=e=>{if(!e)return"";const t=String(e).split("-");return t.length===3?`${t[0]}-${t[2]}`:String(e)},w8=e=>e?new Date(e).toLocaleString("en-US",{month:"2-digit",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}):"--";function jUe(){const[e,t]=f.useState(!1),[n,s]=f.useState(null),[r,i]=f.useState(null),[o,l]=f.useState(null),[c,u]=f.useState(null),[d,h]=f.useState([]),[p,x]=f.useState(null),[v,j]=f.useState(!1),[y,N]=f.useState(null),[w,S]=f.useState(!1),[_,k]=f.useState(!1),[T,A]=f.useState("PLANNED"),[E,M]=f.useState(!1),[z,P]=f.useState(!1),[D,U]=f.useState(1),[B,R]=f.useState(10),[q,Z]=f.useState(null),[V,oe]=f.useState([]),[je,X]=f.useState(null),{comments:se,addComment:ye,refresh:Ne}=kn({relatedType:"call",relatedId:n?.id});f.useEffect(()=>{n?.id&&Ne()},[n?.id,Ne]),Bs();const fe=kt(),we=ta(),{user:de}=Vt(),ke=de?.role==="Sales",$e={subject:"",call_time:(()=>{const xe=new Date,ve=xe.getFullYear(),Oe=String(xe.getMonth()+1).padStart(2,"0"),Ce=String(xe.getDate()).padStart(2,"0");return`${ve}-${Oe}-${Ce}T08:00`})(),duration_minutes:"",direction:"Outgoing",status:"Planned",notes:"",relatedType1:"Lead",relatedType2:null,relatedTo1:null,relatedTo2:null,assigned_to:null},[be,me]=f.useState($e);f.useEffect(()=>{e&&!v&&ke&&de&&!be.assigned_to&&me(xe=>({...xe,assigned_to:de.id}))},[e,v,de,ke]),f.useEffect(()=>{const xe=we.state,ve=xe?.callID;if(ve&&!xe?.openCallModal){Z(ve),fe(we.pathname,{replace:!0,state:{}});return}!xe?.openCallModal||!xe?.initialCallData||xe.initialCallData.relatedType1==="Lead"&&Array.isArray(o)&&o.length===0||xe.initialCallData.relatedType1==="Account"&&(!Array.isArray(o)||o.length===0)||(t(!0),me(Oe=>({...Oe,...xe.initialCallData,relatedTo1:xe.initialCallData.relatedTo1?String(xe.initialCallData.relatedTo1):"",relatedTo2:xe.initialCallData.relatedTo2?String(xe.initialCallData.relatedTo2):""})),fe(we.pathname,{replace:!0,state:{}}))},[we.state,o]),f.useEffect(()=>{if(q&&d.length>0&&!z){const xe=d.find(ve=>ve.id===q);xe?s(xe):H.error("Call not found."),Z(null)}},[q,d,z]);const Ue=async()=>{try{P(!0);const xe=await re.get("/calls/admin/fetch-all"),Oe=[...Array.isArray(xe.data)?xe.data:[]].sort((Ce,Qe)=>{const G=Ce?.created_at?new Date(Ce.created_at):0;return(Qe?.created_at?new Date(Qe.created_at):0)-G});h(Oe)}catch(xe){console.error("Error fetching calls:",xe),H.error("Failed to load calls")}finally{P(!1)}},Ee=async()=>{try{const xe=await re.get("/users/all");x(xe.data)}catch(xe){console.error("Error fetching users: ",xe)}};f.useEffect(()=>{async function xe(){try{const ve=await re.get("/auth/me");X(ve.data)}catch(ve){console.error("Failed to fetch current user",ve)}}xe()},[]),f.useEffect(()=>{Ee(),Ue()},[]);const We=[],tt="",lt="Filter by Status",Fe="Filter by Users",st=d,Xe=f.useMemo(()=>{const xe=(D-1)*B;return st.slice(xe,xe+B)},[st,D,B]),Ze=d.length,Je=d.filter(xe=>hf(xe.status)==="PLANNED").length,Be=d.filter(xe=>hf(xe.status)==="HELD").length,_e=d.filter(xe=>hf(xe.status)==="NOT_HELD").length,pe=[{title:"Total",value:Ze,icon:Fs,color:"text-slate-600",bgColor:"bg-slate-100"},{title:"Planned",value:Je,icon:zs,color:"text-indigo-600",bgColor:"bg-indigo-100"},{title:"Held",value:Be,icon:Qa,color:"text-green-600",bgColor:"bg-green-100"},{title:"Not Held",value:_e,icon:Us,color:"text-gray-600",bgColor:"bg-gray-100"}],[ce,Q]=f.useState("Overview"),ne=xe=>{const{name:ve,value:Oe}=xe.target;me(Ce=>{const Qe={...Ce,[ve]:Oe};return ve==="relatedType1"&&(Qe.relatedTo1="",Oe==="Lead"?(Qe.relatedType2=null,Qe.relatedTo2=null,u([])):Oe==="Account"&&(Qe.relatedType2="Contact")),ve==="relatedType2"&&(Qe.relatedTo2=""),Qe})};f.useEffect(()=>{const xe=async()=>{try{l([]);let ve;be.relatedType1==="Lead"?ve=await re.get("/leads/admin/getLeads"):be.relatedType1==="Account"&&(ve=await re.get("/accounts/admin/fetch-all"));let Oe=[];if(ve&&Array.isArray(ve.data)?Oe=ve.data:Oe=[],v&&be.relatedTo1)try{let Ce;be.relatedType1==="Lead"?Ce=await re.get(`/leads/get/${be.relatedTo1}`):be.relatedType1==="Account"&&(Ce=await re.get(`/accounts/get/${be.relatedTo1}`)),Ce&&Ce.data&&(Oe.some(G=>String(G.id)===String(be.relatedTo1))||(Oe=[Ce.data,...Oe]))}catch(Ce){console.error("Error fetching specific related item:",Ce)}l(Oe)}catch(ve){console.error("Error fetching data:",ve),l([])}};be.relatedType1&&xe()},[be.relatedType1,v,be.relatedTo1]),f.useEffect(()=>{const xe=async()=>{try{u([]);let ve;if(be.relatedType1==="Account"&&be.relatedTo1)be.relatedType2==="Contact"?ve=await re.get(`/contacts/from-acc/${be.relatedTo1}`):be.relatedType2==="Deal"?ve=await re.get(`/deals/from-acc/${be.relatedTo1}`):be.relatedType2==="Quote"&&(ve=await re.get(`/quotes/from-acc/${be.relatedTo1}`));else{u([]);return}ve&&Array.isArray(ve.data)?u(ve.data):u([])}catch(ve){console.error("Error fetching data:",ve),u([])}};be.relatedType2&&xe()},[be.relatedType2,be.relatedTo1,be.relatedType1]);const[ae,Pe]=f.useState(!1),Te=xe=>{xe.preventDefault(),Pe(!0);const ve=be.subject;if(!ve||ve.trim()===""){H.error("Subject is required.");return}if(!be.relatedTo1){H.error(`Please select a ${be.relatedType1||"Lead/Account"}.`);return}if(!be.assigned_to){H.error("Subject is required.");return}const Ce={...be,duration_minutes:be.duration_minutes?parseInt(be.duration_minutes,10):null,relatedTo1:be.relatedTo1?parseInt(be.relatedTo1,10):null,relatedTo2:be.relatedType1==="Lead"?null:be.relatedTo2?parseInt(be.relatedTo2,10):null,relatedType2:be.relatedType1==="Lead"?null:be.relatedType2,assigned_to:be.assigned_to?parseInt(be.assigned_to,10):null},Qe=v&&y?"update":"create",G=(be.subject||"").trim()||"Untitled Call";i({title:Qe==="create"?"Confirm New Call":"Confirm Update",message:Qe==="create"?`Create "${G}"?`:`Save changes to "${G}"?`,confirmLabel:Qe==="create"?"Create Call":"Update Call",cancelLabel:"Cancel",variant:"primary",action:{type:Qe,payload:Ce,targetId:y||null,name:G}})},he=xe=>s(xe),He=()=>{t(!1),j(!1),N(null)},qe=async()=>{if(!r?.action){i(null);return}const{action:xe}=r,{type:ve,payload:Oe,targetId:Ce,name:Qe,callIds:G}=xe;k(!0);try{if(ve==="bulk-delete")await re.post("/calls/bulk-delete",{call_ids:G}),H.success(`Successfully archived ${G.length} call(s).`),oe([]),await Ue();else if(ve==="create")S(!0),await re.post("/calls/create",Oe),H.success(`Call "${Qe}" created successfully.`),t(!1),me($e),j(!1),N(null),await Ue();else if(ve==="update"){if(!Ce)throw new Error("Missing call identifier for update.");S(!0),await re.put(`/calls/${Ce}`,Oe),H.success(`Call "${Qe}" updated successfully.`),t(!1),me($e),j(!1),N(null),await Ue()}else if(ve==="delete"){if(!Ce)throw new Error("Missing call identifier for archival.");await re.delete(`/calls/${Ce}`),H.success(`Call "${Qe}" archived successfully.`),n?.id===Ce&&s(null),await Ue()}}catch(W){const J=ve==="create"?"Failed to create call. Please review the details and try again.":ve==="update"?"Failed to update call. Please review the details and try again.":"Failed to archive call. Please try again.",Y=W?.response?.data?.detail||J;H.error(Y)}finally{(ve==="create"||ve==="update")&&S(!1),k(!1),i(null)}},nt=()=>{_||i(null)},ot=async()=>{if(n?.id)try{M(!0),await re.put(`/calls/${n.id}`,{status:T}),H.success(`Status updated to ${WA(T)}`),h(xe=>Array.isArray(xe)?xe.map(ve=>ve.id===n.id?{...ve,status:T}:ve):xe),s(null)}catch(xe){const ve=xe.response?.data?.detail||"Failed to update status.";H.error(ve)}finally{M(!1)}},Re=()=>{const xe=Xe.filter(ve=>ve.call_creator?.id===je?.id);V.length===xe.length&&xe.length>0?oe([]):oe(xe.map(ve=>ve.id))},it=xe=>{oe(ve=>ve.includes(xe)?ve.filter(Oe=>Oe!==xe):[...ve,xe])},St=xe=>{if(xe==="single"){const ve=n.subject||"this call";i({title:"Archive Call",message:`Are you sure you want to archive "${ve}"? This call will be hidden from your view but admins can still see it.`,confirmLabel:"Archive Call",cancelLabel:"Cancel",variant:"warning",action:{type:"delete",targetId:n.id,name:ve}})}else if(xe==="bulk"){if(V.length===0)return;i({title:"Archive Calls",message:a.jsxs("span",{children:["Are you sure you want to archive"," ",a.jsx("span",{className:"font-semibold",children:V.length})," selected calls? These calls will be hidden from your view but admins can still see them."]}),confirmLabel:`Archive ${V.length} call(s)`,cancelLabel:"Cancel",variant:"warning",action:{type:"bulk-delete",callIds:V}})}},Et=()=>{St("bulk")};f.useEffect(()=>{n&&A(hf(n.status))},[n]);const Tt=n?a.jsxs("div",{id:"callModalBackdrop",onClick:xe=>xe.target.id==="callModalBackdrop"&&s(null),className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center p-4",children:[z&&a.jsx(Wt,{message:"Loading call details..."}),a.jsxs("div",{className:"bg-white rounded-xl shadow-lg w-full max-w-full lg:max-w-4xl max-h-[95vh] overflow-y-auto hide-scrollbar relative box-border",children:[a.jsxs("div",{className:"bg-tertiary w-full rounded-t-xl p-3 lg:p-3 relative",children:[a.jsx("h1",{className:"lg:text-3xl text-xl text-white font-semibold text-center w-full",children:"Calls"}),a.jsx("button",{onClick:()=>s(null),className:"text-gray-500 hover:text-white transition cursor-pointer absolute top-3 right-3",children:a.jsx(Ja,{size:25})})]}),a.jsx("div",{className:"mt-4 gap-2 px-2 lg:gap-4 lg:mx-7",children:a.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between lg:flex-row lg:items-center lg:justify-between mt-3 gap-2 px-2 md:items-center lg:gap-4 md:mx-7 lg:mx-7",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[a.jsx("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-800",children:n.subject}),a.jsx("span",{className:`text-xs sm:text-sm font-medium px-2 sm:px-3 py-1 rounded-full ${v8(n.status)}`,children:WA(n.status)})]}),a.jsx("div",{className:"flex flex-col sm:flex-row sm:space-x-3 space-y-2 sm:space-y-0",children:n.call_creator?.id===je?.id&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{className:"inline-flex items-center justify-center w-full sm:w-auto bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 transition text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",onClick:()=>{const xe=G=>{if(!G)return"";const W=new Date(G),J=W.getFullYear(),Y=String(W.getMonth()+1).padStart(2,"0"),F=String(W.getDate()).padStart(2,"0"),ue=String(W.getHours()).padStart(2,"0"),De=String(W.getMinutes()).padStart(2,"0");return`${J}-${Y}-${F}T${ue}:${De}`},ve=n.lead?"Lead":n.account?"Account":"Lead",Oe=n.lead?n.lead.id:n.account?n.account.id:null,Ce=ve==="Lead"?null:n.contact?"Contact":n.deal?"Deal":n.quote?"Quote":"Contact",Qe=ve==="Lead"?null:n.contact?n.contact.id:n.deal?n.deal.id:n.quote?n.quote.id:null;me({subject:n.subject||"",call_time:xe(n.call_time),duration_minutes:n.duration_minutes?String(n.duration_minutes):"",direction:n.direction||"Outgoing",status:n.status||"Planned",notes:n.notes||"",relatedType1:ve,relatedType2:Ce,relatedTo1:Oe?String(Oe):"",relatedTo2:Qe?String(Qe):"",assigned_to:n.call_assign_to?.id?String(n.call_assign_to.id):""}),j(!0),N(n.id),s(null),t(!0)},children:[a.jsx(gn,{className:"mr-2"}),"Edit"]}),a.jsxs("button",{className:"inline-flex items-center justify-center w-full sm:w-auto px-4 py-2 rounded-md text-sm bg-orange-500 text-white hover:bg-orange-600 transition focus:outline-none focus:ring-2 focus:ring-orange-400",onClick:()=>St("single"),children:[a.jsx(Zt,{className:"mr-2"}),"Archive"]})]})})]})}),a.jsx("div",{className:"border-b border-gray-200 my-5"}),a.jsxs("div",{className:"p-6 lg:p-4",children:[a.jsx("div",{className:"flex w-full bg-[#6A727D] text-white mt-1 overflow-x-auto mb-6",children:["Overview","Notes"].map(xe=>a.jsx("button",{onClick:()=>Q(xe),className:`flex-1 min-w-[90px] px-4 py-2.5 text-xs sm:text-sm font-medium border-b-2 ${ce===xe?"bg-paper-white text-[#6A727D] border-white":"text-white hover:bg-[#5c636d]"}`,children:xe},xe))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 items-start",children:[a.jsxs("div",{className:"lg:col-span-3",children:[ce==="Overview"&&a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 md:p-8 border border-gray-200",children:a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4 sm:gap-6 text-sm text-gray-700",children:[a.jsx(po,{label:"Call Time",value:w8(n.call_time)}),a.jsx(po,{label:"Duration",value:n.duration_minutes?`${n.duration_minutes} min`:null}),a.jsx(po,{label:"Direction",value:n.direction||"--"}),a.jsx(po,{label:"Assigned To",value:`${n.call_assign_to.first_name} ${n.call_assign_to.last_name}`}),n.lead&&a.jsx(po,{label:"Lead",value:n.lead.title}),n.account&&a.jsx(po,{label:"Account",value:n.account.name}),n.contact&&a.jsx(po,{label:"Contact",value:`${n.contact.first_name} ${n.contact.last_name}`}),n.deal&&a.jsx(po,{label:"Deal",value:n.deal.name}),n.quote&&a.jsx(po,{label:"Quote",value:VA(n.quote.quote_id)}),a.jsx(po,{label:"Created At",value:w8(n.created_at)})]})}),ce==="Notes"&&a.jsxs("div",{className:"mt-4 w-full",children:[a.jsx("div",{className:"flex flex-wrap items-center justify-between mb-4 gap-2",children:a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words",children:"Call Note"})}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 shadow-sm break-words",children:[a.jsx("div",{className:"flex items-start justify-between",children:a.jsx("div",{children:a.jsx("p",{className:"text-sm font-medium text-gray-800 break-words",children:"Note"})})}),a.jsx("div",{className:"mt-3 text-sm text-gray-700 whitespace-pre-wrap break-words",children:n.notes||"No notes available."})]}),a.jsx(Tn,{comments:se,onAddComment:ye})]})]}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm w-full",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Status"}),a.jsxs("select",{className:"border border-gray-200 rounded-md px-2 py-1.5 w-full text-sm mb-2",value:T,onChange:xe=>A(xe.target.value),children:[a.jsx("option",{value:"PLANNED",children:"PLANNED"}),a.jsx("option",{value:"HELD",children:"HELD"}),a.jsx("option",{value:"NOT_HELD",children:"NOT HELD"})]}),a.jsx("button",{onClick:ot,disabled:E,className:"w-full py-1.5 rounded-md text-sm bg-gray-900 text-white hover:bg-gray-800 disabled:opacity-50",children:E?"Updating...":"Update"})]})]})]})]})]}):null,Nt=e?a.jsx("div",{id:"modalBackdrop",onClick:xe=>xe.target.id==="modalBackdrop"&&He(),className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-xl rounded-2xl shadow-lg p-4 sm:p-6 md:p-8 relative border border-gray-200 overflow-y-auto max-h-[90vh] hide-scrollbar",children:[a.jsx("button",{onClick:()=>{He(),Pe(!1)},className:"absolute top-4 right-4 text-gray-500 hover:text-black transition",children:a.jsx(ea,{size:22})}),a.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800 mb-4 sm:mb-6 flex items-center justify-center",children:v?"Edit Call":"Add New Call"}),a.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 w-full gap-4 text-sm",onSubmit:Te,noValidate:!0,children:[a.jsx(CUe,{label:"Subject",className:"md:col-span-2",name:"subject",value:be.subject,onChange:ne,isSubmitted:ae,required:!0}),a.jsxs("div",{className:"w-full flex flex-col",children:[a.jsxs("div",{className:"relative w-25",children:[a.jsxs("select",{name:"relatedType1",onChange:ne,value:be.relatedType1,className:"outline-none cursor-pointer mb-1 w-22 text-gray-700 disabled:text-gray-400 disabled:cursor-not-allowed",disabled:w,children:[a.jsx("option",{value:"Lead",children:"Lead"}),a.jsx("option",{value:"Account",children:"Account"})]}),a.jsx("span",{className:"absolute left-10 md:pl-6 pl-6 top-1/2 -translate-y-1/2 text-red-500 pointer-events-none",children:"*"})]}),a.jsx(YA,{items:Array.isArray(o)?o:[],value:be.relatedTo1??"",placeholder:`Search ${be.relatedType1||"here"}...`,getLabel:xe=>be.relatedType1==="Lead"?xe.title:xe.name??"",onChange:xe=>me(ve=>({...ve,relatedTo1:xe})),required:!0,isSubmitted:ae,disabled:w})]}),a.jsxs("div",{className:"w-full flex flex-col",children:[a.jsxs("select",{name:"relatedType2",onChange:ne,value:be.relatedType2??"Contact",className:"text-gray-700 outline-none cursor-pointer mb-1 w-22 disabled:text-gray-400 disabled:cursor-not-allowed",disabled:be.relatedType1==="Lead"||w,children:[a.jsx("option",{value:"Contact",children:"Contact"}),a.jsx("option",{value:"Deal",children:"Deal"}),a.jsx("option",{value:"Quote",children:"Quote"})]}),a.jsx(YA,{disabled:be.relatedType1==="Lead"||w,items:Array.isArray(c)?c:[],value:be.relatedTo2??"",placeholder:be.relatedType1==="Lead"?"":Array.isArray(c)&&c.length>0?`Search ${be.relatedType2||"Contact"}...`:`No ${be.relatedType2||""} data found`,getLabel:xe=>be.relatedType2==="Contact"?`${xe.first_name??""} ${xe.last_name??""}`.trim():be.relatedType2==="Quote"?VA(xe.quote_id)??"":xe.name??"",onChange:xe=>me(ve=>({...ve,relatedTo2:xe}))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Call Time"}),a.jsx("input",{type:"datetime-local",value:be.call_time,onChange:ne,name:"call_time",className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100"})]}),a.jsxs("div",{className:"w-full",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Duration"}),a.jsxs("div",{className:"w-full rounded-md text-sm flex flex-row items-center justify-start",children:[a.jsx("input",{type:"tel",value:be.duration_minutes,onChange:ne,name:"duration_minutes",className:"border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100 w-44 mr-3"}),a.jsx("p",{children:"minutes"})]})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:["Assign To ",a.jsx("span",{className:"text-red-600 font-semibold",children:"*"})]}),a.jsx(YA,{items:Array.isArray(p)?p:[],value:be.assigned_to??"",placeholder:"Search an account...",getLabel:xe=>`${xe.first_name} ${xe.last_name}`,onChange:xe=>me(ve=>({...ve,assigned_to:xe})),disabled:ke,required:!0,isSubmitted:ae})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Direction"}),a.jsxs("select",{name:"direction",onChange:ne,value:be.direction,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100",children:[a.jsx("option",{value:"Incoming",children:"Incoming"}),a.jsx("option",{value:"Outgoing",children:"Outgoing"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Status"}),a.jsxs("select",{name:"status",onChange:ne,value:be.status,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100",children:[a.jsx("option",{value:"Planned",children:"Planned"}),a.jsx("option",{value:"Held",children:"Held"}),a.jsx("option",{value:"Not held",children:"Not held"})]})]}),a.jsx(SUe,{className:"col-span-2",label:"Notes",value:be.notes,onChange:ne,name:"notes"}),a.jsxs("div",{className:"flex flex-col md:flex-row justify-end col-span-2 mt-4 gap-2 w-full",children:[a.jsx("button",{type:"button",onClick:()=>{He(),Pe(!1)},className:"w-full sm:w-auto px-4 py-2 text-white bg-red-400 border border-red-300 rounded hover:bg-red-500 transition",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:w,className:"w-full sm:w-auto px-4 py-2 text-white bg-tertiary border border-tertiary rounded hover:bg-secondary transition",children:w?"Saving...":v?"Update Call":"Save Call"})]})]})]})}):null;return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h1",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(Fs,{className:"mr-2 text-blue-600"})," Calls"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{onClick:()=>{me($e),j(!1),N(null),t(!0),Pe(!1)},className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 my-1 lg:my-0 rounded-md hover:bg-gray-800 text-sm sm:text-base mx-auto sm:ml-auto cursor-pointer",children:[a.jsx(aa,{className:"mr-2"})," Add Call"]})})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-4 mb-6 w-full break-words overflow-hidden lg:overflow-visible",children:pe.map(xe=>a.jsx(NUe,{...xe},xe.title))}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center gap-3",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search calls",className:"focus:outline-none text-base w-full",defaultValue:tt})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row w-full lg:w-1/2 gap-2",children:[a.jsxs("select",{defaultValue:lt,className:"border border-gray-300 rounded-lg px-3 h-11 text-sm bg-white w-full",children:[a.jsx("option",{value:"Filter by Status",children:"Filter by Status"}),vUe.map(xe=>a.jsx("option",{value:xe.value,children:xe.label},xe.value))]}),a.jsxs("select",{defaultValue:Fe,className:"border border-gray-300 rounded-lg px-3 h-11 text-sm bg-white w-full",children:[a.jsx("option",{value:"Filter by Users",children:"Filter by Users"}),We.map(xe=>a.jsx("option",{value:xe.name,children:xe.name},xe.id))]})]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[500px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm mb-4",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 text-center w-12",children:a.jsx("input",{type:"checkbox",checked:Xe.length>0&&Xe.filter(xe=>xe.call_creator?.id===je?.id).every(xe=>V.includes(xe.id))&&Xe.some(xe=>xe.call_creator?.id===je?.id),onChange:Re,className:"form-checkbox h-4 w-4 text-blue-600 rounded focus:ring-blue-500 border-gray-300"})}),a.jsx("th",{className:"py-3 px-4",children:"Subject"}),a.jsx("th",{className:"py-3 px-4",children:"Related To"}),a.jsx("th",{className:"py-3 px-4",children:"Call Time"}),a.jsx("th",{className:"py-3 px-4",children:"Assigned To"}),a.jsx("th",{className:"py-3 px-4",children:"Status"}),a.jsx("th",{className:"py-3 px-4 text-center w-24",children:V.length>0?a.jsx("button",{onClick:Et,className:"text-orange-600 hover:text-orange-800 transition p-1 rounded-full hover:bg-orange-50",title:`Archive ${V.length} selected calls`,children:a.jsx(Zt,{size:18})}):""})]})}),a.jsx("tbody",{children:z?a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"py-10",children:a.jsx(Wt,{message:"Loading calls..."})})}):Xe.length>0?Xe.map(xe=>a.jsxs("tr",{onClick:()=>he(xe),className:"hover:bg-gray-50 cursor-pointer border-b border-gray-100",children:[a.jsx("td",{className:"py-3 px-4 align-top text-center",onClick:ve=>ve.stopPropagation(),children:xe.call_creator?.id===je?.id?a.jsx("input",{type:"checkbox",checked:V.includes(xe.id),onChange:()=>it(xe.id),className:"form-checkbox h-4 w-4 text-blue-600 rounded focus:ring-blue-500 border-gray-300",onClick:ve=>ve.stopPropagation()}):null}),a.jsx("td",{className:"py-3 px-4 text-blue-600 font-medium",children:xe.subject||"--"}),a.jsxs("td",{className:"py-3 px-4",children:[xe.lead&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:xe.lead.title}),xe.account&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:xe.account.name}),xe.contact&&a.jsxs("p",{className:"font-medium text-blue-500 text-xs",children:[xe.contact.first_name," ",xe.contact.last_name]}),xe.deal&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:xe.deal.name}),xe.quote&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:VA(xe.quote.quote_id)})]}),a.jsx("td",{className:"py-3 px-4 text-gray-800",children:xe.call_time?new Date(xe.call_time).toLocaleString():"--"}),a.jsx("td",{className:"py-3 px-4 text-gray-800",children:xe?.call_assign_to?`${xe.call_assign_to.first_name} ${xe.call_assign_to.last_name}`:"--"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${v8(xe.status)}`,children:WA(xe.status)})}),a.jsx("td",{})]},xe.id)):a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"text-center py-4 text-gray-500",children:"No calls found."})})})]})}),a.jsx(ca,{totalItems:st.length,pageSize:B,currentPage:D,onPrev:()=>U(xe=>Math.max(xe-1,1)),onNext:()=>U(xe=>Math.min(xe+1,Math.max(1,Math.ceil(st.length/B)||1))),onPageSizeChange:xe=>{R(xe),U(1)},pageSizeOptions:[10,20,30,40,50],label:"calls"})]}),Tt,Nt,r&&a.jsx(_Ue,{open:!0,title:r.title,message:r.message,confirmLabel:r.confirmLabel,variant:r.variant,onConfirm:qe,onCancel:nt,loading:_})]})}function NUe({icon:e,title:t,value:n,color:s,bgColor:r}){return a.jsxs("div",{className:"flex items-center p-4 bg-white rounded-xl shadow-md border border-gray-200 transition-all duration-300",children:[a.jsx("div",{className:`p-3 rounded-full ${r} ${s} mr-4`,children:a.jsx(e,{size:22})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:t}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:n})]})]})}function CUe({label:e,name:t,value:n,onChange:s,placeholder:r="",type:i="text",required:o=!1,disabled:l=!1,isSubmitted:c=!1,className:u=""}){const d=c&&o&&!n;return a.jsxs("div",{className:u,children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",o&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:i,name:t,value:n??"",onChange:s,placeholder:r,disabled:l,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border focus:ring-2 disabled:bg-gray-100
          ${d?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}
        `})]})}function SUe(e){return a.jsxs("div",{className:e.className,children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e.label}),a.jsx("textarea",{...e,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100 resize-none"})]})}function po({label:e,value:t}){return a.jsxs("p",{children:[a.jsxs("span",{className:"font-semibold",children:[e,":"]})," ",a.jsx("br",{}),a.jsx("span",{className:"break-words",children:t||"--"})]})}function _Ue({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o=!1,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="warning"?"bg-orange-500 hover:bg-orange-600 border border-orange-400":i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsx("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${u}`,disabled:o,children:o?"Processing...":s})]})]})})}function YA({items:e=[],value:t="",onChange:n,getLabel:s,placeholder:r="Search...",disabled:i=!1,maxRender:o=200,required:l=!1,isSubmitted:c=!1}){const[u,d]=f.useState(!1),[h,p]=f.useState(""),x=f.useRef(null),v=e.find(w=>String(w.id)===String(t)),j=v?s(v):"",y=l&&c&&!t,N=f.useMemo(()=>{const w=h.trim().toLowerCase();return(w?e.filter(_=>(s(_)||"").toLowerCase().includes(w)):e).slice(0,o)},[e,h,s,o]);return f.useEffect(()=>{const w=S=>{x.current&&!x.current.contains(S.target)&&d(!1)};return document.addEventListener("mousedown",w),()=>document.removeEventListener("mousedown",w)},[]),f.useEffect(()=>{u||p("")},[u]),a.jsxs("div",{ref:x,className:"relative w-full",children:[a.jsx("input",{disabled:i,value:u?h:j,placeholder:r,onFocus:()=>!i&&d(!0),onChange:w=>{p(w.target.value),u||d(!0)},className:`w-full border rounded-md px-2 py-1.5 text-sm outline-none focus:ring-2 disabled:bg-gray-100
          ${y?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}`}),u&&!i&&a.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg overflow-hidden",children:[a.jsx("div",{className:"max-h-56 overflow-y-auto",children:N.length>0?N.map(w=>{const S=String(w.id),_=s(w),k=String(t)===S;return a.jsx("button",{type:"button",onClick:()=>{n(S),d(!1)},className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-50 ${k?"bg-blue-50":""}`,children:_||"--"},S)}):a.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No results"})}),e.length>o&&a.jsxs("div",{className:"px-3 py-2 text-[11px] text-gray-400 border-t",children:["Showing first ",o," results  keep typing to narrow."]})]})]})}function AUe({toggleSidebar:e}){const[t,n]=f.useState(!1),[s,r]=f.useState(!1),[i,o]=f.useState([]),[l,c]=f.useState(0),u=f.useRef(null),d=f.useRef(null),h=ta(),p=kt(),{logout:x}=Ks(),{user:v,fetchUser:j}=Vt(),N={"/manager/dashboard":"Dashboard","/manager/accounts":"Accounts","/manager/contacts":"Contacts","/reports":"Reports","/leads":"Leads","/manager/Audit":"Audit","/manager/targets":"Targets","/manager/leads":"Leads","/manager/quotes":"Quotes","/manager/users":"Users","/manager/deals":"Deals"}[h.pathname]||"Manager Panel";return f.useEffect(()=>{j()},[]),f.useEffect(()=>{const w=()=>j();return window.addEventListener("userProfileUpdated",w),()=>window.removeEventListener("userProfileUpdated",w)},[j]),f.useEffect(()=>{if(!v?.id)return;const w=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1",S=window.location.protocol==="https:"?"wss:":"ws:",_=w?"localhost:8000":window.location.host,k=`${S}//${_}/ws/notifications?user_id=${v.id}`,T=new WebSocket(k);return T.onmessage=A=>{const E=JSON.parse(A.data);o(M=>[E,...M]),c(M=>M+1)},()=>T.close()},[v?.id]),f.useEffect(()=>{function w(S){u.current&&!u.current.contains(S.target)&&n(!1),d.current&&!d.current.contains(S.target)&&r(!1)}return document.addEventListener("mousedown",w),()=>document.removeEventListener("mousedown",w)},[]),a.jsxs("header",{className:"flex justify-between items-center bg-white shadow px-4 sm:px-6 py-3 border-b relative z-50",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("button",{onClick:e,className:"lg:hidden text-gray-700 hover:text-gray-900",children:a.jsx(th,{className:"text-2xl"})}),a.jsx("h1",{className:"text-lg font-semibold text-gray-800",children:N})]}),a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs("div",{className:"relative",ref:d,children:[a.jsxs("button",{onClick:()=>r(!s),className:"relative text-gray-600 hover:text-gray-800 transition",children:[a.jsx(mx,{className:"text-xl"}),l>0&&a.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-[10px] w-4 h-4 flex items-center justify-center rounded-full font-semibold",children:l})]}),s&&a.jsxs("div",{className:"absolute right-0 mt-3 w-80 bg-white rounded-xl shadow-lg border z-50 overflow-hidden animate-in fade-in slide-in-from-top-2 duration-200",children:[a.jsxs("div",{className:"p-3 border-b bg-gray-50 flex justify-between items-center",children:[a.jsx("h3",{className:"font-semibold text-gray-800 text-sm",children:"Notifications"}),a.jsx("button",{onClick:()=>{o([]),c(0)},className:"text-xs text-blue-600 hover:underline",children:"Clear All"})]}),a.jsx("div",{className:"max-h-60 overflow-y-auto",children:i.length>0?i.map((w,S)=>a.jsx("div",{className:"p-3 border-b text-sm hover:bg-gray-50 cursor-pointer transition",children:w.title||w.message||"New Notification"},S)):a.jsx("div",{className:"p-4 text-center text-gray-500 text-xs",children:"No notifications"})})]})]}),a.jsxs("div",{className:"relative",ref:u,children:[a.jsxs("button",{onClick:()=>n(!t),className:"flex items-center gap-2 cursor-pointer hover:bg-gray-100 px-2 py-1 rounded transition",children:[a.jsx("img",{src:v?.profile_picture||"https://via.placeholder.com/40",alt:"Profile",className:"w-8 h-8 object-cover rounded-full border border-gray-200"}),a.jsxs("span",{className:"hidden lg:inline text-sm font-medium text-gray-700",children:[v?.first_name," ",v?.last_name]})]}),t&&a.jsxs("div",{className:"absolute right-0 mt-2 w-64 bg-white shadow-xl rounded-xl border border-gray-200 z-50 p-4 animate-in fade-in slide-in-from-top-2 duration-200",children:[a.jsxs("div",{className:"flex flex-col items-center text-center space-y-3",children:[a.jsx("img",{src:v?.profile_picture||"https://via.placeholder.com/80",alt:"Profile Large",className:"w-16 h-16 rounded-full object-cover border-2 border-gray-100"}),a.jsxs("div",{children:[a.jsxs("h2",{className:"text-gray-800 font-semibold text-sm",children:[v?.first_name," ",v?.middle_name," ",v?.last_name]}),a.jsx("p",{className:"text-[11px] text-gray-600 font-light w-full truncate",children:"Manager"})]})]}),a.jsxs("div",{className:"mt-6 space-y-1 px-2",children:[a.jsx("button",{onClick:()=>{p("/manager/users"),n(!1)},className:"block w-full text-sm text-gray-700 hover:bg-gray-50 p-2 rounded text-left transition",children:"Invite Your Team"}),a.jsx("button",{onClick:()=>{p("/manager/manage-account"),n(!1)},className:"block w-full text-sm text-gray-700 hover:bg-gray-50 p-2 rounded text-left transition",children:"Manage Your Account"}),a.jsx("div",{className:"border-t border-gray-100 my-2"}),a.jsx("button",{onClick:x,className:"block w-full text-sm text-red-600 hover:bg-red-50 p-2 rounded text-left transition font-medium",children:"Logout"})]})]})]})]})]})}function TUe(){const[e,t]=f.useState(!1),[n,s]=f.useState(!1),[r,i]=f.useState(!1),[o,l]=f.useState(!1),c=ta(),{user:u}=Vt();f.useEffect(()=>{u&&console.log("Fetched user:",u)},[u]),f.useEffect(()=>{document.title="Panel | Sari-Sari CRM"},[]);const d="flex items-center gap-3 px-3 py-2 rounded-lg bg-white text-[#1e293b] font-semibold shadow-sm",h="flex items-center gap-3 px-3 py-2 rounded-lg text-gray-300 hover:bg-[#334155] hover:text-white transition";return["/manager/accounts","/manager/contacts","/manager/leads","/manager/deals","/manager/quotes","/manager/targets","/manager/meetings","/manager/manage-account"].includes(c.pathname),a.jsxs("div",{className:"flex h-screen bg-gray-100 overflow-hidden",children:[a.jsxs("div",{className:`fixed top-0 left-0 h-screen w-64 bg-[#1e293b] text-white flex flex-col shadow-lg transform transition-transform duration-300 z-50
          ${o?"translate-x-0":"-translate-x-full"} lg:translate-x-0`,children:[a.jsxs("div",{className:"px-4 py-3 bg-[#fbbf24] leading-none",children:[a.jsxs("p",{className:"text-gray-900 font-bold text-lg m-0 p-0",children:[" Sari-Sari.CRM"," ",a.jsx("span",{className:"text-[12px] text-gray-700 font-medium align-bottom",children:"v2"})]}),u&&u.company&&a.jsx("p",{className:"text-[12px] text-gray-600 font-medium w-full truncate",children:u.company.company_name})]}),a.jsxs("nav",{className:"flex-1 overflow-y-auto p-4 space-y-2 hide-scrollbar",children:[a.jsxs(Ft,{to:"/manager/dashboard",className:({isActive:x})=>x?d:h,children:[a.jsx(eh,{className:"text-lg"}),a.jsx("span",{children:"Dashboard"})]}),a.jsxs("div",{children:[a.jsxs("button",{className:"w-full px-3 py-2 flex justify-between items-center text-sm font-medium text-gray-300 hover:bg-[#334155] rounded-lg transition",onClick:()=>t(!e),children:[a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx(sa,{className:"text-lg"}),"Sales"]}),a.jsx(Pt,{className:`transition-transform ${e?"rotate-180":""}`})]}),e&&a.jsxs("div",{className:"ml-6 mt-2 space-y-1",children:[a.jsxs(Ft,{to:"/manager/accounts",className:({isActive:x})=>x?d:h,children:[a.jsx(ac,{})," Accounts"]}),a.jsxs(Ft,{to:"/manager/contacts",className:({isActive:x})=>x?d:h,children:[a.jsx(ra,{})," Contacts"]}),a.jsxs(Ft,{to:"/manager/leads",className:({isActive:x})=>x?d:h,children:[a.jsx(Xa,{})," Leads"]}),a.jsxs(Ft,{to:"/manager/deals",className:({isActive:x})=>x?d:h,children:[a.jsx(sa,{})," Deals"]}),a.jsxs(Ft,{to:"/manager/quotes",className:({isActive:x})=>x?d:h,children:[a.jsx(ia,{})," Quotes"]}),a.jsxs(Ft,{to:"/manager/targets",className:({isActive:x})=>x?d:h,children:[a.jsx(fr,{})," Targets"]})]})]}),a.jsxs("div",{children:[a.jsxs("button",{className:"w-full px-3 py-2 flex justify-between items-center text-sm font-medium text-gray-300 hover:bg-[#334155] rounded-lg transition",onClick:()=>s(!n),children:[a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx(ks,{className:"text-lg"}),"Activity"]}),a.jsx(Pt,{className:`transition-transform ${n?"rotate-180":""}`})]}),n&&a.jsxs("div",{className:"ml-6 mt-2 space-y-1",children:[a.jsxs(Ft,{to:"/manager/tasks",className:({isActive:x})=>x?d:h,children:[a.jsx(Qt,{})," Tasks"]}),a.jsxs(Ft,{to:"/manager/meetings",className:({isActive:x})=>x?d:h,children:[a.jsx(Ot,{})," Meetings"]}),a.jsxs(Ft,{to:"/manager/calls",className:({isActive:x})=>x?d:h,children:[a.jsx(Fs,{})," Calls"]}),a.jsxs(Ft,{to:"/manager/audit",className:({isActive:x})=>x?d:h,children:[a.jsx(ks,{})," Audit"]})]})]}),a.jsx("div",{children:a.jsx(Ft,{to:"/manager/territory",className:({isActive:x})=>x?d:h,children:a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx(tc,{className:"text-lg"}),"Territory"]})})}),a.jsxs("div",{children:[a.jsxs("button",{className:"w-full px-3 py-2 flex justify-between items-center text-sm font-medium text-gray-300 hover:bg-[#334155] rounded-lg transition",onClick:()=>i(!r),children:[a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx(SL,{className:"text-lg"}),"Settings"]}),a.jsx(Pt,{className:`transition-transform ${r?"rotate-180":""}`})]}),r&&a.jsxs("div",{className:"ml-6 mt-2 space-y-1",children:[a.jsxs(Ft,{to:"/manager/users",className:({isActive:x})=>x?d:h,children:[a.jsx(Za,{})," Users"]}),a.jsxs(Ft,{to:"/manager/manage-account",className:({isActive:x})=>x?d:h,children:[a.jsx(ra,{})," Your Profile"]})]})]})]}),a.jsxs("div",{className:"px-4 py-3 text-xs text-gray-400 border-t border-gray-700",children:[" ",new Date().getFullYear()," Sari-Sari CRM"]})]}),o&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 lg:hidden",onClick:()=>l(!1)}),a.jsxs("div",{className:"flex-1 flex flex-col lg:ml-64 overflow-hidden",children:[a.jsx(AUe,{toggleSidebar:()=>l(!o)}),a.jsx("main",{className:"flex-1 p-6 overflow-auto hide-scrollbar",style:{backgroundColor:"#fffeee"},children:a.jsx(Xf,{})})]})]})}const kUe=e=>a.jsx(Kt,{...e}),EUe=e=>a.jsx(ac,{...e}),pJ=e=>a.jsx(zs,{...e}),LUe=e=>a.jsx(ux,{...e}),PUe=e=>a.jsx(hj,{...e}),DUe=e=>a.jsx(Ot,{...e}),OUe=e=>a.jsx(It,{...e}),MUe=e=>a.jsx(pj,{...e}),xJ=e=>a.jsx(gj,{...e}),IUe=e=>a.jsx(Za,{...e}),yJ=e=>a.jsx(ra,{...e}),$Ue=e=>a.jsx(Xa,{...e}),bJ=e=>a.jsx(sa,{...e}),RUe=e=>a.jsx(ia,{...e}),vJ=e=>a.jsx(fr,{...e}),zUe=e=>a.jsx(Qa,{...e}),FUe=e=>a.jsx(Ot,{...e}),UUe=e=>a.jsx(Fs,{...e}),BUe=e=>a.jsx(tc,{...e}),HUe=e=>a.jsx(ks,{...e}),wJ=(e,t="")=>{const n=parseFloat(e)||0;return new Intl.NumberFormat("en-US",{notation:"compact",compactDisplay:"short",maximumFractionDigits:1}).format(n).replace(/^/,`${t} `)},qUe=e=>{switch(e){case"Negotiation":return{text:"text-purple-700",bg:"bg-purple-100"};case"Proposal":return{text:"text-red-700",bg:"bg-red-100"};case"Qualification":return{text:"text-yellow-700",bg:"bg-yellow-100"};case"Prospecting":return{text:"text-blue-700",bg:"bg-blue-100"};case"Closed Won":return{text:"text-green-700",bg:"bg-green-100"};case"Closed Lost":return{text:"text-red-700",bg:"bg-red-100"};default:return{text:"text-gray-700",bg:"bg-gray-100"}}},GUe=e=>{switch(e){case"Website":return{text:"text-green-600",bg:"bg-green-100"};case"Referral":return{text:"text-purple-600",bg:"bg-purple-100"};case"Trade Show":return{text:"text-orange-600",bg:"bg-orange-100"};case"Cold Call":return{text:"text-red-600",bg:"bg-red-100"};default:return{text:"text-gray-600",bg:"bg-gray-100"}}},WUe=e=>{switch(e){case"call":return{Icon:OUe,color:"text-red-500",bgColor:"bg-red-100"};case"qualification":return{Icon:MUe,color:"text-green-600",bgColor:"bg-green-100"};default:return{Icon:DUe,color:"text-blue-500",bgColor:"bg-blue-100"}}},VUe=e=>{switch(e.toUpperCase()){case"HIGH":return{text:"text-red-700",bg:"bg-red-100"};case"LOW":return{text:"text-blue-700",bg:"bg-blue-100"};default:return{text:"text-gray-700",bg:"bg-gray-100"}}},YUe=({searchQuery:e,onSearchChange:t,searchResults:n,onSearchResultClick:s})=>{const r=kt(),[i,o]=f.useState(!1),l=f.useRef(null),c=[{icon:EUe,label:"Account"},{icon:yJ,label:"Contact"},{icon:$Ue,label:"Leads"},{icon:bJ,label:"Deals"},{icon:RUe,label:"Quotes"},{icon:vJ,label:"Target"},{icon:zUe,label:"Task"},{icon:FUe,label:"Meeting"},{icon:UUe,label:"Call"},{icon:HUe,label:"Audit"},{icon:BUe,label:"Territory"}];f.useEffect(()=>{const h=p=>{l.current&&!l.current.contains(p.target)&&o(!1)};return document.addEventListener("mousedown",h),()=>document.removeEventListener("mousedown",h)},[]);const u=h=>{t(h.target.value),o(h.target.value.trim().length>0)},d=h=>{s&&s(h),o(!1)};return a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-3 sm:p-4 flex flex-col items-start space-y-4 w-full",children:[a.jsxs("div",{className:"w-full flex justify-center relative",ref:l,children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg lg:mt-3 px-4 py-2 w-full max-w-md md:max-w-lg lg:max-w-2xl focus-within:ring-2 focus-within:ring-blue-500 transition duration-150",children:[a.jsx(kUe,{size:20,className:"text-gray-400 mr-3 flex-shrink-0"}),a.jsx("input",{type:"text",placeholder:"Search Leads, Deals, or Accounts...",className:"focus:outline-none text-base w-full",value:e,onChange:u,onFocus:()=>e.trim().length>0&&o(!0)})]}),i&&Array.isArray(n)&&n.length>0&&a.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 mt-2 w-full max-w-md md:max-w-lg lg:max-w-2xl bg-white rounded-lg shadow-xl border border-gray-200 z-50 max-h-96 overflow-y-auto",children:n.map((h,p)=>a.jsx("div",{className:"px-4 py-3 hover:bg-gray-50 cursor-pointer border-b border-gray-100 last:border-b-0 transition duration-150",onClick:()=>d(h),children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-semibold text-gray-800 text-sm",children:h.name}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:h.type}),h.details&&a.jsx("p",{className:"text-xs text-gray-400 mt-1",children:h.details})]}),a.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${h.type==="Lead"?"bg-blue-100 text-blue-600":h.type==="Deal"?"bg-yellow-100 text-yellow-600":"bg-green-100 text-green-600"}`,children:h.type})]})},p))}),i&&e.trim().length>0&&(!Array.isArray(n)||n.length===0)&&a.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 mt-2 w-full max-w-md md:max-w-lg lg:max-w-2xl bg-white rounded-lg shadow-xl border border-gray-200 z-50 p-4 text-center text-sm text-gray-500",children:"No results found"})]}),a.jsx("div",{className:"w-full overflow-x-auto lg:overflow-x-hidden scroll-smooth flex justify-center",children:a.jsx("div",{className:"flex flex-nowrap space-x-3 lg:space-x-4 xl:space-x-3 px-2 sm:px-0",children:c.map((h,p)=>a.jsxs("div",{className:"relative flex-shrink-0 group",children:[a.jsx("button",{className:"p-3 text-gray-500 hover:text-gray-900 transition duration-150 rounded-full hover:bg-gray-100 focus:outline-none cursor-pointer","aria-label":h.label,title:h.label,onClick:()=>{switch(h.label){case"Account":r("/manager/accounts");break;case"Contact":r("/manager/contacts");break;case"Leads":r("/manager/leads");break;case"Deals":r("/manager/deals");break;case"Quotes":r("/manager/quotes");break;case"Target":r("/manager/targets");break;case"Task":r("/manager/tasks");break;case"Meeting":r("/manager/meetings");break;case"Call":r("/manager/calls");break;case"Audit":r("/manager/audit");break;case"Territory":r("/manager/territory");break;default:console.log(`Clicked ${h.label}`)}},children:a.jsx(h.icon,{size:24,className:"lg:scale-95"})}),a.jsxs("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 px-3 py-1.5 bg-gray-900 text-white text-xs font-semibold rounded-md whitespace-nowrap opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-75 ease-in-out z-50 shadow-lg",children:[h.label,a.jsx("div",{className:"absolute top-full left-1/2 -translate-x-1/2 -mt-1 border-4 border-transparent border-t-gray-900"})]})]},p))})})]})},QUe=({action:e,description:t,entity_type:n,entity_name:s,timestamp:r})=>{const i=kt(),o=d=>{if(!d)return"Unknown";const h=new Date(d),x=new Date-h,v=Math.floor(x/6e4),j=Math.floor(x/36e5),y=Math.floor(x/864e5);return v<1?"Just now":v<60?`${v} min ago`:j<24?`${j} hour${j>1?"s":""} ago`:y<7?`${y} day${y>1?"s":""} ago`:h.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},l=e||t||"Action",c=s||n||"System",u=o(r);return a.jsxs("li",{className:"flex justify-between items-center py-2 border-b border-gray-100 last:border-b-0 cursor-pointer hover:bg-gray-50 transition duration-150 px-2 -mx-2 rounded-md",onClick:()=>i("/manager/audit"),children:[a.jsxs("p",{className:"text-sm text-gray-800 flex-grow font-medium",children:[l," ",a.jsxs("span",{className:"text-gray-500 italic text-xs",children:["(",c,")"]})]}),a.jsx("span",{className:"text-xs text-gray-400 flex-shrink-0 ml-4",children:u})]})},KUe=({logs:e,loading:t})=>{const n=kt();return a.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg border border-gray-100 flex flex-col h-full",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h2",{className:"text-md font-semibold text-gray-800",children:"Recent Logs"}),a.jsxs("span",{className:"text-sm text-blue-500 cursor-pointer hover:underline flex items-center space-x-1 font-medium",onClick:()=>n("/manager/audit"),children:[a.jsx("span",{children:"See All"}),a.jsx(xJ,{size:14,className:"transform -rotate-45"})]})]}),e&&e.length>0?a.jsx("ul",{className:"space-y-1",children:e.slice(0,3).map((s,r)=>a.jsx(QUe,{...s},r))}):a.jsx("div",{className:"text-sm text-gray-500 py-4",children:"No recent logs"})]})},XUe=({icon:e,title:t,value:n,color:s,bgColor:r,loading:i,onClick:o})=>a.jsxs("div",{className:"flex items-center p-4 bg-white rounded-xl shadow-md border border-gray-200 transition-all duration-300",onClick:o||(()=>console.log(`Clicked metric card: ${t}`)),children:[a.jsx("div",{className:`p-3 rounded-full ${r} ${s} mr-4`,children:a.jsx(e,{size:20})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-500 font-medium uppercase",children:t}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:n||0})]})]}),ZUe=({revenueData:e,loading:t})=>{const n=kt(),s=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],r=f.useMemo(()=>{if(console.log("=== RevenueChart calculateRevenueData ==="),console.log("revenueData:",e),console.log("revenueData length:",e?.length),!e||e.length===0){console.log("No revenue data, returning empty chart");const y=new Date;y.getFullYear();const N=y.getMonth(),w=[],S=[];for(let _=0;_<=N;_++)w.push(s[_]),S.push(0);return{labels:w,revenues:S,maxRevenue:0}}const l={};let c=0,u=0;console.log("Processing deals:",e.length),e.forEach((y,N)=>{const w=y.close_date||y.closeDate||null,S=w&&w!==null&&w!=="",_=y.stage||"",k=_.toUpperCase()==="CLOSED_WON"||_==="CLOSED_WON";let T=y.amount;T&&typeof T=="object"&&T.toString?T=parseFloat(T.toString()):T=parseFloat(T)||0;const A=T>0;if(k&&(u++,console.log(`Deal ${N+1} (CLOSED_WON):`,{id:y.id,name:y.name,stage:_,close_date:w,close_date_type:typeof w,amount:T,amount_type:typeof y.amount,hasCloseDate:S,hasAmount:A,willBeAdded:S&&A,allFields:Object.keys(y)})),S&&k&&A)try{let E=new Date(w);if(isNaN(E.getTime())){const M=String(w).split("T")[0];E=new Date(M+"T00:00:00")}if(isNaN(E.getTime()))console.warn(` Invalid date for deal ${y.id}:`,w,"Type:",typeof w);else{const M=E.getFullYear(),z=E.getMonth()+1,P=`${M}-${String(z).padStart(2,"0")}`;l[P]||(l[P]=0),l[P]+=T,c++,console.log(` Added deal ${y.id} to month ${P}: ${T}, total: ${l[P]}`),console.log(`  - Close date: ${w} -> Parsed: ${E.toISOString()} -> Month: ${P} (Year: ${M}, Month: ${z})`)}}catch(E){console.error("Error parsing deal date:",w,E)}else k&&console.warn(` Deal ${y.id} is CLOSED_WON but missing data:`,{hasCloseDate:S,hasAmount:A,closeDate:w,amount:T,originalAmount:y.amount})}),console.log("Summary:",{totalDeals:e.length,closedWonDeals:u,validDealsForGraph:c,monthlyRevenue:l});const d=Object.keys(l).map(y=>parseInt(y.split("-")[0])),h=d.length>0?[...new Set(d)].sort():[],p=new Date().getFullYear();new Date().getMonth();const x=[],v=[];for(let y=0;y<12;y++){const N=`${p}-${String(y+1).padStart(2,"0")}`;x.push(s[y]);const w=l[N]||0;v.push(w),w>0&&console.log(`Month ${s[y]} (${N}): ${w}`)}if(h.length>0){const y=Math.max(...h);if(y>p)for(let N=p+1;N<=y;N++)for(let w=0;w<12;w++){const S=`${N}-${String(w+1).padStart(2,"0")}`,_=l[S]||0;x.push(`${s[w]} ${N}`),v.push(_),_>0&&console.log(`Month ${s[w]} ${N} (${S}): ${_}`)}}const j=Math.max(...v,1);return console.log("Final chart data:",{labels:x,revenues:v,maxRevenue:j,hasData:v.some(y=>y>0)}),{labels:x,revenues:v,maxRevenue:j}},[e]),i=r.labels,o=r.revenues;return console.log("=== FINAL CHART DATA ==="),console.log("X Axis (Months):",i),console.log("Y Axis (Revenue):",o),console.log("Has any revenue > 0:",o.some(l=>l>0)),console.log("All revenue values:",o),console.log("Max revenue:",r.maxRevenue),a.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg h-full flex flex-col",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Revenue Overview"}),a.jsxs("span",{className:"text-sm text-blue-500 cursor-pointer hover:underline flex items-center space-x-1 font-medium",onClick:()=>n("/manager/deals"),children:[a.jsx("span",{children:"See All"}),a.jsx(xJ,{size:14,className:"transform -rotate-45"})]})]}),a.jsx("div",{className:"h-80 relative flex-1 flex items-center justify-center p-6",children:a.jsx("div",{className:"w-full h-full flex items-center justify-center",children:i&&i.length>0&&o&&o.length>0?a.jsx(lh,{xAxis:[{data:i,scaleType:"point"}],yAxis:[{valueFormatter:l=>l>=1e3?`${(l/1e3).toFixed(0)}k`:l.toString()}],series:[{data:o,showMark:!0,area:!0}],height:320,width:void 0,grid:{vertical:!0,horizontal:!0},margin:{top:40,right:40,bottom:50,left:50},sx:{width:"100%",maxWidth:"100%"}}):a.jsxs("div",{className:"text-center text-gray-500",children:[a.jsx("p",{className:"text-sm",children:"No revenue data available"}),a.jsx("p",{className:"text-xs mt-2",children:"Closed won deals with close dates will appear here"})]})})})]})},QA=({title:e,items:t,children:n,onSeeAll:s})=>{const r=kt(),i=()=>{if(s)s();else{const o={"Latest Leads":"/manager/leads","Latest Deals":"/manager/deals","Upcoming Activities":"/manager/tasks"};o[e]&&r(o[e])}};return a.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg flex flex-col",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:e}),a.jsx("span",{className:"text-sm text-blue-500 cursor-pointer hover:underline",onClick:i,children:"See All"})]}),n]})},JUe=({first_name:e,last_name:t,company_name:n,source:s,created_at:r,id:i})=>{const o=kt(),{text:l,bg:c}=GUe(s||"Website"),u=x=>{if(!x)return"Unknown";const v=new Date(x),y=new Date-v,N=Math.floor(y/6e4),w=Math.floor(y/36e5),S=Math.floor(y/864e5);return N<60?`${N} min ago`:w<24?v.toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}):S<7?v.toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}):v.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})},d=`${e||""} ${t||""}`.trim()||"Unknown",h=n||"Unknown Company",p=u(r);return a.jsx("div",{className:"py-3 border-b border-gray-100 last:border-b-0 cursor-pointer hover:bg-gray-50 transition duration-150 px-2 -mx-2 rounded-md",onClick:()=>i&&o(`/manager/leads/${i}`),children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-gray-800",children:d}),a.jsx("p",{className:"text-xs text-gray-500",children:h})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"text-xs text-gray-400",children:p}),a.jsx("span",{className:`inline-block mt-1 text-xs font-medium ${l} ${c} px-2 py-0.5 rounded-full`,children:s||"Website"})]})]})})},e7e=({name:e,amount:t,account:n,stage:s,created_at:r,id:i,previousAmount:o,currencySymbol:l})=>{const c=kt(),d={PROSPECTING:"Prospecting",QUALIFICATION:"Qualification",PROPOSAL:"Proposal",NEGOTIATION:"Negotiation",CLOSED_WON:"Closed Won",CLOSED_LOST:"Closed Lost"}[s]||s||"Unknown",{text:h,bg:p}=qUe(d),x=parseFloat(t||0),v=o?x>=o?"up":"down":"up",j=v==="up"?LUe:PUe,y=v==="up"?"text-green-400":"text-red-400",N=n?.name||"Unknown Company";return a.jsx("div",{className:"py-3 border-b border-gray-100 last:border-b-0 cursor-pointer hover:bg-gray-50 transition duration-150 px-2 -mx-2 rounded-md",onClick:()=>i&&c(`/manager/deals/info?id=${i}`),children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{className:"flex-shrink",children:[a.jsx("p",{className:"font-semibold text-sm text-gray-900",children:e||"Unnamed Deal"}),a.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:N}),a.jsx("span",{className:`inline-block mt-1 text-xs font-medium ${h} ${p} px-2 py-0.5 rounded-full`,children:d})]}),a.jsxs("div",{className:"text-right flex flex-col items-end flex-shrink-0",children:[a.jsx("p",{className:"text-md font-bold text-gray-800",children:wJ(x,l)}),a.jsx(j,{size:16,className:`${y} mt-1`})]})]})})},t7e=({type:e,title:t,assignedTo:n,dueDate:s,scheduledDate:r,priority:i,id:o,activityType:l,fullData:c})=>{const u=kt(),h=l||{Call:"call",Meeting:"meeting",Task:"qualification"}[e]||"meeting",{Icon:p,color:x,bgColor:v}=WUe(h),{text:j,bg:y}=VUe(i||"MEDIUM"),S=(T=>{if(!T)return"No date set";const A=new Date(T),M=A-new Date,z=Math.floor(M/864e5);return z===0?`Today, ${A.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}`:z===1?`Tomorrow, ${A.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}`:z===-1?`Yesterday, ${A.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}`:A.toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})})(s||r),_=n||"Unassigned",k=()=>{o&&(c?h==="call"?(sessionStorage.setItem("callDetailData",JSON.stringify(c)),u(`/manager/calls/info?id=${o}`)):h==="meeting"?(sessionStorage.setItem("meetingDetailData",JSON.stringify(c)),u(`/manager/meetings/info?id=${o}`)):u("/manager/tasks"):u(h==="call"?`/manager/calls/info?id=${o}`:h==="meeting"?`/manager/meetings/info?id=${o}`:"/manager/tasks"))};return a.jsxs("div",{className:"flex items-start py-3 border-b border-gray-100 last:border-b-0 cursor-pointer hover:bg-gray-50 transition duration-150 px-2 -mx-2 rounded-md",onClick:k,children:[a.jsx("div",{className:`p-2 rounded-lg ${v} mr-3 flex-shrink-0 mt-1`,children:a.jsx(p,{size:20,className:`${x}`})}),a.jsxs("div",{className:"flex-grow",children:[a.jsxs("p",{className:"font-medium text-gray-800 flex items-center mb-1",children:[a.jsx("span",{className:"text-xl leading-none mr-2",children:""}),t||"Untitled Activity"]}),a.jsxs("div",{className:"space-y-1 text-xs text-gray-500",children:[a.jsxs("p",{className:"flex items-center",children:[a.jsx(pJ,{size:14,className:"mr-1.5 text-gray-400"}),S]}),a.jsxs("p",{className:"flex items-center",children:[a.jsx(yJ,{size:14,className:"mr-1.5 text-gray-400"}),"Assigned to: ",_]})]})]}),a.jsx("span",{className:`inline-block text-xs font-medium ${j} ${y} px-2 py-0.5 rounded-full flex-shrink-0 self-center ml-4`,children:(i||"MEDIUM").toUpperCase()})]})},a7e=()=>{const e=kt(),{user:t}=Vt(),n=t?.company?.currency||"",[s,r]=f.useState({activeLeads:0,totalDeals:0,activeAccounts:0,overdueTasks:0}),[i,o]=f.useState([]),[l,c]=f.useState([]),[u,d]=f.useState([]),[h,p]=f.useState([]),[x,v]=f.useState([]),[j,y]=f.useState([]),[N,w]=f.useState(!0),[S,_]=f.useState(null),[k,T]=f.useState(""),[A,E]=f.useState([]),[M,z]=f.useState([]),[P,D]=f.useState([]),[U,B]=f.useState([]),[R,q]=f.useState(0),[Z,V]=f.useState(new Date),oe=f.useRef(null),je=f.useRef(null),X=f.useMemo(()=>{try{if(!k.trim())return[];const fe=k.toLowerCase().trim(),we=[];return Array.isArray(A)&&A.forEach(de=>{const ke=`${de.first_name||""} ${de.last_name||""}`.trim().toLowerCase(),ge=(de.company_name||"").toLowerCase(),$e=(de.email||"").toLowerCase(),be=(de.phone||"").toLowerCase();(ke.includes(fe)||ge.includes(fe)||$e.includes(fe)||be.includes(fe))&&we.push({id:de.id,name:`${de.first_name||""} ${de.last_name||""}`.trim()||"Unnamed Lead",type:"Lead",details:de.company_name||"No company",route:`/manager/leads/${de.id}`})}),Array.isArray(M)&&M.forEach(de=>{const ke=(de.name||"").toLowerCase(),ge=(de.account?.name||"").toLowerCase(),$e=(de.description||"").toLowerCase();(ke.includes(fe)||ge.includes(fe)||$e.includes(fe))&&we.push({id:de.id,name:de.name||"Unnamed Deal",type:"Deal",details:de.account?.name||"No account",route:`/manager/deals/info?id=${de.id}`})}),Array.isArray(P)&&P.forEach(de=>{const ke=(de.name||"").toLowerCase(),ge=(de.email||"").toLowerCase(),$e=(de.phone||"").toLowerCase(),be=(de.website||"").toLowerCase();(ke.includes(fe)||ge.includes(fe)||$e.includes(fe)||be.includes(fe))&&we.push({id:de.id,name:de.name||"Unnamed Account",type:"Account",details:de.email||de.phone||"No contact info",route:"/manager/accounts"})}),we.slice(0,10)}catch(fe){return console.error("Error in search:",fe),[]}},[k,A,M,P]),se=fe=>{fe.route&&(e(fe.route),T(""))},ye=f.useCallback(async()=>{w(!0),_(null);try{const[fe,we,de,ke,ge,$e,be,me]=await Promise.all([re.get("/leads/admin/getLeads").catch(he=>(console.error("Error fetching leads:",he),{data:[]})),re.get("/deals/admin/fetch-all").catch(he=>(console.error("Error fetching deals:",he),{data:[]})),re.get("/accounts/admin/fetch-all").catch(he=>(console.error("Error fetching accounts:",he),{data:[]})),re.get("/tasks/all").catch(he=>(console.error("Error fetching tasks:",he),{data:[]})),re.get("/meetings/admin/fetch-all").catch(he=>(console.error("Error fetching meetings:",he),{data:[]})),re.get("/calls/admin/fetch-all").catch(he=>(console.error("Error fetching calls:",he),{data:[]})),re.get("/logs/read-all").catch(he=>(console.error("Error fetching logs:",he),{data:[]})),re.get("/targets/admin/fetch-all").catch(he=>(console.error("Error fetching targets:",he),{data:[]}))]),Ue=Array.isArray(fe.data)?fe.data:[],Ee=Array.isArray(we.data)?we.data:[],We=Array.isArray(de.data)?de.data:[],tt=Array.isArray(ke.data)?ke.data:[],lt=Array.isArray(ge.data)?ge.data:[],Fe=Array.isArray($e.data)?$e.data:[],st=Array.isArray(be.data)?be.data:[],Xe=Array.isArray(me.data)?me.data:[];console.log("=== RAW DEALS API RESPONSE ==="),console.log("Deals count:",Ee.length),Ee.length>0&&(console.log("First deal sample (raw):",JSON.stringify(Ee[0],null,2)),console.log("First deal keys:",Object.keys(Ee[0]))),E(Ue),z(Ee),D(We),B(Xe);const Ze=Xe.reduce((he,He)=>{const qe=He.amount||He.value||He.target_amount||0,nt=parseFloat(typeof qe=="string"?qe.replace(/[^\d.-]/g,""):qe);return he+(Number.isFinite(nt)?nt:0)},0);q(Ze);const Je=Ue.filter(he=>he.status&&!["Lost","Converted"].includes(he.status)).length,Be=tt.filter(he=>!he.dueDate||he.status==="Completed"?!1:new Date(he.dueDate)<new Date).length;r({activeLeads:Je,totalDeals:Ee.length,activeAccounts:We.length,overdueTasks:Be});const _e=[...Ue].sort((he,He)=>new Date(He.created_at||0)-new Date(he.created_at||0)).slice(0,5);o(_e);const pe=[...Ee].sort((he,He)=>new Date(He.created_at||0)-new Date(he.created_at||0)).slice(0,5);c(pe);const ce=new Date,Q=[];Fe.forEach(he=>{const He=he.due_date||he.call_time,qe=(he.status||"").toUpperCase();if(He){const nt=new Date(He);qe==="COMPLETED"||qe==="MISSED"||qe==="NOT_HELD"||qe==="HELD"||Q.push({type:"Call",title:he.subject||"Untitled Call",assignedTo:he.assigned_to||(he.call_assign_to?`${he.call_assign_to.first_name||""} ${he.call_assign_to.last_name||""}`.trim():"Unassigned"),scheduledDate:He,priority:(he.priority||"MEDIUM").toUpperCase(),id:he.id,activityType:"call",fullData:he})}}),lt.forEach(he=>{const He=he.dueDate||he.start_time,qe=(he.status||"").toUpperCase();if(He){const nt=new Date(He);qe==="COMPLETED"||qe==="CANCELLED"||qe==="DONE"||Q.push({type:"Meeting",title:he.subject||he.activity||"Untitled Meeting",assignedTo:he.assignedTo||(he.meet_assign_to?`${he.meet_assign_to.first_name||""} ${he.meet_assign_to.last_name||""}`.trim():"Unassigned"),scheduledDate:He,priority:(he.priority||"MEDIUM").toUpperCase(),id:he.id,activityType:"meeting",fullData:he})}});const ne={HIGH:1,MEDIUM:2,LOW:3},ae=Q.sort((he,He)=>{const qe=ne[he.priority]||3,nt=ne[He.priority]||3;if(qe!==nt)return qe-nt;const ot=new Date(he.scheduledDate||0),Re=new Date(He.scheduledDate||0);return ot-Re}).slice(0,5);d(ae),p(Ee),console.log("=== ALL DEALS DATA ==="),console.log("Total deals:",Ee.length);const Pe=Ee.filter(he=>(he.stage||"").toUpperCase()==="CLOSED_WON");console.log("CLOSED_WON deals:",Pe.length),Pe.length>0?(console.log("=== CLOSED_WON DEALS DETAILS ==="),Pe.forEach((he,He)=>{let qe=he.amount;qe&&typeof qe=="object"?qe.toString?qe=parseFloat(qe.toString()):qe=parseFloat(qe):qe=parseFloat(qe)||0,console.log(`Deal ${He+1}:`,{id:he.id,name:he.name,stage:he.stage,stage_upper:(he.stage||"").toUpperCase(),amount:he.amount,amount_parsed:qe,amount_type:typeof he.amount,close_date:he.close_date,close_date_type:typeof he.close_date,close_date_value:he.close_date?new Date(he.close_date):null,has_close_date:!!he.close_date,has_amount:qe>0,all_keys:Object.keys(he),full_deal:he})})):(console.log(" No CLOSED_WON deals found!"),console.log("All deal stages:",Ee.map(he=>he.stage))),y(Ee);const Te=[...st].sort((he,He)=>new Date(He.timestamp||0)-new Date(he.timestamp||0));v(Te)}catch(fe){console.error("Error fetching dashboard data:",fe),_("Failed to load dashboard data. Please refresh the page.")}finally{w(!1)}},[]);f.useEffect(()=>(document.title="Dashboard | Sari-Sari CRM",console.log("ManagerDashboard mounted, fetching data..."),ye(),oe.current=setInterval(()=>{console.log("Auto-refreshing dashboard data..."),ye(),V(new Date)},3e4),()=>{oe.current&&clearInterval(oe.current)}),[ye]),f.useEffect(()=>{if(!t||!t.id)return;let fe=0;const we=3;let de=null;const ke=()=>{const ge=window.location.protocol==="https:"?"wss:":"ws:",$e=window.location.hostname==="localhost"?"localhost:8000":window.location.host,be=`${ge}//${$e}/ws/notifications?user_id=${t.id}`;try{const me=new WebSocket(be);je.current=me,me.onopen=()=>{console.log(" WebSocket connected for dashboard updates"),fe=0},me.onmessage=Ue=>{try{const Ee=JSON.parse(Ue.data);console.log(" Real-time notification received:",Ee),Ee.event&&["new_task","task_updated","new_lead","lead_updated","new_deal","deal_updated","new_account","account_updated","new_meeting","meeting_updated","new_call","call_updated"].includes(Ee.event)&&(console.log(" Refreshing dashboard due to:",Ee.event),ye(),V(new Date))}catch(Ee){console.error("Error parsing WebSocket message:",Ee)}},me.onerror=Ue=>{fe===0&&console.warn(" WebSocket connection unavailable (this is optional)")},me.onclose=()=>{fe<we&&(fe++,de=setTimeout(()=>{t&&t.id&&ke()},5e3))}}catch{console.warn(" WebSocket not available (optional feature)")}};return ke(),()=>{de&&clearTimeout(de),je.current&&(je.current.close(),je.current=null)}},[t,ye]);const Ne=[{icon:IUe,title:"Active Leads",value:s.activeLeads,color:"text-blue-600",bgColor:"bg-blue-50",onClick:()=>e("/manager/leads")},{icon:vJ,title:"Total Targets",value:wJ(R,n),color:"text-purple-600",bgColor:"bg-purple-50",onClick:()=>e("/manager/targets")},{icon:bJ,title:"Total Deals",value:s.totalDeals,color:"text-yellow-600",bgColor:"bg-yellow-50",onClick:()=>e("/manager/deals")},{icon:pJ,title:"Overdue Tasks",value:s.overdueTasks,color:"text-red-600",bgColor:"bg-red-50",onClick:()=>e("/manager/tasks")}];return console.log("ManagerDashboard rendering, loading:",N,"error:",S),a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative w-full",children:[N&&a.jsx(Wt,{}),a.jsxs("div",{className:"max-w-screen-2xl mx-auto",children:[S&&a.jsx("div",{className:"mb-6 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:a.jsx("p",{className:"font-medium",children:S})}),a.jsx("div",{className:"mb-8",children:a.jsx(YUe,{searchQuery:k,onSearchChange:T,searchResults:X,onSearchResultClick:se})}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-4 mb-8",children:Ne.map(fe=>a.jsx(XUe,{...fe,loading:N},fe.title))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[a.jsx(KUe,{logs:x,loading:N}),a.jsx(pP,{currencySymbol:n})]}),a.jsx("div",{className:"mb-8",children:a.jsx(LN,{leads:A,deals:M,targets:U,currencySymbol:n,basePath:"/manager"})}),a.jsx("div",{className:"grid grid-cols-1 mb-8",children:a.jsx(ZUe,{revenueData:j,loading:N})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[a.jsx(QA,{title:"Latest Leads",children:i.length>0?i.map((fe,we)=>a.jsx(JUe,{...fe},fe.id||we)):a.jsx("div",{className:"text-sm text-gray-500 py-4 text-center",children:"No leads found"})}),a.jsx(QA,{title:"Latest Deals",children:N?a.jsxs("div",{className:"flex flex-col items-center justify-center py-8",children:[a.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-500 mb-2"}),a.jsx("div",{className:"text-sm text-gray-500",children:"Loading deals..."})]}):l.length>0?l.map((fe,we)=>a.jsx(e7e,{...fe,currencySymbol:n},fe.id||we)):a.jsx("div",{className:"text-sm text-gray-500 py-4 text-center",children:"No deals found"})}),a.jsx(QA,{title:"Upcoming Activities",children:u.length>0?u.map((fe,we)=>a.jsx(t7e,{...fe},fe.id||we)):a.jsx("div",{className:"text-sm text-gray-500 py-4 text-center",children:"No upcoming activities"})})]})]})]})},KA=[{value:"CUSTOMER",label:"Customer"},{value:"PROSPECT",label:"Prospect"},{value:"PARTNER",label:"Partner"},{value:"ACTIVE",label:"Vendor"},{value:"INACTIVE",label:"Inactive"},{value:"FORMER",label:"Delete"}],Eb={name:"",website:"",phone_number:"",billing_address:"",shipping_address:"",industry:"",parent_company:"",status:"PROSPECT",territory_id:"",assigned_to:""},cr=e=>e?e.toUpperCase():"",XA=e=>e?e.toString().toLowerCase().replace(/\b\w/g,t=>t.toUpperCase()):"--",n7e=e=>{switch(cr(e)){case"CUSTOMER":return"bg-green-600 text-white";case"PROSPECT":return"bg-purple-600 text-white";case"PARTNER":return"bg-pink-600 text-white";case"ACTIVE":return"bg-blue-600 text-white";case"INACTIVE":return"bg-gray-600 text-white";case"FORMER":return"bg-orange-600 text-white";default:return"bg-gray-500 text-white"}},s7e=e=>{switch(cr(e)){case"CUSTOMER":return"bg-green-100 text-green-700";case"PROSPECT":return"bg-purple-100 text-purple-700";case"PARTNER":return"bg-pink-100 text-pink-700";case"ACTIVE":return"bg-blue-100 text-blue-700";case"INACTIVE":return"bg-gray-200 text-gray-700";case"FORMER":return"bg-orange-100 text-orange-700";default:return"bg-gray-100 text-gray-700"}};function r7e(){const e=kt(),t=ta(),{user:n}=Vt();f.useEffect(()=>{document.title="Accounts | Sari-Sari CRM"},[]);const[s,r]=f.useState(!1),[i,o]=f.useState(!1),[l,c]=f.useState(!1),[u,d]=f.useState(null),[h,p]=f.useState(null),[x,v]=f.useState(Eb),[j,y]=f.useState(null),[N,w]=f.useState([]),[S,_]=f.useState(!1),[k,T]=f.useState([]),[A,E]=f.useState(null),[M,z]=f.useState([]),[P,D]=f.useState([]),[U,B]=f.useState("Filter by Status"),[R,q]=f.useState(""),[Z,V]=f.useState(null),[oe,je]=f.useState(!1),[X,se]=f.useState(1),[ye,Ne]=f.useState(10),[fe,we]=f.useState("Overview"),[de,ke]=f.useState(""),[ge,$e]=f.useState(!1),[be,me]=f.useState({}),[Ue,Ee]=f.useState(null),[We,tt]=f.useState(new Set),[lt,Fe]=f.useState(!1),{comments:st,addComment:Xe,refresh:Ze}=kn({relatedType:"account",relatedId:j?.id});f.useEffect(()=>{j?.id&&Ze()},[j?.id,Ze]);const Je=f.useCallback(async(L=null)=>{_(!0);try{const ee=await re.get("/accounts/admin/fetch-all"),ze=[...Array.isArray(ee.data)?ee.data:[]].sort((Ve,ft)=>{const _t=Ve?.created_at||Ve?.updated_at||0,At=ft?.created_at||ft?.updated_at||0;return new Date(At)-new Date(_t)});if(w(ze),L){const Ve=ze.find(ft=>ft.id===L);y(Ve||null)}}catch(ee){console.error(ee),w([]),ee.response?.status===403?H.error("Permission denied. Only CEO, Admin, or Group Manager can access this page."):H.error("Failed to fetch accounts. Please try again later.")}finally{_(!1)}},[y]),Be=f.useCallback(async()=>{try{const L=await re.get("/users/all");T(Array.isArray(L.data)?L.data:[])}catch(L){console.error(L),L.response?.status===403&&H.warn("Unable to load users for assignment (permission denied).")}},[]),_e=f.useCallback(async()=>{try{const L=await re.get("/territories/fetch");z(Array.isArray(L.data)?L.data:[])}catch(L){console.error(L),L.response?.status===403&&H.warn("Unable to load territories (permission denied).")}},[]),pe=f.useCallback(async()=>{try{const L=await re.get("/accounts/admin/parent-companies");D(Array.isArray(L.data)?L.data:[])}catch(L){console.error(L),L.response?.status===403&&H.warn("Unable to load parent companies (permission denied).")}},[]),ce=f.useCallback(async L=>{try{const ee=await re.get(`/activities/accounts/${L}`);me(ee.data&&typeof ee.data=="object"?ee.data:{})}catch(ee){console.error(ee),ee.response?.status===404&&(console.warn("No activities found for this account."),me({}))}},[]);f.useEffect(()=>{Je(),Be(),_e(),pe()},[Je,Be,_e,pe]),f.useEffect(()=>{j&&ke(cr(j.status)||"PROSPECT")},[j]);const Q=N.length,ne=f.useMemo(()=>N.filter(L=>L.status?.toLowerCase()==="customer").length,[N]),ae=f.useMemo(()=>N.filter(L=>L.status?.toLowerCase()==="prospect").length,[N]),Pe=f.useMemo(()=>N.filter(L=>L.status?.toLowerCase()==="partner").length,[N]),Te=f.useMemo(()=>N.filter(L=>L.status?.toLowerCase()==="active").length,[N]),he=f.useMemo(()=>N.filter(L=>L.status?.toLowerCase()==="inactive").length,[N]),He=f.useMemo(()=>N.filter(L=>L.status?.toLowerCase()==="former").length,[N]),qe=f.useMemo(()=>[{title:"Total",value:Q,icon:Za,color:"text-slate-600",bgColor:"bg-slate-100"},{title:"Customers",value:ne,icon:Qi,color:"text-green-600",bgColor:"bg-green-100"},{title:"Prospects",value:ae,icon:Xa,color:"text-purple-600",bgColor:"bg-purple-100"},{title:"Partners",value:Pe,icon:ra,color:"text-pink-600",bgColor:"bg-pink-100"},{title:"Active",value:Te,icon:Qi,color:"text-blue-600",bgColor:"bg-blue-100"},{title:"Inactive",value:he,icon:Ki,color:"text-gray-600",bgColor:"bg-gray-100"},{title:"Former",value:He,icon:Ki,color:"text-orange-600",bgColor:"bg-orange-100"}],[Q,ne,ae,Pe,Te,he,He]),nt=f.useMemo(()=>{const L=R.trim().toLowerCase(),ee=U.trim().toUpperCase();return N.filter(Le=>{const ze=[Le?.name,Le?.website,Le?.industry,Le?.territory?.name,Le?.phone_number],Ve=L===""||ze.some(Yt=>Yt==null?!1:Yt.toString().toLowerCase().includes(L)),ft=ee==="FILTER BY STATUS"||cr(Le.status)===ee,At=cr(Le.status)==="INACTIVE"&&ee!=="INACTIVE";return Ve&&ft&&!At})},[N,R,U]),ot=Math.max(1,Math.ceil(nt.length/ye)||1);f.useEffect(()=>{se(1)},[R,U]),f.useEffect(()=>{se(L=>{const ee=Math.max(1,Math.ceil(nt.length/ye)||1);return L>ee?ee:L})},[nt.length]);const Re=f.useMemo(()=>{const L=(X-1)*ye;return nt.slice(L,L+ye)},[nt,X]);nt.length===0||(X-1)*ye+1,Math.min(X*ye,nt.length);const it=()=>se(L=>Math.max(L-1,1)),St=()=>se(L=>Math.min(L+1,ot)),Et=L=>{y(L),we("Overview"),ke(cr(L?.status)||"PROSPECT")},Tt=()=>y(null),Nt=L=>{L.target.id==="accountModalBackdrop"&&!oe&&Tt()},xe=()=>{r(!1),o(!1),p(null),v(Eb),c(!1),E(null)},ve=L=>{L.target.id==="modalBackdrop"&&xe()},Oe=L=>L?new Date(L).toLocaleString("en-US",{month:"short",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).replace(",",""):"",Ce=L=>{const{name:ee,value:Le}=L.target;v(ze=>({...ze,[ee]:Le}))},Qe=()=>{v(Eb),o(!1),p(null),r(!0)};f.useEffect(()=>{const L=new URLSearchParams(t.search||"");(t.state?.openAccountModal||L.get("openModal")==="1")&&(v(Eb),o(!1),p(null),r(!0),K(!1),e(t.pathname,{replace:!0,state:{}}))},[t.state,t.pathname,t.search,e]);const G=L=>{y(null),L.assigned_accs?E(L.assigned_accs):E(null),v({name:L.name||"",website:L.website||"",phone_number:L.phone_number||"",billing_address:L.billing_address||"",shipping_address:L.shipping_address||"",parent_company:L.parent_company||"",industry:L.industry||"",status:cr(L.status)||"PROSPECT",territory_id:L.territory?.id?String(L.territory.id):"",assigned_to:L.assigned_accs?.id?String(L.assigned_accs.id):""}),o(!0),p(L.id),r(!0)},W=L=>{L&&V({title:"Archive Account",message:a.jsxs("span",{children:["Are you sure you want to archive the account"," ",a.jsx("span",{className:"font-semibold",children:L.name}),"? You can restore it later if needed."]}),confirmLabel:"Archive Account",cancelLabel:"Cancel",variant:"archive",action:{type:"archive",targetId:L.id,name:L.name}})},J=L=>{const ee=Re.find(Le=>Le.id===L);ee&&ee.acc_creator?.id===n?.id&&tt(Le=>{const ze=new Set(Le);return ze.has(L)?ze.delete(L):ze.add(L),ze})},Y=()=>{const L=Re.filter(ee=>ee.acc_creator?.id===n?.id);We.size===L.length&&L.length>0?tt(new Set):tt(new Set(L.map(ee=>ee.id)))},F=()=>{if(We.size===0)return;const L=We.size;V({title:"Archive Accounts",message:a.jsxs("span",{children:["Are you sure you want to archive"," ",a.jsx("span",{className:"font-semibold",children:L})," account",L!==1?"s":"","? You can restore them later if needed."]}),confirmLabel:`Archive ${L} Account${L!==1?"s":""}`,cancelLabel:"Cancel",variant:"archive",action:{type:"bulk-archive",targetIds:Array.from(We),count:L}})},ue=async()=>{if(!Z?.action){V(null);return}const{action:L}=Z,{type:ee,payload:Le,targetId:ze,name:Ve,targetIds:ft,count:_t}=L;je(!0);try{if(ee==="create"){c(!0);const At=await re.post("/accounts/admin",Le);pe(),H.success(`Account "${Ve}" created successfully.`);const Yt=j?.id||null;xe(),await Je(Yt),!j&&At.data?.id}else if(ee==="update"){if(!ze)throw new Error("Missing account identifier for update.");c(!0),await re.put(`/accounts/admin/${ze}`,Le),H.success(`Account "${Ve}" updated successfully.`);const At=j?.id&&j.id===ze?ze:null;xe(),await Je(At),j?.id===ze&&y(null)}else if(ee==="archive"){if(!ze)throw new Error("Missing account identifier for archiving.");const At=j?.id;d(ze),await re.put(`/accounts/admin/${ze}`,{status:"INACTIVE"}),H.success(`Account "${Ve}" archived successfully.`),await Je(At&&At!==ze?At:null),At===ze&&y(null)}else if(ee==="bulk-archive"){if(!ft||ft.length===0)throw new Error("Missing account identifiers for bulk archiving.");Fe(!0),await Promise.all(ft.map(At=>re.put(`/accounts/admin/${At}`,{status:"INACTIVE"}))),H.success(`${_t} account${_t!==1?"s":""} archived successfully.`),tt(new Set),await Je(),y(null)}}catch(At){console.error(At);const Yt=ee==="create"?"Failed to create account. Please review the details and try again.":ee==="update"?"Failed to update account. Please review the details and try again.":ee==="bulk-archive"?"Failed to archive accounts. Please try again.":"Failed to archive account. Please try again.",En=At.response?.data?.detail||Yt;H.error(En),(ee==="create"||ee==="update")&&c(!1),ee==="archive"&&d(null),ee==="bulk-archive"&&Fe(!1)}finally{(ee==="create"||ee==="update")&&c(!1),ee==="archive"&&d(null),ee==="bulk-archive"&&Fe(!1),je(!1),V(null)}},De=()=>{oe||V(null)},le=async()=>{if(!j||!de)return;const L=cr(de),ee=cr(j.status);if(L!==ee){$e(!0);try{await re.put(`/accounts/admin/${j.id}`,{status:L}),H.success(`Account status updated to ${XA(L)}`),w(Le=>Le.map(ze=>ze.id===j.id?{...ze,status:L}:ze)),y(null)}catch(Le){console.error(Le);const ze=Le.response?.data?.detail||"Failed to update account status. Please try again.";H.error(ze)}finally{$e(!1)}}},[Ie,K]=f.useState(!1),ie=L=>{L.preventDefault(),K(!0);const ee=x.name.trim();if(!ee){H.error("Account name is required.");return}if(!x.assigned_to){H.error("Assigned To is required.");return}const ze={name:ee,website:x.website?.trim()||null,phone_number:x.phone_number?.trim()||null,billing_address:x.billing_address?.trim()||null,shipping_address:x.shipping_address?.trim()||null,industry:x.industry?.trim()||null,parent_company:x.parent_company?.trim()||null,status:x.status||"PROSPECT",territory_id:x.territory_id?Number(x.territory_id):null,assigned_to:x.assigned_to?Number(x.assigned_to):null},Ve=i&&h?"update":"create";V({title:Ve==="create"?"Confirm New Account":"Confirm Update",message:Ve==="create"?a.jsxs("span",{children:["Are you sure you want to create the account"," ",a.jsx("span",{className:"font-semibold",children:ee}),"?"]}):a.jsxs("span",{children:["Save changes to the account"," ",a.jsx("span",{className:"font-semibold",children:ee}),"?"]}),confirmLabel:Ve==="create"?"Create Account":"Update Account",cancelLabel:"Cancel",variant:"primary",action:{type:Ve,payload:ze,targetId:h||null,name:ee}})},Me=[{label:"Filter by Status",value:"Filter by Status"},...KA.map(L=>({label:L.label,value:L.value}))],Ke=Z?.action?.type==="delete"?Z.action.targetId:null,gt=j&&(u===j.id||Ke===j.id),Ct=j&&u===j.id,Ht=j?n7e(j.status):"",da=j?a.jsx("div",{id:"accountModalBackdrop",onClick:Nt,className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-6xl max-h-[92vh] overflow-y-auto hide-scrollbar animate-scale-in font-inter relative",onClick:L=>L.stopPropagation(),children:[a.jsxs("div",{className:"bg-tertiary w-full rounded-t-xl flex items-center justify-between p-3 lg:p-3",children:[a.jsx("h1",{className:"lg:text-3xl text-xl text-white font-semibold text-center w-full",children:"Account"}),a.jsx("button",{onClick:Tt,className:"text-gray-400 hover:text-white cursor-pointer",children:a.jsx(Ja,{size:25})})]}),a.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between lg:flex-row lg:items-center lg:justify-between mt-3 gap-2 px-2 md:items-center lg:gap-4 md:mx-7 lg:mx-7",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[a.jsx("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-800",children:j.name}),a.jsx("span",{className:`text-xs sm:text-sm font-medium px-2 sm:px-3 py-1 rounded-full whitespace-nowrap ${Ht}`,children:XA(j.status)})]}),n?.id===j?.acc_creator?.id&&a.jsxs("div",{className:"flex flex-col sm:flex-row sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsxs("button",{className:"inline-flex items-center justify-center w-full sm:w-auto bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 disabled:opacity-70 transition text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",onClick:()=>G(j),disabled:Z?.action?.type==="update"&&Z.action.targetId===j.id,children:[a.jsx(gn,{className:"mr-2"}),"Edit"]}),a.jsx("button",{className:"inline-flex items-center justify-center w-full sm:w-auto px-4 py-2 rounded-md text-sm bg-orange-500 text-white hover:bg-orange-600 transition focus:outline-none focus:ring-2 focus:ring-orange-400",onClick:()=>W(j),disabled:!!gt,children:Ct?"Archiving...":a.jsxs(a.Fragment,{children:[a.jsx(Zt,{className:"mr-2"}),"Archive"]})})]})]}),a.jsx("div",{className:"border-b border-gray-200 my-5"}),a.jsxs("div",{className:"p-6 lg:p-4",children:[a.jsx("div",{className:"flex w-full bg-[#6A727D] text-white mt-1 overflow-x-auto mb-6",children:["Overview","Activities"].map(L=>a.jsx("button",{onClick:()=>we(L),className:`flex-1 min-w-[90px] px-4 py-2.5 text-xs sm:text-sm font-medium text-center transition-all duration-200 border-b-2
        ${fe===L?"bg-paper-white text-[#6A727D] border-white":"text-white hover:bg-[#5c636d]"}`,children:L},L))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 items-start",children:[a.jsxs("div",{className:"lg:col-span-3",children:[fe==="Overview"&&a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 md:p-8 border border-gray-200",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4 sm:gap-6 text-sm text-gray-700",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Website:"}),a.jsx("p",{children:j.website?a.jsx("a",{href:j.website,className:"text-blue-600 hover:underline break-all",target:"_blank",rel:"noopener noreferrer",children:j.website}):"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Industry:"}),a.jsx("p",{children:j.industry||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Parent Company:"}),a.jsx("p",{children:j.parent_company||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Territory:"}),a.jsx("p",{children:j.territory?.name||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Phone Number:"}),a.jsx("p",{children:j.phone_number||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Billing Address:"}),a.jsx("p",{children:j.billing_address||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Shipping Address:"}),a.jsx("p",{children:j.shipping_address||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Assigned To:"}),a.jsx("p",{children:j.assigned_accs?`${j.assigned_accs.first_name} ${j.assigned_accs.last_name}`:"Unassigned"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created By:"}),a.jsx("p",{children:j.acc_creator?`${j.acc_creator.first_name} ${j.acc_creator.last_name}`:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created At:"}),a.jsx("p",{children:Oe(j.created_at)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Last Updated:"}),a.jsx("p",{children:Oe(j.updated_at)||"N/A"})]})]}),a.jsx(Tn,{comments:st,onAddComment:Xe})]}),fe==="Notes"&&a.jsxs("div",{className:"mt-4 w-full",children:[a.jsx("div",{className:"flex flex-wrap items-center justify-between mb-4 gap-2",children:a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words",children:"Account Note"})}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 shadow-sm break-words",children:[a.jsx("div",{className:"flex items-start justify-between",children:a.jsx("div",{children:a.jsx("p",{className:"text-sm font-medium text-gray-800 break-words",children:"Note"})})}),a.jsx("div",{className:"mt-3 text-sm text-gray-700 whitespace-pre-wrap break-words",children:N.notes||"No notes available."})]})]}),fe==="Activities"&&a.jsxs("div",{className:"space-y-2 w-full h-full max-h-[50dvh] overflow-y-auto bg-gray-50 p-2 hide-scrollbar rounded-lg border border-gray-200 shadow-sm",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words border-b border-gray-300 py-2",children:"Related Activities"}),a.jsxs("div",{className:"space-y-2 text-sm",children:[be.tasks&&be.tasks.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>Ee(Ue==="tasks"?null:"tasks"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Qt,{className:"text-blue-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Tasks (",be.tasks.length,")"]})]}),Ue==="tasks"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Ue==="tasks"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:be.tasks.map((L,ee)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/manager/tasks",{state:{taskID:L.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-blue-600 mt-1",children:a.jsx(Qt,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:L.subject||L.title||"Task"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:L.description||"No description"}),L.assigned_to&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Assigned: ",L.assigned_to.first_name," ",L.assigned_to.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:Oe(L.due_date||L.created_at)})]},`task-${ee}`))})]}),be.meetings&&be.meetings.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>Ee(Ue==="meetings"?null:"meetings"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ot,{className:"text-green-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Meetings (",be.meetings.length,")"]})]}),Ue==="meetings"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Ue==="meetings"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:be.meetings.map((L,ee)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/manager/meetings",{state:{meetingID:L.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-green-600 mt-1",children:a.jsx(Ot,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:L.subject||L.title||"Meeting"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:L.description||L.location||"No description"}),L.host&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Host: ",L.host.first_name," ",L.host.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:Oe(L.start_time||L.created_at)})]},`meeting-${ee}`))})]}),be.calls&&be.calls.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>Ee(Ue==="calls"?null:"calls"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(It,{className:"text-purple-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Calls (",be.calls.length,")"]})]}),Ue==="calls"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Ue==="calls"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:be.calls.map((L,ee)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/manager/calls",{state:{callID:L.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-purple-600 mt-1",children:a.jsx(It,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:L.subject||L.title||"Call"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:L.direction||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:Oe(L.call_time||L.created_at)})]},`call-${ee}`))})]}),be.contacts&&be.contacts.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>Ee(Ue==="contacts"?null:"contacts"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ra,{className:"text-teal-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Contacts (",be.contacts.length,")"]})]}),Ue==="contacts"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Ue==="contacts"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:be.contacts.map((L,ee)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/manager/contacts",{state:{contactID:L.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-teal-600 mt-1",children:a.jsx(ra,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("h4",{className:"font-medium text-blue-600 break-words text-sm",children:[L.first_name?`${L.first_name} `:"",L.last_name]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:L.title||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:Oe(L.created_at)})]},`contact-${ee}`))})]}),be.deals&&be.deals.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>Ee(Ue==="deals"?null:"deals"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(sa,{className:"text-indigo-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Deals (",be.deals.length,")"]})]}),Ue==="deals"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Ue==="deals"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:be.deals.map((L,ee)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/manager/deals",{state:{dealID:L.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-indigo-600 mt-1",children:a.jsx(sa,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("h4",{className:"font-medium text-blue-600 break-words text-sm",children:[L.deal_id?L.deal_id.replace(/D(\d+)-\d+-/,"D$1-"):"--"," ",L.name||L.title||"Deal"]}),a.jsx("p",{className:"text-xs text-gray-500 break-words capitalize",children:L.stage||L.description||"No description"})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:Oe(L.close_date||L.created_at)})]},`deal-${ee}`))})]}),be.quotes&&be.quotes.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>Ee(Ue==="quotes"?null:"quotes"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ia,{className:"text-orange-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Quotes (",be.quotes.length,")"]})]}),Ue==="quotes"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Ue==="quotes"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:be.quotes.map((L,ee)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/manager/quotes",{state:{quoteID:L.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-orange-600 mt-1",children:a.jsx(ia,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:(L.quote_id?L.quote_id.replace(/Q(\d+)-\d+-/,"Q$1-"):"--")||"Quote"}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:L.status||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:Oe(L.presented_date)||""})]},`quote-${ee}`))})]}),(!be||(!be.tasks||be.tasks.length===0)&&(!be.meetings||be.meetings.length===0)&&(!be.calls||be.calls.length===0)&&(!be.quotes||be.quotes.length===0)&&(!be.deals||be.deals.length===0)&&(!be.contacts||be.contacts.length===0))&&a.jsx("div",{className:"text-center py-8 text-gray-500",children:a.jsx("p",{children:"No related activities found for this account."})})]})]})]}),a.jsxs("div",{className:"flex flex-col gap-4",children:[a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Quick Actions"}),a.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[a.jsxs("button",{onClick:()=>e("/manager/calls",{state:{openCallModal:!0,initialCallData:{subject:`Call with ${j.name}`,relatedType1:"Account",relatedTo1:String(j.id),relatedType2:null,relatedTo2:null,assigned_to:j.assigned_accs?.id?String(j.assigned_accs.id):"",direction:"Outgoing",status:"Planned"}}}),className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(It,{className:"text-gray-600 w-4 h-4"}),"Schedule Call"]}),a.jsxs("button",{className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",onClick:()=>e("/manager/meetings",{state:{openMeetingModal:!0,initialMeetingData:{subject:`Meeting with ${j.name}`,relatedType1:"Account",relatedTo1:String(j.id),relatedType2:null,relatedTo2:null,assignedTo:j.assigned_accs?.id?String(j.assigned_accs.id):"",status:"Planned"}}}),children:[a.jsx(Ot,{className:"text-gray-600 w-4 h-4"}),"Book Meeting"]}),a.jsxs("button",{onClick:()=>e("/manager/tasks",{state:{openTaskModal:!0,initialTaskData:{subject:`Follow up with ${j.name}`,relatedType1:"Account",relatedTo1:String(j.id),relatedType2:null,relatedTo2:null,assignedTo:j.assigned_accs?.id?String(j.assigned_accs.id):"",priority:"NORMAL",status:"Not Started"}}}),className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(Qt,{className:"text-gray-600 w-4 h-4"}),"Tasks"]})]})]}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm w-full",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Status"}),a.jsx("select",{className:"border border-gray-200 rounded-md px-2 sm:px-3 py-1.5 w-full text-sm mb-2 focus:ring-2 focus:ring-indigo-500 outline-none",value:de||cr(j?.status)||"PROSPECT",onChange:L=>ke(L.target.value),children:KA.map(L=>a.jsx("option",{value:L.value,children:L.label},L.value))}),a.jsx("button",{onClick:le,disabled:ge||!de||cr(de)===cr(j?.status),className:`w-full py-1.5 rounded-md text-sm transition focus:outline-none focus:ring-2 ${ge||!de||cr(de)===cr(j?.status)?"bg-gray-400 cursor-not-allowed text-white":"bg-gray-900 text-white hover:bg-gray-800 focus:ring-gray-400"}`,children:ge?"Updating...":"Update"})]})]})]})]})]})}):null,Ge=a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[S&&a.jsx(Wt,{message:"Loading accounts..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h2",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(Za,{className:"mr-2 text-blue-600"}),"Accounts Management"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{onClick:()=>{Qe(),K(!1)},className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 my-1 lg:my-0 rounded-md hover:bg-gray-800 text-sm sm:text-base mx-auto sm:ml-auto cursor-pointer",children:[a.jsx(aa,{className:"mr-2"})," Add Account"]})})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4 mb-6 w-full break-words overflow-hidden lg:overflow-visible",children:qe.map(L=>a.jsx(i7e,{...L},L.title))}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search accounts",value:R,onChange:L=>q(L.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsx("div",{className:"w-full lg:w-1/4",children:a.jsx("select",{value:U,onChange:L=>B(L.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:Me.map(L=>a.jsx("option",{value:L.value,children:L.label},L.value))})})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[500px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 text-sm tracking-wide font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 w-12",children:a.jsx("input",{type:"checkbox",checked:We.size>0&&We.size===Re.filter(L=>L.acc_creator?.id===n?.id).length&&Re.filter(L=>L.acc_creator?.id===n?.id).length>0,onChange:Y,className:"w-4 h-4 cursor-pointer"})}),a.jsx("th",{className:"py-3 px-4 truncate",children:"Account"}),a.jsx("th",{className:"py-3 px-4",children:"Status"}),a.jsx("th",{className:"py-3 px-4",children:"Industry"}),a.jsx("th",{className:"py-3 px-4",children:"Territory"}),a.jsx("th",{className:"py-3 px-4",children:"Phone"}),a.jsx("th",{className:"py-3 px-4 w-12",children:We.size>0&&a.jsx("button",{onClick:F,className:"text-orange-500 hover:text-orange-700 transition",title:"Archive selected accounts",children:a.jsx(Zt,{size:18})})})]})}),a.jsx("tbody",{children:S?a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:7,children:"Loading accounts..."})}):nt.length>0?Re.map(L=>a.jsxs("tr",{className:"hover:bg-gray-50 text-xs",children:[a.jsx("td",{className:"py-3 px-4",children:L.acc_creator?.id===n?.id&&a.jsx("input",{type:"checkbox",checked:We.has(L.id),onChange:ee=>{ee.stopPropagation(),J(L.id)},className:"w-4 h-4 cursor-pointer"})}),a.jsx("td",{className:"py-3 px-4 cursor-pointer",onClick:()=>{Et(L),ce(L.id)},children:a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-blue-600 hover:underline break-all text-sm",children:L.name}),a.jsx("div",{className:"text-gray-500 text-xs break-all",children:L.website||"--"})]})}),a.jsx("td",{className:"py-3 px-4 cursor-pointer",onClick:()=>{Et(L),ce(L.id)},children:a.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${s7e(L.status)}`,children:XA(L.status)})}),a.jsx("td",{className:"py-3 px-4 text-sm cursor-pointer",onClick:()=>{Et(L),ce(L.id)},children:L.industry||"--"}),a.jsx("td",{className:"py-3 px-4 text-sm cursor-pointer",onClick:()=>{Et(L),ce(L.id)},children:L.territory?.name||"--"}),a.jsx("td",{className:"py-3 px-4 cursor-pointer",onClick:()=>{Et(L),ce(L.id)},children:a.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[a.jsx(It,{className:"text-gray-500"}),a.jsx("span",{children:L.phone_number||"--"})]})})]},L.id)):a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:7,children:"No accounts found."})})})]})}),a.jsx(ca,{className:"mt-4",totalItems:nt.length,pageSize:ye,currentPage:X,onPrev:it,onNext:St,onPageSizeChange:L=>{Ne(L),se(1)},pageSizeOptions:[10,20,30,40,50],label:"accounts"})]}),Ae=s?a.jsx("div",{id:"modalBackdrop",onClick:ve,className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-full sm:max-w-3xl rounded-2xl shadow-lg p-4 sm:p-6 md:p-8 relative border border-gray-200 overflow-y-auto hide-scrollbar max-h-[90vh]",onClick:L=>L.stopPropagation(),children:[a.jsx("button",{onClick:()=>{xe(),K(!1)},className:"absolute top-4 right-4 text-gray-500 hover:text-black transition",disabled:l||oe,children:a.jsx(ea,{size:22})}),a.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800 mb-4 sm:mb-6 flex items-center justify-center",children:i?"Edit Account":"Add New Account"}),a.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",onSubmit:ie,noValidate:!0,children:[a.jsx("div",{className:"md:col-span-2",children:a.jsx(af,{label:"Name",name:"name",value:x.name,onChange:Ce,placeholder:"Company name",required:!0,isSubmitted:Ie})}),a.jsx(N8,{label:"Parent Company",value:x.parent_company,onChange:L=>{v(ee=>({...ee,parent_company:L}))},items:P.map(L=>({id:L,name:L})),getLabel:L=>L?.name||"",placeholder:"Select parent company...",disabled:l}),a.jsx(af,{label:"Website",name:"website",value:x.website,onChange:Ce,placeholder:"https://example.com",disabled:l}),a.jsx(af,{label:"Phone Number",name:"phone_number",value:x.phone_number,onChange:Ce,placeholder:"09xx xxx xxxx",type:"tel",disabled:l}),a.jsx(af,{label:"Industry",name:"industry",value:x.industry,onChange:Ce,placeholder:"Industry",disabled:l}),a.jsx(af,{label:"Billing Address",name:"billing_address",value:x.billing_address,onChange:Ce,placeholder:"Billing address",disabled:l}),a.jsx(af,{label:"Shipping Address",name:"shipping_address",value:x.shipping_address,onChange:Ce,placeholder:"Shipping address",disabled:l}),a.jsx(j8,{label:"Status",name:"status",value:x.status,onChange:Ce,options:[{value:"",label:"Select status"},...KA],required:!0,disabled:l}),a.jsx(N8,{label:"Assigned To",value:x.assigned_to,onChange:L=>{const ee=k.find(ze=>String(ze.id)===String(L));E(ee);let Le=null;ee&&ee.assigned_territory&&ee.assigned_territory.length===1&&(Le=ee.assigned_territory[0].id),v(ze=>({...ze,assigned_to:L,territory_id:Le}))},items:k||[],getLabel:L=>`${L?.first_name??""} ${L?.last_name??""} (${L?.role??""})`.trim(),placeholder:"Search assignee...",required:!0,isSubmitted:Ie,disabled:l||k.length===0}),a.jsx(j8,{label:"Territory",name:"territory_id",value:x.territory_id||"",onChange:Ce,options:[{value:"",label:A?A.assigned_territory&&A.assigned_territory.length>0?"Select Territory":"No territories assigned to this user":"Select a user first"},...A&&A.assigned_territory&&A.assigned_territory.map(L=>({value:String(L.id),label:L.name}))||[]],disabled:l||!A||!A.assigned_territory||A.assigned_territory.length===0}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-end sm:justify-end space-y-2 sm:space-y-0 sm:space-x-2 col-span-1 md:col-span-2 mt-4 w-full",children:[a.jsx("button",{type:"button",onClick:()=>{xe(),K(!1)},className:"w-full sm:w-auto px-4 py-2 text-white bg-red-400 border border-red-300 rounded hover:bg-red-500 transition disabled:opacity-70",disabled:l||oe,children:"Cancel"}),a.jsx("button",{type:"submit",className:"w-full sm:w-auto px-4 py-2 text-white border border-tertiary bg-tertiary rounded hover:bg-secondary transition disabled:opacity-70",disabled:l||oe,children:l?"Saving...":i?"Update Account":"Save Account"})]})]})]})}):null,I=Z?a.jsx(l7e,{open:!0,title:Z.title,message:Z.message,confirmLabel:Z.confirmLabel,cancelLabel:Z.cancelLabel,variant:Z.variant,onConfirm:ue,onCancel:De,loading:oe}):null;return a.jsxs(a.Fragment,{children:[Ge,da,Ae,I]})}function i7e({icon:e,title:t,value:n,color:s="text-blue-600",bgColor:r="bg-blue-100",onClick:i}){const o=()=>{typeof i=="function"?i():console.log(`Clicked: ${t}`)};return a.jsxs("div",{className:"flex items-center p-4 bg-white rounded-xl shadow-md border border-gray-200 transition-all duration-300",onClick:o,children:[a.jsx("div",{className:`flex-shrink-0 p-3 rounded-full ${r} ${s} mr-4`,children:e?a.jsx(e,{size:22}):null}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:t}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:n})]})]})}function af({label:e,name:t,value:n,onChange:s,placeholder:r,type:i="text",required:o=!1,disabled:l=!1,className:c="",isSubmitted:u=!1}){const d=u&&!n?.trim();return a.jsxs("div",{children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",o&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:i,name:t,value:n??"",onChange:s,placeholder:r,required:o,disabled:l,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border focus:ring-2
          ${d?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}
          ${c}
        `})]})}function j8({label:e,name:t,value:n,onChange:s,options:r,required:i=!1,disabled:o=!1}){return a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsx("select",{name:t,value:n??"",onChange:s,required:i,disabled:o,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100",children:r.map(l=>a.jsx("option",{value:l.value,children:l.label},l.value))})]})}function N8({label:e,items:t=[],value:n="",onChange:s,getLabel:r,placeholder:i="Search...",disabled:o=!1,className:l="",required:c=!1,isSubmitted:u=!1,allowFreeText:d=!1}){const h=u&&c&&!n;return a.jsxs("div",{className:l,children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",c&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx(o7e,{items:t,value:n??"",onChange:s,getLabel:r,placeholder:i,disabled:o,hasError:h,allowFreeText:d})]})}function o7e({items:e=[],value:t="",onChange:n,getLabel:s,placeholder:r="Search...",disabled:i=!1,maxRender:o=200,hasError:l=!1,allowFreeText:c=!1}){const[u,d]=f.useState(!1),[h,p]=f.useState(""),x=f.useRef(null),v=e.find(N=>String(N.id)===String(t)),j=v?s(v):t,y=f.useMemo(()=>{const N=h.trim().toLowerCase();return(N?e.filter(S=>(s(S)||"").toLowerCase().includes(N)):e).slice(0,o)},[e,h,s,o]);return f.useEffect(()=>{const N=w=>{x.current&&!x.current.contains(w.target)&&d(!1)};return document.addEventListener("mousedown",N),()=>document.removeEventListener("mousedown",N)},[]),f.useEffect(()=>{u||p("")},[u]),a.jsxs("div",{ref:x,className:"relative w-full",children:[a.jsx("input",{disabled:i,value:u?h:j,placeholder:r,onFocus:()=>!i&&d(!0),onChange:N=>{p(N.target.value),u||d(!0)},className:`w-full border rounded-md px-2 py-1.5 text-sm outline-none focus:ring-2
          ${l?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}`}),u&&!i&&a.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg overflow-hidden",children:[a.jsxs("div",{className:"max-h-56 overflow-y-auto hide-scrollbar",children:[c&&h.trim()&&!y.some(N=>s(N).toLowerCase()===h.trim().toLowerCase())&&a.jsxs("button",{type:"button",onClick:()=>{n(h.trim()),d(!1)},className:"w-full text-left px-3 py-2 text-sm hover:bg-green-50 bg-blue-50 font-medium text-blue-700",children:['+ Add "',h.trim(),'" as new parent company']}),y.length>0?y.map(N=>{const w=String(N.id),S=s(N),_=String(t)===w;return a.jsx("button",{type:"button",onClick:()=>{n(w),d(!1)},className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-50 ${_?"bg-blue-50":""}`,children:S||"--"},w)}):!c||!h.trim()?a.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No results"}):null]}),e.length>o&&a.jsxs("div",{className:"px-3 py-2 text-[11px] text-gray-400 border-t",children:["Showing first ",o," results  keep typing to narrow."]})]})]})}function l7e({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o=!1,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":i==="archive"?"bg-orange-500 hover:bg-orange-600 border border-orange-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsx("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${u}`,disabled:o,children:o?"Processing...":s})]})]})})}const Lb={first_name:"",last_name:"",account_id:"",title:"",department:"",email:"",work_phone:"",mobile_phone_1:"",mobile_phone_2:"",notes:"",assigned_to:""},wl=e=>[e?.first_name,e?.last_name].filter(Boolean).join(" ").trim(),xo=e=>e?new Date(e).toLocaleString("en-US",{month:"short",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).replace(",",""):"";function c7e(){const e=kt(),t=ta(),{user:n}=Vt();f.useEffect(()=>{document.title="Contacts | Sari-Sari CRM"},[]);const[s,r]=f.useState([]),[i,o]=f.useState(!1),[l,c]=f.useState([]),[u,d]=f.useState([]),[h,p]=f.useState(null),[x,v]=f.useState(!1),[j,y]=f.useState(!1),[N,w]=f.useState(!1),[S,_]=f.useState(null),[k,T]=f.useState(!1),[A,E]=f.useState(null),[M,z]=f.useState(Lb),[P,D]=f.useState(""),[U,B]=f.useState("Filter by Accounts"),[R,q]=f.useState(null),[Z,V]=f.useState("Overview"),[oe,je]=f.useState(1),[X,se]=f.useState(10),[ye,Ne]=f.useState({}),[fe,we]=f.useState(null),[de,ke]=f.useState(null),[ge,$e]=f.useState(new Set),[be,me]=f.useState(!1),{comments:Ue,addComment:Ee,refresh:We}=kn({relatedType:"contact",relatedId:h?.id});f.useEffect(()=>{h?.id&&We()},[h?.id,We]),f.useEffect(()=>{const F=t.state?.contactID;F&&(ke(F),e(t.pathname,{replace:!0,state:{}}))},[t,e]),f.useEffect(()=>{if(de&&s.length>0&&!i){const F=s.find(ue=>ue.id===de);F?p(F):H.error("Contact not found."),ke(null)}},[de,s,i]);const tt=f.useCallback(async(F=null)=>{o(!0);try{const ue=await re.get("/contacts/admin/fetch-all"),le=[...Array.isArray(ue.data)?ue.data:[]].sort((Ie,K)=>{const ie=Ie?.created_at||Ie?.updated_at||0,Me=K?.created_at||K?.updated_at||0;return new Date(Me)-new Date(ie)});if(r(le),F){const Ie=le.find(K=>K.id===F);p(Ie||null)}}catch(ue){console.error(ue),r([]),ue.response?.status===403?H.error("Permission denied. Only CEO, Admin, or Group Manager can access this page."):H.error("Failed to fetch contacts. Please try again later.")}finally{o(!1)}},[p]),lt=f.useCallback(async()=>{try{const F=await re.get("/accounts/admin/fetch-all"),De=[...Array.isArray(F.data)?F.data:[]].sort((le,Ie)=>(le?.name||"").localeCompare(Ie?.name||""));c(De)}catch(F){console.error(F),c([]),F.response?.status===403&&H.warn("Unable to load accounts (permission denied).")}},[]),Fe=f.useCallback(()=>{window.open("/manager/accounts?openModal=1","_blank","noopener,noreferrer")},[]),st=f.useCallback(async()=>{try{const F=await re.get("/users/all"),De=[...Array.isArray(F.data)?F.data:[]].sort((le,Ie)=>wl(le).localeCompare(wl(Ie)));d(De)}catch(F){console.error(F),d([]),F.response?.status===403&&H.warn("Unable to load users for assignment (permission denied).")}},[]),Xe=f.useCallback(async F=>{try{const ue=await re.get(`/activities/contact/${F}`);Ne(ue.data&&typeof ue.data=="object"?ue.data:{})}catch(ue){console.error(ue),ue.response?.status===404&&(console.warn("No activities found for this account."),Ne({}))}},[]);f.useEffect(()=>{tt(),lt(),st()},[tt,lt,st]);const Ze=f.useMemo(()=>{const F=new Map;l.forEach(De=>{De?.id&&De?.name&&F.set(String(De.id),De.name)}),s.forEach(De=>{De?.account_id&&De?.account?.name&&F.set(String(De.account_id),De.account.name)});const ue=Array.from(F.entries()).sort((De,le)=>De[1].localeCompare(le[1])).map(([De,le])=>({value:De,label:le}));return[{value:"Filter by Accounts",label:"Filter by Accounts"},...ue]},[l,s]),Je=f.useMemo(()=>{const F=P.trim().toLowerCase(),ue=U.trim();return s.filter(De=>{const le=[De?.first_name,De?.last_name,De?.email,De?.title,De?.department,De?.account?.name,De?.account?.status,De?.work_phone,De?.mobile_phone_1,De?.mobile_phone_2,De?.assigned_contact?.first_name,De?.assigned_contact?.last_name,De?.contact_creator?.first_name,De?.contact_creator?.last_name,De?.notes,xo(De?.created_at),xo(De?.updated_at)],Ie=F===""||le.some(Me=>Me==null?!1:Me.toString().toLowerCase().includes(F)),K=ue==="Filter by Accounts"||String(De.account_id)===ue,ie=De?.status!=="Inactive";return Ie&&K&&ie})},[s,P,U]),Be=Math.max(1,Math.ceil(Je.length/X)||1);f.useEffect(()=>{je(1)},[P,U]),f.useEffect(()=>{je(F=>{const ue=Math.max(1,Math.ceil(Je.length/X)||1);return F>ue?ue:F})},[Je.length]);const _e=f.useMemo(()=>{const F=(oe-1)*X;return Je.slice(F,F+X)},[Je,oe,X]),pe=()=>je(F=>Math.max(F-1,1)),ce=()=>je(F=>Math.min(F+1,Be)),Q=f.useMemo(()=>{if(!j||!A)return l;const F=s.find(De=>De.id===A);return!F||!F.account||l.some(De=>De.id===F.account.id)?l:[...l,F.account]},[l,j,A,s]),ne=f.useCallback(()=>{v(!1),y(!1),E(null),z(Lb),w(!1),it(!1)},[]),ae=F=>{F.target.id==="modalBackdrop"&&!N&&!k&&ne()},Pe=F=>{const{name:ue,value:De}=F.target;z(le=>({...le,[ue]:De}))},Te=()=>{z(Lb),y(!1),E(null),v(!0)};f.useEffect(()=>{const F=new URLSearchParams(t.search||"");(t.state?.openContactModal||F.get("openModal")==="1")&&(z(Lb),y(!1),E(null),v(!0),it(!1),e(t.pathname,{replace:!0,state:{}}))},[t.state,t.pathname,t.search,e]);const he=async F=>{if(!F)return;const ue=await re.get(`/accounts/get/${F.account_id}`);z({first_name:F.first_name||"",last_name:F.last_name||"",account_id:ue.data.id?ue.data.id:"",title:F.title||"",department:F.department||"",email:F.email||"",work_phone:F.work_phone||"",mobile_phone_1:F.mobile_phone_1||"",mobile_phone_2:F.mobile_phone_2||"",notes:F.notes||"",assigned_to:F.assigned_to?String(F.assigned_to):""}),y(!0),E(F.id),v(!0),p(null)},He=F=>{if(!F)return;const ue=wl(F)||"this contact";_({title:"Archive Contact",message:a.jsxs("span",{children:["Are you sure you want to archive"," ",a.jsx("span",{className:"font-semibold",children:ue}),"? You can restore it later if needed."]}),confirmLabel:"Archive Contact",cancelLabel:"Cancel",variant:"archive",action:{type:"archive",targetId:F.id,name:ue}})},qe=F=>{const ue=_e.find(De=>De.id===F);ue&&ue.contact_creator?.id===n?.id&&$e(De=>{const le=new Set(De);return le.has(F)?le.delete(F):le.add(F),le})},nt=()=>{const F=_e.filter(ue=>ue.contact_creator?.id===n?.id);ge.size===F.length&&F.length>0?$e(new Set):$e(new Set(F.map(ue=>ue.id)))},ot=()=>{if(ge.size===0)return;const F=ge.size;_({title:"Archive Contacts",message:a.jsxs("span",{children:["Are you sure you want to archive"," ",a.jsx("span",{className:"font-semibold",children:F})," contact",F!==1?"s":"","? You can restore them later if needed."]}),confirmLabel:`Archive ${F} Contact${F!==1?"s":""}`,cancelLabel:"Cancel",variant:"archive",action:{type:"bulk-archive",targetIds:Array.from(ge),count:F}})},[Re,it]=f.useState(!1),St=F=>{F.preventDefault(),it(!0);const ue=M.first_name.trim(),De=M.last_name.trim();if(!ue||!De){H.error("First name and last name are required.");return}if(!M.account_id){H.error("Account is required.");return}if(!M.assigned_to){H.error("Assigned To is required.");return}const Ie=M.email?.trim();if(!Ie){H.error("Email is required.");return}if(!Ie.includes("@")){H.error("Email must contain '@'.");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(Ie)){H.error("Please enter a valid email address.");return}const ie={first_name:ue,last_name:De,account_id:Number(M.account_id),title:M.title?.trim()||null,department:M.department?.trim()||null,email:M.email?.trim().toLowerCase()||null,work_phone:M.work_phone?.trim()||null,mobile_phone_1:M.mobile_phone_1?.trim()||null,mobile_phone_2:M.mobile_phone_2?.trim()||null,notes:M.notes?.trim()||null,assigned_to:M.assigned_to?Number(M.assigned_to):null},Me=j&&A?"update":"create",Ke=`${ue} ${De}`.trim();_({title:Me==="create"?"Confirm New Contact":"Confirm Update",message:Me==="create"?a.jsxs("span",{children:["Are you sure you want to add"," ",a.jsx("span",{className:"font-semibold",children:Ke})," to your contacts?"]}):a.jsxs("span",{children:["Save changes to ",a.jsx("span",{className:"font-semibold",children:Ke}),"?"]}),confirmLabel:Me==="create"?"Create Contact":"Update Contact",cancelLabel:"Cancel",variant:"primary",action:{type:Me,payload:ie,targetId:A||null,name:Ke}})},Et=async()=>{if(!S?.action){_(null);return}const{action:F}=S,{type:ue,payload:De,targetId:le,name:Ie}=F;T(!0);try{if(ue==="create"){w(!0),await re.post("/contacts/admin",De),H.success(`Contact "${Ie}" created successfully.`);const K=h?.id||null;ne(),await tt(K)}else if(ue==="update"){if(!le)throw new Error("Missing contact identifier for update.");w(!0),await re.put(`/contacts/admin/${le}`,De),H.success(`Contact "${Ie}" updated successfully.`);const K=h?.id&&h.id===le?le:h?.id||null;ne(),await tt(K),h?.id===le&&p(null)}else if(ue==="archive"){if(!le)throw new Error("Missing contact identifier for archiving.");const K=h?.id;q(le),await re.put(`/contacts/admin/${le}`,{status:"Inactive"}),H.success(`Contact "${Ie}" archived successfully.`),await tt(K&&K!==le?K:null),K===le&&p(null)}else if(ue==="bulk-archive"){const{targetIds:K,count:ie}=F;if(!K||K.length===0)throw new Error("Missing contact identifiers for bulk archiving.");me(!0),await Promise.all(K.map(Me=>re.put(`/contacts/admin/${Me}`,{status:"Inactive"}))),H.success(`${ie} contact${ie!==1?"s":""} archived successfully.`),$e(new Set),await tt(),p(null)}}catch(K){console.error(K);const ie=ue==="create"?"Failed to create contact. Please review the details and try again.":ue==="update"?"Failed to update contact. Please review the details and try again.":ue==="bulk-archive"?"Failed to archive contacts. Please try again.":"Failed to archive contact. Please try again.",Me=K.response?.data?.detail||ie;H.error(Me)}finally{(ue==="create"||ue==="update")&&w(!1),ue==="archive"&&q(null),ue==="bulk-archive"&&me(!1),T(!1),_(null)}},Tt=()=>{k||_(null)},Nt=F=>{p(F),V("Overview")},xe=()=>p(null),ve=F=>{F.target.id==="contactModalBackdrop"&&!k&&xe()},Oe=S?.action?.type==="delete"?S.action.targetId:null,Ce=h&&(R===h.id||Oe===h.id),Qe=h&&R===h.id,G=h?a.jsx("div",{id:"contactModalBackdrop",onClick:ve,className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-6xl max-h-[92vh] overflow-y-auto hide-scrollbar animate-scale-in font-inter relative",onClick:F=>F.stopPropagation(),children:[a.jsxs("div",{className:"bg-tertiary w-full rounded-t-xl relative p-3 lg:p-3",children:[a.jsx("h1",{className:"lg:text-3xl text-xl text-white font-semibold text-center w-full",children:"Contact"}),a.jsx("button",{onClick:xe,className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-white cursor-pointer",children:a.jsx(Ja,{size:25})})]}),a.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between lg:flex-row lg:items-center lg:justify-between mt-3 gap-2 px-2 md:items-center lg:gap-4 md:mx-7 lg:mx-7",children:[a.jsx("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:a.jsx("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-800",children:wl(h)||"Unnamed contact"})}),a.jsx("div",{className:"flex flex-col sm:flex-row sm:space-x-3 space-y-2 sm:space-y-0",children:n?.id===h?.contact_creator?.id&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{className:"inline-flex items-center justify-center w-full sm:w-auto bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 disabled:opacity-70 transition text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",onClick:()=>he(h),disabled:k||S?.action?.type==="update"&&S.action.targetId===h.id,children:[a.jsx(gn,{className:"mr-2"}),"Edit"]}),a.jsx("button",{className:"inline-flex items-center justify-center w-full sm:w-auto px-4 py-2 rounded-md text-sm bg-orange-500 text-white hover:bg-orange-600 transition focus:outline-none focus:ring-2 focus:ring-orange-400",onClick:()=>He(h),disabled:!!Ce,children:Qe?"Archiving...":a.jsxs(a.Fragment,{children:[a.jsx(Zt,{className:"mr-2"}),"Archive"]})})]})})]}),a.jsx("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-2 px-2 lg:gap-4 md:mx-7 lg:mx-7",children:a.jsx("p",{className:"text-sm text-gray-500",children:h.account?.name||"No associated account"})}),a.jsx("div",{className:"border-b border-gray-200 my-5"}),a.jsxs("div",{className:"p-6 lg:p-4",children:[a.jsx("div",{className:"flex w-full bg-[#6A727D] text-white mt-1 overflow-x-auto mb-6",children:["Overview","Notes","Activities"].map(F=>a.jsx("button",{onClick:()=>V(F),className:`flex-1 min-w-[90px] px-4 py-2.5 text-xs sm:text-sm font-medium text-center transition-all duration-200 border-b-2
        ${Z===F?"bg-paper-white text-[#6A727D] border-white":"text-white hover:bg-[#5c636d]"}`,children:F},F))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 items-start",children:[a.jsxs("div",{className:"lg:col-span-3",children:[Z==="Overview"&&a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 md:p-8 border border-gray-200",children:a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4 sm:gap-6 text-sm text-gray-700",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Contact Name:"}),a.jsx("p",{children:wl(h)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Title:"}),a.jsx("p",{children:h.title||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Email:"}),a.jsx("p",{children:h.email?a.jsx("a",{href:`mailto:${h.email}`,className:"text-blue-600 hover:underline break-all",children:h.email}):"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Department:"}),a.jsx("p",{children:h.department||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Work Phone:"}),a.jsx("p",{children:h.work_phone||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Mobile Phone 1:"}),a.jsx("p",{children:h.mobile_phone_1||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Mobile Phone 2:"}),a.jsx("p",{children:h.mobile_phone_2||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Assigned To:"}),a.jsx("p",{children:h.assigned_contact?`${h.assigned_contact.first_name} ${h.assigned_contact.last_name}`:"Unassigned"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created By:"}),a.jsx("p",{children:h.contact_creator?`${h.contact_creator.first_name} ${h.contact_creator.last_name}`:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created At:"}),a.jsx("p",{children:xo(h.created_at)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Last Updated:"}),a.jsx("p",{children:xo(h.updated_at)||"N/A"})]})]})}),Z==="Notes"&&a.jsxs("div",{className:"mt-4 w-full",children:[a.jsx("div",{className:"flex flex-wrap items-center justify-between mb-4 gap-2",children:a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words",children:"Contact Note"})}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 shadow-sm break-words",children:[a.jsx("div",{className:"flex items-start justify-between",children:a.jsx("div",{children:a.jsx("p",{className:"text-sm font-medium text-gray-800 break-words",children:"Note"})})}),a.jsx("div",{className:"mt-3 text-sm text-gray-700 whitespace-pre-wrap break-words",children:h.notes||"No notes available."})]}),a.jsx(Tn,{comments:Ue,onAddComment:Ee})]}),Z==="Activities"&&a.jsxs("div",{className:"space-y-2 w-full h-full max-h-[50dvh] overflow-y-auto bg-gray-50 p-2 hide-scrollbar rounded-lg border border-gray-200 shadow-sm",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words border-b border-gray-300 py-2",children:"Related Activities"}),a.jsxs("div",{className:"space-y-2 text-sm",children:[ye.tasks&&ye.tasks.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>we(fe==="tasks"?null:"tasks"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Qt,{className:"text-blue-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Tasks (",ye.tasks.length,")"]})]}),fe==="tasks"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),fe==="tasks"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:ye.tasks.map((F,ue)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/manager/tasks",{state:{taskID:F.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-blue-600 mt-1",children:a.jsx(Qt,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:F.subject||F.title||"Task"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:F.description||"No description"}),F.assigned_to&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Assigned: ",F.assigned_to.first_name," ",F.assigned_to.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:xo(F.due_date||F.created_at)})]},`task-${ue}`))})]}),ye.meetings&&ye.meetings.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>we(fe==="meetings"?null:"meetings"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ot,{className:"text-green-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Meetings (",ye.meetings.length,")"]})]}),fe==="meetings"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),fe==="meetings"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:ye.meetings.map((F,ue)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/manager/meetings",{state:{meetingID:F.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-green-600 mt-1",children:a.jsx(Ot,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:F.subject||F.title||"Meeting"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:F.description||F.location||"No description"}),F.host&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Host: ",F.host.first_name," ",F.host.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:xo(F.start_time||F.created_at)})]},`meeting-${ue}`))})]}),ye.calls&&ye.calls.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>we(fe==="calls"?null:"calls"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(It,{className:"text-purple-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Calls (",ye.calls.length,")"]})]}),fe==="calls"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),fe==="calls"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:ye.calls.map((F,ue)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/manager/calls",{state:{callID:F.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-purple-600 mt-1",children:a.jsx(It,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:F.subject||F.title||"Call"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:F.direction||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:xo(F.call_time||F.created_at)})]},`call-${ue}`))})]}),ye.deals&&ye.deals.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>we(fe==="deals"?null:"deals"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(sa,{className:"text-indigo-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Deals (",ye.deals.length,")"]})]}),fe==="deals"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),fe==="deals"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:ye.deals.map((F,ue)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/manager/deals",{state:{dealID:F.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-indigo-600 mt-1",children:a.jsx(sa,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("h4",{className:"font-medium text-blue-600 break-words text-sm",children:[F.deal_id?F.deal_id.replace(/D(\d+)-\d+-/,"D$1-"):"--"," ",F.name||F.title||"Deal"]}),a.jsx("p",{className:"text-xs text-gray-500 break-words capitalize",children:F.stage||F.description||"No description"})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:xo(F.close_date||F.created_at)})]},`deal-${ue}`))})]}),ye.quotes&&ye.quotes.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>we(fe==="quotes"?null:"quotes"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ia,{className:"text-orange-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Quotes (",ye.quotes.length,")"]})]}),fe==="quotes"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),fe==="quotes"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:ye.quotes.map((F,ue)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/manager/quotes",{state:{quoteID:F.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-orange-600 mt-1",children:a.jsx(ia,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:(F.quote_id?F.quote_id.replace(/Q(\d+)-\d+-/,"Q$1-"):"--")||"Quote"}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:F.status||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:xo(F.presented_date)||""})]},`quote-${ue}`))})]}),(!ye||(!ye.tasks||ye.tasks.length===0)&&(!ye.meetings||ye.meetings.length===0)&&(!ye.calls||ye.calls.length===0)&&(!ye.quotes||ye.quotes.length===0)&&(!ye.deals||ye.deals.length===0)&&(!ye.contacts||ye.contacts.length===0))&&a.jsx("div",{className:"text-center py-8 text-gray-500",children:a.jsx("p",{children:"No related activities found for this account."})})]})]})]}),a.jsx("div",{className:"flex flex-col gap-4",children:a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Quick Actions"}),a.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[a.jsxs("button",{onClick:()=>e("/manager/calls",{state:{openCallModal:!0,initialCallData:{subject:`Call with ${wl(h)||""}`.trim(),relatedType1:"Account",relatedTo1:h?.account_id?String(h.account_id):h?.account?.id?String(h.account.id):"",relatedType2:"Contact",relatedTo2:h?.id?String(h.id):"",assigned_to:h?.assigned_contact?.id?String(h.assigned_contact.id):"",direction:"Outgoing",status:"Planned"}}}),className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(It,{className:"text-gray-600 w-4 h-4"}),"Schedule Call"]}),a.jsxs("button",{type:"button",onClick:()=>{if(!h?.email){alert("No email address available");return}const F=encodeURIComponent(h.email),ue=encodeURIComponent(""),De=encodeURIComponent(""),le=`mailto:${F}?subject=${ue}&body=${De}`;window.location.href=le},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(rn,{className:"text-gray-600 w-4 h-4"}),"Send E-mail"]}),a.jsxs("button",{className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",onClick:()=>e("/manager/meetings",{state:{openMeetingModal:!0,initialMeetingData:{subject:`Meeting with ${wl(h)||""}`.trim(),relatedType1:"Account",relatedTo1:h?.account_id?String(h.account_id):h?.account?.id?String(h.account.id):"",relatedType2:"Contact",relatedTo2:h?.id?String(h.id):"",assignedTo:h?.assigned_contact?.id?String(h.assigned_contact.id):"",status:"Planned"}}}),children:[a.jsx(Ot,{className:"text-gray-600 w-4 h-4"}),"Book Meeting"]}),a.jsxs("button",{onClick:()=>e("/manager/tasks",{state:{openTaskModal:!0,initialTaskData:{subject:`Task for ${wl(h)||""}`.trim(),relatedType1:"Account",relatedTo1:h?.account_id?String(h.account_id):h?.account?.id?String(h.account.id):"",relatedType2:"Contact",relatedTo2:h?.id?String(h.id):"",assignedTo:h?.assigned_contact?.id?String(h.assigned_contact.id):"",priority:"NORMAL",status:"Not Started"}}}),className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(Qt,{className:"text-gray-600 w-4 h-4"}),"Tasks"]})]})]})})]})]})]})}):null,W=a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[i&&a.jsx(Wt,{message:"Loading contacts..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0 w-full",children:[a.jsxs("h2",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(Za,{className:"mr-2 text-blue-600"})," Contacts Management"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{onClick:()=>{Te(),it(!1)},className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 rounded-md hover:bg-gray-800 text-sm sm:text-base self-end sm:self-auto cursor-pointer",children:[a.jsx(aa,{className:"mr-2"})," Add Contact"]})})]}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search contacts",value:P,onChange:F=>D(F.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsx("div",{className:"w-full lg:w-1/4",children:a.jsx("select",{value:U,onChange:F=>B(F.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:Ze.map(F=>a.jsx("option",{value:F.value,children:F.label},F.value??F.label))})})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[600px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 text-sm tracking-wide font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 w-12",children:a.jsx("input",{type:"checkbox",checked:ge.size>0&&ge.size===_e.filter(F=>F.contact_creator?.id===n?.id).length&&_e.filter(F=>F.contact_creator?.id===n?.id).length>0,onChange:nt,className:"w-4 h-4 cursor-pointer"})}),a.jsx("th",{className:"py-3 px-4 truncate",children:"Contact"}),a.jsx("th",{className:"py-3 px-4",children:"Account"}),a.jsx("th",{className:"py-3 px-4 truncate",children:"Contact Info"}),a.jsx("th",{className:"py-3 px-4",children:"Department"}),a.jsx("th",{className:"py-3 px-4",children:"Assigned To"}),a.jsx("th",{className:"py-3 px-4",children:"Created"}),a.jsx("th",{className:"py-3 px-4 w-12",children:ge.size>0&&a.jsx("button",{onClick:ot,className:"text-orange-500 hover:text-orange-700 transition",title:"Archive selected contacts",disabled:be,children:a.jsx(Zt,{size:18})})})]})}),a.jsx("tbody",{children:i?a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:8,children:"Loading contacts..."})}):Je.length>0?_e.map(F=>{const ue=[{Icon:rn,value:F.email,key:"email"},{Icon:It,value:F.work_phone,key:"work_phone"},{Icon:fd,value:F.mobile_phone_1,key:"mobile_phone_1"},{Icon:fd,value:F.mobile_phone_2,key:"mobile_phone_2"}].filter(De=>!!De.value);return a.jsxs("tr",{className:"hover:bg-gray-50 text-sm cursor-pointer transition",children:[a.jsx("td",{className:"py-3 px-4",children:n?.id===F.contact_creator?.id&&a.jsx("input",{type:"checkbox",checked:ge.has(F.id),onChange:De=>{De.stopPropagation(),qe(F.id)},className:"w-4 h-4 cursor-pointer"})}),a.jsxs("td",{className:"py-3 px-4 align-top",onClick:()=>{Nt(F),Xe(F.id)},children:[a.jsx("div",{className:"font-medium text-blue-600 hover:underline break-all text-sm",children:wl(F)||"--"}),a.jsx("div",{className:"text-xs text-gray-500",children:F.title||"No title"})]}),a.jsx("td",{className:"py-3 px-4 align-top",onClick:()=>{Nt(F),Xe(F.id)},children:a.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-700",children:[a.jsx(Vx,{className:"text-gray-500 flex-shrink-0"}),a.jsx("span",{className:"break-words",children:F.account?.name||"--"})]})}),a.jsx("td",{className:"py-3 px-4 align-top",onClick:()=>{Nt(F),Xe(F.id)},children:ue.length>0?a.jsx("div",{className:"space-y-1 text-gray-700",children:ue.map(({Icon:De,value:le,key:Ie})=>{const K=wt.createElement(De,{className:"text-gray-500 flex-shrink-0"});return a.jsxs("div",{className:"flex items-center space-x-2 break-all text-sm",children:[K,a.jsx("span",{children:le})]},Ie)})}):a.jsx("span",{className:"text-gray-400 text-sm",children:"--"})}),a.jsx("td",{className:"py-3 px-4 align-top",onClick:()=>{Nt(F),Xe(F.id)},children:a.jsxs("div",{className:"flex items-center space-x-2 text-gray-700 text-sm",children:[a.jsx(sa,{className:"text-gray-500 flex-shrink-0"}),a.jsx("span",{children:F.department||"--"})]})}),a.jsx("td",{className:"py-3 px-4 align-top",onClick:()=>{Nt(F),Xe(F.id)},children:a.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[a.jsx(ra,{className:"text-gray-500 flex-shrink-0"}),a.jsx("span",{children:F.assigned_contact?`${F.assigned_contact.first_name} ${F.assigned_contact.last_name}`:"Unassigned"})]})}),a.jsx("td",{className:"py-3 px-4 align-top",onClick:()=>{Nt(F),Xe(F.id)},children:a.jsxs("div",{className:"flex items-center space-x-2 text-gray-500",children:[a.jsx(Ot,{className:"text-gray-500 flex-shrink-0"}),a.jsx("span",{className:"text-xs",children:xo(F.created_at)||"--"})]})})]},F.id)}):a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:8,children:"No contacts found."})})})]})}),a.jsx(ca,{className:"mt-4",totalItems:Je.length,pageSize:X,currentPage:oe,onPrev:pe,onNext:ce,onPageSizeChange:F=>{se(F),je(1)},pageSizeOptions:[10,20,30,40,50],label:"contacts"})]}),J=x?a.jsx("div",{id:"modalBackdrop",onClick:ae,className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-full sm:max-w-3xl rounded-2xl shadow-lg p-4 sm:p-6 md:p-8 relative border border-gray-200 overflow-y-auto max-h-[90vh] hide-scrollbar",onClick:F=>F.stopPropagation(),children:[a.jsx("button",{onClick:()=>{ne(),it(!1)},className:"absolute top-4 right-4 text-gray-500 hover:text-black transition disabled:opacity-60",disabled:N||k,children:a.jsx(ea,{size:22})}),a.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800 mb-4 sm:mb-6 flex items-center justify-center",children:j?"Edit Contact":"Add New Contact"}),a.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",onSubmit:St,noValidate:!0,children:[a.jsx(qc,{label:"First Name",name:"first_name",value:M.first_name,onChange:Pe,placeholder:"First name",required:!0,isSubmitted:Re}),a.jsx(qc,{label:"Last Name",name:"last_name",value:M.last_name,onChange:Pe,placeholder:"Last name",required:!0,isSubmitted:Re}),a.jsx(C8,{label:"Account",value:M.account_id,onChange:F=>z(ue=>({...ue,account_id:F})),items:j?Q:l||[],getLabel:F=>F?.name??"",placeholder:"Search account...",actions:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{type:"button",onClick:Fe,disabled:N,title:"Add account",className:"inline-flex items-center justify-center w-8 h-8 rounded-md border border-gray-300 text-gray-600 hover:bg-gray-50 transition disabled:opacity-60",children:a.jsx(aa,{size:16})}),a.jsx("button",{type:"button",onClick:lt,disabled:N,title:"Refresh accounts",className:"inline-flex items-center justify-center w-8 h-8 rounded-md border border-gray-300 text-gray-600 hover:bg-gray-50 transition disabled:opacity-60",children:a.jsx(Br,{size:16})})]}),disabled:N||(j?Q.length===0:l.length===0),required:!0,isSubmitted:Re}),a.jsx(C8,{label:"Assigned To",value:M.assigned_to,onChange:F=>z(ue=>({...ue,assigned_to:F})),items:u||[],getLabel:F=>`${F?.first_name??""} ${F?.last_name??""} (${F?.role??""})`.trim(),placeholder:"Search assignee...",required:!0,isSubmitted:Re,disabled:N||u.length===0}),a.jsx(qc,{label:"Title",name:"title",value:M.title,onChange:Pe,placeholder:"Job title",disabled:N}),a.jsx(qc,{label:"Department",name:"department",value:M.department,onChange:Pe,placeholder:"Department",disabled:N}),a.jsx(qc,{label:"Email",name:"email",type:"email",value:M.email,onChange:Pe,placeholder:"example@email.com",required:!0,isSubmitted:Re}),a.jsx(qc,{label:"Work Phone",name:"work_phone",value:M.work_phone,onChange:Pe,placeholder:"09xx xxx xxxx",disabled:N}),a.jsx(qc,{label:"Mobile Phone 1",name:"mobile_phone_1",value:M.mobile_phone_1,onChange:Pe,placeholder:"09xx xxx xxxx",disabled:N}),a.jsx(qc,{label:"Mobile Phone 2",name:"mobile_phone_2",value:M.mobile_phone_2,onChange:Pe,placeholder:"09xx xxx xxxx",disabled:N}),a.jsx(u7e,{label:"Notes",name:"notes",value:M.notes,onChange:Pe,placeholder:"Additional details...",rows:3,disabled:N,className:"md:col-span-2"}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-2 md:col-span-2 mt-4",children:[a.jsx("button",{type:"button",onClick:()=>{ne(),it(!1)},className:"w-full sm:w-auto px-4 py-2 text-white bg-red-400 border border-red-300 rounded hover:bg-red-500 transition disabled:opacity-70",disabled:N||k,children:"Cancel"}),a.jsx("button",{type:"submit",className:"w-full sm:w-auto px-4 py-2 text-white border border-tertiary bg-tertiary rounded hover:bg-secondary transition disabled:opacity-70",disabled:N||k,children:N?"Saving...":j?"Update Contact":"Save Contact"})]})]})]})}):null,Y=S?a.jsx(m7e,{open:!0,title:S.title,message:S.message,confirmLabel:S.confirmLabel,cancelLabel:S.cancelLabel,variant:S.variant,onConfirm:Et,onCancel:Tt,loading:k}):null;return a.jsxs(a.Fragment,{children:[W,G,J,Y]})}function qc({label:e,name:t,value:n,onChange:s,placeholder:r,type:i="text",required:o=!1,disabled:l=!1,isSubmitted:c=!1,className:u=""}){const d=c&&!n?.trim();return a.jsxs("div",{children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",o&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:i,name:t,value:n??"",onChange:s,placeholder:r,required:o,disabled:l,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border focus:ring-2
          ${d?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}
          ${u}
        `})]})}function C8({label:e,items:t=[],value:n="",onChange:s,getLabel:r,placeholder:i="Search...",disabled:o=!1,className:l="",required:c=!1,isSubmitted:u=!1,actions:d=null}){const h=u&&c&&!n;return a.jsxs("div",{className:l,children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",c&&a.jsx("span",{className:"text-red-500",children:"*"})]}),d?a.jsx("div",{className:"flex items-center",children:d}):null]}),a.jsx(d7e,{items:t,value:n??"",onChange:s,getLabel:r,placeholder:i,disabled:o,hasError:h})]})}function d7e({items:e=[],value:t="",onChange:n,getLabel:s,placeholder:r="Search...",disabled:i=!1,maxRender:o=200,hasError:l=!1}){const[c,u]=f.useState(!1),[d,h]=f.useState(""),p=f.useRef(null),x=e.find(y=>String(y.id)===String(t)),v=x?s(x):"",j=f.useMemo(()=>{const y=d.trim().toLowerCase();return(y?e.filter(w=>(s(w)||"").toLowerCase().includes(y)):e).slice(0,o)},[e,d,s,o]);return f.useEffect(()=>{const y=N=>{p.current&&!p.current.contains(N.target)&&u(!1)};return document.addEventListener("mousedown",y),()=>document.removeEventListener("mousedown",y)},[]),f.useEffect(()=>{c||h("")},[c]),a.jsxs("div",{ref:p,className:"relative w-full",children:[a.jsx("input",{disabled:i,value:c?d:v,placeholder:r,onFocus:()=>!i&&u(!0),onChange:y=>{h(y.target.value),c||u(!0)},className:`w-full border rounded-md px-2 py-1.5 text-sm outline-none focus:ring-2
          ${l?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}`}),c&&!i&&a.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg overflow-hidden",children:[a.jsx("div",{className:"max-h-56 overflow-y-auto",children:j.length>0?j.map(y=>{const N=String(y.id),w=s(y),S=String(t)===N;return a.jsx("button",{type:"button",onClick:()=>{n(N),u(!1)},className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-50 ${S?"bg-blue-50":""}`,children:w||"--"},N)}):a.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No results"})}),e.length>o&&a.jsxs("div",{className:"px-3 py-2 text-[11px] text-gray-400 border-t",children:["Showing first ",o," results  keep typing to narrow."]})]})]})}function u7e({label:e,name:t,value:n,onChange:s,placeholder:r,rows:i=3,disabled:o=!1,className:l=""}){return a.jsxs("div",{className:l,children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsx("textarea",{name:t,value:n??"",onChange:s,placeholder:r,rows:i,disabled:o,className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100 resize-none"})]})}function m7e({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o=!1,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":i==="archive"?"bg-orange-500 hover:bg-orange-600 border border-orange-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsx("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${u}`,disabled:o,children:o?"Processing...":s})]})]})})}const ZA=e=>e?new Date(e).toLocaleString("en-US",{month:"short",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).replace(",",""):"";function jJ({lead:e,onBack:t,fetchLeads:n,onEdit:s,onArchive:r,setSelectedLead:i,relatedActs:o}){const l=kt(),{leadID:c}=Wo(),{user:u}=Vt(),[d,h]=f.useState(e||null),[p,x]=f.useState("Overview"),[v,j]=f.useState(""),y=d?.status?.toUpperCase()==="QUALIFIED",[N,w]=f.useState(null),S=d&&u&&d.creator?.id===u.id,[_,k]=f.useState({name:"",website:"",countryCode:"",phone_number:"",billing_address:"",shipping_address:"",industry:"",status:"Prospect",territory_id:null,assigned_to:null,created_by:null}),[T,A]=f.useState({last_name:"",first_name:"",account_id:null,title:"",department:"",email:"",work_phone:"",mobile_phone_1:"",mobile_phone_2:"",notes:"",assigned_to:null,created_by:null}),[E,M]=f.useState({name:"Converted from Lead",account_id:null,primary_contact_id:null,stage:"Prospecting",probability:10,amount:0,currency:"PHP",description:"Initial deal from lead conversion.",assigned_to:null,created_by:null}),z=async()=>{try{if(e){h(e),j(e.status||"New");return}if(!c)return;const R=await re.get(`/leads/get/${c}`);h(R.data),j(R.data.status||"New"),k({name:R.data.company_name||"",website:"",countryCode:"+63",phone_number:"",billing_address:"",shipping_address:"",industry:"",status:"Prospect",territory_id:R.data.territory?.id||null,assigned_to:R.data.assigned_to?.id||null,created_by:R.data.creator?.id||null}),A({last_name:R.data.last_name||"",first_name:R.data.first_name||"",account_id:null,title:R.data.title||"",department:R.data.department||"",email:R.data.email||"",work_phone:R.data.work_phone||"",mobile_phone_1:R.data.mobile_phone_1||"",mobile_phone_2:R.data.mobile_phone_2||"",notes:"",assigned_to:R.data.assigned_to?.id||null,created_by:R.data.creator?.id||null}),M({name:"Converted from Lead",account_id:null,primary_contact_id:null,stage:"Prospecting",probability:10,amount:0,currency:"PHP",description:"Initial deal from lead conversion.",assigned_to:R.data.assigned_to?.id||null,created_by:R.data.creator?.id||null})}catch(R){console.error(R)}};f.useEffect(()=>{e?(h(e),j(e.status||"New")):c&&z()},[c,e]);const P=async()=>{try{if(v==="Converted"&&d?.status?.toUpperCase()!=="QUALIFIED"){H.error("Lead must be Qualified before it can be converted.");return}const R=await re.put(`/leads/${d.id}/update/status`,{status:v});H.success("Lead status updated successfully");const q={...d,status:R.data.status};h(q),i&&i(q),n&&n(),t&&t()}catch(R){console.error(R),H.error("Failed to update lead status")}},D=async R=>{const q={..._,assigned_to:R.assigned_to?.id,billing_address:R.address,shipping_address:R.address,created_by:R.creator?.id,industry:null,name:R.company_name,phone_number:R.work_phone,status:"Prospect",territory_id:R.territory?.id,website:""};console.log("Account data: ",q),console.log("Contact data: ",T),console.log("Deal data: ",E),console.log("Lead data: ",R);try{const V=(await re.post("/accounts/convertedLead",q)).data.id,oe={...T,account_id:V,assigned_to:R.assigned_to?.id,created_by:R.creator?.id,department:R.department,email:R.email,first_name:R.first_name,last_name:R.last_name,mobile_phone_1:R.mobile_phone_1,mobile_phone_2:R.mobile_phone_2,notes:R.notes,title:R.title,work_phone:R.work_phone},X=(await re.post("/contacts/convertedLead",oe)).data.id,se=()=>{switch(E.stage){case"PROSPECTING":return 10;case"QUALIFICATION":return 25;case"PROPOSAL":return 60;case"NEGOTIATION":return 80;case"CLOSED_WON":return 100;case"CLOSED_LOST":return 0;default:return 0}},ye=E.amount&&E.amount!==""?parseFloat(E.amount):0,Ne={...E,account_id:V,assigned_to:R.assigned_to?.id,created_by:R.creator?.id,primary_contact_id:X,probability:se(),stage:"Prospecting"},fe=await re.post("/deals/convertedLead",Ne),we=await re.put(`/leads/convert/${R.id}`);i&&i(null),n(),H.success("Lead converted successfully!"),t()}catch(Z){console.error("Error during conversion:",Z);const V=Z.response?.data?.detail||Z.message||"Failed to convert lead. Please try again.";H.error(V)}},U=R=>{switch((R||"").toUpperCase()){case"NEW":return"bg-indigo-100 text-indigo-700";case"CONTACTED":return"bg-blue-100 text-blue-700";case"QUALIFIED":return"bg-green-100 text-green-700";case"CONVERTED":return"bg-emerald-100 text-emerald-700";case"LOST":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-700"}},B=R=>R.toString().toLowerCase().replace(/\b\w/g,q=>q.toUpperCase());return d?a.jsx(a.Fragment,{children:a.jsx("div",{className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-lg w-full max-w-full sm:max-w-6xl max-h-[90vh] overflow-y-auto hide-scrollbar relative box-border",children:[a.jsx("div",{className:"bg-tertiary w-full rounded-t-xl p-3 lg:p-3",children:a.jsxs("div",{className:"flex items-start justify-between w-full",children:[a.jsx("h1",{className:"lg:text-3xl text-xl text-white font-semibold text-center w-full",children:"Lead"}),a.jsx("button",{onClick:()=>{t?t():l(-1)},className:"text-gray-400 hover:text-white mt-1 cursor-pointer",children:a.jsx(Ja,{size:25})})]})}),a.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between lg:flex-row lg:items-center lg:justify-between mt-3 gap-2 px-2 md:items-center lg:gap-4 md:mx-7 lg:mx-7",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[a.jsxs("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-800",children:[d.first_name," ",d.last_name]}),a.jsx("span",{className:`text-xs sm:text-sm font-medium px-2 sm:px-3 py-1 rounded-full whitespace-nowrap ${U(d.status)}`,children:B(d.status||"New")}),a.jsx("div",{className:"flex flex-col",children:a.jsx("button",{onClick:()=>D(d),disabled:!y,title:y?"Convert Lead":"Lead must be Qualified before converting",className:`px-3 sm:px-4 py-1.5 sm:py-2 rounded-md font-medium text-xs sm:text-sm transition focus:outline-none focus:ring-2
      ${y?"bg-green-600 hover:bg-green-700 text-white focus:ring-green-400":"bg-gray-200 text-gray-400 cursor-not-allowed"}
    `,children:"Convert"})})]}),S&&a.jsxs("div",{className:"flex flex-col sm:flex-row sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsxs("button",{type:"button",onClick:()=>{s&&d&&s(d)},className:"inline-flex items-center justify-center w-full sm:w-auto bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 transition text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",children:[a.jsx(hn,{className:"mr-2"}),"Edit"]}),a.jsxs("button",{type:"button",onClick:()=>{r&&d&&r(d)},className:"inline-flex items-center justify-center w-full sm:w-auto px-4 py-2 rounded-md text-sm bg-orange-500 text-white hover:bg-orange-600 transition focus:outline-none focus:ring-2 focus:ring-orange-400",children:[a.jsx(Zt,{className:"mr-2"}),"Archive"]})]})]}),a.jsx("div",{className:"border-b border-gray-200 my-5"}),a.jsxs("div",{className:"p-4 lg:p-4",children:[a.jsx("div",{className:"flex w-full bg-[#6A727D] text-white mt-1 overflow-x-auto mb-6",children:["Overview","Notes","Activities"].map(R=>a.jsx("button",{onClick:()=>x(R),className:`flex-1 min-w-[90px] px-4 py-2.5 text-xs sm:text-sm font-medium text-center transition-all duration-200 border-b-2
        ${p===R?"bg-paper-white text-[#6A727D] border-white":"text-white hover:bg-[#5c636d]"}`,children:R},R))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 items-start",children:[a.jsxs("div",{className:"lg:col-span-3",children:[p==="Overview"&&a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 md:p-8 border border-gray-200",children:a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4 sm:gap-6 text-sm text-gray-700",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Name:"}),a.jsxs("p",{children:[d.first_name," ",d.last_name||"N/A"]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Company:"}),a.jsx("p",{children:d.company_name||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Job Title:"}),a.jsx("p",{children:d.title||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Department:"}),a.jsx("p",{children:d.department||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Email:"}),a.jsx("p",{children:d.email||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Territory:"}),a.jsx("p",{children:d.territory?.name||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Assigned To:"}),a.jsx("p",{children:d.assigned_to?`${d.assigned_to.first_name} ${d.assigned_to.last_name}`:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created By:"}),a.jsx("p",{children:d.creator?`${d.creator.first_name} ${d.creator.last_name}`:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Work Phone:"}),a.jsx("p",{children:d.work_phone||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Mobile Phone 1:"}),a.jsx("p",{children:d.mobile_phone_1||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Mobile Phone 2:"}),a.jsx("p",{children:d.mobile_phone_2||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Source:"}),a.jsx("p",{children:d.source||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Address:"}),a.jsx("p",{children:d.address||"N/A"})]})]})}),p==="Notes"&&a.jsxs("div",{className:"mt-4 w-full",children:[a.jsx("div",{className:"flex flex-wrap items-center justify-between mb-4 gap-2",children:a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words",children:"Lead Note"})}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 shadow-sm break-words",children:[a.jsx("div",{className:"flex items-start justify-between",children:a.jsx("div",{children:a.jsx("p",{className:"text-sm font-medium text-gray-800 break-words",children:"Note"})})}),a.jsx("div",{className:"mt-3 text-sm text-gray-700 whitespace-pre-wrap break-words",children:d.notes||"No notes available."})]})]}),p==="Activities"&&a.jsxs("div",{className:"space-y-2 w-full h-full max-h-[50dvh] overflow-y-auto bg-gray-50 p-2 hide-scrollbar rounded-lg border border-gray-200 shadow-sm",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words border-b border-gray-300 py-2",children:"Related Activities"}),a.jsxs("div",{className:"space-y-2 text-sm",children:[o.tasks&&o.tasks.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>w(N==="tasks"?null:"tasks"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Qt,{className:"text-blue-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Tasks (",o.tasks.length,")"]})]}),N==="tasks"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),N==="tasks"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:o.tasks.map((R,q)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>l("/manager/tasks",{state:{taskID:R.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-blue-600 mt-1",children:a.jsx(Qt,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:R.subject||R.title||"Task"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:R.description||"No description"}),R.assigned_to&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Assigned:"," ",R.assigned_to.first_name," ",R.assigned_to.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:ZA(R.due_date||R.created_at)})]},`task-${q}`))})]}),o.meetings&&o.meetings.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>w(N==="meetings"?null:"meetings"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ot,{className:"text-green-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Meetings (",o.meetings.length,")"]})]}),N==="meetings"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),N==="meetings"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:o.meetings.map((R,q)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>l("/manager/meetings",{state:{meetingID:R.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-green-600 mt-1",children:a.jsx(Ot,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:R.subject||R.title||"Meeting"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:R.description||R.location||"No description"}),R.host&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Host: ",R.host.first_name," ",R.host.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:ZA(R.start_time||R.created_at)})]},`meeting-${q}`))})]}),o.calls&&o.calls.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>w(N==="calls"?null:"calls"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(It,{className:"text-purple-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Calls (",o.calls.length,")"]})]}),N==="calls"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),N==="calls"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:o.calls.map((R,q)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>l("/manager/calls",{state:{callID:R.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-purple-600 mt-1",children:a.jsx(It,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:R.subject||R.title||"Call"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:R.direction||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:ZA(R.call_time||R.created_at)})]},`call-${q}`))})]}),(!o||(!o.tasks||o.tasks.length===0)&&(!o.meetings||o.meetings.length===0)&&(!o.calls||o.calls.length===0)&&(!o.quotes||o.quotes.length===0)&&(!o.deals||o.deals.length===0)&&(!o.contacts||o.contacts.length===0))&&a.jsx("div",{className:"text-center py-8 text-gray-500",children:a.jsx("p",{children:"No related activities found for this account."})})]})]})]}),a.jsxs("div",{className:"flex flex-col gap-4",children:[a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Quick Actions"}),a.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[a.jsxs("button",{onClick:()=>{d&&l("/manager/calls",{state:{openCallModal:!0,initialCallData:{subject:d.title?`Call regarding ${d.title}`:`Call with ${d.first_name} ${d.last_name}`,relatedType1:"Lead",relatedTo1:String(d.id),relatedType2:null,relatedTo2:null,assigned_to:d.assigned_to?.id?String(d.assigned_to.id):"",direction:"Outgoing",status:"Planned"}}})},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(It,{className:"text-gray-600 w-4 h-4"}),"Schedule Call"]}),a.jsxs("button",{type:"button",onClick:()=>{if(!d?.email){alert("No email address available");return}const R=encodeURIComponent(d.email),q=encodeURIComponent(""),Z=encodeURIComponent(""),V=`mailto:${R}?subject=${q}&body=${Z}`;window.location.href=V},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(rn,{className:"text-gray-600 w-4 h-4"}),"Send E-mail"]}),a.jsxs("button",{className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",onClick:()=>{d&&l("/manager/meetings",{state:{openMeetingModal:!0,initialMeetingData:{subject:d.title?`Meeting regarding ${d.title}`:`Meeting with ${d.first_name||""} ${d.last_name||""}`.trim(),relatedType1:"Lead",relatedTo1:String(d.id),relatedType2:null,relatedTo2:null,assignedTo:d.assigned_to?.id?String(d.assigned_to.id):"",status:"Planned"}}})},children:[a.jsx(Ot,{className:"text-gray-600 w-4 h-4"}),"Book Meeting"]}),a.jsxs("button",{onClick:()=>{d&&l("/manager/tasks",{state:{openTaskModal:!0,initialTaskData:{subject:d.title?`Follow up on ${d.title}`:`Follow up with ${d.first_name||""} ${d.last_name||""}`.trim(),relatedType1:"Lead",relatedTo1:String(d.id),relatedType2:null,relatedTo2:null,assignedTo:d.assigned_to?.id?String(d.assigned_to.id):"",priority:"NORMAL",status:"Not Started"}}})},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(Qt,{className:"text-gray-600 w-4 h-4"}),"Tasks"]})]})]}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm w-full",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Status"}),a.jsxs("select",{className:"border border-gray-200 rounded-md px-2 sm:px-3 py-1.5 w-full text-sm mb-2 focus:ring-2 focus:ring-indigo-500 outline-none",value:v,onChange:R=>j(R.target.value),children:[a.jsx("option",{value:"New",children:"New"}),a.jsx("option",{value:"Contacted",children:"Contacted"}),a.jsx("option",{value:"Qualified",children:"Qualified"}),d?.status?.toUpperCase()==="QUALIFIED"&&a.jsx("option",{value:"Converted",children:"Converted"}),a.jsx("option",{value:"Lost",children:"Lost"})]}),a.jsx("button",{onClick:P,disabled:v===d.status,className:`w-full py-1.5 rounded-md text-sm transition focus:outline-none focus:ring-2 ${v===d.status?"bg-gray-400 cursor-not-allowed text-white":"bg-gray-900 text-white hover:bg-gray-800 focus:ring-gray-400"}`,children:"Update"})]})]})]})]})]})})}):null}const f7e=nh.all(),JA=f7e.map((e,t)=>({code:`+${e.countryCallingCode}`,name:e.countryCode,id:`${e.countryCallingCode}-${e.countryCode}-${t}`})),h7e=e=>e.toString().toLowerCase().replace(/\b\w/g,t=>t.toUpperCase()),g7e=e=>{switch(e.toUpperCase()){case"NEW":return"bg-indigo-100 text-indigo-700";case"CONTACTED":return"bg-blue-100 text-blue-700";case"QUALIFIED":return"bg-green-100 text-green-700";case"CONVERTED":return"bg-emerald-100 text-emerald-700";case"LOST":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-700"}},eT={first_name:"",last_name:"",company_name:"",title:"",department:"",email:"",work_ccode:"+63",work_phone:"",m1_ccode:"+63",mobile_phone_1:"",m2_ccode:"+63",mobile_phone_2:"",address:"",notes:"",source:"",territory_id:null,lead_owner:null,status:"New"};function p7e(){const e=kt(),{leadID:t}=Wo(),{user:n}=Vt();Bs();const[s,r]=f.useState(null),[i,o]=f.useState(!1),[l,c]=f.useState(null),[u,d]=f.useState(null),[h,p]=f.useState([]),[x,v]=f.useState(!1),[j,y]=f.useState(""),[N,w]=f.useState("Filter by Status"),[S,_]=f.useState(1),[k,T]=f.useState(10),[A,E]=f.useState(eT),[M,z]=f.useState(!1),[P,D]=f.useState(null),[U,B]=f.useState(!1),[R,q]=f.useState(null),[Z,V]=f.useState(!1),[oe,je]=f.useState({}),[X,se]=f.useState(new Set),[ye,Ne]=f.useState(!1),[fe,we]=f.useState(null);f.useRef(null);const[de,ke]=f.useState(!1),[ge,$e]=f.useState(null),[be,me]=f.useState({name:"",website:"",countryCode:"+63",phone_number:"",combinedPhoneNumbers:"",billing_address:"",shipping_address:"",industry:"",status:"Prospect",territory_id:null,assigned_to:null,created_by:null}),[Ue,Ee]=f.useState({last_name:"",first_name:"",account_id:null,title:"",department:"",email:"",work_phone:"",mobile_phone_1:"",mobile_phone_2:"",notes:"",assigned_to:null,created_by:null}),[We,tt]=f.useState({name:"Converted from Lead",account_id:null,primary_contact_id:null,stage:"PROSPECTING",probability:10,amount:0,currency:"PHP",description:"Initial deal from lead conversion.",assigned_to:null,created_by:null});f.useEffect(()=>{document.title="Leads | Sari-Sari CRM"},[]);const lt=async()=>{try{const G=await re.get("/leads/getUsers");c(G.data)}catch(G){console.error(`Error fetching users: ${G}`)}},Fe=async()=>{v(!0);try{const G=await re.get("/leads/admin/getLeads");p(G.data),console.log(G.data)}catch(G){console.error(`Error fetching leads: ${G}`)}finally{v(!1)}};f.useEffect(()=>{lt(),Fe()},[]),f.useEffect(()=>{if(t&&h.length>0&&!i&&!M){const G=h.find(W=>W.id===Number(t));G&&r(G)}else!t&&!s&&r(null)},[t,h,i,M]),f.useEffect(()=>{if(ge){const W=(F=>{if(!F)return{code:"+63",number:""};const ue=F.match(/^(\+\d+)\s(.+)$/);if(ue)return{code:ue[1],number:ue[2]};if(F.startsWith("+")){const De=F.match(/^(\+\d{1,3})/);if(De)return{code:De[1],number:F.substring(De[1].length).trim()}}return{code:"+63",number:F}})(ge.work_phone),J=[];ge.work_phone&&J.push(`Work: ${ge.work_phone}`),ge.mobile_phone_1&&J.push(`Mobile 1: ${ge.mobile_phone_1}`),ge.mobile_phone_2&&J.push(`Mobile 2: ${ge.mobile_phone_2}`);const Y=J.length>0?J.join(" | "):"";me({name:ge.company_name||"",website:"",countryCode:W.code,phone_number:W.number,combinedPhoneNumbers:Y,billing_address:ge.address||"",shipping_address:ge.address||"",industry:"",status:"Prospect",territory_id:ge.assigned_to?.territory?.id||null,assigned_to:ge.assigned_to?.id||null,created_by:ge.creator?.id||null}),Ee({last_name:ge.last_name||"",first_name:ge.first_name||"",account_id:null,title:ge.title||"",department:ge.department||"",email:ge.email||"",work_phone:ge.work_phone||"",mobile_phone_1:ge.mobile_phone_1||"",mobile_phone_2:ge.mobile_phone_2||"",notes:ge.notes||"",assigned_to:ge.assigned_to?.id||null,created_by:ge.creator?.id||null}),tt({name:"Converted from Lead",account_id:null,primary_contact_id:null,stage:"PROSPECTING",probability:10,amount:0,currency:"PHP",description:"Initial deal from lead conversion.",assigned_to:ge.assigned_to?.id||null,created_by:ge.creator?.id||null})}},[ge]);const st=G=>y(G.target.value),Xe=f.useMemo(()=>{const G=j.trim().toLowerCase(),W=N.trim().toUpperCase();let J=h.filter(Y=>{const F=Y?.status!=="Inactive",ue=[Y?.first_name,Y?.last_name,Y?.company_name,Y?.title,Y?.email,Y?.work_phone,Y?.assigned_to?`${Y.assigned_to.first_name} ${Y.assigned_to.last_name}`:""],De=G===""||ue.some(Ie=>Ie==null||Ie===""?!1:Ie.toString().toLowerCase().includes(G));let le=!1;return W==="FILTER BY STATUS"?le=(Y.status?Y.status.toUpperCase():"")!=="CONVERTED":le=(Y.status?Y.status.toUpperCase():"")===W,De&&le&&F});return J.sort((Y,F)=>{const ue=new Date(Y.created_at).getTime();return new Date(F.created_at).getTime()-ue}),J},[h,j,N]),Ze=Math.max(1,Math.ceil(Xe.length/k)||1);f.useEffect(()=>{_(1)},[j,N]),f.useEffect(()=>{_(G=>{const W=Math.max(1,Math.ceil(Xe.length/k)||1);return G>W?W:G})},[Xe.length]);const Je=f.useMemo(()=>{const G=(S-1)*k;return Xe.slice(G,G+k)},[Xe,S]),Be=()=>_(G=>Math.max(G-1,1)),_e=()=>_(G=>Math.min(G+1,Ze)),pe=f.useCallback(async G=>{try{const W=await re.get(`/activities/lead/${G}`);je(W.data&&typeof W.data=="object"?W.data:{})}catch(W){console.error(W),W.response?.status===404&&(console.warn("No activities found for this account."),je({}))}},[]),ce=G=>{r(G),pe(G.id)},Q=()=>{r(null),t&&e("/admin/leads",{replace:!0})},ne=()=>{o(!1),E(eT),z(!1),D(null),B(!1),d(null),sessionStorage.removeItem("editLeadData")},ae=G=>{G.target.id==="modalBackdrop"&&ne()},Pe=()=>{E(eT),z(!1),D(null),d(null),o(!0)},Te=G=>{if(!G){console.error("handleEditClick: lead is null or undefined");return}console.log("handleEditClick called with lead:",G),console.log("Current state - leadID:",t,"selectedLead:",s,"showModal:",i);const W=De=>{if(!De)return{code:"+63",number:""};const le=De.match(/^(\+\d+)\s(.+)$/);return le?{code:le[1],number:le[2]}:{code:"+63",number:De}},J=W(G.work_phone),Y=W(G.mobile_phone_1),F=W(G.mobile_phone_2);let ue="";if(G.assigned_to){ue=String(G.assigned_to.id);const De=l?.find(le=>le.id===G.assigned_to.id);d(De)}E({first_name:G.first_name||"",last_name:G.last_name||"",company_name:G.company_name||"",title:G.title||"",department:G.department||"",email:G.email||"",work_ccode:J.code,work_phone:J.number,m1_ccode:Y.code,mobile_phone_1:Y.number,m2_ccode:F.code,mobile_phone_2:F.number,address:G.address||"",notes:G.notes||"",source:G.source||"",territory_id:G.territory?.id||null,lead_owner:ue,status:G.status||"New"}),z(!0),D(G.id),s?(console.log("Coming from detail view - closing detail modal and showing edit form"),r(null),o(!0)):(console.log("Already in list view - showing modal"),o(!0))},he=G=>{if(!G){console.error("handleArchive: lead is null or undefined");return}const W=`${G.first_name} ${G.last_name}`||"this lead";q({title:"Archive Lead",message:a.jsxs("span",{children:["Are you sure you want to archive"," ",a.jsx("span",{className:"font-semibold",children:W}),"? You can restore it later if needed."]}),confirmLabel:"Archive Lead",cancelLabel:"Cancel",variant:"archive",action:{type:"archive",targetId:G.id,name:W}})},He=G=>{const W=Je.find(J=>J.id===G);W&&W.creator?.id===n?.id&&se(J=>{const Y=new Set(J);return Y.has(G)?Y.delete(G):Y.add(G),Y})},qe=()=>{const G=Je.filter(W=>W.creator?.id===n?.id);X.size===G.length&&G.length>0?se(new Set):se(new Set(G.map(W=>W.id)))},nt=()=>{if(X.size===0)return;const G=X.size;q({title:"Archive Leads",message:a.jsxs("span",{children:["Are you sure you want to archive"," ",a.jsx("span",{className:"font-semibold",children:G})," lead",G!==1?"s":"","? You can restore them later if needed."]}),confirmLabel:`Archive ${G} Lead${G!==1?"s":""}`,cancelLabel:"Cancel",variant:"archive",action:{type:"bulk-archive",targetIds:Array.from(X),count:G}})},ot=G=>{const{name:W,value:J}=G.target;if(E(Y=>({...Y,[W]:J})),W==="lead_owner"){const Y=l.find(F=>F.id===parseInt(J));d(Y)}},[Re,it]=f.useState(!1),St=G=>{if(G.preventDefault(),it(!0),!A.last_name?.trim()){H.error("Last name is required.");return}if(!A.company_name?.trim()){H.error("Company is required.");return}if(!A.email?.trim()){H.error("Email is required.");return}if(!A.email.includes("@")){H.error("Email must contain '@'.");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(A.email)){H.error("Please enter a valid email address with a dot in the domain.");return}if(!A.lead_owner){H.error("Please assign a lead owner.");return}const J={...A,territory_id:A.territory_id?parseInt(A.territory_id):null,lead_owner:parseInt(A.lead_owner),work_phone:`${A.work_ccode} ${A.work_phone}`,mobile_phone_1:`${A.m1_ccode} ${A.mobile_phone_1}`,mobile_phone_2:`${A.m2_ccode} ${A.mobile_phone_2}`},Y=M&&P?"update":"create",F=`${A.first_name} ${A.last_name}`;q({title:Y==="create"?"Confirm New Lead":"Confirm Update",message:Y==="create"?a.jsxs("span",{children:["Are you sure you want to create a new lead for"," ",a.jsx("span",{className:"font-semibold",children:F}),"?"]}):a.jsxs("span",{children:["Save changes to ",a.jsx("span",{className:"font-semibold",children:F}),"?"]}),confirmLabel:Y==="create"?"Create Lead":"Update Lead",cancelLabel:"Cancel",variant:"primary",action:{type:Y,payload:J,targetId:P||null,name:F}})},Et=async()=>{if(!R?.action){q(null);return}const{action:G}=R,{type:W,payload:J,targetId:Y,name:F,targetIds:ue,count:De}=G;console.log(J),V(!0);try{if(W==="create")B(!0),await re.post("/leads/create",J),H.success(`Lead "${F}" created successfully.`),ne(),await Fe();else if(W==="update"){if(!Y)throw new Error("Missing lead identifier for update.");B(!0);const le=await re.put(`/leads/${Y}`,J);H.success(`Lead "${F}" updated successfully.`),s&&s.id===Y&&r(null),ne(),await Fe()}else if(W==="archive"){if(!Y)throw new Error("Missing lead identifier for archiving.");const le=s?.id;we(Y),await re.put(`/leads/${Y}`,{status:"Inactive"}),H.success(`Lead "${F}" archived successfully.`),await Fe(),le===Y&&r(null)}else if(W==="bulk-archive"){if(!ue||ue.length===0)throw new Error("Missing lead identifiers for bulk archiving.");Ne(!0),await Promise.all(ue.map(le=>re.put(`/leads/${le}`,{status:"Inactive"}))),H.success(`${De} lead${De!==1?"s":""} archived successfully.`),se(new Set),await Fe(),r(null)}}catch(le){console.error(le);const Ie=W==="create"?"Failed to create lead. Please review the details and try again.":W==="update"?"Failed to update lead. Please review the details and try again.":W==="bulk-archive"?"Failed to archive leads. Please try again.":"Failed to archive lead. Please try again.",K=le.response?.data?.detail||Ie;H.error(K)}finally{(W==="create"||W==="update")&&B(!1),W==="archive"&&we(null),W==="bulk-archive"&&Ne(!1),W!=="edit"&&(V(!1),q(null))}},Tt=()=>{Z||q(null)},Nt=h.filter(G=>G.status==="New").length,xe=h.filter(G=>G.status==="Contacted").length,ve=h.filter(G=>G.status==="Qualified").length,Oe=h.filter(G=>G.status==="Converted").length,Ce=h.filter(G=>G.status==="Lost").length,Qe=[{title:"New",value:Nt,icon:Xa,color:"text-indigo-600",bgColor:"bg-indigo-100"},{title:"Contacted",value:xe,icon:It,color:"text-blue-600",bgColor:"bg-blue-100"},{title:"Qualified",value:ve,icon:Qa,color:"text-green-600",bgColor:"bg-green-100"},{title:"Converted",value:Oe,icon:ec,color:"text-emerald-600",bgColor:"bg-emerald-100"},{title:"Lost",value:Ce,icon:Us,color:"text-red-600",bgColor:"bg-red-100"}];return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[x&&a.jsx(Wt,{message:"Loading leads..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h1",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(Xa,{className:"mr-2 text-blue-600"}),"Leads"]}),a.jsx("div",{className:"flex justify-center lg:justify-end gap-3 w-full sm:w-auto",children:a.jsxs("button",{onClick:()=>{Pe(),it(!1)},className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 rounded-md hover:bg-gray-800 text-sm sm:text-base self-end sm:self-auto cursor-pointer",children:[a.jsx(aa,{className:"mr-2"})," Add Lead"]})})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 xl:grid-cols-5 gap-4 mb-6 w-full break-words overflow-hidden lg:overflow-visible",children:Qe.map(G=>a.jsx(y7e,{...G},G.title))}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search leads",value:j,onChange:st,className:"focus:outline-none text-base w-full"})]}),a.jsx("div",{className:"w-full lg:w-1/4",children:a.jsxs("select",{value:N,onChange:G=>w(G.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{value:"Filter by Status",children:"Filter by Status"}),a.jsx("option",{value:"New",children:"New"}),a.jsx("option",{value:"Contacted",children:"Contacted"}),a.jsx("option",{value:"Qualified",children:"Qualified"}),a.jsx("option",{value:"Converted",children:"Converted"}),a.jsx("option",{value:"Lost",children:"Lost"})]})})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[500px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 text-sm tracking-wide font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 w-12",children:a.jsx("input",{type:"checkbox",checked:X.size>0&&X.size===Je.filter(G=>G.creator?.id===n?.id).length&&Je.filter(G=>G.creator?.id===n?.id).length>0,onChange:qe,className:"w-4 h-4 cursor-pointer"})}),a.jsx("th",{className:"py-3 px-4",children:"Name"}),a.jsx("th",{className:"py-3 px-4",children:"Company"}),a.jsx("th",{className:"py-3 px-4",children:"Job Title"}),a.jsx("th",{className:"py-3 px-4",children:"Email"}),a.jsx("th",{className:"py-3 px-4",children:"Assigned To"}),a.jsx("th",{className:"py-3 px-4",children:"Status"}),a.jsx("th",{className:"py-3 px-4 w-12",children:X.size>0&&a.jsx("button",{onClick:nt,className:"text-orange-500 hover:text-orange-700 transition",title:"Archive selected leads",disabled:ye,children:a.jsx(Zt,{size:18})})})]})}),a.jsx("tbody",{children:Xe.length>0?Je.map(G=>a.jsxs("tr",{className:"hover:bg-gray-50 text-sm cursor-pointer",children:[a.jsx("td",{className:"py-3 px-4",children:n?.id===G.creator?.id&&a.jsx("input",{type:"checkbox",checked:X.has(G.id),onChange:W=>{W.stopPropagation(),He(G.id)},className:"w-4 h-4 cursor-pointer"})}),a.jsx("td",{className:"py-3 px-4 align-top",onClick:()=>ce(G),children:a.jsxs("div",{className:"font-medium text-blue-600 hover:underline break-all text-sm",children:[G.first_name," ",G.last_name]})}),a.jsx("td",{className:"py-3 px-4 align-top",onClick:()=>ce(G),children:a.jsx("div",{className:"font-medium text-gray-800 text-sm leading-tight",children:G.company_name||"--"})}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",onClick:()=>ce(G),children:G.title||"--"}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",onClick:()=>ce(G),children:G.email||"--"}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",onClick:()=>ce(G),children:G.assigned_to?`${G.assigned_to.first_name} ${G.assigned_to.last_name}`:"--"}),a.jsx("td",{className:"py-3 px-4",onClick:()=>ce(G),children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium whitespace-nowrap ${g7e(G.status||"New")}`,children:h7e(G.status||"New")})}),a.jsx("td",{className:"py-3 px-4"})]},G.id)):a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:8,children:"No leads found."})})})]})}),a.jsx(ca,{className:"mt-4",totalItems:Xe.length,pageSize:k,currentPage:S,onPrev:Be,onNext:_e,onPageSizeChange:G=>{T(G),_(1)},pageSizeOptions:[10,20,30,40,50],label:"leads"}),i&&a.jsx("div",{id:"modalBackdrop",onClick:ae,className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-full sm:max-w-3xl rounded-2xl shadow-lg p-4 sm:p-6 md:p-8 relative border border-gray-200 overflow-y-auto max-h-[90vh] hide-scrollbar",onClick:G=>G.stopPropagation(),children:[a.jsx("button",{onClick:()=>{ne(),it(!1)},className:"absolute top-4 right-4 text-gray-500 hover:text-black transition",children:a.jsx(ea,{size:22})}),a.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800 mb-4 sm:mb-6 flex items-center justify-center",children:M?"Edit Lead":"Add New Lead"}),a.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 text-sm",children:[a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"First Name"}),a.jsx("input",{type:"text",name:"first_name",value:A.first_name,onChange:ot,placeholder:"Joe",className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:["Last Name ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",placeholder:"Smith",name:"last_name",value:A.last_name,onChange:ot,required:!0,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border
                      ${Re&&!A.last_name?.trim()?"border-red-400 focus:ring-red-400":"border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"}
                  focus:ring-2`})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:["Company ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",placeholder:"ABC Company",name:"company_name",value:A.company_name,onChange:ot,required:!0,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border
                       ${Re&&!A.company_name?.trim()?"border-red-400 focus:ring-red-400":"border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"}
                  focus:ring-2`})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:["Job Title",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",placeholder:"ABC Agenda",name:"title",value:A.title,onChange:ot,required:!0,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border
                       ${Re&&!A.title?.trim()?"border-red-400 focus:ring-red-400":"border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"}
                      focus:ring-2`})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Department"}),a.jsx("input",{type:"text",placeholder:"Sales",name:"department",value:A.department,onChange:ot,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:["Email",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"email",placeholder:"abc@gmail.com",name:"email",value:A.email,onChange:ot,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border
                       ${Re&&!A.email?.trim()?"border-red-400 focus:ring-red-400":"border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"}
                      focus:ring-2`})]}),a.jsxs("div",{className:"flex flex-col col-span-1 md:col-span-2 lg:col-span-1",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Work Phone"}),a.jsxs("div",{className:"w-full border border-gray-300 rounded-md focus-within:ring-2 focus-within:ring-blue-400 outline-none flex flex-row gap-1",children:[a.jsx("select",{name:"work_ccode",value:A.work_ccode,onChange:ot,className:"outline-none cursor-pointer py-1.5 px-2 border-r border-gray-400 text-sm",children:JA.map(G=>a.jsx("option",{value:G.code,children:G.code},G.id))}),a.jsx("input",{type:"text",placeholder:"9----------",name:"work_phone",value:A.work_phone,onChange:ot,className:"w-full outline-none px-2 py-1.5 text-sm"})]})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Mobile Phone 1"}),a.jsxs("div",{className:"w-full border border-gray-300 rounded-md focus-within:ring-2 focus-within:ring-blue-400 outline-none flex flex-row gap-1",children:[a.jsx("select",{name:"m1_ccode",value:A.m1_ccode,onChange:ot,className:"outline-none cursor-pointer py-1.5 px-2 border-r border-gray-400 text-sm",children:JA.map(G=>a.jsx("option",{value:G.code,children:G.code},G.id))}),a.jsx("input",{type:"text",placeholder:"9----------",name:"mobile_phone_1",value:A.mobile_phone_1,onChange:ot,className:"w-full outline-none px-2 py-1.5 text-sm"})]})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Mobile Phone 2"}),a.jsxs("div",{className:"w-full border border-gray-300 rounded-md focus-within:ring-2 focus-within:ring-blue-400 outline-none flex flex-row gap-1",children:[a.jsx("select",{name:"m2_ccode",value:A.m2_ccode,onChange:ot,className:"outline-none cursor-pointer py-1.5 px-2 border-r border-gray-400 text-sm",children:JA.map(G=>a.jsx("option",{value:G.code,children:G.code},G.id))}),a.jsx("input",{type:"text",placeholder:"9----------",name:"mobile_phone_2",value:A.mobile_phone_2,onChange:ot,className:"w-full outline-none px-2 py-1.5 text-sm"})]})]}),a.jsxs("div",{className:"flex flex-col col-span-1 sm:col-span-2 lg:col-span-3",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Address"}),a.jsx("input",{type:"text",name:"address",value:A.address,onChange:ot,placeholder:"Street No., Street Name, City, State/Province, Postal Code",className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"})]}),a.jsxs("div",{className:"flex flex-col col-span-1 md:col-span-2 lg:col-span-1",children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:["Assign To ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("div",{className:`w-full rounded-lg ${Re&&!A.lead_owner?"border border-red-400":"border border-gray-300"}`,children:a.jsx(b7e,{items:Array.isArray(l)?l:[],value:A.lead_owner??"",placeholder:"Search a user...",getLabel:G=>`${G.first_name} ${G.last_name}`,onChange:G=>{const W=l.find(Y=>String(Y.id)===String(G));d(W);let J=null;W&&W.assigned_territory&&W.assigned_territory.length===1&&(J=W.assigned_territory[0].id),E(Y=>({...Y,lead_owner:G,territory_id:J}))}})})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Territory"}),a.jsxs("select",{name:"territory_id",value:A.territory_id||"",onChange:ot,disabled:!u||!u.assigned_territory||u.assigned_territory.length===0,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm bg-white focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100 disabled:text-gray-500",children:[a.jsx("option",{value:"",disabled:!0,children:u?u.assigned_territory&&u.assigned_territory.length>0?"Select Territory":"No territories assigned to this user":"Select a user first"}),u&&u.assigned_territory&&u.assigned_territory.map(G=>a.jsx("option",{value:G.id,children:G.name},G.id))]})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Source"}),a.jsxs("select",{className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none",defaultValue:"",name:"source",value:A.source,onChange:ot,children:[a.jsx("option",{value:"",disabled:!0,children:"Select Source"}),a.jsx("option",{value:"Website",children:"Website"}),a.jsx("option",{value:"Referral",children:"Referral"}),a.jsx("option",{value:"Cold call",children:"Cold call"}),a.jsx("option",{value:"Event",children:"Event"}),a.jsx("option",{value:"Other",children:"Other"})]})]}),a.jsxs("div",{className:"flex flex-col col-span-1 sm:col-span-2 lg:col-span-3",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Notes"}),a.jsx("textarea",{placeholder:"Additional details...",name:"notes",value:A.notes,onChange:ot,rows:3,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none resize-none"})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-2 mt-4 col-span-1 sm:col-span-2 lg:col-span-3",children:[a.jsx("button",{type:"button",onClick:()=>{ne(),it(!1)},className:"w-full sm:w-auto px-4 py-2 text-white bg-red-400 border border-red-300 rounded hover:bg-red-500 transition disabled:opacity-70",disabled:U||Z,children:"Cancel"}),a.jsx("button",{type:"submit",onClick:St,className:"w-full sm:w-auto px-4 py-2 text-white border border-tertiary bg-tertiary rounded hover:bg-secondary transition disabled:opacity-70",disabled:U||Z,children:U||Z?"Processing...":M?"Update Lead":"Save Lead"})]})]})]})}),R&&a.jsx(x7e,{open:!0,title:R.title,message:R.message,confirmLabel:R.confirmLabel,cancelLabel:R.cancelLabel,variant:R.variant,onConfirm:Et,onCancel:Tt,loading:Z}),s&&!i&&!M&&a.jsx(jJ,{relatedActs:oe,lead:s,onBack:Q,fetchLeads:Fe,setSelectedLead:r,onEdit:Te,onArchive:he})]})}function x7e({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o=!1,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":i==="archive"?"bg-orange-500 hover:bg-orange-600 border border-orange-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsx("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${u}`,disabled:o,children:o?"Processing...":s})]})]})})}function y7e({icon:e,title:t,value:n,color:s="text-blue-600",bgColor:r="bg-blue-100",onClick:i}){const o=()=>{typeof i=="function"?i():console.log(`Clicked: ${t}`)};return a.jsxs("div",{className:"flex items-center p-4 bg-white rounded-xl shadow-md border border-gray-200 transition-all duration-300",onClick:o,children:[a.jsx("div",{className:`flex-shrink-0 p-3 rounded-full ${r} ${s} mr-4`,children:e?a.jsx(e,{size:22}):null}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:t}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:n})]})]})}function b7e({items:e=[],value:t="",onChange:n,getLabel:s,placeholder:r="Search...",disabled:i=!1,maxRender:o=200}){const[l,c]=f.useState(!1),[u,d]=f.useState(""),h=f.useRef(null),p=e.find(j=>String(j.id)===String(t)),x=p?s(p):"",v=f.useMemo(()=>{const j=u.trim().toLowerCase();return(j?e.filter(N=>(s(N)||"").toLowerCase().includes(j)):e).slice(0,o)},[e,u,s,o]);return f.useEffect(()=>{const j=y=>{h.current&&!h.current.contains(y.target)&&c(!1)};return document.addEventListener("mousedown",j),()=>document.removeEventListener("mousedown",j)},[]),f.useEffect(()=>{l||d("")},[l]),a.jsxs("div",{ref:h,className:"relative w-full",children:[a.jsx("input",{disabled:i,value:l?u:x,placeholder:r,onFocus:()=>!i&&c(!0),onChange:j=>{d(j.target.value),l||c(!0)},className:"w-full rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100"}),l&&!i&&a.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg overflow-hidden",children:[a.jsx("div",{className:"max-h-56 overflow-y-auto",children:v.length>0?v.map(j=>{const y=String(j.id),N=s(j),w=String(t)===y;return a.jsx("button",{type:"button",onClick:()=>{n(y),c(!1)},className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-50 ${w?"bg-blue-50":""}`,children:N||"--"},y)}):a.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No results"})}),e.length>o&&a.jsxs("div",{className:"px-3 py-2 text-[11px] text-gray-400 border-t",children:["Showing first ",o," results  keep typing to narrow."]})]})]})}const Pb={accountName:"Josh Inc.",companyNumber:"09135007323",companyWebsite:"joshenc.com",industry:"Agriculture",billingAddress:"#1 Pilar Las Pinas City",shippingAddress:"#3 BNW ASS-CBN",firstName:"Josh",lastName:"Vergara",department:"Administration",title:"CEO",workPhone:"09253677323",email:"josh@joshinc.com",mobile1:"09253677323",mobile2:"0907452874",dealName:"Josh Deal",dealAmount:"60.00",stage:"Prospecting",territory:"Cavite",description:"Initial lead conversion deal.",dealTitle:"New Client Agreement"},Jn=({label:e,value:t,name:n,className:s=""})=>a.jsxs("div",{className:`flex flex-col ${s}`,children:[a.jsx("label",{className:"text-xs text-gray-500 mb-1",children:e}),a.jsx("input",{type:"text",name:n,defaultValue:t,readOnly:!0,className:"w-full border border-gray-300 p-2 rounded-lg text-sm focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 outline-none bg-gray-50"})]}),v7e=({data:e})=>a.jsxs("div",{className:"space-y-6 p-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-700",children:"Account Information"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsx(Jn,{label:"Company Number",name:"companyNumber",value:e.companyNumber}),a.jsx(Jn,{label:"Company Website",name:"companyWebsite",value:e.companyWebsite}),a.jsx(Jn,{label:"Industry",name:"industry",value:e.industry})]}),a.jsx(Jn,{label:"Billing Address",name:"billingAddress",value:e.billingAddress,className:"col-span-3"}),a.jsx(Jn,{label:"Shipping Address",name:"shippingAddress",value:e.shippingAddress,className:"col-span-3"})]}),w7e=({data:e})=>a.jsxs("div",{className:"space-y-6 p-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-700",children:"Contact Information"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx(Jn,{label:"First Name",name:"firstName",value:e.firstName}),a.jsx(Jn,{label:"Last Name",name:"lastName",value:e.lastName}),a.jsx(Jn,{label:"Department",name:"department",value:e.department}),a.jsx(Jn,{label:"Title",name:"title",value:e.title}),a.jsx(Jn,{label:"Work Phone",name:"workPhone",value:e.workPhone}),a.jsx(Jn,{label:"Email",name:"email",value:e.email}),a.jsx(Jn,{label:"Mobile Number 1",name:"mobile1",value:e.mobile1}),a.jsx(Jn,{label:"Mobile Number 2",name:"mobile2",value:e.mobile2})]})]}),j7e=({data:e})=>a.jsxs("div",{className:"space-y-6 p-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-700",children:"Deal"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx(Jn,{label:"Deal Name",name:"dealName",value:e.dealName}),a.jsxs("div",{className:"flex",children:[a.jsx(Jn,{label:"Deal Amount",name:"dealAmount",value:e.dealAmount,className:"flex-grow"}),a.jsx("div",{className:"flex flex-col justify-end ml-1",children:a.jsx("span",{className:"text-sm font-medium text-gray-600 border border-gray-300 bg-gray-100 p-2 rounded-r-lg h-10 flex items-center",children:"PHP"})})]}),a.jsx(Jn,{label:"Stage",name:"stage",value:e.stage}),a.jsx(Jn,{label:"Territory",name:"territory",value:e.territory})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx(Jn,{label:"Description",name:"description",value:e.description}),a.jsx(Jn,{label:"Title",name:"dealTitle",value:e.dealTitle})]})]});function N7e({isOpen:e,onClose:t}){const[n,s]=f.useState(1),r=3;if(!e)return null;const i=()=>{n<r?s(n+1):(t(),s(1))},o=()=>{n>1&&s(n-1)},l=[{id:1,name:"Account"},{id:2,name:"Contact"},{id:3,name:"Deal"}],c=()=>{switch(n){case 1:return a.jsx(v7e,{data:Pb});case 2:return a.jsx(w7e,{data:Pb});case 3:return a.jsx(j7e,{data:Pb});default:return null}};return a.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-[800px] h-[600px] overflow-hidden flex flex-col",children:[a.jsxs("div",{className:"p-6 border-b border-gray-200 flex justify-between items-start",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wider",children:"Convert Lead"}),a.jsx("h1",{className:"text-2xl font-bold text-gray-900 mt-1",children:Pb.accountName})]}),a.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition",children:a.jsx(PN,{className:"w-6 h-6"})})]}),a.jsx("div",{className:"flex border-b border-gray-200 bg-gray-50",children:l.map(u=>a.jsx("button",{onClick:()=>s(u.id),className:`flex-1 py-3 px-6 text-sm font-medium transition ${n===u.id?"bg-white text-gray-800 border-b-2 border-indigo-600":"bg-gray-600 text-white hover:bg-gray-700"}`,children:u.name},u.id))}),a.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:c()}),a.jsxs("div",{className:"p-4 border-t border-gray-200 bg-gray-50 flex justify-end space-x-3",children:[n>1&&a.jsx("button",{onClick:o,className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-100 flex items-center",children:"Cancel"}),n<r?a.jsx("button",{onClick:i,className:"px-5 py-2 text-white bg-gray-900 rounded-xl hover:bg-gray-800 transition",children:"Next"}):a.jsx("button",{onClick:i,className:"px-5 py-2 text-white bg-gray-900 rounded-xl hover:bg-gray-800 transition",children:"Convert"})]})]})})}function NJ({selectedDeal:e,onStatusUpdate:t,onClose:n}){const[s,r]=f.useState(e?.stage||""),[i,o]=f.useState(!1),l=kt(),{user:c}=Vt();f.useEffect(()=>{console.log("ManagerDealsInformation mounted sahdksd",e),console.log("User sadad:",c)},[e,c]);const u=[{value:"PROSPECTING",label:"Prospecting"},{value:"QUALIFICATION",label:"Qualification"},{value:"PROPOSAL",label:"Proposal"},{value:"NEGOTIATION",label:"Negotiation"},{value:"CLOSED_WON",label:"Closed Won"},{value:"CLOSED_LOST",label:"Closed Lost"}];f.useEffect(()=>{e?.stage&&r(e.stage)},[e]);const d=async()=>{if(!e||!e.id){H.error("No deal selected");return}if(!s||s===e.stage){H.info("Please select a different stage");return}const h=e.id;o(!0);try{await re.put(`/deals/admin/${h}`,{stage:s}),n&&n(),t&&setTimeout(async()=>{await t(!0)},100),setTimeout(()=>{H.success("Deal status updated successfully")},300)}catch(p){console.error(p);const x=p.response?.data?.detail||"Failed to update deal status";H.error(x)}finally{o(!1)}};return e?a.jsxs("div",{className:"space-y-4 font-inter text-[13px] w-full sm:w-[85%] mx-auto flex flex-col gap-4",children:[a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Quick Actions"}),a.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[a.jsxs("button",{onClick:()=>{const h=e.account?.id||e.account_id;l("/manager/calls",{state:{openCallModal:!0,initialCallData:{subject:e.name?`Call regarding: ${e.name}`:"",relatedType1:"Account",relatedTo1:h,relatedType2:"Deal",relatedTo2:e.id,contactId:e.contact?.id,assigned_to:e.assigned_deals?.id?String(e.assigned_deals.id):"",assignedTo:e.assigned_to?.id?String(e.assigned_to.id):""}}})},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(It,{className:"text-gray-600 w-4 h-4"}),"Schedule Call"]}),a.jsxs("button",{type:"button",onClick:()=>{if(!e.contact?.email){alert("No email address available");return}const h=encodeURIComponent(e.contact.email),p=encodeURIComponent(""),x=encodeURIComponent(""),v=`mailto:${h}?subject=${p}&body=${x}`;window.location.href=v},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(rn,{className:"text-gray-600 w-4 h-4"}),"Send E-mail"]}),a.jsxs("button",{className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",onClick:()=>{const h=e.account?.id||e.account_id;l("/manager/meetings",{state:{openMeetingModal:!0,initialMeetingData:{subject:e.name?`Meeting: ${e.name}`:"",relatedType1:"Account",relatedTo1:h,relatedType2:"Deal",relatedTo2:e.id,assignedTo:e.assigned_deals?.id?String(e.assigned_deals.id):""}}})},children:[a.jsx(Ot,{className:"text-gray-600 w-4 h-4"}),"Book Meeting"]}),a.jsxs("button",{onClick:()=>{const h=e.account?.id||e.account_id;l("/manager/tasks",{state:{openTaskModal:!0,initialTaskData:{subject:e.name?`Task for: ${e.name}`:"",relatedType1:"Account",relatedTo1:h,relatedType2:"Deal",relatedTo2:e.id,contactId:e.contact?.id,assignedTo:e.assigned_deals?.id?String(e.assigned_deals.id):"",priority:"NORMAL",status:"Not Started"}}})},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(Qt,{className:"text-gray-600 w-4 h-4"}),"Tasks"]})]})]}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm w-full",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Promote Deal"}),a.jsx("select",{className:"border border-gray-200 rounded-md px-2 sm:px-3 py-1.5 w-full text-sm mb-2 focus:ring-2 focus:ring-gray-300 focus:outline-none",value:s,onChange:h=>r(h.target.value),disabled:i||e.created_by!==c?.id&&e.assigned_to!==c?.id,children:u.map(h=>a.jsx("option",{value:h.value,children:h.label},h.value))}),(e.created_by===c?.id||e.assigned_to===c?.id)&&a.jsx("button",{className:"w-full bg-gray-900 text-white py-1.5 rounded-md text-sm hover:bg-gray-800 transition disabled:opacity-50 disabled:cursor-not-allowed",onClick:d,disabled:i||!s||s===e.stage,children:i?"Updating...":"Update"})]})]}):null}function CJ({selectedDeal:e,relatedActs:t={},show:n,onClose:s,activeTab:r,setActiveTab:i,onEdit:o,onDelete:l,onStatusUpdate:c}){const u=kt(),[d]=Bs(),h=d.get("id"),[p,x]=f.useState(e||null),[v,j]=f.useState(r||"Overview"),[y,N]=f.useState(null),{user:w}=Vt(),{comments:S,addComment:_,refresh:k}=kn({relatedType:"deal",relatedId:p?.id});f.useEffect(()=>{p?.id&&k()},[p?.id,k]);const T=r!==void 0?r:v,A=(()=>{const P=String(w?.role||"").toLowerCase();return P==="ceo"||P==="admin"?"admin":P==="manager"?"manager":P==="sales"?"sales":P==="group manager"||P==="group_manager"||P==="group-manager"?"group-manager":"guest"})();if(f.useEffect(()=>{(async()=>{if(h&&!e)try{const B=((await re.get("/deals/admin/fetch-all")).data||[]).find(R=>R.id===parseInt(h));if(B){const R={...B,amount:typeof B.amount=="number"?B.amount:parseFloat(B.amount||0),probability:B.probability||0};x(R)}else console.warn("Deal not found with ID:",h)}catch(D){console.error("Error fetching deal:",D)}})()},[h,e]),!p&&!h||h&&!p)return null;const E=P=>({PROSPECTING:"bg-blue-100 text-blue-700",QUALIFICATION:"bg-yellow-100 text-yellow-700",PROPOSAL:"bg-orange-100 text-orange-700",NEGOTIATION:"bg-purple-100 text-purple-700",CLOSED_WON:"bg-green-100 text-green-700",CLOSED_LOST:"bg-red-100 text-red-700"})[P]||"bg-gray-100 text-gray-700",M=P=>{if(!P)return"";const D=String(P).split("-");return D.length===3?`${D[0]}-${D[2]}`:String(P)},z=P=>P?new Date(P).toLocaleString("en-US",{month:"short",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).replace(",",""):"";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[9999] font-inter p-2 sm:p-4 overflow-x-hidden",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-lg w-full max-w-full sm:max-w-6xl max-h-[90vh] overflow-y-auto hide-scrollbar relative box-border",children:[a.jsx("div",{className:"bg-tertiary w-full rounded-t-xl p-3 lg:p-3",children:a.jsxs("div",{className:"flex items-start justify-between w-full",children:[a.jsx("h1",{className:"lg:text-3xl text-xl text-white font-semibold text-center w-full",children:"Deal"}),a.jsx("div",{className:"flex items-center gap-2 sm:gap-3",children:a.jsx("button",{onClick:()=>{s?s():u(-1)},className:"text-gray-400 hover:text-white mt-1 cursor-pointer",children:a.jsx(ea,{size:25})})})]})}),a.jsx("div",{className:"p-4 lg:p-2 lg:mx-7",children:a.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-2 sm:gap-3 mt-3",children:[a.jsxs("div",{className:"flex flex-col gap-1",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3 lg:gap-1",children:[a.jsxs("h2",{className:"text-xl lg:text-xl font-semibold text-gray-800 break-words",children:[M(p.deal_id)," - ",p.name]}),a.jsx("span",{className:`text-xs sm:text-sm inline-block font-medium px-1.5 py-0.5 sm:px-3 sm:py-1 rounded-full break-words ${E(p.stage)}`,children:p.stage})]}),a.jsxs("p",{className:"text-gray-500 text-sm break-words",children:["Created on ",z(p.created_at)]})]}),a.jsxs("div",{className:"flex flex-col items-end gap-2",children:[a.jsxs("h2",{className:"text-xl sm:text-2xl font-bold text-gray-600 break-words",children:[" ",p.amount?p.amount.toLocaleString():"0"]}),a.jsx("div",{className:"w-full sm:w-40 bg-gray-200 rounded-full h-2",children:a.jsx("div",{className:"bg-green-500 h-2 rounded-full",style:{width:`${p.probability}%`}})}),a.jsxs("p",{className:"text-xs text-gray-500 break-words",children:[" ",p.probability,"% Complete "]}),p.deal_creator?.id===w?.id&&a.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 mt-3",children:[a.jsxs("button",{type:"button",onClick:()=>{o&&o(p)},className:"inline-flex items-center justify-center bg-blue-500 text-white px-3 sm:px-4 py-1.5 sm:py-2 rounded-md hover:bg-blue-600 transition text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",children:[a.jsx(hn,{className:"mr-1 sm:mr-2",size:16}),a.jsx("span",{className:"hidden sm:inline",children:"Edit"})]}),a.jsxs("button",{type:"button",onClick:()=>{l&&l(p)},className:"inline-flex items-center justify-center px-3 sm:px-4 py-1.5 sm:py-2 rounded-md text-sm bg-orange-500 text-white hover:bg-orange-600 transition focus:outline-none focus:ring-2 focus:ring-orange-400",children:[a.jsx(Zt,{className:"mr-1 sm:mr-2",size:16}),a.jsx("span",{className:"hidden sm:inline",children:"Archive"})]})]})]})]})}),a.jsx("div",{className:"border-b border-gray-200 my-5"}),a.jsxs("div",{className:"p-6 lg:p-4",children:[a.jsx("div",{className:"flex w-full bg-[#6A727D] text-white mt-1 overflow-x-auto mb-6",children:["Overview","Notes","Activities"].map(P=>a.jsx("button",{onClick:()=>{i?i(P):j(P)},className:`flex-1 min-w-[90px] px-4 py-2.5 text-xs sm:text-sm font-medium text-center transition-all duration-200 border-b-2
                ${T===P?"bg-paper-white text-[#6A727D] border-white":"text-white hover:bg-[#5c636d]"}`,children:P},P))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 items-start",children:[a.jsxs("div",{className:"lg:col-span-3 space-y-6",children:[T==="Overview"&&a.jsxs("div",{className:"grid md:grid-cols-2 gap-4 sm:gap-6 w-full",children:[a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 sm:p-5 shadow-sm pb-20 break-words",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 sm:mb-3",children:"Deal Information"}),a.jsxs("p",{className:"text-sm sm:text-sm text-gray-700 mb-2 py-5 break-words",children:[a.jsx("strong",{children:"Description:"})," ",p.description]}),a.jsx("div",{className:"h-px bg-gray-200 w-full"}),a.jsxs("p",{className:"text-sm sm:text-sm text-gray-700 mb-2 py-5 break-words",children:[a.jsx("strong",{children:"Expected Close Date:"})," ",z(p.close_date)||"--"]}),a.jsx("div",{className:"h-px bg-gray-200 w-full"}),a.jsxs("div",{className:"mt-4 py-3 w-full",children:[a.jsxs("div",{className:"relative flex flex-col w-full",children:[a.jsx("div",{className:"absolute top-0 left-0 right-0 flex items-center justify-between w-full",children:(()=>{const P=(p?.stage||"PROSPECTING").toUpperCase(),U=(R=>R==="PROSPECTING"?0:R==="QUALIFICATION"?1:R==="PROPOSAL"?2:R==="NEGOTIATION"?3:R==="CLOSED_WON"||R==="CLOSED_LOST"?4:-1)(P);return[0,1,2,3,4].map(R=>U===R?"orange":U>R?"green":"gray").map((R,q)=>a.jsxs(wt.Fragment,{children:[a.jsx("div",{className:`relative z-10 w-6 h-6 rounded-full border-2 ${R==="green"?"bg-green-500 border-green-500":R==="orange"?"bg-orange-400 border-orange-400":"bg-gray-300 border-gray-300"}`}),q<4&&a.jsx("div",{className:"flex-grow h-1 bg-gray-200 mx-1 min-w-0"})]},q))})()}),a.jsx("div",{className:"flex justify-between mt-8 gap-2 text-[9px] lg:text-[9px] sm:text-xs text-gray-600 w-full",children:["Prospecting","Qualification","Proposal","Negotiation","Closed"].map((P,D)=>a.jsx("span",{className:"text-center flex-1 break-words",children:P},D))})]}),a.jsx("p",{className:"text-sm text-orange-600 font-medium mt-6 text-center break-words",children:p.stage})]})]}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 sm:p-5 shadow-sm break-words",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-3",children:"Contact Information"}),a.jsxs("div",{className:"text-sm sm:text-sm text-gray-700 space-y-3",children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Account:"})," ",p.account?.name]}),a.jsx("div",{className:"h-px bg-gray-200 w-full"}),a.jsxs("p",{children:[a.jsx("strong",{children:"Primary Contact:"})," ",p.contact?.first_name," ",p.contact?.last_name]}),a.jsx("div",{className:"h-px bg-gray-200 w-full"}),a.jsxs("p",{children:[a.jsx("strong",{children:"Phone:"})," ",p.contact?.work_phone]}),a.jsx("div",{className:"h-px bg-gray-200 w-full"}),a.jsxs("p",{children:[a.jsx("strong",{children:"Email:"})," ",p.contact?.email]}),a.jsx("div",{className:"h-px bg-gray-200 w-full"}),a.jsxs("p",{children:[a.jsx("strong",{children:"Assigned To:"})," ",p.assigned_deals?.first_name," ",p.assigned_deals?.last_name]})]})]})]}),T==="Notes"&&a.jsxs("div",{className:"mt-4 w-full",children:[a.jsx("div",{className:"flex flex-wrap items-center justify-between mb-4 gap-2",children:a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words",children:"Deal Note"})}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 shadow-sm break-words",children:[a.jsx("div",{className:"flex items-start justify-between",children:a.jsx("div",{children:a.jsx("p",{className:"text-sm font-medium text-gray-800 break-words",children:"Note"})})}),a.jsx("div",{className:"mt-3 text-sm text-gray-700 whitespace-pre-wrap break-words",children:p.description||"No notes available."})]}),a.jsx(Tn,{comments:S,onAddComment:_})]}),T==="Activities"&&a.jsxs("div",{className:"space-y-2 w-full h-full max-h-[50dvh] overflow-y-auto bg-gray-50 p-2 hide-scrollbar rounded-lg border border-gray-200 shadow-sm",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words border-b border-gray-300 py-2",children:"Related Activities"}),a.jsxs("div",{className:"space-y-2 text-sm",children:[t.tasks&&t.tasks.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>N(y==="tasks"?null:"tasks"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Qt,{className:"text-blue-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Tasks (",t.tasks.length,")"]})]}),y==="tasks"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),y==="tasks"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:t.tasks.map((P,D)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>u(`/${A}/tasks`,{state:{taskID:P.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-blue-600 mt-1",children:a.jsx(Qt,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:P.subject||P.title||"Task"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:P.description||"No description"}),P.assigned_to&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Assigned: ",P.assigned_to.first_name," ",P.assigned_to.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:z(P.due_date||P.created_at)})]},`task-${D}`))})]}),t.meetings&&t.meetings.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>N(y==="meetings"?null:"meetings"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ot,{className:"text-green-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Meetings (",t.meetings.length,")"]})]}),y==="meetings"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),y==="meetings"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:t.meetings.map((P,D)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>u(`/${A}/meetings`,{state:{meetingID:P.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-green-600 mt-1",children:a.jsx(Ot,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:P.subject||P.title||"Meeting"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:P.description||P.location||"No description"}),P.host&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Host: ",P.host.first_name," ",P.host.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:z(P.start_time||P.created_at)})]},`meeting-${D}`))})]}),t.calls&&t.calls.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>N(y==="calls"?null:"calls"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(It,{className:"text-purple-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Calls (",t.calls.length,")"]})]}),y==="calls"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),y==="calls"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:t.calls.map((P,D)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>u(`/${A}/calls`,{state:{callID:P.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-purple-600 mt-1",children:a.jsx(It,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:P.subject||P.title||"Call"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:P.direction||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:z(P.call_time||P.created_at)})]},`call-${D}`))})]}),t.quotes&&t.quotes.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>N(y==="quotes"?null:"quotes"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ia,{className:"text-orange-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Quotes (",t.quotes.length,")"]})]}),y==="quotes"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),y==="quotes"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:t.quotes.map((P,D)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>u(`/${A}/quotes`,{state:{quoteID:P.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-orange-600 mt-1",children:a.jsx(ia,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:(P.quote_id?P.quote_id.replace(/Q(\d+)-\d+-/,"Q$1-"):"--")||"Quote"}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:P.status||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:z(P.presented_date)||""})]},`quote-${D}`))})]}),(!t||(!t.tasks||t.tasks.length===0)&&(!t.meetings||t.meetings.length===0)&&(!t.calls||t.calls.length===0)&&(!t.quotes||t.quotes.length===0)&&(!t.deals||t.deals.length===0)&&(!t.contacts||t.contacts.length===0))&&a.jsx("div",{className:"text-center py-8 text-gray-500",children:a.jsx("p",{children:"No related activities found for this account."})})]})]}),T==="Edit"&&a.jsxs("div",{className:"mt-4 space-y-4 w-full",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words",children:"Edit Deal"}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 sm:p-5 shadow-sm w-full",children:[a.jsxs("label",{className:"block mb-3 break-words",children:[a.jsx("span",{className:"text-sm text-gray-700",children:"Deal Name"}),a.jsx("input",{type:"text",className:"mt-1 block w-full border border-gray-200 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-gray-200",defaultValue:p.name})]}),a.jsxs("label",{className:"block mb-3 break-words",children:[a.jsx("span",{className:"text-sm text-gray-700",children:"Description"}),a.jsx("textarea",{className:"mt-1 block w-full border border-gray-200 rounded-md px-3 py-2 text-sm h-24 resize-y focus:outline-none focus:ring-2 focus:ring-gray-200",defaultValue:p.description})]}),a.jsx("button",{className:"bg-gray-900 text-white px-4 py-2 rounded-md hover:bg-gray-800",children:"Save Changes"})]})]})]}),a.jsx("div",{className:"w-full lg:w-auto",children:a.jsx(NJ,{selectedDeal:p,onStatusUpdate:c,onClose:s})})]})]})]})})}function C7e(){f.useEffect(()=>{document.title="Deals | Sari-Sari CRM"},[]);const e=kt(),t=ta(),[n,s]=f.useState(""),[r,i]=f.useState("Filter by Stage"),[o,l]=f.useState("Filter by Owner"),[c,u]=f.useState(null),[d,h]=f.useState("Overview"),[p,x]=f.useState(!1),[v,j]=f.useState(null),[y,N]=f.useState(!1),[w,S]=f.useState(1),[_,k]=f.useState(10),[T,A]=f.useState(!1),[E,M]=f.useState(null),[z,P]=f.useState(!1),[D,U]=f.useState(!1),[B,R]=f.useState(null),[q,Z]=f.useState([]),[V,oe]=f.useState([]),[je,X]=f.useState([]),[se,ye]=f.useState({}),[Ne,fe]=f.useState(null),[we,de]=f.useState(new Set),[ke,ge]=f.useState(!1),{user:$e}=Vt();f.useEffect(()=>{const K=t.state,ie=K?.dealID;if(ie&&!K?.openDealModal){fe(ie),e(t.pathname,{replace:!0,state:{}});return}},[t,e]),f.useEffect(()=>{if(Ne&&v?.length>0&&!y){const K=v.find(ie=>ie.id===Ne);K?u(K):H.error("Deal not found."),fe(null)}},[Ne,v,y]);const[be,me]=f.useState({id:null,name:"",account_id:"",primary_contact_id:"",stage:"PROPOSAL",amount:"",close_date:"",assigned_to:"",currency:"PHP",description:""}),[Ue,Ee]=f.useState(null),[We,tt]=f.useState(null),lt="dealDraft:manager/deals",Fe=3600*1e3,st=f.useRef(!1),Xe=K=>{if(!K)return"";const ie=String(K).split("-");return ie.length===3?`${ie[0]}-${ie[2]}`:String(K)},Ze=K=>K?new Date(K).toLocaleString("en-US",{month:"short",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).replace(",",""):"";f.useEffect(()=>{if(!st.current){st.current=!0;try{const K=sessionStorage.getItem(lt);if(!K)return;const ie=JSON.parse(K);if(typeof ie?.ts=="number"&&Date.now()-ie.ts>Fe){sessionStorage.removeItem(lt);return}if(ie?.returnTo&&ie.returnTo!==t.pathname)return;ie?.dealForm&&typeof ie.dealForm=="object"&&me(ie.dealForm),typeof ie?.isEditing=="boolean"&&U(ie.isEditing),ie?.currentDealId!==void 0&&R(ie.currentDealId),x(!0),sessionStorage.removeItem(lt)}catch{sessionStorage.removeItem(lt)}}},[t.pathname]);const Je=f.useCallback(()=>{try{sessionStorage.setItem(lt,JSON.stringify({ts:Date.now(),returnTo:t.pathname,dealForm:be,isEditing:D,currentDealId:B}))}catch{}},[lt,t.pathname,be,D,B]),Be=f.useCallback(()=>{Je(),window.open("/manager/accounts?openModal=1","_blank","noopener,noreferrer")},[Je]),_e=f.useCallback(()=>{Je(),window.open("/manager/contacts?openModal=1","_blank","noopener,noreferrer")},[Je]),pe={"Prospecting Stage":"PROSPECTING","Qualification Stage":"QUALIFICATION","Proposal Stage":"PROPOSAL","Negotiation Stage":"NEGOTIATION","Closed Won Stage":"CLOSED_WON","Closed Lost Stage":"CLOSED_LOST","Closed Cancelled Stage":"CLOSED_CANCELLED"},ce=K=>({PROSPECTING:"Prospecting",QUALIFICATION:"Qualification",PROPOSAL:"Proposal",NEGOTIATION:"Negotiation",CLOSED_WON:"Closed Won",CLOSED_LOST:"Closed Lost",CLOSED_CANCELLED:"Closed Cancelled"})[K]||K||"--",Q=K=>({PROSPECTING:"bg-blue-100 text-blue-700",QUALIFICATION:"bg-yellow-100 text-yellow-700",PROPOSAL:"bg-orange-100 text-orange-700",NEGOTIATION:"bg-purple-100 text-purple-700",CLOSED_WON:"bg-green-100 text-green-700",CLOSED_LOST:"bg-red-100 text-red-700",CLOSED_CANCELLED:"bg-red-100 text-red-700"})[K]||"bg-gray-100 text-gray-700",ne=f.useCallback(async K=>{try{const ie=await re.get(`/activities/deal/${K}`);ye(ie.data&&typeof ie.data=="object"?ie.data:{})}catch(ie){console.error(ie),ie.response?.status===404&&(console.warn("No activities found for this account."),ye({}))}},[]),ae=f.useMemo(()=>{const K=n.trim().toLowerCase(),ie=r.trim(),Me=o.trim();return(v??[]).filter(Ke=>{const gt=[Ke?.name,Ke?.description,Ke?.account?.name,Ke?.contact?.first_name,Ke?.contact?.last_name,Ke?.assigned_deals?.first_name,Ke?.assigned_deals?.last_name],Ct=K===""||gt.some(Ge=>Ge==null||Ge===""?!1:Ge.toString().toLowerCase().includes(K)),Ht=ie==="Filter by Stage"||ie===""||Ke.stage===pe[ie]||Ke.stage===ie,da=Me==="Filter by Owner"||Me===""||`${Ke.assigned_deals?.first_name||""} ${Ke.assigned_deals?.last_name||""}`.trim().toLowerCase()===Me.toLowerCase();return Ct&&Ht&&da})},[v,n,r,o]),Pe=Math.max(1,Math.ceil(ae.length/_)||1);f.useEffect(()=>{S(1)},[n,r,o]),f.useEffect(()=>{S(K=>{const ie=Math.max(1,Math.ceil(ae.length/_)||1);return K>ie?ie:K})},[ae.length]);const Te=f.useMemo(()=>{const K=(w-1)*_;return ae.slice(K,K+_)},[ae,w]),he=()=>S(K=>Math.max(K-1,1)),He=()=>S(K=>Math.min(K+1,Pe)),qe=()=>{me({id:null,name:"",account_id:"",primary_contact_id:"",stage:"PROPOSAL",amount:"",close_date:"",assigned_to:"",currency:"PHP",description:""}),U(!1),R(null),x(!0)},nt=async()=>{N(!0);try{const K=await re.get("/deals/admin/fetch-all"),Me=[...Array.isArray(K.data)?K.data:[]].sort((Ke,gt)=>{const Ct=Ke?.created_at?new Date(Ke.created_at).getTime():0;return(gt?.created_at?new Date(gt.created_at).getTime():0)-Ct});j(Me)}catch(K){K.response&&K.response.status===403?H.error("Permission denied. Only CEO, Admin, or Group Manager can access this page."):H.error("Failed to fetch deals. Please try again later."),console.error(K)}finally{N(!1)}},ot=async()=>{try{const K=await re.get("/accounts/admin/fetch-all");Z(Array.isArray(K.data)?K.data:[])}catch(K){console.error(K),K.response?.status===403&&H.warn("Unable to load accounts (permission denied).")}},Re=async()=>{try{const K=await re.get("/contacts/admin/fetch-all");oe(Array.isArray(K.data)?K.data:[])}catch(K){console.error(K),K.response?.status===403&&H.warn("Unable to load contacts (permission denied).")}},it=async()=>{try{const K=await re.get("/users/all");X(Array.isArray(K.data)?K.data:[])}catch(K){console.error(K),K.response?.status===403&&H.warn("Unable to load users (permission denied).")}};f.useEffect(()=>{nt(),ot(),Re(),it()},[]);const St=async K=>{K&&(me({id:K.id||null,name:K.name||"",account_id:K.account_id?.toString()||"",primary_contact_id:K.primary_contact_id?.toString()||"",stage:K.stage||"PROPOSAL",amount:K.amount?.toString()||"",close_date:K.close_date?new Date(K.close_date).toISOString().split("T")[0]:"",assigned_to:K.assigned_to?.toString()||"",currency:K.currency||"PHP",description:K.description||""}),Ee(K.account||null),tt(K.contact||null),U(!0),R(K.id),u(null),x(!0))},Et=async(K=!1)=>{try{const ie=await re.get("/deals/admin/fetch-all"),Ke=[...Array.isArray(ie.data)?ie.data:[]].sort((gt,Ct)=>{const Ht=gt?.created_at?new Date(gt.created_at).getTime():0;return(Ct?.created_at?new Date(Ct.created_at).getTime():0)-Ht});if(j(Ke),!K&&c&&c.id){const gt=Ke.find(Ct=>Ct.id===c.id);gt&&u({...gt})}}catch(ie){console.error("Failed to refresh deal data:",ie),await nt()}},Tt=K=>{const ie=K.name.trim();if(!ie){H.error("Deal name is required.");return}if(!K.account_id){H.error("Account is required.");return}const Me=D&&B?"update":"create",Ke=ie;M({title:Me==="create"?"Confirm New Deal":"Confirm Update",message:Me==="create"?a.jsxs("span",{children:["Are you sure you want to create"," ",a.jsx("span",{className:"font-semibold",children:Ke}),"?"]}):a.jsxs("span",{children:["Save changes to ",a.jsx("span",{className:"font-semibold",children:Ke}),"?"]}),confirmLabel:Me==="create"?"Create Deal":"Update Deal",cancelLabel:"Cancel",variant:"primary",action:{type:Me,formData:K,targetId:B||null,name:Ke}})},Nt=K=>{const ie=Te?.find(Me=>Me.id===K);ie&&ie.deal_creator?.id===$e?.id&&de(Me=>{const Ke=new Set(Me);return Ke.has(K)?Ke.delete(K):Ke.add(K),Ke})},xe=()=>{const K=Te?.filter(ie=>ie.deal_creator?.id===$e?.id)||[];we.size===K.length&&K.length>0?de(new Set):de(new Set(K.map(ie=>ie.id)))},ve=()=>{if(we.size===0)return;const K=we.size;M({title:"Archive Deals",message:a.jsxs("span",{children:["Are you sure you want to archive"," ",a.jsx("span",{className:"font-semibold",children:K})," deal",K!==1?"s":"","? You can restore them later if needed."]}),confirmLabel:`Archive ${K} Deal${K!==1?"s":""}`,cancelLabel:"Cancel",variant:"archive",action:{type:"bulk-archive",targetIds:Array.from(we),count:K}})},Oe=K=>{if(!K)return;const ie=K.name||"this deal";M({title:"Archive Deal",message:a.jsxs("span",{children:["Are you sure you want to archive"," ",a.jsx("span",{className:"font-semibold",children:ie}),"? You can restore it later if needed."]}),confirmLabel:"Archive Deal",cancelLabel:"Cancel",variant:"archive",action:{type:"archive",targetId:K.id,name:ie}})},Ce=async()=>{if(!E?.action){M(null);return}const{action:K}=E,{type:ie,formData:Me,targetId:Ke,name:gt}=K;P(!0);try{if(ie==="create"){A(!0);const Ct={name:Me.name.trim(),account_id:parseInt(Me.account_id),primary_contact_id:Me.primary_contact_id?parseInt(Me.primary_contact_id):null,stage:Me.stage,amount:Me.amount?parseFloat(Me.amount):null,currency:Me.currency||"PHP",close_date:Me.close_date||null,description:Me.description||null,assigned_to:Me.assigned_to?parseInt(Me.assigned_to):null};await re.post("/deals/admin/create",Ct),H.success(`Deal "${gt}" created successfully.`),x(!1),await nt()}else if(ie==="update"){if(!Ke)throw new Error("Missing deal identifier for update.");A(!0);const Ct={};Me.name!==void 0&&(Ct.name=Me.name.trim()),Me.account_id!==void 0&&Me.account_id!==""&&(Ct.account_id=parseInt(Me.account_id)),Me.primary_contact_id!==void 0&&(Ct.primary_contact_id=Me.primary_contact_id?parseInt(Me.primary_contact_id):null),Me.stage!==void 0&&(Ct.stage=Me.stage),Me.amount!==void 0&&Me.amount!==""&&(Ct.amount=parseFloat(Me.amount)),Me.currency!==void 0&&(Ct.currency=Me.currency),Me.close_date!==void 0&&(Ct.close_date=Me.close_date||null),Me.description!==void 0&&(Ct.description=Me.description||null),Me.assigned_to!==void 0&&(Ct.assigned_to=Me.assigned_to?parseInt(Me.assigned_to):null),await re.put(`/deals/admin/${Ke}`,Ct),H.success(`Deal "${gt}" updated successfully.`),x(!1),await nt()}else if(ie==="delete"){if(!Ke)throw new Error("Missing deal identifier for deletion.");await re.delete(`/deals/admin/${Ke}`),H.success(`Deal "${gt}" deleted successfully.`),c?.id===Ke&&u(null),await nt()}else if(ie==="archive"){if(!Ke)throw new Error("Missing deal identifier for archive.");await re.put(`/deals/single-archive/${Ke}`),H.success(`Deal "${gt}" archived successfully.`),c?.id===Ke&&u(null),await nt()}else if(ie==="bulk-archive"){if(ge(!0),!K.targetIds||K.targetIds.length===0)throw new Error("No deals selected for archiving.");await re.put("/deals/bulk-archive",{deal_ids:K.targetIds}),H.success(`${K.count} deal${K.count!==1?"s":""} archived successfully.`),de(new Set),c&&K.targetIds.includes(c.id)&&u(null),await nt()}}catch(Ct){console.error(Ct);const Ht=ie==="create"?"Failed to create deal. Please review the details and try again.":ie==="update"?"Failed to update deal. Please review the details and try again.":ie==="bulk-archive"?"Failed to archive deals. Please try again.":ie==="archive"?"Failed to archive deal. Please try again.":"Failed to delete deal. Please try again.",da=Ct.response?.data?.detail||Ht;H.error(da)}finally{(ie==="create"||ie==="update")&&A(!1),ie==="bulk-archive"&&ge(!1),P(!1),M(null)}},Qe=()=>{z||M(null)},G=()=>{x(!1),me({id:null,name:"",account_id:"",primary_contact_id:"",stage:"PROPOSAL",amount:"",close_date:"",assigned_to:"",currency:"PHP",description:""}),Ee(null),tt(null),U(!1),R(null),A(!1)},W=(v??[]).filter(K=>K.stage==="PROSPECTING").length,J=(v??[]).filter(K=>K.stage==="QUALIFICATION").length,Y=(v??[]).filter(K=>K.stage==="PROPOSAL").length,F=(v??[]).filter(K=>K.stage==="NEGOTIATION").length,ue=(v??[]).filter(K=>K.stage==="CLOSED_WON").length,De=(v??[]).filter(K=>K.stage==="CLOSED_LOST").length,le=(v??[]).filter(K=>K.stage==="CLOSED_CANCELLED").length,Ie=[{title:"Prospecting",value:W,icon:yj,color:"text-blue-600",bgColor:"bg-blue-100"},{title:"Qualification",value:J,icon:gn,color:"text-yellow-600",bgColor:"bg-yellow-100"},{title:"Proposal",value:Y,icon:sa,color:"text-orange-600",bgColor:"bg-orange-100"},{title:"Negotiation",value:F,icon:cd,color:"text-purple-600",bgColor:"bg-purple-100"},{title:"Closed Won",value:ue,icon:Qa,color:"text-green-600",bgColor:"bg-green-100"},{title:"Closed Lost",value:De,icon:Us,color:"text-red-600",bgColor:"bg-red-100"},{title:"Closed Cancelled",value:le,icon:Us,color:"text-gray-600",bgColor:"bg-gray-100"}];return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[y&&a.jsx(Wt,{message:"Loading deals..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h1",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(sa,{className:"mr-2 text-blue-600"}),"Deals"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{onClick:qe,className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 lg:my-0 rounded-md hover:bg-gray-800 text-sm sm:text-base mx-auto sm:ml-auto cursor-pointer",children:[a.jsx(aa,{className:"mr-2"})," Add Deal"]})})]}),a.jsx("div",{className:"grid grid-cols-1 p-2 lg:grid-cols-4 gap-4 mb-6 w-full break-words overflow-hidden",children:Ie.map(K=>a.jsx(_7e,{...K},K.title))}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search deals",value:n,onChange:K=>s(K.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsxs("div",{className:"w-full lg:w-auto flex flex-col lg:flex-row gap-3",children:[a.jsxs("select",{value:r,onChange:K=>i(K.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full lg:w-40 focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{value:"Filter by Stage",children:"Filter by Stage"}),a.jsx("option",{value:"Prospecting Stage",children:"Prospecting"}),a.jsx("option",{value:"Qualification Stage",children:"Qualification"}),a.jsx("option",{value:"Proposal Stage",children:"Proposal"}),a.jsx("option",{value:"Negotiation Stage",children:"Negotiation"}),a.jsx("option",{value:"Closed Won Stage",children:"Closed Won"}),a.jsx("option",{value:"Closed Lost Stage",children:"Closed Lost"}),a.jsx("option",{value:"Closed Cancelled Stage",children:"Closed Cancelled"})]}),a.jsxs("select",{value:o,onChange:K=>l(K.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full lg:w-40 focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{value:"Filter by Owner",children:"Filter by Owner"}),[...new Set((v??[]).map(K=>`${K.assigned_deals?.first_name} ${K.assigned_deals?.last_name}`))].map((K,ie)=>a.jsx("option",{value:K,children:K},ie))]})]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[500px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 text-sm tracking-wide font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 w-12",children:a.jsx("input",{type:"checkbox",checked:we.size>0&&we.size===Te?.filter(K=>K.deal_creator?.id===$e?.id).length&&Te?.filter(K=>K.deal_creator?.id===$e?.id).length>0,onChange:xe,className:"w-4 h-4 cursor-pointer"})}),a.jsx("th",{className:"py-3 px-4",children:"Deal ID"}),a.jsx("th",{className:"py-3 px-4 truncate",children:"Deal Name"}),a.jsx("th",{className:"py-3 px-4",children:"Account"}),a.jsx("th",{className:"py-3 px-4",children:"Contact"}),a.jsx("th",{className:"py-3 px-4",children:"Stage"}),a.jsx("th",{className:"py-3 px-4",children:"Value"}),a.jsx("th",{className:"py-3 px-4",children:"Close Date"}),a.jsx("th",{className:"py-3 px-4",children:"Owner"}),a.jsx("th",{className:"py-3 px-4 w-12",children:we.size>0&&a.jsx("button",{onClick:ve,className:"text-orange-500 hover:text-orange-700 transition",title:"Archive selected deals",disabled:ke,children:a.jsx(Zt,{size:18})})})]})}),a.jsx("tbody",{children:ae.length>0?Te.map(K=>a.jsxs("tr",{className:"hover:bg-gray-50 text-sm cursor-pointer",onClick:()=>{u({...K}),ne(K.id)},children:[a.jsx("td",{className:"py-3 px-4",children:$e?.id===K.deal_creator?.id&&a.jsx("input",{type:"checkbox",checked:we.has(K.id),onClick:ie=>{ie.stopPropagation()},onChange:ie=>{ie.stopPropagation(),Nt(K.id)},className:"w-4 h-4 cursor-pointer"})}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",children:Xe(K.deal_id)}),a.jsx("td",{className:"py-3 px-4",children:a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-blue-600 hover:underline break-all text-sm",children:K.name}),a.jsx("div",{className:"text-gray-500 text-xs break-all",children:K.description||"--"})]})}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",children:K.account?.name||"--"}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",children:K.contact?.first_name&&K.contact?.last_name?`${K.contact.first_name} ${K.contact.last_name}`:K.contact?.first_name||K.contact?.last_name||"--"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${Q(K.stage)}`,children:ce(K.stage)})}),a.jsxs("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",children:[" ",K.amount?.toLocaleString()||"0"]}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",children:Ze(K.close_date)||"--"}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",children:K.assigned_deals?.first_name&&K.assigned_deals?.last_name?`${K.assigned_deals.first_name} ${K.assigned_deals.last_name}`:K.assigned_deals?.first_name||K.assigned_deals?.last_name||"--"})]},K.id)):a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:8,children:"No deals found."})})})]})}),a.jsx(ca,{className:"mt-4",totalItems:ae.length,pageSize:_,currentPage:w,onPrev:he,onNext:He,onPageSizeChange:K=>{k(K),S(1)},pageSizeOptions:[10,20,30,40,50],label:"deals"}),p&&a.jsx(A7e,{onClose:G,formData:be,setFormData:me,isEditing:D,onSubmit:Tt,isSubmitting:T||z,accounts:q,contacts:V,users:je,currentAccount:Ue,currentContact:We,onAddAccount:Be,onAddContact:_e,onRefreshAccounts:ot,onRefreshContacts:Re}),c&&a.jsx(CJ,{relatedActs:se,selectedDeal:c,show:!!c,onClose:()=>u(null),activeTab:d,setActiveTab:h,onEdit:St,onDelete:Oe,onStatusUpdate:Et}),E&&a.jsx(S7e,{open:!0,title:E.title,message:E.message,confirmLabel:E.confirmLabel,cancelLabel:E.cancelLabel,variant:E.variant,onConfirm:Ce,onCancel:Qe,loading:z})]})}function S7e({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o=!1,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":i==="archive"?"bg-orange-500 hover:bg-orange-600 border border-orange-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[10000]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsx("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${u}`,disabled:o,children:o?"Processing...":s})]})]})})}function _7e({icon:e,title:t,value:n,color:s="text-blue-600",bgColor:r="bg-blue-100",onClick:i}){const o=()=>{typeof i=="function"?i():console.log(`Clicked: ${t}`)};return a.jsxs("div",{className:"flex items-center p-4 bg-white rounded-xl shadow-md border border-gray-200 transition-all duration-300",onClick:o,children:[a.jsx("div",{className:`flex-shrink-0 p-3 rounded-full ${r} ${s} mr-4`,children:e?a.jsx(e,{size:22}):null}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:t}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:n})]})]})}function A7e({onClose:e,formData:t,setFormData:n,isEditing:s=!1,onSubmit:r,isSubmitting:i=!1,accounts:o=[],contacts:l=[],users:c=[],currentAccount:u=null,currentContact:d=null,onAddAccount:h,onAddContact:p,onRefreshAccounts:x,onRefreshContacts:v}){const[j,y]=f.useState(!1),N=_=>{if(_.preventDefault(),y(!0),!t.name?.trim()){H.error("Deal name is required.");return}const k=Number(t.amount);if(!t.amount||isNaN(k)||k<=0){H.error("Amount must be a number greater than 0.");return}if(!t.account_id){H.error("Please select an account.");return}if(!t.primary_contact_id){H.error("Please select a primary contact.");return}if(!t.assigned_to){H.error("Please assign this deal to a user.");return}r?.(t)},w=_=>{_.target.id==="modalBackdrop"&&e()},S=f.useMemo(()=>{const _=String(t.account_id||"").trim(),k=Array.isArray(l)?l:[];return _?k.filter(T=>{const E=[T?.account_id,T?.accountId,T?.account?.id,T?.account?.account_id,T?.account?.accountId].find(M=>M!=null&&String(M).trim()!=="");return E?String(E)===_:!1}):k},[l,t.account_id]);return f.useEffect(()=>{const _=String(t.account_id||"").trim(),k=String(t.primary_contact_id||"").trim();if(!k||!_)return;S.some(A=>String(A?.id)===k)||n(A=>({...A,primary_contact_id:""}))},[t.account_id,t.primary_contact_id,S,n]),a.jsx("div",{id:"modalBackdrop",onClick:w,className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-full sm:max-w-3xl rounded-2xl shadow-lg p-4 sm:p-6 md:p-8 relative border border-gray-200 overflow-y-auto max-h-[90vh] hide-scrollbar",onClick:_=>_.stopPropagation(),children:[a.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-gray-500 hover:text-black transition",children:a.jsx(ea,{size:22})}),a.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800 mb-4 sm:mb-6 flex items-center justify-center",children:s?"Edit Deal":"Create Deal"}),a.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",onSubmit:N,noValidate:!0,children:[a.jsx(tT,{label:"Deal Name",name:"name",value:t.name,onChange:_=>n({...t,name:_.target.value}),placeholder:"Enter deal name",required:!0,isSubmitted:j,className:"md:col-span-2"}),a.jsx(aT,{label:"Account",value:t.account_id||"",onChange:_=>n({...t,account_id:_}),items:o||[],getLabel:_=>_?.name??"",placeholder:"Search account...",disabled:i,currentItem:u,required:!0,isSubmitted:j,actions:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{type:"button",onClick:h,disabled:i,title:"Add account",className:"inline-flex items-center justify-center w-8 h-8 rounded-md border border-gray-300 text-gray-600 hover:bg-gray-50 transition disabled:opacity-60",children:a.jsx(aa,{size:16})}),a.jsx("button",{type:"button",onClick:x,disabled:i,title:"Refresh accounts",className:"inline-flex items-center justify-center w-8 h-8 rounded-md border border-gray-300 text-gray-600 hover:bg-gray-50 transition disabled:opacity-60",children:a.jsx(Br,{size:16})})]})}),a.jsx(aT,{label:"Primary Contact",value:t.primary_contact_id||"",onChange:_=>n({...t,primary_contact_id:_}),items:S||[],getLabel:_=>`${_?.first_name??""} ${_?.last_name??""}`.trim()||_?.email||"",placeholder:"Search contact...",disabled:i,currentItem:d,required:!0,isSubmitted:j,actions:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{type:"button",onClick:p,disabled:i,title:"Add contact",className:"inline-flex items-center justify-center w-8 h-8 rounded-md border border-gray-300 text-gray-600 hover:bg-gray-50 transition disabled:opacity-60",children:a.jsx(aa,{size:16})}),a.jsx("button",{type:"button",onClick:v,disabled:i,title:"Refresh contacts",className:"inline-flex items-center justify-center w-8 h-8 rounded-md border border-gray-300 text-gray-600 hover:bg-gray-50 transition disabled:opacity-60",children:a.jsx(Br,{size:16})})]})}),a.jsx(S8,{label:"Stage",name:"stage",value:t.stage,onChange:_=>n({...t,stage:_.target.value}),options:[{value:"PROSPECTING",label:"Prospecting"},{value:"QUALIFICATION",label:"Qualification"},{value:"PROPOSAL",label:"Proposal"},{value:"NEGOTIATION",label:"Negotiation"},{value:"CLOSED_WON",label:"Closed Won"},{value:"CLOSED_LOST",label:"Closed Lost"},{value:"CLOSED_CANCELLED",label:"Closed Cancelled"}],disabled:i}),a.jsx(tT,{label:"Amount",name:"amount",type:"number",step:"0.01",value:t.amount,onChange:_=>n({...t,amount:_.target.value}),placeholder:"0",required:!0,isSubmitted:j}),a.jsx(S8,{label:"Currency",name:"currency",value:t.currency||"PHP",onChange:_=>n({...t,currency:_.target.value}),options:[{value:"PHP",label:"PHP"},{value:"USD",label:"USD"}],disabled:i}),a.jsx(tT,{label:"Close Date",name:"close_date",type:"date",value:t.close_date||"",onChange:_=>n({...t,close_date:_.target.value}),disabled:i}),a.jsx(aT,{label:"Assign To",value:t.assigned_to||"",onChange:_=>n({...t,assigned_to:_}),items:c||[],getLabel:_=>`${_?.first_name??""} ${_?.last_name??""}`.trim()||_?.email||"",placeholder:"Search assignee...",disabled:i,required:!0,isSubmitted:j,className:"md:col-span-2"}),a.jsx(k7e,{label:"Description",name:"description",value:t.description,onChange:_=>n({...t,description:_.target.value}),placeholder:"Additional details...",rows:3,className:"md:col-span-2",disabled:i}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-2 md:col-span-2 mt-4",children:[a.jsx("button",{type:"button",onClick:e,className:"w-full sm:w-auto px-4 py-2 text-white bg-red-400 border border-red-300 rounded hover:bg-red-500 transition disabled:opacity-70",disabled:i,children:"Cancel"}),a.jsx("button",{type:"submit",className:"w-full sm:w-auto px-4 py-2 text-white border border-tertiary bg-tertiary rounded hover:bg-secondary transition disabled:opacity-70",disabled:i,children:i?"Saving...":s?"Update Deal":"Save Deal"})]})]})]})})}function tT({label:e,name:t,value:n,onChange:s,placeholder:r,type:i="text",required:o=!1,disabled:l=!1,className:c="",isSubmitted:u=!1}){const d=u&&!n?.trim();return a.jsxs("div",{className:c,children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",o&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:i,name:t,value:n??"",onChange:s,placeholder:r,required:o,disabled:l,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border focus:ring-2
          ${d?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}
          ${c}
        `})]})}function S8({label:e,name:t,value:n,onChange:s,options:r,required:i=!1,disabled:o=!1,className:l=""}){return a.jsxs("div",{className:l,children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsx("select",{name:t,value:n??"",onChange:s,required:i,disabled:o,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100",children:r.map(c=>a.jsx("option",{value:c.value,children:c.label},c.value))})]})}function aT({label:e,items:t=[],value:n="",onChange:s,getLabel:r,placeholder:i="Search...",disabled:o=!1,className:l="",currentItem:c=null,required:u=!1,isSubmitted:d=!1,actions:h=null}){const p=d&&u&&!n;return a.jsxs("div",{className:l,children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",u&&a.jsx("span",{className:"text-red-500",children:"*"})]}),h?a.jsx("div",{className:"flex items-center",children:h}):null]}),a.jsx(T7e,{items:t,value:n??"",onChange:s,getLabel:r,placeholder:i,disabled:o,currentItem:c,hasError:p})]})}function T7e({items:e=[],value:t="",onChange:n,getLabel:s,placeholder:r="Search...",disabled:i=!1,maxRender:o=200,currentItem:l=null,hasError:c=!1}){const[u,d]=f.useState(!1),[h,p]=f.useState(""),x=f.useRef(null),j=e.find(w=>String(w.id)===String(t))||l,y=j?s(j):"",N=f.useMemo(()=>{const w=h.trim().toLowerCase();return(w?e.filter(_=>(s(_)||"").toLowerCase().includes(w)):e).slice(0,o)},[e,h,s,o]);return f.useEffect(()=>{const w=S=>{x.current&&!x.current.contains(S.target)&&d(!1)};return document.addEventListener("mousedown",w),()=>document.removeEventListener("mousedown",w)},[]),f.useEffect(()=>{u||p("")},[u]),a.jsxs("div",{ref:x,className:"relative w-full",children:[a.jsx("input",{disabled:i,value:u?h:y,placeholder:r,onFocus:()=>!i&&d(!0),onChange:w=>{p(w.target.value),u||d(!0)},className:`w-full border rounded-md px-2 py-1.5 text-sm outline-none focus:ring-2
          ${c?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}`}),u&&!i&&a.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg overflow-hidden",children:[a.jsx("div",{className:"max-h-56 overflow-y-auto hide-scrollbar",children:N.length>0?N.map(w=>{const S=String(w.id),_=s(w),k=String(t)===S;return a.jsx("button",{type:"button",onClick:()=>{n(S),d(!1)},className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-50 ${k?"bg-blue-50":""}`,children:_||"--"},S)}):a.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No results"})}),e.length>o&&a.jsxs("div",{className:"px-3 py-2 text-[11px] text-gray-400 border-t",children:["Showing first ",o," results  keep typing to narrow."]})]})]})}function k7e({label:e,name:t,value:n,onChange:s,placeholder:r,required:i=!1,disabled:o=!1,className:l="",rows:c=3}){return a.jsxs("div",{className:l,children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsx("textarea",{name:t,value:n??"",onChange:s,placeholder:r,required:i,disabled:o,rows:c,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100 resize-none"})]})}const nT=[{value:"Draft",label:"Draft"},{value:"Presented",label:"Presented"},{value:"Accepted",label:"Accepted"},{value:"Rejected",label:"Rejected"}],sT={deal_id:"",account_id:"",contact_id:"",total_amount:"",presented_date:"",validity_days:"",status:"Draft",assigned_to:"",notes:"",subtotal:0,tax_rate:0,tax_amount:0,discount_type:"",discount_value:0,discount_amount:0,currency:"PHP",items:[]},zi=e=>{if(!e)return"Draft";const t=e.toString().trim().toLowerCase();return{draft:"Draft",presented:"Presented",accepted:"Accepted",rejected:"Rejected"}[t]||"Draft"},rT=e=>e?e.toString().toLowerCase().replace(/\b\w/g,t=>t.toUpperCase()):"--",E7e=e=>{switch(zi(e).toLowerCase()){case"draft":return"bg-gray-100 text-gray-700";case"presented":return"bg-yellow-100 text-yellow-700";case"accepted":return"bg-green-100 text-green-700";case"rejected":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-700"}},L7e=e=>{switch(zi(e).toLowerCase()){case"draft":return"bg-gray-600 text-white";case"presented":return"bg-yellow-600 text-white";case"accepted":return"bg-green-600 text-white";case"rejected":return"bg-red-600 text-white";default:return"bg-gray-600 text-white"}},Db=e=>e?new Date(e).toLocaleString("en-US",{month:"2-digit",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).replace(",",""):"",Lg=e=>e?new Date(e).toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"numeric"}):"",P7e=e=>{if(!e)return"";if(typeof e=="string"&&e.match(/^\d{4}-\d{2}-\d{2}$/))return e;try{const t=new Date(e);if(isNaN(t.getTime()))return"";const n=t.getFullYear(),s=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0");return`${n}-${s}-${r}`}catch{return""}},iT=(e,t)=>{if(!e||t==null||t==="")return"";const n=Number(t);if(Number.isNaN(n))return"";const s=new Date(e);return isNaN(s.getTime())?"":(s.setDate(s.getDate()+n),s.toISOString().slice(0,10))},_8=e=>{if(!e)return"";const t=String(e).split("-");return t.length===3?`${t[0]}-${t[2]}`:String(e)},oT=e=>{if(!e)return"";const t=String(e).split("-");return t.length===3?`${t[0]}-${t[2]}`:String(e)},Qw=e=>{if(!e)return null;if(typeof e=="number")return e;if(typeof e=="string"&&e.trim()&&!Number.isNaN(Number(e)))return Number(e);if(typeof e=="object"){if(e.id&&!Number.isNaN(Number(e.id)))return Number(e.id);if(e.user?.id&&!Number.isNaN(Number(e.user.id)))return Number(e.user.id);if(e.data?.id&&!Number.isNaN(Number(e.data.id)))return Number(e.data.id);if(e.profile?.id&&!Number.isNaN(Number(e.profile.id)))return Number(e.profile.id)}return null},D7e=()=>{const e=["user","currentUser","userData","authUser","profile"];for(const s of e){const r=localStorage.getItem(s);if(r)try{const i=JSON.parse(r),o=Qw(i);if(o)return o}catch{}}const t=localStorage.getItem("user_id"),n=Qw(t);return n||null},O7e=e=>{if(!e)return"";const n=[e.account_id,e.accountId,e.account?.id,e.account?.account_id,e.account?.accountId].find(s=>s!=null&&String(s).trim()!=="");return n?String(n):""},M7e=e=>{if(!e)return"";const n=[e.contact_id,e.contactId,e.contact?.id,e.primary_contact_id,e.primaryContactId,e.primary_contact?.id,e.primaryContact?.id].find(s=>s!=null&&String(s).trim()!=="");return n?String(n):""};function I7e(){const e=kt(),t=ta(),{user:n}=Vt(),s=n?.company?.currency||"";f.useEffect(()=>{document.title="Quotes | Sari-Sari CRM"},[]);const[r,i]=f.useState([]),[o,l]=f.useState(!1),[c,u]=f.useState([]),[d,h]=f.useState([]),[p,x]=f.useState([]),[v,j]=f.useState([]),[y,N]=f.useState(null),[w,S]=f.useState(null),[_,k]=f.useState(!1),[T,A]=f.useState(!1),[E,M]=f.useState(!1),[z,P]=f.useState(null),[D,U]=f.useState(!1),[B,R]=f.useState(!1),[q,Z]=f.useState(null),[V,oe]=f.useState(sT),[je,X]=f.useState(""),[se,ye]=f.useState("Filter by Status"),[Ne,fe]=f.useState(null),we=f.useCallback(async()=>{if(w)try{R(!0);const L=(await re.get("/company/invoice-info"))?.data;e(`/manager/quotes/${encodeURIComponent(w.id)}/print`,{state:{quote:w,companyInfo:L}})}catch(I){const L=I?.response?.data?.detail||I?.message||"Failed to open print page.";H.error(L)}finally{R(!1)}},[w,e]),[de,ke]=f.useState(1),[ge,$e]=f.useState(10),[be,me]=f.useState("Overview"),[Ue,Ee]=f.useState("Draft"),[We,tt]=f.useState([]),[lt,Fe]=f.useState(null),{comments:st,addComment:Xe,refresh:Ze}=kn({relatedType:"quote",relatedId:w?.id});f.useEffect(()=>{w?.id&&Ze()},[w?.id,Ze]),f.useEffect(()=>{const L=t.state?.quoteID;if(L){Fe(L),e(t.pathname,{replace:!0,state:{}});return}},[t,e]),f.useEffect(()=>{if(lt&&r.length>0&&!o){const I=r.find(L=>L.id===lt);I?S(I):H.error("Quote not found."),Fe(null)}},[lt,r,o]),f.useEffect(()=>{let I=!0;return(async()=>{const ee=D7e();if(ee&&I){N(ee);return}try{const Le=await re.get("/auth/me"),ze=Qw(Le?.data);if(ze&&I){N(ze);return}}catch{}try{const Le=await re.get("/users/me"),ze=Qw(Le?.data);if(ze&&I){N(ze);return}}catch{}I&&N(null)})(),()=>{I=!1}},[]);const Je=f.useCallback(I=>I&&d.find(ee=>String(ee.id)===String(I))?.name||"",[d]),Be=f.useCallback(I=>{if(!I)return"";const L=p.find(ee=>String(ee.id)===String(I));return L?`${L.first_name} ${L.last_name}`.trim():""},[p]),_e=f.useCallback(I=>{if(!I)return"--";const L=c.find(ee=>String(ee.id)===String(I));return L?.deal_name||L?.name||`Deal #${_8(I)}`},[c]),pe=f.useCallback(I=>{const L=c.find(ze=>String(ze.id)===String(I)),ee=O7e(L);let Le=M7e(L);if(!Le&&ee){const ze=p.filter(Ve=>String(Ve.account_id||"")===String(ee));if(ze.length>0){const Ve=[...ze].sort((ft,_t)=>{const At=`${ft.first_name||""} ${ft.last_name||""}`.trim().toLowerCase(),Yt=`${_t.first_name||""} ${_t.last_name||""}`.trim().toLowerCase();return At.localeCompare(Yt)});Le=String(Ve[0].id)}}if(ee&&Le){const ze=p.find(Ve=>String(Ve.id)===String(Le));ze?.account_id&&String(ze.account_id)!==String(ee)&&(Le="")}return{accountId:ee||"",contactId:Le||""}},[c,p]),ce=f.useCallback(I=>{if(!I)return"--";if(I.deal?.deal_name)return I.deal.deal_name;if(I.deal?.name)return I.deal.name;const L=I.deal_id||I.deal?.id;return L?_e(L):"--"},[_e]),Q=f.useCallback(I=>{if(!I)return"--";if(I.account?.name)return I.account.name;let L=I.account_id||I.account?.id;if(!L){const ee=I.deal_id||I.deal?.id;ee&&(L=pe(ee).accountId)}return L?Je(L)||`Account #${L}`:"--"},[pe,Je]),ne=f.useCallback(I=>{if(!I)return"--";if(I.contact?.first_name||I.contact?.last_name)return`${I.contact?.first_name||""} ${I.contact?.last_name||""}`.trim()||"--";let L=I.contact_id||I.contact?.id;if(!L){const Le=I.deal_id||I.deal?.id;Le&&(L=pe(Le).contactId)}return(L?Be(L):"")||(L?`Contact #${L}`:"--")},[pe,Be]),ae=f.useCallback(async(I=null)=>{l(!0);try{const L=await re.get("/quotes/admin/fetch-all"),Le=[...Array.isArray(L.data)?L.data:[]].sort((ze,Ve)=>{const ft=ze?.created_at||ze?.updated_at||0,_t=Ve?.created_at||Ve?.updated_at||0;return new Date(_t)-new Date(ft)});if(i(Le),I){const ze=Le.find(Ve=>Ve.id===I);S(ze||null)}}catch(L){console.error(L),i([]),L.response?.status===403?H.error("Permission denied. Only CEO, Admin, or Group Manager can access this page."):H.error("Failed to fetch quotes. Please try again later.")}finally{l(!1)}},[]),Pe=f.useCallback(async()=>{try{const I=await re.get("/deals/admin/fetch-all");u(Array.isArray(I.data)?I.data:[])}catch(I){console.error(I),I.response?.status===403&&H.warn("Unable to load deals (permission denied).")}},[]),Te=f.useCallback(async()=>{try{const I=await re.get("/accounts/admin/fetch-all");h(Array.isArray(I.data)?I.data:[])}catch(I){console.error(I),I.response?.status===403&&H.warn("Unable to load accounts (permission denied).")}},[]),he=f.useCallback(async()=>{try{const I=await re.get("/contacts/admin/fetch-all");x(Array.isArray(I.data)?I.data:[])}catch(I){console.error(I),I.response?.status===403&&H.warn("Unable to load contacts (permission denied).")}},[]),He=f.useCallback(async()=>{try{const I=await re.get("/users/all");j(Array.isArray(I.data)?I.data:[])}catch(I){console.error(I),I.response?.status===403&&H.warn("Unable to load users (permission denied).")}},[]);f.useEffect(()=>{ae(),Pe(),Te(),he(),He()},[ae,Pe,Te,he,He]);const qe=f.useMemo(()=>{const I=je.trim().toLowerCase(),L=se.trim();return r.filter(ee=>{const Le=ce(ee),ze=Q(ee),Ve=ne(ee),ft=iT(ee.presented_date,ee.validity_days),_t=[ee.quote_id,Le,ze,Ve,ee.total_amount?.toString(),ee.validity_days?.toString(),ee.presented_date?Lg(ee.presented_date):"",ft?Lg(ft):"",ee.assigned_user?.first_name,ee.assigned_user?.last_name,ee.creator?.first_name,ee.creator?.last_name,ee.status,ee.notes,Db(ee.created_at),Db(ee.updated_at)],At=I===""||_t.some(En=>En==null?!1:En.toString().toLowerCase().includes(I)),Yt=L==="Filter by Status"||zi(ee.status)===L;return At&&Yt})},[r,je,se,ce,Q,ne]),nt=Math.max(1,Math.ceil(qe.length/ge)||1);f.useEffect(()=>ke(1),[je,se]),f.useEffect(()=>{ke(I=>{const L=Math.max(1,Math.ceil(qe.length/ge)||1);return I>L?L:I})},[qe.length,ge]);const ot=f.useMemo(()=>{const I=(de-1)*ge;return qe.slice(I,I+ge)},[qe,de,ge]),Re=()=>ke(I=>Math.max(I-1,1)),it=()=>ke(I=>Math.min(I+1,nt)),St=I=>{S(I),me("Overview"),Ee(zi(I?.status)||"Draft")},Et=()=>{S(null),me("Overview")},Tt=I=>{I.target.id==="quoteModalBackdrop"&&!D&&Et()},Nt=f.useCallback(()=>{k(!1),A(!1),Z(null),oe(sT),M(!1)},[]),xe=I=>{I.target.id==="modalBackdrop"&&!E&&!D&&Nt()},ve=I=>{const{name:L,value:ee}=I.target;if(L==="deal_id"){const{accountId:Le,contactId:ze}=pe(ee);oe(Ve=>({...Ve,deal_id:ee,account_id:Le,contact_id:ze}));return}oe(Le=>({...Le,[L]:ee}))},Oe=()=>{oe(sT),A(!1),Z(null),k(!0)},Ce=I=>{if(!I)return;S(null);const L=I.deal?.id?String(I.deal.id):I.deal_id?String(I.deal_id):"",ee=L?pe(L):{accountId:"",contactId:""},Le=I.account?.id?String(I.account.id):I.account_id?String(I.account_id):ee.accountId,ze=I.contact?.id?String(I.contact.id):I.contact_id?String(I.contact_id):ee.contactId,Ve=I.assigned_user?.id?String(I.assigned_user.id):I.assigned_to?String(I.assigned_to):"";oe({deal_id:L,account_id:Le||"",contact_id:ze||"",total_amount:I.total_amount?.toString()||"",presented_date:P7e(I.presented_date),validity_days:I.validity_days!==null&&I.validity_days!==void 0?String(I.validity_days):"",status:zi(I.status)||"Draft",assigned_to:Ve,notes:I.notes||"",subtotal:parseFloat(I.subtotal)||0,tax_rate:parseFloat(I.tax_rate)||0,tax_amount:parseFloat(I.tax_amount)||0,discount_type:I.discount_type||"",discount_value:parseFloat(I.discount_value)||0,discount_amount:parseFloat(I.discount_amount)||0,currency:I.currency||"PHP",items:Array.isArray(I.items)?I.items.map(ft=>({id:ft.id,item_type:ft.item_type||"Product",name:ft.name||"",description:ft.description||"",sku:ft.sku||"",variant:ft.variant||"",unit:ft.unit||"pcs",quantity:parseFloat(ft.quantity)||1,unit_price:parseFloat(ft.unit_price)||0,discount_percent:parseFloat(ft.discount_percent)||0,discount_amount:parseFloat(ft.discount_amount)||0,line_total:parseFloat(ft.line_total)||0,sort_order:ft.sort_order||0})):[]}),A(!0),Z(I.id),k(!0)},Qe=I=>{if(I.target.checked){const L=ot.filter(ee=>ee.created_by===y).map(ee=>ee.id);tt(L)}else tt([])},G=I=>{tt(L=>L.includes(I)?L.filter(ee=>ee!==I):[...L,I])},W=ot.filter(I=>I.created_by===y),J=I=>{if(!I)return;const L=I.quote_id||"this quote";P({title:"Archive Quote",message:a.jsxs("span",{children:["Are you sure you want to archive"," ",a.jsx("span",{className:"font-semibold",children:L}),"? This action cannot be undone."]}),confirmLabel:"Archive Quote",cancelLabel:"Cancel",variant:"danger",action:{type:"delete",targetId:I.id,name:L}})},Y=async()=>{We.length!==0&&P({title:"Archive Quotes",message:a.jsxs("span",{children:["Are you sure you want to archive"," ",a.jsx("span",{className:"font-semibold",children:We.length})," selected quotes? This action cannot be undone."]}),confirmLabel:`Archive ${We.length} Quote(s)`,cancelLabel:"Cancel",variant:"danger",action:{type:"bulk-delete",quote_ids:We}})},[F,ue]=f.useState(!1),De=I=>{if(I.preventDefault(),ue(!0),!y){H.error("Unable to determine current user. Please log in again.");return}if(!V.deal_id){H.error("Deal is required.");return}if(!V.assigned_to){H.error("Assigned To is required.");return}const ee=pe(V.deal_id),Le=V.items.map((At,Yt)=>({item_type:At.item_type||"Product",name:At.name,description:At.description||null,sku:At.sku||null,variant:At.variant||null,unit:At.unit||null,quantity:parseFloat(At.quantity)||1,unit_price:parseFloat(At.unit_price)||0,discount_percent:parseFloat(At.discount_percent)||0,sort_order:At.sort_order??Yt})),ze={deal_id:Number(V.deal_id),account_id:ee.accountId?Number(ee.accountId):null,contact_id:ee.contactId?Number(ee.contactId):null,subtotal:parseFloat(V.subtotal)||0,tax_rate:parseFloat(V.tax_rate)||0,tax_amount:parseFloat(V.tax_amount)||0,discount_type:V.discount_type||null,discount_value:parseFloat(V.discount_value)||0,discount_amount:parseFloat(V.discount_amount)||0,total_amount:parseFloat(V.total_amount)||0,currency:V.currency||"PHP",presented_date:V.presented_date||null,validity_days:V.validity_days===""?null:Number(V.validity_days),status:V.status||"Draft",assigned_to:V.assigned_to?Number(V.assigned_to):null,notes:V.notes?.trim()||null,items:Le},Ve=T&&q?"update":"create",ft=_e(V.deal_id),_t=Ve==="create"?{...ze,created_by_id:Number(y)}:ze;P({title:Ve==="create"?"Confirm New Quote":"Confirm Update",message:Ve==="create"?a.jsxs("span",{children:["Are you sure you want to create a quote for"," ",a.jsx("span",{className:"font-semibold",children:ft}),"?"]}):a.jsxs("span",{children:["Save changes to"," ",a.jsx("span",{className:"font-semibold",children:ft}),"?"]}),confirmLabel:Ve==="create"?"Create Quote":"Update Quote",cancelLabel:"Cancel",variant:"primary",action:{type:Ve,payload:_t,targetId:q||null,name:ft}})},le=async()=>{if(!z?.action){P(null);return}const{action:I}=z,{type:L,payload:ee,targetId:Le,name:ze}=I;U(!0);try{if(L==="create")M(!0),await re.post("/quotes/admin",ee),H.success("Quote created successfully."),Nt(),await ae();else if(L==="update"){if(!Le)throw new Error("Missing quote identifier for update.");M(!0),await re.put(`/quotes/admin/${Le}`,ee),H.success("Quote updated successfully."),Nt(),await ae(),w?.id===Le&&S(null)}else if(L==="delete"){if(!Le)throw new Error("Missing quote identifier for deletion.");const Ve=w?.id;fe(Le),await re.delete(`/quotes/admin/${Le}`),H.success(`Quote "${ze}" archived successfully.`),await ae(Ve&&Ve!==Le?Ve:null),Ve===Le&&S(null)}else L==="bulk-delete"&&(await re.post("/quotes/admin/bulk-delete",{quote_ids:We}),H.success(`Successfully archived ${We.length} quotes`),tt([]),await ae())}catch(Ve){console.error(Ve);const ft=L==="create"?"Failed to create quote. Please review the details and try again.":L==="update"?"Failed to update quote. Please review the details and try again.":"Failed to delete quote. Please try again.";H.error(ft),(L==="create"||L==="update")&&M(!1),L==="delete"&&fe(null)}finally{(L==="create"||L==="update")&&M(!1),L==="delete"&&fe(null),U(!1),P(null)}},Ie=()=>{D||P(null)},K=f.useCallback((I,L)=>{const ee=I?.deal_id??I?.deal?.id??"",Le=ee?Number(ee):null,ze=Le?pe(String(Le)):{accountId:"",contactId:""},Ve=I?.account_id??I?.account?.id??ze.accountId??null,ft=I?.contact_id??I?.contact?.id??ze.contactId??null,_t=I?.total_amount??0,At=I?.assigned_to??I?.assigned_user?.id??null;return{deal_id:Le,account_id:Ve!=null&&String(Ve).trim()!==""?Number(Ve):null,contact_id:ft!=null&&String(ft).trim()!==""?Number(ft):null,total_amount:Number(_t),presented_date:I?.presented_date||null,validity_days:I?.validity_days===""||I?.validity_days===void 0||I?.validity_days===null?null:Number(I.validity_days),status:L,assigned_to:At!=null&&String(At).trim()!==""?Number(At):null,notes:I?.notes?.trim()||null}},[pe]),ie=f.useCallback(async()=>{if(!w?.id)return;const I=zi(Ue),L=[I,I.toLowerCase()],ee=async Le=>re.patch(`/quotes/admin/${w.id}/status`,{status:Le},{headers:{"Content-Type":"application/json"}});try{let Le=!1;for(const ze of L)try{await ee(ze),Le=!0;break}catch(Ve){if(Ve?.response?.status===422)continue;throw Ve}if(!Le){const ze=K(w,I);if(!ze.deal_id){H.error("Cannot update status: missing deal_id on selected quote.");return}if(!ze.total_amount||ze.total_amount<=0){H.error("Cannot update status: missing/invalid total_amount on selected quote.");return}await re.put(`/quotes/admin/${w.id}`,ze)}H.success(`Quote status updated to ${I}`),S(null),me("Overview"),await ae()}catch(Le){console.error(Le);const ze=Le?.response?.data?.message||(Le?.response?.data?.errors?Object.values(Le.response.data.errors).flat().join(" "):null)||"Failed to update quote status. Please try again.";H.error(ze)}},[w,Ue,ae,K]),Me=[{label:"Filter by Status",value:"Filter by Status"},...nT.map(I=>({label:I.label,value:I.value}))],Ke=z?.action?.type==="delete"?z.action.targetId:null,gt=w&&(Ne===w.id||Ke===w.id),Ct=w&&Ne===w.id,Ht=w?a.jsx("div",{id:"quoteModalBackdrop",onClick:Tt,className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-6xl max-h-[92vh] overflow-y-auto hide-scrollbar animate-scale-in font-inter relative",onClick:I=>I.stopPropagation(),children:[a.jsx("div",{className:"w-full flex flex-col items-center justify-center rounded-t-xl",children:a.jsxs("div",{className:"bg-tertiary w-full flex items-center justify-between p-3 lg:p-3 rounded-t-xl",children:[a.jsx("h1",{className:"lg:text-3xl text-xl text-white font-semibold text-center w-full",children:"Quotes"}),a.jsx("button",{onClick:Et,className:"text-gray-500 hover:text-white transition cursor-pointer",children:a.jsx(Ja,{size:25})})]})}),a.jsxs("div",{className:"p-6 lg:p-4",children:[a.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between lg:flex-row lg:items-center lg:justify-between mt-3 gap-2 px-2 md:items-center lg:gap-4 md:mx-7 lg:mx-7",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[a.jsx("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-800",children:ce(w)}),a.jsx("span",{className:`text-xs sm:text-sm font-medium px-2 sm:px-3 py-1 rounded-full whitespace-nowrap ${L7e(w.status)}`,children:rT(w.status)})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsxs("button",{className:"inline-flex items-center justify-center w-full sm:w-auto bg-white text-gray-700 px-4 py-2 rounded-md border border-gray-300 hover:bg-gray-50 disabled:opacity-70 transition text-sm focus:outline-none focus:ring-2 focus:ring-gray-300",onClick:we,disabled:B||E||D,children:[a.jsx(ia,{className:"mr-2"}),B?"Preparing...":"Print Quotation"]}),y===w.created_by&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{className:"inline-flex items-center justify-center w-full sm:w-auto bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 disabled:opacity-70 transition text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",onClick:()=>Ce(w),disabled:D||z?.action?.type==="update"&&z.action.targetId===w.id,children:[a.jsx(gn,{className:"mr-2"}),"Edit"]}),a.jsx("button",{className:"inline-flex items-center justify-center w-full sm:w-auto px-4 py-2 rounded-md text-sm bg-orange-500 text-white hover:bg-orange-600 transition focus:outline-none focus:ring-2 focus:ring-orange-400",onClick:()=>J(w),disabled:!!gt,children:Ct?"Archiving...":a.jsxs(a.Fragment,{children:[a.jsx(Zt,{className:"mr-2"}),"Archive"]})})]})]})]}),a.jsx("div",{className:"border-b border-gray-200 my-5"}),a.jsxs("div",{className:"p-1 lg:p-4",children:[a.jsx("div",{className:"flex w-full bg-[#6A727D] text-white mt-1 overflow-x-auto mb-6",children:["Overview","Notes"].map(I=>a.jsx("button",{onClick:()=>me(I),className:`flex-1 min-w-[90px] px-4 py-2.5 text-xs sm:text-sm font-medium text-center transition-all duration-200 border-b-2
                    ${be===I?"bg-paper-white text-[#6A727D] border-white":"text-white hover:bg-[#5c636d]"}`,children:I},I))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 items-start",children:[a.jsxs("div",{className:"lg:col-span-3",children:[be==="Overview"&&a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 md:p-8 border border-gray-200",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4 sm:gap-6 text-sm text-gray-700",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Quote ID:"}),a.jsx("p",{children:oT(w.quote_id)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Deal:"}),a.jsx("p",{children:ce(w)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Account:"}),a.jsx("p",{children:Q(w)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Contact:"}),a.jsx("p",{children:ne(w)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Total Amount:"}),a.jsx("p",{children:w.total_amount?`${s}${Number(w.total_amount).toLocaleString()}`:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Presented Date:"}),a.jsx("p",{children:Lg(w.presented_date)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Validity Days:"}),a.jsx("p",{children:w.validity_days!==null&&w.validity_days!==void 0?w.validity_days:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Expiry Date:"}),a.jsx("p",{children:Lg(iT(w.presented_date,w.validity_days))||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Status:"}),a.jsx("p",{children:rT(w.status)})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Assigned To:"}),a.jsx("p",{children:w.assigned_user?`${w.assigned_user.first_name} ${w.assigned_user.last_name}`:"Unassigned"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created By:"}),a.jsx("p",{children:w.creator?`${w.creator.first_name} ${w.creator.last_name}`:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created At:"}),a.jsx("p",{children:Db(w.created_at)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Last Updated:"}),a.jsx("p",{children:Db(w.updated_at)||"N/A"})]})]}),w.items&&w.items.length>0&&a.jsx("div",{className:"mt-6",children:a.jsx(jd,{items:w.items,onChange:()=>{},currencySymbol:s,readOnly:!0,taxRate:parseFloat(w.tax_rate)||0,discountType:w.discount_type,discountValue:parseFloat(w.discount_value)||0})})]}),be==="Notes"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"bg-white p-4 sm:p-6 rounded-xl border border-gray-200 shadow-sm",children:[a.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Notes:"}),a.jsx("p",{className:"text-sm text-gray-700 leading-relaxed whitespace-pre-wrap",children:w.notes||"No notes available."})]}),a.jsx(Tn,{comments:st,onAddComment:Xe})]})]}),a.jsxs("div",{className:"flex flex-col gap-4",children:[a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Quick Actions"}),a.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[a.jsxs("button",{onClick:()=>e("/manager/calls",{state:{openCallModal:!0,initialCallData:{subject:`Call regarding Quote ${oT(w.quote_id)}`,assigned_to:w.assigned_user?.id?String(w.assigned_user.id):w.assigned_to?String(w.assigned_to):"",direction:"Outgoing",status:"Planned"}}}),className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(It,{className:"text-gray-600 w-4 h-4"}),"Schedule Call"]}),a.jsxs("button",{className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",onClick:()=>e("/manager/meetings",{state:{openMeetingModal:!0,initialMeetingData:{subject:`Meeting with ${w.quote_id}`,assignedTo:w.assigned_user?.id?String(w.assigned_user.id):w.assigned_to?String(w.assigned_to):"",status:"Planned"}}}),children:[a.jsx(Ot,{className:"text-gray-600 w-4 h-4"}),"Book Meeting"]}),a.jsxs("button",{onClick:()=>e("/manager/tasks",{state:{openTaskModal:!0,initialTaskData:{subject:`Follow up with ${w.quote_id}`,assignedTo:w.assigned_user?.id?String(w.assigned_user.id):w.assigned_to?String(w.assigned_to):"",priority:"NORMAL",status:"Not Started"}}}),className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(Qt,{className:"text-gray-600 w-4 h-4"}),"Tasks"]})]})]}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm w-full",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Status"}),a.jsx("select",{className:"border border-gray-200 rounded-md px-2 sm:px-3 py-1.5 w-full text-sm mb-2 focus:ring-2 focus:ring-indigo-500 outline-none",value:Ue||zi(w.status)||"Draft",onChange:I=>Ee(I.target.value),children:nT.map(I=>a.jsx("option",{value:I.value,children:I.label},I.value))}),a.jsx("button",{onClick:ie,disabled:zi(Ue)===zi(w.status),className:`w-full py-1.5 rounded-md text-sm transition focus:outline-none focus:ring-2 ${zi(Ue)===zi(w.status)?"bg-gray-400 cursor-not-allowed text-white":"bg-gray-900 text-white hover:bg-gray-800 focus:ring-gray-400"}`,children:"Update"})]})]})]})]})]})]})}):null,da=a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[o&&a.jsx(Wt,{message:"Loading quotes..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h2",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(ia,{className:"mr-2 text-blue-600"})," Quotes"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto gap-2",children:a.jsxs("button",{onClick:()=>{Oe(),ue(!1)},className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 rounded-md hover:bg-gray-800 text-sm sm:text-base mx-auto sm:ml-auto cursor-pointer",children:[a.jsx(aa,{className:"mr-2"})," Add Quote"]})})]}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search quotes",value:je,onChange:I=>X(I.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsx("div",{className:"w-full lg:w-1/4",children:a.jsx("select",{value:se,onChange:I=>ye(I.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:Me.map(I=>a.jsx("option",{value:I.value,children:I.label},I.value))})})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[900px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 text-sm tracking-wide font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 w-12",children:a.jsx("input",{type:"checkbox",checked:W.length>0&&We.length===W.length,onChange:Qe,className:"cursor-pointer"})}),a.jsx("th",{className:"py-3 px-4",children:"Quote ID"}),a.jsx("th",{className:"py-3 px-4",children:"Deal"}),a.jsx("th",{className:"py-3 px-4",children:"Account"}),a.jsx("th",{className:"py-3 px-4",children:"Contact"}),a.jsx("th",{className:"py-3 px-4",children:"Total Amount"}),a.jsx("th",{className:"py-3 px-4",children:"Status"}),a.jsx("th",{className:"py-3 px-4",children:"Assigned To"}),a.jsx("th",{className:"py-3 px-4",children:"Expiry Date"}),a.jsx("th",{className:"py-3 px-4 text-center w-24",children:We.length>0?a.jsx("button",{onClick:Y,className:"text-orange-600 hover:text-orange-800 transition p-1 rounded-full hover:bg-orange-50",title:`Archive ${We.length} selected items`,children:a.jsx(Zt,{size:18})}):""})]})}),a.jsx("tbody",{children:o?a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:10,children:"Loading quotes..."})}):qe.length>0?ot.map(I=>{const L=iT(I.presented_date,I.validity_days);return a.jsxs("tr",{className:"hover:bg-gray-50 text-sm cursor-pointer transition",onClick:()=>St(I),children:[a.jsx("td",{className:"py-3 px-4 align-top w-12",onClick:ee=>ee.stopPropagation(),children:I.created_by===y&&a.jsx("input",{type:"checkbox",checked:We.includes(I.id),onChange:()=>G(I.id),className:"cursor-pointer"})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("div",{className:"font-medium text-blue-600 hover:underline whitespace-nowrap",children:oT(I.quote_id)||"--"})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("div",{className:"break-words",children:ce(I)||"--"})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("div",{className:"text-sm text-gray-700 break-words",children:Q(I)||"--"})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("div",{className:"break-words",children:ne(I)||"--"})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("div",{className:"text-gray-700",children:I.total_amount?`${s}${Number(I.total_amount).toLocaleString()}`:"--"})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-medium ${E7e(I.status)}`,children:rT(I.status)})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("div",{children:I.assigned_user?`${I.assigned_user.first_name} ${I.assigned_user.last_name}`:"Unassigned"})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("div",{className:"text-gray-500 text-xs",children:Lg(L)||"--"})}),a.jsx("td",{className:"py-3 px-4 align-top text-center w-24"})]},I.id)}):a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:10,children:"No quotes found."})})})]})}),a.jsx(ca,{className:"mt-4",totalItems:qe.length,pageSize:ge,currentPage:de,onPrev:Re,onNext:it,onPageSizeChange:I=>{$e(I),ke(1)},pageSizeOptions:[10,20,30,40,50],label:"quotes"})]}),Ge=_?a.jsx("div",{id:"modalBackdrop",onClick:xe,className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-full sm:max-w-3xl rounded-2xl shadow-lg p-4 sm:p-6 md:p-8 relative border border-gray-200 overflow-y-auto max-h-[90vh] hide-scrollbar",onClick:I=>I.stopPropagation(),children:[a.jsx("button",{onClick:()=>{Nt(),ue(!1)},className:"absolute top-4 right-4 text-gray-500 hover:text-black transition disabled:opacity-60",disabled:E||D,children:a.jsx(ea,{size:22})}),a.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800 mb-4 sm:mb-6 flex items-center justify-center",children:T?"Edit Quote":"Add New Quote"}),a.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",onSubmit:De,children:[a.jsx(k8,{label:"Deal",name:"deal_id",value:V.deal_id,onChange:I=>{const{accountId:L,contactId:ee}=pe(I);oe(Le=>({...Le,deal_id:I,account_id:L,contact_id:ee}))},items:Array.isArray(c)?c:[],getLabel:I=>`${_8(I?.deal_id??"")} ${I?.name??""}`.trim(),placeholder:"Search deal...",required:!0,isSubmitted:F,disabled:E||c.length===0,className:"md:col-span-2"}),a.jsx(T8,{label:"Account",value:Je(V.account_id)||(V.account_id?`Account #${V.account_id}`:""),disabled:!0}),a.jsx(T8,{label:"Contact",value:Be(V.contact_id)||(V.contact_id?`Contact #${V.contact_id}`:""),disabled:!0}),a.jsx("div",{className:"md:col-span-2 mt-2",children:a.jsx(jd,{items:V.items,onChange:I=>oe(L=>({...L,items:I})),currencySymbol:s,readOnly:E,taxRate:V.tax_rate,discountType:V.discount_type,discountValue:V.discount_value,onTotalsChange:I=>{oe(L=>({...L,subtotal:I.subtotal,discount_amount:I.discount_amount,tax_amount:I.tax_amount,total_amount:I.total_amount}))}})}),a.jsxs("div",{className:"md:col-span-2 mt-2 p-4 bg-gray-50 rounded-lg",children:[a.jsx("h4",{className:"font-medium text-gray-700 mb-3",children:"Pricing Settings"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-600 text-xs mb-1",children:"Discount Type"}),a.jsxs("select",{value:V.discount_type||"",onChange:I=>oe(L=>({...L,discount_type:I.target.value})),className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm",disabled:E,children:[a.jsx("option",{value:"",children:"No Discount"}),a.jsx("option",{value:"percentage",children:"Percentage (%)"}),a.jsx("option",{value:"fixed",children:"Fixed Amount"})]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-gray-600 text-xs mb-1",children:["Discount"," ",V.discount_type==="percentage"?"%":"Amount"]}),a.jsx("input",{type:"number",value:V.discount_value||"",onChange:I=>oe(L=>({...L,discount_value:I.target.value})),className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm",placeholder:"0",min:"0",max:V.discount_type==="percentage"?"100":void 0,step:"0.01",disabled:E||!V.discount_type})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-600 text-xs mb-1",children:"Tax Rate (%)"}),a.jsx("input",{type:"number",value:V.tax_rate||"",onChange:I=>oe(L=>({...L,tax_rate:I.target.value})),className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm",placeholder:"0",min:"0",max:"100",step:"0.01",disabled:E})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-600 text-xs mb-1",children:"Total Amount"}),a.jsxs("div",{className:"w-full bg-gray-100 border border-gray-300 rounded-md px-2 py-1.5 text-sm font-medium",children:[s,parseFloat(V.total_amount||0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]})]}),a.jsx(A8,{label:"Presented Date",name:"presented_date",type:"date",value:V.presented_date,onChange:ve,disabled:E}),a.jsx(A8,{label:"Validity Days",name:"validity_days",type:"number",value:V.validity_days,onChange:ve,placeholder:"30",disabled:E}),a.jsx(k8,{label:"Assigned To",value:V.assigned_to||"",onChange:I=>oe(L=>({...L,assigned_to:I})),items:Array.isArray(v)?v:[],getLabel:I=>{const L=`${I?.first_name??""} ${I?.last_name??""}`.trim();return L?I?.role?`${L} (${I.role})`:L:I?.email||""},placeholder:"Search assignee...",required:!0,isSubmitted:F,disabled:E}),a.jsx($7e,{label:"Status",name:"status",value:V.status,onChange:ve,options:nT,required:!0,disabled:E}),a.jsx(z7e,{label:"Notes",name:"notes",value:V.notes,onChange:ve,placeholder:"Additional details...",rows:3,disabled:E,className:"md:col-span-2"}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-2 md:col-span-2 mt-4",children:[a.jsx("button",{type:"button",onClick:()=>{Nt(),ue(!1)},className:"w-full sm:w-auto px-4 py-2 text-white bg-red-400 border border-red-300 rounded hover:bg-red-500 transition disabled:opacity-70",disabled:E||D,children:"Cancel"}),a.jsx("button",{type:"submit",className:"w-full sm:w-auto px-4 py-2 text-white border border-tertiary bg-tertiary rounded hover:bg-secondary transition disabled:opacity-70",disabled:E||D,children:E?"Saving...":T?"Update Quote":"Save Quote"})]})]})]})}):null,Ae=z?a.jsx(F7e,{open:!0,title:z.title,message:z.message,confirmLabel:z.confirmLabel,cancelLabel:z.cancelLabel,variant:z.variant,onConfirm:le,onCancel:Ie,loading:D}):null;return a.jsxs(a.Fragment,{children:[w?Ht:da,Ge,Ae]})}function A8({label:e,name:t,value:n,onChange:s,placeholder:r,type:i="text",required:o=!1,disabled:l=!1,className:c="",isSubmitted:u=!1}){const d=u&&!n?.trim();return a.jsxs("div",{className:c,children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",o&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:i,name:t,value:n??"",onChange:s,placeholder:r,required:o,disabled:l,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border focus:ring-2
          ${d?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}
          ${c}
        `})]})}function T8({label:e,value:t,className:n="",disabled:s=!0}){return a.jsxs("div",{className:n,children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsx("input",{type:"text",value:t??"",disabled:s,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm outline-none disabled:bg-gray-100"})]})}function $7e({label:e,name:t,value:n,onChange:s,options:r,required:i=!1,disabled:o=!1,className:l=""}){const c=n!=null?String(n):"",d=r.some(h=>String(h.value)===c)?c:"";return a.jsxs("div",{className:l,children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsx("select",{name:t,value:d,onChange:s,required:i,disabled:o,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100",children:r.map(h=>a.jsx("option",{value:String(h.value??""),children:h.label},h.value??h.label))})]})}function k8({label:e,items:t=[],value:n="",onChange:s,getLabel:r,placeholder:i="Search...",disabled:o=!1,className:l="",required:c=!1,isSubmitted:u=!1}){const d=u&&c&&!n;return a.jsxs("div",{className:l,children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",c&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx(R7e,{items:t,value:n??"",onChange:s,getLabel:r,placeholder:i,disabled:o,hasError:d})]})}function R7e({items:e=[],value:t="",onChange:n,getLabel:s,placeholder:r="Search...",disabled:i=!1,maxRender:o=200,hasError:l=!1}){const[c,u]=f.useState(!1),[d,h]=f.useState(""),p=f.useRef(null),x=e.find(y=>String(y.id)===String(t)),v=x?s(x):"",j=f.useMemo(()=>{const y=d.trim().toLowerCase();return(y?e.filter(w=>(s(w)||"").toLowerCase().includes(y)):e).slice(0,o)},[e,d,s,o]);return f.useEffect(()=>{const y=N=>{p.current&&!p.current.contains(N.target)&&u(!1)};return document.addEventListener("mousedown",y),()=>document.removeEventListener("mousedown",y)},[]),f.useEffect(()=>{c||h("")},[c]),a.jsxs("div",{ref:p,className:"relative w-full",children:[a.jsx("input",{disabled:i,value:c?d:v,placeholder:r,onFocus:()=>!i&&u(!0),onChange:y=>{h(y.target.value),c||u(!0)},className:`w-full border rounded-md px-2 py-1.5 text-sm outline-none focus:ring-2
          ${l?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}`}),c&&!i&&a.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg overflow-hidden",children:[a.jsx("div",{className:"max-h-56 overflow-y-auto hide-scrollbar",children:j.length>0?j.map(y=>{const N=String(y.id),w=s(y),S=String(t)===N;return a.jsx("button",{type:"button",onClick:()=>{n(N),u(!1)},className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-50 ${S?"bg-blue-50":""}`,children:w||"--"},N)}):a.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No results"})}),e.length>o&&a.jsxs("div",{className:"px-3 py-2 text-[11px] text-gray-400 border-t",children:["Showing first ",o," results  keep typing to narrow."]})]})]})}function z7e({label:e,name:t,value:n,onChange:s,placeholder:r,rows:i=3,disabled:o=!1,className:l=""}){return a.jsxs("div",{className:l,children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsx("textarea",{name:t,value:n??"",onChange:s,placeholder:r,rows:i,disabled:o,className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100 resize-none"})]})}function F7e({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o=!1,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-orange-500 hover:bg-orange-600 border border-orange-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsx("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${u}`,disabled:o,children:o?"Processing...":s})]})]})})}function U7e(){const{userRole:e}=Ks();return a.jsx(y1,{currentUserRole:e,currentUserId:null})}function B7e(){f.useEffect(()=>{document.title="Audit | Sari-Sari CRM"},[]);const[e,t]=f.useState(null),[n,s]=f.useState(""),[r,i]=f.useState("Filter by Actions"),[o,l]=f.useState(1),[c,u]=f.useState(10),d=async()=>{try{const w=await re.get("/logs/read-all");t(w.data)}catch(w){console.error("Error fetching audit logs:",w)}};f.useEffect(()=>{d()},[]);const h=f.useMemo(()=>{if(!Array.isArray(e))return[];const w=n.trim().toLowerCase(),S=r?.toUpperCase?.()||"ALL";return e.filter(k=>{const T=k.timestamp?new Date(k.timestamp).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}):"",A=`${k.entity_type||""} ${k.entity_name||k.entity_details?.name||k.entity_details?.title||k.entity_id||""}`,E=`${k.logger?.first_name||""} ${k.logger?.last_name||""}`,M=[T,E,k.action,k.entity_type,A,k.description],z=w===""||M.some(D=>D==null?!1:D.toString().toLowerCase().includes(w)),P=S==="FILTER BY ACTIONS"||(k.action||"").toUpperCase()===S;return z&&P}).sort((k,T)=>{const A=k.timestamp?new Date(k.timestamp).getTime():0;return(T.timestamp?new Date(T.timestamp).getTime():0)-A})},[e,n,r]),p=Math.max(1,Math.ceil(h.length/c)||1);f.useEffect(()=>{l(1)},[n,r]),f.useEffect(()=>{l(w=>{const S=Math.max(1,Math.ceil(h.length/c)||1);return w>S?S:w})},[h.length]);const x=f.useMemo(()=>{const w=(o-1)*c;return h.slice(w,w+c)},[h,o]);h.length===0||(o-1)*c+1,Math.min(o*c,h.length);const v=()=>l(w=>Math.max(w-1,1)),j=()=>l(w=>Math.min(w+1,p)),y=()=>{if(!h.length){Kx.error("No logs to export!");return}const w=["Timestamp","User","Action","Resource","Details"],S=h.map(E=>[new Date(E.timestamp).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}),`${E.logger?.first_name||""} ${E.logger?.last_name||""}`.trim(),E.action,`${E.entity_type}: ${E.entity_id}`,E.description||""]),_=[w.join(","),...S.map(E=>E.map(M=>`"${String(M).replace(/"/g,'""')}"`).join(","))].join(`
`),k=new Blob([_],{type:"text/csv;charset=utf-8;"}),T=URL.createObjectURL(k),A=document.createElement("a");A.href=T,A.download=`AuditLogs_${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(A),A.click(),document.body.removeChild(A),URL.revokeObjectURL(T)},N=w=>{switch((w||"").toUpperCase()){case"CREATE":return"bg-green-100 text-green-700";case"UPDATE":case"EDIT":return"bg-blue-100 text-blue-700";case"DELETE":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-700"}};return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[e===null&&a.jsx(Wt,{message:"Loading audit logs..."}),a.jsx(Qx,{toastOptions:{duration:1e3}}),a.jsxs("div",{className:"bg-blue-50 border-l-4 border-blue-400 p-4 mb-6 rounded-r-md flex items-center",children:[a.jsx(Ot,{className:"text-blue-600 mr-3 flex-shrink-0",size:20}),a.jsxs("p",{className:"text-sm text-blue-700",children:[a.jsx("span",{className:"font-semibold",children:"Data Retention Policy:"})," Audit logs are automatically purged after 6 months to optimize system performance."]})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-5 space-y-3 sm:space-y-0",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(ks,{className:"text-blue-600",size:20}),a.jsx("h2",{className:"text-2xl sm:text-xl font-semibold text-gray-700",children:"Audit Logs"})]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 rounded-md hover:bg-gray-800 text-sm sm:text-base self-end sm:self-auto cursor-pointer",onClick:y,children:[a.jsx(Vo,{className:"mr-2"}),"Export Logs"]})})]}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition bg-white",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search audit logs",value:n,onChange:w=>s(w.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsx("div",{className:"w-full lg:w-1/4",children:a.jsxs("select",{value:r,onChange:w=>i(w.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{value:"Filter by Actions",children:"Filter by Actions"}),a.jsx("option",{value:"CREATE",children:"CREATE"}),a.jsx("option",{value:"DELETE",children:"DELETE"}),a.jsx("option",{value:"UPDATE",children:"UPDATE"})]})})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[600px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 text-sm tracking-wide font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4",children:"Timestamp"}),a.jsx("th",{className:"py-3 px-4",children:"User"}),a.jsx("th",{className:"py-3 px-4",children:"Action"}),a.jsx("th",{className:"py-3 px-4",children:"Resource"}),a.jsx("th",{className:"py-3 px-4",children:"Details"})]})}),a.jsx("tbody",{children:Array.isArray(h)&&h.length>0?x.map((w,S)=>a.jsxs("tr",{className:"hover:bg-gray-50 text-sm",children:[a.jsx("td",{className:"py-3 px-4 text-gray-700 whitespace-nowrap",children:new Date(w.timestamp).toLocaleString("en-US",{month:"numeric",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}).replace(",","")}),a.jsx("td",{className:"py-3 px-4 text-gray-700",children:w.name}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium whitespace-nowrap ${N(w.action)}`,children:w.action})}),a.jsxs("td",{className:"py-3 px-4 text-gray-700",children:[w.entity_type,": ",w.entity_id]}),a.jsx("td",{className:"py-3 px-4 text-gray-700",children:w.description})]},S)):a.jsx("tr",{children:a.jsx("td",{className:"py-3 px-4 text-sm text-gray-500 text-center",colSpan:5,children:"No activities to show."})})})]})}),a.jsx(ca,{className:"mt-4",totalItems:h.length,pageSize:c,currentPage:o,onPrev:v,onNext:j,onPageSizeChange:w=>{u(w),l(1)},pageSizeOptions:[10,20,30,40,50],label:"logs"})]})}const H7e=[{value:"PLANNED",label:"PLANNED"},{value:"HELD",label:"HELD"},{value:"NOT_HELD",label:"NOT HELD"}],q7e=e=>e?String(e).toUpperCase():"",gf=e=>{const t=q7e(e);return t==="PLANNED"||t==="PENDING"?"PLANNED":t==="HELD"||t==="COMPLETED"?"HELD":t==="NOT HELD"||t==="NOT_HELD"||t==="CANCELLED"?"NOT_HELD":"PLANNED"},lT=e=>{const t=gf(e);return t==="PLANNED"?"PLANNED":t==="HELD"?"HELD":t==="NOT_HELD"?"NOT HELD":"--"},E8=e=>{switch(gf(e)){case"PLANNED":return"bg-indigo-100 text-indigo-700";case"HELD":return"bg-green-100 text-green-700";case"NOT_HELD":return"bg-gray-200 text-gray-700";default:return"bg-gray-100 text-gray-700"}},L8=e=>e?new Date(e).toLocaleString("en-US",{month:"2-digit",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}):"--";function G7e(){const[e,t]=f.useState(!1),[n,s]=f.useState(null),[r,i]=f.useState(null),[o,l]=f.useState(null),[c,u]=f.useState(null),[d,h]=f.useState([]),[p,x]=f.useState(null),[v,j]=f.useState(!1),[y,N]=f.useState(null),[w,S]=f.useState(!1),[_,k]=f.useState(!1),[T,A]=f.useState("PLANNED"),[E,M]=f.useState(!1),[z,P]=f.useState(!1),[D,U]=f.useState(null),[B,R]=f.useState(new Set),[q,Z]=f.useState(!1),{user:V}=Vt(),{comments:oe,addComment:je,refresh:X}=kn({relatedType:"call",relatedId:n?.id});f.useEffect(()=>{n?.id&&X()},[n?.id,X]),Bs();const se=kt(),ye=ta(),Ne=xe=>{if(!xe)return"";const ve=String(xe).split("-");return ve.length===3?`${ve[0]}-${ve[2]}`:String(xe)},we={subject:"",call_time:(()=>{const xe=new Date,ve=xe.getFullYear(),Oe=String(xe.getMonth()+1).padStart(2,"0"),Ce=String(xe.getDate()).padStart(2,"0");return`${ve}-${Oe}-${Ce}T08:00`})(),duration_minutes:"",direction:"Outgoing",status:"Planned",notes:"",relatedType1:"Lead",relatedType2:null,relatedTo1:null,relatedTo2:null,assigned_to:null},[de,ke]=f.useState(we);f.useEffect(()=>{const xe=ye.state,ve=xe?.callID;if(ve&&!xe?.openCallModal){U(ve),se(ye.pathname,{replace:!0,state:{}});return}!xe?.openCallModal||!xe?.initialCallData||xe.initialCallData.relatedType1==="Lead"&&Array.isArray(o)&&o.length===0||xe.initialCallData.relatedType1==="Account"&&(!Array.isArray(o)||o.length===0)||(t(!0),ke(Oe=>({...Oe,...xe.initialCallData,relatedTo1:xe.initialCallData.relatedTo1?String(xe.initialCallData.relatedTo1):"",relatedTo2:xe.initialCallData.relatedTo2?String(xe.initialCallData.relatedTo2):""})),se(ye.pathname,{replace:!0,state:{}}))},[ye.state,o]),f.useEffect(()=>{if(D&&d.length>0&&!z){const xe=d.find(ve=>ve.id===D);xe?s(xe):H.error("Call not found."),U(null)}},[D,d,z]);const ge=async()=>{try{P(!0);const xe=await re.get("/calls/admin/fetch-all"),Oe=[...Array.isArray(xe.data)?xe.data:[]].sort((Ce,Qe)=>{const G=Ce?.created_at?new Date(Ce.created_at):0;return(Qe?.created_at?new Date(Qe.created_at):0)-G});h(Oe)}catch(xe){console.error("Error fetching calls:",xe),H.error("Failed to load calls")}finally{P(!1)}},$e=async()=>{try{const xe=await re.get("/users/all");x(xe.data)}catch(xe){console.error("Error fetching users: ",xe)}};f.useEffect(()=>{$e(),ge()},[]);const be=[],me="",Ue="Filter by Status",Ee="Filter by Users",[We,tt]=f.useState(1),[lt,Fe]=f.useState(10),Xe=["GROUP MANAGER","MANAGER","SALES"].includes(V?.role?.toUpperCase())?d.filter(xe=>xe.status!=="INACTIVE"):d,Ze=Xe,Je=Xe.length,Be=Xe.filter(xe=>gf(xe.status)==="PLANNED").length,_e=Xe.filter(xe=>gf(xe.status)==="HELD").length,pe=Xe.filter(xe=>gf(xe.status)==="NOT_HELD").length,ce=[{title:"Total",value:Je,icon:Fs,color:"text-slate-600",bgColor:"bg-slate-100"},{title:"Planned",value:Be,icon:zs,color:"text-indigo-600",bgColor:"bg-indigo-100"},{title:"Held",value:_e,icon:Qa,color:"text-green-600",bgColor:"bg-green-100"},{title:"Not Held",value:pe,icon:Us,color:"text-gray-600",bgColor:"bg-gray-100"}],[Q,ne]=f.useState("Overview"),ae=xe=>{const{name:ve,value:Oe}=xe.target;ke(Ce=>{const Qe={...Ce,[ve]:Oe};return ve==="relatedType1"&&(Qe.relatedTo1="",Oe==="Lead"?(Qe.relatedType2=null,Qe.relatedTo2=null,u([])):Oe==="Account"&&(Qe.relatedType2="Contact")),ve==="relatedType2"&&(Qe.relatedTo2=""),Qe})};f.useEffect(()=>{const xe=async()=>{try{l([]);let ve;de.relatedType1==="Lead"?ve=await re.get("/leads/admin/getLeads"):de.relatedType1==="Account"&&(ve=await re.get("/accounts/admin/fetch-all"));let Oe=[];if(ve&&Array.isArray(ve.data)?Oe=ve.data:Oe=[],v&&de.relatedTo1)try{let Ce;de.relatedType1==="Lead"?Ce=await re.get(`/leads/get/${de.relatedTo1}`):de.relatedType1==="Account"&&(Ce=await re.get(`/accounts/get/${de.relatedTo1}`)),Ce&&Ce.data&&(Oe.some(G=>String(G.id)===String(de.relatedTo1))||(Oe=[Ce.data,...Oe]))}catch(Ce){console.error("Error fetching specific related item:",Ce)}l(Oe)}catch(ve){console.error("Error fetching data:",ve),l([])}};de.relatedType1&&xe()},[de.relatedType1,v,de.relatedTo1]),f.useEffect(()=>{const xe=async()=>{try{u([]);let ve;if(de.relatedType1==="Account"&&de.relatedTo1)de.relatedType2==="Contact"?ve=await re.get(`/contacts/from-acc/${de.relatedTo1}`):de.relatedType2==="Deal"?ve=await re.get(`/deals/from-acc/${de.relatedTo1}`):de.relatedType2==="Quote"&&(ve=await re.get(`/quotes/from-acc/${de.relatedTo1}`));else{u([]);return}ve&&Array.isArray(ve.data)?u(ve.data):u([])}catch(ve){console.error("Error fetching data:",ve),u([])}};de.relatedType2&&xe()},[de.relatedType2,de.relatedTo1,de.relatedType1]);const[Pe,Te]=f.useState(!1),he=xe=>{xe.preventDefault(),Te(!0);const ve=de.subject;if(!ve||ve.trim()===""){H.error("Subject is required.");return}if(!de.relatedTo1){H.error(`Please select a ${de.relatedType1||"Lead/Account"}.`);return}if(!de.assigned_to){H.error("Subject is required.");return}const Ce={...de,duration_minutes:de.duration_minutes?parseInt(de.duration_minutes,10):null,relatedTo1:de.relatedTo1?parseInt(de.relatedTo1,10):null,relatedTo2:de.relatedType1==="Lead"?null:de.relatedTo2?parseInt(de.relatedTo2,10):null,relatedType2:de.relatedType1==="Lead"?null:de.relatedType2,assigned_to:de.assigned_to?parseInt(de.assigned_to,10):null},Qe=v&&y?"update":"create",G=(de.subject||"").trim()||"Untitled Call";i({title:Qe==="create"?"Confirm New Call":"Confirm Update",message:Qe==="create"?`Create "${G}"?`:`Save changes to "${G}"?`,confirmLabel:Qe==="create"?"Create Call":"Update Call",cancelLabel:"Cancel",variant:"primary",action:{type:Qe,payload:Ce,targetId:y||null,name:G}})},He=xe=>s(xe),qe=()=>{t(!1),j(!1),N(null)},nt=async()=>{if(!r?.action){i(null);return}const{action:xe}=r,{type:ve,payload:Oe,targetId:Ce,name:Qe}=xe;k(!0);try{if(ve==="create")S(!0),await re.post("/calls/create",Oe),H.success(`Call "${Qe}" created successfully.`),t(!1),ke(we),j(!1),N(null),await ge();else if(ve==="update"){if(!Ce)throw new Error("Missing call identifier for update.");S(!0),await re.put(`/calls/${Ce}`,Oe),H.success(`Call "${Qe}" updated successfully.`),t(!1),ke(we),j(!1),N(null),await ge()}else if(ve==="delete"){if(!Ce)throw new Error("Missing call identifier for archiving.");await re.put(`/calls/${Ce}`,{status:"INACTIVE"}),H.success(`Call "${Qe}" archived successfully.`),n?.id===Ce&&s(null),await ge()}else if(ve==="bulk-delete"){const{targetIds:G,count:W}=xe;if(!G||G.length===0)throw new Error("Missing call identifiers for bulk archiving.");Z(!0),await re.put("/calls/bulk-archive",{call_ids:G}),H.success(`${W} call${W!==1?"s":""} archived successfully.`),R(new Set),await ge(),n&&B.has(n.id)&&s(null)}}catch(G){const W=ve==="create"?"Failed to create call. Please review the details and try again.":ve==="update"?"Failed to update call. Please review the details and try again.":ve==="bulk-delete"?"Failed to archive calls. Please try again.":"Failed to archive call. Please try again.",J=G?.response?.data?.detail||W;H.error(J)}finally{(ve==="create"||ve==="update")&&S(!1),ve==="bulk-delete"&&Z(!1),k(!1),i(null)}},ot=()=>{_||i(null)},Re=async()=>{if(n?.id)try{M(!0),await re.put(`/calls/${n.id}`,{status:T}),H.success(`Status updated to ${lT(T)}`),h(xe=>Array.isArray(xe)?xe.map(ve=>ve.id===n.id?{...ve,status:T}:ve):xe),s(null)}catch(xe){const ve=xe.response?.data?.detail||"Failed to update status.";H.error(ve)}finally{M(!1)}},it=xe=>{const ve=Ze.find(Oe=>Oe.id===xe);ve&&ve.call_creator?.id===V?.id&&R(Oe=>{const Ce=new Set(Oe);return Ce.has(xe)?Ce.delete(xe):Ce.add(xe),Ce})},St=()=>{const xe=Ze.filter(ve=>ve.call_creator?.id===V?.id);B.size===xe.length&&xe.length>0?R(new Set):R(new Set(xe.map(ve=>ve.id)))},Et=()=>{if(B.size===0)return;const xe=B.size;i({title:"Archive Calls",message:a.jsxs("span",{children:["Are you sure you want to archive"," ",a.jsx("span",{className:"font-semibold",children:xe})," call",xe!==1?"s":"","? You can restore them later if needed."]}),confirmLabel:`Archive ${xe} Call${xe!==1?"s":""}`,cancelLabel:"Cancel",variant:"archive",action:{type:"bulk-delete",targetIds:Array.from(B),count:xe}})};f.useEffect(()=>{n&&A(gf(n.status))},[n]);const Tt=n?a.jsxs("div",{id:"callModalBackdrop",onClick:xe=>xe.target.id==="callModalBackdrop"&&s(null),className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center p-4",children:[z&&a.jsx(Wt,{message:"Loading call details..."}),a.jsxs("div",{className:"bg-white rounded-xl shadow-lg w-full max-w-full lg:max-w-4xl max-h-[95vh] overflow-y-auto hide-scrollbar relative box-border",children:[a.jsxs("div",{className:"bg-tertiary w-full rounded-t-xl p-3 lg:p-3 relative",children:[a.jsx("h1",{className:"lg:text-3xl text-xl text-white font-semibold text-center w-full",children:"Calls"}),a.jsx("button",{onClick:()=>s(null),className:"text-gray-500 hover:text-white transition cursor-pointer absolute top-3 right-3",children:a.jsx(Ja,{size:25})})]}),a.jsx("div",{className:"mt-4 gap-2 px-2 lg:gap-4 lg:mx-7",children:a.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between lg:flex-row lg:items-center lg:justify-between mt-3 gap-2 px-2 md:items-center lg:gap-4 md:mx-7 lg:mx-7",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[a.jsx("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-800",children:n.subject}),a.jsx("span",{className:`text-xs sm:text-sm font-medium px-2 sm:px-3 py-1 rounded-full ${E8(n.status)}`,children:lT(n.status)})]}),a.jsx("div",{className:"flex flex-col sm:flex-row sm:space-x-3 space-y-2 sm:space-y-0",children:V?.id===n?.call_creator?.id&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{className:"inline-flex items-center justify-center w-full sm:w-auto bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 transition text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",onClick:()=>{const xe=G=>{if(!G)return"";const W=new Date(G),J=W.getFullYear(),Y=String(W.getMonth()+1).padStart(2,"0"),F=String(W.getDate()).padStart(2,"0"),ue=String(W.getHours()).padStart(2,"0"),De=String(W.getMinutes()).padStart(2,"0");return`${J}-${Y}-${F}T${ue}:${De}`},ve=n.lead?"Lead":n.account?"Account":"Lead",Oe=n.lead?n.lead.id:n.account?n.account.id:null,Ce=ve==="Lead"?null:n.contact?"Contact":n.deal?"Deal":n.quote?"Quote":"Contact",Qe=ve==="Lead"?null:n.contact?n.contact.id:n.deal?n.deal.id:n.quote?n.quote.id:null;ke({subject:n.subject||"",call_time:xe(n.call_time),duration_minutes:n.duration_minutes?String(n.duration_minutes):"",direction:n.direction||"Outgoing",status:n.status||"Planned",notes:n.notes||"",relatedType1:ve,relatedType2:Ce,relatedTo1:Oe?String(Oe):"",relatedTo2:Qe?String(Qe):"",assigned_to:n.call_assign_to?.id?String(n.call_assign_to.id):""}),j(!0),N(n.id),s(null),t(!0)},children:[a.jsx(gn,{className:"mr-2"}),"Edit"]}),a.jsxs("button",{className:"inline-flex items-center justify-center w-full sm:w-auto px-4 py-2 rounded-md text-sm bg-orange-500 text-white hover:bg-orange-600 transition focus:outline-none focus:ring-2 focus:ring-orange-400",onClick:()=>{const xe=n.subject||"this call";i({title:"Archive Call",message:`Are you sure you want to archive "${xe}"? You can restore it later if needed.`,confirmLabel:"Archive Call",cancelLabel:"Cancel",variant:"archive",action:{type:"delete",targetId:n.id,name:xe}})},children:[a.jsx(Zt,{className:"mr-2"}),"Archive"]})]})})]})}),a.jsx("div",{className:"border-b border-gray-200 my-5"}),a.jsxs("div",{className:"p-6 lg:p-4",children:[a.jsx("div",{className:"flex w-full bg-[#6A727D] text-white mt-1 overflow-x-auto mb-6",children:["Overview","Notes"].map(xe=>a.jsx("button",{onClick:()=>ne(xe),className:`flex-1 min-w-[90px] px-4 py-2.5 text-xs sm:text-sm font-medium border-b-2 ${Q===xe?"bg-paper-white text-[#6A727D] border-white":"text-white hover:bg-[#5c636d]"}`,children:xe},xe))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 items-start",children:[a.jsxs("div",{className:"lg:col-span-3",children:[Q==="Overview"&&a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 md:p-8 border border-gray-200",children:a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4 sm:gap-6 text-sm text-gray-700",children:[a.jsx(yo,{label:"Call Time",value:L8(n.call_time)}),a.jsx(yo,{label:"Duration",value:n.duration_minutes?`${n.duration_minutes} min`:null}),a.jsx(yo,{label:"Direction",value:n.direction||"--"}),a.jsx(yo,{label:"Assigned To",value:`${n.call_assign_to.first_name} ${n.call_assign_to.last_name}`}),n.lead&&a.jsx(yo,{label:"Lead",value:n.lead.title}),n.account&&a.jsx(yo,{label:"Account",value:n.account.name}),n.contact&&a.jsx(yo,{label:"Contact",value:`${n.contact.first_name} ${n.contact.last_name}`}),n.deal&&a.jsx(yo,{label:"Deal",value:n.deal.name}),n.quote&&a.jsx(yo,{label:"Quote",value:Ne(n.quote.quote_id)}),a.jsx(yo,{label:"Created At",value:L8(n.created_at)})]})}),Q==="Notes"&&a.jsxs("div",{className:"mt-4 w-full",children:[a.jsx("div",{className:"flex flex-wrap items-center justify-between mb-4 gap-2",children:a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words",children:"Call Note"})}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 shadow-sm break-words",children:[a.jsx("div",{className:"flex items-start justify-between",children:a.jsx("div",{children:a.jsx("p",{className:"text-sm font-medium text-gray-800 break-words",children:"Note"})})}),a.jsx("div",{className:"mt-3 text-sm text-gray-700 whitespace-pre-wrap break-words",children:n.notes||"No notes available."})]}),a.jsx(Tn,{comments:oe,onAddComment:je})]})]}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm w-full",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Status"}),a.jsxs("select",{className:"border border-gray-200 rounded-md px-2 py-1.5 w-full text-sm mb-2",value:T,onChange:xe=>A(xe.target.value),children:[a.jsx("option",{value:"PLANNED",children:"PLANNED"}),a.jsx("option",{value:"HELD",children:"HELD"}),a.jsx("option",{value:"NOT_HELD",children:"NOT HELD"})]}),a.jsx("button",{onClick:Re,disabled:E,className:"w-full py-1.5 rounded-md text-sm bg-gray-900 text-white hover:bg-gray-800 disabled:opacity-50",children:E?"Updating...":"Update"})]})]})]})]})]}):null,Nt=e?a.jsx("div",{id:"modalBackdrop",onClick:xe=>xe.target.id==="modalBackdrop"&&qe(),className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-xl rounded-2xl shadow-lg p-4 sm:p-6 md:p-8 relative border border-gray-200 overflow-y-auto max-h-[90vh] hide-scrollbar",children:[a.jsx("button",{onClick:()=>{qe(),Te(!1)},className:"absolute top-4 right-4 text-gray-500 hover:text-black transition",children:a.jsx(ea,{size:22})}),a.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800 mb-4 sm:mb-6 flex items-center justify-center",children:v?"Edit Call":"Add New Call"}),a.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 w-full gap-4 text-sm",onSubmit:he,noValidate:!0,children:[a.jsx(V7e,{label:"Subject",className:"md:col-span-2",name:"subject",value:de.subject,onChange:ae,isSubmitted:Pe,required:!0}),a.jsxs("div",{className:"w-full flex flex-col",children:[a.jsxs("div",{className:"relative w-25",children:[a.jsxs("select",{name:"relatedType1",onChange:ae,value:de.relatedType1,className:"outline-none cursor-pointer mb-1 w-22 text-gray-700 disabled:text-gray-400 disabled:cursor-not-allowed",disabled:w,children:[a.jsx("option",{value:"Lead",children:"Lead"}),a.jsx("option",{value:"Account",children:"Account"})]}),a.jsx("span",{className:"absolute left-10 md:pl-6 pl-6 top-1/2 -translate-y-1/2 text-red-500 pointer-events-none",children:"*"})]}),a.jsx(cT,{items:Array.isArray(o)?o:[],value:de.relatedTo1??"",placeholder:`Search ${de.relatedType1||"here"}...`,getLabel:xe=>de.relatedType1==="Lead"?xe.title:xe.name??"",onChange:xe=>ke(ve=>({...ve,relatedTo1:xe})),required:!0,isSubmitted:Pe,disabled:w})]}),a.jsxs("div",{className:"w-full flex flex-col",children:[a.jsxs("select",{name:"relatedType2",onChange:ae,value:de.relatedType2??"Contact",className:"text-gray-700 outline-none cursor-pointer mb-1 w-22 disabled:text-gray-400 disabled:cursor-not-allowed",disabled:de.relatedType1==="Lead"||w,children:[a.jsx("option",{value:"Contact",children:"Contact"}),a.jsx("option",{value:"Deal",children:"Deal"}),a.jsx("option",{value:"Quote",children:"Quote"})]}),a.jsx(cT,{disabled:de.relatedType1==="Lead"||w,items:Array.isArray(c)?c:[],value:de.relatedTo2??"",placeholder:de.relatedType1==="Lead"?"":Array.isArray(c)&&c.length>0?`Search ${de.relatedType2||"Contact"}...`:`No ${de.relatedType2||""} data found`,getLabel:xe=>de.relatedType2==="Contact"?`${xe.first_name??""} ${xe.last_name??""}`.trim():de.relatedType2==="Quote"?Ne(xe.quote_id)??"":xe.name??"",onChange:xe=>ke(ve=>({...ve,relatedTo2:xe}))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Call Time"}),a.jsx("input",{type:"datetime-local",value:de.call_time,onChange:ae,name:"call_time",className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100"})]}),a.jsxs("div",{className:"w-full",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Duration"}),a.jsxs("div",{className:"w-full rounded-md text-sm flex flex-row items-center justify-start",children:[a.jsx("input",{type:"tel",value:de.duration_minutes,onChange:ae,name:"duration_minutes",className:"border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100 w-44 mr-3"}),a.jsx("p",{children:"minutes"})]})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:["Assign To ",a.jsx("span",{className:"text-red-500 font-semibold",children:"*"})]}),a.jsx(cT,{items:Array.isArray(p)?p:[],value:de.assigned_to??"",placeholder:"Search an account...",getLabel:xe=>`${xe.first_name} ${xe.last_name}`,onChange:xe=>ke(ve=>({...ve,assigned_to:xe})),required:!0,isSubmitted:Pe})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Direction"}),a.jsxs("select",{name:"direction",onChange:ae,value:de.direction,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100",children:[a.jsx("option",{value:"Incoming",children:"Incoming"}),a.jsx("option",{value:"Outgoing",children:"Outgoing"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Status"}),a.jsxs("select",{name:"status",onChange:ae,value:de.status,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100",children:[a.jsx("option",{value:"Planned",children:"Planned"}),a.jsx("option",{value:"Held",children:"Held"}),a.jsx("option",{value:"Not held",children:"Not held"})]})]}),a.jsx(Y7e,{className:"col-span-2",label:"Notes",value:de.notes,onChange:ae,name:"notes"}),a.jsxs("div",{className:"flex flex-col md:flex-row justify-end col-span-2 mt-4 gap-2 w-full",children:[a.jsx("button",{type:"button",onClick:()=>{qe(),Te(!1)},className:"w-full sm:w-auto px-4 py-2 text-white bg-red-400 border border-red-300 rounded hover:bg-red-500 transition",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:w,className:"w-full sm:w-auto px-4 py-2 text-white bg-tertiary border border-tertiary rounded hover:bg-secondary transition",children:w?"Saving...":v?"Update Call":"Save Call"})]})]})]})}):null;return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h1",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(Fs,{className:"mr-2 text-blue-600"})," Calls"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{onClick:()=>{ke(we),j(!1),N(null),t(!0),Te(!1)},className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 my-1 lg:my-0 rounded-md hover:bg-gray-800 text-sm sm:text-base mx-auto sm:ml-auto cursor-pointer",children:[a.jsx(aa,{className:"mr-2"})," Add Call"]})})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-4 mb-6 w-full break-words overflow-hidden lg:overflow-visible",children:ce.map(xe=>a.jsx(W7e,{...xe},xe.title))}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center gap-3",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search calls",className:"focus:outline-none text-base w-full",defaultValue:me})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row w-full lg:w-1/2 gap-2",children:[a.jsxs("select",{defaultValue:Ue,className:"border border-gray-300 rounded-lg px-3 h-11 text-sm bg-white w-full",children:[a.jsx("option",{value:"Filter by Status",children:"Filter by Status"}),H7e.map(xe=>a.jsx("option",{value:xe.value,children:xe.label},xe.value))]}),a.jsxs("select",{defaultValue:Ee,className:"border border-gray-300 rounded-lg px-3 h-11 text-sm bg-white w-full",children:[a.jsx("option",{value:"Filter by Users",children:"Filter by Users"}),be.map(xe=>a.jsx("option",{value:xe.name,children:xe.name},xe.id))]})]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[500px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm mb-4",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 w-12",children:a.jsx("input",{type:"checkbox",checked:B.size>0&&B.size===Ze.filter(xe=>xe.call_creator?.id===V?.id).length&&Ze.filter(xe=>xe.call_creator?.id===V?.id).length>0,onChange:St,className:"w-4 h-4 cursor-pointer"})}),a.jsx("th",{className:"py-3 px-4",children:"Subject"}),a.jsx("th",{className:"py-3 px-4",children:"Related To"}),a.jsx("th",{className:"py-3 px-4",children:"Call Time"}),a.jsx("th",{className:"py-3 px-4",children:"Assigned To"}),a.jsx("th",{className:"py-3 px-4",children:"Status"}),a.jsx("th",{className:"py-3 px-4 w-12",children:B.size>0&&a.jsx("button",{onClick:Et,className:"text-orange-500 hover:text-orange-700 transition",title:"Archive selected calls",disabled:q,children:a.jsx(Zt,{size:18})})})]})}),a.jsx("tbody",{children:z?a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"py-10",children:a.jsx(Wt,{message:"Loading calls..."})})}):Ze.length>0?Ze.map(xe=>a.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer border-b border-gray-100",children:[a.jsx("td",{className:"py-3 px-4",children:V?.id===xe.call_creator?.id&&a.jsx("input",{type:"checkbox",checked:B.has(xe.id),onChange:ve=>{ve.stopPropagation(),it(xe.id)},className:"w-4 h-4 cursor-pointer"})}),a.jsx("td",{className:"py-3 px-4 text-blue-600 font-medium",onClick:()=>He(xe),children:xe.subject||"--"}),a.jsxs("td",{className:"py-3 px-4",onClick:()=>He(xe),children:[xe.lead&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:xe.lead.title}),xe.account&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:xe.account.name}),xe.contact&&a.jsxs("p",{className:"font-medium text-blue-500 text-xs",children:[xe.contact.first_name," ",xe.contact.last_name]}),xe.deal&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:xe.deal.name}),xe.quote&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:Ne(xe.quote.quote_id)})]}),a.jsx("td",{className:"py-3 px-4 text-gray-800",onClick:()=>He(xe),children:xe.call_time?new Date(xe.call_time).toLocaleString():"--"}),a.jsx("td",{className:"py-3 px-4 text-gray-800",onClick:()=>He(xe),children:xe?.call_assign_to?`${xe.call_assign_to.first_name} ${xe.call_assign_to.last_name}`:"--"}),a.jsx("td",{className:"py-3 px-4",onClick:()=>He(xe),children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${E8(xe.status)}`,children:lT(xe.status)})}),a.jsx("td",{className:"py-3 px-4"})]},xe.id)):a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"text-center py-4 text-gray-500",children:"No calls found."})})})]})}),a.jsx(ca,{totalItems:Xe.length,pageSize:lt,currentPage:We,onPrev:()=>tt(xe=>Math.max(1,xe-1)),onNext:()=>tt(xe=>xe+1),onPageSizeChange:xe=>{Fe(xe),tt(1)},pageSizeOptions:[10,20,30,40,50],label:"calls"})]}),Tt,Nt,r&&a.jsx(Q7e,{open:!0,title:r.title,message:r.message,confirmLabel:r.confirmLabel,cancelLabel:r.cancelLabel,variant:r.variant,onConfirm:nt,onCancel:ot,loading:_})]})}function W7e({icon:e,title:t,value:n,color:s,bgColor:r}){return a.jsxs("div",{className:"flex items-center p-4 bg-white rounded-xl shadow-md border border-gray-200 transition-all duration-300",children:[a.jsx("div",{className:`p-3 rounded-full ${r} ${s} mr-4`,children:a.jsx(e,{size:22})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:t}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:n})]})]})}function V7e({label:e,name:t,value:n,onChange:s,placeholder:r="",type:i="text",required:o=!1,disabled:l=!1,isSubmitted:c=!1,className:u=""}){const d=c&&o&&!n;return a.jsxs("div",{className:u,children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",o&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:i,name:t,value:n??"",onChange:s,placeholder:r,disabled:l,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border focus:ring-2 disabled:bg-gray-100
          ${d?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}
        `})]})}function Y7e(e){return a.jsxs("div",{className:e.className,children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e.label}),a.jsx("textarea",{...e,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100 resize-none"})]})}function yo({label:e,value:t}){return a.jsxs("p",{children:[a.jsxs("span",{className:"font-semibold",children:[e,":"]})," ",a.jsx("br",{}),a.jsx("span",{className:"break-words",children:t||"--"})]})}function Q7e({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o=!1,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":i==="archive"?"bg-orange-500 hover:bg-orange-600 border border-orange-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsx("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${u}`,disabled:o,children:o?"Processing...":s})]})]})})}function cT({items:e=[],value:t="",onChange:n,getLabel:s,placeholder:r="Search...",disabled:i=!1,maxRender:o=200,required:l=!1,isSubmitted:c=!1}){const[u,d]=f.useState(!1),[h,p]=f.useState(""),x=f.useRef(null),v=e.find(w=>String(w.id)===String(t)),j=v?s(v):"",y=l&&c&&!t,N=f.useMemo(()=>{const w=h.trim().toLowerCase();return(w?e.filter(_=>(s(_)||"").toLowerCase().includes(w)):e).slice(0,o)},[e,h,s,o]);return f.useEffect(()=>{const w=S=>{x.current&&!x.current.contains(S.target)&&d(!1)};return document.addEventListener("mousedown",w),()=>document.removeEventListener("mousedown",w)},[]),f.useEffect(()=>{u||p("")},[u]),a.jsxs("div",{ref:x,className:"relative w-full",children:[a.jsx("input",{disabled:i,value:u?h:j,placeholder:r,onFocus:()=>!i&&d(!0),onChange:w=>{p(w.target.value),u||d(!0)},className:`w-full border rounded-md px-2 py-1.5 text-sm outline-none focus:ring-2 disabled:bg-gray-100
          ${y?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}`}),u&&!i&&a.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg overflow-hidden",children:[a.jsx("div",{className:"max-h-56 overflow-y-auto",children:N.length>0?N.map(w=>{const S=String(w.id),_=s(w),k=String(t)===S;return a.jsx("button",{type:"button",onClick:()=>{n(S),d(!1)},className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-50 ${k?"bg-blue-50":""}`,children:_||"--"},S)}):a.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No results"})}),e.length>o&&a.jsxs("div",{className:"px-3 py-2 text-[11px] text-gray-400 border-t",children:["Showing first ",o," results  keep typing to narrow."]})]})]})}const P8=["Not started","In progress","Deferred","Completed"],D8={NOT_STARTED:"Not started","NOT STARTED":"Not started","TO DO":"Not started",IN_PROGRESS:"In progress","IN PROGRESS":"In progress",COMPLETED:"Completed",DEFERRED:"Deferred","Not started":"Not started","In progress":"In progress",Completed:"Completed",Deferred:"Deferred","In Progress":"In progress","To Do":"Not started",Review:"Deferred"},SJ=e=>e&&(D8[e]||D8[String(e).toUpperCase()])||"Not started",K7e=e=>{if(!e)return"";const t=new Date(e);if(Number.isNaN(t.getTime()))return"";const n=t.getTimezoneOffset();return new Date(t.getTime()-n*60*1e3).toISOString().slice(0,16)},dT=e=>{if(!e)return"";const t=new Date(e);return Number.isNaN(t.getTime())?"":t.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},X7e=e=>{const t=e.subject?.trim()??"",n=e.description?.trim()??"",s=e.notes?.trim()??"";e.priority&&String(e.priority).toUpperCase(),SJ(e.status);let r=null,i=null,o=null,l=null,c=null;e.relatedType1==="Lead"&&e.relatedTo1?r=Number(e.relatedTo1):e.relatedType1==="Account"&&e.relatedTo1&&(i=Number(e.relatedTo1)),e.relatedType1==="Account"&&(e.relatedType2==="Contact"&&e.relatedTo2?o=Number(e.relatedTo2):e.relatedType2==="Deal"&&e.relatedTo2?l=Number(e.relatedTo2):e.relatedType2==="Quote"&&e.relatedTo2&&(c=Number(e.relatedTo2)));const u=e.assignedTo?Number(e.assignedTo):null,d=o||l||i||r,h=o?"Contact":l?"Deal":i?"Account":r?"Lead":c?"Quote":null;return{title:t,description:n,priority:e.priority||"Normal",status:e.status||"Not started",due_date:e.dueDate?e.dueDate:null,assigned_to:u,notes:s,is_personal:!1,lead_id:r,account_id:i,contact_id:o,deal_id:l,quote_id:c,related_to_1:e.relatedTo1?Number(e.relatedTo1):null,related_type_1:e.relatedType1,related_to_2:e.relatedTo2?Number(e.relatedTo2):null,related_type_2:e.relatedType2,related_to:d,related_type:h}},Z7e=e=>{const t=e.task_assign_to?`${e.task_assign_to.first_name} ${e.task_assign_to.last_name}`:e.assigned_to?String(e.assigned_to):"Unassigned",n=e.task_creator?`${e.task_creator.first_name} ${e.task_creator.last_name}`:e.created_by?String(e.created_by):"System",s=e.due_date||e.dueDate||null,r=e.date_assigned||e.created_at||null,i=e.contact?`${e.contact.first_name} ${e.contact.last_name}`:e.assigned_to?String(e.assigned_to.id):"Unassigned",o=B=>{if(!B)return"";const R=String(B).split("-");return R.length===3?`${R[0]}-${R[2]}`:String(B)},l=()=>e.lead?.id||e.lead_id,c=()=>e.account?.id||e.account_id,u=()=>e.contact?.id||e.contact_id,d=()=>e.deal?.id||e.deal_id,h=()=>e.quote?.id||e.quote_id,p=()=>e.task_assign_to?.id||e.assigned_to,x=()=>e.lead?.title||e.lead_id,v=()=>e.account?.name||e.account_id,j=()=>i||e.contact_id,y=()=>e.deal?.name||e.deal_id,N=()=>o(e.quote?.quote_id)||e.id;let w="Lead",S="",_="",k="",T="Lead",A="",E="",M="";const z=c(),P=v(),D=l(),U=x();if(z){w="Account",T="Account",A=P,S=String(z);const B=u(),R=d(),q=j(),Z=y(),V=h(),oe=N();B?(_="Contact",E="Contact",M=q,k=String(B)):R?(E="Deal",_="Deal",M=Z,k=String(R)):V&&(E="Quote",_="Quote",M=oe,k=String(V))}else D?(T="Lead",A=U,w="Lead",S=String(D)):e.related_type==="Account"&&(w="Account",S=String(e.related_to));return{id:e.id,title:e.title,description:e.description,priority:e.priority||"Normal",status:SJ(e.status),dueDate:s,dateAssigned:r,assignedToId:p()||null,assignedToName:t,createdAt:e.created_at||null,createdById:e.created_by??null,createdBy:n,notes:e.notes||"",isPersonal:!!e.is_personal,relatedType1Text:T,relatedTo1Text:A,relatedType2Text:E,relatedTo2Text:M,subject:e.title,relatedType1:w,relatedTo1:S,relatedType2:_,relatedTo2:k}};function J7e(){f.useEffect(()=>{document.title="Tasks | Sari-Sari CRM"},[]);const{user:e,loading:t}=Vt(),[n,s]=f.useState("board"),[r,i]=f.useState(!1),[o,l]=f.useState(null),[c,u]=f.useState(!1),[d,h]=f.useState([]),[p,x]=f.useState(!0),[v,j]=f.useState(""),[y,N]=f.useState("Filter by Status"),[w,S]=f.useState("Filter by Priority"),[_,k]=f.useState([]),[T,A]=f.useState(1),[E,M]=f.useState(10),[z,P]=f.useState(null),[D,U]=f.useState(!1),[B,R]=f.useState([]),[q,Z]=f.useState(null),V=kt(),oe=ta(),[je,X]=f.useState({id:"",subject:"",description:"",priority:"",status:"",dueDate:"",assignedTo:"",notes:"",relatedType1:"Lead",relatedType2:"Contact",relatedTo1:"",relatedTo2:""}),[se,ye]=f.useState(null),Ne=Ux(Ff(sm,{activationConstraint:{distance:8}})),fe=Q=>{const{active:ne}=Q,ae=d.find(Pe=>Pe.id===ne.id);Z(ae)},we=async Q=>{const{active:ne,over:ae}=Q;if(Z(null),!ae)return;const Pe=ne.id,Te=ae.id,he=d.find(He=>He.id===Pe);if(!(!he||he.status===Te)){h(He=>He.map(qe=>qe.id===Pe?{...qe,status:Te}:qe));try{const He={title:he.title,description:he.description||"",priority:he.priority||"Normal",status:Te,due_date:he.dueDate||null,assigned_to:he.assignedToId||null,related_type_1:he.relatedType1||null,related_to_1:he.relatedTo1?parseInt(he.relatedTo1,10):null,related_type_2:he.relatedType2||null,related_to_2:he.relatedTo2?parseInt(he.relatedTo2,10):null};(!He.related_to_1||isNaN(He.related_to_1))&&(He.related_to_1=null),(!He.related_to_2||isNaN(He.related_to_2))&&(He.related_to_2=null),await re.put(`/tasks/${Pe}`,He),H.success(`Task moved to "${Te}"`)}catch(He){console.error("Failed to update task status:",He),H.error("Failed to update task status"),h(qe=>qe.map(nt=>nt.id===Pe?{...nt,status:he.status}:nt))}}},de=()=>{Z(null)};f.useEffect(()=>{const Q=oe.state?.openTaskModal,ne=oe.state?.initialTaskData,ae=oe.state?.taskID;Q?(i(!0),ne&&X(Pe=>({...Pe,...ne})),V(oe.pathname,{replace:!0,state:{}})):ae&&(ye(ae),V(oe.pathname,{replace:!0,state:{}}))},[oe,V]),f.useEffect(()=>{if(se&&d.length>0&&!p){const Q=d.find(ne=>ne.id===se);Q?be(Q,!0):H.error("Task not found."),ye(null)}},[se,d,p]);const ke=async()=>{try{const Q=await re.get("/users/all");k(Array.isArray(Q.data)?Q.data:[])}catch(Q){console.error("Failed to fetch users:",Q),H.error("Failed to fetch users.")}},ge=async()=>{try{x(!0);const Q=await re.get("/tasks/all"),ae=(Array.isArray(Q.data)?Q.data:[]).map(Z7e);ae.sort((Pe,Te)=>{const he=Pe.createdAt?new Date(Pe.createdAt):0;return(Te.createdAt?new Date(Te.createdAt):0)-he}),h(ae),n==="list"&&A(1)}catch(Q){console.error("Failed to load tasks:",Q),H.error("Failed to load tasks.")}finally{x(!1)}};f.useEffect(()=>{!t&&e&&(ke(),ge())},[t,e]);const $e=()=>{l(null),X({id:"",subject:"",description:"",priority:"Normal",status:"Not started",dueDate:"",assignedTo:"",notes:"",relatedType1:"Lead",relatedType2:"Contact",relatedTo1:"",relatedTo2:""})},be=(Q=null,ne=!1)=>{l(Q),u(ne),Q?X({id:Q.id,subject:Q.title||"",description:Q.description||"",priority:Q.priority||"Normal",status:Q.status||"Not started",dueDate:K7e(Q.dueDate),assignedTo:Q.assignedToId?String(Q.assignedToId):"",assignedToName:Q.assignedToName||"",createdBy:Q.createdBy||"",notes:Q.notes||"",relatedType1Text:Q.relatedType1Text||"",relatedTo1Text:Q.relatedTo1Text||"",relatedType2Text:Q.relatedType2Text||"",relatedTo2Text:Q.relatedTo2Text||"",relatedType1:Q.relatedType1||"",relatedTo1:Q.relatedTo1||"",relatedType2:Q.relatedType2||"",relatedTo2:Q.relatedTo2||""}):$e(),i(!0)},me=()=>{i(!1),l(null),u(!1),$e()},Ue=async Q=>{const ne=X7e(Q);try{o&&!c?(await re.put(`/tasks/${o.id}`,ne),H.success("Task updated successfully.")):(await re.post("/tasks/create",ne),H.success("Task created successfully.")),i(!1),await ge()}catch(ae){console.error("Failed to save task:",ae);const Pe=ae.response?.data?.detail||"Failed to save task.";H.error(Pe)}},Ee=Q=>{Q&&P({title:"Delete Task",message:a.jsxs(a.Fragment,{children:["Are you sure you want to delete ",a.jsx("span",{className:"font-semibold",children:Q.title}),"?"]}),confirmLabel:"Delete Task",cancelLabel:"Cancel",variant:"danger",action:{type:"delete",targetId:Q.id}})},We=()=>{if(Ze.every(Q=>B.includes(Q.id)))R(B.filter(Q=>!Ze.map(ne=>ne.id).includes(Q)));else{const Q=Ze.map(ne=>ne.id);R([...new Set([...B,...Q])])}},tt=Q=>{R(ne=>ne.includes(Q)?ne.filter(ae=>ae!==Q):[...ne,Q])},lt=async()=>{B.length!==0&&P({title:"Delete Tasks",message:a.jsxs("span",{children:["Are you sure you want to delete"," ",a.jsx("span",{className:"font-semibold",children:B.length})," selected tasks? This action cannot be undone."]}),confirmLabel:`Delete ${B.length} Task(s)`,cancelLabel:"Cancel",variant:"danger",action:{type:"bulk-delete",task_ids:B}})},Fe=async()=>{if(!z?.action){P(null);return}const{action:Q}=z;U(!0);try{Q.type==="delete"?(await re.delete(`/tasks/${Q.targetId}`),H.success("Task deleted successfully."),await ge()):Q.type==="bulk-delete"&&(await re.delete("/tasks/admin/bulk-delete",{data:{task_ids:Q.task_ids}}),H.success(`Successfully deleted ${Q.task_ids.length} tasks`),R([]),await ge())}catch(ne){console.error("Task action failed:",ne),H.error("Failed to delete task.")}finally{U(!1),P(null)}},st=()=>{D||P(null)},Xe=f.useMemo(()=>{const Q=v.trim().toLowerCase();return[...d].sort((ae,Pe)=>{const Te=ae.createdAt?new Date(ae.createdAt):0;return(Pe.createdAt?new Date(Pe.createdAt):0)-Te}).filter(ae=>{const Pe=Q===""||ae.title?.toLowerCase().includes(Q)||ae.description?.toLowerCase().includes(Q)||ae.assignedToName?.toLowerCase().includes(Q)||ae.createdBy?.toLowerCase().includes(Q),Te=y==="Filter by Status"||ae.status===y,he=w==="Filter by Priority"||ae.priority===w;return Pe&&Te&&he})},[d,v,y,w]);f.useEffect(()=>{A(1)},[v,y,w,n,E]),f.useEffect(()=>{if(n==="list"){const Q=Xe.length===0?1:Math.ceil(Xe.length/E);T>Q&&A(Q)}},[Xe.length,T,n,E]);const Ze=f.useMemo(()=>{if(n==="board")return Xe;const Q=(T-1)*E;return Xe.slice(Q,Q+E)},[Xe,T,n,E]),Je=f.useMemo(()=>{const Q=new Date;return[{title:"To Do",value:d.filter(ne=>ne.status==="Not started").length,icon:zs,color:"text-blue-600",bgColor:"bg-blue-100"},{title:"In Progress",value:d.filter(ne=>ne.status==="In progress").length,icon:Yi,color:"text-purple-600",bgColor:"bg-purple-100"},{title:"Completed",value:d.filter(ne=>ne.status==="Completed").length,icon:Qa,color:"text-green-600",bgColor:"bg-green-100"},{title:"Overdue",value:d.filter(ne=>ne.dueDate&&new Date(ne.dueDate)<Q&&ne.status!=="Completed").length,icon:Fl,color:"text-red-600",bgColor:"bg-red-100"},{title:"High Priority",value:d.filter(ne=>ne.priority==="High").length,icon:ec,color:"text-orange-600",bgColor:"bg-orange-100"}]},[d]),Be=Q=>Q.dueDate&&new Date(Q.dueDate)<new Date&&Q.status!=="Completed",_e=Q=>{switch(Q.status){case"Not started":return"bg-blue-50 hover:bg-blue-100 border-blue-200";case"In progress":return"bg-purple-50 hover:bg-purple-100 border-purple-200";case"Deferred":return"bg-orange-50 hover:bg-orange-100 border-orange-200";case"Completed":return"bg-green-50 hover:bg-green-100 border-green-200";default:return"bg-gray-50 hover:bg-gray-100 border-gray-100"}},pe=Q=>{switch(Q){case"Not started":return"bg-blue-100 text-blue-700";case"In progress":return"bg-purple-100 text-purple-700";case"Deferred":return"bg-orange-100 text-orange-700";case"Completed":return"bg-green-100 text-green-700";default:return"bg-gray-100 text-gray-700"}},ce=Q=>{switch(Q){case"High":return"bg-red-100 text-red-700";case"Normal":return"bg-yellow-100 text-yellow-700";default:return"bg-gray-100 text-gray-700"}};return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 min-h-screen font-inter relative",children:[(p||t)&&a.jsx(Wt,{message:"Loading tasks..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 space-y-2 sm:space-y-0",children:[a.jsxs("h1",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[a.jsx(Yi,{className:"text-blue-600"})," Tasks Board"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{type:"button",onClick:()=>be(),className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 rounded-md hover:bg-gray-800 text-sm sm:text-base self-end sm:self-auto mt-2 lg:mt-0 cursor-pointer",children:[a.jsx(aa,{})," Create Task"]})})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 xl:grid-cols-5 gap-4 mb-6 w-full break-words overflow-hidden lg:overflow-visible",children:Je.map(Q=>a.jsx(e8e,{...Q},Q.title))}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mt-6 mb-4 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search tasks",value:v,onChange:Q=>j(Q.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row w-full lg:w-1/2 gap-2",children:[a.jsxs("select",{value:y,onChange:Q=>N(Q.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{children:"Filter by Status"}),P8.map(Q=>a.jsx("option",{children:Q},Q))]}),a.jsxs("select",{value:w,onChange:Q=>S(Q.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{children:"Filter by Priority"}),a.jsx("option",{children:"High"}),a.jsx("option",{children:"Normal"}),a.jsx("option",{children:"Low"})]})]})]}),a.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[a.jsx("button",{type:"button",onClick:()=>s("board"),className:`px-4 py-2 rounded-full text-sm ${n==="board"?"bg-gray-800 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Board View"}),a.jsx("button",{type:"button",onClick:()=>s("list"),className:`px-4 py-2 rounded-full text-sm ${n==="list"?"bg-gray-800 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"List View"})]}),!p&&!t&&n==="board"&&(Xe.length>0?a.jsxs(qx,{sensors:Ne,collisionDetection:Bx,onDragStart:fe,onDragEnd:we,onDragCancel:de,children:[a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4 rounded-md",children:P8.map(Q=>{const ne=Ze.filter(ae=>ae.status===Q);return a.jsx(a8e,{column:Q,columnTasks:ne,getTaskCardColor:_e,isTaskOverdue:Be,formatDateDisplay:dT,handleOpenModal:be,handleDeleteTask:Ee},Q)})}),a.jsx(EN,{children:q?a.jsx(s8e,{task:q,getTaskCardColor:_e,isTaskOverdue:Be,formatDateDisplay:dT}):null})]}):a.jsx("div",{className:"col-span-4 text-center py-10 text-gray-500 border border-dashed rounded-xl",children:"No tasks found."})),!p&&!t&&n==="list"&&a.jsx("div",{className:"bg-white rounded-md shadow-sm overflow-hidden",children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-gray-600 text-left",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 w-10",children:a.jsx("input",{type:"checkbox",className:"w-4 h-4 accent-blue-600",checked:Ze.length>0&&Ze.every(Q=>B.includes(Q.id)),onChange:We})}),a.jsx("th",{className:"py-3 px-4 font-medium",children:"Task"}),a.jsx("th",{className:"py-3 px-4 font-medium",children:"Status"}),a.jsx("th",{className:"py-3 px-4 font-medium",children:"Priority"}),a.jsx("th",{className:"py-3 px-4 font-medium",children:"Assigned To"}),a.jsx("th",{className:"py-3 px-4 font-medium",children:"Date Assigned"}),a.jsx("th",{className:"py-3 px-4 font-medium text-center w-24",children:B.length>0?a.jsx("button",{onClick:lt,className:"text-red-600 hover:text-red-800 transition p-1 rounded-full hover:bg-red-50",title:`Delete ${B.length} selected tasks`,children:a.jsx(wa,{size:18})}):""})]})}),a.jsx("tbody",{children:Ze.length>0?Ze.map(Q=>a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors text-sm cursor-pointer",children:[a.jsx("td",{className:"py-3 px-4",onClick:ne=>ne.stopPropagation(),children:a.jsx("input",{type:"checkbox",className:"w-4 h-4 accent-blue-600",checked:B.includes(Q.id),onChange:()=>tt(Q.id)})}),a.jsx("td",{className:"py-3 px-4 text-gray-700 whitespace-nowrap font-medium",onClick:()=>be(Q,!0),children:Q.title}),a.jsx("td",{className:"py-3 px-4 whitespace-nowrap",onClick:()=>be(Q,!0),children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium whitespace-nowrap ${pe(Q.status||"Not started")}`,children:Q.status||"Not started"})}),a.jsx("td",{className:"py-3 px-4 whitespace-nowrap",onClick:()=>be(Q,!0),children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium whitespace-nowrap ${ce(Q.priority||"Low")}`,children:Q.priority||"Low"})}),a.jsx("td",{className:"py-3 px-4 text-gray-700 whitespace-nowrap",onClick:()=>be(Q,!0),children:Q.assignedToName||"Unassigned"}),a.jsx("td",{className:`py-3 px-4 text-gray-700 whitespace-nowrap ${Be(Q)?"text-red-600 font-medium":""}`,onClick:()=>be(Q,!0),children:Q.dateAssigned?dT(Q.dateAssigned):""}),a.jsx("td",{})]},Q.id)):a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"text-center py-4 text-gray-500",children:"No tasks found."})})})]})})}),!p&&!t&&n==="list"&&a.jsx(ca,{className:"mt-6",totalItems:Xe.length,pageSize:E,currentPage:Xe.length===0?0:T,onPrev:()=>A(Q=>Math.max(Q-1,1)),onNext:()=>A(Q=>Math.min(Q+1,Math.max(1,Math.ceil(Xe.length/E)||1))),onPageSizeChange:Q=>{M(Q),A(1)},pageSizeOptions:[10,20,30,40,50],label:"tasks"}),a.jsx(v0,{isOpen:r,onClose:me,onSave:Ue,onEdit:()=>u(!1),setFormData:X,formData:je,isEditing:!c&&!!o,viewMode:c,users:_,currentUser:e,onDelete:Ee}),z&&a.jsx(t8e,{open:!0,title:z.title,message:z.message,confirmLabel:z.confirmLabel,cancelLabel:z.cancelLabel,variant:z.variant,onConfirm:Fe,onCancel:st,loading:D})]})}function e8e({icon:e,title:t,value:n,color:s,bgColor:r,onClick:i}){return a.jsxs("div",{className:"flex items-center p-4 bg-white rounded-xl shadow-md border border-gray-200 transition-all duration-300 cursor-default",onClick:i,children:[a.jsx("div",{className:`flex-shrink-0 p-3 rounded-full ${r} ${s} mr-4`,children:e?a.jsx(e,{size:22}):null}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:t}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:n})]})]})}function t8e({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r,variant:i,loading:o,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsx("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${u}`,disabled:o,children:o?"Processing...":s})]})]})})}function a8e({column:e,columnTasks:t,getTaskCardColor:n,isTaskOverdue:s,formatDateDisplay:r,handleOpenModal:i,handleDeleteTask:o}){const{isOver:l,setNodeRef:c}=Wx({id:e});return a.jsxs("div",{ref:c,className:`bg-white p-4 shadow border flex flex-col relative rounded-md transition-all duration-200 min-h-[200px] ${l?"border-blue-400 bg-blue-50 ring-2 ring-blue-300":"border-gray-200"}`,children:[a.jsx("div",{className:"absolute top-0 left-0 w-full h-5 bg-secondary rounded-t-md"}),a.jsxs("div",{className:"flex items-center justify-between mb-3 pt-7",children:[a.jsx("h3",{className:"font-medium text-gray-900",children:e}),a.jsx("span",{className:"text-xs bg-gray-100 px-2 py-1 rounded-full text-gray-500",children:t.length})]}),a.jsx("div",{className:`space-y-3 flex-1 ${t.length>3?"overflow-y-auto max-h-[480px] hide-scrollbar":""}`,children:t.length>0?t.map(u=>a.jsx(n8e,{task:u,getTaskCardColor:n,isTaskOverdue:s,formatDateDisplay:r,handleOpenModal:i,handleDeleteTask:o},u.id)):a.jsx("div",{className:`text-center py-10 text-gray-500 border-2 border-dashed rounded-lg ${l?"border-blue-300 bg-blue-50":"border-gray-200"}`,children:l?"Drop here":"No tasks"})})]})}function n8e({task:e,getTaskCardColor:t,isTaskOverdue:n,formatDateDisplay:s,handleOpenModal:r,handleDeleteTask:i}){const{attributes:o,listeners:l,setNodeRef:c,transform:u,isDragging:d}=Gx({id:e.id}),h=u?{transform:`translate3d(${u.x}px, ${u.y}px, 0)`}:void 0;return a.jsxs("div",{ref:c,style:h,className:`border rounded-lg p-3 transition flex justify-between items-start cursor-grab active:cursor-grabbing ${t(e)} ${d?"opacity-50 shadow-lg ring-2 ring-blue-400":""}`,...l,...o,children:[a.jsxs("div",{className:"text-left flex-1",onClick:p=>{p.stopPropagation(),r(e,!0)},children:[a.jsx("p",{className:"font-medium text-gray-800 text-sm",children:e.title}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Priority: ",e.priority]}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Assigned To: ",e.assignedToName]}),a.jsxs("p",{className:"text-xs mt-1 text-gray-500",children:["Date: ",a.jsx("span",{className:n(e)?"text-red-600":"text-gray-600",children:e.dateAssigned?s(e.dateAssigned):""})]})]}),a.jsxs("div",{className:"flex items-center gap-2 ml-3",onClick:p=>p.stopPropagation(),children:[a.jsx("button",{type:"button",onClick:p=>{p.stopPropagation(),r(e)},className:"text-blue-500 hover:text-blue-700",children:a.jsx(hn,{})}),a.jsx("button",{type:"button",onClick:p=>{p.stopPropagation(),i(e)},className:"text-red-500 hover:text-red-700",children:a.jsx(wa,{})})]})]})}function s8e({task:e,getTaskCardColor:t,isTaskOverdue:n,formatDateDisplay:s}){return a.jsx("div",{className:`border rounded-lg p-3 shadow-xl ring-2 ring-blue-400 ${t(e)}`,style:{width:"280px"},children:a.jsxs("div",{className:"text-left flex-1",children:[a.jsx("p",{className:"font-medium text-gray-800 text-sm",children:e.title}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Priority: ",e.priority]}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Assigned To: ",e.assignedToName]}),a.jsxs("p",{className:"text-xs mt-1 text-gray-500",children:["Date: ",a.jsx("span",{className:n(e)?"text-red-600":"text-gray-600",children:e.dateAssigned?s(e.dateAssigned):""})]})]})})}const _J=e=>e?e.toUpperCase():"",Ob=e=>{const t=_J(e);return t==="PLANNED"||t==="IN PROGRESS"?"PLANNED":t==="HELD"||t==="DONE"?"HELD":t==="NOT_HELD"||t==="NOT HELD"?"NOT_HELD":"PLANNED"},r8e=e=>{if(!e)return"";const t=String(e).split("-");return t.length===3?`${t[0]}-${t[2]}`:String(e)},i8e=e=>{if(!e)return"--";try{return new Date(e).toLocaleString()}catch{return"--"}},o8e=e=>{const t=_J(e);switch(t==="PLANNED"?"PENDING":t==="HELD"?"COMPLETED":t==="NOT_HELD"?"CANCELLED":t){case"PENDING":return"bg-indigo-100 text-indigo-700";case"COMPLETED":case"DONE":return"bg-green-100 text-green-700";case"CANCELLED":return"bg-gray-200 text-gray-700";case"IN PROGRESS":return"bg-blue-100 text-blue-700";default:return"bg-gray-100 text-gray-700"}},uT={subject:"",startTime:"",endTime:"",location:"",status:"PLANNED",notes:"",assignedTo:"",relatedType1:"Lead",relatedTo1:"",relatedType2:null,relatedTo2:""},l8e=()=>{const e=kt(),t=ta(),[n]=Bs(),s=n.get("id"),r=t.pathname==="/admin/meetings/info";f.useEffect(()=>{document.title="Meetings | Sari-Sari CRM"},[]);const[i,o]=f.useState([]),[l,c]=f.useState(!1),[u,d]=f.useState([]),[h,p]=f.useState(""),[x,v]=f.useState("Filter by Status"),[j,y]=f.useState(!1),[N,w]=f.useState(null),[S,_]=f.useState(1),[k,T]=f.useState(10),[A,E]=f.useState(uT),[M,z]=f.useState(!1),[P,D]=f.useState(null),[U,B]=f.useState(!1),[R,q]=f.useState(null),[Z,V]=f.useState(!1),[oe,je]=f.useState(null),[X,se]=f.useState(new Set),[ye,Ne]=f.useState(!1),{user:fe}=Vt();f.useEffect(()=>{const _e=t.state?.openMeetingModal,pe=t.state?.initialMeetingData?.relatedTo||n.get("id"),ce=t.state?.meetingID;_e||pe?(y(!0),t.state?.initialMeetingData&&E(Q=>({...Q,...t.state.initialMeetingData})),e(t.pathname,{replace:!0,state:{}})):ce&&(je(ce),e(t.pathname,{replace:!0,state:{}}))},[t,n,e]),f.useEffect(()=>{console.log("ManagerMeetings - Current User:",fe),console.log("Current User Role:",fe?.role),console.log("Is non-admin:",["GROUP MANAGER","MANAGER","SALES"].includes(fe?.role?.toUpperCase()))},[fe]),f.useEffect(()=>{if(oe&&i.length>0&&!l){const _e=i.find(pe=>pe.id===oe);_e?w(_e):H.error("Meeting not found."),je(null)}},[oe,i,l]);const we=async()=>{if(s&&r){const _e=sessionStorage.getItem("meetingDetailData");if(_e)try{const pe=JSON.parse(_e);if(pe.id===parseInt(s)){w(pe),sessionStorage.removeItem("meetingDetailData");return}}catch(pe){console.error(pe)}}c(!0);try{console.log("=== FETCH MEETINGS START ===");const _e=await re.get("/meetings/admin/fetch-all"),pe=Array.isArray(_e.data)?_e.data:[];console.log("Total meetings fetched:",pe.length),console.log("Meeting statuses:",pe.map(Q=>({id:Q.id,subject:Q.subject,status:Q.status})));const ce=[...pe].sort((Q,ne)=>{const ae=Q?.created_at?new Date(Q.created_at).getTime():0;return(ne?.created_at?new Date(ne.created_at).getTime():0)-ae});if(o(ce),console.log("Meetings set after sort"),console.log("=== FETCH MEETINGS COMPLETE ==="),s&&!N){const Q=ce.find(ne=>ne.id===parseInt(s));Q&&w(Q)}}catch(_e){console.error("fetchMeetings error:",_e),H.error("Failed to load meetings.")}finally{c(!1)}},de=async()=>{try{const _e=await re.get("/users/all");d(Array.isArray(_e.data)?_e.data:[])}catch(_e){console.error(_e)}};f.useEffect(()=>{we(),de()},[]);const ke=_e=>p(_e.target.value),$e=["GROUP MANAGER","MANAGER","SALES"].includes(fe?.role?.toUpperCase()),be=$e?i.filter(_e=>{const pe=_e.status?.toUpperCase()==="INACTIVE";return pe&&console.log(`Filtering out INACTIVE meeting: ${_e.subject} (status: ${_e.status})`),!pe}):i;console.log("=== FILTER SUMMARY ==="),console.log("User role:",fe?.role),console.log("Is non-admin:",$e),console.log("Total meetings:",i.length),console.log("Visible meetings after filter:",be.length),console.log("=== END FILTER SUMMARY ===");const me=f.useMemo(()=>{const _e=h.trim().toLowerCase(),pe=x.trim().toUpperCase();return be.filter(ce=>{const Q=[ce?.activity,ce?.description,ce?.relatedTo,ce?.assignedTo],ne=_e===""||Q.some(Pe=>Pe&&Pe.toString().toLowerCase().includes(_e)),ae=pe==="FILTER BY STATUS"||Ob(ce.status||"PENDING")===pe;return ne&&ae})},[be,h,x]),Ue=f.useMemo(()=>{const _e=(S-1)*k;return me.slice(_e,_e+k)},[me,S]),Ee=()=>{y(!1),E(uT),z(!1),D(null),B(!1)},We=()=>{E(uT),z(!1),D(null),y(!0)},tt=_e=>{let pe="";if(_e.meet_assign_to?.id)pe=String(_e.meet_assign_to.id);else if(_e.assignedTo){const qe=u.find(nt=>`${nt.first_name} ${nt.last_name}`===_e.assignedTo);pe=qe?String(qe.id):""}const ce=qe=>{if(!qe)return"";try{const nt=new Date(qe),ot=nt.getTimezoneOffset()*6e4;return new Date(nt.getTime()-ot).toISOString().slice(0,16)}catch{return""}};let Q="Lead",ne="",ae="Contact",Pe="";if(_e.lead)Q="Lead",ne=String(_e.lead.id);else if(_e.account)Q="Account",ne=String(_e.account.id),_e.contact?(ae="Contact",Pe=String(_e.contact.id)):_e.deal?(ae="Deal",Pe=String(_e.deal.id)):_e.quote&&(ae="Quote",Pe=String(_e.quote.id));else if(_e.relatedType||_e.related_type){const qe=_e.relatedType||_e.related_type,nt=_e.related_to||_e.relatedToId;qe==="Lead"?(Q="Lead",ne=String(nt)):(Q="Account",ne=_e.account_id?String(_e.account_id):"")}const Te={PLANNED:"Planned",HELD:"Held",NOT_HELD:"Not held"},he=Ob(_e.status),He=Te[he]||"Planned";E({subject:_e.subject||_e.activity||"",location:_e.location||"",startTime:ce(_e.start_time||_e.startTime),endTime:ce(_e.end_time||_e.endTime),status:He,notes:_e.description||_e.notes||"",assignedTo:pe,relatedType1:Q,relatedTo1:ne,relatedType2:ae,relatedTo2:Pe}),z(!0),D(_e.id),w(null),y(!0)},lt=_e=>{if(!_e.subject?.trim())return H.error("Subject is required.");if(!_e.startTime)return H.error("Start time is required.");if(_e.endTime&&!(new Date(_e.endTime)-new Date(_e.startTime)>0))return H.error("End time must be after start time.");_e.relatedType1,_e.relatedTo1,_e.relatedType1==="Account"&&_e.relatedType2&&_e.relatedTo2&&(_e.relatedType2,_e.relatedTo2);const pe={..._e,assignedTo:parseInt(_e.assignedTo),relatedTo1:parseInt(_e.relatedTo1),relatedTo2:parseInt(_e.relatedTo2)},ce=M&&P?"update":"create";q({title:ce==="create"?"Confirm New Meeting":"Confirm Update",message:`Are you sure you want to ${ce} "${pe.subject}"?`,confirmLabel:ce==="create"?"Create Meeting":"Update Meeting",variant:"primary",action:{type:ce,payload:pe,targetId:P,name:pe.subject}})},Fe=async()=>{if(!R?.action)return;const{type:_e,payload:pe,targetId:ce,name:Q,targetIds:ne,count:ae}=R.action;V(!0);try{if(_e==="create")B(!0),await re.post("/meetings/create",pe),H.success(`Meeting "${Q}" created.`),Ee(),await we();else if(_e==="update")B(!0),await re.put(`/meetings/${ce}`,pe),H.success(`Meeting "${Q}" updated.`),Ee(),await we();else if(_e==="delete"){console.log("=== ARCHIVE FLOW START ==="),console.log("Archiving meeting:",ce),console.log("Meeting name:",Q);try{const Pe=await re.delete(`/meetings/${ce}`);console.log("Archive API response:",Pe),console.log("Response data:",Pe.data),H.success(`Meeting "${Q}" archived successfully.`),N?.id===ce&&w(null),console.log("Calling fetchMeetings to refresh list..."),await we(),console.log("=== ARCHIVE FLOW COMPLETE ===")}catch(Pe){throw console.error("Archive failed:",Pe),Pe}}else if(_e==="bulk-delete"){if(!ne||ne.length===0)throw new Error("Missing meeting identifiers for bulk archiving.");console.log("Bulk archiving meetings:",ne),Ne(!0),await re.put("/meetings/bulk-archive",{meeting_ids:ne}),H.success(`${ae} meeting${ae!==1?"s":""} archived successfully.`),se(new Set),await we(),N&&X.has(N.id)&&w(null)}}catch(Pe){console.error("Error in handleConfirmAction:",Pe),console.error("Error response:",Pe?.response),console.error("Error details:",Pe?.response?.data);const Te=_e==="create"?"Failed to create meeting. Please review the details and try again.":_e==="update"?"Failed to update meeting. Please review the details and try again.":_e==="bulk-delete"?"Failed to archive meetings. Please try again.":"Failed to delete meeting. Please try again.",he=Pe?.response?.data?.detail||Te;H.error(he)}finally{(_e==="create"||_e==="update")&&B(!1),_e==="bulk-delete"&&Ne(!1),V(!1),q(null)}},st=_e=>{console.log("Delete button clicked for meeting:",_e),console.log("Meeting created_by:",_e.created_by),console.log("Current user ID:",fe?.id),console.log("Can delete?:",_e.created_by===fe?.id),q({title:"Archive Meeting",message:`Are you sure you want to archive "${_e.subject||_e.activity}"? You can restore it later if needed.`,confirmLabel:"Archive",variant:"archive",action:{type:"delete",targetId:_e.id,name:_e.subject||_e.activity}})},Xe=async(_e,pe)=>{try{await re.put(`/meetings/${_e}`,{status:pe}),H.success("Status updated"),we(),w(null)}catch{H.error("Failed to update status")}},Ze=_e=>{const pe=Ue.find(ce=>ce.id===_e);pe&&pe.created_by===fe?.id&&se(ce=>{const Q=new Set(ce);return Q.has(_e)?Q.delete(_e):Q.add(_e),Q})},Je=()=>{const _e=Ue.filter(pe=>pe.created_by===fe?.id);X.size===_e.length?se(new Set):se(new Set(_e.map(pe=>pe.id)))},Be=()=>{if(X.size===0)return;const _e=X.size;q({title:"Archive Meetings",message:a.jsxs("span",{children:["Are you sure you want to archive"," ",a.jsx("span",{className:"font-semibold",children:_e})," meeting",_e!==1?"s":"","? You can restore them later if needed."]}),confirmLabel:`Archive ${_e} Meeting${_e!==1?"s":""}`,cancelLabel:"Cancel",variant:"archive",action:{type:"bulk-delete",targetIds:Array.from(X),count:_e}})};return r&&s?N?a.jsx(Nd,{meeting:N,onClose:()=>{w(null),e("/admin/dashboard")},onEdit:tt,onDelete:st,onStatusUpdate:Xe,currentUser:fe,isSalesView:!0}):a.jsx(Wt,{message:"Loading meeting..."}):a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[l&&a.jsx(Wt,{message:"Loading meetings..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h1",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800 mb-4 lg:mb-0",children:[a.jsx(Ot,{className:"mr-2 text-blue-600"})," Meetings"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{onClick:We,className:"bg-black text-white px-4 py-2 rounded-md flex items-center hover:bg-gray-800",children:[a.jsx(aa,{className:"mr-2"})," Add Meeting"]})})]}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full sm:w-auto lg:w-4/4 md:w-3/4",children:[a.jsx(Kt,{className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search meetings",value:h,onChange:ke,className:"w-full outline-none"})]}),a.jsxs("select",{value:x,onChange:_e=>v(_e.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm bg-white w-full sm:w-auto",children:[a.jsx("option",{children:"Filter by Status"}),a.jsx("option",{value:"PLANNED",children:"PLANNED"}),a.jsx("option",{value:"HELD",children:"HELD"}),a.jsx("option",{value:"NOT_HELD",children:"NOT HELD"})]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[500px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm mb-4",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 w-12",children:a.jsx("input",{type:"checkbox",checked:X.size===Ue.filter(_e=>_e.created_by===fe?.id).length&&Ue.filter(_e=>_e.created_by===fe?.id).length>0,onChange:Je,className:"w-4 h-4 cursor-pointer rounded border-gray-300"})}),a.jsx("th",{className:"py-3 px-4",children:"Subject"}),a.jsx("th",{className:"py-3 px-4",children:"Related To"}),a.jsx("th",{className:"py-3 px-4",children:"Start Time"}),a.jsx("th",{className:"py-3 px-4",children:"Assigned"}),a.jsx("th",{className:"py-3 px-4",children:"Status"}),a.jsx("th",{className:"py-3 px-4 w-12",children:X.size>0&&a.jsx("button",{onClick:Be,className:"text-orange-500 hover:text-orange-700 transition",title:"Archive selected meetings",disabled:ye,children:a.jsx(Zt,{size:18})})})]})}),a.jsx("tbody",{children:Ue.length>0?Ue.map(_e=>a.jsxs("tr",{onClick:()=>w(_e),className:"hover:bg-gray-50 cursor-pointer border-b border-gray-100",children:[a.jsx("td",{className:"py-3 px-4",onClick:pe=>pe.stopPropagation(),children:fe?.id===_e.created_by&&a.jsx("input",{type:"checkbox",checked:X.has(_e.id),onChange:pe=>{pe.stopPropagation(),Ze(_e.id)},className:"w-4 h-4 cursor-pointer rounded border-gray-300"})}),a.jsx("td",{className:"py-3 px-4 font-medium text-blue-600",children:_e.subject}),a.jsxs("td",{className:"py-3 px-4",children:[_e.lead&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:_e.lead.title}),_e.account&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:_e.account.name}),_e.contact&&a.jsxs("p",{className:"font-medium text-blue-500 text-xs",children:[_e.contact.first_name," ",_e.contact.last_name]}),_e.deal&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:_e.deal.name}),_e.quote&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:r8e(_e.quote.quote_id)})]}),a.jsx("td",{className:"py-3 px-4",children:i8e(_e.start_time)}),a.jsxs("td",{className:"py-3 px-4",children:[_e.meet_assign_to.first_name," ",_e.meet_assign_to.last_name]}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${o8e(Ob(_e.status))}`,children:Ob(_e.status).replace("_"," ")})})]},_e.id)):a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"text-center py-4 text-gray-500",children:"No meetings found."})})})]})}),a.jsx(ca,{totalItems:me.length,pageSize:k,currentPage:S,onPrev:()=>_(_e=>Math.max(1,_e-1)),onNext:()=>_(_e=>_e+1),onPageSizeChange:_e=>{T(_e),_(1)},pageSizeOptions:[10,20,30,40,50],label:"meetings"}),j&&a.jsx(k1,{onClose:Ee,formData:A,setFormData:E,isEditing:M,onSubmit:lt,isSubmitting:U||Z,users:u}),N&&a.jsx(Nd,{meeting:N,onClose:()=>w(null),onEdit:tt,onDelete:st,onStatusUpdate:Xe,currentUser:fe,isSalesView:!0}),R&&a.jsx(c8e,{open:!0,title:R.title,message:R.message,confirmLabel:R.confirmLabel,variant:R.variant,onConfirm:Fe,onCancel:()=>q(null),loading:Z})]})};function c8e({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":i==="archive"?"bg-orange-500 hover:bg-orange-600 border border-orange-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{onClick:c,disabled:o,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",children:"Cancel"}),a.jsx("button",{onClick:l,disabled:o,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70
                       ${u}`,children:o?"...":s})]})]})})}const E1=[{value:"CEO",label:"CEO"},{value:"Admin",label:"Admin"},{value:"Group Manager",label:"Group Manager"},{value:"Manager",label:"Manager"},{value:"Marketing",label:"Marketing"},{value:"Sales",label:"Sales"}],Pg={firstName:"",lastName:"",email:"",password:"",role:""},d8e={CEO:"bg-purple-100 text-purple-700",ADMIN:"bg-purple-100 text-purple-700",GROUP_MANAGER:"bg-indigo-100 text-indigo-700",MANAGER:"bg-blue-100 text-blue-700",MARKETING:"bg-yellow-100 text-yellow-700",SALES:"bg-green-100 text-green-700"},Eo=e=>e?e.toString().trim().replace(/([a-z0-9])([A-Z])/g,"$1_$2").replace(/\s+/g,"_").toUpperCase():"",u8e=e=>{const t=Eo(e),n=E1.find(s=>Eo(s.value)===t);return n?n.value:e||""},nL=e=>{const t=Eo(e),n=E1.find(s=>Eo(s.value)===t);return n?n.label:typeof e=="string"?e.toLowerCase().replace(/\b\w/g,s=>s.toUpperCase()):"--"},O8=e=>{if(!e)return"--";const t=new Date(e);return Number.isNaN(t.getTime())?"--":t.toLocaleString("en-US",{month:"2-digit",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).replace(",","")},mT=(e,{size:t="sm"}={})=>{const n=Eo(e),s=d8e[n]||"bg-gray-100 text-gray-700",r=t==="lg"?"px-3 py-1 text-sm":t==="md"?"px-2.5 py-1 text-sm":"px-2 py-1 text-xs";return a.jsx("span",{className:`${r} font-semibold rounded-md inline-flex items-center justify-center ${s}`,children:nL(e)})},m8e=(e,t)=>{const n=e?.trim()?.[0]??"",s=t?.trim()?.[0]??"";return`${n}${s}`.toUpperCase()||"U"},M8=e=>[...e].sort((t,n)=>{const s=t.created_at?new Date(t.created_at).getTime():0;return(n.created_at?new Date(n.created_at).getTime():0)-s});function f8e(){const{user:e,loading:t}=Vt(),[n,s]=f.useState([]),[r,i]=f.useState(!1),[o,l]=f.useState(""),[c,u]=f.useState(""),[d,h]=f.useState(null),[p,x]=f.useState(!1),[v,j]=f.useState(!1),[y,N]=f.useState(null),[w,S]=f.useState(Pg),[_,k]=f.useState(!1),[T,A]=f.useState(null),[E,M]=f.useState(!1),[z,P]=f.useState(1),[D,U]=f.useState(10),[B,R]=f.useState("Overview"),[q,Z]=f.useState(""),[V,oe]=f.useState(!1),je=Eo(e?.role),X=["ADMIN","CEO","GROUP MANAGER","MANAGER"].includes(je),se=!t&&X,ye=f.useMemo(()=>{const ce=E1.filter(Q=>Eo(Q.value)!=="CEO");return[{label:"Filter by Roles",value:""},{label:"CEO",value:"CEO"},...ce]},[]),Ne=f.useCallback(ce=>{ce&&(s(Q=>Q.map(ne=>ne.id===ce?{...ne,highlight:!0}:ne)),setTimeout(()=>{s(Q=>Q.map(ne=>ne.id===ce?{...ne,highlight:!1}:ne))},2e3))},[]),fe=f.useCallback(async()=>{i(!0);try{const ce=await re.get("/users/all"),Q=Array.isArray(ce.data)?ce.data:[],ne=M8(Q);s(ne),h(ae=>ae&&(ne.find(Te=>Te.id===ae.id)||null)),console.log(ce.data)}catch(ce){console.error("Error fetching users:",ce);const Q=ce.response?.data?.detail||"Failed to load users. Please try again later.";H.error(Q)}finally{i(!1)}},[]);f.useEffect(()=>{!t&&!X&&e&&H.error("You are not authorized to access User Management.")},[X,t,e]),f.useEffect(()=>{t||!X||fe()},[t,X,fe]),f.useEffect(()=>{document.title="Users | Sari-Sari CRM"},[]);const we=f.useMemo(()=>{const ce=o.trim().toLowerCase(),Q=Eo(c);return M8(n.filter(ne=>{if(!ne)return!1;const ae=ce===""||[ne.first_name,ne.last_name,`${ne.first_name||""} ${ne.last_name||""}`,ne.email,nL(ne.role)].filter(Boolean).some(Te=>Te.toString().toLowerCase().includes(ce)),Pe=Q===""||Q==="CEO"&&["CEO","ADMIN"].includes(Eo(ne.role))||Eo(ne.role)===Q;return ae&&Pe}))},[n,o,c]),de=Math.max(1,Math.ceil(we.length/D)||1);f.useEffect(()=>{P(1)},[o,c]),f.useEffect(()=>{P(ce=>{const Q=Math.max(1,Math.ceil(we.length/D)||1);return ce>Q?Q:ce})},[we.length]);const ke=f.useMemo(()=>{const ce=(z-1)*D;return we.slice(ce,ce+D)},[we,z]);we.length===0||(z-1)*D+1,Math.min(z*D,we.length);const ge=()=>P(ce=>Math.max(ce-1,1)),$e=()=>P(ce=>Math.min(ce+1,de)),be=()=>{S(Pg),j(!1),N(null),x(!0)},me=ce=>{console.log(ce),h(ce),R("Overview"),Z(ce?.is_active?"Active":"Inactive")},Ue=ce=>{ce.target.id==="userModalBackdrop"&&!E&&Ee()},Ee=()=>{h(null)},We=(ce,Q)=>{S(ne=>({...ne,[ce]:Q}))},tt=()=>{const ce="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*";let Q="";for(let ne=0;ne<10;ne+=1)Q+=ce.charAt(Math.floor(Math.random()*ce.length));We("password",Q)},lt=()=>{_||E||(x(!1),S(Pg),N(null),j(!1))},Fe=ce=>{S({firstName:ce.first_name||"",lastName:ce.last_name||"",email:ce.email||"",password:"",role:u8e(ce.role)}),j(!0),N(ce.id),x(!0),h(null)},st=ce=>{A({title:"Delete User",message:a.jsxs("span",{children:["Are you sure you want to delete"," ",a.jsxs("span",{className:"font-semibold",children:[ce.first_name," ",ce.last_name]}),"? This action cannot be undone."]}),confirmLabel:"Delete",cancelLabel:"Cancel",variant:"danger",action:{type:"delete",targetId:ce.id,name:`${ce.first_name||""} ${ce.last_name||""}`.trim()||ce.email||"user"}})},Xe=ce=>{ce.preventDefault();const Q=w.firstName.trim(),ne=w.lastName.trim(),ae=w.email.trim(),Pe=w.password.trim(),Te="Sales",he=!(v&&y);if(!Q||!ae||!Te){H.warn("Please fill in all required fields.");return}if(he&&!Pe){H.warn("Please fill in all required fields.");return}if(Pe&&Pe.length<8){H.warn("Password should be at least 8 characters long.");return}const He={first_name:Q,last_name:ne,email:ae,role:Te};console.log(He),(he||Pe)&&(He.password=Pe);const qe=`${Q} ${ne}`.trim(),nt=he?"create":"update";A({title:nt==="create"?"Confirm New User":"Confirm User Update",message:nt==="create"?a.jsxs("span",{children:["Create user ",a.jsx("span",{className:"font-semibold",children:qe})," with role"," ",a.jsx("span",{className:"font-semibold",children:nL(Te)}),"?"]}):a.jsxs("span",{children:["Save changes for"," ",a.jsx("span",{className:"font-semibold",children:qe||ae}),"?"]}),confirmLabel:nt==="create"?"Create User":"Update User",cancelLabel:"Cancel",variant:"primary",action:{type:nt,payload:He,targetId:y,name:qe||ae}})},Ze=async()=>{if(!T?.action){A(null);return}const{action:ce}=T,{type:Q,payload:ne,targetId:ae,name:Pe}=ce;M(!0),(Q==="create"||Q==="update")&&k(!0);try{if(Q==="create"){const he=(await re.post("/users/createuser",ne)).data;await fe(),Ne(he.id),H.success(`User "${Pe}" created successfully.`),x(!1),S(Pg),N(null),j(!1)}else if(Q==="update"){if(!ae)throw new Error("Missing user identifier for update.");const he=(await re.put(`/users/updateuser/${ae}`,ne)).data;await fe(),h(null),Ne(he.id),H.success(`User "${Pe}" updated successfully.`),x(!1),S(Pg),N(null),j(!1)}else if(Q==="delete"){if(!ae)throw new Error("Missing user identifier for deletion.");await re.delete(`/users/deleteuser/${ae}`),s(Te=>Te.map(he=>he.id===ae?{...he,is_active:!1}:he)),d&&d.id===ae&&(h(null),Z("")),H.success(`User "${Pe}" deactivated successfully.`)}}catch(Te){console.error("User management error:",Te);const he=Q==="create"?"Failed to create user. Please review the details and try again.":Q==="update"?"Failed to update user. Please review the details and try again.":"Failed to delete user. Please try again.",He=Te.response?.data?.detail||he;H.error(He)}finally{(Q==="create"||Q==="update")&&k(!1),M(!1),A(null)}},Je=()=>{E||A(null)},Be=async()=>{if(!d||!q)return;const ce=d.is_active?"Active":"Inactive";if(q===ce)return;const Q=q==="Active";oe(!0);try{const ae=(await re.put(`/users/updateuser/${d.id}`,{is_active:Q})).data;s(Pe=>Pe.map(Te=>Te.id===ae.id?ae:Te)),h(null),Z(""),H.success(`User status updated to ${q}`)}catch(ne){console.error("Failed to update user status:",ne);const ae=ne.response?.data?.detail||"Failed to update user status. Please try again.";H.error(ae)}finally{oe(!1)}},_e=a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[(r||t||!se)&&a.jsx(Wt,{}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h1",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(xj,{className:"mr-2 text-blue-600"}),"User Management"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{type:"button",onClick:be,className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 rounded-md hover:bg-gray-800 text-sm sm:text-base self-end sm:self-auto cursor-pointer",children:[a.jsx(Xa,{className:"mr-2"})," Add User"]})})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search users",value:o,onChange:ce=>l(ce.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsx("div",{className:"w-full lg:w-1/4",children:a.jsx("select",{value:c,onChange:ce=>u(ce.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:ye.map(ce=>a.jsx("option",{value:ce.value,children:ce.label},ce.value))})})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[600px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 text-sm tracking-wide font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4",children:"Fullname"}),a.jsx("th",{className:"py-3 px-4",children:"Email"}),a.jsx("th",{className:"py-3 px-4",children:"Role"}),a.jsx("th",{className:"py-3 px-4",children:"Status"})]})}),a.jsx("tbody",{children:r?a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:3,children:"Loading users..."})}):we.length===0?a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-400",colSpan:4,children:"No users found."})}):ke.map(ce=>a.jsxs("tr",{className:`hover:bg-gray-50 transition-colors ${ce.highlight?"bg-green-50":""} ${ce.is_active?"":"opacity-60 bg-gray-50"}`,children:[a.jsx("td",{className:"py-3 px-4 cursor-pointer",onClick:()=>me(ce),children:a.jsxs("div",{className:"font-medium text-blue-600 hover:underline text-sm",children:[ce.first_name," ",ce.last_name]})}),a.jsx("td",{className:"py-3 px-4 cursor-pointer text-sm",onClick:()=>me(ce),children:ce.email}),a.jsx("td",{className:"py-3 px-4 cursor-pointer",onClick:()=>me(ce),children:mT(ce.role)}),a.jsx("td",{className:"py-3 px-4 cursor-pointer",onClick:()=>me(ce),children:a.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-md ${ce.is_active?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:ce.is_active?"Active":"Inactive"})})]},ce.id))})]})}),a.jsx(ca,{className:"mt-4",totalItems:we.length,pageSize:D,currentPage:z,onPrev:ge,onNext:$e,onPageSizeChange:ce=>{U(ce),P(1)},pageSizeOptions:[10,20,30,40,50],label:"users"})]}),pe=d?a.jsx("div",{id:"userModalBackdrop",onClick:Ue,className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-6xl max-h-[92vh] overflow-y-auto hide-scrollbar animate-scale-in p-4 sm:p-6 md:p-8 font-inter relative",children:[a.jsx("div",{className:"flex justify-end w-full",children:a.jsx("button",{onClick:Ee,className:"text-gray-500 hover:text-gray-700 transition mb-5 cursor-pointer",children:a.jsx(Ja,{size:30})})}),a.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between lg:flex-row lg:items-center lg:justify-between mt-3 gap-2 px-2 md:items-center lg:gap-4 md:mx-7 lg:mx-7 mb-4 lg:mb-6 md:mb-4",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[d.profile_picture?a.jsx("img",{src:d.profile_picture,alt:`${d.first_name} ${d.last_name}`,className:"w-12 h-12 sm:w-16 sm:h-16 rounded-full object-cover border border-gray-200 shadow-sm"}):a.jsx("div",{className:"w-12 h-12 sm:w-16 sm:h-16 rounded-full bg-gray-200 text-gray-700 flex items-center justify-center text-lg sm:text-xl font-semibold border border-gray-200 shadow-sm",children:m8e(d.first_name,d.last_name)}),a.jsxs("div",{children:[a.jsxs("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-800",children:[d.first_name," ",d.last_name]}),a.jsx("p",{className:"text-sm text-gray-500 break-all",children:d.email})]})]}),mT(d.role,{size:"md"})]}),!["CEO","ADMIN","GROUP MANAGER","GROUP_MANAGER"].includes(d.role.toUpperCase())&&a.jsxs("div",{className:"flex flex-col sm:flex-row sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsxs("button",{type:"button",className:"inline-flex items-center justify-center w-full sm:w-auto bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 disabled:opacity-70 transition text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",onClick:()=>Fe(d),disabled:E,children:[a.jsx(hn,{className:"mr-2"}),"Edit"]}),a.jsxs("button",{type:"button",className:"inline-flex items-center justify-center w-full sm:w-auto px-4 py-2 rounded-md text-sm bg-red-500 text-white hover:bg-red-600 transition focus:outline-none focus:ring-2 focus:ring-red-400",onClick:()=>st(d),disabled:E,children:[a.jsx(wa,{className:"mr-2"}),"Delete"]})]})]}),a.jsx("div",{className:"border-b border-gray-200 mb-6"}),a.jsx("div",{className:"flex w-full bg-[#6A727D] text-white mt-1 overflow-x-auto mb-6",children:["Overview"].map(ce=>a.jsx("button",{onClick:()=>R(ce),className:`flex-1 min-w-[90px] px-4 py-2.5 text-xs sm:text-sm font-medium text-center transition-all duration-200 border-b-2
        ${B===ce?"bg-[#5c636d] text-white border-white":"text-white hover:bg-[#5c636d]"}`,children:ce},ce))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 items-start",children:[a.jsx("div",{className:"lg:col-span-3",children:B==="Overview"&&a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 md:p-8 border border-gray-200",children:a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4 sm:gap-6 text-sm text-gray-700",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Email:"}),a.jsx("p",{children:d.email||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Role:"}),a.jsx("p",{children:mT(d.role,{size:"sm"})})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Status:"}),a.jsx("p",{children:d.is_active?"Active":"Inactive"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Auth Provider:"}),a.jsx("p",{children:d.auth_provider?d.auth_provider.toString().replace(/\b\w/g,ce=>ce.toUpperCase()):"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Phone Number:"}),a.jsx("p",{children:d.phone_number||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Company:"}),a.jsx("p",{children:d.company?.company_name||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Company Number:"}),a.jsx("p",{children:d.company?.company_number||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Related to CEO:"}),a.jsx("p",{children:d.manager?`${d.manager.first_name} ${d.manager.last_name}`:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created At:"}),a.jsx("p",{children:O8(d.created_at)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Last Login:"}),a.jsx("p",{children:d.last_login?O8(d.last_login):"Never"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Profile Picture:"}),a.jsx("p",{children:d.profile_picture?a.jsx("a",{href:d.profile_picture,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline break-all",children:"View image"}):"N/A"})]})]})})}),a.jsxs("div",{className:"flex flex-col gap-4",children:[a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Quick Actions"}),a.jsx("div",{className:"flex flex-col gap-2 w-full",children:a.jsxs("button",{type:"button",onClick:()=>{if(!d.email){alert("No email address available");return}const ce=encodeURIComponent(d.email),Q=encodeURIComponent(""),ne=encodeURIComponent(""),ae=`https://mail.google.com/mail/?view=cm&fs=1&to=${ce}&su=${Q}&body=${ne}`;window.open(ae,"_blank")},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(rn,{className:"text-gray-600 w-4 h-4"}),"Send E-mail"]})})]}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm w-full",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Status"}),a.jsxs("select",{className:"border border-gray-200 rounded-md px-2 sm:px-3 py-1.5 w-full text-sm mb-2 focus:ring-2 focus:ring-indigo-500 outline-none",value:q||(d.is_active?"Active":"Inactive"),onChange:ce=>Z(ce.target.value),children:[a.jsx("option",{value:"Active",children:"Active"}),a.jsx("option",{value:"Inactive",children:"Inactive"})]}),a.jsx("button",{onClick:Be,disabled:V||q===(d.is_active?"Active":"Inactive"),className:`w-full py-1.5 rounded-md text-sm transition focus:outline-none focus:ring-2 ${V||q===(d.is_active?"Active":"Inactive")?"bg-gray-400 cursor-not-allowed text-white":"bg-gray-900 text-white hover:bg-gray-800 focus:ring-gray-400"}`,children:V?"Updating...":"Update"})]})]})]})]})}):null;return a.jsxs(a.Fragment,{children:[_e,pe,a.jsx(h8e,{open:p,isEditing:v,isSubmitting:_,confirmProcessing:E,formData:w,onClose:lt,onSubmit:Xe,onChange:We,onGeneratePassword:tt}),a.jsx(g8e,{open:!!T,title:T?.title,message:T?.message,confirmLabel:T?.confirmLabel,cancelLabel:T?.cancelLabel,variant:T?.variant,loading:E,onConfirm:Ze,onCancel:Je})]})}function h8e({open:e,isEditing:t,isSubmitting:n,confirmProcessing:s,formData:r,onClose:i,onSubmit:o,onChange:l,onGeneratePassword:c}){if(!e)return null;const u=n||s;return a.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-2xl rounded-2xl shadow-lg border border-gray-200 p-6 sm:p-8 relative overflow-y-auto max-h-[90vh]",children:[a.jsx("button",{onClick:i,className:"absolute top-4 right-4 text-gray-500 hover:text-black transition disabled:opacity-60",disabled:u,children:a.jsx(ea,{size:22})}),a.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800 mb-6 text-center",children:t?"Edit User":"Add New User"}),a.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",onSubmit:o,children:[a.jsx(Mb,{label:"First Name",value:r.firstName,onChange:d=>l("firstName",d),placeholder:"John",required:!0,disabled:u}),a.jsx(Mb,{label:"Last Name",value:r.lastName,onChange:d=>l("lastName",d),placeholder:"Doe",required:!0,disabled:u}),a.jsx(Mb,{label:"Email",type:"email",value:r.email,onChange:d=>l("email",d),placeholder:"john.doe@company.com",required:!0,disabled:u||t}),a.jsx(Mb,{label:"Role",type:"select",disabled:!0,value:"Sales",onChange:d=>l("role",d),options:[{value:"",label:"Select role"},...E1],required:!0}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Password"}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2",children:[a.jsx("input",{type:"text",value:r.password,onChange:d=>l("password",d.target.value),placeholder:t?"Leave blank to keep current password":"Enter or generate password",required:!t,disabled:u,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-indigo-500 outline-none disabled:bg-gray-100"}),a.jsx("button",{type:"button",onClick:c,className:"flex items-center justify-center px-4 py-2 bg-gray-900 text-white rounded-md hover:bg-gray-800 transition disabled:opacity-60",disabled:u,children:"Generate"})]}),t?a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Setting a password will reset the user's credentials; leave it blank to keep the current password."}):a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Password must be at least 8 characters long."})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-2 md:col-span-2 mt-4",children:[a.jsx("button",{type:"button",onClick:i,className:"w-full sm:w-auto px-4 py-2 text-white bg-red-400 border border-red-300 rounded hover:bg-red-500 transition disabled:opacity-70",disabled:u,children:"Cancel"}),a.jsx("button",{type:"submit",className:"w-full sm:w-auto px-4 py-2 text-white border border-tertiary bg-tertiary rounded hover:bg-secondary transition disabled:opacity-70",disabled:u,children:n?"Saving...":t?"Update User":"Save User"})]})]})]})})}function Mb({label:e,type:t="text",value:n,onChange:s,placeholder:r,options:i=[],required:o=!1,disabled:l=!1}){return a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),t==="select"?a.jsx("select",{value:n??"",onChange:c=>s(c.target.value),required:o,disabled:l,className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-indigo-500 outline-none disabled:bg-gray-100",children:i.map(c=>a.jsx("option",{value:c.value,children:c.label},c.value))}):a.jsx("input",{type:t,value:n??"",onChange:c=>s(c.target.value),placeholder:r,required:o,disabled:l,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-indigo-500 outline-none disabled:bg-gray-100"})]})}function g8e({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o=!1,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":"bg-black hover:bg-gray-800 border border-black";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("div",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsx("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${u}`,disabled:o,children:o?"Processing...":s})]})]})})}function p8e({toggleSidebar:e}){const[t,n]=f.useState(!1),s=f.useRef(null),r=ta(),{logout:i}=Ks(),{user:o,fetchUser:l}=Vt(),c={"/marketing/dashboard":"Dashboard","/marketing/contacts":"Contacts","/marketing/accounts":"Accounts","/marketing/leads":"Leads","/marketing/tasks":"Tasks","/marketing/campaigns":"Campaign","/marketing/templates":"Templates"};f.useEffect(()=>{l()},[]);const u=c[r.pathname]||"Marketing Panel";return f.useEffect(()=>{function d(h){s.current&&!s.current.contains(h.target)&&n(!1)}return document.addEventListener("mousedown",d),()=>document.removeEventListener("mousedown",d)},[]),a.jsxs("header",{className:"flex justify-between items-center bg-white shadow px-6 py-3 border-b relative",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("button",{onClick:e,className:"lg:hidden text-gray-700 hover:text-gray-900",children:a.jsx(th,{className:"text-2xl"})}),a.jsx("h1",{className:"text-lg font-semibold text-gray-800",children:u})]}),a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs("button",{className:"relative text-gray-600 hover:text-gray-800",children:[a.jsx(mx,{className:"text-xl"}),a.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs w-4 h-4 flex items-center justify-center rounded-full",children:"3"})]}),a.jsxs("div",{className:"relative",ref:s,children:[a.jsxs("button",{onClick:()=>n(!t),className:"flex items-center gap-2 cursor-pointer hover:bg-gray-100 px-2 py-1 rounded",children:[a.jsx("img",{src:o?.profile_picture,alt:"",className:"w-8 aspect-square object-cover rounded-full"}),a.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[o?.first_name," ",o?.last_name]})]}),t&&a.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-gray-100 shadow-lg rounded border z-50",children:a.jsxs("div",{className:"flex flex-col",children:[a.jsx("button",{className:"px-4 py-2 text-sm hover:bg-gray-200 text-left",children:"Manage Account"}),a.jsx("div",{className:"border-t my-1"}),a.jsx("button",{onClick:i,className:"px-4 py-2 text-sm bg-red-500 text-white rounded mx-2 my-2 hover:bg-red-600",children:"Logout"})]})})]})]})]})}function x8e(){const[e,t]=f.useState(!1),[n,s]=f.useState(!1),[r,i]=f.useState(!1),[o,l]=f.useState(!1),c=ta(),{fetchUser:u}=Vt();f.useEffect(()=>{u()},[]),f.useEffect(()=>{document.title="Panel | Sari-Sari CRM"},[]);const d="flex items-center gap-3 px-3 py-2 rounded-lg bg-white text-[#1e293b] font-semibold shadow-sm",h="flex items-center gap-3 px-3 py-2 rounded-lg text-gray-300 hover:bg-[#334155] hover:text-white transition",p=["/marketing/campaigns","/marketing/templates"],x=["/marketing/accounts","/marketing/contacts","/marketing/leads"],v=["/marketing/tasks"],j=p.includes(c.pathname),y=x.includes(c.pathname),N=v.includes(c.pathname);return f.useEffect(()=>{j&&t(!0),y&&s(!0),N&&i(!0)},[j,y,N]),a.jsxs("div",{className:"flex h-screen bg-gray-100 overflow-hidden",children:[a.jsxs("div",{className:`fixed top-0 left-0 h-screen w-64 bg-[#1e293b] text-white flex flex-col shadow-lg transform transition-transform duration-300 z-50
          ${o?"translate-x-0":"-translate-x-full"} lg:translate-x-0`,children:[a.jsx("div",{className:"bg-[#fbbf24] text-gray-900 font-bold text-xl px-6 py-4.5 tracking-wide",children:"Marketing CRM"}),a.jsxs("nav",{className:"flex-1 overflow-y-auto p-4 space-y-2",children:[a.jsxs(Ft,{to:"/marketing/dashboard",className:({isActive:w})=>w?d:h,children:[a.jsx(eh,{className:"text-lg"}),a.jsx("span",{children:"Dashboard"})]}),a.jsxs("div",{children:[a.jsxs("button",{className:"w-full px-3 py-2 flex justify-between items-center text-sm font-medium text-gray-300 hover:bg-[#334155] rounded-lg transition",onClick:()=>s(!n),children:[a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx(sa,{className:"text-lg"}),"Sales"]}),a.jsx(Pt,{className:`transition-transform ${n?"rotate-180":""}`})]}),n&&a.jsxs("div",{className:"ml-6 mt-2 space-y-1",children:[a.jsxs(Ft,{to:"/marketing/accounts",className:({isActive:w})=>w?d:h,children:[a.jsx(Za,{})," Accounts"]}),a.jsxs(Ft,{to:"/marketing/contacts",className:({isActive:w})=>w?d:h,children:[a.jsx(ra,{})," Contacts"]}),a.jsxs(Ft,{to:"/marketing/leads",className:({isActive:w})=>w?d:h,children:[a.jsx(Xa,{})," Leads"]})]})]}),a.jsxs("div",{children:[a.jsxs("button",{className:"w-full px-3 py-2 flex justify-between items-center text-sm font-medium text-gray-300 hover:bg-[#334155] rounded-lg transition",onClick:()=>t(!e),children:[a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx(fr,{className:"text-lg"}),"Tools"]}),a.jsx(Pt,{className:`transition-transform ${e?"rotate-180":""}`})]}),e&&a.jsxs("div",{className:"ml-6 mt-2 space-y-1",children:[a.jsxs(Ft,{to:"/marketing/campaigns",className:({isActive:w})=>w?d:h,children:[a.jsx(nk,{})," Campaign"]}),a.jsxs(Ft,{to:"/marketing/templates",className:({isActive:w})=>w?d:h,children:[a.jsx(NL,{})," Templates"]})]})]}),a.jsxs("div",{children:[a.jsxs("button",{className:"w-full px-3 py-2 flex justify-between items-center text-sm font-medium text-gray-300 hover:bg-[#334155] rounded-lg transition",onClick:()=>i(!r),children:[a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx(ks,{className:"text-lg"}),"Activity"]}),a.jsx(Pt,{className:`transition-transform ${r?"rotate-180":""}`})]}),r&&a.jsx("div",{className:"ml-6 mt-2 space-y-1",children:a.jsxs(Ft,{to:"/marketing/tasks",className:({isActive:w})=>w?d:h,children:[a.jsx(Qt,{})," Tasks"]})})]})]}),a.jsxs("div",{className:"px-4 py-3 text-xs text-gray-400 border-t border-gray-700",children:[" ",new Date().getFullYear()," Marketing CRM"]})]}),o&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 lg:hidden",onClick:()=>l(!1)}),a.jsxs("div",{className:"flex-1 flex flex-col lg:ml-64 overflow-hidden",children:[a.jsx(p8e,{toggleSidebar:()=>l(!o)}),a.jsx("main",{className:"flex-1 p-6 overflow-auto",style:{backgroundColor:"#fffeee"},children:a.jsx(Xf,{})})]})]})}function w0(e){return e+.5|0}const sd=(e,t,n)=>Math.max(Math.min(e,n),t);function Jg(e){return sd(w0(e*2.55),0,255)}function ud(e){return sd(w0(e*255),0,255)}function Al(e){return sd(w0(e/2.55)/100,0,1)}function I8(e){return sd(w0(e*100),0,100)}const ci={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},sL=[..."0123456789ABCDEF"],y8e=e=>sL[e&15],b8e=e=>sL[(e&240)>>4]+sL[e&15],Ib=e=>(e&240)>>4===(e&15),v8e=e=>Ib(e.r)&&Ib(e.g)&&Ib(e.b)&&Ib(e.a);function w8e(e){var t=e.length,n;return e[0]==="#"&&(t===4||t===5?n={r:255&ci[e[1]]*17,g:255&ci[e[2]]*17,b:255&ci[e[3]]*17,a:t===5?ci[e[4]]*17:255}:(t===7||t===9)&&(n={r:ci[e[1]]<<4|ci[e[2]],g:ci[e[3]]<<4|ci[e[4]],b:ci[e[5]]<<4|ci[e[6]],a:t===9?ci[e[7]]<<4|ci[e[8]]:255})),n}const j8e=(e,t)=>e<255?t(e):"";function N8e(e){var t=v8e(e)?y8e:b8e;return e?"#"+t(e.r)+t(e.g)+t(e.b)+j8e(e.a,t):void 0}const C8e=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function AJ(e,t,n){const s=t*Math.min(n,1-n),r=(i,o=(i+e/30)%12)=>n-s*Math.max(Math.min(o-3,9-o,1),-1);return[r(0),r(8),r(4)]}function S8e(e,t,n){const s=(r,i=(r+e/60)%6)=>n-n*t*Math.max(Math.min(i,4-i,1),0);return[s(5),s(3),s(1)]}function _8e(e,t,n){const s=AJ(e,1,.5);let r;for(t+n>1&&(r=1/(t+n),t*=r,n*=r),r=0;r<3;r++)s[r]*=1-t-n,s[r]+=t;return s}function A8e(e,t,n,s,r){return e===r?(t-n)/s+(t<n?6:0):t===r?(n-e)/s+2:(e-t)/s+4}function n3(e){const n=e.r/255,s=e.g/255,r=e.b/255,i=Math.max(n,s,r),o=Math.min(n,s,r),l=(i+o)/2;let c,u,d;return i!==o&&(d=i-o,u=l>.5?d/(2-i-o):d/(i+o),c=A8e(n,s,r,d,i),c=c*60+.5),[c|0,u||0,l]}function s3(e,t,n,s){return(Array.isArray(t)?e(t[0],t[1],t[2]):e(t,n,s)).map(ud)}function r3(e,t,n){return s3(AJ,e,t,n)}function T8e(e,t,n){return s3(_8e,e,t,n)}function k8e(e,t,n){return s3(S8e,e,t,n)}function TJ(e){return(e%360+360)%360}function E8e(e){const t=C8e.exec(e);let n=255,s;if(!t)return;t[5]!==s&&(n=t[6]?Jg(+t[5]):ud(+t[5]));const r=TJ(+t[2]),i=+t[3]/100,o=+t[4]/100;return t[1]==="hwb"?s=T8e(r,i,o):t[1]==="hsv"?s=k8e(r,i,o):s=r3(r,i,o),{r:s[0],g:s[1],b:s[2],a:n}}function L8e(e,t){var n=n3(e);n[0]=TJ(n[0]+t),n=r3(n),e.r=n[0],e.g=n[1],e.b=n[2]}function P8e(e){if(!e)return;const t=n3(e),n=t[0],s=I8(t[1]),r=I8(t[2]);return e.a<255?`hsla(${n}, ${s}%, ${r}%, ${Al(e.a)})`:`hsl(${n}, ${s}%, ${r}%)`}const $8={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},R8={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function D8e(){const e={},t=Object.keys(R8),n=Object.keys($8);let s,r,i,o,l;for(s=0;s<t.length;s++){for(o=l=t[s],r=0;r<n.length;r++)i=n[r],l=l.replace(i,$8[i]);i=parseInt(R8[o],16),e[l]=[i>>16&255,i>>8&255,i&255]}return e}let $b;function O8e(e){$b||($b=D8e(),$b.transparent=[0,0,0,0]);const t=$b[e.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:t.length===4?t[3]:255}}const M8e=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function I8e(e){const t=M8e.exec(e);let n=255,s,r,i;if(t){if(t[7]!==s){const o=+t[7];n=t[8]?Jg(o):sd(o*255,0,255)}return s=+t[1],r=+t[3],i=+t[5],s=255&(t[2]?Jg(s):sd(s,0,255)),r=255&(t[4]?Jg(r):sd(r,0,255)),i=255&(t[6]?Jg(i):sd(i,0,255)),{r:s,g:r,b:i,a:n}}}function $8e(e){return e&&(e.a<255?`rgba(${e.r}, ${e.g}, ${e.b}, ${Al(e.a)})`:`rgb(${e.r}, ${e.g}, ${e.b})`)}const fT=e=>e<=.0031308?e*12.92:Math.pow(e,1/2.4)*1.055-.055,nf=e=>e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4);function R8e(e,t,n){const s=nf(Al(e.r)),r=nf(Al(e.g)),i=nf(Al(e.b));return{r:ud(fT(s+n*(nf(Al(t.r))-s))),g:ud(fT(r+n*(nf(Al(t.g))-r))),b:ud(fT(i+n*(nf(Al(t.b))-i))),a:e.a+n*(t.a-e.a)}}function Rb(e,t,n){if(e){let s=n3(e);s[t]=Math.max(0,Math.min(s[t]+s[t]*n,t===0?360:1)),s=r3(s),e.r=s[0],e.g=s[1],e.b=s[2]}}function kJ(e,t){return e&&Object.assign(t||{},e)}function z8(e){var t={r:0,g:0,b:0,a:255};return Array.isArray(e)?e.length>=3&&(t={r:e[0],g:e[1],b:e[2],a:255},e.length>3&&(t.a=ud(e[3]))):(t=kJ(e,{r:0,g:0,b:0,a:1}),t.a=ud(t.a)),t}function z8e(e){return e.charAt(0)==="r"?I8e(e):E8e(e)}class Qp{constructor(t){if(t instanceof Qp)return t;const n=typeof t;let s;n==="object"?s=z8(t):n==="string"&&(s=w8e(t)||O8e(t)||z8e(t)),this._rgb=s,this._valid=!!s}get valid(){return this._valid}get rgb(){var t=kJ(this._rgb);return t&&(t.a=Al(t.a)),t}set rgb(t){this._rgb=z8(t)}rgbString(){return this._valid?$8e(this._rgb):void 0}hexString(){return this._valid?N8e(this._rgb):void 0}hslString(){return this._valid?P8e(this._rgb):void 0}mix(t,n){if(t){const s=this.rgb,r=t.rgb;let i;const o=n===i?.5:n,l=2*o-1,c=s.a-r.a,u=((l*c===-1?l:(l+c)/(1+l*c))+1)/2;i=1-u,s.r=255&u*s.r+i*r.r+.5,s.g=255&u*s.g+i*r.g+.5,s.b=255&u*s.b+i*r.b+.5,s.a=o*s.a+(1-o)*r.a,this.rgb=s}return this}interpolate(t,n){return t&&(this._rgb=R8e(this._rgb,t._rgb,n)),this}clone(){return new Qp(this.rgb)}alpha(t){return this._rgb.a=ud(t),this}clearer(t){const n=this._rgb;return n.a*=1-t,this}greyscale(){const t=this._rgb,n=w0(t.r*.3+t.g*.59+t.b*.11);return t.r=t.g=t.b=n,this}opaquer(t){const n=this._rgb;return n.a*=1+t,this}negate(){const t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return Rb(this._rgb,2,t),this}darken(t){return Rb(this._rgb,2,-t),this}saturate(t){return Rb(this._rgb,1,t),this}desaturate(t){return Rb(this._rgb,1,-t),this}rotate(t){return L8e(this._rgb,t),this}}function jl(){}const F8e=(()=>{let e=0;return()=>e++})();function Pa(e){return e==null}function ss(e){if(Array.isArray&&Array.isArray(e))return!0;const t=Object.prototype.toString.call(e);return t.slice(0,7)==="[object"&&t.slice(-6)==="Array]"}function Ca(e){return e!==null&&Object.prototype.toString.call(e)==="[object Object]"}function Ci(e){return(typeof e=="number"||e instanceof Number)&&isFinite(+e)}function bo(e,t){return Ci(e)?e:t}function ma(e,t){return typeof e>"u"?t:e}const U8e=(e,t)=>typeof e=="string"&&e.endsWith("%")?parseFloat(e)/100:+e/t,EJ=(e,t)=>typeof e=="string"&&e.endsWith("%")?parseFloat(e)/100*t:+e;function nn(e,t,n){if(e&&typeof e.call=="function")return e.apply(n,t)}function $a(e,t,n,s){let r,i,o;if(ss(e))for(i=e.length,r=0;r<i;r++)t.call(n,e[r],r);else if(Ca(e))for(o=Object.keys(e),i=o.length,r=0;r<i;r++)t.call(n,e[o[r]],o[r])}function Kw(e,t){let n,s,r,i;if(!e||!t||e.length!==t.length)return!1;for(n=0,s=e.length;n<s;++n)if(r=e[n],i=t[n],r.datasetIndex!==i.datasetIndex||r.index!==i.index)return!1;return!0}function Xw(e){if(ss(e))return e.map(Xw);if(Ca(e)){const t=Object.create(null),n=Object.keys(e),s=n.length;let r=0;for(;r<s;++r)t[n[r]]=Xw(e[n[r]]);return t}return e}function LJ(e){return["__proto__","prototype","constructor"].indexOf(e)===-1}function B8e(e,t,n,s){if(!LJ(e))return;const r=t[e],i=n[e];Ca(r)&&Ca(i)?Kp(r,i,s):t[e]=Xw(i)}function Kp(e,t,n){const s=ss(t)?t:[t],r=s.length;if(!Ca(e))return e;n=n||{};const i=n.merger||B8e;let o;for(let l=0;l<r;++l){if(o=s[l],!Ca(o))continue;const c=Object.keys(o);for(let u=0,d=c.length;u<d;++u)i(c[u],e,o,n)}return e}function mp(e,t){return Kp(e,t,{merger:H8e})}function H8e(e,t,n){if(!LJ(e))return;const s=t[e],r=n[e];Ca(s)&&Ca(r)?mp(s,r):Object.prototype.hasOwnProperty.call(t,e)||(t[e]=Xw(r))}const F8={"":e=>e,x:e=>e.x,y:e=>e.y};function q8e(e){const t=e.split("."),n=[];let s="";for(const r of t)s+=r,s.endsWith("\\")?s=s.slice(0,-1)+".":(n.push(s),s="");return n}function G8e(e){const t=q8e(e);return n=>{for(const s of t){if(s==="")break;n=n&&n[s]}return n}}function Yu(e,t){return(F8[t]||(F8[t]=G8e(t)))(e)}function i3(e){return e.charAt(0).toUpperCase()+e.slice(1)}const Xp=e=>typeof e<"u",Cd=e=>typeof e=="function",U8=(e,t)=>{if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0};function W8e(e){return e.type==="mouseup"||e.type==="click"||e.type==="contextmenu"}const za=Math.PI,_n=2*za,V8e=_n+za,Zw=Number.POSITIVE_INFINITY,Y8e=za/180,rs=za/2,Xd=za/4,B8=za*2/3,PJ=Math.log10,Fo=Math.sign;function fp(e,t,n){return Math.abs(e-t)<n}function H8(e){const t=Math.round(e);e=fp(e,t,e/1e3)?t:e;const n=Math.pow(10,Math.floor(PJ(e))),s=e/n;return(s<=1?1:s<=2?2:s<=5?5:10)*n}function Q8e(e){const t=[],n=Math.sqrt(e);let s;for(s=1;s<n;s++)e%s===0&&(t.push(s),t.push(e/s));return n===(n|0)&&t.push(n),t.sort((r,i)=>r-i).pop(),t}function K8e(e){return typeof e=="symbol"||typeof e=="object"&&e!==null&&!(Symbol.toPrimitive in e||"toString"in e||"valueOf"in e)}function Zp(e){return!K8e(e)&&!isNaN(parseFloat(e))&&isFinite(e)}function X8e(e,t){const n=Math.round(e);return n-t<=e&&n+t>=e}function Z8e(e,t,n){let s,r,i;for(s=0,r=e.length;s<r;s++)i=e[s][n],isNaN(i)||(t.min=Math.min(t.min,i),t.max=Math.max(t.max,i))}function Dl(e){return e*(za/180)}function J8e(e){return e*(180/za)}function q8(e){if(!Ci(e))return;let t=1,n=0;for(;Math.round(e*t)/t!==e;)t*=10,n++;return n}function DJ(e,t){const n=t.x-e.x,s=t.y-e.y,r=Math.sqrt(n*n+s*s);let i=Math.atan2(s,n);return i<-.5*za&&(i+=_n),{angle:i,distance:r}}function rL(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function eBe(e,t){return(e-t+V8e)%_n-za}function Ui(e){return(e%_n+_n)%_n}function Jp(e,t,n,s){const r=Ui(e),i=Ui(t),o=Ui(n),l=Ui(i-r),c=Ui(o-r),u=Ui(r-i),d=Ui(r-o);return r===i||r===o||s&&i===o||l>c&&u<d}function Is(e,t,n){return Math.max(t,Math.min(n,e))}function tBe(e){return Is(e,-32768,32767)}function rd(e,t,n,s=1e-6){return e>=Math.min(t,n)-s&&e<=Math.max(t,n)+s}function o3(e,t,n){n=n||(o=>e[o]<t);let s=e.length-1,r=0,i;for(;s-r>1;)i=r+s>>1,n(i)?r=i:s=i;return{lo:r,hi:s}}const bu=(e,t,n,s)=>o3(e,n,s?r=>{const i=e[r][t];return i<n||i===n&&e[r+1][t]===n}:r=>e[r][t]<n),aBe=(e,t,n)=>o3(e,n,s=>e[s][t]>=n);function nBe(e,t,n){let s=0,r=e.length;for(;s<r&&e[s]<t;)s++;for(;r>s&&e[r-1]>n;)r--;return s>0||r<e.length?e.slice(s,r):e}const OJ=["push","pop","shift","splice","unshift"];function sBe(e,t){if(e._chartjs){e._chartjs.listeners.push(t);return}Object.defineProperty(e,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[t]}}),OJ.forEach(n=>{const s="_onData"+i3(n),r=e[n];Object.defineProperty(e,n,{configurable:!0,enumerable:!1,value(...i){const o=r.apply(this,i);return e._chartjs.listeners.forEach(l=>{typeof l[s]=="function"&&l[s](...i)}),o}})})}function G8(e,t){const n=e._chartjs;if(!n)return;const s=n.listeners,r=s.indexOf(t);r!==-1&&s.splice(r,1),!(s.length>0)&&(OJ.forEach(i=>{delete e[i]}),delete e._chartjs)}function MJ(e){const t=new Set(e);return t.size===e.length?e:Array.from(t)}const IJ=(function(){return typeof window>"u"?function(e){return e()}:window.requestAnimationFrame})();function $J(e,t){let n=[],s=!1;return function(...r){n=r,s||(s=!0,IJ.call(window,()=>{s=!1,e.apply(t,n)}))}}function rBe(e,t){let n;return function(...s){return t?(clearTimeout(n),n=setTimeout(e,t,s)):e.apply(this,s),t}}const l3=e=>e==="start"?"left":e==="end"?"right":"center",Ps=(e,t,n)=>e==="start"?t:e==="end"?n:(t+n)/2,iBe=(e,t,n,s)=>e===(s?"left":"right")?n:e==="center"?(t+n)/2:t;function oBe(e,t,n){const s=t.length;let r=0,i=s;if(e._sorted){const{iScale:o,vScale:l,_parsed:c}=e,u=e.dataset&&e.dataset.options?e.dataset.options.spanGaps:null,d=o.axis,{min:h,max:p,minDefined:x,maxDefined:v}=o.getUserBounds();if(x){if(r=Math.min(bu(c,d,h).lo,n?s:bu(t,d,o.getPixelForValue(h)).lo),u){const j=c.slice(0,r+1).reverse().findIndex(y=>!Pa(y[l.axis]));r-=Math.max(0,j)}r=Is(r,0,s-1)}if(v){let j=Math.max(bu(c,o.axis,p,!0).hi+1,n?0:bu(t,d,o.getPixelForValue(p),!0).hi+1);if(u){const y=c.slice(j-1).findIndex(N=>!Pa(N[l.axis]));j+=Math.max(0,y)}i=Is(j,r,s)-r}else i=s-r}return{start:r,count:i}}function lBe(e){const{xScale:t,yScale:n,_scaleRanges:s}=e,r={xmin:t.min,xmax:t.max,ymin:n.min,ymax:n.max};if(!s)return e._scaleRanges=r,!0;const i=s.xmin!==t.min||s.xmax!==t.max||s.ymin!==n.min||s.ymax!==n.max;return Object.assign(s,r),i}const zb=e=>e===0||e===1,W8=(e,t,n)=>-(Math.pow(2,10*(e-=1))*Math.sin((e-t)*_n/n)),V8=(e,t,n)=>Math.pow(2,-10*e)*Math.sin((e-t)*_n/n)+1,hp={linear:e=>e,easeInQuad:e=>e*e,easeOutQuad:e=>-e*(e-2),easeInOutQuad:e=>(e/=.5)<1?.5*e*e:-.5*(--e*(e-2)-1),easeInCubic:e=>e*e*e,easeOutCubic:e=>(e-=1)*e*e+1,easeInOutCubic:e=>(e/=.5)<1?.5*e*e*e:.5*((e-=2)*e*e+2),easeInQuart:e=>e*e*e*e,easeOutQuart:e=>-((e-=1)*e*e*e-1),easeInOutQuart:e=>(e/=.5)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2),easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>(e-=1)*e*e*e*e+1,easeInOutQuint:e=>(e/=.5)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2),easeInSine:e=>-Math.cos(e*rs)+1,easeOutSine:e=>Math.sin(e*rs),easeInOutSine:e=>-.5*(Math.cos(za*e)-1),easeInExpo:e=>e===0?0:Math.pow(2,10*(e-1)),easeOutExpo:e=>e===1?1:-Math.pow(2,-10*e)+1,easeInOutExpo:e=>zb(e)?e:e<.5?.5*Math.pow(2,10*(e*2-1)):.5*(-Math.pow(2,-10*(e*2-1))+2),easeInCirc:e=>e>=1?e:-(Math.sqrt(1-e*e)-1),easeOutCirc:e=>Math.sqrt(1-(e-=1)*e),easeInOutCirc:e=>(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1),easeInElastic:e=>zb(e)?e:W8(e,.075,.3),easeOutElastic:e=>zb(e)?e:V8(e,.075,.3),easeInOutElastic(e){return zb(e)?e:e<.5?.5*W8(e*2,.1125,.45):.5+.5*V8(e*2-1,.1125,.45)},easeInBack(e){return e*e*((1.70158+1)*e-1.70158)},easeOutBack(e){return(e-=1)*e*((1.70158+1)*e+1.70158)+1},easeInOutBack(e){let t=1.70158;return(e/=.5)<1?.5*(e*e*(((t*=1.525)+1)*e-t)):.5*((e-=2)*e*(((t*=1.525)+1)*e+t)+2)},easeInBounce:e=>1-hp.easeOutBounce(1-e),easeOutBounce(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},easeInOutBounce:e=>e<.5?hp.easeInBounce(e*2)*.5:hp.easeOutBounce(e*2-1)*.5+.5};function c3(e){if(e&&typeof e=="object"){const t=e.toString();return t==="[object CanvasPattern]"||t==="[object CanvasGradient]"}return!1}function Y8(e){return c3(e)?e:new Qp(e)}function hT(e){return c3(e)?e:new Qp(e).saturate(.5).darken(.1).hexString()}const cBe=["x","y","borderWidth","radius","tension"],dBe=["color","borderColor","backgroundColor"];function uBe(e){e.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),e.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>t!=="onProgress"&&t!=="onComplete"&&t!=="fn"}),e.set("animations",{colors:{type:"color",properties:dBe},numbers:{type:"number",properties:cBe}}),e.describe("animations",{_fallback:"animation"}),e.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>t|0}}}})}function mBe(e){e.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const Q8=new Map;function fBe(e,t){t=t||{};const n=e+JSON.stringify(t);let s=Q8.get(n);return s||(s=new Intl.NumberFormat(e,t),Q8.set(n,s)),s}function d3(e,t,n){return fBe(t,n).format(e)}const hBe={values(e){return ss(e)?e:""+e},numeric(e,t,n){if(e===0)return"0";const s=this.chart.options.locale;let r,i=e;if(n.length>1){const u=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(u<1e-4||u>1e15)&&(r="scientific"),i=gBe(e,n)}const o=PJ(Math.abs(i)),l=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),c={notation:r,minimumFractionDigits:l,maximumFractionDigits:l};return Object.assign(c,this.options.ticks.format),d3(e,s,c)}};function gBe(e,t){let n=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;return Math.abs(n)>=1&&e!==Math.floor(e)&&(n=e-Math.floor(e)),n}var RJ={formatters:hBe};function pBe(e){e.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,n)=>n.lineWidth,tickColor:(t,n)=>n.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:RJ.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),e.route("scale.ticks","color","","color"),e.route("scale.grid","color","","borderColor"),e.route("scale.border","color","","borderColor"),e.route("scale.title","color","","color"),e.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&t!=="callback"&&t!=="parser",_indexable:t=>t!=="borderDash"&&t!=="tickBorderDash"&&t!=="dash"}),e.describe("scales",{_fallback:"scale"}),e.describe("scale.ticks",{_scriptable:t=>t!=="backdropPadding"&&t!=="callback",_indexable:t=>t!=="backdropPadding"})}const Qu=Object.create(null),iL=Object.create(null);function gp(e,t){if(!t)return e;const n=t.split(".");for(let s=0,r=n.length;s<r;++s){const i=n[s];e=e[i]||(e[i]=Object.create(null))}return e}function gT(e,t,n){return typeof t=="string"?Kp(gp(e,t),n):Kp(gp(e,""),t)}class xBe{constructor(t,n){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=s=>s.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(s,r)=>hT(r.backgroundColor),this.hoverBorderColor=(s,r)=>hT(r.borderColor),this.hoverColor=(s,r)=>hT(r.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t),this.apply(n)}set(t,n){return gT(this,t,n)}get(t){return gp(this,t)}describe(t,n){return gT(iL,t,n)}override(t,n){return gT(Qu,t,n)}route(t,n,s,r){const i=gp(this,t),o=gp(this,s),l="_"+n;Object.defineProperties(i,{[l]:{value:i[n],writable:!0},[n]:{enumerable:!0,get(){const c=this[l],u=o[r];return Ca(c)?Object.assign({},u,c):ma(c,u)},set(c){this[l]=c}}})}apply(t){t.forEach(n=>n(this))}}var On=new xBe({_scriptable:e=>!e.startsWith("on"),_indexable:e=>e!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[uBe,mBe,pBe]);function yBe(e){return!e||Pa(e.size)||Pa(e.family)?null:(e.style?e.style+" ":"")+(e.weight?e.weight+" ":"")+e.size+"px "+e.family}function K8(e,t,n,s,r){let i=t[r];return i||(i=t[r]=e.measureText(r).width,n.push(r)),i>s&&(s=i),s}function Zd(e,t,n){const s=e.currentDevicePixelRatio,r=n!==0?Math.max(n/2,.5):0;return Math.round((t-r)*s)/s+r}function X8(e,t){!t&&!e||(t=t||e.getContext("2d"),t.save(),t.resetTransform(),t.clearRect(0,0,e.width,e.height),t.restore())}function oL(e,t,n,s){zJ(e,t,n,s,null)}function zJ(e,t,n,s,r){let i,o,l,c,u,d,h,p;const x=t.pointStyle,v=t.rotation,j=t.radius;let y=(v||0)*Y8e;if(x&&typeof x=="object"&&(i=x.toString(),i==="[object HTMLImageElement]"||i==="[object HTMLCanvasElement]")){e.save(),e.translate(n,s),e.rotate(y),e.drawImage(x,-x.width/2,-x.height/2,x.width,x.height),e.restore();return}if(!(isNaN(j)||j<=0)){switch(e.beginPath(),x){default:r?e.ellipse(n,s,r/2,j,0,0,_n):e.arc(n,s,j,0,_n),e.closePath();break;case"triangle":d=r?r/2:j,e.moveTo(n+Math.sin(y)*d,s-Math.cos(y)*j),y+=B8,e.lineTo(n+Math.sin(y)*d,s-Math.cos(y)*j),y+=B8,e.lineTo(n+Math.sin(y)*d,s-Math.cos(y)*j),e.closePath();break;case"rectRounded":u=j*.516,c=j-u,o=Math.cos(y+Xd)*c,h=Math.cos(y+Xd)*(r?r/2-u:c),l=Math.sin(y+Xd)*c,p=Math.sin(y+Xd)*(r?r/2-u:c),e.arc(n-h,s-l,u,y-za,y-rs),e.arc(n+p,s-o,u,y-rs,y),e.arc(n+h,s+l,u,y,y+rs),e.arc(n-p,s+o,u,y+rs,y+za),e.closePath();break;case"rect":if(!v){c=Math.SQRT1_2*j,d=r?r/2:c,e.rect(n-d,s-c,2*d,2*c);break}y+=Xd;case"rectRot":h=Math.cos(y)*(r?r/2:j),o=Math.cos(y)*j,l=Math.sin(y)*j,p=Math.sin(y)*(r?r/2:j),e.moveTo(n-h,s-l),e.lineTo(n+p,s-o),e.lineTo(n+h,s+l),e.lineTo(n-p,s+o),e.closePath();break;case"crossRot":y+=Xd;case"cross":h=Math.cos(y)*(r?r/2:j),o=Math.cos(y)*j,l=Math.sin(y)*j,p=Math.sin(y)*(r?r/2:j),e.moveTo(n-h,s-l),e.lineTo(n+h,s+l),e.moveTo(n+p,s-o),e.lineTo(n-p,s+o);break;case"star":h=Math.cos(y)*(r?r/2:j),o=Math.cos(y)*j,l=Math.sin(y)*j,p=Math.sin(y)*(r?r/2:j),e.moveTo(n-h,s-l),e.lineTo(n+h,s+l),e.moveTo(n+p,s-o),e.lineTo(n-p,s+o),y+=Xd,h=Math.cos(y)*(r?r/2:j),o=Math.cos(y)*j,l=Math.sin(y)*j,p=Math.sin(y)*(r?r/2:j),e.moveTo(n-h,s-l),e.lineTo(n+h,s+l),e.moveTo(n+p,s-o),e.lineTo(n-p,s+o);break;case"line":o=r?r/2:Math.cos(y)*j,l=Math.sin(y)*j,e.moveTo(n-o,s-l),e.lineTo(n+o,s+l);break;case"dash":e.moveTo(n,s),e.lineTo(n+Math.cos(y)*(r?r/2:j),s+Math.sin(y)*j);break;case!1:e.closePath();break}e.fill(),t.borderWidth>0&&e.stroke()}}function ex(e,t,n){return n=n||.5,!t||e&&e.x>t.left-n&&e.x<t.right+n&&e.y>t.top-n&&e.y<t.bottom+n}function u3(e,t){e.save(),e.beginPath(),e.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),e.clip()}function m3(e){e.restore()}function bBe(e,t,n,s,r){if(!t)return e.lineTo(n.x,n.y);if(r==="middle"){const i=(t.x+n.x)/2;e.lineTo(i,t.y),e.lineTo(i,n.y)}else r==="after"!=!!s?e.lineTo(t.x,n.y):e.lineTo(n.x,t.y);e.lineTo(n.x,n.y)}function vBe(e,t,n,s){if(!t)return e.lineTo(n.x,n.y);e.bezierCurveTo(s?t.cp1x:t.cp2x,s?t.cp1y:t.cp2y,s?n.cp2x:n.cp1x,s?n.cp2y:n.cp1y,n.x,n.y)}function wBe(e,t){t.translation&&e.translate(t.translation[0],t.translation[1]),Pa(t.rotation)||e.rotate(t.rotation),t.color&&(e.fillStyle=t.color),t.textAlign&&(e.textAlign=t.textAlign),t.textBaseline&&(e.textBaseline=t.textBaseline)}function jBe(e,t,n,s,r){if(r.strikethrough||r.underline){const i=e.measureText(s),o=t-i.actualBoundingBoxLeft,l=t+i.actualBoundingBoxRight,c=n-i.actualBoundingBoxAscent,u=n+i.actualBoundingBoxDescent,d=r.strikethrough?(c+u)/2:u;e.strokeStyle=e.fillStyle,e.beginPath(),e.lineWidth=r.decorationWidth||2,e.moveTo(o,d),e.lineTo(l,d),e.stroke()}}function NBe(e,t){const n=e.fillStyle;e.fillStyle=t.color,e.fillRect(t.left,t.top,t.width,t.height),e.fillStyle=n}function tx(e,t,n,s,r,i={}){const o=ss(t)?t:[t],l=i.strokeWidth>0&&i.strokeColor!=="";let c,u;for(e.save(),e.font=r.string,wBe(e,i),c=0;c<o.length;++c)u=o[c],i.backdrop&&NBe(e,i.backdrop),l&&(i.strokeColor&&(e.strokeStyle=i.strokeColor),Pa(i.strokeWidth)||(e.lineWidth=i.strokeWidth),e.strokeText(u,n,s,i.maxWidth)),e.fillText(u,n,s,i.maxWidth),jBe(e,n,s,u,i),s+=Number(r.lineHeight);e.restore()}function Jw(e,t){const{x:n,y:s,w:r,h:i,radius:o}=t;e.arc(n+o.topLeft,s+o.topLeft,o.topLeft,1.5*za,za,!0),e.lineTo(n,s+i-o.bottomLeft),e.arc(n+o.bottomLeft,s+i-o.bottomLeft,o.bottomLeft,za,rs,!0),e.lineTo(n+r-o.bottomRight,s+i),e.arc(n+r-o.bottomRight,s+i-o.bottomRight,o.bottomRight,rs,0,!0),e.lineTo(n+r,s+o.topRight),e.arc(n+r-o.topRight,s+o.topRight,o.topRight,0,-rs,!0),e.lineTo(n+o.topLeft,s)}const CBe=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,SBe=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function _Be(e,t){const n=(""+e).match(CBe);if(!n||n[1]==="normal")return t*1.2;switch(e=+n[2],n[3]){case"px":return e;case"%":e/=100;break}return t*e}const ABe=e=>+e||0;function f3(e,t){const n={},s=Ca(t),r=s?Object.keys(t):t,i=Ca(e)?s?o=>ma(e[o],e[t[o]]):o=>e[o]:()=>e;for(const o of r)n[o]=ABe(i(o));return n}function FJ(e){return f3(e,{top:"y",right:"x",bottom:"y",left:"x"})}function Cf(e){return f3(e,["topLeft","topRight","bottomLeft","bottomRight"])}function Si(e){const t=FJ(e);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function $s(e,t){e=e||{},t=t||On.font;let n=ma(e.size,t.size);typeof n=="string"&&(n=parseInt(n,10));let s=ma(e.style,t.style);s&&!(""+s).match(SBe)&&(console.warn('Invalid font style specified: "'+s+'"'),s=void 0);const r={family:ma(e.family,t.family),lineHeight:_Be(ma(e.lineHeight,t.lineHeight),n),size:n,style:s,weight:ma(e.weight,t.weight),string:""};return r.string=yBe(r),r}function Fb(e,t,n,s){let r,i,o;for(r=0,i=e.length;r<i;++r)if(o=e[r],o!==void 0&&o!==void 0)return o}function TBe(e,t,n){const{min:s,max:r}=e,i=EJ(t,(r-s)/2),o=(l,c)=>n&&l===0?0:l+c;return{min:o(s,-Math.abs(i)),max:o(r,i)}}function lm(e,t){return Object.assign(Object.create(e),t)}function h3(e,t=[""],n,s,r=()=>e[0]){const i=n||e;typeof s>"u"&&(s=qJ("_fallback",e));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:e,_rootScopes:i,_fallback:s,_getTarget:r,override:l=>h3([l,...e],t,i,s)};return new Proxy(o,{deleteProperty(l,c){return delete l[c],delete l._keys,delete e[0][c],!0},get(l,c){return BJ(l,c,()=>IBe(c,t,e,l))},getOwnPropertyDescriptor(l,c){return Reflect.getOwnPropertyDescriptor(l._scopes[0],c)},getPrototypeOf(){return Reflect.getPrototypeOf(e[0])},has(l,c){return J8(l).includes(c)},ownKeys(l){return J8(l)},set(l,c,u){const d=l._storage||(l._storage=r());return l[c]=d[c]=u,delete l._keys,!0}})}function Gf(e,t,n,s){const r={_cacheable:!1,_proxy:e,_context:t,_subProxy:n,_stack:new Set,_descriptors:UJ(e,s),setContext:i=>Gf(e,i,n,s),override:i=>Gf(e.override(i),t,n,s)};return new Proxy(r,{deleteProperty(i,o){return delete i[o],delete e[o],!0},get(i,o,l){return BJ(i,o,()=>EBe(i,o,l))},getOwnPropertyDescriptor(i,o){return i._descriptors.allKeys?Reflect.has(e,o)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(e,o)},getPrototypeOf(){return Reflect.getPrototypeOf(e)},has(i,o){return Reflect.has(e,o)},ownKeys(){return Reflect.ownKeys(e)},set(i,o,l){return e[o]=l,delete i[o],!0}})}function UJ(e,t={scriptable:!0,indexable:!0}){const{_scriptable:n=t.scriptable,_indexable:s=t.indexable,_allKeys:r=t.allKeys}=e;return{allKeys:r,scriptable:n,indexable:s,isScriptable:Cd(n)?n:()=>n,isIndexable:Cd(s)?s:()=>s}}const kBe=(e,t)=>e?e+i3(t):t,g3=(e,t)=>Ca(t)&&e!=="adapters"&&(Object.getPrototypeOf(t)===null||t.constructor===Object);function BJ(e,t,n){if(Object.prototype.hasOwnProperty.call(e,t)||t==="constructor")return e[t];const s=n();return e[t]=s,s}function EBe(e,t,n){const{_proxy:s,_context:r,_subProxy:i,_descriptors:o}=e;let l=s[t];return Cd(l)&&o.isScriptable(t)&&(l=LBe(t,l,e,n)),ss(l)&&l.length&&(l=PBe(t,l,e,o.isIndexable)),g3(t,l)&&(l=Gf(l,r,i&&i[t],o)),l}function LBe(e,t,n,s){const{_proxy:r,_context:i,_subProxy:o,_stack:l}=n;if(l.has(e))throw new Error("Recursion detected: "+Array.from(l).join("->")+"->"+e);l.add(e);let c=t(i,o||s);return l.delete(e),g3(e,c)&&(c=p3(r._scopes,r,e,c)),c}function PBe(e,t,n,s){const{_proxy:r,_context:i,_subProxy:o,_descriptors:l}=n;if(typeof i.index<"u"&&s(e))return t[i.index%t.length];if(Ca(t[0])){const c=t,u=r._scopes.filter(d=>d!==c);t=[];for(const d of c){const h=p3(u,r,e,d);t.push(Gf(h,i,o&&o[e],l))}}return t}function HJ(e,t,n){return Cd(e)?e(t,n):e}const DBe=(e,t)=>e===!0?t:typeof e=="string"?Yu(t,e):void 0;function OBe(e,t,n,s,r){for(const i of t){const o=DBe(n,i);if(o){e.add(o);const l=HJ(o._fallback,n,r);if(typeof l<"u"&&l!==n&&l!==s)return l}else if(o===!1&&typeof s<"u"&&n!==s)return null}return!1}function p3(e,t,n,s){const r=t._rootScopes,i=HJ(t._fallback,n,s),o=[...e,...r],l=new Set;l.add(s);let c=Z8(l,o,n,i||n,s);return c===null||typeof i<"u"&&i!==n&&(c=Z8(l,o,i,c,s),c===null)?!1:h3(Array.from(l),[""],r,i,()=>MBe(t,n,s))}function Z8(e,t,n,s,r){for(;n;)n=OBe(e,t,n,s,r);return n}function MBe(e,t,n){const s=e._getTarget();t in s||(s[t]={});const r=s[t];return ss(r)&&Ca(n)?n:r||{}}function IBe(e,t,n,s){let r;for(const i of t)if(r=qJ(kBe(i,e),n),typeof r<"u")return g3(e,r)?p3(n,s,e,r):r}function qJ(e,t){for(const n of t){if(!n)continue;const s=n[e];if(typeof s<"u")return s}}function J8(e){let t=e._keys;return t||(t=e._keys=$Be(e._scopes)),t}function $Be(e){const t=new Set;for(const n of e)for(const s of Object.keys(n).filter(r=>!r.startsWith("_")))t.add(s);return Array.from(t)}const RBe=Number.EPSILON||1e-14,Wf=(e,t)=>t<e.length&&!e[t].skip&&e[t],GJ=e=>e==="x"?"y":"x";function zBe(e,t,n,s){const r=e.skip?t:e,i=t,o=n.skip?t:n,l=rL(i,r),c=rL(o,i);let u=l/(l+c),d=c/(l+c);u=isNaN(u)?0:u,d=isNaN(d)?0:d;const h=s*u,p=s*d;return{previous:{x:i.x-h*(o.x-r.x),y:i.y-h*(o.y-r.y)},next:{x:i.x+p*(o.x-r.x),y:i.y+p*(o.y-r.y)}}}function FBe(e,t,n){const s=e.length;let r,i,o,l,c,u=Wf(e,0);for(let d=0;d<s-1;++d)if(c=u,u=Wf(e,d+1),!(!c||!u)){if(fp(t[d],0,RBe)){n[d]=n[d+1]=0;continue}r=n[d]/t[d],i=n[d+1]/t[d],l=Math.pow(r,2)+Math.pow(i,2),!(l<=9)&&(o=3/Math.sqrt(l),n[d]=r*o*t[d],n[d+1]=i*o*t[d])}}function UBe(e,t,n="x"){const s=GJ(n),r=e.length;let i,o,l,c=Wf(e,0);for(let u=0;u<r;++u){if(o=l,l=c,c=Wf(e,u+1),!l)continue;const d=l[n],h=l[s];o&&(i=(d-o[n])/3,l[`cp1${n}`]=d-i,l[`cp1${s}`]=h-i*t[u]),c&&(i=(c[n]-d)/3,l[`cp2${n}`]=d+i,l[`cp2${s}`]=h+i*t[u])}}function BBe(e,t="x"){const n=GJ(t),s=e.length,r=Array(s).fill(0),i=Array(s);let o,l,c,u=Wf(e,0);for(o=0;o<s;++o)if(l=c,c=u,u=Wf(e,o+1),!!c){if(u){const d=u[t]-c[t];r[o]=d!==0?(u[n]-c[n])/d:0}i[o]=l?u?Fo(r[o-1])!==Fo(r[o])?0:(r[o-1]+r[o])/2:r[o-1]:r[o]}FBe(e,r,i),UBe(e,i,t)}function Ub(e,t,n){return Math.max(Math.min(e,n),t)}function HBe(e,t){let n,s,r,i,o,l=ex(e[0],t);for(n=0,s=e.length;n<s;++n)o=i,i=l,l=n<s-1&&ex(e[n+1],t),i&&(r=e[n],o&&(r.cp1x=Ub(r.cp1x,t.left,t.right),r.cp1y=Ub(r.cp1y,t.top,t.bottom)),l&&(r.cp2x=Ub(r.cp2x,t.left,t.right),r.cp2y=Ub(r.cp2y,t.top,t.bottom)))}function qBe(e,t,n,s,r){let i,o,l,c;if(t.spanGaps&&(e=e.filter(u=>!u.skip)),t.cubicInterpolationMode==="monotone")BBe(e,r);else{let u=s?e[e.length-1]:e[0];for(i=0,o=e.length;i<o;++i)l=e[i],c=zBe(u,l,e[Math.min(i+1,o-(s?0:1))%o],t.tension),l.cp1x=c.previous.x,l.cp1y=c.previous.y,l.cp2x=c.next.x,l.cp2y=c.next.y,u=l}t.capBezierPoints&&HBe(e,n)}function x3(){return typeof window<"u"&&typeof document<"u"}function y3(e){let t=e.parentNode;return t&&t.toString()==="[object ShadowRoot]"&&(t=t.host),t}function ej(e,t,n){let s;return typeof e=="string"?(s=parseInt(e,10),e.indexOf("%")!==-1&&(s=s/100*t.parentNode[n])):s=e,s}const L1=e=>e.ownerDocument.defaultView.getComputedStyle(e,null);function GBe(e,t){return L1(e).getPropertyValue(t)}const WBe=["top","right","bottom","left"];function Tu(e,t,n){const s={};n=n?"-"+n:"";for(let r=0;r<4;r++){const i=WBe[r];s[i]=parseFloat(e[t+"-"+i+n])||0}return s.width=s.left+s.right,s.height=s.top+s.bottom,s}const VBe=(e,t,n)=>(e>0||t>0)&&(!n||!n.shadowRoot);function YBe(e,t){const n=e.touches,s=n&&n.length?n[0]:e,{offsetX:r,offsetY:i}=s;let o=!1,l,c;if(VBe(r,i,e.target))l=r,c=i;else{const u=t.getBoundingClientRect();l=s.clientX-u.left,c=s.clientY-u.top,o=!0}return{x:l,y:c,box:o}}function iu(e,t){if("native"in e)return e;const{canvas:n,currentDevicePixelRatio:s}=t,r=L1(n),i=r.boxSizing==="border-box",o=Tu(r,"padding"),l=Tu(r,"border","width"),{x:c,y:u,box:d}=YBe(e,n),h=o.left+(d&&l.left),p=o.top+(d&&l.top);let{width:x,height:v}=t;return i&&(x-=o.width+l.width,v-=o.height+l.height),{x:Math.round((c-h)/x*n.width/s),y:Math.round((u-p)/v*n.height/s)}}function QBe(e,t,n){let s,r;if(t===void 0||n===void 0){const i=e&&y3(e);if(!i)t=e.clientWidth,n=e.clientHeight;else{const o=i.getBoundingClientRect(),l=L1(i),c=Tu(l,"border","width"),u=Tu(l,"padding");t=o.width-u.width-c.width,n=o.height-u.height-c.height,s=ej(l.maxWidth,i,"clientWidth"),r=ej(l.maxHeight,i,"clientHeight")}}return{width:t,height:n,maxWidth:s||Zw,maxHeight:r||Zw}}const id=e=>Math.round(e*10)/10;function KBe(e,t,n,s){const r=L1(e),i=Tu(r,"margin"),o=ej(r.maxWidth,e,"clientWidth")||Zw,l=ej(r.maxHeight,e,"clientHeight")||Zw,c=QBe(e,t,n);let{width:u,height:d}=c;if(r.boxSizing==="content-box"){const p=Tu(r,"border","width"),x=Tu(r,"padding");u-=x.width+p.width,d-=x.height+p.height}return u=Math.max(0,u-i.width),d=Math.max(0,s?u/s:d-i.height),u=id(Math.min(u,o,c.maxWidth)),d=id(Math.min(d,l,c.maxHeight)),u&&!d&&(d=id(u/2)),(t!==void 0||n!==void 0)&&s&&c.height&&d>c.height&&(d=c.height,u=id(Math.floor(d*s))),{width:u,height:d}}function eB(e,t,n){const s=t||1,r=id(e.height*s),i=id(e.width*s);e.height=id(e.height),e.width=id(e.width);const o=e.canvas;return o.style&&(n||!o.style.height&&!o.style.width)&&(o.style.height=`${e.height}px`,o.style.width=`${e.width}px`),e.currentDevicePixelRatio!==s||o.height!==r||o.width!==i?(e.currentDevicePixelRatio=s,o.height=r,o.width=i,e.ctx.setTransform(s,0,0,s,0,0),!0):!1}const XBe=(function(){let e=!1;try{const t={get passive(){return e=!0,!1}};x3()&&(window.addEventListener("test",null,t),window.removeEventListener("test",null,t))}catch{}return e})();function tB(e,t){const n=GBe(e,t),s=n&&n.match(/^(\d+)(\.\d+)?px$/);return s?+s[1]:void 0}function ou(e,t,n,s){return{x:e.x+n*(t.x-e.x),y:e.y+n*(t.y-e.y)}}function ZBe(e,t,n,s){return{x:e.x+n*(t.x-e.x),y:s==="middle"?n<.5?e.y:t.y:s==="after"?n<1?e.y:t.y:n>0?t.y:e.y}}function JBe(e,t,n,s){const r={x:e.cp2x,y:e.cp2y},i={x:t.cp1x,y:t.cp1y},o=ou(e,r,n),l=ou(r,i,n),c=ou(i,t,n),u=ou(o,l,n),d=ou(l,c,n);return ou(u,d,n)}const eHe=function(e,t){return{x(n){return e+e+t-n},setWidth(n){t=n},textAlign(n){return n==="center"?n:n==="right"?"left":"right"},xPlus(n,s){return n-s},leftForLtr(n,s){return n-s}}},tHe=function(){return{x(e){return e},setWidth(e){},textAlign(e){return e},xPlus(e,t){return e+t},leftForLtr(e,t){return e}}};function Sf(e,t,n){return e?eHe(t,n):tHe()}function WJ(e,t){let n,s;(t==="ltr"||t==="rtl")&&(n=e.canvas.style,s=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",t,"important"),e.prevTextDirection=s)}function VJ(e,t){t!==void 0&&(delete e.prevTextDirection,e.canvas.style.setProperty("direction",t[0],t[1]))}function YJ(e){return e==="angle"?{between:Jp,compare:eBe,normalize:Ui}:{between:rd,compare:(t,n)=>t-n,normalize:t=>t}}function aB({start:e,end:t,count:n,loop:s,style:r}){return{start:e%n,end:t%n,loop:s&&(t-e+1)%n===0,style:r}}function aHe(e,t,n){const{property:s,start:r,end:i}=n,{between:o,normalize:l}=YJ(s),c=t.length;let{start:u,end:d,loop:h}=e,p,x;if(h){for(u+=c,d+=c,p=0,x=c;p<x&&o(l(t[u%c][s]),r,i);++p)u--,d--;u%=c,d%=c}return d<u&&(d+=c),{start:u,end:d,loop:h,style:e.style}}function nHe(e,t,n){if(!n)return[e];const{property:s,start:r,end:i}=n,o=t.length,{compare:l,between:c,normalize:u}=YJ(s),{start:d,end:h,loop:p,style:x}=aHe(e,t,n),v=[];let j=!1,y=null,N,w,S;const _=()=>c(r,S,N)&&l(r,S)!==0,k=()=>l(i,N)===0||c(i,S,N),T=()=>j||_(),A=()=>!j||k();for(let E=d,M=d;E<=h;++E)w=t[E%o],!w.skip&&(N=u(w[s]),N!==S&&(j=c(N,r,i),y===null&&T()&&(y=l(N,r)===0?E:M),y!==null&&A()&&(v.push(aB({start:y,end:E,loop:p,count:o,style:x})),y=null),M=E,S=N));return y!==null&&v.push(aB({start:y,end:h,loop:p,count:o,style:x})),v}function sHe(e,t){const n=[],s=e.segments;for(let r=0;r<s.length;r++){const i=nHe(s[r],e.points,t);i.length&&n.push(...i)}return n}function rHe(e,t,n,s){let r=0,i=t-1;if(n&&!s)for(;r<t&&!e[r].skip;)r++;for(;r<t&&e[r].skip;)r++;for(r%=t,n&&(i+=r);i>r&&e[i%t].skip;)i--;return i%=t,{start:r,end:i}}function iHe(e,t,n,s){const r=e.length,i=[];let o=t,l=e[t],c;for(c=t+1;c<=n;++c){const u=e[c%r];u.skip||u.stop?l.skip||(s=!1,i.push({start:t%r,end:(c-1)%r,loop:s}),t=o=u.stop?c:null):(o=c,l.skip&&(t=c)),l=u}return o!==null&&i.push({start:t%r,end:o%r,loop:s}),i}function oHe(e,t){const n=e.points,s=e.options.spanGaps,r=n.length;if(!r)return[];const i=!!e._loop,{start:o,end:l}=rHe(n,r,i,s);if(s===!0)return nB(e,[{start:o,end:l,loop:i}],n,t);const c=l<o?l+r:l,u=!!e._fullLoop&&o===0&&l===r-1;return nB(e,iHe(n,o,c,u),n,t)}function nB(e,t,n,s){return!s||!s.setContext||!n?t:lHe(e,t,n,s)}function lHe(e,t,n,s){const r=e._chart.getContext(),i=sB(e.options),{_datasetIndex:o,options:{spanGaps:l}}=e,c=n.length,u=[];let d=i,h=t[0].start,p=h;function x(v,j,y,N){const w=l?-1:1;if(v!==j){for(v+=c;n[v%c].skip;)v-=w;for(;n[j%c].skip;)j+=w;v%c!==j%c&&(u.push({start:v%c,end:j%c,loop:y,style:N}),d=N,h=j%c)}}for(const v of t){h=l?h:v.start;let j=n[h%c],y;for(p=h+1;p<=v.end;p++){const N=n[p%c];y=sB(s.setContext(lm(r,{type:"segment",p0:j,p1:N,p0DataIndex:(p-1)%c,p1DataIndex:p%c,datasetIndex:o}))),cHe(y,d)&&x(h,p-1,v.loop,d),j=N,d=y}h<p-1&&x(h,p-1,v.loop,d)}return u}function sB(e){return{backgroundColor:e.backgroundColor,borderCapStyle:e.borderCapStyle,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderJoinStyle:e.borderJoinStyle,borderWidth:e.borderWidth,borderColor:e.borderColor}}function cHe(e,t){if(!t)return!1;const n=[],s=function(r,i){return c3(i)?(n.includes(i)||n.push(i),n.indexOf(i)):i};return JSON.stringify(e,s)!==JSON.stringify(t,s)}function Bb(e,t,n){return e.options.clip?e[n]:t[n]}function dHe(e,t){const{xScale:n,yScale:s}=e;return n&&s?{left:Bb(n,t,"left"),right:Bb(n,t,"right"),top:Bb(s,t,"top"),bottom:Bb(s,t,"bottom")}:t}function uHe(e,t){const n=t._clip;if(n.disabled)return!1;const s=dHe(t,e.chartArea);return{left:n.left===!1?0:s.left-(n.left===!0?0:n.left),right:n.right===!1?e.width:s.right+(n.right===!0?0:n.right),top:n.top===!1?0:s.top-(n.top===!0?0:n.top),bottom:n.bottom===!1?e.height:s.bottom+(n.bottom===!0?0:n.bottom)}}class mHe{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,n,s,r){const i=n.listeners[r],o=n.duration;i.forEach(l=>l({chart:t,initial:n.initial,numSteps:o,currentStep:Math.min(s-n.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=IJ.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(t=Date.now()){let n=0;this._charts.forEach((s,r)=>{if(!s.running||!s.items.length)return;const i=s.items;let o=i.length-1,l=!1,c;for(;o>=0;--o)c=i[o],c._active?(c._total>s.duration&&(s.duration=c._total),c.tick(t),l=!0):(i[o]=i[i.length-1],i.pop());l&&(r.draw(),this._notify(r,s,t,"progress")),i.length||(s.running=!1,this._notify(r,s,t,"complete"),s.initial=!1),n+=i.length}),this._lastDate=t,n===0&&(this._running=!1)}_getAnims(t){const n=this._charts;let s=n.get(t);return s||(s={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},n.set(t,s)),s}listen(t,n,s){this._getAnims(t).listeners[n].push(s)}add(t,n){!n||!n.length||this._getAnims(t).items.push(...n)}has(t){return this._getAnims(t).items.length>0}start(t){const n=this._charts.get(t);n&&(n.running=!0,n.start=Date.now(),n.duration=n.items.reduce((s,r)=>Math.max(s,r._duration),0),this._refresh())}running(t){if(!this._running)return!1;const n=this._charts.get(t);return!(!n||!n.running||!n.items.length)}stop(t){const n=this._charts.get(t);if(!n||!n.items.length)return;const s=n.items;let r=s.length-1;for(;r>=0;--r)s[r].cancel();n.items=[],this._notify(t,n,Date.now(),"complete")}remove(t){return this._charts.delete(t)}}var Cl=new mHe;const rB="transparent",fHe={boolean(e,t,n){return n>.5?t:e},color(e,t,n){const s=Y8(e||rB),r=s.valid&&Y8(t||rB);return r&&r.valid?r.mix(s,n).hexString():t},number(e,t,n){return e+(t-e)*n}};class hHe{constructor(t,n,s,r){const i=n[s];r=Fb([t.to,r,i,t.from]);const o=Fb([t.from,i,r]);this._active=!0,this._fn=t.fn||fHe[t.type||typeof o],this._easing=hp[t.easing]||hp.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=n,this._prop=s,this._from=o,this._to=r,this._promises=void 0}active(){return this._active}update(t,n,s){if(this._active){this._notify(!1);const r=this._target[this._prop],i=s-this._start,o=this._duration-i;this._start=s,this._duration=Math.floor(Math.max(o,t.duration)),this._total+=i,this._loop=!!t.loop,this._to=Fb([t.to,n,r,t.from]),this._from=Fb([t.from,r,n])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(t){const n=t-this._start,s=this._duration,r=this._prop,i=this._from,o=this._loop,l=this._to;let c;if(this._active=i!==l&&(o||n<s),!this._active){this._target[r]=l,this._notify(!0);return}if(n<0){this._target[r]=i;return}c=n/s%2,c=o&&c>1?2-c:c,c=this._easing(Math.min(1,Math.max(0,c))),this._target[r]=this._fn(i,l,c)}wait(){const t=this._promises||(this._promises=[]);return new Promise((n,s)=>{t.push({res:n,rej:s})})}_notify(t){const n=t?"res":"rej",s=this._promises||[];for(let r=0;r<s.length;r++)s[r][n]()}}class QJ{constructor(t,n){this._chart=t,this._properties=new Map,this.configure(n)}configure(t){if(!Ca(t))return;const n=Object.keys(On.animation),s=this._properties;Object.getOwnPropertyNames(t).forEach(r=>{const i=t[r];if(!Ca(i))return;const o={};for(const l of n)o[l]=i[l];(ss(i.properties)&&i.properties||[r]).forEach(l=>{(l===r||!s.has(l))&&s.set(l,o)})})}_animateOptions(t,n){const s=n.options,r=pHe(t,s);if(!r)return[];const i=this._createAnimations(r,s);return s.$shared&&gHe(t.options.$animations,s).then(()=>{t.options=s},()=>{}),i}_createAnimations(t,n){const s=this._properties,r=[],i=t.$animations||(t.$animations={}),o=Object.keys(n),l=Date.now();let c;for(c=o.length-1;c>=0;--c){const u=o[c];if(u.charAt(0)==="$")continue;if(u==="options"){r.push(...this._animateOptions(t,n));continue}const d=n[u];let h=i[u];const p=s.get(u);if(h)if(p&&h.active()){h.update(p,d,l);continue}else h.cancel();if(!p||!p.duration){t[u]=d;continue}i[u]=h=new hHe(p,t,u,d),r.push(h)}return r}update(t,n){if(this._properties.size===0){Object.assign(t,n);return}const s=this._createAnimations(t,n);if(s.length)return Cl.add(this._chart,s),!0}}function gHe(e,t){const n=[],s=Object.keys(t);for(let r=0;r<s.length;r++){const i=e[s[r]];i&&i.active()&&n.push(i.wait())}return Promise.all(n)}function pHe(e,t){if(!t)return;let n=e.options;if(!n){e.options=t;return}return n.$shared&&(e.options=n=Object.assign({},n,{$shared:!1,$animations:{}})),n}function iB(e,t){const n=e&&e.options||{},s=n.reverse,r=n.min===void 0?t:0,i=n.max===void 0?t:0;return{start:s?i:r,end:s?r:i}}function xHe(e,t,n){if(n===!1)return!1;const s=iB(e,n),r=iB(t,n);return{top:r.end,right:s.end,bottom:r.start,left:s.start}}function yHe(e){let t,n,s,r;return Ca(e)?(t=e.top,n=e.right,s=e.bottom,r=e.left):t=n=s=r=e,{top:t,right:n,bottom:s,left:r,disabled:e===!1}}function KJ(e,t){const n=[],s=e._getSortedDatasetMetas(t);let r,i;for(r=0,i=s.length;r<i;++r)n.push(s[r].index);return n}function oB(e,t,n,s={}){const r=e.keys,i=s.mode==="single";let o,l,c,u;if(t===null)return;let d=!1;for(o=0,l=r.length;o<l;++o){if(c=+r[o],c===n){if(d=!0,s.all)continue;break}u=e.values[c],Ci(u)&&(i||t===0||Fo(t)===Fo(u))&&(t+=u)}return!d&&!s.all?0:t}function bHe(e,t){const{iScale:n,vScale:s}=t,r=n.axis==="x"?"x":"y",i=s.axis==="x"?"x":"y",o=Object.keys(e),l=new Array(o.length);let c,u,d;for(c=0,u=o.length;c<u;++c)d=o[c],l[c]={[r]:d,[i]:e[d]};return l}function pT(e,t){const n=e&&e.options.stacked;return n||n===void 0&&t.stack!==void 0}function vHe(e,t,n){return`${e.id}.${t.id}.${n.stack||n.type}`}function wHe(e){const{min:t,max:n,minDefined:s,maxDefined:r}=e.getUserBounds();return{min:s?t:Number.NEGATIVE_INFINITY,max:r?n:Number.POSITIVE_INFINITY}}function jHe(e,t,n){const s=e[t]||(e[t]={});return s[n]||(s[n]={})}function lB(e,t,n,s){for(const r of t.getMatchingVisibleMetas(s).reverse()){const i=e[r.index];if(n&&i>0||!n&&i<0)return r.index}return null}function cB(e,t){const{chart:n,_cachedMeta:s}=e,r=n._stacks||(n._stacks={}),{iScale:i,vScale:o,index:l}=s,c=i.axis,u=o.axis,d=vHe(i,o,s),h=t.length;let p;for(let x=0;x<h;++x){const v=t[x],{[c]:j,[u]:y}=v,N=v._stacks||(v._stacks={});p=N[u]=jHe(r,d,j),p[l]=y,p._top=lB(p,o,!0,s.type),p._bottom=lB(p,o,!1,s.type);const w=p._visualValues||(p._visualValues={});w[l]=y}}function xT(e,t){const n=e.scales;return Object.keys(n).filter(s=>n[s].axis===t).shift()}function NHe(e,t){return lm(e,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}function CHe(e,t,n){return lm(e,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:n,index:t,mode:"default",type:"data"})}function Dg(e,t){const n=e.controller.index,s=e.vScale&&e.vScale.axis;if(s){t=t||e._parsed;for(const r of t){const i=r._stacks;if(!i||i[s]===void 0||i[s][n]===void 0)return;delete i[s][n],i[s]._visualValues!==void 0&&i[s]._visualValues[n]!==void 0&&delete i[s]._visualValues[n]}}}const yT=e=>e==="reset"||e==="none",dB=(e,t)=>t?e:Object.assign({},e),SHe=(e,t,n)=>e&&!t.hidden&&t._stacked&&{keys:KJ(n,!0),values:null};class P1{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(t,n){this.chart=t,this._ctx=t.ctx,this.index=n,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const t=this._cachedMeta;this.configure(),this.linkScales(),t._stacked=pT(t.vScale,t),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(t){this.index!==t&&Dg(this._cachedMeta),this.index=t}linkScales(){const t=this.chart,n=this._cachedMeta,s=this.getDataset(),r=(h,p,x,v)=>h==="x"?p:h==="r"?v:x,i=n.xAxisID=ma(s.xAxisID,xT(t,"x")),o=n.yAxisID=ma(s.yAxisID,xT(t,"y")),l=n.rAxisID=ma(s.rAxisID,xT(t,"r")),c=n.indexAxis,u=n.iAxisID=r(c,i,o,l),d=n.vAxisID=r(c,o,i,l);n.xScale=this.getScaleForId(i),n.yScale=this.getScaleForId(o),n.rScale=this.getScaleForId(l),n.iScale=this.getScaleForId(u),n.vScale=this.getScaleForId(d)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(t){return this.chart.scales[t]}_getOtherScale(t){const n=this._cachedMeta;return t===n.iScale?n.vScale:n.iScale}reset(){this._update("reset")}_destroy(){const t=this._cachedMeta;this._data&&G8(this._data,this),t._stacked&&Dg(t)}_dataCheck(){const t=this.getDataset(),n=t.data||(t.data=[]),s=this._data;if(Ca(n)){const r=this._cachedMeta;this._data=bHe(n,r)}else if(s!==n){if(s){G8(s,this);const r=this._cachedMeta;Dg(r),r._parsed=[]}n&&Object.isExtensible(n)&&sBe(n,this),this._syncList=[],this._data=n}}addElements(){const t=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(t.dataset=new this.datasetElementType)}buildOrUpdateElements(t){const n=this._cachedMeta,s=this.getDataset();let r=!1;this._dataCheck();const i=n._stacked;n._stacked=pT(n.vScale,n),n.stack!==s.stack&&(r=!0,Dg(n),n.stack=s.stack),this._resyncElements(t),(r||i!==n._stacked)&&(cB(this,n._parsed),n._stacked=pT(n.vScale,n))}configure(){const t=this.chart.config,n=t.datasetScopeKeys(this._type),s=t.getOptionScopes(this.getDataset(),n,!0);this.options=t.createResolver(s,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(t,n){const{_cachedMeta:s,_data:r}=this,{iScale:i,_stacked:o}=s,l=i.axis;let c=t===0&&n===r.length?!0:s._sorted,u=t>0&&s._parsed[t-1],d,h,p;if(this._parsing===!1)s._parsed=r,s._sorted=!0,p=r;else{ss(r[t])?p=this.parseArrayData(s,r,t,n):Ca(r[t])?p=this.parseObjectData(s,r,t,n):p=this.parsePrimitiveData(s,r,t,n);const x=()=>h[l]===null||u&&h[l]<u[l];for(d=0;d<n;++d)s._parsed[d+t]=h=p[d],c&&(x()&&(c=!1),u=h);s._sorted=c}o&&cB(this,p)}parsePrimitiveData(t,n,s,r){const{iScale:i,vScale:o}=t,l=i.axis,c=o.axis,u=i.getLabels(),d=i===o,h=new Array(r);let p,x,v;for(p=0,x=r;p<x;++p)v=p+s,h[p]={[l]:d||i.parse(u[v],v),[c]:o.parse(n[v],v)};return h}parseArrayData(t,n,s,r){const{xScale:i,yScale:o}=t,l=new Array(r);let c,u,d,h;for(c=0,u=r;c<u;++c)d=c+s,h=n[d],l[c]={x:i.parse(h[0],d),y:o.parse(h[1],d)};return l}parseObjectData(t,n,s,r){const{xScale:i,yScale:o}=t,{xAxisKey:l="x",yAxisKey:c="y"}=this._parsing,u=new Array(r);let d,h,p,x;for(d=0,h=r;d<h;++d)p=d+s,x=n[p],u[d]={x:i.parse(Yu(x,l),p),y:o.parse(Yu(x,c),p)};return u}getParsed(t){return this._cachedMeta._parsed[t]}getDataElement(t){return this._cachedMeta.data[t]}applyStack(t,n,s){const r=this.chart,i=this._cachedMeta,o=n[t.axis],l={keys:KJ(r,!0),values:n._stacks[t.axis]._visualValues};return oB(l,o,i.index,{mode:s})}updateRangeFromParsed(t,n,s,r){const i=s[n.axis];let o=i===null?NaN:i;const l=r&&s._stacks[n.axis];r&&l&&(r.values=l,o=oB(r,i,this._cachedMeta.index)),t.min=Math.min(t.min,o),t.max=Math.max(t.max,o)}getMinMax(t,n){const s=this._cachedMeta,r=s._parsed,i=s._sorted&&t===s.iScale,o=r.length,l=this._getOtherScale(t),c=SHe(n,s,this.chart),u={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:d,max:h}=wHe(l);let p,x;function v(){x=r[p];const j=x[l.axis];return!Ci(x[t.axis])||d>j||h<j}for(p=0;p<o&&!(!v()&&(this.updateRangeFromParsed(u,t,x,c),i));++p);if(i){for(p=o-1;p>=0;--p)if(!v()){this.updateRangeFromParsed(u,t,x,c);break}}return u}getAllParsedValues(t){const n=this._cachedMeta._parsed,s=[];let r,i,o;for(r=0,i=n.length;r<i;++r)o=n[r][t.axis],Ci(o)&&s.push(o);return s}getMaxOverflow(){return!1}getLabelAndValue(t){const n=this._cachedMeta,s=n.iScale,r=n.vScale,i=this.getParsed(t);return{label:s?""+s.getLabelForValue(i[s.axis]):"",value:r?""+r.getLabelForValue(i[r.axis]):""}}_update(t){const n=this._cachedMeta;this.update(t||"default"),n._clip=yHe(ma(this.options.clip,xHe(n.xScale,n.yScale,this.getMaxOverflow())))}update(t){}draw(){const t=this._ctx,n=this.chart,s=this._cachedMeta,r=s.data||[],i=n.chartArea,o=[],l=this._drawStart||0,c=this._drawCount||r.length-l,u=this.options.drawActiveElementsOnTop;let d;for(s.dataset&&s.dataset.draw(t,i,l,c),d=l;d<l+c;++d){const h=r[d];h.hidden||(h.active&&u?o.push(h):h.draw(t,i))}for(d=0;d<o.length;++d)o[d].draw(t,i)}getStyle(t,n){const s=n?"active":"default";return t===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(s):this.resolveDataElementOptions(t||0,s)}getContext(t,n,s){const r=this.getDataset();let i;if(t>=0&&t<this._cachedMeta.data.length){const o=this._cachedMeta.data[t];i=o.$context||(o.$context=CHe(this.getContext(),t,o)),i.parsed=this.getParsed(t),i.raw=r.data[t],i.index=i.dataIndex=t}else i=this.$context||(this.$context=NHe(this.chart.getContext(),this.index)),i.dataset=r,i.index=i.datasetIndex=this.index;return i.active=!!n,i.mode=s,i}resolveDatasetElementOptions(t){return this._resolveElementOptions(this.datasetElementType.id,t)}resolveDataElementOptions(t,n){return this._resolveElementOptions(this.dataElementType.id,n,t)}_resolveElementOptions(t,n="default",s){const r=n==="active",i=this._cachedDataOpts,o=t+"-"+n,l=i[o],c=this.enableOptionSharing&&Xp(s);if(l)return dB(l,c);const u=this.chart.config,d=u.datasetElementScopeKeys(this._type,t),h=r?[`${t}Hover`,"hover",t,""]:[t,""],p=u.getOptionScopes(this.getDataset(),d),x=Object.keys(On.elements[t]),v=()=>this.getContext(s,r,n),j=u.resolveNamedOptions(p,x,v,h);return j.$shared&&(j.$shared=c,i[o]=Object.freeze(dB(j,c))),j}_resolveAnimations(t,n,s){const r=this.chart,i=this._cachedDataOpts,o=`animation-${n}`,l=i[o];if(l)return l;let c;if(r.options.animation!==!1){const d=this.chart.config,h=d.datasetAnimationScopeKeys(this._type,n),p=d.getOptionScopes(this.getDataset(),h);c=d.createResolver(p,this.getContext(t,s,n))}const u=new QJ(r,c&&c.animations);return c&&c._cacheable&&(i[o]=Object.freeze(u)),u}getSharedOptions(t){if(t.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},t))}includeOptions(t,n){return!n||yT(t)||this.chart._animationsDisabled}_getSharedOptions(t,n){const s=this.resolveDataElementOptions(t,n),r=this._sharedOptions,i=this.getSharedOptions(s),o=this.includeOptions(n,i)||i!==r;return this.updateSharedOptions(i,n,s),{sharedOptions:i,includeOptions:o}}updateElement(t,n,s,r){yT(r)?Object.assign(t,s):this._resolveAnimations(n,r).update(t,s)}updateSharedOptions(t,n,s){t&&!yT(n)&&this._resolveAnimations(void 0,n).update(t,s)}_setStyle(t,n,s,r){t.active=r;const i=this.getStyle(n,r);this._resolveAnimations(n,s,r).update(t,{options:!r&&this.getSharedOptions(i)||i})}removeHoverStyle(t,n,s){this._setStyle(t,s,"active",!1)}setHoverStyle(t,n,s){this._setStyle(t,s,"active",!0)}_removeDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!1)}_setDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!0)}_resyncElements(t){const n=this._data,s=this._cachedMeta.data;for(const[l,c,u]of this._syncList)this[l](c,u);this._syncList=[];const r=s.length,i=n.length,o=Math.min(i,r);o&&this.parse(0,o),i>r?this._insertElements(r,i-r,t):i<r&&this._removeElements(i,r-i)}_insertElements(t,n,s=!0){const r=this._cachedMeta,i=r.data,o=t+n;let l;const c=u=>{for(u.length+=n,l=u.length-1;l>=o;l--)u[l]=u[l-n]};for(c(i),l=t;l<o;++l)i[l]=new this.dataElementType;this._parsing&&c(r._parsed),this.parse(t,n),s&&this.updateElements(i,t,n,"reset")}updateElements(t,n,s,r){}_removeElements(t,n){const s=this._cachedMeta;if(this._parsing){const r=s._parsed.splice(t,n);s._stacked&&Dg(s,r)}s.data.splice(t,n)}_sync(t){if(this._parsing)this._syncList.push(t);else{const[n,s,r]=t;this[n](s,r)}this.chart._dataChanges.push([this.index,...t])}_onDataPush(){const t=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-t,t])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(t,n){n&&this._sync(["_removeElements",t,n]);const s=arguments.length-2;s&&this._sync(["_insertElements",t,s])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}function _He(e,t){if(!e._cache.$bar){const n=e.getMatchingVisibleMetas(t);let s=[];for(let r=0,i=n.length;r<i;r++)s=s.concat(n[r].controller.getAllParsedValues(e));e._cache.$bar=MJ(s.sort((r,i)=>r-i))}return e._cache.$bar}function AHe(e){const t=e.iScale,n=_He(t,e.type);let s=t._length,r,i,o,l;const c=()=>{o===32767||o===-32768||(Xp(l)&&(s=Math.min(s,Math.abs(o-l)||s)),l=o)};for(r=0,i=n.length;r<i;++r)o=t.getPixelForValue(n[r]),c();for(l=void 0,r=0,i=t.ticks.length;r<i;++r)o=t.getPixelForTick(r),c();return s}function THe(e,t,n,s){const r=n.barThickness;let i,o;return Pa(r)?(i=t.min*n.categoryPercentage,o=n.barPercentage):(i=r*s,o=1),{chunk:i/s,ratio:o,start:t.pixels[e]-i/2}}function kHe(e,t,n,s){const r=t.pixels,i=r[e];let o=e>0?r[e-1]:null,l=e<r.length-1?r[e+1]:null;const c=n.categoryPercentage;o===null&&(o=i-(l===null?t.end-t.start:l-i)),l===null&&(l=i+i-o);const u=i-(i-Math.min(o,l))/2*c;return{chunk:Math.abs(l-o)/2*c/s,ratio:n.barPercentage,start:u}}function EHe(e,t,n,s){const r=n.parse(e[0],s),i=n.parse(e[1],s),o=Math.min(r,i),l=Math.max(r,i);let c=o,u=l;Math.abs(o)>Math.abs(l)&&(c=l,u=o),t[n.axis]=u,t._custom={barStart:c,barEnd:u,start:r,end:i,min:o,max:l}}function XJ(e,t,n,s){return ss(e)?EHe(e,t,n,s):t[n.axis]=n.parse(e,s),t}function uB(e,t,n,s){const r=e.iScale,i=e.vScale,o=r.getLabels(),l=r===i,c=[];let u,d,h,p;for(u=n,d=n+s;u<d;++u)p=t[u],h={},h[r.axis]=l||r.parse(o[u],u),c.push(XJ(p,h,i,u));return c}function bT(e){return e&&e.barStart!==void 0&&e.barEnd!==void 0}function LHe(e,t,n){return e!==0?Fo(e):(t.isHorizontal()?1:-1)*(t.min>=n?1:-1)}function PHe(e){let t,n,s,r,i;return e.horizontal?(t=e.base>e.x,n="left",s="right"):(t=e.base<e.y,n="bottom",s="top"),t?(r="end",i="start"):(r="start",i="end"),{start:n,end:s,reverse:t,top:r,bottom:i}}function DHe(e,t,n,s){let r=t.borderSkipped;const i={};if(!r){e.borderSkipped=i;return}if(r===!0){e.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:o,end:l,reverse:c,top:u,bottom:d}=PHe(e);r==="middle"&&n&&(e.enableBorderRadius=!0,(n._top||0)===s?r=u:(n._bottom||0)===s?r=d:(i[mB(d,o,l,c)]=!0,r=u)),i[mB(r,o,l,c)]=!0,e.borderSkipped=i}function mB(e,t,n,s){return s?(e=OHe(e,t,n),e=fB(e,n,t)):e=fB(e,t,n),e}function OHe(e,t,n){return e===t?n:e===n?t:e}function fB(e,t,n){return e==="start"?t:e==="end"?n:e}function MHe(e,{inflateAmount:t},n){e.inflateAmount=t==="auto"?n===1?.33:0:t}class IHe extends P1{static id="bar";static defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};static overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};parsePrimitiveData(t,n,s,r){return uB(t,n,s,r)}parseArrayData(t,n,s,r){return uB(t,n,s,r)}parseObjectData(t,n,s,r){const{iScale:i,vScale:o}=t,{xAxisKey:l="x",yAxisKey:c="y"}=this._parsing,u=i.axis==="x"?l:c,d=o.axis==="x"?l:c,h=[];let p,x,v,j;for(p=s,x=s+r;p<x;++p)j=n[p],v={},v[i.axis]=i.parse(Yu(j,u),p),h.push(XJ(Yu(j,d),v,o,p));return h}updateRangeFromParsed(t,n,s,r){super.updateRangeFromParsed(t,n,s,r);const i=s._custom;i&&n===this._cachedMeta.vScale&&(t.min=Math.min(t.min,i.min),t.max=Math.max(t.max,i.max))}getMaxOverflow(){return 0}getLabelAndValue(t){const n=this._cachedMeta,{iScale:s,vScale:r}=n,i=this.getParsed(t),o=i._custom,l=bT(o)?"["+o.start+", "+o.end+"]":""+r.getLabelForValue(i[r.axis]);return{label:""+s.getLabelForValue(i[s.axis]),value:l}}initialize(){this.enableOptionSharing=!0,super.initialize();const t=this._cachedMeta;t.stack=this.getDataset().stack}update(t){const n=this._cachedMeta;this.updateElements(n.data,0,n.data.length,t)}updateElements(t,n,s,r){const i=r==="reset",{index:o,_cachedMeta:{vScale:l}}=this,c=l.getBasePixel(),u=l.isHorizontal(),d=this._getRuler(),{sharedOptions:h,includeOptions:p}=this._getSharedOptions(n,r);for(let x=n;x<n+s;x++){const v=this.getParsed(x),j=i||Pa(v[l.axis])?{base:c,head:c}:this._calculateBarValuePixels(x),y=this._calculateBarIndexPixels(x,d),N=(v._stacks||{})[l.axis],w={horizontal:u,base:j.base,enableBorderRadius:!N||bT(v._custom)||o===N._top||o===N._bottom,x:u?j.head:y.center,y:u?y.center:j.head,height:u?y.size:Math.abs(j.size),width:u?Math.abs(j.size):y.size};p&&(w.options=h||this.resolveDataElementOptions(x,t[x].active?"active":r));const S=w.options||t[x].options;DHe(w,S,N,o),MHe(w,S,d.ratio),this.updateElement(t[x],x,w,r)}}_getStacks(t,n){const{iScale:s}=this._cachedMeta,r=s.getMatchingVisibleMetas(this._type).filter(d=>d.controller.options.grouped),i=s.options.stacked,o=[],l=this._cachedMeta.controller.getParsed(n),c=l&&l[s.axis],u=d=>{const h=d._parsed.find(x=>x[s.axis]===c),p=h&&h[d.vScale.axis];if(Pa(p)||isNaN(p))return!0};for(const d of r)if(!(n!==void 0&&u(d))&&((i===!1||o.indexOf(d.stack)===-1||i===void 0&&d.stack===void 0)&&o.push(d.stack),d.index===t))break;return o.length||o.push(void 0),o}_getStackCount(t){return this._getStacks(void 0,t).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const t=this.chart.scales,n=this.chart.options.indexAxis;return Object.keys(t).filter(s=>t[s].axis===n).shift()}_getAxis(){const t={},n=this.getFirstScaleIdForIndexAxis();for(const s of this.chart.data.datasets)t[ma(this.chart.options.indexAxis==="x"?s.xAxisID:s.yAxisID,n)]=!0;return Object.keys(t)}_getStackIndex(t,n,s){const r=this._getStacks(t,s),i=n!==void 0?r.indexOf(n):-1;return i===-1?r.length-1:i}_getRuler(){const t=this.options,n=this._cachedMeta,s=n.iScale,r=[];let i,o;for(i=0,o=n.data.length;i<o;++i)r.push(s.getPixelForValue(this.getParsed(i)[s.axis],i));const l=t.barThickness;return{min:l||AHe(n),pixels:r,start:s._startPixel,end:s._endPixel,stackCount:this._getStackCount(),scale:s,grouped:t.grouped,ratio:l?1:t.categoryPercentage*t.barPercentage}}_calculateBarValuePixels(t){const{_cachedMeta:{vScale:n,_stacked:s,index:r},options:{base:i,minBarLength:o}}=this,l=i||0,c=this.getParsed(t),u=c._custom,d=bT(u);let h=c[n.axis],p=0,x=s?this.applyStack(n,c,s):h,v,j;x!==h&&(p=x-h,x=h),d&&(h=u.barStart,x=u.barEnd-u.barStart,h!==0&&Fo(h)!==Fo(u.barEnd)&&(p=0),p+=h);const y=!Pa(i)&&!d?i:p;let N=n.getPixelForValue(y);if(this.chart.getDataVisibility(t)?v=n.getPixelForValue(p+x):v=N,j=v-N,Math.abs(j)<o){j=LHe(j,n,l)*o,h===l&&(N-=j/2);const w=n.getPixelForDecimal(0),S=n.getPixelForDecimal(1),_=Math.min(w,S),k=Math.max(w,S);N=Math.max(Math.min(N,k),_),v=N+j,s&&!d&&(c._stacks[n.axis]._visualValues[r]=n.getValueForPixel(v)-n.getValueForPixel(N))}if(N===n.getPixelForValue(l)){const w=Fo(j)*n.getLineWidthForValue(l)/2;N+=w,j-=w}return{size:j,base:N,head:v,center:v+j/2}}_calculateBarIndexPixels(t,n){const s=n.scale,r=this.options,i=r.skipNull,o=ma(r.maxBarThickness,1/0);let l,c;const u=this._getAxisCount();if(n.grouped){const d=i?this._getStackCount(t):n.stackCount,h=r.barThickness==="flex"?kHe(t,n,r,d*u):THe(t,n,r,d*u),p=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,x=this._getAxis().indexOf(ma(p,this.getFirstScaleIdForIndexAxis())),v=this._getStackIndex(this.index,this._cachedMeta.stack,i?t:void 0)+x;l=h.start+h.chunk*v+h.chunk/2,c=Math.min(o,h.chunk*h.ratio)}else l=s.getPixelForValue(this.getParsed(t)[s.axis],t),c=Math.min(o,n.min*n.ratio);return{base:l-c/2,head:l+c/2,center:l,size:c}}draw(){const t=this._cachedMeta,n=t.vScale,s=t.data,r=s.length;let i=0;for(;i<r;++i)this.getParsed(i)[n.axis]!==null&&!s[i].hidden&&s[i].draw(this._ctx)}}function $He(e,t,n){let s=1,r=1,i=0,o=0;if(t<_n){const l=e,c=l+t,u=Math.cos(l),d=Math.sin(l),h=Math.cos(c),p=Math.sin(c),x=(S,_,k)=>Jp(S,l,c,!0)?1:Math.max(_,_*n,k,k*n),v=(S,_,k)=>Jp(S,l,c,!0)?-1:Math.min(_,_*n,k,k*n),j=x(0,u,h),y=x(rs,d,p),N=v(za,u,h),w=v(za+rs,d,p);s=(j-N)/2,r=(y-w)/2,i=-(j+N)/2,o=-(y+w)/2}return{ratioX:s,ratioY:r,offsetX:i,offsetY:o}}class RHe extends P1{static id="doughnut";static defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};static descriptors={_scriptable:t=>t!=="spacing",_indexable:t=>t!=="spacing"&&!t.startsWith("borderDash")&&!t.startsWith("hoverBorderDash")};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const n=t.data,{labels:{pointStyle:s,textAlign:r,color:i,useBorderRadius:o,borderRadius:l}}=t.legend.options;return n.labels.length&&n.datasets.length?n.labels.map((c,u)=>{const h=t.getDatasetMeta(0).controller.getStyle(u);return{text:c,fillStyle:h.backgroundColor,fontColor:i,hidden:!t.getDataVisibility(u),lineDash:h.borderDash,lineDashOffset:h.borderDashOffset,lineJoin:h.borderJoinStyle,lineWidth:h.borderWidth,strokeStyle:h.borderColor,textAlign:r,pointStyle:s,borderRadius:o&&(l||h.borderRadius),index:u}}):[]}},onClick(t,n,s){s.chart.toggleDataVisibility(n.index),s.chart.update()}}}};constructor(t,n){super(t,n),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(t,n){const s=this.getDataset().data,r=this._cachedMeta;if(this._parsing===!1)r._parsed=s;else{let i=c=>+s[c];if(Ca(s[t])){const{key:c="value"}=this._parsing;i=u=>+Yu(s[u],c)}let o,l;for(o=t,l=t+n;o<l;++o)r._parsed[o]=i(o)}}_getRotation(){return Dl(this.options.rotation-90)}_getCircumference(){return Dl(this.options.circumference)}_getRotationExtents(){let t=_n,n=-_n;for(let s=0;s<this.chart.data.datasets.length;++s)if(this.chart.isDatasetVisible(s)&&this.chart.getDatasetMeta(s).type===this._type){const r=this.chart.getDatasetMeta(s).controller,i=r._getRotation(),o=r._getCircumference();t=Math.min(t,i),n=Math.max(n,i+o)}return{rotation:t,circumference:n-t}}update(t){const n=this.chart,{chartArea:s}=n,r=this._cachedMeta,i=r.data,o=this.getMaxBorderWidth()+this.getMaxOffset(i)+this.options.spacing,l=Math.max((Math.min(s.width,s.height)-o)/2,0),c=Math.min(U8e(this.options.cutout,l),1),u=this._getRingWeight(this.index),{circumference:d,rotation:h}=this._getRotationExtents(),{ratioX:p,ratioY:x,offsetX:v,offsetY:j}=$He(h,d,c),y=(s.width-o)/p,N=(s.height-o)/x,w=Math.max(Math.min(y,N)/2,0),S=EJ(this.options.radius,w),_=Math.max(S*c,0),k=(S-_)/this._getVisibleDatasetWeightTotal();this.offsetX=v*S,this.offsetY=j*S,r.total=this.calculateTotal(),this.outerRadius=S-k*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-k*u,0),this.updateElements(i,0,i.length,t)}_circumference(t,n){const s=this.options,r=this._cachedMeta,i=this._getCircumference();return n&&s.animation.animateRotate||!this.chart.getDataVisibility(t)||r._parsed[t]===null||r.data[t].hidden?0:this.calculateCircumference(r._parsed[t]*i/_n)}updateElements(t,n,s,r){const i=r==="reset",o=this.chart,l=o.chartArea,u=o.options.animation,d=(l.left+l.right)/2,h=(l.top+l.bottom)/2,p=i&&u.animateScale,x=p?0:this.innerRadius,v=p?0:this.outerRadius,{sharedOptions:j,includeOptions:y}=this._getSharedOptions(n,r);let N=this._getRotation(),w;for(w=0;w<n;++w)N+=this._circumference(w,i);for(w=n;w<n+s;++w){const S=this._circumference(w,i),_=t[w],k={x:d+this.offsetX,y:h+this.offsetY,startAngle:N,endAngle:N+S,circumference:S,outerRadius:v,innerRadius:x};y&&(k.options=j||this.resolveDataElementOptions(w,_.active?"active":r)),N+=S,this.updateElement(_,w,k,r)}}calculateTotal(){const t=this._cachedMeta,n=t.data;let s=0,r;for(r=0;r<n.length;r++){const i=t._parsed[r];i!==null&&!isNaN(i)&&this.chart.getDataVisibility(r)&&!n[r].hidden&&(s+=Math.abs(i))}return s}calculateCircumference(t){const n=this._cachedMeta.total;return n>0&&!isNaN(t)?_n*(Math.abs(t)/n):0}getLabelAndValue(t){const n=this._cachedMeta,s=this.chart,r=s.data.labels||[],i=d3(n._parsed[t],s.options.locale);return{label:r[t]||"",value:i}}getMaxBorderWidth(t){let n=0;const s=this.chart;let r,i,o,l,c;if(!t){for(r=0,i=s.data.datasets.length;r<i;++r)if(s.isDatasetVisible(r)){o=s.getDatasetMeta(r),t=o.data,l=o.controller;break}}if(!t)return 0;for(r=0,i=t.length;r<i;++r)c=l.resolveDataElementOptions(r),c.borderAlign!=="inner"&&(n=Math.max(n,c.borderWidth||0,c.hoverBorderWidth||0));return n}getMaxOffset(t){let n=0;for(let s=0,r=t.length;s<r;++s){const i=this.resolveDataElementOptions(s);n=Math.max(n,i.offset||0,i.hoverOffset||0)}return n}_getRingWeightOffset(t){let n=0;for(let s=0;s<t;++s)this.chart.isDatasetVisible(s)&&(n+=this._getRingWeight(s));return n}_getRingWeight(t){return Math.max(ma(this.chart.data.datasets[t].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}class zHe extends P1{static id="line";static defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1};static overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(t){const n=this._cachedMeta,{dataset:s,data:r=[],_dataset:i}=n,o=this.chart._animationsDisabled;let{start:l,count:c}=oBe(n,r,o);this._drawStart=l,this._drawCount=c,lBe(n)&&(l=0,c=r.length),s._chart=this.chart,s._datasetIndex=this.index,s._decimated=!!i._decimated,s.points=r;const u=this.resolveDatasetElementOptions(t);this.options.showLine||(u.borderWidth=0),u.segment=this.options.segment,this.updateElement(s,void 0,{animated:!o,options:u},t),this.updateElements(r,l,c,t)}updateElements(t,n,s,r){const i=r==="reset",{iScale:o,vScale:l,_stacked:c,_dataset:u}=this._cachedMeta,{sharedOptions:d,includeOptions:h}=this._getSharedOptions(n,r),p=o.axis,x=l.axis,{spanGaps:v,segment:j}=this.options,y=Zp(v)?v:Number.POSITIVE_INFINITY,N=this.chart._animationsDisabled||i||r==="none",w=n+s,S=t.length;let _=n>0&&this.getParsed(n-1);for(let k=0;k<S;++k){const T=t[k],A=N?T:{};if(k<n||k>=w){A.skip=!0;continue}const E=this.getParsed(k),M=Pa(E[x]),z=A[p]=o.getPixelForValue(E[p],k),P=A[x]=i||M?l.getBasePixel():l.getPixelForValue(c?this.applyStack(l,E,c):E[x],k);A.skip=isNaN(z)||isNaN(P)||M,A.stop=k>0&&Math.abs(E[p]-_[p])>y,j&&(A.parsed=E,A.raw=u.data[k]),h&&(A.options=d||this.resolveDataElementOptions(k,T.active?"active":r)),N||this.updateElement(T,k,A,r),_=E}}getMaxOverflow(){const t=this._cachedMeta,n=t.dataset,s=n.options&&n.options.borderWidth||0,r=t.data||[];if(!r.length)return s;const i=r[0].size(this.resolveDataElementOptions(0)),o=r[r.length-1].size(this.resolveDataElementOptions(r.length-1));return Math.max(s,i,o)/2}draw(){const t=this._cachedMeta;t.dataset.updateControlPoints(this.chart.chartArea,t.iScale.axis),super.draw()}}class FHe extends RHe{static id="pie";static defaults={cutout:0,rotation:0,circumference:360,radius:"100%"}}function Jd(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class b3{static override(t){Object.assign(b3.prototype,t)}options;constructor(t){this.options=t||{}}init(){}formats(){return Jd()}parse(){return Jd()}format(){return Jd()}add(){return Jd()}diff(){return Jd()}startOf(){return Jd()}endOf(){return Jd()}}var UHe={_date:b3};function BHe(e,t,n,s){const{controller:r,data:i,_sorted:o}=e,l=r._cachedMeta.iScale,c=e.dataset&&e.dataset.options?e.dataset.options.spanGaps:null;if(l&&t===l.axis&&t!=="r"&&o&&i.length){const u=l._reversePixels?aBe:bu;if(s){if(r._sharedOptions){const d=i[0],h=typeof d.getRange=="function"&&d.getRange(t);if(h){const p=u(i,t,n-h),x=u(i,t,n+h);return{lo:p.lo,hi:x.hi}}}}else{const d=u(i,t,n);if(c){const{vScale:h}=r._cachedMeta,{_parsed:p}=e,x=p.slice(0,d.lo+1).reverse().findIndex(j=>!Pa(j[h.axis]));d.lo-=Math.max(0,x);const v=p.slice(d.hi).findIndex(j=>!Pa(j[h.axis]));d.hi+=Math.max(0,v)}return d}}return{lo:0,hi:i.length-1}}function D1(e,t,n,s,r){const i=e.getSortedVisibleDatasetMetas(),o=n[t];for(let l=0,c=i.length;l<c;++l){const{index:u,data:d}=i[l],{lo:h,hi:p}=BHe(i[l],t,o,r);for(let x=h;x<=p;++x){const v=d[x];v.skip||s(v,u,x)}}}function HHe(e){const t=e.indexOf("x")!==-1,n=e.indexOf("y")!==-1;return function(s,r){const i=t?Math.abs(s.x-r.x):0,o=n?Math.abs(s.y-r.y):0;return Math.sqrt(Math.pow(i,2)+Math.pow(o,2))}}function vT(e,t,n,s,r){const i=[];return!r&&!e.isPointInArea(t)||D1(e,n,t,function(l,c,u){!r&&!ex(l,e.chartArea,0)||l.inRange(t.x,t.y,s)&&i.push({element:l,datasetIndex:c,index:u})},!0),i}function qHe(e,t,n,s){let r=[];function i(o,l,c){const{startAngle:u,endAngle:d}=o.getProps(["startAngle","endAngle"],s),{angle:h}=DJ(o,{x:t.x,y:t.y});Jp(h,u,d)&&r.push({element:o,datasetIndex:l,index:c})}return D1(e,n,t,i),r}function GHe(e,t,n,s,r,i){let o=[];const l=HHe(n);let c=Number.POSITIVE_INFINITY;function u(d,h,p){const x=d.inRange(t.x,t.y,r);if(s&&!x)return;const v=d.getCenterPoint(r);if(!(!!i||e.isPointInArea(v))&&!x)return;const y=l(t,v);y<c?(o=[{element:d,datasetIndex:h,index:p}],c=y):y===c&&o.push({element:d,datasetIndex:h,index:p})}return D1(e,n,t,u),o}function wT(e,t,n,s,r,i){return!i&&!e.isPointInArea(t)?[]:n==="r"&&!s?qHe(e,t,n,r):GHe(e,t,n,s,r,i)}function hB(e,t,n,s,r){const i=[],o=n==="x"?"inXRange":"inYRange";let l=!1;return D1(e,n,t,(c,u,d)=>{c[o]&&c[o](t[n],r)&&(i.push({element:c,datasetIndex:u,index:d}),l=l||c.inRange(t.x,t.y,r))}),s&&!l?[]:i}var WHe={modes:{index(e,t,n,s){const r=iu(t,e),i=n.axis||"x",o=n.includeInvisible||!1,l=n.intersect?vT(e,r,i,s,o):wT(e,r,i,!1,s,o),c=[];return l.length?(e.getSortedVisibleDatasetMetas().forEach(u=>{const d=l[0].index,h=u.data[d];h&&!h.skip&&c.push({element:h,datasetIndex:u.index,index:d})}),c):[]},dataset(e,t,n,s){const r=iu(t,e),i=n.axis||"xy",o=n.includeInvisible||!1;let l=n.intersect?vT(e,r,i,s,o):wT(e,r,i,!1,s,o);if(l.length>0){const c=l[0].datasetIndex,u=e.getDatasetMeta(c).data;l=[];for(let d=0;d<u.length;++d)l.push({element:u[d],datasetIndex:c,index:d})}return l},point(e,t,n,s){const r=iu(t,e),i=n.axis||"xy",o=n.includeInvisible||!1;return vT(e,r,i,s,o)},nearest(e,t,n,s){const r=iu(t,e),i=n.axis||"xy",o=n.includeInvisible||!1;return wT(e,r,i,n.intersect,s,o)},x(e,t,n,s){const r=iu(t,e);return hB(e,r,"x",n.intersect,s)},y(e,t,n,s){const r=iu(t,e);return hB(e,r,"y",n.intersect,s)}}};const ZJ=["left","top","right","bottom"];function Og(e,t){return e.filter(n=>n.pos===t)}function gB(e,t){return e.filter(n=>ZJ.indexOf(n.pos)===-1&&n.box.axis===t)}function Mg(e,t){return e.sort((n,s)=>{const r=t?s:n,i=t?n:s;return r.weight===i.weight?r.index-i.index:r.weight-i.weight})}function VHe(e){const t=[];let n,s,r,i,o,l;for(n=0,s=(e||[]).length;n<s;++n)r=e[n],{position:i,options:{stack:o,stackWeight:l=1}}=r,t.push({index:n,box:r,pos:i,horizontal:r.isHorizontal(),weight:r.weight,stack:o&&i+o,stackWeight:l});return t}function YHe(e){const t={};for(const n of e){const{stack:s,pos:r,stackWeight:i}=n;if(!s||!ZJ.includes(r))continue;const o=t[s]||(t[s]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=i}return t}function QHe(e,t){const n=YHe(e),{vBoxMaxWidth:s,hBoxMaxHeight:r}=t;let i,o,l;for(i=0,o=e.length;i<o;++i){l=e[i];const{fullSize:c}=l.box,u=n[l.stack],d=u&&l.stackWeight/u.weight;l.horizontal?(l.width=d?d*s:c&&t.availableWidth,l.height=r):(l.width=s,l.height=d?d*r:c&&t.availableHeight)}return n}function KHe(e){const t=VHe(e),n=Mg(t.filter(u=>u.box.fullSize),!0),s=Mg(Og(t,"left"),!0),r=Mg(Og(t,"right")),i=Mg(Og(t,"top"),!0),o=Mg(Og(t,"bottom")),l=gB(t,"x"),c=gB(t,"y");return{fullSize:n,leftAndTop:s.concat(i),rightAndBottom:r.concat(c).concat(o).concat(l),chartArea:Og(t,"chartArea"),vertical:s.concat(r).concat(c),horizontal:i.concat(o).concat(l)}}function pB(e,t,n,s){return Math.max(e[n],t[n])+Math.max(e[s],t[s])}function JJ(e,t){e.top=Math.max(e.top,t.top),e.left=Math.max(e.left,t.left),e.bottom=Math.max(e.bottom,t.bottom),e.right=Math.max(e.right,t.right)}function XHe(e,t,n,s){const{pos:r,box:i}=n,o=e.maxPadding;if(!Ca(r)){n.size&&(e[r]-=n.size);const h=s[n.stack]||{size:0,count:1};h.size=Math.max(h.size,n.horizontal?i.height:i.width),n.size=h.size/h.count,e[r]+=n.size}i.getPadding&&JJ(o,i.getPadding());const l=Math.max(0,t.outerWidth-pB(o,e,"left","right")),c=Math.max(0,t.outerHeight-pB(o,e,"top","bottom")),u=l!==e.w,d=c!==e.h;return e.w=l,e.h=c,n.horizontal?{same:u,other:d}:{same:d,other:u}}function ZHe(e){const t=e.maxPadding;function n(s){const r=Math.max(t[s]-e[s],0);return e[s]+=r,r}e.y+=n("top"),e.x+=n("left"),n("right"),n("bottom")}function JHe(e,t){const n=t.maxPadding;function s(r){const i={left:0,top:0,right:0,bottom:0};return r.forEach(o=>{i[o]=Math.max(t[o],n[o])}),i}return s(e?["left","right"]:["top","bottom"])}function ep(e,t,n,s){const r=[];let i,o,l,c,u,d;for(i=0,o=e.length,u=0;i<o;++i){l=e[i],c=l.box,c.update(l.width||t.w,l.height||t.h,JHe(l.horizontal,t));const{same:h,other:p}=XHe(t,n,l,s);u|=h&&r.length,d=d||p,c.fullSize||r.push(l)}return u&&ep(r,t,n,s)||d}function Hb(e,t,n,s,r){e.top=n,e.left=t,e.right=t+s,e.bottom=n+r,e.width=s,e.height=r}function xB(e,t,n,s){const r=n.padding;let{x:i,y:o}=t;for(const l of e){const c=l.box,u=s[l.stack]||{placed:0,weight:1},d=l.stackWeight/u.weight||1;if(l.horizontal){const h=t.w*d,p=u.size||c.height;Xp(u.start)&&(o=u.start),c.fullSize?Hb(c,r.left,o,n.outerWidth-r.right-r.left,p):Hb(c,t.left+u.placed,o,h,p),u.start=o,u.placed+=h,o=c.bottom}else{const h=t.h*d,p=u.size||c.width;Xp(u.start)&&(i=u.start),c.fullSize?Hb(c,i,r.top,p,n.outerHeight-r.bottom-r.top):Hb(c,i,t.top+u.placed,p,h),u.start=i,u.placed+=h,i=c.right}}t.x=i,t.y=o}var pi={addBox(e,t){e.boxes||(e.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(n){t.draw(n)}}]},e.boxes.push(t)},removeBox(e,t){const n=e.boxes?e.boxes.indexOf(t):-1;n!==-1&&e.boxes.splice(n,1)},configure(e,t,n){t.fullSize=n.fullSize,t.position=n.position,t.weight=n.weight},update(e,t,n,s){if(!e)return;const r=Si(e.options.layout.padding),i=Math.max(t-r.width,0),o=Math.max(n-r.height,0),l=KHe(e.boxes),c=l.vertical,u=l.horizontal;$a(e.boxes,j=>{typeof j.beforeLayout=="function"&&j.beforeLayout()});const d=c.reduce((j,y)=>y.box.options&&y.box.options.display===!1?j:j+1,0)||1,h=Object.freeze({outerWidth:t,outerHeight:n,padding:r,availableWidth:i,availableHeight:o,vBoxMaxWidth:i/2/d,hBoxMaxHeight:o/2}),p=Object.assign({},r);JJ(p,Si(s));const x=Object.assign({maxPadding:p,w:i,h:o,x:r.left,y:r.top},r),v=QHe(c.concat(u),h);ep(l.fullSize,x,h,v),ep(c,x,h,v),ep(u,x,h,v)&&ep(c,x,h,v),ZHe(x),xB(l.leftAndTop,x,h,v),x.x+=x.w,x.y+=x.h,xB(l.rightAndBottom,x,h,v),e.chartArea={left:x.left,top:x.top,right:x.left+x.w,bottom:x.top+x.h,height:x.h,width:x.w},$a(l.chartArea,j=>{const y=j.box;Object.assign(y,e.chartArea),y.update(x.w,x.h,{left:0,top:0,right:0,bottom:0})})}};class eee{acquireContext(t,n){}releaseContext(t){return!1}addEventListener(t,n,s){}removeEventListener(t,n,s){}getDevicePixelRatio(){return 1}getMaximumSize(t,n,s,r){return n=Math.max(0,n||t.width),s=s||t.height,{width:n,height:Math.max(0,r?Math.floor(n/r):s)}}isAttached(t){return!0}updateConfig(t){}}class e9e extends eee{acquireContext(t){return t&&t.getContext&&t.getContext("2d")||null}updateConfig(t){t.options.animation=!1}}const jv="$chartjs",t9e={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},yB=e=>e===null||e==="";function a9e(e,t){const n=e.style,s=e.getAttribute("height"),r=e.getAttribute("width");if(e[jv]={initial:{height:s,width:r,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",yB(r)){const i=tB(e,"width");i!==void 0&&(e.width=i)}if(yB(s))if(e.style.height==="")e.height=e.width/(t||2);else{const i=tB(e,"height");i!==void 0&&(e.height=i)}return e}const tee=XBe?{passive:!0}:!1;function n9e(e,t,n){e&&e.addEventListener(t,n,tee)}function s9e(e,t,n){e&&e.canvas&&e.canvas.removeEventListener(t,n,tee)}function r9e(e,t){const n=t9e[e.type]||e.type,{x:s,y:r}=iu(e,t);return{type:n,chart:t,native:e,x:s!==void 0?s:null,y:r!==void 0?r:null}}function tj(e,t){for(const n of e)if(n===t||n.contains(t))return!0}function i9e(e,t,n){const s=e.canvas,r=new MutationObserver(i=>{let o=!1;for(const l of i)o=o||tj(l.addedNodes,s),o=o&&!tj(l.removedNodes,s);o&&n()});return r.observe(document,{childList:!0,subtree:!0}),r}function o9e(e,t,n){const s=e.canvas,r=new MutationObserver(i=>{let o=!1;for(const l of i)o=o||tj(l.removedNodes,s),o=o&&!tj(l.addedNodes,s);o&&n()});return r.observe(document,{childList:!0,subtree:!0}),r}const ax=new Map;let bB=0;function aee(){const e=window.devicePixelRatio;e!==bB&&(bB=e,ax.forEach((t,n)=>{n.currentDevicePixelRatio!==e&&t()}))}function l9e(e,t){ax.size||window.addEventListener("resize",aee),ax.set(e,t)}function c9e(e){ax.delete(e),ax.size||window.removeEventListener("resize",aee)}function d9e(e,t,n){const s=e.canvas,r=s&&y3(s);if(!r)return;const i=$J((l,c)=>{const u=r.clientWidth;n(l,c),u<r.clientWidth&&n()},window),o=new ResizeObserver(l=>{const c=l[0],u=c.contentRect.width,d=c.contentRect.height;u===0&&d===0||i(u,d)});return o.observe(r),l9e(e,i),o}function jT(e,t,n){n&&n.disconnect(),t==="resize"&&c9e(e)}function u9e(e,t,n){const s=e.canvas,r=$J(i=>{e.ctx!==null&&n(r9e(i,e))},e);return n9e(s,t,r),r}class m9e extends eee{acquireContext(t,n){const s=t&&t.getContext&&t.getContext("2d");return s&&s.canvas===t?(a9e(t,n),s):null}releaseContext(t){const n=t.canvas;if(!n[jv])return!1;const s=n[jv].initial;["height","width"].forEach(i=>{const o=s[i];Pa(o)?n.removeAttribute(i):n.setAttribute(i,o)});const r=s.style||{};return Object.keys(r).forEach(i=>{n.style[i]=r[i]}),n.width=n.width,delete n[jv],!0}addEventListener(t,n,s){this.removeEventListener(t,n);const r=t.$proxies||(t.$proxies={}),o={attach:i9e,detach:o9e,resize:d9e}[n]||u9e;r[n]=o(t,n,s)}removeEventListener(t,n){const s=t.$proxies||(t.$proxies={}),r=s[n];if(!r)return;({attach:jT,detach:jT,resize:jT}[n]||s9e)(t,n,r),s[n]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(t,n,s,r){return KBe(t,n,s,r)}isAttached(t){const n=t&&y3(t);return!!(n&&n.isConnected)}}function f9e(e){return!x3()||typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas?e9e:m9e}let hc=class{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(t){const{x:n,y:s}=this.getProps(["x","y"],t);return{x:n,y:s}}hasValue(){return Zp(this.x)&&Zp(this.y)}getProps(t,n){const s=this.$animations;if(!n||!s)return this;const r={};return t.forEach(i=>{r[i]=s[i]&&s[i].active()?s[i]._to:this[i]}),r}};function h9e(e,t){const n=e.options.ticks,s=g9e(e),r=Math.min(n.maxTicksLimit||s,s),i=n.major.enabled?x9e(t):[],o=i.length,l=i[0],c=i[o-1],u=[];if(o>r)return y9e(t,u,i,o/r),u;const d=p9e(i,t,r);if(o>0){let h,p;const x=o>1?Math.round((c-l)/(o-1)):null;for(qb(t,u,d,Pa(x)?0:l-x,l),h=0,p=o-1;h<p;h++)qb(t,u,d,i[h],i[h+1]);return qb(t,u,d,c,Pa(x)?t.length:c+x),u}return qb(t,u,d),u}function g9e(e){const t=e.options.offset,n=e._tickSize(),s=e._length/n+(t?0:1),r=e._maxLength/n;return Math.floor(Math.min(s,r))}function p9e(e,t,n){const s=b9e(e),r=t.length/n;if(!s)return Math.max(r,1);const i=Q8e(s);for(let o=0,l=i.length-1;o<l;o++){const c=i[o];if(c>r)return c}return Math.max(r,1)}function x9e(e){const t=[];let n,s;for(n=0,s=e.length;n<s;n++)e[n].major&&t.push(n);return t}function y9e(e,t,n,s){let r=0,i=n[0],o;for(s=Math.ceil(s),o=0;o<e.length;o++)o===i&&(t.push(e[o]),r++,i=n[r*s])}function qb(e,t,n,s,r){const i=ma(s,0),o=Math.min(ma(r,e.length),e.length);let l=0,c,u,d;for(n=Math.ceil(n),r&&(c=r-s,n=c/Math.floor(c/n)),d=i;d<0;)l++,d=Math.round(i+l*n);for(u=Math.max(i,0);u<o;u++)u===d&&(t.push(e[u]),l++,d=Math.round(i+l*n))}function b9e(e){const t=e.length;let n,s;if(t<2)return!1;for(s=e[0],n=1;n<t;++n)if(e[n]-e[n-1]!==s)return!1;return s}const v9e=e=>e==="left"?"right":e==="right"?"left":e,vB=(e,t,n)=>t==="top"||t==="left"?e[t]+n:e[t]-n,wB=(e,t)=>Math.min(t||e,e);function jB(e,t){const n=[],s=e.length/t,r=e.length;let i=0;for(;i<r;i+=s)n.push(e[Math.floor(i)]);return n}function w9e(e,t,n){const s=e.ticks.length,r=Math.min(t,s-1),i=e._startPixel,o=e._endPixel,l=1e-6;let c=e.getPixelForTick(r),u;if(!(n&&(s===1?u=Math.max(c-i,o-c):t===0?u=(e.getPixelForTick(1)-c)/2:u=(c-e.getPixelForTick(r-1))/2,c+=r<t?u:-u,c<i-l||c>o+l)))return c}function j9e(e,t){$a(e,n=>{const s=n.gc,r=s.length/2;let i;if(r>t){for(i=0;i<r;++i)delete n.data[s[i]];s.splice(0,r)}})}function Ig(e){return e.drawTicks?e.tickLength:0}function NB(e,t){if(!e.display)return 0;const n=$s(e.font,t),s=Si(e.padding);return(ss(e.text)?e.text.length:1)*n.lineHeight+s.height}function N9e(e,t){return lm(e,{scale:t,type:"scale"})}function C9e(e,t,n){return lm(e,{tick:n,index:t,type:"tick"})}function S9e(e,t,n){let s=l3(e);return(n&&t!=="right"||!n&&t==="right")&&(s=v9e(s)),s}function _9e(e,t,n,s){const{top:r,left:i,bottom:o,right:l,chart:c}=e,{chartArea:u,scales:d}=c;let h=0,p,x,v;const j=o-r,y=l-i;if(e.isHorizontal()){if(x=Ps(s,i,l),Ca(n)){const N=Object.keys(n)[0],w=n[N];v=d[N].getPixelForValue(w)+j-t}else n==="center"?v=(u.bottom+u.top)/2+j-t:v=vB(e,n,t);p=l-i}else{if(Ca(n)){const N=Object.keys(n)[0],w=n[N];x=d[N].getPixelForValue(w)-y+t}else n==="center"?x=(u.left+u.right)/2-y+t:x=vB(e,n,t);v=Ps(s,o,r),h=n==="left"?-rs:rs}return{titleX:x,titleY:v,maxWidth:p,rotation:h}}class Nh extends hc{constructor(t){super(),this.id=t.id,this.type=t.type,this.options=void 0,this.ctx=t.ctx,this.chart=t.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(t){this.options=t.setContext(this.getContext()),this.axis=t.axis,this._userMin=this.parse(t.min),this._userMax=this.parse(t.max),this._suggestedMin=this.parse(t.suggestedMin),this._suggestedMax=this.parse(t.suggestedMax)}parse(t,n){return t}getUserBounds(){let{_userMin:t,_userMax:n,_suggestedMin:s,_suggestedMax:r}=this;return t=bo(t,Number.POSITIVE_INFINITY),n=bo(n,Number.NEGATIVE_INFINITY),s=bo(s,Number.POSITIVE_INFINITY),r=bo(r,Number.NEGATIVE_INFINITY),{min:bo(t,s),max:bo(n,r),minDefined:Ci(t),maxDefined:Ci(n)}}getMinMax(t){let{min:n,max:s,minDefined:r,maxDefined:i}=this.getUserBounds(),o;if(r&&i)return{min:n,max:s};const l=this.getMatchingVisibleMetas();for(let c=0,u=l.length;c<u;++c)o=l[c].controller.getMinMax(this,t),r||(n=Math.min(n,o.min)),i||(s=Math.max(s,o.max));return n=i&&n>s?s:n,s=r&&n>s?n:s,{min:bo(n,bo(s,n)),max:bo(s,bo(n,s))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]}getLabelItems(t=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(t))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){nn(this.options.beforeUpdate,[this])}update(t,n,s){const{beginAtZero:r,grace:i,ticks:o}=this.options,l=o.sampleSize;this.beforeUpdate(),this.maxWidth=t,this.maxHeight=n,this._margins=s=Object.assign({left:0,right:0,top:0,bottom:0},s),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+s.left+s.right:this.height+s.top+s.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=TBe(this,i,r),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const c=l<this.ticks.length;this._convertTicksToLabels(c?jB(this.ticks,l):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||o.source==="auto")&&(this.ticks=h9e(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),c&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let t=this.options.reverse,n,s;this.isHorizontal()?(n=this.left,s=this.right):(n=this.top,s=this.bottom,t=!t),this._startPixel=n,this._endPixel=s,this._reversePixels=t,this._length=s-n,this._alignToPixels=this.options.alignToPixels}afterUpdate(){nn(this.options.afterUpdate,[this])}beforeSetDimensions(){nn(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){nn(this.options.afterSetDimensions,[this])}_callHooks(t){this.chart.notifyPlugins(t,this.getContext()),nn(this.options[t],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){nn(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(t){const n=this.options.ticks;let s,r,i;for(s=0,r=t.length;s<r;s++)i=t[s],i.label=nn(n.callback,[i.value,s,t],this)}afterTickToLabelConversion(){nn(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){nn(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const t=this.options,n=t.ticks,s=wB(this.ticks.length,t.ticks.maxTicksLimit),r=n.minRotation||0,i=n.maxRotation;let o=r,l,c,u;if(!this._isVisible()||!n.display||r>=i||s<=1||!this.isHorizontal()){this.labelRotation=r;return}const d=this._getLabelSizes(),h=d.widest.width,p=d.highest.height,x=Is(this.chart.width-h,0,this.maxWidth);l=t.offset?this.maxWidth/s:x/(s-1),h+6>l&&(l=x/(s-(t.offset?.5:1)),c=this.maxHeight-Ig(t.grid)-n.padding-NB(t.title,this.chart.options.font),u=Math.sqrt(h*h+p*p),o=J8e(Math.min(Math.asin(Is((d.highest.height+6)/l,-1,1)),Math.asin(Is(c/u,-1,1))-Math.asin(Is(p/u,-1,1)))),o=Math.max(r,Math.min(i,o))),this.labelRotation=o}afterCalculateLabelRotation(){nn(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){nn(this.options.beforeFit,[this])}fit(){const t={width:0,height:0},{chart:n,options:{ticks:s,title:r,grid:i}}=this,o=this._isVisible(),l=this.isHorizontal();if(o){const c=NB(r,n.options.font);if(l?(t.width=this.maxWidth,t.height=Ig(i)+c):(t.height=this.maxHeight,t.width=Ig(i)+c),s.display&&this.ticks.length){const{first:u,last:d,widest:h,highest:p}=this._getLabelSizes(),x=s.padding*2,v=Dl(this.labelRotation),j=Math.cos(v),y=Math.sin(v);if(l){const N=s.mirror?0:y*h.width+j*p.height;t.height=Math.min(this.maxHeight,t.height+N+x)}else{const N=s.mirror?0:j*h.width+y*p.height;t.width=Math.min(this.maxWidth,t.width+N+x)}this._calculatePadding(u,d,y,j)}}this._handleMargins(),l?(this.width=this._length=n.width-this._margins.left-this._margins.right,this.height=t.height):(this.width=t.width,this.height=this._length=n.height-this._margins.top-this._margins.bottom)}_calculatePadding(t,n,s,r){const{ticks:{align:i,padding:o},position:l}=this.options,c=this.labelRotation!==0,u=l!=="top"&&this.axis==="x";if(this.isHorizontal()){const d=this.getPixelForTick(0)-this.left,h=this.right-this.getPixelForTick(this.ticks.length-1);let p=0,x=0;c?u?(p=r*t.width,x=s*n.height):(p=s*t.height,x=r*n.width):i==="start"?x=n.width:i==="end"?p=t.width:i!=="inner"&&(p=t.width/2,x=n.width/2),this.paddingLeft=Math.max((p-d+o)*this.width/(this.width-d),0),this.paddingRight=Math.max((x-h+o)*this.width/(this.width-h),0)}else{let d=n.height/2,h=t.height/2;i==="start"?(d=0,h=t.height):i==="end"&&(d=n.height,h=0),this.paddingTop=d+o,this.paddingBottom=h+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){nn(this.options.afterFit,[this])}isHorizontal(){const{axis:t,position:n}=this.options;return n==="top"||n==="bottom"||t==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(t){this.beforeTickToLabelConversion(),this.generateTickLabels(t);let n,s;for(n=0,s=t.length;n<s;n++)Pa(t[n].label)&&(t.splice(n,1),s--,n--);this.afterTickToLabelConversion()}_getLabelSizes(){let t=this._labelSizes;if(!t){const n=this.options.ticks.sampleSize;let s=this.ticks;n<s.length&&(s=jB(s,n)),this._labelSizes=t=this._computeLabelSizes(s,s.length,this.options.ticks.maxTicksLimit)}return t}_computeLabelSizes(t,n,s){const{ctx:r,_longestTextCache:i}=this,o=[],l=[],c=Math.floor(n/wB(n,s));let u=0,d=0,h,p,x,v,j,y,N,w,S,_,k;for(h=0;h<n;h+=c){if(v=t[h].label,j=this._resolveTickFontOptions(h),r.font=y=j.string,N=i[y]=i[y]||{data:{},gc:[]},w=j.lineHeight,S=_=0,!Pa(v)&&!ss(v))S=K8(r,N.data,N.gc,S,v),_=w;else if(ss(v))for(p=0,x=v.length;p<x;++p)k=v[p],!Pa(k)&&!ss(k)&&(S=K8(r,N.data,N.gc,S,k),_+=w);o.push(S),l.push(_),u=Math.max(S,u),d=Math.max(_,d)}j9e(i,n);const T=o.indexOf(u),A=l.indexOf(d),E=M=>({width:o[M]||0,height:l[M]||0});return{first:E(0),last:E(n-1),widest:E(T),highest:E(A),widths:o,heights:l}}getLabelForValue(t){return t}getPixelForValue(t,n){return NaN}getValueForPixel(t){}getPixelForTick(t){const n=this.ticks;return t<0||t>n.length-1?null:this.getPixelForValue(n[t].value)}getPixelForDecimal(t){this._reversePixels&&(t=1-t);const n=this._startPixel+t*this._length;return tBe(this._alignToPixels?Zd(this.chart,n,0):n)}getDecimalForPixel(t){const n=(t-this._startPixel)/this._length;return this._reversePixels?1-n:n}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:t,max:n}=this;return t<0&&n<0?n:t>0&&n>0?t:0}getContext(t){const n=this.ticks||[];if(t>=0&&t<n.length){const s=n[t];return s.$context||(s.$context=C9e(this.getContext(),t,s))}return this.$context||(this.$context=N9e(this.chart.getContext(),this))}_tickSize(){const t=this.options.ticks,n=Dl(this.labelRotation),s=Math.abs(Math.cos(n)),r=Math.abs(Math.sin(n)),i=this._getLabelSizes(),o=t.autoSkipPadding||0,l=i?i.widest.width+o:0,c=i?i.highest.height+o:0;return this.isHorizontal()?c*s>l*r?l/s:c/r:c*r<l*s?c/s:l/r}_isVisible(){const t=this.options.display;return t!=="auto"?!!t:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(t){const n=this.axis,s=this.chart,r=this.options,{grid:i,position:o,border:l}=r,c=i.offset,u=this.isHorizontal(),h=this.ticks.length+(c?1:0),p=Ig(i),x=[],v=l.setContext(this.getContext()),j=v.display?v.width:0,y=j/2,N=function(q){return Zd(s,q,j)};let w,S,_,k,T,A,E,M,z,P,D,U;if(o==="top")w=N(this.bottom),A=this.bottom-p,M=w-y,P=N(t.top)+y,U=t.bottom;else if(o==="bottom")w=N(this.top),P=t.top,U=N(t.bottom)-y,A=w+y,M=this.top+p;else if(o==="left")w=N(this.right),T=this.right-p,E=w-y,z=N(t.left)+y,D=t.right;else if(o==="right")w=N(this.left),z=t.left,D=N(t.right)-y,T=w+y,E=this.left+p;else if(n==="x"){if(o==="center")w=N((t.top+t.bottom)/2+.5);else if(Ca(o)){const q=Object.keys(o)[0],Z=o[q];w=N(this.chart.scales[q].getPixelForValue(Z))}P=t.top,U=t.bottom,A=w+y,M=A+p}else if(n==="y"){if(o==="center")w=N((t.left+t.right)/2);else if(Ca(o)){const q=Object.keys(o)[0],Z=o[q];w=N(this.chart.scales[q].getPixelForValue(Z))}T=w-y,E=T-p,z=t.left,D=t.right}const B=ma(r.ticks.maxTicksLimit,h),R=Math.max(1,Math.ceil(h/B));for(S=0;S<h;S+=R){const q=this.getContext(S),Z=i.setContext(q),V=l.setContext(q),oe=Z.lineWidth,je=Z.color,X=V.dash||[],se=V.dashOffset,ye=Z.tickWidth,Ne=Z.tickColor,fe=Z.tickBorderDash||[],we=Z.tickBorderDashOffset;_=w9e(this,S,c),_!==void 0&&(k=Zd(s,_,oe),u?T=E=z=D=k:A=M=P=U=k,x.push({tx1:T,ty1:A,tx2:E,ty2:M,x1:z,y1:P,x2:D,y2:U,width:oe,color:je,borderDash:X,borderDashOffset:se,tickWidth:ye,tickColor:Ne,tickBorderDash:fe,tickBorderDashOffset:we}))}return this._ticksLength=h,this._borderValue=w,x}_computeLabelItems(t){const n=this.axis,s=this.options,{position:r,ticks:i}=s,o=this.isHorizontal(),l=this.ticks,{align:c,crossAlign:u,padding:d,mirror:h}=i,p=Ig(s.grid),x=p+d,v=h?-d:x,j=-Dl(this.labelRotation),y=[];let N,w,S,_,k,T,A,E,M,z,P,D,U="middle";if(r==="top")T=this.bottom-v,A=this._getXAxisLabelAlignment();else if(r==="bottom")T=this.top+v,A=this._getXAxisLabelAlignment();else if(r==="left"){const R=this._getYAxisLabelAlignment(p);A=R.textAlign,k=R.x}else if(r==="right"){const R=this._getYAxisLabelAlignment(p);A=R.textAlign,k=R.x}else if(n==="x"){if(r==="center")T=(t.top+t.bottom)/2+x;else if(Ca(r)){const R=Object.keys(r)[0],q=r[R];T=this.chart.scales[R].getPixelForValue(q)+x}A=this._getXAxisLabelAlignment()}else if(n==="y"){if(r==="center")k=(t.left+t.right)/2-x;else if(Ca(r)){const R=Object.keys(r)[0],q=r[R];k=this.chart.scales[R].getPixelForValue(q)}A=this._getYAxisLabelAlignment(p).textAlign}n==="y"&&(c==="start"?U="top":c==="end"&&(U="bottom"));const B=this._getLabelSizes();for(N=0,w=l.length;N<w;++N){S=l[N],_=S.label;const R=i.setContext(this.getContext(N));E=this.getPixelForTick(N)+i.labelOffset,M=this._resolveTickFontOptions(N),z=M.lineHeight,P=ss(_)?_.length:1;const q=P/2,Z=R.color,V=R.textStrokeColor,oe=R.textStrokeWidth;let je=A;o?(k=E,A==="inner"&&(N===w-1?je=this.options.reverse?"left":"right":N===0?je=this.options.reverse?"right":"left":je="center"),r==="top"?u==="near"||j!==0?D=-P*z+z/2:u==="center"?D=-B.highest.height/2-q*z+z:D=-B.highest.height+z/2:u==="near"||j!==0?D=z/2:u==="center"?D=B.highest.height/2-q*z:D=B.highest.height-P*z,h&&(D*=-1),j!==0&&!R.showLabelBackdrop&&(k+=z/2*Math.sin(j))):(T=E,D=(1-P)*z/2);let X;if(R.showLabelBackdrop){const se=Si(R.backdropPadding),ye=B.heights[N],Ne=B.widths[N];let fe=D-se.top,we=0-se.left;switch(U){case"middle":fe-=ye/2;break;case"bottom":fe-=ye;break}switch(A){case"center":we-=Ne/2;break;case"right":we-=Ne;break;case"inner":N===w-1?we-=Ne:N>0&&(we-=Ne/2);break}X={left:we,top:fe,width:Ne+se.width,height:ye+se.height,color:R.backdropColor}}y.push({label:_,font:M,textOffset:D,options:{rotation:j,color:Z,strokeColor:V,strokeWidth:oe,textAlign:je,textBaseline:U,translation:[k,T],backdrop:X}})}return y}_getXAxisLabelAlignment(){const{position:t,ticks:n}=this.options;if(-Dl(this.labelRotation))return t==="top"?"left":"right";let r="center";return n.align==="start"?r="left":n.align==="end"?r="right":n.align==="inner"&&(r="inner"),r}_getYAxisLabelAlignment(t){const{position:n,ticks:{crossAlign:s,mirror:r,padding:i}}=this.options,o=this._getLabelSizes(),l=t+i,c=o.widest.width;let u,d;return n==="left"?r?(d=this.right+i,s==="near"?u="left":s==="center"?(u="center",d+=c/2):(u="right",d+=c)):(d=this.right-l,s==="near"?u="right":s==="center"?(u="center",d-=c/2):(u="left",d=this.left)):n==="right"?r?(d=this.left+i,s==="near"?u="right":s==="center"?(u="center",d-=c/2):(u="left",d-=c)):(d=this.left+l,s==="near"?u="left":s==="center"?(u="center",d+=c/2):(u="right",d=this.right)):u="right",{textAlign:u,x:d}}_computeLabelArea(){if(this.options.ticks.mirror)return;const t=this.chart,n=this.options.position;if(n==="left"||n==="right")return{top:0,left:this.left,bottom:t.height,right:this.right};if(n==="top"||n==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:t.width}}drawBackground(){const{ctx:t,options:{backgroundColor:n},left:s,top:r,width:i,height:o}=this;n&&(t.save(),t.fillStyle=n,t.fillRect(s,r,i,o),t.restore())}getLineWidthForValue(t){const n=this.options.grid;if(!this._isVisible()||!n.display)return 0;const r=this.ticks.findIndex(i=>i.value===t);return r>=0?n.setContext(this.getContext(r)).lineWidth:0}drawGrid(t){const n=this.options.grid,s=this.ctx,r=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(t));let i,o;const l=(c,u,d)=>{!d.width||!d.color||(s.save(),s.lineWidth=d.width,s.strokeStyle=d.color,s.setLineDash(d.borderDash||[]),s.lineDashOffset=d.borderDashOffset,s.beginPath(),s.moveTo(c.x,c.y),s.lineTo(u.x,u.y),s.stroke(),s.restore())};if(n.display)for(i=0,o=r.length;i<o;++i){const c=r[i];n.drawOnChartArea&&l({x:c.x1,y:c.y1},{x:c.x2,y:c.y2},c),n.drawTicks&&l({x:c.tx1,y:c.ty1},{x:c.tx2,y:c.ty2},{color:c.tickColor,width:c.tickWidth,borderDash:c.tickBorderDash,borderDashOffset:c.tickBorderDashOffset})}}drawBorder(){const{chart:t,ctx:n,options:{border:s,grid:r}}=this,i=s.setContext(this.getContext()),o=s.display?i.width:0;if(!o)return;const l=r.setContext(this.getContext(0)).lineWidth,c=this._borderValue;let u,d,h,p;this.isHorizontal()?(u=Zd(t,this.left,o)-o/2,d=Zd(t,this.right,l)+l/2,h=p=c):(h=Zd(t,this.top,o)-o/2,p=Zd(t,this.bottom,l)+l/2,u=d=c),n.save(),n.lineWidth=i.width,n.strokeStyle=i.color,n.beginPath(),n.moveTo(u,h),n.lineTo(d,p),n.stroke(),n.restore()}drawLabels(t){if(!this.options.ticks.display)return;const s=this.ctx,r=this._computeLabelArea();r&&u3(s,r);const i=this.getLabelItems(t);for(const o of i){const l=o.options,c=o.font,u=o.label,d=o.textOffset;tx(s,u,0,d,c,l)}r&&m3(s)}drawTitle(){const{ctx:t,options:{position:n,title:s,reverse:r}}=this;if(!s.display)return;const i=$s(s.font),o=Si(s.padding),l=s.align;let c=i.lineHeight/2;n==="bottom"||n==="center"||Ca(n)?(c+=o.bottom,ss(s.text)&&(c+=i.lineHeight*(s.text.length-1))):c+=o.top;const{titleX:u,titleY:d,maxWidth:h,rotation:p}=_9e(this,c,n,l);tx(t,s.text,0,0,i,{color:s.color,maxWidth:h,rotation:p,textAlign:S9e(l,n,r),textBaseline:"middle",translation:[u,d]})}draw(t){this._isVisible()&&(this.drawBackground(),this.drawGrid(t),this.drawBorder(),this.drawTitle(),this.drawLabels(t))}_layers(){const t=this.options,n=t.ticks&&t.ticks.z||0,s=ma(t.grid&&t.grid.z,-1),r=ma(t.border&&t.border.z,0);return!this._isVisible()||this.draw!==Nh.prototype.draw?[{z:n,draw:i=>{this.draw(i)}}]:[{z:s,draw:i=>{this.drawBackground(),this.drawGrid(i),this.drawTitle()}},{z:r,draw:()=>{this.drawBorder()}},{z:n,draw:i=>{this.drawLabels(i)}}]}getMatchingVisibleMetas(t){const n=this.chart.getSortedVisibleDatasetMetas(),s=this.axis+"AxisID",r=[];let i,o;for(i=0,o=n.length;i<o;++i){const l=n[i];l[s]===this.id&&(!t||l.type===t)&&r.push(l)}return r}_resolveTickFontOptions(t){const n=this.options.ticks.setContext(this.getContext(t));return $s(n.font)}_maxDigits(){const t=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/t}}class Gb{constructor(t,n,s){this.type=t,this.scope=n,this.override=s,this.items=Object.create(null)}isForType(t){return Object.prototype.isPrototypeOf.call(this.type.prototype,t.prototype)}register(t){const n=Object.getPrototypeOf(t);let s;k9e(n)&&(s=this.register(n));const r=this.items,i=t.id,o=this.scope+"."+i;if(!i)throw new Error("class does not have id: "+t);return i in r||(r[i]=t,A9e(t,o,s),this.override&&On.override(t.id,t.overrides)),o}get(t){return this.items[t]}unregister(t){const n=this.items,s=t.id,r=this.scope;s in n&&delete n[s],r&&s in On[r]&&(delete On[r][s],this.override&&delete Qu[s])}}function A9e(e,t,n){const s=Kp(Object.create(null),[n?On.get(n):{},On.get(t),e.defaults]);On.set(t,s),e.defaultRoutes&&T9e(t,e.defaultRoutes),e.descriptors&&On.describe(t,e.descriptors)}function T9e(e,t){Object.keys(t).forEach(n=>{const s=n.split("."),r=s.pop(),i=[e].concat(s).join("."),o=t[n].split("."),l=o.pop(),c=o.join(".");On.route(i,r,c,l)})}function k9e(e){return"id"in e&&"defaults"in e}class E9e{constructor(){this.controllers=new Gb(P1,"datasets",!0),this.elements=new Gb(hc,"elements"),this.plugins=new Gb(Object,"plugins"),this.scales=new Gb(Nh,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...t){this._each("register",t)}remove(...t){this._each("unregister",t)}addControllers(...t){this._each("register",t,this.controllers)}addElements(...t){this._each("register",t,this.elements)}addPlugins(...t){this._each("register",t,this.plugins)}addScales(...t){this._each("register",t,this.scales)}getController(t){return this._get(t,this.controllers,"controller")}getElement(t){return this._get(t,this.elements,"element")}getPlugin(t){return this._get(t,this.plugins,"plugin")}getScale(t){return this._get(t,this.scales,"scale")}removeControllers(...t){this._each("unregister",t,this.controllers)}removeElements(...t){this._each("unregister",t,this.elements)}removePlugins(...t){this._each("unregister",t,this.plugins)}removeScales(...t){this._each("unregister",t,this.scales)}_each(t,n,s){[...n].forEach(r=>{const i=s||this._getRegistryForType(r);s||i.isForType(r)||i===this.plugins&&r.id?this._exec(t,i,r):$a(r,o=>{const l=s||this._getRegistryForType(o);this._exec(t,l,o)})})}_exec(t,n,s){const r=i3(t);nn(s["before"+r],[],s),n[t](s),nn(s["after"+r],[],s)}_getRegistryForType(t){for(let n=0;n<this._typedRegistries.length;n++){const s=this._typedRegistries[n];if(s.isForType(t))return s}return this.plugins}_get(t,n,s){const r=n.get(t);if(r===void 0)throw new Error('"'+t+'" is not a registered '+s+".");return r}}var Co=new E9e;class L9e{constructor(){this._init=void 0}notify(t,n,s,r){if(n==="beforeInit"&&(this._init=this._createDescriptors(t,!0),this._notify(this._init,t,"install")),this._init===void 0)return;const i=r?this._descriptors(t).filter(r):this._descriptors(t),o=this._notify(i,t,n,s);return n==="afterDestroy"&&(this._notify(i,t,"stop"),this._notify(this._init,t,"uninstall"),this._init=void 0),o}_notify(t,n,s,r){r=r||{};for(const i of t){const o=i.plugin,l=o[s],c=[n,r,i.options];if(nn(l,c,o)===!1&&r.cancelable)return!1}return!0}invalidate(){Pa(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(t){if(this._cache)return this._cache;const n=this._cache=this._createDescriptors(t);return this._notifyStateChanges(t),n}_createDescriptors(t,n){const s=t&&t.config,r=ma(s.options&&s.options.plugins,{}),i=P9e(s);return r===!1&&!n?[]:O9e(t,i,r,n)}_notifyStateChanges(t){const n=this._oldCache||[],s=this._cache,r=(i,o)=>i.filter(l=>!o.some(c=>l.plugin.id===c.plugin.id));this._notify(r(n,s),t,"stop"),this._notify(r(s,n),t,"start")}}function P9e(e){const t={},n=[],s=Object.keys(Co.plugins.items);for(let i=0;i<s.length;i++)n.push(Co.getPlugin(s[i]));const r=e.plugins||[];for(let i=0;i<r.length;i++){const o=r[i];n.indexOf(o)===-1&&(n.push(o),t[o.id]=!0)}return{plugins:n,localIds:t}}function D9e(e,t){return!t&&e===!1?null:e===!0?{}:e}function O9e(e,{plugins:t,localIds:n},s,r){const i=[],o=e.getContext();for(const l of t){const c=l.id,u=D9e(s[c],r);u!==null&&i.push({plugin:l,options:M9e(e.config,{plugin:l,local:n[c]},u,o)})}return i}function M9e(e,{plugin:t,local:n},s,r){const i=e.pluginScopeKeys(t),o=e.getOptionScopes(s,i);return n&&t.defaults&&o.push(t.defaults),e.createResolver(o,r,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function lL(e,t){const n=On.datasets[e]||{};return((t.datasets||{})[e]||{}).indexAxis||t.indexAxis||n.indexAxis||"x"}function I9e(e,t){let n=e;return e==="_index_"?n=t:e==="_value_"&&(n=t==="x"?"y":"x"),n}function $9e(e,t){return e===t?"_index_":"_value_"}function CB(e){if(e==="x"||e==="y"||e==="r")return e}function R9e(e){if(e==="top"||e==="bottom")return"x";if(e==="left"||e==="right")return"y"}function cL(e,...t){if(CB(e))return e;for(const n of t){const s=n.axis||R9e(n.position)||e.length>1&&CB(e[0].toLowerCase());if(s)return s}throw new Error(`Cannot determine type of '${e}' axis. Please provide 'axis' or 'position' option.`)}function SB(e,t,n){if(n[t+"AxisID"]===e)return{axis:t}}function z9e(e,t){if(t.data&&t.data.datasets){const n=t.data.datasets.filter(s=>s.xAxisID===e||s.yAxisID===e);if(n.length)return SB(e,"x",n[0])||SB(e,"y",n[0])}return{}}function F9e(e,t){const n=Qu[e.type]||{scales:{}},s=t.scales||{},r=lL(e.type,t),i=Object.create(null);return Object.keys(s).forEach(o=>{const l=s[o];if(!Ca(l))return console.error(`Invalid scale configuration for scale: ${o}`);if(l._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${o}`);const c=cL(o,l,z9e(o,e),On.scales[l.type]),u=$9e(c,r),d=n.scales||{};i[o]=mp(Object.create(null),[{axis:c},l,d[c],d[u]])}),e.data.datasets.forEach(o=>{const l=o.type||e.type,c=o.indexAxis||lL(l,t),d=(Qu[l]||{}).scales||{};Object.keys(d).forEach(h=>{const p=I9e(h,c),x=o[p+"AxisID"]||p;i[x]=i[x]||Object.create(null),mp(i[x],[{axis:p},s[x],d[h]])})}),Object.keys(i).forEach(o=>{const l=i[o];mp(l,[On.scales[l.type],On.scale])}),i}function nee(e){const t=e.options||(e.options={});t.plugins=ma(t.plugins,{}),t.scales=F9e(e,t)}function see(e){return e=e||{},e.datasets=e.datasets||[],e.labels=e.labels||[],e}function U9e(e){return e=e||{},e.data=see(e.data),nee(e),e}const _B=new Map,ree=new Set;function Wb(e,t){let n=_B.get(e);return n||(n=t(),_B.set(e,n),ree.add(n)),n}const $g=(e,t,n)=>{const s=Yu(t,n);s!==void 0&&e.add(s)};class B9e{constructor(t){this._config=U9e(t),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(t){this._config.type=t}get data(){return this._config.data}set data(t){this._config.data=see(t)}get options(){return this._config.options}set options(t){this._config.options=t}get plugins(){return this._config.plugins}update(){const t=this._config;this.clearCache(),nee(t)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(t){return Wb(t,()=>[[`datasets.${t}`,""]])}datasetAnimationScopeKeys(t,n){return Wb(`${t}.transition.${n}`,()=>[[`datasets.${t}.transitions.${n}`,`transitions.${n}`],[`datasets.${t}`,""]])}datasetElementScopeKeys(t,n){return Wb(`${t}-${n}`,()=>[[`datasets.${t}.elements.${n}`,`datasets.${t}`,`elements.${n}`,""]])}pluginScopeKeys(t){const n=t.id,s=this.type;return Wb(`${s}-plugin-${n}`,()=>[[`plugins.${n}`,...t.additionalOptionScopes||[]]])}_cachedScopes(t,n){const s=this._scopeCache;let r=s.get(t);return(!r||n)&&(r=new Map,s.set(t,r)),r}getOptionScopes(t,n,s){const{options:r,type:i}=this,o=this._cachedScopes(t,s),l=o.get(n);if(l)return l;const c=new Set;n.forEach(d=>{t&&(c.add(t),d.forEach(h=>$g(c,t,h))),d.forEach(h=>$g(c,r,h)),d.forEach(h=>$g(c,Qu[i]||{},h)),d.forEach(h=>$g(c,On,h)),d.forEach(h=>$g(c,iL,h))});const u=Array.from(c);return u.length===0&&u.push(Object.create(null)),ree.has(n)&&o.set(n,u),u}chartOptionScopes(){const{options:t,type:n}=this;return[t,Qu[n]||{},On.datasets[n]||{},{type:n},On,iL]}resolveNamedOptions(t,n,s,r=[""]){const i={$shared:!0},{resolver:o,subPrefixes:l}=AB(this._resolverCache,t,r);let c=o;if(q9e(o,n)){i.$shared=!1,s=Cd(s)?s():s;const u=this.createResolver(t,s,l);c=Gf(o,s,u)}for(const u of n)i[u]=c[u];return i}createResolver(t,n,s=[""],r){const{resolver:i}=AB(this._resolverCache,t,s);return Ca(n)?Gf(i,n,void 0,r):i}}function AB(e,t,n){let s=e.get(t);s||(s=new Map,e.set(t,s));const r=n.join();let i=s.get(r);return i||(i={resolver:h3(t,n),subPrefixes:n.filter(l=>!l.toLowerCase().includes("hover"))},s.set(r,i)),i}const H9e=e=>Ca(e)&&Object.getOwnPropertyNames(e).some(t=>Cd(e[t]));function q9e(e,t){const{isScriptable:n,isIndexable:s}=UJ(e);for(const r of t){const i=n(r),o=s(r),l=(o||i)&&e[r];if(i&&(Cd(l)||H9e(l))||o&&ss(l))return!0}return!1}var G9e="4.5.1";const W9e=["top","bottom","left","right","chartArea"];function TB(e,t){return e==="top"||e==="bottom"||W9e.indexOf(e)===-1&&t==="x"}function kB(e,t){return function(n,s){return n[e]===s[e]?n[t]-s[t]:n[e]-s[e]}}function EB(e){const t=e.chart,n=t.options.animation;t.notifyPlugins("afterRender"),nn(n&&n.onComplete,[e],t)}function V9e(e){const t=e.chart,n=t.options.animation;nn(n&&n.onProgress,[e],t)}function iee(e){return x3()&&typeof e=="string"?e=document.getElementById(e):e&&e.length&&(e=e[0]),e&&e.canvas&&(e=e.canvas),e}const Nv={},LB=e=>{const t=iee(e);return Object.values(Nv).filter(n=>n.canvas===t).pop()};function Y9e(e,t,n){const s=Object.keys(e);for(const r of s){const i=+r;if(i>=t){const o=e[r];delete e[r],(n>0||i>t)&&(e[i+n]=o)}}}function Q9e(e,t,n,s){return!n||e.type==="mouseout"?null:s?t:e}let O1=class{static defaults=On;static instances=Nv;static overrides=Qu;static registry=Co;static version=G9e;static getChart=LB;static register(...t){Co.add(...t),PB()}static unregister(...t){Co.remove(...t),PB()}constructor(t,n){const s=this.config=new B9e(n),r=iee(t),i=LB(r);if(i)throw new Error("Canvas is already in use. Chart with ID '"+i.id+"' must be destroyed before the canvas with ID '"+i.canvas.id+"' can be reused.");const o=s.createResolver(s.chartOptionScopes(),this.getContext());this.platform=new(s.platform||f9e(r)),this.platform.updateConfig(s);const l=this.platform.acquireContext(r,o.aspectRatio),c=l&&l.canvas,u=c&&c.height,d=c&&c.width;if(this.id=F8e(),this.ctx=l,this.canvas=c,this.width=d,this.height=u,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new L9e,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=rBe(h=>this.update(h),o.resizeDelay||0),this._dataChanges=[],Nv[this.id]=this,!l||!c){console.error("Failed to create chart: can't acquire context from the given item");return}Cl.listen(this,"complete",EB),Cl.listen(this,"progress",V9e),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:t,maintainAspectRatio:n},width:s,height:r,_aspectRatio:i}=this;return Pa(t)?n&&i?i:r?s/r:null:t}get data(){return this.config.data}set data(t){this.config.data=t}get options(){return this._options}set options(t){this.config.options=t}get registry(){return Co}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():eB(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return X8(this.canvas,this.ctx),this}stop(){return Cl.stop(this),this}resize(t,n){Cl.running(this)?this._resizeBeforeDraw={width:t,height:n}:this._resize(t,n)}_resize(t,n){const s=this.options,r=this.canvas,i=s.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(r,t,n,i),l=s.devicePixelRatio||this.platform.getDevicePixelRatio(),c=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,eB(this,l,!0)&&(this.notifyPlugins("resize",{size:o}),nn(s.onResize,[this,o],this),this.attached&&this._doResize(c)&&this.render())}ensureScalesHaveIDs(){const n=this.options.scales||{};$a(n,(s,r)=>{s.id=r})}buildOrUpdateScales(){const t=this.options,n=t.scales,s=this.scales,r=Object.keys(s).reduce((o,l)=>(o[l]=!1,o),{});let i=[];n&&(i=i.concat(Object.keys(n).map(o=>{const l=n[o],c=cL(o,l),u=c==="r",d=c==="x";return{options:l,dposition:u?"chartArea":d?"bottom":"left",dtype:u?"radialLinear":d?"category":"linear"}}))),$a(i,o=>{const l=o.options,c=l.id,u=cL(c,l),d=ma(l.type,o.dtype);(l.position===void 0||TB(l.position,u)!==TB(o.dposition))&&(l.position=o.dposition),r[c]=!0;let h=null;if(c in s&&s[c].type===d)h=s[c];else{const p=Co.getScale(d);h=new p({id:c,type:d,ctx:this.ctx,chart:this}),s[h.id]=h}h.init(l,t)}),$a(r,(o,l)=>{o||delete s[l]}),$a(s,o=>{pi.configure(this,o,o.options),pi.addBox(this,o)})}_updateMetasets(){const t=this._metasets,n=this.data.datasets.length,s=t.length;if(t.sort((r,i)=>r.index-i.index),s>n){for(let r=n;r<s;++r)this._destroyDatasetMeta(r);t.splice(n,s-n)}this._sortedMetasets=t.slice(0).sort(kB("order","index"))}_removeUnreferencedMetasets(){const{_metasets:t,data:{datasets:n}}=this;t.length>n.length&&delete this._stacks,t.forEach((s,r)=>{n.filter(i=>i===s._dataset).length===0&&this._destroyDatasetMeta(r)})}buildOrUpdateControllers(){const t=[],n=this.data.datasets;let s,r;for(this._removeUnreferencedMetasets(),s=0,r=n.length;s<r;s++){const i=n[s];let o=this.getDatasetMeta(s);const l=i.type||this.config.type;if(o.type&&o.type!==l&&(this._destroyDatasetMeta(s),o=this.getDatasetMeta(s)),o.type=l,o.indexAxis=i.indexAxis||lL(l,this.options),o.order=i.order||0,o.index=s,o.label=""+i.label,o.visible=this.isDatasetVisible(s),o.controller)o.controller.updateIndex(s),o.controller.linkScales();else{const c=Co.getController(l),{datasetElementType:u,dataElementType:d}=On.datasets[l];Object.assign(c,{dataElementType:Co.getElement(d),datasetElementType:u&&Co.getElement(u)}),o.controller=new c(this,s),t.push(o.controller)}}return this._updateMetasets(),t}_resetElements(){$a(this.data.datasets,(t,n)=>{this.getDatasetMeta(n).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(t){const n=this.config;n.update();const s=this._options=n.createResolver(n.chartOptionScopes(),this.getContext()),r=this._animationsDisabled=!s.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:t,cancelable:!0})===!1)return;const i=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let u=0,d=this.data.datasets.length;u<d;u++){const{controller:h}=this.getDatasetMeta(u),p=!r&&i.indexOf(h)===-1;h.buildOrUpdateElements(p),o=Math.max(+h.getMaxOverflow(),o)}o=this._minPadding=s.layout.autoPadding?o:0,this._updateLayout(o),r||$a(i,u=>{u.reset()}),this._updateDatasets(t),this.notifyPlugins("afterUpdate",{mode:t}),this._layers.sort(kB("z","_idx"));const{_active:l,_lastEvent:c}=this;c?this._eventHandler(c,!0):l.length&&this._updateHoverStyles(l,l,!0),this.render()}_updateScales(){$a(this.scales,t=>{pi.removeBox(this,t)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const t=this.options,n=new Set(Object.keys(this._listeners)),s=new Set(t.events);(!U8(n,s)||!!this._responsiveListeners!==t.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:t}=this,n=this._getUniformDataChanges()||[];for(const{method:s,start:r,count:i}of n){const o=s==="_removeElements"?-i:i;Y9e(t,r,o)}}_getUniformDataChanges(){const t=this._dataChanges;if(!t||!t.length)return;this._dataChanges=[];const n=this.data.datasets.length,s=i=>new Set(t.filter(o=>o[0]===i).map((o,l)=>l+","+o.splice(1).join(","))),r=s(0);for(let i=1;i<n;i++)if(!U8(r,s(i)))return;return Array.from(r).map(i=>i.split(",")).map(i=>({method:i[1],start:+i[2],count:+i[3]}))}_updateLayout(t){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;pi.update(this,this.width,this.height,t);const n=this.chartArea,s=n.width<=0||n.height<=0;this._layers=[],$a(this.boxes,r=>{s&&r.position==="chartArea"||(r.configure&&r.configure(),this._layers.push(...r._layers()))},this),this._layers.forEach((r,i)=>{r._idx=i}),this.notifyPlugins("afterLayout")}_updateDatasets(t){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:t,cancelable:!0})!==!1){for(let n=0,s=this.data.datasets.length;n<s;++n)this.getDatasetMeta(n).controller.configure();for(let n=0,s=this.data.datasets.length;n<s;++n)this._updateDataset(n,Cd(t)?t({datasetIndex:n}):t);this.notifyPlugins("afterDatasetsUpdate",{mode:t})}}_updateDataset(t,n){const s=this.getDatasetMeta(t),r={meta:s,index:t,mode:n,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",r)!==!1&&(s.controller._update(n),r.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",r))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(Cl.has(this)?this.attached&&!Cl.running(this)&&Cl.start(this):(this.draw(),EB({chart:this})))}draw(){let t;if(this._resizeBeforeDraw){const{width:s,height:r}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(s,r)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const n=this._layers;for(t=0;t<n.length&&n[t].z<=0;++t)n[t].draw(this.chartArea);for(this._drawDatasets();t<n.length;++t)n[t].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(t){const n=this._sortedMetasets,s=[];let r,i;for(r=0,i=n.length;r<i;++r){const o=n[r];(!t||o.visible)&&s.push(o)}return s}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const t=this.getSortedVisibleDatasetMetas();for(let n=t.length-1;n>=0;--n)this._drawDataset(t[n]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(t){const n=this.ctx,s={meta:t,index:t.index,cancelable:!0},r=uHe(this,t);this.notifyPlugins("beforeDatasetDraw",s)!==!1&&(r&&u3(n,r),t.controller.draw(),r&&m3(n),s.cancelable=!1,this.notifyPlugins("afterDatasetDraw",s))}isPointInArea(t){return ex(t,this.chartArea,this._minPadding)}getElementsAtEventForMode(t,n,s,r){const i=WHe.modes[n];return typeof i=="function"?i(this,t,s,r):[]}getDatasetMeta(t){const n=this.data.datasets[t],s=this._metasets;let r=s.filter(i=>i&&i._dataset===n).pop();return r||(r={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:n&&n.order||0,index:t,_dataset:n,_parsed:[],_sorted:!1},s.push(r)),r}getContext(){return this.$context||(this.$context=lm(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(t){const n=this.data.datasets[t];if(!n)return!1;const s=this.getDatasetMeta(t);return typeof s.hidden=="boolean"?!s.hidden:!n.hidden}setDatasetVisibility(t,n){const s=this.getDatasetMeta(t);s.hidden=!n}toggleDataVisibility(t){this._hiddenIndices[t]=!this._hiddenIndices[t]}getDataVisibility(t){return!this._hiddenIndices[t]}_updateVisibility(t,n,s){const r=s?"show":"hide",i=this.getDatasetMeta(t),o=i.controller._resolveAnimations(void 0,r);Xp(n)?(i.data[n].hidden=!s,this.update()):(this.setDatasetVisibility(t,s),o.update(i,{visible:s}),this.update(l=>l.datasetIndex===t?r:void 0))}hide(t,n){this._updateVisibility(t,n,!1)}show(t,n){this._updateVisibility(t,n,!0)}_destroyDatasetMeta(t){const n=this._metasets[t];n&&n.controller&&n.controller._destroy(),delete this._metasets[t]}_stop(){let t,n;for(this.stop(),Cl.remove(this),t=0,n=this.data.datasets.length;t<n;++t)this._destroyDatasetMeta(t)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:t,ctx:n}=this;this._stop(),this.config.clearCache(),t&&(this.unbindEvents(),X8(t,n),this.platform.releaseContext(n),this.canvas=null,this.ctx=null),delete Nv[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...t){return this.canvas.toDataURL(...t)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const t=this._listeners,n=this.platform,s=(i,o)=>{n.addEventListener(this,i,o),t[i]=o},r=(i,o,l)=>{i.offsetX=o,i.offsetY=l,this._eventHandler(i)};$a(this.options.events,i=>s(i,r))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const t=this._responsiveListeners,n=this.platform,s=(c,u)=>{n.addEventListener(this,c,u),t[c]=u},r=(c,u)=>{t[c]&&(n.removeEventListener(this,c,u),delete t[c])},i=(c,u)=>{this.canvas&&this.resize(c,u)};let o;const l=()=>{r("attach",l),this.attached=!0,this.resize(),s("resize",i),s("detach",o)};o=()=>{this.attached=!1,r("resize",i),this._stop(),this._resize(0,0),s("attach",l)},n.isAttached(this.canvas)?l():o()}unbindEvents(){$a(this._listeners,(t,n)=>{this.platform.removeEventListener(this,n,t)}),this._listeners={},$a(this._responsiveListeners,(t,n)=>{this.platform.removeEventListener(this,n,t)}),this._responsiveListeners=void 0}updateHoverStyle(t,n,s){const r=s?"set":"remove";let i,o,l,c;for(n==="dataset"&&(i=this.getDatasetMeta(t[0].datasetIndex),i.controller["_"+r+"DatasetHoverStyle"]()),l=0,c=t.length;l<c;++l){o=t[l];const u=o&&this.getDatasetMeta(o.datasetIndex).controller;u&&u[r+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(t){const n=this._active||[],s=t.map(({datasetIndex:i,index:o})=>{const l=this.getDatasetMeta(i);if(!l)throw new Error("No dataset found at index "+i);return{datasetIndex:i,element:l.data[o],index:o}});!Kw(s,n)&&(this._active=s,this._lastEvent=null,this._updateHoverStyles(s,n))}notifyPlugins(t,n,s){return this._plugins.notify(this,t,n,s)}isPluginEnabled(t){return this._plugins._cache.filter(n=>n.plugin.id===t).length===1}_updateHoverStyles(t,n,s){const r=this.options.hover,i=(c,u)=>c.filter(d=>!u.some(h=>d.datasetIndex===h.datasetIndex&&d.index===h.index)),o=i(n,t),l=s?t:i(t,n);o.length&&this.updateHoverStyle(o,r.mode,!1),l.length&&r.mode&&this.updateHoverStyle(l,r.mode,!0)}_eventHandler(t,n){const s={event:t,replay:n,cancelable:!0,inChartArea:this.isPointInArea(t)},r=o=>(o.options.events||this.options.events).includes(t.native.type);if(this.notifyPlugins("beforeEvent",s,r)===!1)return;const i=this._handleEvent(t,n,s.inChartArea);return s.cancelable=!1,this.notifyPlugins("afterEvent",s,r),(i||s.changed)&&this.render(),this}_handleEvent(t,n,s){const{_active:r=[],options:i}=this,o=n,l=this._getActiveElements(t,r,s,o),c=W8e(t),u=Q9e(t,this._lastEvent,s,c);s&&(this._lastEvent=null,nn(i.onHover,[t,l,this],this),c&&nn(i.onClick,[t,l,this],this));const d=!Kw(l,r);return(d||n)&&(this._active=l,this._updateHoverStyles(l,r,n)),this._lastEvent=u,d}_getActiveElements(t,n,s,r){if(t.type==="mouseout")return[];if(!s)return n;const i=this.options.hover;return this.getElementsAtEventForMode(t,i.mode,i,r)}};function PB(){return $a(O1.instances,e=>e._plugins.invalidate())}function K9e(e,t,n){const{startAngle:s,x:r,y:i,outerRadius:o,innerRadius:l,options:c}=t,{borderWidth:u,borderJoinStyle:d}=c,h=Math.min(u/o,Ui(s-n));if(e.beginPath(),e.arc(r,i,o-u/2,s+h/2,n-h/2),l>0){const p=Math.min(u/l,Ui(s-n));e.arc(r,i,l+u/2,n-p/2,s+p/2,!0)}else{const p=Math.min(u/2,o*Ui(s-n));if(d==="round")e.arc(r,i,p,n-za/2,s+za/2,!0);else if(d==="bevel"){const x=2*p*p,v=-x*Math.cos(n+za/2)+r,j=-x*Math.sin(n+za/2)+i,y=x*Math.cos(s+za/2)+r,N=x*Math.sin(s+za/2)+i;e.lineTo(v,j),e.lineTo(y,N)}}e.closePath(),e.moveTo(0,0),e.rect(0,0,e.canvas.width,e.canvas.height),e.clip("evenodd")}function X9e(e,t,n){const{startAngle:s,pixelMargin:r,x:i,y:o,outerRadius:l,innerRadius:c}=t;let u=r/l;e.beginPath(),e.arc(i,o,l,s-u,n+u),c>r?(u=r/c,e.arc(i,o,c,n+u,s-u,!0)):e.arc(i,o,r,n+rs,s-rs),e.closePath(),e.clip()}function Z9e(e){return f3(e,["outerStart","outerEnd","innerStart","innerEnd"])}function J9e(e,t,n,s){const r=Z9e(e.options.borderRadius),i=(n-t)/2,o=Math.min(i,s*t/2),l=c=>{const u=(n-Math.min(i,c))*s/2;return Is(c,0,Math.min(i,u))};return{outerStart:l(r.outerStart),outerEnd:l(r.outerEnd),innerStart:Is(r.innerStart,0,o),innerEnd:Is(r.innerEnd,0,o)}}function sf(e,t,n,s){return{x:n+e*Math.cos(t),y:s+e*Math.sin(t)}}function aj(e,t,n,s,r,i){const{x:o,y:l,startAngle:c,pixelMargin:u,innerRadius:d}=t,h=Math.max(t.outerRadius+s+n-u,0),p=d>0?d+s+n+u:0;let x=0;const v=r-c;if(s){const R=d>0?d-s:0,q=h>0?h-s:0,Z=(R+q)/2,V=Z!==0?v*Z/(Z+s):v;x=(v-V)/2}const j=Math.max(.001,v*h-n/za)/h,y=(v-j)/2,N=c+y+x,w=r-y-x,{outerStart:S,outerEnd:_,innerStart:k,innerEnd:T}=J9e(t,p,h,w-N),A=h-S,E=h-_,M=N+S/A,z=w-_/E,P=p+k,D=p+T,U=N+k/P,B=w-T/D;if(e.beginPath(),i){const R=(M+z)/2;if(e.arc(o,l,h,M,R),e.arc(o,l,h,R,z),_>0){const oe=sf(E,z,o,l);e.arc(oe.x,oe.y,_,z,w+rs)}const q=sf(D,w,o,l);if(e.lineTo(q.x,q.y),T>0){const oe=sf(D,B,o,l);e.arc(oe.x,oe.y,T,w+rs,B+Math.PI)}const Z=(w-T/p+(N+k/p))/2;if(e.arc(o,l,p,w-T/p,Z,!0),e.arc(o,l,p,Z,N+k/p,!0),k>0){const oe=sf(P,U,o,l);e.arc(oe.x,oe.y,k,U+Math.PI,N-rs)}const V=sf(A,N,o,l);if(e.lineTo(V.x,V.y),S>0){const oe=sf(A,M,o,l);e.arc(oe.x,oe.y,S,N-rs,M)}}else{e.moveTo(o,l);const R=Math.cos(M)*h+o,q=Math.sin(M)*h+l;e.lineTo(R,q);const Z=Math.cos(z)*h+o,V=Math.sin(z)*h+l;e.lineTo(Z,V)}e.closePath()}function eqe(e,t,n,s,r){const{fullCircles:i,startAngle:o,circumference:l}=t;let c=t.endAngle;if(i){aj(e,t,n,s,c,r);for(let u=0;u<i;++u)e.fill();isNaN(l)||(c=o+(l%_n||_n))}return aj(e,t,n,s,c,r),e.fill(),c}function tqe(e,t,n,s,r){const{fullCircles:i,startAngle:o,circumference:l,options:c}=t,{borderWidth:u,borderJoinStyle:d,borderDash:h,borderDashOffset:p,borderRadius:x}=c,v=c.borderAlign==="inner";if(!u)return;e.setLineDash(h||[]),e.lineDashOffset=p,v?(e.lineWidth=u*2,e.lineJoin=d||"round"):(e.lineWidth=u,e.lineJoin=d||"bevel");let j=t.endAngle;if(i){aj(e,t,n,s,j,r);for(let y=0;y<i;++y)e.stroke();isNaN(l)||(j=o+(l%_n||_n))}v&&X9e(e,t,j),c.selfJoin&&j-o>=za&&x===0&&d!=="miter"&&K9e(e,t,j),i||(aj(e,t,n,s,j,r),e.stroke())}class aqe extends hc{static id="arc";static defaults={borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1};static defaultRoutes={backgroundColor:"backgroundColor"};static descriptors={_scriptable:!0,_indexable:t=>t!=="borderDash"};circumference;endAngle;fullCircles;innerRadius;outerRadius;pixelMargin;startAngle;constructor(t){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,t&&Object.assign(this,t)}inRange(t,n,s){const r=this.getProps(["x","y"],s),{angle:i,distance:o}=DJ(r,{x:t,y:n}),{startAngle:l,endAngle:c,innerRadius:u,outerRadius:d,circumference:h}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],s),p=(this.options.spacing+this.options.borderWidth)/2,x=ma(h,c-l),v=Jp(i,l,c)&&l!==c,j=x>=_n||v,y=rd(o,u+p,d+p);return j&&y}getCenterPoint(t){const{x:n,y:s,startAngle:r,endAngle:i,innerRadius:o,outerRadius:l}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],t),{offset:c,spacing:u}=this.options,d=(r+i)/2,h=(o+l+u+c)/2;return{x:n+Math.cos(d)*h,y:s+Math.sin(d)*h}}tooltipPosition(t){return this.getCenterPoint(t)}draw(t){const{options:n,circumference:s}=this,r=(n.offset||0)/4,i=(n.spacing||0)/2,o=n.circular;if(this.pixelMargin=n.borderAlign==="inner"?.33:0,this.fullCircles=s>_n?Math.floor(s/_n):0,s===0||this.innerRadius<0||this.outerRadius<0)return;t.save();const l=(this.startAngle+this.endAngle)/2;t.translate(Math.cos(l)*r,Math.sin(l)*r);const c=1-Math.sin(Math.min(za,s||0)),u=r*c;t.fillStyle=n.backgroundColor,t.strokeStyle=n.borderColor,eqe(t,this,u,i,o),tqe(t,this,u,i,o),t.restore()}}function oee(e,t,n=t){e.lineCap=ma(n.borderCapStyle,t.borderCapStyle),e.setLineDash(ma(n.borderDash,t.borderDash)),e.lineDashOffset=ma(n.borderDashOffset,t.borderDashOffset),e.lineJoin=ma(n.borderJoinStyle,t.borderJoinStyle),e.lineWidth=ma(n.borderWidth,t.borderWidth),e.strokeStyle=ma(n.borderColor,t.borderColor)}function nqe(e,t,n){e.lineTo(n.x,n.y)}function sqe(e){return e.stepped?bBe:e.tension||e.cubicInterpolationMode==="monotone"?vBe:nqe}function lee(e,t,n={}){const s=e.length,{start:r=0,end:i=s-1}=n,{start:o,end:l}=t,c=Math.max(r,o),u=Math.min(i,l),d=r<o&&i<o||r>l&&i>l;return{count:s,start:c,loop:t.loop,ilen:u<c&&!d?s+u-c:u-c}}function rqe(e,t,n,s){const{points:r,options:i}=t,{count:o,start:l,loop:c,ilen:u}=lee(r,n,s),d=sqe(i);let{move:h=!0,reverse:p}=s||{},x,v,j;for(x=0;x<=u;++x)v=r[(l+(p?u-x:x))%o],!v.skip&&(h?(e.moveTo(v.x,v.y),h=!1):d(e,j,v,p,i.stepped),j=v);return c&&(v=r[(l+(p?u:0))%o],d(e,j,v,p,i.stepped)),!!c}function iqe(e,t,n,s){const r=t.points,{count:i,start:o,ilen:l}=lee(r,n,s),{move:c=!0,reverse:u}=s||{};let d=0,h=0,p,x,v,j,y,N;const w=_=>(o+(u?l-_:_))%i,S=()=>{j!==y&&(e.lineTo(d,y),e.lineTo(d,j),e.lineTo(d,N))};for(c&&(x=r[w(0)],e.moveTo(x.x,x.y)),p=0;p<=l;++p){if(x=r[w(p)],x.skip)continue;const _=x.x,k=x.y,T=_|0;T===v?(k<j?j=k:k>y&&(y=k),d=(h*d+_)/++h):(S(),e.lineTo(_,k),v=T,h=0,j=y=k),N=k}S()}function dL(e){const t=e.options,n=t.borderDash&&t.borderDash.length;return!e._decimated&&!e._loop&&!t.tension&&t.cubicInterpolationMode!=="monotone"&&!t.stepped&&!n?iqe:rqe}function oqe(e){return e.stepped?ZBe:e.tension||e.cubicInterpolationMode==="monotone"?JBe:ou}function lqe(e,t,n,s){let r=t._path;r||(r=t._path=new Path2D,t.path(r,n,s)&&r.closePath()),oee(e,t.options),e.stroke(r)}function cqe(e,t,n,s){const{segments:r,options:i}=t,o=dL(t);for(const l of r)oee(e,i,l.style),e.beginPath(),o(e,t,l,{start:n,end:n+s-1})&&e.closePath(),e.stroke()}const dqe=typeof Path2D=="function";function uqe(e,t,n,s){dqe&&!t.options.segment?lqe(e,t,n,s):cqe(e,t,n,s)}class mqe extends hc{static id="line";static defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};static descriptors={_scriptable:!0,_indexable:t=>t!=="borderDash"&&t!=="fill"};constructor(t){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,t&&Object.assign(this,t)}updateControlPoints(t,n){const s=this.options;if((s.tension||s.cubicInterpolationMode==="monotone")&&!s.stepped&&!this._pointsUpdated){const r=s.spanGaps?this._loop:this._fullLoop;qBe(this._points,s,t,r,n),this._pointsUpdated=!0}}set points(t){this._points=t,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=oHe(this,this.options.segment))}first(){const t=this.segments,n=this.points;return t.length&&n[t[0].start]}last(){const t=this.segments,n=this.points,s=t.length;return s&&n[t[s-1].end]}interpolate(t,n){const s=this.options,r=t[n],i=this.points,o=sHe(this,{property:n,start:r,end:r});if(!o.length)return;const l=[],c=oqe(s);let u,d;for(u=0,d=o.length;u<d;++u){const{start:h,end:p}=o[u],x=i[h],v=i[p];if(x===v){l.push(x);continue}const j=Math.abs((r-x[n])/(v[n]-x[n])),y=c(x,v,j,s.stepped);y[n]=t[n],l.push(y)}return l.length===1?l[0]:l}pathSegment(t,n,s){return dL(this)(t,this,n,s)}path(t,n,s){const r=this.segments,i=dL(this);let o=this._loop;n=n||0,s=s||this.points.length-n;for(const l of r)o&=i(t,this,l,{start:n,end:n+s-1});return!!o}draw(t,n,s,r){const i=this.options||{};(this.points||[]).length&&i.borderWidth&&(t.save(),uqe(t,this,s,r),t.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}function DB(e,t,n,s){const r=e.options,{[n]:i}=e.getProps([n],s);return Math.abs(t-i)<r.radius+r.hitRadius}class fqe extends hc{static id="point";parsed;skip;stop;static defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(t){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,t&&Object.assign(this,t)}inRange(t,n,s){const r=this.options,{x:i,y:o}=this.getProps(["x","y"],s);return Math.pow(t-i,2)+Math.pow(n-o,2)<Math.pow(r.hitRadius+r.radius,2)}inXRange(t,n){return DB(this,t,"x",n)}inYRange(t,n){return DB(this,t,"y",n)}getCenterPoint(t){const{x:n,y:s}=this.getProps(["x","y"],t);return{x:n,y:s}}size(t){t=t||this.options||{};let n=t.radius||0;n=Math.max(n,n&&t.hoverRadius||0);const s=n&&t.borderWidth||0;return(n+s)*2}draw(t,n){const s=this.options;this.skip||s.radius<.1||!ex(this,n,this.size(s)/2)||(t.strokeStyle=s.borderColor,t.lineWidth=s.borderWidth,t.fillStyle=s.backgroundColor,oL(t,s,this.x,this.y))}getRange(){const t=this.options||{};return t.radius+t.hitRadius}}function cee(e,t){const{x:n,y:s,base:r,width:i,height:o}=e.getProps(["x","y","base","width","height"],t);let l,c,u,d,h;return e.horizontal?(h=o/2,l=Math.min(n,r),c=Math.max(n,r),u=s-h,d=s+h):(h=i/2,l=n-h,c=n+h,u=Math.min(s,r),d=Math.max(s,r)),{left:l,top:u,right:c,bottom:d}}function od(e,t,n,s){return e?0:Is(t,n,s)}function hqe(e,t,n){const s=e.options.borderWidth,r=e.borderSkipped,i=FJ(s);return{t:od(r.top,i.top,0,n),r:od(r.right,i.right,0,t),b:od(r.bottom,i.bottom,0,n),l:od(r.left,i.left,0,t)}}function gqe(e,t,n){const{enableBorderRadius:s}=e.getProps(["enableBorderRadius"]),r=e.options.borderRadius,i=Cf(r),o=Math.min(t,n),l=e.borderSkipped,c=s||Ca(r);return{topLeft:od(!c||l.top||l.left,i.topLeft,0,o),topRight:od(!c||l.top||l.right,i.topRight,0,o),bottomLeft:od(!c||l.bottom||l.left,i.bottomLeft,0,o),bottomRight:od(!c||l.bottom||l.right,i.bottomRight,0,o)}}function pqe(e){const t=cee(e),n=t.right-t.left,s=t.bottom-t.top,r=hqe(e,n/2,s/2),i=gqe(e,n/2,s/2);return{outer:{x:t.left,y:t.top,w:n,h:s,radius:i},inner:{x:t.left+r.l,y:t.top+r.t,w:n-r.l-r.r,h:s-r.t-r.b,radius:{topLeft:Math.max(0,i.topLeft-Math.max(r.t,r.l)),topRight:Math.max(0,i.topRight-Math.max(r.t,r.r)),bottomLeft:Math.max(0,i.bottomLeft-Math.max(r.b,r.l)),bottomRight:Math.max(0,i.bottomRight-Math.max(r.b,r.r))}}}}function NT(e,t,n,s){const r=t===null,i=n===null,l=e&&!(r&&i)&&cee(e,s);return l&&(r||rd(t,l.left,l.right))&&(i||rd(n,l.top,l.bottom))}function xqe(e){return e.topLeft||e.topRight||e.bottomLeft||e.bottomRight}function yqe(e,t){e.rect(t.x,t.y,t.w,t.h)}function CT(e,t,n={}){const s=e.x!==n.x?-t:0,r=e.y!==n.y?-t:0,i=(e.x+e.w!==n.x+n.w?t:0)-s,o=(e.y+e.h!==n.y+n.h?t:0)-r;return{x:e.x+s,y:e.y+r,w:e.w+i,h:e.h+o,radius:e.radius}}class bqe extends hc{static id="bar";static defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(t){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,t&&Object.assign(this,t)}draw(t){const{inflateAmount:n,options:{borderColor:s,backgroundColor:r}}=this,{inner:i,outer:o}=pqe(this),l=xqe(o.radius)?Jw:yqe;t.save(),(o.w!==i.w||o.h!==i.h)&&(t.beginPath(),l(t,CT(o,n,i)),t.clip(),l(t,CT(i,-n,o)),t.fillStyle=s,t.fill("evenodd")),t.beginPath(),l(t,CT(i,n)),t.fillStyle=r,t.fill(),t.restore()}inRange(t,n,s){return NT(this,t,n,s)}inXRange(t,n){return NT(this,t,null,n)}inYRange(t,n){return NT(this,null,t,n)}getCenterPoint(t){const{x:n,y:s,base:r,horizontal:i}=this.getProps(["x","y","base","horizontal"],t);return{x:i?(n+r)/2:n,y:i?s:(s+r)/2}}getRange(t){return t==="x"?this.width/2:this.height/2}}const OB=(e,t)=>{let{boxHeight:n=t,boxWidth:s=t}=e;return e.usePointStyle&&(n=Math.min(n,t),s=e.pointStyleWidth||Math.min(s,t)),{boxWidth:s,boxHeight:n,itemHeight:Math.max(t,n)}},vqe=(e,t)=>e!==null&&t!==null&&e.datasetIndex===t.datasetIndex&&e.index===t.index;class MB extends hc{constructor(t){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,n,s){this.maxWidth=t,this.maxHeight=n,this._margins=s,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const t=this.options.labels||{};let n=nn(t.generateLabels,[this.chart],this)||[];t.filter&&(n=n.filter(s=>t.filter(s,this.chart.data))),t.sort&&(n=n.sort((s,r)=>t.sort(s,r,this.chart.data))),this.options.reverse&&n.reverse(),this.legendItems=n}fit(){const{options:t,ctx:n}=this;if(!t.display){this.width=this.height=0;return}const s=t.labels,r=$s(s.font),i=r.size,o=this._computeTitleHeight(),{boxWidth:l,itemHeight:c}=OB(s,i);let u,d;n.font=r.string,this.isHorizontal()?(u=this.maxWidth,d=this._fitRows(o,i,l,c)+10):(d=this.maxHeight,u=this._fitCols(o,r,l,c)+10),this.width=Math.min(u,t.maxWidth||this.maxWidth),this.height=Math.min(d,t.maxHeight||this.maxHeight)}_fitRows(t,n,s,r){const{ctx:i,maxWidth:o,options:{labels:{padding:l}}}=this,c=this.legendHitBoxes=[],u=this.lineWidths=[0],d=r+l;let h=t;i.textAlign="left",i.textBaseline="middle";let p=-1,x=-d;return this.legendItems.forEach((v,j)=>{const y=s+n/2+i.measureText(v.text).width;(j===0||u[u.length-1]+y+2*l>o)&&(h+=d,u[u.length-(j>0?0:1)]=0,x+=d,p++),c[j]={left:0,top:x,row:p,width:y,height:r},u[u.length-1]+=y+l}),h}_fitCols(t,n,s,r){const{ctx:i,maxHeight:o,options:{labels:{padding:l}}}=this,c=this.legendHitBoxes=[],u=this.columnSizes=[],d=o-t;let h=l,p=0,x=0,v=0,j=0;return this.legendItems.forEach((y,N)=>{const{itemWidth:w,itemHeight:S}=wqe(s,n,i,y,r);N>0&&x+S+2*l>d&&(h+=p+l,u.push({width:p,height:x}),v+=p+l,j++,p=x=0),c[N]={left:v,top:x,col:j,width:w,height:S},p=Math.max(p,w),x+=S+l}),h+=p,u.push({width:p,height:x}),h}adjustHitBoxes(){if(!this.options.display)return;const t=this._computeTitleHeight(),{legendHitBoxes:n,options:{align:s,labels:{padding:r},rtl:i}}=this,o=Sf(i,this.left,this.width);if(this.isHorizontal()){let l=0,c=Ps(s,this.left+r,this.right-this.lineWidths[l]);for(const u of n)l!==u.row&&(l=u.row,c=Ps(s,this.left+r,this.right-this.lineWidths[l])),u.top+=this.top+t+r,u.left=o.leftForLtr(o.x(c),u.width),c+=u.width+r}else{let l=0,c=Ps(s,this.top+t+r,this.bottom-this.columnSizes[l].height);for(const u of n)u.col!==l&&(l=u.col,c=Ps(s,this.top+t+r,this.bottom-this.columnSizes[l].height)),u.top=c,u.left+=this.left+r,u.left=o.leftForLtr(o.x(u.left),u.width),c+=u.height+r}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const t=this.ctx;u3(t,this),this._draw(),m3(t)}}_draw(){const{options:t,columnSizes:n,lineWidths:s,ctx:r}=this,{align:i,labels:o}=t,l=On.color,c=Sf(t.rtl,this.left,this.width),u=$s(o.font),{padding:d}=o,h=u.size,p=h/2;let x;this.drawTitle(),r.textAlign=c.textAlign("left"),r.textBaseline="middle",r.lineWidth=.5,r.font=u.string;const{boxWidth:v,boxHeight:j,itemHeight:y}=OB(o,h),N=function(T,A,E){if(isNaN(v)||v<=0||isNaN(j)||j<0)return;r.save();const M=ma(E.lineWidth,1);if(r.fillStyle=ma(E.fillStyle,l),r.lineCap=ma(E.lineCap,"butt"),r.lineDashOffset=ma(E.lineDashOffset,0),r.lineJoin=ma(E.lineJoin,"miter"),r.lineWidth=M,r.strokeStyle=ma(E.strokeStyle,l),r.setLineDash(ma(E.lineDash,[])),o.usePointStyle){const z={radius:j*Math.SQRT2/2,pointStyle:E.pointStyle,rotation:E.rotation,borderWidth:M},P=c.xPlus(T,v/2),D=A+p;zJ(r,z,P,D,o.pointStyleWidth&&v)}else{const z=A+Math.max((h-j)/2,0),P=c.leftForLtr(T,v),D=Cf(E.borderRadius);r.beginPath(),Object.values(D).some(U=>U!==0)?Jw(r,{x:P,y:z,w:v,h:j,radius:D}):r.rect(P,z,v,j),r.fill(),M!==0&&r.stroke()}r.restore()},w=function(T,A,E){tx(r,E.text,T,A+y/2,u,{strikethrough:E.hidden,textAlign:c.textAlign(E.textAlign)})},S=this.isHorizontal(),_=this._computeTitleHeight();S?x={x:Ps(i,this.left+d,this.right-s[0]),y:this.top+d+_,line:0}:x={x:this.left+d,y:Ps(i,this.top+_+d,this.bottom-n[0].height),line:0},WJ(this.ctx,t.textDirection);const k=y+d;this.legendItems.forEach((T,A)=>{r.strokeStyle=T.fontColor,r.fillStyle=T.fontColor;const E=r.measureText(T.text).width,M=c.textAlign(T.textAlign||(T.textAlign=o.textAlign)),z=v+p+E;let P=x.x,D=x.y;c.setWidth(this.width),S?A>0&&P+z+d>this.right&&(D=x.y+=k,x.line++,P=x.x=Ps(i,this.left+d,this.right-s[x.line])):A>0&&D+k>this.bottom&&(P=x.x=P+n[x.line].width+d,x.line++,D=x.y=Ps(i,this.top+_+d,this.bottom-n[x.line].height));const U=c.x(P);if(N(U,D,T),P=iBe(M,P+v+p,S?P+z:this.right,t.rtl),w(c.x(P),D,T),S)x.x+=z+d;else if(typeof T.text!="string"){const B=u.lineHeight;x.y+=dee(T,B)+d}else x.y+=k}),VJ(this.ctx,t.textDirection)}drawTitle(){const t=this.options,n=t.title,s=$s(n.font),r=Si(n.padding);if(!n.display)return;const i=Sf(t.rtl,this.left,this.width),o=this.ctx,l=n.position,c=s.size/2,u=r.top+c;let d,h=this.left,p=this.width;if(this.isHorizontal())p=Math.max(...this.lineWidths),d=this.top+u,h=Ps(t.align,h,this.right-p);else{const v=this.columnSizes.reduce((j,y)=>Math.max(j,y.height),0);d=u+Ps(t.align,this.top,this.bottom-v-t.labels.padding-this._computeTitleHeight())}const x=Ps(l,h,h+p);o.textAlign=i.textAlign(l3(l)),o.textBaseline="middle",o.strokeStyle=n.color,o.fillStyle=n.color,o.font=s.string,tx(o,n.text,x,d,s)}_computeTitleHeight(){const t=this.options.title,n=$s(t.font),s=Si(t.padding);return t.display?n.lineHeight+s.height:0}_getLegendItemAt(t,n){let s,r,i;if(rd(t,this.left,this.right)&&rd(n,this.top,this.bottom)){for(i=this.legendHitBoxes,s=0;s<i.length;++s)if(r=i[s],rd(t,r.left,r.left+r.width)&&rd(n,r.top,r.top+r.height))return this.legendItems[s]}return null}handleEvent(t){const n=this.options;if(!Cqe(t.type,n))return;const s=this._getLegendItemAt(t.x,t.y);if(t.type==="mousemove"||t.type==="mouseout"){const r=this._hoveredItem,i=vqe(r,s);r&&!i&&nn(n.onLeave,[t,r,this],this),this._hoveredItem=s,s&&!i&&nn(n.onHover,[t,s,this],this)}else s&&nn(n.onClick,[t,s,this],this)}}function wqe(e,t,n,s,r){const i=jqe(s,e,t,n),o=Nqe(r,s,t.lineHeight);return{itemWidth:i,itemHeight:o}}function jqe(e,t,n,s){let r=e.text;return r&&typeof r!="string"&&(r=r.reduce((i,o)=>i.length>o.length?i:o)),t+n.size/2+s.measureText(r).width}function Nqe(e,t,n){let s=e;return typeof t.text!="string"&&(s=dee(t,n)),s}function dee(e,t){const n=e.text?e.text.length:0;return t*n}function Cqe(e,t){return!!((e==="mousemove"||e==="mouseout")&&(t.onHover||t.onLeave)||t.onClick&&(e==="click"||e==="mouseup"))}var Sqe={id:"legend",_element:MB,start(e,t,n){const s=e.legend=new MB({ctx:e.ctx,options:n,chart:e});pi.configure(e,s,n),pi.addBox(e,s)},stop(e){pi.removeBox(e,e.legend),delete e.legend},beforeUpdate(e,t,n){const s=e.legend;pi.configure(e,s,n),s.options=n},afterUpdate(e){const t=e.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent(e,t){t.replay||e.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(e,t,n){const s=t.datasetIndex,r=n.chart;r.isDatasetVisible(s)?(r.hide(s),t.hidden=!0):(r.show(s),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:e=>e.chart.options.color,boxWidth:40,padding:10,generateLabels(e){const t=e.data.datasets,{labels:{usePointStyle:n,pointStyle:s,textAlign:r,color:i,useBorderRadius:o,borderRadius:l}}=e.legend.options;return e._getSortedDatasetMetas().map(c=>{const u=c.controller.getStyle(n?0:void 0),d=Si(u.borderWidth);return{text:t[c.index].label,fillStyle:u.backgroundColor,fontColor:i,hidden:!c.visible,lineCap:u.borderCapStyle,lineDash:u.borderDash,lineDashOffset:u.borderDashOffset,lineJoin:u.borderJoinStyle,lineWidth:(d.width+d.height)/4,strokeStyle:u.borderColor,pointStyle:s||u.pointStyle,rotation:u.rotation,textAlign:r||u.textAlign,borderRadius:o&&(l||u.borderRadius),datasetIndex:c.index}},this)}},title:{color:e=>e.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:e=>!e.startsWith("on"),labels:{_scriptable:e=>!["generateLabels","filter","sort"].includes(e)}}};class uee extends hc{constructor(t){super(),this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,n){const s=this.options;if(this.left=0,this.top=0,!s.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=t,this.height=this.bottom=n;const r=ss(s.text)?s.text.length:1;this._padding=Si(s.padding);const i=r*$s(s.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=i:this.width=i}isHorizontal(){const t=this.options.position;return t==="top"||t==="bottom"}_drawArgs(t){const{top:n,left:s,bottom:r,right:i,options:o}=this,l=o.align;let c=0,u,d,h;return this.isHorizontal()?(d=Ps(l,s,i),h=n+t,u=i-s):(o.position==="left"?(d=s+t,h=Ps(l,r,n),c=za*-.5):(d=i-t,h=Ps(l,n,r),c=za*.5),u=r-n),{titleX:d,titleY:h,maxWidth:u,rotation:c}}draw(){const t=this.ctx,n=this.options;if(!n.display)return;const s=$s(n.font),i=s.lineHeight/2+this._padding.top,{titleX:o,titleY:l,maxWidth:c,rotation:u}=this._drawArgs(i);tx(t,n.text,0,0,s,{color:n.color,maxWidth:c,rotation:u,textAlign:l3(n.align),textBaseline:"middle",translation:[o,l]})}}function _qe(e,t){const n=new uee({ctx:e.ctx,options:t,chart:e});pi.configure(e,n,t),pi.addBox(e,n),e.titleBlock=n}var Aqe={id:"title",_element:uee,start(e,t,n){_qe(e,n)},stop(e){const t=e.titleBlock;pi.removeBox(e,t),delete e.titleBlock},beforeUpdate(e,t,n){const s=e.titleBlock;pi.configure(e,s,n),s.options=n},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const tp={average(e){if(!e.length)return!1;let t,n,s=new Set,r=0,i=0;for(t=0,n=e.length;t<n;++t){const l=e[t].element;if(l&&l.hasValue()){const c=l.tooltipPosition();s.add(c.x),r+=c.y,++i}}return i===0||s.size===0?!1:{x:[...s].reduce((l,c)=>l+c)/s.size,y:r/i}},nearest(e,t){if(!e.length)return!1;let n=t.x,s=t.y,r=Number.POSITIVE_INFINITY,i,o,l;for(i=0,o=e.length;i<o;++i){const c=e[i].element;if(c&&c.hasValue()){const u=c.getCenterPoint(),d=rL(t,u);d<r&&(r=d,l=c)}}if(l){const c=l.tooltipPosition();n=c.x,s=c.y}return{x:n,y:s}}};function No(e,t){return t&&(ss(t)?Array.prototype.push.apply(e,t):e.push(t)),e}function Sl(e){return(typeof e=="string"||e instanceof String)&&e.indexOf(`
`)>-1?e.split(`
`):e}function Tqe(e,t){const{element:n,datasetIndex:s,index:r}=t,i=e.getDatasetMeta(s).controller,{label:o,value:l}=i.getLabelAndValue(r);return{chart:e,label:o,parsed:i.getParsed(r),raw:e.data.datasets[s].data[r],formattedValue:l,dataset:i.getDataset(),dataIndex:r,datasetIndex:s,element:n}}function IB(e,t){const n=e.chart.ctx,{body:s,footer:r,title:i}=e,{boxWidth:o,boxHeight:l}=t,c=$s(t.bodyFont),u=$s(t.titleFont),d=$s(t.footerFont),h=i.length,p=r.length,x=s.length,v=Si(t.padding);let j=v.height,y=0,N=s.reduce((_,k)=>_+k.before.length+k.lines.length+k.after.length,0);if(N+=e.beforeBody.length+e.afterBody.length,h&&(j+=h*u.lineHeight+(h-1)*t.titleSpacing+t.titleMarginBottom),N){const _=t.displayColors?Math.max(l,c.lineHeight):c.lineHeight;j+=x*_+(N-x)*c.lineHeight+(N-1)*t.bodySpacing}p&&(j+=t.footerMarginTop+p*d.lineHeight+(p-1)*t.footerSpacing);let w=0;const S=function(_){y=Math.max(y,n.measureText(_).width+w)};return n.save(),n.font=u.string,$a(e.title,S),n.font=c.string,$a(e.beforeBody.concat(e.afterBody),S),w=t.displayColors?o+2+t.boxPadding:0,$a(s,_=>{$a(_.before,S),$a(_.lines,S),$a(_.after,S)}),w=0,n.font=d.string,$a(e.footer,S),n.restore(),y+=v.width,{width:y,height:j}}function kqe(e,t){const{y:n,height:s}=t;return n<s/2?"top":n>e.height-s/2?"bottom":"center"}function Eqe(e,t,n,s){const{x:r,width:i}=s,o=n.caretSize+n.caretPadding;if(e==="left"&&r+i+o>t.width||e==="right"&&r-i-o<0)return!0}function Lqe(e,t,n,s){const{x:r,width:i}=n,{width:o,chartArea:{left:l,right:c}}=e;let u="center";return s==="center"?u=r<=(l+c)/2?"left":"right":r<=i/2?u="left":r>=o-i/2&&(u="right"),Eqe(u,e,t,n)&&(u="center"),u}function $B(e,t,n){const s=n.yAlign||t.yAlign||kqe(e,n);return{xAlign:n.xAlign||t.xAlign||Lqe(e,t,n,s),yAlign:s}}function Pqe(e,t){let{x:n,width:s}=e;return t==="right"?n-=s:t==="center"&&(n-=s/2),n}function Dqe(e,t,n){let{y:s,height:r}=e;return t==="top"?s+=n:t==="bottom"?s-=r+n:s-=r/2,s}function RB(e,t,n,s){const{caretSize:r,caretPadding:i,cornerRadius:o}=e,{xAlign:l,yAlign:c}=n,u=r+i,{topLeft:d,topRight:h,bottomLeft:p,bottomRight:x}=Cf(o);let v=Pqe(t,l);const j=Dqe(t,c,u);return c==="center"?l==="left"?v+=u:l==="right"&&(v-=u):l==="left"?v-=Math.max(d,p)+r:l==="right"&&(v+=Math.max(h,x)+r),{x:Is(v,0,s.width-t.width),y:Is(j,0,s.height-t.height)}}function Vb(e,t,n){const s=Si(n.padding);return t==="center"?e.x+e.width/2:t==="right"?e.x+e.width-s.right:e.x+s.left}function zB(e){return No([],Sl(e))}function Oqe(e,t,n){return lm(e,{tooltip:t,tooltipItems:n,type:"tooltip"})}function FB(e,t){const n=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return n?e.override(n):e}const mee={beforeTitle:jl,title(e){if(e.length>0){const t=e[0],n=t.chart.data.labels,s=n?n.length:0;if(this&&this.options&&this.options.mode==="dataset")return t.dataset.label||"";if(t.label)return t.label;if(s>0&&t.dataIndex<s)return n[t.dataIndex]}return""},afterTitle:jl,beforeBody:jl,beforeLabel:jl,label(e){if(this&&this.options&&this.options.mode==="dataset")return e.label+": "+e.formattedValue||e.formattedValue;let t=e.dataset.label||"";t&&(t+=": ");const n=e.formattedValue;return Pa(n)||(t+=n),t},labelColor(e){const n=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{borderColor:n.borderColor,backgroundColor:n.backgroundColor,borderWidth:n.borderWidth,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(e){const n=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{pointStyle:n.pointStyle,rotation:n.rotation}},afterLabel:jl,afterBody:jl,beforeFooter:jl,footer:jl,afterFooter:jl};function or(e,t,n,s){const r=e[t].call(n,s);return typeof r>"u"?mee[t].call(n,s):r}class UB extends hc{static positioners=tp;constructor(t){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=t.chart,this.options=t.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(t){this.options=t,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const t=this._cachedAnimations;if(t)return t;const n=this.chart,s=this.options.setContext(this.getContext()),r=s.enabled&&n.options.animation&&s.animations,i=new QJ(this.chart,r);return r._cacheable&&(this._cachedAnimations=Object.freeze(i)),i}getContext(){return this.$context||(this.$context=Oqe(this.chart.getContext(),this,this._tooltipItems))}getTitle(t,n){const{callbacks:s}=n,r=or(s,"beforeTitle",this,t),i=or(s,"title",this,t),o=or(s,"afterTitle",this,t);let l=[];return l=No(l,Sl(r)),l=No(l,Sl(i)),l=No(l,Sl(o)),l}getBeforeBody(t,n){return zB(or(n.callbacks,"beforeBody",this,t))}getBody(t,n){const{callbacks:s}=n,r=[];return $a(t,i=>{const o={before:[],lines:[],after:[]},l=FB(s,i);No(o.before,Sl(or(l,"beforeLabel",this,i))),No(o.lines,or(l,"label",this,i)),No(o.after,Sl(or(l,"afterLabel",this,i))),r.push(o)}),r}getAfterBody(t,n){return zB(or(n.callbacks,"afterBody",this,t))}getFooter(t,n){const{callbacks:s}=n,r=or(s,"beforeFooter",this,t),i=or(s,"footer",this,t),o=or(s,"afterFooter",this,t);let l=[];return l=No(l,Sl(r)),l=No(l,Sl(i)),l=No(l,Sl(o)),l}_createItems(t){const n=this._active,s=this.chart.data,r=[],i=[],o=[];let l=[],c,u;for(c=0,u=n.length;c<u;++c)l.push(Tqe(this.chart,n[c]));return t.filter&&(l=l.filter((d,h,p)=>t.filter(d,h,p,s))),t.itemSort&&(l=l.sort((d,h)=>t.itemSort(d,h,s))),$a(l,d=>{const h=FB(t.callbacks,d);r.push(or(h,"labelColor",this,d)),i.push(or(h,"labelPointStyle",this,d)),o.push(or(h,"labelTextColor",this,d))}),this.labelColors=r,this.labelPointStyles=i,this.labelTextColors=o,this.dataPoints=l,l}update(t,n){const s=this.options.setContext(this.getContext()),r=this._active;let i,o=[];if(!r.length)this.opacity!==0&&(i={opacity:0});else{const l=tp[s.position].call(this,r,this._eventPosition);o=this._createItems(s),this.title=this.getTitle(o,s),this.beforeBody=this.getBeforeBody(o,s),this.body=this.getBody(o,s),this.afterBody=this.getAfterBody(o,s),this.footer=this.getFooter(o,s);const c=this._size=IB(this,s),u=Object.assign({},l,c),d=$B(this.chart,s,u),h=RB(s,u,d,this.chart);this.xAlign=d.xAlign,this.yAlign=d.yAlign,i={opacity:1,x:h.x,y:h.y,width:c.width,height:c.height,caretX:l.x,caretY:l.y}}this._tooltipItems=o,this.$context=void 0,i&&this._resolveAnimations().update(this,i),t&&s.external&&s.external.call(this,{chart:this.chart,tooltip:this,replay:n})}drawCaret(t,n,s,r){const i=this.getCaretPosition(t,s,r);n.lineTo(i.x1,i.y1),n.lineTo(i.x2,i.y2),n.lineTo(i.x3,i.y3)}getCaretPosition(t,n,s){const{xAlign:r,yAlign:i}=this,{caretSize:o,cornerRadius:l}=s,{topLeft:c,topRight:u,bottomLeft:d,bottomRight:h}=Cf(l),{x:p,y:x}=t,{width:v,height:j}=n;let y,N,w,S,_,k;return i==="center"?(_=x+j/2,r==="left"?(y=p,N=y-o,S=_+o,k=_-o):(y=p+v,N=y+o,S=_-o,k=_+o),w=y):(r==="left"?N=p+Math.max(c,d)+o:r==="right"?N=p+v-Math.max(u,h)-o:N=this.caretX,i==="top"?(S=x,_=S-o,y=N-o,w=N+o):(S=x+j,_=S+o,y=N+o,w=N-o),k=S),{x1:y,x2:N,x3:w,y1:S,y2:_,y3:k}}drawTitle(t,n,s){const r=this.title,i=r.length;let o,l,c;if(i){const u=Sf(s.rtl,this.x,this.width);for(t.x=Vb(this,s.titleAlign,s),n.textAlign=u.textAlign(s.titleAlign),n.textBaseline="middle",o=$s(s.titleFont),l=s.titleSpacing,n.fillStyle=s.titleColor,n.font=o.string,c=0;c<i;++c)n.fillText(r[c],u.x(t.x),t.y+o.lineHeight/2),t.y+=o.lineHeight+l,c+1===i&&(t.y+=s.titleMarginBottom-l)}}_drawColorBox(t,n,s,r,i){const o=this.labelColors[s],l=this.labelPointStyles[s],{boxHeight:c,boxWidth:u}=i,d=$s(i.bodyFont),h=Vb(this,"left",i),p=r.x(h),x=c<d.lineHeight?(d.lineHeight-c)/2:0,v=n.y+x;if(i.usePointStyle){const j={radius:Math.min(u,c)/2,pointStyle:l.pointStyle,rotation:l.rotation,borderWidth:1},y=r.leftForLtr(p,u)+u/2,N=v+c/2;t.strokeStyle=i.multiKeyBackground,t.fillStyle=i.multiKeyBackground,oL(t,j,y,N),t.strokeStyle=o.borderColor,t.fillStyle=o.backgroundColor,oL(t,j,y,N)}else{t.lineWidth=Ca(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,t.strokeStyle=o.borderColor,t.setLineDash(o.borderDash||[]),t.lineDashOffset=o.borderDashOffset||0;const j=r.leftForLtr(p,u),y=r.leftForLtr(r.xPlus(p,1),u-2),N=Cf(o.borderRadius);Object.values(N).some(w=>w!==0)?(t.beginPath(),t.fillStyle=i.multiKeyBackground,Jw(t,{x:j,y:v,w:u,h:c,radius:N}),t.fill(),t.stroke(),t.fillStyle=o.backgroundColor,t.beginPath(),Jw(t,{x:y,y:v+1,w:u-2,h:c-2,radius:N}),t.fill()):(t.fillStyle=i.multiKeyBackground,t.fillRect(j,v,u,c),t.strokeRect(j,v,u,c),t.fillStyle=o.backgroundColor,t.fillRect(y,v+1,u-2,c-2))}t.fillStyle=this.labelTextColors[s]}drawBody(t,n,s){const{body:r}=this,{bodySpacing:i,bodyAlign:o,displayColors:l,boxHeight:c,boxWidth:u,boxPadding:d}=s,h=$s(s.bodyFont);let p=h.lineHeight,x=0;const v=Sf(s.rtl,this.x,this.width),j=function(E){n.fillText(E,v.x(t.x+x),t.y+p/2),t.y+=p+i},y=v.textAlign(o);let N,w,S,_,k,T,A;for(n.textAlign=o,n.textBaseline="middle",n.font=h.string,t.x=Vb(this,y,s),n.fillStyle=s.bodyColor,$a(this.beforeBody,j),x=l&&y!=="right"?o==="center"?u/2+d:u+2+d:0,_=0,T=r.length;_<T;++_){for(N=r[_],w=this.labelTextColors[_],n.fillStyle=w,$a(N.before,j),S=N.lines,l&&S.length&&(this._drawColorBox(n,t,_,v,s),p=Math.max(h.lineHeight,c)),k=0,A=S.length;k<A;++k)j(S[k]),p=h.lineHeight;$a(N.after,j)}x=0,p=h.lineHeight,$a(this.afterBody,j),t.y-=i}drawFooter(t,n,s){const r=this.footer,i=r.length;let o,l;if(i){const c=Sf(s.rtl,this.x,this.width);for(t.x=Vb(this,s.footerAlign,s),t.y+=s.footerMarginTop,n.textAlign=c.textAlign(s.footerAlign),n.textBaseline="middle",o=$s(s.footerFont),n.fillStyle=s.footerColor,n.font=o.string,l=0;l<i;++l)n.fillText(r[l],c.x(t.x),t.y+o.lineHeight/2),t.y+=o.lineHeight+s.footerSpacing}}drawBackground(t,n,s,r){const{xAlign:i,yAlign:o}=this,{x:l,y:c}=t,{width:u,height:d}=s,{topLeft:h,topRight:p,bottomLeft:x,bottomRight:v}=Cf(r.cornerRadius);n.fillStyle=r.backgroundColor,n.strokeStyle=r.borderColor,n.lineWidth=r.borderWidth,n.beginPath(),n.moveTo(l+h,c),o==="top"&&this.drawCaret(t,n,s,r),n.lineTo(l+u-p,c),n.quadraticCurveTo(l+u,c,l+u,c+p),o==="center"&&i==="right"&&this.drawCaret(t,n,s,r),n.lineTo(l+u,c+d-v),n.quadraticCurveTo(l+u,c+d,l+u-v,c+d),o==="bottom"&&this.drawCaret(t,n,s,r),n.lineTo(l+x,c+d),n.quadraticCurveTo(l,c+d,l,c+d-x),o==="center"&&i==="left"&&this.drawCaret(t,n,s,r),n.lineTo(l,c+h),n.quadraticCurveTo(l,c,l+h,c),n.closePath(),n.fill(),r.borderWidth>0&&n.stroke()}_updateAnimationTarget(t){const n=this.chart,s=this.$animations,r=s&&s.x,i=s&&s.y;if(r||i){const o=tp[t.position].call(this,this._active,this._eventPosition);if(!o)return;const l=this._size=IB(this,t),c=Object.assign({},o,this._size),u=$B(n,t,c),d=RB(t,c,u,n);(r._to!==d.x||i._to!==d.y)&&(this.xAlign=u.xAlign,this.yAlign=u.yAlign,this.width=l.width,this.height=l.height,this.caretX=o.x,this.caretY=o.y,this._resolveAnimations().update(this,d))}}_willRender(){return!!this.opacity}draw(t){const n=this.options.setContext(this.getContext());let s=this.opacity;if(!s)return;this._updateAnimationTarget(n);const r={width:this.width,height:this.height},i={x:this.x,y:this.y};s=Math.abs(s)<.001?0:s;const o=Si(n.padding),l=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;n.enabled&&l&&(t.save(),t.globalAlpha=s,this.drawBackground(i,t,r,n),WJ(t,n.textDirection),i.y+=o.top,this.drawTitle(i,t,n),this.drawBody(i,t,n),this.drawFooter(i,t,n),VJ(t,n.textDirection),t.restore())}getActiveElements(){return this._active||[]}setActiveElements(t,n){const s=this._active,r=t.map(({datasetIndex:l,index:c})=>{const u=this.chart.getDatasetMeta(l);if(!u)throw new Error("Cannot find a dataset at index "+l);return{datasetIndex:l,element:u.data[c],index:c}}),i=!Kw(s,r),o=this._positionChanged(r,n);(i||o)&&(this._active=r,this._eventPosition=n,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(t,n,s=!0){if(n&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const r=this.options,i=this._active||[],o=this._getActiveElements(t,i,n,s),l=this._positionChanged(o,t),c=n||!Kw(o,i)||l;return c&&(this._active=o,(r.enabled||r.external)&&(this._eventPosition={x:t.x,y:t.y},this.update(!0,n))),c}_getActiveElements(t,n,s,r){const i=this.options;if(t.type==="mouseout")return[];if(!r)return n.filter(l=>this.chart.data.datasets[l.datasetIndex]&&this.chart.getDatasetMeta(l.datasetIndex).controller.getParsed(l.index)!==void 0);const o=this.chart.getElementsAtEventForMode(t,i.mode,i,s);return i.reverse&&o.reverse(),o}_positionChanged(t,n){const{caretX:s,caretY:r,options:i}=this,o=tp[i.position].call(this,t,n);return o!==!1&&(s!==o.x||r!==o.y)}}var Mqe={id:"tooltip",_element:UB,positioners:tp,afterInit(e,t,n){n&&(e.tooltip=new UB({chart:e,options:n}))},beforeUpdate(e,t,n){e.tooltip&&e.tooltip.initialize(n)},reset(e,t,n){e.tooltip&&e.tooltip.initialize(n)},afterDraw(e){const t=e.tooltip;if(t&&t._willRender()){const n={tooltip:t};if(e.notifyPlugins("beforeTooltipDraw",{...n,cancelable:!0})===!1)return;t.draw(e.ctx),e.notifyPlugins("afterTooltipDraw",n)}},afterEvent(e,t){if(e.tooltip){const n=t.replay;e.tooltip.handleEvent(t.event,n,t.inChartArea)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(e,t)=>t.bodyFont.size,boxWidth:(e,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:mee},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:e=>e!=="filter"&&e!=="itemSort"&&e!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const Iqe=(e,t,n,s)=>(typeof t=="string"?(n=e.push(t)-1,s.unshift({index:n,label:t})):isNaN(t)&&(n=null),n);function $qe(e,t,n,s){const r=e.indexOf(t);if(r===-1)return Iqe(e,t,n,s);const i=e.lastIndexOf(t);return r!==i?n:r}const Rqe=(e,t)=>e===null?null:Is(Math.round(e),0,t);function BB(e){const t=this.getLabels();return e>=0&&e<t.length?t[e]:e}class zqe extends Nh{static id="category";static defaults={ticks:{callback:BB}};constructor(t){super(t),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(t){const n=this._addedLabels;if(n.length){const s=this.getLabels();for(const{index:r,label:i}of n)s[r]===i&&s.splice(r,1);this._addedLabels=[]}super.init(t)}parse(t,n){if(Pa(t))return null;const s=this.getLabels();return n=isFinite(n)&&s[n]===t?n:$qe(s,t,ma(n,t),this._addedLabels),Rqe(n,s.length-1)}determineDataLimits(){const{minDefined:t,maxDefined:n}=this.getUserBounds();let{min:s,max:r}=this.getMinMax(!0);this.options.bounds==="ticks"&&(t||(s=0),n||(r=this.getLabels().length-1)),this.min=s,this.max=r}buildTicks(){const t=this.min,n=this.max,s=this.options.offset,r=[];let i=this.getLabels();i=t===0&&n===i.length-1?i:i.slice(t,n+1),this._valueRange=Math.max(i.length-(s?0:1),1),this._startValue=this.min-(s?.5:0);for(let o=t;o<=n;o++)r.push({value:o});return r}getLabelForValue(t){return BB.call(this,t)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(t){return typeof t!="number"&&(t=this.parse(t)),t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getPixelForTick(t){const n=this.ticks;return t<0||t>n.length-1?null:this.getPixelForValue(n[t].value)}getValueForPixel(t){return Math.round(this._startValue+this.getDecimalForPixel(t)*this._valueRange)}getBasePixel(){return this.bottom}}function Fqe(e,t){const n=[],{bounds:r,step:i,min:o,max:l,precision:c,count:u,maxTicks:d,maxDigits:h,includeBounds:p}=e,x=i||1,v=d-1,{min:j,max:y}=t,N=!Pa(o),w=!Pa(l),S=!Pa(u),_=(y-j)/(h+1);let k=H8((y-j)/v/x)*x,T,A,E,M;if(k<1e-14&&!N&&!w)return[{value:j},{value:y}];M=Math.ceil(y/k)-Math.floor(j/k),M>v&&(k=H8(M*k/v/x)*x),Pa(c)||(T=Math.pow(10,c),k=Math.ceil(k*T)/T),r==="ticks"?(A=Math.floor(j/k)*k,E=Math.ceil(y/k)*k):(A=j,E=y),N&&w&&i&&X8e((l-o)/i,k/1e3)?(M=Math.round(Math.min((l-o)/k,d)),k=(l-o)/M,A=o,E=l):S?(A=N?o:A,E=w?l:E,M=u-1,k=(E-A)/M):(M=(E-A)/k,fp(M,Math.round(M),k/1e3)?M=Math.round(M):M=Math.ceil(M));const z=Math.max(q8(k),q8(A));T=Math.pow(10,Pa(c)?z:c),A=Math.round(A*T)/T,E=Math.round(E*T)/T;let P=0;for(N&&(p&&A!==o?(n.push({value:o}),A<o&&P++,fp(Math.round((A+P*k)*T)/T,o,HB(o,_,e))&&P++):A<o&&P++);P<M;++P){const D=Math.round((A+P*k)*T)/T;if(w&&D>l)break;n.push({value:D})}return w&&p&&E!==l?n.length&&fp(n[n.length-1].value,l,HB(l,_,e))?n[n.length-1].value=l:n.push({value:l}):(!w||E===l)&&n.push({value:E}),n}function HB(e,t,{horizontal:n,minRotation:s}){const r=Dl(s),i=(n?Math.sin(r):Math.cos(r))||.001,o=.75*t*(""+e).length;return Math.min(t/i,o)}class Uqe extends Nh{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(t,n){return Pa(t)||(typeof t=="number"||t instanceof Number)&&!isFinite(+t)?null:+t}handleTickRangeOptions(){const{beginAtZero:t}=this.options,{minDefined:n,maxDefined:s}=this.getUserBounds();let{min:r,max:i}=this;const o=c=>r=n?r:c,l=c=>i=s?i:c;if(t){const c=Fo(r),u=Fo(i);c<0&&u<0?l(0):c>0&&u>0&&o(0)}if(r===i){let c=i===0?1:Math.abs(i*.05);l(i+c),t||o(r-c)}this.min=r,this.max=i}getTickLimit(){const t=this.options.ticks;let{maxTicksLimit:n,stepSize:s}=t,r;return s?(r=Math.ceil(this.max/s)-Math.floor(this.min/s)+1,r>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${s} would result generating up to ${r} ticks. Limiting to 1000.`),r=1e3)):(r=this.computeTickLimit(),n=n||11),n&&(r=Math.min(n,r)),r}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const t=this.options,n=t.ticks;let s=this.getTickLimit();s=Math.max(2,s);const r={maxTicks:s,bounds:t.bounds,min:t.min,max:t.max,precision:n.precision,step:n.stepSize,count:n.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:n.minRotation||0,includeBounds:n.includeBounds!==!1},i=this._range||this,o=Fqe(r,i);return t.bounds==="ticks"&&Z8e(o,this,"value"),t.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}configure(){const t=this.ticks;let n=this.min,s=this.max;if(super.configure(),this.options.offset&&t.length){const r=(s-n)/Math.max(t.length-1,1)/2;n-=r,s+=r}this._startValue=n,this._endValue=s,this._valueRange=s-n}getLabelForValue(t){return d3(t,this.chart.options.locale,this.options.ticks.format)}}class Bqe extends Uqe{static id="linear";static defaults={ticks:{callback:RJ.formatters.numeric}};determineDataLimits(){const{min:t,max:n}=this.getMinMax(!0);this.min=Ci(t)?t:0,this.max=Ci(n)?n:1,this.handleTickRangeOptions()}computeTickLimit(){const t=this.isHorizontal(),n=t?this.width:this.height,s=Dl(this.options.ticks.minRotation),r=(t?Math.sin(s):Math.cos(s))||.001,i=this._resolveTickFontOptions(0);return Math.ceil(n/Math.min(40,i.lineHeight/r))}getPixelForValue(t){return t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getValueForPixel(t){return this._startValue+this.getDecimalForPixel(t)*this._valueRange}}const M1={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},mr=Object.keys(M1);function qB(e,t){return e-t}function GB(e,t){if(Pa(t))return null;const n=e._adapter,{parser:s,round:r,isoWeekday:i}=e._parseOpts;let o=t;return typeof s=="function"&&(o=s(o)),Ci(o)||(o=typeof s=="string"?n.parse(o,s):n.parse(o)),o===null?null:(r&&(o=r==="week"&&(Zp(i)||i===!0)?n.startOf(o,"isoWeek",i):n.startOf(o,r)),+o)}function WB(e,t,n,s){const r=mr.length;for(let i=mr.indexOf(e);i<r-1;++i){const o=M1[mr[i]],l=o.steps?o.steps:Number.MAX_SAFE_INTEGER;if(o.common&&Math.ceil((n-t)/(l*o.size))<=s)return mr[i]}return mr[r-1]}function Hqe(e,t,n,s,r){for(let i=mr.length-1;i>=mr.indexOf(n);i--){const o=mr[i];if(M1[o].common&&e._adapter.diff(r,s,o)>=t-1)return o}return mr[n?mr.indexOf(n):0]}function qqe(e){for(let t=mr.indexOf(e)+1,n=mr.length;t<n;++t)if(M1[mr[t]].common)return mr[t]}function VB(e,t,n){if(!n)e[t]=!0;else if(n.length){const{lo:s,hi:r}=o3(n,t),i=n[s]>=t?n[s]:n[r];e[i]=!0}}function Gqe(e,t,n,s){const r=e._adapter,i=+r.startOf(t[0].value,s),o=t[t.length-1].value;let l,c;for(l=i;l<=o;l=+r.add(l,1,s))c=n[l],c>=0&&(t[c].major=!0);return t}function YB(e,t,n){const s=[],r={},i=t.length;let o,l;for(o=0;o<i;++o)l=t[o],r[l]=o,s.push({value:l,major:!1});return i===0||!n?s:Gqe(e,s,r,n)}class QB extends Nh{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(t){super(t),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(t,n={}){const s=t.time||(t.time={}),r=this._adapter=new UHe._date(t.adapters.date);r.init(n),mp(s.displayFormats,r.formats()),this._parseOpts={parser:s.parser,round:s.round,isoWeekday:s.isoWeekday},super.init(t),this._normalized=n.normalized}parse(t,n){return t===void 0?null:GB(this,t)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const t=this.options,n=this._adapter,s=t.time.unit||"day";let{min:r,max:i,minDefined:o,maxDefined:l}=this.getUserBounds();function c(u){!o&&!isNaN(u.min)&&(r=Math.min(r,u.min)),!l&&!isNaN(u.max)&&(i=Math.max(i,u.max))}(!o||!l)&&(c(this._getLabelBounds()),(t.bounds!=="ticks"||t.ticks.source!=="labels")&&c(this.getMinMax(!1))),r=Ci(r)&&!isNaN(r)?r:+n.startOf(Date.now(),s),i=Ci(i)&&!isNaN(i)?i:+n.endOf(Date.now(),s)+1,this.min=Math.min(r,i-1),this.max=Math.max(r+1,i)}_getLabelBounds(){const t=this.getLabelTimestamps();let n=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;return t.length&&(n=t[0],s=t[t.length-1]),{min:n,max:s}}buildTicks(){const t=this.options,n=t.time,s=t.ticks,r=s.source==="labels"?this.getLabelTimestamps():this._generate();t.bounds==="ticks"&&r.length&&(this.min=this._userMin||r[0],this.max=this._userMax||r[r.length-1]);const i=this.min,o=this.max,l=nBe(r,i,o);return this._unit=n.unit||(s.autoSkip?WB(n.minUnit,this.min,this.max,this._getLabelCapacity(i)):Hqe(this,l.length,n.minUnit,this.min,this.max)),this._majorUnit=!s.major.enabled||this._unit==="year"?void 0:qqe(this._unit),this.initOffsets(r),t.reverse&&l.reverse(),YB(this,l,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(t=>+t.value))}initOffsets(t=[]){let n=0,s=0,r,i;this.options.offset&&t.length&&(r=this.getDecimalForValue(t[0]),t.length===1?n=1-r:n=(this.getDecimalForValue(t[1])-r)/2,i=this.getDecimalForValue(t[t.length-1]),t.length===1?s=i:s=(i-this.getDecimalForValue(t[t.length-2]))/2);const o=t.length<3?.5:.25;n=Is(n,0,o),s=Is(s,0,o),this._offsets={start:n,end:s,factor:1/(n+1+s)}}_generate(){const t=this._adapter,n=this.min,s=this.max,r=this.options,i=r.time,o=i.unit||WB(i.minUnit,n,s,this._getLabelCapacity(n)),l=ma(r.ticks.stepSize,1),c=o==="week"?i.isoWeekday:!1,u=Zp(c)||c===!0,d={};let h=n,p,x;if(u&&(h=+t.startOf(h,"isoWeek",c)),h=+t.startOf(h,u?"day":o),t.diff(s,n,o)>1e5*l)throw new Error(n+" and "+s+" are too far apart with stepSize of "+l+" "+o);const v=r.ticks.source==="data"&&this.getDataTimestamps();for(p=h,x=0;p<s;p=+t.add(p,l,o),x++)VB(d,p,v);return(p===s||r.bounds==="ticks"||x===1)&&VB(d,p,v),Object.keys(d).sort(qB).map(j=>+j)}getLabelForValue(t){const n=this._adapter,s=this.options.time;return s.tooltipFormat?n.format(t,s.tooltipFormat):n.format(t,s.displayFormats.datetime)}format(t,n){const r=this.options.time.displayFormats,i=this._unit,o=n||r[i];return this._adapter.format(t,o)}_tickFormatFunction(t,n,s,r){const i=this.options,o=i.ticks.callback;if(o)return nn(o,[t,n,s],this);const l=i.time.displayFormats,c=this._unit,u=this._majorUnit,d=c&&l[c],h=u&&l[u],p=s[n],x=u&&h&&p&&p.major;return this._adapter.format(t,r||(x?h:d))}generateTickLabels(t){let n,s,r;for(n=0,s=t.length;n<s;++n)r=t[n],r.label=this._tickFormatFunction(r.value,n,t)}getDecimalForValue(t){return t===null?NaN:(t-this.min)/(this.max-this.min)}getPixelForValue(t){const n=this._offsets,s=this.getDecimalForValue(t);return this.getPixelForDecimal((n.start+s)*n.factor)}getValueForPixel(t){const n=this._offsets,s=this.getDecimalForPixel(t)/n.factor-n.end;return this.min+s*(this.max-this.min)}_getLabelSize(t){const n=this.options.ticks,s=this.ctx.measureText(t).width,r=Dl(this.isHorizontal()?n.maxRotation:n.minRotation),i=Math.cos(r),o=Math.sin(r),l=this._resolveTickFontOptions(0).size;return{w:s*i+l*o,h:s*o+l*i}}_getLabelCapacity(t){const n=this.options.time,s=n.displayFormats,r=s[n.unit]||s.millisecond,i=this._tickFormatFunction(t,0,YB(this,[t],this._majorUnit),r),o=this._getLabelSize(i),l=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return l>0?l:1}getDataTimestamps(){let t=this._cache.data||[],n,s;if(t.length)return t;const r=this.getMatchingVisibleMetas();if(this._normalized&&r.length)return this._cache.data=r[0].controller.getAllParsedValues(this);for(n=0,s=r.length;n<s;++n)t=t.concat(r[n].controller.getAllParsedValues(this));return this._cache.data=this.normalize(t)}getLabelTimestamps(){const t=this._cache.labels||[];let n,s;if(t.length)return t;const r=this.getLabels();for(n=0,s=r.length;n<s;++n)t.push(GB(this,r[n]));return this._cache.labels=this._normalized?t:this.normalize(t)}normalize(t){return MJ(t.sort(qB))}}function Yb(e,t,n){let s=0,r=e.length-1,i,o,l,c;n?(t>=e[s].pos&&t<=e[r].pos&&({lo:s,hi:r}=bu(e,"pos",t)),{pos:i,time:l}=e[s],{pos:o,time:c}=e[r]):(t>=e[s].time&&t<=e[r].time&&({lo:s,hi:r}=bu(e,"time",t)),{time:i,pos:l}=e[s],{time:o,pos:c}=e[r]);const u=o-i;return u?l+(c-l)*(t-i)/u:l}class pYe extends QB{static id="timeseries";static defaults=QB.defaults;constructor(t){super(t),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const t=this._getTimestampsForTable(),n=this._table=this.buildLookupTable(t);this._minPos=Yb(n,this.min),this._tableRange=Yb(n,this.max)-this._minPos,super.initOffsets(t)}buildLookupTable(t){const{min:n,max:s}=this,r=[],i=[];let o,l,c,u,d;for(o=0,l=t.length;o<l;++o)u=t[o],u>=n&&u<=s&&r.push(u);if(r.length<2)return[{time:n,pos:0},{time:s,pos:1}];for(o=0,l=r.length;o<l;++o)d=r[o+1],c=r[o-1],u=r[o],Math.round((d+c)/2)!==u&&i.push({time:u,pos:o/(l-1)});return i}_generate(){const t=this.min,n=this.max;let s=super.getDataTimestamps();return(!s.includes(t)||!s.length)&&s.splice(0,0,t),(!s.includes(n)||s.length===1)&&s.push(n),s.sort((r,i)=>r-i)}_getTimestampsForTable(){let t=this._cache.all||[];if(t.length)return t;const n=this.getDataTimestamps(),s=this.getLabelTimestamps();return n.length&&s.length?t=this.normalize(n.concat(s)):t=n.length?n:s,t=this._cache.all=t,t}getDecimalForValue(t){return(Yb(this._table,t)-this._minPos)/this._tableRange}getValueForPixel(t){const n=this._offsets,s=this.getDecimalForPixel(t)/n.factor-n.end;return Yb(this._table,s*this._tableRange+this._minPos,!0)}}const fee="label";function KB(e,t){typeof e=="function"?e(t):e&&(e.current=t)}function Wqe(e,t){const n=e.options;n&&t&&Object.assign(n,t)}function hee(e,t){e.labels=t}function gee(e,t,n=fee){const s=[];e.datasets=t.map(r=>{const i=e.datasets.find(o=>o[n]===r[n]);return!i||!r.data||s.includes(i)?{...r}:(s.push(i),Object.assign(i,r),i)})}function Vqe(e,t=fee){const n={labels:[],datasets:[]};return hee(n,e.labels),gee(n,e.datasets,t),n}function Yqe(e,t){const{height:n=150,width:s=300,redraw:r=!1,datasetIdKey:i,type:o,data:l,options:c,plugins:u=[],fallbackContent:d,updateMode:h,...p}=e,x=f.useRef(null),v=f.useRef(null),j=()=>{x.current&&(v.current=new O1(x.current,{type:o,data:Vqe(l,i),options:c&&{...c},plugins:u}),KB(t,v.current))},y=()=>{KB(t,null),v.current&&(v.current.destroy(),v.current=null)};return f.useEffect(()=>{!r&&v.current&&c&&Wqe(v.current,c)},[r,c]),f.useEffect(()=>{!r&&v.current&&hee(v.current.config.data,l.labels)},[r,l.labels]),f.useEffect(()=>{!r&&v.current&&l.datasets&&gee(v.current.config.data,l.datasets,i)},[r,l.datasets]),f.useEffect(()=>{v.current&&(r?(y(),setTimeout(j)):v.current.update(h))},[r,c,l.labels,l.datasets,h]),f.useEffect(()=>{v.current&&(y(),setTimeout(j))},[o]),f.useEffect(()=>(j(),()=>y()),[]),a.jsx("canvas",{ref:x,role:"img",height:n,width:s,...p,children:d})}const Qqe=f.forwardRef(Yqe);function v3(e,t){return O1.register(t),f.forwardRef((n,s)=>a.jsx(Qqe,{...n,ref:s,type:e}))}const Kqe=v3("line",zHe),Xqe=v3("bar",IHe),Zqe=v3("pie",FHe);O1.register(zqe,Bqe,bqe,mqe,fqe,aqe,Aqe,Mqe,Sqe);const pee=e=>a.jsx(Za,{...e}),Jqe=e=>a.jsx(h9,{...e}),eGe=e=>a.jsx(ux,{...e}),tGe=e=>a.jsx(Qa,{...e}),xee=e=>a.jsx(ia,{...e}),aGe=e=>a.jsx(Oue,{...e}),nGe=[{icon:pee,title:"Total Contacts",value:128,color:"text-blue-600",bgColor:"bg-blue-50"},{icon:xee,title:"Emails Sent",value:450,color:"text-purple-600",bgColor:"bg-purple-50"},{icon:eGe,title:"Active Campaigns",value:9,color:"text-green-600",bgColor:"bg-green-50"},{icon:Jqe,title:"Revenue",value:125e3,color:"text-yellow-600",bgColor:"bg-yellow-50"}],sGe=[{name:"Emma Watty",company:"Tech Interaction Inc.",assignedBy:"Alice Smith",source:"Website",date:"Oct 10, 2:10 PM"},{name:"John Johnny",company:"Capital Business Co.",assignedBy:"Bob Johnson",source:"Referral",date:"Oct 9, 12:00 AM"},{name:"Annie Arnty",company:"Dynamic Systems Inc.",assignedBy:"Catherine Lee",source:"Trade Show",date:"Oct 8, 1:25 PM"},{name:"James Wilson",company:"Global Services LLC",assignedBy:"David Kim",source:"Cold Call",date:"Oct 7, 11:15 AM"}],rGe={labels:["Week 1","Week 2","Week 3","Week 4"],datasets:[{label:"Leads",data:[50,75,60,90],backgroundColor:"rgba(96, 165, 250, 0.6)",borderColor:"rgba(96, 165, 250, 1)",borderWidth:1},{label:"Conversions",data:[10,20,15,25],backgroundColor:"rgba(34, 197, 94, 0.6)",borderColor:"rgba(34, 197, 94, 1)",borderWidth:1}]},iGe={responsive:!0,plugins:{legend:{position:"top",labels:{color:"#374151"}},title:{display:!0,color:"#111827",font:{size:18}}}},oGe={labels:["Leads","Conversions"],datasets:[{label:"Leads Status",data:[75,25],backgroundColor:["rgba(96, 165, 250, 0.6)","rgba(34, 197, 94, 0.6)"],borderColor:["rgba(96, 165, 250, 1)","rgba(34, 197, 94, 1)"],borderWidth:1}]},lGe={responsive:!0,plugins:{legend:{position:"top",labels:{color:"#374151"}},title:{display:!0,color:"#111827",font:{size:18}}}},cGe=e=>{switch(e){case"Website":return{text:"text-green-600",bg:"bg-green-100"};case"Referral":return{text:"text-purple-600",bg:"bg-purple-100"};case"Trade Show":return{text:"text-orange-600",bg:"bg-orange-100"};case"Cold Call":return{text:"text-red-600",bg:"bg-red-100"};default:return{text:"text-gray-600",bg:"bg-gray-100"}}},dGe=()=>{const e=[{icon:pee,label:"New Contact"},{icon:xee,label:"New Campaign"},{icon:tGe,label:"New Task"},{icon:aGe,label:"New Leads"}];return a.jsxs("div",{className:"bg-white rounded-xl shadow-md p-4 flex flex-col md:flex-row items-center space-y-3 md:space-y-0 md:space-x-4",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 py-2 flex-grow focus-within:ring-2 focus-within:ring-indigo-500 transition w-full md:max-w-3xl",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search Contacts, Leads, or Campaigns...",className:"focus:outline-none text-base w-full"})]}),a.jsx("div",{className:"flex space-x-3 md:ml-auto",children:e.map((t,n)=>a.jsxs("div",{className:"relative group",children:[a.jsx("button",{className:"p-2 text-gray-500 hover:text-gray-900 transition rounded-full hover:bg-gray-100 focus:outline-none",children:a.jsx(t.icon,{size:20})}),a.jsx("span",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-1 bg-gray-800 text-white text-xs rounded-md whitespace-nowrap opacity-0 invisible group-hover:opacity-100 group-hover:visible transition",children:t.label})]},n))})]})},uGe=({icon:e,title:t,value:n,color:s,bgColor:r})=>a.jsxs("div",{className:"flex items-center p-4 bg-white rounded-xl shadow-lg transition duration-300 hover:shadow-xl hover:ring-2 hover:ring-blue-500 cursor-pointer",onClick:()=>console.log(`Clicked metric card: ${t}`),children:[a.jsx("div",{className:`p-3 rounded-full ${r} ${s} mr-4`,children:a.jsx(e,{size:22})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:t}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:n})]})]}),mGe=({name:e,company:t,assignedBy:n,source:s,date:r})=>{const{text:i,bg:o}=cGe(s);return a.jsx("div",{className:"py-3 border-b border-gray-100 last:border-b-0 cursor-pointer hover:bg-gray-50 px-2 -mx-2 rounded-md",children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-gray-800",children:e}),a.jsx("p",{className:"text-xs text-gray-500",children:t}),n&&a.jsxs("p",{className:"text-xs text-gray-500",children:["Assigned by:"," ",a.jsx("span",{className:"font-semibold text-gray-700",children:n})]})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"text-xs text-gray-400",children:r}),a.jsx("span",{className:`inline-block mt-1 text-xs font-medium ${i} ${o} px-2 py-0.5 rounded-full`,children:s})]})]})})},fGe=({title:e,children:t})=>a.jsxs("div",{className:"bg-white p-5 rounded-xl shadow-md flex flex-col",children:[a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:e}),a.jsx("span",{className:"text-sm text-indigo-500 cursor-pointer hover:underline",children:"See All"})]}),t]}),hGe=({title:e,chartData:t,chartOptions:n})=>{const[s,r]=f.useState("bar"),i=s==="pie"?oGe:t,o=s==="pie"?lGe:n,l=s==="line"?Kqe:s==="pie"?Zqe:Xqe,c=s==="pie"?250:300;return a.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-md flex flex-col hover:shadow-lg transition",children:[a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:e}),a.jsxs("select",{value:s,onChange:u=>r(u.target.value),className:"border border-gray-300 rounded-md px-2 py-1 text-sm",children:[a.jsx("option",{value:"bar",children:"Bar"}),a.jsx("option",{value:"line",children:"Line"}),a.jsx("option",{value:"pie",children:"Pie"})]})]}),a.jsx("div",{className:"w-full flex justify-center",style:{height:c},children:a.jsx(l,{data:i,options:o})})]})};function gGe(){const{user:e}=Vt();return f.useEffect(()=>{document.title="Dashboard | Sari-Sari CRM"},[]),a.jsx("div",{className:"min-h-screen pt-5 pb-10 font-sans",children:a.jsxs("main",{className:"max-w-screen-2xl mx-auto px-4 sm:px-6 lg:px-8",children:[a.jsxs("div",{className:"text-xl font-bold mb-4",children:["Welcome back, ",e?.name||"Marketing","! Heres your marketing overview."]}),a.jsx(dGe,{}),a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-6",children:nGe.map(t=>a.jsx(uGe,{...t},t.title))}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:[a.jsx(hGe,{title:"Leads & Conversions",chartData:rGe,chartOptions:iGe}),a.jsx(fGe,{title:"Latest Leads",children:sGe.map((t,n)=>a.jsx(mGe,{...t},n))})]})]})})}function pGe(){f.useEffect(()=>{document.title="Accounts | Sari-Sari CRM"},[]);const[e,t]=f.useState(null),[n,s]=f.useState(""),[r,i]=f.useState("All Statuses"),o=f.useMemo(()=>[{company:"Acme Corporation",url:"https://acme.com",status:"CUSTOMER",industry:"Technology",territory:"North Region",phone_number:"+1-555-0100",billing_address:"123 Main St, North City",shipping_address:"456 Elm St, North City",created_by:"John Appleseed",created_date:"2024-01-10",last_updated:"2025-09-25 14:30"},{company:"Beta Solutions",url:"https://beta.com",status:"PROSPECT",industry:"Finance",territory:"South Region",phone_number:"+1-555-0200",billing_address:"789 Pine St, South City",shipping_address:"101 Maple St, South City",created_by:"Jane Doe",created_date:"2024-03-05",last_updated:"2025-10-01 10:15"},{company:"Gamma Partners",url:"https://gamma.com",status:"PARTNER",industry:"Retail",territory:"East Region",phone_number:"+1-555-0300",billing_address:"234 Oak St, East City",shipping_address:"345 Birch St, East City",created_by:"Alice Smith",created_date:"2023-12-20",last_updated:"2025-08-15 09:45"},{company:"Delta Corp",url:"https://delta.com",status:"INACTIVE",industry:"Logistics",territory:"West Region",phone_number:"+1-555-0400",billing_address:"987 Cedar St, West City",shipping_address:"654 Pine St, West City",created_by:"Bob Johnson",created_date:"2023-11-15",last_updated:"2025-06-12 11:20"}],[]),l=h=>t(h),c=()=>t(null),u=f.useMemo(()=>[{title:"Total Accounts",value:o.length,color:"text-yellow-600",bgColor:"bg-yellow-50",icon:Za},{title:"Customers",value:o.filter(h=>h.status==="CUSTOMER").length,color:"text-green-600",bgColor:"bg-green-50",icon:Qi},{title:"Prospects",value:o.filter(h=>h.status==="PROSPECT").length,color:"text-purple-600",bgColor:"bg-purple-50",icon:Xa},{title:"Partners",value:o.filter(h=>h.status==="PARTNER").length,color:"text-pink-600",bgColor:"bg-pink-50",icon:ra},{title:"Active",value:o.filter(h=>h.status==="CUSTOMER"||h.status==="PARTNER").length,color:"text-blue-600",bgColor:"bg-blue-50",icon:Qi},{title:"Inactive",value:o.filter(h=>h.status==="INACTIVE").length,color:"text-gray-600",bgColor:"bg-gray-50",icon:Ki},{title:"Former",value:o.filter(h=>h.status==="FORMER").length,color:"text-orange-600",bgColor:"bg-orange-50",icon:Ki}],[o]);if(e)return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter",children:[a.jsxs("div",{className:"mb-6",children:[a.jsxs("button",{onClick:c,className:"inline-flex items-center text-sm sm:text-base text-gray-500 hover:text-gray-700 transition mb-4 sm:mb-6 cursor-pointer",children:[a.jsx(Ku,{className:"mr-1 w-4 h-4 sm:w-5 sm:h-5"})," Back"]}),a.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6",children:a.jsx("div",{children:a.jsxs("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-800 flex items-center gap-2",children:[e.company,a.jsx("span",{className:`inline-block text-xs px-2 py-0.5 rounded ${e.status==="CUSTOMER"?"bg-green-600 text-white":e.status==="PROSPECT"?"bg-purple-600 text-white":e.status==="PARTNER"?"bg-pink-600 text-white":"bg-gray-500 text-white"}`,children:e.status})]})})})]}),a.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 sm:p-6 shadow-sm overflow-x-auto",children:[a.jsx("h2",{className:"text-lg sm:text-xl font-semibold mb-3 sm:mb-4 text-gray-800",children:"Account Details"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 text-sm text-gray-700",children:[a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:"Website:"})," ",a.jsx("br",{}),a.jsx("a",{href:e.url,className:"text-blue-600 hover:underline break-words",children:e.url})]}),a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:"Industry:"})," ",a.jsx("br",{}),e.industry]}),a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:"Territory:"})," ",a.jsx("br",{}),e.territory]}),a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:"Phone Number:"})," ",a.jsx("br",{}),e.phone_number]}),a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:"Billing Address:"})," ",a.jsx("br",{}),e.billing_address]}),a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:"Shipping Address:"})," ",a.jsx("br",{}),e.shipping_address]}),a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:"Created By:"})," ",a.jsx("br",{}),e.created_by," on ",e.created_date]}),a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:"Last Updated:"})," ",a.jsx("br",{}),e.last_updated]})]})]})]});const d=o.filter(h=>{const p=h.company.toLowerCase().includes(n.toLowerCase())||h.url.toLowerCase().includes(n.toLowerCase())||h.industry.toLowerCase().includes(n.toLowerCase())||h.territory.toLowerCase().includes(n.toLowerCase())||h.phone_number.toLowerCase().includes(n.toLowerCase()),x=r==="All Statuses"||r==="Active"&&(h.status==="CUSTOMER"||h.status==="PARTNER")||r==="Inactive"&&h.status==="INACTIVE"||r==="Former"&&h.status==="FORMER"||h.status.toLowerCase()===r.toLowerCase();return p&&x});return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-sans",children:[a.jsx("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:a.jsxs("h1",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(Za,{className:"mr-2 text-blue-600"}),"Accounts List"]})}),a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 xl:grid-cols-4 md:grid-cols-4 gap-4 mb-6",children:u.map(h=>a.jsx(xGe,{...h},h.title))}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search by company, website, industry, territory, or phone...",value:n,onChange:h=>s(h.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsx("div",{className:"w-full lg:w-1/4",children:a.jsxs("select",{value:r,onChange:h=>i(h.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{children:"All Statuses"}),a.jsx("option",{children:"Customer"}),a.jsx("option",{children:"Prospect"}),a.jsx("option",{children:"Partner"}),a.jsx("option",{children:"Active"}),a.jsx("option",{children:"Inactive"}),a.jsx("option",{children:"Former"})]})})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[500px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4",children:"Company"}),a.jsx("th",{className:"py-3 px-4",children:"Status"}),a.jsx("th",{className:"py-3 px-4",children:"Industry"}),a.jsx("th",{className:"py-3 px-4",children:"Territory"}),a.jsx("th",{className:"py-3 px-4",children:"Phone"})]})}),a.jsxs("tbody",{children:[d.map((h,p)=>a.jsxs("tr",{className:"hover:bg-gray-50 text-xs cursor-pointer",onClick:()=>l(h),children:[a.jsx("td",{className:"py-3 px-4 break-words",children:a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-blue-600 hover:underline break-words",children:h.company}),a.jsx("div",{className:"text-gray-500 text-xs break-words",children:h.url})]})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${h.status==="CUSTOMER"?"bg-green-100 text-green-700":h.status==="PROSPECT"?"bg-purple-100 text-purple-700":h.status==="PARTNER"?"bg-pink-100 text-pink-700":h.status==="INACTIVE"?"bg-gray-100 text-gray-700":"bg-orange-100 text-orange-700"}`,children:h.status})}),a.jsx("td",{className:"py-3 px-4 break-words",children:h.industry}),a.jsx("td",{className:"py-3 px-4 break-words",children:h.territory}),a.jsxs("td",{className:"py-3 px-4 flex items-center space-x-2 break-words",children:[a.jsx(It,{className:"text-gray-500"}),a.jsx("span",{children:h.phone_number})]})]},p)),d.length===0&&a.jsx("tr",{children:a.jsx("td",{colSpan:5,className:"py-4 text-center text-gray-500",children:"No accounts match your search/filter."})})]})]})})]})}const xGe=({icon:e,title:t,value:n,color:s,bgColor:r})=>a.jsxs("div",{className:"flex items-center p-4 bg-white rounded-xl shadow-md hover:shadow-lg hover:ring-2 hover:ring-blue-500 cursor-pointer transition-all duration-300",onClick:()=>console.log(`Clicked: ${t}`),children:[a.jsx("div",{className:`flex-shrink-0 p-3 rounded-full ${r} ${s} mr-4`,children:a.jsx(e,{size:22})}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:t}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:n})]})]});function yGe(){f.useEffect(()=>{document.title="Contacts | Sari-Sari CRM"},[]);const[e,t]=f.useState(!1),[n,s]=f.useState(null),[r,i]=f.useState(!1),[o,l]=f.useState(""),[c,u]=f.useState("All Contacts"),[d,h]=f.useState([{id:1,name:"John Smith",title:"Marketing Director",account:"Acme Corporation",email:"john.smith@acme.com",phone1:"+1-555-0101",phone2:"+1-555-0102",department:"Marketing",assigned:"Jane Sales",created:"1/10/2024",mobile:"09217229846",workPhone:"(555) 123-4567",createdBy:"John Appleseed",lastUpdated:"2025-09-21 15:30",notes:"Key marketing partner for Q4 campaigns."}]),[p,x]=f.useState({id:null,name:"",email:"",workPhone:"",title:"",department:"",phone1:"",phone2:"",account:"",assigned:"",notes:""}),v=k=>{k.target.id==="modalBackdrop"&&t(!1)},j=k=>{s(k)},y=()=>{s(null)},N=()=>{i(!1),x({id:null,name:"",email:"",workPhone:"",title:"",department:"",phone1:"",phone2:"",account:"",assigned:"",notes:""}),t(!0)},w=(k,T)=>{T.stopPropagation(),i(!0),x(k),t(!0)},S=k=>{const{name:T,value:A}=k.target;x(E=>({...E,[T]:A}))},_=k=>{if(k.preventDefault(),r)h(T=>T.map(A=>A.id===p.id?{...p}:A));else{const T={...p,id:Date.now(),created:new Date().toLocaleDateString(),createdBy:"Admin User"};h(A=>[...A,T])}t(!1)};return n?a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter",children:[a.jsxs("button",{onClick:y,className:"inline-flex items-center text-sm sm:text-base text-gray-500 hover:text-gray-700 transition mb-4 sm:mb-6 cursor-pointer",children:[a.jsx(Ku,{className:"mr-1 w-4 h-4 sm:w-5 sm:h-5"})," Back"]}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:space-x-3",children:[a.jsx("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-800",children:n.account}),a.jsx("span",{className:"mt-1 sm:mt-0 bg-blue-600 text-white text-xs sm:text-sm px-2 py-0.5 rounded w-fit",children:"Active"})]}),a.jsx("div",{className:"flex flex-col sm:flex-row sm:space-x-3 space-y-2 sm:space-y-0 mt-3 sm:mt-0",children:a.jsxs("button",{className:"w-full sm:w-auto bg-gray-800 text-white px-5 py-2 rounded-md hover:bg-gray-900 transition flex items-center gap-2",children:[a.jsx(Vo,{}),"Export"]})})]}),a.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 sm:p-6 w-full max-w-full lg:max-w-6xl shadow-sm overflow-x-auto mx-auto",children:[a.jsx("h2",{className:"text-lg sm:text-xl font-semibold mb-3 sm:mb-4 text-gray-800",children:"Contact Details"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4 text-sm text-gray-700",children:[a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:"Primary Contact:"})," ",a.jsx("br",{}),n.name]}),a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:"Email:"})," ",a.jsx("br",{}),n.email]}),a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:"Created By:"})," ",a.jsx("br",{}),n.createdBy," on ",n.created]}),a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:"Title:"})," ",a.jsx("br",{}),n.title]}),a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:"Assigned To:"})," ",a.jsx("br",{}),n.assigned]}),a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:"Work Phone:"})," ",a.jsx("br",{}),n.workPhone]}),a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:"Account:"})," ",a.jsx("br",{}),n.account]}),a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:"Mobile Phone:"})," ",a.jsx("br",{}),n.phone1]}),a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:"Last Updated:"})," ",a.jsx("br",{}),n.lastUpdated]})]}),a.jsxs("div",{className:"mt-6 border-gray-200 pt-4",children:[a.jsx("h3",{className:"text-md sm:text-lg font-semibold text-gray-800 mb-2",children:"Notes"}),a.jsx("p",{className:"text-sm text-gray-700 leading-relaxed",children:n.notes?n.notes:"No additional notes were provided for this contact."})]})]})]}):a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h2",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(Za,{className:"mr-2 text-blue-600"})," Contacts Management"]}),a.jsx("button",{onClick:N,className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 rounded-md hover:bg-gray-800 text-sm sm:text-base transition",children:" Add Contact"})]}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search Contacts...",value:o,onChange:k=>l(k.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsx("div",{className:"w-full lg:w-1/4",children:a.jsxs("select",{value:c,onChange:k=>u(k.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{children:"All Contacts"}),a.jsx("option",{children:"Option 1"}),a.jsx("option",{children:"Option 2"}),a.jsx("option",{children:"Option 3"})]})})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-[600px] w-full border border-gray-200 rounded-lg bg-white shadow-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-sm text-gray-600",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4",children:"Contact"}),a.jsx("th",{className:"py-3 px-4",children:"Account"}),a.jsx("th",{className:"py-3 px-4",children:"Contact Info"}),a.jsx("th",{className:"py-3 px-4",children:"Department"}),a.jsx("th",{className:"py-3 px-4",children:"Assigned To"}),a.jsx("th",{className:"py-3 px-4",children:"Created"}),a.jsx("th",{className:"py-3 px-4 text-center",children:"Actions"})]})}),a.jsx("tbody",{className:"text-xs text-gray-700",children:d.map((k,T)=>a.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>j(k),children:[a.jsx("td",{className:"py-3 px-4",children:a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-blue-600 hover:underline break-all",children:k.name}),a.jsx("div",{className:"text-xs text-gray-500",children:k.title})]})}),a.jsx("td",{className:"py-3 px-4",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Vx,{className:"text-gray-500"}),a.jsx("span",{children:k.account})]})}),a.jsx("td",{className:"py-3 px-4",children:a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(rn,{className:"text-gray-500"}),a.jsx("span",{children:k.email})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(It,{className:"text-gray-500"}),a.jsx("span",{children:k.phone1})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(It,{className:"text-gray-500"}),a.jsx("span",{children:k.phone2})]})]})}),a.jsx("td",{className:"py-3 px-4",children:k.department}),a.jsx("td",{className:"py-3 px-4",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(ra,{className:"text-gray-500"}),a.jsx("span",{children:k.assigned})]})}),a.jsx("td",{className:"py-3 px-4",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Ot,{className:"text-gray-500"}),a.jsx("span",{children:k.created})]})}),a.jsx("td",{className:"py-3 px-4 text-center",children:a.jsx("div",{className:"flex justify-center",children:a.jsx("button",{onClick:A=>w(k,A),className:"text-blue-500 hover:text-blue-700",children:a.jsx(gn,{})})})})]},T))})]})}),e&&a.jsx("div",{id:"modalBackdrop",onClick:v,className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-full sm:max-w-3xl rounded-2xl shadow-lg p-4 sm:p-6 md:p-8 relative border border-gray-200 overflow-y-auto max-h-[90vh]",onClick:k=>k.stopPropagation(),children:[a.jsx("button",{onClick:()=>t(!1),className:"absolute top-4 right-4 text-gray-500 hover:text-black transition",children:a.jsx(ea,{size:22})}),a.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800 mb-4 sm:mb-6 text-center",children:r?"Edit Contact":"Add New Contact"}),a.jsxs("form",{onSubmit:_,className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4 text-sm",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Name"}),a.jsx("input",{type:"text",name:"name",value:p.name,onChange:S,placeholder:"Full name",className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Email"}),a.jsx("input",{type:"email",name:"email",value:p.email,onChange:S,placeholder:"example@email.com",className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Work Phone"}),a.jsx("input",{type:"text",name:"workPhone",value:p.workPhone,onChange:S,placeholder:"09 --- --- ---",className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"})]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Title"}),a.jsx("input",{type:"text",name:"title",value:p.title,onChange:S,placeholder:"Job title",className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Department"}),a.jsx("input",{type:"text",name:"department",value:p.department,onChange:S,placeholder:"Marketing / Sales",className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Phone Number 1"}),a.jsx("input",{type:"text",name:"phone1",value:p.phone1,onChange:S,placeholder:"09 --- --- ---",className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"})]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Account"}),a.jsx("input",{type:"text",name:"account",value:p.account,onChange:S,placeholder:"Company name",className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Assign To"}),a.jsxs("select",{name:"assigned",value:p.assigned,onChange:S,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none",children:[a.jsx("option",{value:"",children:"Assign To"}),a.jsx("option",{value:"Smith",children:"Smith"}),a.jsx("option",{value:"Doe",children:"Doe"}),a.jsx("option",{value:"Jane Sales",children:"Jane Sales"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Phone Number 2"}),a.jsx("input",{type:"text",name:"phone2",value:p.phone2,onChange:S,placeholder:"09 --- --- ---",className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"})]})]}),a.jsxs("div",{className:"flex flex-col col-span-1 sm:col-span-2 md:col-span-3",children:[a.jsx("label",{className:"text-gray-700 font-medium mb-1 text-sm",children:"Notes"}),a.jsx("textarea",{name:"notes",value:p.notes,onChange:S,placeholder:"Additional details...",rows:3,className:"border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-400 outline-none resize-none"})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-2 mt-4 col-span-1 sm:col-span-2 md:col-span-3",children:[a.jsx("button",{type:"button",onClick:()=>t(!1),className:"px-4 py-2 text-white bg-red-400 border border-red-300 rounded hover:bg-red-500 transition",children:"Cancel"}),a.jsx("button",{type:"submit",className:"px-4 py-2 text-white bg-blue-600 border border-blue-500 rounded hover:bg-blue-700 transition",children:"Save Contact"})]})]})]})})]})}const Qb={accountName:"Josh Inc.",companyNumber:"09135007323",companyWebsite:"joshenc.com",industry:"Agriculture",billingAddress:"#1 Pilar Las Pinas City",shippingAddress:"#3 BNW ASS-CBN",firstName:"Josh",lastName:"Vergara",department:"Administration",title:"CEO",workPhone:"09253677323",email:"josh@joshinc.com",mobile1:"09253677323",mobile2:"0907452874",dealName:"Josh Deal",dealAmount:"60.00",stage:"Prospecting",territory:"Cavite",description:"Initial lead conversion deal.",dealTitle:"New Client Agreement"},es=({label:e,value:t,name:n,className:s=""})=>a.jsxs("div",{className:`flex flex-col ${s}`,children:[a.jsx("label",{className:"text-xs text-gray-500 mb-1",children:e}),a.jsx("input",{type:"text",name:n,defaultValue:t,readOnly:!0,className:"w-full border border-gray-300 p-2 rounded-lg text-sm focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 outline-none bg-gray-50"})]}),bGe=({data:e})=>a.jsxs("div",{className:"space-y-6 p-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-700",children:"Account Information"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsx(es,{label:"Company Number",name:"companyNumber",value:e.companyNumber}),a.jsx(es,{label:"Company Website",name:"companyWebsite",value:e.companyWebsite}),a.jsx(es,{label:"Industry",name:"industry",value:e.industry})]}),a.jsx(es,{label:"Billing Address",name:"billingAddress",value:e.billingAddress,className:"col-span-3"}),a.jsx(es,{label:"Shipping Address",name:"shippingAddress",value:e.shippingAddress,className:"col-span-3"})]}),vGe=({data:e})=>a.jsxs("div",{className:"space-y-6 p-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-700",children:"Contact Information"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx(es,{label:"First Name",name:"firstName",value:e.firstName}),a.jsx(es,{label:"Last Name",name:"lastName",value:e.lastName}),a.jsx(es,{label:"Department",name:"department",value:e.department}),a.jsx(es,{label:"Title",name:"title",value:e.title}),a.jsx(es,{label:"Work Phone",name:"workPhone",value:e.workPhone}),a.jsx(es,{label:"Email",name:"email",value:e.email}),a.jsx(es,{label:"Mobile Number 1",name:"mobile1",value:e.mobile1}),a.jsx(es,{label:"Mobile Number 2",name:"mobile2",value:e.mobile2})]})]}),wGe=({data:e})=>a.jsxs("div",{className:"space-y-6 p-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-700",children:"Deal"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx(es,{label:"Deal Name",name:"dealName",value:e.dealName}),a.jsxs("div",{className:"flex",children:[a.jsx(es,{label:"Deal Amount",name:"dealAmount",value:e.dealAmount,className:"flex-grow"}),a.jsx("div",{className:"flex flex-col justify-end ml-1",children:a.jsx("span",{className:"text-sm font-medium text-gray-600 border border-gray-300 bg-gray-100 p-2 rounded-r-lg h-10 flex items-center",children:"PHP"})})]}),a.jsx(es,{label:"Stage",name:"stage",value:e.stage}),a.jsx(es,{label:"Territory",name:"territory",value:e.territory})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx(es,{label:"Description",name:"description",value:e.description}),a.jsx(es,{label:"Title",name:"dealTitle",value:e.dealTitle})]})]});function yee({isOpen:e,onClose:t}){const[n,s]=f.useState(1),r=3;if(!e)return null;const i=()=>{n<r?s(n+1):(t(),s(1))},o=()=>{n>1&&s(n-1)},l=[{id:1,name:"Account"},{id:2,name:"Contact"},{id:3,name:"Deal"}],c=()=>{switch(n){case 1:return a.jsx(bGe,{data:Qb});case 2:return a.jsx(vGe,{data:Qb});case 3:return a.jsx(wGe,{data:Qb});default:return null}};return a.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-[800px] h-[600px] overflow-hidden flex flex-col",children:[a.jsxs("div",{className:"p-6 border-b border-gray-200 flex justify-between items-start",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wider",children:"Convert Lead"}),a.jsx("h1",{className:"text-2xl font-bold text-gray-900 mt-1",children:Qb.accountName})]}),a.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition",children:a.jsx(PN,{className:"w-6 h-6"})})]}),a.jsx("div",{className:"flex border-b border-gray-200 bg-gray-50",children:l.map(u=>a.jsx("button",{onClick:()=>s(u.id),className:`flex-1 py-3 px-6 text-sm font-medium transition ${n===u.id?"bg-white text-gray-800 border-b-2 border-indigo-600":"bg-gray-600 text-white hover:bg-gray-700"}`,children:u.name},u.id))}),a.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:c()}),a.jsxs("div",{className:"p-4 border-t border-gray-200 bg-gray-50 flex justify-end space-x-3",children:[n>1&&a.jsx("button",{onClick:o,className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-100 flex items-center",children:"Cancel"}),n<r?a.jsx("button",{onClick:i,className:"px-5 py-2 text-white bg-gray-900 rounded-xl hover:bg-gray-800 transition",children:"Next"}):a.jsx("button",{onClick:i,className:"px-5 py-2 text-white bg-gray-900 rounded-xl hover:bg-gray-800 transition",children:"Convert"})]})]})})}const jGe={name:"Josh Vergara",status:"New",company:"Josh Inc.",title:"CEO",department:"Administration",email:"josh@joshinc.com",territory:"Cavite",assignedTo:"Admin",createdBy:"Admin",workPhone:"09253677323",phone1:"09253677323",phone2:"0907452874",source:"Website",addressLine1:"#1 Pilar Las Pinas",addressLine2:"Suite 400",city:"Las Pinas",state:"Metro Manila",zipCode:"1740",notes:"Interested in our premium plan."};function bee({lead:e=jGe,onBack:t}){const[n,s]=f.useState(!1);return e?a.jsxs("div",{className:"p-4 sm:p-6 md:p-8 font-inter min-h-screen",children:[a.jsxs("button",{onClick:t,className:"inline-flex items-center text-sm sm:text-base text-gray-500 hover:text-gray-700 transition mb-4 sm:mb-6 cursor-pointer",children:[a.jsx(Ku,{className:"mr-1 w-4 h-4 sm:w-5 sm:h-5"})," Back"]}),a.jsx("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between mb-6 sm:mb-8 gap-2 sm:gap-4",children:a.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[a.jsx("h1",{className:"text-xl sm:text-2xl font-semibold",children:e.name}),a.jsx("span",{className:"bg-blue-100 text-blue-700 text-xs sm:text-sm font-medium px-2 sm:px-3 py-1 rounded-full",children:e.status}),a.jsx("div",{className:"flex flex-wrap items-center ml-0 sm:ml-1",children:a.jsx("button",{onClick:()=>s(!0),className:"bg-green-600 hover:bg-green-700 text-white px-3 sm:px-5 py-1.5 sm:py-2 rounded-lg font-medium text-xs sm:text-sm",children:"Convert"})})]})}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 md:p-8 border border-gray-200 mb-6 sm:mb-8",children:[a.jsx("h2",{className:"text-lg sm:text-xl font-semibold mb-4 sm:mb-6",children:"Lead Details"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 sm:gap-6 text-sm text-gray-700",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Name:"}),a.jsx("p",{children:e.name})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Company:"}),a.jsx("p",{children:e.company})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Title:"}),a.jsx("p",{children:e.title})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Department:"}),a.jsx("p",{children:e.department})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Email:"}),a.jsx("p",{children:e.email})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Territory:"}),a.jsx("p",{children:e.territory})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Assign To:"}),a.jsx("p",{children:e.assignedTo})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created By:"}),a.jsx("p",{children:e.createdBy})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Work Phone:"}),a.jsx("p",{children:e.workPhone})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Mobile Phone 1:"}),a.jsx("p",{children:e.phone1})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Mobile Phone 2:"}),a.jsx("p",{children:e.phone2})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Source:"}),a.jsx("p",{children:e.source})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6 mb-6 sm:mb-8",children:[a.jsxs("div",{className:"bg-white p-4 sm:p-6 rounded-xl border border-gray-200",children:[a.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Address:"}),a.jsxs("p",{className:"text-sm text-gray-700 leading-relaxed",children:[e.addressLine1," ",a.jsx("br",{}),e.addressLine2," ",a.jsx("br",{}),e.city,", ",e.state," ",e.zipCode]})]}),a.jsxs("div",{className:"bg-white p-4 sm:p-6 rounded-xl border border-gray-200",children:[a.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Notes:"}),a.jsx("p",{className:"text-sm text-gray-700 leading-relaxed",children:e.notes||"No notes available."})]})]}),a.jsxs("div",{className:"bg-white p-4 sm:p-6 rounded-xl border border-gray-200",children:[a.jsx("h3",{className:"font-semibold text-gray-800 mb-4 sm:mb-6",children:"Related Activities"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 sm:gap-8 text-sm",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold mb-2",children:"Tasks (2)"}),a.jsxs("div",{className:"space-y-1 text-gray-700",children:[a.jsx("p",{children:"Schedule follow-up call"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Due: 2025-09-15 | In Progress"}),a.jsx("p",{children:"Schedule follow-up call"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Due: 2025-09-18 | In Progress"})]}),a.jsx("a",{href:"#",className:"text-blue-600 hover:underline text-xs font-medium mt-2 inline-block",children:"View All Tasks"})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold mb-2",children:"Calls (2)"}),a.jsxs("div",{className:"space-y-1 text-gray-700",children:[a.jsx("p",{children:"Initial discovery call"}),a.jsx("p",{className:"text-xs text-gray-500",children:"2025-09-10 | Completed"}),a.jsx("p",{children:"Initial discovery call"}),a.jsx("p",{className:"text-xs text-gray-500",children:"2025-09-11 | Completed"})]}),a.jsx("a",{href:"#",className:"text-blue-600 hover:underline text-xs font-medium mt-2 inline-block",children:"View All Calls"})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold mb-2",children:"Meeting (0)"}),a.jsx("p",{className:"text-gray-500",children:"No meetings associated."}),a.jsx("a",{href:"#",className:"text-blue-600 hover:underline text-xs font-medium mt-2 inline-block",children:"View All Meetings"})]})]})]}),a.jsx(yee,{isOpen:n,onClose:()=>s(!1)})]}):null}const NGe=nh.all(),ST=NGe.map(e=>({code:`+${e.countryCallingCode}`,name:e.countryCode}));function CGe(){const[e,t]=f.useState(null),[n,s]=f.useState(!1),[r,i]=f.useState(null),[o,l]=f.useState([{id:1,first_name:"Jane",last_name:"Doe"},{id:2,first_name:"John",last_name:"Smith"},{id:3,first_name:"Mary",last_name:"Johnson"}]),[c,u]=f.useState([{id:1,name:"Joshua Vergara",status:"Qualified",title:"Marketing Director",email:"sarah.williams@innovateco.com",phone1:"9271229484",phone2:"---------",workPhone:"999123-4567",work_ccode:"+63",m1_ccode:"+63",m2_ccode:"+63",territory:"East Coast",department:"Marketing",company:"Innovate Co.",createdBy:"John Appleseed",createdAt:"2025-09-10 09:30",lastUpdated:"2025-09-12 14:45",source:"Website",assignedTo:"Jane Doe",address:"123 Main St, City, Country",notes:"Important client"}]),[d,h]=f.useState({work_ccode:"+63",work_phone:"",m1_ccode:"+63",mobile_phone_1:"",m2_ccode:"+63",mobile_phone_2:""});f.useEffect(()=>{document.title="Leads | Sari-Sari CRM"},[]);const p=A=>t(A),x=()=>t(null),[v,j]=f.useState(""),[y,N]=f.useState("All Accounts"),w=()=>{s(!1),i(null),h({work_ccode:"+63",work_phone:"",m1_ccode:"+63",mobile_phone_1:"",m2_ccode:"+63",mobile_phone_2:""})},S=A=>{i(A),s(!0),h({work_ccode:A.work_ccode||"+63",work_phone:A.workPhone||"",m1_ccode:A.m1_ccode||"+63",mobile_phone_1:A.phone1||"",m2_ccode:A.m2_ccode||"+63",mobile_phone_2:A.phone2||""})},_=A=>{window.confirm("Are you sure you want to delete this lead?")&&u(c.filter(E=>E.id!==A))},k=A=>{const{name:E,value:M}=A.target;h(z=>({...z,[E]:M}))},T=A=>{A.preventDefault();const E=new FormData(A.target),M=Object.fromEntries(E.entries());M.name=`${M.firstName} ${M.lastName}`,M.assignedTo=o.find(z=>z.id.toString()===M.assignedTo)?.first_name+" "+o.find(z=>z.id.toString()===M.assignedTo)?.last_name,M.work_ccode=d.work_ccode,M.workPhone=d.work_phone,M.m1_ccode=d.m1_ccode,M.phone1=d.mobile_phone_1,M.m2_ccode=d.m2_ccode,M.phone2=d.mobile_phone_2,u(r?c.map(z=>z.id===r.id?{...z,...M}:z):[...c,{...M,id:c.length+1,createdAt:new Date().toISOString(),lastUpdated:new Date().toISOString()}]),w()};return e?a.jsx(bee,{lead:e,onBack:x}):a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between mb-6 gap-3",children:[a.jsxs("h2",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(Xa,{className:"mr-2 text-blue-600"})," Leads"]}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 w-full sm:w-auto",children:[a.jsxs("button",{className:"flex items-center justify-center border border-tertiary text-tertiary px-4 py-2 gap-2 rounded-md hover:bg-gray-800 hover:text-white transition w-full sm:w-auto",children:[a.jsx(Vo,{})," Download"]}),a.jsx("button",{onClick:()=>s(!0),className:"flex items-center justify-center bg-black text-white px-4 py-2 rounded-md hover:bg-gray-800 transition w-full sm:w-auto",children:" Add Leads"})]})]}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search Leads...",value:v,onChange:A=>j(A.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsx("div",{className:"w-full lg:w-1/4",children:a.jsxs("select",{value:y,onChange:A=>N(A.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{children:"All Leads"}),a.jsx("option",{children:"New"}),a.jsx("option",{children:"Contacted"}),a.jsx("option",{children:"Qualified"}),a.jsx("option",{children:"Converted"}),a.jsx("option",{children:"Lost"})]})})]}),a.jsxs("div",{className:"bg-white shadow-sm overflow-x-auto rounded-md border border-gray-200",children:[a.jsxs("div",{className:"grid grid-cols-9 min-w-[800px] bg-gray-100 font-bold text-gray-600 text-sm px-4 py-3",children:[a.jsx("div",{children:"Name"}),a.jsx("div",{children:"Account"}),a.jsx("div",{children:"Title"}),a.jsx("div",{children:"Department"}),a.jsx("div",{children:"Email"}),a.jsx("div",{children:"Work Phone"}),a.jsx("div",{children:"Assigned To"}),a.jsx("div",{children:"Updated"}),a.jsx("div",{className:"text-center",children:"Actions"})]}),c.map(A=>a.jsxs("div",{className:"grid grid-cols-9 min-w-[800px] px-4 py-3 text-xs hover:bg-gray-100 transition cursor-pointer gap-x-4",onClick:()=>p(A),children:[a.jsx("div",{className:"truncate",children:A.name}),a.jsx("div",{className:"truncate",children:A.company}),a.jsx("div",{className:"truncate",children:A.title}),a.jsx("div",{className:"truncate",children:A.department}),a.jsx("div",{className:"truncate",children:A.email}),a.jsxs("div",{className:"truncate",children:[A.work_ccode," ",A.workPhone]}),a.jsx("div",{className:"truncate",children:A.assignedTo}),a.jsx("div",{className:"truncate",children:A.lastUpdated}),a.jsxs("div",{className:"flex justify-center space-x-2",children:[a.jsx("button",{className:"text-blue-500 hover:text-blue-700",onClick:E=>{E.stopPropagation(),S(A)},children:a.jsx(gn,{})}),a.jsx("button",{className:"text-red-500 hover:text-red-700",onClick:E=>{E.stopPropagation(),_(A.id)},children:a.jsx(wa,{})})]})]},A.id))]}),n&&a.jsx("div",{id:"modalBackdrop",onClick:w,className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-3xl rounded-xl shadow-lg p-5 sm:p-6 relative border border-gray-200 my-6 max-h-[90vh] overflow-y-auto",onClick:A=>A.stopPropagation(),children:[a.jsx("button",{onClick:w,className:"absolute top-3 right-3 text-gray-400 hover:text-black transition",children:a.jsx(ea,{size:20})}),a.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-gray-800 mb-4 text-center",children:r?"Edit Lead":"Add New Lead"}),a.jsxs("form",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 text-xs sm:text-sm",onSubmit:T,children:[a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"text-gray-700 font-medium mb-1",children:"First Name"}),a.jsx("input",{name:"firstName",type:"text",placeholder:"Joe",defaultValue:r?r.name.split(" ")[0]:"",className:"border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-400 outline-none",required:!0})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"text-gray-700 font-medium mb-1",children:"Last Name"}),a.jsx("input",{name:"lastName",type:"text",placeholder:"Smith",defaultValue:r?r.name.split(" ")[1]:"",className:"border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-400 outline-none",required:!0})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"text-gray-700 font-medium mb-1",children:"Company"}),a.jsx("input",{name:"company",type:"text",placeholder:"ABC Company",defaultValue:r?.company||"",className:"border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-400 outline-none"})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"text-gray-700 font-medium mb-1",children:"Title"}),a.jsx("input",{name:"title",type:"text",placeholder:"ABC Agenda",defaultValue:r?.title||"",className:"border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-400 outline-none"})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"text-gray-700 font-medium mb-1",children:"Department"}),a.jsx("input",{name:"department",type:"text",placeholder:"Sales",defaultValue:r?.department||"",className:"border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-400 outline-none"})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"text-gray-700 font-medium mb-1",children:"Email"}),a.jsx("input",{name:"email",type:"text",placeholder:"abc@gmail.com",defaultValue:r?.email||"",className:"border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-400 outline-none"})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"text-gray-700 font-medium mb-1",children:"Work Phone"}),a.jsxs("div",{className:"border border-gray-300 rounded-md flex flex-row w-full gap-1",children:[a.jsx("select",{name:"work_ccode",value:d.work_ccode,onChange:k,className:"outline-none cursor-pointer py-2 border-r border-gray-400 w-15",children:ST.map(A=>a.jsx("option",{value:A.code,children:A.code},A.code))}),a.jsx("input",{type:"text",name:"work_phone",placeholder:"9----------",value:d.work_phone,onChange:k,className:"w-full outline-none"})]})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"text-gray-700 font-medium mb-1",children:"Mobile Phone 1"}),a.jsxs("div",{className:"border border-gray-300 rounded-md flex flex-row w-full gap-1",children:[a.jsx("select",{name:"m1_ccode",value:d.m1_ccode,onChange:k,className:"outline-none cursor-pointer py-2 border-r border-gray-400 w-15",children:ST.map(A=>a.jsx("option",{value:A.code,children:A.code},A.code))}),a.jsx("input",{type:"text",name:"mobile_phone_1",placeholder:"9----------",value:d.mobile_phone_1,onChange:k,className:"w-full outline-none"})]})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"text-gray-700 font-medium mb-1",children:"Mobile Phone 2"}),a.jsxs("div",{className:"border border-gray-300 rounded-md flex flex-row w-full gap-1",children:[a.jsx("select",{name:"m2_ccode",value:d.m2_ccode,onChange:k,className:"outline-none cursor-pointer py-2 border-r border-gray-400 w-15",children:ST.map(A=>a.jsx("option",{value:A.code,children:A.code},A.code))}),a.jsx("input",{type:"text",name:"mobile_phone_2",placeholder:"9----------",value:d.mobile_phone_2,onChange:k,className:"w-full outline-none"})]})]}),a.jsxs("div",{className:"flex flex-col col-span-1 sm:col-span-2 lg:col-span-3",children:[a.jsx("label",{className:"text-gray-700 font-medium mb-1",children:"Address"}),a.jsx("input",{name:"address",type:"text",placeholder:"Street No., Street Name, City, State/Province, Postal Code",defaultValue:r?.address||"",className:"border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-400 outline-none"})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"text-gray-700 font-medium mb-1",children:"Assign To"}),a.jsxs("select",{name:"assignedTo",defaultValue:o.find(A=>`${A.first_name} ${A.last_name}`===r?.assignedTo)?.id||"",className:"border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-400 outline-none",children:[a.jsx("option",{value:"",disabled:!0,children:"Select user"}),o.map(A=>a.jsxs("option",{value:A.id,children:[A.first_name," ",A.last_name]},A.id))]})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"text-gray-700 font-medium mb-1",children:"Territory"}),a.jsx("input",{type:"text",disabled:!0,name:"territory_id",placeholder:"Assign a user",className:"border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-400 outline-none"})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"text-gray-700 font-medium mb-1",children:"Source"}),a.jsxs("select",{className:"border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-400 outline-none",defaultValue:r?.source||"",name:"source",children:[a.jsx("option",{value:"",disabled:!0,children:"Select Source"}),a.jsx("option",{value:"Website",children:"Website"}),a.jsx("option",{value:"Referral",children:"Referral"}),a.jsx("option",{value:"Cold call",children:"Cold call"}),a.jsx("option",{value:"Event",children:"Event"}),a.jsx("option",{value:"Other",children:"Other"})]})]}),a.jsxs("div",{className:"flex flex-col col-span-1 sm:col-span-2 lg:col-span-3",children:[a.jsx("label",{className:"text-gray-700 font-medium mb-1",children:"Notes"}),a.jsx("textarea",{name:"notes",placeholder:"Additional details...",rows:3,defaultValue:r?.notes||"",className:"border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-400 outline-none resize-none"})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-2 mt-2 col-span-1 sm:col-span-2 lg:col-span-3",children:[a.jsx("button",{type:"button",onClick:w,className:"px-4 py-2 text-white bg-red-400 border border-red-300 rounded hover:bg-red-500 transition",children:"Cancel"}),a.jsx("button",{type:"submit",className:"px-4 py-2 text-white border border-tertiary bg-tertiary rounded hover:bg-secondary transition",children:r?"Update Lead":"Save Lead"})]})]})]})})]})}const XB=["To Do","In Progress","Review","Completed"],Rg=10,SGe=e=>{if(!e)return"";const t=new Date(e);if(Number.isNaN(t.getTime()))return"";const n=t.getTimezoneOffset();return new Date(t.getTime()-n*60*1e3).toISOString().slice(0,16)},ZB=e=>{if(!e)return"";const t=new Date(e);return Number.isNaN(t.getTime())?"":t.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},_Ge=e=>{const t=e.subject?.trim()??"",n=e.description?.trim()??"",s=e.notes?.trim()??"";e.priority&&String(e.priority).toUpperCase(),e.status&&String(e.status).toUpperCase();let r=null,i=null,o=null,l=null;e.relatedType1==="Lead"&&e.relatedTo1?r=Number(e.relatedTo1):e.relatedType1==="Account"&&e.relatedTo1&&(i=Number(e.relatedTo1)),e.relatedType1==="Account"&&(e.relatedType2==="Contact"&&e.relatedTo2?o=Number(e.relatedTo2):e.relatedType2==="Deal"&&e.relatedTo2&&(l=Number(e.relatedTo2)));const c=e.assignedTo?Number(e.assignedTo):null,u=o||l||i||r,d=o?"Contact":l?"Deal":i?"Account":r?"Lead":null;return{title:t,description:n,priority:e.priority||"Normal",status:e.status||"Not started",due_date:e.dueDate?e.dueDate:null,assigned_to:c,notes:s,is_personal:!1,lead_id:r,account_id:i,contact_id:o,deal_id:l,related_to_1:e.relatedTo1?Number(e.relatedTo1):null,related_type_1:e.relatedType1,related_to_2:e.relatedTo2?Number(e.relatedTo2):null,related_type_2:e.relatedType2,related_to:u,related_type:d}},AGe=e=>{const t=e.task_assign_to?`${e.task_assign_to.first_name} ${e.task_assign_to.last_name}`:e.assigned_to?String(e.assigned_to):"Unassigned",n=e.task_creator?`${e.task_creator.first_name} ${e.task_creator.last_name}`:e.created_by?String(e.created_by):"System",s=e.due_date||e.dueDate||null,r=e.date_assigned||e.created_at||null,i=e.contact?`${e.contact.first_name} ${e.contact.last_name}`:e.assigned_to?String(e.assigned_to.id):"Unassigned",o=()=>e.lead?.id||e.lead_id,l=()=>e.account?.id||e.account_id,c=()=>e.contact?.id||e.contact_id,u=()=>e.deal?.id||e.deal_id,d=()=>e.task_assign_to?.id||e.assigned_to,h=()=>e.lead?.title||e.lead_id,p=()=>e.account?.name||e.account_id,x=()=>i||e.contact_id,v=()=>e.deal?.name||e.deal_id;let j="Lead",y="",N="",w="",S="Lead",_="",k="",T="";const A=l(),E=p(),M=o(),z=h();if(A){j="Account",S="Account",_=E,y=String(A);const P=c(),D=u(),U=x(),B=v();P?(N="Contact",k="Contact",T=U,w=String(P)):D&&(k="Deal",N="Deal",T=B,w=String(D))}else M?(S="Lead",_=z,j="Lead",y=String(M)):e.related_type==="Account"&&(j="Account",y=String(e.related_to));return{id:e.id,title:e.title,description:e.description,priority:e.priority||"Normal",status:e.status||"Not started",dueDate:s,dateAssigned:r,assignedToId:d()||null,assignedToName:t,createdAt:e.created_at||null,createdById:e.created_by??null,createdBy:n,notes:e.notes||"",isPersonal:!!e.is_personal,relatedType1Text:S,relatedTo1Text:_,relatedType2Text:k,relatedTo2Text:T,subject:e.title,relatedType1:j,relatedTo1:y,relatedType2:N,relatedTo2:w}};function TGe(){f.useEffect(()=>{document.title="Tasks | Sari-Sari CRM"},[]);const{user:e,loading:t}=Vt(),[n,s]=f.useState("board"),[r,i]=f.useState(!1),[o,l]=f.useState(null),[c,u]=f.useState(!1),[d,h]=f.useState([]),[p,x]=f.useState(!0),[v,j]=f.useState(""),[y,N]=f.useState("Filter by Status"),[w,S]=f.useState("Filter by Priority"),[_,k]=f.useState([]),[T,A]=f.useState(1),[E,M]=f.useState(null),[z,P]=f.useState(!1),D=kt(),U=ta(),[B,R]=f.useState({id:"",subject:"",description:"",priority:"",status:"",dueDate:"",assignedTo:"",notes:"",relatedType1:"Lead",relatedType2:"Contact",relatedTo1:"",relatedTo2:""});f.useEffect(()=>{const me=U.state?.openTaskModal,Ue=U.state?.initialTaskData;me&&(i(!0),Ue&&R(Ee=>({...Ee,...Ue})),D(U.pathname,{replace:!0,state:{}}))},[U,D]);const q=async()=>{try{const me=await re.get("/users/all");k(Array.isArray(me.data)?me.data:[])}catch(me){console.error("Failed to fetch users:",me),H.error("Failed to fetch users.")}},Z=async()=>{try{x(!0);const me=await re.get("/tasks/all"),Ee=(Array.isArray(me.data)?me.data:[]).map(AGe);Ee.sort((We,tt)=>{const lt=We.createdAt?new Date(We.createdAt):0;return(tt.createdAt?new Date(tt.createdAt):0)-lt}),console.log("Fetched Tasks:",Ee),h(Ee),n==="list"&&A(1)}catch(me){console.error("Failed to load tasks:",me),H.error("Failed to load tasks.")}finally{x(!1)}};f.useEffect(()=>{!t&&e&&(q(),Z())},[t,e]);const V=()=>{l(null),R({id:"",subject:"",description:"",priority:"Normal",status:"Not started",dueDate:"",assignedTo:"",notes:"",relatedType1:"Lead",relatedType2:"Contact",relatedTo1:"",relatedTo2:""})},oe=(me=null,Ue=!1)=>{l(me),u(Ue),me?R({id:me.id,subject:me.title||"",description:me.description||"",priority:me.priority||"Normal",status:me.status||"Not started",dueDate:SGe(me.dueDate),assignedTo:me.assignedToId?String(me.assignedToId):"",notes:me.notes||"",relatedType1Text:me.relatedType1Text||"",relatedTo1Text:me.relatedTo1Text||"",relatedType2Text:me.relatedType2Text||"",relatedTo2Text:me.relatedTo2Text||"",relatedType1:me.relatedType1||"",relatedTo1:me.relatedTo1||"",relatedType2:me.relatedType2||"",relatedTo2:me.relatedTo2||""}):V(),i(!0)},je=()=>{i(!1),l(null),u(!1),V()},X=async me=>{const Ue=_Ge(me);try{o&&!c?(await re.put(`/tasks/${o.id}`,Ue),H.success("Task updated successfully.")):(await re.post("/tasks/create",Ue),H.success("Task created successfully.")),i(!1),await Z()}catch(Ee){console.error("Failed to save task:",Ee);const We=Ee.response?.data?.detail||"Failed to save task.";H.error(We)}},se=me=>{me&&M({title:"Delete Task",message:a.jsxs(a.Fragment,{children:["Are you sure you want to delete ",a.jsx("span",{className:"font-semibold",children:me.title}),"?"]}),confirmLabel:"Delete Task",cancelLabel:"Cancel",variant:"danger",action:{type:"delete",targetId:me.id}})},ye=async()=>{if(!E?.action){M(null);return}const{action:me}=E;P(!0);try{me.type==="delete"&&(await re.delete(`/tasks/${me.targetId}`),H.success("Task deleted successfully."),await Z())}catch(Ue){console.error("Task action failed:",Ue),H.error("Failed to delete task.")}finally{P(!1),M(null)}},Ne=()=>{z||M(null)},fe=f.useMemo(()=>{const me=v.trim().toLowerCase();return[...d].sort((Ee,We)=>{const tt=Ee.createdAt?new Date(Ee.createdAt):0;return(We.createdAt?new Date(We.createdAt):0)-tt}).filter(Ee=>{const We=me===""||Ee.title?.toLowerCase().includes(me)||Ee.description?.toLowerCase().includes(me)||Ee.assignedToName?.toLowerCase().includes(me)||Ee.createdBy?.toLowerCase().includes(me),tt=y==="Filter by Status"||Ee.status===y,lt=w==="Filter by Priority"||Ee.priority===w;return We&&tt&&lt})},[d,v,y,w]);f.useEffect(()=>{A(1)},[v,y,w,n]),f.useEffect(()=>{if(n==="list"){const me=fe.length===0?1:Math.ceil(fe.length/Rg);T>me&&A(me)}},[fe.length,T,n]);const we=f.useMemo(()=>{if(n==="board")return fe;const me=(T-1)*Rg;return fe.slice(me,me+Rg)},[fe,T,n]),de=f.useMemo(()=>{const me=new Date;return[{title:"To Do",value:d.filter(Ue=>Ue.status==="Not started").length,icon:zs,color:"text-blue-600",bgColor:"bg-blue-100"},{title:"In Progress",value:d.filter(Ue=>Ue.status==="In progress").length,icon:Yi,color:"text-purple-600",bgColor:"bg-purple-100"},{title:"Completed",value:d.filter(Ue=>Ue.status==="Completed").length,icon:Qa,color:"text-green-600",bgColor:"bg-green-100"},{title:"Overdue",value:d.filter(Ue=>Ue.dueDate&&new Date(Ue.dueDate)<me&&Ue.status!=="Completed").length,icon:Fl,color:"text-red-600",bgColor:"bg-red-100"},{title:"High Priority",value:d.filter(Ue=>Ue.priority==="High").length,icon:ec,color:"text-orange-600",bgColor:"bg-orange-100"}]},[d]),ke=me=>me.dueDate&&new Date(me.dueDate)<new Date&&me.status!=="Completed",ge=me=>{switch(me.status){case"To Do":return"bg-blue-50 hover:bg-blue-100 border-blue-200";case"In Progress":return"bg-purple-50 hover:bg-purple-100 border-purple-200";case"Review":return"bg-orange-50 hover:bg-orange-100 border-orange-200";case"Completed":return"bg-green-50 hover:bg-green-100 border-green-200";default:return"bg-gray-50 hover:bg-gray-100 border-gray-100"}},$e=me=>{switch(me){case"To Do":return"bg-blue-100 text-blue-700";case"In Progress":return"bg-purple-100 text-purple-700";case"Review":return"bg-orange-100 text-orange-700";case"Completed":return"bg-green-100 text-green-700";default:return"bg-gray-100 text-gray-700"}},be=me=>{switch(me){case"High":return"bg-red-100 text-red-700";case"Normal":return"bg-yellow-100 text-yellow-700";default:return"bg-gray-100 text-gray-700"}};return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 min-h-screen font-inter relative",children:[(p||t)&&a.jsx(Wt,{message:"Loading tasks..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 space-y-2 sm:space-y-0",children:[a.jsxs("h1",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[a.jsx(Yi,{className:"text-blue-600"})," Tasks Board"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{type:"button",onClick:()=>oe(),className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 rounded-md hover:bg-gray-800 text-sm sm:text-base self-end sm:self-auto mt-2 lg:mt-0 cursor-pointer",children:[a.jsx(aa,{})," Create Task"]})})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 xl:grid-cols-5 gap-4 mb-6 w-full break-words overflow-hidden lg:overflow-visible",children:de.map(me=>a.jsx(kGe,{...me},me.title))}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mt-6 mb-4 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search tasks",value:v,onChange:me=>j(me.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row w-full lg:w-1/2 gap-2",children:[a.jsxs("select",{value:y,onChange:me=>N(me.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{children:"Filter by Status"}),XB.map(me=>a.jsx("option",{children:me},me))]}),a.jsxs("select",{value:w,onChange:me=>S(me.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{children:"Filter by Priority"}),a.jsx("option",{children:"High"}),a.jsx("option",{children:"Normal"}),a.jsx("option",{children:"Low"})]})]})]}),a.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[a.jsx("button",{type:"button",onClick:()=>s("board"),className:`px-4 py-2 rounded-full text-sm ${n==="board"?"bg-gray-800 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Board View"}),a.jsx("button",{type:"button",onClick:()=>s("list"),className:`px-4 py-2 rounded-full text-sm ${n==="list"?"bg-gray-800 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"List View"})]}),!p&&!t&&fe.length===0&&a.jsx("p",{className:"text-center text-gray-500 mt-10 p-4 bg-white shadow rounded-lg",children:"No tasks found matching current filters."}),!p&&!t&&fe.length>0&&n==="board"&&a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4 rounded-md",children:XB.map(me=>{const Ue=we.filter(Ee=>Ee.status===me);return a.jsxs("div",{className:"bg-white p-4 shadow border border-gray-200 flex flex-col relative",children:[a.jsx("div",{className:"absolute top-0 left-0 w-full h-5 bg-secondary rounded-t-md"}),a.jsxs("div",{className:"flex items-center justify-between mb-3 pt-7",children:[a.jsx("h3",{className:"font-medium text-gray-900",children:me}),a.jsx("span",{className:"text-xs bg-gray-100 px-2 py-1 rounded-full text-gray-500",children:Ue.length})]}),a.jsx("div",{className:`space-y-3 ${Ue.length>3?"overflow-y-auto max-h-[480px] hide-scrollbar":""}`,children:Ue.length>0?Ue.map(Ee=>a.jsxs("div",{className:`border rounded-lg p-3 transition flex justify-between items-start cursor-pointer ${ge(Ee)}`,onClick:()=>oe(Ee,!0),children:[a.jsxs("div",{className:"text-left flex-1",children:[a.jsx("p",{className:"font-medium text-gray-800 text-sm",children:Ee.title}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Priority: ",Ee.priority]}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Assigned To: ",Ee.assignedToName]}),a.jsxs("p",{className:"text-xs mt-1 text-gray-500",children:["Date: ",a.jsx("span",{className:ke(Ee)?"text-red-600":"text-gray-600",children:Ee.dateAssigned?ZB(Ee.dateAssigned):""})]})]}),a.jsxs("div",{className:"flex items-center gap-2 ml-3",children:[a.jsx("button",{type:"button",onClick:We=>{We.stopPropagation(),oe(Ee)},className:"text-blue-500 hover:text-blue-700",children:a.jsx(hn,{})}),a.jsx("button",{type:"button",onClick:We=>{We.stopPropagation(),se(Ee)},className:"text-red-500 hover:text-red-700",children:a.jsx(wa,{})})]})]},Ee.id)):a.jsx("p",{className:"text-sm text-gray-400 text-center py-4",children:"No tasks"})})]},me)})}),!p&&!t&&fe.length>0&&n==="list"&&a.jsx("div",{className:"bg-white rounded-md shadow-sm overflow-hidden",children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-gray-600 text-left",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 font-medium",children:"Task"}),a.jsx("th",{className:"py-3 px-4 font-medium",children:"Status"}),a.jsx("th",{className:"py-3 px-4 font-medium",children:"Priority"}),a.jsx("th",{className:"py-3 px-4 font-medium",children:"Assigned To"}),a.jsx("th",{className:"py-3 px-4 font-medium",children:"Date Assigned"}),a.jsx("th",{className:"py-3 px-4 font-medium",children:"Actions"})]})}),a.jsx("tbody",{children:we.map(me=>a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors text-sm cursor-pointer",onClick:()=>{console.log("Opening task in view mode:",me),oe(me,!0)},children:[a.jsx("td",{className:"py-3 px-4 text-gray-700 whitespace-nowrap font-medium",children:me.title}),a.jsx("td",{className:"py-3 px-4 whitespace-nowrap",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium whitespace-nowrap ${$e(me.status||"To Do")}`,children:me.status||"To Do"})}),a.jsx("td",{className:"py-3 px-4 whitespace-nowrap",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium whitespace-nowrap ${be(me.priority||"Low")}`,children:me.priority||"Low"})}),a.jsx("td",{className:"py-3 px-4 text-gray-700 whitespace-nowrap",children:me.assignedToName||"Unassigned"}),a.jsx("td",{className:`py-3 px-4 text-gray-700 whitespace-nowrap ${ke(me)?"text-red-600 font-medium":""}`,children:me.dateAssigned?ZB(me.dateAssigned):""}),a.jsx("td",{className:"py-3 px-4 whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center gap-3",onClick:Ue=>Ue.stopPropagation(),children:[a.jsxs("button",{type:"button",onClick:()=>oe(me),className:"text-blue-500 hover:text-blue-700 flex items-center gap-1",children:[a.jsx(hn,{})," Edit"]}),a.jsxs("button",{type:"button",onClick:()=>se(me),className:"text-red-500 hover:text-red-700 flex items-center gap-1",children:[a.jsx(wa,{})," Delete"]})]})})]},me.id))})]})})}),!p&&!t&&n==="list"&&a.jsx(ca,{className:"mt-6",totalItems:fe.length,pageSize:Rg,currentPage:fe.length===0?0:T,onPrev:()=>A(me=>Math.max(me-1,1)),onNext:()=>A(me=>Math.min(me+1,Math.max(1,Math.ceil(fe.length/Rg)||1))),label:"tasks"}),a.jsx(v0,{isOpen:r,onClose:je,onSave:X,onEdit:()=>u(!1),setFormData:R,formData:B,isEditing:!c&&!!o,viewMode:c,users:_,currentUser:e,onDelete:se}),E&&a.jsx(EGe,{open:!0,title:E.title,message:E.message,confirmLabel:E.confirmLabel,cancelLabel:E.cancelLabel,variant:E.variant,onConfirm:ye,onCancel:Ne,loading:z})]})}function kGe({icon:e,title:t,value:n,color:s,bgColor:r,onClick:i}){return a.jsxs("div",{className:"flex items-center p-4 bg-white rounded-xl shadow-md border border-gray-200 transition-all duration-300 cursor-default",onClick:i,children:[a.jsx("div",{className:`flex-shrink-0 p-3 rounded-full ${r} ${s} mr-4`,children:e?a.jsx(e,{size:22}):null}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:t}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:n})]})]})}function EGe({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r,variant:i,loading:o,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsx("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${u}`,disabled:o,children:o?"Processing...":s})]})]})})}function LGe(){f.useEffect(()=>{document.title="Campaign | Sari-Sari CRM"},[]);const[e,t]=f.useState(!1),[n,s]=f.useState(!1),[r,i]=f.useState(null),[o,l]=f.useState(""),[c,u]=f.useState("All Statuses"),[d,h]=f.useState({show:!1,action:null,campaign:null}),[p,x]=f.useState([{id:1,name:"Christmas Promo 2025",subject:" Holiday Discounts Await You!",content:"Spread holiday cheer with exclusive deals this Christmas season!",status:"Scheduled",recipients:1200,scheduleDate:"2025-12-15T10:00",created:"2025-10-20",createdBy:"Marketing Team"},{id:2,name:"New Year Kickoff",subject:"Start 2026 with Big Savings!",content:"Kick off your year right with amazing offers from us!",status:"Draft",recipients:"",scheduleDate:"",created:"2025-10-25",createdBy:"Marketing Team"}]),[v,j]=f.useState({id:null,name:"",subject:"",content:"",status:"Draft",recipients:"",scheduleDate:""}),y=p.filter(P=>{const D=c==="All Statuses"||P.status===c,U=P.name.toLowerCase().includes(o.toLowerCase())||P.subject.toLowerCase().includes(o.toLowerCase());return D&&U}),N=()=>{s(!1),j({id:null,name:"",subject:"",content:"",status:"Draft",recipients:"",scheduleDate:""}),t(!0)},w=(P,D)=>{D.stopPropagation(),s(!0),j(P),t(!0)},S=(P,D)=>{D.stopPropagation(),h({show:!0,action:"delete",campaign:P})},_=P=>{P.preventDefault(),h({show:!0,action:n?"edit":"add",campaign:{...v}})},k=()=>{if(d.action==="add"){const P={...d.campaign,id:Date.now(),created:new Date().toLocaleDateString(),createdBy:"Marketing Team"};x(D=>[...D,P]),t(!1)}else d.action==="edit"?(x(P=>P.map(D=>D.id===d.campaign.id?{...d.campaign}:D)),t(!1)):d.action==="delete"&&x(P=>P.filter(D=>D.id!==d.campaign.id));h({show:!1,action:null,campaign:null})},T=()=>{h({show:!1,action:null,campaign:null})},A=P=>i(P),E=()=>i(null),M=P=>{const{name:D,value:U}=P.target;j(B=>({...B,[D]:U}))},z=P=>{P.target.id==="modalBackdrop"&&t(!1)};return r?a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter",children:[a.jsxs("button",{onClick:E,className:"inline-flex items-center text-sm sm:text-base text-gray-500 hover:text-gray-700 transition mb-6 cursor-pointer",children:[a.jsx(Ku,{className:"mr-1 w-5 h-5"})," Back"]}),a.jsx("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center mb-6",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-800",children:r.name}),a.jsx("span",{className:`text-xs sm:text-sm px-2 py-0.5 rounded ${r.status==="Scheduled"?"bg-yellow-100 text-yellow-700":r.status==="Sent"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-600"}`,children:r.status})]})}),a.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[a.jsx("h2",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Campaign Information"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 text-sm text-gray-700",children:[a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:"Subject:"})," ",a.jsx("br",{}),r.subject]}),a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:"Created By:"})," ",a.jsx("br",{}),r.createdBy]}),a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:"Created On:"})," ",a.jsx("br",{}),r.created]}),a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:"Scheduled Date:"})," ",a.jsx("br",{}),r.scheduleDate?new Date(r.scheduleDate).toLocaleString():""]}),a.jsxs("p",{className:"sm:col-span-2",children:[a.jsx("span",{className:"font-semibold",children:"Email Content:"})," ",a.jsx("br",{}),r.content]}),r.status==="Scheduled"&&a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:"Recipients:"})," ",a.jsx("br",{}),r.recipients]})]})]})]}):a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h2",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(rn,{className:"mr-2 text-blue-600"})," Email Campaigns"]}),a.jsx("button",{onClick:N,className:"flex items-center bg-black text-white px-4 py-2 rounded-md hover:bg-gray-800 transition text-sm sm:text-base shadow-sm",children:" New Campaign"})]}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search by campaign name or email subject...",value:o,onChange:P=>l(P.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsx("div",{className:"w-full lg:w-1/4",children:a.jsxs("select",{value:c,onChange:P=>u(P.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{children:"All Statuses"}),a.jsx("option",{children:"Draft"}),a.jsx("option",{children:"Scheduled"}),a.jsx("option",{children:"Sent"})]})})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-[700px] w-full border border-gray-200 rounded-lg bg-white shadow-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-sm text-gray-600",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4",children:"Campaign Name"}),a.jsx("th",{className:"py-3 px-4",children:"Email Subject"}),a.jsx("th",{className:"py-3 px-4",children:"Status"}),a.jsx("th",{className:"py-3 px-4",children:"Recipients"}),a.jsx("th",{className:"py-3 px-4",children:"Scheduled Date"}),a.jsx("th",{className:"py-3 px-4 text-center",children:"Actions"})]})}),a.jsx("tbody",{className:"text-sm text-gray-700",children:y.map((P,D)=>a.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer transition",onClick:()=>A(P),children:[a.jsx("td",{className:"py-3 px-4 font-medium text-blue-600",children:P.name}),a.jsx("td",{className:"py-3 px-4",children:P.subject}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${P.status==="Scheduled"?"bg-yellow-100 text-yellow-700":P.status==="Sent"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-600"}`,children:P.status})}),a.jsx("td",{className:"py-3 px-4",children:P.recipients?`${P.recipients} emails`:""}),a.jsx("td",{className:"py-3 px-4",children:P.scheduleDate?new Date(P.scheduleDate).toLocaleString():""}),a.jsx("td",{className:"py-3 px-4 text-center",onClick:U=>U.stopPropagation(),children:a.jsxs("div",{className:"flex justify-center gap-3",children:[a.jsx("button",{onClick:U=>w(P,U),className:"text-blue-500 hover:text-blue-700",children:a.jsx(gn,{})}),a.jsx("button",{onClick:U=>S(P,U),className:"text-red-500 hover:text-red-700",children:a.jsx(wa,{})})]})})]},D))})]})}),e&&a.jsx("div",{id:"modalBackdrop",onClick:z,className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-2xl rounded-xl shadow-lg p-5 sm:p-6 relative border border-gray-200 my-6 max-h-[90vh] overflow-y-auto",onClick:P=>P.stopPropagation(),children:[a.jsx("button",{onClick:()=>t(!1),className:"absolute top-3 right-3 text-gray-400 hover:text-black transition",children:a.jsx(ea,{size:20})}),a.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-gray-800 mb-4 text-center",children:n?"Edit Campaign":"Add New Campaign"}),a.jsxs("form",{onSubmit:_,className:"grid grid-cols-1 sm:grid-cols-2 gap-4 text-sm",children:[a.jsxs("div",{className:"flex flex-col",children:[a.jsxs("label",{className:"text-gray-700 font-medium mb-1",children:["Campaign Name ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",name:"name",value:v.name,onChange:M,placeholder:"e.g. Summer Sale Blast",required:!0,className:"border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-400 outline-none"})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsxs("label",{className:"text-gray-700 font-medium mb-1",children:["Email Subject ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",name:"subject",value:v.subject,onChange:M,placeholder:"e.g. Big discounts await you!",required:!0,className:"border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-400 outline-none"})]}),a.jsxs("div",{className:"flex flex-col sm:col-span-2",children:[a.jsxs("label",{className:"text-gray-700 font-medium mb-1",children:["Campaign Status ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("select",{name:"status",value:v.status,onChange:M,required:!0,className:"border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-400 outline-none",children:[a.jsx("option",{value:"Draft",children:"Draft"}),a.jsx("option",{value:"Scheduled",children:"Scheduled"}),a.jsx("option",{value:"Sent",children:"Sent"})]})]}),v.status==="Scheduled"&&a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:col-span-2",children:[a.jsxs("div",{className:"flex flex-col",children:[a.jsxs("label",{className:"text-gray-700 font-medium mb-1",children:["Scheduled Date ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"datetime-local",name:"scheduleDate",value:v.scheduleDate,onChange:M,required:!0,className:"border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-400 outline-none"})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsxs("label",{className:"text-gray-700 font-medium mb-1",children:["Recipient Count ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"number",name:"recipients",value:v.recipients,onChange:M,placeholder:"e.g. 500",required:!0,className:"border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-400 outline-none"})]})]}),a.jsxs("div",{className:"flex flex-col sm:col-span-2",children:[a.jsxs("label",{className:"text-gray-700 font-medium mb-1",children:["Email Content ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("textarea",{name:"content",rows:4,value:v.content,onChange:M,placeholder:"Write your email message here...",required:!0,className:"border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-400 outline-none resize-none"})]}),a.jsxs("div",{className:"flex justify-end gap-2 sm:col-span-2 pt-3 border-t border-gray-100 mt-2",children:[a.jsx("button",{type:"button",onClick:()=>t(!1),className:"px-4 py-2 text-gray-700 bg-gray-100 border border-gray-300 rounded-md hover:bg-gray-200 transition",children:"Cancel"}),a.jsx("button",{type:"submit",className:"px-4 py-2 bg-black text-white rounded-md hover:bg-gray-800 transition",children:"Save Campaign"})]})]})]})}),d.show&&a.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 relative border border-gray-200",children:[a.jsx("button",{onClick:T,className:"absolute top-3 right-3 text-gray-400 hover:text-black transition",children:a.jsx(ea,{size:20})}),a.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-gray-800 mb-4 text-center",children:d.action==="delete"?"Confirm Delete":d.action==="edit"?"Confirm Edit":"Confirm Add"}),a.jsx("p",{className:"text-center text-gray-600 mb-6",children:d.action==="delete"?a.jsxs(a.Fragment,{children:["Are you sure you want to delete the campaign"," ",a.jsx("span",{className:"font-semibold",children:d.campaign.name}),"?"]}):d.action==="edit"?a.jsxs(a.Fragment,{children:["Save changes to"," ",a.jsx("span",{className:"font-semibold",children:d.campaign.name}),"?"]}):a.jsxs(a.Fragment,{children:["Add new campaign"," ",a.jsx("span",{className:"font-semibold",children:d.campaign.name}),"?"]})}),a.jsxs("div",{className:"flex justify-center gap-4",children:[a.jsx("button",{onClick:T,className:"px-4 py-2 text-gray-700 bg-gray-100 border border-gray-300 rounded-md hover:bg-gray-200 transition",children:"Cancel"}),a.jsx("button",{onClick:k,className:"px-4 py-2 bg-black text-white rounded-md hover:bg-gray-800 transition",children:"Confirm"})]})]})})]})}const PGe=[{id:1,name:"Welcome E-mail",category:"Welcome",subject:"Welcome to {company}!",body:`Hi {name}, Welcome to {company}! We're excited to have you on board.

Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed vel quam vitae erat venenatis feugiat. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas.

Best regards, The Team`,createdBy:"Angel Angelo",date:"12/10/23"},{id:2,name:"Product Demo Follow-up",category:"Follow-up",subject:"Thanks for checking out our demo",body:`Hi {name}, Thank you for taking the time to view our product demo.
Do you have any questions? Let's schedule a call to discuss how we can help {company}.

Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed vel quam vitae erat venenatis feugiat. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas.

Best, Sales Team`,createdBy:"Angel Angelo",date:"12/10/23"}],JB={Welcome:"bg-orange-100 text-orange-700","Follow-up":"bg-blue-100 text-blue-700",Newsletter:"bg-green-100 text-green-700",Promotional:"bg-purple-100 text-purple-700",default:"bg-gray-100 text-gray-800"};function DGe(){f.useEffect(()=>{document.title="Templates | Sari-Sari CRM"},[]);const[e,t]=f.useState(PGe),[n,s]=f.useState(!1),[r,i]=f.useState(null),[o,l]=f.useState(null),[c,u]=f.useState(""),[d,h]=f.useState("All Categories"),[p,x]=f.useState({name:"",category:"",subject:"",body:""}),[v,j]=f.useState({show:!1,action:null,template:null}),y=()=>{l(null),i(null),s(!1)},N=D=>{x({...p,[D.target.name]:D.target.value})},w=()=>{j({show:!0,action:"add",template:{...p}})},S=D=>{i(D),x({name:D.name,category:D.category,subject:D.subject,body:D.body})},_=()=>{j({show:!0,action:"edit",template:{...p,id:r.id}})},k=D=>{j({show:!0,action:"delete",template:D})},T=D=>{Kx.success(`Template "${D.name}" selected for use!`),j({show:!1,action:null,template:null})},A=()=>{const D=v.template;if(v.action==="add"){const U={...D,id:e.length+1,createdBy:"You",date:new Date().toLocaleDateString()};t(B=>[U,...B]),s(!1),x({name:"",category:"",subject:"",body:""})}else v.action==="edit"?(t(U=>U.map(B=>B.id===D.id?{...D}:B).sort((B,R)=>new Date(R.date).getTime()-new Date(B.date).getTime())),i(null),x({name:"",category:"",subject:"",body:""}),l(null)):v.action==="delete"&&(t(U=>U.filter(B=>B.id!==D.id)),l(null));j({show:!1,action:null,template:null})},E=()=>{j({show:!1,action:null,template:null})},M=D=>l(D),z=e.filter(D=>D.name.toLowerCase().includes(c.toLowerCase())&&(d==="All Categories"||D.category===d)),P=(D,U=!1)=>a.jsxs("div",{className:"flex flex-col justify-between h-full",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:D.name}),a.jsx("span",{className:`text-xs px-3 py-1 rounded-md ${JB[D.category]||JB.default}`,children:D.category})]}),a.jsx("p",{className:"text-gray-600 mb-2 text-sm",children:D.subject}),a.jsx("div",{className:`text-gray-800 text-sm p-2 rounded-md ${U?"bg-gray-50 max-h-40 overflow-y-auto":"truncate"} whitespace-pre-line`,style:U?{}:{display:"-webkit-box",WebkitLineClamp:7,WebkitBoxOrient:"vertical",overflow:"hidden"},children:D.body})]}),a.jsxs("div",{className:"flex justify-between items-center mt-4",children:[!U&&a.jsxs("button",{onClick:B=>{B.stopPropagation(),T(D)},className:"flex items-center gap-1 bg-black text-white px-3 py-1 rounded-md text-sm hover:bg-gray-900 transition",children:[a.jsx(ia,{})," Use Template"]}),U&&a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("button",{onClick:B=>{B.stopPropagation(),S(D)},className:"flex items-center gap-1 bg-black text-white px-3 py-1 rounded-md text-sm hover:bg-gray-900 transition",children:[a.jsx(hn,{})," Edit"]}),a.jsxs("button",{onClick:B=>{B.stopPropagation(),k(D)},className:"flex items-center gap-1 bg-red-500 text-white px-3 py-1 rounded-md text-sm hover:bg-red-600 transition",children:[a.jsx(wa,{})," Delete"]})]}),a.jsxs("p",{className:"text-gray-400 text-xs text-right",children:["Created by: ",D.createdBy," | ",D.date]})]})]});return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter min-h-screen",children:[a.jsx(Qx,{position:"top-center",reverseOrder:!1}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h2",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(ia,{className:"mr-2 text-black"})," Templates"]}),a.jsx("button",{onClick:()=>{s(!0),i(null),x({name:"",category:"",subject:"",body:""})},className:"flex items-center bg-black text-white px-4 py-2 rounded-md hover:bg-gray-800 transition text-sm sm:text-base shadow-sm",children:" New Template"})]}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search by template name...",value:c,onChange:D=>u(D.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsx("div",{className:"w-full lg:w-1/4",children:a.jsxs("select",{value:d,onChange:D=>h(D.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{children:"All Categories"}),a.jsx("option",{children:"Welcome"}),a.jsx("option",{children:"Follow-up"}),a.jsx("option",{children:"Newsletter"}),a.jsx("option",{children:"Promotional"})]})})]}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:z.map(D=>a.jsxs("div",{onClick:()=>M(D),className:"bg-white rounded-2xl shadow-lg border border-gray-100 hover:shadow-xl cursor-pointer flex flex-col justify-between h-80 transition",children:[a.jsx("div",{className:"h-2 w-full rounded-t-2xl bg-black"}),a.jsx("div",{className:"p-4 flex-grow",children:P(D)})]},D.id))}),(n||r)&&a.jsx("div",{onClick:y,className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-2xl rounded-xl shadow-lg p-5 sm:p-6 relative border border-gray-200 my-6 max-h-[90vh] overflow-y-auto",onClick:D=>D.stopPropagation(),children:[a.jsx("button",{onClick:y,className:"absolute top-3 right-3 text-gray-400 hover:text-black transition",children:a.jsx(ea,{size:20})}),a.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-gray-800 mb-4 text-center",children:r?"Edit Template":"Create New Template"}),a.jsxs("form",{onSubmit:D=>{D.preventDefault(),r?_():w()},className:"grid grid-cols-1 sm:grid-cols-2 gap-4 text-sm",children:[a.jsxs("div",{className:"flex flex-col",children:[a.jsxs("label",{className:"text-gray-700 font-medium mb-1",children:["Template Name ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",name:"name",value:p.name,onChange:N,placeholder:"e.g. Welcome Email",required:!0,className:"border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-black outline-none"})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsxs("label",{className:"text-gray-700 font-medium mb-1",children:["Category ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("select",{name:"category",value:p.category,onChange:N,required:!0,className:"border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-black outline-none",children:[a.jsx("option",{value:"",children:"Select Category"}),a.jsx("option",{value:"Welcome",children:"Welcome"}),a.jsx("option",{value:"Follow-up",children:"Follow-up"}),a.jsx("option",{value:"Newsletter",children:"Newsletter"}),a.jsx("option",{value:"Promotional",children:"Promotional"})]})]}),a.jsxs("div",{className:"flex flex-col sm:col-span-2",children:[a.jsxs("label",{className:"text-gray-700 font-medium mb-1",children:["Subject Line ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",name:"subject",value:p.subject,onChange:N,placeholder:"e.g. Welcome to our service!",required:!0,className:"border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-black outline-none"})]}),a.jsxs("div",{className:"flex flex-col sm:col-span-2",children:[a.jsxs("label",{className:"text-gray-700 font-medium mb-1",children:["Email Body ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("textarea",{name:"body",rows:4,value:p.body,onChange:N,placeholder:"Write your email message here...",required:!0,className:"border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-black outline-none resize-none"})]}),a.jsxs("div",{className:"flex justify-end gap-2 sm:col-span-2 pt-3 border-t border-gray-100 mt-2",children:[a.jsx("button",{type:"button",onClick:y,className:"px-4 py-2 text-gray-700 bg-gray-100 border border-gray-300 rounded-md hover:bg-gray-200 transition",children:"Cancel"}),a.jsx("button",{type:"submit",className:"px-4 py-2 bg-black text-white rounded-md hover:bg-gray-800 transition",children:r?"Update Template":"Create Template"})]})]})]})}),o&&!r&&a.jsx("div",{onClick:y,className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"rounded-2xl shadow-lg cursor-default h-80 w-full max-w-md overflow-hidden flex flex-col",onClick:D=>D.stopPropagation(),children:[a.jsx("div",{className:"h-2 w-full rounded-t-2xl bg-black"}),a.jsx("div",{className:"p-4 flex-grow overflow-y-auto bg-gray-50",children:P(o,!0)})]})}),v.show&&a.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 relative border border-gray-200",children:[a.jsx("button",{onClick:E,className:"absolute top-3 right-3 text-gray-400 hover:text-black transition",children:a.jsx(ea,{size:20})}),a.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-gray-800 mb-4 text-center",children:v.action==="delete"?"Confirm Delete":v.action==="edit"?"Confirm Update":v.action==="add"?"Confirm Add":"Confirm Use"}),a.jsx("p",{className:"text-center text-gray-600 mb-6",children:v.action==="delete"?a.jsxs(a.Fragment,{children:["Are you sure you want to delete the template"," ",a.jsx("span",{className:"font-semibold",children:v.template.name}),"?"]}):v.action==="edit"?a.jsxs(a.Fragment,{children:["Save changes to"," ",a.jsx("span",{className:"font-semibold",children:v.template.name}),"?"]}):v.action==="add"?a.jsxs(a.Fragment,{children:["Add new template"," ",a.jsx("span",{className:"font-semibold",children:v.template.name}),"?"]}):a.jsxs(a.Fragment,{children:["Use template"," ",a.jsx("span",{className:"font-semibold",children:v.template.name}),"?"]})}),a.jsxs("div",{className:"flex justify-center gap-4",children:[a.jsx("button",{onClick:E,className:"px-4 py-2 text-gray-700 bg-gray-100 border border-gray-300 rounded-md hover:bg-gray-200 transition",children:"Cancel"}),a.jsx("button",{onClick:A,className:"px-4 py-2 bg-black text-white rounded-md hover:bg-gray-800 transition",children:"Confirm"})]})]})})]})}const Cv=e=>{if(e==null||e==="")return 0;const t=Number(e);return Number.isFinite(t)?t:0},rf=(e,t="")=>{const n=Cv(e);return`${t}${n.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`},eH=e=>{if(!e)return"";const t=new Date(e);if(Number.isNaN(t.getTime()))return"";const n=t.getFullYear(),s=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0");return`${n}-${s}-${r}`},OGe=e=>{if(!e)return"";const t=new Date(e);return Number.isNaN(t.getTime())?"":t.toLocaleDateString(void 0,{year:"numeric",month:"long",day:"2-digit"})},MGe=e=>{if(!e)return"";const t=String(e).split("-");return t.length===3?`${t[0]}-${t[2]}`:String(e)},tH=(e,t,n)=>{const s=new Date,r=e?.contact?`${e.contact.first_name||""} ${e.contact.last_name||""}`.trim():"",i=e?.validity_days?String(e.validity_days):"";return{issuedDate:eH(e?.presented_date)||eH(s),subject:"Price Quotation",forName:e?.account?.name||"",attn:r,intro:"We are pleased to submit our proposal as follows:",notes:e?.notes||"",terms:{validity:i?`${i} days from the date of quotation.`:"",payment:"",deliveryPeriod:"",deliveryPoint:""},preparedBy:t?`${t.first_name||""} ${t.last_name||""}`.trim():"",approvedBy:n?.ceo_name||"Admin"}};function Kb(){const e=kt(),t=ta(),{quoteId:n}=Wo(),{user:s}=Vt(),r=s?.company?.currency||"",i=f.useMemo(()=>`quote-print:${n||""}`,[n]),[o,l]=f.useState(()=>{const _=t.state?.quote;return _&&String(_.id)===String(n)?_:null}),[c,u]=f.useState(()=>t.state?.companyInfo||null),[d,h]=f.useState(!1),[p,x]=f.useState(()=>{try{const _=sessionStorage.getItem(i);return _?JSON.parse(_):null}catch{return null}});f.useEffect(()=>{if(!n)return;let _=!0;return(async()=>{try{h(!0);const A=!c?await re.get("/company/invoice-info"):null;if(!_)return;if(A?.data&&u(A.data),!o){const E=await re.get("/quotes/admin/fetch-all"),z=(Array.isArray(E?.data)?E.data:[]).find(P=>String(P.id)===String(n));z&&l(z)}}catch(T){const A=T?.response?.data?.detail||T?.message||"Failed to load quotation.";H.error(A)}finally{_&&h(!1)}})(),()=>{_=!1}},[n]),f.useEffect(()=>{o&&x(_=>{if(_)return _;try{const T=sessionStorage.getItem(i);if(T)return JSON.parse(T)}catch{}const k=tH(o,s,c);try{sessionStorage.setItem(i,JSON.stringify(k))}catch{}return k})},[o,s,c,i]);const v=_=>{x(_);try{sessionStorage.setItem(i,JSON.stringify(_))}catch{}},j=Array.isArray(o?.items)?o.items:[],y=Cv(o?.discount_amount),N=Cv(o?.tax_rate);if(!p)return a.jsx("div",{className:"p-6",children:a.jsx("div",{className:"text-gray-700",children:d?"Loading...":""})});const w=p.preparedBy||(s?`${s.first_name||""} ${s.last_name||""}`.trim():""),S=p.approvedBy||c?.ceo_name||"CEO";return a.jsxs("div",{className:"min-h-screen bg-gray-50 quote-print-root",children:[a.jsx("style",{children:`
        @page { size: A4; margin: 5mm; }
        @media print {
          html, body { margin: 0 !important; padding: 0 !important; }
          .no-print { display: none !important; }
          .print-surface { box-shadow: none !important; border: none !important; }
          body { background: white !important; }
          .quote-print-root { background: white !important; }

          /* Remove screen gutters/max-width so print is tight */
          .quote-print-page { max-width: none !important; margin: 0 !important; padding: 0 !important; }

          * { -webkit-print-color-adjust: exact; print-color-adjust: exact; }

          /* Keep the quote meta proportions while printing (left 2 cols + fixed quotation col) */
          .quote-meta-grid { grid-template-columns: 1fr 1fr 240px !important; padding: 0px; }
        }
      `}),a.jsx("div",{className:"no-print sticky top-0 z-10 bg-white border-b border-gray-200",children:a.jsxs("div",{className:"max-w-5xl mx-auto px-4 py-3 flex items-center justify-between gap-3",children:[a.jsx("button",{type:"button",className:"px-3 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-50 text-sm",onClick:()=>e(-1),children:"Back"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{type:"button",className:"px-3 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-50 text-sm",onClick:()=>{if(!o)return;const _=tH(o,s,c);v(_)},disabled:!o,children:"Reset fields"}),a.jsx("button",{type:"button",className:"px-4 py-2 rounded-md bg-blue-600 text-white hover:bg-blue-700 text-sm disabled:opacity-70",onClick:()=>window.print(),disabled:!o||d,children:"Print"})]})]})}),a.jsxs("div",{className:"max-w-5xl mx-auto px-4 py-6 quote-print-page",children:[a.jsx("div",{className:"no-print bg-white border border-gray-200 rounded-xl p-4 mb-4",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Date"}),a.jsx("input",{type:"date",className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm",value:p.issuedDate||"",onChange:_=>v({...p,issuedDate:_.target.value})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Subject"}),a.jsx("input",{type:"text",className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm",value:p.subject||"",onChange:_=>v({...p,subject:_.target.value})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"For"}),a.jsx("input",{type:"text",className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm",value:p.forName||"",onChange:_=>v({...p,forName:_.target.value})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Attn"}),a.jsx("input",{type:"text",className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm",value:p.attn||"",onChange:_=>v({...p,attn:_.target.value})})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Intro"}),a.jsx("textarea",{className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm min-h-[70px]",value:p.intro||"",onChange:_=>v({...p,intro:_.target.value})})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Notes"}),a.jsx("textarea",{className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm min-h-[70px]",value:p.notes||"",onChange:_=>v({...p,notes:_.target.value})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Terms: Validity"}),a.jsx("input",{type:"text",className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm",value:p.terms?.validity||"",onChange:_=>v({...p,terms:{...p.terms,validity:_.target.value}})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Terms: Payment"}),a.jsx("input",{type:"text",className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm",value:p.terms?.payment||"",onChange:_=>v({...p,terms:{...p.terms,payment:_.target.value}})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Terms: Delivery Period"}),a.jsx("input",{type:"text",className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm",value:p.terms?.deliveryPeriod||"",onChange:_=>v({...p,terms:{...p.terms,deliveryPeriod:_.target.value}})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Terms: Delivery Point"}),a.jsx("input",{type:"text",className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm",value:p.terms?.deliveryPoint||"",onChange:_=>v({...p,terms:{...p.terms,deliveryPoint:_.target.value}})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Approved by"}),a.jsx("input",{type:"text",className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm",value:p.approvedBy||"",onChange:_=>v({...p,approvedBy:_.target.value})})]})]})}),a.jsxs("div",{className:"print-surface bg-white border border-gray-200 rounded-xl shadow-sm p-6",children:[a.jsxs("div",{className:"flex items-center justify-between gap-4 border-b border-gray-300 pb-3",children:[a.jsxs("div",{className:"min-w-0 w-4/5",children:[a.jsx("div",{className:"text-xl font-bold text-gray-900 uppercase",children:c?.company_name||""}),c?.address?a.jsx("div",{className:"text-sm text-gray-700",children:c.address}):null,c?.company_number?a.jsx("div",{className:"text-sm text-gray-700",children:c.company_number}):null,c?.ceo_email?a.jsxs("div",{className:"text-sm text-gray-700",children:["Email: ",c.ceo_email]}):null,c?.company_website?a.jsxs("div",{className:"text-sm text-gray-700",children:["Web: ",c.company_website]}):null]}),a.jsx("div",{className:"flex items-start gap-3 w-1/6",children:c?.company_logo?a.jsx("img",{src:c.company_logo,alt:"Company logo",className:"w-full h-auto object-contain"}):null})]}),a.jsxs("div",{className:"mt-4",children:[a.jsxs("div",{className:"quote-meta-grid grid grid-cols-3 text-sm border border-gray-300",children:[a.jsxs("div",{className:"flex gap-2 p-2 border border-gray-300 col-span-2",children:[a.jsx("div",{className:"w-16 font-semibold",children:"For:"}),a.jsx("div",{className:"min-w-0 break-words",children:p.forName||""})]}),a.jsx("div",{className:"quote-meta-quote justify-center text-center p-1 border-b border-t border-r border-gray-300",children:a.jsx("div",{className:"text-xl font-bold text-gray-900",children:"QUOTATION"})}),a.jsxs("div",{className:"flex gap-2 p-2 border border-gray-300 col-span-2",children:[a.jsx("div",{className:"w-16 font-semibold",children:"Attn:"}),a.jsx("div",{className:"min-w-0 break-words",children:p.attn||""})]}),a.jsx("div",{className:"quote-meta-quote justify-center text-center p-2 border-t border-r border-gray-300",children:a.jsxs("div",{className:"text-sm text-gray-700",children:["No."," ",a.jsx("span",{className:"font-semibold",children:MGe(o?.quote_id||o?.id)})]})}),a.jsxs("div",{className:"flex gap-2 p-2 border border-gray-300 col-span-2",children:[a.jsx("div",{className:"w-16 font-semibold",children:"Subject:"}),a.jsx("div",{className:"min-w-0 break-words",children:p.subject||""})]}),a.jsx("div",{className:"quote-meta-quote md:justify-center border-r border-b border-gray-300 text-center p-2",children:a.jsx("div",{className:"text-sm text-gray-700",children:OGe(p.issuedDate)})})]}),a.jsx("div",{className:"mt-4 text-sm text-gray-900 whitespace-pre-wrap",children:p.intro||""})]}),a.jsx("div",{className:"mt-4 overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm border border-gray-400 border-collapse",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gray-100",children:[a.jsx("th",{className:"border border-gray-400 px-2 py-2 w-14",children:"Item"}),a.jsx("th",{className:"border border-gray-400 px-2 py-2 text-left",children:"Description"}),a.jsx("th",{className:"border border-gray-400 px-2 py-2 w-20",children:"Qty"}),a.jsx("th",{className:"border border-gray-400 px-2 py-2 w-20",children:"Unit"}),a.jsx("th",{className:"border border-gray-400 px-2 py-2 w-28",children:"Unit Price"}),a.jsx("th",{className:"border border-gray-400 px-2 py-2 w-28",children:"Total Cost"})]})}),a.jsx("tbody",{children:j.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:6,className:"border border-gray-400 px-2 py-4 text-center text-gray-600",children:"No line items."})}):j.map((_,k)=>{const T=_?.name?String(_.name).trim():"",A=_?.description?String(_.description).trim():"",E=_?.variant?String(_.variant).trim():"",M=_?.sku?String(_.sku).trim():"",z=E&&M?`${E} (${M})`:M?`(${M})`:E,D=[T,A,z].map(U=>U?String(U).trim():"").filter(Boolean).join(`
`);return a.jsxs("tr",{children:[a.jsx("td",{className:"border border-gray-400 px-2 py-2 text-center",children:k+1}),a.jsx("td",{className:"border border-gray-400 px-2 py-2 whitespace-pre-wrap",children:D}),a.jsx("td",{className:"border border-gray-400 px-2 py-2 text-center",children:Cv(_?.quantity)||""}),a.jsx("td",{className:"border border-gray-400 px-2 py-2 text-center",children:_?.unit||""}),a.jsx("td",{className:"border border-gray-400 px-2 py-2 text-right",children:rf(_?.unit_price,r)}),a.jsx("td",{className:"border border-gray-400 px-2 py-2 text-right",children:rf(_?.line_total,r)})]},_?.id??k)})})]})}),a.jsx("div",{className:"mt-4 flex justify-end",children:a.jsx("table",{className:"text-sm border border-gray-400 border-collapse min-w-[280px]",children:a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsx("td",{className:"border border-gray-400 px-3 py-2 font-semibold",children:"SUB TOTAL"}),a.jsx("td",{className:"border border-gray-400 px-3 py-2 text-right",children:rf(o?.subtotal,r)})]}),y>0?a.jsxs("tr",{children:[a.jsx("td",{className:"border border-gray-400 px-3 py-2 font-semibold",children:"Less: Discount"}),a.jsx("td",{className:"border border-gray-400 px-3 py-2 text-right",children:rf(o?.discount_amount,r)})]}):null,a.jsxs("tr",{children:[a.jsxs("td",{className:"border border-gray-400 px-3 py-2 font-semibold",children:["Tax ",N.toFixed(0),"%"]}),a.jsx("td",{className:"border border-gray-400 px-3 py-2 text-right",children:rf(o?.tax_amount,r)})]}),a.jsxs("tr",{children:[a.jsx("td",{className:"border border-gray-400 px-3 py-2 font-bold",children:"TOTAL"}),a.jsx("td",{className:"border border-gray-400 px-3 py-2 text-right font-bold",children:rf(o?.total_amount,r)})]})]})})}),a.jsxs("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-bold text-gray-900 mb-2",children:"TERMS & CONDITIONS:"}),a.jsxs("div",{className:"text-sm",children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsx("div",{className:"w-28 font-semibold",children:"Validity"}),a.jsxs("div",{className:"flex-1",children:[": ",p.terms?.validity||""]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("div",{className:"w-28 font-semibold",children:"Payment"}),a.jsxs("div",{className:"flex-1",children:[": ",p.terms?.payment||""]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("div",{className:"w-28 font-semibold",children:"Delivery Period"}),a.jsxs("div",{className:"flex-1",children:[": ",p.terms?.deliveryPeriod||""]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("div",{className:"w-28 font-semibold",children:"Delivery Point"}),a.jsxs("div",{className:"flex-1",children:[": ",p.terms?.deliveryPoint||""]})]})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-bold text-gray-900 mb-2",children:"NOTE:"}),a.jsx("div",{className:"text-sm whitespace-pre-wrap text-gray-900",children:p.notes||""})]})]}),a.jsxs("div",{className:"mt-10 grid grid-cols-2 gap-10 text-sm",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-gray-700",children:"Prepared by:"}),a.jsx("div",{className:"mt-8 border-b border-gray-400"}),a.jsx("div",{className:"mt-2 font-semibold",children:w})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-gray-700",children:"Approved by:"}),a.jsx("div",{className:"mt-8 border-b border-gray-400"}),a.jsx("div",{className:"mt-2 font-semibold",children:S})]})]}),a.jsx("div",{className:"mt-6 text-xs text-gray-500",children:"Generated from Sari-Sari CRM quotation."})]})]})]})}function IGe({toggleSidebar:e}){const[t,n]=f.useState(!1),[s,r]=f.useState(!1),[i,o]=f.useState([]),[l,c]=f.useState(0),u=f.useRef(null),d=f.useRef(null),h=ta(),p=kt(),{logout:x}=Ks(),{user:v,fetchUser:j}=Vt(),N={"/group-manager/dashboard":"Dashboard","/group-manager/accounts":"Accounts","/group-manager/contacts":"Contacts","/reports":"Reports","/leads":"Leads","/group-manager/Audit":"Audit","/group-manager/targets":"Targets","/group-manager/leads":"Leads","/group-manager/quotes":"Quotes","/group-manager/users":"Users","/group-manager/deals":"Deals"}[h.pathname]||"Group Manager Panel";return f.useEffect(()=>{j()},[]),f.useEffect(()=>{const w=()=>{j()};return window.addEventListener("userProfileUpdated",w),()=>{window.removeEventListener("userProfileUpdated",w)}},[j]),f.useEffect(()=>{if(!v?.id)return;const w=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1",S=window.location.protocol==="https:"?"wss:":"ws:",_=w?"localhost:8000":window.location.host,k=`${S}//${_}/ws/notifications?user_id=${v.id}`,T=new WebSocket(k);return T.onmessage=A=>{const E=JSON.parse(A.data);o(M=>[E,...M]),c(M=>M+1)},()=>T.close()},[v?.id]),f.useEffect(()=>{function w(S){u.current&&!u.current.contains(S.target)&&n(!1),d.current&&!d.current.contains(S.target)&&r(!1)}return document.addEventListener("mousedown",w),()=>document.removeEventListener("mousedown",w)},[]),a.jsxs("header",{className:"flex justify-between items-center bg-white shadow px-4 sm:px-6 py-3 border-b relative z-50",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("button",{onClick:e,className:"lg:hidden text-gray-700 hover:text-gray-900",children:a.jsx(th,{className:"text-2xl"})}),a.jsx("h1",{className:"text-lg font-semibold text-gray-800",children:N})]}),a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs("div",{className:"relative",ref:d,children:[a.jsxs("button",{onClick:()=>r(!s),className:"relative text-gray-600 hover:text-gray-800 transition",children:[a.jsx(mx,{className:"text-xl"}),l>0&&a.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-[10px] w-4 h-4 flex items-center justify-center rounded-full font-semibold",children:l})]}),s&&a.jsxs("div",{className:"absolute right-0 mt-3 w-80 bg-white rounded-xl shadow-lg border z-50 overflow-hidden animate-in fade-in slide-in-from-top-2 duration-200",children:[a.jsxs("div",{className:"p-3 border-b bg-gray-50 flex justify-between items-center",children:[a.jsx("h3",{className:"font-semibold text-gray-800 text-sm",children:"Notifications"}),a.jsx("button",{onClick:()=>{o([]),c(0)},className:"text-xs text-blue-600 hover:underline",children:"Clear All"})]}),a.jsx("div",{className:"max-h-60 overflow-y-auto",children:i.length>0?i.map((w,S)=>a.jsx("div",{className:"p-3 border-b text-sm hover:bg-gray-50 cursor-pointer transition",children:w.title||w.message||"New Notification"},S)):a.jsx("div",{className:"p-4 text-center text-gray-500 text-xs",children:"No notifications"})})]})]}),a.jsxs("div",{className:"relative",ref:u,children:[a.jsxs("button",{onClick:()=>n(!t),className:"flex items-center gap-2 cursor-pointer hover:bg-gray-100 px-2 py-1 rounded transition",children:[a.jsx("img",{src:v?.profile_picture||"https://via.placeholder.com/40",alt:"Profile",className:"w-8 h-8 object-cover rounded-full border border-gray-200"}),a.jsxs("span",{className:"hidden lg:inline text-sm font-medium text-gray-700",children:[v?.first_name," ",v?.last_name]})]}),t&&a.jsxs("div",{className:"absolute right-0 mt-2 w-64 bg-white shadow-xl rounded-xl border border-gray-200 z-50 p-4 animate-in fade-in slide-in-from-top-2 duration-200",children:[a.jsxs("div",{className:"flex flex-col items-center text-center space-y-3",children:[a.jsx("img",{src:v?.profile_picture||"https://via.placeholder.com/80",alt:"Profile Large",className:"w-16 h-16 rounded-full object-cover border-2 border-gray-100"}),a.jsxs("div",{children:[a.jsxs("h2",{className:"text-gray-800 font-semibold text-sm",children:[v?.first_name," ",v?.middle_name," ",v?.last_name]}),a.jsx("p",{className:"text-[11px] text-gray-600 font-light w-full truncate",children:"Group Manager"})]})]}),a.jsxs("div",{className:"mt-6 space-y-1 px-2",children:[a.jsx("button",{onClick:()=>{p("/group-manager/users"),n(!1)},className:"block w-full text-sm text-gray-700 hover:bg-gray-50 p-2 rounded text-left transition",children:"Invite Your Team"}),a.jsx("button",{onClick:()=>{p("/group-manager/manage-account"),n(!1)},className:"block w-full text-sm text-gray-700 hover:bg-gray-50 p-2 rounded text-left transition",children:"Manage Your Account"}),a.jsx("div",{className:"border-t border-gray-100 my-2"}),a.jsx("button",{onClick:x,className:"block w-full text-sm text-red-600 hover:bg-red-50 p-2 rounded text-left transition font-medium",children:"Logout"})]})]})]})]})]})}function $Ge(){const[e,t]=f.useState(!1),[n,s]=f.useState(!1),[r,i]=f.useState(!1),[o,l]=f.useState(!1),c=ta(),{user:u}=Vt();f.useEffect(()=>{u&&console.log("Fetched user:",u)},[u]),f.useEffect(()=>{console.log("Simulating user fetch... (no backend)")},[]),f.useEffect(()=>{document.title="Panel | Sari-Sari CRM"},[]);const d="flex items-center gap-3 px-3 py-2 rounded-lg bg-white text-[#1e293b] font-semibold shadow-sm",h="flex items-center gap-3 px-3 py-2 rounded-lg text-gray-300 hover:bg-[#334155] hover:text-white transition";return["/group-manager/accounts","/group-manager/contacts","/group-manager/leads","/group-manager/deals","/group-manager/quotes","/group-manager/targets","/group-manager/meetings"].includes(c.pathname),a.jsxs("div",{className:"flex h-screen bg-gray-100 overflow-hidden",children:[a.jsxs("div",{className:`fixed top-0 left-0 h-screen w-64 bg-[#1e293b] text-white flex flex-col shadow-lg transform transition-transform duration-300 z-50
          ${o?"translate-x-0":"-translate-x-full"} lg:translate-x-0`,children:[a.jsxs("div",{className:"px-4 py-3 bg-[#fbbf24] leading-none",children:[a.jsxs("p",{className:"text-gray-900 font-bold text-lg m-0 p-0",children:[" Sari-Sari.CRM"," ",a.jsx("span",{className:"text-[12px] text-gray-700 font-medium align-bottom",children:"v2"})]}),u&&u.company&&a.jsx("p",{className:"text-[12px] text-gray-600 font-medium w-full truncate",children:u.company.company_name})]}),a.jsxs("nav",{className:"flex-1 overflow-y-auto p-4 space-y-2 hide-scrollbar",children:[a.jsxs(Ft,{to:"/group-manager/dashboard",className:({isActive:x})=>x?d:h,children:[a.jsx(eh,{className:"text-lg"}),a.jsx("span",{children:"Dashboard"})]}),a.jsxs("div",{children:[a.jsxs("button",{className:"w-full px-3 py-2 flex justify-between items-center text-sm font-medium text-gray-300 hover:bg-[#334155] rounded-lg transition",onClick:()=>t(!e),children:[a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx(sa,{className:"text-lg"}),"Sales"]}),a.jsx(Pt,{className:`transition-transform ${e?"rotate-180":""}`})]}),e&&a.jsxs("div",{className:"ml-6 mt-2 space-y-1",children:[a.jsxs(Ft,{to:"/group-manager/accounts",className:({isActive:x})=>x?d:h,children:[a.jsx(ac,{})," Accounts"]}),a.jsxs(Ft,{to:"/group-manager/contacts",className:({isActive:x})=>x?d:h,children:[a.jsx(ra,{})," Contacts"]}),a.jsxs(Ft,{to:"/group-manager/leads",className:({isActive:x})=>x?d:h,children:[a.jsx(Xa,{})," Leads"]}),a.jsxs(Ft,{to:"/group-manager/deals",className:({isActive:x})=>x?d:h,children:[a.jsx(sa,{})," Deals"]}),a.jsxs(Ft,{to:"/group-manager/quotes",className:({isActive:x})=>x?d:h,children:[a.jsx(ia,{})," Quotes"]}),a.jsxs(Ft,{to:"/group-manager/targets",className:({isActive:x})=>x?d:h,children:[a.jsx(fr,{})," Targets"]})]})]}),a.jsxs("div",{children:[a.jsxs("button",{className:"w-full px-3 py-2 flex justify-between items-center text-sm font-medium text-gray-300 hover:bg-[#334155] rounded-lg transition",onClick:()=>s(!n),children:[a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx(ks,{className:"text-lg"}),"Activity"]}),a.jsx(Pt,{className:`transition-transform ${n?"rotate-180":""}`})]}),n&&a.jsxs("div",{className:"ml-6 mt-2 space-y-1",children:[a.jsxs(Ft,{to:"/group-manager/tasks",className:({isActive:x})=>x?d:h,children:[a.jsx(Qt,{})," Tasks"]}),a.jsxs(Ft,{to:"/group-manager/meetings",className:({isActive:x})=>x?d:h,children:[a.jsx(Ot,{})," Meetings"]}),a.jsxs(Ft,{to:"/group-manager/calls",className:({isActive:x})=>x?d:h,children:[a.jsx(Fs,{})," Calls"]}),a.jsxs(Ft,{to:"/group-manager/audit",className:({isActive:x})=>x?d:h,children:[a.jsx(ks,{})," Audit"]})]})]}),a.jsx("div",{children:a.jsx(Ft,{to:"/group-manager/territory",className:({isActive:x})=>x?d:h,children:a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx(tc,{className:"text-lg"}),"Territory"]})})}),a.jsxs("div",{children:[a.jsxs("button",{className:"w-full px-3 py-2 flex justify-between items-center text-sm font-medium text-gray-300 hover:bg-[#334155] rounded-lg transition",onClick:()=>i(!r),children:[a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx(SL,{className:"text-lg"}),"Settings"]}),a.jsx(Pt,{className:`transition-transform ${r?"rotate-180":""}`})]}),r&&a.jsxs("div",{className:"ml-6 mt-2 space-y-1",children:[a.jsxs(Ft,{to:"/group-manager/users",className:({isActive:x})=>x?d:h,children:[a.jsx(Za,{})," Users"]}),a.jsxs(Ft,{to:"/group-manager/manage-account",className:({isActive:x})=>x?d:h,children:[a.jsx(ra,{})," Your Profile"]})]})]})]}),a.jsxs("div",{className:"px-4 py-3 text-xs text-gray-400 border-t border-gray-700",children:[" ",new Date().getFullYear()," Sari-Sari CRM"]})]}),o&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 lg:hidden",onClick:()=>l(!1)}),a.jsxs("div",{className:"flex-1 flex flex-col lg:ml-64 overflow-hidden",children:[a.jsx(IGe,{toggleSidebar:()=>l(!o)}),a.jsx("main",{className:"flex-1 p-6 overflow-auto hide-scrollbar",style:{backgroundColor:"#fffeee"},children:a.jsx(Xf,{})})]})]})}const RGe=e=>a.jsx(Kt,{...e}),zGe=e=>a.jsx(ac,{...e}),vee=e=>a.jsx(zs,{...e}),FGe=e=>a.jsx(ux,{...e}),UGe=e=>a.jsx(hj,{...e}),BGe=e=>a.jsx(Ot,{...e}),HGe=e=>a.jsx(It,{...e}),qGe=e=>a.jsx(pj,{...e}),wee=e=>a.jsx(gj,{...e}),GGe=e=>a.jsx(Za,{...e}),jee=e=>a.jsx(ra,{...e}),WGe=e=>a.jsx(Xa,{...e}),Nee=e=>a.jsx(sa,{...e}),VGe=e=>a.jsx(ia,{...e}),Cee=e=>a.jsx(fr,{...e}),YGe=e=>a.jsx(Qa,{...e}),QGe=e=>a.jsx(Ot,{...e}),KGe=e=>a.jsx(Fs,{...e}),XGe=e=>a.jsx(tc,{...e}),ZGe=e=>a.jsx(ks,{...e}),See=(e,t="")=>{const n=parseFloat(e)||0;return new Intl.NumberFormat("en-US",{notation:"compact",compactDisplay:"short",maximumFractionDigits:1}).format(n).replace(/^/,`${t} `)},JGe=e=>{switch(e){case"Negotiation":return{text:"text-purple-700",bg:"bg-purple-100"};case"Proposal":return{text:"text-red-700",bg:"bg-red-100"};case"Qualification":return{text:"text-yellow-700",bg:"bg-yellow-100"};case"Prospecting":return{text:"text-blue-700",bg:"bg-blue-100"};case"Closed Won":return{text:"text-green-700",bg:"bg-green-100"};case"Closed Lost":return{text:"text-red-700",bg:"bg-red-100"};default:return{text:"text-gray-700",bg:"bg-gray-100"}}},eWe=e=>{switch(e){case"Website":return{text:"text-green-600",bg:"bg-green-100"};case"Referral":return{text:"text-purple-600",bg:"bg-purple-100"};case"Trade Show":return{text:"text-orange-600",bg:"bg-orange-100"};case"Cold Call":return{text:"text-red-600",bg:"bg-red-100"};default:return{text:"text-gray-600",bg:"bg-gray-100"}}},tWe=e=>{switch(e){case"call":return{Icon:HGe,color:"text-red-500",bgColor:"bg-red-100"};case"qualification":return{Icon:qGe,color:"text-green-600",bgColor:"bg-green-100"};default:return{Icon:BGe,color:"text-blue-500",bgColor:"bg-blue-100"}}},aWe=e=>{switch(e.toUpperCase()){case"HIGH":return{text:"text-red-700",bg:"bg-red-100"};case"LOW":return{text:"text-blue-700",bg:"bg-blue-100"};default:return{text:"text-gray-700",bg:"bg-gray-100"}}},nWe=({searchQuery:e,onSearchChange:t,searchResults:n,onSearchResultClick:s})=>{const r=kt(),[i,o]=f.useState(!1),l=f.useRef(null),c=[{icon:zGe,label:"Account"},{icon:jee,label:"Contact"},{icon:WGe,label:"Leads"},{icon:Nee,label:"Deals"},{icon:VGe,label:"Quotes"},{icon:Cee,label:"Target"},{icon:YGe,label:"Task"},{icon:QGe,label:"Meeting"},{icon:KGe,label:"Call"},{icon:ZGe,label:"Audit"},{icon:XGe,label:"Territory"}];f.useEffect(()=>{const h=p=>{l.current&&!l.current.contains(p.target)&&o(!1)};return document.addEventListener("mousedown",h),()=>document.removeEventListener("mousedown",h)},[]);const u=h=>{t(h.target.value),o(h.target.value.trim().length>0)},d=h=>{s&&s(h),o(!1)};return a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-3 sm:p-4 flex flex-col items-start space-y-4 w-full",children:[a.jsxs("div",{className:"w-full flex justify-center relative",ref:l,children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg lg:mt-3 px-4 py-2 w-full max-w-md md:max-w-lg lg:max-w-2xl focus-within:ring-2 focus-within:ring-blue-500 transition duration-150",children:[a.jsx(RGe,{size:20,className:"text-gray-400 mr-3 flex-shrink-0"}),a.jsx("input",{type:"text",placeholder:"Search Leads, Deals, or Accounts...",className:"focus:outline-none text-base w-full",value:e,onChange:u,onFocus:()=>e.trim().length>0&&o(!0)})]}),i&&Array.isArray(n)&&n.length>0&&a.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 mt-2 w-full max-w-md md:max-w-lg lg:max-w-2xl bg-white rounded-lg shadow-xl border border-gray-200 z-50 max-h-96 overflow-y-auto",children:n.map((h,p)=>a.jsx("div",{className:"px-4 py-3 hover:bg-gray-50 cursor-pointer border-b border-gray-100 last:border-b-0 transition duration-150",onClick:()=>d(h),children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-semibold text-gray-800 text-sm",children:h.name}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:h.type}),h.details&&a.jsx("p",{className:"text-xs text-gray-400 mt-1",children:h.details})]}),a.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${h.type==="Lead"?"bg-blue-100 text-blue-600":h.type==="Deal"?"bg-yellow-100 text-yellow-600":"bg-green-100 text-green-600"}`,children:h.type})]})},p))}),i&&e.trim().length>0&&(!Array.isArray(n)||n.length===0)&&a.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 mt-2 w-full max-w-md md:max-w-lg lg:max-w-2xl bg-white rounded-lg shadow-xl border border-gray-200 z-50 p-4 text-center text-sm text-gray-500",children:"No results found"})]}),a.jsx("div",{className:"w-full overflow-x-auto lg:overflow-x-hidden scroll-smooth flex justify-center",children:a.jsx("div",{className:"flex flex-nowrap space-x-3 lg:space-x-4 xl:space-x-3 px-2 sm:px-0",children:c.map((h,p)=>a.jsxs("div",{className:"relative flex-shrink-0 group",children:[a.jsx("button",{className:"p-3 text-gray-500 hover:text-gray-900 transition duration-150 rounded-full hover:bg-gray-100 focus:outline-none cursor-pointer","aria-label":h.label,title:h.label,onClick:()=>{switch(h.label){case"Account":r("/group-manager/accounts");break;case"Contact":r("/group-manager/contacts");break;case"Leads":r("/group-manager/leads");break;case"Deals":r("/group-manager/deals");break;case"Quotes":r("/group-manager/quotes");break;case"Target":r("/group-manager/targets");break;case"Task":r("/group-manager/tasks");break;case"Meeting":r("/group-manager/meetings");break;case"Call":r("/group-manager/calls");break;case"Audit":r("/group-manager/audit");break;case"Territory":r("/group-manager/territory");break;default:console.log(`Clicked ${h.label}`)}},children:a.jsx(h.icon,{size:24,className:"lg:scale-95"})}),a.jsxs("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 px-3 py-1.5 bg-gray-900 text-white text-xs font-semibold rounded-md whitespace-nowrap opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-75 ease-in-out z-50 shadow-lg",children:[h.label,a.jsx("div",{className:"absolute top-full left-1/2 -translate-x-1/2 -mt-1 border-4 border-transparent border-t-gray-900"})]})]},p))})})]})},sWe=({action:e,description:t,entity_type:n,entity_name:s,timestamp:r})=>{const i=kt(),o=d=>{if(!d)return"Unknown";const h=new Date(d),x=new Date-h,v=Math.floor(x/6e4),j=Math.floor(x/36e5),y=Math.floor(x/864e5);return v<1?"Just now":v<60?`${v} min ago`:j<24?`${j} hour${j>1?"s":""} ago`:y<7?`${y} day${y>1?"s":""} ago`:h.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},l=e||t||"Action",c=s||n||"System",u=o(r);return a.jsxs("li",{className:"flex justify-between items-center py-2 border-b border-gray-100 last:border-b-0 cursor-pointer hover:bg-gray-50 transition duration-150 px-2 -mx-2 rounded-md",onClick:()=>i("/group-manager/audit"),children:[a.jsxs("p",{className:"text-sm text-gray-800 flex-grow font-medium",children:[l," ",a.jsxs("span",{className:"text-gray-500 italic text-xs",children:["(",c,")"]})]}),a.jsx("span",{className:"text-xs text-gray-400 flex-shrink-0 ml-4",children:u})]})},rWe=({logs:e,loading:t})=>{const n=kt();return a.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg border border-gray-100 flex flex-col h-full",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h2",{className:"text-md font-semibold text-gray-800",children:"Recent Logs"}),a.jsxs("span",{className:"text-sm text-blue-500 cursor-pointer hover:underline flex items-center space-x-1 font-medium",onClick:()=>n("/group-manager/audit"),children:[a.jsx("span",{children:"See All"}),a.jsx(wee,{size:14,className:"transform -rotate-45"})]})]}),e&&e.length>0?a.jsx("ul",{className:"space-y-1",children:e.slice(0,3).map((s,r)=>a.jsx(sWe,{...s},r))}):a.jsx("div",{className:"text-sm text-gray-500 py-4",children:"No recent logs"})]})},iWe=({icon:e,title:t,value:n,color:s,bgColor:r,loading:i,onClick:o})=>a.jsxs("div",{className:"flex items-center p-4 bg-white rounded-xl shadow-md border border-gray-200 transition-all duration-300",onClick:o||(()=>console.log(`Clicked metric card: ${t}`)),children:[a.jsx("div",{className:`p-3 rounded-full ${r} ${s} mr-4`,children:a.jsx(e,{size:20})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-500 font-medium uppercase",children:t}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:n||0})]})]}),oWe=({revenueData:e,loading:t})=>{const n=kt(),s=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],r=f.useMemo(()=>{if(console.log("=== RevenueChart calculateRevenueData ==="),console.log("revenueData:",e),console.log("revenueData length:",e?.length),!e||e.length===0){console.log("No revenue data, returning empty chart");const y=new Date;y.getFullYear();const N=y.getMonth(),w=[],S=[];for(let _=0;_<=N;_++)w.push(s[_]),S.push(0);return{labels:w,revenues:S,maxRevenue:0}}const l={};let c=0,u=0;console.log("Processing deals:",e.length),e.forEach((y,N)=>{const w=y.close_date||y.closeDate||null,S=w&&w!==null&&w!=="",_=y.stage||"",k=_.toUpperCase()==="CLOSED_WON"||_==="CLOSED_WON";let T=y.amount;T&&typeof T=="object"&&T.toString?T=parseFloat(T.toString()):T=parseFloat(T)||0;const A=T>0;if(k&&(u++,console.log(`Deal ${N+1} (CLOSED_WON):`,{id:y.id,name:y.name,stage:_,close_date:w,close_date_type:typeof w,amount:T,amount_type:typeof y.amount,hasCloseDate:S,hasAmount:A,willBeAdded:S&&A,allFields:Object.keys(y)})),S&&k&&A)try{let E=new Date(w);if(isNaN(E.getTime())){const M=String(w).split("T")[0];E=new Date(M+"T00:00:00")}if(isNaN(E.getTime()))console.warn(` Invalid date for deal ${y.id}:`,w,"Type:",typeof w);else{const M=E.getFullYear(),z=E.getMonth()+1,P=`${M}-${String(z).padStart(2,"0")}`;l[P]||(l[P]=0),l[P]+=T,c++,console.log(` Added deal ${y.id} to month ${P}: ${T}, total: ${l[P]}`),console.log(`  - Close date: ${w} -> Parsed: ${E.toISOString()} -> Month: ${P} (Year: ${M}, Month: ${z})`)}}catch(E){console.error("Error parsing deal date:",w,E)}else k&&console.warn(` Deal ${y.id} is CLOSED_WON but missing data:`,{hasCloseDate:S,hasAmount:A,closeDate:w,amount:T,originalAmount:y.amount})}),console.log("Summary:",{totalDeals:e.length,closedWonDeals:u,validDealsForGraph:c,monthlyRevenue:l});const d=Object.keys(l).map(y=>parseInt(y.split("-")[0])),h=d.length>0?[...new Set(d)].sort():[],p=new Date().getFullYear();new Date().getMonth();const x=[],v=[];for(let y=0;y<12;y++){const N=`${p}-${String(y+1).padStart(2,"0")}`;x.push(s[y]);const w=l[N]||0;v.push(w),w>0&&console.log(`Month ${s[y]} (${N}): ${w}`)}if(h.length>0){const y=Math.max(...h);if(y>p)for(let N=p+1;N<=y;N++)for(let w=0;w<12;w++){const S=`${N}-${String(w+1).padStart(2,"0")}`,_=l[S]||0;x.push(`${s[w]} ${N}`),v.push(_),_>0&&console.log(`Month ${s[w]} ${N} (${S}): ${_}`)}}const j=Math.max(...v,1);return console.log("Final chart data:",{labels:x,revenues:v,maxRevenue:j,hasData:v.some(y=>y>0)}),{labels:x,revenues:v,maxRevenue:j}},[e]),i=r.labels,o=r.revenues;return console.log("=== FINAL CHART DATA ==="),console.log("X Axis (Months):",i),console.log("Y Axis (Revenue):",o),console.log("Has any revenue > 0:",o.some(l=>l>0)),console.log("All revenue values:",o),console.log("Max revenue:",r.maxRevenue),a.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg h-full flex flex-col",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Revenue Overview"}),a.jsxs("span",{className:"text-sm text-blue-500 cursor-pointer hover:underline flex items-center space-x-1 font-medium",onClick:()=>n("/group-manager/deals"),children:[a.jsx("span",{children:"See All"}),a.jsx(wee,{size:14,className:"transform -rotate-45"})]})]}),a.jsx("div",{className:"h-80 relative flex-1 flex items-center justify-center p-6",children:a.jsx("div",{className:"w-full h-full flex items-center justify-center",children:i&&i.length>0&&o&&o.length>0?a.jsx(lh,{xAxis:[{data:i,scaleType:"point"}],yAxis:[{valueFormatter:l=>l>=1e3?`${(l/1e3).toFixed(0)}k`:l.toString()}],series:[{data:o,showMark:!0,area:!0}],height:320,width:void 0,grid:{vertical:!0,horizontal:!0},margin:{top:40,right:40,bottom:50,left:50},sx:{width:"100%",maxWidth:"100%"}}):a.jsxs("div",{className:"text-center text-gray-500",children:[a.jsx("p",{className:"text-sm",children:"No revenue data available"}),a.jsx("p",{className:"text-xs mt-2",children:"Closed won deals with close dates will appear here"})]})})})]})},_T=({title:e,items:t,children:n,onSeeAll:s})=>{const r=kt(),i=()=>{if(s)s();else{const o={"Latest Leads":"/group-manager/leads","Latest Deals":"/group-manager/deals","Upcoming Activities":"/group-manager/tasks"};o[e]&&r(o[e])}};return a.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg flex flex-col",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:e}),a.jsx("span",{className:"text-sm text-blue-500 cursor-pointer hover:underline",onClick:i,children:"See All"})]}),n]})},lWe=({first_name:e,last_name:t,company_name:n,source:s,created_at:r,id:i})=>{const o=kt(),{text:l,bg:c}=eWe(s||"Website"),u=x=>{if(!x)return"Unknown";const v=new Date(x),y=new Date-v,N=Math.floor(y/6e4),w=Math.floor(y/36e5),S=Math.floor(y/864e5);return N<60?`${N} min ago`:w<24?v.toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}):S<7?v.toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}):v.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})},d=`${e||""} ${t||""}`.trim()||"Unknown",h=n||"Unknown Company",p=u(r);return a.jsx("div",{className:"py-3 border-b border-gray-100 last:border-b-0 cursor-pointer hover:bg-gray-50 transition duration-150 px-2 -mx-2 rounded-md",onClick:()=>i&&o(`/group-manager/leads/${i}`),children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-gray-800",children:d}),a.jsx("p",{className:"text-xs text-gray-500",children:h})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"text-xs text-gray-400",children:p}),a.jsx("span",{className:`inline-block mt-1 text-xs font-medium ${l} ${c} px-2 py-0.5 rounded-full`,children:s||"Website"})]})]})})},cWe=({name:e,amount:t,account:n,stage:s,created_at:r,id:i,previousAmount:o,currencySymbol:l})=>{const c=kt(),d={PROSPECTING:"Prospecting",QUALIFICATION:"Qualification",PROPOSAL:"Proposal",NEGOTIATION:"Negotiation",CLOSED_WON:"Closed Won",CLOSED_LOST:"Closed Lost"}[s]||s||"Unknown",{text:h,bg:p}=JGe(d),x=parseFloat(t||0),v=o?x>=o?"up":"down":"up",j=v==="up"?FGe:UGe,y=v==="up"?"text-green-400":"text-red-400",N=n?.name||"Unknown Company";return a.jsx("div",{className:"py-3 border-b border-gray-100 last:border-b-0 cursor-pointer hover:bg-gray-50 transition duration-150 px-2 -mx-2 rounded-md",onClick:()=>i&&c(`/group-manager/deals/info?id=${i}`),children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{className:"flex-shrink",children:[a.jsx("p",{className:"font-semibold text-sm text-gray-900",children:e||"Unnamed Deal"}),a.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:N}),a.jsx("span",{className:`inline-block mt-1 text-xs font-medium ${h} ${p} px-2 py-0.5 rounded-full`,children:d})]}),a.jsxs("div",{className:"text-right flex flex-col items-end flex-shrink-0",children:[a.jsx("p",{className:"text-md font-bold text-gray-800",children:See(x,l)}),a.jsx(j,{size:16,className:`${y} mt-1`})]})]})})},dWe=({type:e,title:t,assignedTo:n,dueDate:s,scheduledDate:r,priority:i,id:o,activityType:l,fullData:c})=>{const u=kt(),h=l||{Call:"call",Meeting:"meeting",Task:"qualification"}[e]||"meeting",{Icon:p,color:x,bgColor:v}=tWe(h),{text:j,bg:y}=aWe(i||"MEDIUM"),S=(T=>{if(!T)return"No date set";const A=new Date(T),M=A-new Date,z=Math.floor(M/864e5);return z===0?`Today, ${A.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}`:z===1?`Tomorrow, ${A.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}`:z===-1?`Yesterday, ${A.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}`:A.toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})})(s||r),_=n||"Unassigned",k=()=>{o&&(c?h==="call"?(sessionStorage.setItem("callDetailData",JSON.stringify(c)),u(`/group-manager/calls/info?id=${o}`)):h==="meeting"?(sessionStorage.setItem("meetingDetailData",JSON.stringify(c)),u(`/group-manager/meetings/info?id=${o}`)):u("/group-manager/tasks"):u(h==="call"?`/group-manager/calls/info?id=${o}`:h==="meeting"?`/group-manager/meetings/info?id=${o}`:"/group-manager/tasks"))};return a.jsxs("div",{className:"flex items-start py-3 border-b border-gray-100 last:border-b-0 cursor-pointer hover:bg-gray-50 transition duration-150 px-2 -mx-2 rounded-md",onClick:k,children:[a.jsx("div",{className:`p-2 rounded-lg ${v} mr-3 flex-shrink-0 mt-1`,children:a.jsx(p,{size:20,className:`${x}`})}),a.jsxs("div",{className:"flex-grow",children:[a.jsxs("p",{className:"font-medium text-gray-800 flex items-center mb-1",children:[a.jsx("span",{className:"text-xl leading-none mr-2",children:""}),t||"Untitled Activity"]}),a.jsxs("div",{className:"space-y-1 text-xs text-gray-500",children:[a.jsxs("p",{className:"flex items-center",children:[a.jsx(vee,{size:14,className:"mr-1.5 text-gray-400"}),S]}),a.jsxs("p",{className:"flex items-center",children:[a.jsx(jee,{size:14,className:"mr-1.5 text-gray-400"}),"Assigned to: ",_]})]})]}),a.jsx("span",{className:`inline-block text-xs font-medium ${j} ${y} px-2 py-0.5 rounded-full flex-shrink-0 self-center ml-4`,children:(i||"MEDIUM").toUpperCase()})]})},uWe=()=>{const e=kt(),{user:t}=Vt(),n=t?.company?.currency||"",[s,r]=f.useState({activeLeads:0,totalDeals:0,activeAccounts:0,overdueTasks:0}),[i,o]=f.useState([]),[l,c]=f.useState([]),[u,d]=f.useState([]),[h,p]=f.useState([]),[x,v]=f.useState([]),[j,y]=f.useState([]),[N,w]=f.useState(!0),[S,_]=f.useState(null),[k,T]=f.useState(""),[A,E]=f.useState([]),[M,z]=f.useState([]),[P,D]=f.useState([]),[U,B]=f.useState([]),[R,q]=f.useState(0),[Z,V]=f.useState(new Date),oe=f.useRef(null),je=f.useRef(null),X=f.useMemo(()=>{try{if(!k.trim())return[];const fe=k.toLowerCase().trim(),we=[];return Array.isArray(A)&&A.forEach(de=>{const ke=`${de.first_name||""} ${de.last_name||""}`.trim().toLowerCase(),ge=(de.company_name||"").toLowerCase(),$e=(de.email||"").toLowerCase(),be=(de.phone||"").toLowerCase();(ke.includes(fe)||ge.includes(fe)||$e.includes(fe)||be.includes(fe))&&we.push({id:de.id,name:`${de.first_name||""} ${de.last_name||""}`.trim()||"Unnamed Lead",type:"Lead",details:de.company_name||"No company",route:`/group-manager/leads/${de.id}`})}),Array.isArray(M)&&M.forEach(de=>{const ke=(de.name||"").toLowerCase(),ge=(de.account?.name||"").toLowerCase(),$e=(de.description||"").toLowerCase();(ke.includes(fe)||ge.includes(fe)||$e.includes(fe))&&we.push({id:de.id,name:de.name||"Unnamed Deal",type:"Deal",details:de.account?.name||"No account",route:`/group-manager/deals/info?id=${de.id}`})}),Array.isArray(P)&&P.forEach(de=>{const ke=(de.name||"").toLowerCase(),ge=(de.email||"").toLowerCase(),$e=(de.phone||"").toLowerCase(),be=(de.website||"").toLowerCase();(ke.includes(fe)||ge.includes(fe)||$e.includes(fe)||be.includes(fe))&&we.push({id:de.id,name:de.name||"Unnamed Account",type:"Account",details:de.email||de.phone||"No contact info",route:"/group-manager/accounts"})}),we.slice(0,10)}catch(fe){return console.error("Error in search:",fe),[]}},[k,A,M,P]),se=fe=>{fe.route&&(e(fe.route),T(""))},ye=f.useCallback(async()=>{w(!0),_(null);try{const[fe,we,de,ke,ge,$e,be,me]=await Promise.all([re.get("/leads/admin/getLeads").catch(he=>(console.error("Error fetching leads:",he),{data:[]})),re.get("/deals/admin/fetch-all").catch(he=>(console.error("Error fetching deals:",he),{data:[]})),re.get("/accounts/admin/fetch-all").catch(he=>(console.error("Error fetching accounts:",he),{data:[]})),re.get("/tasks/all").catch(he=>(console.error("Error fetching tasks:",he),{data:[]})),re.get("/meetings/admin/fetch-all").catch(he=>(console.error("Error fetching meetings:",he),{data:[]})),re.get("/calls/admin/fetch-all").catch(he=>(console.error("Error fetching calls:",he),{data:[]})),re.get("/logs/read-all").catch(he=>(console.error("Error fetching logs:",he),{data:[]})),re.get("/targets/admin/fetch-all").catch(he=>(console.error("Error fetching targets:",he),{data:[]}))]),Ue=Array.isArray(fe.data)?fe.data:[],Ee=Array.isArray(we.data)?we.data:[],We=Array.isArray(de.data)?de.data:[],tt=Array.isArray(ke.data)?ke.data:[],lt=Array.isArray(ge.data)?ge.data:[],Fe=Array.isArray($e.data)?$e.data:[],st=Array.isArray(be.data)?be.data:[],Xe=Array.isArray(me.data)?me.data:[];console.log("=== RAW DEALS API RESPONSE ==="),console.log("Deals count:",Ee.length),Ee.length>0&&(console.log("First deal sample (raw):",JSON.stringify(Ee[0],null,2)),console.log("First deal keys:",Object.keys(Ee[0]))),E(Ue),z(Ee),D(We),B(Xe);const Ze=Xe.reduce((he,He)=>{const qe=He.amount||He.value||He.target_amount||0,nt=parseFloat(typeof qe=="string"?qe.replace(/[^\d.-]/g,""):qe);return he+(Number.isFinite(nt)?nt:0)},0);q(Ze);const Je=Ue.filter(he=>he.status&&!["Lost","Converted"].includes(he.status)).length,Be=tt.filter(he=>!he.dueDate||he.status==="Completed"?!1:new Date(he.dueDate)<new Date).length;r({activeLeads:Je,totalDeals:Ee.length,activeAccounts:We.length,overdueTasks:Be});const _e=[...Ue].sort((he,He)=>new Date(He.created_at||0)-new Date(he.created_at||0)).slice(0,5);o(_e);const pe=[...Ee].sort((he,He)=>new Date(He.created_at||0)-new Date(he.created_at||0)).slice(0,5);c(pe);const ce=new Date,Q=[];Fe.forEach(he=>{const He=he.due_date||he.call_time,qe=(he.status||"").toUpperCase();if(He){const nt=new Date(He);qe==="COMPLETED"||qe==="MISSED"||qe==="NOT_HELD"||qe==="HELD"||Q.push({type:"Call",title:he.subject||"Untitled Call",assignedTo:he.assigned_to||(he.call_assign_to?`${he.call_assign_to.first_name||""} ${he.call_assign_to.last_name||""}`.trim():"Unassigned"),scheduledDate:He,priority:(he.priority||"MEDIUM").toUpperCase(),id:he.id,activityType:"call",fullData:he})}}),lt.forEach(he=>{const He=he.dueDate||he.start_time,qe=(he.status||"").toUpperCase();if(He){const nt=new Date(He);qe==="COMPLETED"||qe==="CANCELLED"||qe==="DONE"||Q.push({type:"Meeting",title:he.subject||he.activity||"Untitled Meeting",assignedTo:he.assignedTo||(he.meet_assign_to?`${he.meet_assign_to.first_name||""} ${he.meet_assign_to.last_name||""}`.trim():"Unassigned"),scheduledDate:He,priority:(he.priority||"MEDIUM").toUpperCase(),id:he.id,activityType:"meeting",fullData:he})}});const ne={HIGH:1,MEDIUM:2,LOW:3},ae=Q.sort((he,He)=>{const qe=ne[he.priority]||3,nt=ne[He.priority]||3;if(qe!==nt)return qe-nt;const ot=new Date(he.scheduledDate||0),Re=new Date(He.scheduledDate||0);return ot-Re}).slice(0,5);d(ae),p(Ee),console.log("=== ALL DEALS DATA ==="),console.log("Total deals:",Ee.length);const Pe=Ee.filter(he=>(he.stage||"").toUpperCase()==="CLOSED_WON");console.log("CLOSED_WON deals:",Pe.length),Pe.length>0?(console.log("=== CLOSED_WON DEALS DETAILS ==="),Pe.forEach((he,He)=>{let qe=he.amount;qe&&typeof qe=="object"?qe.toString?qe=parseFloat(qe.toString()):qe=parseFloat(qe):qe=parseFloat(qe)||0,console.log(`Deal ${He+1}:`,{id:he.id,name:he.name,stage:he.stage,stage_upper:(he.stage||"").toUpperCase(),amount:he.amount,amount_parsed:qe,amount_type:typeof he.amount,close_date:he.close_date,close_date_type:typeof he.close_date,close_date_value:he.close_date?new Date(he.close_date):null,has_close_date:!!he.close_date,has_amount:qe>0,all_keys:Object.keys(he),full_deal:he})})):(console.log(" No CLOSED_WON deals found!"),console.log("All deal stages:",Ee.map(he=>he.stage))),y(Ee);const Te=[...st].sort((he,He)=>new Date(He.timestamp||0)-new Date(he.timestamp||0));v(Te)}catch(fe){console.error("Error fetching dashboard data:",fe),_("Failed to load dashboard data. Please refresh the page.")}finally{w(!1)}},[]);f.useEffect(()=>(document.title="Dashboard | Sari-Sari CRM",console.log("TManagerDashboard mounted, fetching data..."),ye(),oe.current=setInterval(()=>{console.log("Auto-refreshing dashboard data..."),ye(),V(new Date)},3e4),()=>{oe.current&&clearInterval(oe.current)}),[ye]),f.useEffect(()=>{if(!t||!t.id)return;let fe=0;const we=3;let de=null;const ke=()=>{const ge=window.location.protocol==="https:"?"wss:":"ws:",$e=window.location.hostname==="localhost"?"localhost:8000":window.location.host,be=`${ge}//${$e}/ws/notifications?user_id=${t.id}`;try{const me=new WebSocket(be);je.current=me,me.onopen=()=>{console.log(" WebSocket connected for dashboard updates"),fe=0},me.onmessage=Ue=>{try{const Ee=JSON.parse(Ue.data);console.log(" Real-time notification received:",Ee),Ee.event&&["new_task","task_updated","new_lead","lead_updated","new_deal","deal_updated","new_account","account_updated","new_meeting","meeting_updated","new_call","call_updated"].includes(Ee.event)&&(console.log(" Refreshing dashboard due to:",Ee.event),ye(),V(new Date))}catch(Ee){console.error("Error parsing WebSocket message:",Ee)}},me.onerror=Ue=>{fe===0&&console.warn(" WebSocket connection unavailable (this is optional)")},me.onclose=()=>{fe<we&&(fe++,de=setTimeout(()=>{t&&t.id&&ke()},5e3))}}catch{console.warn(" WebSocket not available (optional feature)")}};return ke(),()=>{de&&clearTimeout(de),je.current&&(je.current.close(),je.current=null)}},[t,ye]);const Ne=[{icon:GGe,title:"Active Leads",value:s.activeLeads,color:"text-blue-600",bgColor:"bg-blue-50",onClick:()=>e("/group-manager/leads")},{icon:Cee,title:"Total Targets",value:See(R,n),color:"text-purple-600",bgColor:"bg-purple-50",onClick:()=>e("/group-manager/targets")},{icon:Nee,title:"Total Deals",value:s.totalDeals,color:"text-yellow-600",bgColor:"bg-yellow-50",onClick:()=>e("/group-manager/deals")},{icon:vee,title:"Overdue Tasks",value:s.overdueTasks,color:"text-red-600",bgColor:"bg-red-50",onClick:()=>e("/group-manager/tasks")}];return console.log("TManagerDashboard rendering, loading:",N,"error:",S),a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative w-full",children:[N&&a.jsx(Wt,{}),a.jsxs("div",{className:"max-w-screen-2xl mx-auto",children:[S&&a.jsx("div",{className:"mb-6 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:a.jsx("p",{className:"font-medium",children:S})}),a.jsx("div",{className:"mb-8",children:a.jsx(nWe,{searchQuery:k,onSearchChange:T,searchResults:X,onSearchResultClick:se})}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-4 mb-8",children:Ne.map(fe=>a.jsx(iWe,{...fe,loading:N},fe.title))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[a.jsx(rWe,{logs:x,loading:N}),a.jsx(pP,{currencySymbol:n})]}),a.jsx("div",{className:"mb-8",children:a.jsx(LN,{leads:A,deals:M,targets:U,currencySymbol:n,basePath:"/group-manager"})}),a.jsx("div",{className:"grid grid-cols-1 mb-8",children:a.jsx(oWe,{revenueData:j,loading:N})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[a.jsx(_T,{title:"Latest Leads",children:i.length>0?i.map((fe,we)=>a.jsx(lWe,{...fe},fe.id||we)):a.jsx("div",{className:"text-sm text-gray-500 py-4 text-center",children:"No leads found"})}),a.jsx(_T,{title:"Latest Deals",children:N?a.jsxs("div",{className:"flex flex-col items-center justify-center py-8",children:[a.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-500 mb-2"}),a.jsx("div",{className:"text-sm text-gray-500",children:"Loading deals..."})]}):l.length>0?l.map((fe,we)=>a.jsx(cWe,{...fe,currencySymbol:n},fe.id||we)):a.jsx("div",{className:"text-sm text-gray-500 py-4 text-center",children:"No deals found"})}),a.jsx(_T,{title:"Upcoming Activities",children:u.length>0?u.map((fe,we)=>a.jsx(dWe,{...fe},fe.id||we)):a.jsx("div",{className:"text-sm text-gray-500 py-4 text-center",children:"No upcoming activities"})})]})]})]})},AT=[{value:"CUSTOMER",label:"Customer"},{value:"PROSPECT",label:"Prospect"},{value:"PARTNER",label:"Partner"},{value:"ACTIVE",label:"Vendor"},{value:"INACTIVE",label:"Inactive"},{value:"FORMER",label:"Delete"}],Xb={name:"",website:"",phone_number:"",billing_address:"",shipping_address:"",industry:"",parent_company:"",status:"PROSPECT",territory_id:"",assigned_to:""},dr=e=>e?e.toUpperCase():"",TT=e=>e?e.toString().toLowerCase().replace(/\b\w/g,t=>t.toUpperCase()):"--",mWe=e=>{switch(dr(e)){case"CUSTOMER":return"bg-green-600 text-white";case"PROSPECT":return"bg-purple-600 text-white";case"PARTNER":return"bg-pink-600 text-white";case"ACTIVE":return"bg-blue-600 text-white";case"INACTIVE":return"bg-gray-600 text-white";case"FORMER":return"bg-orange-600 text-white";default:return"bg-gray-500 text-white"}},fWe=e=>{switch(dr(e)){case"CUSTOMER":return"bg-green-100 text-green-700";case"PROSPECT":return"bg-purple-100 text-purple-700";case"PARTNER":return"bg-pink-100 text-pink-700";case"ACTIVE":return"bg-blue-100 text-blue-700";case"INACTIVE":return"bg-gray-200 text-gray-700";case"FORMER":return"bg-orange-100 text-orange-700";default:return"bg-gray-100 text-gray-700"}};function hWe(){const e=kt(),t=ta(),{user:n}=Vt();f.useEffect(()=>{document.title="Accounts | Sari-Sari CRM"},[]);const[s,r]=f.useState(!1),[i,o]=f.useState(!1),[l,c]=f.useState(!1),[u,d]=f.useState(null),[h,p]=f.useState(null),[x,v]=f.useState(Xb),[j,y]=f.useState(null),[N,w]=f.useState([]),[S,_]=f.useState(!1),[k,T]=f.useState([]),[A,E]=f.useState(null),[M,z]=f.useState([]),[P,D]=f.useState([]),[U,B]=f.useState("Filter by Status"),[R,q]=f.useState(""),[Z,V]=f.useState(null),[oe,je]=f.useState(!1),[X,se]=f.useState(1),[ye,Ne]=f.useState(10),[fe,we]=f.useState("Overview"),[de,ke]=f.useState(""),[ge,$e]=f.useState(!1),[be,me]=f.useState({}),[Ue,Ee]=f.useState(null),[We,tt]=f.useState(new Set),[lt,Fe]=f.useState(!1),{comments:st,addComment:Xe,refresh:Ze}=kn({relatedType:"account",relatedId:j?.id});f.useEffect(()=>{j?.id&&Ze()},[j?.id,Ze]);const Je=f.useCallback(async(L=null)=>{_(!0);try{const ee=await re.get("/accounts/admin/fetch-all"),ze=[...Array.isArray(ee.data)?ee.data:[]].sort((Ve,ft)=>{const _t=Ve?.created_at||Ve?.updated_at||0,At=ft?.created_at||ft?.updated_at||0;return new Date(At)-new Date(_t)});if(w(ze),L){const Ve=ze.find(ft=>ft.id===L);y(Ve||null)}}catch(ee){console.error(ee),w([]),ee.response?.status===403?H.error("Permission denied. Only CEO, Admin, or Group Manager can access this page."):H.error("Failed to fetch accounts. Please try again later.")}finally{_(!1)}},[y]),Be=f.useCallback(async()=>{try{const L=await re.get("/users/all");T(Array.isArray(L.data)?L.data:[])}catch(L){console.error(L),L.response?.status===403&&H.warn("Unable to load users for assignment (permission denied).")}},[]),_e=f.useCallback(async()=>{try{const L=await re.get("/territories/fetch");z(Array.isArray(L.data)?L.data:[])}catch(L){console.error(L),L.response?.status===403&&H.warn("Unable to load territories (permission denied).")}},[]),pe=f.useCallback(async()=>{try{const L=await re.get("/accounts/admin/parent-companies");D(Array.isArray(L.data)?L.data:[])}catch(L){console.error(L),L.response?.status===403&&H.warn("Unable to load parent companies (permission denied).")}},[]),ce=f.useCallback(async L=>{try{const ee=await re.get(`/activities/accounts/${L}`);me(ee.data&&typeof ee.data=="object"?ee.data:{})}catch(ee){console.error(ee),ee.response?.status===404&&(console.warn("No activities found for this account."),me({}))}},[]);f.useEffect(()=>{Je(),Be(),_e(),pe()},[Je,Be,_e,pe]),f.useEffect(()=>{j&&ke(dr(j.status)||"PROSPECT")},[j]);const Q=N.length,ne=f.useMemo(()=>N.filter(L=>L.status?.toLowerCase()==="customer").length,[N]),ae=f.useMemo(()=>N.filter(L=>L.status?.toLowerCase()==="prospect").length,[N]),Pe=f.useMemo(()=>N.filter(L=>L.status?.toLowerCase()==="partner").length,[N]),Te=f.useMemo(()=>N.filter(L=>L.status?.toLowerCase()==="active").length,[N]),he=f.useMemo(()=>N.filter(L=>L.status?.toLowerCase()==="inactive").length,[N]),He=f.useMemo(()=>N.filter(L=>L.status?.toLowerCase()==="former").length,[N]),qe=f.useMemo(()=>[{title:"Total",value:Q,icon:Za,color:"text-slate-600",bgColor:"bg-slate-100"},{title:"Customers",value:ne,icon:Qi,color:"text-green-600",bgColor:"bg-green-100"},{title:"Prospects",value:ae,icon:Xa,color:"text-purple-600",bgColor:"bg-purple-100"},{title:"Partners",value:Pe,icon:ra,color:"text-pink-600",bgColor:"bg-pink-100"},{title:"Active",value:Te,icon:Qi,color:"text-blue-600",bgColor:"bg-blue-100"},{title:"Inactive",value:he,icon:Ki,color:"text-gray-600",bgColor:"bg-gray-100"},{title:"Former",value:He,icon:Ki,color:"text-orange-600",bgColor:"bg-orange-100"}],[Q,ne,ae,Pe,Te,he,He]),nt=f.useMemo(()=>{const L=R.trim().toLowerCase(),ee=U.trim().toUpperCase();return N.filter(Le=>{const ze=[Le?.name,Le?.website,Le?.industry,Le?.territory?.name,Le?.phone_number],Ve=L===""||ze.some(Qr=>Qr==null?!1:Qr.toString().toLowerCase().includes(L)),ft=ee==="FILTER BY STATUS"||dr(Le.status)===ee;let _t=!0;const At=n?.role?.toUpperCase();if(At!=="GROUP MANAGER"&&At!=="CEO"&&At!=="ADMIN"){const Qr=Le?.assigned_to?.id===n?.id||Le?.assigned_to===n?.id,j0=Le?.acc_creator?.id===n?.id;_t=Qr||j0}const En=dr(Le.status)==="INACTIVE"&&ee!=="INACTIVE";return Ve&&ft&&_t&&!En})},[N,R,U,n?.id]),ot=Math.max(1,Math.ceil(nt.length/ye)||1);f.useEffect(()=>{se(1)},[R,U,ye]),f.useEffect(()=>{se(L=>{const ee=Math.max(1,Math.ceil(nt.length/ye)||1);return L>ee?ee:L})},[nt.length,ye]);const Re=f.useMemo(()=>{const L=(X-1)*ye;return nt.slice(L,L+ye)},[nt,X,ye]);nt.length===0||(X-1)*ye+1,Math.min(X*ye,nt.length);const it=()=>se(L=>Math.max(L-1,1)),St=()=>se(L=>Math.min(L+1,ot)),Et=L=>{y(L),we("Overview"),ke(dr(L?.status)||"PROSPECT")},Tt=()=>y(null),Nt=L=>{L.target.id==="accountModalBackdrop"&&!oe&&Tt()},xe=()=>{r(!1),o(!1),p(null),v(Xb),c(!1),E(null)},ve=L=>{L.target.id==="modalBackdrop"&&xe()},Oe=L=>L?new Date(L).toLocaleString("en-US",{month:"short",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).replace(",",""):"",Ce=L=>{const{name:ee,value:Le}=L.target;v(ze=>({...ze,[ee]:Le}))},Qe=()=>{v(Xb),o(!1),p(null),r(!0)};f.useEffect(()=>{const L=new URLSearchParams(t.search||"");(t.state?.openAccountModal||L.get("openModal")==="1")&&(v(Xb),o(!1),p(null),r(!0),K(!1),e(t.pathname,{replace:!0,state:{}}))},[t.state,t.pathname,t.search,e]);const G=L=>{y(null),L.assigned_accs?E(L.assigned_accs):E(null),v({name:L.name||"",website:L.website||"",phone_number:L.phone_number||"",billing_address:L.billing_address||"",shipping_address:L.shipping_address||"",parent_company:L.parent_company||"",industry:L.industry||"",status:dr(L.status)||"PROSPECT",territory_id:L.territory?.id?String(L.territory.id):"",assigned_to:L.assigned_accs?.id?String(L.assigned_accs.id):""}),o(!0),p(L.id),r(!0)},W=L=>{L&&V({title:"Archive Account",message:a.jsxs("span",{children:["Are you sure you want to archive the account"," ",a.jsx("span",{className:"font-semibold",children:L.name}),"? You can restore it later if needed."]}),confirmLabel:"Archive Account",cancelLabel:"Cancel",variant:"archive",action:{type:"archive",targetId:L.id,name:L.name}})},J=L=>{const ee=Re.find(Le=>Le.id===L);ee&&ee.acc_creator?.id===n?.id&&tt(Le=>{const ze=new Set(Le);return ze.has(L)?ze.delete(L):ze.add(L),ze})},Y=()=>{const L=Re.filter(ee=>ee.acc_creator?.id===n?.id);We.size===L.length&&L.length>0?tt(new Set):tt(new Set(L.map(ee=>ee.id)))},F=()=>{if(We.size===0)return;const L=We.size;V({title:"Archive Accounts",message:a.jsxs("span",{children:["Are you sure you want to archive"," ",a.jsx("span",{className:"font-semibold",children:L})," account",L!==1?"s":"","? You can restore them later if needed."]}),confirmLabel:`Archive ${L} Account${L!==1?"s":""}`,cancelLabel:"Cancel",variant:"archive",action:{type:"bulk-archive",targetIds:Array.from(We),count:L}})},ue=async()=>{if(!Z?.action){V(null);return}const{action:L}=Z,{type:ee,payload:Le,targetId:ze,name:Ve,targetIds:ft,count:_t}=L;je(!0);try{if(ee==="create"){c(!0);const At=await re.post("/accounts/admin",Le);pe(),H.success(`Account "${Ve}" created successfully.`);const Yt=j?.id||null;xe(),await Je(Yt),!j&&At.data?.id}else if(ee==="update"){if(!ze)throw new Error("Missing account identifier for update.");c(!0),await re.put(`/accounts/admin/${ze}`,Le),H.success(`Account "${Ve}" updated successfully.`);const At=j?.id&&j.id===ze?ze:null;xe(),await Je(At),j?.id===ze&&y(null)}else if(ee==="archive"){if(!ze)throw new Error("Missing account identifier for archiving.");const At=j?.id;d(ze),await re.put(`/accounts/admin/${ze}`,{status:"INACTIVE"}),H.success(`Account "${Ve}" archived successfully.`),await Je(At&&At!==ze?At:null),At===ze&&y(null)}else if(ee==="bulk-archive"){if(!ft||ft.length===0)throw new Error("Missing account identifiers for bulk archiving.");Fe(!0),await Promise.all(ft.map(At=>re.put(`/accounts/admin/${At}`,{status:"INACTIVE"}))),H.success(`${_t} account${_t!==1?"s":""} archived successfully.`),tt(new Set),await Je(),y(null)}}catch(At){console.error(At);const Yt=ee==="create"?"Failed to create account. Please review the details and try again.":ee==="update"?"Failed to update account. Please review the details and try again.":ee==="bulk-archive"?"Failed to archive accounts. Please try again.":"Failed to archive account. Please try again.",En=At.response?.data?.detail||Yt;H.error(En),(ee==="create"||ee==="update")&&c(!1),ee==="archive"&&d(null),ee==="bulk-archive"&&Fe(!1)}finally{(ee==="create"||ee==="update")&&c(!1),ee==="archive"&&d(null),ee==="bulk-archive"&&Fe(!1),je(!1),V(null)}},De=()=>{oe||V(null)},le=async()=>{if(!j||!de)return;const L=dr(de),ee=dr(j.status);if(L!==ee){$e(!0);try{await re.put(`/accounts/admin/${j.id}`,{status:L}),H.success(`Account status updated to ${TT(L)}`),w(Le=>Le.map(ze=>ze.id===j.id?{...ze,status:L}:ze)),y(null)}catch(Le){console.error(Le);const ze=Le.response?.data?.detail||"Failed to update account status. Please try again.";H.error(ze)}finally{$e(!1)}}},[Ie,K]=f.useState(!1),ie=L=>{L.preventDefault(),K(!0);const ee=x.name.trim();if(!ee){H.error("Account name is required.");return}if(!x.assigned_to){H.error("Assigned To is required.");return}const ze={name:ee,website:x.website?.trim()||null,phone_number:x.phone_number?.trim()||null,billing_address:x.billing_address?.trim()||null,shipping_address:x.shipping_address?.trim()||null,industry:x.industry?.trim()||null,parent_company:x.parent_company?.trim()||null,status:x.status||"PROSPECT",territory_id:x.territory_id?Number(x.territory_id):null,assigned_to:x.assigned_to?Number(x.assigned_to):null},Ve=i&&h?"update":"create";V({title:Ve==="create"?"Confirm New Account":"Confirm Update",message:Ve==="create"?a.jsxs("span",{children:["Are you sure you want to create the account"," ",a.jsx("span",{className:"font-semibold",children:ee}),"?"]}):a.jsxs("span",{children:["Save changes to the account"," ",a.jsx("span",{className:"font-semibold",children:ee}),"?"]}),confirmLabel:Ve==="create"?"Create Account":"Update Account",cancelLabel:"Cancel",variant:"primary",action:{type:Ve,payload:ze,targetId:h||null,name:ee}})},Me=[{label:"Filter by Status",value:"Filter by Status"},...AT.map(L=>({label:L.label,value:L.value}))],Ke=Z?.action?.type==="delete"?Z.action.targetId:null,gt=j&&(u===j.id||Ke===j.id),Ct=j&&u===j.id,Ht=j?mWe(j.status):"",da=j?a.jsx("div",{id:"accountModalBackdrop",onClick:Nt,className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-6xl max-h-[92vh] overflow-y-auto hide-scrollbar animate-scale-in font-inter relative",onClick:L=>L.stopPropagation(),children:[a.jsxs("div",{className:"bg-tertiary w-full rounded-t-xl flex items-center justify-between p-3 lg:p-3",children:[a.jsx("h1",{className:"lg:text-3xl text-xl text-white font-semibold text-center w-full",children:"Account"}),a.jsx("button",{onClick:Tt,className:"text-gray-400 hover:text-white cursor-pointer",children:a.jsx(Ja,{size:25})})]}),a.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between lg:flex-row lg:items-center lg:justify-between mt-3 gap-2 px-2 md:items-center lg:gap-4 md:mx-7 lg:mx-7",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[a.jsx("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-800",children:j.name}),a.jsx("span",{className:`text-xs sm:text-sm font-medium px-2 sm:px-3 py-1 rounded-full whitespace-nowrap ${Ht}`,children:TT(j.status)})]}),n?.id===j?.acc_creator?.id&&a.jsxs("div",{className:"flex flex-col sm:flex-row sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsxs("button",{className:"inline-flex items-center justify-center w-full sm:w-auto bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 disabled:opacity-70 transition text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",onClick:()=>G(j),disabled:Z?.action?.type==="update"&&Z.action.targetId===j.id,children:[a.jsx(gn,{className:"mr-2"}),"Edit"]}),a.jsx("button",{className:"inline-flex items-center justify-center w-full sm:w-auto px-4 py-2 rounded-md text-sm bg-orange-500 text-white hover:bg-orange-600 transition focus:outline-none focus:ring-2 focus:ring-orange-400",onClick:()=>W(j),disabled:!!gt,children:Ct?"Archiving...":a.jsxs(a.Fragment,{children:[a.jsx(Zt,{className:"mr-2"}),"Archive"]})})]})]}),a.jsx("div",{className:"border-b border-gray-200 my-5"}),a.jsxs("div",{className:"p-6 lg:p-4",children:[a.jsx("div",{className:"flex w-full bg-[#6A727D] text-white mt-1 overflow-x-auto mb-6",children:["Overview","Activities"].map(L=>a.jsx("button",{onClick:()=>we(L),className:`flex-1 min-w-[90px] px-4 py-2.5 text-xs sm:text-sm font-medium text-center transition-all duration-200 border-b-2
        ${fe===L?"bg-paper-white text-[#6A727D] border-white":"text-white hover:bg-[#5c636d]"}`,children:L},L))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 items-start",children:[a.jsxs("div",{className:"lg:col-span-3",children:[fe==="Overview"&&a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 md:p-8 border border-gray-200",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4 sm:gap-6 text-sm text-gray-700",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Website:"}),a.jsx("p",{children:j.website?a.jsx("a",{href:j.website,className:"text-blue-600 hover:underline break-all",target:"_blank",rel:"noopener noreferrer",children:j.website}):"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Industry:"}),a.jsx("p",{children:j.industry||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Parent Company:"}),a.jsx("p",{children:j.parent_company||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Territory:"}),a.jsx("p",{children:j.territory?.name||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Phone Number:"}),a.jsx("p",{children:j.phone_number||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Billing Address:"}),a.jsx("p",{children:j.billing_address||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Shipping Address:"}),a.jsx("p",{children:j.shipping_address||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Assigned To:"}),a.jsx("p",{children:j.assigned_accs?`${j.assigned_accs.first_name} ${j.assigned_accs.last_name}`:"Unassigned"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created By:"}),a.jsx("p",{children:j.acc_creator?`${j.acc_creator.first_name} ${j.acc_creator.last_name}`:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created At:"}),a.jsx("p",{children:Oe(j.created_at)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Last Updated:"}),a.jsx("p",{children:Oe(j.updated_at)||"N/A"})]})]}),a.jsx(Tn,{comments:st,onAddComment:Xe})]}),fe==="Notes"&&a.jsxs("div",{className:"mt-4 w-full",children:[a.jsx("div",{className:"flex flex-wrap items-center justify-between mb-4 gap-2",children:a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words",children:"Account Note"})}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 shadow-sm break-words",children:[a.jsx("div",{className:"flex items-start justify-between",children:a.jsx("div",{children:a.jsx("p",{className:"text-sm font-medium text-gray-800 break-words",children:"Note"})})}),a.jsx("div",{className:"mt-3 text-sm text-gray-700 whitespace-pre-wrap break-words",children:N.notes||"No notes available."})]})]}),fe==="Activities"&&a.jsxs("div",{className:"space-y-2 w-full h-full max-h-[50dvh] overflow-y-auto bg-gray-50 p-2 hide-scrollbar rounded-lg border border-gray-200 shadow-sm",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words border-b border-gray-300 py-2",children:"Related Activities"}),a.jsxs("div",{className:"space-y-2 text-sm",children:[be.tasks&&be.tasks.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>Ee(Ue==="tasks"?null:"tasks"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Qt,{className:"text-blue-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Tasks (",be.tasks.length,")"]})]}),Ue==="tasks"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Ue==="tasks"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:be.tasks.map((L,ee)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/group-manager/tasks",{state:{taskID:L.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-blue-600 mt-1",children:a.jsx(Qt,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:L.subject||L.title||"Task"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:L.description||"No description"}),L.assigned_to&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Assigned: ",L.assigned_to.first_name," ",L.assigned_to.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:Oe(L.due_date||L.created_at)})]},`task-${ee}`))})]}),be.meetings&&be.meetings.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>Ee(Ue==="meetings"?null:"meetings"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ot,{className:"text-green-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Meetings (",be.meetings.length,")"]})]}),Ue==="meetings"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Ue==="meetings"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:be.meetings.map((L,ee)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/group-manager/meetings",{state:{meetingID:L.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-green-600 mt-1",children:a.jsx(Ot,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:L.subject||L.title||"Meeting"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:L.description||L.location||"No description"}),L.host&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Host: ",L.host.first_name," ",L.host.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:Oe(L.start_time||L.created_at)})]},`meeting-${ee}`))})]}),be.calls&&be.calls.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>Ee(Ue==="calls"?null:"calls"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(It,{className:"text-purple-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Calls (",be.calls.length,")"]})]}),Ue==="calls"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Ue==="calls"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:be.calls.map((L,ee)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/group-manager/calls",{state:{callID:L.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-purple-600 mt-1",children:a.jsx(It,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:L.subject||L.title||"Call"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:L.direction||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:Oe(L.call_time||L.created_at)})]},`call-${ee}`))})]}),be.contacts&&be.contacts.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>Ee(Ue==="contacts"?null:"contacts"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ra,{className:"text-teal-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Contacts (",be.contacts.length,")"]})]}),Ue==="contacts"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Ue==="contacts"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:be.contacts.map((L,ee)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/group-manager/contacts",{state:{contactID:L.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-teal-600 mt-1",children:a.jsx(ra,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("h4",{className:"font-medium text-blue-600 break-words text-sm",children:[L.first_name?`${L.first_name} `:"",L.last_name]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:L.title||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:Oe(L.created_at)})]},`contact-${ee}`))})]}),be.deals&&be.deals.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>Ee(Ue==="deals"?null:"deals"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(sa,{className:"text-indigo-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Deals (",be.deals.length,")"]})]}),Ue==="deals"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Ue==="deals"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:be.deals.map((L,ee)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/group-manager/deals",{state:{dealID:L.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-indigo-600 mt-1",children:a.jsx(sa,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("h4",{className:"font-medium text-blue-600 break-words text-sm",children:[L.deal_id?L.deal_id.replace(/D(\d+)-\d+-/,"D$1-"):"--"," ",L.name||L.title||"Deal"]}),a.jsx("p",{className:"text-xs text-gray-500 break-words capitalize",children:L.stage||L.description||"No description"})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:Oe(L.close_date||L.created_at)})]},`deal-${ee}`))})]}),be.quotes&&be.quotes.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>Ee(Ue==="quotes"?null:"quotes"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ia,{className:"text-orange-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Quotes (",be.quotes.length,")"]})]}),Ue==="quotes"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),Ue==="quotes"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:be.quotes.map((L,ee)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/group-manager/quotes",{state:{quoteID:L.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-orange-600 mt-1",children:a.jsx(ia,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:(L.quote_id?L.quote_id.replace(/Q(\d+)-\d+-/,"Q$1-"):"--")||"Quote"}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:L.status||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:Oe(L.presented_date)||""})]},`quote-${ee}`))})]}),(!be||(!be.tasks||be.tasks.length===0)&&(!be.meetings||be.meetings.length===0)&&(!be.calls||be.calls.length===0)&&(!be.quotes||be.quotes.length===0)&&(!be.deals||be.deals.length===0)&&(!be.contacts||be.contacts.length===0))&&a.jsx("div",{className:"text-center py-8 text-gray-500",children:a.jsx("p",{children:"No related activities found for this account."})})]})]})]}),a.jsxs("div",{className:"flex flex-col gap-4",children:[a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Quick Actions"}),a.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[a.jsxs("button",{onClick:()=>e("/group-manager/calls",{state:{openCallModal:!0,initialCallData:{subject:`Call with ${j.name}`,relatedType1:"Account",relatedTo1:String(j.id),relatedType2:null,relatedTo2:null,assigned_to:j.assigned_accs?.id?String(j.assigned_accs.id):"",direction:"Outgoing",status:"Planned"}}}),className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(It,{className:"text-gray-600 w-4 h-4"}),"Schedule Call"]}),a.jsxs("button",{className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",onClick:()=>e("/group-manager/meetings",{state:{openMeetingModal:!0,initialMeetingData:{subject:`Meeting with ${j.name}`,relatedType1:"Account",relatedTo1:String(j.id),relatedType2:null,relatedTo2:null,assignedTo:j.assigned_accs?.id?String(j.assigned_accs.id):"",status:"Planned"}}}),children:[a.jsx(Ot,{className:"text-gray-600 w-4 h-4"}),"Book Meeting"]}),a.jsxs("button",{onClick:()=>e("/group-manager/tasks",{state:{openTaskModal:!0,initialTaskData:{subject:`Follow up with ${j.name}`,relatedType1:"Account",relatedTo1:String(j.id),relatedType2:null,relatedTo2:null,assignedTo:j.assigned_accs?.id?String(j.assigned_accs.id):"",priority:"NORMAL",status:"Not Started"}}}),className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(Qt,{className:"text-gray-600 w-4 h-4"}),"Tasks"]})]})]}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm w-full",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Status"}),a.jsx("select",{className:"border border-gray-200 rounded-md px-2 sm:px-3 py-1.5 w-full text-sm mb-2 focus:ring-2 focus:ring-indigo-500 outline-none",value:de||dr(j?.status)||"PROSPECT",onChange:L=>ke(L.target.value),children:AT.map(L=>a.jsx("option",{value:L.value,children:L.label},L.value))}),a.jsx("button",{onClick:le,disabled:ge||!de||dr(de)===dr(j?.status),className:`w-full py-1.5 rounded-md text-sm transition focus:outline-none focus:ring-2 ${ge||!de||dr(de)===dr(j?.status)?"bg-gray-400 cursor-not-allowed text-white":"bg-gray-900 text-white hover:bg-gray-800 focus:ring-gray-400"}`,children:ge?"Updating...":"Update"})]})]})]})]})]})}):null,Ge=a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[S&&a.jsx(Wt,{message:"Loading accounts..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h2",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(Za,{className:"mr-2 text-blue-600"}),"Accounts Management"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{onClick:()=>{Qe(),K(!1)},className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 my-1 lg:my-0 rounded-md hover:bg-gray-800 text-sm sm:text-base mx-auto sm:ml-auto cursor-pointer",children:[a.jsx(aa,{className:"mr-2"})," Add Account"]})})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4 mb-6 w-full break-words overflow-hidden lg:overflow-visible",children:qe.map(L=>a.jsx(gWe,{...L},L.title))}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search accounts",value:R,onChange:L=>q(L.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsx("div",{className:"w-full lg:w-1/4",children:a.jsx("select",{value:U,onChange:L=>B(L.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:Me.map(L=>a.jsx("option",{value:L.value,children:L.label},L.value))})})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[500px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 text-sm tracking-wide font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 w-12",children:a.jsx("input",{type:"checkbox",checked:We.size>0&&We.size===Re.filter(L=>L.acc_creator?.id===n?.id).length&&Re.filter(L=>L.acc_creator?.id===n?.id).length>0,onChange:Y,className:"w-4 h-4 cursor-pointer rounded border-gray-300",title:Re.some(L=>L.acc_creator?.id===n?.id)?We.size===Re.filter(L=>L.acc_creator?.id===n?.id).length?"Deselect all":"Select all":"No accounts to select"})}),a.jsx("th",{className:"py-3 px-4 truncate",children:"Account"}),a.jsx("th",{className:"py-3 px-4",children:"Status"}),a.jsx("th",{className:"py-3 px-4",children:"Industry"}),a.jsx("th",{className:"py-3 px-4",children:"Territory"}),a.jsx("th",{className:"py-3 px-4",children:"Phone"}),a.jsx("th",{className:"py-3 px-4 w-12",children:We.size>0&&a.jsx("button",{onClick:F,disabled:lt,title:`Archive ${We.size} account${We.size!==1?"s":""}`,className:"text-orange-500 hover:text-orange-700 disabled:opacity-50 transition",children:a.jsx(Zt,{size:18})})})]})}),a.jsx("tbody",{children:S?a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:7,children:"Loading accounts..."})}):nt.length>0?Re.map(L=>a.jsxs("tr",{className:"hover:bg-gray-50 text-xs cursor-pointer",children:[a.jsx("td",{className:"py-3 px-4",children:L.acc_creator?.id===n?.id?a.jsx("input",{type:"checkbox",checked:We.has(L.id),onChange:ee=>{ee.stopPropagation(),J(L.id)},className:"w-4 h-4 cursor-pointer rounded border-gray-300"}):null}),a.jsx("td",{className:"py-3 px-4",onClick:()=>{Et(L),ce(L.id)},children:a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-blue-600 hover:underline break-all text-sm",children:L.name}),a.jsx("div",{className:"text-gray-500 text-xs break-all",children:L.website||"--"})]})}),a.jsx("td",{className:"py-3 px-4",onClick:()=>{Et(L),ce(L.id)},children:a.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${fWe(L.status)}`,children:TT(L.status)})}),a.jsx("td",{className:"py-3 px-4 text-sm",onClick:()=>{Et(L),ce(L.id)},children:L.industry||"--"}),a.jsx("td",{className:"py-3 px-4 text-sm",onClick:()=>{Et(L),ce(L.id)},children:L.territory?.name||"--"}),a.jsx("td",{className:"py-3 px-4",onClick:()=>{Et(L),ce(L.id)},children:a.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[a.jsx(It,{className:"text-gray-500"}),a.jsx("span",{children:L.phone_number||"--"})]})})]},L.id)):a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:7,children:"No accounts found."})})})]})}),a.jsx(ca,{className:"mt-4",totalItems:nt.length,pageSize:ye,currentPage:X,onPrev:it,onNext:St,onPageSizeChange:Ne,label:"accounts"})]}),Ae=s?a.jsx("div",{id:"modalBackdrop",onClick:ve,className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-full sm:max-w-3xl rounded-2xl shadow-lg p-4 sm:p-6 md:p-8 relative border border-gray-200 overflow-y-auto hide-scrollbar max-h-[90vh]",onClick:L=>L.stopPropagation(),children:[a.jsx("button",{onClick:()=>{xe(),K(!1)},className:"absolute top-4 right-4 text-gray-500 hover:text-black transition",disabled:l||oe,children:a.jsx(ea,{size:22})}),a.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800 mb-4 sm:mb-6 flex items-center justify-center",children:i?"Edit Account":"Add New Account"}),a.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",onSubmit:ie,noValidate:!0,children:[a.jsx("div",{className:"md:col-span-2",children:a.jsx(of,{label:"Name",name:"name",value:x.name,onChange:Ce,placeholder:"Company name",required:!0,isSubmitted:Ie})}),a.jsx(nH,{label:"Parent Company",value:x.parent_company,onChange:L=>{v(ee=>({...ee,parent_company:L}))},items:P.map(L=>({id:L,name:L})),getLabel:L=>L?.name||"",placeholder:"Select parent company...",disabled:l}),a.jsx(of,{label:"Website",name:"website",value:x.website,onChange:Ce,placeholder:"https://example.com",disabled:l}),a.jsx(of,{label:"Phone Number",name:"phone_number",value:x.phone_number,onChange:Ce,placeholder:"09xx xxx xxxx",type:"tel",disabled:l}),a.jsx(of,{label:"Industry",name:"industry",value:x.industry,onChange:Ce,placeholder:"Industry",disabled:l}),a.jsx(of,{label:"Billing Address",name:"billing_address",value:x.billing_address,onChange:Ce,placeholder:"Billing address",disabled:l}),a.jsx(of,{label:"Shipping Address",name:"shipping_address",value:x.shipping_address,onChange:Ce,placeholder:"Shipping address",disabled:l}),a.jsx(aH,{label:"Status",name:"status",value:x.status,onChange:Ce,options:[{value:"",label:"Select status"},...AT],required:!0,disabled:l}),a.jsx(nH,{label:"Assigned To",value:x.assigned_to,onChange:L=>{const ee=k.find(ze=>String(ze.id)===String(L));E(ee);let Le=null;ee&&ee.assigned_territory&&ee.assigned_territory.length===1&&(Le=ee.assigned_territory[0].id),v(ze=>({...ze,assigned_to:L,territory_id:Le}))},items:k||[],getLabel:L=>`${L?.first_name??""} ${L?.last_name??""} (${L?.role??""})`.trim(),placeholder:"Search assignee...",required:!0,isSubmitted:Ie,disabled:l||k.length===0}),a.jsx(aH,{label:"Territory",name:"territory_id",value:x.territory_id||"",onChange:Ce,options:[{value:"",label:A?A.assigned_territory&&A.assigned_territory.length>0?"Select Territory":"No territories assigned to this user":"Select a user first"},...A&&A.assigned_territory&&A.assigned_territory.map(L=>({value:String(L.id),label:L.name}))||[]],disabled:l||!A||!A.assigned_territory||A.assigned_territory.length===0}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-end sm:justify-end space-y-2 sm:space-y-0 sm:space-x-2 col-span-1 md:col-span-2 mt-4 w-full",children:[a.jsx("button",{type:"button",onClick:()=>{xe(),K(!1)},className:"w-full sm:w-auto px-4 py-2 text-white bg-red-400 border border-red-300 rounded hover:bg-red-500 transition disabled:opacity-70",disabled:l||oe,children:"Cancel"}),a.jsx("button",{type:"submit",className:"w-full sm:w-auto px-4 py-2 text-white border border-tertiary bg-tertiary rounded hover:bg-secondary transition disabled:opacity-70",disabled:l||oe,children:l?"Saving...":i?"Update Account":"Save Account"})]})]})]})}):null,I=Z?a.jsx(xWe,{open:!0,title:Z.title,message:Z.message,confirmLabel:Z.confirmLabel,cancelLabel:Z.cancelLabel,variant:Z.variant,onConfirm:ue,onCancel:De,loading:oe}):null;return a.jsxs(a.Fragment,{children:[Ge,da,Ae,I]})}function gWe({icon:e,title:t,value:n,color:s="text-blue-600",bgColor:r="bg-blue-100",onClick:i}){const o=()=>{typeof i=="function"?i():console.log(`Clicked: ${t}`)};return a.jsxs("div",{className:"flex items-center p-4 bg-white rounded-xl shadow-md border border-gray-200 transition-all duration-300",onClick:o,children:[a.jsx("div",{className:`flex-shrink-0 p-3 rounded-full ${r} ${s} mr-4`,children:e?a.jsx(e,{size:22}):null}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:t}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:n})]})]})}function of({label:e,name:t,value:n,onChange:s,placeholder:r,type:i="text",required:o=!1,disabled:l=!1,className:c="",isSubmitted:u=!1}){const d=u&&!n?.trim();return a.jsxs("div",{children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",o&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:i,name:t,value:n??"",onChange:s,placeholder:r,required:o,disabled:l,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border focus:ring-2
          ${d?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}
          ${c}
        `})]})}function aH({label:e,name:t,value:n,onChange:s,options:r,required:i=!1,disabled:o=!1}){return a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsx("select",{name:t,value:n??"",onChange:s,required:i,disabled:o,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100",children:r.map(l=>a.jsx("option",{value:l.value,children:l.label},l.value))})]})}function nH({label:e,items:t=[],value:n="",onChange:s,getLabel:r,placeholder:i="Search...",disabled:o=!1,className:l="",required:c=!1,isSubmitted:u=!1,allowFreeText:d=!1}){const h=u&&c&&!n;return a.jsxs("div",{className:l,children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",c&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx(pWe,{items:t,value:n??"",onChange:s,getLabel:r,placeholder:i,disabled:o,hasError:h,allowFreeText:d})]})}function pWe({items:e=[],value:t="",onChange:n,getLabel:s,placeholder:r="Search...",disabled:i=!1,maxRender:o=200,hasError:l=!1,allowFreeText:c=!1}){const[u,d]=f.useState(!1),[h,p]=f.useState(""),x=f.useRef(null),v=e.find(N=>String(N.id)===String(t)),j=v?s(v):t,y=f.useMemo(()=>{const N=h.trim().toLowerCase();return(N?e.filter(S=>(s(S)||"").toLowerCase().includes(N)):e).slice(0,o)},[e,h,s,o]);return f.useEffect(()=>{const N=w=>{x.current&&!x.current.contains(w.target)&&d(!1)};return document.addEventListener("mousedown",N),()=>document.removeEventListener("mousedown",N)},[]),f.useEffect(()=>{u||p("")},[u]),a.jsxs("div",{ref:x,className:"relative w-full",children:[a.jsx("input",{disabled:i,value:u?h:j,placeholder:r,onFocus:()=>!i&&d(!0),onChange:N=>{p(N.target.value),u||d(!0)},className:`w-full border rounded-md px-2 py-1.5 text-sm outline-none focus:ring-2
          ${l?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}`}),u&&!i&&a.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg overflow-hidden",children:[a.jsxs("div",{className:"max-h-56 overflow-y-auto hide-scrollbar",children:[c&&h.trim()&&!y.some(N=>s(N).toLowerCase()===h.trim().toLowerCase())&&a.jsxs("button",{type:"button",onClick:()=>{n(h.trim()),d(!1)},className:"w-full text-left px-3 py-2 text-sm hover:bg-green-50 bg-blue-50 font-medium text-blue-700",children:['+ Add "',h.trim(),'" as new parent company']}),y.length>0?y.map(N=>{const w=String(N.id),S=s(N),_=String(t)===w;return a.jsx("button",{type:"button",onClick:()=>{n(w),d(!1)},className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-50 ${_?"bg-blue-50":""}`,children:S||"--"},w)}):!c||!h.trim()?a.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No results"}):null]}),e.length>o&&a.jsxs("div",{className:"px-3 py-2 text-[11px] text-gray-400 border-t",children:["Showing first ",o," results  keep typing to narrow."]})]})]})}function xWe({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o=!1,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="archive"?"bg-orange-500 hover:bg-orange-600 border border-orange-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsx("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${u}`,disabled:o,children:o?"Processing...":s})]})]})})}const Zb={first_name:"",last_name:"",account_id:"",title:"",department:"",email:"",work_phone:"",mobile_phone_1:"",mobile_phone_2:"",notes:"",assigned_to:""},Nl=e=>[e?.first_name,e?.last_name].filter(Boolean).join(" ").trim(),vo=e=>e?new Date(e).toLocaleString("en-US",{month:"short",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).replace(",",""):"";function yWe(){const e=kt(),t=ta(),{user:n}=Vt();f.useEffect(()=>{document.title="Contacts | Sari-Sari CRM"},[]);const[s,r]=f.useState([]),[i,o]=f.useState(!1),[l,c]=f.useState([]),[u,d]=f.useState([]),[h,p]=f.useState(null),[x,v]=f.useState(!1),[j,y]=f.useState(!1),[N,w]=f.useState(!1),[S,_]=f.useState(null),[k,T]=f.useState(!1),[A,E]=f.useState(null),[M,z]=f.useState(Zb),[P,D]=f.useState(""),[U,B]=f.useState("Filter by Accounts"),[R,q]=f.useState(null),[Z,V]=f.useState("Overview"),[oe,je]=f.useState(1),[X,se]=f.useState(10),[ye,Ne]=f.useState({}),[fe,we]=f.useState(null),[de,ke]=f.useState(null),[ge,$e]=f.useState(new Set),[be,me]=f.useState(!1),{comments:Ue,addComment:Ee,refresh:We}=kn({relatedType:"contact",relatedId:h?.id});f.useEffect(()=>{h?.id&&We()},[h?.id,We]),f.useEffect(()=>{const F=t.state?.contactID;F&&(ke(F),e(t.pathname,{replace:!0,state:{}}))},[t,e]),f.useEffect(()=>{if(de&&s.length>0&&!i){const F=s.find(ue=>ue.id===de);F?p(F):H.error("Contact not found."),ke(null)}},[de,s,i]);const tt=f.useCallback(async(F=null)=>{o(!0);try{const ue=await re.get("/contacts/admin/fetch-all"),le=[...Array.isArray(ue.data)?ue.data:[]].sort((Ie,K)=>{const ie=Ie?.created_at||Ie?.updated_at||0,Me=K?.created_at||K?.updated_at||0;return new Date(Me)-new Date(ie)});if(r(le),F){const Ie=le.find(K=>K.id===F);p(Ie||null)}}catch(ue){console.error(ue),r([]),ue.response?.status===403?H.error("Permission denied. Only CEO, Admin, or Group Manager can access this page."):H.error("Failed to fetch contacts. Please try again later.")}finally{o(!1)}},[p]),lt=f.useCallback(async()=>{try{const F=await re.get("/accounts/admin/fetch-all"),De=[...Array.isArray(F.data)?F.data:[]].sort((le,Ie)=>(le?.name||"").localeCompare(Ie?.name||""));c(De)}catch(F){console.error(F),c([]),F.response?.status===403&&H.warn("Unable to load accounts (permission denied).")}},[]),Fe=f.useCallback(()=>{window.open("/group-manager/accounts?openModal=1","_blank","noopener,noreferrer")},[]),st=f.useCallback(async()=>{try{const F=await re.get("/users/all"),De=[...Array.isArray(F.data)?F.data:[]].sort((le,Ie)=>Nl(le).localeCompare(Nl(Ie)));d(De)}catch(F){console.error(F),d([]),F.response?.status===403&&H.warn("Unable to load users for assignment (permission denied).")}},[]),Xe=f.useCallback(async F=>{try{const ue=await re.get(`/activities/contact/${F}`);Ne(ue.data&&typeof ue.data=="object"?ue.data:{})}catch(ue){console.error(ue),ue.response?.status===404&&(console.warn("No activities found for this account."),Ne({}))}},[]);f.useEffect(()=>{tt(),lt(),st()},[tt,lt,st]);const Ze=f.useMemo(()=>{const F=new Map;l.forEach(De=>{De?.id&&De?.name&&F.set(String(De.id),De.name)}),s.forEach(De=>{De?.account_id&&De?.account?.name&&F.set(String(De.account_id),De.account.name)});const ue=Array.from(F.entries()).sort((De,le)=>De[1].localeCompare(le[1])).map(([De,le])=>({value:De,label:le}));return[{value:"Filter by Accounts",label:"Filter by Accounts"},...ue]},[l,s]),Je=f.useMemo(()=>{const F=P.trim().toLowerCase(),ue=U.trim();return s.filter(De=>{const le=[De?.first_name,De?.last_name,De?.email,De?.title,De?.department,De?.account?.name,De?.account?.status,De?.work_phone,De?.mobile_phone_1,De?.mobile_phone_2,De?.assigned_contact?.first_name,De?.assigned_contact?.last_name,De?.contact_creator?.first_name,De?.contact_creator?.last_name,De?.notes,vo(De?.created_at),vo(De?.updated_at)],Ie=F===""||le.some(gt=>gt==null?!1:gt.toString().toLowerCase().includes(F)),K=ue==="Filter by Accounts"||String(De.account_id)===ue,ie=De?.status!=="Inactive";let Me=!0;const Ke=n?.role?.toUpperCase();if(Ke!=="GROUP MANAGER"&&Ke!=="CEO"&&Ke!=="ADMIN"){const gt=De?.assigned_to===n?.id,Ct=De?.created_by===n?.id;Me=gt||Ct}return Ie&&K&&ie&&Me})},[s,P,U,n?.id]),Be=Math.max(1,Math.ceil(Je.length/X)||1);f.useEffect(()=>{je(1)},[P,U,X]),f.useEffect(()=>{je(F=>{const ue=Math.max(1,Math.ceil(Je.length/X)||1);return F>ue?ue:F})},[Je.length,X]);const _e=f.useMemo(()=>{const F=(oe-1)*X;return Je.slice(F,F+X)},[Je,oe,X]),pe=()=>je(F=>Math.max(F-1,1)),ce=()=>je(F=>Math.min(F+1,Be)),Q=f.useMemo(()=>{if(!j||!A)return l;const F=s.find(De=>De.id===A);return!F||!F.account||l.some(De=>De.id===F.account.id)?l:[...l,F.account]},[l,j,A,s]),ne=f.useCallback(()=>{v(!1),y(!1),E(null),z(Zb),w(!1),it(!1)},[]),ae=F=>{F.target.id==="modalBackdrop"&&!N&&!k&&ne()},Pe=F=>{const{name:ue,value:De}=F.target;z(le=>({...le,[ue]:De}))},Te=()=>{z(Zb),y(!1),E(null),v(!0)};f.useEffect(()=>{const F=new URLSearchParams(t.search||"");(t.state?.openContactModal||F.get("openModal")==="1")&&(z(Zb),y(!1),E(null),v(!0),it(!1),e(t.pathname,{replace:!0,state:{}}))},[t.state,t.pathname,t.search,e]);const he=async F=>{if(!F)return;const ue=await re.get(`/accounts/get/${F.account_id}`);z({first_name:F.first_name||"",last_name:F.last_name||"",account_id:ue.data.id?ue.data.id:"",title:F.title||"",department:F.department||"",email:F.email||"",work_phone:F.work_phone||"",mobile_phone_1:F.mobile_phone_1||"",mobile_phone_2:F.mobile_phone_2||"",notes:F.notes||"",assigned_to:F.assigned_to?String(F.assigned_to):""}),y(!0),E(F.id),v(!0),p(null)},He=F=>{if(!F)return;const ue=Nl(F)||"this contact";_({title:"Archive Contact",message:a.jsxs("span",{children:["Are you sure you want to archive"," ",a.jsx("span",{className:"font-semibold",children:ue}),"? You can restore it later if needed."]}),confirmLabel:"Archive Contact",cancelLabel:"Cancel",variant:"archive",action:{type:"archive",targetId:F.id,name:ue}})},qe=F=>{const ue=_e.find(De=>De.id===F);ue&&ue.contact_creator?.id===n?.id&&$e(De=>{const le=new Set(De);return le.has(F)?le.delete(F):le.add(F),le})},nt=()=>{const F=_e.filter(ue=>ue.contact_creator?.id===n?.id);ge.size===F.length&&F.length>0?$e(new Set):$e(new Set(F.map(ue=>ue.id)))},ot=()=>{if(ge.size===0)return;const F=ge.size;_({title:"Archive Contacts",message:a.jsxs("span",{children:["Are you sure you want to archive"," ",a.jsx("span",{className:"font-semibold",children:F})," contact",F!==1?"s":"","? You can restore them later if needed."]}),confirmLabel:`Archive ${F} Contact${F!==1?"s":""}`,cancelLabel:"Cancel",variant:"archive",action:{type:"bulk-archive",targetIds:Array.from(ge),count:F}})},[Re,it]=f.useState(!1),St=F=>{F.preventDefault(),it(!0);const ue=M.first_name.trim(),De=M.last_name.trim();if(!ue||!De){H.error("First name and last name are required.");return}if(!M.account_id){H.error("Account is required.");return}if(!M.assigned_to){H.error("Assigned To is required.");return}const Ie=M.email?.trim();if(!Ie){H.error("Email is required.");return}if(!Ie.includes("@")){H.error("Email must contain '@'.");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(Ie)){H.error("Please enter a valid email address.");return}const ie={first_name:ue,last_name:De,account_id:Number(M.account_id),title:M.title?.trim()||null,department:M.department?.trim()||null,email:M.email?.trim().toLowerCase()||null,work_phone:M.work_phone?.trim()||null,mobile_phone_1:M.mobile_phone_1?.trim()||null,mobile_phone_2:M.mobile_phone_2?.trim()||null,notes:M.notes?.trim()||null,assigned_to:M.assigned_to?Number(M.assigned_to):null},Me=j&&A?"update":"create",Ke=`${ue} ${De}`.trim();_({title:Me==="create"?"Confirm New Contact":"Confirm Update",message:Me==="create"?a.jsxs("span",{children:["Are you sure you want to add"," ",a.jsx("span",{className:"font-semibold",children:Ke})," to your contacts?"]}):a.jsxs("span",{children:["Save changes to ",a.jsx("span",{className:"font-semibold",children:Ke}),"?"]}),confirmLabel:Me==="create"?"Create Contact":"Update Contact",cancelLabel:"Cancel",variant:"primary",action:{type:Me,payload:ie,targetId:A||null,name:Ke}})},Et=async()=>{if(!S?.action){_(null);return}const{action:F}=S,{type:ue,payload:De,targetId:le,name:Ie}=F;T(!0);try{if(ue==="create"){w(!0),await re.post("/contacts/admin",De),H.success(`Contact "${Ie}" created successfully.`);const K=h?.id||null;ne(),await tt(K)}else if(ue==="update"){if(!le)throw new Error("Missing contact identifier for update.");w(!0),await re.put(`/contacts/admin/${le}`,De),H.success(`Contact "${Ie}" updated successfully.`);const K=h?.id&&h.id===le?le:h?.id||null;ne(),await tt(K),h?.id===le&&p(null)}else if(ue==="archive"){if(!le)throw new Error("Missing contact identifier for archiving.");const K=h?.id;q(le),await re.put(`/contacts/admin/${le}`,{status:"Inactive"}),H.success(`Contact "${Ie}" archived successfully.`),await tt(K&&K!==le?K:null),K===le&&p(null)}else if(ue==="bulk-archive"){const{targetIds:K,count:ie}=F;if(!K||K.length===0)throw new Error("Missing contact identifiers for bulk archiving.");me(!0),await Promise.all(K.map(Me=>re.put(`/contacts/admin/${Me}`,{status:"Inactive"}))),H.success(`${ie} contact${ie!==1?"s":""} archived successfully.`),$e(new Set),await tt(),p(null)}}catch(K){console.error(K);const ie=ue==="create"?"Failed to create contact. Please review the details and try again.":ue==="update"?"Failed to update contact. Please review the details and try again.":ue==="bulk-archive"?"Failed to archive contacts. Please try again.":"Failed to archive contact. Please try again.",Me=K.response?.data?.detail||ie;H.error(Me)}finally{(ue==="create"||ue==="update")&&w(!1),ue==="archive"&&q(null),ue==="bulk-archive"&&me(!1),T(!1),_(null)}},Tt=()=>{k||_(null)},Nt=F=>{p(F),V("Overview")},xe=()=>p(null),ve=F=>{F.target.id==="contactModalBackdrop"&&!k&&xe()},Oe=S?.action?.type==="delete"?S.action.targetId:null,Ce=h&&(R===h.id||Oe===h.id),Qe=h&&R===h.id,G=h?a.jsx("div",{id:"contactModalBackdrop",onClick:ve,className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-6xl max-h-[92vh] overflow-y-auto hide-scrollbar animate-scale-in font-inter relative",onClick:F=>F.stopPropagation(),children:[a.jsxs("div",{className:"bg-tertiary w-full rounded-t-xl relative p-3 lg:p-3",children:[a.jsx("h1",{className:"lg:text-3xl text-xl text-white font-semibold text-center w-full",children:"Contact"}),a.jsx("button",{onClick:xe,className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-white cursor-pointer",children:a.jsx(Ja,{size:25})})]}),a.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between lg:flex-row lg:items-center lg:justify-between mt-3 gap-2 px-2 md:items-center lg:gap-4 md:mx-7 lg:mx-7",children:[a.jsx("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:a.jsx("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-800",children:Nl(h)||"Unnamed contact"})}),a.jsx("div",{className:"flex flex-col sm:flex-row sm:space-x-3 space-y-2 sm:space-y-0",children:n?.id===h?.contact_creator?.id&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{className:"inline-flex items-center justify-center w-full sm:w-auto bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 disabled:opacity-70 transition text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",onClick:()=>he(h),disabled:k||S?.action?.type==="update"&&S.action.targetId===h.id,children:[a.jsx(gn,{className:"mr-2"}),"Edit"]}),a.jsx("button",{className:"inline-flex items-center justify-center w-full sm:w-auto px-4 py-2 rounded-md text-sm bg-orange-500 text-white hover:bg-orange-600 transition focus:outline-none focus:ring-2 focus:ring-orange-400",onClick:()=>He(h),disabled:!!Ce,children:Qe?"Archiving...":a.jsxs(a.Fragment,{children:[a.jsx(Zt,{className:"mr-2"}),"Archive"]})})]})})]}),a.jsx("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-2 px-2 lg:gap-4 md:mx-7 lg:mx-7",children:a.jsx("p",{className:"text-sm text-gray-500",children:h.account?.name||"No associated account"})}),a.jsx("div",{className:"border-b border-gray-200 my-5"}),a.jsxs("div",{className:"p-6 lg:p-4",children:[a.jsx("div",{className:"flex w-full bg-[#6A727D] text-white mt-1 overflow-x-auto mb-6",children:["Overview","Notes","Activities"].map(F=>a.jsx("button",{onClick:()=>V(F),className:`flex-1 min-w-[90px] px-4 py-2.5 text-xs sm:text-sm font-medium text-center transition-all duration-200 border-b-2
        ${Z===F?"bg-paper-white text-[#6A727D] border-white":"text-white hover:bg-[#5c636d]"}`,children:F},F))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 items-start",children:[a.jsxs("div",{className:"lg:col-span-3",children:[Z==="Overview"&&a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 md:p-8 border border-gray-200",children:a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4 sm:gap-6 text-sm text-gray-700",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Contact Name:"}),a.jsx("p",{children:Nl(h)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Title:"}),a.jsx("p",{children:h.title||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Email:"}),a.jsx("p",{children:h.email?a.jsx("a",{href:`mailto:${h.email}`,className:"text-blue-600 hover:underline break-all",children:h.email}):"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Department:"}),a.jsx("p",{children:h.department||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Work Phone:"}),a.jsx("p",{children:h.work_phone||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Mobile Phone 1:"}),a.jsx("p",{children:h.mobile_phone_1||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Mobile Phone 2:"}),a.jsx("p",{children:h.mobile_phone_2||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Assigned To:"}),a.jsx("p",{children:h.assigned_contact?`${h.assigned_contact.first_name} ${h.assigned_contact.last_name}`:"Unassigned"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created By:"}),a.jsx("p",{children:h.contact_creator?`${h.contact_creator.first_name} ${h.contact_creator.last_name}`:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created At:"}),a.jsx("p",{children:vo(h.created_at)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Last Updated:"}),a.jsx("p",{children:vo(h.updated_at)||"N/A"})]})]})}),Z==="Notes"&&a.jsxs("div",{className:"mt-4 w-full",children:[a.jsx("div",{className:"flex flex-wrap items-center justify-between mb-4 gap-2",children:a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words",children:"Contact Note"})}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 shadow-sm break-words",children:[a.jsx("div",{className:"flex items-start justify-between",children:a.jsx("div",{children:a.jsx("p",{className:"text-sm font-medium text-gray-800 break-words",children:"Note"})})}),a.jsx("div",{className:"mt-3 text-sm text-gray-700 whitespace-pre-wrap break-words",children:h.notes||"No notes available."})]}),a.jsx(Tn,{comments:Ue,onAddComment:Ee})]}),Z==="Activities"&&a.jsxs("div",{className:"space-y-2 w-full h-full max-h-[50dvh] overflow-y-auto bg-gray-50 p-2 hide-scrollbar rounded-lg border border-gray-200 shadow-sm",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words border-b border-gray-300 py-2",children:"Related Activities"}),a.jsxs("div",{className:"space-y-2 text-sm",children:[ye.tasks&&ye.tasks.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>we(fe==="tasks"?null:"tasks"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Qt,{className:"text-blue-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Tasks (",ye.tasks.length,")"]})]}),fe==="tasks"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),fe==="tasks"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:ye.tasks.map((F,ue)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/group-manager/tasks",{state:{taskID:F.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-blue-600 mt-1",children:a.jsx(Qt,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:F.subject||F.title||"Task"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:F.description||"No description"}),F.assigned_to&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Assigned: ",F.assigned_to.first_name," ",F.assigned_to.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:vo(F.due_date||F.created_at)})]},`task-${ue}`))})]}),ye.meetings&&ye.meetings.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>we(fe==="meetings"?null:"meetings"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ot,{className:"text-green-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Meetings (",ye.meetings.length,")"]})]}),fe==="meetings"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),fe==="meetings"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:ye.meetings.map((F,ue)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/group-manager/meetings",{state:{meetingID:F.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-green-600 mt-1",children:a.jsx(Ot,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:F.subject||F.title||"Meeting"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:F.description||F.location||"No description"}),F.host&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Host: ",F.host.first_name," ",F.host.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:vo(F.start_time||F.created_at)})]},`meeting-${ue}`))})]}),ye.calls&&ye.calls.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>we(fe==="calls"?null:"calls"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(It,{className:"text-purple-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Calls (",ye.calls.length,")"]})]}),fe==="calls"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),fe==="calls"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:ye.calls.map((F,ue)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/group-manager/calls",{state:{callID:F.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-purple-600 mt-1",children:a.jsx(It,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:F.subject||F.title||"Call"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:F.direction||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:vo(F.call_time||F.created_at)})]},`call-${ue}`))})]}),ye.deals&&ye.deals.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>we(fe==="deals"?null:"deals"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(sa,{className:"text-indigo-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Deals (",ye.deals.length,")"]})]}),fe==="deals"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),fe==="deals"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:ye.deals.map((F,ue)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/group-manager/deals",{state:{dealID:F.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-indigo-600 mt-1",children:a.jsx(sa,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("h4",{className:"font-medium text-blue-600 break-words text-sm",children:[F.deal_id?F.deal_id.replace(/D(\d+)-\d+-/,"D$1-"):"--"," ",F.name||F.title||"Deal"]}),a.jsx("p",{className:"text-xs text-gray-500 break-words capitalize",children:F.stage||F.description||"No description"})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:vo(F.close_date||F.created_at)})]},`deal-${ue}`))})]}),ye.quotes&&ye.quotes.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>we(fe==="quotes"?null:"quotes"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ia,{className:"text-orange-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Quotes (",ye.quotes.length,")"]})]}),fe==="quotes"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),fe==="quotes"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:ye.quotes.map((F,ue)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>e("/group-manager/quotes",{state:{quoteID:F.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-orange-600 mt-1",children:a.jsx(ia,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:(F.quote_id?F.quote_id.replace(/Q(\d+)-\d+-/,"Q$1-"):"--")||"Quote"}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:F.status||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:vo(F.presented_date)||""})]},`quote-${ue}`))})]}),(!ye||(!ye.tasks||ye.tasks.length===0)&&(!ye.meetings||ye.meetings.length===0)&&(!ye.calls||ye.calls.length===0)&&(!ye.quotes||ye.quotes.length===0)&&(!ye.deals||ye.deals.length===0)&&(!ye.contacts||ye.contacts.length===0))&&a.jsx("div",{className:"text-center py-8 text-gray-500",children:a.jsx("p",{children:"No related activities found for this account."})})]})]})]}),a.jsx("div",{className:"flex flex-col gap-4",children:a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Quick Actions"}),a.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[a.jsxs("button",{onClick:()=>e("/group-manager/calls",{state:{openCallModal:!0,initialCallData:{subject:`Call with ${Nl(h)||""}`.trim(),relatedType1:"Account",relatedTo1:h?.account_id?String(h.account_id):h?.account?.id?String(h.account.id):"",relatedType2:"Contact",relatedTo2:h?.id?String(h.id):"",assigned_to:h?.assigned_contact?.id?String(h.assigned_contact.id):"",direction:"Outgoing",status:"Planned"}}}),className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(It,{className:"text-gray-600 w-4 h-4"}),"Schedule Call"]}),a.jsxs("button",{type:"button",onClick:()=>{if(!h?.email){alert("No email address available");return}const F=encodeURIComponent(h.email),ue=encodeURIComponent(""),De=encodeURIComponent(""),le=`mailto:${F}?subject=${ue}&body=${De}`;window.location.href=le},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(rn,{className:"text-gray-600 w-4 h-4"}),"Send E-mail"]}),a.jsxs("button",{className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",onClick:()=>e("/group-manager/meetings",{state:{openMeetingModal:!0,initialMeetingData:{subject:`Meeting with ${Nl(h)||""}`.trim(),relatedType1:"Account",relatedTo1:h?.account_id?String(h.account_id):h?.account?.id?String(h.account.id):"",relatedType2:"Contact",relatedTo2:h?.id?String(h.id):"",assignedTo:h?.assigned_contact?.id?String(h.assigned_contact.id):"",status:"Planned"}}}),children:[a.jsx(Ot,{className:"text-gray-600 w-4 h-4"}),"Book Meeting"]}),a.jsxs("button",{onClick:()=>e("/group-manager/tasks",{state:{openTaskModal:!0,initialTaskData:{subject:`Task for ${Nl(h)||""}`.trim(),relatedType1:"Account",relatedTo1:h?.account_id?String(h.account_id):h?.account?.id?String(h.account.id):"",relatedType2:"Contact",relatedTo2:h?.id?String(h.id):"",assignedTo:h?.assigned_contact?.id?String(h.assigned_contact.id):"",priority:"NORMAL",status:"Not Started"}}}),className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(Qt,{className:"text-gray-600 w-4 h-4"}),"Tasks"]})]})]})})]})]})]})}):null,W=a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[i&&a.jsx(Wt,{message:"Loading contacts..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0 w-full",children:[a.jsxs("h2",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(Za,{className:"mr-2 text-blue-600"})," Contacts Management"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{onClick:()=>{Te(),it(!1)},className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 rounded-md hover:bg-gray-800 text-sm sm:text-base self-end sm:self-auto cursor-pointer",children:[a.jsx(aa,{className:"mr-2"})," Add Contact"]})})]}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search contacts",value:P,onChange:F=>D(F.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsx("div",{className:"w-full lg:w-1/4",children:a.jsx("select",{value:U,onChange:F=>B(F.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:Ze.map(F=>a.jsx("option",{value:F.value,children:F.label},F.value??F.label))})})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[600px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 text-sm tracking-wide font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 w-12",children:a.jsx("input",{type:"checkbox",checked:ge.size>0&&ge.size===_e.filter(F=>F.contact_creator?.id===n?.id).length&&_e.filter(F=>F.contact_creator?.id===n?.id).length>0,onChange:nt,className:"w-4 h-4 cursor-pointer"})}),a.jsx("th",{className:"py-3 px-4 truncate",children:"Contact"}),a.jsx("th",{className:"py-3 px-4",children:"Account"}),a.jsx("th",{className:"py-3 px-4 truncate",children:"Contact Info"}),a.jsx("th",{className:"py-3 px-4",children:"Department"}),a.jsx("th",{className:"py-3 px-4",children:"Assigned To"}),a.jsx("th",{className:"py-3 px-4",children:"Created"}),a.jsx("th",{className:"py-3 px-4 w-12",children:ge.size>0&&a.jsx("button",{onClick:ot,className:"text-orange-500 hover:text-orange-700 transition",title:"Archive selected contacts",disabled:be,children:a.jsx(Zt,{size:18})})})]})}),a.jsx("tbody",{children:i?a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:8,children:"Loading contacts..."})}):Je.length>0?_e.map(F=>{const ue=[{Icon:rn,value:F.email,key:"email"},{Icon:It,value:F.work_phone,key:"work_phone"},{Icon:fd,value:F.mobile_phone_1,key:"mobile_phone_1"},{Icon:fd,value:F.mobile_phone_2,key:"mobile_phone_2"}].filter(De=>!!De.value);return a.jsxs("tr",{className:"hover:bg-gray-50 text-sm cursor-pointer transition",children:[a.jsx("td",{className:"py-3 px-4",children:n?.id===F.contact_creator?.id&&a.jsx("input",{type:"checkbox",checked:ge.has(F.id),onChange:De=>{De.stopPropagation(),qe(F.id)},className:"w-4 h-4 cursor-pointer"})}),a.jsxs("td",{className:"py-3 px-4 align-top",onClick:()=>{Nt(F),Xe(F.id)},children:[a.jsx("div",{className:"font-medium text-blue-600 hover:underline break-all text-sm",children:Nl(F)||"--"}),a.jsx("div",{className:"text-xs text-gray-500",children:F.title||"No title"})]}),a.jsx("td",{className:"py-3 px-4 align-top",onClick:()=>{Nt(F),Xe(F.id)},children:a.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-700",children:[a.jsx(Vx,{className:"text-gray-500 flex-shrink-0"}),a.jsx("span",{className:"break-words",children:F.account?.name||"--"})]})}),a.jsx("td",{className:"py-3 px-4 align-top",onClick:()=>{Nt(F),Xe(F.id)},children:ue.length>0?a.jsx("div",{className:"space-y-1 text-gray-700",children:ue.map(({Icon:De,value:le,key:Ie})=>{const K=wt.createElement(De,{className:"text-gray-500 flex-shrink-0"});return a.jsxs("div",{className:"flex items-center space-x-2 break-all text-sm",children:[K,a.jsx("span",{children:le})]},Ie)})}):a.jsx("span",{className:"text-gray-400 text-sm",children:"--"})}),a.jsx("td",{className:"py-3 px-4 align-top",onClick:()=>{Nt(F),Xe(F.id)},children:a.jsxs("div",{className:"flex items-center space-x-2 text-gray-700 text-sm",children:[a.jsx(sa,{className:"text-gray-500 flex-shrink-0"}),a.jsx("span",{children:F.department||"--"})]})}),a.jsx("td",{className:"py-3 px-4 align-top",onClick:()=>{Nt(F),Xe(F.id)},children:a.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[a.jsx(ra,{className:"text-gray-500 flex-shrink-0"}),a.jsx("span",{children:F.assigned_contact?`${F.assigned_contact.first_name} ${F.assigned_contact.last_name}`:"Unassigned"})]})}),a.jsx("td",{className:"py-3 px-4 align-top",onClick:()=>{Nt(F),Xe(F.id)},children:a.jsxs("div",{className:"flex items-center space-x-2 text-gray-500",children:[a.jsx(Ot,{className:"text-gray-500 flex-shrink-0"}),a.jsx("span",{className:"text-xs",children:vo(F.created_at)||"--"})]})}),a.jsx("td",{className:"py-3 px-4"})]},F.id)}):a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:8,children:"No contacts found."})})})]})}),a.jsx(ca,{className:"mt-4",totalItems:Je.length,pageSize:X,currentPage:oe,onPrev:pe,onNext:ce,onPageSizeChange:se,label:"contacts"})]}),J=x?a.jsx("div",{id:"modalBackdrop",onClick:ae,className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-full sm:max-w-3xl rounded-2xl shadow-lg p-4 sm:p-6 md:p-8 relative border border-gray-200 overflow-y-auto max-h-[90vh] hide-scrollbar",onClick:F=>F.stopPropagation(),children:[a.jsx("button",{onClick:()=>{ne(),it(!1)},className:"absolute top-4 right-4 text-gray-500 hover:text-black transition disabled:opacity-60",disabled:N||k,children:a.jsx(ea,{size:22})}),a.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800 mb-4 sm:mb-6 flex items-center justify-center",children:j?"Edit Contact":"Add New Contact"}),a.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",onSubmit:St,noValidate:!0,children:[a.jsx(Gc,{label:"First Name",name:"first_name",value:M.first_name,onChange:Pe,placeholder:"First name",required:!0,isSubmitted:Re}),a.jsx(Gc,{label:"Last Name",name:"last_name",value:M.last_name,onChange:Pe,placeholder:"Last name",required:!0,isSubmitted:Re}),a.jsx(sH,{label:"Account",value:M.account_id,onChange:F=>z(ue=>({...ue,account_id:F})),items:j?Q:l||[],getLabel:F=>F?.name??"",placeholder:"Search account...",actions:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{type:"button",onClick:Fe,disabled:N,title:"Add account",className:"inline-flex items-center justify-center w-8 h-8 rounded-md border border-gray-300 text-gray-600 hover:bg-gray-50 transition disabled:opacity-60",children:a.jsx(aa,{size:16})}),a.jsx("button",{type:"button",onClick:lt,disabled:N,title:"Refresh accounts",className:"inline-flex items-center justify-center w-8 h-8 rounded-md border border-gray-300 text-gray-600 hover:bg-gray-50 transition disabled:opacity-60",children:a.jsx(Br,{size:16})})]}),disabled:N||(j?Q.length===0:l.length===0),required:!0,isSubmitted:Re}),a.jsx(sH,{label:"Assigned To",value:M.assigned_to,onChange:F=>z(ue=>({...ue,assigned_to:F})),items:u||[],getLabel:F=>`${F?.first_name??""} ${F?.last_name??""} (${F?.role??""})`.trim(),placeholder:"Search assignee...",required:!0,isSubmitted:Re,disabled:N||u.length===0}),a.jsx(Gc,{label:"Title",name:"title",value:M.title,onChange:Pe,placeholder:"Job title",disabled:N}),a.jsx(Gc,{label:"Department",name:"department",value:M.department,onChange:Pe,placeholder:"Department",disabled:N}),a.jsx(Gc,{label:"Email",name:"email",type:"email",value:M.email,onChange:Pe,placeholder:"example@email.com",required:!0,isSubmitted:Re}),a.jsx(Gc,{label:"Work Phone",name:"work_phone",value:M.work_phone,onChange:Pe,placeholder:"09xx xxx xxxx",disabled:N}),a.jsx(Gc,{label:"Mobile Phone 1",name:"mobile_phone_1",value:M.mobile_phone_1,onChange:Pe,placeholder:"09xx xxx xxxx",disabled:N}),a.jsx(Gc,{label:"Mobile Phone 2",name:"mobile_phone_2",value:M.mobile_phone_2,onChange:Pe,placeholder:"09xx xxx xxxx",disabled:N}),a.jsx(vWe,{label:"Notes",name:"notes",value:M.notes,onChange:Pe,placeholder:"Additional details...",rows:3,disabled:N,className:"md:col-span-2"}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-2 md:col-span-2 mt-4",children:[a.jsx("button",{type:"button",onClick:()=>{ne(),it(!1)},className:"w-full sm:w-auto px-4 py-2 text-white bg-red-400 border border-red-300 rounded hover:bg-red-500 transition disabled:opacity-70",disabled:N||k,children:"Cancel"}),a.jsx("button",{type:"submit",className:"w-full sm:w-auto px-4 py-2 text-white border border-tertiary bg-tertiary rounded hover:bg-secondary transition disabled:opacity-70",disabled:N||k,children:N?"Saving...":j?"Update Contact":"Save Contact"})]})]})]})}):null,Y=S?a.jsx(wWe,{open:!0,title:S.title,message:S.message,confirmLabel:S.confirmLabel,cancelLabel:S.cancelLabel,variant:S.variant,onConfirm:Et,onCancel:Tt,loading:k}):null;return a.jsxs(a.Fragment,{children:[W,G,J,Y]})}function Gc({label:e,name:t,value:n,onChange:s,placeholder:r,type:i="text",required:o=!1,disabled:l=!1,isSubmitted:c=!1,className:u=""}){const d=c&&!n?.trim();return a.jsxs("div",{children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",o&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:i,name:t,value:n??"",onChange:s,placeholder:r,required:o,disabled:l,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border focus:ring-2
          ${d?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}
          ${u}
        `})]})}function sH({label:e,items:t=[],value:n="",onChange:s,getLabel:r,placeholder:i="Search...",disabled:o=!1,className:l="",required:c=!1,isSubmitted:u=!1,actions:d=null}){const h=u&&c&&!n;return a.jsxs("div",{className:l,children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",c&&a.jsx("span",{className:"text-red-500",children:"*"})]}),d?a.jsx("div",{className:"flex items-center",children:d}):null]}),a.jsx(bWe,{items:t,value:n??"",onChange:s,getLabel:r,placeholder:i,disabled:o,hasError:h})]})}function bWe({items:e=[],value:t="",onChange:n,getLabel:s,placeholder:r="Search...",disabled:i=!1,maxRender:o=200,hasError:l=!1}){const[c,u]=f.useState(!1),[d,h]=f.useState(""),p=f.useRef(null),x=e.find(y=>String(y.id)===String(t)),v=x?s(x):"",j=f.useMemo(()=>{const y=d.trim().toLowerCase();return(y?e.filter(w=>(s(w)||"").toLowerCase().includes(y)):e).slice(0,o)},[e,d,s,o]);return f.useEffect(()=>{const y=N=>{p.current&&!p.current.contains(N.target)&&u(!1)};return document.addEventListener("mousedown",y),()=>document.removeEventListener("mousedown",y)},[]),f.useEffect(()=>{c||h("")},[c]),a.jsxs("div",{ref:p,className:"relative w-full",children:[a.jsx("input",{disabled:i,value:c?d:v,placeholder:r,onFocus:()=>!i&&u(!0),onChange:y=>{h(y.target.value),c||u(!0)},className:`w-full border rounded-md px-2 py-1.5 text-sm outline-none focus:ring-2
          ${l?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}`}),c&&!i&&a.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg overflow-hidden",children:[a.jsx("div",{className:"max-h-56 overflow-y-auto",children:j.length>0?j.map(y=>{const N=String(y.id),w=s(y),S=String(t)===N;return a.jsx("button",{type:"button",onClick:()=>{n(N),u(!1)},className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-50 ${S?"bg-blue-50":""}`,children:w||"--"},N)}):a.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No results"})}),e.length>o&&a.jsxs("div",{className:"px-3 py-2 text-[11px] text-gray-400 border-t",children:["Showing first ",o," results  keep typing to narrow."]})]})]})}function vWe({label:e,name:t,value:n,onChange:s,placeholder:r,rows:i=3,disabled:o=!1,className:l=""}){return a.jsxs("div",{className:l,children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsx("textarea",{name:t,value:n??"",onChange:s,placeholder:r,rows:i,disabled:o,className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100 resize-none"})]})}function wWe({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o=!1,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":i==="archive"?"bg-orange-500 hover:bg-orange-600 border border-orange-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsx("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${u}`,disabled:o,children:o?"Processing...":s})]})]})})}const kT=e=>e?new Date(e).toLocaleString("en-US",{month:"short",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).replace(",",""):"";function _ee({lead:e,onBack:t,fetchLeads:n,onEdit:s,onArchive:r,setSelectedLead:i,relatedActs:o}){const l=kt(),{leadID:c}=Wo(),{user:u}=Vt(),[d,h]=f.useState(e||null),[p,x]=f.useState("Overview"),[v,j]=f.useState(""),y=d?.status?.toUpperCase()==="QUALIFIED",[N,w]=f.useState(null),S=d&&u&&d.creator?.id===u.id,[_,k]=f.useState({name:"",website:"",countryCode:"",phone_number:"",billing_address:"",shipping_address:"",industry:"",status:"Prospect",territory_id:null,assigned_to:null,created_by:null}),[T,A]=f.useState({last_name:"",first_name:"",account_id:null,title:"",department:"",email:"",work_phone:"",mobile_phone_1:"",mobile_phone_2:"",notes:"",assigned_to:null,created_by:null}),[E,M]=f.useState({name:"Converted from Lead",account_id:null,primary_contact_id:null,stage:"Prospecting",probability:10,amount:0,currency:"PHP",description:"Initial deal from lead conversion.",assigned_to:null,created_by:null}),z=async()=>{try{if(e){h(e),j(e.status||"New");return}if(!c)return;const R=await re.get(`/leads/get/${c}`);h(R.data),j(R.data.status||"New"),k({name:R.data.company_name||"",website:"",countryCode:"+63",phone_number:"",billing_address:"",shipping_address:"",industry:"",status:"Prospect",territory_id:R.data.territory?.id||null,assigned_to:R.data.assigned_to?.id||null,created_by:R.data.creator?.id||null}),A({last_name:R.data.last_name||"",first_name:R.data.first_name||"",account_id:null,title:R.data.title||"",department:R.data.department||"",email:R.data.email||"",work_phone:R.data.work_phone||"",mobile_phone_1:R.data.mobile_phone_1||"",mobile_phone_2:R.data.mobile_phone_2||"",notes:"",assigned_to:R.data.assigned_to?.id||null,created_by:R.data.creator?.id||null}),M({name:"Converted from Lead",account_id:null,primary_contact_id:null,stage:"Prospecting",probability:10,amount:0,currency:"PHP",description:"Initial deal from lead conversion.",assigned_to:R.data.assigned_to?.id||null,created_by:R.data.creator?.id||null})}catch(R){console.error(R)}};f.useEffect(()=>{e?(h(e),j(e.status||"New")):c&&z()},[c,e]);const P=async()=>{try{if(v==="Converted"&&d?.status?.toUpperCase()!=="QUALIFIED"){H.error("Lead must be Qualified before it can be converted.");return}const R=await re.put(`/leads/${d.id}/update/status`,{status:v});H.success("Lead status updated successfully");const q={...d,status:R.data.status};h(q),i&&i(q),n&&n(),t&&t()}catch(R){console.error(R),H.error("Failed to update lead status")}},D=async R=>{const q={..._,assigned_to:R.assigned_to?.id,billing_address:R.address,shipping_address:R.address,created_by:R.creator?.id,industry:null,name:R.company_name,phone_number:R.work_phone,status:"Prospect",territory_id:R.territory?.id,website:""};console.log("Account data: ",q),console.log("Contact data: ",T),console.log("Deal data: ",E),console.log("Lead data: ",R);try{const V=(await re.post("/accounts/convertedLead",q)).data.id,oe={...T,account_id:V,assigned_to:R.assigned_to?.id,created_by:R.creator?.id,department:R.department,email:R.email,first_name:R.first_name,last_name:R.last_name,mobile_phone_1:R.mobile_phone_1,mobile_phone_2:R.mobile_phone_2,notes:R.notes,title:R.title,work_phone:R.work_phone},X=(await re.post("/contacts/convertedLead",oe)).data.id,se=()=>{switch(E.stage){case"PROSPECTING":return 10;case"QUALIFICATION":return 25;case"PROPOSAL":return 60;case"NEGOTIATION":return 80;case"CLOSED_WON":return 100;case"CLOSED_LOST":return 0;default:return 0}},ye=E.amount&&E.amount!==""?parseFloat(E.amount):0,Ne={...E,account_id:V,assigned_to:R.assigned_to?.id,created_by:R.creator?.id,primary_contact_id:X,probability:se(),stage:"Prospecting"},fe=await re.post("/deals/convertedLead",Ne),we=await re.put(`/leads/convert/${R.id}`);i&&i(null),n(),H.success("Lead converted successfully!"),t()}catch(Z){console.error("Error during conversion:",Z);const V=Z.response?.data?.detail||Z.message||"Failed to convert lead. Please try again.";H.error(V)}},U=R=>{switch((R||"").toUpperCase()){case"NEW":return"bg-indigo-100 text-indigo-700";case"CONTACTED":return"bg-blue-100 text-blue-700";case"QUALIFIED":return"bg-green-100 text-green-700";case"CONVERTED":return"bg-emerald-100 text-emerald-700";case"LOST":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-700"}},B=R=>R.toString().toLowerCase().replace(/\b\w/g,q=>q.toUpperCase());return d?a.jsx(a.Fragment,{children:a.jsx("div",{className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-lg w-full max-w-full sm:max-w-6xl max-h-[90vh] overflow-y-auto hide-scrollbar relative box-border",children:[a.jsx("div",{className:"bg-tertiary w-full rounded-t-xl p-3 lg:p-3",children:a.jsxs("div",{className:"flex items-start justify-between w-full",children:[a.jsx("h1",{className:"lg:text-3xl text-xl text-white font-semibold text-center w-full",children:"Lead"}),a.jsx("button",{onClick:()=>{t?t():l(-1)},className:"text-gray-400 hover:text-white mt-1 cursor-pointer",children:a.jsx(Ja,{size:25})})]})}),a.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between lg:flex-row lg:items-center lg:justify-between mt-3 gap-2 px-2 md:items-center lg:gap-4 md:mx-7 lg:mx-7",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[a.jsxs("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-800",children:[d.first_name," ",d.last_name]}),a.jsx("span",{className:`text-xs sm:text-sm font-medium px-2 sm:px-3 py-1 rounded-full whitespace-nowrap ${U(d.status)}`,children:B(d.status||"New")}),a.jsx("div",{className:"flex flex-col",children:a.jsx("button",{onClick:()=>D(d),disabled:!y,title:y?"Convert Lead":"Lead must be Qualified before converting",className:`px-3 sm:px-4 py-1.5 sm:py-2 rounded-md font-medium text-xs sm:text-sm transition focus:outline-none focus:ring-2
      ${y?"bg-green-600 hover:bg-green-700 text-white focus:ring-green-400":"bg-gray-200 text-gray-400 cursor-not-allowed"}
    `,children:"Convert"})})]}),a.jsx("div",{className:"flex flex-col sm:flex-row sm:space-x-3 space-y-2 sm:space-y-0",children:S&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{type:"button",onClick:()=>{s&&d&&s(d)},className:"inline-flex items-center justify-center w-full sm:w-auto bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 transition text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",children:[a.jsx(hn,{className:"mr-2"}),"Edit"]}),a.jsxs("button",{type:"button",onClick:()=>{r&&d&&r(d)},className:"inline-flex items-center justify-center w-full sm:w-auto px-4 py-2 rounded-md text-sm bg-orange-500 text-white hover:bg-orange-600 transition focus:outline-none focus:ring-2 focus:ring-orange-400",children:[a.jsx(Zt,{className:"mr-2"}),"Archive"]})]})})]}),a.jsx("div",{className:"border-b border-gray-200 my-5"}),a.jsxs("div",{className:"p-4 lg:p-4",children:[a.jsx("div",{className:"flex w-full bg-[#6A727D] text-white mt-1 overflow-x-auto mb-6",children:["Overview","Notes","Activities"].map(R=>a.jsx("button",{onClick:()=>x(R),className:`flex-1 min-w-[90px] px-4 py-2.5 text-xs sm:text-sm font-medium text-center transition-all duration-200 border-b-2
        ${p===R?"bg-paper-white text-[#6A727D] border-white":"text-white hover:bg-[#5c636d]"}`,children:R},R))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 items-start",children:[a.jsxs("div",{className:"lg:col-span-3",children:[p==="Overview"&&a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 md:p-8 border border-gray-200",children:a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4 sm:gap-6 text-sm text-gray-700",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Name:"}),a.jsxs("p",{children:[d.first_name," ",d.last_name||"N/A"]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Company:"}),a.jsx("p",{children:d.company_name||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Job Title:"}),a.jsx("p",{children:d.title||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Department:"}),a.jsx("p",{children:d.department||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Email:"}),a.jsx("p",{children:d.email||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Territory:"}),a.jsx("p",{children:d.territory?.name||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Assigned To:"}),a.jsx("p",{children:d.assigned_to?`${d.assigned_to.first_name} ${d.assigned_to.last_name}`:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created By:"}),a.jsx("p",{children:d.creator?`${d.creator.first_name} ${d.creator.last_name}`:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Work Phone:"}),a.jsx("p",{children:d.work_phone||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Mobile Phone 1:"}),a.jsx("p",{children:d.mobile_phone_1||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Mobile Phone 2:"}),a.jsx("p",{children:d.mobile_phone_2||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Source:"}),a.jsx("p",{children:d.source||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Address:"}),a.jsx("p",{children:d.address||"N/A"})]})]})}),p==="Notes"&&a.jsxs("div",{className:"mt-4 w-full",children:[a.jsx("div",{className:"flex flex-wrap items-center justify-between mb-4 gap-2",children:a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words",children:"Lead Note"})}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 shadow-sm break-words",children:[a.jsx("div",{className:"flex items-start justify-between",children:a.jsx("div",{children:a.jsx("p",{className:"text-sm font-medium text-gray-800 break-words",children:"Note"})})}),a.jsx("div",{className:"mt-3 text-sm text-gray-700 whitespace-pre-wrap break-words",children:d.notes||"No notes available."})]})]}),p==="Activities"&&a.jsxs("div",{className:"space-y-2 w-full h-full max-h-[50dvh] overflow-y-auto bg-gray-50 p-2 hide-scrollbar rounded-lg border border-gray-200 shadow-sm",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words border-b border-gray-300 py-2",children:"Related Activities"}),a.jsxs("div",{className:"space-y-2 text-sm",children:[o.tasks&&o.tasks.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>w(N==="tasks"?null:"tasks"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Qt,{className:"text-blue-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Tasks (",o.tasks.length,")"]})]}),N==="tasks"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),N==="tasks"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:o.tasks.map((R,q)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>l("/group-manager/tasks",{state:{taskID:R.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-blue-600 mt-1",children:a.jsx(Qt,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:R.subject||R.title||"Task"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:R.description||"No description"}),R.assigned_to&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Assigned:"," ",R.assigned_to.first_name," ",R.assigned_to.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:kT(R.due_date||R.created_at)})]},`task-${q}`))})]}),o.meetings&&o.meetings.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>w(N==="meetings"?null:"meetings"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ot,{className:"text-green-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Meetings (",o.meetings.length,")"]})]}),N==="meetings"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),N==="meetings"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:o.meetings.map((R,q)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>l("/group-manager/meetings",{state:{meetingID:R.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-green-600 mt-1",children:a.jsx(Ot,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:R.subject||R.title||"Meeting"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:R.description||R.location||"No description"}),R.host&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Host: ",R.host.first_name," ",R.host.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:kT(R.start_time||R.created_at)})]},`meeting-${q}`))})]}),o.calls&&o.calls.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>w(N==="calls"?null:"calls"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(It,{className:"text-purple-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Calls (",o.calls.length,")"]})]}),N==="calls"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),N==="calls"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:o.calls.map((R,q)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>l("/group-manager/calls",{state:{callID:R.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-purple-600 mt-1",children:a.jsx(It,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:R.subject||R.title||"Call"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:R.direction||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:kT(R.call_time||R.created_at)})]},`call-${q}`))})]}),(!o||(!o.tasks||o.tasks.length===0)&&(!o.meetings||o.meetings.length===0)&&(!o.calls||o.calls.length===0)&&(!o.quotes||o.quotes.length===0)&&(!o.deals||o.deals.length===0)&&(!o.contacts||o.contacts.length===0))&&a.jsx("div",{className:"text-center py-8 text-gray-500",children:a.jsx("p",{children:"No related activities found for this account."})})]})]})]}),a.jsxs("div",{className:"flex flex-col gap-4",children:[a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Quick Actions"}),a.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[a.jsxs("button",{onClick:()=>{d&&l("/group-manager/calls",{state:{openCallModal:!0,initialCallData:{subject:d.title?`Call regarding ${d.title}`:`Call with ${d.first_name} ${d.last_name}`,relatedType1:"Lead",relatedTo1:String(d.id),relatedType2:null,relatedTo2:null,assigned_to:d.assigned_to?.id?String(d.assigned_to.id):"",direction:"Outgoing",status:"Planned"}}})},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(It,{className:"text-gray-600 w-4 h-4"}),"Schedule Call"]}),a.jsxs("button",{type:"button",onClick:()=>{if(!d?.email){alert("No email address available");return}const R=encodeURIComponent(d.email),q=encodeURIComponent(""),Z=encodeURIComponent(""),V=`mailto:${R}?subject=${q}&body=${Z}`;window.location.href=V},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(rn,{className:"text-gray-600 w-4 h-4"}),"Send E-mail"]}),a.jsxs("button",{className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",onClick:()=>{d&&l("/group-manager/meetings",{state:{openMeetingModal:!0,initialMeetingData:{subject:d.title?`Meeting regarding ${d.title}`:`Meeting with ${d.first_name||""} ${d.last_name||""}`.trim(),relatedType1:"Lead",relatedTo1:String(d.id),relatedType2:null,relatedTo2:null,assignedTo:d.assigned_to?.id?String(d.assigned_to.id):"",status:"Planned"}}})},children:[a.jsx(Ot,{className:"text-gray-600 w-4 h-4"}),"Book Meeting"]}),a.jsxs("button",{onClick:()=>{d&&l("/group-manager/tasks",{state:{openTaskModal:!0,initialTaskData:{subject:d.title?`Follow up on ${d.title}`:`Follow up with ${d.first_name||""} ${d.last_name||""}`.trim(),relatedType1:"Lead",relatedTo1:String(d.id),relatedType2:null,relatedTo2:null,assignedTo:d.assigned_to?.id?String(d.assigned_to.id):"",priority:"NORMAL",status:"Not Started"}}})},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(Qt,{className:"text-gray-600 w-4 h-4"}),"Tasks"]})]})]}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm w-full",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Status"}),a.jsxs("select",{className:"border border-gray-200 rounded-md px-2 sm:px-3 py-1.5 w-full text-sm mb-2 focus:ring-2 focus:ring-indigo-500 outline-none",value:v,onChange:R=>j(R.target.value),children:[a.jsx("option",{value:"New",children:"New"}),a.jsx("option",{value:"Contacted",children:"Contacted"}),a.jsx("option",{value:"Qualified",children:"Qualified"}),d?.status?.toUpperCase()==="QUALIFIED"&&a.jsx("option",{value:"Converted",children:"Converted"}),a.jsx("option",{value:"Lost",children:"Lost"})]}),a.jsx("button",{onClick:P,disabled:v===d.status,className:`w-full py-1.5 rounded-md text-sm transition focus:outline-none focus:ring-2 ${v===d.status?"bg-gray-400 cursor-not-allowed text-white":"bg-gray-900 text-white hover:bg-gray-800 focus:ring-gray-400"}`,children:"Update"})]})]})]})]})]})})}):null}const jWe=nh.all(),ET=jWe.map((e,t)=>({code:`+${e.countryCallingCode}`,name:e.countryCode,id:`${e.countryCallingCode}-${e.countryCode}-${t}`})),NWe=e=>e.toString().toLowerCase().replace(/\b\w/g,t=>t.toUpperCase()),CWe=e=>{switch(e.toUpperCase()){case"NEW":return"bg-indigo-100 text-indigo-700";case"CONTACTED":return"bg-blue-100 text-blue-700";case"QUALIFIED":return"bg-green-100 text-green-700";case"CONVERTED":return"bg-emerald-100 text-emerald-700";case"LOST":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-700"}},LT={first_name:"",last_name:"",company_name:"",title:"",department:"",email:"",work_ccode:"+63",work_phone:"",m1_ccode:"+63",mobile_phone_1:"",m2_ccode:"+63",mobile_phone_2:"",address:"",notes:"",source:"",territory_id:null,lead_owner:null,status:"New"};function SWe(){const e=kt(),{leadID:t}=Wo(),{user:n}=Vt();Bs();const[s,r]=f.useState(null),[i,o]=f.useState(!1),[l,c]=f.useState(null),[u,d]=f.useState(null),[h,p]=f.useState([]),[x,v]=f.useState(!1),[j,y]=f.useState(""),[N,w]=f.useState("Filter by Status"),[S,_]=f.useState(1),[k,T]=f.useState(10),[A,E]=f.useState(LT),[M,z]=f.useState(!1),[P,D]=f.useState(null),[U,B]=f.useState(!1),[R,q]=f.useState(null),[Z,V]=f.useState(!1),[oe,je]=f.useState({}),[X,se]=f.useState(new Set),[ye,Ne]=f.useState(!1),[fe,we]=f.useState(null);f.useRef(null);const[de,ke]=f.useState(!1),[ge,$e]=f.useState(null),[be,me]=f.useState({name:"",website:"",countryCode:"+63",phone_number:"",combinedPhoneNumbers:"",billing_address:"",shipping_address:"",industry:"",status:"Prospect",territory_id:null,assigned_to:null,created_by:null}),[Ue,Ee]=f.useState({last_name:"",first_name:"",account_id:null,title:"",department:"",email:"",work_phone:"",mobile_phone_1:"",mobile_phone_2:"",notes:"",assigned_to:null,created_by:null}),[We,tt]=f.useState({name:"Converted from Lead",account_id:null,primary_contact_id:null,stage:"PROSPECTING",probability:10,amount:0,currency:"PHP",description:"Initial deal from lead conversion.",assigned_to:null,created_by:null});f.useEffect(()=>{document.title="Leads | Sari-Sari CRM"},[]);const lt=async()=>{try{const G=await re.get("/leads/getUsers");c(G.data)}catch(G){console.error(`Error fetching users: ${G}`)}},Fe=async()=>{v(!0);try{const G=await re.get("/leads/admin/getLeads");p(G.data),console.log(G.data)}catch(G){console.error(`Error fetching leads: ${G}`)}finally{v(!1)}};f.useEffect(()=>{lt(),Fe()},[]),f.useEffect(()=>{if(t&&h.length>0&&!i&&!M){const G=h.find(W=>W.id===Number(t));G&&r(G)}else!t&&!s&&r(null)},[t,h,i,M]),f.useEffect(()=>{if(ge){const W=(F=>{if(!F)return{code:"+63",number:""};const ue=F.match(/^(\+\d+)\s(.+)$/);if(ue)return{code:ue[1],number:ue[2]};if(F.startsWith("+")){const De=F.match(/^(\+\d{1,3})/);if(De)return{code:De[1],number:F.substring(De[1].length).trim()}}return{code:"+63",number:F}})(ge.work_phone),J=[];ge.work_phone&&J.push(`Work: ${ge.work_phone}`),ge.mobile_phone_1&&J.push(`Mobile 1: ${ge.mobile_phone_1}`),ge.mobile_phone_2&&J.push(`Mobile 2: ${ge.mobile_phone_2}`);const Y=J.length>0?J.join(" | "):"";me({name:ge.company_name||"",website:"",countryCode:W.code,phone_number:W.number,combinedPhoneNumbers:Y,billing_address:ge.address||"",shipping_address:ge.address||"",industry:"",status:"Prospect",territory_id:ge.assigned_to?.territory?.id||null,assigned_to:ge.assigned_to?.id||null,created_by:ge.creator?.id||null}),Ee({last_name:ge.last_name||"",first_name:ge.first_name||"",account_id:null,title:ge.title||"",department:ge.department||"",email:ge.email||"",work_phone:ge.work_phone||"",mobile_phone_1:ge.mobile_phone_1||"",mobile_phone_2:ge.mobile_phone_2||"",notes:ge.notes||"",assigned_to:ge.assigned_to?.id||null,created_by:ge.creator?.id||null}),tt({name:"Converted from Lead",account_id:null,primary_contact_id:null,stage:"PROSPECTING",probability:10,amount:0,currency:"PHP",description:"Initial deal from lead conversion.",assigned_to:ge.assigned_to?.id||null,created_by:ge.creator?.id||null})}},[ge]);const st=G=>y(G.target.value),Xe=f.useMemo(()=>{const G=j.trim().toLowerCase(),W=N.trim().toUpperCase();let J=h.filter(Y=>{const F=Y?.status!=="Inactive",ue=[Y?.first_name,Y?.last_name,Y?.company_name,Y?.title,Y?.email,Y?.work_phone,Y?.assigned_to?`${Y.assigned_to.first_name} ${Y.assigned_to.last_name}`:""],De=G===""||ue.some(Ie=>Ie==null||Ie===""?!1:Ie.toString().toLowerCase().includes(G));let le=!1;return W==="FILTER BY STATUS"?le=(Y.status?Y.status.toUpperCase():"")!=="CONVERTED":le=(Y.status?Y.status.toUpperCase():"")===W,De&&le&&F});return J.sort((Y,F)=>{const ue=new Date(Y.created_at).getTime();return new Date(F.created_at).getTime()-ue}),J},[h,j,N]),Ze=Math.max(1,Math.ceil(Xe.length/k)||1);f.useEffect(()=>{_(1)},[j,N,k]),f.useEffect(()=>{_(G=>{const W=Math.max(1,Math.ceil(Xe.length/k)||1);return G>W?W:G})},[Xe.length,k]);const Je=f.useMemo(()=>{const G=(S-1)*k;return Xe.slice(G,G+k)},[Xe,S,k]),Be=()=>_(G=>Math.max(G-1,1)),_e=()=>_(G=>Math.min(G+1,Ze)),pe=f.useCallback(async G=>{try{const W=await re.get(`/activities/lead/${G}`);je(W.data&&typeof W.data=="object"?W.data:{})}catch(W){console.error(W),W.response?.status===404&&(console.warn("No activities found for this account."),je({}))}},[]),ce=G=>{r(G),pe(G.id)},Q=()=>{r(null),t&&e("/admin/leads",{replace:!0})},ne=()=>{o(!1),E(LT),z(!1),D(null),B(!1),d(null),sessionStorage.removeItem("editLeadData")},ae=G=>{G.target.id==="modalBackdrop"&&ne()},Pe=()=>{E(LT),z(!1),D(null),d(null),o(!0)},Te=G=>{if(!G){console.error("handleEditClick: lead is null or undefined");return}console.log("handleEditClick called with lead:",G),console.log("Current state - leadID:",t,"selectedLead:",s,"showModal:",i);const W=De=>{if(!De)return{code:"+63",number:""};const le=De.match(/^(\+\d+)\s(.+)$/);return le?{code:le[1],number:le[2]}:{code:"+63",number:De}},J=W(G.work_phone),Y=W(G.mobile_phone_1),F=W(G.mobile_phone_2);let ue="";if(G.assigned_to){ue=String(G.assigned_to.id);const De=l?.find(le=>le.id===G.assigned_to.id);d(De)}E({first_name:G.first_name||"",last_name:G.last_name||"",company_name:G.company_name||"",title:G.title||"",department:G.department||"",email:G.email||"",work_ccode:J.code,work_phone:J.number,m1_ccode:Y.code,mobile_phone_1:Y.number,m2_ccode:F.code,mobile_phone_2:F.number,address:G.address||"",notes:G.notes||"",source:G.source||"",territory_id:G.territory?.id||null,lead_owner:ue,status:G.status||"New"}),z(!0),D(G.id),s?(console.log("Coming from detail view - closing detail modal and showing edit form"),r(null),o(!0)):(console.log("Already in list view - showing modal"),o(!0))},he=G=>{if(!G){console.error("handleArchive: lead is null or undefined");return}const W=`${G.first_name} ${G.last_name}`||"this lead";q({title:"Archive Lead",message:a.jsxs("span",{children:["Are you sure you want to archive"," ",a.jsx("span",{className:"font-semibold",children:W}),"? You can restore it later if needed."]}),confirmLabel:"Archive Lead",cancelLabel:"Cancel",variant:"archive",action:{type:"archive",targetId:G.id,name:W}})},He=G=>{const W=Je.find(J=>J.id===G);W&&W.creator?.id===n?.id&&se(J=>{const Y=new Set(J);return Y.has(G)?Y.delete(G):Y.add(G),Y})},qe=()=>{const G=Je.filter(W=>W.creator?.id===n?.id);X.size===G.length&&G.length>0?se(new Set):se(new Set(G.map(W=>W.id)))},nt=()=>{if(X.size===0)return;const G=X.size;q({title:"Archive Leads",message:a.jsxs("span",{children:["Are you sure you want to archive"," ",a.jsx("span",{className:"font-semibold",children:G})," lead",G!==1?"s":"","? You can restore them later if needed."]}),confirmLabel:`Archive ${G} Lead${G!==1?"s":""}`,cancelLabel:"Cancel",variant:"archive",action:{type:"bulk-archive",targetIds:Array.from(X),count:G}})},ot=G=>{const{name:W,value:J}=G.target;if(E(Y=>({...Y,[W]:J})),W==="lead_owner"){const Y=l.find(F=>F.id===parseInt(J));d(Y)}},[Re,it]=f.useState(!1),St=G=>{if(G.preventDefault(),it(!0),!A.last_name?.trim()){H.error("Last name is required.");return}if(!A.company_name?.trim()){H.error("Company is required.");return}if(!A.title?.trim()){H.error("Job title is required.");return}if(!A.email?.trim()){H.error("Email is required.");return}if(!A.email.includes("@")){H.error("Email must contain '@'.");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(A.email)){H.error("Please enter a valid email address with a dot in the domain.");return}if(!A.lead_owner){H.error("Please assign a lead owner.");return}const J={...A,territory_id:A.territory_id?parseInt(A.territory_id):null,lead_owner:parseInt(A.lead_owner),work_phone:`${A.work_ccode} ${A.work_phone}`,mobile_phone_1:`${A.m1_ccode} ${A.mobile_phone_1}`,mobile_phone_2:`${A.m2_ccode} ${A.mobile_phone_2}`},Y=M&&P?"update":"create",F=`${A.first_name} ${A.last_name}`;q({title:Y==="create"?"Confirm New Lead":"Confirm Update",message:Y==="create"?a.jsxs("span",{children:["Are you sure you want to create a new lead for"," ",a.jsx("span",{className:"font-semibold",children:F}),"?"]}):a.jsxs("span",{children:["Save changes to ",a.jsx("span",{className:"font-semibold",children:F}),"?"]}),confirmLabel:Y==="create"?"Create Lead":"Update Lead",cancelLabel:"Cancel",variant:"primary",action:{type:Y,payload:J,targetId:P||null,name:F}})},Et=async()=>{if(!R?.action){q(null);return}const{action:G}=R,{type:W,payload:J,targetId:Y,name:F,targetIds:ue,count:De}=G;console.log(J),V(!0);try{if(W==="create")B(!0),await re.post("/leads/create",J),H.success(`Lead "${F}" created successfully.`),ne(),await Fe();else if(W==="update"){if(!Y)throw new Error("Missing lead identifier for update.");B(!0);const le=await re.put(`/leads/${Y}`,J);H.success(`Lead "${F}" updated successfully.`),s&&s.id===Y&&r(null),ne(),await Fe()}else if(W==="archive"){if(!Y)throw new Error("Missing lead identifier for archiving.");const le=s?.id;we(Y),await re.put(`/leads/${Y}`,{status:"Inactive"}),H.success(`Lead "${F}" archived successfully.`),await Fe(),le===Y&&r(null)}else if(W==="bulk-archive"){if(!ue||ue.length===0)throw new Error("Missing lead identifiers for bulk archiving.");Ne(!0),await Promise.all(ue.map(le=>re.put(`/leads/${le}`,{status:"Inactive"}))),H.success(`${De} lead${De!==1?"s":""} archived successfully.`),se(new Set),await Fe(),r(null)}}catch(le){console.error(le);const Ie=W==="create"?"Failed to create lead. Please review the details and try again.":W==="update"?"Failed to update lead. Please review the details and try again.":W==="bulk-archive"?"Failed to archive leads. Please try again.":"Failed to archive lead. Please try again.",K=le.response?.data?.detail||Ie;H.error(K)}finally{(W==="create"||W==="update")&&B(!1),W==="archive"&&we(null),W==="bulk-archive"&&Ne(!1),W!=="edit"&&(V(!1),q(null))}},Tt=()=>{Z||q(null)},Nt=h.filter(G=>G.status==="New").length,xe=h.filter(G=>G.status==="Contacted").length,ve=h.filter(G=>G.status==="Qualified").length,Oe=h.filter(G=>G.status==="Converted").length,Ce=h.filter(G=>G.status==="Lost").length,Qe=[{title:"New",value:Nt,icon:Xa,color:"text-indigo-600",bgColor:"bg-indigo-100"},{title:"Contacted",value:xe,icon:It,color:"text-blue-600",bgColor:"bg-blue-100"},{title:"Qualified",value:ve,icon:Qa,color:"text-green-600",bgColor:"bg-green-100"},{title:"Converted",value:Oe,icon:ec,color:"text-emerald-600",bgColor:"bg-emerald-100"},{title:"Lost",value:Ce,icon:Us,color:"text-red-600",bgColor:"bg-red-100"}];return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[x&&a.jsx(Wt,{message:"Loading leads..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h1",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(Xa,{className:"mr-2 text-blue-600"}),"Leads"]}),a.jsxs("div",{className:"flex justify-center lg:justify-end gap-3 w-full sm:w-auto",children:[a.jsxs("button",{onClick:()=>{H.info("Download functionality coming soon")},className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 rounded-md hover:bg-gray-800 text-sm sm:text-base self-end sm:self-auto cursor-pointer",children:[a.jsx(Vo,{className:"mr-2"})," Download"]}),a.jsxs("button",{onClick:()=>{Pe(),it(!1)},className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 rounded-md hover:bg-gray-800 text-sm sm:text-base self-end sm:self-auto cursor-pointer",children:[a.jsx(aa,{className:"mr-2"})," Add Lead"]})]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 xl:grid-cols-5 gap-4 mb-6 w-full break-words overflow-hidden lg:overflow-visible",children:Qe.map(G=>a.jsx(AWe,{...G},G.title))}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search leads",value:j,onChange:st,className:"focus:outline-none text-base w-full"})]}),a.jsx("div",{className:"w-full lg:w-1/4",children:a.jsxs("select",{value:N,onChange:G=>w(G.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{value:"Filter by Status",children:"Filter by Status"}),a.jsx("option",{value:"New",children:"New"}),a.jsx("option",{value:"Contacted",children:"Contacted"}),a.jsx("option",{value:"Qualified",children:"Qualified"}),a.jsx("option",{value:"Converted",children:"Converted"}),a.jsx("option",{value:"Lost",children:"Lost"})]})})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[500px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 text-sm tracking-wide font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 w-12",children:a.jsx("input",{type:"checkbox",checked:X.size>0&&X.size===Je.filter(G=>G.creator?.id===n?.id).length&&Je.filter(G=>G.creator?.id===n?.id).length>0,onChange:qe,className:"w-4 h-4 cursor-pointer"})}),a.jsx("th",{className:"py-3 px-4",children:"Name"}),a.jsx("th",{className:"py-3 px-4",children:"Company"}),a.jsx("th",{className:"py-3 px-4",children:"Job Title"}),a.jsx("th",{className:"py-3 px-4",children:"Email"}),a.jsx("th",{className:"py-3 px-4",children:"Assigned To"}),a.jsx("th",{className:"py-3 px-4",children:"Status"}),a.jsx("th",{className:"py-3 px-4 w-12",children:X.size>0&&a.jsx("button",{onClick:nt,className:"text-orange-500 hover:text-orange-700 transition",title:"Archive selected leads",disabled:ye,children:a.jsx(Zt,{size:18})})})]})}),a.jsx("tbody",{children:Xe.length>0?Je.map(G=>a.jsxs("tr",{className:"hover:bg-gray-50 text-sm cursor-pointer",children:[a.jsx("td",{className:"py-3 px-4",children:n?.id===G.creator?.id&&a.jsx("input",{type:"checkbox",checked:X.has(G.id),onChange:W=>{W.stopPropagation(),He(G.id)},className:"w-4 h-4 cursor-pointer"})}),a.jsx("td",{className:"py-3 px-4 align-top",onClick:()=>ce(G),children:a.jsxs("div",{className:"font-medium text-blue-600 hover:underline break-all text-sm",children:[G.first_name," ",G.last_name]})}),a.jsx("td",{className:"py-3 px-4 align-top",onClick:()=>ce(G),children:a.jsx("div",{className:"font-medium text-gray-800 text-sm leading-tight",children:G.company_name||"--"})}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",onClick:()=>ce(G),children:G.title||"--"}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",onClick:()=>ce(G),children:G.email||"--"}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",onClick:()=>ce(G),children:G.assigned_to?`${G.assigned_to.first_name} ${G.assigned_to.last_name}`:"--"}),a.jsx("td",{className:"py-3 px-4",onClick:()=>ce(G),children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium whitespace-nowrap ${CWe(G.status||"New")}`,children:NWe(G.status||"New")})}),a.jsx("td",{className:"py-3 px-4"})]},G.id)):a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:8,children:"No leads found."})})})]})}),a.jsx(ca,{className:"mt-4",totalItems:Xe.length,pageSize:k,currentPage:S,onPrev:Be,onNext:_e,onPageSizeChange:T,label:"leads"}),i&&a.jsx("div",{id:"modalBackdrop",onClick:ae,className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-full sm:max-w-3xl rounded-2xl shadow-lg p-4 sm:p-6 md:p-8 relative border border-gray-200 overflow-y-auto max-h-[90vh] hide-scrollbar",onClick:G=>G.stopPropagation(),children:[a.jsx("button",{onClick:()=>{ne(),it(!1)},className:"absolute top-4 right-4 text-gray-500 hover:text-black transition",children:a.jsx(ea,{size:22})}),a.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800 mb-4 sm:mb-6 flex items-center justify-center",children:M?"Edit Lead":"Add New Lead"}),a.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 text-sm",children:[a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"First Name"}),a.jsx("input",{type:"text",name:"first_name",value:A.first_name,onChange:ot,placeholder:"Joe",className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:["Last Name ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",placeholder:"Smith",name:"last_name",value:A.last_name,onChange:ot,required:!0,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border
                      ${Re&&!A.last_name?.trim()?"border-red-400 focus:ring-red-400":"border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"}
                  focus:ring-2`})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:["Company ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",placeholder:"ABC Company",name:"company_name",value:A.company_name,onChange:ot,required:!0,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border
                       ${Re&&!A.company_name?.trim()?"border-red-400 focus:ring-red-400":"border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"}
                  focus:ring-2`})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:["Job Title",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",placeholder:"ABC Agenda",name:"title",value:A.title,onChange:ot,required:!0,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border
                       ${Re&&!A.title?.trim()?"border-red-400 focus:ring-red-400":"border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"}
                      focus:ring-2`})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Department"}),a.jsx("input",{type:"text",placeholder:"Sales",name:"department",value:A.department,onChange:ot,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:["Email",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"email",placeholder:"abc@gmail.com",name:"email",value:A.email,onChange:ot,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border
                       ${Re&&!A.email?.trim()?"border-red-400 focus:ring-red-400":"border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"}
                      focus:ring-2`})]}),a.jsxs("div",{className:"flex flex-col col-span-1 md:col-span-2 lg:col-span-1",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Work Phone"}),a.jsxs("div",{className:"w-full border border-gray-300 rounded-md focus-within:ring-2 focus-within:ring-blue-400 outline-none flex flex-row gap-1",children:[a.jsx("select",{name:"work_ccode",value:A.work_ccode,onChange:ot,className:"outline-none cursor-pointer py-1.5 px-2 border-r border-gray-400 text-sm",children:ET.map(G=>a.jsx("option",{value:G.code,children:G.code},G.id))}),a.jsx("input",{type:"text",placeholder:"9----------",name:"work_phone",value:A.work_phone,onChange:ot,className:"w-full outline-none px-2 py-1.5 text-sm"})]})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Mobile Phone 1"}),a.jsxs("div",{className:"w-full border border-gray-300 rounded-md focus-within:ring-2 focus-within:ring-blue-400 outline-none flex flex-row gap-1",children:[a.jsx("select",{name:"m1_ccode",value:A.m1_ccode,onChange:ot,className:"outline-none cursor-pointer py-1.5 px-2 border-r border-gray-400 text-sm",children:ET.map(G=>a.jsx("option",{value:G.code,children:G.code},G.id))}),a.jsx("input",{type:"text",placeholder:"9----------",name:"mobile_phone_1",value:A.mobile_phone_1,onChange:ot,className:"w-full outline-none px-2 py-1.5 text-sm"})]})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Mobile Phone 2"}),a.jsxs("div",{className:"w-full border border-gray-300 rounded-md focus-within:ring-2 focus-within:ring-blue-400 outline-none flex flex-row gap-1",children:[a.jsx("select",{name:"m2_ccode",value:A.m2_ccode,onChange:ot,className:"outline-none cursor-pointer py-1.5 px-2 border-r border-gray-400 text-sm",children:ET.map(G=>a.jsx("option",{value:G.code,children:G.code},G.id))}),a.jsx("input",{type:"text",placeholder:"9----------",name:"mobile_phone_2",value:A.mobile_phone_2,onChange:ot,className:"w-full outline-none px-2 py-1.5 text-sm"})]})]}),a.jsxs("div",{className:"flex flex-col col-span-1 sm:col-span-2 lg:col-span-3",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Address"}),a.jsx("input",{type:"text",name:"address",value:A.address,onChange:ot,placeholder:"Street No., Street Name, City, State/Province, Postal Code",className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none"})]}),a.jsxs("div",{className:"flex flex-col col-span-1 md:col-span-2 lg:col-span-1",children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:["Assign To ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("div",{className:`w-full rounded-lg ${Re&&!A.lead_owner?"border border-red-400":"border border-gray-300"}`,children:a.jsx(TWe,{items:Array.isArray(l)?l:[],value:A.lead_owner??"",placeholder:"Search a user...",getLabel:G=>`${G.first_name} ${G.last_name}`,onChange:G=>{const W=l.find(Y=>String(Y.id)===String(G));d(W);let J=null;W&&W.assigned_territory&&W.assigned_territory.length===1&&(J=W.assigned_territory[0].id),E(Y=>({...Y,lead_owner:G,territory_id:J}))}})})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Territory"}),a.jsxs("select",{name:"territory_id",value:A.territory_id||"",onChange:ot,disabled:!u||!u.assigned_territory||u.assigned_territory.length===0,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm bg-white focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100 disabled:text-gray-500",children:[a.jsx("option",{value:"",disabled:!0,children:u?u.assigned_territory&&u.assigned_territory.length>0?"Select Territory":"No territories assigned to this user":"Select a user first"}),u&&u.assigned_territory&&u.assigned_territory.map(G=>a.jsx("option",{value:G.id,children:G.name},G.id))]})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Source"}),a.jsxs("select",{className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none",defaultValue:"",name:"source",value:A.source,onChange:ot,children:[a.jsx("option",{value:"",disabled:!0,children:"Select Source"}),a.jsx("option",{value:"Website",children:"Website"}),a.jsx("option",{value:"Referral",children:"Referral"}),a.jsx("option",{value:"Cold call",children:"Cold call"}),a.jsx("option",{value:"Event",children:"Event"}),a.jsx("option",{value:"Other",children:"Other"})]})]}),a.jsxs("div",{className:"flex flex-col col-span-1 sm:col-span-2 lg:col-span-3",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Notes"}),a.jsx("textarea",{placeholder:"Additional details...",name:"notes",value:A.notes,onChange:ot,rows:3,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none resize-none"})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-2 mt-4 col-span-1 sm:col-span-2 lg:col-span-3",children:[a.jsx("button",{type:"button",onClick:()=>{ne(),it(!1)},className:"w-full sm:w-auto px-4 py-2 text-white bg-red-400 border border-red-300 rounded hover:bg-red-500 transition disabled:opacity-70",disabled:U||Z,children:"Cancel"}),a.jsx("button",{type:"submit",onClick:St,className:"w-full sm:w-auto px-4 py-2 text-white border border-tertiary bg-tertiary rounded hover:bg-secondary transition disabled:opacity-70",disabled:U||Z,children:U||Z?"Processing...":M?"Update Lead":"Save Lead"})]})]})]})}),R&&a.jsx(_We,{open:!0,title:R.title,message:R.message,confirmLabel:R.confirmLabel,cancelLabel:R.cancelLabel,variant:R.variant,onConfirm:Et,onCancel:Tt,loading:Z}),s&&!i&&!M&&a.jsx(_ee,{relatedActs:oe,lead:s,onBack:Q,fetchLeads:Fe,setSelectedLead:r,onEdit:Te,onArchive:he})]})}function _We({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o=!1,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":i==="archive"?"bg-orange-500 hover:bg-orange-600 border border-orange-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsx("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${u}`,disabled:o,children:o?"Processing...":s})]})]})})}function AWe({icon:e,title:t,value:n,color:s="text-blue-600",bgColor:r="bg-blue-100",onClick:i}){const o=()=>{typeof i=="function"?i():console.log(`Clicked: ${t}`)};return a.jsxs("div",{className:"flex items-center p-4 bg-white rounded-xl shadow-md border border-gray-200 transition-all duration-300",onClick:o,children:[a.jsx("div",{className:`flex-shrink-0 p-3 rounded-full ${r} ${s} mr-4`,children:e?a.jsx(e,{size:22}):null}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:t}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:n})]})]})}function TWe({items:e=[],value:t="",onChange:n,getLabel:s,placeholder:r="Search...",disabled:i=!1,maxRender:o=200}){const[l,c]=f.useState(!1),[u,d]=f.useState(""),h=f.useRef(null),p=e.find(j=>String(j.id)===String(t)),x=p?s(p):"",v=f.useMemo(()=>{const j=u.trim().toLowerCase();return(j?e.filter(N=>(s(N)||"").toLowerCase().includes(j)):e).slice(0,o)},[e,u,s,o]);return f.useEffect(()=>{const j=y=>{h.current&&!h.current.contains(y.target)&&c(!1)};return document.addEventListener("mousedown",j),()=>document.removeEventListener("mousedown",j)},[]),f.useEffect(()=>{l||d("")},[l]),a.jsxs("div",{ref:h,className:"relative w-full",children:[a.jsx("input",{disabled:i,value:l?u:x,placeholder:r,onFocus:()=>!i&&c(!0),onChange:j=>{d(j.target.value),l||c(!0)},className:"w-full rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100"}),l&&!i&&a.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg overflow-hidden",children:[a.jsx("div",{className:"max-h-56 overflow-y-auto",children:v.length>0?v.map(j=>{const y=String(j.id),N=s(j),w=String(t)===y;return a.jsx("button",{type:"button",onClick:()=>{n(y),c(!1)},className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-50 ${w?"bg-blue-50":""}`,children:N||"--"},y)}):a.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No results"})}),e.length>o&&a.jsxs("div",{className:"px-3 py-2 text-[11px] text-gray-400 border-t",children:["Showing first ",o," results  keep typing to narrow."]})]})]})}const Jb={accountName:"Josh Inc.",companyNumber:"09135007323",companyWebsite:"joshenc.com",industry:"Agriculture",billingAddress:"#1 Pilar Las Pinas City",shippingAddress:"#3 BNW ASS-CBN",firstName:"Josh",lastName:"Vergara",department:"Administration",title:"CEO",workPhone:"09253677323",email:"josh@joshinc.com",mobile1:"09253677323",mobile2:"0907452874",dealName:"Josh Deal",dealAmount:"60.00",stage:"Prospecting",territory:"Cavite",description:"Initial lead conversion deal.",dealTitle:"New Client Agreement"},ts=({label:e,value:t,name:n,className:s=""})=>a.jsxs("div",{className:`flex flex-col ${s}`,children:[a.jsx("label",{className:"text-xs text-gray-500 mb-1",children:e}),a.jsx("input",{type:"text",name:n,defaultValue:t,readOnly:!0,className:"w-full border border-gray-300 p-2 rounded-lg text-sm focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 outline-none bg-gray-50"})]}),kWe=({data:e})=>a.jsxs("div",{className:"space-y-6 p-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-700",children:"Account Information"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsx(ts,{label:"Company Number",name:"companyNumber",value:e.companyNumber}),a.jsx(ts,{label:"Company Website",name:"companyWebsite",value:e.companyWebsite}),a.jsx(ts,{label:"Industry",name:"industry",value:e.industry})]}),a.jsx(ts,{label:"Billing Address",name:"billingAddress",value:e.billingAddress,className:"col-span-3"}),a.jsx(ts,{label:"Shipping Address",name:"shippingAddress",value:e.shippingAddress,className:"col-span-3"})]}),EWe=({data:e})=>a.jsxs("div",{className:"space-y-6 p-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-700",children:"Contact Information"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx(ts,{label:"First Name",name:"firstName",value:e.firstName}),a.jsx(ts,{label:"Last Name",name:"lastName",value:e.lastName}),a.jsx(ts,{label:"Department",name:"department",value:e.department}),a.jsx(ts,{label:"Title",name:"title",value:e.title}),a.jsx(ts,{label:"Work Phone",name:"workPhone",value:e.workPhone}),a.jsx(ts,{label:"Email",name:"email",value:e.email}),a.jsx(ts,{label:"Mobile Number 1",name:"mobile1",value:e.mobile1}),a.jsx(ts,{label:"Mobile Number 2",name:"mobile2",value:e.mobile2})]})]}),LWe=({data:e})=>a.jsxs("div",{className:"space-y-6 p-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-700",children:"Deal"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx(ts,{label:"Deal Name",name:"dealName",value:e.dealName}),a.jsxs("div",{className:"flex",children:[a.jsx(ts,{label:"Deal Amount",name:"dealAmount",value:e.dealAmount,className:"flex-grow"}),a.jsx("div",{className:"flex flex-col justify-end ml-1",children:a.jsx("span",{className:"text-sm font-medium text-gray-600 border border-gray-300 bg-gray-100 p-2 rounded-r-lg h-10 flex items-center",children:"PHP"})})]}),a.jsx(ts,{label:"Stage",name:"stage",value:e.stage}),a.jsx(ts,{label:"Territory",name:"territory",value:e.territory})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx(ts,{label:"Description",name:"description",value:e.description}),a.jsx(ts,{label:"Title",name:"dealTitle",value:e.dealTitle})]})]});function PWe({isOpen:e,onClose:t}){const[n,s]=f.useState(1),r=3;if(!e)return null;const i=()=>{n<r?s(n+1):(t(),s(1))},o=()=>{n>1&&s(n-1)},l=[{id:1,name:"Account"},{id:2,name:"Contact"},{id:3,name:"Deal"}],c=()=>{switch(n){case 1:return a.jsx(kWe,{data:Jb});case 2:return a.jsx(EWe,{data:Jb});case 3:return a.jsx(LWe,{data:Jb});default:return null}};return a.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-[800px] h-[600px] overflow-hidden flex flex-col",children:[a.jsxs("div",{className:"p-6 border-b border-gray-200 flex justify-between items-start",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wider",children:"Convert Lead"}),a.jsx("h1",{className:"text-2xl font-bold text-gray-900 mt-1",children:Jb.accountName})]}),a.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition",children:a.jsx(PN,{className:"w-6 h-6"})})]}),a.jsx("div",{className:"flex border-b border-gray-200 bg-gray-50",children:l.map(u=>a.jsx("button",{onClick:()=>s(u.id),className:`flex-1 py-3 px-6 text-sm font-medium transition ${n===u.id?"bg-white text-gray-800 border-b-2 border-indigo-600":"bg-gray-600 text-white hover:bg-gray-700"}`,children:u.name},u.id))}),a.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:c()}),a.jsxs("div",{className:"p-4 border-t border-gray-200 bg-gray-50 flex justify-end space-x-3",children:[n>1&&a.jsx("button",{onClick:o,className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-100 flex items-center",children:"Cancel"}),n<r?a.jsx("button",{onClick:i,className:"px-5 py-2 text-white bg-gray-900 rounded-xl hover:bg-gray-800 transition",children:"Next"}):a.jsx("button",{onClick:i,className:"px-5 py-2 text-white bg-gray-900 rounded-xl hover:bg-gray-800 transition",children:"Convert"})]})]})})}function Aee({selectedDeal:e,onStatusUpdate:t,onClose:n}){const[s,r]=f.useState(e?.stage||""),[i,o]=f.useState(!1),l=kt(),{user:c}=Vt();f.useEffect(()=>{console.log("Group Manager DealsInformation mounted sahdksd",e),console.log("User sadad:",c)},[e,c]);const u=[{value:"PROSPECTING",label:"Prospecting"},{value:"QUALIFICATION",label:"Qualification"},{value:"PROPOSAL",label:"Proposal"},{value:"NEGOTIATION",label:"Negotiation"},{value:"CLOSED_WON",label:"Closed Won"},{value:"CLOSED_LOST",label:"Closed Lost"},{value:"CLOSED_CANCELLED",label:"Closed Cancelled"}];f.useEffect(()=>{e?.stage&&r(e.stage)},[e]);const d=async()=>{if(!e||!e.id){H.error("No deal selected");return}if(!s||s===e.stage){H.info("Please select a different stage");return}const h=e.id;o(!0);try{await re.put(`/deals/admin/${h}`,{stage:s}),n&&n(),t&&setTimeout(async()=>{await t(!0)},100),setTimeout(()=>{H.success("Deal status updated successfully")},300)}catch(p){console.error(p);const x=p.response?.data?.detail||"Failed to update deal status";H.error(x)}finally{o(!1)}};return e?a.jsxs("div",{className:"space-y-4 font-inter text-[13px] w-full sm:w-[85%] mx-auto flex flex-col gap-4",children:[a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Quick Actions"}),a.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[a.jsxs("button",{onClick:()=>{const h=e.account?.id||e.account_id;l("/group-manager/calls",{state:{openCallModal:!0,initialCallData:{subject:e.name?`Call regarding: ${e.name}`:"",relatedType1:"Account",relatedTo1:h,relatedType2:"Deal",relatedTo2:e.id,contactId:e.contact?.id,assigned_to:e.assigned_deals?.id?String(e.assigned_deals.id):"",assignedTo:e.assigned_to?.id?String(e.assigned_to.id):""}}})},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(It,{className:"text-gray-600 w-4 h-4"}),"Schedule Call"]}),a.jsxs("button",{type:"button",onClick:()=>{if(!e.contact?.email){alert("No email address available");return}const h=encodeURIComponent(e.contact.email),p=encodeURIComponent(""),x=encodeURIComponent(""),v=`mailto:${h}?subject=${p}&body=${x}`;window.location.href=v},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(rn,{className:"text-gray-600 w-4 h-4"}),"Send E-mail"]}),a.jsxs("button",{className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",onClick:()=>{const h=e.account?.id||e.account_id;l("/group-manager/meetings",{state:{openMeetingModal:!0,initialMeetingData:{subject:e.name?`Meeting: ${e.name}`:"",relatedType1:"Account",relatedTo1:h,relatedType2:"Deal",relatedTo2:e.id,assignedTo:e.assigned_deals?.id?String(e.assigned_deals.id):""}}})},children:[a.jsx(Ot,{className:"text-gray-600 w-4 h-4"}),"Book Meeting"]}),a.jsxs("button",{onClick:()=>{const h=e.account?.id||e.account_id;l("/group-manager/tasks",{state:{openTaskModal:!0,initialTaskData:{subject:e.name?`Task for: ${e.name}`:"",relatedType1:"Account",relatedTo1:h,relatedType2:"Deal",relatedTo2:e.id,contactId:e.contact?.id,assignedTo:e.assigned_deals?.id?String(e.assigned_deals.id):"",priority:"NORMAL",status:"Not Started"}}})},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(Qt,{className:"text-gray-600 w-4 h-4"}),"Tasks"]})]})]}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm w-full",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Promote Deal"}),a.jsx("select",{className:"border border-gray-200 rounded-md px-2 sm:px-3 py-1.5 w-full text-sm mb-2 focus:ring-2 focus:ring-gray-300 focus:outline-none",value:s,onChange:h=>r(h.target.value),disabled:i||e.created_by!==c?.id&&e.assigned_to!==c?.id,children:u.map(h=>a.jsx("option",{value:h.value,children:h.label},h.value))}),(e.created_by===c?.id||e.assigned_to===c?.id)&&a.jsx("button",{className:"w-full bg-gray-900 text-white py-1.5 rounded-md text-sm hover:bg-gray-800 transition disabled:opacity-50 disabled:cursor-not-allowed",onClick:d,disabled:i||!s||s===e.stage,children:i?"Updating...":"Update"})]})]}):null}function Tee({selectedDeal:e,relatedActs:t={},show:n,onClose:s,activeTab:r,setActiveTab:i,onEdit:o,onDelete:l,onStatusUpdate:c}){const u=kt(),[d]=Bs(),h=d.get("id"),[p,x]=f.useState(e||null),[v,j]=f.useState(r||"Overview"),[y,N]=f.useState(null),{user:w}=Vt(),{comments:S,addComment:_,refresh:k}=kn({relatedType:"deal",relatedId:p?.id});f.useEffect(()=>{p?.id&&k()},[p?.id,k]);const T=r!==void 0?r:v,A=(()=>{const P=String(w?.role||"").toLowerCase();return P==="ceo"||P==="admin"?"admin":P==="manager"?"manager":P==="sales"?"sales":P==="group manager"||P==="group_manager"||P==="group-manager"?"group-manager":"guest"})(),E=P=>{if(!P)return"";const D=String(P).split("-");return D.length===3?`${D[0]}-${D[2]}`:String(P)},M=P=>P?new Date(P).toLocaleString("en-US",{month:"short",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).replace(",",""):"";if(f.useEffect(()=>{(async()=>{if(h&&!e)try{const B=((await re.get("/deals/admin/fetch-all")).data||[]).find(R=>R.id===parseInt(h));if(B){const R={...B,amount:typeof B.amount=="number"?B.amount:parseFloat(B.amount||0),probability:B.probability||0};x(R)}else console.warn("Deal not found with ID:",h)}catch(D){console.error("Error fetching deal:",D)}})()},[h,e]),!p&&!h||h&&!p)return null;const z=P=>({PROSPECTING:"bg-blue-100 text-blue-700",QUALIFICATION:"bg-yellow-100 text-yellow-700",PROPOSAL:"bg-orange-100 text-orange-700",NEGOTIATION:"bg-purple-100 text-purple-700",CLOSED_WON:"bg-green-100 text-green-700",CLOSED_LOST:"bg-red-100 text-red-700"})[P]||"bg-gray-100 text-gray-700";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[9999] font-inter p-2 sm:p-4 overflow-x-hidden",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-lg w-full max-w-full sm:max-w-6xl max-h-[90vh] overflow-y-auto hide-scrollbar relative box-border",children:[a.jsx("div",{className:"bg-tertiary w-full rounded-t-xl p-3 lg:p-3",children:a.jsxs("div",{className:"flex items-start justify-between w-full",children:[a.jsx("h1",{className:"lg:text-3xl text-xl text-white font-semibold text-center w-full",children:"Deal"}),a.jsx("div",{className:"flex items-center gap-2 sm:gap-3",children:a.jsx("button",{onClick:()=>{s?s():u(-1)},className:"text-gray-400 hover:text-white mt-1 cursor-pointer",children:a.jsx(ea,{size:25})})})]})}),a.jsx("div",{className:"p-4 lg:p-2 lg:mx-7",children:a.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-2 sm:gap-3 mt-3",children:[a.jsxs("div",{className:"flex flex-col gap-1",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3 lg:gap-1",children:[a.jsxs("h2",{className:"text-xl lg:text-xl font-semibold text-gray-800 break-words",children:[E(p.deal_id)," - ",p.name]}),a.jsx("span",{className:`text-xs sm:text-sm inline-block font-medium px-1.5 py-0.5 sm:px-3 sm:py-1 rounded-full break-words ${z(p.stage)}`,children:p.stage})]}),a.jsxs("p",{className:"text-gray-500 text-sm break-words",children:["Created on ",M(p.created_at)]})]}),a.jsxs("div",{className:"flex flex-col items-end gap-2",children:[a.jsxs("h2",{className:"text-xl sm:text-2xl font-bold text-gray-600 break-words",children:[" ",p.amount?p.amount.toLocaleString():"0"]}),a.jsx("div",{className:"w-full sm:w-40 bg-gray-200 rounded-full h-2",children:a.jsx("div",{className:"bg-green-500 h-2 rounded-full",style:{width:`${p.probability}%`}})}),a.jsxs("p",{className:"text-xs text-gray-500 break-words",children:[" ",p.probability,"% Complete "]}),p.deal_creator?.id===w?.id&&a.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 mt-3",children:[a.jsxs("button",{type:"button",onClick:()=>{o&&o(p)},className:"inline-flex items-center justify-center bg-blue-500 text-white px-3 sm:px-4 py-1.5 sm:py-2 rounded-md hover:bg-blue-600 transition text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",children:[a.jsx(hn,{className:"mr-1 sm:mr-2",size:16}),a.jsx("span",{className:"hidden sm:inline",children:"Edit"})]}),a.jsxs("button",{type:"button",onClick:()=>{l&&l(p)},className:"inline-flex items-center justify-center px-3 sm:px-4 py-1.5 sm:py-2 rounded-md text-sm bg-orange-500 text-white hover:bg-orange-600 transition focus:outline-none focus:ring-2 focus:ring-orange-400",children:[a.jsx(Zt,{className:"mr-1 sm:mr-2",size:16}),a.jsx("span",{className:"hidden sm:inline",children:"Archive"})]})]})]})]})}),a.jsx("div",{className:"border-b border-gray-200 my-5"}),a.jsxs("div",{className:"p-6 lg:p-4",children:[a.jsx("div",{className:"flex w-full bg-[#6A727D] text-white mt-1 overflow-x-auto mb-6",children:["Overview","Notes","Activities"].map(P=>a.jsx("button",{onClick:()=>{i?i(P):j(P)},className:`flex-1 min-w-[90px] px-4 py-2.5 text-xs sm:text-sm font-medium text-center transition-all duration-200 border-b-2
                ${T===P?"bg-paper-white text-[#6A727D] border-white":"text-white hover:bg-[#5c636d]"}`,children:P},P))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 items-start",children:[a.jsxs("div",{className:"lg:col-span-3 space-y-6",children:[T==="Overview"&&a.jsxs("div",{className:"grid md:grid-cols-2 gap-4 sm:gap-6 w-full",children:[a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 sm:p-5 shadow-sm pb-20 break-words",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 sm:mb-3",children:"Deal Information"}),a.jsxs("p",{className:"text-sm sm:text-sm text-gray-700 mb-2 py-5 break-words",children:[a.jsx("strong",{children:"Description:"})," ",p.description]}),a.jsx("div",{className:"h-px bg-gray-200 w-full"}),a.jsxs("p",{className:"text-sm sm:text-sm text-gray-700 mb-2 py-5 break-words",children:[a.jsx("strong",{children:"Expected Close Date:"})," ",M(p.close_date)||"--"]}),a.jsx("div",{className:"h-px bg-gray-200 w-full"}),a.jsxs("div",{className:"mt-4 py-3 w-full",children:[a.jsxs("div",{className:"relative flex flex-col w-full",children:[a.jsx("div",{className:"absolute top-0 left-0 right-0 flex items-center justify-between w-full",children:(()=>{const P=(p?.stage||"PROSPECTING").toUpperCase(),U=(R=>R==="PROSPECTING"?0:R==="QUALIFICATION"?1:R==="PROPOSAL"?2:R==="NEGOTIATION"?3:R==="CLOSED_WON"||R==="CLOSED_LOST"?4:-1)(P);return[0,1,2,3,4].map(R=>U===R?"orange":U>R?"green":"gray").map((R,q)=>a.jsxs(wt.Fragment,{children:[a.jsx("div",{className:`relative z-10 w-6 h-6 rounded-full border-2 ${R==="green"?"bg-green-500 border-green-500":R==="orange"?"bg-orange-400 border-orange-400":"bg-gray-300 border-gray-300"}`}),q<4&&a.jsx("div",{className:"flex-grow h-1 bg-gray-200 mx-1 min-w-0"})]},q))})()}),a.jsx("div",{className:"flex justify-between mt-8 gap-2 text-[9px] lg:text-[9px] sm:text-xs text-gray-600 w-full",children:["Prospecting","Qualification","Proposal","Negotiation","Closed"].map((P,D)=>a.jsx("span",{className:"text-center flex-1 break-words",children:P},D))})]}),a.jsx("p",{className:"text-sm text-orange-600 font-medium mt-6 text-center break-words",children:p.stage})]})]}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 sm:p-5 shadow-sm break-words",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-3",children:"Contact Information"}),a.jsxs("div",{className:"text-sm sm:text-sm text-gray-700 space-y-3",children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Account:"})," ",p.account?.name]}),a.jsx("div",{className:"h-px bg-gray-200 w-full"}),a.jsxs("p",{children:[a.jsx("strong",{children:"Primary Contact:"})," ",p.contact?.first_name," ",p.contact?.last_name]}),a.jsx("div",{className:"h-px bg-gray-200 w-full"}),a.jsxs("p",{children:[a.jsx("strong",{children:"Phone:"})," ",p.contact?.work_phone]}),a.jsx("div",{className:"h-px bg-gray-200 w-full"}),a.jsxs("p",{children:[a.jsx("strong",{children:"Email:"})," ",p.contact?.email]}),a.jsx("div",{className:"h-px bg-gray-200 w-full"}),a.jsxs("p",{children:[a.jsx("strong",{children:"Assigned To:"})," ",p.assigned_deals?.first_name," ",p.assigned_deals?.last_name]})]})]})]}),T==="Notes"&&a.jsxs("div",{className:"mt-4 w-full",children:[a.jsx("div",{className:"flex flex-wrap items-center justify-between mb-4 gap-2",children:a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words",children:"Deal Note"})}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 shadow-sm break-words",children:[a.jsx("div",{className:"flex items-start justify-between",children:a.jsx("div",{children:a.jsx("p",{className:"text-sm font-medium text-gray-800 break-words",children:"Note"})})}),a.jsx("div",{className:"mt-3 text-sm text-gray-700 whitespace-pre-wrap break-words",children:p.description||"No notes available."})]}),a.jsx(Tn,{comments:S,onAddComment:_})]}),T==="Activities"&&a.jsxs("div",{className:"space-y-2 w-full h-full max-h-[50dvh] overflow-y-auto bg-gray-50 p-2 hide-scrollbar rounded-lg border border-gray-200 shadow-sm",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words border-b border-gray-300 py-2",children:"Related Activities"}),a.jsxs("div",{className:"space-y-2 text-sm",children:[t.tasks&&t.tasks.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>N(y==="tasks"?null:"tasks"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Qt,{className:"text-blue-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Tasks (",t.tasks.length,")"]})]}),y==="tasks"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),y==="tasks"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:t.tasks.map((P,D)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>u(`/${A}/tasks`,{state:{taskID:P.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-blue-600 mt-1",children:a.jsx(Qt,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:P.subject||P.title||"Task"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:P.description||"No description"}),P.assigned_to&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Assigned: ",P.assigned_to.first_name," ",P.assigned_to.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:M(P.due_date||P.created_at)})]},`task-${D}`))})]}),t.meetings&&t.meetings.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>N(y==="meetings"?null:"meetings"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ot,{className:"text-green-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Meetings (",t.meetings.length,")"]})]}),y==="meetings"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),y==="meetings"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:t.meetings.map((P,D)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>u(`/${A}/meetings`,{state:{meetingID:P.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-green-600 mt-1",children:a.jsx(Ot,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:P.subject||P.title||"Meeting"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:P.description||P.location||"No description"}),P.host&&a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Host: ",P.host.first_name," ",P.host.last_name]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:M(P.start_time||P.created_at)})]},`meeting-${D}`))})]}),t.calls&&t.calls.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>N(y==="calls"?null:"calls"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(It,{className:"text-purple-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Calls (",t.calls.length,")"]})]}),y==="calls"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),y==="calls"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:t.calls.map((P,D)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>u(`/${A}/calls`,{state:{callID:P.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-purple-600 mt-1",children:a.jsx(It,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:P.subject||P.title||"Call"}),a.jsx("p",{className:"text-gray-500 break-words text-xs",children:P.direction||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:M(P.call_time||P.created_at)})]},`call-${D}`))})]}),t.quotes&&t.quotes.length>0&&a.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>N(y==="quotes"?null:"quotes"),className:"w-full flex items-center justify-between p-3 hover:bg-gray-50 transition cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ia,{className:"text-orange-600"}),a.jsxs("span",{className:"font-semibold text-gray-700",children:["Quotes (",t.quotes.length,")"]})]}),y==="quotes"?a.jsx(Pt,{className:"text-gray-500"}):a.jsx(Mt,{className:"text-gray-500"})]}),y==="quotes"&&a.jsx("div",{className:"border-t border-gray-200 p-2 space-y-2 max-h-60 overflow-y-auto hide-scrollbar",children:t.quotes.map((P,D)=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start border border-gray-100 rounded-lg p-3 bg-gray-50 w-full break-words cursor-pointer",onClick:()=>u(`/${A}/quotes`,{state:{quoteID:P.id}}),children:[a.jsxs("div",{className:"flex gap-3 mb-2 sm:mb-0 flex-1 min-w-0",children:[a.jsx("div",{className:"text-orange-600 mt-1",children:a.jsx(ia,{size:20})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-blue-600 break-words text-sm",children:(P.quote_id?P.quote_id.replace(/Q(\d+)-\d+-/,"Q$1-"):"--")||"Quote"}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:P.status||""})]})]}),a.jsx("p",{className:"text-xs text-gray-500 break-words",children:M(P.presented_date)||""})]},`quote-${D}`))})]}),(!t||(!t.tasks||t.tasks.length===0)&&(!t.meetings||t.meetings.length===0)&&(!t.calls||t.calls.length===0)&&(!t.quotes||t.quotes.length===0)&&(!t.deals||t.deals.length===0)&&(!t.contacts||t.contacts.length===0))&&a.jsx("div",{className:"text-center py-8 text-gray-500",children:a.jsx("p",{children:"No related activities found for this account."})})]})]}),T==="Edit"&&a.jsxs("div",{className:"mt-4 space-y-4 w-full",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words",children:"Edit Deal"}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 sm:p-5 shadow-sm w-full",children:[a.jsxs("label",{className:"block mb-3 break-words",children:[a.jsx("span",{className:"text-sm text-gray-700",children:"Deal Name"}),a.jsx("input",{type:"text",className:"mt-1 block w-full border border-gray-200 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-gray-200",defaultValue:p.name})]}),a.jsxs("label",{className:"block mb-3 break-words",children:[a.jsx("span",{className:"text-sm text-gray-700",children:"Description"}),a.jsx("textarea",{className:"mt-1 block w-full border border-gray-200 rounded-md px-3 py-2 text-sm h-24 resize-y focus:outline-none focus:ring-2 focus:ring-gray-200",defaultValue:p.description})]}),a.jsx("button",{className:"bg-gray-900 text-white px-4 py-2 rounded-md hover:bg-gray-800",children:"Save Changes"})]})]})]}),a.jsx("div",{className:"w-full lg:w-auto",children:a.jsx(Aee,{selectedDeal:p,onStatusUpdate:c,onClose:s})})]})]})]})})}const DWe=10;function OWe(){f.useEffect(()=>{document.title="Deals | Sari-Sari CRM"},[]);const e=kt(),t=ta(),{user:n}=Vt(),[s,r]=f.useState(""),[i,o]=f.useState("Filter by Stage"),[l,c]=f.useState("Filter by Owner"),[u,d]=f.useState(null),[h,p]=f.useState("Overview"),[x,v]=f.useState(!1),[j,y]=f.useState(null),[N,w]=f.useState(!1),[S,_]=f.useState(1),[k,T]=f.useState(10),[A,E]=f.useState(!1),[M,z]=f.useState(null),[P,D]=f.useState(!1),[U,B]=f.useState(!1),[R,q]=f.useState(null),[Z,V]=f.useState([]),[oe,je]=f.useState([]),[X,se]=f.useState([]),[ye,Ne]=f.useState({}),[fe,we]=f.useState(null),[de,ke]=f.useState(new Set),[ge,$e]=f.useState(!1),be=K=>{if(!K)return"";const ie=String(K).split("-");return ie.length===3?`${ie[0]}-${ie[2]}`:String(K)},me=K=>K?new Date(K).toLocaleString("en-US",{month:"short",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).replace(",",""):"";f.useEffect(()=>{const K=t.state,ie=K?.dealID;if(ie&&!K?.openDealModal){we(ie),e(t.pathname,{replace:!0,state:{}});return}},[t,e]),f.useEffect(()=>{if(fe&&j?.length>0&&!N){const K=j.find(ie=>ie.id===fe);K?d(K):H.error("Deal not found."),we(null)}},[fe,j,N]);const[Ue,Ee]=f.useState({id:null,name:"",account_id:"",primary_contact_id:"",stage:"PROPOSAL",amount:"",close_date:"",assigned_to:"",currency:"PHP",description:""}),[We,tt]=f.useState(null),[lt,Fe]=f.useState(null),st="dealDraft:group-manager/deals",Xe=3600*1e3,Ze=f.useRef(!1);f.useEffect(()=>{if(!Ze.current){Ze.current=!0;try{const K=sessionStorage.getItem(st);if(!K)return;const ie=JSON.parse(K);if(typeof ie?.ts=="number"&&Date.now()-ie.ts>Xe){sessionStorage.removeItem(st);return}if(ie?.returnTo&&ie.returnTo!==t.pathname)return;ie?.dealForm&&typeof ie.dealForm=="object"&&Ee(ie.dealForm),typeof ie?.isEditing=="boolean"&&B(ie.isEditing),ie?.currentDealId!==void 0&&q(ie.currentDealId),v(!0),sessionStorage.removeItem(st)}catch{sessionStorage.removeItem(st)}}},[t.pathname]);const Je=f.useCallback(()=>{try{sessionStorage.setItem(st,JSON.stringify({ts:Date.now(),returnTo:t.pathname,dealForm:Ue,isEditing:U,currentDealId:R}))}catch{}},[st,t.pathname,Ue,U,R]),Be=f.useCallback(()=>{Je(),window.open("/group-manager/accounts?openModal=1","_blank","noopener,noreferrer")},[Je]),_e=f.useCallback(()=>{Je(),window.open("/group-manager/contacts?openModal=1","_blank","noopener,noreferrer")},[Je]),pe={"Prospecting Stage":"PROSPECTING","Qualification Stage":"QUALIFICATION","Proposal Stage":"PROPOSAL","Negotiation Stage":"NEGOTIATION","Closed Won Stage":"CLOSED_WON","Closed Lost Stage":"CLOSED_LOST","Closed Cancelled Stage":"CLOSED_CANCELLED"},ce=K=>({PROSPECTING:"Prospecting",QUALIFICATION:"Qualification",PROPOSAL:"Proposal",NEGOTIATION:"Negotiation",CLOSED_WON:"Closed Won",CLOSED_LOST:"Closed Lost",CLOSED_CANCELLED:"Closed Cancelled"})[K]||K||"--",Q=K=>({PROSPECTING:"bg-blue-100 text-blue-700",QUALIFICATION:"bg-yellow-100 text-yellow-700",PROPOSAL:"bg-orange-100 text-orange-700",NEGOTIATION:"bg-purple-100 text-purple-700",CLOSED_WON:"bg-green-100 text-green-700",CLOSED_LOST:"bg-red-100 text-red-700",CLOSED_CANCELLED:"bg-red-100 text-red-700"})[K]||"bg-gray-100 text-gray-700",ne=K=>{const ie=qe?.find(Me=>Me.id===K);ie&&ie.deal_creator?.id===n?.id&&ke(Me=>{const Ke=new Set(Me);return Ke.has(K)?Ke.delete(K):Ke.add(K),Ke})},ae=()=>{const K=qe?.filter(ie=>ie.deal_creator?.id===n?.id)||[];de.size===K.length&&K.length>0?ke(new Set):ke(new Set(K.map(ie=>ie.id)))},Pe=()=>{if(de.size===0)return;const K=de.size;z({title:"Archive Deals",message:a.jsxs("span",{children:["Are you sure you want to archive"," ",a.jsx("span",{className:"font-semibold",children:K})," deal",K!==1?"s":"","? You can restore them later if needed."]}),confirmLabel:`Archive ${K} Deal${K!==1?"s":""}`,cancelLabel:"Cancel",variant:"archive",action:{type:"bulk-archive",targetIds:Array.from(de),count:K}})},Te=f.useCallback(async K=>{try{const ie=await re.get(`/activities/deal/${K}`);Ne(ie.data&&typeof ie.data=="object"?ie.data:{})}catch(ie){console.error(ie),ie.response?.status===404&&(console.warn("No activities found for this account."),Ne({}))}},[]),he=f.useMemo(()=>{const K=s.trim().toLowerCase(),ie=i.trim(),Me=l.trim();return(j??[]).filter(Ke=>{const gt=[Ke?.name,Ke?.description,Ke?.account?.name,Ke?.contact?.first_name,Ke?.contact?.last_name,Ke?.assigned_deals?.first_name,Ke?.assigned_deals?.last_name],Ct=K===""||gt.some(Ge=>Ge==null||Ge===""?!1:Ge.toString().toLowerCase().includes(K)),Ht=ie==="Filter by Stage"||ie===""||Ke.stage===pe[ie]||Ke.stage===ie,da=Me==="Filter by Owner"||Me===""||`${Ke.assigned_deals?.first_name||""} ${Ke.assigned_deals?.last_name||""}`.trim().toLowerCase()===Me.toLowerCase();return Ct&&Ht&&da})},[j,s,i,l]),He=Math.max(1,Math.ceil(he.length/DWe)||1);f.useEffect(()=>{_(1)},[s,i,l]),f.useEffect(()=>{_(K=>{const ie=Math.max(1,Math.ceil(he.length/k)||1);return K>ie?ie:K})},[he.length,k]);const qe=f.useMemo(()=>{const K=(S-1)*k;return he.slice(K,K+k)},[he,S,k]),nt=()=>_(K=>Math.max(K-1,1)),ot=()=>_(K=>Math.min(K+1,He)),Re=()=>{Ee({id:null,name:"",account_id:"",primary_contact_id:"",stage:"PROPOSAL",amount:"",close_date:"",assigned_to:"",currency:"PHP",description:""}),B(!1),q(null),v(!0)},it=async()=>{w(!0);try{const K=await re.get("/deals/admin/fetch-all"),Me=[...Array.isArray(K.data)?K.data:[]].sort((Ke,gt)=>{const Ct=Ke?.created_at?new Date(Ke.created_at).getTime():0;return(gt?.created_at?new Date(gt.created_at).getTime():0)-Ct});y(Me)}catch(K){K.response&&K.response.status===403?H.error("Permission denied. Only CEO, Admin, or Group Manager can access this page."):H.error("Failed to fetch deals. Please try again later."),console.error(K)}finally{w(!1)}},St=async()=>{try{const K=await re.get("/accounts/admin/fetch-all");V(Array.isArray(K.data)?K.data:[])}catch(K){console.error(K),K.response?.status===403&&H.warn("Unable to load accounts (permission denied).")}},Et=async()=>{try{const K=await re.get("/contacts/admin/fetch-all");je(Array.isArray(K.data)?K.data:[])}catch(K){console.error(K),K.response?.status===403&&H.warn("Unable to load contacts (permission denied).")}},Tt=async()=>{try{const K=await re.get("/users/all");se(Array.isArray(K.data)?K.data:[])}catch(K){console.error(K),K.response?.status===403&&H.warn("Unable to load users (permission denied).")}};f.useEffect(()=>{it(),St(),Et(),Tt()},[]);const Nt=async K=>{K&&(Ee({id:K.id||null,name:K.name||"",account_id:K.account_id?.toString()||"",primary_contact_id:K.primary_contact_id?.toString()||"",stage:K.stage||"PROPOSAL",amount:K.amount?.toString()||"",close_date:K.close_date?new Date(K.close_date).toISOString().split("T")[0]:"",assigned_to:K.assigned_to?.toString()||"",currency:K.currency||"PHP",description:K.description||""}),tt(K.account||null),Fe(K.contact||null),B(!0),q(K.id),d(null),v(!0))},xe=async(K=!1)=>{try{const ie=await re.get("/deals/admin/fetch-all"),Ke=[...Array.isArray(ie.data)?ie.data:[]].sort((gt,Ct)=>{const Ht=gt?.created_at?new Date(gt.created_at).getTime():0;return(Ct?.created_at?new Date(Ct.created_at).getTime():0)-Ht});if(y(Ke),!K&&u&&u.id){const gt=Ke.find(Ct=>Ct.id===u.id);gt&&d({...gt})}}catch(ie){console.error("Failed to refresh deal data:",ie),await it()}},ve=K=>{const ie=K.name.trim();if(!ie){H.error("Deal name is required.");return}if(!K.account_id){H.error("Account is required.");return}const Me=U&&R?"update":"create",Ke=ie;z({title:Me==="create"?"Confirm New Deal":"Confirm Update",message:Me==="create"?a.jsxs("span",{children:["Are you sure you want to create"," ",a.jsx("span",{className:"font-semibold",children:Ke}),"?"]}):a.jsxs("span",{children:["Save changes to ",a.jsx("span",{className:"font-semibold",children:Ke}),"?"]}),confirmLabel:Me==="create"?"Create Deal":"Update Deal",cancelLabel:"Cancel",variant:"primary",action:{type:Me,formData:K,targetId:R||null,name:Ke}})},Oe=K=>{if(!K)return;const ie=K.name||"this deal";z({title:"Archive Deal",message:a.jsxs("span",{children:["Are you sure you want to archive"," ",a.jsx("span",{className:"font-semibold",children:ie}),"? You can restore it later if needed."]}),confirmLabel:"Archive Deal",cancelLabel:"Cancel",variant:"archive",action:{type:"archive-single",targetId:K.id,name:ie}})},Ce=async()=>{if(!M?.action){z(null);return}const{action:K}=M,{type:ie,formData:Me,targetId:Ke,name:gt}=K;D(!0);try{if(ie==="create"){E(!0);const Ct={name:Me.name.trim(),account_id:parseInt(Me.account_id),primary_contact_id:Me.primary_contact_id?parseInt(Me.primary_contact_id):null,stage:Me.stage,amount:Me.amount?parseFloat(Me.amount):null,currency:Me.currency||"PHP",close_date:Me.close_date||null,description:Me.description||null,assigned_to:Me.assigned_to?parseInt(Me.assigned_to):null};await re.post("/deals/admin/create",Ct),H.success(`Deal "${gt}" created successfully.`),v(!1),await it()}else if(ie==="update"){if(!Ke)throw new Error("Missing deal identifier for update.");E(!0);const Ct={};Me.name!==void 0&&(Ct.name=Me.name.trim()),Me.account_id!==void 0&&Me.account_id!==""&&(Ct.account_id=parseInt(Me.account_id)),Me.primary_contact_id!==void 0&&(Ct.primary_contact_id=Me.primary_contact_id?parseInt(Me.primary_contact_id):null),Me.stage!==void 0&&(Ct.stage=Me.stage),Me.amount!==void 0&&Me.amount!==""&&(Ct.amount=parseFloat(Me.amount)),Me.currency!==void 0&&(Ct.currency=Me.currency),Me.close_date!==void 0&&(Ct.close_date=Me.close_date||null),Me.description!==void 0&&(Ct.description=Me.description||null),Me.assigned_to!==void 0&&(Ct.assigned_to=Me.assigned_to?parseInt(Me.assigned_to):null),await re.put(`/deals/admin/${Ke}`,Ct),H.success(`Deal "${gt}" updated successfully.`),v(!1),await it()}else if(ie==="archive-single"){if(!Ke)throw new Error("Missing deal identifier for archiving.");await re.put(`/deals/single-archive/${Ke}`),H.success(`Deal "${gt}" archived successfully.`),u?.id===Ke&&d(null),await it()}else if(ie==="bulk-archive"){if($e(!0),!K.targetIds||K.targetIds.length===0)throw new Error("No deals selected for archiving.");await re.put("/deals/bulk-archive",{deal_ids:K.targetIds}),H.success(`${K.count} deal${K.count!==1?"s":""} archived successfully.`),ke(new Set),u&&K.targetIds.includes(u.id)&&d(null),await it()}}catch(Ct){console.error(Ct);const Ht=ie==="create"?"Failed to create deal. Please review the details and try again.":ie==="update"?"Failed to update deal. Please review the details and try again.":ie==="bulk-archive"?"Failed to archive deals. Please try again.":"Failed to archive deal. Please try again.",da=Ct.response?.data?.detail||Ht;H.error(da)}finally{(ie==="create"||ie==="update")&&E(!1),ie==="bulk-archive"&&$e(!1),D(!1),z(null)}},Qe=()=>{P||z(null)},G=()=>{v(!1),Ee({id:null,name:"",account_id:"",primary_contact_id:"",stage:"PROPOSAL",amount:"",close_date:"",assigned_to:"",currency:"PHP",description:""}),tt(null),Fe(null),B(!1),q(null),E(!1)},W=(j??[]).filter(K=>K.stage==="PROSPECTING").length,J=(j??[]).filter(K=>K.stage==="QUALIFICATION").length,Y=(j??[]).filter(K=>K.stage==="PROPOSAL").length,F=(j??[]).filter(K=>K.stage==="NEGOTIATION").length,ue=(j??[]).filter(K=>K.stage==="CLOSED_WON").length,De=(j??[]).filter(K=>K.stage==="CLOSED_LOST").length,le=(j??[]).filter(K=>K.stage==="CLOSED_CANCELLED").length,Ie=[{title:"Prospecting",value:W,icon:yj,color:"text-blue-600",bgColor:"bg-blue-100"},{title:"Qualification",value:J,icon:gn,color:"text-yellow-600",bgColor:"bg-yellow-100"},{title:"Proposal",value:Y,icon:sa,color:"text-orange-600",bgColor:"bg-orange-100"},{title:"Negotiation",value:F,icon:cd,color:"text-purple-600",bgColor:"bg-purple-100"},{title:"Closed Won",value:ue,icon:Qa,color:"text-green-600",bgColor:"bg-green-100"},{title:"Closed Lost",value:De,icon:Us,color:"text-red-600",bgColor:"bg-red-100"},{title:"Closed Cancelled",value:le,icon:Us,color:"text-gray-600",bgColor:"bg-gray-100"}];return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[N&&a.jsx(Wt,{message:"Loading deals..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h1",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(sa,{className:"mr-2 text-blue-600"}),"Deals"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{onClick:Re,className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 lg:my-0 rounded-md hover:bg-gray-800 text-sm sm:text-base mx-auto sm:ml-auto cursor-pointer",children:[a.jsx(aa,{className:"mr-2"})," Add Deal"]})})]}),a.jsx("div",{className:"grid grid-cols-1 p-2 lg:grid-cols-4 gap-4 mb-6 w-full break-words overflow-hidden",children:Ie.map(K=>a.jsx(IWe,{...K},K.title))}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search deals",value:s,onChange:K=>r(K.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsxs("div",{className:"w-full lg:w-auto flex flex-col lg:flex-row gap-3",children:[a.jsxs("select",{value:i,onChange:K=>o(K.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full lg:w-40 focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{value:"Filter by Stage",children:"Filter by Stage"}),a.jsx("option",{value:"Prospecting Stage",children:"Prospecting"}),a.jsx("option",{value:"Qualification Stage",children:"Qualification"}),a.jsx("option",{value:"Proposal Stage",children:"Proposal"}),a.jsx("option",{value:"Negotiation Stage",children:"Negotiation"}),a.jsx("option",{value:"Closed Won Stage",children:"Closed Won"}),a.jsx("option",{value:"Closed Lost Stage",children:"Closed Lost"}),a.jsx("option",{value:"Closed Cancelled Stage",children:"Closed Cancelled"})]}),a.jsxs("select",{value:l,onChange:K=>c(K.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full lg:w-40 focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{value:"Filter by Owner",children:"Filter by Owner"}),[...new Set((j??[]).map(K=>`${K.assigned_deals?.first_name} ${K.assigned_deals?.last_name}`))].map((K,ie)=>a.jsx("option",{value:K,children:K},ie))]})]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[500px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 text-sm tracking-wide font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 w-12",children:a.jsx("input",{type:"checkbox",checked:de.size>0&&de.size===qe?.filter(K=>K.deal_creator?.id===n?.id).length&&qe?.filter(K=>K.deal_creator?.id===n?.id).length>0,onChange:ae,className:"w-4 h-4 cursor-pointer"})}),a.jsx("th",{className:"py-3 px-4",children:"Deal ID"}),a.jsx("th",{className:"py-3 px-4 truncate",children:"Deal Name"}),a.jsx("th",{className:"py-3 px-4",children:"Account"}),a.jsx("th",{className:"py-3 px-4",children:"Contact"}),a.jsx("th",{className:"py-3 px-4",children:"Stage"}),a.jsx("th",{className:"py-3 px-4",children:"Value"}),a.jsx("th",{className:"py-3 px-4",children:"Close Date"}),a.jsx("th",{className:"py-3 px-4",children:"Owner"}),a.jsx("th",{className:"py-3 px-4 w-12",children:de.size>0&&a.jsx("button",{onClick:Pe,className:"text-orange-500 hover:text-orange-700 transition",title:"Archive selected deals",disabled:ge,children:a.jsx(Zt,{size:18})})})]})}),a.jsx("tbody",{children:he.length>0?qe.map(K=>a.jsxs("tr",{className:"hover:bg-gray-50 text-sm cursor-pointer",onClick:()=>{d({...K}),Te(K.id)},children:[a.jsx("td",{className:"py-3 px-4",children:n?.id===K.deal_creator?.id&&a.jsx("input",{type:"checkbox",checked:de.has(K.id),onClick:ie=>{ie.stopPropagation()},onChange:ie=>{ie.stopPropagation(),ne(K.id)},className:"w-4 h-4 cursor-pointer"})}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",children:be(K.deal_id)}),a.jsx("td",{className:"py-3 px-4",children:a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-blue-600 hover:underline break-all text-sm",children:K.name}),a.jsx("div",{className:"text-gray-500 text-xs break-all",children:K.description||"--"})]})}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",children:K.account?.name||"--"}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",children:K.contact?.first_name&&K.contact?.last_name?`${K.contact.first_name} ${K.contact.last_name}`:K.contact?.first_name||K.contact?.last_name||"--"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${Q(K.stage)}`,children:ce(K.stage)})}),a.jsxs("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",children:[" ",K.amount?.toLocaleString()||"0"]}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",children:me(K.close_date)||"--"}),a.jsx("td",{className:"py-3 px-4 text-gray-800 font-medium text-sm",children:K.assigned_deals?.first_name&&K.assigned_deals?.last_name?`${K.assigned_deals.first_name} ${K.assigned_deals.last_name}`:K.assigned_deals?.first_name||K.assigned_deals?.last_name||"--"})]},K.id)):a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:10,children:"No deals found."})})})]})}),a.jsx(ca,{className:"mt-4",totalItems:he.length,pageSize:k,currentPage:S,onPrev:nt,onNext:ot,onPageSizeChange:T,label:"deals"}),x&&a.jsx($We,{onClose:G,formData:Ue,setFormData:Ee,isEditing:U,onSubmit:ve,isSubmitting:A||P,accounts:Z,contacts:oe,users:X,currentAccount:We,currentContact:lt,onAddAccount:Be,onAddContact:_e,onRefreshAccounts:St,onRefreshContacts:Et}),u&&a.jsx(Tee,{relatedActs:ye,selectedDeal:u,show:!!u,onClose:()=>d(null),activeTab:h,setActiveTab:p,onEdit:Nt,onDelete:Oe,onStatusUpdate:xe}),M&&a.jsx(MWe,{open:!0,title:M.title,message:M.message,confirmLabel:M.confirmLabel,cancelLabel:M.cancelLabel,variant:M.variant,onConfirm:Ce,onCancel:Qe,loading:P})]})}function MWe({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o=!1,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="archive"?"bg-orange-500 hover:bg-orange-600 border border-orange-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[10000]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsx("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${u}`,disabled:o,children:o?"Processing...":s})]})]})})}function IWe({icon:e,title:t,value:n,color:s="text-blue-600",bgColor:r="bg-blue-100",onClick:i}){const o=()=>{typeof i=="function"?i():console.log(`Clicked: ${t}`)};return a.jsxs("div",{className:"flex items-center p-4 bg-white rounded-xl shadow-md border border-gray-200 transition-all duration-300",onClick:o,children:[a.jsx("div",{className:`flex-shrink-0 p-3 rounded-full ${r} ${s} mr-4`,children:e?a.jsx(e,{size:22}):null}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:t}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:n})]})]})}function $We({onClose:e,formData:t,setFormData:n,isEditing:s=!1,onSubmit:r,isSubmitting:i=!1,accounts:o=[],contacts:l=[],users:c=[],currentAccount:u=null,currentContact:d=null,onAddAccount:h,onAddContact:p,onRefreshAccounts:x,onRefreshContacts:v}){const[j,y]=f.useState(!1),N=_=>{if(_.preventDefault(),y(!0),!t.name?.trim()){H.error("Deal name is required.");return}const k=Number(t.amount);if(!t.amount||isNaN(k)||k<=0){H.error("Amount must be a number greater than 0.");return}if(!t.account_id){H.error("Please select an account.");return}if(!t.primary_contact_id){H.error("Please select a primary contact.");return}if(!t.assigned_to){H.error("Please assign this deal to a user.");return}r?.(t)},w=_=>{_.target.id==="modalBackdrop"&&e()},S=f.useMemo(()=>{const _=String(t.account_id||"").trim(),k=Array.isArray(l)?l:[];return _?k.filter(T=>{const E=[T?.account_id,T?.accountId,T?.account?.id,T?.account?.account_id,T?.account?.accountId].find(M=>M!=null&&String(M).trim()!=="");return E?String(E)===_:!1}):k},[l,t.account_id]);return f.useEffect(()=>{const _=String(t.account_id||"").trim(),k=String(t.primary_contact_id||"").trim();if(!k||!_)return;S.some(A=>String(A?.id)===k)||n(A=>({...A,primary_contact_id:""}))},[t.account_id,t.primary_contact_id,S,n]),a.jsx("div",{id:"modalBackdrop",onClick:w,className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-full sm:max-w-3xl rounded-2xl shadow-lg p-4 sm:p-6 md:p-8 relative border border-gray-200 overflow-y-auto max-h-[90vh] hide-scrollbar",onClick:_=>_.stopPropagation(),children:[a.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-gray-500 hover:text-black transition",children:a.jsx(ea,{size:22})}),a.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800 mb-4 sm:mb-6 flex items-center justify-center",children:s?"Edit Deal":"Create Deal"}),a.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",onSubmit:N,noValidate:!0,children:[a.jsx(PT,{label:"Deal Name",name:"name",value:t.name,onChange:_=>n({...t,name:_.target.value}),placeholder:"Enter deal name",required:!0,isSubmitted:j,className:"md:col-span-2"}),a.jsx(DT,{label:"Account",value:t.account_id||"",onChange:_=>n({...t,account_id:_}),items:o||[],getLabel:_=>_?.name??"",placeholder:"Search account...",disabled:i,currentItem:u,actions:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{type:"button",onClick:h,disabled:i,title:"Add account",className:"inline-flex items-center justify-center w-8 h-8 rounded-md border border-gray-300 text-gray-600 hover:bg-gray-50 transition disabled:opacity-60",children:a.jsx(aa,{size:16})}),a.jsx("button",{type:"button",onClick:x,disabled:i,title:"Refresh accounts",className:"inline-flex items-center justify-center w-8 h-8 rounded-md border border-gray-300 text-gray-600 hover:bg-gray-50 transition disabled:opacity-60",children:a.jsx(Br,{size:16})})]}),required:!0,isSubmitted:j}),a.jsx(DT,{label:"Primary Contact",value:t.primary_contact_id||"",onChange:_=>n({...t,primary_contact_id:_}),items:S||[],getLabel:_=>`${_?.first_name??""} ${_?.last_name??""}`.trim()||_?.email||"",placeholder:"Search contact...",disabled:i,currentItem:d,actions:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{type:"button",onClick:p,disabled:i,title:"Add contact",className:"inline-flex items-center justify-center w-8 h-8 rounded-md border border-gray-300 text-gray-600 hover:bg-gray-50 transition disabled:opacity-60",children:a.jsx(aa,{size:16})}),a.jsx("button",{type:"button",onClick:v,disabled:i,title:"Refresh contacts",className:"inline-flex items-center justify-center w-8 h-8 rounded-md border border-gray-300 text-gray-600 hover:bg-gray-50 transition disabled:opacity-60",children:a.jsx(Br,{size:16})})]}),required:!0,isSubmitted:j}),a.jsx(rH,{label:"Stage",name:"stage",value:t.stage,onChange:_=>n({...t,stage:_.target.value}),options:[{value:"PROSPECTING",label:"Prospecting"},{value:"QUALIFICATION",label:"Qualification"},{value:"PROPOSAL",label:"Proposal"},{value:"NEGOTIATION",label:"Negotiation"},{value:"CLOSED_WON",label:"Closed Won"},{value:"CLOSED_LOST",label:"Closed Lost"},{value:"CLOSED_CANCELLED",label:"Closed Cancelled"}],disabled:i}),a.jsx(PT,{label:"Amount",name:"amount",type:"number",step:"0.01",value:t.amount,onChange:_=>n({...t,amount:_.target.value}),placeholder:"0",required:!0,isSubmitted:j}),a.jsx(rH,{label:"Currency",name:"currency",value:t.currency||"PHP",onChange:_=>n({...t,currency:_.target.value}),options:[{value:"PHP",label:"PHP"},{value:"USD",label:"USD"}],disabled:i}),a.jsx(PT,{label:"Close Date",name:"close_date",type:"date",value:t.close_date||"",onChange:_=>n({...t,close_date:_.target.value}),disabled:i}),a.jsx(DT,{label:"Assign To",value:t.assigned_to||"",onChange:_=>n({...t,assigned_to:_}),items:c||[],getLabel:_=>`${_?.first_name??""} ${_?.last_name??""}`.trim()||_?.email||"",placeholder:"Search assignee...",disabled:i,required:!0,isSubmitted:j,className:"md:col-span-2"}),a.jsx(zWe,{label:"Description",name:"description",value:t.description,onChange:_=>n({...t,description:_.target.value}),placeholder:"Additional details...",rows:3,className:"md:col-span-2",disabled:i}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-2 md:col-span-2 mt-4",children:[a.jsx("button",{type:"button",onClick:e,className:"w-full sm:w-auto px-4 py-2 text-white bg-red-400 border border-red-300 rounded hover:bg-red-500 transition disabled:opacity-70",disabled:i,children:"Cancel"}),a.jsx("button",{type:"submit",className:"w-full sm:w-auto px-4 py-2 text-white border border-tertiary bg-tertiary rounded hover:bg-secondary transition disabled:opacity-70",disabled:i,children:i?"Saving...":s?"Update Deal":"Save Deal"})]})]})]})})}function PT({label:e,name:t,value:n,onChange:s,placeholder:r,type:i="text",required:o=!1,disabled:l=!1,className:c="",isSubmitted:u=!1}){const d=u&&!n?.trim();return a.jsxs("div",{className:c,children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",o&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:i,name:t,value:n??"",onChange:s,placeholder:r,required:o,disabled:l,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border focus:ring-2
          ${d?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}
          ${c}
        `})]})}function rH({label:e,name:t,value:n,onChange:s,options:r,required:i=!1,disabled:o=!1,className:l=""}){return a.jsxs("div",{className:l,children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsx("select",{name:t,value:n??"",onChange:s,required:i,disabled:o,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100",children:r.map(c=>a.jsx("option",{value:c.value,children:c.label},c.value))})]})}function DT({label:e,items:t=[],value:n="",onChange:s,getLabel:r,placeholder:i="Search...",disabled:o=!1,className:l="",currentItem:c=null,required:u=!1,isSubmitted:d=!1,actions:h=null}){const p=d&&u&&!n;return a.jsxs("div",{className:l,children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",u&&a.jsx("span",{className:"text-red-500",children:"*"})]}),h?a.jsx("div",{className:"flex items-center",children:h}):null]}),a.jsx(RWe,{items:t,value:n??"",onChange:s,getLabel:r,placeholder:i,disabled:o,currentItem:c,hasError:p})]})}function RWe({items:e=[],value:t="",onChange:n,getLabel:s,placeholder:r="Search...",disabled:i=!1,maxRender:o=200,currentItem:l=null,hasError:c=!1}){const[u,d]=f.useState(!1),[h,p]=f.useState(""),x=f.useRef(null),j=e.find(w=>String(w.id)===String(t))||l,y=j?s(j):"",N=f.useMemo(()=>{const w=h.trim().toLowerCase();return(w?e.filter(_=>(s(_)||"").toLowerCase().includes(w)):e).slice(0,o)},[e,h,s,o]);return f.useEffect(()=>{const w=S=>{x.current&&!x.current.contains(S.target)&&d(!1)};return document.addEventListener("mousedown",w),()=>document.removeEventListener("mousedown",w)},[]),f.useEffect(()=>{u||p("")},[u]),a.jsxs("div",{ref:x,className:"relative w-full",children:[a.jsx("input",{disabled:i,value:u?h:y,placeholder:r,onFocus:()=>!i&&d(!0),onChange:w=>{p(w.target.value),u||d(!0)},className:`w-full border rounded-md px-2 py-1.5 text-sm outline-none focus:ring-2
          ${c?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}`}),u&&!i&&a.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg overflow-hidden",children:[a.jsx("div",{className:"max-h-56 overflow-y-auto hide-scrollbar",children:N.length>0?N.map(w=>{const S=String(w.id),_=s(w),k=String(t)===S;return a.jsx("button",{type:"button",onClick:()=>{n(S),d(!1)},className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-50 ${k?"bg-blue-50":""}`,children:_||"--"},S)}):a.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No results"})}),e.length>o&&a.jsxs("div",{className:"px-3 py-2 text-[11px] text-gray-400 border-t",children:["Showing first ",o," results  keep typing to narrow."]})]})]})}function zWe({label:e,name:t,value:n,onChange:s,placeholder:r,required:i=!1,disabled:o=!1,className:l="",rows:c=3}){return a.jsxs("div",{className:l,children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsx("textarea",{name:t,value:n??"",onChange:s,placeholder:r,required:i,disabled:o,rows:c,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100 resize-none"})]})}const OT=[{value:"Draft",label:"Draft"},{value:"Presented",label:"Presented"},{value:"Accepted",label:"Accepted"},{value:"Rejected",label:"Rejected"}],MT={deal_id:"",account_id:"",contact_id:"",total_amount:"",presented_date:"",validity_days:"",status:"Draft",assigned_to:"",notes:"",subtotal:0,tax_rate:0,tax_amount:0,discount_type:"",discount_value:0,discount_amount:0,currency:"PHP",items:[]},Fi=e=>{if(!e)return"Draft";const t=e.toString().trim().toLowerCase();return{draft:"Draft",presented:"Presented",accepted:"Accepted",rejected:"Rejected"}[t]||"Draft"},IT=e=>e?e.toString().toLowerCase().replace(/\b\w/g,t=>t.toUpperCase()):"--",FWe=e=>{switch(Fi(e).toLowerCase()){case"draft":return"bg-gray-100 text-gray-700";case"presented":return"bg-yellow-100 text-yellow-700";case"accepted":return"bg-green-100 text-green-700";case"rejected":return"bg-orange-100 text-orange-700";default:return"bg-gray-100 text-gray-700"}},UWe=e=>{switch(Fi(e).toLowerCase()){case"draft":return"bg-gray-600 text-white";case"presented":return"bg-yellow-600 text-white";case"accepted":return"bg-green-600 text-white";case"rejected":return"bg-orange-600 text-white";default:return"bg-gray-600 text-white"}},ev=e=>e?new Date(e).toLocaleString("en-US",{month:"2-digit",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).replace(",",""):"",zg=e=>e?new Date(e).toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"numeric"}):"",BWe=e=>{if(!e)return"";if(typeof e=="string"&&e.match(/^\d{4}-\d{2}-\d{2}$/))return e;try{const t=new Date(e);if(isNaN(t.getTime()))return"";const n=t.getFullYear(),s=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0");return`${n}-${s}-${r}`}catch{return""}},$T=(e,t)=>{if(!e||t==null||t==="")return"";const n=Number(t);if(Number.isNaN(n))return"";const s=new Date(e);return isNaN(s.getTime())?"":(s.setDate(s.getDate()+n),s.toISOString().slice(0,10))},iH=e=>{if(!e)return"";const t=String(e).split("-");return t.length===3?`${t[0]}-${t[2]}`:String(e)},RT=e=>{if(!e)return"";const t=String(e).split("-");return t.length===3?`${t[0]}-${t[2]}`:String(e)},nj=e=>{if(!e)return null;if(typeof e=="number")return e;if(typeof e=="string"&&e.trim()&&!Number.isNaN(Number(e)))return Number(e);if(typeof e=="object"){if(e.id&&!Number.isNaN(Number(e.id)))return Number(e.id);if(e.user?.id&&!Number.isNaN(Number(e.user.id)))return Number(e.user.id);if(e.data?.id&&!Number.isNaN(Number(e.data.id)))return Number(e.data.id);if(e.profile?.id&&!Number.isNaN(Number(e.profile.id)))return Number(e.profile.id)}return null},HWe=()=>{const e=["user","currentUser","userData","authUser","profile"];for(const s of e){const r=localStorage.getItem(s);if(r)try{const i=JSON.parse(r),o=nj(i);if(o)return o}catch{}}const t=localStorage.getItem("user_id"),n=nj(t);return n||null},qWe=e=>{if(!e)return"";const n=[e.account_id,e.accountId,e.account?.id,e.account?.account_id,e.account?.accountId].find(s=>s!=null&&String(s).trim()!=="");return n?String(n):""},GWe=e=>{if(!e)return"";const n=[e.contact_id,e.contactId,e.contact?.id,e.primary_contact_id,e.primaryContactId,e.primary_contact?.id,e.primaryContact?.id].find(s=>s!=null&&String(s).trim()!=="");return n?String(n):""},WWe=e=>{if(!e)return"";const n=[e.assigned_user?.id,e.assigned_to?.id,e.assigned_to,e.assigned_user_id].find(s=>s!=null&&String(s).trim()!=="");return n?String(n):""};function VWe(){const e=kt(),t=ta(),{user:n}=Vt(),s=n?.company?.currency||"";f.useEffect(()=>{document.title="Quotes | Sari-Sari CRM"},[]);const[r,i]=f.useState([]),[o,l]=f.useState(!1),[c,u]=f.useState([]),[d,h]=f.useState([]),[p,x]=f.useState([]),[v,j]=f.useState([]),[y,N]=f.useState(null),[w,S]=f.useState(null),[_,k]=f.useState(!1),[T,A]=f.useState(!1),[E,M]=f.useState(!1),[z,P]=f.useState(null),[D,U]=f.useState(!1),[B,R]=f.useState(!1),[q,Z]=f.useState(null),[V,oe]=f.useState(MT),[je,X]=f.useState(""),[se,ye]=f.useState("Filter by Status"),[Ne,fe]=f.useState(null),we=f.useCallback(async()=>{if(w)try{R(!0);const ee=(await re.get("/company/invoice-info"))?.data;e(`/group-manager/quotes/${encodeURIComponent(w.id)}/print`,{state:{quote:w,companyInfo:ee}})}catch(L){const ee=L?.response?.data?.detail||L?.message||"Failed to open print page.";H.error(ee)}finally{R(!1)}},[w,e]),[de,ke]=f.useState(1),[ge,$e]=f.useState(10),[be,me]=f.useState("Overview"),[Ue,Ee]=f.useState("Draft"),[We,tt]=f.useState([]),[lt,Fe]=f.useState(null),st=f.useMemo(()=>WWe(w),[w]),{comments:Xe,addComment:Ze,refresh:Je}=kn({relatedType:"quote",relatedId:w?.id});f.useEffect(()=>{w?.id&&Je()},[w?.id,Je]),f.useEffect(()=>{const ee=t.state?.quoteID;if(ee){Fe(ee),e(t.pathname,{replace:!0,state:{}});return}},[t,e]),f.useEffect(()=>{if(lt&&r.length>0&&!o){const L=r.find(ee=>ee.id===lt);L?S(L):H.error("Quote not found."),Fe(null)}},[lt,r,o]),f.useEffect(()=>{let L=!0;return(async()=>{const Le=HWe();if(Le&&L){N(Le);return}try{const ze=await re.get("/auth/me"),Ve=nj(ze?.data);if(Ve&&L){N(Ve);return}}catch{}try{const ze=await re.get("/users/me"),Ve=nj(ze?.data);if(Ve&&L){N(Ve);return}}catch{}L&&N(null)})(),()=>{L=!1}},[]);const Be=f.useCallback(L=>L&&d.find(Le=>String(Le.id)===String(L))?.name||"",[d]),_e=f.useCallback(L=>{if(!L)return"";const ee=p.find(Le=>String(Le.id)===String(L));return ee?`${ee.first_name} ${ee.last_name}`.trim():""},[p]),pe=f.useCallback(L=>{if(!L)return"--";const ee=c.find(Le=>String(Le.id)===String(L));return ee?.deal_name||ee?.name||`Deal #${iH(L)}`},[c]),ce=f.useCallback(L=>{const ee=c.find(Ve=>String(Ve.id)===String(L)),Le=qWe(ee);let ze=GWe(ee);if(!ze&&Le){const Ve=p.filter(ft=>String(ft.account_id||"")===String(Le));if(Ve.length>0){const ft=[...Ve].sort((_t,At)=>{const Yt=`${_t.first_name||""} ${_t.last_name||""}`.trim().toLowerCase(),En=`${At.first_name||""} ${At.last_name||""}`.trim().toLowerCase();return Yt.localeCompare(En)});ze=String(ft[0].id)}}if(Le&&ze){const Ve=p.find(ft=>String(ft.id)===String(ze));Ve?.account_id&&String(Ve.account_id)!==String(Le)&&(ze="")}return{accountId:Le||"",contactId:ze||""}},[c,p]),Q=f.useCallback(L=>{if(!L)return"--";if(L.deal?.deal_name)return L.deal.deal_name;if(L.deal?.name)return L.deal.name;const ee=L.deal_id||L.deal?.id;return ee?pe(ee):"--"},[pe]),ne=f.useCallback(L=>{if(!L)return"--";if(L.account?.name)return L.account.name;let ee=L.account_id||L.account?.id;if(!ee){const Le=L.deal_id||L.deal?.id;Le&&(ee=ce(Le).accountId)}return ee?Be(ee)||`Account #${ee}`:"--"},[ce,Be]),ae=f.useCallback(L=>{if(!L)return"--";if(L.contact?.first_name||L.contact?.last_name)return`${L.contact?.first_name||""} ${L.contact?.last_name||""}`.trim()||"--";let ee=L.contact_id||L.contact?.id;if(!ee){const ze=L.deal_id||L.deal?.id;ze&&(ee=ce(ze).contactId)}return(ee?_e(ee):"")||(ee?`Contact #${ee}`:"--")},[ce,_e]),Pe=f.useCallback(async(L=null)=>{l(!0);try{const ee=await re.get("/quotes/admin/fetch-all"),ze=[...Array.isArray(ee.data)?ee.data:[]].sort((Ve,ft)=>{const _t=Ve?.created_at||Ve?.updated_at||0,At=ft?.created_at||ft?.updated_at||0;return new Date(At)-new Date(_t)});if(i(ze),L){const Ve=ze.find(ft=>ft.id===L);S(Ve||null)}}catch(ee){console.error(ee),i([]),ee.response?.status===403?H.error("Permission denied. Only CEO, Admin, or Group Manager can access this page."):H.error("Failed to fetch quotes. Please try again later.")}finally{l(!1)}},[]),Te=f.useCallback(async()=>{try{const L=await re.get("/deals/admin/fetch-all");u(Array.isArray(L.data)?L.data:[])}catch(L){console.error(L),L.response?.status===403&&H.warn("Unable to load deals (permission denied).")}},[]),he=f.useCallback(async()=>{try{const L=await re.get("/accounts/admin/fetch-all");h(Array.isArray(L.data)?L.data:[])}catch(L){console.error(L),L.response?.status===403&&H.warn("Unable to load accounts (permission denied).")}},[]),He=f.useCallback(async()=>{try{const L=await re.get("/contacts/admin/fetch-all");x(Array.isArray(L.data)?L.data:[])}catch(L){console.error(L),L.response?.status===403&&H.warn("Unable to load contacts (permission denied).")}},[]),qe=f.useCallback(async()=>{try{const L=await re.get("/users/all");j(Array.isArray(L.data)?L.data:[])}catch(L){console.error(L),L.response?.status===403&&H.warn("Unable to load users (permission denied).")}},[]);f.useEffect(()=>{Pe(),Te(),he(),He(),qe()},[Pe,Te,he,He,qe]);const nt=f.useMemo(()=>{const L=je.trim().toLowerCase(),ee=se.trim();return r.filter(Le=>{const ze=Q(Le),Ve=ne(Le),ft=ae(Le),_t=$T(Le.presented_date,Le.validity_days),At=[Le.quote_id,ze,Ve,ft,Le.total_amount?.toString(),Le.validity_days?.toString(),Le.presented_date?zg(Le.presented_date):"",_t?zg(_t):"",Le.assigned_user?.first_name,Le.assigned_user?.last_name,Le.creator?.first_name,Le.creator?.last_name,Le.status,Le.notes,ev(Le.created_at),ev(Le.updated_at)],Yt=L===""||At.some(Qr=>Qr==null?!1:Qr.toString().toLowerCase().includes(L)),En=ee==="Filter by Status"||Fi(Le.status)===ee;return Yt&&En})},[r,je,se,Q,ne,ae]),ot=Math.max(1,Math.ceil(nt.length/ge)||1);f.useEffect(()=>ke(1),[je,se]),f.useEffect(()=>{ke(L=>{const ee=Math.max(1,Math.ceil(nt.length/ge)||1);return L>ee?ee:L})},[nt.length,ge]);const Re=f.useMemo(()=>{const L=(de-1)*ge;return nt.slice(L,L+ge)},[nt,de,ge]),it=()=>ke(L=>Math.max(L-1,1)),St=()=>ke(L=>Math.min(L+1,ot)),Et=L=>{S(L),me("Overview"),Ee(Fi(L?.status)||"Draft")},Tt=()=>{S(null),me("Overview")},Nt=L=>{L.target.id==="quoteModalBackdrop"&&!D&&Tt()},xe=f.useCallback(()=>{k(!1),A(!1),Z(null),oe(MT),M(!1)},[]),ve=L=>{L.target.id==="modalBackdrop"&&!E&&!D&&xe()},Oe=L=>{const{name:ee,value:Le}=L.target;if(ee==="deal_id"){const{accountId:ze,contactId:Ve}=ce(Le);oe(ft=>({...ft,deal_id:Le,account_id:ze,contact_id:Ve}));return}oe(ze=>({...ze,[ee]:Le}))},Ce=()=>{oe(MT),A(!1),Z(null),k(!0)},Qe=L=>{if(!L)return;S(null);const ee=L.deal?.id?String(L.deal.id):L.deal_id?String(L.deal_id):"",Le=ee?ce(ee):{accountId:"",contactId:""},ze=L.account?.id?String(L.account.id):L.account_id?String(L.account_id):Le.accountId,Ve=L.contact?.id?String(L.contact.id):L.contact_id?String(L.contact_id):Le.contactId,ft=L.assigned_user?.id?String(L.assigned_user.id):L.assigned_to?String(L.assigned_to):"";oe({deal_id:ee,account_id:ze||"",contact_id:Ve||"",total_amount:L.total_amount?.toString()||"",presented_date:BWe(L.presented_date),validity_days:L.validity_days!==null&&L.validity_days!==void 0?String(L.validity_days):"",status:Fi(L.status)||"Draft",assigned_to:ft,notes:L.notes||"",subtotal:parseFloat(L.subtotal)||0,tax_rate:parseFloat(L.tax_rate)||0,tax_amount:parseFloat(L.tax_amount)||0,discount_type:L.discount_type||"",discount_value:parseFloat(L.discount_value)||0,discount_amount:parseFloat(L.discount_amount)||0,currency:L.currency||"PHP",items:Array.isArray(L.items)?L.items.map(_t=>({id:_t.id,item_type:_t.item_type||"Product",name:_t.name||"",description:_t.description||"",sku:_t.sku||"",variant:_t.variant||"",unit:_t.unit||"pcs",quantity:parseFloat(_t.quantity)||1,unit_price:parseFloat(_t.unit_price)||0,discount_percent:parseFloat(_t.discount_percent)||0,discount_amount:parseFloat(_t.discount_amount)||0,line_total:parseFloat(_t.line_total)||0,sort_order:_t.sort_order||0})):[]}),A(!0),Z(L.id),k(!0)},G=L=>{if(L.target.checked){const ee=Re.filter(Le=>Le.created_by===y).map(Le=>Le.id);tt(ee)}else tt([])},W=L=>{tt(ee=>ee.includes(L)?ee.filter(Le=>Le!==L):[...ee,L])},J=Re.filter(L=>L.created_by===y),Y=L=>{if(!L)return;const ee=L.quote_id||"this quote";P({title:"Archive Quote",message:a.jsxs("span",{children:["Are you sure you want to archive"," ",a.jsx("span",{className:"font-semibold",children:ee}),"? This action cannot be undone."]}),confirmLabel:"Archive Quote",cancelLabel:"Cancel",variant:"danger",action:{type:"delete",targetId:L.id,name:ee}})},F=async()=>{We.length!==0&&P({title:"Archive Quotes",message:a.jsxs("span",{children:["Are you sure you want to archive"," ",a.jsx("span",{className:"font-semibold",children:We.length})," selected quotes? This action cannot be undone."]}),confirmLabel:`Archive ${We.length} Quote(s)`,cancelLabel:"Cancel",variant:"danger",action:{type:"bulk-delete",quote_ids:We}})},[ue,De]=f.useState(!1),le=L=>{if(L.preventDefault(),De(!0),!y){H.error("Unable to determine current user. Please log in again.");return}if(!V.deal_id){H.error("Deal is required.");return}if(!V.assigned_to){H.error("Assigned To is required.");return}const Le=ce(V.deal_id),ze=V.items.map((Yt,En)=>({item_type:Yt.item_type||"Product",name:Yt.name,description:Yt.description||null,sku:Yt.sku||null,variant:Yt.variant||null,unit:Yt.unit||null,quantity:parseFloat(Yt.quantity)||1,unit_price:parseFloat(Yt.unit_price)||0,discount_percent:parseFloat(Yt.discount_percent)||0,sort_order:Yt.sort_order??En})),Ve={deal_id:Number(V.deal_id),account_id:Le.accountId?Number(Le.accountId):null,contact_id:Le.contactId?Number(Le.contactId):null,subtotal:parseFloat(V.subtotal)||0,tax_rate:parseFloat(V.tax_rate)||0,tax_amount:parseFloat(V.tax_amount)||0,discount_type:V.discount_type||null,discount_value:parseFloat(V.discount_value)||0,discount_amount:parseFloat(V.discount_amount)||0,total_amount:parseFloat(V.total_amount)||0,currency:V.currency||"PHP",presented_date:V.presented_date||null,validity_days:V.validity_days===""?null:Number(V.validity_days),status:V.status||"Draft",assigned_to:V.assigned_to?Number(V.assigned_to):null,notes:V.notes?.trim()||null,items:ze},ft=T&&q?"update":"create",_t=pe(V.deal_id),At=ft==="create"?{...Ve,created_by_id:Number(y)}:Ve;P({title:ft==="create"?"Confirm New Quote":"Confirm Update",message:ft==="create"?a.jsxs("span",{children:["Are you sure you want to create a quote for"," ",a.jsx("span",{className:"font-semibold",children:_t}),"?"]}):a.jsxs("span",{children:["Save changes to"," ",a.jsx("span",{className:"font-semibold",children:_t}),"?"]}),confirmLabel:ft==="create"?"Create Quote":"Update Quote",cancelLabel:"Cancel",variant:"primary",action:{type:ft,payload:At,targetId:q||null,name:_t}})},Ie=async()=>{if(!z?.action){P(null);return}const{action:L}=z,{type:ee,payload:Le,targetId:ze,name:Ve}=L;U(!0);try{if(ee==="create")M(!0),await re.post("/quotes/admin",Le),H.success("Quote created successfully."),xe(),await Pe();else if(ee==="update"){if(!ze)throw new Error("Missing quote identifier for update.");M(!0),await re.put(`/quotes/admin/${ze}`,Le),H.success("Quote updated successfully."),xe(),await Pe(),w?.id===ze&&S(null)}else if(ee==="delete"){if(!ze)throw new Error("Missing quote identifier for deletion.");const ft=w?.id;fe(ze),await re.delete(`/quotes/admin/${ze}`),H.success(`Quote "${Ve}" archived successfully.`),await Pe(ft&&ft!==ze?ft:null),ft===ze&&S(null)}else ee==="bulk-delete"&&(await re.post("/quotes/admin/bulk-delete",{quote_ids:We}),H.success(`Successfully archived ${We.length} quotes`),tt([]),await Pe())}catch(ft){console.error(ft);const _t=ee==="create"?"Failed to create quote. Please review the details and try again.":ee==="update"?"Failed to update quote. Please review the details and try again.":"Failed to delete quote. Please try again.";H.error(_t),(ee==="create"||ee==="update")&&M(!1),ee==="delete"&&fe(null)}finally{(ee==="create"||ee==="update")&&M(!1),ee==="delete"&&fe(null),U(!1),P(null)}},K=()=>{D||P(null)},ie=f.useCallback((L,ee)=>{const Le=L?.deal_id??L?.deal?.id??"",ze=Le?Number(Le):null,Ve=ze?ce(String(ze)):{accountId:"",contactId:""},ft=L?.account_id??L?.account?.id??Ve.accountId??null,_t=L?.contact_id??L?.contact?.id??Ve.contactId??null,At=L?.total_amount??0,Yt=L?.assigned_to??L?.assigned_user?.id??null;return{deal_id:ze,account_id:ft!=null&&String(ft).trim()!==""?Number(ft):null,contact_id:_t!=null&&String(_t).trim()!==""?Number(_t):null,total_amount:Number(At),presented_date:L?.presented_date||null,validity_days:L?.validity_days===""||L?.validity_days===void 0||L?.validity_days===null?null:Number(L.validity_days),status:ee,assigned_to:Yt!=null&&String(Yt).trim()!==""?Number(Yt):null,notes:L?.notes?.trim()||null}},[ce]),Me=f.useCallback(async()=>{if(!w?.id)return;const L=Fi(Ue),ee=[L,L.toLowerCase()],Le=async ze=>re.patch(`/quotes/admin/${w.id}/status`,{status:ze},{headers:{"Content-Type":"application/json"}});try{let ze=!1;for(const Ve of ee)try{await Le(Ve),ze=!0;break}catch(ft){if(ft?.response?.status===422)continue;throw ft}if(!ze){const Ve=ie(w,L);if(!Ve.deal_id){H.error("Cannot update status: missing deal_id on selected quote.");return}if(!Ve.total_amount||Ve.total_amount<=0){H.error("Cannot update status: missing/invalid total_amount on selected quote.");return}await re.put(`/quotes/admin/${w.id}`,Ve)}H.success(`Quote status updated to ${L}`),S(null),me("Overview"),await Pe()}catch(ze){console.error(ze);const Ve=ze?.response?.data?.message||(ze?.response?.data?.errors?Object.values(ze.response.data.errors).flat().join(" "):null)||"Failed to update quote status. Please try again.";H.error(Ve)}},[w,Ue,Pe,ie]),Ke=[{label:"Filter by Status",value:"Filter by Status"},...OT.map(L=>({label:L.label,value:L.value}))],gt=z?.action?.type==="delete"?z.action.targetId:null,Ct=w&&(Ne===w.id||gt===w.id),Ht=w&&Ne===w.id,da=w?a.jsx("div",{id:"quoteModalBackdrop",onClick:Nt,className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-6xl max-h-[92vh] overflow-y-auto hide-scrollbar animate-scale-in font-inter relative",onClick:L=>L.stopPropagation(),children:[a.jsx("div",{className:"w-full flex flex-col items-center justify-center rounded-t-xl",children:a.jsxs("div",{className:"bg-tertiary w-full flex items-center justify-between p-3 lg:p-3 rounded-t-xl",children:[a.jsx("h1",{className:"lg:text-3xl text-xl text-white font-semibold text-center w-full",children:"Quotes"}),a.jsx("button",{onClick:Tt,className:"text-gray-500 hover:text-white transition cursor-pointer",children:a.jsx(Ja,{size:25})})]})}),a.jsxs("div",{className:"p-6 lg:p-4",children:[a.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between lg:flex-row lg:items-center lg:justify-between mt-3 gap-2 px-2 md:items-center lg:gap-4 md:mx-7 lg:mx-7",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[a.jsx("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-800",children:Q(w)}),a.jsx("span",{className:`text-xs sm:text-sm font-medium px-2 sm:px-3 py-1 rounded-full whitespace-nowrap ${UWe(w.status)}`,children:IT(w.status)})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsxs("button",{className:"inline-flex items-center justify-center w-full sm:w-auto bg-white text-gray-700 px-4 py-2 rounded-md border border-gray-300 hover:bg-gray-50 disabled:opacity-70 transition text-sm focus:outline-none focus:ring-2 focus:ring-gray-300",onClick:we,disabled:B||E||D,children:[a.jsx(ia,{className:"mr-2"}),B?"Preparing...":"Print Quotation"]}),y===w.created_by&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{className:"inline-flex items-center justify-center w-full sm:w-auto bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 disabled:opacity-70 transition text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",onClick:()=>Qe(w),disabled:D||z?.action?.type==="update"&&z.action.targetId===w.id,children:[a.jsx(gn,{className:"mr-2"}),"Edit"]}),a.jsx("button",{className:"inline-flex items-center justify-center w-full sm:w-auto px-4 py-2 rounded-md text-sm bg-orange-500 text-white hover:bg-orange-600 transition focus:outline-none focus:ring-2 focus:ring-orange-400",onClick:()=>Y(w),disabled:!!Ct,children:Ht?"Archiving...":a.jsxs(a.Fragment,{children:[a.jsx(Zt,{className:"mr-2"}),"Archive"]})})]})]})]}),a.jsx("div",{className:"border-b border-gray-200 my-5"}),a.jsxs("div",{className:"p-1 lg:p-4",children:[a.jsx("div",{className:"flex w-full bg-[#6A727D] text-white mt-1 overflow-x-auto mb-6",children:["Overview","Notes"].map(L=>a.jsx("button",{onClick:()=>me(L),className:`flex-1 min-w-[90px] px-4 py-2.5 text-xs sm:text-sm font-medium text-center transition-all duration-200 border-b-2
                    ${be===L?"bg-paper-white text-[#6A727D] border-white":"text-white hover:bg-[#5c636d]"}`,children:L},L))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 items-start",children:[a.jsxs("div",{className:"lg:col-span-3",children:[be==="Overview"&&a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 md:p-8 border border-gray-200",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4 sm:gap-6 text-sm text-gray-700",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Quote ID:"}),a.jsx("p",{children:RT(w.quote_id)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Deal:"}),a.jsx("p",{children:Q(w)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Account:"}),a.jsx("p",{children:ne(w)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Contact:"}),a.jsx("p",{children:ae(w)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Total Amount:"}),a.jsx("p",{children:w.total_amount?`${s}${Number(w.total_amount).toLocaleString()}`:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Presented Date:"}),a.jsx("p",{children:zg(w.presented_date)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Validity Days:"}),a.jsx("p",{children:w.validity_days!==null&&w.validity_days!==void 0?w.validity_days:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Expiry Date:"}),a.jsx("p",{children:zg($T(w.presented_date,w.validity_days))||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Status:"}),a.jsx("p",{children:IT(w.status)})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Assigned To:"}),a.jsx("p",{children:w.assigned_user?`${w.assigned_user.first_name} ${w.assigned_user.last_name}`:"Unassigned"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created By:"}),a.jsx("p",{children:w.creator?`${w.creator.first_name} ${w.creator.last_name}`:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created At:"}),a.jsx("p",{children:ev(w.created_at)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Last Updated:"}),a.jsx("p",{children:ev(w.updated_at)||"N/A"})]})]}),w.items&&w.items.length>0&&a.jsx("div",{className:"mt-6",children:a.jsx(jd,{items:w.items,onChange:()=>{},currencySymbol:s,readOnly:!0,taxRate:parseFloat(w.tax_rate)||0,discountType:w.discount_type,discountValue:parseFloat(w.discount_value)||0})})]}),be==="Notes"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"bg-white p-4 sm:p-6 rounded-xl border border-gray-200 shadow-sm",children:[a.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Notes:"}),a.jsx("p",{className:"text-sm text-gray-700 leading-relaxed whitespace-pre-wrap",children:w.notes||"No notes available."})]}),a.jsx(Tn,{comments:Xe,onAddComment:Ze})]})]}),a.jsxs("div",{className:"flex flex-col gap-4",children:[a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Quick Actions"}),a.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[a.jsxs("button",{onClick:()=>e("/group-manager/calls",{state:{openCallModal:!0,initialCallData:{subject:`Call regarding Quote ${RT(w.quote_id)}`,assigned_to:st,direction:"Outgoing",status:"Planned"}}}),className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(It,{className:"text-gray-600 w-4 h-4"}),"Schedule Call"]}),a.jsxs("button",{className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",onClick:()=>e("/group-manager/meetings",{state:{openMeetingModal:!0,initialMeetingData:{subject:`Meeting with ${w.quote_id}`,assignedTo:st,status:"Planned"}}}),children:[a.jsx(Ot,{className:"text-gray-600 w-4 h-4"}),"Book Meeting"]}),a.jsxs("button",{onClick:()=>e("/group-manager/tasks",{state:{openTaskModal:!0,initialTaskData:{subject:`Follow up with ${w.quote_id}`,assignedTo:st,priority:"NORMAL",status:"Not Started"}}}),className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(Qt,{className:"text-gray-600 w-4 h-4"}),"Tasks"]})]})]}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm w-full",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Status"}),a.jsx("select",{className:"border border-gray-200 rounded-md px-2 sm:px-3 py-1.5 w-full text-sm mb-2 focus:ring-2 focus:ring-indigo-500 outline-none",value:Ue||Fi(w.status)||"Draft",onChange:L=>Ee(L.target.value),children:OT.map(L=>a.jsx("option",{value:L.value,children:L.label},L.value))}),a.jsx("button",{onClick:Me,disabled:Fi(Ue)===Fi(w.status),className:`w-full py-1.5 rounded-md text-sm transition focus:outline-none focus:ring-2 ${Fi(Ue)===Fi(w.status)?"bg-gray-400 cursor-not-allowed text-white":"bg-gray-900 text-white hover:bg-gray-800 focus:ring-gray-400"}`,children:"Update"})]})]})]})]})]})]})}):null,Ge=a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[o&&a.jsx(Wt,{message:"Loading quotes..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h2",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(ia,{className:"mr-2 text-blue-600"})," Quotes"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto gap-2",children:a.jsxs("button",{onClick:()=>{Ce(),De(!1)},className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 rounded-md hover:bg-gray-800 text-sm sm:text-base mx-auto sm:ml-auto cursor-pointer",children:[a.jsx(aa,{className:"mr-2"})," Add Quote"]})})]}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search quotes",value:je,onChange:L=>X(L.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsx("div",{className:"w-full lg:w-1/4",children:a.jsx("select",{value:se,onChange:L=>ye(L.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:Ke.map(L=>a.jsx("option",{value:L.value,children:L.label},L.value))})})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[900px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 text-sm tracking-wide font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 w-12",children:a.jsx("input",{type:"checkbox",checked:J.length>0&&We.length===J.length,onChange:G,className:"cursor-pointer"})}),a.jsx("th",{className:"py-3 px-4",children:"Quote ID"}),a.jsx("th",{className:"py-3 px-4",children:"Deal"}),a.jsx("th",{className:"py-3 px-4",children:"Account"}),a.jsx("th",{className:"py-3 px-4",children:"Contact"}),a.jsx("th",{className:"py-3 px-4",children:"Total Amount"}),a.jsx("th",{className:"py-3 px-4",children:"Status"}),a.jsx("th",{className:"py-3 px-4",children:"Assigned To"}),a.jsx("th",{className:"py-3 px-4",children:"Expiry Date"}),a.jsx("th",{className:"py-3 px-4 text-center w-24",children:We.length>0?a.jsx("button",{onClick:F,className:"text-orange-600 hover:text-orange-800 transition p-1 rounded-full hover:bg-orange-50",title:`Archive ${We.length} selected items`,children:a.jsx(Zt,{size:18})}):""})]})}),a.jsx("tbody",{children:o?a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:10,children:"Loading quotes..."})}):nt.length>0?Re.map(L=>{const ee=$T(L.presented_date,L.validity_days);return a.jsxs("tr",{className:"hover:bg-gray-50 text-sm cursor-pointer transition",onClick:()=>Et(L),children:[a.jsx("td",{className:"py-3 px-4 align-top w-12",onClick:Le=>Le.stopPropagation(),children:L.created_by===y&&a.jsx("input",{type:"checkbox",checked:We.includes(L.id),onChange:()=>W(L.id),className:"cursor-pointer"})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("div",{className:"font-medium text-blue-600 hover:underline whitespace-nowrap",children:RT(L.quote_id)||"--"})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("div",{className:"break-words",children:Q(L)||"--"})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("div",{className:"text-sm text-gray-700 break-words",children:ne(L)||"--"})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("div",{className:"break-words",children:ae(L)||"--"})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("div",{className:"text-gray-700",children:L.total_amount?`${s}${Number(L.total_amount).toLocaleString()}`:"--"})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-medium ${FWe(L.status)}`,children:IT(L.status)})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("div",{children:L.assigned_user?`${L.assigned_user.first_name} ${L.assigned_user.last_name}`:"Unassigned"})}),a.jsx("td",{className:"py-3 px-4 align-top",children:a.jsx("div",{className:"text-gray-500 text-xs",children:zg(ee)||"--"})}),a.jsx("td",{className:"py-3 px-4 align-top text-center w-24"})]},L.id)}):a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:10,children:"No quotes found."})})})]})}),a.jsx(ca,{className:"mt-4",totalItems:nt.length,pageSize:ge,currentPage:de,onPrev:it,onNext:St,onPageSizeChange:L=>{$e(L),ke(1)},pageSizeOptions:[10,20,30,40,50],label:"quotes"})]}),Ae=_?a.jsx("div",{id:"modalBackdrop",onClick:ve,className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-full sm:max-w-3xl rounded-2xl shadow-lg p-4 sm:p-6 md:p-8 relative border border-gray-200 overflow-y-auto max-h-[90vh] hide-scrollbar",onClick:L=>L.stopPropagation(),children:[a.jsx("button",{onClick:()=>{xe(),De(!1)},className:"absolute top-4 right-4 text-gray-500 hover:text-black transition disabled:opacity-60",disabled:E||D,children:a.jsx(ea,{size:22})}),a.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800 mb-4 sm:mb-6 flex items-center justify-center",children:T?"Edit Quote":"Add New Quote"}),a.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",onSubmit:le,children:[a.jsx(cH,{label:"Deal",name:"deal_id",value:V.deal_id,onChange:L=>{const{accountId:ee,contactId:Le}=ce(L);oe(ze=>({...ze,deal_id:L,account_id:ee,contact_id:Le}))},items:Array.isArray(c)?c:[],getLabel:L=>`${iH(L?.deal_id??"")} ${L?.name??""}`.trim(),placeholder:"Search deal...",required:!0,isSubmitted:ue,disabled:E||c.length===0,className:"md:col-span-2"}),a.jsx(lH,{label:"Account",value:Be(V.account_id)||(V.account_id?`Account #${V.account_id}`:""),disabled:!0}),a.jsx(lH,{label:"Contact",value:_e(V.contact_id)||(V.contact_id?`Contact #${V.contact_id}`:""),disabled:!0}),a.jsx("div",{className:"md:col-span-2 mt-2",children:a.jsx(jd,{items:V.items,onChange:L=>oe(ee=>({...ee,items:L})),currencySymbol:s,readOnly:E,taxRate:V.tax_rate,discountType:V.discount_type,discountValue:V.discount_value,onTotalsChange:L=>{oe(ee=>({...ee,subtotal:L.subtotal,discount_amount:L.discount_amount,tax_amount:L.tax_amount,total_amount:L.total_amount}))}})}),a.jsxs("div",{className:"md:col-span-2 mt-2 p-4 bg-gray-50 rounded-lg",children:[a.jsx("h4",{className:"font-medium text-gray-700 mb-3",children:"Pricing Settings"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-600 text-xs mb-1",children:"Discount Type"}),a.jsxs("select",{value:V.discount_type||"",onChange:L=>oe(ee=>({...ee,discount_type:L.target.value})),className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm",disabled:E,children:[a.jsx("option",{value:"",children:"No Discount"}),a.jsx("option",{value:"percentage",children:"Percentage (%)"}),a.jsx("option",{value:"fixed",children:"Fixed Amount"})]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-gray-600 text-xs mb-1",children:["Discount"," ",V.discount_type==="percentage"?"%":"Amount"]}),a.jsx("input",{type:"number",value:V.discount_value||"",onChange:L=>oe(ee=>({...ee,discount_value:L.target.value})),className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm",placeholder:"0",min:"0",max:V.discount_type==="percentage"?"100":void 0,step:"0.01",disabled:E||!V.discount_type})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-600 text-xs mb-1",children:"Tax Rate (%)"}),a.jsx("input",{type:"number",value:V.tax_rate||"",onChange:L=>oe(ee=>({...ee,tax_rate:L.target.value})),className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm",placeholder:"0",min:"0",max:"100",step:"0.01",disabled:E})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-600 text-xs mb-1",children:"Total Amount"}),a.jsxs("div",{className:"w-full bg-gray-100 border border-gray-300 rounded-md px-2 py-1.5 text-sm font-medium",children:[s,parseFloat(V.total_amount||0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]})]}),a.jsx(oH,{label:"Presented Date",name:"presented_date",type:"date",value:V.presented_date,onChange:Oe,disabled:E}),a.jsx(oH,{label:"Validity Days",name:"validity_days",type:"number",value:V.validity_days,onChange:Oe,placeholder:"30",disabled:E}),a.jsx(cH,{label:"Assigned To",value:V.assigned_to||"",onChange:L=>oe(ee=>({...ee,assigned_to:L})),items:Array.isArray(v)?v:[],getLabel:L=>{const ee=`${L?.first_name??""} ${L?.last_name??""}`.trim();return ee?L?.role?`${ee} (${L.role})`:ee:L?.email||""},placeholder:"Search assignee...",required:!0,isSubmitted:ue,disabled:E}),a.jsx(YWe,{label:"Status",name:"status",value:V.status,onChange:Oe,options:OT,required:!0,disabled:E}),a.jsx(KWe,{label:"Notes",name:"notes",value:V.notes,onChange:Oe,placeholder:"Additional details...",rows:3,disabled:E,className:"md:col-span-2"}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-2 md:col-span-2 mt-4",children:[a.jsx("button",{type:"button",onClick:()=>{xe(),De(!1)},className:"w-full sm:w-auto px-4 py-2 text-white bg-red-400 border border-red-300 rounded hover:bg-red-500 transition disabled:opacity-70",disabled:E||D,children:"Cancel"}),a.jsx("button",{type:"submit",className:"w-full sm:w-auto px-4 py-2 text-white border border-tertiary bg-tertiary rounded hover:bg-secondary transition disabled:opacity-70",disabled:E||D,children:E?"Saving...":T?"Update Quote":"Save Quote"})]})]})]})}):null,I=z?a.jsx(XWe,{open:!0,title:z.title,message:z.message,confirmLabel:z.confirmLabel,cancelLabel:z.cancelLabel,variant:z.variant,onConfirm:Ie,onCancel:K,loading:D}):null;return a.jsxs(a.Fragment,{children:[w?da:Ge,Ae,I]})}function oH({label:e,name:t,value:n,onChange:s,placeholder:r,type:i="text",required:o=!1,disabled:l=!1,className:c="",isSubmitted:u=!1}){const d=u&&!n?.trim();return a.jsxs("div",{className:c,children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",o&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:i,name:t,value:n??"",onChange:s,placeholder:r,required:o,disabled:l,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border focus:ring-2
          ${d?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}
          ${c}
        `})]})}function lH({label:e,value:t,className:n="",disabled:s=!0}){return a.jsxs("div",{className:n,children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsx("input",{type:"text",value:t??"",disabled:s,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm outline-none disabled:bg-gray-100"})]})}function YWe({label:e,name:t,value:n,onChange:s,options:r,required:i=!1,disabled:o=!1,className:l=""}){const c=n!=null?String(n):"",d=r.some(h=>String(h.value)===c)?c:"";return a.jsxs("div",{className:l,children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsx("select",{name:t,value:d,onChange:s,required:i,disabled:o,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100",children:r.map(h=>a.jsx("option",{value:String(h.value??""),children:h.label},h.value??h.label))})]})}function cH({label:e,items:t=[],value:n="",onChange:s,getLabel:r,placeholder:i="Search...",disabled:o=!1,className:l="",required:c=!1,isSubmitted:u=!1}){const d=u&&c&&!n;return a.jsxs("div",{className:l,children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",c&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx(QWe,{items:t,value:n??"",onChange:s,getLabel:r,placeholder:i,disabled:o,hasError:d})]})}function QWe({items:e=[],value:t="",onChange:n,getLabel:s,placeholder:r="Search...",disabled:i=!1,maxRender:o=200,hasError:l=!1}){const[c,u]=f.useState(!1),[d,h]=f.useState(""),p=f.useRef(null),x=e.find(y=>String(y.id)===String(t)),v=x?s(x):"",j=f.useMemo(()=>{const y=d.trim().toLowerCase();return(y?e.filter(w=>(s(w)||"").toLowerCase().includes(y)):e).slice(0,o)},[e,d,s,o]);return f.useEffect(()=>{const y=N=>{p.current&&!p.current.contains(N.target)&&u(!1)};return document.addEventListener("mousedown",y),()=>document.removeEventListener("mousedown",y)},[]),f.useEffect(()=>{c||h("")},[c]),a.jsxs("div",{ref:p,className:"relative w-full",children:[a.jsx("input",{disabled:i,value:c?d:v,placeholder:r,onFocus:()=>!i&&u(!0),onChange:y=>{h(y.target.value),c||u(!0)},className:`w-full border rounded-md px-2 py-1.5 text-sm outline-none focus:ring-2
          ${l?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}`}),c&&!i&&a.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg overflow-hidden",children:[a.jsx("div",{className:"max-h-56 overflow-y-auto hide-scrollbar",children:j.length>0?j.map(y=>{const N=String(y.id),w=s(y),S=String(t)===N;return a.jsx("button",{type:"button",onClick:()=>{n(N),u(!1)},className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-50 ${S?"bg-blue-50":""}`,children:w||"--"},N)}):a.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No results"})}),e.length>o&&a.jsxs("div",{className:"px-3 py-2 text-[11px] text-gray-400 border-t",children:["Showing first ",o," results  keep typing to narrow."]})]})]})}function KWe({label:e,name:t,value:n,onChange:s,placeholder:r,rows:i=3,disabled:o=!1,className:l=""}){return a.jsxs("div",{className:l,children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),a.jsx("textarea",{name:t,value:n??"",onChange:s,placeholder:r,rows:i,disabled:o,className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100 resize-none"})]})}function XWe({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o=!1,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-orange-500 hover:bg-orange-600 border border-orange-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsx("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${u}`,disabled:o,children:o?"Processing...":s})]})]})})}function ZWe(){const{userRole:e}=Ks();return a.jsx(y1,{currentUserRole:e,currentUserId:null})}const dH=["Not started","In progress","Deferred","Completed"],uH={NOT_STARTED:"Not started","NOT STARTED":"Not started","TO DO":"Not started",IN_PROGRESS:"In progress","IN PROGRESS":"In progress",COMPLETED:"Completed",DEFERRED:"Deferred","Not started":"Not started","In progress":"In progress",Completed:"Completed",Deferred:"Deferred","In Progress":"In progress","To Do":"Not started",Review:"Deferred"},kee=e=>e&&(uH[e]||uH[String(e).toUpperCase()])||"Not started",JWe=e=>{if(!e)return"";const t=new Date(e);if(Number.isNaN(t.getTime()))return"";const n=t.getTimezoneOffset();return new Date(t.getTime()-n*60*1e3).toISOString().slice(0,16)},zT=e=>{if(!e)return"";const t=new Date(e);return Number.isNaN(t.getTime())?"":t.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},eVe=e=>{const t=e.subject?.trim()??"",n=e.description?.trim()??"",s=e.notes?.trim()??"";e.priority&&String(e.priority).toUpperCase(),kee(e.status);let r=null,i=null,o=null,l=null,c=null;e.relatedType1==="Lead"&&e.relatedTo1?r=Number(e.relatedTo1):e.relatedType1==="Account"&&e.relatedTo1&&(i=Number(e.relatedTo1)),e.relatedType1==="Account"&&(e.relatedType2==="Contact"&&e.relatedTo2?o=Number(e.relatedTo2):e.relatedType2==="Deal"&&e.relatedTo2?l=Number(e.relatedTo2):e.relatedType2==="Quote"&&e.relatedTo2&&(c=Number(e.relatedTo2)));const u=e.assignedTo?Number(e.assignedTo):null,d=o||l||i||r,h=o?"Contact":l?"Deal":i?"Account":r?"Lead":c?"Quote":null;return{title:t,description:n,priority:e.priority||"Normal",status:e.status||"Not started",due_date:e.dueDate?e.dueDate:null,assigned_to:u,notes:s,is_personal:!1,lead_id:r,account_id:i,contact_id:o,deal_id:l,quote_id:c,related_to_1:e.relatedTo1?Number(e.relatedTo1):null,related_type_1:e.relatedType1,related_to_2:e.relatedTo2?Number(e.relatedTo2):null,related_type_2:e.relatedType2,related_to:d,related_type:h}},tVe=e=>{const t=e.task_assign_to?`${e.task_assign_to.first_name} ${e.task_assign_to.last_name}`:e.assigned_to?String(e.assigned_to):"Unassigned",n=e.task_creator?`${e.task_creator.first_name} ${e.task_creator.last_name}`:e.created_by?String(e.created_by):"System",s=e.due_date||e.dueDate||null,r=e.date_assigned||e.created_at||null,i=e.contact?`${e.contact.first_name} ${e.contact.last_name}`:e.assigned_to?String(e.assigned_to.id):"Unassigned",o=B=>{if(!B)return"";const R=String(B).split("-");return R.length===3?`${R[0]}-${R[2]}`:String(B)},l=()=>e.lead?.id||e.lead_id,c=()=>e.account?.id||e.account_id,u=()=>e.contact?.id||e.contact_id,d=()=>e.deal?.id||e.deal_id,h=()=>e.quote?.id||e.quote_id,p=()=>e.task_assign_to?.id||e.assigned_to,x=()=>e.lead?.title||e.lead_id,v=()=>e.account?.name||e.account_id,j=()=>i||e.contact_id,y=()=>e.deal?.name||e.deal_id,N=()=>o(e.quote?.quote_id)||e.id;let w="Lead",S="",_="",k="",T="Lead",A="",E="",M="";const z=c(),P=v(),D=l(),U=x();if(z){w="Account",T="Account",A=P,S=String(z);const B=u(),R=d(),q=j(),Z=y(),V=h(),oe=N();B?(_="Contact",E="Contact",M=q,k=String(B)):R?(E="Deal",_="Deal",M=Z,k=String(R)):V&&(E="Quote",_="Quote",M=oe,k=String(V))}else D?(T="Lead",A=U,w="Lead",S=String(D)):e.related_type==="Account"&&(w="Account",S=String(e.related_to));return{id:e.id,title:e.title,description:e.description,priority:e.priority||"Normal",status:kee(e.status),dueDate:s,dateAssigned:r,assignedToId:p()||null,assignedToName:t,createdAt:e.created_at||null,createdById:e.created_by?.id||e.created_by||null,createdBy:n,notes:e.notes||"",isPersonal:!!e.is_personal,relatedType1Text:T,relatedTo1Text:A,relatedType2Text:E,relatedTo2Text:M,subject:e.title,relatedType1:w,relatedTo1:S,relatedType2:_,relatedTo2:k}};function aVe(){f.useEffect(()=>{document.title="Tasks | Sari-Sari CRM"},[]);const{user:e,loading:t}=Vt(),[n,s]=f.useState("board"),[r,i]=f.useState(!1),[o,l]=f.useState(null),[c,u]=f.useState(!1),[d,h]=f.useState([]),[p,x]=f.useState(!0),[v,j]=f.useState(""),[y,N]=f.useState("Filter by Status"),[w,S]=f.useState("Filter by Priority"),[_,k]=f.useState([]),[T,A]=f.useState(1),[E,M]=f.useState(10),[z,P]=f.useState(null),[D,U]=f.useState(!1),[B,R]=f.useState([]),[q,Z]=f.useState(null),V=kt(),oe=ta(),[je,X]=f.useState({id:"",subject:"",description:"",priority:"",status:"",dueDate:"",assignedTo:"",notes:"",relatedType1:"Lead",relatedType2:"Contact",relatedTo1:"",relatedTo2:""}),[se,ye]=f.useState(null),Ne=Ux(Ff(sm,{activationConstraint:{distance:8}})),fe=ae=>{const{active:Pe}=ae,Te=d.find(he=>he.id===Pe.id);Z(Te)},we=async ae=>{const{active:Pe,over:Te}=ae;if(Z(null),!Te)return;const he=Pe.id,He=Te.id,qe=d.find(nt=>nt.id===he);if(!(!qe||qe.status===He)){h(nt=>nt.map(ot=>ot.id===he?{...ot,status:He}:ot));try{const nt={title:qe.title,description:qe.description||"",priority:qe.priority||"Normal",status:He,due_date:qe.dueDate||null,assigned_to:qe.assignedToId||null,related_type_1:qe.relatedType1||null,related_to_1:qe.relatedTo1?parseInt(qe.relatedTo1,10):null,related_type_2:qe.relatedType2||null,related_to_2:qe.relatedTo2?parseInt(qe.relatedTo2,10):null};(!nt.related_to_1||isNaN(nt.related_to_1))&&(nt.related_to_1=null),(!nt.related_to_2||isNaN(nt.related_to_2))&&(nt.related_to_2=null),await re.put(`/tasks/${he}`,nt),H.success(`Task moved to "${He}"`)}catch(nt){console.error("Failed to update task status:",nt),H.error("Failed to update task status"),h(ot=>ot.map(Re=>Re.id===he?{...Re,status:qe.status}:Re))}}},de=()=>{Z(null)};f.useEffect(()=>{const ae=oe.state?.openTaskModal,Pe=oe.state?.initialTaskData,Te=oe.state?.taskID;ae?(i(!0),Pe&&X(he=>({...he,...Pe})),V(oe.pathname,{replace:!0,state:{}})):Te&&(ye(Te),V(oe.pathname,{replace:!0,state:{}}))},[oe,V]),f.useEffect(()=>{if(se&&d.length>0&&!p){const ae=d.find(Pe=>Pe.id===se);ae?be(ae,!0):H.error("Task not found."),ye(null)}},[se,d,p]);const ke=async()=>{try{const ae=await re.get("/users/all");k(Array.isArray(ae.data)?ae.data:[])}catch(ae){console.error("Failed to fetch users:",ae),H.error("Failed to fetch users.")}},ge=async()=>{try{x(!0);const ae=await re.get("/tasks/all"),Pe=Array.isArray(ae.data)?ae.data:[];console.log("Raw tasks from API:",Pe.slice(0,3).map(he=>({id:he.id,title:he.title,created_by:he.created_by,task_creator:he.task_creator})));const Te=Pe.map(tVe);console.log("Formatted tasks:",Te.map(he=>({id:he.id,title:he.title,createdById:he.createdById}))),console.log("Current user ID:",e?.id),Te.sort((he,He)=>{const qe=he.createdAt?new Date(he.createdAt):0;return(He.createdAt?new Date(He.createdAt):0)-qe}),h(Te),n==="list"&&A(1)}catch(ae){console.error("Failed to load tasks:",ae),H.error("Failed to load tasks.")}finally{x(!1)}};f.useEffect(()=>{!t&&e&&(ke(),ge())},[t,e]);const $e=()=>{l(null),X({id:"",subject:"",description:"",priority:"Normal",status:"Not started",dueDate:"",assignedTo:"",notes:"",relatedType1:"Lead",relatedType2:"Contact",relatedTo1:"",relatedTo2:""})},be=(ae=null,Pe=!1)=>{l(ae),u(Pe),ae?X({id:ae.id,subject:ae.title||"",description:ae.description||"",priority:ae.priority||"Normal",status:ae.status||"Not started",dueDate:JWe(ae.dueDate),assignedTo:ae.assignedToId?String(ae.assignedToId):"",assignedToName:ae.assignedToName||"",createdBy:ae.createdBy||"",createdById:ae.createdById||null,notes:ae.notes||"",relatedType1Text:ae.relatedType1Text||"",relatedTo1Text:ae.relatedTo1Text||"",relatedType2Text:ae.relatedType2Text||"",relatedTo2Text:ae.relatedTo2Text||"",relatedType1:ae.relatedType1||"",relatedTo1:ae.relatedTo1||"",relatedType2:ae.relatedType2||"",relatedTo2:ae.relatedTo2||""}):$e(),i(!0)},me=()=>{i(!1),l(null),u(!1),$e()},Ue=async ae=>{const Pe=eVe(ae);try{o&&!c?(await re.put(`/tasks/${o.id}`,Pe),H.success("Task updated successfully.")):(await re.post("/tasks/create",Pe),H.success("Task created successfully.")),i(!1),await ge()}catch(Te){console.error("Failed to save task:",Te);const he=Te.response?.data?.detail||"Failed to save task.";H.error(he)}},Ee=ae=>{if(!ae)return;const Pe=/group.manager/i.test(e?.role);P({title:Pe?"Archive Task":"Delete Task",message:a.jsxs(a.Fragment,{children:["Are you sure you want to ",Pe?"archive":"delete"," ",a.jsx("span",{className:"font-semibold",children:ae.title}),"?",Pe?a.jsx("span",{children:" This action will mark the task as inactive."}):a.jsx("span",{children:" This action cannot be undone."})]}),confirmLabel:Pe?"Archive Task":"Delete Task",cancelLabel:"Cancel",variant:Pe?"warning":"danger",action:{type:"delete",targetId:ae.id}})},We=()=>{if(Be.every(ae=>B.includes(ae.id)))R(B.filter(ae=>!Be.map(Pe=>Pe.id).includes(ae)));else{const ae=Be.map(Pe=>Pe.id);R([...new Set([...B,...ae])])}},tt=ae=>{Je(Ze.find(Pe=>Pe.id===ae))&&R(Pe=>Pe.includes(ae)?Pe.filter(Te=>Te!==ae):[...Pe,ae])},lt=async()=>{if(B.length===0)return;const ae=/group.manager/i.test(e?.role);P({title:ae?"Archive Tasks":"Delete Tasks",message:a.jsxs("span",{children:["Are you sure you want to ",ae?"archive":"delete"," ",a.jsx("span",{className:"font-semibold",children:B.length})," selected tasks? ",ae?"This action will mark the tasks as inactive.":"This action cannot be undone."]}),confirmLabel:ae?`Archive ${B.length} Task(s)`:`Delete ${B.length} Task(s)`,cancelLabel:"Cancel",variant:ae?"warning":"danger",action:{type:"bulk-delete",task_ids:B}})},Fe=async()=>{if(!z?.action){P(null);return}const{action:ae}=z;U(!0);const Pe=/group.manager/i.test(e?.role);try{ae.type==="delete"?(await re.delete(`/tasks/${ae.targetId}`),H.success(Pe?"Task archived successfully.":"Task deleted successfully."),await ge()):ae.type==="bulk-delete"&&(Pe?(await re.post("/tasks/bulk-archive",{task_ids:ae.task_ids}),H.success(`Successfully archived ${ae.task_ids.length} tasks`)):(await re.delete("/tasks/admin/bulk-delete",{data:{task_ids:ae.task_ids}}),H.success(`Successfully deleted ${ae.task_ids.length} tasks`)),R([]),await ge())}catch(Te){console.error("Task action failed:",Te),H.error(Pe?"Failed to archive task.":"Failed to delete task.")}finally{U(!1),P(null)}},st=()=>{D||P(null)},Xe=f.useMemo(()=>{const ae=v.trim().toLowerCase();return[...d].sort((Te,he)=>{const He=Te.createdAt?new Date(Te.createdAt):0;return(he.createdAt?new Date(he.createdAt):0)-He}).filter(Te=>{const he=ae===""||Te.title?.toLowerCase().includes(ae)||Te.description?.toLowerCase().includes(ae)||Te.assignedToName?.toLowerCase().includes(ae)||Te.createdBy?.toLowerCase().includes(ae),He=y==="Filter by Status"||Te.status===y,qe=w==="Filter by Priority"||Te.priority===w;return he&&He&&qe})},[d,v,y,w]);f.useEffect(()=>{A(1)},[v,y,w,n,E]),f.useEffect(()=>{if(n==="list"){const ae=Xe.length===0?1:Math.ceil(Xe.length/E);T>ae&&A(ae)}},[Xe.length,T,n,E]);const Ze=f.useMemo(()=>{if(n==="board")return Xe;const ae=(T-1)*E;return Xe.slice(ae,ae+E)},[Xe,T,n,E]),Je=ae=>/group.manager/i.test(e?.role)?String(ae?.createdById)===String(e?.id):!0,Be=f.useMemo(()=>Ze.filter(Je),[Ze,e?.role,e?.id]),_e=f.useMemo(()=>{const ae=new Date;return[{title:"To Do",value:d.filter(Pe=>Pe.status==="Not started").length,icon:zs,color:"text-blue-600",bgColor:"bg-blue-100"},{title:"In Progress",value:d.filter(Pe=>Pe.status==="In progress").length,icon:Yi,color:"text-purple-600",bgColor:"bg-purple-100"},{title:"Completed",value:d.filter(Pe=>Pe.status==="Completed").length,icon:Qa,color:"text-green-600",bgColor:"bg-green-100"},{title:"Overdue",value:d.filter(Pe=>Pe.dueDate&&new Date(Pe.dueDate)<ae&&Pe.status!=="Completed").length,icon:Fl,color:"text-red-600",bgColor:"bg-red-100"},{title:"High Priority",value:d.filter(Pe=>Pe.priority==="High").length,icon:ec,color:"text-orange-600",bgColor:"bg-orange-100"}]},[d]),pe=ae=>ae.dueDate&&new Date(ae.dueDate)<new Date&&ae.status!=="Completed",ce=ae=>{switch(ae.status){case"Not started":return"bg-blue-50 hover:bg-blue-100 border-blue-200";case"In progress":return"bg-purple-50 hover:bg-purple-100 border-purple-200";case"Deferred":return"bg-orange-50 hover:bg-orange-100 border-orange-200";case"Completed":return"bg-green-50 hover:bg-green-100 border-green-200";default:return"bg-gray-50 hover:bg-gray-100 border-gray-100"}},Q=ae=>{switch(ae){case"Not started":return"bg-blue-100 text-blue-700";case"In progress":return"bg-purple-100 text-purple-700";case"Deferred":return"bg-orange-100 text-orange-700";case"Completed":return"bg-green-100 text-green-700";default:return"bg-gray-100 text-gray-700"}},ne=ae=>{switch(ae){case"High":return"bg-red-100 text-red-700";case"Normal":return"bg-yellow-100 text-yellow-700";default:return"bg-gray-100 text-gray-700"}};return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 min-h-screen font-inter relative",children:[(p||t)&&a.jsx(Wt,{message:"Loading tasks..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 space-y-2 sm:space-y-0",children:[a.jsxs("h1",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[a.jsx(Yi,{className:"text-blue-600"})," Tasks Board"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{type:"button",onClick:()=>be(),className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 rounded-md hover:bg-gray-800 text-sm sm:text-base self-end sm:self-auto mt-2 lg:mt-0 cursor-pointer",children:[a.jsx(aa,{})," Create Task"]})})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 xl:grid-cols-5 gap-4 mb-6 w-full break-words overflow-hidden lg:overflow-visible",children:_e.map(ae=>a.jsx(nVe,{...ae},ae.title))}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mt-6 mb-4 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search tasks",value:v,onChange:ae=>j(ae.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row w-full lg:w-1/2 gap-2",children:[a.jsxs("select",{value:y,onChange:ae=>N(ae.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{children:"Filter by Status"}),dH.map(ae=>a.jsx("option",{children:ae},ae))]}),a.jsxs("select",{value:w,onChange:ae=>S(ae.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{children:"Filter by Priority"}),a.jsx("option",{children:"High"}),a.jsx("option",{children:"Normal"}),a.jsx("option",{children:"Low"})]})]})]}),a.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[a.jsx("button",{type:"button",onClick:()=>s("board"),className:`px-4 py-2 rounded-full text-sm ${n==="board"?"bg-gray-800 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Board View"}),a.jsx("button",{type:"button",onClick:()=>s("list"),className:`px-4 py-2 rounded-full text-sm ${n==="list"?"bg-gray-800 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"List View"})]}),!p&&!t&&n==="board"&&(Xe.length>0?a.jsxs(qx,{sensors:Ne,collisionDetection:Bx,onDragStart:fe,onDragEnd:we,onDragCancel:de,children:[a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4 rounded-md",children:dH.map(ae=>{const Pe=Ze.filter(Te=>Te.status===ae);return a.jsx(rVe,{column:ae,columnTasks:Pe,getTaskCardColor:ce,isTaskOverdue:pe,formatDateDisplay:zT,handleOpenModal:be,handleDeleteTask:Ee,currentUser:e},ae)})}),a.jsx(EN,{children:q?a.jsx(oVe,{task:q,getTaskCardColor:ce,isTaskOverdue:pe,formatDateDisplay:zT}):null})]}):a.jsx("div",{className:"col-span-4 text-center py-10 text-gray-500 border border-dashed rounded-xl",children:"No tasks found."})),!p&&!t&&n==="list"&&a.jsx("div",{className:"bg-white rounded-md shadow-sm overflow-hidden",children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-gray-600 text-left",children:a.jsxs("tr",{children:[/group.manager/i.test(e?.role)?a.jsx("th",{className:"py-3 px-4 w-10",children:a.jsx("input",{type:"checkbox",className:"w-4 h-4 accent-blue-600",checked:Be.length>0&&Be.every(ae=>B.includes(ae.id)),onChange:We})}):a.jsx("th",{className:"py-3 px-4 w-10"}),a.jsx("th",{className:"py-3 px-4 font-medium",children:"Task"}),a.jsx("th",{className:"py-3 px-4 font-medium",children:"Status"}),a.jsx("th",{className:"py-3 px-4 font-medium",children:"Priority"}),a.jsx("th",{className:"py-3 px-4 font-medium",children:"Assigned To"}),a.jsx("th",{className:"py-3 px-4 font-medium",children:"Date Assigned"}),a.jsx("th",{className:"py-3 px-4 font-medium text-center w-24",children:B.length>0?a.jsx("button",{onClick:lt,className:`transition p-1 rounded-full ${/group.manager/i.test(e?.role)?"text-orange-600 hover:text-orange-800 hover:bg-orange-50":"text-red-600 hover:text-red-800 hover:bg-red-50"}`,title:`${/group.manager/i.test(e?.role)?"Archive":"Delete"} ${B.length} selected tasks`,children:/group.manager/i.test(e?.role)?a.jsx(Zt,{size:18}):a.jsx(wa,{size:18})}):""})]})}),a.jsx("tbody",{children:Ze.length>0?Ze.map(ae=>a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors text-sm cursor-pointer",children:[/group.manager/i.test(e?.role)?a.jsx("td",{className:"py-3 px-4",onClick:Pe=>Pe.stopPropagation(),children:Je(ae)&&a.jsx("input",{type:"checkbox",className:"w-4 h-4 accent-blue-600",checked:B.includes(ae.id),onChange:()=>tt(ae.id)})}):a.jsx("td",{className:"py-3 px-4"}),a.jsx("td",{className:"py-3 px-4 text-gray-700 whitespace-nowrap font-medium",onClick:()=>be(ae,!0),children:ae.title}),a.jsx("td",{className:"py-3 px-4 whitespace-nowrap",onClick:()=>be(ae,!0),children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium whitespace-nowrap ${Q(ae.status||"Not started")}`,children:ae.status||"Not started"})}),a.jsx("td",{className:"py-3 px-4 whitespace-nowrap",onClick:()=>be(ae,!0),children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium whitespace-nowrap ${ne(ae.priority||"Low")}`,children:ae.priority||"Low"})}),a.jsx("td",{className:"py-3 px-4 text-gray-700 whitespace-nowrap",onClick:()=>be(ae,!0),children:ae.assignedToName||"Unassigned"}),a.jsx("td",{className:`py-3 px-4 text-gray-700 whitespace-nowrap ${pe(ae)?"text-red-600 font-medium":""}`,onClick:()=>be(ae,!0),children:ae.dateAssigned?zT(ae.dateAssigned):""}),a.jsx("td",{})]},ae.id)):a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"text-center py-4 text-gray-500",children:"No tasks found."})})})]})})}),!p&&!t&&n==="list"&&a.jsx(ca,{className:"mt-6",totalItems:Xe.length,pageSize:E,currentPage:Xe.length===0?0:T,onPrev:()=>A(ae=>Math.max(ae-1,1)),onNext:()=>A(ae=>Math.min(ae+1,Math.max(1,Math.ceil(Xe.length/E)||1))),onPageSizeChange:ae=>{M(ae),A(1)},pageSizeOptions:[10,20,30,40,50],label:"tasks"}),a.jsx(v0,{isOpen:r,onClose:me,onSave:Ue,onEdit:()=>u(!1),setFormData:X,formData:je,isEditing:!c&&!!o,viewMode:c,users:_,currentUser:e,onDelete:Ee}),z&&a.jsx(sVe,{open:!0,title:z.title,message:z.message,confirmLabel:z.confirmLabel,cancelLabel:z.cancelLabel,variant:z.variant,onConfirm:Fe,onCancel:st,loading:D})]})}function nVe({icon:e,title:t,value:n,color:s,bgColor:r,onClick:i}){return a.jsxs("div",{className:"flex items-center p-4 bg-white rounded-xl shadow-md border border-gray-200 transition-all duration-300 cursor-default",onClick:i,children:[a.jsx("div",{className:`flex-shrink-0 p-3 rounded-full ${r} ${s} mr-4`,children:e?a.jsx(e,{size:22}):null}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:t}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:n})]})]})}function sVe({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r,variant:i,loading:o,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":i==="warning"?"bg-orange-500 hover:bg-orange-600 border border-orange-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsx("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${u}`,disabled:o,children:o?"Processing...":s})]})]})})}function rVe({column:e,columnTasks:t,getTaskCardColor:n,isTaskOverdue:s,formatDateDisplay:r,handleOpenModal:i,handleDeleteTask:o,currentUser:l}){const{isOver:c,setNodeRef:u}=Wx({id:e});return a.jsxs("div",{ref:u,className:`bg-white p-4 shadow border flex flex-col relative rounded-md transition-all duration-200 min-h-[200px] ${c?"border-blue-400 bg-blue-50 ring-2 ring-blue-300":"border-gray-200"}`,children:[a.jsx("div",{className:"absolute top-0 left-0 w-full h-5 bg-secondary rounded-t-md"}),a.jsxs("div",{className:"flex items-center justify-between mb-3 pt-7",children:[a.jsx("h3",{className:"font-medium text-gray-900",children:e}),a.jsx("span",{className:"text-xs bg-gray-100 px-2 py-1 rounded-full text-gray-500",children:t.length})]}),a.jsx("div",{className:`space-y-3 flex-1 ${t.length>3?"overflow-y-auto max-h-[480px] hide-scrollbar":""}`,children:t.length>0?t.map(d=>a.jsx(iVe,{task:d,getTaskCardColor:n,isTaskOverdue:s,formatDateDisplay:r,handleOpenModal:i,handleDeleteTask:o,currentUser:l},d.id)):a.jsx("div",{className:`text-center py-10 text-gray-500 border-2 border-dashed rounded-lg ${c?"border-blue-300 bg-blue-50":"border-gray-200"}`,children:c?"Drop here":"No tasks"})})]})}function iVe({task:e,getTaskCardColor:t,isTaskOverdue:n,formatDateDisplay:s,handleOpenModal:r,handleDeleteTask:i,currentUser:o}){const{attributes:l,listeners:c,setNodeRef:u,transform:d,isDragging:h}=Gx({id:e.id}),p=!(/group.manager/i.test(o?.role)&&String(e?.createdById)!==String(o?.id)),x=d?{transform:`translate3d(${d.x}px, ${d.y}px, 0)`}:void 0;return a.jsxs("div",{ref:u,style:x,className:`border rounded-lg p-3 transition flex justify-between items-start cursor-grab active:cursor-grabbing ${t(e)} ${h?"opacity-50 shadow-lg ring-2 ring-blue-400":""}`,...c,...l,children:[a.jsxs("div",{className:"text-left flex-1",onClick:v=>{v.stopPropagation(),r(e,!0)},children:[a.jsx("p",{className:"font-medium text-gray-800 text-sm",children:e.title}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Priority: ",e.priority]}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Assigned To: ",e.assignedToName]}),a.jsxs("p",{className:"text-xs mt-1 text-gray-500",children:["Date: ",a.jsx("span",{className:n(e)?"text-red-600":"text-gray-600",children:e.dateAssigned?s(e.dateAssigned):""})]})]}),p&&a.jsxs("div",{className:"flex items-center gap-2 ml-3",onClick:v=>v.stopPropagation(),children:[a.jsx("button",{type:"button",onClick:v=>{v.stopPropagation(),r(e)},className:"text-blue-500 hover:text-blue-700",children:a.jsx(hn,{})}),a.jsx("button",{type:"button",onClick:v=>{v.stopPropagation(),i(e)},className:`${/group.manager/i.test(o?.role)?"text-orange-500 hover:text-orange-700":"text-red-500 hover:text-red-700"}`,children:/group.manager/i.test(o?.role)?a.jsx(Zt,{}):a.jsx(wa,{})})]})]})}function oVe({task:e,getTaskCardColor:t,isTaskOverdue:n,formatDateDisplay:s}){return a.jsx("div",{className:`border rounded-lg p-3 shadow-xl ring-2 ring-blue-400 ${t(e)}`,style:{width:"280px"},children:a.jsxs("div",{className:"text-left flex-1",children:[a.jsx("p",{className:"font-medium text-gray-800 text-sm",children:e.title}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Priority: ",e.priority]}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Assigned To: ",e.assignedToName]}),a.jsxs("p",{className:"text-xs mt-1 text-gray-500",children:["Date: ",a.jsx("span",{className:n(e)?"text-red-600":"text-gray-600",children:e.dateAssigned?s(e.dateAssigned):""})]})]})})}const Eee=e=>e?e.toUpperCase():"",tv=e=>{const t=Eee(e);return t==="PLANNED"||t==="IN PROGRESS"?"PLANNED":t==="HELD"||t==="DONE"?"HELD":t==="NOT_HELD"||t==="NOT HELD"?"NOT_HELD":"PLANNED"},lVe=e=>{if(!e)return"";const t=String(e).split("-");return t.length===3?`${t[0]}-${t[2]}`:String(e)},cVe=e=>{if(!e)return"--";try{return new Date(e).toLocaleString()}catch{return"--"}},dVe=e=>{const t=Eee(e);switch(t==="PLANNED"?"PENDING":t==="HELD"?"COMPLETED":t==="NOT_HELD"?"CANCELLED":t){case"PENDING":return"bg-indigo-100 text-indigo-700";case"COMPLETED":case"DONE":return"bg-green-100 text-green-700";case"CANCELLED":return"bg-gray-200 text-gray-700";case"IN PROGRESS":return"bg-blue-100 text-blue-700";default:return"bg-gray-100 text-gray-700"}},FT={subject:"",startTime:"",endTime:"",location:"",status:"PLANNED",notes:"",assignedTo:"",relatedType1:"Lead",relatedTo1:"",relatedType2:null,relatedTo2:""},uVe=()=>{const e=kt(),t=ta(),[n]=Bs(),s=n.get("id"),r=t.pathname==="/admin/meetings/info";f.useEffect(()=>{document.title="Meetings | Sari-Sari CRM"},[]);const[i,o]=f.useState([]),[l,c]=f.useState(!1),[u,d]=f.useState([]),[h,p]=f.useState(""),[x,v]=f.useState("Filter by Status"),[j,y]=f.useState(!1),[N,w]=f.useState(null),[S,_]=f.useState(1),[k,T]=f.useState(10),[A,E]=f.useState(FT),[M,z]=f.useState(!1),[P,D]=f.useState(null),[U,B]=f.useState(!1),[R,q]=f.useState(null),[Z,V]=f.useState(!1),[oe,je]=f.useState(null),[X,se]=f.useState(new Set),[ye,Ne]=f.useState(!1),{user:fe}=Vt();f.useEffect(()=>{const pe=t.state?.openMeetingModal,ce=t.state?.initialMeetingData?.relatedTo||n.get("id"),Q=t.state?.meetingID;pe||ce?(y(!0),t.state?.initialMeetingData&&E(ne=>({...ne,...t.state.initialMeetingData})),e(t.pathname,{replace:!0,state:{}})):Q&&(je(Q),e(t.pathname,{replace:!0,state:{}}))},[t,n,e]),f.useEffect(()=>{if(oe&&i.length>0&&!l){const pe=i.find(ce=>ce.id===oe);pe?w(pe):H.error("Meeting not found."),je(null)}},[oe,i,l]);const we=async()=>{if(s&&r){const pe=sessionStorage.getItem("meetingDetailData");if(pe)try{const ce=JSON.parse(pe);if(ce.id===parseInt(s)){w(ce),sessionStorage.removeItem("meetingDetailData");return}}catch(ce){console.error(ce)}}c(!0);try{const pe=await re.get("/meetings/admin/fetch-all"),Q=[...Array.isArray(pe.data)?pe.data:[]].sort((ne,ae)=>{const Pe=ne?.created_at?new Date(ne.created_at).getTime():0;return(ae?.created_at?new Date(ae.created_at).getTime():0)-Pe});if(o(Q),s&&!N){const ne=Q.find(ae=>ae.id===parseInt(s));ne&&w(ne)}}catch{H.error("Failed to load meetings.")}finally{c(!1)}},de=async()=>{try{const pe=await re.get("/users/all");d(Array.isArray(pe.data)?pe.data:[])}catch(pe){console.error(pe)}};f.useEffect(()=>{we(),de()},[]);const ke=pe=>p(pe.target.value),ge=f.useMemo(()=>{if(!fe?.id)return[];const pe=fe?.role?.toUpperCase();return pe==="GROUP MANAGER"||pe==="CEO"||pe==="ADMIN"?i:i.filter(ce=>ce.created_by===fe.id||ce.meet_assign_to?.id===fe.id)},[i,fe?.id,fe?.role]),me=["GROUP MANAGER","MANAGER","SALES"].includes(fe?.role?.toUpperCase())?ge.filter(pe=>!(pe.status?.toUpperCase()==="INACTIVE")):ge,Ue=f.useMemo(()=>{const pe=h.trim().toLowerCase(),ce=x.trim().toUpperCase();return me.filter(Q=>{const ne=[Q?.activity,Q?.description,Q?.relatedTo,Q?.assignedTo],ae=pe===""||ne.some(Te=>Te&&Te.toString().toLowerCase().includes(pe)),Pe=ce==="FILTER BY STATUS"||tv(Q.status||"PENDING")===ce;return ae&&Pe})},[me,h,x]),Ee=f.useMemo(()=>{const pe=(S-1)*k;return Ue.slice(pe,pe+k)},[Ue,S,k]),We=()=>{y(!1),E(FT),z(!1),D(null),B(!1)},tt=()=>{E(FT),z(!1),D(null),y(!0)},lt=pe=>{let ce="";if(pe.meet_assign_to?.id)ce=String(pe.meet_assign_to.id);else if(pe.assignedTo){const nt=u.find(ot=>`${ot.first_name} ${ot.last_name}`===pe.assignedTo);ce=nt?String(nt.id):""}const Q=nt=>{if(!nt)return"";try{const ot=new Date(nt),Re=ot.getTimezoneOffset()*6e4;return new Date(ot.getTime()-Re).toISOString().slice(0,16)}catch{return""}};let ne="Lead",ae="",Pe="Contact",Te="";if(pe.lead)ne="Lead",ae=String(pe.lead.id);else if(pe.account)ne="Account",ae=String(pe.account.id),pe.contact?(Pe="Contact",Te=String(pe.contact.id)):pe.deal?(Pe="Deal",Te=String(pe.deal.id)):pe.quote&&(Pe="Quote",Te=String(pe.quote.id));else if(pe.relatedType||pe.related_type){const nt=pe.relatedType||pe.related_type,ot=pe.related_to||pe.relatedToId;nt==="Lead"?(ne="Lead",ae=String(ot)):(ne="Account",ae=pe.account_id?String(pe.account_id):"")}const he={PLANNED:"Planned",HELD:"Held",NOT_HELD:"Not held"},He=tv(pe.status),qe=he[He]||"Planned";E({subject:pe.subject||pe.activity||"",location:pe.location||"",startTime:Q(pe.start_time||pe.startTime),endTime:Q(pe.end_time||pe.endTime),status:qe,notes:pe.description||pe.notes||"",assignedTo:ce,relatedType1:ne,relatedTo1:ae,relatedType2:Pe,relatedTo2:Te}),z(!0),D(pe.id),w(null),y(!0)},Fe=pe=>{if(!pe.subject?.trim())return H.error("Subject is required.");if(!pe.startTime)return H.error("Start time is required.");if(pe.endTime&&!(new Date(pe.endTime)-new Date(pe.startTime)>0))return H.error("End time must be after start time.");pe.relatedType1,pe.relatedTo1,pe.relatedType1==="Account"&&pe.relatedType2&&pe.relatedTo2&&(pe.relatedType2,pe.relatedTo2);const ce={...pe,assignedTo:parseInt(pe.assignedTo),relatedTo1:parseInt(pe.relatedTo1),relatedTo2:parseInt(pe.relatedTo2)},Q=M&&P?"update":"create";q({title:Q==="create"?"Confirm New Meeting":"Confirm Update",message:`Are you sure you want to ${Q} "${ce.subject}"?`,confirmLabel:Q==="create"?"Create Meeting":"Update Meeting",variant:"primary",action:{type:Q,payload:ce,targetId:P,name:ce.subject}})},st=async()=>{if(!R?.action)return;const{type:pe,payload:ce,targetId:Q,name:ne,targetIds:ae,count:Pe}=R.action;V(!0);try{if(pe==="create")B(!0),await re.post("/meetings/create",ce),H.success(`Meeting "${ne}" created.`),We(),await we();else if(pe==="update")B(!0),await re.put(`/meetings/${Q}`,ce),H.success(`Meeting "${ne}" updated.`),We(),await we();else if(pe==="delete")await re.put("/meetings/bulk-archive",{meeting_ids:[Q]}),H.success(`Meeting "${ne}" archived successfully.`),N?.id===Q&&w(null),await we();else if(pe==="bulk-delete"){if(!ae||ae.length===0)throw new Error("Missing meeting identifiers for bulk archiving.");Ne(!0),await re.put("/meetings/bulk-archive",{meeting_ids:ae}),H.success(`${Pe} meeting${Pe!==1?"s":""} archived successfully.`),se(new Set),await we(),N&&X.has(N.id)&&w(null)}}catch(Te){const he=pe==="create"?"Failed to create meeting. Please review the details and try again.":pe==="update"?"Failed to update meeting. Please review the details and try again.":pe==="bulk-delete"?"Failed to archive meetings. Please try again.":"Failed to archive meeting. Please try again.",He=Te?.response?.data?.detail||he;H.error(He),console.error(Te)}finally{(pe==="create"||pe==="update")&&B(!1),pe==="bulk-delete"&&Ne(!1),V(!1),q(null)}},Xe=pe=>{q({title:"Archive Meeting",message:`Are you sure you want to archive "${pe.subject||pe.activity}"? You can restore it later if needed.`,confirmLabel:"Archive",variant:"archive",action:{type:"delete",targetId:pe.id,name:pe.subject||pe.activity}})},Ze=pe=>{const ce=Ee.find(Q=>Q.id===pe);ce&&ce.created_by===fe?.id&&se(Q=>{const ne=new Set(Q);return ne.has(pe)?ne.delete(pe):ne.add(pe),ne})},Je=()=>{const pe=Ee.filter(ce=>ce.created_by===fe?.id);X.size===pe.length?se(new Set):se(new Set(pe.map(ce=>ce.id)))},Be=()=>{if(X.size===0)return;const pe=X.size;q({title:"Archive Meetings",message:a.jsxs("span",{children:["Are you sure you want to archive"," ",a.jsx("span",{className:"font-semibold",children:pe})," meeting",pe!==1?"s":"","? You can restore them later if needed."]}),confirmLabel:`Archive ${pe} Meeting${pe!==1?"s":""}`,cancelLabel:"Cancel",variant:"archive",action:{type:"bulk-delete",targetIds:Array.from(X),count:pe}})},_e=async(pe,ce)=>{try{await re.put(`/meetings/${pe}`,{status:ce}),H.success("Status updated"),we(),w(null)}catch{H.error("Failed to update status")}};return r&&s?N?a.jsx(Nd,{meeting:N,onClose:()=>{w(null),e("/admin/dashboard")},onEdit:lt,onDelete:Xe,onStatusUpdate:_e,currentUser:fe,isSalesView:!0}):a.jsx(Wt,{message:"Loading meeting..."}):a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[l&&a.jsx(Wt,{message:"Loading meetings..."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h1",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800 mb-4 lg:mb-0",children:[a.jsx(Ot,{className:"mr-2 text-blue-600"})," Meetings"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{onClick:tt,className:"bg-black text-white px-4 py-2 rounded-md flex items-center hover:bg-gray-800",children:[a.jsx(aa,{className:"mr-2"})," Add Meeting"]})})]}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full sm:w-auto lg:w-4/4 md:w-3/4",children:[a.jsx(Kt,{className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search meetings",value:h,onChange:ke,className:"w-full outline-none"})]}),a.jsxs("select",{value:x,onChange:pe=>v(pe.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm bg-white w-full sm:w-auto",children:[a.jsx("option",{children:"Filter by Status"}),a.jsx("option",{value:"PLANNED",children:"PLANNED"}),a.jsx("option",{value:"HELD",children:"HELD"}),a.jsx("option",{value:"NOT_HELD",children:"NOT HELD"})]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[500px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm mb-4",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 w-12",children:a.jsx("input",{type:"checkbox",checked:X.size===Ee.filter(pe=>pe.created_by===fe?.id).length&&Ee.filter(pe=>pe.created_by===fe?.id).length>0,onChange:Je,className:"w-4 h-4 cursor-pointer rounded border-gray-300"})}),a.jsx("th",{className:"py-3 px-4",children:"Subject"}),a.jsx("th",{className:"py-3 px-4",children:"Related To"}),a.jsx("th",{className:"py-3 px-4",children:"Start Time"}),a.jsx("th",{className:"py-3 px-4",children:"Assigned"}),a.jsx("th",{className:"py-3 px-4",children:"Status"}),a.jsx("th",{className:"py-3 px-4 w-12",children:X.size>0&&a.jsx("button",{onClick:Be,className:"text-orange-500 hover:text-orange-700 transition",title:"Archive selected meetings",disabled:ye,children:a.jsx(Zt,{size:18})})})]})}),a.jsx("tbody",{children:Ee.length>0?Ee.map(pe=>a.jsxs("tr",{onClick:()=>w(pe),className:"hover:bg-gray-50 cursor-pointer border-b border-gray-100",children:[a.jsx("td",{className:"py-3 px-4",onClick:ce=>ce.stopPropagation(),children:fe?.id===pe.created_by&&a.jsx("input",{type:"checkbox",checked:X.has(pe.id),onChange:ce=>{ce.stopPropagation(),Ze(pe.id)},className:"w-4 h-4 cursor-pointer rounded border-gray-300"})}),a.jsx("td",{className:"py-3 px-4 font-medium text-blue-600",children:pe.subject}),a.jsxs("td",{className:"py-3 px-4",children:[pe.lead&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:pe.lead.title}),pe.account&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:pe.account.name}),pe.contact&&a.jsxs("p",{className:"font-medium text-blue-500 text-xs",children:[pe.contact.first_name," ",pe.contact.last_name]}),pe.deal&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:pe.deal.name}),pe.quote&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:lVe(pe.quote.quote_id)})]}),a.jsx("td",{className:"py-3 px-4",children:cVe(pe.start_time)}),a.jsxs("td",{className:"py-3 px-4",children:[pe.meet_assign_to.first_name," ",pe.meet_assign_to.last_name]}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${dVe(tv(pe.status))}`,children:tv(pe.status).replace("_"," ")})})]},pe.id)):a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"text-center py-4 text-gray-500",children:"No meetings found."})})})]})}),a.jsx(ca,{totalItems:Ue.length,pageSize:k,currentPage:S,onPrev:()=>_(pe=>Math.max(1,pe-1)),onNext:()=>_(pe=>pe+1),onPageSizeChange:T,label:"meetings"}),j&&a.jsx(k1,{onClose:We,formData:A,setFormData:E,isEditing:M,onSubmit:Fe,isSubmitting:U||Z,users:u}),N&&a.jsx(Nd,{meeting:N,onClose:()=>w(null),onEdit:lt,onDelete:Xe,onStatusUpdate:_e,currentUser:fe,isSalesView:!0}),R&&a.jsx(mVe,{open:!0,title:R.title,message:R.message,confirmLabel:R.confirmLabel,variant:R.variant,onConfirm:st,onCancel:()=>q(null),loading:Z})]})};function mVe({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":i==="archive"?"bg-orange-500 hover:bg-orange-600 border border-orange-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{onClick:c,disabled:o,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",children:"Cancel"}),a.jsx("button",{onClick:l,disabled:o,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70
                       ${u}`,children:o?"...":s})]})]})})}const fVe=[{value:"PLANNED",label:"PLANNED"},{value:"HELD",label:"HELD"},{value:"NOT_HELD",label:"NOT HELD"}],hVe=e=>e?String(e).toUpperCase():"",pf=e=>{const t=hVe(e);return t==="PLANNED"||t==="PENDING"?"PLANNED":t==="HELD"||t==="COMPLETED"?"HELD":t==="NOT HELD"||t==="NOT_HELD"||t==="CANCELLED"?"NOT_HELD":"PLANNED"},UT=e=>{const t=pf(e);return t==="PLANNED"?"PLANNED":t==="HELD"?"HELD":t==="NOT_HELD"?"NOT HELD":"--"},mH=e=>{switch(pf(e)){case"PLANNED":return"bg-indigo-100 text-indigo-700";case"HELD":return"bg-green-100 text-green-700";case"NOT_HELD":return"bg-gray-200 text-gray-700";default:return"bg-gray-100 text-gray-700"}},fH=e=>e?new Date(e).toLocaleString("en-US",{month:"2-digit",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}):"--";function gVe(){const[e,t]=f.useState(!1),[n,s]=f.useState(null),[r,i]=f.useState(null),[o,l]=f.useState(null),[c,u]=f.useState(null),[d,h]=f.useState([]),[p,x]=f.useState(null),[v,j]=f.useState(!1),[y,N]=f.useState(null),[w,S]=f.useState(!1),[_,k]=f.useState(!1),[T,A]=f.useState("PLANNED"),[E,M]=f.useState(!1),[z,P]=f.useState(!1),[D,U]=f.useState(null),[B,R]=f.useState(new Set),[q,Z]=f.useState(!1),{user:V}=Vt(),{comments:oe,addComment:je,refresh:X}=kn({relatedType:"call",relatedId:n?.id});f.useEffect(()=>{n?.id&&X()},[n?.id,X]),Bs();const se=kt(),ye=ta(),Ne=W=>{if(!W)return"";const J=String(W).split("-");return J.length===3?`${J[0]}-${J[2]}`:String(W)},we={subject:"",call_time:(()=>{const W=new Date,J=W.getFullYear(),Y=String(W.getMonth()+1).padStart(2,"0"),F=String(W.getDate()).padStart(2,"0");return`${J}-${Y}-${F}T08:00`})(),duration_minutes:"",direction:"Outgoing",status:"Planned",notes:"",relatedType1:"Lead",relatedType2:null,relatedTo1:null,relatedTo2:null,assigned_to:null},[de,ke]=f.useState(we);f.useEffect(()=>{const W=ye.state,J=W?.callID;if(J&&!W?.openCallModal){U(J),se(ye.pathname,{replace:!0,state:{}});return}!W?.openCallModal||!W?.initialCallData||W.initialCallData.relatedType1==="Lead"&&Array.isArray(o)&&o.length===0||W.initialCallData.relatedType1==="Account"&&(!Array.isArray(o)||o.length===0)||(t(!0),ke(Y=>({...Y,...W.initialCallData,relatedTo1:W.initialCallData.relatedTo1?String(W.initialCallData.relatedTo1):"",relatedTo2:W.initialCallData.relatedTo2?String(W.initialCallData.relatedTo2):""})),se(ye.pathname,{replace:!0,state:{}}))},[ye.state,o]),f.useEffect(()=>{if(D&&d.length>0&&!z){const W=d.find(J=>J.id===D);W?s(W):H.error("Call not found."),U(null)}},[D,d,z]);const ge=async()=>{try{P(!0);const W=await re.get("/calls/admin/fetch-all"),Y=[...Array.isArray(W.data)?W.data:[]].sort((F,ue)=>{const De=F?.created_at?new Date(F.created_at):0;return(ue?.created_at?new Date(ue.created_at):0)-De});h(Y)}catch(W){console.error("Error fetching calls:",W),H.error("Failed to load calls")}finally{P(!1)}},$e=async()=>{try{const W=await re.get("/users/all");x(W.data)}catch(W){console.error("Error fetching users: ",W)}};f.useEffect(()=>{$e(),ge()},[]);const be=[],[me,Ue]=f.useState(""),[Ee,We]=f.useState("Filter by Status"),[tt,lt]=f.useState("Filter by Users"),[Fe,st]=f.useState(1),[Xe,Ze]=f.useState(10),Be=["GROUP MANAGER","MANAGER","SALES"].includes(V?.role?.toUpperCase())?d.filter(W=>W.status!=="INACTIVE"):d,_e=Math.max(1,Math.ceil(Be.length/Xe)||1);f.useEffect(()=>{st(1)},[me,Ee,Xe]),f.useEffect(()=>{st(W=>{const J=Math.max(1,Math.ceil(Be.length/Xe)||1);return W>J?J:W})},[Be.length,Xe]);const pe=f.useMemo(()=>{const W=(Fe-1)*Xe;return Be.slice(W,W+Xe)},[Be,Fe,Xe]),ce=()=>st(W=>Math.max(W-1,1)),Q=()=>st(W=>Math.min(W+1,_e)),ne=d.length,ae=d.filter(W=>pf(W.status)==="PLANNED").length,Pe=d.filter(W=>pf(W.status)==="HELD").length,Te=d.filter(W=>pf(W.status)==="NOT_HELD").length,he=[{title:"Total",value:ne,icon:Fs,color:"text-slate-600",bgColor:"bg-slate-100"},{title:"Planned",value:ae,icon:zs,color:"text-indigo-600",bgColor:"bg-indigo-100"},{title:"Held",value:Pe,icon:Qa,color:"text-green-600",bgColor:"bg-green-100"},{title:"Not Held",value:Te,icon:Us,color:"text-gray-600",bgColor:"bg-gray-100"}],[He,qe]=f.useState("Overview"),nt=W=>{const{name:J,value:Y}=W.target;ke(F=>{const ue={...F,[J]:Y};return J==="relatedType1"&&(ue.relatedTo1="",Y==="Lead"?(ue.relatedType2=null,ue.relatedTo2=null,u([])):Y==="Account"&&(ue.relatedType2="Contact")),J==="relatedType2"&&(ue.relatedTo2=""),ue})};f.useEffect(()=>{const W=async()=>{try{l([]);let J;de.relatedType1==="Lead"?J=await re.get("/leads/admin/getLeads"):de.relatedType1==="Account"&&(J=await re.get("/accounts/admin/fetch-all"));let Y=[];if(J&&Array.isArray(J.data)?Y=J.data:Y=[],v&&de.relatedTo1)try{let F;de.relatedType1==="Lead"?F=await re.get(`/leads/get/${de.relatedTo1}`):de.relatedType1==="Account"&&(F=await re.get(`/accounts/get/${de.relatedTo1}`)),F&&F.data&&(Y.some(De=>String(De.id)===String(de.relatedTo1))||(Y=[F.data,...Y]))}catch(F){console.error("Error fetching specific related item:",F)}l(Y)}catch(J){console.error("Error fetching data:",J),l([])}};de.relatedType1&&W()},[de.relatedType1,v,de.relatedTo1]),f.useEffect(()=>{const W=async()=>{try{u([]);let J;if(de.relatedType1==="Account"&&de.relatedTo1)de.relatedType2==="Contact"?J=await re.get(`/contacts/from-acc/${de.relatedTo1}`):de.relatedType2==="Deal"?J=await re.get(`/deals/from-acc/${de.relatedTo1}`):de.relatedType2==="Quote"&&(J=await re.get(`/quotes/from-acc/${de.relatedTo1}`));else{u([]);return}let Y=[];if(J&&Array.isArray(J.data)?Y=J.data:Y=[],v&&de.relatedTo2)try{let F;de.relatedType2==="Contact"?F=await re.get(`/contacts/get/${de.relatedTo2}`):de.relatedType2==="Deal"?F=await re.get(`/deals/get/${de.relatedTo2}`):de.relatedType2==="Quote"&&(F=await re.get(`/quotes/get/${de.relatedTo2}`)),F&&F.data&&(Y.some(De=>String(De.id)===String(de.relatedTo2))||(Y=[F.data,...Y]))}catch(F){console.error("Error fetching specific related item:",F)}u(Y)}catch(J){console.error("Error fetching data:",J),u([])}};de.relatedType2&&W()},[de.relatedType2,de.relatedTo1,de.relatedType1,v,de.relatedTo2]);const[ot,Re]=f.useState(!1),it=W=>{W.preventDefault(),Re(!0);const J=de.subject;if(!J||J.trim()===""){H.error("Subject is required.");return}if(!de.relatedTo1){H.error(`Please select a ${de.relatedType1||"Lead/Account"}.`);return}if(!de.assigned_to){H.error("Subject is required.");return}const F={...de,duration_minutes:de.duration_minutes?parseInt(de.duration_minutes,10):null,relatedTo1:de.relatedTo1?parseInt(de.relatedTo1,10):null,relatedTo2:de.relatedType1==="Lead"?null:de.relatedTo2?parseInt(de.relatedTo2,10):null,relatedType2:de.relatedType1==="Lead"?null:de.relatedType2,assigned_to:de.assigned_to?parseInt(de.assigned_to,10):null},ue=v&&y?"update":"create",De=(de.subject||"").trim()||"Untitled Call";i({title:ue==="create"?"Confirm New Call":"Confirm Update",message:ue==="create"?`Create "${De}"?`:`Save changes to "${De}"?`,confirmLabel:ue==="create"?"Create Call":"Update Call",cancelLabel:"Cancel",variant:"primary",action:{type:ue,payload:F,targetId:y||null,name:De}})},St=W=>s(W),Et=()=>{t(!1),j(!1),N(null)},Tt=async()=>{if(!r?.action){i(null);return}const{action:W}=r,{type:J,payload:Y,targetId:F,name:ue}=W;k(!0);try{if(J==="create")S(!0),await re.post("/calls/create",Y),H.success(`Call "${ue}" created successfully.`),t(!1),ke(we),j(!1),N(null),await ge();else if(J==="update"){if(!F)throw new Error("Missing call identifier for update.");S(!0),await re.put(`/calls/${F}`,Y),H.success(`Call "${ue}" updated successfully.`),t(!1),ke(we),j(!1),N(null),await ge()}else if(J==="delete"){if(!F)throw new Error("Missing call identifier for archiving.");await re.put(`/calls/${F}`,{status:"INACTIVE"}),H.success(`Call "${ue}" archived successfully.`),n?.id===F&&s(null),await ge()}else if(J==="bulk-delete"){const{targetIds:De,count:le}=W;if(!De||De.length===0)throw new Error("Missing call identifiers for bulk archiving.");Z(!0),await re.put("/calls/bulk-archive",{call_ids:De}),H.success(`${le} call${le!==1?"s":""} archived successfully.`),R(new Set),await ge(),n&&B.has(n.id)&&s(null)}}catch(De){const le=J==="create"?"Failed to create call. Please review the details and try again.":J==="update"?"Failed to update call. Please review the details and try again.":J==="bulk-delete"?"Failed to archive calls. Please try again.":"Failed to archive call. Please try again.",Ie=De?.response?.data?.detail||le;H.error(Ie)}finally{(J==="create"||J==="update")&&S(!1),J==="bulk-delete"&&Z(!1),k(!1),i(null)}},Nt=()=>{_||i(null)},xe=W=>{const J=pe.find(Y=>Y.id===W);J&&J.call_creator?.id===V?.id&&R(Y=>{const F=new Set(Y);return F.has(W)?F.delete(W):F.add(W),F})},ve=()=>{const W=pe.filter(J=>J.call_creator?.id===V?.id);B.size===W.length?R(new Set):R(new Set(W.map(J=>J.id)))},Oe=()=>{if(B.size===0)return;const W=B.size;i({title:"Archive Calls",message:a.jsxs("span",{children:["Are you sure you want to archive"," ",a.jsx("span",{className:"font-semibold",children:W})," call",W!==1?"s":"","? You can restore them later if needed."]}),confirmLabel:`Archive ${W} Call${W!==1?"s":""}`,cancelLabel:"Cancel",variant:"archive",action:{type:"bulk-delete",targetIds:Array.from(B),count:W}})},Ce=async()=>{if(n?.id)try{M(!0),await re.put(`/calls/${n.id}`,{status:T}),H.success(`Status updated to ${UT(T)}`),h(W=>Array.isArray(W)?W.map(J=>J.id===n.id?{...J,status:T}:J):W),s(null)}catch(W){const J=W.response?.data?.detail||"Failed to update status.";H.error(J)}finally{M(!1)}};f.useEffect(()=>{n&&A(pf(n.status))},[n]);const Qe=n?a.jsxs("div",{id:"callModalBackdrop",onClick:W=>W.target.id==="callModalBackdrop"&&s(null),className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center p-4",children:[z&&a.jsx(Wt,{message:"Loading call details..."}),a.jsxs("div",{className:"bg-white rounded-xl shadow-lg w-full max-w-full lg:max-w-4xl max-h-[95vh] overflow-y-auto hide-scrollbar relative box-border",children:[a.jsxs("div",{className:"bg-tertiary w-full rounded-t-xl p-3 lg:p-3 relative",children:[a.jsx("h1",{className:"lg:text-3xl text-xl text-white font-semibold text-center w-full",children:"Calls"}),a.jsx("button",{onClick:()=>s(null),className:"text-gray-500 hover:text-white transition cursor-pointer absolute top-3 right-3",children:a.jsx(Ja,{size:25})})]}),a.jsx("div",{className:"mt-4 gap-2 px-2 lg:gap-4 lg:mx-7",children:a.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between lg:flex-row lg:items-center lg:justify-between mt-3 gap-2 px-2 md:items-center lg:gap-4 md:mx-7 lg:mx-7",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[a.jsx("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-800",children:n.subject}),a.jsx("span",{className:`text-xs sm:text-sm font-medium px-2 sm:px-3 py-1 rounded-full ${mH(n.status)}`,children:UT(n.status)})]}),a.jsx("div",{className:"flex flex-col sm:flex-row sm:space-x-3 space-y-2 sm:space-y-0",children:V?.id===n.call_creator?.id&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{className:"inline-flex items-center justify-center w-full sm:w-auto bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 transition text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",onClick:()=>{const W=De=>{if(!De)return"";const le=new Date(De),Ie=le.getFullYear(),K=String(le.getMonth()+1).padStart(2,"0"),ie=String(le.getDate()).padStart(2,"0"),Me=String(le.getHours()).padStart(2,"0"),Ke=String(le.getMinutes()).padStart(2,"0");return`${Ie}-${K}-${ie}T${Me}:${Ke}`},J=n.lead?"Lead":n.account?"Account":"Lead",Y=n.lead?n.lead.id:n.account?n.account.id:null,F=J==="Lead"?null:n.contact?"Contact":n.deal?"Deal":n.quote?"Quote":"Contact",ue=J==="Lead"?null:n.contact?n.contact.id:n.deal?n.deal.id:n.quote?n.quote.id:null;ke({subject:n.subject||"",call_time:W(n.call_time),duration_minutes:n.duration_minutes?String(n.duration_minutes):"",direction:n.direction||"Outgoing",status:n.status||"Planned",notes:n.notes||"",relatedType1:J,relatedType2:F,relatedTo1:Y?String(Y):"",relatedTo2:ue?String(ue):"",assigned_to:n.call_assign_to?.id?String(n.call_assign_to.id):""}),j(!0),N(n.id),s(null),t(!0)},children:[a.jsx(gn,{className:"mr-2"}),"Edit"]}),a.jsxs("button",{className:"inline-flex items-center justify-center w-full sm:w-auto px-4 py-2 rounded-md text-sm bg-orange-500 text-white hover:bg-orange-600 transition focus:outline-none focus:ring-2 focus:ring-orange-400",onClick:()=>{const W=n.subject||"this call";i({title:"Archive Call",message:`Are you sure you want to archive "${W}"? You can restore it later if needed.`,confirmLabel:"Archive Call",cancelLabel:"Cancel",variant:"archive",action:{type:"delete",targetId:n.id,name:W}})},children:[a.jsx(Zt,{className:"mr-2"}),"Archive"]})]})})]})}),a.jsx("div",{className:"border-b border-gray-200 my-5"}),a.jsxs("div",{className:"p-6 lg:p-4",children:[a.jsx("div",{className:"flex w-full bg-[#6A727D] text-white mt-1 overflow-x-auto mb-6",children:["Overview","Notes"].map(W=>a.jsx("button",{onClick:()=>qe(W),className:`flex-1 min-w-[90px] px-4 py-2.5 text-xs sm:text-sm font-medium border-b-2 ${He===W?"bg-paper-white text-[#6A727D] border-white":"text-white hover:bg-[#5c636d]"}`,children:W},W))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 items-start",children:[a.jsxs("div",{className:"lg:col-span-3",children:[He==="Overview"&&a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 md:p-8 border border-gray-200",children:a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4 sm:gap-6 text-sm text-gray-700",children:[a.jsx(wo,{label:"Call Time",value:fH(n.call_time)}),a.jsx(wo,{label:"Duration",value:n.duration_minutes?`${n.duration_minutes} min`:null}),a.jsx(wo,{label:"Direction",value:n.direction||"--"}),a.jsx(wo,{label:"Assigned To",value:`${n.call_assign_to.first_name} ${n.call_assign_to.last_name}`}),n.lead&&a.jsx(wo,{label:"Lead",value:n.lead.title}),n.account&&a.jsx(wo,{label:"Account",value:n.account.name}),n.contact&&a.jsx(wo,{label:"Contact",value:`${n.contact.first_name} ${n.contact.last_name}`}),n.deal&&a.jsx(wo,{label:"Deal",value:n.deal.name}),n.quote&&a.jsx(wo,{label:"Quote",value:Ne(n.quote.quote_id)}),a.jsx(wo,{label:"Created At",value:fH(n.created_at)})]})}),He==="Notes"&&a.jsxs("div",{className:"mt-4 w-full",children:[a.jsx("div",{className:"flex flex-wrap items-center justify-between mb-4 gap-2",children:a.jsx("h3",{className:"text-lg font-semibold text-gray-800 break-words",children:"Call Note"})}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 shadow-sm break-words",children:[a.jsx("div",{className:"flex items-start justify-between",children:a.jsx("div",{children:a.jsx("p",{className:"text-sm font-medium text-gray-800 break-words",children:"Note"})})}),a.jsx("div",{className:"mt-3 text-sm text-gray-700 whitespace-pre-wrap break-words",children:n.notes||"No notes available."})]}),a.jsx(Tn,{comments:oe,onAddComment:je})]})]}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm w-full",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Status"}),a.jsxs("select",{className:"border border-gray-200 rounded-md px-2 py-1.5 w-full text-sm mb-2",value:T,onChange:W=>A(W.target.value),children:[a.jsx("option",{value:"PLANNED",children:"PLANNED"}),a.jsx("option",{value:"HELD",children:"HELD"}),a.jsx("option",{value:"NOT_HELD",children:"NOT HELD"})]}),a.jsx("button",{onClick:Ce,disabled:E,className:"w-full py-1.5 rounded-md text-sm bg-gray-900 text-white hover:bg-gray-800 disabled:opacity-50",children:E?"Updating...":"Update"})]})]})]})]})]}):null,G=e?a.jsx("div",{id:"modalBackdrop",onClick:W=>W.target.id==="modalBackdrop"&&Et(),className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-xl rounded-2xl shadow-lg p-4 sm:p-6 md:p-8 relative border border-gray-200 overflow-y-auto max-h-[90vh] hide-scrollbar",children:[a.jsx("button",{onClick:()=>{Et(),Re(!1)},className:"absolute top-4 right-4 text-gray-500 hover:text-black transition",children:a.jsx(ea,{size:22})}),a.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800 mb-4 sm:mb-6 flex items-center justify-center",children:v?"Edit Call":"Add New Call"}),a.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 w-full gap-4 text-sm",onSubmit:it,noValidate:!0,children:[a.jsx(xVe,{label:"Subject",className:"md:col-span-2",name:"subject",value:de.subject,onChange:nt,isSubmitted:ot,required:!0}),a.jsxs("div",{className:"w-full flex flex-col",children:[a.jsxs("div",{className:"relative w-25",children:[a.jsxs("select",{name:"relatedType1",onChange:nt,value:de.relatedType1,className:"outline-none cursor-pointer mb-1 w-22 text-gray-700 disabled:text-gray-400 disabled:cursor-not-allowed",disabled:w,children:[a.jsx("option",{value:"Lead",children:"Lead"}),a.jsx("option",{value:"Account",children:"Account"})]}),a.jsx("span",{className:"absolute left-10 md:pl-6 pl-6 top-1/2 -translate-y-1/2 text-red-500 pointer-events-none",children:"*"})]}),a.jsx(BT,{items:Array.isArray(o)?o:[],value:de.relatedTo1??"",placeholder:`Search ${de.relatedType1||"here"}...`,getLabel:W=>de.relatedType1==="Lead"?W.title:W.name??"",onChange:W=>ke(J=>({...J,relatedTo1:W})),required:!0,isSubmitted:ot,disabled:w})]}),a.jsxs("div",{className:"w-full flex flex-col",children:[a.jsxs("select",{name:"relatedType2",onChange:nt,value:de.relatedType2??"Contact",className:"text-gray-700 outline-none cursor-pointer mb-1 w-22 disabled:text-gray-400 disabled:cursor-not-allowed",disabled:de.relatedType1==="Lead"||w,children:[a.jsx("option",{value:"Contact",children:"Contact"}),a.jsx("option",{value:"Deal",children:"Deal"}),a.jsx("option",{value:"Quote",children:"Quote"})]}),a.jsx(BT,{disabled:de.relatedType1==="Lead"||w,items:Array.isArray(c)?c:[],value:de.relatedTo2??"",placeholder:de.relatedType1==="Lead"?"":Array.isArray(c)&&c.length>0?`Search ${de.relatedType2||"Contact"}...`:`No ${de.relatedType2||""} data found`,getLabel:W=>de.relatedType2==="Contact"?`${W.first_name??""} ${W.last_name??""}`.trim():de.relatedType2==="Quote"?Ne(W.quote_id)??"":W.name??"",onChange:W=>ke(J=>({...J,relatedTo2:W}))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Call Time"}),a.jsx("input",{type:"datetime-local",value:de.call_time,onChange:nt,name:"call_time",className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100"})]}),a.jsxs("div",{className:"w-full",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Duration"}),a.jsxs("div",{className:"w-full rounded-md text-sm flex flex-row items-center justify-start",children:[a.jsx("input",{type:"tel",value:de.duration_minutes,onChange:nt,name:"duration_minutes",className:"border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100 w-44 mr-3"}),a.jsx("p",{children:"minutes"})]})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:["Assign To ",a.jsx("span",{className:"text-red-600 font-semibold",children:"*"})]}),a.jsx(BT,{items:Array.isArray(p)?p:[],value:de.assigned_to??"",placeholder:"Search an account...",getLabel:W=>`${W.first_name} ${W.last_name}`,onChange:W=>ke(J=>({...J,assigned_to:W})),required:!0,isSubmitted:ot})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Direction"}),a.jsxs("select",{name:"direction",onChange:nt,value:de.direction,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100",children:[a.jsx("option",{value:"Incoming",children:"Incoming"}),a.jsx("option",{value:"Outgoing",children:"Outgoing"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Status"}),a.jsxs("select",{name:"status",onChange:nt,value:de.status,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100",children:[a.jsx("option",{value:"Planned",children:"Planned"}),a.jsx("option",{value:"Held",children:"Held"}),a.jsx("option",{value:"Not held",children:"Not held"})]})]}),a.jsx(yVe,{className:"col-span-2",label:"Notes",value:de.notes,onChange:nt,name:"notes"}),a.jsxs("div",{className:"flex flex-col md:flex-row justify-end col-span-2 mt-4 gap-2 w-full",children:[a.jsx("button",{type:"button",onClick:()=>{Et(),Re(!1)},className:"w-full sm:w-auto px-4 py-2 text-white bg-red-400 border border-red-300 rounded hover:bg-red-500 transition",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:w,className:"w-full sm:w-auto px-4 py-2 text-white bg-tertiary border border-tertiary rounded hover:bg-secondary transition",children:w?"Saving...":v?"Update Call":"Save Call"})]})]})]})}):null;return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h1",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(Fs,{className:"mr-2 text-blue-600"})," Calls"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{onClick:()=>{ke(we),j(!1),N(null),t(!0),Re(!1)},className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 my-1 lg:my-0 rounded-md hover:bg-gray-800 text-sm sm:text-base mx-auto sm:ml-auto cursor-pointer",children:[a.jsx(aa,{className:"mr-2"})," Add Call"]})})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-4 mb-6 w-full break-words overflow-hidden lg:overflow-visible",children:he.map(W=>a.jsx(pVe,{...W},W.title))}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center gap-3",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search calls",className:"focus:outline-none text-base w-full",defaultValue:me})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row w-full lg:w-1/2 gap-2",children:[a.jsxs("select",{defaultValue:Ee,className:"border border-gray-300 rounded-lg px-3 h-11 text-sm bg-white w-full",children:[a.jsx("option",{value:"Filter by Status",children:"Filter by Status"}),fVe.map(W=>a.jsx("option",{value:W.value,children:W.label},W.value))]}),a.jsxs("select",{defaultValue:tt,className:"border border-gray-300 rounded-lg px-3 h-11 text-sm bg-white w-full",children:[a.jsx("option",{value:"Filter by Users",children:"Filter by Users"}),be.map(W=>a.jsx("option",{value:W.name,children:W.name},W.id))]})]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[500px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm mb-4",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 w-12",children:a.jsx("input",{type:"checkbox",checked:B.size===pe.filter(W=>W.call_creator?.id===V?.id).length&&pe.filter(W=>W.call_creator?.id===V?.id).length>0,onChange:ve,className:"w-4 h-4 cursor-pointer rounded border-gray-300"})}),a.jsx("th",{className:"py-3 px-4",children:"Subject"}),a.jsx("th",{className:"py-3 px-4",children:"Related To"}),a.jsx("th",{className:"py-3 px-4",children:"Call Time"}),a.jsx("th",{className:"py-3 px-4",children:"Assigned To"}),a.jsx("th",{className:"py-3 px-4",children:"Status"}),a.jsx("th",{className:"py-3 px-4 w-12",children:B.size>0&&a.jsx("button",{onClick:Oe,className:"text-orange-500 hover:text-orange-700 transition",title:"Archive selected calls",disabled:q,children:a.jsx(Zt,{size:18})})})]})}),a.jsx("tbody",{children:z?a.jsx("tr",{children:a.jsx("td",{colSpan:6,className:"py-10",children:a.jsx(Wt,{message:"Loading calls..."})})}):pe.length>0?pe.map(W=>a.jsxs("tr",{onClick:()=>St(W),className:"hover:bg-gray-50 cursor-pointer border-b border-gray-100",children:[a.jsx("td",{className:"py-3 px-4",onClick:J=>J.stopPropagation(),children:V?.id===W.call_creator?.id&&a.jsx("input",{type:"checkbox",checked:B.has(W.id),onChange:J=>{J.stopPropagation(),xe(W.id)},className:"w-4 h-4 cursor-pointer rounded border-gray-300"})}),a.jsx("td",{className:"py-3 px-4 text-blue-600 font-medium",children:W.subject||"--"}),a.jsxs("td",{className:"py-3 px-4",children:[W.lead&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:W.lead.title}),W.account&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:W.account.name}),W.contact&&a.jsxs("p",{className:"font-medium text-blue-500 text-xs",children:[W.contact.first_name," ",W.contact.last_name]}),W.deal&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:W.deal.name}),W.quote&&a.jsx("p",{className:"font-medium text-blue-500 text-xs",children:Ne(W.quote.quote_id)})]}),a.jsx("td",{className:"py-3 px-4 text-gray-800",children:W.call_time?new Date(W.call_time).toLocaleString():"--"}),a.jsx("td",{className:"py-3 px-4 text-gray-800",children:W?.call_assign_to?`${W.call_assign_to.first_name} ${W.call_assign_to.last_name}`:"--"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${mH(W.status)}`,children:UT(W.status)})})]},W.id)):a.jsx("tr",{children:a.jsx("td",{colSpan:6,className:"text-center py-4 text-gray-500",children:"No calls found."})})})]})}),a.jsx(ca,{totalItems:Be.length,pageSize:Xe,currentPage:Fe,onPrev:ce,onNext:Q,onPageSizeChange:Ze,label:"calls"})]}),Qe,G,r&&a.jsx(bVe,{open:!0,title:r.title,message:r.message,confirmLabel:r.confirmLabel,cancelLabel:r.cancelLabel,variant:r.variant,onConfirm:Tt,onCancel:Nt,loading:_})]})}function pVe({icon:e,title:t,value:n,color:s,bgColor:r}){return a.jsxs("div",{className:"flex items-center p-4 bg-white rounded-xl shadow-md border border-gray-200 transition-all duration-300",children:[a.jsx("div",{className:`p-3 rounded-full ${r} ${s} mr-4`,children:a.jsx(e,{size:22})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:t}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:n})]})]})}function xVe({label:e,name:t,value:n,onChange:s,placeholder:r="",type:i="text",required:o=!1,disabled:l=!1,isSubmitted:c=!1,className:u=""}){const d=c&&o&&!n;return a.jsxs("div",{className:u,children:[a.jsxs("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:[e," ",o&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:i,name:t,value:n??"",onChange:s,placeholder:r,disabled:l,className:`w-full rounded-md px-2 py-1.5 text-sm outline-none border focus:ring-2 disabled:bg-gray-100
          ${d?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}
        `})]})}function yVe(e){return a.jsxs("div",{className:e.className,children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e.label}),a.jsx("textarea",{...e,className:"w-full border border-gray-300 rounded-md px-2 py-1.5 text-sm focus:ring-2 focus:ring-blue-400 outline-none disabled:bg-gray-100 resize-none"})]})}function wo({label:e,value:t}){return a.jsxs("p",{children:[a.jsxs("span",{className:"font-semibold",children:[e,":"]})," ",a.jsx("br",{}),a.jsx("span",{className:"break-words",children:t||"--"})]})}function bVe({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o=!1,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":i==="archive"?"bg-orange-500 hover:bg-orange-600 border border-orange-400":"bg-tertiary hover:bg-secondary border border-tertiary";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("p",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsx("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${u}`,disabled:o,children:o?"Processing...":s})]})]})})}function BT({items:e=[],value:t="",onChange:n,getLabel:s,placeholder:r="Search...",disabled:i=!1,maxRender:o=200,required:l=!1,isSubmitted:c=!1}){const[u,d]=f.useState(!1),[h,p]=f.useState(""),x=f.useRef(null),v=e.find(w=>String(w.id)===String(t)),j=v?s(v):"",y=l&&c&&!t,N=f.useMemo(()=>{const w=h.trim().toLowerCase();return(w?e.filter(_=>(s(_)||"").toLowerCase().includes(w)):e).slice(0,o)},[e,h,s,o]);return f.useEffect(()=>{const w=S=>{x.current&&!x.current.contains(S.target)&&d(!1)};return document.addEventListener("mousedown",w),()=>document.removeEventListener("mousedown",w)},[]),f.useEffect(()=>{u||p("")},[u]),a.jsxs("div",{ref:x,className:"relative w-full",children:[a.jsx("input",{disabled:i,value:u?h:j,placeholder:r,onFocus:()=>!i&&d(!0),onChange:w=>{p(w.target.value),u||d(!0)},className:`w-full border rounded-md px-2 py-1.5 text-sm outline-none focus:ring-2 disabled:bg-gray-100
          ${y?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-400"}`}),u&&!i&&a.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg overflow-hidden",children:[a.jsx("div",{className:"max-h-56 overflow-y-auto",children:N.length>0?N.map(w=>{const S=String(w.id),_=s(w),k=String(t)===S;return a.jsx("button",{type:"button",onClick:()=>{n(S),d(!1)},className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-50 ${k?"bg-blue-50":""}`,children:_||"--"},S)}):a.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No results"})}),e.length>o&&a.jsxs("div",{className:"px-3 py-2 text-[11px] text-gray-400 border-t",children:["Showing first ",o," results  keep typing to narrow."]})]})]})}function vVe(){f.useEffect(()=>{document.title="Audit | Sari-Sari CRM"},[]);const[e,t]=f.useState(null),[n,s]=f.useState(""),[r,i]=f.useState("Filter by Actions"),[o,l]=f.useState(1),[c,u]=f.useState(10),d=async()=>{try{const w=await re.get("/logs/read-all");t(w.data)}catch(w){console.error("Error fetching audit logs:",w)}};f.useEffect(()=>{d()},[]);const h=f.useMemo(()=>{if(!Array.isArray(e))return[];const w=n.trim().toLowerCase(),S=r?.toUpperCase?.()||"ALL";return e.filter(k=>{const T=k.timestamp?new Date(k.timestamp).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}):"",A=`${k.entity_type||""} ${k.entity_name||k.entity_details?.name||k.entity_details?.title||k.entity_id||""}`,E=`${k.logger?.first_name||""} ${k.logger?.last_name||""}`,M=[T,E,k.action,k.entity_type,A,k.description],z=w===""||M.some(D=>D==null?!1:D.toString().toLowerCase().includes(w)),P=S==="FILTER BY ACTIONS"||(k.action||"").toUpperCase()===S;return z&&P}).sort((k,T)=>{const A=k.timestamp?new Date(k.timestamp).getTime():0;return(T.timestamp?new Date(T.timestamp).getTime():0)-A})},[e,n,r]),p=Math.max(1,Math.ceil(h.length/c)||1);f.useEffect(()=>{l(1)},[n,c]),f.useEffect(()=>{l(w=>{const S=Math.max(1,Math.ceil(h.length/c)||1);return w>S?S:w})},[h.length,c]);const x=f.useMemo(()=>{const w=(o-1)*c;return h.slice(w,w+c)},[h,o,c]);h.length===0||(o-1)*c+1,Math.min(o*c,h.length);const v=()=>l(w=>Math.max(w-1,1)),j=()=>l(w=>Math.min(w+1,p)),y=()=>{if(!h.length){Kx.error("No logs to export!");return}const w=["Timestamp","User","Action","Resource","Details"],S=h.map(E=>[new Date(E.timestamp).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}),`${E.logger?.first_name||""} ${E.logger?.last_name||""}`.trim(),E.action,`${E.entity_type}: ${E.entity_id}`,E.description||""]),_=[w.join(","),...S.map(E=>E.map(M=>`"${String(M).replace(/"/g,'""')}"`).join(","))].join(`
`),k=new Blob([_],{type:"text/csv;charset=utf-8;"}),T=URL.createObjectURL(k),A=document.createElement("a");A.href=T,A.download=`AuditLogs_${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(A),A.click(),document.body.removeChild(A),URL.revokeObjectURL(T)},N=w=>{switch((w||"").toUpperCase()){case"CREATE":return"bg-green-100 text-green-700";case"UPDATE":case"EDIT":return"bg-blue-100 text-blue-700";case"DELETE":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-700"}};return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[e===null&&a.jsx(Wt,{message:"Loading audit logs..."}),a.jsx(Qx,{toastOptions:{duration:1e3}}),a.jsxs("div",{className:"bg-blue-50 border-l-4 border-blue-400 p-4 mb-6 rounded-r-md flex items-center",children:[a.jsx(Ot,{className:"text-blue-600 mr-3 flex-shrink-0",size:20}),a.jsxs("p",{className:"text-sm text-blue-700",children:[a.jsx("span",{className:"font-semibold",children:"Data Retention Policy:"})," Audit logs are automatically purged after 6 months to optimize system performance."]})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-5 space-y-3 sm:space-y-0",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(ks,{className:"text-blue-600",size:20}),a.jsx("h2",{className:"text-2xl sm:text-xl font-semibold text-gray-700",children:"Audit Logs"})]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 rounded-md hover:bg-gray-800 text-sm sm:text-base self-end sm:self-auto cursor-pointer",onClick:y,children:[a.jsx(Vo,{className:"mr-2"}),"Export Logs"]})})]}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition bg-white",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search audit logs",value:n,onChange:w=>s(w.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsx("div",{className:"w-full lg:w-1/4",children:a.jsxs("select",{value:r,onChange:w=>i(w.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:[a.jsx("option",{value:"Filter by Actions",children:"Filter by Actions"}),a.jsx("option",{value:"CREATE",children:"CREATE"}),a.jsx("option",{value:"DELETE",children:"DELETE"}),a.jsx("option",{value:"UPDATE",children:"UPDATE"})]})})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[600px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 text-sm tracking-wide font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4",children:"Timestamp"}),a.jsx("th",{className:"py-3 px-4",children:"User"}),a.jsx("th",{className:"py-3 px-4",children:"Action"}),a.jsx("th",{className:"py-3 px-4",children:"Resource"}),a.jsx("th",{className:"py-3 px-4",children:"Details"})]})}),a.jsx("tbody",{children:Array.isArray(h)&&h.length>0?x.map((w,S)=>a.jsxs("tr",{className:"hover:bg-gray-50 text-sm",children:[a.jsx("td",{className:"py-3 px-4 text-gray-700 whitespace-nowrap",children:new Date(w.timestamp).toLocaleString("en-US",{month:"numeric",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}).replace(",","")}),a.jsx("td",{className:"py-3 px-4 text-gray-700",children:w.name}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium whitespace-nowrap ${N(w.action)}`,children:w.action})}),a.jsxs("td",{className:"py-3 px-4 text-gray-700",children:[w.entity_type,": ",w.entity_id]}),a.jsx("td",{className:"py-3 px-4 text-gray-700",children:w.description})]},S)):a.jsx("tr",{children:a.jsx("td",{className:"py-3 px-4 text-sm text-gray-500 text-center",colSpan:5,children:"No activities to show."})})})]})}),a.jsx(ca,{className:"mt-4",totalItems:h.length,pageSize:c,currentPage:o,onPrev:v,onNext:j,onPageSizeChange:u,label:"logs"})]})}const I1=[{value:"Manager",label:"Manager"},{value:"Sales",label:"Sales"}],Fg={firstName:"",lastName:"",email:"",password:"",role:""},wVe={CEO:"bg-purple-100 text-purple-700",ADMIN:"bg-purple-100 text-purple-700",GROUP_MANAGER:"bg-indigo-100 text-indigo-700",MANAGER:"bg-blue-100 text-blue-700",MARKETING:"bg-yellow-100 text-yellow-700",SALES:"bg-green-100 text-green-700"},Lo=e=>e?e.toString().trim().replace(/([a-z0-9])([A-Z])/g,"$1_$2").replace(/\s+/g,"_").toUpperCase():"",jVe=e=>{const t=Lo(e),n=I1.find(s=>Lo(s.value)===t);return n?n.value:e||""},uL=e=>{const t=Lo(e),n=I1.find(s=>Lo(s.value)===t);return n?n.label:typeof e=="string"?e.toLowerCase().replace(/\b\w/g,s=>s.toUpperCase()):"--"},hH=e=>{if(!e)return"--";const t=new Date(e);return Number.isNaN(t.getTime())?"--":t.toLocaleString("en-US",{month:"2-digit",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).replace(",","")},HT=(e,{size:t="sm"}={})=>{const n=Lo(e),s=wVe[n]||"bg-gray-100 text-gray-700",r=t==="lg"?"px-3 py-1 text-sm":t==="md"?"px-2.5 py-1 text-sm":"px-2 py-1 text-xs";return a.jsx("span",{className:`${r} font-semibold rounded-md inline-flex items-center justify-center ${s}`,children:uL(e)})},NVe=(e,t)=>{const n=e?.trim()?.[0]??"",s=t?.trim()?.[0]??"";return`${n}${s}`.toUpperCase()||"U"},gH=e=>[...e].sort((t,n)=>{const s=t.created_at?new Date(t.created_at).getTime():0;return(n.created_at?new Date(n.created_at).getTime():0)-s});function CVe(){const{user:e,loading:t}=Vt(),[n,s]=f.useState([]),[r,i]=f.useState(!1),[o,l]=f.useState(""),[c,u]=f.useState(""),[d,h]=f.useState(null),[p,x]=f.useState(!1),[v,j]=f.useState(!1),[y,N]=f.useState(null),[w,S]=f.useState(Fg),[_,k]=f.useState(!1),[T,A]=f.useState(null),[E,M]=f.useState(!1),[z,P]=f.useState(1),[D,U]=f.useState(10),[B,R]=f.useState("Overview"),[q,Z]=f.useState(""),[V,oe]=f.useState(!1),je=Lo(e?.role);console.log("meow",e);const X=["ADMIN","CEO","GROUP_MANAGER"].includes(je),se=!t&&X,ye=f.useMemo(()=>{const ce=I1.filter(Q=>Lo(Q.value)!=="CEO");return[{label:"Filter by Roles",value:""},{label:"CEO",value:"CEO"},...ce]},[]),Ne=f.useCallback(ce=>{ce&&(s(Q=>Q.map(ne=>ne.id===ce?{...ne,highlight:!0}:ne)),setTimeout(()=>{s(Q=>Q.map(ne=>ne.id===ce?{...ne,highlight:!1}:ne))},2e3))},[]),fe=f.useCallback(async()=>{i(!0);try{const ce=await re.get("/users/all"),Q=Array.isArray(ce.data)?ce.data:[],ne=gH(Q);s(ne),h(ae=>ae&&(ne.find(Te=>Te.id===ae.id)||null)),console.log(ce.data)}catch(ce){console.error("Error fetching users:",ce);const Q=ce.response?.data?.detail||"Failed to load users. Please try again later.";H.error(Q)}finally{i(!1)}},[]);f.useEffect(()=>{!t&&!X&&e&&H.error("You are not authorized to access User Management.")},[X,t,e]),f.useEffect(()=>{t||!X||fe()},[t,X,fe]),f.useEffect(()=>{document.title="Users | Sari-Sari CRM"},[]);const we=f.useMemo(()=>{const ce=o.trim().toLowerCase(),Q=Lo(c);return gH(n.filter(ne=>{if(!ne)return!1;const ae=ce===""||[ne.first_name,ne.last_name,`${ne.first_name||""} ${ne.last_name||""}`,ne.email,uL(ne.role)].filter(Boolean).some(Te=>Te.toString().toLowerCase().includes(ce)),Pe=Q===""||Q==="CEO"&&["CEO","ADMIN"].includes(Lo(ne.role))||Lo(ne.role)===Q;return ae&&Pe}))},[n,o,c]),de=Math.max(1,Math.ceil(we.length/D)||1);f.useEffect(()=>{P(1)},[o,c,D]),f.useEffect(()=>{P(ce=>{const Q=Math.max(1,Math.ceil(we.length/D)||1);return ce>Q?Q:ce})},[we.length,D]);const ke=f.useMemo(()=>{const ce=(z-1)*D;return we.slice(ce,ce+D)},[we,z,D]);we.length===0||(z-1)*D+1,Math.min(z*D,we.length);const ge=()=>P(ce=>Math.max(ce-1,1)),$e=()=>P(ce=>Math.min(ce+1,de)),be=()=>{S(Fg),j(!1),N(null),x(!0)},me=ce=>{h(ce),R("Overview"),Z(ce?.is_active?"Active":"Inactive")},Ue=ce=>{ce.target.id==="userModalBackdrop"&&!E&&Ee()},Ee=()=>{h(null)},We=(ce,Q)=>{S(ne=>({...ne,[ce]:Q}))},tt=()=>{const ce="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*";let Q="";for(let ne=0;ne<10;ne+=1)Q+=ce.charAt(Math.floor(Math.random()*ce.length));We("password",Q)},lt=()=>{_||E||(x(!1),S(Fg),N(null),j(!1))},Fe=ce=>{S({firstName:ce.first_name||"",lastName:ce.last_name||"",email:ce.email||"",password:"",role:jVe(ce.role)}),j(!0),N(ce.id),x(!0),h(null)},st=ce=>{A({title:"Delete User",message:a.jsxs("span",{children:["Are you sure you want to delete"," ",a.jsxs("span",{className:"font-semibold",children:[ce.first_name," ",ce.last_name]}),"? This action cannot be undone."]}),confirmLabel:"Delete",cancelLabel:"Cancel",variant:"danger",action:{type:"delete",targetId:ce.id,name:`${ce.first_name||""} ${ce.last_name||""}`.trim()||ce.email||"user"}})},Xe=ce=>{ce.preventDefault();const Q=w.firstName.trim(),ne=w.lastName.trim(),ae=w.email.trim(),Pe=w.password.trim(),Te=w.role,he=!(v&&y);if(!Q||!ae||!Te){H.warn("Please fill in all required fields.");return}if(he&&!Pe){H.warn("Please fill in all required fields.");return}if(Pe&&Pe.length<8){H.warn("Password should be at least 8 characters long.");return}const He={first_name:Q,last_name:ne,email:ae,role:Te};(he||Pe)&&(He.password=Pe);const qe=`${Q} ${ne}`.trim(),nt=he?"create":"update";A({title:nt==="create"?"Confirm New User":"Confirm User Update",message:nt==="create"?a.jsxs("span",{children:["Create user ",a.jsx("span",{className:"font-semibold",children:qe})," with role"," ",a.jsx("span",{className:"font-semibold",children:uL(Te)}),"?"]}):a.jsxs("span",{children:["Save changes for"," ",a.jsx("span",{className:"font-semibold",children:qe||ae}),"?"]}),confirmLabel:nt==="create"?"Create User":"Update User",cancelLabel:"Cancel",variant:"primary",action:{type:nt,payload:He,targetId:y,name:qe||ae}})},Ze=async()=>{if(!T?.action){A(null);return}const{action:ce}=T,{type:Q,payload:ne,targetId:ae,name:Pe}=ce;M(!0),(Q==="create"||Q==="update")&&k(!0);try{if(Q==="create"){const he=(await re.post("/users/createuser",ne)).data;await fe(),Ne(he.id),H.success(`User "${Pe}" created successfully.`),x(!1),S(Fg),N(null),j(!1)}else if(Q==="update"){if(!ae)throw new Error("Missing user identifier for update.");const he=(await re.put(`/users/updateuser/${ae}`,ne)).data;await fe(),h(null),Ne(he.id),H.success(`User "${Pe}" updated successfully.`),x(!1),S(Fg),N(null),j(!1)}else if(Q==="delete"){if(!ae)throw new Error("Missing user identifier for deletion.");await re.delete(`/users/deleteuser/${ae}`),s(Te=>Te.map(he=>he.id===ae?{...he,is_active:!1}:he)),d&&d.id===ae&&(h(null),Z("")),H.success(`User "${Pe}" deactivated successfully.`)}}catch(Te){console.error("User management error:",Te);const he=Q==="create"?"Failed to create user. Please review the details and try again.":Q==="update"?"Failed to update user. Please review the details and try again.":"Failed to delete user. Please try again.",He=Te.response?.data?.detail||he;H.error(He)}finally{(Q==="create"||Q==="update")&&k(!1),M(!1),A(null)}},Je=()=>{E||A(null)},Be=async()=>{if(!d||!q)return;const ce=d.is_active?"Active":"Inactive";if(q===ce)return;const Q=q==="Active";oe(!0);try{const ae=(await re.put(`/users/updateuser/${d.id}`,{is_active:Q})).data;s(Pe=>Pe.map(Te=>Te.id===ae.id?ae:Te)),h(null),Z(""),H.success(`User status updated to ${q}`)}catch(ne){console.error("Failed to update user status:",ne);const ae=ne.response?.data?.detail||"Failed to update user status. Please try again.";H.error(ae)}finally{oe(!1)}},_e=a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 font-inter relative",children:[(r||t||!se)&&a.jsx(Wt,{}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 space-y-2 sm:space-y-0",children:[a.jsxs("h1",{className:"flex items-center text-xl sm:text-2xl font-semibold text-gray-800",children:[a.jsx(xj,{className:"mr-2 text-blue-600"}),"User Management"]}),a.jsx("div",{className:"flex justify-center lg:justify-end w-full sm:w-auto",children:a.jsxs("button",{type:"button",onClick:be,className:"flex items-center bg-black text-white px-3 sm:px-4 py-2 rounded-md hover:bg-gray-800 text-sm sm:text-base self-end sm:self-auto cursor-pointer",children:[a.jsx(Xa,{className:"mr-2"})," Add User"]})})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-4 shadow-sm mb-6 flex flex-col lg:flex-row items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg px-4 h-11 w-full lg:w-3/4 focus-within:ring-2 focus-within:ring-indigo-500 transition",children:[a.jsx(Kt,{size:20,className:"text-gray-400 mr-3"}),a.jsx("input",{type:"text",placeholder:"Search users",value:o,onChange:ce=>l(ce.target.value),className:"focus:outline-none text-base w-full"})]}),a.jsx("div",{className:"w-full lg:w-1/4",children:a.jsx("select",{value:c,onChange:ce=>u(ce.target.value),className:"border border-gray-300 rounded-lg px-3 h-11 text-sm text-gray-600 bg-white w-full focus:ring-2 focus:ring-indigo-500 transition",children:ye.map(ce=>a.jsx("option",{value:ce.value,children:ce.label},ce.value))})})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[600px] border border-gray-200 rounded-lg bg-white shadow-sm text-sm",children:[a.jsx("thead",{className:"bg-gray-100 text-left text-gray-600 text-sm tracking-wide font-semibold",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4",children:"Fullname"}),a.jsx("th",{className:"py-3 px-4",children:"Email"}),a.jsx("th",{className:"py-3 px-4",children:"Role"}),a.jsx("th",{className:"py-3 px-4",children:"Status"})]})}),a.jsx("tbody",{children:r?a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-500",colSpan:3,children:"Loading users..."})}):we.length===0?a.jsx("tr",{children:a.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-400",colSpan:4,children:"No users found."})}):ke.map(ce=>a.jsxs("tr",{className:`hover:bg-gray-50 transition-colors ${ce.highlight?"bg-green-50":""} ${ce.is_active?"":"opacity-60 bg-gray-50"}`,children:[a.jsx("td",{className:"py-3 px-4 cursor-pointer",onClick:()=>me(ce),children:a.jsxs("div",{className:"font-medium text-blue-600 hover:underline text-sm",children:[ce.first_name," ",ce.last_name]})}),a.jsx("td",{className:"py-3 px-4 cursor-pointer text-sm",onClick:()=>me(ce),children:ce.email}),a.jsx("td",{className:"py-3 px-4 cursor-pointer",onClick:()=>me(ce),children:HT(ce.role)}),a.jsx("td",{className:"py-3 px-4 cursor-pointer",onClick:()=>me(ce),children:a.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-md ${ce.is_active?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:ce.is_active?"Active":"Inactive"})})]},ce.id))})]})}),a.jsx(ca,{className:"mt-4",totalItems:we.length,pageSize:D,currentPage:z,onPrev:ge,onNext:$e,onPageSizeChange:U,label:"users"})]}),pe=d?a.jsx("div",{id:"userModalBackdrop",onClick:Ue,className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-6xl max-h-[92vh] overflow-y-auto hide-scrollbar animate-scale-in p-4 sm:p-6 md:p-8 font-inter relative",children:[a.jsx("div",{className:"flex justify-end w-full",children:a.jsx("button",{onClick:Ee,className:"text-gray-500 hover:text-gray-700 transition mb-5 cursor-pointer",children:a.jsx(Ja,{size:30})})}),a.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between lg:flex-row lg:items-center lg:justify-between mt-3 gap-2 px-2 md:items-center lg:gap-4 md:mx-7 lg:mx-7 mb-4 lg:mb-6 md:mb-4",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[d.profile_picture?a.jsx("img",{src:d.profile_picture,alt:`${d.first_name} ${d.last_name}`,className:"w-12 h-12 sm:w-16 sm:h-16 rounded-full object-cover border border-gray-200 shadow-sm"}):a.jsx("div",{className:"w-12 h-12 sm:w-16 sm:h-16 rounded-full bg-gray-200 text-gray-700 flex items-center justify-center text-lg sm:text-xl font-semibold border border-gray-200 shadow-sm",children:NVe(d.first_name,d.last_name)}),a.jsxs("div",{children:[a.jsxs("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-800",children:[d.first_name," ",d.last_name]}),a.jsx("p",{className:"text-sm text-gray-500 break-all",children:d.email})]})]}),HT(d.role,{size:"md"})]}),!["CEO","ADMIN","GROUP MANAGER","GROUP_MANAGER"].includes(d.role.toUpperCase())&&a.jsxs("div",{className:"flex flex-col sm:flex-row sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsxs("button",{type:"button",className:"inline-flex items-center justify-center w-full sm:w-auto bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 disabled:opacity-70 transition text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",onClick:()=>Fe(d),disabled:E,children:[a.jsx(hn,{className:"mr-2"}),"Edit"]}),a.jsxs("button",{type:"button",className:"inline-flex items-center justify-center w-full sm:w-auto px-4 py-2 rounded-md text-sm bg-red-500 text-white hover:bg-red-600 transition focus:outline-none focus:ring-2 focus:ring-red-400",onClick:()=>st(d),disabled:E,children:[a.jsx(wa,{className:"mr-2"}),"Delete"]})]})]}),a.jsx("div",{className:"border-b border-gray-200 mb-6"}),a.jsx("div",{className:"flex w-full bg-[#6A727D] text-white mt-1 overflow-x-auto mb-6",children:["Overview"].map(ce=>a.jsx("button",{onClick:()=>R(ce),className:`flex-1 min-w-[90px] px-4 py-2.5 text-xs sm:text-sm font-medium text-center transition-all duration-200 border-b-2
        ${B===ce?"bg-[#5c636d] text-white border-white":"text-white hover:bg-[#5c636d]"}`,children:ce},ce))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 items-start",children:[a.jsx("div",{className:"lg:col-span-3",children:B==="Overview"&&a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 md:p-8 border border-gray-200",children:a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4 sm:gap-6 text-sm text-gray-700",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Email:"}),a.jsx("p",{children:d.email||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Role:"}),a.jsx("p",{children:HT(d.role,{size:"sm"})})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Status:"}),a.jsx("p",{children:d.is_active?"Active":"Inactive"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Auth Provider:"}),a.jsx("p",{children:d.auth_provider?d.auth_provider.toString().replace(/\b\w/g,ce=>ce.toUpperCase()):"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Phone Number:"}),a.jsx("p",{children:d.phone_number||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Company:"}),a.jsx("p",{children:d.company?.company_name||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Company Number:"}),a.jsx("p",{children:d.company?.company_number||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Related to CEO:"}),a.jsx("p",{children:d.manager?`${d.manager.first_name} ${d.manager.last_name}`:"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Created At:"}),a.jsx("p",{children:hH(d.created_at)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Last Login:"}),a.jsx("p",{children:d.last_login?hH(d.last_login):"Never"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Profile Picture:"}),a.jsx("p",{children:d.profile_picture?a.jsx("a",{href:d.profile_picture,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline break-all",children:"View image"}):"N/A"})]})]})})}),a.jsxs("div",{className:"flex flex-col gap-4",children:[a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Quick Actions"}),a.jsx("div",{className:"flex flex-col gap-2 w-full",children:a.jsxs("button",{type:"button",onClick:()=>{if(!d.email){alert("No email address available");return}const ce=encodeURIComponent(d.email),Q=encodeURIComponent(""),ne=encodeURIComponent(""),ae=`https://mail.google.com/mail/?view=cm&fs=1&to=${ce}&su=${Q}&body=${ne}`;window.open(ae,"_blank")},className:"flex items-center gap-2 border border-gray-100 rounded-md py-1.5 px-2 sm:px-3 hover:bg-gray-50 transition text-sm",children:[a.jsx(rn,{className:"text-gray-600 w-4 h-4"}),"Send E-mail"]})})]}),a.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-3 sm:p-4 shadow-sm w-full",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Status"}),a.jsxs("select",{className:"border border-gray-200 rounded-md px-2 sm:px-3 py-1.5 w-full text-sm mb-2 focus:ring-2 focus:ring-indigo-500 outline-none",value:q||(d.is_active?"Active":"Inactive"),onChange:ce=>Z(ce.target.value),children:[a.jsx("option",{value:"Active",children:"Active"}),a.jsx("option",{value:"Inactive",children:"Inactive"})]}),a.jsx("button",{onClick:Be,disabled:V||q===(d.is_active?"Active":"Inactive"),className:`w-full py-1.5 rounded-md text-sm transition focus:outline-none focus:ring-2 ${V||q===(d.is_active?"Active":"Inactive")?"bg-gray-400 cursor-not-allowed text-white":"bg-gray-900 text-white hover:bg-gray-800 focus:ring-gray-400"}`,children:V?"Updating...":"Update"})]})]})]})]})}):null;return a.jsxs(a.Fragment,{children:[_e,pe,a.jsx(SVe,{open:p,isEditing:v,isSubmitting:_,confirmProcessing:E,formData:w,onClose:lt,onSubmit:Xe,onChange:We,onGeneratePassword:tt}),a.jsx(_Ve,{open:!!T,title:T?.title,message:T?.message,confirmLabel:T?.confirmLabel,cancelLabel:T?.cancelLabel,variant:T?.variant,loading:E,onConfirm:Ze,onCancel:Je})]})}function SVe({open:e,isEditing:t,isSubmitting:n,confirmProcessing:s,formData:r,onClose:i,onSubmit:o,onChange:l,onGeneratePassword:c}){if(!e)return null;const u=n||s;return a.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-2xl rounded-2xl shadow-lg border border-gray-200 p-6 sm:p-8 relative overflow-y-auto max-h-[90vh]",children:[a.jsx("button",{onClick:i,className:"absolute top-4 right-4 text-gray-500 hover:text-black transition disabled:opacity-60",disabled:u,children:a.jsx(ea,{size:22})}),a.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800 mb-6 text-center",children:t?"Edit User":"Add New User"}),a.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",onSubmit:o,children:[a.jsx(av,{label:"First Name",value:r.firstName,onChange:d=>l("firstName",d),placeholder:"John",required:!0,disabled:u}),a.jsx(av,{label:"Last Name",value:r.lastName,onChange:d=>l("lastName",d),placeholder:"Doe",required:!0,disabled:u}),a.jsx(av,{label:"Email",type:"email",value:r.email,onChange:d=>l("email",d),placeholder:"john.doe@company.com",required:!0,disabled:u||t}),a.jsx(av,{label:"Role",type:"select",value:r.role,onChange:d=>l("role",d),options:[{value:"",label:"Select role"},...I1],required:!0,disabled:u}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:"Password"}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2",children:[a.jsx("input",{type:"text",value:r.password,onChange:d=>l("password",d.target.value),placeholder:t?"Leave blank to keep current password":"Enter or generate password",required:!t,disabled:u,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-indigo-500 outline-none disabled:bg-gray-100"}),a.jsx("button",{type:"button",onClick:c,className:"flex items-center justify-center px-4 py-2 bg-gray-900 text-white rounded-md hover:bg-gray-800 transition disabled:opacity-60",disabled:u,children:"Generate"})]}),t?a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Setting a password will reset the user's credentials; leave it blank to keep the current password."}):a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Password must be at least 8 characters long."})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-2 md:col-span-2 mt-4",children:[a.jsx("button",{type:"button",onClick:i,className:"w-full sm:w-auto px-4 py-2 text-white bg-red-400 border border-red-300 rounded hover:bg-red-500 transition disabled:opacity-70",disabled:u,children:"Cancel"}),a.jsx("button",{type:"submit",className:"w-full sm:w-auto px-4 py-2 text-white border border-tertiary bg-tertiary rounded hover:bg-secondary transition disabled:opacity-70",disabled:u,children:n?"Saving...":t?"Update User":"Save User"})]})]})]})})}function av({label:e,type:t="text",value:n,onChange:s,placeholder:r,options:i=[],required:o=!1,disabled:l=!1}){return a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1 text-sm",children:e}),t==="select"?a.jsx("select",{value:n??"",onChange:c=>s(c.target.value),required:o,disabled:l,className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-indigo-500 outline-none disabled:bg-gray-100",children:i.map(c=>a.jsx("option",{value:c.value,children:c.label},c.value))}):a.jsx("input",{type:t,value:n??"",onChange:c=>s(c.target.value),placeholder:r,required:o,disabled:l,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-indigo-500 outline-none disabled:bg-gray-100"})]})}function _Ve({open:e,title:t,message:n,confirmLabel:s,cancelLabel:r="Cancel",variant:i="primary",loading:o=!1,onConfirm:l,onCancel:c}){if(!e)return null;const u=i==="danger"?"bg-red-500 hover:bg-red-600 border border-red-400":"bg-black hover:bg-gray-800 border border-black";return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 border border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),a.jsx("div",{className:"text-sm text-gray-600 mt-2 whitespace-pre-line",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[a.jsx("button",{type:"button",onClick:c,className:"w-full sm:w-auto px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-70",disabled:o,children:r}),a.jsx("button",{type:"button",onClick:l,className:`w-full sm:w-auto px-4 py-2 rounded-md text-white transition disabled:opacity-70 ${u}`,disabled:o,children:o?"Processing...":s})]})]})})}function AVe(){return a.jsxs(yse,{children:[a.jsx(ore,{position:"top-right",autoClose:3e3,hideProgressBar:!1,newestOnTop:!0,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"colored",className:"z-[9999]"}),a.jsxs(Vne,{children:[a.jsx(vt,{path:"/",element:a.jsx(goe,{})}),a.jsx(vt,{path:"/header",element:a.jsx(p9,{})}),a.jsx(vt,{path:"/signup",element:a.jsx(hue,{})}),a.jsx(vt,{path:"/login",element:a.jsx(pue,{})}),a.jsx(vt,{path:"/forgot-password",element:a.jsx(bue,{})}),a.jsx(vt,{path:"/resources",element:a.jsx(Cue,{})}),a.jsx(vt,{path:"/legal",element:a.jsx(Eue,{})}),a.jsx(vt,{path:"/admin/quotes/:quoteId/print",element:a.jsx(uo,{requiredRole:"ceo",children:a.jsx(Kb,{})})}),a.jsx(vt,{path:"/sales/quotes/:quoteId/print",element:a.jsx(uo,{requiredRole:"sales",children:a.jsx(Kb,{})})}),a.jsx(vt,{path:"/manager/quotes/:quoteId/print",element:a.jsx(uo,{requiredRole:"manager",children:a.jsx(Kb,{})})}),a.jsx(vt,{path:"/group-manager/quotes/:quoteId/print",element:a.jsx(uo,{requiredRole:"group manager",children:a.jsx(Kb,{})})}),a.jsxs(vt,{path:"/super-admin",element:a.jsx(uo,{requiredRole:"admin",children:a.jsx(Gze,{})}),children:[a.jsx(vt,{index:!0,element:a.jsx(ur,{to:"dashboard",replace:!0})}),a.jsx(vt,{path:"dashboard",element:a.jsx(Wze,{})})]}),a.jsxs(vt,{path:"/admin",element:a.jsx(uo,{requiredRole:"ceo",children:a.jsx(Pue,{})}),children:[a.jsx(vt,{index:!0,element:a.jsx(ur,{to:"dashboard",replace:!0})}),a.jsx(vt,{path:"dashboard",element:a.jsx(xCe,{})}),a.jsx(vt,{path:"accounts",element:a.jsx($Ce,{})}),a.jsx(vt,{path:"contacts",element:a.jsx(UCe,{})}),a.jsx(vt,{path:"leads",element:a.jsx(YCe,{})}),a.jsx(vt,{path:"leads/:leadID",element:a.jsx(uY,{})}),a.jsx(vt,{path:"audit",element:a.jsx(zSe,{})}),a.jsx(vt,{path:"targets",element:a.jsx(U$e,{})}),a.jsx(vt,{path:"quotes",element:a.jsx(Y$e,{})}),a.jsx(vt,{path:"users",element:a.jsx(a6e,{})}),a.jsx(vt,{path:"manage-account",element:a.jsx(i6e,{})}),a.jsx(vt,{path:"company-details",element:a.jsx(Hze,{})}),a.jsx(vt,{path:"deals",element:a.jsx(o6e,{})}),a.jsx(vt,{path:"deals/info",element:a.jsx(SZ,{})}),a.jsx(vt,{path:"deals/quickaction",element:a.jsx(CZ,{})}),a.jsx(vt,{path:"tasks",element:a.jsx(bze,{})}),a.jsxs(vt,{path:"/admin/territory",children:[a.jsx(vt,{index:!0,element:a.jsx(Bc,{})}),a.jsx(vt,{path:":id",element:a.jsx(Bc,{})})]}),a.jsx(vt,{path:"calls",element:a.jsx(l8,{})}),a.jsx(vt,{path:"calls/info",element:a.jsx(l8,{})}),a.jsx(vt,{path:"meetings",element:a.jsx(c8,{})}),a.jsx(vt,{path:"meetings/info",element:a.jsx(c8,{})}),a.jsx(vt,{path:"help",element:a.jsx(qze,{})})]}),a.jsxs(vt,{path:"/sales",element:a.jsx(uo,{requiredRole:"sales",children:a.jsx(Yze,{})}),children:[a.jsx(vt,{index:!0,element:a.jsx(ur,{to:"overview",replace:!0})}),a.jsx(vt,{path:"overview",element:a.jsx(bFe,{})}),a.jsx(vt,{path:"accounts",element:a.jsx(jFe,{})}),a.jsx(vt,{path:"contacts",element:a.jsx(_Fe,{})}),a.jsx(vt,{path:"leads",element:a.jsx(DFe,{})}),a.jsx(vt,{path:"leads/info",element:a.jsx(uJ,{})}),a.jsx(vt,{path:"leads/convert",element:a.jsx(FFe,{})}),a.jsx(vt,{path:"deals",element:a.jsx(UFe,{})}),a.jsx(vt,{path:"deals/info",element:a.jsx(fJ,{})}),a.jsx(vt,{path:"deals/quickaction",element:a.jsx(mJ,{})}),a.jsx(vt,{path:"quotes",element:a.jsx(JFe,{})}),a.jsx(vt,{path:"targets",element:a.jsx(sUe,{})}),a.jsx(vt,{path:"audit",element:a.jsx(rUe,{})}),a.jsx(vt,{path:"manage-account",element:a.jsx(Gy,{})}),a.jsxs(vt,{path:"/sales/territory",children:[a.jsx(vt,{index:!0,element:a.jsx(Bc,{})}),a.jsx(vt,{path:":id",element:a.jsx(Bc,{})})]}),a.jsx(vt,{path:"meetings",element:a.jsx(yUe,{})}),a.jsx(vt,{path:"calls",element:a.jsx(jUe,{})}),a.jsx(vt,{path:"tasks",element:a.jsx(cUe,{})})]}),a.jsxs(vt,{path:"/manager",element:a.jsx(uo,{requiredRole:"manager",children:a.jsx(TUe,{})}),children:[a.jsx(vt,{index:!0,element:a.jsx(ur,{to:"dashboard",replace:!0})}),a.jsx(vt,{path:"dashboard",element:a.jsx(a7e,{})}),a.jsx(vt,{path:"accounts",element:a.jsx(r7e,{})}),a.jsx(vt,{path:"contacts",element:a.jsx(c7e,{})}),a.jsx(vt,{path:"leads",element:a.jsx(p7e,{})}),a.jsx(vt,{path:"leads/info",element:a.jsx(jJ,{})}),a.jsx(vt,{path:"leads/convert",element:a.jsx(N7e,{})}),a.jsx(vt,{path:"deals",element:a.jsx(C7e,{})}),a.jsx(vt,{path:"deals/info",element:a.jsx(CJ,{})}),a.jsx(vt,{path:"deals/quickaction",element:a.jsx(NJ,{})}),a.jsx(vt,{path:"quotes",element:a.jsx(I7e,{})}),a.jsx(vt,{path:"targets",element:a.jsx(U7e,{})}),a.jsx(vt,{path:"meetings",element:a.jsx(l8e,{})}),a.jsx(vt,{path:"audit",element:a.jsx(B7e,{})}),a.jsx(vt,{path:"calls",element:a.jsx(G7e,{})}),a.jsx(vt,{path:"tasks",element:a.jsx(J7e,{})}),a.jsxs(vt,{path:"/manager/territory",children:[a.jsx(vt,{index:!0,element:a.jsx(Bc,{})}),a.jsx(vt,{path:":id",element:a.jsx(Bc,{})})]}),a.jsx(vt,{path:"users",element:a.jsx(f8e,{})}),a.jsx(vt,{path:"manage-account",element:a.jsx(Gy,{})})]}),a.jsx(vt,{children:a.jsxs(vt,{path:"/marketing",element:a.jsx(uo,{requiredRole:"marketing",children:a.jsx(x8e,{})}),children:[a.jsx(vt,{index:!0,element:a.jsx(ur,{to:"dashboard",replace:!0})}),a.jsx(vt,{path:"dashboard",element:a.jsx(gGe,{})}),a.jsx(vt,{path:"accounts",element:a.jsx(pGe,{})}),a.jsx(vt,{path:"contacts",element:a.jsx(yGe,{})}),a.jsx(vt,{path:"leads",element:a.jsx(CGe,{})}),a.jsx(vt,{path:"leads/info",element:a.jsx(bee,{})}),a.jsx(vt,{path:"leads/convert",element:a.jsx(yee,{})}),a.jsx(vt,{path:"tasks",element:a.jsx(TGe,{})}),a.jsx(vt,{path:"campaigns",element:a.jsx(LGe,{})}),a.jsx(vt,{path:"templates",element:a.jsx(DGe,{})}),a.jsx(vt,{path:"manage-account",element:a.jsx(Gy,{})})]})}),a.jsxs(vt,{path:"/group-manager",element:a.jsx(uo,{requiredRole:"group manager",children:a.jsx($Ge,{})}),children:[a.jsx(vt,{index:!0,element:a.jsx(ur,{to:"dashboard",replace:!0})}),a.jsx(vt,{path:"dashboard",element:a.jsx(uWe,{})}),a.jsx(vt,{path:"accounts",element:a.jsx(hWe,{})}),a.jsx(vt,{path:"contacts",element:a.jsx(yWe,{})}),a.jsx(vt,{path:"leads",element:a.jsx(SWe,{})}),a.jsx(vt,{path:"leads/info",element:a.jsx(_ee,{})}),a.jsx(vt,{path:"leads/convert",element:a.jsx(PWe,{})}),a.jsx(vt,{path:"deals",element:a.jsx(OWe,{})}),a.jsx(vt,{path:"deals/info",element:a.jsx(Tee,{})}),a.jsx(vt,{path:"deals/quickaction",element:a.jsx(Aee,{})}),a.jsx(vt,{path:"quotes",element:a.jsx(VWe,{})}),a.jsx(vt,{path:"targets",element:a.jsx(ZWe,{})}),a.jsx(vt,{path:"tasks",element:a.jsx(aVe,{})}),a.jsxs(vt,{path:"/group-manager/territory",children:[a.jsx(vt,{index:!0,element:a.jsx(Bc,{})}),a.jsx(vt,{path:":id",element:a.jsx(Bc,{})})]}),a.jsx(vt,{path:"meetings",element:a.jsx(uVe,{})}),a.jsx(vt,{path:"calls",element:a.jsx(gVe,{})}),a.jsx(vt,{path:"audit",element:a.jsx(vVe,{})}),a.jsx(vt,{path:"users",element:a.jsx(CVe,{})}),a.jsx(vt,{path:"manage-account",element:a.jsx(Gy,{})})]})]})]})}Yae.createRoot(document.getElementById("root")).render(a.jsx(f.StrictMode,{children:a.jsx(AVe,{})}));
